       IDENTIFICATION DIVISION.
       PROGRAM-ID.  BYTEFILE.
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT IN-FILE
               ASSIGN TO 'ZCOBOL\TEST\TESTPM3.IN'
               ORGANIZATION IS LINE SEQUENTIAL.
           SELECT OUT-FILE
               ASSIGN TO 'ZCOBOL\TEST\TESTPM3.OUT'
               ORGANIZATION IS LINE SEQUENTIAL.
       DATA DIVISION.
       FILE SECTION.
       FD  IN-FILE
           DATA RECORD IS IN-RECORD.
       01  IN-RECORD.
           03  IR   OCCURS  80 PIC X(01).
*******        01  IN-RECORD PIC X(80).
       FD  OUT-FILE
           DATA RECORD IS OUT-RECORD.
       01  OUT-RECORD.
           03  OR   OCCURS  80 PIC X(01).
*******        01  OUT-RECORD PIC X(80).
       WORKING-STORAGE SECTION.
       01  WS-LINE PIC X(80).
       01  END-OF-FILE-FLAG PIC X VALUE 'F'.
       77  ICHAR COMP   PIC S9(4) VALUE +0.
       77  OCHAR COMP   PIC S9(4) VALUE +0.
       77  IBYTES       COMP-3    PIC S9(18) VALUE +0.
       77  COUNT COMP-3 PIC S9(4) VALUE +0.
       77  HOLD-CHAR    PIC X(01) VALUE SPACE.
       PROCEDURE DIVISION.
       MAINLINE.
           DISPLAY 'BYTEFILE STARTED'.
           PERFORM INITIALIZATION-ROUTINE.
           PERFORM THE-LOOP
                   UNTIL END-OF-FILE-FLAG = 'Y'.
           PERFORM EOJ-ROUTINE.
           DISPLAY 'BYTEFILE RECORDS COPIED = ' COUNT.
           DISPLAY 'BYTES COPIED =' IBYTES.
           DISPLAY 'BYTEFILE ENDED OK'
           STOP RUN.
       INITIALIZATION-ROUTINE.
           OPEN INPUT IN-FILE.
           OPEN OUTPUT OUT-FILE.
           READ IN-FILE INTO IN-RECORD
                AT END MOVE 'Y' TO END-OF-FILE-FLAG.
       THE-LOOP.
           PERFORM THE-MOVE 
              VARYING ICHAR FROM 1 BY 1 UNTIL ICHAR > 80.

           WRITE OUT-RECORD.
           ADD 1 TO COUNT.
           READ IN-FILE INTO OUT-RECORD
                AT END MOVE 'Y' TO END-OF-FILE-FLAG.
       THE-MOVE.
           MOVE ICHAR TO OCHAR.
           MOVE IR (ICHAR) TO HOLD-CHAR.
  
           MOVE HOLD-CHAR TO OR (OCHAR).
           COMPUTE IBYTES = IBYTES + 1.
       EOJ-ROUTINE.
           CLOSE IN-FILE.
           CLOSE OUT-FILE.
