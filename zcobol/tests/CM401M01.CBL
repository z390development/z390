000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300      CM401M.
000400*The following program tests the flagging of level 2
000500*features of the communication module.
000600 ENVIRONMENT DIVISION.
000700 CONFIGURATION SECTION.
000800 SOURCE-COMPUTER.
000900     XXXXX082.
001000 OBJECT-COMPUTER.
001100     XXXXX083.
001200 DATA DIVISION.
001300 FILE SECTION.
001400 COMMUNICATION SECTION.
001500 CD COMMNAME FOR INITIAL INPUT
001600*Message expected for above statement: NON-CONFORMING STANDARD
001700     SYMBOLIC SUB-QUEUE-1 IS CQ.
001800*Message expected for above statement: NON-CONFORMING STANDARD
001900 01 CREC.
002000     03 CNAME1   PIC X(8).
002100     03 CQ       PIC 9(8).
002200     03 FILLER   PIC X(62).
002300     03 CINT     PIC 9.
002400     03 FILLER   PIC X(8).
002500
002600 CD COMM2 FOR OUTPUT
002700     DESTINATION TABLE OCCURS 7 TIMES.
002800*Message expected for above statement: NON-CONFORMING STANDARD
002900
003000 PROCEDURE DIVISION.
003100
003200 CM401M-CONTROL.
003300     PERFORM CM401M-DISABLE THRU CM401M-SENDREP.
003400     STOP RUN.
003500
003600 CM401M-DISABLE.
003700     DISABLE INPUT COMMNAME WITH KEY CNAME1.
003800*Message expected for above statement: NON-CONFORMING STANDARD
003900
004000 CM401M-ENABLE.
004100     ENABLE INPUT COMMNAME WITH KEY CNAME1.
004200*Message expected for above statement: NON-CONFORMING STANDARD
004300
004400
004500 CM401M-PURGE.
004600     PURGE COMM2.
004700*Message expected for above statement: NON-CONFORMING STANDARD
004800
004900 CM401M-SEND.
005000     SEND COMM2 FROM CNAME1.
005100*Message expected for above statement: NON-CONFORMING STANDARD
005200
005300 CM401M-SENDID.
005400     SEND COMM2 FROM CNAME1 WITH CINT.
005500*Message expected for above statement: NON-CONFORMING STANDARD
005600
005700 CM401M-SENDESI.
005800     SEND COMM2 FROM CNAME1 WITH ESI.
005900*Message expected for above statement: NON-CONFORMING STANDARD
006000
006100 CM401M-SENDREP.
006200     SEND COMM2 WITH EMI REPLACING LINE.
006300*Message expected for above statement: NON-CONFORMING STANDARD
006400
006500*TOTAL NUMBER OF FLAGS EXPECTED = 10.
