000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST104A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100 ENVIRONMENT DIVISION.
002200 CONFIGURATION SECTION.
002300 SOURCE-COMPUTER.
002400     XXXXX082.
002500 OBJECT-COMPUTER.
002600     XXXXX083.
002700 INPUT-OUTPUT SECTION.
002800 FILE-CONTROL.
002900     SELECT PRINT-FILE ASSIGN TO
003000     XXXXX055.
003100     SELECT   SORTOUT-1D ASSIGN TO
003200     XXXXP001.
003300 DATA DIVISION.
003400 FILE SECTION.
003500 FD  PRINT-FILE.
003600 01  PRINT-REC PICTURE X(120).
003700 01  DUMMY-RECORD PICTURE X(120).
003800 FD  SORTOUT-1D
003900     LABEL RECORDS STANDARD
004000C    VALUE OF
004100C    XXXXX074
004200C    IS
004300C    XXXXX075
004400G    XXXXX069
004500     DATA RECORD IS SORTOUT-REC.
004600 01  SORTOUT-REC.
004700     02 KEY-ITEM        PICTURE S999V999.
004800     02 NON-KEY-ITEM    PICTURE S9(12).
004900 WORKING-STORAGE SECTION.
005000 77  U-TILITY           PICTURE 999V999     VALUE ZERO.
005100 77  UTIL-SW            PICTURE 9           VALUE ZERO.
005200 77  WRITE-COUNTER      PICTURE 999         VALUE ZERO.
005300 01  TEST-RESULTS.
005400     02 FILLER                   PIC X      VALUE SPACE.
005500     02 FEATURE                  PIC X(20)  VALUE SPACE.
005600     02 FILLER                   PIC X      VALUE SPACE.
005700     02 P-OR-F                   PIC X(5)   VALUE SPACE.
005800     02 FILLER                   PIC X      VALUE SPACE.
005900     02  PAR-NAME.
006000       03 FILLER                 PIC X(19)  VALUE SPACE.
006100       03  PARDOT-X              PIC X      VALUE SPACE.
006200       03 DOTVALUE               PIC 99     VALUE ZERO.
006300     02 FILLER                   PIC X(8)   VALUE SPACE.
006400     02 RE-MARK                  PIC X(61).
006500 01  TEST-COMPUTED.
006600     02 FILLER                   PIC X(30)  VALUE SPACE.
006700     02 FILLER                   PIC X(17)  VALUE
006800            "       COMPUTED=".
006900     02 COMPUTED-X.
007000     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
007100     03 COMPUTED-N               REDEFINES COMPUTED-A
007200                                 PIC -9(9).9(9).
007300     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
007400     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
007500     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
007600     03       CM-18V0 REDEFINES COMPUTED-A.
007700         04 COMPUTED-18V0                    PIC -9(18).
007800         04 FILLER                           PIC X.
007900     03 FILLER PIC X(50) VALUE SPACE.
008000 01  TEST-CORRECT.
008100     02 FILLER PIC X(30) VALUE SPACE.
008200     02 FILLER PIC X(17) VALUE "       CORRECT =".
008300     02 CORRECT-X.
008400     03 CORRECT-A                  PIC X(20) VALUE SPACE.
008500     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
008600     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
008700     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
008800     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
008900     03      CR-18V0 REDEFINES CORRECT-A.
009000         04 CORRECT-18V0                     PIC -9(18).
009100         04 FILLER                           PIC X.
009200     03 FILLER PIC X(2) VALUE SPACE.
009300     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
009400 01  CCVS-C-1.
009500     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
009600-    "SS  PARAGRAPH-NAME
009700-    "       REMARKS".
009800     02 FILLER                     PIC X(20)    VALUE SPACE.
009900 01  CCVS-C-2.
010000     02 FILLER                     PIC X        VALUE SPACE.
010100     02 FILLER                     PIC X(6)     VALUE "TESTED".
010200     02 FILLER                     PIC X(15)    VALUE SPACE.
010300     02 FILLER                     PIC X(4)     VALUE "FAIL".
010400     02 FILLER                     PIC X(94)    VALUE SPACE.
010500 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
010600 01  REC-CT                        PIC 99       VALUE ZERO.
010700 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
010800 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
010900 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
011000 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
011100 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
011200 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
011300 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
011400 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
011500 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
011600 01  CCVS-H-1.
011700     02  FILLER                    PIC X(39)    VALUE SPACES.
011800     02  FILLER                    PIC X(42)    VALUE
011900     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
012000     02  FILLER                    PIC X(39)    VALUE SPACES.
012100 01  CCVS-H-2A.
012200   02  FILLER                        PIC X(40)  VALUE SPACE.
012300   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
012400   02  FILLER                        PIC XXXX   VALUE
012500     "4.2 ".
012600   02  FILLER                        PIC X(28)  VALUE
012700            " COPY - NOT FOR DISTRIBUTION".
012800   02  FILLER                        PIC X(41)  VALUE SPACE.
012900
013000 01  CCVS-H-2B.
013100   02  FILLER                        PIC X(15)  VALUE
013200            "TEST RESULT OF ".
013300   02  TEST-ID                       PIC X(9).
013400   02  FILLER                        PIC X(4)   VALUE
013500            " IN ".
013600   02  FILLER                        PIC X(12)  VALUE
013700     " HIGH       ".
013800   02  FILLER                        PIC X(22)  VALUE
013900            " LEVEL VALIDATION FOR ".
014000   02  FILLER                        PIC X(58)  VALUE
014100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
014200 01  CCVS-H-3.
014300     02  FILLER                      PIC X(34)  VALUE
014400            " FOR OFFICIAL USE ONLY    ".
014500     02  FILLER                      PIC X(58)  VALUE
014600     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
014700     02  FILLER                      PIC X(28)  VALUE
014800            "  COPYRIGHT   1985 ".
014900 01  CCVS-E-1.
015000     02 FILLER                       PIC X(52)  VALUE SPACE.
015100     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
015200     02 ID-AGAIN                     PIC X(9).
015300     02 FILLER                       PIC X(45)  VALUE SPACES.
015400 01  CCVS-E-2.
015500     02  FILLER                      PIC X(31)  VALUE SPACE.
015600     02  FILLER                      PIC X(21)  VALUE SPACE.
015700     02 CCVS-E-2-2.
015800         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
015900         03 FILLER                   PIC X      VALUE SPACE.
016000         03 ENDER-DESC               PIC X(44)  VALUE
016100            "ERRORS ENCOUNTERED".
016200 01  CCVS-E-3.
016300     02  FILLER                      PIC X(22)  VALUE
016400            " FOR OFFICIAL USE ONLY".
016500     02  FILLER                      PIC X(12)  VALUE SPACE.
016600     02  FILLER                      PIC X(58)  VALUE
016700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
016800     02  FILLER                      PIC X(13)  VALUE SPACE.
016900     02 FILLER                       PIC X(15)  VALUE
017000             " COPYRIGHT 1985".
017100 01  CCVS-E-4.
017200     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
017300     02 FILLER                       PIC X(4)   VALUE " OF ".
017400     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
017500     02 FILLER                       PIC X(40)  VALUE
017600      "  TESTS WERE EXECUTED SUCCESSFULLY".
017700 01  XXINFO.
017800     02 FILLER                       PIC X(19)  VALUE
017900            "*** INFORMATION ***".
018000     02 INFO-TEXT.
018100       04 FILLER                     PIC X(8)   VALUE SPACE.
018200       04 XXCOMPUTED                 PIC X(20).
018300       04 FILLER                     PIC X(5)   VALUE SPACE.
018400       04 XXCORRECT                  PIC X(20).
018500     02 INF-ANSI-REFERENCE           PIC X(48).
018600 01  HYPHEN-LINE.
018700     02 FILLER  PIC IS X VALUE IS SPACE.
018800     02 FILLER  PIC IS X(65)    VALUE IS "************************
018900-    "*****************************************".
019000     02 FILLER  PIC IS X(54)    VALUE IS "************************
019100-    "******************************".
019200 01  CCVS-PGM-ID                     PIC X(9)   VALUE
019300     "ST104A".
019400 PROCEDURE DIVISION.
019500 CCVS1 SECTION.
019600 OPEN-FILES.
019700     OPEN     OUTPUT PRINT-FILE.
019800     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
019900     MOVE    SPACE TO TEST-RESULTS.
020000     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
020100     GO TO CCVS1-EXIT.
020200 CLOSE-FILES.
020300     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
020400 TERMINATE-CCVS.
020500S    EXIT PROGRAM.
020600STERMINATE-CALL.
020700     STOP     RUN.
020800 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
020900 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
021000 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
021100 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
021200     MOVE "****TEST DELETED****" TO RE-MARK.
021300 PRINT-DETAIL.
021400     IF REC-CT NOT EQUAL TO ZERO
021500             MOVE "." TO PARDOT-X
021600             MOVE REC-CT TO DOTVALUE.
021700     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
021800     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
021900        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
022000          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
022100     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
022200     MOVE SPACE TO CORRECT-X.
022300     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
022400     MOVE     SPACE TO RE-MARK.
022500 HEAD-ROUTINE.
022600     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
022700     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
022800     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
022900     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
023000 COLUMN-NAMES-ROUTINE.
023100     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
023200     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
023400 END-ROUTINE.
023500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
023600 END-RTN-EXIT.
023700     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023800 END-ROUTINE-1.
023900      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
024000      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
024100      ADD PASS-COUNTER TO ERROR-HOLD.
024200*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
024300      MOVE PASS-COUNTER TO CCVS-E-4-1.
024400      MOVE ERROR-HOLD TO CCVS-E-4-2.
024500      MOVE CCVS-E-4 TO CCVS-E-2-2.
024600      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
024700  END-ROUTINE-12.
024800      MOVE "TEST(S) FAILED" TO ENDER-DESC.
024900     IF       ERROR-COUNTER IS EQUAL TO ZERO
025000         MOVE "NO " TO ERROR-TOTAL
025100         ELSE
025200         MOVE ERROR-COUNTER TO ERROR-TOTAL.
025300     MOVE     CCVS-E-2 TO DUMMY-RECORD.
025400     PERFORM WRITE-LINE.
025500 END-ROUTINE-13.
025600     IF DELETE-COUNTER IS EQUAL TO ZERO
025700         MOVE "NO " TO ERROR-TOTAL  ELSE
025800         MOVE DELETE-COUNTER TO ERROR-TOTAL.
025900     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
026000     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026100      IF   INSPECT-COUNTER EQUAL TO ZERO
026200          MOVE "NO " TO ERROR-TOTAL
026300      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
026400      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
026500      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026600     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026700 WRITE-LINE.
026800     ADD 1 TO RECORD-COUNT.
026900Y    IF RECORD-COUNT GREATER 42
027000Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
027100Y        MOVE SPACE TO DUMMY-RECORD
027200Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
027300Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
027400Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
027500Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
027600Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
027700Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
027800Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
027900Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
028000Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
028100Y        MOVE ZERO TO RECORD-COUNT.
028200     PERFORM WRT-LN.
028300 WRT-LN.
028400     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
028500     MOVE SPACE TO DUMMY-RECORD.
028600 BLANK-LINE-PRINT.
028700     PERFORM WRT-LN.
028800 FAIL-ROUTINE.
028900     IF     COMPUTED-X NOT EQUAL TO SPACE
029000            GO TO   FAIL-ROUTINE-WRITE.
029100     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
029200     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
029300     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
029400     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029500     MOVE   SPACES TO INF-ANSI-REFERENCE.
029600     GO TO  FAIL-ROUTINE-EX.
029700 FAIL-ROUTINE-WRITE.
029800     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
029900     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
030000     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
030100     MOVE   SPACES TO COR-ANSI-REFERENCE.
030200 FAIL-ROUTINE-EX. EXIT.
030300 BAIL-OUT.
030400     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
030500     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
030600 BAIL-OUT-WRITE.
030700     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
030800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
030900     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031000     MOVE   SPACES TO INF-ANSI-REFERENCE.
031100 BAIL-OUT-EX. EXIT.
031200 CCVS1-EXIT.
031300     EXIT.
031400 SECT-ST104-0001 SECTION.
031500 ST104-0001-01.
031600     OPEN     OUTPUT SORTOUT-1D.
031700 BUILD-FILE.
031800     MOVE     +987654321078 TO NON-KEY-ITEM.
031900     MOVE     U-TILITY TO KEY-ITEM.
032000     IF       U-TILITY GREATER THAN 214.200
032100              MOVE 1 TO UTIL-SW.
032200     WRITE    SORTOUT-REC.
032300     ADD      1 TO WRITE-COUNTER ON SIZE ERROR
032400              MOVE "SIZE ERROR ENCOUNTERED" TO RE-MARK
032500              GO TO BUILD-FILE-FAIL.
032600     IF       UTIL-SW EQUAL TO 1
032700              SUBTRACT 002.142 FROM U-TILITY
032800              ELSE
032900              ADD 002.142 TO U-TILITY.
033000     IF       U-TILITY NOT EQUAL TO ZERO
033100              GO TO BUILD-FILE.
033200     MOVE     +987654321078 TO NON-KEY-ITEM.
033300     MOVE     U-TILITY TO KEY-ITEM.
033400     WRITE    SORTOUT-REC.
033500     ADD      1 TO WRITE-COUNTER ON SIZE ERROR
033600              MOVE "SIZE ERROR FOUND" TO RE-MARK
033700              GO TO BUILD-FILE-FAIL.
033800 BUILD-FILE-TEST.
033900     IF       WRITE-COUNTER EQUAL TO 203
034000              PERFORM PASS GO TO BUILD-FILE-WRITE.
034100 BUILD-FILE-FAIL.
034200     MOVE     WRITE-COUNTER TO COMPUTED-N.
034300     MOVE     203 TO CORRECT-N.
034400     PERFORM  FAIL.
034500 BUILD-FILE-WRITE.
034600     MOVE     "TAPE BEING BUILT" TO FEATURE.
034700     MOVE     "BUILD-FILE-TEST" TO PAR-NAME.
034800     PERFORM  PRINT-DETAIL.
034900     CLOSE    SORTOUT-1D.
035000 CCVS-EXIT SECTION.
035100 CCVS-999999.
035200     GO TO   CLOSE-FILES.
