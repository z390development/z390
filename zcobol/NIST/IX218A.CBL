000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IX218A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*
001400*  1.  THE  FUNCTION  OF THIS PROGRAM IS TO CHECK THE SEQUENTIAL
001500*      READ  STATEMENT FOR A NOT EXISTING OPTIONAL INDEXED FILE.
001600*      THE  READ  STATEMENT WITHOUT AN OPEN STATEMENT FOR SUCH A
001700*      FILE  MUST CAUSE THE AT END CONDITION AND THE FILE STATUS
001800*      CODE  10. THIS CODE IS CHECKED HERE. THE NAME OF THE FILE
001900*      IS  IX-FS1.  THE  AT  END PHRASE IS SPECIFIED. THAT MEANS
002000*      THAT  ANY USE AFTER STANDARD EXCEPTION PROCEDURE MUST NOT
002100*      BE EXECUTED.
002200*
002300*  2.  ANOTHER  FUNCTION  OF  THIS PROGRAM IS TO CHECK THE START
002400*      AND  THE  RANDOM  READ  STATEMENTS  FOR  A  NOT  EXISTING
002500*      OPTIONAL  INDEXED  FILE.  BOTH  ATTEMPTS SHOULD CAUSE THE
002600*      FILE  STATUS CODE 23. THE INVALID KEY PHRASE IS SPECIFIED
002700*      AND  THE  USE AFTER STANDARD EXCEPTION PROCEDURE MUST NOT
002800*      BE EXECUTED. THE NAME OF THE FILE IS IX-FS2.
002900*
003000*
003100*
003200*       X-CARDS  WHICH MUST BE REPLACED FOR THIS PROGRAM ARE
003300*
003400*             X-24   INDEXED FILE IMPLEMENTOR-NAME IN ASSGN TO
003500*                    CLAUSE FOR DATA FILE IX-FS1
003600*             X-25   INDEXED FILE IMPLEMENTOR-NAME IN ASSGN TO
003700*                    CLAUSE FOR DATA FILE IX-FS1
003800*             X-55   IMPLEMENTOR-NAME FOR SYSTEM PRINTER
003900*             X-62   IMPLEMENTOR-NAME FOR RAW-DATA (OPTIONAL)
004000*             X-82   IMPLEMENTOR-NAME FOR SOURCE-COMPUTER
004100*             X-83   IMPLEMENTOR-NAME FOR OBJECT-COMPUTER
004200*             X-84   IMPLEMENTOR-NAME FOR PRINT-FILE
004300*
004400*         NOTE:  X-CARDS 44, 45 AND 62          ARE OPTIONAL
004500*               AND NEED ONLY TO BE PRESENT IF THE COMPILER RE-
004600*               QUIRES THIS CODE BE AVAILABLE FOR PROPER PROGRAM
004700*               COMPILATION AND EXECUTION. IF THE VP-ROUTINE IS
004800*               USED THE  X-CARDS MAY BE AUTOMATICALLY SELECTED
004900*               FOR INCLUSION IN THE PROGRAM BY SPECIFYING THE
005000*               APPROPRIATE LETTER IN THE "*OPT" VP-ROUTINE
005100*               CONTROL CARD. THE LETTER  CORRESPONDS TO A
005200*               CHARACTER IN POSITION 7 OF THE SOURCE LINE AND
005300*               THEY ARE AS FOLLOWS
005400*
005500*                  J  SELECTS X-CARD 44
005600*                  J  SELECTS X-CARD 45
005700*                  P  SELECTS X-CARD 62
005800*                  C  SELECTS X-CARD 84
005900*
006000******************************************************
006100 ENVIRONMENT DIVISION.
006200 CONFIGURATION SECTION.
006300 SOURCE-COMPUTER.
006400     XXXXX082.
006500 OBJECT-COMPUTER.
006600     XXXXX083.
006700 INPUT-OUTPUT SECTION.
006800 FILE-CONTROL.
006900P    SELECT RAW-DATA   ASSIGN TO
007000P    XXXXX062
007100P           ORGANIZATION IS INDEXED
007200P           ACCESS MODE IS RANDOM
007300P           RECORD KEY IS RAW-DATA-KEY.
007400     SELECT PRINT-FILE ASSIGN TO
007500     XXXXX055.
007600
007700     SELECT OPTIONAL   IX-FS1 ASSIGN TO
007800*    SELECT            IX-FS1 ASSIGN TO
007900     XXXXP024
008000J    XXXXP044
008100     ORGANIZATION IS INDEXED
008200     RECORD KEY IS IX-FS1-KEY
008300     ACCESS MODE IS SEQUENTIAL
008400     FILE STATUS IS IX-FS1-STATUS.
008500
008600     SELECT OPTIONAL   IX-FS2 ASSIGN TO
008700*    SELECT            IX-FS2 ASSIGN TO
008800     XXXXP025
008900J    XXXXP045
009000     ORGANIZATION IS INDEXED
009100     RECORD KEY IS IX-FS2-KEY
009200     ACCESS MODE IS DYNAMIC
009300     FILE STATUS IS IX-FS2-STATUS.
009400
009500 DATA DIVISION.
009600 FILE SECTION.
009700P
009800PFD  RAW-DATA.
009900P
010000P01  RAW-DATA-SATZ.
010100P    05  RAW-DATA-KEY        PIC X(6).
010200P    05  C-DATE              PIC 9(6).
010300P    05  C-TIME              PIC 9(8).
010400P    05  C-NO-OF-TESTS       PIC 99.
010500P    05  C-OK                PIC 999.
010600P    05  C-ALL               PIC 999.
010700P    05  C-FAIL              PIC 999.
010800P    05  C-DELETED           PIC 999.
010900P    05  C-INSPECT           PIC 999.
011000P    05  C-NOTE              PIC X(13).
011100P    05  C-INDENT            PIC X.
011200P    05  C-ABORT             PIC X(8).
011300 FD  PRINT-FILE.
011400 01  PRINT-REC PICTURE X(120).
011500 01  DUMMY-RECORD PICTURE X(120).
011600
011700 FD  IX-FS1
011800C    LABEL RECORD IS STANDARD
011900C    DATA RECORD IS IX-FS1R1-F-G-240
012000     BLOCK CONTAINS 1 RECORDS
012100     RECORD CONTAINS 240 CHARACTERS.
012200 01  IX-FS1R1-F-G-240.
012300     03 IX-FS1-WRK-120 PIC X(120).
012400     03 IX-FS1-GRP-120.
012500     05 FILLER   PIC   X(8).
012600     05 IX-FS1-KEY  PIC X(29).
012700     05 FILLER PIC X(83).
012800
012900 FD  IX-FS2
013000C    LABEL RECORD IS STANDARD
013100C    DATA RECORD IS IX-FS2R1-F-G-240
013200     BLOCK CONTAINS 1 RECORDS
013300     RECORD CONTAINS 240 CHARACTERS.
013400 01  IX-FS2R1-F-G-240.
013500     03 IX-FS2-WRK-120 PIC X(120).
013600     03 IX-FS2-GRP-120.
013700     05 FILLER   PIC   X(8).
013800     05 IX-FS2-KEY  PIC X(29).
013900     05 FILLER PIC X(83).
014000
014100 WORKING-STORAGE SECTION.
014200 01  EOF-FLAG                PIC 9 VALUE ZERO.
014300
014400 01  IX-FS1-STATUS.
014500     05  IX-FS1-STAT1        PIC X.
014600     05  IX-FS1-STAT2        PIC X.
014700
014800 01  IX-FS2-STATUS.
014900     05  IX-FS2-STAT1        PIC X.
015000     05  IX-FS2-STAT2        PIC X.
015100
015200 01  TEST-RESULTS.
015300     02 FILLER                   PIC X      VALUE SPACE.
015400     02 FEATURE                  PIC X(20)  VALUE SPACE.
015500     02 FILLER                   PIC X      VALUE SPACE.
015600     02 P-OR-F                   PIC X(5)   VALUE SPACE.
015700     02 FILLER                   PIC X      VALUE SPACE.
015800     02  PAR-NAME.
015900       03 FILLER                 PIC X(19)  VALUE SPACE.
016000       03  PARDOT-X              PIC X      VALUE SPACE.
016100       03 DOTVALUE               PIC 99     VALUE ZERO.
016200     02 FILLER                   PIC X(8)   VALUE SPACE.
016300     02 RE-MARK                  PIC X(61).
016400 01  TEST-COMPUTED.
016500     02 FILLER                   PIC X(30)  VALUE SPACE.
016600     02 FILLER                   PIC X(17)  VALUE
016700            "       COMPUTED=".
016800     02 COMPUTED-X.
016900     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
017000     03 COMPUTED-N               REDEFINES COMPUTED-A
017100                                 PIC -9(9).9(9).
017200     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
017300     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
017400     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
017500     03       CM-18V0 REDEFINES COMPUTED-A.
017600         04 COMPUTED-18V0                    PIC -9(18).
017700         04 FILLER                           PIC X.
017800     03 FILLER PIC X(50) VALUE SPACE.
017900 01  TEST-CORRECT.
018000     02 FILLER PIC X(30) VALUE SPACE.
018100     02 FILLER PIC X(17) VALUE "       CORRECT =".
018200     02 CORRECT-X.
018300     03 CORRECT-A                  PIC X(20) VALUE SPACE.
018400     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
018500     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
018600     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
018700     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
018800     03      CR-18V0 REDEFINES CORRECT-A.
018900         04 CORRECT-18V0                     PIC -9(18).
019000         04 FILLER                           PIC X.
019100     03 FILLER PIC X(2) VALUE SPACE.
019200     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
019300 01  CCVS-C-1.
019400     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
019500-    "SS  PARAGRAPH-NAME
019600-    "       REMARKS".
019700     02 FILLER                     PIC X(20)    VALUE SPACE.
019800 01  CCVS-C-2.
019900     02 FILLER                     PIC X        VALUE SPACE.
020000     02 FILLER                     PIC X(6)     VALUE "TESTED".
020100     02 FILLER                     PIC X(15)    VALUE SPACE.
020200     02 FILLER                     PIC X(4)     VALUE "FAIL".
020300     02 FILLER                     PIC X(94)    VALUE SPACE.
020400 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
020500 01  REC-CT                        PIC 99       VALUE ZERO.
020600 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
020700 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
020800 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
020900 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
021000 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
021100 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
021200 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
021300 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
021400 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
021500 01  CCVS-H-1.
021600     02  FILLER                    PIC X(39)    VALUE SPACES.
021700     02  FILLER                    PIC X(42)    VALUE
021800     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
021900     02  FILLER                    PIC X(39)    VALUE SPACES.
022000 01  CCVS-H-2A.
022100   02  FILLER                        PIC X(40)  VALUE SPACE.
022200   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
022300   02  FILLER                        PIC XXXX   VALUE
022400     "4.2 ".
022500   02  FILLER                        PIC X(28)  VALUE
022600            " COPY - NOT FOR DISTRIBUTION".
022700   02  FILLER                        PIC X(41)  VALUE SPACE.
022800
022900 01  CCVS-H-2B.
023000   02  FILLER                        PIC X(15)  VALUE
023100            "TEST RESULT OF ".
023200   02  TEST-ID                       PIC X(9).
023300   02  FILLER                        PIC X(4)   VALUE
023400            " IN ".
023500   02  FILLER                        PIC X(12)  VALUE
023600     " HIGH       ".
023700   02  FILLER                        PIC X(22)  VALUE
023800            " LEVEL VALIDATION FOR ".
023900   02  FILLER                        PIC X(58)  VALUE
024000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024100 01  CCVS-H-3.
024200     02  FILLER                      PIC X(34)  VALUE
024300            " FOR OFFICIAL USE ONLY    ".
024400     02  FILLER                      PIC X(58)  VALUE
024500     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
024600     02  FILLER                      PIC X(28)  VALUE
024700            "  COPYRIGHT   1985 ".
024800 01  CCVS-E-1.
024900     02 FILLER                       PIC X(52)  VALUE SPACE.
025000     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
025100     02 ID-AGAIN                     PIC X(9).
025200     02 FILLER                       PIC X(45)  VALUE SPACES.
025300 01  CCVS-E-2.
025400     02  FILLER                      PIC X(31)  VALUE SPACE.
025500     02  FILLER                      PIC X(21)  VALUE SPACE.
025600     02 CCVS-E-2-2.
025700         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
025800         03 FILLER                   PIC X      VALUE SPACE.
025900         03 ENDER-DESC               PIC X(44)  VALUE
026000            "ERRORS ENCOUNTERED".
026100 01  CCVS-E-3.
026200     02  FILLER                      PIC X(22)  VALUE
026300            " FOR OFFICIAL USE ONLY".
026400     02  FILLER                      PIC X(12)  VALUE SPACE.
026500     02  FILLER                      PIC X(58)  VALUE
026600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
026700     02  FILLER                      PIC X(13)  VALUE SPACE.
026800     02 FILLER                       PIC X(15)  VALUE
026900             " COPYRIGHT 1985".
027000 01  CCVS-E-4.
027100     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
027200     02 FILLER                       PIC X(4)   VALUE " OF ".
027300     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
027400     02 FILLER                       PIC X(40)  VALUE
027500      "  TESTS WERE EXECUTED SUCCESSFULLY".
027600 01  XXINFO.
027700     02 FILLER                       PIC X(19)  VALUE
027800            "*** INFORMATION ***".
027900     02 INFO-TEXT.
028000       04 FILLER                     PIC X(8)   VALUE SPACE.
028100       04 XXCOMPUTED                 PIC X(20).
028200       04 FILLER                     PIC X(5)   VALUE SPACE.
028300       04 XXCORRECT                  PIC X(20).
028400     02 INF-ANSI-REFERENCE           PIC X(48).
028500 01  HYPHEN-LINE.
028600     02 FILLER  PIC IS X VALUE IS SPACE.
028700     02 FILLER  PIC IS X(65)    VALUE IS "************************
028800-    "*****************************************".
028900     02 FILLER  PIC IS X(54)    VALUE IS "************************
029000-    "******************************".
029100 01  CCVS-PGM-ID                     PIC X(9)   VALUE
029200     "IX218A".
029300 PROCEDURE DIVISION.
029400 DECLARATIVES.
029500
029600 READ-OPTIONAL-10 SECTION.
029700     USE AFTER EXCEPTION PROCEDURE ON IX-FS1.
029800 INPUT-PROCESS.
029900     MOVE 1 TO EOF-FLAG.
030000
030100 READ-OPTIONAL-23 SECTION.
030200     USE AFTER EXCEPTION PROCEDURE ON IX-FS2.
030300 INPUT-PROCESS.
030400     MOVE 1 TO EOF-FLAG.
030500
030600 END DECLARATIVES.
030700
030800 CCVS1 SECTION.
030900 OPEN-FILES.
031000P    OPEN I-O RAW-DATA.
031100P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
031200P    READ RAW-DATA INVALID KEY GO TO END-E-1.
031300P    MOVE "ABORTED " TO C-ABORT.
031400P    ADD 1 TO C-NO-OF-TESTS.
031500P    ACCEPT C-DATE  FROM DATE.
031600P    ACCEPT C-TIME  FROM TIME.
031700P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
031800PEND-E-1.
031900P    CLOSE RAW-DATA.
032000     OPEN    OUTPUT PRINT-FILE.
032100     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
032200     MOVE    SPACE TO TEST-RESULTS.
032300     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
032400     GO TO CCVS1-EXIT.
032500 CLOSE-FILES.
032600P    OPEN I-O RAW-DATA.
032700P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
032800P    READ RAW-DATA INVALID KEY GO TO END-E-2.
032900P    MOVE "OK.     " TO C-ABORT.
033000P    MOVE PASS-COUNTER TO C-OK.
033100P    MOVE ERROR-HOLD   TO C-ALL.
033200P    MOVE ERROR-COUNTER TO C-FAIL.
033300P    MOVE DELETE-COUNTER TO C-DELETED.
033400P    MOVE INSPECT-COUNTER TO C-INSPECT.
033500P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
033600PEND-E-2.
033700P    CLOSE RAW-DATA IX-FS1 IX-FS2.
033800     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
033900 TERMINATE-CCVS.
034000S    EXIT PROGRAM.
034100STERMINATE-CALL.
034200     STOP     RUN.
034300 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
034400 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
034500 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
034600 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
034700     MOVE "****TEST DELETED****" TO RE-MARK.
034800 PRINT-DETAIL.
034900     IF REC-CT NOT EQUAL TO ZERO
035000             MOVE "." TO PARDOT-X
035100             MOVE REC-CT TO DOTVALUE.
035200     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
035300     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
035400        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
035500          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
035600     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
035700     MOVE SPACE TO CORRECT-X.
035800     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
035900     MOVE     SPACE TO RE-MARK.
036000 HEAD-ROUTINE.
036100     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036200     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036300     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
036400     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
036500 COLUMN-NAMES-ROUTINE.
036600     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036700     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
036900 END-ROUTINE.
037000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
037100 END-RTN-EXIT.
037200     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037300 END-ROUTINE-1.
037400      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
037500      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
037600      ADD PASS-COUNTER TO ERROR-HOLD.
037700*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
037800      MOVE PASS-COUNTER TO CCVS-E-4-1.
037900      MOVE ERROR-HOLD TO CCVS-E-4-2.
038000      MOVE CCVS-E-4 TO CCVS-E-2-2.
038100      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
038200  END-ROUTINE-12.
038300      MOVE "TEST(S) FAILED" TO ENDER-DESC.
038400     IF       ERROR-COUNTER IS EQUAL TO ZERO
038500         MOVE "NO " TO ERROR-TOTAL
038600         ELSE
038700         MOVE ERROR-COUNTER TO ERROR-TOTAL.
038800     MOVE     CCVS-E-2 TO DUMMY-RECORD.
038900     PERFORM WRITE-LINE.
039000 END-ROUTINE-13.
039100     IF DELETE-COUNTER IS EQUAL TO ZERO
039200         MOVE "NO " TO ERROR-TOTAL  ELSE
039300         MOVE DELETE-COUNTER TO ERROR-TOTAL.
039400     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
039500     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
039600      IF   INSPECT-COUNTER EQUAL TO ZERO
039700          MOVE "NO " TO ERROR-TOTAL
039800      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
039900      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
040000      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
040100     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
040200 WRITE-LINE.
040300     ADD 1 TO RECORD-COUNT.
040400Y    IF RECORD-COUNT GREATER 42
040500Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
040600Y        MOVE SPACE TO DUMMY-RECORD
040700Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
040800Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
040900Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
041000Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
041100Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
041200Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
041300Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
041400Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
041500Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
041600Y        MOVE ZERO TO RECORD-COUNT.
041700     PERFORM WRT-LN.
041800 WRT-LN.
041900     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
042000     MOVE SPACE TO DUMMY-RECORD.
042100 BLANK-LINE-PRINT.
042200     PERFORM WRT-LN.
042300 FAIL-ROUTINE.
042400     IF     COMPUTED-X NOT EQUAL TO SPACE
042500            GO TO   FAIL-ROUTINE-WRITE.
042600     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
042700     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
042800     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
042900     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043000     MOVE   SPACES TO INF-ANSI-REFERENCE.
043100     GO TO  FAIL-ROUTINE-EX.
043200 FAIL-ROUTINE-WRITE.
043300     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
043400     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
043500     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
043600     MOVE   SPACES TO COR-ANSI-REFERENCE.
043700 FAIL-ROUTINE-EX. EXIT.
043800 BAIL-OUT.
043900     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
044000     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
044100 BAIL-OUT-WRITE.
044200     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
044300     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
044400     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044500     MOVE   SPACES TO INF-ANSI-REFERENCE.
044600 BAIL-OUT-EX. EXIT.
044700 CCVS1-EXIT.
044800     EXIT.
044900
045000******************************************************************
045100*   TEST  1                                                      *
045200*         READ   (ACCESS IS SEQUENTIAL) OPTIONAL NOT EXISTING FILE
045300*                                       10  EXPECTED             *
045400*         IX-4, 1.3.4 (2) A 2);                                  *
045500*         IX-29, 4.5.4 GR (4) B;                                 *
045600*         IX-30, 4.5.4 GR (10) A;                                *
045700*         IX-30, 4.5.4 GR (10) B;                                *
045800******************************************************************
045900 SECT-IX-01-001 SECTION.
046000 REA-INIT-F1-01.
046100     MOVE ZERO TO EOF-FLAG.
046200     MOVE SPACES TO IX-FS1-STATUS.
046300     MOVE "READ OPTION. 10 EXP." TO FEATURE.
046400     MOVE "REA-TEST-F1-01      " TO PAR-NAME.
046500     OPEN INPUT IX-FS1.
046600 REA-TEST-F1-01.
046700     READ IX-FS1 AT END   GO TO REA-TEST-F1-01-1.
046800 REA-TEST-F1-01-1.
046900     IF IX-FS1-STATUS EQUAL TO "10"
047000         GO TO REA-PASS-F1-01.
047100 REA-FAIL-F1-01.
047200     MOVE "IX-4, 1.3.4, (2) A 2); IX-29 GR (4) B  IX-30 GR (10) A,
047300-         " B"                   TO RE-MARK.
047400     PERFORM FAIL.
047500     MOVE IX-FS1-STATUS TO COMPUTED-A.
047600     MOVE "10" TO CORRECT-X.
047700     GO TO REA-WRITE-F1-01.
047800 REA-PASS-F1-01.
047900     PERFORM PASS.
048000 REA-WRITE-F1-01.
048100     PERFORM PRINT-DETAIL.
048200
048300******************************************************************
048400*   TEST  2                                                      *
048500*         READ I-O  (ACCESS IS DYNAMIC) OPTIONAL NOT EXISTING FILE
048600*                                                                *
048700*         IX-30, GR (10) B                                       *
048800******************************************************************
048900 REA-INIT-GF-02.
049000     MOVE "REA-TEST-GF-02  " TO PAR-NAME.
049100     MOVE "NO USE MUST BE EXEC." TO FEATURE.
049200 REA-TEST-GF-02.
049300     IF EOF-FLAG EQUAL TO    0
049400         GO TO REA-PASS-GF-02.
049500 REA-FAIL-GF-02.
049600     MOVE "IX-30, GR (10) B; 1: USE PROCEDURE HAS BEEN  EXECUTED"
049700              TO RE-MARK.
049800     PERFORM FAIL.
049900     MOVE EOF-FLAG      TO COMPUTED-N.
050000     MOVE " 0" TO CORRECT-X.
050100     GO TO REA-WRITE-GF-02.
050200 REA-PASS-GF-02.
050300     PERFORM PASS.
050400 REA-WRITE-GF-02.
050500     PERFORM PRINT-DETAIL.
050600
050700******************************************************************
050800*   TEST  3                                                      *
050900*         START   (FOR AN OPTIONAL FILE WHICH IS NOT PRESENT)    *
051000*         IX-4, 1.3.4 (3) C 2)          23  EXPECTED             *
051100******************************************************************
051200 STA-INIT-GF-01.
051300     MOVE ZERO TO EOF-FLAG.
051400     MOVE SPACES TO IX-FS2-STATUS.
051500     MOVE "STA-TEST-GF-01  " TO PAR-NAME.
051600     MOVE "START OPT.   23 EXP." TO FEATURE.
051700     OPEN INPUT IX-FS2.
051800 STA-TEST-GF-01.
051900     START IX-FS2        INVALID  KEY GO TO STA-TEST-GF-01-1.
052000 STA-TEST-GF-01-1.
052100     IF IX-FS2-STATUS EQUAL TO "23"
052200         GO TO STA-PASS-GF-01.
052300 STA-FAIL-GF-01.
052400     MOVE "IX-4, 1.3.4,(3) C 2)" TO RE-MARK.
052500     PERFORM FAIL.
052600     MOVE IX-FS2-STATUS TO COMPUTED-A.
052700     MOVE "23" TO CORRECT-X.
052800     GO TO STA-WRITE-GF-01.
052900 STA-PASS-GF-01.
053000     PERFORM PASS.
053100 STA-WRITE-GF-01.
053200     PERFORM PRINT-DETAIL.
053300
053400******************************************************************
053500*   TEST  4                                                      *
053600*         START   (NO USE PROCEDURE MUST BE EXECUTED BECAUSE     *
053700*                  THE INVALID KEY PHRASE IS SPECIFIED)          *
053800*         IX-37, 4.7.4, (5), (6) AND (7)                         *
053900******************************************************************
054000 STA-INIT-GF-02.
054100     MOVE "STA-TEST-GF-02  " TO PAR-NAME.
054200     MOVE "START NO USE    EXP." TO FEATURE.
054300 STA-TEST-GF-02.
054400     IF EOF-FLAG  EQUAL TO ZERO
054500         GO TO STA-PASS-GF-02.
054600 STA-FAIL-GF-02.
054700     MOVE "IX-37 4.7.4,(5,6,7); 1:USE PROCEDURE HAS BEEN EXECUTED"
054800                                 TO RE-MARK.
054900     PERFORM FAIL.
055000     MOVE EOF-FLAG      TO COMPUTED-N.
055100     MOVE  "0" TO CORRECT-X.
055200     GO TO STA-WRITE-GF-02.
055300 STA-PASS-GF-02.
055400     PERFORM PASS.
055500 STA-WRITE-GF-02.
055600     PERFORM PRINT-DETAIL.
055700
055800******************************************************************
055900*   TEST  5                                                      *
056000*      READ (RANDOM) (FOR AN OPTIONAL FILE WHICH IS NOT PRESENT) *
056100*         IX-4, 1.3.4 (3) C 2)                                   *
056200******************************************************************
056300 REA-INIT-GF-03.
056400     MOVE ZERO TO EOF-FLAG.
056500     MOVE SPACES TO IX-FS2-STATUS.
056600     MOVE "REA-TEST-GF-03  " TO PAR-NAME.
056700     MOVE "RANDOM READ  23 EXP." TO FEATURE.
056800 REA-TEST-GF-03.
056900     READ  IX-FS2        INVALID  KEY GO TO REA-TEST-GF-03-1.
057000 REA-TEST-GF-03-1.
057100     IF IX-FS2-STATUS EQUAL TO "23"
057200         GO TO REA-PASS-GF-03.
057300 REA-FAIL-GF-03.
057400     MOVE "IX-4, 1.3.4,(3) C 2); IX-36 4.7.4,GR (1), (5), (6) AND
057500-         " (7)"                 TO RE-MARK.
057600     PERFORM FAIL.
057700     MOVE IX-FS2-STATUS TO COMPUTED-A.
057800     MOVE "23" TO CORRECT-X.
057900     GO TO REA-WRITE-GF-03.
058000 REA-PASS-GF-03.
058100     PERFORM PASS.
058200 REA-WRITE-GF-03.
058300     PERFORM PRINT-DETAIL.
058400
058500******************************************************************
058600*   TEST  6                                                      *
058700*         READ (RANDOM) NO USE PROCEDURE MUST BE EXECUTED BECAUSE*
058800*                  THE INVALID KEY PHRASE IS SPECIFIED)          *
058900*         IX-29, 4.5.4, GR (4) B, (17)                           *
059000******************************************************************
059100 REA-INIT-GF-04.
059200     MOVE "REA-TEST-GF-04  " TO PAR-NAME.
059300     MOVE "RANDOM READ (NO USE)" TO FEATURE.
059400 REA-TEST-GF-04.
059500     IF EOF-FLAG  EQUAL TO ZERO
059600         GO TO REA-PASS-GF-04.
059700 REA-FAIL-GF-04.
059800     MOVE "IX-29 4.5.4, GR (4) B, (17); 1: USE PROCEDURE HAS BEEN
059900-    "EXECUTED"             TO RE-MARK.
060000     PERFORM FAIL.
060100     MOVE EOF-FLAG      TO COMPUTED-N.
060200     MOVE  "0" TO CORRECT-X.
060300     GO TO REA-WRITE-GF-04.
060400 REA-PASS-GF-04.
060500     PERFORM PASS.
060600 REA-WRITE-GF-04.
060700     PERFORM PRINT-DETAIL.
060800
060900
061000
061100 CCVS-EXIT SECTION.
061200 CCVS-999999.
061300     GO TO CLOSE-FILES.
