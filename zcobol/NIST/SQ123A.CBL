000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ123A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
000900*                             REVISED 1986, AUGUST             *
001000*                                                              *
001100*    CREATION DATE     /     VALIDATION DATE                   *
001200*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001300*                                                              *
001400****************************************************************
001500*                                                              *
001600*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001700*                                                              *
001800*            X-14   SEQUENTIAL NON-UNIT MASS STORAGE FILE      *
001900*            X-55   SYSTEM PRINTER                             *
002000*            X-82   SOURCE-COMPUTER                            *
002100*            X-83   OBJECT-COMPUTER.                           *
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    THIS PROGRAM OPENS FOR OUTPUT A FILE WHICH IS ASSIGNED    *
002600*    TO A MEDIUM WHICH IS NOT A REEL/UNIT MEDIUM.  A CLOSE     *
002700*    REEL STATEMENT IS EXECUTED.  THIS SHOULD HAVE NO EFFECT   *
002800*    ON THE FILE, EXCEPT TO CAUSE I-O STATUS 07.  THE FILE     *
002900*    SHOULD REMAIN OPEN.  A NORMAL, UNQUALIFIED, CLOSE         *
003000*    STATEMENT IS THEN EXECUTED, WHICH SHOULD BE SUCCESSFUL    *
003100*    AND CLOSE THE FILE.  THERE IS AN ERROR DECLARATIVE FOR    *
003200*    THE FILE, WHICH SHOULD NOT BE ENTERED.                    *
003300*                                                              *
003400****************************************************************
003500*
003600 ENVIRONMENT DIVISION.
003700 CONFIGURATION SECTION.
003800 SOURCE-COMPUTER.
003900     XXXXX082.
004000 OBJECT-COMPUTER.
004100     XXXXX083.
004200*
004300 INPUT-OUTPUT SECTION.
004400 FILE-CONTROL.
004500     SELECT PRINT-FILE ASSIGN TO
004600     XXXXX055.
004700*
004800P    SELECT RAW-DATA   ASSIGN TO
004900P    XXXXX062
005000P          ORGANIZATION IS INDEXED
005100P          ACCESS MODE  IS RANDOM
005200P          RECORD-KEY   IS RAW-DATA-KEY.
005300P
005400     SELECT SQ-FS4 ASSIGN
005500     XXXXX014
005600            SEQUENTIAL
005700            ACCESS IS SEQUENTIAL
005800            STATUS IS SQ-FS4-STATUS.
005900*
006000*
006100 DATA DIVISION.
006200 FILE SECTION.
006300 FD  PRINT-FILE
006400C    LABEL RECORDS
006500C    XXXXX084
006600C    DATA RECORD IS PRINT-REC DUMMY-RECORD
006700               .
006800 01  PRINT-REC    PICTURE X(120).
006900 01  DUMMY-RECORD PICTURE X(120).
007000P
007100PFD  RAW-DATA.
007200P01  RAW-DATA-SATZ.
007300P    05  RAW-DATA-KEY        PIC X(6).
007400P    05  C-DATE              PIC 9(6).
007500P    05  C-TIME              PIC 9(8).
007600P    05  NO-OF-TESTS         PIC 99.
007700P    05  C-OK                PIC 999.
007800P    05  C-ALL               PIC 999.
007900P    05  C-FAIL              PIC 999.
008000P    05  C-DELETED           PIC 999.
008100P    05  C-INSPECT           PIC 999.
008200P    05  C-NOTE              PIC X(13).
008300P    05  C-INDENT            PIC X.
008400P    05  C-ABORT             PIC X(8).
008500*
008600 FD  SQ-FS4
008700C    LABEL RECORD IS STANDARD
008800                .
008900 01  SQ-FS4R1-F-G-120  PIC X(120).
009000*
009100 WORKING-STORAGE SECTION.
009200*
009300***************************************************************
009400*                                                             *
009500*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
009600*                                                             *
009700***************************************************************
009800*
009900 01  SQ-FS4-STATUS.
010000   03  SQ-FS4-KEY-1   PIC X.
010100   03  SQ-FS4-KEY-2   PIC X.
010200*
010300 01  DELETE-SW.
010400     03  DELETE-SW-1 PIC X.
010500     03  DELETE-SW-1-GROUP.
010600         05  DELETE-SW-2 PIC X.
010700*
010800 01  DECL-EXEC-I  PIC X(12).
010900 01  DECL-EXEC-O  PIC X(12).
011000 01  DECL-EXEC-SW PIC X.
011100*
011200***************************************************************
011300*                                                             *
011400*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
011500*                                                             *
011600***************************************************************
011700*
011800 01  REC-SKEL-SUB   PIC 99.
011900*
012000 01  FILE-RECORD-INFORMATION-REC.
012100     03 FILE-RECORD-INFO-SKELETON.
012200        05 FILLER                 PICTURE X(48)       VALUE
012300             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
012400        05 FILLER                 PICTURE X(46)       VALUE
012500             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
012600        05 FILLER                 PICTURE X(26)       VALUE
012700             ",LFIL=000000,ORG=  ,LBLR= ".
012800        05 FILLER                 PICTURE X(37)       VALUE
012900             ",RECKEY=                             ".
013000        05 FILLER                 PICTURE X(38)       VALUE
013100             ",ALTKEY1=                             ".
013200        05 FILLER                 PICTURE X(38)       VALUE
013300             ",ALTKEY2=                             ".
013400        05 FILLER                 PICTURE X(7)        VALUE SPACE.
013500     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
013600        05 FILE-RECORD-INFO-P1-120.
013700           07 FILLER              PIC X(5).
013800           07 XFILE-NAME          PIC X(6).
013900           07 FILLER              PIC X(8).
014000           07 XRECORD-NAME        PIC X(6).
014100           07 FILLER              PIC X(1).
014200           07 REELUNIT-NUMBER     PIC 9(1).
014300           07 FILLER              PIC X(7).
014400           07 XRECORD-NUMBER      PIC 9(6).
014500           07 FILLER              PIC X(6).
014600           07 UPDATE-NUMBER       PIC 9(2).
014700           07 FILLER              PIC X(5).
014800           07 ODO-NUMBER          PIC 9(4).
014900           07 FILLER              PIC X(5).
015000           07 XPROGRAM-NAME       PIC X(5).
015100           07 FILLER              PIC X(7).
015200           07 XRECORD-LENGTH      PIC 9(6).
015300           07 FILLER              PIC X(7).
015400           07 CHARS-OR-RECORDS    PIC X(2).
015500           07 FILLER              PIC X(1).
015600           07 XBLOCK-SIZE         PIC 9(4).
015700           07 FILLER              PIC X(6).
015800           07 RECORDS-IN-FILE     PIC 9(6).
015900           07 FILLER              PIC X(5).
016000           07 XFILE-ORGANIZATION  PIC X(2).
016100           07 FILLER              PIC X(6).
016200           07 XLABEL-TYPE         PIC X(1).
016300        05 FILE-RECORD-INFO-P121-240.
016400           07 FILLER              PIC X(8).
016500           07 XRECORD-KEY         PIC X(29).
016600           07 FILLER              PIC X(9).
016700           07 ALTERNATE-KEY1      PIC X(29).
016800           07 FILLER              PIC X(9).
016900           07 ALTERNATE-KEY2      PIC X(29).
017000           07 FILLER              PIC X(7).
017100*
017200 01  TEST-RESULTS.
017300     02 FILLER              PIC X      VALUE SPACE.
017400     02  PAR-NAME.
017500       03 FILLER              PIC X(14)  VALUE SPACE.
017600       03 PARDOT-X            PIC X      VALUE SPACE.
017700       03 DOTVALUE            PIC 99     VALUE ZERO.
017800     02 FILLER              PIC X      VALUE SPACE.
017900     02 FEATURE             PIC X(24)  VALUE SPACE.
018000     02 FILLER              PIC X      VALUE SPACE.
018100     02 P-OR-F              PIC X(5)   VALUE SPACE.
018200     02 FILLER              PIC X(9)   VALUE SPACE.
018300     02 RE-MARK             PIC X(61).
018400 01  TEST-COMPUTED.
018500   02 FILLER  PIC X(30)  VALUE SPACE.
018600   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
018700   02 COMPUTED-X.
018800     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
018900     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
019000     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
019100     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
019200     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
019300     03       CM-18V0 REDEFINES COMPUTED-A.
019400        04 COMPUTED-18V0                   PIC -9(18).
019500        04 FILLER                          PIC X.
019600     03 FILLER PIC X(50) VALUE SPACE.
019700 01  TEST-CORRECT.
019800     02 FILLER PIC X(30) VALUE SPACE.
019900     02 FILLER PIC X(17) VALUE "       CORRECT =".
020000     02 CORRECT-X.
020100     03 CORRECT-A                  PIC X(20) VALUE SPACE.
020200     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
020300     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
020400     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
020500     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
020600     03      CR-18V0 REDEFINES CORRECT-A.
020700         04 CORRECT-18V0                     PIC -9(18).
020800         04 FILLER                           PIC X.
020900     03 FILLER PIC X(2) VALUE SPACE.
021000     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
021100*
021200 01  CCVS-C-1.
021300     02 FILLER  PIC IS X        VALUE  SPACE.
021400     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
021500     02 FILLER  PIC IS X        VALUE  SPACE.
021600     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
021700     02 FILLER  PIC IS X        VALUE  SPACE.
021800     02 FILLER  PIC IS X(5)     VALUE "PASS ".
021900     02 FILLER  PIC IS X(9)     VALUE  SPACE.
022000     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
022100 01  CCVS-C-2.
022200     02 FILLER  PIC X(19)  VALUE  SPACE.
022300     02 FILLER  PIC X(6)   VALUE "TESTED".
022400     02 FILLER  PIC X(19)  VALUE  SPACE.
022500     02 FILLER  PIC X(4)   VALUE "FAIL".
022600     02 FILLER  PIC X(72)  VALUE  SPACE.
022700*
022800 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
022900 01  REC-CT            PIC 99       VALUE ZERO.
023000 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
023100 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
023200 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
023300 01  PASS-COUNTER      PIC 999      VALUE ZERO.
023400 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
023500 01  ERROR-HOLD        PIC 999      VALUE ZERO.
023600 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
023700 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
023800 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
023900 01  CCVS-H-1.
024000     02  FILLER          PIC X(39)    VALUE SPACES.
024100     02  FILLER          PIC X(42)    VALUE
024200     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
024300     02  FILLER          PIC X(39)    VALUE SPACES.
024400 01  CCVS-H-2A.
024500   02  FILLER            PIC X(40)  VALUE SPACE.
024600   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
024700   02  FILLER            PIC XXXX   VALUE
024800     "4.2 ".
024900   02  FILLER            PIC X(28)  VALUE
025000            " COPY - NOT FOR DISTRIBUTION".
025100   02  FILLER            PIC X(41)  VALUE SPACE.
025200*
025300 01  CCVS-H-2B.
025400   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
025500   02  TEST-ID           PIC X(9).
025600   02  FILLER            PIC X(4)   VALUE " IN ".
025700   02  FILLER            PIC X(12)  VALUE
025800     " HIGH       ".
025900   02  FILLER            PIC X(22)  VALUE
026000            " LEVEL VALIDATION FOR ".
026100   02  FILLER            PIC X(58)  VALUE
026200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
026300 01  CCVS-H-3.
026400     02  FILLER          PIC X(34)  VALUE
026500            " FOR OFFICIAL USE ONLY    ".
026600     02  FILLER          PIC X(58)  VALUE
026700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
026800     02  FILLER          PIC X(28)  VALUE
026900            "  COPYRIGHT   1985,1986 ".
027000 01  CCVS-E-1.
027100     02 FILLER           PIC X(52)  VALUE SPACE.
027200     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
027300     02 ID-AGAIN         PIC X(9).
027400     02 FILLER           PIC X(45)  VALUE SPACES.
027500 01  CCVS-E-2.
027600     02  FILLER          PIC X(31)  VALUE SPACE.
027700     02  FILLER          PIC X(21)  VALUE SPACE.
027800     02  CCVS-E-2-2.
027900         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
028000         03 FILLER         PIC X      VALUE SPACE.
028100         03 ENDER-DESC     PIC X(44)  VALUE
028200            "ERRORS ENCOUNTERED".
028300 01  CCVS-E-3.
028400     02  FILLER          PIC X(22)  VALUE
028500            " FOR OFFICIAL USE ONLY".
028600     02  FILLER          PIC X(12)  VALUE SPACE.
028700     02  FILLER          PIC X(58)  VALUE
028800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
028900     02  FILLER          PIC X(8)   VALUE SPACE.
029000     02  FILLER          PIC X(20)  VALUE
029100             " COPYRIGHT 1985,1986".
029200 01  CCVS-E-4.
029300     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
029400     02 FILLER           PIC X(4)   VALUE " OF ".
029500     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
029600     02 FILLER           PIC X(40)  VALUE
029700      "  TESTS WERE EXECUTED SUCCESSFULLY".
029800 01  XXINFO.
029900     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
030000     02 INFO-TEXT.
030100       04 FILLER             PIC X(8)   VALUE SPACE.
030200       04 XXCOMPUTED         PIC X(20).
030300       04 FILLER             PIC X(5)   VALUE SPACE.
030400       04 XXCORRECT          PIC X(20).
030500     02 INF-ANSI-REFERENCE PIC X(48).
030600 01  HYPHEN-LINE.
030700     02 FILLER  PIC IS X VALUE IS SPACE.
030800     02 FILLER  PIC IS X(65)    VALUE IS "************************
030900-    "*****************************************".
031000     02 FILLER  PIC IS X(54)    VALUE IS "************************
031100-    "******************************".
031200 01  CCVS-PGM-ID  PIC X(9)   VALUE
031300     "SQ123A".
031400*
031500*
031600 PROCEDURE DIVISION.
031700 DECLARATIVES.
031800*
031900*    FIRST, A DECLARATIVE FOR THE PRINT FILE, IN CASE THERE
032000*    IS AN ERROR ON PRINTING DURING EXECUTION OF THE OUTPUT
032100*    DECLARATIVE.  PAGE VII-51, 4.6.4(7) STATES THAT THE
032200*    INVOCATION OF THE SAME DECLARATIVE TWICE IS ILLEGAL.
032300*
032400 SECT-SQ123A-0000 SECTION.
032500     USE AFTER STANDARD ERROR PROCEDURE ON PRINT-FILE.
032600 PRINT-FILE-ERROR-PROCESS.
032700     EXIT.
032800*
032900 SECT-SQ123A-0001 SECTION.
033000     USE AFTER EXCEPTION PROCEDURE INPUT.
033100 INPUT-ERROR-PROCESS.
033200     MOVE   "EXECUTED" TO DECL-EXEC-I.
033300*
033400 SECT-SQ123A-0002 SECTION.
033500     USE AFTER STANDARD EXCEPTION PROCEDURE OUTPUT.
033600 OUTPUT-ERROR-PROCESS.
033700     MOVE   "EXECUTED" TO DECL-EXEC-O.
033800*
033900     IF DECL-EXEC-SW NOT = SPACE
034000         GO TO   END-DECLS.
034100*
034200     MOVE    1 TO REC-CT.
034300     MOVE   "CLOSE AFTER CLOSE REEL"  TO FEATURE.
034400     MOVE   "DECL-CLOSE-02" TO PAR-NAME.
034500     GO TO   DECL-CLOSE-02.
034600 DECL-DELETE-02.
034700     PERFORM DECL-DE-LETE.
034800     GO TO   DECL-TEST-01-END.
034900 DECL-CLOSE-02.
035000     MOVE    SQ-FS4-STATUS TO COMPUTED-A
035100     MOVE   "00" TO CORRECT-A
035200     MOVE   "DECLARATIVE ENTERED ON CLOSE OF FILE WHICH IS OPEN"
035300               TO RE-MARK
035400     MOVE   "VII-3, VII-38,4.2.4(3)F" TO ANSI-REFERENCE
035500     PERFORM DECL-FAIL.
035600 DECL-TEST-01-END.
035700*
035800     GO TO   END-DECLS.
035900*
036000*
036100 DECL-PASS.
036200     MOVE   "PASS " TO P-OR-F.
036300     ADD     1 TO PASS-COUNTER.
036400     PERFORM DECL-PRINT-DETAIL.
036500*
036600 DECL-FAIL.
036700     MOVE   "FAIL*" TO P-OR-F.
036800     ADD     1 TO ERROR-COUNTER.
036900     PERFORM DECL-PRINT-DETAIL.
037000*
037100 DECL-DE-LETE.
037200     MOVE   "****TEST DELETED****" TO RE-MARK.
037300     MOVE   "*****" TO P-OR-F.
037400     ADD     1 TO DELETE-COUNTER.
037500     PERFORM DECL-PRINT-DETAIL.
037600*
037700 DECL-PRINT-DETAIL.
037800     IF REC-CT NOT EQUAL TO ZERO
037900             MOVE "." TO PARDOT-X
038000             MOVE REC-CT TO DOTVALUE.
038100     MOVE    TEST-RESULTS TO PRINT-REC.
038200     PERFORM DECL-WRITE-LINE.
038300     IF P-OR-F EQUAL TO "FAIL*"
038400         PERFORM DECL-WRITE-LINE
038500         PERFORM DECL-FAIL-ROUTINE THRU DECL-FAIL-EX
038600     ELSE
038700         PERFORM DECL-BAIL THRU DECL-BAIL-EX.
038800     MOVE    SPACE TO P-OR-F.
038900     MOVE    SPACE TO COMPUTED-X.
039000     MOVE    SPACE TO CORRECT-X.
039100     IF REC-CT EQUAL TO ZERO
039200         MOVE    SPACE TO PAR-NAME.
039300     MOVE    SPACE TO RE-MARK.
039400*
039500 DECL-WRITE-LINE.
039600     ADD     1 TO RECORD-COUNT.
039700Y    IF RECORD-COUNT GREATER 50
039800Y        MOVE    DUMMY-RECORD TO DUMMY-HOLD
039900Y        MOVE    SPACE TO DUMMY-RECORD
040000Y        WRITE   DUMMY-RECORD AFTER ADVANCING PAGE
040100Y        MOVE    CCVS-C-1 TO DUMMY-RECORD PERFORM DECL-WRT-LN
040200Y        MOVE    CCVS-C-2 TO DUMMY-RECORD
040300Y        PERFORM DECL-WRT-LN 2 TIMES
040400Y        MOVE    HYPHEN-LINE TO DUMMY-RECORD
040500Y        PERFORM DECL-WRT-LN
040600Y        MOVE    DUMMY-HOLD TO DUMMY-RECORD
040700Y        MOVE    ZERO TO RECORD-COUNT.
040800     PERFORM DECL-WRT-LN.
040900*
041000 DECL-WRT-LN.
041100     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
041200     MOVE    SPACE TO DUMMY-RECORD.
041300*
041400 DECL-FAIL-ROUTINE.
041500     IF COMPUTED-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
041600     IF CORRECT-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
041700     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
041800     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
041900     MOVE    XXINFO TO DUMMY-RECORD.
042000     PERFORM DECL-WRITE-LINE 2 TIMES.
042100     MOVE    SPACES TO INF-ANSI-REFERENCE.
042200     GO TO   DECL-FAIL-EX.
042300 DECL-FAIL-WRITE.
042400     MOVE    TEST-COMPUTED TO PRINT-REC
042500     PERFORM DECL-WRITE-LINE
042600     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
042700     MOVE    TEST-CORRECT TO PRINT-REC
042800     PERFORM DECL-WRITE-LINE 2 TIMES.
042900     MOVE    SPACES TO COR-ANSI-REFERENCE.
043000 DECL-FAIL-EX.
043100     EXIT.
043200*
043300 DECL-BAIL.
043400     IF COMPUTED-A NOT EQUAL TO SPACE GO TO DECL-BAIL-WRITE.
043500     IF CORRECT-A EQUAL TO SPACE GO TO DECL-BAIL-EX.
043600 DECL-BAIL-WRITE.
043700     MOVE    CORRECT-A TO XXCORRECT.
043800     MOVE    COMPUTED-A TO XXCOMPUTED.
043900     MOVE    XXINFO TO DUMMY-RECORD.
044000     PERFORM DECL-WRITE-LINE 2 TIMES.
044100 DECL-BAIL-EX.
044200     EXIT.
044300*
044400 END-DECLS.
044500 END DECLARATIVES.
044600*
044700*
044800 CCVS1 SECTION.
044900 OPEN-FILES.
045000P    OPEN    I-O RAW-DATA.
045100P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
045200P    READ    RAW-DATA INVALID KEY GO TO END-E-1.
045300P    MOVE   "ABORTED "   TO C-ABORT.
045400P    ADD     1           TO C-NO-OF-TESTS.
045500P    ACCEPT  C-DATE      FROM DATE.
045600P    ACCEPT  C-TIME      FROM TIME.
045700P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
045800PEND-E-1.
045900P    CLOSE   RAW-DATA.
046000     OPEN    OUTPUT PRINT-FILE.
046100     MOVE    CCVS-PGM-ID TO TEST-ID.
046200     MOVE    CCVS-PGM-ID TO ID-AGAIN.
046300     MOVE    SPACE TO TEST-RESULTS.
046400     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
046500     MOVE    ZERO TO REC-SKEL-SUB.
046600     PERFORM CCVS-INIT-FILE 10 TIMES.
046700     GO TO CCVS1-EXIT.
046800*
046900 CCVS-INIT-FILE.
047000     ADD     1 TO REC-SKL-SUB.
047100     MOVE    FILE-RECORD-INFO-SKELETON TO
047200                  FILE-RECORD-INFO (REC-SKL-SUB).
047300*
047400 CLOSE-FILES.
047500     PERFORM END-ROUTINE THRU END-ROUTINE-13.
047600     CLOSE   PRINT-FILE.
047700P    OPEN    I-O RAW-DATA.
047800P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
047900P    READ    RAW-DATA INVALID KEY GO TO END-E-2.
048000P    MOVE   "OK.     " TO C-ABORT.
048100P    MOVE    PASS-COUNTER  TO C-OK.
048200P    MOVE    ERROR-HOLD    TO C-ALL.
048300P    MOVE    ERROR-COUNTER TO C-FAIL.
048400P    MOVE    DELETE-CNT    TO C-DELETED.
048500P    MOVE    INSPECT-COUNTER TO C-INSPECT.
048600P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
048700PEND-E-2.
048800P    CLOSE   RAW-DATA.
048900 TERMINATE-CCVS.
049000S    EXIT    PROGRAM.
049100     STOP    RUN.
049200*
049300 INSPT.
049400     MOVE   "INSPT" TO P-OR-F.
049500     ADD     1 TO INSPECT-COUNTER.
049600     PERFORM PRINT-DETAIL.
049700*
049800 PASS.
049900     MOVE   "PASS " TO P-OR-F.
050000     ADD     1 TO PASS-COUNTER.
050100     PERFORM PRINT-DETAIL.
050200*
050300 FAIL.
050400     MOVE   "FAIL*" TO P-OR-F.
050500     ADD     1 TO ERROR-COUNTER.
050600     PERFORM PRINT-DETAIL.
050700*
050800 DE-LETE.
050900     MOVE   "****TEST DELETED****" TO RE-MARK.
051000     MOVE   "*****" TO P-OR-F.
051100     ADD     1 TO DELETE-COUNTER.
051200     PERFORM PRINT-DETAIL.
051300*
051400 PRINT-DETAIL.
051500     IF REC-CT NOT EQUAL TO ZERO
051600         MOVE   "." TO PARDOT-X
051700         MOVE    REC-CT TO DOTVALUE.
051800     MOVE    TEST-RESULTS TO PRINT-REC.
051900     PERFORM WRITE-LINE.
052000     IF P-OR-F EQUAL TO "FAIL*"
052100         PERFORM WRITE-LINE
052200         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
052300     ELSE
052400         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
052500     MOVE    SPACE TO P-OR-F.
052600     MOVE    SPACE TO COMPUTED-X.
052700     MOVE    SPACE TO CORRECT-X.
052800     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
052900     MOVE    SPACE TO RE-MARK.
053000*
053100 HEAD-ROUTINE.
053200     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
053300     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
053400     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
053500     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
053600 COLUMN-NAMES-ROUTINE.
053700     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
053800     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
053900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
054000 END-ROUTINE.
054100     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
054200     PERFORM WRITE-LINE 5 TIMES.
054300 END-RTN-EXIT.
054400     MOVE    CCVS-E-1 TO DUMMY-RECORD.
054500     PERFORM WRITE-LINE 2 TIMES.
054600*
054700 END-ROUTINE-1.
054800     ADD     ERROR-COUNTER   TO ERROR-HOLD
054900     ADD     INSPECT-COUNTER TO ERROR-HOLD.
055000     ADD     DELETE-COUNTER  TO ERROR-HOLD.
055100     ADD     PASS-COUNTER    TO ERROR-HOLD.
055200     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
055300     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
055400     MOVE    CCVS-E-4        TO CCVS-E-2-2.
055500     MOVE    CCVS-E-2        TO DUMMY-RECORD
055600     PERFORM WRITE-LINE.
055700     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
055800     IF ERROR-COUNTER IS EQUAL TO ZERO
055900         MOVE   "NO " TO ERROR-TOTAL
056000     ELSE
056100         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
056200     MOVE    CCVS-E-2 TO DUMMY-RECORD.
056300     PERFORM WRITE-LINE.
056400 END-ROUTINE-13.
056500     IF DELETE-COUNTER IS EQUAL TO ZERO
056600         MOVE   "NO " TO ERROR-TOTAL
056700     ELSE
056800         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
056900     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
057000     MOVE    CCVS-E-2 TO DUMMY-RECORD.
057100     PERFORM WRITE-LINE.
057200     IF INSPECT-COUNTER EQUAL TO ZERO
057300         MOVE   "NO " TO ERROR-TOTAL
057400     ELSE
057500         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
057600     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
057700     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
057800     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
057900*
058000 WRITE-LINE.
058100     ADD     1 TO RECORD-COUNT.
058200Y    IF RECORD-COUNT GREATER 50
058300Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
058400Y        MOVE  SPACE TO DUMMY-RECORD
058500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
058600Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
058700Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
058800Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
058900Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
059000Y        MOVE  ZERO TO RECORD-COUNT.
059100     PERFORM WRT-LN.
059200*
059300 WRT-LN.
059400     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
059500     MOVE    SPACE TO DUMMY-RECORD.
059600 BLANK-LINE-PRINT.
059700     PERFORM WRT-LN.
059800 FAIL-ROUTINE.
059900     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
060000     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
060100     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
060200     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
060300     MOVE    XXINFO TO DUMMY-RECORD.
060400     PERFORM WRITE-LINE 2 TIMES.
060500     MOVE    SPACES TO INF-ANSI-REFERENCE.
060600     GO TO   FAIL-ROUTINE-EX.
060700 FAIL-ROUTINE-WRITE.
060800     MOVE    TEST-COMPUTED  TO PRINT-REC
060900     PERFORM WRITE-LINE
061000     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
061100     MOVE    TEST-CORRECT   TO PRINT-REC
061200     PERFORM WRITE-LINE 2 TIMES.
061300     MOVE    SPACES         TO COR-ANSI-REFERENCE.
061400 FAIL-ROUTINE-EX.
061500     EXIT.
061600 BAIL-OUT.
061700     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
061800     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
061900 BAIL-OUT-WRITE.
062000     MOVE    CORRECT-A      TO XXCORRECT.
062100     MOVE    COMPUTED-A     TO XXCOMPUTED.
062200     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
062300     MOVE    XXINFO TO DUMMY-RECORD.
062400     PERFORM WRITE-LINE 2 TIMES.
062500     MOVE    SPACES TO INF-ANSI-REFERENCE.
062600 BAIL-OUT-EX.
062700     EXIT.
062800 CCVS1-EXIT.
062900     EXIT.
063000*
063100****************************************************************
063200*                                                              *
063300*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
063400*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
063500*                                                              *
063600****************************************************************
063700*
063800 SECT-SQ123A-0004 SECTION.
063900 STA-INIT.
064000     MOVE    SPACE TO DELETE-SW.
064100*
064200     MOVE   "SQ-FS4" TO XFILE-NAME (1).
064300     MOVE   "R1-F-G" TO XRECORD-NAME (1).
064400     MOVE    CCVS-PGM-ID TO XPROGRAM-NAME (1).
064500     MOVE    125 TO XRECORD-LENGTH (1).
064600     MOVE   "RC" TO CHARS-OR-RECORDS (1).
064700     MOVE    1   TO XBLOCK-SIZE (1).
064800     MOVE    0   TO RECORDS-IN-FILE (1).
064900     MOVE   "SQ" TO XFILE-ORGANIZATION (1).
065000     MOVE   "S"  TO XLABEL-TYPE (1).
065100     MOVE    ZERO TO XRECORD-NUMBER (1).
065200*
065300*    OPEN THE FILE IN THE OUTPUT MODE
065400*
065500 SEQ-INIT-01.
065600     MOVE    0 TO REC-CT.
065700     MOVE   "*"  TO DECL-EXEC-SW.
065800     MOVE   "**" TO SQ-FS4-STATUS.
065900     MOVE   "NOT EXECUTED" TO DECL-EXEC-I.
066000     MOVE   "NOT EXECUTED" TO DECL-EXEC-O.
066100     MOVE   "OPEN, CREATE FILE"  TO FEATURE.
066200     MOVE   "SEQ-TEST-OP-01" TO PAR-NAME.
066300     GO TO   SEQ-TEST-OP-01.
066400 SEQ-DELETE-01.
066500     MOVE   "*" TO DELETE-SW-1.
066600     GO TO   SEQ-DELETE-01-01.
066700 SEQ-TEST-OP-01.
066800     OPEN    OUTPUT SQ-FS4.
066900*
067000*    CHECK I-O STATUS RETURNED FROM OPEN OUTPUT
067100*
067200     ADD    1 TO REC-CT.
067300     IF DELETE-SW NOT = SPACE
067400         GO TO   SEQ-DELETE-01-01.
067500     GO TO   SEQ-TEST-OP-01-01.
067600 SEQ-DELETE-01-01.
067700     PERFORM DE-LETE.
067800     GO TO   SEQ-TEST-01-01-END.
067900 SEQ-TEST-OP-01-01.
068000     IF SQ-FS4-STATUS = "00"
068100         PERFORM PASS
068200     ELSE
068300         MOVE    SQ-FS4-STATUS TO COMPUTED-A
068400         MOVE   "00" TO CORRECT-A
068500         MOVE   "UNEXPECTED ERROR CODE FROM OPEN OUTPUT"
068600                   TO RE-MARK
068700         MOVE   "VII-3, VII-23" TO ANSI-REFERENCE
068800         PERFORM FAIL.
068900 SEQ-TEST-01-01-END.
069000*
069100*    CHECK EXECUTION OF INPUT DECLARATIVE
069200*
069300     ADD     1 TO REC-CT.
069400     IF DELETE-SW NOT = SPACE
069500         GO TO   SEQ-DELETE-01-02.
069600     GO TO   SEQ-TEST-OP-01-02.
069700 SEQ-DELETE-01-02.
069800     PERFORM DE-LETE.
069900     GO TO   SEQ-TEST-01-02-END.
070000 SEQ-TEST-OP-01-02.
070100     IF DECL-EXEC-I = "NOT EXECUTED"
070200         PERFORM PASS
070300     ELSE
070400         MOVE    DECL-EXEC-I TO COMPUTED-A
070500         MOVE   "NOT EXECUTED" TO CORRECT-A
070600         MOVE   "UNEXPECTED EXECUTION OF INPUT DECLARATIVE"
070700                   TO RE-MARK
070800         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
070900         PERFORM FAIL.
071000 SEQ-TEST-01-02-END.
071100*
071200*    CHECK EXECUTION OF OUTPUT DECLARATIVE
071300*
071400     ADD     1 TO REC-CT.
071500     IF DELETE-SW NOT = SPACE
071600         GO TO   SEQ-DELETE-01-03.
071700     GO TO   SEQ-TEST-OP-01-03.
071800 SEQ-DELETE-01-03.
071900     PERFORM DE-LETE.
072000     GO TO   SEQ-TEST-01-03-END.
072100 SEQ-TEST-OP-01-03.
072200     IF DECL-EXEC-O = "NOT EXECUTED"
072300         PERFORM PASS
072400     ELSE
072500         MOVE    DECL-EXEC-O TO COMPUTED-A
072600         MOVE   "NOT EXECUTED" TO CORRECT-A
072700         MOVE   "UNEXPECTED EXECUTION OF INPUT DECLARATIVE"
072800                   TO RE-MARK
072900         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
073000         PERFORM FAIL.
073100 SEQ-TEST-01-03-END.
073200*
073300*
073400*    THE FILE HAS BEEN CREATED.  WE NOW EXECUTE CLOSE REEL
073500*
073600 SEQ-INIT-02.
073700     MOVE    0 TO REC-CT.
073800     MOVE   "*"  TO DECL-EXEC-SW.
073900     MOVE   "**" TO SQ-FS4-STATUS.
074000     MOVE   "NOT EXECUTED" TO DECL-EXEC-I.
074100     MOVE   "NOT EXECUTED" TO DECL-EXEC-O.
074200     MOVE   "CLOSE REEL, NON-REEL"  TO FEATURE.
074300     MOVE   "SEQ-TEST-CR-02" TO PAR-NAME.
074400     IF DELETE-SW NOT EQUAL TO SPACE
074500         GO TO SEQ-DELETE-02.
074600     GO TO   SEQ-TEST-CR-02.
074700 SEQ-DELETE-02.
074800     MOVE   "*" TO DELETE-SW-2.
074900     GO TO   SEQ-DELETE-02-01.
075000 SEQ-TEST-CR-02.
075100     CLOSE   SQ-FS4 REEL.
075200*
075300*    CHECK I-O STATUS RETURNED FROM CLOSE REEL
075400*
075500     ADD    1 TO REC-CT.
075600     IF DELETE-SW NOT = SPACE
075700         GO TO   SEQ-DELETE-02-01.
075800     GO TO   SEQ-TEST-CR-02-01.
075900 SEQ-DELETE-02-01.
076000     PERFORM DE-LETE.
076100     GO TO   SEQ-TEST-02-01-END.
076200 SEQ-TEST-CR-02-01.
076300     IF SQ-FS4-STATUS = "07"
076400         PERFORM PASS
076500     ELSE
076600         MOVE    SQ-FS4-STATUS TO COMPUTED-A
076700         MOVE   "07" TO CORRECT-A
076800         MOVE   "UNEXPECTED I-O STATUS FROM CLOSE REEL"
076900                   TO RE-MARK
077000         MOVE   "VII-3, VII-38,4.2.4(3)F" TO ANSI-REFERENCE
077100         PERFORM FAIL.
077200 SEQ-TEST-02-01-END.
077300*
077400*    CHECK EXECUTION OF INPUT DECLARATIVE
077500*
077600     ADD     1 TO REC-CT.
077700     IF DELETE-SW NOT = SPACE
077800         GO TO   SEQ-DELETE-02-02.
077900     GO TO   SEQ-TEST-CR-02-02.
078000 SEQ-DELETE-02-02.
078100     PERFORM DE-LETE.
078200     GO TO   SEQ-TEST-02-02-END.
078300 SEQ-TEST-CR-02-02.
078400     IF DECL-EXEC-I = "NOT EXECUTED"
078500         PERFORM PASS
078600     ELSE
078700         MOVE    DECL-EXEC-I TO COMPUTED-A
078800         MOVE   "NOT EXECUTED" TO CORRECT-A
078900         MOVE   "UNEXPECTED EXECUTION OF INPUT DECLARATIVE"
079000                   TO RE-MARK
079100         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
079200         PERFORM FAIL.
079300 SEQ-TEST-02-02-END.
079400*
079500*    CHECK EXECUTION OF OUTPUT DECLARATIVE
079600*
079700     ADD     1 TO REC-CT.
079800     IF DELETE-SW NOT = SPACE
079900         GO TO   SEQ-DELETE-02-03.
080000     GO TO   SEQ-TEST-CR-02-03.
080100 SEQ-DELETE-02-03.
080200     PERFORM DE-LETE.
080300     GO TO   SEQ-TEST-02-03-END.
080400 SEQ-TEST-CR-02-03.
080500     IF DECL-EXEC-O = "NOT EXECUTED"
080600         PERFORM PASS
080700     ELSE
080800         MOVE    DECL-EXEC-O TO COMPUTED-A
080900         MOVE   "NOT EXECUTED" TO CORRECT-A
081000         MOVE   "UNEXPECTED EXECUTION OF OUTPUT DECLARATIVE"
081100                   TO RE-MARK
081200         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
081300         PERFORM FAIL.
081400 SEQ-TEST-02-03-END.
081500     MOVE    SPACE TO DELETE-SW-2.
081600*
081700*
081800*    NOW EXECUTE A NORMAL CLOSE ON THE EMPTY FILE.
081900*
082000 SEQ-INIT-03.
082100     MOVE    0 TO REC-CT.
082200     MOVE    SPACE TO DECL-EXEC-SW.
082300     MOVE   "**" TO SQ-FS4-STATUS.
082400     MOVE   "NOT EXECUTED" TO DECL-EXEC-I.
082500     MOVE   "NOT EXECUTED" TO DECL-EXEC-O.
082600     MOVE   "CLOSE AFTER CLOSE REEL"  TO FEATURE.
082700     MOVE   "SEQ-TEST-CL-03" TO PAR-NAME.
082800     IF DELETE-SW NOT EQUAL TO SPACE
082900         GO TO SEQ-DELETE-03.
083000     GO TO   SEQ-TEST-CL-03.
083100 SEQ-DELETE-03.
083200     MOVE   "*" TO DELETE-SW-2.
083300     GO TO   SEQ-DELETE-03-01.
083400 SEQ-TEST-CL-03.
083500     CLOSE   SQ-FS4.
083600*
083700*    CHECK I-O STATUS RETURNED FROM CLOSE
083800*
083900     ADD    1 TO REC-CT.
084000     IF DELETE-SW NOT = SPACE
084100         GO TO   SEQ-DELETE-03-01.
084200     GO TO   SEQ-TEST-CL-03-01.
084300 SEQ-DELETE-03-01.
084400     PERFORM DE-LETE.
084500     GO TO   SEQ-TEST-03-01-END.
084600 SEQ-TEST-CL-03-01.
084700     IF SQ-FS4-STATUS = "00"
084800         PERFORM PASS
084900     ELSE
085000         MOVE    SQ-FS4-STATUS TO COMPUTED-A
085100         MOVE   "00" TO CORRECT-A
085200         MOVE   "UNEXPECTED ERROR CODE FROM CLOSE"
085300                   TO RE-MARK
085400         MOVE   "VII-3, VII-38,4.2.4(4)" TO ANSI-REFERENCE
085500         PERFORM FAIL.
085600 SEQ-TEST-03-01-END.
085700*
085800*    CHECK EXECUTION OF INPUT DECLARATIVE
085900*
086000     ADD     1 TO REC-CT.
086100     IF DELETE-SW NOT = SPACE
086200         GO TO   SEQ-DELETE-03-02.
086300     GO TO   SEQ-TEST-CL-03-02.
086400 SEQ-DELETE-03-02.
086500     PERFORM DE-LETE.
086600     GO TO   SEQ-TEST-03-02-END.
086700 SEQ-TEST-CL-03-02.
086800     IF DECL-EXEC-I = "NOT EXECUTED"
086900         PERFORM PASS
087000     ELSE
087100         MOVE    DECL-EXEC-I TO COMPUTED-A
087200         MOVE   "NOT EXECUTED" TO CORRECT-A
087300         MOVE   "UNEXPECTED EXECUTION OF INPUT DECLARATIVE"
087400                   TO RE-MARK
087500         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
087600         PERFORM FAIL.
087700 SEQ-TEST-03-02-END.
087800*
087900*    CHECK EXECUTION OF OUTPUT DECLARATIVE
088000*
088100     ADD     1 TO REC-CT.
088200     IF DELETE-SW NOT = SPACE
088300         GO TO   SEQ-DELETE-03-03.
088400     GO TO   SEQ-TEST-CL-03-03.
088500 SEQ-DELETE-03-03.
088600     PERFORM DE-LETE.
088700     GO TO   SEQ-TEST-03-03-END.
088800 SEQ-TEST-CL-03-03.
088900     IF DECL-EXEC-O = "NOT EXECUTED"
089000         PERFORM PASS
089100     ELSE
089200         MOVE    DECL-EXEC-O TO COMPUTED-A
089300         MOVE   "NOT EXECUTED" TO CORRECT-A
089400         MOVE   "UNEXPECTED EXECUTION OF OUTPUT DECLARATIVE"
089500                   TO RE-MARK
089600         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
089700         PERFORM FAIL.
089800 SEQ-TEST-03-03-END.
089900     MOVE    SPACE TO DELETE-SW-2.
090000*
090100*
090200 CCVS-EXIT SECTION.
090300 CCVS-999999.
090400     GO TO   CLOSE-FILES.
