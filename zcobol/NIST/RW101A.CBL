000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RW101A.
000400 AUTHOR.
000500     FEDERAL COMPILER TESTING CENTER.
000600 INSTALLATION.
000700     GENERAL SERVICES ADMINISTRATION
000800     AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
000900     SOFTWARE DEVELOPMENT OFFICE.
001000     5203 LEESBURG PIKE  SUITE 1100
001100     FALLS CHURCH VIRGINIA 22041.
001200
001300     PHONE   (703) 756-6153
001400
001500     " HIGH       ".
001600 DATE-WRITTEN.
001700     CCVS-74 VERSION 4.0 - 1980 JULY 1.
001800     CREATION DATE     /    VALIDATION DATE
001900     "4.2 ".
002000 SECURITY.
002100     NONE.
002200******************************************************************
002300*
002400*       THE ROUTINE RW101A  TESTS THE BASIC REPORT WRITER MODULE
002500*    FUNCTIONS.  A SINGLE OUTPUT REPORT IS PRODUCED BY THE RWCS.
002600*    THE REPORT DESCRIPTION IN THIS ROUTINE CONTAINS A
002700*            PAGE LIMIT IS 20 LINES
002800*    WITHOUT THE OPTIONAL HEADING, FIRST DETAIL, LAST DETAIL OR
002900*    FOOTING PHRASES.  THE ASSUMED VALUES FOR THESE PHRASES ARE
003000*            HEADING - VALUE OF 1,
003100*            FIRST DETAIL - VALUE OF 1,
003200*            LAST DETAIL - VALUE OF 20,
003300*            FOOTING - VALUE OF 20.
003400*    A SINGLE DETAIL REPORT GROUP IS DEFINED FOR THE REPORT.
003500*
003600*        THE ROUTINE RW101A PROCEDURE DIVISION
003700*            OPENS THE OUTPUT SEQUENTIAL FILE FOR THE REPORT,
003800*            INITIATES THE REPORT,
003900*            CHECKS THE VALUES IN LINE-COUNTER AND PAGE-COUNTER
004000*        AFTER EXECUTING THE INITIATE STATEMENT,
004100*            GENERATES THE REPORT BODY WITH
004200*                    GENERATE DATA-NAME
004300*            STATEMENTS, CHECKING THE LINE-COUNTER AND PAGE-COUNTE
004400*            VALUES AFTER EACH GENERATE STATEMENT,
004500*            TERMINATES THE REPORT,
004600*            CLOSES THE REPORT FILE.
004700*
004800*         THE OUTPUT OF THIS ROUTINE CONSISTS OF AN OUTPUT REPORT
004900*    IN THE USUAL AUDIT ROUTINE FORMAT PRODUCED USING WRITE
005000*    STATEMENTS AND A REPORT PRODUCED BY THE RWCS.  BOTH REPORTS
005100*    MUST BE CAREFULLY EXAMINED TO VERIFY THAT THE TESTS IN
005200*    RW101 WERE EXECUTED CORRECTLY.
005300*
005400*         THE OUTPUT REPORT GENERATED BY THE RWCS CONSISTS OF
005500*    20 LINES.  ON THE OUTPUT REPORT, THE WORKING-STORAGE LINE
005600*    COUNT IS EQUAL TO THE LINE NUMBER ON WHICH THE LINE IS
005700*    PRESENTED.  SINCE LINE-COUNTER IS MOVED TO THE RWCS SOURCE
005800*    FIELD BEFORE THE GENERATE STATEMENT, THE DISPLAYED LINE-
005900*    COUNTER IS ONE LESS THAN THE LINE NUMBER.
006000*
006100******************************************************************
006200*
006300*    REFERENCE   AMERICAN NATIONAL STANDARD PROGRAMMING
006400*                    LANGUAGE COBOL, X3.23-1974
006500*        SECTION VIII - REPORT WRITER MODULE
006600*
006700******************************************************************
006800 ENVIRONMENT DIVISION.
006900 CONFIGURATION SECTION.
007000 SOURCE-COMPUTER.
007100     XXXXX082.
007200 OBJECT-COMPUTER.
007300     XXXXX083.
007400 INPUT-OUTPUT SECTION.
007500 FILE-CONTROL.
007600     SELECT PRINT-FILE ASSIGN TO
007700     XXXXX055.
007800     SELECT RW-FS1 ASSIGN TO
007900     XXXXX049.
008000 DATA DIVISION.
008100 FILE SECTION.
008200 FD  PRINT-FILE
008300     LABEL RECORDS
008400     XXXXX084
008500     DATA RECORD IS PRINT-REC DUMMY-RECORD.
008600 01  PRINT-REC PICTURE X(120).
008700 01  DUMMY-RECORD PICTURE X(120).
008800 FD  RW-FS1
008900     LABEL RECORDS ARE STANDARD
009000C    VALUE OF
009100C    XXXXX074
009200C          IS
009300C    XXXXX075
009400G    XXXXX069
009500     REPORT IS RW-FS1-REPORT-1.
009600 WORKING-STORAGE SECTION.
009700 01  LC-ERRORS  PICTURE 99  VALUE 0.
009800 01  PC-ERRORS  PICTURE 99  VALUE 0.
009900 01  REPORT-LINE-IMAGE.
010000     02  FILLER  PICTURE X(43)
010100         VALUE "DETAIL LINE WORKING-STORAGE LINE COUNTER = ".
010200     02  WS-COUNTER PICTURE 9(6) VALUE ZERO.
010300     02  FILLER  PICTURE X(21)
010400         VALUE " RWCS LINE-COUNTER = ".
010500     02  STORE-LINE-COUNTER   PICTURE 9(6).
010600 01  TEST-RESULTS.
010700     02 FILLER                    PICTURE X VALUE SPACE.
010800     02 FEATURE                   PICTURE X(20) VALUE SPACE.
010900     02 FILLER                    PICTURE X VALUE SPACE.
011000     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
011100     02 FILLER                    PICTURE X  VALUE SPACE.
011200     02  PAR-NAME.
011300       03 FILLER PICTURE X(12) VALUE SPACE.
011400       03  PARDOT-X PICTURE X  VALUE SPACE.
011500       03 DOTVALUE PICTURE 99  VALUE ZERO.
011600       03 FILLER PIC X(5) VALUE SPACE.
011700     02 FILLER PIC X(10) VALUE SPACE.
011800     02 RE-MARK PIC X(61).
011900 01  TEST-COMPUTED.
012000     02 FILLER PIC X(30) VALUE SPACE.
012100     02 FILLER PIC X(17) VALUE "       COMPUTED=".
012200     02 COMPUTED-X.
012300     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
012400     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
012500     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
012600     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
012700     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
012800     03       CM-18V0 REDEFINES COMPUTED-A.
012900         04 COMPUTED-18V0                   PICTURE -9(18).
013000         04 FILLER                          PICTURE X.
013100     03 FILLER PIC X(50) VALUE SPACE.
013200 01  TEST-CORRECT.
013300     02 FILLER PIC X(30) VALUE SPACE.
013400     02 FILLER PIC X(17) VALUE "       CORRECT =".
013500     02 CORRECT-X.
013600     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
013700     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
013800     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
013900     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
014000     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
014100     03      CR-18V0 REDEFINES CORRECT-A.
014200         04 CORRECT-18V0                    PICTURE -9(18).
014300         04 FILLER                          PICTURE X.
014400     03 FILLER PIC X(50) VALUE SPACE.
014500 01  CCVS-C-1.
014600     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
014700-    "SS  PARAGRAPH-NAME
014800-    "        REMARKS".
014900     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
015000 01  CCVS-C-2.
015100     02 FILLER PICTURE IS X VALUE IS SPACE.
015200     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
015300     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
015400     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
015500     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
015600 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
015700 01  REC-CT PICTURE 99 VALUE ZERO.
015800 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
015900 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
016000 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
016100 01  PASS-COUNTER PIC 999 VALUE ZERO.
016200 01  TOTAL-ERROR PIC 999 VALUE ZERO.
016300 01  ERROR-HOLD PIC 999 VALUE ZERO.
016400 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
016500 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
016600 01  CCVS-H-1.
016700     02  FILLER   PICTURE X(27)  VALUE SPACE.
016800     02 FILLER PICTURE X(67) VALUE
016900     " FEDERAL COMPILER TESTING CENTER COBOL COMPILER VALIDATION
017000-    " SYSTEM".
017100     02  FILLER     PICTURE X(26)  VALUE SPACE.
017200 01  CCVS-H-2.
017300     02 FILLER PICTURE X(52) VALUE IS
017400     "CCVS74 NCC  COPY, NOT FOR DISTRIBUTION.".
017500     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
017600     02 TEST-ID PICTURE IS X(9).
017700     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
017800 01  CCVS-H-3.
017900     02  FILLER PICTURE X(34) VALUE
018000     " FOR OFFICIAL USE ONLY    ".
018100     02  FILLER PICTURE X(58) VALUE
018200     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
018300     02  FILLER PICTURE X(28) VALUE
018400     "  COPYRIGHT   1974 ".
018500 01  CCVS-E-1.
018600     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
018700     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
018800     02 ID-AGAIN PICTURE IS X(9).
018900     02 FILLER PICTURE X(45) VALUE IS
019000     " NTIS DISTRIBUTION COBOL 74".
019100 01  CCVS-E-2.
019200     02  FILLER                   PICTURE X(31)  VALUE
019300     SPACE.
019400     02  FILLER                   PICTURE X(21)  VALUE SPACE.
019500     02 CCVS-E-2-2.
019600         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
019700         03 FILLER PICTURE IS X VALUE IS SPACE.
019800         03 ENDER-DESC PIC X(44) VALUE "ERRORS ENCOUNTERED".
019900 01  CCVS-E-3.
020000     02  FILLER PICTURE X(22) VALUE
020100     " FOR OFFICIAL USE ONLY".
020200     02  FILLER PICTURE X(12) VALUE SPACE.
020300     02  FILLER PICTURE X(58) VALUE
020400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
020500     02  FILLER PICTURE X(13) VALUE SPACE.
020600     02 FILLER PIC X(15) VALUE " COPYRIGHT 1974".
020700 01  CCVS-E-4.
020800     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
020900     02 FILLER PIC XXXX VALUE " OF ".
021000     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
021100     02 FILLER PIC X(40) VALUE
021200      "  TESTS WERE EXECUTED SUCCESSFULLY".
021300 01  XXINFO.
021400     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
021500     02 INFO-TEXT.
021600     04 FILLER PIC X(20) VALUE SPACE.
021700     04 XXCOMPUTED PIC X(20).
021800     04 FILLER PIC X(5) VALUE SPACE.
021900     04 XXCORRECT PIC X(20).
022000 01  HYPHEN-LINE.
022100     02 FILLER PICTURE IS X VALUE IS SPACE.
022200     02 FILLER PICTURE IS X(65) VALUE IS "************************
022300-    "*****************************************".
022400     02 FILLER PICTURE IS X(54) VALUE IS "************************
022500-    "******************************".
022600 01  CCVS-PGM-ID PIC X(6) VALUE
022700     "RW101A".
022800 REPORT SECTION.
022900 RD  RW-FS1-REPORT-1
023000     PAGE LIMIT IS 20 LINES.
023100 01  RW-FS1-GROUP
023200     TYPE IS DETAIL.
023300     03  RW-FS1-ELEM
023400         LINE NUMBER IS PLUS 1
023500         COLUMN NUMBER IS 5
023600         PICTURE X(76)
023700         SOURCE IS REPORT-LINE-IMAGE.
023800 PROCEDURE DIVISION.
023900 CCVS1 SECTION.
024000 OPEN-FILES.
024100     OPEN     OUTPUT PRINT-FILE.
024200     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
024300     MOVE    SPACE TO TEST-RESULTS.
024400     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
024500     GO TO CCVS1-EXIT.
024600 CLOSE-FILES.
024700     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
024800 TERMINATE-CCVS.
024900S    EXIT PROGRAM.
025000STERMINATE-CALL.
025100     STOP     RUN.
025200 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
025300 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
025400 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
025500 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
025600     MOVE "****TEST DELETED****" TO RE-MARK.
025700 PRINT-DETAIL.
025800     IF REC-CT NOT EQUAL TO ZERO
025900             MOVE "." TO PARDOT-X
026000             MOVE REC-CT TO DOTVALUE.
026100     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
026200     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
026300        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
026400          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
026500     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
026600     MOVE SPACE TO CORRECT-X.
026700     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
026800     MOVE     SPACE TO RE-MARK.
026900 HEAD-ROUTINE.
027000     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027100     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
027200     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
027300 COLUMN-NAMES-ROUTINE.
027400     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027500     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
027700 END-ROUTINE.
027800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
027900 END-RTN-EXIT.
028000     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028100 END-ROUTINE-1.
028200      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
028300      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
028400      ADD PASS-COUNTER TO ERROR-HOLD.
028500*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
028600      MOVE PASS-COUNTER TO CCVS-E-4-1.
028700      MOVE ERROR-HOLD TO CCVS-E-4-2.
028800      MOVE CCVS-E-4 TO CCVS-E-2-2.
028900      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
029000  END-ROUTINE-12.
029100      MOVE "TEST(S) FAILED" TO ENDER-DESC.
029200     IF       ERROR-COUNTER IS EQUAL TO ZERO
029300         MOVE "NO " TO ERROR-TOTAL
029400         ELSE
029500         MOVE ERROR-COUNTER TO ERROR-TOTAL.
029600     MOVE     CCVS-E-2 TO DUMMY-RECORD.
029700     PERFORM WRITE-LINE.
029800 END-ROUTINE-13.
029900     IF DELETE-CNT IS EQUAL TO ZERO
030000         MOVE "NO " TO ERROR-TOTAL  ELSE
030100         MOVE DELETE-CNT TO ERROR-TOTAL.
030200     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
030300     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030400      IF   INSPECT-COUNTER EQUAL TO ZERO
030500          MOVE "NO " TO ERROR-TOTAL
030600      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
030700      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
030800      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030900     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031000 WRITE-LINE.
031100     ADD 1 TO RECORD-COUNT.
031200Y    IF RECORD-COUNT GREATER 50
031300Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
031400Y        MOVE SPACE TO DUMMY-RECORD
031500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
031600Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
031700Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
031800Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
031900Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
032000Y        MOVE ZERO TO RECORD-COUNT.
032100     PERFORM WRT-LN.
032200 WRT-LN.
032300     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
032400     MOVE SPACE TO DUMMY-RECORD.
032500 BLANK-LINE-PRINT.
032600     PERFORM WRT-LN.
032700 FAIL-ROUTINE.
032800     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
032900     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
033000     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
033100     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033200     GO TO FAIL-ROUTINE-EX.
033300 FAIL-ROUTINE-WRITE.
033400     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
033500     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
033600 FAIL-ROUTINE-EX. EXIT.
033700 BAIL-OUT.
033800     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
033900     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
034000 BAIL-OUT-WRITE.
034100     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
034200     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034300 BAIL-OUT-EX. EXIT.
034400 CCVS1-EXIT.
034500     EXIT.
034600 SECT-RW101-0001 SECTION.
034700 RW101-INIT.
034800     OPEN OUTPUT RW-FS1.
034900 INIT-TEST-STATE.
035000     INITIATE RW-FS1-REPORT-1.
035100 INIT-TEST-01.
035200*
035300*        AFTER EXECUTION OF THE INITIATE STATEMENT FOR A REPORT,
035400*    THE REPORT LINE-COUNTER SHOULD BE SET TO ZERO.
035500*    REFERENCE PAGE VIII-53, 3.2.4(1)B, THE INITIATE STATEMENT.
035600*
035700     IF LINE-COUNTER EQUAL TO ZERO
035800           PERFORM PASS
035900         GO TO INIT-WRITE-01.
036000 INIT-FAIL-01.
036100     PERFORM FAIL.
036200     MOVE ZERO TO CORRECT-18V0.
036300     MOVE LINE-COUNTER TO COMPUTED-18V0.
036400     MOVE "LINE-COUNTER AFTER INITIATE" TO RE-MARK.
036500 INIT-WRITE-01.
036600     MOVE "INIT-TEST-01" TO PAR-NAME.
036700     MOVE "INITIATE REPORT" TO FEATURE.
036800     PERFORM PRINT-DETAIL.
036900 INIT-TEST-02.
037000*
037100*        AFTER EXECUTION OF THE INITIATE STATEMENT FOR A REPORT,
037200*    THE REPORT PAGE-COUNTER SHOULD BE SET TO ONE.
037300*    REFERENCE PAGE VIII-53, 3.2.4(1)C, THE INITIATE STATEMENT.
037400*
037500     IF PAGE-COUNTER EQUAL TO 1
037600         PERFORM PASS
037700         GO TO INIT-WRITE-02.
037800 INIT-FAIL-02.
037900     PERFORM FAIL.
038000     MOVE 1 TO CORRECT-18V0.
038100     MOVE PAGE-COUNTER TO COMPUTED-18V0.
038200     MOVE "PAGE-COUNTER AFTER INITIATE" TO RE-MARK.
038300 INIT-WRITE-02.
038400     MOVE "INIT-TEST-02" TO PAR-NAME.
038500     PERFORM PRINT-DETAIL.
038600 GENER-INIT-01.
038700*         THIS TEST EXECUTES THE CHRONOLOGICALLY FIRST GENERATE
038800*    STATEMENT FOR THE REPORT RW-FS1-REPORT-1.
038900*    REFERENCE  PAGE VIII-51, 3.1.4(2), (5)D, GENERATE STATEMENT
039000*
039100     ADD 1 TO WS-COUNTER.
039200     MOVE LINE-COUNTER TO STORE-LINE-COUNTER.
039300     GENERATE RW-FS1-GROUP.
039400*
039500*    OUTPUT REPORT INFO
039600*         THE DETAIL REPORT GROUP SHOULD BE PRESENTED ON THE FIRST
039700*    LINE OF THE REPORT PAGE.
039800*    REFERENCE  PAGE VIII-18, 2.5.5.8.1(4)B, BODY GROUP PRE. RULES
039900*
040000 GENER-TEST-01.
040100     IF LINE-COUNTER NOT EQUAL TO 1
040200         GO TO GENER-FAIL-01.
040300*
040400*         THE LINE-COUNTER SETTING AFTER THE GENERATE STATEMENT
040500*    IS EQUAL TO THE LINE NUMBER ON WHICH THE PRINT LINE WAS
040600*    PRESENTED, IN THIS CASE ONE.
040700*    REFERENCE  PAGE VIII-19, 2.5.5.8.1(6)D, FINAL L-C SETTING
040800*
040900 GENER-PASS-01.
041000     PERFORM PASS.
041100     GO TO GENER-WRITE-01.
041200 GENER-FAIL-01.
041300     PERFORM FAIL.
041400     MOVE LINE-COUNTER TO COMPUTED-18V0.
041500     MOVE 1 TO CORRECT-18V0.
041600     MOVE "LINE-COUNTER AFTER FIRST GENER" TO RE-MARK.
041700 GENER-WRITE-01.
041800     MOVE "GENER-TEST-1" TO PAR-NAME.
041900     MOVE "FIRST GENERATE" TO FEATURE.
042000     PERFORM PRINT-DETAIL.
042100 GENER-TEST-02.
042200     IF PAGE-COUNTER NOT EQUAL TO 1
042300         GO TO GENER-FAIL-02.
042400*
042500*         EXECUTION OF THE GENERATE STATEMENT SHOULD NOT CHANGE
042600*    THE VALUE OF PAGE-COUNTER.  IT SHOULD STILL BE EQUAL TO ONE.
042700*    REFERENCE  PAGE VIII-4, 2.4.4, PAGE-COUNTER RULES.
042800*
042900 GENER-PASS-02.
043000     PERFORM PASS.
043100     GO TO GENER-WRITE-02.
043200 GENER-FAIL-02.
043300     PERFORM FAIL.
043400     MOVE PAGE-COUNTER TO COMPUTED-18V0.
043500     MOVE 1 TO CORRECT-18V0.
043600     MOVE "PAGE-COUNTER AFTER FIRST GENER" TO RE-MARK.
043700 GENER-WRITE-02.
043800     MOVE "GENER-TEST-2" TO PAR-NAME.
043900     PERFORM PRINT-DETAIL.
044000 GENER-INIT-03.
044100*         THIS TEST EXECUTES A GENERATE STATEMENT FOR THE DETAIL
044200*    REPORT GROUP 18 TIMES.
044300*    REFERENCE  PAGE VIII-51, 3.1.4(2), (6)B, GENERATE STATEMENT
044400*
044500      PERFORM GENER-DETAIL-LINE 18 TIMES.
044600*
044700*    OUTPUT REPORT INFO
044800*         EIGHTEEN DETAIL LINES SINGLE SPACED SHOULD BE PRESENTED
044900*    ON LINES 2 THROUGH 19 OF THE FIRST REPORT PAGE.
045000*    REFERENCE  PAGE VIII-18, 2.5.5.8.1(4)B, BODY GROUP PRE RULES
045100*
045200 GENER-TEST-03.
045300     IF LC-ERRORS EQUAL TO ZERO
045400         PERFORM PASS
045500         GO TO GENER-WRITE-03.
045600 GENER-FAIL-03.
045700     PERFORM FAIL.
045800     MOVE LC-ERRORS TO COMPUTED-18V0.
045900     MOVE ZERO TO CORRECT-18V0.
046000     MOVE "NUMBER OF LINE-COUNTER ERRORS" TO RE-MARK.
046100 GENER-WRITE-03.
046200     MOVE "GENER-TEST-3" TO PAR-NAME.
046300     MOVE "GENERATE 18 LINES" TO FEATURE.
046400     PERFORM PRINT-DETAIL.
046500     GO TO GENER-TEST-04.
046600 GENER-DETAIL-LINE.
046700     ADD 1 TO WS-COUNTER.
046800     MOVE LINE-COUNTER TO STORE-LINE-COUNTER.
046900     GENERATE RW-FS1-GROUP.
047000     IF LINE-COUNTER NOT EQUAL TO WS-COUNTER
047100         ADD 1 TO LC-ERRORS.
047200*
047300*         THE LINE-COUNTER SETTING AFTER THE GENERATE STATEMENT
047400*    IS EQUAL TO THE LINE NUMBER ON WHICH THE PRINT LINE WAS
047500*    PRESENTED.
047600*    REFERENCE  PAGE VIII-19, 2.5.5.8.1(6)D, FINAL L-C SETTING
047700*
047800     IF PAGE-COUNTER NOT EQUAL TO 1
047900         ADD 1 TO PC-ERRORS.
048000*
048100*         EXECUTION OF THE GENERATE STATEMENT SHOULD NOT CHANGE
048200*    THE VALUE OF PAGE-COUNTER.  IT SHOULD STILL BE EQUAL TO ONE.
048300*    REFERENCE  PAGE VIII-4, 2.4.4, PAGE-COUNTER RULES.
048400*
048500 GENER-TEST-04.
048600     IF PC-ERRORS EQUAL TO ZERO
048700         PERFORM PASS
048800         GO TO GENER-WRITE-04.
048900 GENER-FAIL-04.
049000     PERFORM FAIL.
049100     MOVE PC-ERRORS TO COMPUTED-18V0.
049200     MOVE ZERO TO CORRECT-18V0.
049300     MOVE "NUMBER OF PAGE-COUNTER ERRORS" TO RE-MARK.
049400 GENER-WRITE-04.
049500     MOVE "GENER-TEST-4" TO PAR-NAME.
049600     PERFORM PRINT-DETAIL.
049700 GENER-INIT-05.
049800*         THIS TEST GENERATES THE 20TH PRINT LINE ON THE REPORT
049900*    PAGE.  THE NUMBER OF LINES PER PAGE WAS SPECIFIED TO BE 20.
050000*
050100     ADD 1 TO WS-COUNTER.
050200     MOVE LINE-COUNTER TO STORE-LINE-COUNTER.
050300     GENERATE RW-FS1-GROUP.
050400*
050500*         AFTER EXECUTION OF THE GENERATE STATEMENT LINE-COUNTER
050600*    SHOULD EQUAL 20 AND PAGE-COUNTER SHOULD EQUAL ONE.
050700*
050800 GENER-TEST-05.
050900     IF LINE-COUNTER NOT EQUAL TO 20
051000        GO TO GENER-FAIL-05.
051100 GENER-PASS-05.
051200     PERFORM PASS.
051300     GO TO GENER-WRITE-05.
051400 GENER-FAIL-05.
051500     PERFORM FAIL.
051600     MOVE 20 TO CORRECT-18V0.
051700     MOVE LINE-COUNTER TO COMPUTED-18V0.
051800     MOVE "LINE-COUNTER AFTER LAST GENER" TO RE-MARK.
051900 GENER-WRITE-05.
052000     MOVE "GENER-TEST-5" TO PAR-NAME.
052100     MOVE "LAST GENERATE" TO FEATURE.
052200     PERFORM PRINT-DETAIL.
052300 GENER-TEST-06.
052400     IF PAGE-COUNTER NOT EQUAL TO 1
052500         GO TO GENER-FAIL-06.
052600 GENER-PASS-06.
052700     PERFORM PASS.
052800     GO TO GENER-WRITE-06.
052900 GENER-FAIL-06.
053000     PERFORM FAIL.
053100     MOVE 1 TO CORRECT-18V0.
053200     MOVE PAGE-COUNTER TO COMPUTED-18V0.
053300     MOVE "PAGE-COUNTER AFTER LAST GENER" TO RE-MARK.
053400 GENER-WRITE-06.
053500     MOVE "GENER-TEST-6" TO PAR-NAME.
053600     PERFORM PRINT-DETAIL.
053700 TERM-TEST-STATE.
053800     TERMINATE RW-FS1-REPORT-1.
053900 CLOSE-RW-FS1.
054000     CLOSE RW-FS1.
054100 TERM-WRITE-01.
054200     MOVE "TERMINATE REPORT" TO FEATURE.
054300     MOVE "TERM-TEST-01" TO PAR-NAME.
054400     MOVE "1 PAGE REPORT" TO COMPUTED-A.
054500     MOVE "20 LINES PER PAGE" TO CORRECT-A.
054600     MOVE "CHECK RWCS OUTPUT REPORT" TO RE-MARK.
054700     PERFORM PRINT-DETAIL.
054800 EXIT-RW101.
054900     EXIT.
055000 CCVS-EXIT SECTION.
055100 CCVS-999999.
055200     GO TO CLOSE-FILES.
