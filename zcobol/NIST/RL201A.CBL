000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RL201A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*GENERAL:    THIS RUN UNIT IS THE FIRST OF A SERIES WHICH
001400*            PROCESSES A RELATIVE I-O FILE.  THE FUNCTION OF THIS
001500*            PROGRAM IS TO CREATE A RELATIVE FILE SEQUENTIALLY
001600*            (ACCESS MODE SEQUENTIAL) AND VERIFY THAT IT WAS
001700*            CREATED CORRECTLY.  THE FILE IS IDENTIFED AS "RL-FS1"
001800*            AND IS PASSED TO SUBSEQUENT RUN UNITS FOR PROCESSING.
001900*
002000*            X-CARD PARAMETERS WHICH MUST BE SUPPLIED FOR THIS
002100*            PROGRAM ARE:
002200*
002300*                 X-21   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
002400*                         RELATIVE  I-O DATA FILE
002500*                 X-55   SYSTEM PRINTER
002600*                 X-69   ADDITIONAL VALUE OF CLAUSES
002700*                 X-74   VALUE OF IMPLEMENTOR-NAME
002800*                 X-75   OBJECT OF VALUE OF CLAUSE
002900*                 X-82   SOURCE-COMPUTER
003000*                 X-83   OBJECT-COMPUTER.
003100*
003200****************************************************************
003300 ENVIRONMENT DIVISION.
003400 CONFIGURATION SECTION.
003500 SOURCE-COMPUTER.
003600     XXXXX082.
003700 OBJECT-COMPUTER.
003800     XXXXX083.
003900 INPUT-OUTPUT SECTION.
004000 FILE-CONTROL.
004100     SELECT PRINT-FILE ASSIGN TO
004200     XXXXX055.
004300     SELECT   RL-FS1 ASSIGN TO
004400     XXXXP021
004500             ORGANIZATION IS RELATIVE.
004600*    ABSENCE OF THE ACCESS CLAUSE IS TREATED AS THOUGH
004700*     SEQUENTIAL HAD BEEN SPECIFIED.
004800 DATA DIVISION.
004900 FILE SECTION.
005000 FD  PRINT-FILE.
005100 01  PRINT-REC PICTURE X(120).
005200 01  DUMMY-RECORD PICTURE X(120).
005300 FD  RL-FS1
005400     LABEL RECORDS STANDARD
005500C    VALUE OF
005600C    XXXXX074
005700C    IS
005800C    XXXXX075
005900G    XXXXX069
006000     BLOCK CONTAINS 1 RECORDS
006100     RECORD CONTAINS 120 CHARACTERS.
006200 01  RL-FS1R1-F-G-120.
006300     02 FILLER PIC X(120).
006400 WORKING-STORAGE SECTION.
006500 01  WRK-CS-09V00 PIC S9(9) USAGE COMP VALUE ZERO.
006600 01  FILE-RECORD-INFORMATION-REC.
006700     03 FILE-RECORD-INFO-SKELETON.
006800        05 FILLER                 PICTURE X(48)       VALUE
006900             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
007000        05 FILLER                 PICTURE X(46)       VALUE
007100             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
007200        05 FILLER                 PICTURE X(26)       VALUE
007300             ",LFIL=000000,ORG=  ,LBLR= ".
007400        05 FILLER                 PICTURE X(37)       VALUE
007500             ",RECKEY=                             ".
007600        05 FILLER                 PICTURE X(38)       VALUE
007700             ",ALTKEY1=                             ".
007800        05 FILLER                 PICTURE X(38)       VALUE
007900             ",ALTKEY2=                             ".
008000        05 FILLER                 PICTURE X(7)        VALUE SPACE.
008100     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
008200        05 FILE-RECORD-INFO-P1-120.
008300           07 FILLER              PIC X(5).
008400           07 XFILE-NAME           PIC X(6).
008500           07 FILLER              PIC X(8).
008600           07 XRECORD-NAME         PIC X(6).
008700           07 FILLER              PIC X(1).
008800           07 REELUNIT-NUMBER     PIC 9(1).
008900           07 FILLER              PIC X(7).
009000           07 XRECORD-NUMBER       PIC 9(6).
009100           07 FILLER              PIC X(6).
009200           07 UPDATE-NUMBER       PIC 9(2).
009300           07 FILLER              PIC X(5).
009400           07 ODO-NUMBER          PIC 9(4).
009500           07 FILLER              PIC X(5).
009600           07 XPROGRAM-NAME        PIC X(5).
009700           07 FILLER              PIC X(7).
009800           07 XRECORD-LENGTH       PIC 9(6).
009900           07 FILLER              PIC X(7).
010000           07 CHARS-OR-RECORDS    PIC X(2).
010100           07 FILLER              PIC X(1).
010200           07 XBLOCK-SIZE          PIC 9(4).
010300           07 FILLER              PIC X(6).
010400           07 RECORDS-IN-FILE     PIC 9(6).
010500           07 FILLER              PIC X(5).
010600           07 XFILE-ORGANIZATION   PIC X(2).
010700           07 FILLER              PIC X(6).
010800           07 XLABEL-TYPE          PIC X(1).
010900        05 FILE-RECORD-INFO-P121-240.
011000           07 FILLER              PIC X(8).
011100           07 XRECORD-KEY          PIC X(29).
011200           07 FILLER              PIC X(9).
011300           07 ALTERNATE-KEY1      PIC X(29).
011400           07 FILLER              PIC X(9).
011500           07 ALTERNATE-KEY2      PIC X(29).
011600           07 FILLER              PIC X(7).
011700 01  TEST-RESULTS.
011800     02 FILLER                   PIC X      VALUE SPACE.
011900     02 FEATURE                  PIC X(20)  VALUE SPACE.
012000     02 FILLER                   PIC X      VALUE SPACE.
012100     02 P-OR-F                   PIC X(5)   VALUE SPACE.
012200     02 FILLER                   PIC X      VALUE SPACE.
012300     02  PAR-NAME.
012400       03 FILLER                 PIC X(19)  VALUE SPACE.
012500       03  PARDOT-X              PIC X      VALUE SPACE.
012600       03 DOTVALUE               PIC 99     VALUE ZERO.
012700     02 FILLER                   PIC X(8)   VALUE SPACE.
012800     02 RE-MARK                  PIC X(61).
012900 01  TEST-COMPUTED.
013000     02 FILLER                   PIC X(30)  VALUE SPACE.
013100     02 FILLER                   PIC X(17)  VALUE
013200            "       COMPUTED=".
013300     02 COMPUTED-X.
013400     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
013500     03 COMPUTED-N               REDEFINES COMPUTED-A
013600                                 PIC -9(9).9(9).
013700     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
013800     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
013900     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
014000     03       CM-18V0 REDEFINES COMPUTED-A.
014100         04 COMPUTED-18V0                    PIC -9(18).
014200         04 FILLER                           PIC X.
014300     03 FILLER PIC X(50) VALUE SPACE.
014400 01  TEST-CORRECT.
014500     02 FILLER PIC X(30) VALUE SPACE.
014600     02 FILLER PIC X(17) VALUE "       CORRECT =".
014700     02 CORRECT-X.
014800     03 CORRECT-A                  PIC X(20) VALUE SPACE.
014900     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
015000     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
015100     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
015200     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
015300     03      CR-18V0 REDEFINES CORRECT-A.
015400         04 CORRECT-18V0                     PIC -9(18).
015500         04 FILLER                           PIC X.
015600     03 FILLER PIC X(2) VALUE SPACE.
015700     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
015800 01  CCVS-C-1.
015900     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
016000-    "SS  PARAGRAPH-NAME
016100-    "       REMARKS".
016200     02 FILLER                     PIC X(20)    VALUE SPACE.
016300 01  CCVS-C-2.
016400     02 FILLER                     PIC X        VALUE SPACE.
016500     02 FILLER                     PIC X(6)     VALUE "TESTED".
016600     02 FILLER                     PIC X(15)    VALUE SPACE.
016700     02 FILLER                     PIC X(4)     VALUE "FAIL".
016800     02 FILLER                     PIC X(94)    VALUE SPACE.
016900 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
017000 01  REC-CT                        PIC 99       VALUE ZERO.
017100 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
017200 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
017300 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
017400 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
017500 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
017600 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
017700 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
017800 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
017900 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
018000 01  CCVS-H-1.
018100     02  FILLER                    PIC X(39)    VALUE SPACES.
018200     02  FILLER                    PIC X(42)    VALUE
018300     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
018400     02  FILLER                    PIC X(39)    VALUE SPACES.
018500 01  CCVS-H-2A.
018600   02  FILLER                        PIC X(40)  VALUE SPACE.
018700   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
018800   02  FILLER                        PIC XXXX   VALUE
018900     "4.2 ".
019000   02  FILLER                        PIC X(28)  VALUE
019100            " COPY - NOT FOR DISTRIBUTION".
019200   02  FILLER                        PIC X(41)  VALUE SPACE.
019300
019400 01  CCVS-H-2B.
019500   02  FILLER                        PIC X(15)  VALUE
019600            "TEST RESULT OF ".
019700   02  TEST-ID                       PIC X(9).
019800   02  FILLER                        PIC X(4)   VALUE
019900            " IN ".
020000   02  FILLER                        PIC X(12)  VALUE
020100     " HIGH       ".
020200   02  FILLER                        PIC X(22)  VALUE
020300            " LEVEL VALIDATION FOR ".
020400   02  FILLER                        PIC X(58)  VALUE
020500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
020600 01  CCVS-H-3.
020700     02  FILLER                      PIC X(34)  VALUE
020800            " FOR OFFICIAL USE ONLY    ".
020900     02  FILLER                      PIC X(58)  VALUE
021000     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
021100     02  FILLER                      PIC X(28)  VALUE
021200            "  COPYRIGHT   1985 ".
021300 01  CCVS-E-1.
021400     02 FILLER                       PIC X(52)  VALUE SPACE.
021500     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
021600     02 ID-AGAIN                     PIC X(9).
021700     02 FILLER                       PIC X(45)  VALUE SPACES.
021800 01  CCVS-E-2.
021900     02  FILLER                      PIC X(31)  VALUE SPACE.
022000     02  FILLER                      PIC X(21)  VALUE SPACE.
022100     02 CCVS-E-2-2.
022200         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
022300         03 FILLER                   PIC X      VALUE SPACE.
022400         03 ENDER-DESC               PIC X(44)  VALUE
022500            "ERRORS ENCOUNTERED".
022600 01  CCVS-E-3.
022700     02  FILLER                      PIC X(22)  VALUE
022800            " FOR OFFICIAL USE ONLY".
022900     02  FILLER                      PIC X(12)  VALUE SPACE.
023000     02  FILLER                      PIC X(58)  VALUE
023100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
023200     02  FILLER                      PIC X(13)  VALUE SPACE.
023300     02 FILLER                       PIC X(15)  VALUE
023400             " COPYRIGHT 1985".
023500 01  CCVS-E-4.
023600     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
023700     02 FILLER                       PIC X(4)   VALUE " OF ".
023800     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
023900     02 FILLER                       PIC X(40)  VALUE
024000      "  TESTS WERE EXECUTED SUCCESSFULLY".
024100 01  XXINFO.
024200     02 FILLER                       PIC X(19)  VALUE
024300            "*** INFORMATION ***".
024400     02 INFO-TEXT.
024500       04 FILLER                     PIC X(8)   VALUE SPACE.
024600       04 XXCOMPUTED                 PIC X(20).
024700       04 FILLER                     PIC X(5)   VALUE SPACE.
024800       04 XXCORRECT                  PIC X(20).
024900     02 INF-ANSI-REFERENCE           PIC X(48).
025000 01  HYPHEN-LINE.
025100     02 FILLER  PIC IS X VALUE IS SPACE.
025200     02 FILLER  PIC IS X(65)    VALUE IS "************************
025300-    "*****************************************".
025400     02 FILLER  PIC IS X(54)    VALUE IS "************************
025500-    "******************************".
025600 01  CCVS-PGM-ID                     PIC X(9)   VALUE
025700     "RL201A".
025800 PROCEDURE DIVISION.
025900 CCVS1 SECTION.
026000 OPEN-FILES.
026100     OPEN    OUTPUT PRINT-FILE.
026200     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
026300     MOVE    SPACE TO TEST-RESULTS.
026400     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
026500     MOVE    ZERO TO REC-SKL-SUB.
026600     PERFORM CCVS-INIT-FILE 9 TIMES.
026700 CCVS-INIT-FILE.
026800     ADD     1 TO REC-SKL-SUB.
026900     MOVE    FILE-RECORD-INFO-SKELETON
027000          TO FILE-RECORD-INFO (REC-SKL-SUB).
027100 CCVS-INIT-EXIT.
027200     GO TO CCVS1-EXIT.
027300 CLOSE-FILES.
027400     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
027500 TERMINATE-CCVS.
027600S    EXIT PROGRAM.
027700STERMINATE-CALL.
027800     STOP     RUN.
027900 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
028000 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
028100 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
028200 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
028300     MOVE "****TEST DELETED****" TO RE-MARK.
028400 PRINT-DETAIL.
028500     IF REC-CT NOT EQUAL TO ZERO
028600             MOVE "." TO PARDOT-X
028700             MOVE REC-CT TO DOTVALUE.
028800     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
028900     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
029000        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
029100          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
029200     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
029300     MOVE SPACE TO CORRECT-X.
029400     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
029500     MOVE     SPACE TO RE-MARK.
029600 HEAD-ROUTINE.
029700     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029800     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029900     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030000     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030100 COLUMN-NAMES-ROUTINE.
030200     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030300     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
030500 END-ROUTINE.
030600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
030700 END-RTN-EXIT.
030800     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030900 END-ROUTINE-1.
031000      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
031100      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
031200      ADD PASS-COUNTER TO ERROR-HOLD.
031300*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
031400      MOVE PASS-COUNTER TO CCVS-E-4-1.
031500      MOVE ERROR-HOLD TO CCVS-E-4-2.
031600      MOVE CCVS-E-4 TO CCVS-E-2-2.
031700      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
031800  END-ROUTINE-12.
031900      MOVE "TEST(S) FAILED" TO ENDER-DESC.
032000     IF       ERROR-COUNTER IS EQUAL TO ZERO
032100         MOVE "NO " TO ERROR-TOTAL
032200         ELSE
032300         MOVE ERROR-COUNTER TO ERROR-TOTAL.
032400     MOVE     CCVS-E-2 TO DUMMY-RECORD.
032500     PERFORM WRITE-LINE.
032600 END-ROUTINE-13.
032700     IF DELETE-COUNTER IS EQUAL TO ZERO
032800         MOVE "NO " TO ERROR-TOTAL  ELSE
032900         MOVE DELETE-COUNTER TO ERROR-TOTAL.
033000     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
033100     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033200      IF   INSPECT-COUNTER EQUAL TO ZERO
033300          MOVE "NO " TO ERROR-TOTAL
033400      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
033500      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
033600      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033700     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033800 WRITE-LINE.
033900     ADD 1 TO RECORD-COUNT.
034000Y    IF RECORD-COUNT GREATER 50
034100Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
034200Y        MOVE SPACE TO DUMMY-RECORD
034300Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
034400Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
034500Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
034600Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
034700Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
034800Y        MOVE ZERO TO RECORD-COUNT.
034900     PERFORM WRT-LN.
035000 WRT-LN.
035100     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
035200     MOVE SPACE TO DUMMY-RECORD.
035300 BLANK-LINE-PRINT.
035400     PERFORM WRT-LN.
035500 FAIL-ROUTINE.
035600     IF     COMPUTED-X NOT EQUAL TO SPACE
035700            GO TO   FAIL-ROUTINE-WRITE.
035800     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
035900     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
036000     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
036100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036200     MOVE   SPACES TO INF-ANSI-REFERENCE.
036300     GO TO  FAIL-ROUTINE-EX.
036400 FAIL-ROUTINE-WRITE.
036500     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
036600     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
036700     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
036800     MOVE   SPACES TO COR-ANSI-REFERENCE.
036900 FAIL-ROUTINE-EX. EXIT.
037000 BAIL-OUT.
037100     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
037200     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
037300 BAIL-OUT-WRITE.
037400     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
037500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
037600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037700     MOVE   SPACES TO INF-ANSI-REFERENCE.
037800 BAIL-OUT-EX. EXIT.
037900 CCVS1-EXIT.
038000     EXIT.
038100 SECT-RL201-001 SECTION.
038200 REL-INIT-001.
038300     MOVE     "FILE CREATE RL-FS1" TO FEATURE.
038400     OPEN     OUTPUT    RL-FS1.
038500     MOVE     "RL-FS1" TO XFILE-NAME (1).
038600     MOVE     "R1-F-G" TO XRECORD-NAME (1).
038700     MOVE CCVS-PGM-ID      TO XPROGRAM-NAME (1).
038800     MOVE     000120   TO XRECORD-LENGTH (1).
038900     MOVE     "RC"     TO CHARS-OR-RECORDS (1).
039000     MOVE     0001     TO XBLOCK-SIZE (1).
039100     MOVE     000500   TO RECORDS-IN-FILE (1).
039200     MOVE     "RL"     TO XFILE-ORGANIZATION (1).
039300     MOVE     "S"      TO XLABEL-TYPE (1).
039400     MOVE     000001   TO XRECORD-NUMBER (1).
039500 REL-TEST-001.
039600     MOVE     FILE-RECORD-INFO-P1-120 (1) TO RL-FS1R1-F-G-120.
039700     WRITE    RL-FS1R1-F-G-120
039800              INVALID KEY GO TO REL-FAIL-001.
039900     IF      XRECORD-NUMBER (1) EQUAL TO 500
040000             GO TO REL-WRITE-001.
040100     ADD      000001 TO XRECORD-NUMBER (1).
040200     GO       TO REL-TEST-001.
040300 REL-DELETE-001.
040400     PERFORM   DE-LETE.
040500     GO TO REL-WRITE-001.
040600 REL-FAIL-001.
040700     PERFORM   FAIL.
040800     MOVE    "BOUNDARY VIOLATION"  TO RE-MARK.
040900 REL-WRITE-001.
041000     MOVE     "REL-TEST-001" TO   PAR-NAME
041100     MOVE     "FILE CREATED, LFILE "  TO COMPUTED-A.
041200     MOVE    XRECORD-NUMBER (1) TO CORRECT-18V0.
041300     PERFORM  PRINT-DETAIL.
041400     CLOSE    RL-FS1.
041500 REL-INIT-002.
041600     OPEN     INPUT     RL-FS1.
041700     MOVE     ZERO      TO WRK-CS-09V00.
041800 REL-TEST-002.
041900     READ     RL-FS1
042000              AT END GO TO REL-TEST-002-1.
042100     MOVE     RL-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
042200     ADD      1 TO WRK-CS-09V00.
042300     IF       WRK-CS-09V00 GREATER 500
042400             MOVE "MORE THAN 500 RECORDS" TO RE-MARK
042500              GO TO REL-TEST-002-1.
042600     GO       TO REL-TEST-002.
042700 REL-DELETE-002.
042800     PERFORM     DE-LETE.
042900     PERFORM    PRINT-DETAIL.
043000 REL-TEST-002-1.
043100     IF       XRECORD-NUMBER (1) NOT EQUAL TO 500
043200              PERFORM FAIL
043300              ELSE
043400              PERFORM PASS.
043500     GO       TO REL-WRITE-002.
043600 REL-WRITE-002.
043700     MOVE     "REL-TEST-002" TO PAR-NAME.
043800     MOVE     "FILE VERIFIED, LFILE" TO COMPUTED-A.
043900     MOVE    XRECORD-NUMBER (1) TO CORRECT-18V0.
044000     PERFORM  PRINT-DETAIL.
044100     CLOSE   RL-FS1.
044200 CCVS-EXIT SECTION.
044300 CCVS-999999.
044400     GO TO CLOSE-FILES.
