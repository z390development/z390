000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ216A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200*        THIS ROUTINE TESTS THE CLAUSE:
001300*             PADDING CHARACTER IS   "9" (LITERAL).
001400*
001500*        THE ROUTINE SQ216A CREATES A TAPE FILE WHICH HAS 750 FIXE
001600*    LENGTH RECORDS.  THE FILE IS THEN CLOSED AND OPENED AS AN
001700*    INPUT FILE.  THE FILE IS READ AND FIELDS IN THE INPUT RECORDS
001800*    ARE COMPARED TO THE VALUES WRITTEN TO ENSURE THAT THE RECORDS
001900*    WERE PROCESSED CORRECTLY.  THE FILE IS CLOSED AND OPENED
002000*    AGAIN AS AN INPUT FILE.  FOUR READ FORMAT OPTIONS ARE USED
002100*    TO READ THE FILE AND FIELDS IN THE RECORDS ARE VERIFIED.
002200*    THE OPEN, CLOSE, READ, AND WRITE STATEMENTS ARE TESTED FOR
002300*    LEVEL TWO            PADDING CHARCTER IS "9".
002400*
002500*    THE LAST 9 RECORDS MUST BE FILLED WITH THE PADDING CHARACTER
002600*     "9".
002700*
002800 ENVIRONMENT DIVISION.
002900 CONFIGURATION SECTION.
003000 SOURCE-COMPUTER.
003100     XXXXX082.
003200 OBJECT-COMPUTER.
003300     XXXXX083.
003400 INPUT-OUTPUT SECTION.
003500 FILE-CONTROL.
003600P    SELECT RAW-DATA   ASSIGN TO
003700P    XXXXX062
003800P           ORGANIZATION IS INDEXED
003900P           ACCESS MODE IS RANDOM
004000P           RECORD KEY IS RAW-DATA-KEY.
004100     SELECT PRINT-FILE ASSIGN TO
004200     XXXXX055.
004300     SELECT SQ-FS1 ASSIGN TO
004400     XXXXX001
004500     ORGANIZATION IS SEQUENTIAL
004600     PADDING CHARACTER IS "9"
004700     ACCESS MODE IS SEQUENTIAL.
004800 DATA DIVISION.
004900 FILE SECTION.
005000P
005100PFD  RAW-DATA.
005200P
005300P01  RAW-DATA-SATZ.
005400P    05  RAW-DATA-KEY        PIC X(6).
005500P    05  C-DATE              PIC 9(6).
005600P    05  C-TIME              PIC 9(8).
005700P    05  C-NO-OF-TESTS       PIC 99.
005800P    05  C-OK                PIC 999.
005900P    05  C-ALL               PIC 999.
006000P    05  C-FAIL              PIC 999.
006100P    05  C-DELETED           PIC 999.
006200P    05  C-INSPECT           PIC 999.
006300P    05  C-NOTE              PIC X(13).
006400P    05  C-INDENT            PIC X.
006500P    05  C-ABORT             PIC X(8).
006600 FD  PRINT-FILE
006700C    LABEL RECORDS
006800C    XXXXX084
006900C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007000               .
007100 01  PRINT-REC PICTURE X(120).
007200 01  DUMMY-RECORD PICTURE X(120).
007300 FD  SQ-FS1
007400C    LABEL RECORD STANDARD
007500     RECORD CONTAINS 120 CHARACTERS
007600     BLOCK CONTAINS 13 RECORDS.
007700 01  SQ-FS1R1-F-G-120.
007800     02  FILLER PIC X(120).
007900 WORKING-STORAGE SECTION.
008000 01  WRK-CS-09V00 PIC S9(9) USAGE COMP VALUE ZERO.
008100 01  RECORDS-IN-ERROR PIC S9(5) USAGE COMP VALUE ZERO.
008200 01  ERROR-FLAG PIC 9 VALUE ZERO.
008300 01  EOF-FLAG   PICTURE 9 VALUE ZERO.
008400 01  FILE-RECORD-INFORMATION-REC.
008500     03 FILE-RECORD-INFO-SKELETON.
008600        05 FILLER                 PICTURE X(48)       VALUE
008700             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
008800        05 FILLER                 PICTURE X(46)       VALUE
008900             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
009000        05 FILLER                 PICTURE X(26)       VALUE
009100             ",LFIL=000000,ORG=  ,LBLR= ".
009200        05 FILLER                 PICTURE X(37)       VALUE
009300             ",RECKEY=                             ".
009400        05 FILLER                 PICTURE X(38)       VALUE
009500             ",ALTKEY1=                             ".
009600        05 FILLER                 PICTURE X(38)       VALUE
009700             ",ALTKEY2=                             ".
009800        05 FILLER                 PICTURE X(7)        VALUE SPACE.
009900     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
010000        05 FILE-RECORD-INFO-P1-120.
010100           07 FILLER              PIC X(5).
010200           07 XFILE-NAME           PIC X(6).
010300           07 FILLER              PIC X(8).
010400           07 XRECORD-NAME         PIC X(6).
010500           07 FILLER              PIC X(1).
010600           07 REELUNIT-NUMBER     PIC 9(1).
010700           07 FILLER              PIC X(7).
010800           07 XRECORD-NUMBER       PIC 9(6).
010900           07 FILLER              PIC X(6).
011000           07 UPDATE-NUMBER       PIC 9(2).
011100           07 FILLER              PIC X(5).
011200           07 ODO-NUMBER          PIC 9(4).
011300           07 FILLER              PIC X(5).
011400           07 XPROGRAM-NAME        PIC X(5).
011500           07 FILLER              PIC X(7).
011600           07 XRECORD-LENGTH       PIC 9(6).
011700           07 FILLER              PIC X(7).
011800           07 CHARS-OR-RECORDS    PIC X(2).
011900           07 FILLER              PIC X(1).
012000           07 XBLOCK-SIZE          PIC 9(4).
012100           07 FILLER              PIC X(6).
012200           07 RECORDS-IN-FILE     PIC 9(6).
012300           07 FILLER              PIC X(5).
012400           07 XFILE-ORGANIZATION   PIC X(2).
012500           07 FILLER              PIC X(6).
012600           07 XLABEL-TYPE          PIC X(1).
012700        05 FILE-RECORD-INFO-P121-240.
012800           07 FILLER              PIC X(8).
012900           07 XRECORD-KEY          PIC X(29).
013000           07 FILLER              PIC X(9).
013100           07 ALTERNATE-KEY1      PIC X(29).
013200           07 FILLER              PIC X(9).
013300           07 ALTERNATE-KEY2      PIC X(29).
013400           07 FILLER              PIC X(7).
013500 01  TEST-RESULTS.
013600     02 FILLER                    PICTURE X VALUE SPACE.
013700     02 FEATURE                   PICTURE X(20) VALUE SPACE.
013800     02 FILLER                    PICTURE X VALUE SPACE.
013900     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
014000     02 FILLER                    PICTURE X  VALUE SPACE.
014100     02  PAR-NAME.
014200       03 FILLER PICTURE X(12) VALUE SPACE.
014300       03  PARDOT-X PICTURE X  VALUE SPACE.
014400       03 DOTVALUE PICTURE 99  VALUE ZERO.
014500       03 FILLER PIC X(5) VALUE SPACE.
014600     02 FILLER PIC X(10) VALUE SPACE.
014700     02 RE-MARK PIC X(61).
014800 01  TEST-COMPUTED.
014900     02 FILLER PIC X(30) VALUE SPACE.
015000     02 FILLER PIC X(17) VALUE "       COMPUTED=".
015100     02 COMPUTED-X.
015200     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
015300     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
015400     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
015500     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
015600     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
015700     03       CM-18V0 REDEFINES COMPUTED-A.
015800         04 COMPUTED-18V0                   PICTURE -9(18).
015900         04 FILLER                          PICTURE X.
016000     03 FILLER PIC X(50) VALUE SPACE.
016100 01  TEST-CORRECT.
016200     02 FILLER PIC X(30) VALUE SPACE.
016300     02 FILLER PIC X(17) VALUE "       CORRECT =".
016400     02 CORRECT-X.
016500     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
016600     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
016700     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
016800     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
016900     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
017000     03      CR-18V0 REDEFINES CORRECT-A.
017100         04 CORRECT-18V0                    PICTURE -9(18).
017200         04 FILLER                          PICTURE X.
017300     03 FILLER PIC X(50) VALUE SPACE.
017400 01  CCVS-C-1.
017500     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
017600-    "SS  PARAGRAPH-NAME
017700-    "        REMARKS".
017800     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
017900 01  CCVS-C-2.
018000     02 FILLER PICTURE IS X VALUE IS SPACE.
018100     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
018200     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
018300     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
018400     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
018500 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
018600 01  REC-CT PICTURE 99 VALUE ZERO.
018700 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
018800 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
018900 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
019000 01  PASS-COUNTER PIC 999 VALUE ZERO.
019100 01  TOTAL-ERROR PIC 999 VALUE ZERO.
019200 01  ERROR-HOLD PIC 999 VALUE ZERO.
019300 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
019400 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
019500 01  CCVS-H-1.
019600     02  FILLER   PICTURE X(27)  VALUE SPACE.
019700     02 FILLER PICTURE X(67) VALUE
019800     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
019900-    " SYSTEM".
020000     02  FILLER     PICTURE X(26)  VALUE SPACE.
020100 01  CCVS-H-2.
020200     02 FILLER PICTURE X(52) VALUE IS
020300     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
020400     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
020500     02 TEST-ID PICTURE IS X(9).
020600     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
020700 01  CCVS-H-3.
020800     02  FILLER PICTURE X(34) VALUE
020900     " FOR OFFICIAL USE ONLY    ".
021000     02  FILLER PICTURE X(58) VALUE
021100     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
021200     02  FILLER PICTURE X(28) VALUE
021300     "  COPYRIGHT   1985 ".
021400 01  CCVS-E-1.
021500     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
021600     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
021700     02 ID-AGAIN PICTURE IS X(9).
021800     02 FILLER PICTURE X(45) VALUE IS
021900     " NTIS DISTRIBUTION COBOL 85".
022000 01  CCVS-E-2.
022100     02  FILLER                   PICTURE X(31)  VALUE
022200     SPACE.
022300     02  FILLER                   PICTURE X(21)  VALUE SPACE.
022400     02 CCVS-E-2-2.
022500         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
022600         03 FILLER PICTURE IS X VALUE IS SPACE.
022700         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
022800 01  CCVS-E-3.
022900     02  FILLER PICTURE X(22) VALUE
023000     " FOR OFFICIAL USE ONLY".
023100     02  FILLER PICTURE X(12) VALUE SPACE.
023200     02  FILLER PICTURE X(58) VALUE
023300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
023400     02  FILLER PICTURE X(13) VALUE SPACE.
023500     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
023600 01  CCVS-E-4.
023700     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
023800     02 FILLER PIC XXXX VALUE " OF ".
023900     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
024000     02 FILLER PIC X(40) VALUE
024100      "  TESTS WERE EXECUTED SUCCESSFULLY".
024200 01  XXINFO.
024300     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
024400     02 INFO-TEXT.
024500     04 FILLER PIC X(20) VALUE SPACE.
024600     04 XXCOMPUTED PIC X(20).
024700     04 FILLER PIC X(5) VALUE SPACE.
024800     04 XXCORRECT PIC X(20).
024900 01  HYPHEN-LINE.
025000     02 FILLER PICTURE IS X VALUE IS SPACE.
025100     02 FILLER PICTURE IS X(65) VALUE IS "************************
025200-    "*****************************************".
025300     02 FILLER PICTURE IS X(54) VALUE IS "************************
025400-    "******************************".
025500 01  CCVS-PGM-ID PIC X(6) VALUE
025600     "SQ216A".
025700 PROCEDURE DIVISION.
025800 CCVS1 SECTION.
025900 OPEN-FILES.
026000P    OPEN I-O RAW-DATA.
026100P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
026200P    READ RAW-DATA INVALID KEY GO TO END-E-1.
026300P    MOVE "ABORTED " TO C-ABORT.
026400P    ADD 1 TO C-NO-OF-TESTS.
026500P    ACCEPT C-DATE  FROM DATE.
026600P    ACCEPT C-TIME  FROM TIME.
026700P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
026800PEND-E-1.
026900P    CLOSE RAW-DATA.
027000     OPEN     OUTPUT PRINT-FILE.
027100     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
027200     MOVE    SPACE TO TEST-RESULTS.
027300     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
027400     MOVE ZERO TO REC-SKL-SUB.
027500     PERFORM CCVS-INIT-FILE 9 TIMES.
027600 CCVS-INIT-FILE.
027700     ADD 1 TO REC-SKL-SUB.
027800     MOVE FILE-RECORD-INFO-SKELETON TO
027900                  FILE-RECORD-INFO (REC-SKL-SUB).
028000 CCVS-INIT-EXIT.
028100     GO TO CCVS1-EXIT.
028200 CLOSE-FILES.
028300     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
028400P    OPEN I-O RAW-DATA.
028500P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
028600P    READ RAW-DATA INVALID KEY GO TO END-E-2.
028700P    MOVE "OK.     " TO C-ABORT.
028800P    MOVE PASS-COUNTER TO C-OK.
028900P    MOVE ERROR-HOLD   TO C-ALL.
029000P    MOVE ERROR-COUNTER TO C-FAIL.
029100P    MOVE DELETE-CNT TO C-DELETED.
029200P    MOVE INSPECT-COUNTER TO C-INSPECT.
029300P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
029400PEND-E-2.
029500P    CLOSE RAW-DATA.
029600 TERMINATE-CCVS.
029700S    EXIT PROGRAM.
029800STERMINATE-CALL.
029900     STOP     RUN.
030000 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
030100 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
030200 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
030300 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
030400     MOVE "****TEST DELETED****" TO RE-MARK.
030500 PRINT-DETAIL.
030600     IF REC-CT NOT EQUAL TO ZERO
030700             MOVE "." TO PARDOT-X
030800             MOVE REC-CT TO DOTVALUE.
030900     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
031000     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
031100        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
031200          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
031300     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
031400     MOVE SPACE TO CORRECT-X.
031500     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
031600     MOVE     SPACE TO RE-MARK.
031700 HEAD-ROUTINE.
031800     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031900     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
032000     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
032100 COLUMN-NAMES-ROUTINE.
032200     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
032300     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
032500 END-ROUTINE.
032600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
032700 END-RTN-EXIT.
032800     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032900 END-ROUTINE-1.
033000      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
033100      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
033200      ADD PASS-COUNTER TO ERROR-HOLD.
033300*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
033400      MOVE PASS-COUNTER TO CCVS-E-4-1.
033500      MOVE ERROR-HOLD TO CCVS-E-4-2.
033600      MOVE CCVS-E-4 TO CCVS-E-2-2.
033700      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
033800  END-ROUTINE-12.
033900      MOVE "TEST(S) FAILED" TO ENDER-DESC.
034000     IF       ERROR-COUNTER IS EQUAL TO ZERO
034100         MOVE "NO " TO ERROR-TOTAL
034200         ELSE
034300         MOVE ERROR-COUNTER TO ERROR-TOTAL.
034400     MOVE     CCVS-E-2 TO DUMMY-RECORD.
034500     PERFORM WRITE-LINE.
034600 END-ROUTINE-13.
034700     IF DELETE-CNT IS EQUAL TO ZERO
034800         MOVE "NO " TO ERROR-TOTAL  ELSE
034900         MOVE DELETE-CNT TO ERROR-TOTAL.
035000     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
035100     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035200      IF   INSPECT-COUNTER EQUAL TO ZERO
035300          MOVE "NO " TO ERROR-TOTAL
035400      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
035500      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
035600      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035700     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035800 WRITE-LINE.
035900     ADD 1 TO RECORD-COUNT.
036000Y    IF RECORD-COUNT GREATER 50
036100Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
036200Y        MOVE SPACE TO DUMMY-RECORD
036300Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
036400Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
036500Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
036600Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
036700Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
036800Y        MOVE ZERO TO RECORD-COUNT.
036900     PERFORM WRT-LN.
037000 WRT-LN.
037100     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
037200     MOVE SPACE TO DUMMY-RECORD.
037300 BLANK-LINE-PRINT.
037400     PERFORM WRT-LN.
037500 FAIL-ROUTINE.
037600     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
037700     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
037800     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
037900     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038000     GO TO FAIL-ROUTINE-EX.
038100 FAIL-ROUTINE-WRITE.
038200     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
038300     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
038400 FAIL-ROUTINE-EX. EXIT.
038500 BAIL-OUT.
038600     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
038700     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
038800 BAIL-OUT-WRITE.
038900     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
039000     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039100 BAIL-OUT-EX. EXIT.
039200 CCVS1-EXIT.
039300     EXIT.
039400 SECT-SQ216A-0001 SECTION.
039500 WRITE-INIT-GF-01.
039600     MOVE "SQ-FS1" TO XFILE-NAME (1).
039700     MOVE "R1-F-G" TO XRECORD-NAME (1).
039800     MOVE "SQ216"     TO XPROGRAM-NAME (1).
039900     MOVE 000120 TO XRECORD-LENGTH (1).
040000     MOVE "RC"   TO CHARS-OR-RECORDS (1).
040100     MOVE 0001   TO XBLOCK-SIZE (1).
040200     MOVE 000750 TO RECORDS-IN-FILE (1).
040300     MOVE "SQ"   TO XFILE-ORGANIZATION (1).
040400     MOVE "S" TO XLABEL-TYPE (1).
040500     MOVE 000001 TO XRECORD-NUMBER (1).
040600     OPEN OUTPUT SQ-FS1.
040700 WRITE-TEST-GF-01.
040800     MOVE FILE-RECORD-INFO-P1-120 (1)  TO SQ-FS1R1-F-G-120.
040900     WRITE SQ-FS1R1-F-G-120.
041000     IF XRECORD-NUMBER (1) EQUAL TO 750
041100         GO TO WRITE-WRITE-GF-01.
041200     ADD 1 TO XRECORD-NUMBER (1).
041300     GO TO WRITE-TEST-GF-01.
041400 WRITE-WRITE-GF-01.
041500     MOVE "CREATE FILE SQ-FS1" TO FEATURE.
041600     MOVE "WRITE-TEST-GF-01" TO PAR-NAME.
041700     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
041800     MOVE  XRECORD-NUMBER (1) TO CORRECT-18V0.
041900     PERFORM PASS.
042000     PERFORM PRINT-DETAIL.
042100     CLOSE SQ-FS1.
042200*        A SEQUENTIAL TAPE FILE WITH 120 CHARACTER RECORDS
042300*    HAS BEEN CREATED. THE FILE CONTAINS 750 RECORDS.
042400 READ-INIT-F1-01.
042500     MOVE ZERO TO WRK-CS-09V00.
042600*        THIS TEST READS AND CHECKS THE FILE CREATED IN
042700*    WRITE-TEST-GF-01.
042800     OPEN INPUT SQ-FS1.
042900 READ-TEST-F1-01.
043000     READ SQ-FS1
043100          AT END GO TO READ-TEST-F1-01-1.
043200     MOVE   SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
043300     ADD 1 TO WRK-CS-09V00.
043400     IF WRK-CS-09V00 GREATER THAN 750
043500        MOVE "MORE THAN 750 RECORDS" TO RE-MARK
043600        GO TO READ-FAIL-F1-01.
043700     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
043800         ADD 1 TO RECORDS-IN-ERROR
043900         GO TO READ-TEST-F1-01.
044000     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS1"
044100        ADD 1 TO RECORDS-IN-ERROR
044200        GO TO READ-TEST-F1-01.
044300     IF XLABEL-TYPE (1) NOT EQUAL TO "S"
044400        ADD 1 TO RECORDS-IN-ERROR.
044500     GO TO READ-TEST-F1-01.
044600 READ-TEST-F1-01-1.
044700     IF RECORDS-IN-ERROR EQUAL TO ZERO
044800         GO TO READ-PASS-F1-01.
044900     MOVE "ERRORS IN READING SQ-FS1" TO RE-MARK.
045000 READ-FAIL-F1-01.
045100     MOVE "VII-12; PADDING CHARACTER"  TO RE-MARK.
045200     MOVE "RECORDS IN ERROR =" TO COMPUTED-A.
045300     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
045400     PERFORM FAIL.
045500     GO TO READ-WRITE-F1-01.
045600 READ-PASS-F1-01.
045700     PERFORM PASS.
045800     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
045900     MOVE WRK-CS-09V00 TO CORRECT-18V0.
046000 READ-WRITE-F1-01.
046100     MOVE "READ-TEST-F1-01"  TO PAR-NAME.
046200     MOVE "VERIFY FILE SQ-FS1" TO FEATURE.
046300     PERFORM PRINT-DETAIL.
046400 READ-CLOSE-F1-01.
046500     CLOSE SQ-FS1.
046600 READ-INIT-F1-02.
046700     MOVE ZERO TO WRK-CS-09V00.
046800     MOVE ZERO TO RECORDS-IN-ERROR.
046900     OPEN INPUT   SQ-FS1.
047000*            FOUR OPTIONS FOR THE READ STATEMENT ARE CHECKED
047100*    IN THIS SERIES OF TESTS.
047200     MOVE "LEV 2 PADDING CHARS " TO FEATURE.
047300     MOVE "READ...RECORD AT END ..." TO RE-MARK.
047400     MOVE "READ-TEST-F1-02" TO PAR-NAME.
047500     MOVE ZERO TO ERROR-FLAG.
047600 READ-TEST-F1-02.
047700     READ SQ-FS1 RECORD AT END
047800              MOVE "UNEXPECTED EOF" TO COMPUTED-A
047900              MOVE 1 TO EOF-FLAG
048000              GO TO READ-FAIL-F1-02.
048100     PERFORM RECORD-CHECK.
048200     IF WRK-CS-09V00 EQUAL TO 200
048300              GO TO READ-TEST-F1-02-1.
048400             GO TO READ-TEST-F1-02.
048500 RECORD-CHECK.
048600     MOVE SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
048700     ADD 1 TO WRK-CS-09V00.
048800     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
048900         ADD 1 TO RECORDS-IN-ERROR
049000         MOVE 1 TO ERROR-FLAG.
049100 READ-TEST-F1-02-1.
049200     IF ERROR-FLAG EQUAL TO ZERO
049300         GO TO READ-PASS-F1-02.
049400     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
049500 READ-FAIL-F1-02.
049600     PERFORM FAIL.
049700     GO TO READ-WRITE-F1-02.
049800 READ-PASS-F1-02.
049900     PERFORM PASS.
050000 READ-WRITE-F1-02.
050100     PERFORM PRINT-DETAIL.
050200 READ-INIT-F1-F1-03.
050300     IF EOF-FLAG EQUAL TO 1
050400        GO TO  READ-EOF-06.
050500     MOVE ZERO TO ERROR-FLAG.
050600     MOVE "READ...AT END..." TO RE-MARK.
050700     MOVE "READ-TEST-F1-03" TO PAR-NAME.
050800 READ-TEST-F1-03.
050900     READ SQ-FS1 AT END
051000         MOVE "UNEXPECTED EOF" TO COMPUTED-A
051100         MOVE 1 TO EOF-FLAG
051200         GO TO READ-FAIL-F1-03.
051300     PERFORM RECORD-CHECK.
051400     IF WRK-CS-09V00 EQUAL TO 400
051500         GO TO READ-TEST-F1-03-1.
051600     GO TO READ-TEST-F1-03.
051700 READ-TEST-F1-03-1.
051800     IF ERROR-FLAG EQUAL TO ZERO
051900         GO TO READ-PASS-F1-03.
052000     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
052100 READ-FAIL-F1-03.
052200     MOVE "VII-12; PADDING CHARACTER"  TO RE-MARK.
052300     PERFORM FAIL.
052400     GO TO READ-WRITE-F1-03.
052500 READ-PASS-F1-03.
052600     PERFORM PASS.
052700 READ-WRITE-F1-03.
052800     PERFORM PRINT-DETAIL.
052900 READ-INIT-F1-04.
053000     IF EOF-FLAG EQUAL TO 1
053100        GO TO  READ-EOF-06.
053200     MOVE ZERO TO ERROR-FLAG.
053300     MOVE "READ...RECORD END..." TO RE-MARK.
053400     MOVE "READ-TEST-F1-04" TO PAR-NAME.
053500 READ-TEST-F1-04.
053600     READ SQ-FS1 RECORD END
053700          MOVE "UNEXPECTED EOF" TO COMPUTED-A
053800          MOVE 1 TO EOF-FLAG
053900          GO TO READ-FAIL-F1-04.
054000     PERFORM RECORD-CHECK.
054100     IF WRK-CS-09V00 EQUAL TO 600
054200         GO TO READ-TEST-F1-04-1.
054300     GO TO READ-TEST-F1-04.
054400 READ-TEST-F1-04-1.
054500     IF ERROR-FLAG EQUAL TO ZERO
054600         GO TO READ-PASS-F1-04.
054700     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
054800 READ-FAIL-F1-04.
054900     MOVE "VII-12; PADDING CHARACTER"  TO RE-MARK.
055000     PERFORM FAIL.
055100     GO TO READ-WRITE-F1-04.
055200 READ-PASS-F1-04.
055300     PERFORM PASS.
055400 READ-WRITE-F1-04.
055500     PERFORM PRINT-DETAIL.
055600 READ-INIT-F1-05.
055700     IF EOF-FLAG EQUAL TO 1
055800         GO TO  READ-EOF-06.
055900     MOVE ZERO TO ERROR-FLAG.
056000     MOVE "READ...END..." TO RE-MARK.
056100     MOVE  "READ-TEST-F1-05" TO PAR-NAME.
056200 READ-TEST-F1-05.
056300     READ SQ-FS1 END GO TO READ-TEST-F1-05-1.
056400     PERFORM RECORD-CHECK.
056500     IF WRK-CS-09V00 GREATER THAN 750
056600          GO TO READ-TEST-F1-05-1.
056700     GO TO READ-TEST-F1-05.
056800 READ-TEST-F1-05-1.
056900     IF ERROR-FLAG EQUAL TO ZERO
057000          GO TO READ-PASS-F1-05.
057100 READ-FAIL-F1-05.
057200     MOVE "VII-12; PADDING CHARACTER"  TO RE-MARK.
057300     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
057400     PERFORM FAIL.
057500     GO TO READ-WRITE-F1-05.
057600 READ-PASS-F1-05.
057700     PERFORM PASS.
057800 READ-WRITE-F1-05.
057900     PERFORM PRINT-DETAIL.
058000 READ-TEST-06.
058100     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
058200          MOVE "RECORDS IN ERROR =" TO COMPUTED-A
058300          MOVE "VII-12; PADDING CHARACTER"  TO RE-MARK
058400          MOVE RECORDS-IN-ERROR TO CORRECT-18V0
058500          GO TO READ-FAIL-06.
058600     IF WRK-CS-09V00 GREATER THAN 750
058700     MOVE "MORE THAN 750 RECORDS; VII-12 PADDING CHARS" TO RE-MARK
058800          GO TO READ-FAIL-06.
058900 READ-PASS-06.
059000     PERFORM PASS.
059100     GO TO READ-WRITE-06.
059200 READ-EOF-06.
059300     MOVE "LESS THAN 750 RECORDS" TO RE-MARK.
059400     MOVE "RECORDS READ =" TO COMPUTED-A.
059500     MOVE WRK-CS-09V00 TO CORRECT-18V0.
059600 READ-FAIL-06.
059700     PERFORM FAIL.
059800 READ-WRITE-06.
059900     MOVE "READ-TEST-06 "  TO PAR-NAME.
060000     MOVE "READ FILE SQ-FS1" TO FEATURE.
060100     PERFORM PRINT-DETAIL.
060200 READ-CLOSE-003.
060300     CLOSE SQ-FS1.
060400 TERMINATE-ROUTINE.
060500     EXIT.
060600 CCVS-EXIT SECTION.
060700 CCVS-999999.
060800     GO TO CLOSE-FILES.
