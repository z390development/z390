000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     CM202M.
000400 AUTHOR.
000500     FEDERAL COMPILER TESTING CENTER.
000600 INSTALLATION.
000700     GENERAL SERVICES ADMINISTRATION
000800     AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
000900     SOFTWARE DEVELOPMENT OFFICE.
001000     5203 LEESBURG PIKE  SUITE 1100
001100     FALLS CHURCH VIRGINIA 22041.
001200
001300     PHONE   (703) 756-6153
001400
001500     " HIGH       ".
001600 DATE-WRITTEN.
001700     CCVS-74 VERSION 4.0 - 1980 JULY 1.
001800     CREATION DATE     /    VALIDATION DATE
001900     "4.2 ".
002000 SECURITY.
002100     NONE.
002200 ENVIRONMENT DIVISION.
002300 CONFIGURATION SECTION.
002400 SOURCE-COMPUTER.
002500     XXXXX082.
002600 OBJECT-COMPUTER.
002700     XXXXX083.
002800 INPUT-OUTPUT SECTION.
002900 FILE-CONTROL.
003000     SELECT PRINT-FILE ASSIGN TO
003100     XXXXX055.
003200 DATA DIVISION.
003300 FILE SECTION.
003400 FD  PRINT-FILE
003500     LABEL RECORDS
003600     XXXXX084
003700     DATA RECORD IS PRINT-REC DUMMY-RECORD.
003800 01  PRINT-REC PICTURE X(120).
003900 01  DUMMY-RECORD PICTURE X(120).
004000 WORKING-STORAGE SECTION.
004100 77  END-FLAG PIC 9.
004200 77  FAIL-SAFE PIC 999 COMP.
004300 77  ELAPSED-TIME PIC 999.
004400 77  ENABLE-ALL-MSG PIC X(57) VALUE
004500     "ATTEMPT TO ENTER MESSAGES.  BOTH SOURCES ARE NOW ENABLED.".
004600 01  INIT-TIME.
004700     02  I-HRS PIC 99.
004800     02  I-MINS PIC 99.
004900     02  I-SECS PIC 99V99.
005000 01  TEST-TIME.
005100     02  T-HRS PIC 99.
005200     02  T-MINS PIC 99.
005300     02  T-SECS PIC 99V99.
005400 01  SKIP-MSG-1 PIC X(71) VALUE "SEGMENTED-MSG-TEST-05: THERE SHOU
005500-    "LD BE NO BLANK LINES BETWEEN THIS LINE".
005600 01  SKIP-MSG-2 PIC X(17) VALUE "AND THIS ONE.".
005700 01  INCOMP-MSG.
005800     02  FILLER PIC X(20) VALUE "INCOMPLETE-MSG-TEST-".
005900     02  INC-MSG-NO PIC 99.
006000     02  FILLER PIC X(33) VALUE " FAILURE IF THIS SEGMENT APPEARS.
006100-    "".
006200 01  ENABLE-MSG.
006300     02  FILLER PIC X(34) VALUE "ATTEMPT TO ENTER MESSAGES.  ONLY
006400-    """".
006500     02  SELECTED-SOURCE PIC X(12).
006600     02  FILLER PIC X(13) VALUE """ IS ENABLED.".
006700 01  DISABLE-MSG.
006800     02  FILLER PIC X(36) VALUE
006900     "TERMINALS DEACTIVATED FOR INPUT:    ".
007000     02  TERMINAL-1 PIC X(14) VALUE
007100     XXXXX042.
007200     02  TERMINAL-2 PIC X(12) VALUE
007300     XXXXX043.
007400 01  SEND-MSG.
007500     02  FILLER PIC X(17) VALUE "SEND-STATUS-TEST-".
007600     02  TEST-NUMB PIC 99 VALUE 1.
007700     02  FILLER PIC X(42) VALUE
007800     " FAILURE.  THIS MESSAGE SHOULD NOT APPEAR.".
007900 01  ONE-TERMINAL-MSG.
008000     02  FILLER PIC X(15) VALUE "ONLY TERMINAL """.
008100     02  SELECTED-DEST PIC X(12) VALUE
008200     XXXXX032.
008300     02  FILLER PIC X(30) VALUE
008400     """ SHOULD RECEIVE THIS MESSAGE.".
008500 01  SEG-INIT.
008600     02  FILLER PIC X(19) VALUE "SEGMENTED-MSG-TEST-".
008700     02  SEG-TEST-NO PIC 99.
008800     02  FILLER PIC X(19) VALUE " SEGMENT INITIATED ".
008900     02  FILLER PIC X(16) VALUE "-LENGTH FAILURE ".
009000 01  SEG-CONT PIC X(10) VALUE "-CONTINUED".
009100 01  MSG-COMP PIC X(14) VALUE "-MSG COMPLETE.".
009200 01  GROUP-COMP PIC X(16) VALUE "-GROUP COMPLETE.".
009300 01  TEST-RESULTS.
009400     02 FILLER                    PICTURE X VALUE SPACE.
009500     02 FEATURE                   PICTURE X(18).
009600     02 FILLER                    PICTURE X VALUE SPACE.
009700     02 P-OR-F                    PICTURE X(5).
009800     02 FILLER                    PICTURE X  VALUE SPACE.
009900     02  PAR-NAME PIC X(20).
010000     02 FILLER                    PICTURE X VALUE SPACE.
010100     02  COMPUTED-A.
010200         03  FILLER PIC X(9).
010300         03  COMPUTED-STATUS PIC XX.
010400         03  FILLER PIC X(9).
010500     02 FILLER                    PICTURE X VALUE SPACE.
010600     02  CORRECT-A.
010700         03  FILLER PIC X(9).
010800         03  CORRECT-STATUS PIC XX.
010900         03  FILLER PIC X(9).
011000     02 FILLER                    PICTURE X VALUE SPACE.
011100     02  RE-MARK.
011200         03  MSG-1 PIC X.
011300         03  FILLER PIC X(29).
011400 01  COLUMNS-LINE-1.
011500     02  FILLER PIC X(3) VALUE SPACES.
011600     02  FILLER PIC X(17) VALUE "FEATURE TESTED".
011700     02  FILLER PIC X(9) VALUE "RESLT".
011800     02  FILLER PIC X(21) VALUE "PARAGRAPH NAME".
011900     02  FILLER PIC X(22) VALUE "COMPUTED DATA".
012000     02  FILLER PIC X(29) VALUE "CORRECT DATA".
012100     02  FILLER PIC X(7) VALUE "REMARKS".
012200 01  COLUMNS-LINE-2.
012300     02  FILLER PIC X VALUE SPACE.
012400     02  FILLER PIC X(18) VALUE ALL "-".
012500     02  FILLER PIC X VALUE SPACE.
012600     02  FILLER PIC X(5) VALUE ALL "-".
012700     02  FILLER PIC X VALUE SPACE.
012800     02  FILLER PIC X(20) VALUE ALL "-".
012900     02  FILLER PIC X VALUE SPACE.
013000     02  FILLER PIC X(20) VALUE ALL "-".
013100     02  FILLER PIC X VALUE SPACE.
013200     02  FILLER PIC X(20) VALUE ALL "-".
013300     02  FILLER PIC X VALUE SPACE.
013400     02  FILLER PIC X(31) VALUE ALL "-".
013500 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
013600 01  REC-CT PICTURE 99 VALUE ZERO.
013700 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
013800 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
013900 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
014000 01  PASS-COUNTER PIC 999 VALUE ZERO.
014100 01  TOTAL-ERROR PIC 999 VALUE ZERO.
014200 01  ERROR-HOLD PIC 999 VALUE ZERO.
014300 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
014400 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
014500 01  CCVS-H-1.
014600     02  FILLER   PICTURE X(27)  VALUE SPACE.
014700     02 FILLER PICTURE X(67) VALUE
014800     " FEDERAL COMPILER TESTING CENTER COBOL COMPILER VALIDATION
014900-    " SYSTEM".
015000     02  FILLER     PICTURE X(26)  VALUE SPACE.
015100 01  CCVS-H-2.
015200     02 FILLER PICTURE X(52) VALUE IS
015300     "CCVS74 NCC  COPY, NOT FOR DISTRIBUTION.".
015400     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
015500     02 TEST-ID PICTURE IS X(9).
015600     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
015700 01  CCVS-H-3.
015800     02  FILLER PICTURE X(34) VALUE
015900     " FOR OFFICIAL USE ONLY    ".
016000     02  FILLER PICTURE X(58) VALUE
016100     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
016200     02  FILLER PICTURE X(28) VALUE
016300     "  COPYRIGHT   1974 ".
016400 01  CCVS-E-1.
016500     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
016600     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
016700     02 ID-AGAIN PICTURE IS X(9).
016800     02 FILLER PICTURE X(45) VALUE IS
016900     " NTIS DISTRIBUTION COBOL 74".
017000 01  CCVS-E-2.
017100     02  FILLER                   PICTURE X(31)  VALUE
017200     SPACE.
017300     02  FILLER                   PICTURE X(21)  VALUE SPACE.
017400     02 CCVS-E-2-2.
017500         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
017600         03 FILLER PICTURE IS X VALUE IS SPACE.
017700         03 ENDER-DESC PIC X(44) VALUE "ERRORS ENCOUNTERED".
017800 01  CCVS-E-3.
017900     02  FILLER PICTURE X(22) VALUE
018000     " FOR OFFICIAL USE ONLY".
018100     02  FILLER PICTURE X(12) VALUE SPACE.
018200     02  FILLER PICTURE X(58) VALUE
018300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
018400     02  FILLER PICTURE X(13) VALUE SPACE.
018500     02 FILLER PIC X(15) VALUE " COPYRIGHT 1974".
018600 01  CCVS-E-4.
018700     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
018800     02 FILLER PIC XXXX VALUE " OF ".
018900     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
019000     02 FILLER PIC X(40) VALUE
019100      "  TESTS WERE EXECUTED SUCCESSFULLY".
019200 01  XXINFO.
019300     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
019400     02 INFO-TEXT.
019500     04 FILLER PIC X(20) VALUE SPACE.
019600     04 XXCOMPUTED PIC X(20).
019700     04 FILLER PIC X(5) VALUE SPACE.
019800     04 XXCORRECT PIC X(20).
019900 01  HYPHEN-LINE.
020000     02 FILLER PICTURE IS X VALUE IS SPACE.
020100     02 FILLER PICTURE IS X(65) VALUE IS "************************
020200-    "*****************************************".
020300     02 FILLER PICTURE IS X(54) VALUE IS "************************
020400-    "******************************".
020500 01  CCVS-PGM-ID PIC X(6) VALUE
020600     "CM202M".
020700 COMMUNICATION SECTION.
020800 CD  CM-INQUE-1 INPUT.
020900 01  INQUE-1-RECORD.
021000     02  QUEUE-SET PIC X(12) VALUE
021100     XXXXX030.
021200     02  FILLER PIC X(36) VALUE SPACES.
021300     02  FILLER PIC X(14).
021400     02  SYM-SOURCE PIC X(12).
021500     02  IN-LENGTH PIC 9999.
021600     02  END-KEY PIC X.
021700     02  IN-STATUS PIC XX.
021800     02  MSG-COUNT PIC 9(6).
021900 CD  CM-OUTQUE-1 OUTPUT
022000     DESTINATION COUNT DEST-COUNT
022100     TEXT LENGTH OUT-LENGTH
022200     STATUS KEY OUT-STATUS
022300     DESTINATION TABLE OCCURS 2 TIMES INDEXED BY I1
022400     ERROR KEY ERR-KEY
022500     DESTINATION SYM-DEST.
022600 PROCEDURE    DIVISION.
022700 SECT-CM202M-0001 SECTION.
022800 CM202M-INIT.
022900     OPEN     OUTPUT PRINT-FILE.
023000     MOVE "CM202M     " TO TEST-ID.
023100     MOVE     TEST-ID TO ID-AGAIN.
023200     MOVE    SPACE TO TEST-RESULTS.
023300     PERFORM HEAD-ROUTINE.
023400     MOVE 2 TO DEST-COUNT
023500     MOVE
023600     XXXXX032
023700         TO SYM-DEST (1).
023800     MOVE
023900     XXXXX035
024000         TO SYM-DEST (2).
024100     ENABLE OUTPUT CM-OUTQUE-1 WITH KEY
024200     XXXXX033.
024300     MOVE
024400     XXXXX042
024500         TO SELECTED-SOURCE  SYM-SOURCE.
024600     MOVE 59 TO OUT-LENGTH.
024700     SEND CM-OUTQUE-1 FROM ENABLE-MSG WITH EMI.
024800     ENABLE INPUT TERMINAL CM-INQUE-1 WITH KEY
024900     XXXXX031.
025000     PERFORM DELAY-FOR-30.
025100     DISABLE INPUT TERMINAL CM-INQUE-1 WITH KEY
025200     XXXXX031.
025300     MOVE
025400     XXXXX043
025500         TO SELECTED-SOURCE  SYM-SOURCE.
025600     SEND CM-OUTQUE-1 FROM ENABLE-MSG WITH EMI.
025700     ENABLE INPUT TERMINAL CM-INQUE-1 WITH KEY
025800     XXXXX031.
025900     PERFORM DELAY-FOR-30.
026000     MOVE 57 TO OUT-LENGTH.
026100     SEND CM-OUTQUE-1 FROM ENABLE-ALL-MSG WITH EMI.
026200     MOVE
026300     XXXXX042
026400         TO SYM-SOURCE.
026500     ENABLE INPUT TERMINAL CM-INQUE-1 WITH KEY
026600     XXXXX031.
026700     PERFORM DELAY-FOR-30.
026800     DISABLE INPUT TERMINAL CM-INQUE-1 WITH KEY
026900     XXXXX031.
027000     MOVE
027100     XXXXX043
027200         TO SYM-SOURCE.
027300     DISABLE INPUT TERMINAL CM-INQUE-1 WITH KEY
027400     XXXXX031.
027500     MOVE 62 TO OUT-LENGTH.
027600     SEND CM-OUTQUE-1 FROM DISABLE-MSG WITH EMI.
027700     PERFORM DELAY-FOR-30.
027800 BEGIN-CM202M-STATUS-TESTS.
027900     MOVE 200 TO FAIL-SAFE.
028000     MOVE "RCV MSG/SHORT AREA" TO FEATURE.
028100     MOVE "RECEIVE-TEST-01" TO PAR-NAME.
028200     MOVE " SEE REMARKS COLUMN " TO COMPUTED-A.
028300     MOVE "  INSPECT RESULTS" TO CORRECT-A.
028400 RECEIVE-TEST-01.
028500     RECEIVE CM-INQUE-1 MESSAGE INTO MSG-1  NO DATA
028600         MOVE "QUEUE TESTED EMPTY" TO COMPUTED-A
028700         MOVE SPACES TO CORRECT-A RE-MARK
028800         PERFORM FAIL  PERFORM PRINT-DETAIL
028900         GO TO RECEIVE-TEST-02-INIT.
029000     IF END-KEY IS EQUAL TO "1"
029100         MOVE SPACE TO CORRECT-A
029200         MOVE "   ESI WAS SENSED   " TO COMPUTED-A
029300         PERFORM FAIL
029400         PERFORM PRINT-DETAIL
029500         GO TO RECEIVE-TEST-02-INIT.
029600     PERFORM PRINT-DETAIL.
029700     IF END-KEY IS NOT EQUAL TO "0" GO TO RECEIVE-TEST-02-INIT.
029800     MOVE "RECEIVE-TEST-01-CONT" TO PAR-NAME.
029900     SUBTRACT 1 FROM FAIL-SAFE.
030000     IF FAIL-SAFE IS EQUAL TO 0
030100         MOVE "FAIL-SAFE ACTIVATED" TO CORRECT-A
030200         MOVE "****** WARNING *****" TO COMPUTED-A
030300         PERFORM PRINT-DETAIL
030400         GO TO RECEIVE-TEST-02-INIT.
030500     PERFORM PRINT-DETAIL.
030600     GO TO RECEIVE-TEST-01.
030700 RECEIVE-DELETE-01.
030800     PERFORM DE-LETE.
030900     PERFORM PRINT-DETAIL.
031000 RECEIVE-TEST-02-INIT.
031100     MOVE 200 TO FAIL-SAFE.
031200     MOVE "RCV SEG/SHORT AREA" TO FEATURE.
031300     MOVE "RECEIVE-TEST-02" TO PAR-NAME.
031400     MOVE " SEE REMARKS COLUMN " TO COMPUTED-A.
031500     MOVE "  INSPECT RESULTS" TO CORRECT-A.
031600 RECEIVE-TEST-02.
031700     RECEIVE CM-INQUE-1 SEGMENT INTO MSG-1  NO DATA
031800         MOVE "QUEUE TESTED EMPTY" TO COMPUTED-A
031900         MOVE SPACES TO CORRECT-A  RE-MARK
032000         PERFORM FAIL  PERFORM PRINT-DETAIL
032100         GO TO RECEIVE-TEST-03-INIT.
032200     PERFORM PRINT-DETAIL.
032300     IF END-KEY IS NOT EQUAL TO "0" GO TO RECEIVE-TEST-03-INIT.
032400     MOVE "RECEIVE-TEST-02-CONT" TO PAR-NAME.
032500     SUBTRACT 1 FROM FAIL-SAFE.
032600     IF FAIL-SAFE IS EQUAL TO 0
032700         MOVE "FAIL-SAFE ACTIVATED" TO CORRECT-A
032800         MOVE "****** WARNING *****" TO COMPUTED-A
032900         PERFORM PRINT-DETAIL
033000         GO TO RECEIVE-TEST-03-INIT.
033100     PERFORM PRINT-DETAIL.
033200     GO TO RECEIVE-TEST-02.
033300 RECEIVE-DELETE-02.
033400     PERFORM DE-LETE.
033500     PERFORM PRINT-DETAIL.
033600 RECEIVE-TEST-03-INIT.
033700     MOVE "RCV SEG REPEATEDLY" TO FEATURE.
033800     MOVE "RECEIVE-TEST-03" TO PAR-NAME.
033900 RECEIVE-TEST-03.
034000     MOVE "COMPTD SHOWS END KEY" TO CORRECT-A.
034100     MOVE ALL "*" TO RE-MARK.
034200     RECEIVE CM-INQUE-1 SEGMENT INTO RE-MARK
034300         NO DATA GO TO ENABL-STATUS-TEST-01.
034400     MOVE END-KEY TO COMPUTED-STATUS.
034500     PERFORM PRINT-DETAIL.
034600     MOVE "RECEIVE-TEST-03-CONT" TO PAR-NAME.
034700     GO TO RECEIVE-TEST-03.
034800 RECEIVE-DELETE-03.
034900     PERFORM DE-LETE.
035000     PERFORM PRINT-DETAIL.
035100 ENABL-STATUS-TEST-01.
035200     MOVE "ENABLE TERMINAL" TO FEATURE.
035300     MOVE "BAD PASSWORD SUPPLIED" TO RE-MARK.
035400     ENABLE INPUT TERMINAL CM-INQUE-1 WITH KEY "GARBAGE".
035500     IF IN-STATUS IS EQUAL TO "40"
035600         PERFORM PASS GO TO ENABL-STATUS-WRITE-01.
035700     MOVE IN-STATUS TO COMPUTED-STATUS.
035800     MOVE "40" TO CORRECT-STATUS.
035900     PERFORM FAIL.
036000     GO TO ENABL-STATUS-WRITE-01.
036100 ENABL-STATUS-DELETE-01.
036200     PERFORM DE-LETE.
036300 ENABL-STATUS-WRITE-01.
036400     MOVE "ENABL-STATUS-TEST-01" TO PAR-NAME.
036500     PERFORM PRINT-DETAIL.
036600 ENABL-STATUS-TEST-02.
036700     MOVE "BAD SOURCE NAME USED" TO RE-MARK.
036800     MOVE "GARBAGE" TO SYM-SOURCE.
036900     ENABLE INPUT TERMINAL CM-INQUE-1 WITH KEY
037000     XXXXX031.
037100     IF IN-STATUS IS EQUAL TO "21"
037200         PERFORM PASS  GO TO ENABL-STATUS-WRITE-02.
037300     MOVE IN-STATUS TO COMPUTED-STATUS.
037400     MOVE "21" TO CORRECT-STATUS.
037500     PERFORM FAIL.
037600     GO TO ENABL-STATUS-WRITE-02.
037700 ENABL-STATUS-DELETE-02.
037800     PERFORM DE-LETE.
037900 ENABL-STATUS-WRITE-02.
038000     MOVE "ENABL-STATUS-TEST-02" TO PAR-NAME.
038100     PERFORM PRINT-DETAIL.
038200 DISAB-STATUS-TEST-01.
038300     MOVE "DISABLE TERMINAL" TO FEATURE.
038400     MOVE "BAD PASSWORD SUPPLIED" TO RE-MARK.
038500     MOVE
038600     XXXXX042
038700         TO SYM-SOURCE.
038800     DISABLE INPUT TERMINAL CM-INQUE-1 WITH KEY "GARBAGE".
038900     IF IN-STATUS IS EQUAL TO "40"
039000         PERFORM PASS  GO TO DISAB-STATUS-WRITE-01.
039100     MOVE IN-STATUS TO COMPUTED-STATUS.
039200     MOVE "40" TO CORRECT-STATUS.
039300     PERFORM FAIL.
039400     GO TO DISAB-STATUS-WRITE-01.
039500 DISAB-STATUS-DELETE-01.
039600     PERFORM DE-LETE.
039700 DISAB-STATUS-WRITE-01.
039800     MOVE "DISAB-STATUS-TEST-01" TO PAR-NAME.
039900     PERFORM PRINT-DETAIL.
040000 DISAB-STATUS-TEST-02.
040100     MOVE "BAD SOURCE NAME USED" TO RE-MARK.
040200     MOVE "GARBAGE" TO SYM-SOURCE.
040300     DISABLE INPUT TERMINAL CM-INQUE-1 WITH KEY
040400     XXXXX031.
040500     IF IN-STATUS IS EQUAL TO "21"
040600         PERFORM PASS  GO TO DISAB-STATUS-WRITE-02.
040700     MOVE IN-STATUS TO COMPUTED-STATUS.
040800     MOVE "21" TO CORRECT-STATUS.
040900     PERFORM FAIL.
041000     GO TO DISAB-STATUS-WRITE-02.
041100 DISAB-STATUS-DELETE-02.
041200     PERFORM DE-LETE.
041300 DISAB-STATUS-WRITE-02.
041400     MOVE "DISAB-STATUS-TEST-02" TO PAR-NAME.
041500     PERFORM PRINT-DETAIL.
041600 SEND-STATUS-TEST-01.
041700     MOVE "COUNT EXCEEDS LIMIT" TO RE-MARK.
041800     MOVE 3 TO DEST-COUNT.
041900     MOVE 61 TO OUT-LENGTH.
042000     SEND CM-OUTQUE-1 FROM SEND-MSG WITH EMI.
042100     IF OUT-STATUS IS EQUAL TO "30"
042200         PERFORM PASS  GO TO SEND-STATUS-WRITE-01.
042300     MOVE OUT-STATUS TO COMPUTED-STATUS.
042400     MOVE "30" TO CORRECT-STATUS.
042500     PERFORM FAIL.
042600     GO TO SEND-STATUS-WRITE-01.
042700 SEND-STATUS-DELETE-01.
042800     PERFORM DE-LETE.
042900 SEND-STATUS-WRITE-01.
043000     MOVE "DESTINATION COUNT" TO FEATURE.
043100     MOVE "SEND-STATUS-TEST-01" TO PAR-NAME.
043200     PERFORM PRINT-DETAIL.
043300     MOVE 2 TO DEST-COUNT.
043400 SEND-STATUS-TEST-02.
043500     MOVE 2 TO TEST-NUMB.
043600     MOVE 0 TO OUT-LENGTH.
043700     SEND CM-OUTQUE-1 FROM SEND-MSG.
043800     IF OUT-STATUS IS EQUAL TO "60"
043900         PERFORM PASS  GO TO SEND-STATUS-WRITE-02.
044000     MOVE OUT-STATUS TO COMPUTED-STATUS.
044100     MOVE "60" TO CORRECT-STATUS.
044200     PERFORM FAIL.
044300     GO TO SEND-STATUS-WRITE-02.
044400 SEND-STATUS-DELETE-02.
044500     PERFORM DE-LETE.
044600 SEND-STATUS-WRITE-02.
044700     MOVE "PARTIAL SEGMENT" TO FEATURE.
044800     MOVE "ZERO CHARACTER COUNT USED" TO RE-MARK.
044900     MOVE "SEND-STATUS-TEST-02" TO PAR-NAME.
045000     PERFORM PRINT-DETAIL.
045100 SEND-STATUS-TEST-03.
045200     MOVE 0 TO END-FLAG.
045300     MOVE 3 TO TEST-NUMB.
045400     MOVE 61 TO OUT-LENGTH.
045500     SEND CM-OUTQUE-1 WITH END-FLAG.
045600     IF OUT-STATUS IS EQUAL TO "60"
045700         PERFORM PASS  GO TO SEND-STATUS-WRITE-03.
045800     MOVE OUT-STATUS TO COMPUTED-STATUS.
045900     MOVE "60" TO CORRECT-STATUS.
046000     PERFORM FAIL.
046100     GO TO SEND-STATUS-WRITE-03.
046200 SEND-STATUS-DELETE-03.
046300     PERFORM DE-LETE.
046400 SEND-STATUS-WRITE-03.
046500     MOVE "NO SENDING AREA SPECIFIED" TO RE-MARK.
046600     MOVE "SEND-STATUS-TEST-03" TO PAR-NAME.
046700     PERFORM PRINT-DETAIL.
046800 SEND-STATUS-TEST-04.
046900     MOVE 57 TO OUT-LENGTH.
047000     MOVE "GARBAGE" TO SYM-DEST (2).
047100     SEND CM-OUTQUE-1 FROM ONE-TERMINAL-MSG WITH EMI.
047200     IF OUT-STATUS IS NOT EQUAL TO "20"
047300         MOVE OUT-STATUS TO COMPUTED-STATUS
047400         MOVE "STATUS SHOULD BE 20" TO CORRECT-A
047500         PERFORM FAIL
047600     ELSE IF ERR-KEY (2) IS NOT EQUAL TO "1"
047700         MOVE ERR-KEY (2) TO COMPUTED-STATUS
047800         MOVE " ERROR KEY (2) = 1" TO CORRECT-A
047900         PERFORM FAIL
048000     ELSE IF ERR-KEY (1) IS NOT EQUAL TO "0"
048100         MOVE ERR-KEY (1) TO COMPUTED-STATUS
048200         MOVE " ERROR KEY (1) = 0" TO CORRECT-A
048300         PERFORM FAIL
048400     ELSE PERFORM PASS.
048500     GO TO SEND-STATUS-WRITE-04.
048600 SEND-STATUS-DELETE-04.
048700     PERFORM DE-LETE.
048800 SEND-STATUS-WRITE-04.
048900     MOVE "SYMBOLIC DESTINAT""N (2) IS BAD" TO RE-MARK.
049000     MOVE "SEND-STATUS-TEST-04" TO PAR-NAME.
049100     PERFORM PRINT-DETAIL.
049200     MOVE
049300     XXXXX035
049400         TO SYM-DEST (2).
049500 SEGMENTED-MSG-TEST-01.
049600     MOVE 1 TO SEG-TEST-NO.
049700     MOVE 39 TO OUT-LENGTH.
049800     SEND CM-OUTQUE-1 FROM SEG-INIT WITH ESI.
049900     MOVE 14 TO OUT-LENGTH.
050000     SEND CM-OUTQUE-1 FROM MSG-COMP WITH EMI.
050100 SEGMENTED-MSG-TEST-02.
050200     MOVE 2 TO SEG-TEST-NO.
050300     MOVE 39 TO OUT-LENGTH.
050400     SEND CM-OUTQUE-1 FROM SEG-INIT WITH ESI.
050500     MOVE 16 TO OUT-LENGTH.
050600     SEND CM-OUTQUE-1 FROM GROUP-COMP WITH EGI.
050700 SEGMENTED-MSG-TEST-03.
050800     MOVE 3 TO SEG-TEST-NO.
050900     MOVE 39 TO OUT-LENGTH.
051000     SEND CM-OUTQUE-1 FROM SEG-INIT.
051100     MOVE 10 TO OUT-LENGTH.
051200     SEND CM-OUTQUE-1 FROM SEG-CONT WITH ESI.
051300     MOVE 14 TO OUT-LENGTH.
051400     SEND CM-OUTQUE-1 FROM MSG-COMP WITH EMI.
051500 SEGMENTED-MSG-TEST-04.
051600     MOVE 4 TO SEG-TEST-NO.
051700     MOVE 0 TO END-FLAG.
051800     MOVE 39 TO OUT-LENGTH.
051900     SEND CM-OUTQUE-1 FROM SEG-INIT WITH END-FLAG.
052000     MOVE 1 TO END-FLAG.
052100     MOVE 10 TO OUT-LENGTH.
052200     SEND CM-OUTQUE-1 FROM SEG-CONT WITH END-FLAG.
052300     MOVE 2 TO END-FLAG.
052400     MOVE 14 TO OUT-LENGTH.
052500     SEND CM-OUTQUE-1 FROM MSG-COMP WITH END-FLAG.
052600     MOVE 3 TO END-FLAG.
052700     MOVE 16 TO OUT-LENGTH.
052800     SEND CM-OUTQUE-1 FROM GROUP-COMP WITH END-FLAG.
052900 SEGMENTED-MSG-TEST-05.
053000     MOVE 71 TO OUT-LENGTH.
053100     MOVE 0 TO END-FLAG.
053200     SEND CM-OUTQUE-1 FROM SKIP-MSG-1 WITH END-FLAG
053300         BEFORE ADVANCING 4 LINES.
053400     MOVE 17 TO OUT-LENGTH.
053500     MOVE 3 TO END-FLAG.
053600     SEND CM-OUTQUE-1 FROM SKIP-MSG-2 WITH END-FLAG.
053700 SINGLE-TERMINAL-TEST-01.
053800     MOVE 1 TO DEST-COUNT.
053900     MOVE 57 TO OUT-LENGTH.
054000     SEND CM-OUTQUE-1 FROM ONE-TERMINAL-MSG WITH EGI.
054100     MOVE 2 TO DEST-COUNT.
054200 INCOMPLETE-MSG-TEST-01.
054300     MOVE 55 TO OUT-LENGTH.
054400     MOVE 1 TO INC-MSG-NO.
054500     SEND CM-OUTQUE-1 FROM INCOMP-MSG.
054600 INCOMPLETE-MSG-TEST-02.
054700     MOVE 55 TO OUT-LENGTH.
054800     MOVE 2 TO INC-MSG-NO.
054900     SEND CM-OUTQUE-1 FROM INCOMP-MSG WITH ESI.
055000 INCOMPLETE-MSG-TEST-03.
055100     MOVE 0 TO END-FLAG.
055200     MOVE 55 TO OUT-LENGTH.
055300     MOVE 3 TO INC-MSG-NO.
055400     SEND CM-OUTQUE-1 FROM INCOMP-MSG WITH END-FLAG.
055500 INCOMPLETE-MSG-TEST-04.
055600     MOVE 1 TO END-FLAG.
055700     MOVE 55 TO OUT-LENGTH.
055800     MOVE 4 TO INC-MSG-NO.
055900     SEND CM-OUTQUE-1 FROM INCOMP-MSG WITH END-FLAG.
056000 STOP-WITHOUT-COMPLETING-MSG.
056100     PERFORM END-ROUTINE THRU END-ROUTINE-4.
056200     CLOSE PRINT-FILE.
056300     STOP RUN.
056400 DELAY-FOR-30 SECTION.
056500 TAKE-INIT-TIME.
056600     ACCEPT INIT-TIME FROM TIME.
056700 TEST-ELAPSED-TIME.
056800     ACCEPT TEST-TIME FROM TIME.
056900     COMPUTE ELAPSED-TIME =
057000         (T-HRS * 3600 + T-MINS * 60 + T-SECS) -
057100         (I-HRS * 3600 + I-MINS * 60 + I-SECS).
057200     IF ELAPSED-TIME IS LESS THAN 30 GO TO TEST-ELAPSED-TIME.
057300 COMMON-SUBROUTINES SECTION.
057400 PASS.
057500     MOVE "PASS" TO P-OR-F.
057600 FAIL.
057700     ADD      1 TO ERROR-COUNTER.
057800     MOVE "FAIL*" TO P-OR-F.
057900 DE-LETE.
058000     MOVE     SPACE TO P-OR-F.
058100     MOVE     "    ************    " TO COMPUTED-A.
058200     MOVE     "    ************    " TO CORRECT-A.
058300     MOVE "****TEST DELETED****" TO RE-MARK.
058400     ADD 1 TO DELETE-CNT.
058500 PRINT-DETAIL.
058600     MOVE     TEST-RESULTS TO PRINT-REC.
058700     PERFORM WRITE-LINE.
058800     MOVE     SPACE TO P-OR-F.
058900     MOVE     SPACE TO COMPUTED-A.
059000     MOVE SPACE TO CORRECT-A.
059100     MOVE SPACE TO RE-MARK.
059200     MOVE SPACE TO FEATURE.
059300 COLUMN-NAMES-ROUTINE.
059400     MOVE     COLUMNS-LINE-1 TO DUMMY-RECORD.
059500     PERFORM WRITE-LINE.
059600     MOVE     COLUMNS-LINE-2 TO DUMMY-RECORD.
059700     PERFORM WRITE-LINE.
059800     PERFORM  BLANK-LINE-PRINT.
059900 END-ROUTINE.
060000     MOVE     HYPHEN-LINE TO DUMMY-RECORD.
060100     PERFORM WRITE-LINE.
060200 PARA-Z.
060300     PERFORM  BLANK-LINE-PRINT 4 TIMES.
060400     MOVE     CCVS-E-1 TO DUMMY-RECORD.
060500     PERFORM WRITE-LINE.
060600 END-ROUTINE-1.
060700     PERFORM  BLANK-LINE-PRINT.
060800     IF       ERROR-COUNTER IS EQUAL TO ZERO
060900              GO TO END-ROUTINE-2.
061000     MOVE     ERROR-COUNTER TO ERROR-TOTAL.
061100     GO TO    END-ROUTINE-3.
061200 END-ROUTINE-2.
061300     MOVE " NO" TO ERROR-TOTAL.
061400 END-ROUTINE-3.
061500     MOVE     CCVS-E-2 TO DUMMY-RECORD.
061600     PERFORM WRITE-LINE.
061700     IF DELETE-CNT IS EQUAL TO ZERO
061800         MOVE " NO" TO ERROR-TOTAL  ELSE
061900     MOVE DELETE-CNT TO ERROR-TOTAL.
062000     MOVE "TESTS DELETED     " TO ENDER-DESC.
062100     MOVE CCVS-E-2 TO DUMMY-RECORD.
062200     PERFORM WRITE-LINE.
062300 END-ROUTINE-4.
062400     MOVE CCVS-E-3 TO DUMMY-RECORD.
062500     PERFORM WRITE-LINE.
062600 BLANK-LINE-PRINT.
062700     MOVE     SPACE TO DUMMY-RECORD.
062800     PERFORM WRITE-LINE.
062900 WRITE-LINE.
063000     WRITE DUMMY-RECORD AFTER ADVANCING 1 LINE.
063100 HEAD-ROUTINE.
063200     MOVE CCVS-H-1 TO PRINT-REC
063300     WRITE PRINT-REC
063400         AFTER ADVANCING PAGE.
063500     MOVE CCVS-H-2 TO PRINT-REC.
063600     WRITE PRINT-REC
063700         AFTER 2 LINES.
063800     MOVE CCVS-H-3 TO PRINT-REC.
063900     WRITE PRINT-REC
064000         AFTER 5 LINES.
064100     MOVE HYPHEN-LINE TO PRINT-REC.
064200     PERFORM WRITE-LINE.
