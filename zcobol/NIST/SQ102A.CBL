000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ102A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
000900*                             REVISED 1986, AUGUST             *
001000*                                                              *
001100*    CREATION DATE     /     VALIDATION DATE                   *
001200*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001300*                                                              *
001400****************************************************************
001500*                                                              *
001600*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001700*                                                              *
001800*            X-01   SEQUENTIAL MAGNETIC TAPE                   *
001900*            X-55   SYSTEM PRINTER                             *
002000*            X-82   SOURCE-COMPUTER                            *
002100*            X-83   OBJECT-COMPUTER.                           *
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    SQ102A CREATES A MAGNETIC TAPE FILE CONTAINING 750 FIXED  *
002600*    LENGTH RECORDS, EACH 120 CHARACTERS LONG.  THE FILE IS    *
002700*    READ TWICE.  THE FIRST PASS CHECKS THAT ALL THE EXPECTED  *
002800*    RECORDS ARE PRESENT.  THE SECOND PASS PERFORMS SIMILAR    *
002900*    CHECKS, BUT USES ALL FOUR VARIANTS OF THE READ STATEMENT  *
003000*    WITH THE END PHRASE THAT CAN BE PRODUCED BY INCLUDING OR  *
003100*    OMITTING THE OPTIONAL WORDS "RECORD" AND "AT".            *
003200*                                                              *
003300*    THE PROGRAM OMITS THE OPTIONAL WORDS "ORGANIZATION IS"    *
003400*    FROM THE "ORGANIZATION IS SEQUENTIAL" CLAUSE OF THE       *
003500*    FILE-CONTROL ENTRY, AND PLACES THE ASSIGN CLAUSE IN A     *
003600*    POSITION OTHER THAN FIRST IN THE SAME ENTRY.              *
003700*                                                              *
003800****************************************************************
003900*
004000*
004100 ENVIRONMENT DIVISION.
004200 CONFIGURATION SECTION.
004300 SOURCE-COMPUTER.
004400     XXXXX082.
004500 OBJECT-COMPUTER.
004600     XXXXX083.
004700*
004800 INPUT-OUTPUT SECTION.
004900 FILE-CONTROL.
005000     SELECT PRINT-FILE ASSIGN TO
005100     XXXXX055.
005200*
005300P    SELECT RAW-DATA   ASSIGN TO
005400P    XXXXX062
005500P          ORGANIZATION IS INDEXED
005600P          ACCESS MODE  IS RANDOM
005700P          RECORD-KEY   IS RAW-DATA-KEY.
005800P
005900     SELECT SQ-FS1
006000            ACCESS MODE IS SEQUENTIAL
006100            SEQUENTIAL
006200            ASSIGN TO
006300     XXXXX001
006400            .
006500*
006600*
006700 DATA DIVISION.
006800 FILE SECTION.
006900 FD  PRINT-FILE
007000C    LABEL RECORDS
007100C    XXXXX084
007200C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007300               .
007400 01  PRINT-REC    PICTURE X(120).
007500 01  DUMMY-RECORD PICTURE X(120).
007600P
007700PFD  RAW-DATA.
007800P01  RAW-DATA-SATZ.
007900P    05  RAW-DATA-KEY        PIC X(6).
008000P    05  C-DATE              PIC 9(6).
008100P    05  C-TIME              PIC 9(8).
008200P    05  NO-OF-TESTS         PIC 99.
008300P    05  C-OK                PIC 999.
008400P    05  C-ALL               PIC 999.
008500P    05  C-FAIL              PIC 999.
008600P    05  C-DELETED           PIC 999.
008700P    05  C-INSPECT           PIC 999.
008800P    05  C-NOTE              PIC X(13).
008900P    05  C-INDENT            PIC X.
009000P    05  C-ABORT             PIC X(8).
009100*
009200 FD  SQ-FS1
009300C    LABEL RECORD IS STANDARD
009400                .
009500 01  SQ-FS1R1-F-G-120 PIC X(120).
009600*
009700 WORKING-STORAGE SECTION.
009800*
009900***************************************************************
010000*                                                             *
010100*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
010200*                                                             *
010300***************************************************************
010400*
010500 01  RECORDS-IN-ERROR PIC S9(5) USAGE COMP VALUE ZERO.
010600 01  ERROR-FLAG PIC 9 VALUE ZERO.
010700 01  EOF-FLAG   PICTURE 9 VALUE ZERO.
010800*
010900***************************************************************
011000*                                                             *
011100*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
011200*                                                             *
011300***************************************************************
011400*
011500 01  REC-SKEL-SUB   PIC 99.
011600*
011700 01  FILE-RECORD-INFORMATION-REC.
011800     03 FILE-RECORD-INFO-SKELETON.
011900        05 FILLER                 PICTURE X(48)       VALUE
012000             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
012100        05 FILLER                 PICTURE X(46)       VALUE
012200             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
012300        05 FILLER                 PICTURE X(26)       VALUE
012400             ",LFIL=000000,ORG=  ,LBLR= ".
012500        05 FILLER                 PICTURE X(37)       VALUE
012600             ",RECKEY=                             ".
012700        05 FILLER                 PICTURE X(38)       VALUE
012800             ",ALTKEY1=                             ".
012900        05 FILLER                 PICTURE X(38)       VALUE
013000             ",ALTKEY2=                             ".
013100        05 FILLER                 PICTURE X(7)        VALUE SPACE.
013200     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
013300        05 FILE-RECORD-INFO-P1-120.
013400           07 FILLER              PIC X(5).
013500           07 XFILE-NAME          PIC X(6).
013600           07 FILLER              PIC X(8).
013700           07 XRECORD-NAME        PIC X(6).
013800           07 FILLER              PIC X(1).
013900           07 REELUNIT-NUMBER     PIC 9(1).
014000           07 FILLER              PIC X(7).
014100           07 XRECORD-NUMBER      PIC 9(6).
014200           07 FILLER              PIC X(6).
014300           07 UPDATE-NUMBER       PIC 9(2).
014400           07 FILLER              PIC X(5).
014500           07 ODO-NUMBER          PIC 9(4).
014600           07 FILLER              PIC X(5).
014700           07 XPROGRAM-NAME       PIC X(5).
014800           07 FILLER              PIC X(7).
014900           07 XRECORD-LENGTH      PIC 9(6).
015000           07 FILLER              PIC X(7).
015100           07 CHARS-OR-RECORDS    PIC X(2).
015200           07 FILLER              PIC X(1).
015300           07 XBLOCK-SIZE         PIC 9(4).
015400           07 FILLER              PIC X(6).
015500           07 RECORDS-IN-FILE     PIC 9(6).
015600           07 FILLER              PIC X(5).
015700           07 XFILE-ORGANIZATION  PIC X(2).
015800           07 FILLER              PIC X(6).
015900           07 XLABEL-TYPE         PIC X(1).
016000        05 FILE-RECORD-INFO-P121-240.
016100           07 FILLER              PIC X(8).
016200           07 XRECORD-KEY         PIC X(29).
016300           07 FILLER              PIC X(9).
016400           07 ALTERNATE-KEY1      PIC X(29).
016500           07 FILLER              PIC X(9).
016600           07 ALTERNATE-KEY2      PIC X(29).
016700           07 FILLER              PIC X(7).
016800*
016900 01  TEST-RESULTS.
017000     02 FILLER              PIC X      VALUE SPACE.
017100     02  PAR-NAME.
017200       03 FILLER              PIC X(14)  VALUE SPACE.
017300       03 PARDOT-X            PIC X      VALUE SPACE.
017400       03 DOTVALUE            PIC 99     VALUE ZERO.
017500     02 FILLER              PIC X      VALUE SPACE.
017600     02 FEATURE             PIC X(24)  VALUE SPACE.
017700     02 FILLER              PIC X      VALUE SPACE.
017800     02 P-OR-F              PIC X(5)   VALUE SPACE.
017900     02 FILLER              PIC X(9)   VALUE SPACE.
018000     02 RE-MARK             PIC X(61).
018100 01  TEST-COMPUTED.
018200   02 FILLER  PIC X(30)  VALUE SPACE.
018300   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
018400   02 COMPUTED-X.
018500     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
018600     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
018700     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
018800     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
018900     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
019000     03       CM-18V0 REDEFINES COMPUTED-A.
019100        04 COMPUTED-18V0                   PIC -9(18).
019200        04 FILLER                          PIC X.
019300     03 FILLER PIC X(50) VALUE SPACE.
019400 01  TEST-CORRECT.
019500     02 FILLER PIC X(30) VALUE SPACE.
019600     02 FILLER PIC X(17) VALUE "       CORRECT =".
019700     02 CORRECT-X.
019800     03 CORRECT-A                  PIC X(20) VALUE SPACE.
019900     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
020000     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
020100     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
020200     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
020300     03      CR-18V0 REDEFINES CORRECT-A.
020400         04 CORRECT-18V0                     PIC -9(18).
020500         04 FILLER                           PIC X.
020600     03 FILLER PIC X(2) VALUE SPACE.
020700     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
020800 01  CCVS-C-1.
020900     02 FILLER  PIC IS X        VALUE  SPACE.
021000     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
021100     02 FILLER  PIC IS X        VALUE  SPACE.
021200     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
021300     02 FILLER  PIC IS X        VALUE  SPACE.
021400     02 FILLER  PIC IS X(5)     VALUE "PASS ".
021500     02 FILLER  PIC IS X(9)     VALUE  SPACE.
021600     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
021700 01  CCVS-C-2.
021800     02 FILLER  PIC X(19)  VALUE  SPACE.
021900     02 FILLER  PIC X(6)   VALUE "TESTED".
022000     02 FILLER  PIC X(19)  VALUE  SPACE.
022100     02 FILLER  PIC X(4)   VALUE "FAIL".
022200     02 FILLER  PIC X(72)  VALUE  SPACE.
022300 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
022400 01  REC-CT            PIC 99       VALUE ZERO.
022500 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
022600 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
022700 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
022800 01  PASS-COUNTER      PIC 999      VALUE ZERO.
022900 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
023000 01  ERROR-HOLD        PIC 999      VALUE ZERO.
023100 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
023200 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
023300 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
023400 01  CCVS-H-1.
023500     02  FILLER          PIC X(39)    VALUE SPACES.
023600     02  FILLER          PIC X(42)    VALUE
023700     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
023800     02  FILLER          PIC X(39)    VALUE SPACES.
023900 01  CCVS-H-2A.
024000   02  FILLER            PIC X(40)  VALUE SPACE.
024100   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
024200   02  FILLER            PIC XXXX   VALUE
024300     "4.2 ".
024400   02  FILLER            PIC X(28)  VALUE
024500            " COPY - NOT FOR DISTRIBUTION".
024600   02  FILLER            PIC X(41)  VALUE SPACE.
024700*
024800 01  CCVS-H-2B.
024900   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
025000   02  TEST-ID           PIC X(9).
025100   02  FILLER            PIC X(4)   VALUE " IN ".
025200   02  FILLER            PIC X(12)  VALUE
025300     " HIGH       ".
025400   02  FILLER            PIC X(22)  VALUE
025500            " LEVEL VALIDATION FOR ".
025600   02  FILLER            PIC X(58)  VALUE
025700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025800 01  CCVS-H-3.
025900     02  FILLER          PIC X(34)  VALUE
026000            " FOR OFFICIAL USE ONLY    ".
026100     02  FILLER          PIC X(58)  VALUE
026200     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
026300     02  FILLER          PIC X(28)  VALUE
026400            "  COPYRIGHT   1985,1986 ".
026500 01  CCVS-E-1.
026600     02 FILLER           PIC X(52)  VALUE SPACE.
026700     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
026800     02 ID-AGAIN         PIC X(9).
026900     02 FILLER           PIC X(45)  VALUE SPACES.
027000 01  CCVS-E-2.
027100     02  FILLER          PIC X(31)  VALUE SPACE.
027200     02  FILLER          PIC X(21)  VALUE SPACE.
027300     02  CCVS-E-2-2.
027400         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
027500         03 FILLER         PIC X      VALUE SPACE.
027600         03 ENDER-DESC     PIC X(44)  VALUE
027700            "ERRORS ENCOUNTERED".
027800 01  CCVS-E-3.
027900     02  FILLER          PIC X(22)  VALUE
028000            " FOR OFFICIAL USE ONLY".
028100     02  FILLER          PIC X(12)  VALUE SPACE.
028200     02  FILLER          PIC X(58)  VALUE
028300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
028400     02  FILLER          PIC X(8)   VALUE SPACE.
028500     02  FILLER          PIC X(20)  VALUE
028600             " COPYRIGHT 1985,1986".
028700 01  CCVS-E-4.
028800     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
028900     02 FILLER           PIC X(4)   VALUE " OF ".
029000     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
029100     02 FILLER           PIC X(40)  VALUE
029200      "  TESTS WERE EXECUTED SUCCESSFULLY".
029300 01  XXINFO.
029400     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
029500     02 INFO-TEXT.
029600       04 FILLER             PIC X(8)   VALUE SPACE.
029700       04 XXCOMPUTED         PIC X(20).
029800       04 FILLER             PIC X(5)   VALUE SPACE.
029900       04 XXCORRECT          PIC X(20).
030000     02 INF-ANSI-REFERENCE PIC X(48).
030100 01  HYPHEN-LINE.
030200     02 FILLER  PIC IS X VALUE IS SPACE.
030300     02 FILLER  PIC IS X(65)    VALUE IS "************************
030400-    "*****************************************".
030500     02 FILLER  PIC IS X(54)    VALUE IS "************************
030600-    "******************************".
030700 01  CCVS-PGM-ID  PIC X(9)   VALUE
030800     "SQ102A".
030900*
031000*
031100 PROCEDURE DIVISION.
031200*
031300 CCVS1 SECTION.
031400 OPEN-FILES.
031500P    OPEN    I-O RAW-DATA.
031600P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
031700P    READ    RAW-DATA INVALID KEY GO TO END-E-1.
031800P    MOVE   "ABORTED "   TO C-ABORT.
031900P    ADD     1           TO C-NO-OF-TESTS.
032000P    ACCEPT  C-DATE      FROM DATE.
032100P    ACCEPT  C-TIME      FROM TIME.
032200P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
032300PEND-E-1.
032400P    CLOSE   RAW-DATA.
032500     OPEN    OUTPUT PRINT-FILE.
032600     MOVE    CCVS-PGM-ID TO TEST-ID.
032700     MOVE    CCVS-PGM-ID TO ID-AGAIN.
032800     MOVE    SPACE TO TEST-RESULTS.
032900     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
033000     MOVE    ZERO TO REC-SKEL-SUB.
033100     PERFORM CCVS-INIT-FILE 10 TIMES.
033200     GO TO CCVS1-EXIT.
033300*
033400 CCVS-INIT-FILE.
033500     ADD     1 TO REC-SKL-SUB.
033600     MOVE    FILE-RECORD-INFO-SKELETON TO
033700                  FILE-RECORD-INFO (REC-SKL-SUB).
033800*
033900 CLOSE-FILES.
034000     PERFORM END-ROUTINE THRU END-ROUTINE-13.
034100     CLOSE   PRINT-FILE.
034200P    OPEN    I-O RAW-DATA.
034300P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
034400P    READ    RAW-DATA INVALID KEY GO TO END-E-2.
034500P    MOVE   "OK.     " TO C-ABORT.
034600P    MOVE    PASS-COUNTER  TO C-OK.
034700P    MOVE    ERROR-HOLD    TO C-ALL.
034800P    MOVE    ERROR-COUNTER TO C-FAIL.
034900P    MOVE    DELETE-CNT    TO C-DELETED.
035000P    MOVE    INSPECT-COUNTER TO C-INSPECT.
035100P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
035200PEND-E-2.
035300P    CLOSE   RAW-DATA.
035400 TERMINATE-CCVS.
035500S    EXIT    PROGRAM.
035600     STOP    RUN.
035700*
035800 INSPT.
035900     MOVE   "INSPT" TO P-OR-F.
036000     ADD     1 TO INSPECT-COUNTER.
036100     PERFORM PRINT-DETAIL.
036200*
036300 PASS.
036400     MOVE   "PASS " TO P-OR-F.
036500     ADD     1 TO PASS-COUNTER.
036600     PERFORM PRINT-DETAIL.
036700*
036800 FAIL.
036900     MOVE   "FAIL*" TO P-OR-F.
037000     ADD     1 TO ERROR-COUNTER.
037100     PERFORM PRINT-DETAIL.
037200*
037300 DE-LETE.
037400     MOVE   "****TEST DELETED****" TO RE-MARK.
037500     MOVE   "*****" TO P-OR-F.
037600     ADD     1 TO DELETE-COUNTER.
037700     PERFORM PRINT-DETAIL.
037800*
037900 PRINT-DETAIL.
038000     IF REC-CT NOT EQUAL TO ZERO
038100         MOVE   "." TO PARDOT-X
038200         MOVE    REC-CT TO DOTVALUE.
038300     MOVE    TEST-RESULTS TO PRINT-REC.
038400     PERFORM WRITE-LINE.
038500     IF P-OR-F EQUAL TO "FAIL*"
038600         PERFORM WRITE-LINE
038700         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
038800     ELSE
038900         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
039000     MOVE    SPACE TO P-OR-F.
039100     MOVE    SPACE TO COMPUTED-X.
039200     MOVE    SPACE TO CORRECT-X.
039300     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
039400     MOVE    SPACE TO RE-MARK.
039500*
039600 HEAD-ROUTINE.
039700     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039800     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039900     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
040000     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
040100 COLUMN-NAMES-ROUTINE.
040200     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
040300     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
040500 END-ROUTINE.
040600     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
040700     PERFORM WRITE-LINE 5 TIMES.
040800 END-RTN-EXIT.
040900     MOVE    CCVS-E-1 TO DUMMY-RECORD.
041000     PERFORM WRITE-LINE 2 TIMES.
041100*
041200 END-ROUTINE-1.
041300     ADD     ERROR-COUNTER   TO ERROR-HOLD
041400     ADD     INSPECT-COUNTER TO ERROR-HOLD.
041500     ADD     DELETE-COUNTER  TO ERROR-HOLD.
041600     ADD     PASS-COUNTER    TO ERROR-HOLD.
041700     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
041800     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
041900     MOVE    CCVS-E-4        TO CCVS-E-2-2.
042000     MOVE    CCVS-E-2        TO DUMMY-RECORD
042100     PERFORM WRITE-LINE.
042200     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
042300     IF ERROR-COUNTER IS EQUAL TO ZERO
042400         MOVE   "NO " TO ERROR-TOTAL
042500     ELSE
042600         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
042700     MOVE    CCVS-E-2 TO DUMMY-RECORD.
042800     PERFORM WRITE-LINE.
042900 END-ROUTINE-13.
043000     IF DELETE-COUNTER IS EQUAL TO ZERO
043100         MOVE   "NO " TO ERROR-TOTAL
043200     ELSE
043300         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
043400     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
043500     MOVE    CCVS-E-2 TO DUMMY-RECORD.
043600     PERFORM WRITE-LINE.
043700     IF INSPECT-COUNTER EQUAL TO ZERO
043800         MOVE   "NO " TO ERROR-TOTAL
043900     ELSE
044000         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
044100     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
044200     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
044300     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
044400*
044500 WRITE-LINE.
044600     ADD     1 TO RECORD-COUNT.
044700Y    IF RECORD-COUNT GREATER 50
044800Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
044900Y        MOVE  SPACE TO DUMMY-RECORD
045000Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
045100Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
045200Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
045300Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
045400Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
045500Y        MOVE  ZERO TO RECORD-COUNT.
045600     PERFORM WRT-LN.
045700*
045800 WRT-LN.
045900     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
046000     MOVE    SPACE TO DUMMY-RECORD.
046100 BLANK-LINE-PRINT.
046200     PERFORM WRT-LN.
046300 FAIL-ROUTINE.
046400     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
046500     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
046600     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
046700     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
046800     MOVE    XXINFO TO DUMMY-RECORD.
046900     PERFORM WRITE-LINE 2 TIMES.
047000     MOVE    SPACES TO INF-ANSI-REFERENCE.
047100     GO TO   FAIL-ROUTINE-EX.
047200 FAIL-ROUTINE-WRITE.
047300     MOVE    TEST-COMPUTED  TO PRINT-REC
047400     PERFORM WRITE-LINE
047500     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
047600     MOVE    TEST-CORRECT   TO PRINT-REC
047700     PERFORM WRITE-LINE 2 TIMES.
047800     MOVE    SPACES         TO COR-ANSI-REFERENCE.
047900 FAIL-ROUTINE-EX.
048000     EXIT.
048100 BAIL-OUT.
048200     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
048300     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
048400 BAIL-OUT-WRITE.
048500     MOVE    CORRECT-A      TO XXCORRECT.
048600     MOVE    COMPUTED-A     TO XXCOMPUTED.
048700     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
048800     MOVE    XXINFO TO DUMMY-RECORD.
048900     PERFORM WRITE-LINE 2 TIMES.
049000     MOVE    SPACES TO INF-ANSI-REFERENCE.
049100 BAIL-OUT-EX.
049200     EXIT.
049300 CCVS1-EXIT.
049400     EXIT.
049500*
049600****************************************************************
049700*                                                              *
049800*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
049900*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
050000*                                                              *
050100****************************************************************
050200*
050300 SECT-SQ102-0001 SECTION.
050400 SEQ-INIT-WR-01.
050500     MOVE    "SQ-FS1" TO XFILE-NAME (1).
050600     MOVE    "R1-F-G" TO XRECORD-NAME (1).
050700     MOVE     CCVS-PGM-ID TO XPROGRAM-NAME (1).
050800     MOVE     000120 TO XRECORD-LENGTH (1).
050900     MOVE    "RC"    TO CHARS-OR-RECORDS (1).
051000     MOVE     0001   TO XBLOCK-SIZE (1).
051100     MOVE     000750 TO RECORDS-IN-FILE (1).
051200     MOVE    "SQ"    TO XFILE-ORGANIZATION (1).
051300     MOVE    "S"     TO XLABEL-TYPE (1).
051400     MOVE     ZERO   TO XRECORD-NUMBER (1).
051500     MOVE    "CREATE 750 RECORD FILE" TO FEATURE.
051600     MOVE    "SEQ-TEST-WR-01" TO PAR-NAME.
051700*
051800 SEQ-TEST-WR-01.
051900     OPEN OUTPUT SQ-FS1.
052000*
052100 SEQ-TEST-WR-01-LOOP.
052200     ADD     1 TO XRECORD-NUMBER (1).
052300     MOVE    FILE-RECORD-INFO-P1-120 (1)  TO SQ-FS1R1-F-G-120.
052400     WRITE   SQ-FS1R1-F-G-120.
052500     IF XRECORD-NUMBER (1) LESS THAN 750
052600         GO TO   SEQ-TEST-WR-01-LOOP.
052700*
052800     CLOSE   SQ-FS1.
052900*
053000*    A SEQUENTIAL TAPE FILE HAS BEEN CREATED.  IT CONTAINS 750
053100*    RECORDS, EACH 120 CHARACTERS LONG.  THE FILE WILL NOW BE
053200*    READ AND THE RECORDS VERIFIED.
053300*
053400 SEQ-INIT-GF-02.
053500     MOVE   "SEQ-TEST-GF-02" TO PAR-NAME.
053600     MOVE   "VERIFY NEW FILE" TO FEATURE.
053700     MOVE    1      TO REC-CT.
053800     GO TO  SEQ-TEST-GF-02-01.
053900 SEQ-DELETE-02-01.
054000     GO TO   SEQ-DELETE-02-02.
054100 SEQ-TEST-GF-02-01.
054200     OPEN INPUT SQ-FS1.
054300*
054400 SEQ-INIT-GF-02-02.
054500     MOVE    FILE-RECORD-INFO-P1-120 (1)
054600                TO FILE-RECORD-INFO-P1-120 (2).
054700     MOVE    ZERO   TO XRECORD-NUMBER (2).
054800     GO TO   SEQ-TEST-GF-02-02.
054900 SEQ-DELETE-02-02.
055000     PERFORM DE-LETE.
055100     ADD     1 TO REC-CT.
055200     PERFORM DE-LETE.
055300     GO TO   SEQ-DELETE-GF-02-05.
055400 SEQ-TEST-GF-02-02.
055500 SEQ-TEST-GF-02-02-LOOP.
055600     READ SQ-FS1
055700          AT END GO TO SEQ-TEST-GF-02-02-1.
055800     MOVE   SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
055900     ADD    1 TO XRECORD-NUMBER (2).
056000     IF XRECORD-NUMBER (2) GREATER THAN 750
056100         GO TO   SEQ-TEST-GF-02-02-1.
056200     IF FILE-RECORD-INFO-P1-120 (1)
056300                NOT EQUAL TO FILE-RECORD-INFO-P1-120 (2)
056400         ADD     1 TO RECORDS-IN-ERROR.
056500     GO TO   SEQ-TEST-GF-02-02-LOOP.
056600*
056700 SEQ-TEST-GF-02-02-1.
056800     IF XRECORD-NUMBER (2) = 750
056900         PERFORM PASS
057000     ELSE
057100         MOVE   "RECORD COUNTING ERROR" TO RE-MARK
057200         MOVE    XRECORD-NUMBER (2) TO COMPUTED-18V0
057300         MOVE    750 TO CORRECT-18V0
057400         MOVE   "VII-44" TO ANSI-REFERENCE
057500         PERFORM FAIL.
057600*
057700     ADD     1 TO REC-CT.
057800     IF RECORDS-IN-ERROR EQUAL TO ZERO
057900         PERFORM PASS
058000     ELSE
058100         MOVE   "RECORD CONTENT ERRORS" TO RE-MARK
058200         MOVE    ZERO TO CORRECT-18V0
058300         MOVE    RECORDS-IN-ERROR TO COMPUTED-18V0
058400         MOVE   "VII-44; 4.4.2" TO ANSI-REFERENCE
058500         PERFORM FAIL.
058600*
058700 SEQ-INIT-GF-02-05.
058800     GO TO   SEQ-TEST-GF-02-05.
058900 SEQ-DELETE-GF-02-05.
059000     GO TO   SEQ-TEST-GF-02-END.
059100 SEQ-TEST-GF-02-05.
059200     CLOSE   SQ-FS1.
059300 SEQ-TEST-GF-02-END.
059400*
059500*
059600 SEQ-INIT-GF-03.
059700     GO TO  SEQ-TEST-GF-03.
059800 SEQ-DELETE-03.
059900     GO TO   SEQ-TEST-03-END.
060000 SEQ-TEST-GF-03.
060100     OPEN    INPUT SQ-FS1.
060200 SEQ-TEST-03-END.
060300*
060400*
060500*    THIS SERIES OF TESTS CHECKS FOUR LEVEL 1 VARIANTS OF
060600*    THE READ STATEMENT
060700*
060800 SEQ-INIT-GF-04.
060900     MOVE    ZERO TO XRECORD-NUMBER (2).
061000     MOVE    ZERO TO RECORDS-IN-ERROR.
061100     MOVE   "READ...RECORD AT END"     TO FEATURE.
061200     MOVE   "SEQ-TEST-GF-O4" TO PAR-NAME.
061300     MOVE    ZERO TO ERROR-FLAG.
061400     MOVE    1 TO REC-CT.
061500     GO TO  SEQ-TEST-GF-04.
061600 SEQ-DELETE-04.
061700     PERFORM DE-LETE.
061800     ADD     1 TO REC-CT.
061900     PERFORM DE-LETE.
062000     GO TO   SEQ-TEST-04-END.
062100 SEQ-TEST-GF-04.
062200     READ SQ-FS1 RECORD AT END
062300         MOVE    1 TO EOF-FLAG
062400         GO TO   SEQ-TEST-GF-04-01.
062500     MOVE   SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
062600     ADD    1 TO XRECORD-NUMBER (2)
062700     IF XRECORD-NUMBER (2) NOT EQUAL TO XRECORD-NUMBER (1)
062800         ADD     1 TO RECORDS-IN-ERROR
062900         MOVE    1 TO ERROR-FLAG.
063000     IF XRECORD-NUMBER (2) LESS THAN 200
063100         GO TO   SEQ-TEST-GF-04.
063200*
063300 SEQ-TEST-GF-04-01.
063400     IF EOF-FLAG NOT EQUAL TO ZERO
063500         MOVE   "PREMATURE END OF FILE" TO RE-MARK
063600         MOVE    750 TO CORRECT-18V0
063700         MOVE    XRECORD-NUMBER (2) TO COMPUTED-18V0
063800         MOVE   "VII-44" TO ANSI-REFERENCE
063900         PERFORM FAIL
064000     ELSE
064100         PERFORM PASS.
064200*
064300 SEQ-TEST-GF-04-02.
064400     ADD     1 TO REC-CT.
064500     IF ERROR-FLAG EQUAL TO ZERO
064600         PERFORM PASS
064700     ELSE
064800         MOVE    ERROR-FLAG TO COMPUTED-18V0
064900         MOVE    ZERO TO CORRECT-18V0
065000         MOVE   "ERROR IN ONE OR MORE RECORDS" TO RE-MARK
065100         MOVE   "VII-44" TO ANSI-REFERENCE
065200         PERFORM FAIL.
065300 SEQ-TEST-04-END.
065400*
065500*
065600 SEQ-INIT-GF-O5.
065700     MOVE    1 TO REC-CT.
065800     IF EOF-FLAG EQUAL TO 1
065900         GO TO SEQ-DELETE-05.
066000     MOVE    ZERO TO ERROR-FLAG.
066100     MOVE   "READ...AT END..." TO FEATURE
066200     MOVE   "SEQ-TEST-GF-O5" TO PAR-NAME.
066300     MOVE    ZERO TO RECORDS-IN-ERROR.
066400     GO TO  SEQ-TEST-GF-05.
066500 SEQ-DELETE-05.
066600     PERFORM DE-LETE.
066700     ADD     1 TO REC-CT.
066800     PERFORM DE-LETE.
066900     GO TO   SEQ-TEST-05-END.
067000 SEQ-TEST-GF-05.
067100     READ SQ-FS1 AT END
067200         MOVE    1 TO EOF-FLAG
067300         GO TO   SEQ-TEST-GF-05-01.
067400     MOVE   SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
067500     ADD    1 TO XRECORD-NUMBER (2)
067600     IF XRECORD-NUMBER (2) NOT EQUAL TO XRECORD-NUMBER (1)
067700         ADD     1 TO RECORDS-IN-ERROR
067800         MOVE    1 TO ERROR-FLAG.
067900     IF XRECORD-NUMBER (2) LESS THAN 400
068000         GO TO   SEQ-TEST-GF-05.
068100*
068200 SEQ-TEST-GF-05-01.
068300     IF EOF-FLAG NOT EQUAL TO ZERO
068400         MOVE   "PREMATURE END OF FILE" TO RE-MARK
068500         MOVE    750 TO CORRECT-18V0
068600         MOVE    XRECORD-NUMBER (2) TO COMPUTED-18V0
068700         MOVE   "VII-44" TO ANSI-REFERENCE
068800         PERFORM FAIL
068900     ELSE
069000         PERFORM PASS.
069100*
069200 SEQ-TEST-GF-05-02.
069300     ADD     1 TO REC-CT.
069400     IF ERROR-FLAG EQUAL TO ZERO
069500         PERFORM PASS
069600     ELSE
069700         MOVE    ERROR-FLAG TO COMPUTED-18V0
069800         MOVE    ZERO TO CORRECT-18V0
069900         MOVE   "ERROR IN ONE OR MORE RECORDS" TO RE-MARK
070000         MOVE   "VII-44" TO ANSI-REFERENCE
070100         PERFORM FAIL.
070200 SEQ-TEST-05-END.
070300*
070400*
070500 SEQ-INIT-GF-O6.
070600     MOVE    1 TO REC-CT.
070700     IF EOF-FLAG EQUAL TO 1
070800         GO TO SEQ-DELETE-06.
070900     MOVE    ZERO TO ERROR-FLAG.
071000     MOVE   "READ...RECORD END..." TO FEATURE
071100     MOVE   "SEQ-TEST-GF-O6" TO PAR-NAME.
071200     MOVE    ZERO TO RECORDS-IN-ERROR.
071300     GO TO  SEQ-TEST-GF-06.
071400 SEQ-DELETE-06.
071500     PERFORM DE-LETE.
071600     ADD     1 TO REC-CT.
071700     PERFORM DE-LETE.
071800     GO TO   SEQ-TEST-06-END.
071900 SEQ-TEST-GF-06.
072000     READ SQ-FS1 RECORD END
072100         MOVE    1 TO EOF-FLAG
072200         GO TO   SEQ-TEST-GF-06-01.
072300     MOVE   SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
072400     ADD    1 TO XRECORD-NUMBER (2)
072500     IF XRECORD-NUMBER (2) NOT EQUAL TO XRECORD-NUMBER (1)
072600         ADD     1 TO RECORDS-IN-ERROR
072700         MOVE    1 TO ERROR-FLAG.
072800     IF XRECORD-NUMBER (2) LESS THAN 600
072900         GO TO   SEQ-TEST-GF-06.
073000*
073100 SEQ-TEST-GF-06-01.
073200     IF EOF-FLAG NOT EQUAL TO ZERO
073300         MOVE   "PREMATURE END OF FILE" TO RE-MARK
073400         MOVE    750 TO CORRECT-18V0
073500         MOVE    XRECORD-NUMBER (2) TO COMPUTED-18V0
073600         MOVE   "VII-44" TO ANSI-REFERENCE
073700         PERFORM FAIL
073800     ELSE
073900         PERFORM PASS.
074000*
074100 SEQ-TEST-GF-06-02.
074200     ADD     1 TO REC-CT.
074300     IF ERROR-FLAG EQUAL TO ZERO
074400         PERFORM PASS
074500     ELSE
074600         MOVE    ERROR-FLAG TO COMPUTED-18V0
074700         MOVE    ZERO TO CORRECT-18V0
074800         MOVE   "ERROR IN ONE OR MORE RECORDS" TO RE-MARK
074900         MOVE   "VII-44" TO ANSI-REFERENCE
075000         PERFORM FAIL.
075100 SEQ-TEST-06-END.
075200*
075300*
075400 SEQ-INIT-GF-O7.
075500     MOVE    1 TO REC-CT.
075600     IF EOF-FLAG EQUAL TO 1
075700         GO TO SEQ-DELETE-07.
075800     MOVE    ZERO TO ERROR-FLAG.
075900     MOVE   "READ... END..." TO FEATURE
076000     MOVE   "SEQ-TEST-GF-O7" TO PAR-NAME.
076100     MOVE    ZERO TO RECORDS-IN-ERROR.
076200     GO TO  SEQ-TEST-GF-07.
076300 SEQ-DELETE-07.
076400     PERFORM DE-LETE.
076500     ADD     1 TO REC-CT.
076600     PERFORM DE-LETE.
076700     GO TO   SEQ-TEST-07-END.
076800 SEQ-TEST-GF-07.
076900     READ SQ-FS1 END
077000         MOVE    1 TO EOF-FLAG
077100         GO TO   SEQ-TEST-GF-07-01.
077200     MOVE   SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
077300     ADD    1 TO XRECORD-NUMBER (2)
077400     IF XRECORD-NUMBER (2) NOT EQUAL TO XRECORD-NUMBER (1)
077500         ADD     1 TO RECORDS-IN-ERROR
077600         MOVE    1 TO ERROR-FLAG.
077700     IF XRECORD-NUMBER (2) LESS THAN 750
077800         GO TO   SEQ-TEST-GF-07.
077900*
078000 SEQ-TEST-GF-07-01.
078100     IF EOF-FLAG NOT EQUAL TO ZERO
078200         MOVE   "PREMATURE END OF FILE" TO RE-MARK
078300         MOVE    750 TO CORRECT-18V0
078400         MOVE    XRECORD-NUMBER (2) TO COMPUTED-18V0
078500         MOVE   "VII-44" TO ANSI-REFERENCE
078600         PERFORM FAIL
078700     ELSE
078800         PERFORM PASS.
078900*
079000 SEQ-TEST-GF-07-02.
079100     ADD     1 TO REC-CT.
079200     IF ERROR-FLAG EQUAL TO ZERO
079300         PERFORM PASS
079400     ELSE
079500         MOVE    ERROR-FLAG TO COMPUTED-18V0
079600         MOVE    ZERO TO CORRECT-18V0
079700         MOVE   "ERROR IN ONE OR MORE RECORDS" TO RE-MARK
079800         MOVE   "VII-44" TO ANSI-REFERENCE
079900         PERFORM FAIL.
080000 SEQ-TEST-07-END.
080100*
080200*
080300 SEQ-INIT-GF-O8.
080400     MOVE    1 TO REC-CT.
080500     IF EOF-FLAG EQUAL TO 1
080600         GO TO SEQ-DELETE-08.
080700     MOVE   "READ... END... AT EOF" TO FEATURE
080800     MOVE   "SEQ-TEST-GF-O8" TO PAR-NAME.
080900     GO TO  SEQ-TEST-GF-08.
081000 SEQ-DELETE-08.
081100     PERFORM DE-LETE.
081200     GO TO   SEQ-TEST-08-END.
081300 SEQ-TEST-GF-08.
081400     READ SQ-FS1 END
081500         MOVE    1 TO EOF-FLAG.
081600*
081700 SEQ-TEST-GF-08-01.
081800     IF EOF-FLAG NOT EQUAL TO 1
081900         MOVE    EOF-FLAG TO COMPUTED-18V0
082000         MOVE    1 TO CORRECT-18V0
082100         MOVE   "EOF NOT FOUND AFTER 750 RECORDS" TO RE-MARK
082200         PERFORM FAIL
082300     ELSE
082400         PERFORM PASS.
082500 SEQ-TEST-08-END.
082600*
082700*
082800 SEQ-INIT-GF-O9.
082900     GO TO  SEQ-TEST-GF-09.
083000 SEQ-DELETE-09.
083100     GO TO   SEQ-TEST-09-END.
083200 SEQ-TEST-GF-09.
083300     CLOSE SQ-FS1.
083400 SEQ-TEST-09-END.
083500*
083600*
083700 TERMINATE-ROUTINE.
083800     EXIT.
083900 CCVS-EXIT SECTION.
084000 CCVS-999999.
084100     GO TO CLOSE-FILES.
