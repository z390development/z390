000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST105A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*    THIS PROGRAM TESTS THE SORT WITH USING AND OUTPUT PROCEDURE.
002200*    SORTIN-1E, THE INPUT FILE, WAS CREATED IN ST104 EXPRESSLY FOR
002300*    USE IN THIS PROGRAM. EACH RECORD PASSED TO SORTOUT-1E, THE
002400*    OUTPUT FILE, IS CHECKED BY THIS PROGRAM. SORTOUT-1E WILL NOT
002500*    BE USED BY ANY FURTHER PROGRAM.
002600*    RECORDS ARE RETURNED USING THE "RETURN INTO" PHRASE.
002700*    SORTIN-1E CONTAINS 203 RECORDS, ARRANGED SO THAT THE KEYS
002800*    START AT 000.000 AND RISE IN INCREMENTS OF 2.142 UNTIL THEY
002900*    REACH 216.342, AND THEN DESCEND TO 000.000 IN THE SAME
003000*    INCREMENTS. ALL RECORDS CONTAIN THE NUMBER +987654321078
003100*    IN A NON-KEY AREA.
003200*    SORTOUT-1E WILL BE SORTED IN DESCENDING ORDER. ALL RECORDS
003300*    OCCUR IN IDENTICAL PAIRS EXCEPT THE FIRST ONE.
003400*
003500*    *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  * *.
003600
003700 ENVIRONMENT DIVISION.
003800 CONFIGURATION SECTION.
003900 SOURCE-COMPUTER.
004000     XXXXX082.
004100 OBJECT-COMPUTER.
004200     XXXXX083.
004300 INPUT-OUTPUT SECTION.
004400 FILE-CONTROL.
004500     SELECT PRINT-FILE ASSIGN TO
004600     XXXXX055.
004700     SELECT   SORTIN-1E ASSIGN TO
004800     XXXXD001.
004900     SELECT   SORTOUT-1E ASSIGN TO
005000     XXXXX002.
005100     SELECT   SORTFILE-1E ASSIGN TO
005200     XXXXX027.
005300 DATA DIVISION.
005400 FILE SECTION.
005500 FD  PRINT-FILE.
005600 01  PRINT-REC PICTURE X(120).
005700 01  DUMMY-RECORD PICTURE X(120).
005800 FD  SORTIN-1E
005900     LABEL RECORDS STANDARD
006000C    VALUE OF
006100C    XXXXX074
006200C    IS
006300C    XXXXX075
006400G    XXXXX069
006500     DATA RECORD IS SORTIN-REC.
006600 01  SORTIN-REC.
006700     02 FILLER          PICTURE X(18).
006800 FD  SORTOUT-1E
006900     LABEL RECORDS STANDARD
007000C    VALUE OF
007100C    XXXXX074
007200C    IS
007300C    XXXXX076
007400G    XXXXX069
007500     DATA RECORD IS SORTOUT-REC.
007600 01  SORTOUT-REC.
007700     02 FILLER          PICTURE X(18).
007800 SD  SORTFILE-1E
007900     DATA RECORD IS GRP-RECORD.
008000 01  GRP-RECORD.
008100     02       KEY-ITEM            PICTURE S999V999.
008200     02       NON-KEY-ITEM        PICTURE S9(12).
008300 WORKING-STORAGE SECTION.
008400 77  U-TILITY          PICTURE S999V999 VALUE 216.342.
008500 77  UTIL-SW            PICTURE 9 VALUE ZERO.
008600 77  RECORD-NUMBER      PICTURE 999 VALUE 203.
008700 77  WRITE-COUNTER      PICTURE 999         VALUE ZERO.
008800 01  FEATURE-BUILDER.
008900     02 NON             PICTURE X(4).
009000     02 FILLER          PICTURE X(13) VALUE "KEY-ITEM NO. ".
009100     02 EDITED-NUMBER   PICTURE ZZ9.
009200 01  TEST-RESULTS.
009300     02 FILLER                   PIC X      VALUE SPACE.
009400     02 FEATURE                  PIC X(20)  VALUE SPACE.
009500     02 FILLER                   PIC X      VALUE SPACE.
009600     02 P-OR-F                   PIC X(5)   VALUE SPACE.
009700     02 FILLER                   PIC X      VALUE SPACE.
009800     02  PAR-NAME.
009900       03 FILLER                 PIC X(19)  VALUE SPACE.
010000       03  PARDOT-X              PIC X      VALUE SPACE.
010100       03 DOTVALUE               PIC 99     VALUE ZERO.
010200     02 FILLER                   PIC X(8)   VALUE SPACE.
010300     02 RE-MARK                  PIC X(61).
010400 01  TEST-COMPUTED.
010500     02 FILLER                   PIC X(30)  VALUE SPACE.
010600     02 FILLER                   PIC X(17)  VALUE
010700            "       COMPUTED=".
010800     02 COMPUTED-X.
010900     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
011000     03 COMPUTED-N               REDEFINES COMPUTED-A
011100                                 PIC -9(9).9(9).
011200     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
011300     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
011400     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
011500     03       CM-18V0 REDEFINES COMPUTED-A.
011600         04 COMPUTED-18V0                    PIC -9(18).
011700         04 FILLER                           PIC X.
011800     03 FILLER PIC X(50) VALUE SPACE.
011900 01  TEST-CORRECT.
012000     02 FILLER PIC X(30) VALUE SPACE.
012100     02 FILLER PIC X(17) VALUE "       CORRECT =".
012200     02 CORRECT-X.
012300     03 CORRECT-A                  PIC X(20) VALUE SPACE.
012400     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
012500     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
012600     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
012700     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
012800     03      CR-18V0 REDEFINES CORRECT-A.
012900         04 CORRECT-18V0                     PIC -9(18).
013000         04 FILLER                           PIC X.
013100     03 FILLER PIC X(2) VALUE SPACE.
013200     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
013300 01  CCVS-C-1.
013400     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
013500-    "SS  PARAGRAPH-NAME
013600-    "       REMARKS".
013700     02 FILLER                     PIC X(20)    VALUE SPACE.
013800 01  CCVS-C-2.
013900     02 FILLER                     PIC X        VALUE SPACE.
014000     02 FILLER                     PIC X(6)     VALUE "TESTED".
014100     02 FILLER                     PIC X(15)    VALUE SPACE.
014200     02 FILLER                     PIC X(4)     VALUE "FAIL".
014300     02 FILLER                     PIC X(94)    VALUE SPACE.
014400 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
014500 01  REC-CT                        PIC 99       VALUE ZERO.
014600 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
014700 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
014800 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
014900 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
015000 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
015100 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
015200 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
015300 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
015400 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
015500 01  CCVS-H-1.
015600     02  FILLER                    PIC X(39)    VALUE SPACES.
015700     02  FILLER                    PIC X(42)    VALUE
015800     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
015900     02  FILLER                    PIC X(39)    VALUE SPACES.
016000 01  CCVS-H-2A.
016100   02  FILLER                        PIC X(40)  VALUE SPACE.
016200   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
016300   02  FILLER                        PIC XXXX   VALUE
016400     "4.2 ".
016500   02  FILLER                        PIC X(28)  VALUE
016600            " COPY - NOT FOR DISTRIBUTION".
016700   02  FILLER                        PIC X(41)  VALUE SPACE.
016800
016900 01  CCVS-H-2B.
017000   02  FILLER                        PIC X(15)  VALUE
017100            "TEST RESULT OF ".
017200   02  TEST-ID                       PIC X(9).
017300   02  FILLER                        PIC X(4)   VALUE
017400            " IN ".
017500   02  FILLER                        PIC X(12)  VALUE
017600     " HIGH       ".
017700   02  FILLER                        PIC X(22)  VALUE
017800            " LEVEL VALIDATION FOR ".
017900   02  FILLER                        PIC X(58)  VALUE
018000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
018100 01  CCVS-H-3.
018200     02  FILLER                      PIC X(34)  VALUE
018300            " FOR OFFICIAL USE ONLY    ".
018400     02  FILLER                      PIC X(58)  VALUE
018500     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
018600     02  FILLER                      PIC X(28)  VALUE
018700            "  COPYRIGHT   1985 ".
018800 01  CCVS-E-1.
018900     02 FILLER                       PIC X(52)  VALUE SPACE.
019000     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
019100     02 ID-AGAIN                     PIC X(9).
019200     02 FILLER                       PIC X(45)  VALUE SPACES.
019300 01  CCVS-E-2.
019400     02  FILLER                      PIC X(31)  VALUE SPACE.
019500     02  FILLER                      PIC X(21)  VALUE SPACE.
019600     02 CCVS-E-2-2.
019700         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
019800         03 FILLER                   PIC X      VALUE SPACE.
019900         03 ENDER-DESC               PIC X(44)  VALUE
020000            "ERRORS ENCOUNTERED".
020100 01  CCVS-E-3.
020200     02  FILLER                      PIC X(22)  VALUE
020300            " FOR OFFICIAL USE ONLY".
020400     02  FILLER                      PIC X(12)  VALUE SPACE.
020500     02  FILLER                      PIC X(58)  VALUE
020600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
020700     02  FILLER                      PIC X(13)  VALUE SPACE.
020800     02 FILLER                       PIC X(15)  VALUE
020900             " COPYRIGHT 1985".
021000 01  CCVS-E-4.
021100     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
021200     02 FILLER                       PIC X(4)   VALUE " OF ".
021300     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
021400     02 FILLER                       PIC X(40)  VALUE
021500      "  TESTS WERE EXECUTED SUCCESSFULLY".
021600 01  XXINFO.
021700     02 FILLER                       PIC X(19)  VALUE
021800            "*** INFORMATION ***".
021900     02 INFO-TEXT.
022000       04 FILLER                     PIC X(8)   VALUE SPACE.
022100       04 XXCOMPUTED                 PIC X(20).
022200       04 FILLER                     PIC X(5)   VALUE SPACE.
022300       04 XXCORRECT                  PIC X(20).
022400     02 INF-ANSI-REFERENCE           PIC X(48).
022500 01  HYPHEN-LINE.
022600     02 FILLER  PIC IS X VALUE IS SPACE.
022700     02 FILLER  PIC IS X(65)    VALUE IS "************************
022800-    "*****************************************".
022900     02 FILLER  PIC IS X(54)    VALUE IS "************************
023000-    "******************************".
023100 01  CCVS-PGM-ID                     PIC X(9)   VALUE
023200     "ST105A".
023300 PROCEDURE DIVISION.
023400 SORTPARA SECTION.
023500 SORT-PARAGRAPH.
023600     SORT     SORTFILE-1E ON
023700              DESCENDING
023800              KEY-ITEM
023900              USING SORTIN-1E
024000              OUTPUT PROCEDURE OUTPROC THRU OUTPROC-EXIT.
024100     STOP     RUN.
024200 OUTPROC SECTION.
024300 OPEN-FILES.
024400     OPEN     OUTPUT PRINT-FILE.
024500     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
024600     MOVE    SPACE TO TEST-RESULTS.
024700     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
024800     GO TO CCVS1-EXIT.
024900 CLOSE-FILES.
025000     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
025100 TERMINATE-CCVS.
025200S    EXIT PROGRAM.
025300STERMINATE-CALL.
025400     STOP     RUN.
025500 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
025600 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
025700 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
025800 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
025900     MOVE "****TEST DELETED****" TO RE-MARK.
026000 PRINT-DETAIL.
026100     IF REC-CT NOT EQUAL TO ZERO
026200             MOVE "." TO PARDOT-X
026300             MOVE REC-CT TO DOTVALUE.
026400     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
026500     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
026600        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
026700          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
026800     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
026900     MOVE SPACE TO CORRECT-X.
027000     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
027100     MOVE     SPACE TO RE-MARK.
027200 HEAD-ROUTINE.
027300     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027400     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027500     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
027600     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
027700 COLUMN-NAMES-ROUTINE.
027800     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027900     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
028100 END-ROUTINE.
028200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
028300 END-RTN-EXIT.
028400     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028500 END-ROUTINE-1.
028600      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
028700      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
028800      ADD PASS-COUNTER TO ERROR-HOLD.
028900*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
029000      MOVE PASS-COUNTER TO CCVS-E-4-1.
029100      MOVE ERROR-HOLD TO CCVS-E-4-2.
029200      MOVE CCVS-E-4 TO CCVS-E-2-2.
029300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
029400  END-ROUTINE-12.
029500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
029600     IF       ERROR-COUNTER IS EQUAL TO ZERO
029700         MOVE "NO " TO ERROR-TOTAL
029800         ELSE
029900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
030000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
030100     PERFORM WRITE-LINE.
030200 END-ROUTINE-13.
030300     IF DELETE-COUNTER IS EQUAL TO ZERO
030400         MOVE "NO " TO ERROR-TOTAL  ELSE
030500         MOVE DELETE-COUNTER TO ERROR-TOTAL.
030600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
030700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030800      IF   INSPECT-COUNTER EQUAL TO ZERO
030900          MOVE "NO " TO ERROR-TOTAL
031000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
031100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
031200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031400 WRITE-LINE.
031500     ADD 1 TO RECORD-COUNT.
031600Y    IF RECORD-COUNT GREATER 42
031700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
031800Y        MOVE SPACE TO DUMMY-RECORD
031900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
032000Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
032100Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
032200Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
032300Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
032400Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
032500Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
032600Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
032700Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
032800Y        MOVE ZERO TO RECORD-COUNT.
032900     PERFORM WRT-LN.
033000 WRT-LN.
033100     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
033200     MOVE SPACE TO DUMMY-RECORD.
033300 BLANK-LINE-PRINT.
033400     PERFORM WRT-LN.
033500 FAIL-ROUTINE.
033600     IF     COMPUTED-X NOT EQUAL TO SPACE
033700            GO TO   FAIL-ROUTINE-WRITE.
033800     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
033900     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
034000     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
034100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034200     MOVE   SPACES TO INF-ANSI-REFERENCE.
034300     GO TO  FAIL-ROUTINE-EX.
034400 FAIL-ROUTINE-WRITE.
034500     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
034600     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
034700     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
034800     MOVE   SPACES TO COR-ANSI-REFERENCE.
034900 FAIL-ROUTINE-EX. EXIT.
035000 BAIL-OUT.
035100     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
035200     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
035300 BAIL-OUT-WRITE.
035400     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
035500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
035600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035700     MOVE   SPACES TO INF-ANSI-REFERENCE.
035800 BAIL-OUT-EX. EXIT.
035900 CCVS1-EXIT.
036000     EXIT.
036100 ST105-0001-01.
036200     OPEN     OUTPUT      SORTOUT-1E.
036300     MOVE     "THIS PROGRAM CHECKS ALL" TO RE-MARK.
036400     PERFORM  PRINT-DETAIL.
036500     MOVE     "203 RECORDS, TWO ITEMS" TO RE-MARK.
036600     PERFORM  PRINT-DETAIL.
036700     MOVE     "PER RECORD." TO RE-MARK.
036800     PERFORM  PRINT-DETAIL.
036900     MOVE     "SORT, USING-OUTPROC" TO FEATURE.
037000     PERFORM  PRINT-DETAIL.
037100     MOVE     "SORT-TEST-1" TO PAR-NAME.
037200 SORT-TEST-1.
037300     RETURN   SORTFILE-1E INTO SORTOUT-REC
037400              AT END GO TO OUTPROC-EXIT.
037500     WRITE    SORTOUT-REC.
037600     IF       NON-KEY-ITEM EQUAL TO +987654321078
037700              PERFORM PASS-1 ELSE PERFORM FAIL-1.
037800     IF       KEY-ITEM EQUAL TO U-TILITY
037900              PERFORM PASS-2 ELSE PERFORM FAIL-2.
038000     SUBTRACT 1 FROM RECORD-NUMBER.
038100     IF       U-TILITY GREATER THAN 214.200 GO TO NEW-PAIR.
038200     IF       UTIL-SW EQUAL TO 1 GO TO NEW-PAIR.
038300 CONTINUE-PAIR.
038400     MOVE     1 TO UTIL-SW.
038500     GO       TO SORT-TEST-1.
038600 NEW-PAIR.
038700     MOVE     0 TO UTIL-SW.
038800     SUBTRACT +002.142 FROM U-TILITY.
038900     GO       TO SORT-TEST-1.
039000 SUP-PORT SECTION.
039100 PASS-1.
039200     MOVE     "PASS" TO P-OR-F.
039300     MOVE     "NON-" TO NON.
039400     PERFORM  PRINT-FEATURE.
039500     PERFORM   PRINT-DETAIL.
039600 FAIL-1.
039700     MOVE     "FAIL" TO P-OR-F.
039800     ADD      1 TO ERROR-COUNTER.
039900     MOVE     "NON-" TO NON.
040000     MOVE     NON-KEY-ITEM TO COMPUTED-18V0.
040100     MOVE     +987654321078 TO CORRECT-18V0.
040200     PERFORM  PRINT-FEATURE.
040300     PERFORM   PRINT-DETAIL.
040400 PASS-2.
040500     MOVE     SPACE TO NON.
040600     MOVE     "PASS" TO P-OR-F.
040700     PERFORM  PRINT-FEATURE.
040800     PERFORM   PRINT-DETAIL.
040900 FAIL-2.
041000     MOVE     SPACE TO NON.
041100     MOVE     "FAIL" TO P-OR-F.
041200     ADD      1 TO ERROR-COUNTER.
041300     MOVE    KEY-ITEM TO COMPUTED-N.
041400     MOVE    U-TILITY TO CORRECT-N.
041500     PERFORM  PRINT-FEATURE.
041600     PERFORM   PRINT-DETAIL.
041700 PRINT-FEATURE.
041800     MOVE     RECORD-NUMBER TO EDITED-NUMBER.
041900     MOVE     FEATURE-BUILDER TO FEATURE.
042000 OUTPROC-EXIT SECTION.
042100 SORT-INIT-A.
042200     MOVE     "LAST SORTED RECORD" TO FEATURE.
042300 SORT-TEST-2.
042400     IF       U-TILITY  EQUAL TO -002.142
042500              PERFORM PASS GO TO SORT-WRITE-2.
042600 SORT-FAIL-2.
042700     MOVE     U-TILITY TO COMPUTED-N.
042800     MOVE     -002.142 TO CORRECT-N.
042900     PERFORM  FAIL.
043000 SORT-WRITE-2.
043100     MOVE     "SORT-TEST-2" TO PAR-NAME.
043200     PERFORM  PRINT-DETAIL.
043300 SORT-TEST-3.
043400     IF       UTIL-SW EQUAL TO ZERO
043500              PERFORM PASS GO TO SORT-WRITE-3.
043600 SORT-FAIL-3.
043700     MOVE     UTIL-SW TO COMPUTED-N.
043800     MOVE     ZERO TO CORRECT-N.
043900     MOVE     "LAST RECORDS NOT IN PAIRS" TO RE-MARK.
044000     PERFORM  FAIL.
044100 SORT-WRITE-3.
044200     MOVE     "SORT-TEST-3" TO PAR-NAME.
044300     PERFORM  PRINT-DETAIL.
044400     CLOSE    SORTOUT-1E.
044500     PERFORM  CLOSE-FILES.
