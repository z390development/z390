000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST107A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100 ENVIRONMENT DIVISION.
002200 CONFIGURATION SECTION.
002300 SOURCE-COMPUTER.
002400     XXXXX082.
002500 OBJECT-COMPUTER.
002600     XXXXX083.
002700 INPUT-OUTPUT SECTION.
002800 FILE-CONTROL.
002900     SELECT PRINT-FILE ASSIGN TO
003000     XXXXX055.
003100     SELECT   SORTIN-1G ASSIGN TO
003200     XXXXD001.
003300 DATA DIVISION.
003400 FILE SECTION.
003500 FD  PRINT-FILE.
003600 01  PRINT-REC PICTURE X(120).
003700 01  DUMMY-RECORD PICTURE X(120).
003800 FD  SORTIN-1G
003900     LABEL RECORDS STANDARD
004000C    VALUE OF
004100C    XXXXX074
004200C    IS
004300C    XXXXX075
004400G    XXXXX069
004500     RECORD   CONTAINS 27 CHARACTERS.
004600 01  SORTIN-REC.
004700     02 SORTKEY-3       PICTURE X.
004800     02 SORTKEY-1       PICTURE S9V9(7).
004900     02 SORTKEY-2       PICTURE 9(18).
005000 WORKING-STORAGE SECTION.
005100 77  UTIL-CTR           PICTURE S99999 VALUE ZERO.
005200 77  ITEM-3   PICTURE X(27) VALUE "FIRST OF 3 ITEMS IN RECORD ".
005300 77  ITEM-1   PICTURE X(27) VALUE "  SECOND OF 3 ITEMS        ".
005400 77  ITEM-2   PICTURE X(27) VALUE "    THIRD OF 3 ITEMS       ".
005500 77  DUM-MY   PICTURE X(27) VALUE "TEST UNNECESSARY - BYPASSED".
005600 77  ZER-O              PICTURE X VALUE "0".
005700 77  SPAC-E             PICTURE X VALUE " ".
005800 01  UTILITY-KEYS.
005900     02 UTILITY-3       PICTURE X.
006000     02 UTILITY-1       PICTURE S9V9(7).
006100     02 UTILITY-2       PICTURE 9(018).
006200 01  TEST-RESULTS.
006300     02 FILLER                   PIC X      VALUE SPACE.
006400     02 FEATURE                  PIC X(20)  VALUE SPACE.
006500     02 FILLER                   PIC X      VALUE SPACE.
006600     02 P-OR-F                   PIC X(5)   VALUE SPACE.
006700     02 FILLER                   PIC X      VALUE SPACE.
006800     02  PAR-NAME.
006900       03 FILLER                 PIC X(19)  VALUE SPACE.
007000       03  PARDOT-X              PIC X      VALUE SPACE.
007100       03 DOTVALUE               PIC 99     VALUE ZERO.
007200     02 FILLER                   PIC X(8)   VALUE SPACE.
007300     02 RE-MARK                  PIC X(61).
007400 01  TEST-COMPUTED.
007500     02 FILLER                   PIC X(30)  VALUE SPACE.
007600     02 FILLER                   PIC X(17)  VALUE
007700            "       COMPUTED=".
007800     02 COMPUTED-X.
007900     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
008000     03 COMPUTED-N               REDEFINES COMPUTED-A
008100                                 PIC -9(9).9(9).
008200     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
008300     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
008400     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
008500     03       CM-18V0 REDEFINES COMPUTED-A.
008600         04 COMPUTED-18V0                    PIC -9(18).
008700         04 FILLER                           PIC X.
008800     03 FILLER PIC X(50) VALUE SPACE.
008900 01  TEST-CORRECT.
009000     02 FILLER PIC X(30) VALUE SPACE.
009100     02 FILLER PIC X(17) VALUE "       CORRECT =".
009200     02 CORRECT-X.
009300     03 CORRECT-A                  PIC X(20) VALUE SPACE.
009400     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
009500     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
009600     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
009700     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
009800     03      CR-18V0 REDEFINES CORRECT-A.
009900         04 CORRECT-18V0                     PIC -9(18).
010000         04 FILLER                           PIC X.
010100     03 FILLER PIC X(2) VALUE SPACE.
010200     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
010300 01  CCVS-C-1.
010400     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
010500-    "SS  PARAGRAPH-NAME
010600-    "       REMARKS".
010700     02 FILLER                     PIC X(20)    VALUE SPACE.
010800 01  CCVS-C-2.
010900     02 FILLER                     PIC X        VALUE SPACE.
011000     02 FILLER                     PIC X(6)     VALUE "TESTED".
011100     02 FILLER                     PIC X(15)    VALUE SPACE.
011200     02 FILLER                     PIC X(4)     VALUE "FAIL".
011300     02 FILLER                     PIC X(94)    VALUE SPACE.
011400 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
011500 01  REC-CT                        PIC 99       VALUE ZERO.
011600 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
011700 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
011800 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
011900 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
012000 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
012100 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
012200 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
012300 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
012400 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
012500 01  CCVS-H-1.
012600     02  FILLER                    PIC X(39)    VALUE SPACES.
012700     02  FILLER                    PIC X(42)    VALUE
012800     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
012900     02  FILLER                    PIC X(39)    VALUE SPACES.
013000 01  CCVS-H-2A.
013100   02  FILLER                        PIC X(40)  VALUE SPACE.
013200   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
013300   02  FILLER                        PIC XXXX   VALUE
013400     "4.2 ".
013500   02  FILLER                        PIC X(28)  VALUE
013600            " COPY - NOT FOR DISTRIBUTION".
013700   02  FILLER                        PIC X(41)  VALUE SPACE.
013800
013900 01  CCVS-H-2B.
014000   02  FILLER                        PIC X(15)  VALUE
014100            "TEST RESULT OF ".
014200   02  TEST-ID                       PIC X(9).
014300   02  FILLER                        PIC X(4)   VALUE
014400            " IN ".
014500   02  FILLER                        PIC X(12)  VALUE
014600     " HIGH       ".
014700   02  FILLER                        PIC X(22)  VALUE
014800            " LEVEL VALIDATION FOR ".
014900   02  FILLER                        PIC X(58)  VALUE
015000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
015100 01  CCVS-H-3.
015200     02  FILLER                      PIC X(34)  VALUE
015300            " FOR OFFICIAL USE ONLY    ".
015400     02  FILLER                      PIC X(58)  VALUE
015500     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
015600     02  FILLER                      PIC X(28)  VALUE
015700            "  COPYRIGHT   1985 ".
015800 01  CCVS-E-1.
015900     02 FILLER                       PIC X(52)  VALUE SPACE.
016000     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
016100     02 ID-AGAIN                     PIC X(9).
016200     02 FILLER                       PIC X(45)  VALUE SPACES.
016300 01  CCVS-E-2.
016400     02  FILLER                      PIC X(31)  VALUE SPACE.
016500     02  FILLER                      PIC X(21)  VALUE SPACE.
016600     02 CCVS-E-2-2.
016700         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
016800         03 FILLER                   PIC X      VALUE SPACE.
016900         03 ENDER-DESC               PIC X(44)  VALUE
017000            "ERRORS ENCOUNTERED".
017100 01  CCVS-E-3.
017200     02  FILLER                      PIC X(22)  VALUE
017300            " FOR OFFICIAL USE ONLY".
017400     02  FILLER                      PIC X(12)  VALUE SPACE.
017500     02  FILLER                      PIC X(58)  VALUE
017600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
017700     02  FILLER                      PIC X(13)  VALUE SPACE.
017800     02 FILLER                       PIC X(15)  VALUE
017900             " COPYRIGHT 1985".
018000 01  CCVS-E-4.
018100     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
018200     02 FILLER                       PIC X(4)   VALUE " OF ".
018300     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
018400     02 FILLER                       PIC X(40)  VALUE
018500      "  TESTS WERE EXECUTED SUCCESSFULLY".
018600 01  XXINFO.
018700     02 FILLER                       PIC X(19)  VALUE
018800            "*** INFORMATION ***".
018900     02 INFO-TEXT.
019000       04 FILLER                     PIC X(8)   VALUE SPACE.
019100       04 XXCOMPUTED                 PIC X(20).
019200       04 FILLER                     PIC X(5)   VALUE SPACE.
019300       04 XXCORRECT                  PIC X(20).
019400     02 INF-ANSI-REFERENCE           PIC X(48).
019500 01  HYPHEN-LINE.
019600     02 FILLER  PIC IS X VALUE IS SPACE.
019700     02 FILLER  PIC IS X(65)    VALUE IS "************************
019800-    "*****************************************".
019900     02 FILLER  PIC IS X(54)    VALUE IS "************************
020000-    "******************************".
020100 01  CCVS-PGM-ID                     PIC X(9)   VALUE
020200     "ST107A".
020300 PROCEDURE DIVISION.
020400 CCVS1 SECTION.
020500 OPEN-FILES.
020600     OPEN     OUTPUT PRINT-FILE.
020700     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
020800     MOVE    SPACE TO TEST-RESULTS.
020900     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
021000     GO TO CCVS1-EXIT.
021100 CLOSE-FILES.
021200     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
021300 TERMINATE-CCVS.
021400S    EXIT PROGRAM.
021500STERMINATE-CALL.
021600     STOP     RUN.
021700 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
021800 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
021900 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
022000 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
022100     MOVE "****TEST DELETED****" TO RE-MARK.
022200 PRINT-DETAIL.
022300     IF REC-CT NOT EQUAL TO ZERO
022400             MOVE "." TO PARDOT-X
022500             MOVE REC-CT TO DOTVALUE.
022600     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
022700     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
022800        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
022900          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
023000     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
023100     MOVE SPACE TO CORRECT-X.
023200     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
023300     MOVE     SPACE TO RE-MARK.
023400 HEAD-ROUTINE.
023500     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023600     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023700     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
023800     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
023900 COLUMN-NAMES-ROUTINE.
024000     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
024100     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
024300 END-ROUTINE.
024400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
024500 END-RTN-EXIT.
024600     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024700 END-ROUTINE-1.
024800      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
024900      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
025000      ADD PASS-COUNTER TO ERROR-HOLD.
025100*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
025200      MOVE PASS-COUNTER TO CCVS-E-4-1.
025300      MOVE ERROR-HOLD TO CCVS-E-4-2.
025400      MOVE CCVS-E-4 TO CCVS-E-2-2.
025500      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
025600  END-ROUTINE-12.
025700      MOVE "TEST(S) FAILED" TO ENDER-DESC.
025800     IF       ERROR-COUNTER IS EQUAL TO ZERO
025900         MOVE "NO " TO ERROR-TOTAL
026000         ELSE
026100         MOVE ERROR-COUNTER TO ERROR-TOTAL.
026200     MOVE     CCVS-E-2 TO DUMMY-RECORD.
026300     PERFORM WRITE-LINE.
026400 END-ROUTINE-13.
026500     IF DELETE-COUNTER IS EQUAL TO ZERO
026600         MOVE "NO " TO ERROR-TOTAL  ELSE
026700         MOVE DELETE-COUNTER TO ERROR-TOTAL.
026800     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
026900     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027000      IF   INSPECT-COUNTER EQUAL TO ZERO
027100          MOVE "NO " TO ERROR-TOTAL
027200      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
027300      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
027400      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027500     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027600 WRITE-LINE.
027700     ADD 1 TO RECORD-COUNT.
027800Y    IF RECORD-COUNT GREATER 42
027900Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
028000Y        MOVE SPACE TO DUMMY-RECORD
028100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
028200Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
028300Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
028400Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
028500Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
028600Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
028700Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
028800Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
028900Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
029000Y        MOVE ZERO TO RECORD-COUNT.
029100     PERFORM WRT-LN.
029200 WRT-LN.
029300     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
029400     MOVE SPACE TO DUMMY-RECORD.
029500 BLANK-LINE-PRINT.
029600     PERFORM WRT-LN.
029700 FAIL-ROUTINE.
029800     IF     COMPUTED-X NOT EQUAL TO SPACE
029900            GO TO   FAIL-ROUTINE-WRITE.
030000     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
030100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
030200     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
030300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030400     MOVE   SPACES TO INF-ANSI-REFERENCE.
030500     GO TO  FAIL-ROUTINE-EX.
030600 FAIL-ROUTINE-WRITE.
030700     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
030800     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
030900     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
031000     MOVE   SPACES TO COR-ANSI-REFERENCE.
031100 FAIL-ROUTINE-EX. EXIT.
031200 BAIL-OUT.
031300     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
031400     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
031500 BAIL-OUT-WRITE.
031600     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
031700     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
031800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031900     MOVE   SPACES TO INF-ANSI-REFERENCE.
032000 BAIL-OUT-EX. EXIT.
032100 CCVS1-EXIT.
032200     EXIT.
032300 ST107-0001-01.
032400     OPEN    INPUT SORTIN-1G.
032500     MOVE     "SORT, MIXED CLASSES" TO FEATURE.
032600     IF       ZER-O IS LESS THAN SPAC-E
032700              GO TO ZERO-IS-LESS-THAN-SPACE.
032800 SPACE-IS-LESS-THAN-ZERO SECTION.
032900 SORT-INIT-A.
033000     MOVE     +0.0000001 TO UTILITY-1.
033100     MOVE     999999999999999999 TO UTILITY-2.
033200     MOVE     SPACE TO UTILITY-3.
033300 SORT-TEST-1.
033400     PERFORM  READ-SORTIN.
033500     MOVE     "SORT-TEST-1" TO PAR-NAME.
033600     IF       SORTIN-REC EQUAL TO UTILITY-KEYS
033700              PERFORM PASS GO TO SORT-WRITE-1.
033800 SORT-FAIL-1.
033900     MOVE     SORTKEY-3 TO COMPUTED-A.
034000     MOVE     UTILITY-3 TO CORRECT-A.
034100     MOVE     ITEM-3    TO RE-MARK.
034200     PERFORM  PRINT-DETAIL.
034300     MOVE     SORTKEY-1 TO COMPUTED-4V14.
034400     MOVE     UTILITY-1 TO CORRECT-4V14.
034500     MOVE     ITEM-1    TO RE-MARK.
034600     PERFORM  PRINT-DETAIL.
034700     MOVE     SORTKEY-2 TO COMPUTED-18V0.
034800     MOVE     UTILITY-2 TO CORRECT-18V0.
034900     MOVE     ITEM-2    TO RE-MARK.
035000     PERFORM  FAIL.
035100 SORT-WRITE-1.
035200     PERFORM  PRINT-DETAIL.
035300 SORT-INIT-B.
035400     MOVE     ZERO TO UTILITY-3.
035500     PERFORM  READ-SORTIN 4 TIMES.
035600*        NOTE SORT-TEST-2 CHECKS THE SIXTH RECORD IN THE FILE.
035700 SORT-TEST-2.
035800     PERFORM  READ-SORTIN.
035900     MOVE     "SORT-TEST-2" TO PAR-NAME.
036000     IF       SORTIN-REC EQUAL TO UTILITY-KEYS
036100              PERFORM PASS GO TO SORT-WRITE-2.
036200 SORT-FAIL-2.
036300     MOVE     SORTKEY-3 TO COMPUTED-A.
036400     MOVE     UTILITY-3 TO CORRECT-A.
036500     MOVE     ITEM-3    TO RE-MARK.
036600     PERFORM  PRINT-DETAIL.
036700     MOVE     SORTKEY-1 TO COMPUTED-4V14.
036800     MOVE     UTILITY-1 TO CORRECT-4V14.
036900     MOVE     ITEM-1    TO RE-MARK.
037000     PERFORM  PRINT-DETAIL.
037100     MOVE     SORTKEY-2 TO COMPUTED-18V0.
037200     MOVE     UTILITY-2 TO CORRECT-18V0.
037300     MOVE     ITEM-2    TO RE-MARK.
037400     PERFORM  FAIL.
037500 SORT-WRITE-2.
037600     PERFORM  PRINT-DETAIL.
037700 DUMMY-3-AND-4.
037800     MOVE     "SORT-TEST-3" TO PAR-NAME.
037900     MOVE     DUM-MY TO RE-MARK.
038000     PERFORM  PRINT-DETAIL.
038100     MOVE     "SORT-TEST-4" TO PAR-NAME.
038200     MOVE     DUM-MY TO RE-MARK.
038300     PERFORM  PRINT-DETAIL.
038400     GO       TO CONTINUE-TESTING.
038500 ZERO-IS-LESS-THAN-SPACE SECTION.
038600 SORT-INIT-C.
038700     MOVE     +0.0000001 TO UTILITY-1.
038800     MOVE     999999999999999999 TO UTILITY-2.
038900     MOVE     ZERO TO UTILITY-3.
039000 DUMMY-1-AND-2.
039100     MOVE     "SORT-TEST-1" TO PAR-NAME.
039200     MOVE     DUM-MY TO RE-MARK.
039300     PERFORM  PRINT-DETAIL.
039400     MOVE     "SORT-TEST-2" TO PAR-NAME.
039500     MOVE     DUM-MY TO RE-MARK.
039600     PERFORM  PRINT-DETAIL.
039700 SORT-TEST-3.
039800     PERFORM  READ-SORTIN.
039900     MOVE     "SORT-TEST-3" TO PAR-NAME.
040000     IF       SORTIN-REC EQUAL TO UTILITY-KEYS
040100              PERFORM PASS GO TO SORT-WRITE-3.
040200 SORT-FAIL-3.
040300     MOVE     SORTKEY-3 TO COMPUTED-A.
040400     MOVE     UTILITY-3 TO CORRECT-A.
040500     MOVE     ITEM-3    TO RE-MARK.
040600     PERFORM  PRINT-DETAIL.
040700     MOVE     SORTKEY-1 TO COMPUTED-4V14.
040800     MOVE     UTILITY-1 TO CORRECT-4V14.
040900     MOVE     ITEM-1    TO RE-MARK.
041000     PERFORM  PRINT-DETAIL.
041100     MOVE     SORTKEY-2 TO COMPUTED-18V0.
041200     MOVE     UTILITY-2 TO CORRECT-18V0.
041300     MOVE     ITEM-2    TO RE-MARK.
041400     PERFORM  FAIL.
041500 SORT-WRITE-3.
041600     PERFORM  PRINT-DETAIL.
041700 SORT-INIT-D.
041800     PERFORM  READ-SORTIN 4 TIMES.
041900     MOVE     SPACE TO UTILITY-3.
042000*        NOTE SORT-TEST-4 CHECKS THE SIXTH RECORD IN THE FILE.
042100 SORT-TEST-4.
042200     PERFORM  READ-SORTIN.
042300     MOVE     "SORT-TEST-4" TO PAR-NAME.
042400     IF       SORTIN-REC EQUAL TO UTILITY-KEYS
042500              PERFORM PASS GO TO SORT-WRITE-4.
042600 SORT-FAIL-4.
042700     MOVE     SORTKEY-3 TO COMPUTED-A.
042800     MOVE     UTILITY-3 TO CORRECT-A.
042900     MOVE     ITEM-3    TO RE-MARK.
043000     PERFORM  PRINT-DETAIL.
043100     MOVE     SORTKEY-1 TO COMPUTED-4V14.
043200     MOVE     UTILITY-1 TO CORRECT-4V14.
043300     MOVE     ITEM-1    TO RE-MARK.
043400     PERFORM  PRINT-DETAIL.
043500     MOVE     SORTKEY-2 TO COMPUTED-18V0.
043600     MOVE     UTILITY-2 TO CORRECT-18V0.
043700     MOVE     ITEM-2    TO RE-MARK.
043800     PERFORM  FAIL.
043900 SORT-WRITE-4.
044000     PERFORM  PRINT-DETAIL.
044100 CONTINUE-TESTING SECTION.
044200 SORT-INIT-E.
044300     MOVE     +1.1111112 TO UTILITY-1.
044400     MOVE     SPACE TO UTILITY-3.
044500*        NOTE SORT-TEST-5 CHECKS THE SEVENTH RECORD IN THE FILE.
044600 SORT-TEST-5.
044700     PERFORM  READ-SORTIN.
044800     MOVE     "SORT-TEST-5" TO PAR-NAME.
044900     IF       SORTIN-REC EQUAL TO UTILITY-KEYS
045000              PERFORM PASS GO TO SORT-WRITE-5.
045100 SORT-FAIL-5.
045200     MOVE     SORTKEY-3 TO COMPUTED-A.
045300     MOVE     UTILITY-3 TO CORRECT-A.
045400     MOVE     ITEM-3    TO RE-MARK.
045500     PERFORM  PRINT-DETAIL.
045600     MOVE     SORTKEY-1 TO COMPUTED-4V14.
045700     MOVE     UTILITY-1 TO CORRECT-4V14.
045800     MOVE     ITEM-1    TO RE-MARK.
045900     PERFORM  PRINT-DETAIL.
046000     MOVE     SORTKEY-2 TO COMPUTED-18V0.
046100     MOVE     UTILITY-2 TO CORRECT-18V0.
046200     MOVE     ITEM-2    TO RE-MARK.
046300     PERFORM  FAIL.
046400 SORT-WRITE-5.
046500     PERFORM  PRINT-DETAIL.
046600 SORT-INIT-F.
046700     PERFORM  READ-SORTIN.
046800     MOVE     888888888888888888 TO UTILITY-2.
046900*        NOTE SORT-TEST-6 CHECKS THE NINTH RECORD IN THE FILE.
047000 SORT-TEST-6.
047100     PERFORM  READ-SORTIN.
047200     MOVE     "SORT-TEST-6" TO PAR-NAME.
047300     IF       SORTIN-REC EQUAL TO UTILITY-KEYS
047400              PERFORM PASS GO TO SORT-WRITE-6.
047500 SORT-FAIL-6.
047600     MOVE     SORTKEY-3 TO COMPUTED-A.
047700     MOVE     UTILITY-3 TO CORRECT-A.
047800     MOVE     ITEM-3    TO RE-MARK.
047900     PERFORM  PRINT-DETAIL.
048000     MOVE     SORTKEY-1 TO COMPUTED-4V14.
048100     MOVE     UTILITY-1 TO CORRECT-4V14.
048200     MOVE     ITEM-1    TO RE-MARK.
048300     PERFORM  PRINT-DETAIL.
048400     MOVE     SORTKEY-2 TO COMPUTED-18V0.
048500     MOVE     UTILITY-2 TO CORRECT-18V0.
048600     MOVE     ITEM-2    TO RE-MARK.
048700     PERFORM  FAIL.
048800 SORT-WRITE-6.
048900     PERFORM  PRINT-DETAIL.
049000 SORT-TEST-7.
049100     READ     SORTIN-1G AT END
049200              PERFORM PASS GO TO SORT-WRITE-7.
049300 SORT-FAIL-7.
049400     MOVE     SORTKEY-3 TO COMPUTED-A.
049500     MOVE     "END OF FILE NOT FOUND" TO RE-MARK.
049600     PERFORM  FAIL.
049700 SORT-WRITE-7.
049800     MOVE     "SORT-TEST-7" TO PAR-NAME.
049900     PERFORM  PRINT-DETAIL.
050000 SORT-TEST-8.
050100     IF       UTIL-CTR EQUAL TO 9
050200              PERFORM PASS GO TO SORT-WRITE-8.
050300 SORT-FAIL-8.
050400     MOVE     UTIL-CTR TO COMPUTED-4V14.
050500     MOVE     9 TO CORRECT-4V14.
050600     PERFORM  FAIL.
050700 SORT-WRITE-8.
050800     MOVE     "SORT-TEST-8" TO PAR-NAME.
050900     PERFORM  PRINT-DETAIL.
051000     CLOSE    SORTIN-1G.
051100     GO TO    CCVS-EXIT.
051200 READ-SORTIN.
051300     READ     SORTIN-1G AT END GO TO READ-ERROR.
051400     ADD      1 TO UTIL-CTR.
051500 READ-ERROR.
051600     MOVE     "READ-ERROR" TO PAR-NAME.
051700     MOVE     "EOF PREMATURELY FOUND" TO RE-MARK.
051800     PERFORM  FAIL.
051900     PERFORM  PRINT-DETAIL.
052000 CCVS-EXIT SECTION.
052100 CCVS-999999.
052200     GO TO CLOSE-FILES.
