000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IF128A.
000400
000500***********************************************************
000600*                                                         *
000700* This program forms part of the CCVS85 COBOL Test Suite. *
000800* It contains tests for the Intrinsic Function ORD-MAX.   *
000900*                                                         *
001000*                                                         *
001100***********************************************************
001200 ENVIRONMENT DIVISION.
001300 CONFIGURATION SECTION.
001400 SOURCE-COMPUTER.
001500     XXXXX082.
001600 OBJECT-COMPUTER.
001700     XXXXX083
001800     PROGRAM COLLATING SEQUENCE IS PRG-COLL-SEQ.
001900 SPECIAL-NAMES.
002000     ALPHABET PRG-COLL-SEQ IS
002100     STANDARD-2.
002200 INPUT-OUTPUT SECTION.
002300 FILE-CONTROL.
002400     SELECT PRINT-FILE ASSIGN TO
002500     XXXXX055.
002600 DATA DIVISION.
002700 FILE SECTION.
002800 FD  PRINT-FILE.
002900 01  PRINT-REC PICTURE X(120).
003000 01  DUMMY-RECORD PICTURE X(120).
003100 WORKING-STORAGE SECTION.
003200***********************************************************
003300* Variables specific to the Intrinsic Function Test IF128A*
003400***********************************************************
003500 01  A                   PIC S9(10)     VALUE 5.
003600 01  B                   PIC S9(10)     VALUE 7.
003700 01  C                   PIC S9(10)     VALUE 4.
003800 01  D                   PIC S9(10)     VALUE 10.
003900 01  I                   PIC X(4)       VALUE "R".
004000 01  J                   PIC X(4)       VALUE "U".
004100 01  P                   PIC S9(10)     VALUE 1.
004200 01  Q                   PIC S9(10)     VALUE 3.
004300 01  R                   PIC S9(10)     VALUE 5.
004400 01  ARG1                PIC S9(10)     VALUE 1.
004500 01  ARR                                VALUE "40537".
004600     02 IND OCCURS 5 TIMES   PIC 9.
004700 01  TEMP                PIC S9(10).
004800 01  WS-INT              PIC S9(10).
004900*
005000**********************************************************
005100*
005200 01  TEST-RESULTS.
005300     02 FILLER                   PIC X      VALUE SPACE.
005400     02 FEATURE                  PIC X(20)  VALUE SPACE.
005500     02 FILLER                   PIC X      VALUE SPACE.
005600     02 P-OR-F                   PIC X(5)   VALUE SPACE.
005700     02 FILLER                   PIC X      VALUE SPACE.
005800     02  PAR-NAME.
005900       03 FILLER                 PIC X(19)  VALUE SPACE.
006000       03  PARDOT-X              PIC X      VALUE SPACE.
006100       03 DOTVALUE               PIC 99     VALUE ZERO.
006200     02 FILLER                   PIC X(8)   VALUE SPACE.
006300     02 RE-MARK                  PIC X(61).
006400 01  TEST-COMPUTED.
006500     02 FILLER                   PIC X(30)  VALUE SPACE.
006600     02 FILLER                   PIC X(17)  VALUE
006700            "       COMPUTED=".
006800     02 COMPUTED-X.
006900     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
007000     03 COMPUTED-N               REDEFINES COMPUTED-A
007100                                 PIC -9(9).9(9).
007200     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
007300     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
007400     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
007500     03       CM-18V0 REDEFINES COMPUTED-A.
007600         04 COMPUTED-18V0                    PIC -9(18).
007700         04 FILLER                           PIC X.
007800     03 FILLER PIC X(50) VALUE SPACE.
007900 01  TEST-CORRECT.
008000     02 FILLER PIC X(30) VALUE SPACE.
008100     02 FILLER PIC X(17) VALUE "       CORRECT =".
008200     02 CORRECT-X.
008300     03 CORRECT-A                  PIC X(20) VALUE SPACE.
008400     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
008500     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
008600     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
008700     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
008800     03      CR-18V0 REDEFINES CORRECT-A.
008900         04 CORRECT-18V0                     PIC -9(18).
009000         04 FILLER                           PIC X.
009100     03 FILLER PIC X(2) VALUE SPACE.
009200     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
009300 01  TEST-CORRECT-MIN.
009400     02 FILLER PIC X(30) VALUE SPACE.
009500     02 FILLER PIC X(17) VALUE "     MIN VALUE =".
009600     02 CORRECTMI-X.
009700     03 CORRECTMI-A                 PIC X(20) VALUE SPACE.
009800     03 CORRECT-MIN    REDEFINES CORRECTMI-A     PIC -9(9).9(9).
009900     03 CORRECTMI-0V18 REDEFINES CORRECTMI-A     PIC -.9(18).
010000     03 CORRECTMI-4V14 REDEFINES CORRECTMI-A     PIC -9(4).9(14).
010100     03 CORRECTMI-14V4 REDEFINES CORRECTMI-A     PIC -9(14).9(4).
010200     03      CR-18V0 REDEFINES CORRECTMI-A.
010300         04 CORRECTMI-18V0                     PIC -9(18).
010400         04 FILLER                           PIC X.
010500     03 FILLER PIC X(2) VALUE SPACE.
010600     03 FILLER                           PIC X(48) VALUE SPACE.
010700 01  TEST-CORRECT-MAX.
010800     02 FILLER PIC X(30) VALUE SPACE.
010900     02 FILLER PIC X(17) VALUE "     MAX VALUE =".
011000     02 CORRECTMA-X.
011100     03 CORRECTMA-A                  PIC X(20) VALUE SPACE.
011200     03 CORRECT-MAX    REDEFINES CORRECTMA-A     PIC -9(9).9(9).
011300     03 CORRECTMA-0V18 REDEFINES CORRECTMA-A     PIC -.9(18).
011400     03 CORRECTMA-4V14 REDEFINES CORRECTMA-A     PIC -9(4).9(14).
011500     03 CORRECTMA-14V4 REDEFINES CORRECTMA-A     PIC -9(14).9(4).
011600     03      CR-18V0 REDEFINES CORRECTMA-A.
011700         04 CORRECTMA-18V0                     PIC -9(18).
011800         04 FILLER                           PIC X.
011900     03 FILLER PIC X(2) VALUE SPACE.
012000     03 CORMA-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
012100 01  CCVS-C-1.
012200     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
012300-    "SS  PARAGRAPH-NAME
012400-    "       REMARKS".
012500     02 FILLER                     PIC X(20)    VALUE SPACE.
012600 01  CCVS-C-2.
012700     02 FILLER                     PIC X        VALUE SPACE.
012800     02 FILLER                     PIC X(6)     VALUE "TESTED".
012900     02 FILLER                     PIC X(15)    VALUE SPACE.
013000     02 FILLER                     PIC X(4)     VALUE "FAIL".
013100     02 FILLER                     PIC X(94)    VALUE SPACE.
013200 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
013300 01  REC-CT                        PIC 99       VALUE ZERO.
013400 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
013500 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
013600 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
013700 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
013800 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
013900 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
014000 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
014100 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
014200 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
014300 01  CCVS-H-1.
014400     02  FILLER                    PIC X(39)    VALUE SPACES.
014500     02  FILLER                    PIC X(42)    VALUE
014600     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
014700     02  FILLER                    PIC X(39)    VALUE SPACES.
014800 01  CCVS-H-2A.
014900   02  FILLER                        PIC X(40)  VALUE SPACE.
015000   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
015100   02  FILLER                        PIC XXXX   VALUE
015200     "4.2 ".
015300   02  FILLER                        PIC X(28)  VALUE
015400            " COPY - NOT FOR DISTRIBUTION".
015500   02  FILLER                        PIC X(41)  VALUE SPACE.
015600
015700 01  CCVS-H-2B.
015800   02  FILLER                        PIC X(15)  VALUE
015900            "TEST RESULT OF ".
016000   02  TEST-ID                       PIC X(9).
016100   02  FILLER                        PIC X(4)   VALUE
016200            " IN ".
016300   02  FILLER                        PIC X(12)  VALUE
016400     " HIGH       ".
016500   02  FILLER                        PIC X(22)  VALUE
016600            " LEVEL VALIDATION FOR ".
016700   02  FILLER                        PIC X(58)  VALUE
016800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
016900 01  CCVS-H-3.
017000     02  FILLER                      PIC X(34)  VALUE
017100            " FOR OFFICIAL USE ONLY    ".
017200     02  FILLER                      PIC X(58)  VALUE
017300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
017400     02  FILLER                      PIC X(28)  VALUE
017500            "  COPYRIGHT   1985 ".
017600 01  CCVS-E-1.
017700     02 FILLER                       PIC X(52)  VALUE SPACE.
017800     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
017900     02 ID-AGAIN                     PIC X(9).
018000     02 FILLER                       PIC X(45)  VALUE SPACES.
018100 01  CCVS-E-2.
018200     02  FILLER                      PIC X(31)  VALUE SPACE.
018300     02  FILLER                      PIC X(21)  VALUE SPACE.
018400     02 CCVS-E-2-2.
018500         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
018600         03 FILLER                   PIC X      VALUE SPACE.
018700         03 ENDER-DESC               PIC X(44)  VALUE
018800            "ERRORS ENCOUNTERED".
018900 01  CCVS-E-3.
019000     02  FILLER                      PIC X(22)  VALUE
019100            " FOR OFFICIAL USE ONLY".
019200     02  FILLER                      PIC X(12)  VALUE SPACE.
019300     02  FILLER                      PIC X(58)  VALUE
019400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
019500     02  FILLER                      PIC X(13)  VALUE SPACE.
019600     02 FILLER                       PIC X(15)  VALUE
019700             " COPYRIGHT 1985".
019800 01  CCVS-E-4.
019900     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
020000     02 FILLER                       PIC X(4)   VALUE " OF ".
020100     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
020200     02 FILLER                       PIC X(40)  VALUE
020300      "  TESTS WERE EXECUTED SUCCESSFULLY".
020400 01  XXINFO.
020500     02 FILLER                       PIC X(19)  VALUE
020600            "*** INFORMATION ***".
020700     02 INFO-TEXT.
020800       04 FILLER                     PIC X(8)   VALUE SPACE.
020900       04 XXCOMPUTED                 PIC X(20).
021000       04 FILLER                     PIC X(5)   VALUE SPACE.
021100       04 XXCORRECT                  PIC X(20).
021200     02 INF-ANSI-REFERENCE           PIC X(48).
021300 01  HYPHEN-LINE.
021400     02 FILLER  PIC IS X VALUE IS SPACE.
021500     02 FILLER  PIC IS X(65)    VALUE IS "************************
021600-    "*****************************************".
021700     02 FILLER  PIC IS X(54)    VALUE IS "************************
021800-    "******************************".
021900 01  CCVS-PGM-ID                     PIC X(9)   VALUE
022000     "IF128A".
022100 PROCEDURE DIVISION.
022200 CCVS1 SECTION.
022300 OPEN-FILES.
022400     OPEN     OUTPUT PRINT-FILE.
022500     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
022600     MOVE    SPACE TO TEST-RESULTS.
022700     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
022800     GO TO CCVS1-EXIT.
022900 CLOSE-FILES.
023000     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
023100 TERMINATE-CCVS.
023200     STOP     RUN.
023300 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
023400 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
023500 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
023600 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
023700     MOVE "****TEST DELETED****" TO RE-MARK.
023800 PRINT-DETAIL.
023900     IF REC-CT NOT EQUAL TO ZERO
024000             MOVE "." TO PARDOT-X
024100             MOVE REC-CT TO DOTVALUE.
024200     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
024300     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
024400        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
024500          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
024600     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
024700     MOVE SPACE TO CORRECT-X.
024800     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
024900     MOVE     SPACE TO RE-MARK.
025000 HEAD-ROUTINE.
025100     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025200     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025300     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
025400     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
025500 COLUMN-NAMES-ROUTINE.
025600     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025700     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
025900 END-ROUTINE.
026000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
026100 END-RTN-EXIT.
026200     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026300 END-ROUTINE-1.
026400      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
026500      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
026600      ADD PASS-COUNTER TO ERROR-HOLD.
026700      MOVE PASS-COUNTER TO CCVS-E-4-1.
026800      MOVE ERROR-HOLD TO CCVS-E-4-2.
026900      MOVE CCVS-E-4 TO CCVS-E-2-2.
027000      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
027100  END-ROUTINE-12.
027200      MOVE "TEST(S) FAILED" TO ENDER-DESC.
027300     IF       ERROR-COUNTER IS EQUAL TO ZERO
027400         MOVE "NO " TO ERROR-TOTAL
027500         ELSE
027600         MOVE ERROR-COUNTER TO ERROR-TOTAL.
027700     MOVE     CCVS-E-2 TO DUMMY-RECORD.
027800     PERFORM WRITE-LINE.
027900 END-ROUTINE-13.
028000     IF DELETE-COUNTER IS EQUAL TO ZERO
028100         MOVE "NO " TO ERROR-TOTAL  ELSE
028200         MOVE DELETE-COUNTER TO ERROR-TOTAL.
028300     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
028400     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028500      IF   INSPECT-COUNTER EQUAL TO ZERO
028600          MOVE "NO " TO ERROR-TOTAL
028700      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
028800      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
028900      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029000     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029100 WRITE-LINE.
029200     ADD 1 TO RECORD-COUNT.
029300Y    IF RECORD-COUNT GREATER 42
029400Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
029500Y        MOVE SPACE TO DUMMY-RECORD
029600Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
029700Y        MOVE CCVS-H-1  TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
029800Y        MOVE CCVS-H-2A TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
029900Y        MOVE CCVS-H-2B TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
030000Y        MOVE CCVS-H-3  TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
030100Y        MOVE CCVS-C-1  TO DUMMY-RECORD  PERFORM WRT-LN
030200Y        MOVE CCVS-C-2  TO DUMMY-RECORD  PERFORM WRT-LN
030300Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
030400Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
030500Y        MOVE ZERO TO RECORD-COUNT.
030600     PERFORM WRT-LN.
030700 WRT-LN.
030800     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
030900     MOVE SPACE TO DUMMY-RECORD.
031000 BLANK-LINE-PRINT.
031100     PERFORM WRT-LN.
031200 FAIL-ROUTINE.
031300     IF     COMPUTED-X NOT EQUAL TO SPACE
031400            GO TO FAIL-ROUTINE-WRITE.
031500     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
031600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
031700     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
031800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031900     MOVE   SPACES TO INF-ANSI-REFERENCE.
032000     GO TO  FAIL-ROUTINE-EX.
032100 FAIL-ROUTINE-WRITE.
032200     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE.
032300     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE
032400                              CORMA-ANSI-REFERENCE.
032500     IF CORRECT-MIN NOT EQUAL TO SPACES THEN
032600           MOVE TEST-CORRECT-MIN TO PRINT-REC PERFORM WRITE-LINE
032700           MOVE TEST-CORRECT-MAX TO PRINT-REC PERFORM WRITE-LINE
032800     ELSE
032900           MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE.
033000     PERFORM WRITE-LINE.
033100     MOVE   SPACES TO COR-ANSI-REFERENCE.
033200 FAIL-ROUTINE-EX. EXIT.
033300 BAIL-OUT.
033400     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
033500     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
033600 BAIL-OUT-WRITE.
033700     MOVE CORRECT-A TO XXCORRECT.
033800     MOVE COMPUTED-A TO XXCOMPUTED.
033900     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
034000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034100     MOVE   SPACES TO INF-ANSI-REFERENCE.
034200 BAIL-OUT-EX. EXIT.
034300 CCVS1-EXIT.
034400     EXIT.
034500********************************************************
034600*                                                      *
034700*    Intrinsic Function Tests         IF128A - ORD-MAX *
034800*                                                      *
034900********************************************************
035000 SECT-IF128A SECTION.
035100 F-ORD-MAX-INFO.
035200     MOVE     "See ref. A-61 2.32" TO ANSI-REFERENCE.
035300     MOVE     "ORD-MAX Function"     TO FEATURE.
035400*****************TEST (a) ******************************
035500 F-ORD-MAX-01.
035600     MOVE ZERO TO WS-INT.
035700 F-ORD-MAX-TEST-01.
035800     COMPUTE WS-INT = FUNCTION ORD-MAX(5, 3, 2, 8, 3, 1).
035900     IF WS-INT = 4 THEN
036000                        PERFORM PASS
036100     ELSE
036200                        MOVE 4  TO CORRECT-N
036300                        MOVE WS-INT TO COMPUTED-N
036400                        PERFORM FAIL.
036500     GO TO F-ORD-MAX-WRITE-01.
036600 F-ORD-MAX-DELETE-01.
036700     PERFORM  DE-LETE.
036800     GO TO    F-ORD-MAX-WRITE-01.
036900 F-ORD-MAX-WRITE-01.
037000     MOVE "F-ORD-MAX-01" TO PAR-NAME.
037100     PERFORM  PRINT-DETAIL.
037200*****************TEST (b) ******************************
037300 F-ORD-MAX-TEST-02.
037400     EVALUATE FUNCTION ORD-MAX(3, 2, 7, 1, 5)
037500     WHEN 3
037600                                 PERFORM PASS
037700                                 GO TO F-ORD-MAX-WRITE-02.
037800     PERFORM FAIL.
037900     GO TO F-ORD-MAX-WRITE-02.
038000 F-ORD-MAX-DELETE-02.
038100     PERFORM  DE-LETE.
038200     GO TO    F-ORD-MAX-WRITE-02.
038300 F-ORD-MAX-WRITE-02.
038400     MOVE "F-ORD-MAX-02" TO PAR-NAME.
038500     PERFORM  PRINT-DETAIL.
038600*****************TEST (c) ******************************
038700 F-ORD-MAX-03.
038800     MOVE ZERO TO WS-INT.
038900 F-ORD-MAX-TEST-03.
039000     IF FUNCTION ORD-MAX(A, B, D) = 3 THEN
039100                        PERFORM PASS
039200     ELSE
039300                        PERFORM FAIL.
039400     GO TO F-ORD-MAX-WRITE-03.
039500 F-ORD-MAX-DELETE-03.
039600     PERFORM  DE-LETE.
039700     GO TO    F-ORD-MAX-WRITE-03.
039800 F-ORD-MAX-WRITE-03.
039900     MOVE "F-ORD-MAX-03" TO PAR-NAME.
040000     PERFORM  PRINT-DETAIL.
040100*****************TEST (d) ******************************
040200 F-ORD-MAX-04.
040300     MOVE ZERO TO WS-INT.
040400 F-ORD-MAX-TEST-04.
040500     COMPUTE WS-INT = FUNCTION ORD-MAX(A, B, C).
040600     IF WS-INT = 2 THEN
040700                        PERFORM PASS
040800     ELSE
040900                        MOVE 2   TO CORRECT-N
041000                        MOVE WS-INT TO COMPUTED-N
041100                        PERFORM FAIL.
041200     GO TO F-ORD-MAX-WRITE-04.
041300 F-ORD-MAX-DELETE-04.
041400     PERFORM  DE-LETE.
041500     GO TO    F-ORD-MAX-WRITE-04.
041600 F-ORD-MAX-WRITE-04.
041700     MOVE "F-ORD-MAX-04" TO PAR-NAME.
041800     PERFORM  PRINT-DETAIL.
041900*****************TEST (e) ******************************
042000 F-ORD-MAX-05.
042100     MOVE ZERO TO WS-INT.
042200 F-ORD-MAX-TEST-05.
042300     COMPUTE WS-INT = FUNCTION ORD-MAX(A, 4, B, 7, C, 9).
042400     IF WS-INT = 6 THEN
042500                        PERFORM PASS
042600     ELSE
042700                        MOVE 6    TO CORRECT-N
042800                        MOVE WS-INT TO COMPUTED-N
042900                        PERFORM FAIL.
043000     GO TO F-ORD-MAX-WRITE-05.
043100 F-ORD-MAX-DELETE-05.
043200     PERFORM  DE-LETE.
043300     GO TO    F-ORD-MAX-WRITE-05.
043400 F-ORD-MAX-WRITE-05.
043500     MOVE "F-ORD-MAX-05" TO PAR-NAME.
043600     PERFORM  PRINT-DETAIL.
043700*****************TEST (f) ******************************
043800 F-ORD-MAX-06.
043900     MOVE ZERO TO WS-INT.
044000 F-ORD-MAX-TEST-06.
044100     COMPUTE WS-INT = FUNCTION ORD-MAX(4, 9, A, 3).
044200     IF WS-INT = 2 THEN
044300                        PERFORM PASS
044400     ELSE
044500                        MOVE 2   TO CORRECT-N
044600                        MOVE WS-INT TO COMPUTED-N
044700                        PERFORM FAIL.
044800     GO TO F-ORD-MAX-WRITE-06.
044900 F-ORD-MAX-DELETE-06.
045000     PERFORM  DE-LETE.
045100     GO TO    F-ORD-MAX-WRITE-06.
045200 F-ORD-MAX-WRITE-06.
045300     MOVE "F-ORD-MAX-06" TO PAR-NAME.
045400     PERFORM  PRINT-DETAIL.
045500*****************TEST (g) ******************************
045600 F-ORD-MAX-07.
045700     MOVE ZERO TO WS-INT.
045800 F-ORD-MAX-TEST-07.
045900     COMPUTE WS-INT = FUNCTION ORD-MAX("A", I, "P").
046000     IF WS-INT = 2 THEN
046100                        PERFORM PASS
046200     ELSE
046300                        MOVE 2    TO CORRECT-N
046400                        MOVE WS-INT TO COMPUTED-N
046500                        PERFORM FAIL.
046600     GO TO F-ORD-MAX-WRITE-07.
046700 F-ORD-MAX-DELETE-07.
046800     PERFORM  DE-LETE.
046900     GO TO    F-ORD-MAX-WRITE-07.
047000 F-ORD-MAX-WRITE-07.
047100     MOVE "F-ORD-MAX-07" TO PAR-NAME.
047200     PERFORM  PRINT-DETAIL.
047300*****************TEST (h) ******************************
047400 F-ORD-MAX-08.
047500     MOVE ZERO TO WS-INT.
047600 F-ORD-MAX-TEST-08.
047700     COMPUTE WS-INT = FUNCTION ORD-MAX("S", "D", J).
047800     IF WS-INT = 3 THEN
047900                        PERFORM PASS
048000     ELSE
048100                        MOVE 3    TO CORRECT-N
048200                        MOVE WS-INT TO COMPUTED-N
048300                        PERFORM FAIL.
048400     GO TO F-ORD-MAX-WRITE-08.
048500 F-ORD-MAX-DELETE-08.
048600     PERFORM  DE-LETE.
048700     GO TO    F-ORD-MAX-WRITE-08.
048800 F-ORD-MAX-WRITE-08.
048900     MOVE "F-ORD-MAX-08" TO PAR-NAME.
049000     PERFORM  PRINT-DETAIL.
049100*****************TEST (i) ******************************
049200 F-ORD-MAX-09.
049300     MOVE ZERO TO WS-INT.
049400 F-ORD-MAX-TEST-09.
049500     COMPUTE WS-INT = FUNCTION ORD-MAX(A, 5, 5, A).
049600     IF WS-INT = 1 THEN
049700                        PERFORM PASS
049800     ELSE
049900                        MOVE 1   TO CORRECT-N
050000                        MOVE WS-INT TO COMPUTED-N
050100                        PERFORM FAIL.
050200     GO TO F-ORD-MAX-WRITE-09.
050300 F-ORD-MAX-DELETE-09.
050400     PERFORM  DE-LETE.
050500     GO TO    F-ORD-MAX-WRITE-09.
050600 F-ORD-MAX-WRITE-09.
050700     MOVE "F-ORD-MAX-09" TO PAR-NAME.
050800     PERFORM  PRINT-DETAIL.
050900*****************TEST (j) ******************************
051000 F-ORD-MAX-10.
051100     MOVE ZERO TO WS-INT.
051200 F-ORD-MAX-TEST-10.
051300     COMPUTE WS-INT = FUNCTION ORD-MAX(IND(1), IND(2), IND(3)).
051400     IF WS-INT = 3 THEN
051500                        PERFORM PASS
051600     ELSE
051700                        MOVE 3    TO CORRECT-N
051800                        MOVE WS-INT TO COMPUTED-N
051900                        PERFORM FAIL.
052000     GO TO F-ORD-MAX-WRITE-10.
052100 F-ORD-MAX-DELETE-10.
052200     PERFORM  DE-LETE.
052300     GO TO    F-ORD-MAX-WRITE-10.
052400 F-ORD-MAX-WRITE-10.
052500     MOVE "F-ORD-MAX-10" TO PAR-NAME.
052600     PERFORM  PRINT-DETAIL.
052700*****************TEST (k) ******************************
052800 F-ORD-MAX-11.
052900     MOVE ZERO TO WS-INT.
053000 F-ORD-MAX-TEST-11.
053100     COMPUTE WS-INT = FUNCTION ORD-MAX(IND(R), IND(P), IND(Q)).
053200     IF WS-INT = 1 THEN
053300                        PERFORM PASS
053400     ELSE
053500                        MOVE 1   TO CORRECT-N
053600                        MOVE WS-INT TO COMPUTED-N
053700                        PERFORM FAIL.
053800     GO TO F-ORD-MAX-WRITE-11.
053900 F-ORD-MAX-DELETE-11.
054000     PERFORM  DE-LETE.
054100     GO TO    F-ORD-MAX-WRITE-11.
054200 F-ORD-MAX-WRITE-11.
054300     MOVE "F-ORD-MAX-11" TO PAR-NAME.
054400     PERFORM  PRINT-DETAIL.
054500*****************TEST (l) ******************************
054600 F-ORD-MAX-12.
054700     MOVE ZERO TO WS-INT.
054800 F-ORD-MAX-TEST-12.
054900     COMPUTE WS-INT = FUNCTION ORD-MAX(IND(ALL)).
055000     IF WS-INT = 5 THEN
055100                        PERFORM PASS
055200     ELSE
055300                        MOVE 5    TO CORRECT-N
055400                        MOVE WS-INT TO COMPUTED-N
055500                        PERFORM FAIL.
055600     GO TO F-ORD-MAX-WRITE-12.
055700 F-ORD-MAX-DELETE-12.
055800     PERFORM  DE-LETE.
055900     GO TO    F-ORD-MAX-WRITE-12.
056000 F-ORD-MAX-WRITE-12.
056100     MOVE "F-ORD-MAX-12" TO PAR-NAME.
056200     PERFORM  PRINT-DETAIL.
056300*****************TEST (m) ******************************
056400 F-ORD-MAX-13.
056500     MOVE ZERO TO WS-INT.
056600 F-ORD-MAX-TEST-13.
056700     COMPUTE WS-INT = FUNCTION ORD-MAX(
056800                           FUNCTION ORD-MAX(1, 4), 3, 1).
056900     IF WS-INT = 2 THEN
057000                        PERFORM PASS
057100     ELSE
057200                        MOVE 2    TO CORRECT-N
057300                        MOVE WS-INT TO COMPUTED-N
057400                        PERFORM FAIL.
057500     GO TO F-ORD-MAX-WRITE-13.
057600 F-ORD-MAX-DELETE-13.
057700     PERFORM  DE-LETE.
057800     GO TO    F-ORD-MAX-WRITE-13.
057900 F-ORD-MAX-WRITE-13.
058000     MOVE "F-ORD-MAX-13" TO PAR-NAME.
058100     PERFORM  PRINT-DETAIL.
058200*****************TEST (n) ******************************
058300 F-ORD-MAX-14.
058400     MOVE ZERO TO WS-INT.
058500 F-ORD-MAX-TEST-14.
058600     COMPUTE WS-INT = FUNCTION ORD-MAX(2, 3, C) + A.
058700     IF WS-INT = 8 THEN
058800                        PERFORM PASS
058900     ELSE
059000                        MOVE 8    TO CORRECT-N
059100                        MOVE WS-INT TO COMPUTED-N
059200                        PERFORM FAIL.
059300     GO TO F-ORD-MAX-WRITE-14.
059400 F-ORD-MAX-DELETE-14.
059500     PERFORM  DE-LETE.
059600     GO TO    F-ORD-MAX-WRITE-14.
059700 F-ORD-MAX-WRITE-14.
059800     MOVE "F-ORD-MAX-14" TO PAR-NAME.
059900     PERFORM  PRINT-DETAIL.
060000*****************TEST (o) ******************************
060100 F-ORD-MAX-15.
060200     MOVE ZERO TO WS-INT.
060300 F-ORD-MAX-TEST-15.
060400     COMPUTE WS-INT = FUNCTION ORD-MAX(2, 3, A) +
060500                      FUNCTION ORD-MAX(1, 1).
060600     IF WS-INT = 4 THEN
060700                        PERFORM PASS
060800     ELSE
060900                        MOVE 4   TO CORRECT-N
061000                        MOVE WS-INT TO COMPUTED-N
061100                        PERFORM FAIL.
061200     GO TO F-ORD-MAX-WRITE-15.
061300 F-ORD-MAX-DELETE-15.
061400     PERFORM  DE-LETE.
061500     GO TO    F-ORD-MAX-WRITE-15.
061600 F-ORD-MAX-WRITE-15.
061700     MOVE "F-ORD-MAX-15" TO PAR-NAME.
061800     PERFORM  PRINT-DETAIL.
061900*****************SPECIAL TEST 1******************************
062000 F-ORD-MAX-16.
062100     MOVE 1 TO ARG1
062200     PERFORM F-ORD-MAX-TEST-16
062300         UNTIL FUNCTION ORD-MAX (5, ARG1) = 2.
062400*
062500**    when ARG1 = 6 , ORD-MAX(5,ARG1) = 2
062600*
062700     IF ARG1 = 6 THEN
062800                        PERFORM PASS
062900     ELSE
063000                        MOVE 6 TO CORRECT-N
063100                        MOVE WS-INT TO COMPUTED-N
063200                        PERFORM FAIL.
063300     GO TO F-ORD-MAX-WRITE-16.
063400*
063500 F-ORD-MAX-TEST-16.
063600     COMPUTE ARG1 = ARG1 + 1.
063700*
063800 F-ORD-MAX-DELETE-16.
063900     PERFORM  DE-LETE.
064000     GO TO    F-ORD-MAX-WRITE-16.
064100 F-ORD-MAX-WRITE-16.
064200     MOVE "F-ORD-MAX-16" TO PAR-NAME.
064300     PERFORM  PRINT-DETAIL.
064400*******************END OF TESTS**************************
064500 CCVS-EXIT SECTION.
064600 CCVS-999999.
064700     GO TO CLOSE-FILES.
