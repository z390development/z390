000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ125A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 3.0                                  *
000900*                             REVISED 1986, AUGUST             *
001000*                                                              *
001100*    CREATION DATE     /     VALIDATION DATE                   *
001200*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001300*                                                              *
001400****************************************************************
001500*                                                              *
001600*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001700*                                                              *
001800*            X-01   SEQUENTIAL MAGNETIC TAPE FILE.             *
001900*            X-55   SYSTEM PRINTER                             *
002000*            X-82   SOURCE-COMPUTER                            *
002100*            X-83   OBJECT-COMPUTER                            *
002200*            X-84   LABEL RECORDS OPTION                       *
002300*                                                              *
002400*                                                              *
002500****************************************************************
002600*                                                              *
002700*    SQ125A ATTEMPTS TO OPEN FOR OUTPUT A MAGNETIC TAPE FILE   *
002800*    WHICH IS ALREADY OPEN IN THE OUTPUT MODE.  THIS SHOULD    *
002900*    RESULT IN A RECOGNITION OF A LOGIC ERROR CONDITION AND AN *
003000*    I-O STATUS OF "41".  THE PROGRAM CONTAINS AN APPLICABLE   *
003100*    DECLARATIVE PROCEDURE, WHICH SHOULD BE IMPLEMENTED.       *
003200*                                                              *
003300****************************************************************
003400*
003500 ENVIRONMENT DIVISION.
003600 CONFIGURATION SECTION.
003700 SOURCE-COMPUTER.
003800     XXXXX082.
003900 OBJECT-COMPUTER.
004000     XXXXX083.
004100*
004200 INPUT-OUTPUT SECTION.
004300 FILE-CONTROL.
004400     SELECT PRINT-FILE ASSIGN TO
004500     XXXXX055.
004600*
004700     SELECT SQ-FS1 ASSIGN TO
004800     XXXXX001
004900            FILE STATUS IS SQ-FS1-STATUS.
005000*
005100*
005200 DATA DIVISION.
005300 FILE SECTION.
005400 FD  PRINT-FILE
005500C    LABEL RECORDS
005600C    XXXXX084
005700C    DATA RECORD IS PRINT-REC DUMMY-RECORD
005800               .
005900 01  PRINT-REC    PICTURE X(120).
006000 01  DUMMY-RECORD PICTURE X(120).
006100*
006200 FD  SQ-FS1
006300C    LABEL RECORD IS STANDARD
006400                .
006500 01  SQ-FS1R1-F-G-120 PIC X(120).
006600*
006700 WORKING-STORAGE SECTION.
006800*
006900***************************************************************
007000*                                                             *
007100*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
007200*                                                             *
007300***************************************************************
007400*
007500 01  SQ-FS1-STATUS.
007600   03  SQ-FS1-KEY-1   PIC X.
007700   03  SQ-FS1-KEY-2   PIC X.
007800*
007900***************************************************************
008000*                                                             *
008100*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
008200*                                                             *
008300***************************************************************
008400*
008500 01  REC-SKEL-SUB   PIC 99.
008600*
008700 01  FILE-RECORD-INFORMATION-REC.
008800     03 FILE-RECORD-INFO-SKELETON.
008900        05 FILLER                 PICTURE X(48)       VALUE
009000             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
009100        05 FILLER                 PICTURE X(46)       VALUE
009200             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
009300        05 FILLER                 PICTURE X(26)       VALUE
009400             ",LFIL=000000,ORG=  ,LBLR= ".
009500        05 FILLER                 PICTURE X(37)       VALUE
009600             ",RECKEY=                             ".
009700        05 FILLER                 PICTURE X(38)       VALUE
009800             ",ALTKEY1=                             ".
009900        05 FILLER                 PICTURE X(38)       VALUE
010000             ",ALTKEY2=                             ".
010100        05 FILLER                 PICTURE X(7)        VALUE SPACE.
010200     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
010300        05 FILE-RECORD-INFO-P1-120.
010400           07 FILLER              PIC X(5).
010500           07 XFILE-NAME          PIC X(6).
010600           07 FILLER              PIC X(8).
010700           07 XRECORD-NAME        PIC X(6).
010800           07 FILLER              PIC X(1).
010900           07 REELUNIT-NUMBER     PIC 9(1).
011000           07 FILLER              PIC X(7).
011100           07 XRECORD-NUMBER      PIC 9(6).
011200           07 FILLER              PIC X(6).
011300           07 UPDATE-NUMBER       PIC 9(2).
011400           07 FILLER              PIC X(5).
011500           07 ODO-NUMBER          PIC 9(4).
011600           07 FILLER              PIC X(5).
011700           07 XPROGRAM-NAME       PIC X(5).
011800           07 FILLER              PIC X(7).
011900           07 XRECORD-LENGTH      PIC 9(6).
012000           07 FILLER              PIC X(7).
012100           07 CHARS-OR-RECORDS    PIC X(2).
012200           07 FILLER              PIC X(1).
012300           07 XBLOCK-SIZE         PIC 9(4).
012400           07 FILLER              PIC X(6).
012500           07 RECORDS-IN-FILE     PIC 9(6).
012600           07 FILLER              PIC X(5).
012700           07 XFILE-ORGANIZATION  PIC X(2).
012800           07 FILLER              PIC X(6).
012900           07 XLABEL-TYPE         PIC X(1).
013000        05 FILE-RECORD-INFO-P121-240.
013100           07 FILLER              PIC X(8).
013200           07 XRECORD-KEY         PIC X(29).
013300           07 FILLER              PIC X(9).
013400           07 ALTERNATE-KEY1      PIC X(29).
013500           07 FILLER              PIC X(9).
013600           07 ALTERNATE-KEY2      PIC X(29).
013700           07 FILLER              PIC X(7).
013800*
013900 01  TEST-RESULTS.
014000     02 FILLER              PIC X      VALUE SPACE.
014100     02  PAR-NAME.
014200       03 FILLER              PIC X(14)  VALUE SPACE.
014300       03 PARDOT-X            PIC X      VALUE SPACE.
014400       03 DOTVALUE            PIC 99     VALUE ZERO.
014500     02 FILLER              PIC X      VALUE SPACE.
014600     02 FEATURE             PIC X(24)  VALUE SPACE.
014700     02 FILLER              PIC X      VALUE SPACE.
014800     02 P-OR-F              PIC X(5)   VALUE SPACE.
014900     02 FILLER              PIC X(9)   VALUE SPACE.
015000     02 RE-MARK             PIC X(61).
015100 01  TEST-COMPUTED.
015200   02 FILLER  PIC X(30)  VALUE SPACE.
015300   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
015400   02 COMPUTED-X.
015500     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
015600     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
015700     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
015800     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
015900     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
016000     03       CM-18V0 REDEFINES COMPUTED-A.
016100        04 COMPUTED-18V0                   PIC -9(18).
016200        04 FILLER                          PIC X.
016300     03 FILLER PIC X(50) VALUE SPACE.
016400 01  TEST-CORRECT.
016500     02 FILLER PIC X(30) VALUE SPACE.
016600     02 FILLER PIC X(17) VALUE "       CORRECT =".
016700     02 CORRECT-X.
016800     03 CORRECT-A                  PIC X(20) VALUE SPACE.
016900     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
017000     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
017100     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
017200     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
017300     03      CR-18V0 REDEFINES CORRECT-A.
017400         04 CORRECT-18V0                     PIC -9(18).
017500         04 FILLER                           PIC X.
017600     03 FILLER PIC X(2) VALUE SPACE.
017700     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
017800*
017900 01  CCVS-C-1.
018000     02 FILLER  PIC IS X        VALUE  SPACE.
018100     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
018200     02 FILLER  PIC IS X        VALUE  SPACE.
018300     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
018400     02 FILLER  PIC IS X        VALUE  SPACE.
018500     02 FILLER  PIC IS X(5)     VALUE "PASS ".
018600     02 FILLER  PIC IS X(9)     VALUE  SPACE.
018700     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
018800 01  CCVS-C-2.
018900     02 FILLER  PIC X(19)  VALUE  SPACE.
019000     02 FILLER  PIC X(6)   VALUE "TESTED".
019100     02 FILLER  PIC X(19)  VALUE  SPACE.
019200     02 FILLER  PIC X(4)   VALUE "FAIL".
019300     02 FILLER  PIC X(72)  VALUE  SPACE.
019400*
019500 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
019600 01  REC-CT            PIC 99       VALUE ZERO.
019700 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
019800 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
019900 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
020000 01  PASS-COUNTER      PIC 999      VALUE ZERO.
020100 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
020200 01  ERROR-HOLD        PIC 999      VALUE ZERO.
020300 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
020400 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
020500 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
020600 01  CCVS-H-1.
020700     02  FILLER          PIC X(39)    VALUE SPACES.
020800     02  FILLER          PIC X(42)    VALUE
020900     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
021000     02  FILLER          PIC X(39)    VALUE SPACES.
021100 01  CCVS-H-2A.
021200   02  FILLER            PIC X(40)  VALUE SPACE.
021300   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
021400   02  FILLER            PIC XXXX   VALUE
021500     "4.2 ".
021600   02  FILLER            PIC X(28)  VALUE
021700            " COPY - NOT FOR DISTRIBUTION".
021800   02  FILLER            PIC X(41)  VALUE SPACE.
021900*
022000 01  CCVS-H-2B.
022100   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
022200   02  TEST-ID           PIC X(9).
022300   02  FILLER            PIC X(4)   VALUE " IN ".
022400   02  FILLER            PIC X(12)  VALUE
022500     " HIGH       ".
022600   02  FILLER            PIC X(22)  VALUE
022700            " LEVEL VALIDATION FOR ".
022800   02  FILLER            PIC X(58)  VALUE
022900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
023000 01  CCVS-H-3.
023100     02  FILLER          PIC X(34)  VALUE
023200            " FOR OFFICIAL USE ONLY    ".
023300     02  FILLER          PIC X(58)  VALUE
023400     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
023500     02  FILLER          PIC X(28)  VALUE
023600            "  COPYRIGHT   1985,1986 ".
023700 01  CCVS-E-1.
023800     02 FILLER           PIC X(52)  VALUE SPACE.
023900     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
024000     02 ID-AGAIN         PIC X(9).
024100     02 FILLER           PIC X(45)  VALUE SPACES.
024200 01  CCVS-E-2.
024300     02  FILLER          PIC X(31)  VALUE SPACE.
024400     02  FILLER          PIC X(21)  VALUE SPACE.
024500     02  CCVS-E-2-2.
024600         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
024700         03 FILLER         PIC X      VALUE SPACE.
024800         03 ENDER-DESC     PIC X(44)  VALUE
024900            "ERRORS ENCOUNTERED".
025000 01  CCVS-E-3.
025100     02  FILLER          PIC X(22)  VALUE
025200            " FOR OFFICIAL USE ONLY".
025300     02  FILLER          PIC X(12)  VALUE SPACE.
025400     02  FILLER          PIC X(58)  VALUE
025500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025600     02  FILLER          PIC X(8)   VALUE SPACE.
025700     02  FILLER          PIC X(20)  VALUE
025800             " COPYRIGHT 1985,1986".
025900 01  CCVS-E-4.
026000     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
026100     02 FILLER           PIC X(4)   VALUE " OF ".
026200     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
026300     02 FILLER           PIC X(40)  VALUE
026400      "  TESTS WERE EXECUTED SUCCESSFULLY".
026500 01  XXINFO.
026600     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
026700     02 INFO-TEXT.
026800       04 FILLER             PIC X(8)   VALUE SPACE.
026900       04 XXCOMPUTED         PIC X(20).
027000       04 FILLER             PIC X(5)   VALUE SPACE.
027100       04 XXCORRECT          PIC X(20).
027200     02 INF-ANSI-REFERENCE PIC X(48).
027300 01  HYPHEN-LINE.
027400     02 FILLER  PIC IS X VALUE IS SPACE.
027500     02 FILLER  PIC IS X(65)    VALUE IS "************************
027600-    "*****************************************".
027700     02 FILLER  PIC IS X(54)    VALUE IS "************************
027800-    "******************************".
027900 01  CCVS-PGM-ID  PIC X(9)   VALUE
028000     "SQ125A".
028100*
028200*
028300 PROCEDURE DIVISION.
028400 DECLARATIVES.
028500 SQ125A-DECLARATIVE-001-SECT SECTION.
028600     USE AFTER STANDARD EXCEPTION PROCEDURE SQ-FS1.
028700 INPUT-ERROR-PROCEDURE.
028800     IF SQ-FS1-STATUS = "41"
028900             PERFORM DECL-PASS
029000             GO TO ABNORMAL-TERM-DECL
029100     ELSE
029200             MOVE "41" TO CORRECT-A
029300             MOVE SQ-FS1-STATUS TO COMPUTED-A
029400             MOVE "INCORRECT I-O STATUS FOR SECOND OPEN"
029500                     TO RE-MARK
029600             PERFORM DECL-FAIL
029700             GO TO ABNORMAL-TERM-DECL
029800     END-IF.
029900*
030000*
030100 DECL-PASS.
030200     MOVE   "PASS " TO P-OR-F.
030300     ADD     1 TO PASS-COUNTER.
030400     PERFORM DECL-PRINT-DETAIL.
030500*
030600 DECL-FAIL.
030700     MOVE   "FAIL*" TO P-OR-F.
030800     ADD     1 TO ERROR-COUNTER.
030900     PERFORM DECL-PRINT-DETAIL.
031000*
031100 DECL-PRINT-DETAIL.
031200     IF REC-CT NOT EQUAL TO ZERO
031300             MOVE "." TO PARDOT-X
031400             MOVE REC-CT TO DOTVALUE.
031500     MOVE    TEST-RESULTS TO PRINT-REC.
031600     PERFORM DECL-WRITE-LINE.
031700     IF P-OR-F EQUAL TO "FAIL*"
031800         PERFORM DECL-WRITE-LINE
031900         PERFORM DECL-FAIL-ROUTINE THRU DECL-FAIL-EX
032000     ELSE
032100         PERFORM DECL-BAIL THRU DECL-BAIL-EX.
032200     MOVE    SPACE TO P-OR-F.
032300     MOVE    SPACE TO COMPUTED-X.
032400     MOVE    SPACE TO CORRECT-X.
032500     IF REC-CT EQUAL TO ZERO
032600         MOVE    SPACE TO PAR-NAME.
032700     MOVE    SPACE TO RE-MARK.
032800*
032900 DECL-WRITE-LINE.
033000     ADD     1 TO RECORD-COUNT.
033100Y    IF RECORD-COUNT GREATER 50
033200Y        MOVE    DUMMY-RECORD TO DUMMY-HOLD
033300Y        MOVE    SPACE TO DUMMY-RECORD
033400Y        WRITE   DUMMY-RECORD AFTER ADVANCING PAGE
033500Y        MOVE    CCVS-C-1 TO DUMMY-RECORD PERFORM DECL-WRT-LN
033600Y        MOVE    CCVS-C-2 TO DUMMY-RECORD
033700Y        PERFORM DECL-WRT-LN 2 TIMES
033800Y        MOVE    HYPHEN-LINE TO DUMMY-RECORD
033900Y        PERFORM DECL-WRT-LN
034000Y        MOVE    DUMMY-HOLD TO DUMMY-RECORD
034100Y        MOVE    ZERO TO RECORD-COUNT.
034200     PERFORM DECL-WRT-LN.
034300*
034400 DECL-WRT-LN.
034500     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
034600     MOVE    SPACE TO DUMMY-RECORD.
034700*
034800 DECL-FAIL-ROUTINE.
034900     IF COMPUTED-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
035000     IF CORRECT-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
035100     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
035200     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
035300     MOVE    XXINFO TO DUMMY-RECORD.
035400     PERFORM DECL-WRITE-LINE 2 TIMES.
035500     MOVE    SPACES TO INF-ANSI-REFERENCE.
035600     GO TO   DECL-FAIL-EX.
035700 DECL-FAIL-WRITE.
035800     MOVE    TEST-COMPUTED TO PRINT-REC
035900     PERFORM DECL-WRITE-LINE
036000     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
036100     MOVE    TEST-CORRECT TO PRINT-REC
036200     PERFORM DECL-WRITE-LINE 2 TIMES.
036300     MOVE    SPACES TO COR-ANSI-REFERENCE.
036400 DECL-FAIL-EX.
036500     EXIT.
036600*
036700 DECL-BAIL.
036800     IF COMPUTED-A NOT EQUAL TO SPACE GO TO DECL-BAIL-WRITE.
036900     IF CORRECT-A EQUAL TO SPACE GO TO DECL-BAIL-EX.
037000 DECL-BAIL-WRITE.
037100     MOVE    CORRECT-A TO XXCORRECT.
037200     MOVE    COMPUTED-A TO XXCOMPUTED.
037300     MOVE    XXINFO TO DUMMY-RECORD.
037400     PERFORM DECL-WRITE-LINE 2 TIMES.
037500 DECL-BAIL-EX.
037600     EXIT.
037700*
037800 ABNORMAL-TERM-DECL.
037900     MOVE SPACE TO DUMMY-RECORD.
038000     PERFORM DECL-WRITE-LINE.
038100     MOVE "ABNORMAL TERMINATION AT THIS POINT IS ACCEPTABLE"
038200             TO DUMMY-RECORD.
038300     PERFORM DECL-WRITE-LINE 3 TIMES.
038400*
038500*
038600 END-DECLS.
038700 END DECLARATIVES.
038800*
038900*
039000 CCVS1 SECTION.
039100 OPEN-FILES.
039200     OPEN    OUTPUT PRINT-FILE.
039300     MOVE    CCVS-PGM-ID TO TEST-ID.
039400     MOVE    CCVS-PGM-ID TO ID-AGAIN.
039500     MOVE    SPACE TO TEST-RESULTS.
039600     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
039700     MOVE    ZERO TO REC-SKEL-SUB.
039800     PERFORM CCVS-INIT-FILE 10 TIMES.
039900     GO TO CCVS1-EXIT.
040000*
040100 CCVS-INIT-FILE.
040200     ADD     1 TO REC-SKL-SUB.
040300     MOVE    FILE-RECORD-INFO-SKELETON TO
040400                  FILE-RECORD-INFO (REC-SKL-SUB).
040500*
040600 CLOSE-FILES.
040700     PERFORM END-ROUTINE THRU END-ROUTINE-13.
040800     CLOSE   PRINT-FILE.
040900 TERMINATE-CCVS.
041000     STOP    RUN.
041100*
041200 INSPT.
041300     MOVE   "INSPT" TO P-OR-F.
041400     ADD     1 TO INSPECT-COUNTER.
041500     PERFORM PRINT-DETAIL.
041600
041700 PASS.
041800     MOVE   "PASS " TO P-OR-F.
041900     ADD     1 TO PASS-COUNTER.
042000     PERFORM PRINT-DETAIL.
042100*
042200 FAIL.
042300     MOVE   "FAIL*" TO P-OR-F.
042400     ADD     1 TO ERROR-COUNTER.
042500     PERFORM PRINT-DETAIL.
042600*
042700 DE-LETE.
042800     MOVE   "****TEST DELETED****" TO RE-MARK.
042900     MOVE   "*****" TO P-OR-F.
043000     ADD     1 TO DELETE-COUNTER.
043100     PERFORM PRINT-DETAIL.
043200*
043300 PRINT-DETAIL.
043400     IF REC-CT NOT EQUAL TO ZERO
043500         MOVE   "." TO PARDOT-X
043600         MOVE    REC-CT TO DOTVALUE.
043700     MOVE    TEST-RESULTS TO PRINT-REC.
043800     PERFORM WRITE-LINE.
043900     IF P-OR-F EQUAL TO "FAIL*"
044000         PERFORM WRITE-LINE
044100         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
044200     ELSE
044300         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
044400     MOVE    SPACE TO P-OR-F.
044500     MOVE    SPACE TO COMPUTED-X.
044600     MOVE    SPACE TO CORRECT-X.
044700     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
044800     MOVE    SPACE TO RE-MARK.
044900*
045000 HEAD-ROUTINE.
045100     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045200     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045300     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
045400     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
045500 COLUMN-NAMES-ROUTINE.
045600     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
045700     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
045900 END-ROUTINE.
046000     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
046100     PERFORM WRITE-LINE 5 TIMES.
046200 END-RTN-EXIT.
046300     MOVE    CCVS-E-1 TO DUMMY-RECORD.
046400     PERFORM WRITE-LINE 2 TIMES.
046500*
046600 END-ROUTINE-1.
046700     ADD     ERROR-COUNTER   TO ERROR-HOLD
046800     ADD     INSPECT-COUNTER TO ERROR-HOLD.
046900     ADD     DELETE-COUNTER  TO ERROR-HOLD.
047000     ADD     PASS-COUNTER    TO ERROR-HOLD.
047100     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
047200     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
047300     MOVE    CCVS-E-4        TO CCVS-E-2-2.
047400     MOVE    CCVS-E-2        TO DUMMY-RECORD
047500     PERFORM WRITE-LINE.
047600     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
047700     IF ERROR-COUNTER IS EQUAL TO ZERO
047800         MOVE   "NO " TO ERROR-TOTAL
047900     ELSE
048000         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
048100     MOVE    CCVS-E-2 TO DUMMY-RECORD.
048200     PERFORM WRITE-LINE.
048300 END-ROUTINE-13.
048400     IF DELETE-COUNTER IS EQUAL TO ZERO
048500         MOVE   "NO " TO ERROR-TOTAL
048600     ELSE
048700         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
048800     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
048900     MOVE    CCVS-E-2 TO DUMMY-RECORD.
049000     PERFORM WRITE-LINE.
049100     IF INSPECT-COUNTER EQUAL TO ZERO
049200         MOVE   "NO " TO ERROR-TOTAL
049300     ELSE
049400         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
049500     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
049600     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
049700     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
049800*
049900 WRITE-LINE.
050000     ADD     1 TO RECORD-COUNT.
050100Y    IF RECORD-COUNT GREATER 50
050200Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
050300Y        MOVE  SPACE TO DUMMY-RECORD
050400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
050500Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
050600Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
050700Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
050800Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
050900Y        MOVE  ZERO TO RECORD-COUNT.
051000     PERFORM WRT-LN.
051100*
051200 WRT-LN.
051300     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
051400     MOVE    SPACE TO DUMMY-RECORD.
051500 BLANK-LINE-PRINT.
051600     PERFORM WRT-LN.
051700 FAIL-ROUTINE.
051800     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
051900     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
052000     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
052100     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
052200     MOVE    XXINFO TO DUMMY-RECORD.
052300     PERFORM WRITE-LINE 2 TIMES.
052400     MOVE    SPACES TO INF-ANSI-REFERENCE.
052500     GO TO   FAIL-ROUTINE-EX.
052600 FAIL-ROUTINE-WRITE.
052700     MOVE    TEST-COMPUTED  TO PRINT-REC
052800     PERFORM WRITE-LINE
052900     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
053000     MOVE    TEST-CORRECT   TO PRINT-REC
053100     PERFORM WRITE-LINE 2 TIMES.
053200     MOVE    SPACES         TO COR-ANSI-REFERENCE.
053300 FAIL-ROUTINE-EX.
053400     EXIT.
053500 BAIL-OUT.
053600     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
053700     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
053800 BAIL-OUT-WRITE.
053900     MOVE    CORRECT-A      TO XXCORRECT.
054000     MOVE    COMPUTED-A     TO XXCOMPUTED.
054100     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
054200     MOVE    XXINFO TO DUMMY-RECORD.
054300     PERFORM WRITE-LINE 2 TIMES.
054400     MOVE    SPACES TO INF-ANSI-REFERENCE.
054500 BAIL-OUT-EX.
054600     EXIT.
054700 CCVS1-EXIT.
054800     EXIT.
054900*
055000****************************************************************
055100*                                                              *
055200*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
055300*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
055400*                                                              *
055500****************************************************************
055600*
055700 SECT-SQ125A-MAIN SECTION.
055800*
055900*    THE FIRST ACTION IS TO CREATE THE FILE BY MEANS OF AN
056000*    OPEN OUTPUT STATEMENT.
056100*
056200 SEQ-INIT-01.
056300*
056400     MOVE    1 TO REC-CT
056500     MOVE   "CREATE FILE, OPEN OUTPUT" TO FEATURE
056600     MOVE   "SEQ-TEST-OP-01" TO PAR-NAME
056700     MOVE   "**" TO SQ-FS1-STATUS.
056800 SEQ-TEST-OP-01.
056900     OPEN    OUTPUT SQ-FS1.
057000     MOVE   "SEQ-TEST-OP-01" TO PAR-NAME.
057100     MOVE    1 TO REC-CT.
057200 SEQ-TEST-OP-01-01.
057300*
057400*    CHECK THE I-O STATUS VALUE RETURNED BY THE FIRST OPEN.
057500*
057600     IF  SQ-FS1-STATUS = "00"
057700         PERFORM PASS
057800     ELSE
057900         MOVE    SQ-FS1-STATUS TO COMPUTED-A
058000         MOVE   "00" TO CORRECT-A
058100         MOVE   "UNEXPECTED I-O STATUS CODE FROM OPEN OUTPUT"
058200                    TO RE-MARK
058300         MOVE   "VII-3, 1.5.3(1)A" TO ANSI-REFERENCE
058400         PERFORM FAIL.
058500 SEQ-TEST-01-01-END.
058600*
058700*
058800*    HAVING OPENED THE FILE, THE NEXT ACTION IS TO ATTEMPT
058900*    TO OPEN IT FOR OUTPUT AGAIN.
059000*
059100 SEQ-INIT-02.
059200     MOVE    1 TO REC-CT
059300     MOVE   "OPEN OUTPUT ON OPEN FILE" TO FEATURE
059400     MOVE   "SEQ-TEST-OP-02" TO PAR-NAME
059500     MOVE   "**" TO SQ-FS1-STATUS.
059600 SEQ-TEST-OP-02.
059700     OPEN    OUTPUT SQ-FS1.
059800 CCVS-EXIT SECTION.
059900 CCVS-999999.
060000     GO TO   CLOSE-FILES.
