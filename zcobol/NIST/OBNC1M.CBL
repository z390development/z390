000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     OBNC1M.
000400
000500 AUTHOR.
000600     FEDERAL COMPILER TESTING CENTRE.
000700 INSTALLATION.
000800     GENERAL SERVICES ADMINISTRATION
000900     AUTOMATIC DATA AND TELECOMMUNICATION SERVICE
001000     SOFTWARE DEVELOPMENT OFFICE
001100     5203 LEESBURG PIKE. SUITE 1100
001200     FALLS CHURCH VIRGINIA 22041
001300
001400     PHONE   (703) 756-6153
001500 DATE-WRITTEN.
001600     CCVS-74 VERSION 4.0 - 1980 JULY 1.
001700     CREATION DATE     /    VALIDATION DATE
001800
001900 SECURITY.
002000     NONE
002100
002200
002300****************************************************************
002400*                                                              *
002500*    VALIDATION FOR:-                                          *
002600*                                                              *
002700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
002800*                                                              *
002900*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
003000*                                                              *
003100****************************************************************
003200*                                                              *
003300*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
003400*                                                              *
003500*        X-55  - SYSTEM PRINTER NAME.                          *
003600*        X-82  - SOURCE COMPUTER NAME.                         *
003700*        X-83  - OBJECT COMPUTER NAME.                         *
003800*                                                              *
003900****************************************************************
004000*
004100*     PROGRAM OBNC1M CONTAINS CCVS74 TESTS OF LEVEL 1 LANGUAGE
004200*      ELEMENTS DEFINED AS OBSOLETE IN THE 1985 STANDARDS.
004300*
004400*
004500****************************************************************
004600
004700
004800     A COMMENT ENTRY PARAGRAPH IS TO BE TREATED AS
004900     DOCUMENTATION. ANY ATTEMPT TO COMPILE ANYTHING CONTAINED
005000     HERE IS ILLEGAL. THE LINES WHICH FOLLOW CONSTITUTE A TEST
005100     OF THIS REQUIREMENT. ALL LINES BEGIN IN AREA B ---
005200
005300     ENVIRONMENT DIVISION.
005400     CONFIGURATION SECTION.
005500     SOURCE-COMPUTER.
005600     XXXXX082.
005700     OBJECT-COMPUTER.
005800     XXXXX083.
005900     INPUT-OUTPUT SECTION.
006000     FILE-CONTROL.
006100     SELECT PHONY-PRINT-FILE ASSIGN TO
006200     XXXXX055.
006300     DATA DIVISION.
006400     FILE SECTION.
006500     FD  PHONY-PRINT-FILE
006600         LABEL RECORDS OMITTED
006700         DATA RECORD IS PHONY-PRINT-REC.
006800     01 PHONY-PRINT-REC PICTURE X(120).
006900     WORKING-STORAGE SECTION.
007000     01  COM-MENT.
007100         02 FILLER      PICTURE X(56) VALUE
007200     " CONGRATULATIONS --- YOUR COMPILER HAS JUST SUCCESSFULLY".
007300         02 FILLER      PICTURE X(51) VALUE
007400     " COMPILED AND EXECUTED THE COBOL REMARKS PARAGRAPH.".
007500     PROCEDURE DIVISION.
007600     PHONY-OPEN.
007700         OPEN OUTPUT PHONY-PRINT-FILE.
007800     PHONY-WRITE.
007900         MOVE COM-MENT TO PHONY-PRINT-REC.
008000         WRITE PHONY-PRINT-REC.
008100     PHONY-CLOSE.
008200         CLOSE PHONY-PRINT-FILE.
008300         STOP RUN.
008400     IDENTIFICATION DIVISION.
008500
008600
008700 ENVIRONMENT DIVISION.
008800 CONFIGURATION SECTION.
008900 SOURCE-COMPUTER.
009000     XXXXX082.
009100 OBJECT-COMPUTER.
009200     XXXXX083
009300      MEMORY SIZE
009400     XXXXX067
009500     WORDS.
009600 INPUT-OUTPUT SECTION.
009700 FILE-CONTROL.
009800     SELECT PRINT-FILE ASSIGN TO
009900     XXXXX055.
010000 DATA DIVISION.
010100 FILE SECTION.
010200 FD  PRINT-FILE.
010300 01  PRINT-REC PICTURE X(132).
010400 01  DUMMY-RECORD PICTURE X(132).
010500 WORKING-STORAGE SECTION.
010600 01  CHARACTER-BREAKDOWN-R.
010700     02  FIRST-20R               PICTURE X(20).
010800     02  SECOND-20R              PICTURE X(20).
010900     02  THIRD-20R               PICTURE X(20).
011000     02  FOURTH-20R              PICTURE X(20).
011100 01  CHARACTER-BREAKDOWN-S.
011200     02  FIRST-20S               PICTURE X(20).
011300     02  SECOND-20S              PICTURE X(20).
011400     02  THIRD-20S               PICTURE X(20).
011500     02  FOURTH-20S              PICTURE X(20).
011600 01  X80-CHARACTER-FIELD.
011700     02  FILLER                  PICTURE X(80).
011800 01  ACCEPT-RESULTS.
011900     02  FILLER                  PICTURE X(80)  VALUE
012000     "A B C D E F G H I J K L M N O P Q R S T U V W X Y Z  0123456
012100-    "789                 ".
012200 01  ALTERLOOP                   PIC 9 VALUE ZERO.
012300 01  DISPLAY-DATA.
012400     02 DISPLAY-A.
012500       03 DISPLAY-03               PICTURE A     VALUE "A".
012600       03 DISPLAY-03A.
012700         04 DISPLAY-04             PICTURE A     VALUE "L".
012800         04 DISPLAY-04A.
012900           05 DISPLAY-05           PICTURE A     VALUE "P".
013000           05 DISPLAY-05A.
013100             06 DISPLAY-06         PICTURE A     VALUE "H".
013200             06 DISPLAY-06A.
013300               07 DISPLAY-07       PICTURE A     VALUE "A".
013400               07 DISPLAY-07A.
013500                 08 DISPLAY-08     PICTURE A     VALUE "B".
013600                 08 DISPLAY-08A.
013700                   09 DISPLAY-09   PICTURE A     VALUE "E".
013800                   09 DISPLAY-09A.
013900                     10 DISPLAY-10 PICTURE AAA   VALUE "TIC".
014000     02 DISPLAY-N       PICTURE 9(10)       VALUE 0123456789.
014100     02 DISPLAY-X       PICTURE X(10)       VALUE "A1B2C3D4E5".
014200     02 DISPLAY-B       PICTURE X(13).
014300     02 DISPLAY-C REDEFINES DISPLAY-B.
014400       03 DISPLAY-D     PICTURE X(8).
014500       03 DISPLAY-E     PICTURE X(5).
014600     02 DISPLAY-F.
014700       03 DISPLAY-G     PICTURE X(100)      VALUE "*001*002*003*00
014800-    "4*005*006*007*008*009*010*011*012*013*014*015*016*017*018*01
014900-    "9*020*021*022*023*024*025".
015000       03 DISPLAY-H     PICTURE X(100)      VALUE "*026*027*028*02
015100-    "9*030*031*032*033*034*035*036*037*038*039*040*041*042*043*04
015200-    "4*045*046*047*048*049*050".
015300     02 SEE-ABOVE       PICTURE X(9) VALUE "SEE ABOVE".
015400     02 SEE-BELOW       PICTURE X(9) VALUE "SEE BELOW".
015500     02 CORRECT-FOLLOWS PICTURE X(20) VALUE
015600                                      "CORRECT DATA FOLLOWS".
015700     02 END-CORRECT     PICTURE X(16) VALUE
015800                                      "END CORRECT DATA".
015900     02 DISPLAY-WRITER.
016000       03 DIS-PLAYER.
016100         04 FILLER      PICTURE X(6).
016200         04 QUOTE-SLOT  PICTURE X.
016300         04 FILLER      PICTURE X(112).
016400     02 DISPLAY-SWITCH  PICTURE 9 VALUE ZERO.
016500     02 ZERO-SPACE-QUOTE.
016600       03 FILLER        PICTURE X VALUE ZERO.
016700       03 FILLER        PICTURE X VALUE SPACE.
016800       03 FILLER        PICTURE X VALUE QUOTE.
016900 01  LONG-LITERAL.
017000     02 LONG20                          PICTURE IS X(20)
017100     VALUE IS "STANDARD COMPILERS M".
017200     02 LONG40                          PICTURE IS X(20)
017300     VALUE IS "UST ALLOW NON-NUMERI".
017400     02 LONG60                          PICTURE IS X(20)
017500     VALUE IS "C LITERALS OF AT LEA".
017600     02 LONG80                          PICTURE IS X(20)
017700     VALUE IS "ST 120 CHARACTERS AN".
017800     02 LONG100                         PICTURE IS X(20)
017900     VALUE IS "D NUMERIC LITERALS O".
018000     02 LONG120                         PICTURE IS X(20)
018100     VALUE IS "F AT LEAST 18 DIGITS".
018200 01  ACCEPT-DATA.
018300     02 ACCEPT-D1.
018400       03 ACCEPT-D1-A PICTURE X(20).
018500       03 ACCEPT-D1-B PICTURE X(7).
018600     02 ACCEPT-D2       PICTURE X(27)
018700                        VALUE "ABCDEFGHIJKLMNOPQRSTUVWXY Z".
018800     02 ACCEPT-D3  PICTURE 9(10) USAGE DISPLAY.
018900     02 ACCEPT-D4  PICTURE 9(10) USAGE DISPLAY VALUE 0123456789.
019000     02 ACCEPT-D5  PICTURE X(11).
019100     02  ACCEPT-D6 PICTURE X(11) VALUE "().+-*/l, =".
019200     02 ACCEPT-D7  PICTURE X.
019300     02 ACCEPT-D8 PICTURE X VALUE "9".
019400     02 ACCEPT-D9  PICTURE X.
019500     02 ACCEPT-D10 PICTURE X VALUE "0".
019600     02 ACCEPT-D11 PICTURE A(20).
019700     02 ACCEPT-D12 PICTURE A(20)
019800              VALUE " ABC            XYZ ".
019900     02 ACCEPT-D13 PICTURE 9(9).
020000     02 ACCEPT-D14 PICTURE 9(9) VALUE 012345678.
020100     02 ACCEPT-D15 PICTURE X.
020200     02 ACCEPT-D16 PICTURE X VALUE SPACE.
020300     02 ACCEPT-D17 PICTURE X.
020400     02 ACCEPT-D18 PICTURE X VALUE QUOTE.
020500     02 ACCEPT-D21.
020600         03 TAB-ACCEPT PICTURE XXXX OCCURS 3 TIMES.
020700     02 ACCEPT-D22 PICTURE X(12) VALUE "....ABCD....".
020800 01  TAB-VALUE                    PICTURE X(21)
020900                                  VALUE "ABCDEFGHIJKLMNOPQRSTU".
021000 01  NO-TAB-RECORD REDEFINES TAB-VALUE.
021100     02 X1    PICTURE X.
021200     02 X2    PICTURE X.
021300     02 X3    PICTURE X.
021400     02 X4    PICTURE X.
021500     02 X5    PICTURE X.
021600     02 X6    PICTURE X.
021700     02 X7    PICTURE X.
021800     02 X8    PICTURE X.
021900     02 X9    PICTURE X.
022000     02 X10   PICTURE X.
022100     02 X11   PICTURE X.
022200     02 X12   PICTURE X.
022300     02 X13   PICTURE X.
022400     02 X14   PICTURE X.
022500     02 X15   PICTURE X.
022600     02 X16   PICTURE X.
022700     02 X17   PICTURE X.
022800     02 X18   PICTURE X.
022900     02 X19   PICTURE X.
023000     02 X20   PICTURE X.
023100     02 X21   PICTURE X.
023200 01  TAB-RECORD REDEFINES TAB-VALUE.
023300     02 XTAB                       PICTURE X OCCURS 21 TIMES.
023400 01  DISPLAY-MIXTURE.
023500     02 I-DATA                    PICTURE X(17)
023600                                  VALUE " IDENTIFIER DATA ".
023700     02 TA-VALUE                  PICTURE X(20)
023800              VALUE "A B C D E 0102030405".
023900     02 TA-BLE REDEFINES TA-VALUE.
024000             04 PIECE-A           PICTURE XX OCCURS 5 TIMES.
024100             04 PIECE-N           PICTURE 99 OCCURS 5 TIMES.
024200     02 TRUE-PAIR.
024300         03 A1                    PICTURE X(21)
024400                                  VALUE " (TOTAL 21 OPERANDS) ".
024500         03 A2                    PICTURE X(11)
024600                                  VALUE "END OF DATA".
024700 01  TEST-RESULTS.
024800     02 FILLER                   PIC X      VALUE SPACE.
024900     02 FEATURE                  PIC X(20)  VALUE SPACE.
025000     02 FILLER                   PIC X      VALUE SPACE.
025100     02 P-OR-F                   PIC X(5)   VALUE SPACE.
025200     02 FILLER                   PIC X      VALUE SPACE.
025300     02  PAR-NAME.
025400       03 FILLER                 PIC X(19)  VALUE SPACE.
025500       03  PARDOT-X              PIC X      VALUE SPACE.
025600       03 DOTVALUE               PIC 99     VALUE ZERO.
025700     02 FILLER                   PIC X(8)   VALUE SPACE.
025800     02 RE-MARK                  PIC X(61).
025900 01  TEST-COMPUTED.
026000     02 FILLER                   PIC X(30)  VALUE SPACE.
026100     02 FILLER                   PIC X(17)  VALUE
026200            "       COMPUTED=".
026300     02 COMPUTED-X.
026400     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
026500     03 COMPUTED-N               REDEFINES COMPUTED-A
026600                                 PIC -9(9).9(9).
026700     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
026800     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
026900     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
027000     03       CM-18V0 REDEFINES COMPUTED-A.
027100         04 COMPUTED-18V0                    PIC -9(18).
027200         04 FILLER                           PIC X.
027300     03 FILLER PIC X(50) VALUE SPACE.
027400 01  TEST-CORRECT.
027500     02 FILLER PIC X(30) VALUE SPACE.
027600     02 FILLER PIC X(17) VALUE "       CORRECT =".
027700     02 CORRECT-X.
027800     03 CORRECT-A                  PIC X(20) VALUE SPACE.
027900     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
028000     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
028100     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
028200     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
028300     03      CR-18V0 REDEFINES CORRECT-A.
028400         04 CORRECT-18V0                     PIC -9(18).
028500         04 FILLER                           PIC X.
028600     03 FILLER PIC X(2) VALUE SPACE.
028700     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
028800 01  CCVS-C-1.
028900     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
029000-    "SS  PARAGRAPH-NAME
029100-    "       REMARKS".
029200     02 FILLER                     PIC X(20)    VALUE SPACE.
029300 01  CCVS-C-2.
029400     02 FILLER                     PIC X        VALUE SPACE.
029500     02 FILLER                     PIC X(6)     VALUE "TESTED".
029600     02 FILLER                     PIC X(15)    VALUE SPACE.
029700     02 FILLER                     PIC X(4)     VALUE "FAIL".
029800     02 FILLER                     PIC X(94)    VALUE SPACE.
029900 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
030000 01  REC-CT                        PIC 99       VALUE ZERO.
030100 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
030200 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
030300 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
030400 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
030500 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
030600 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
030700 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
030800 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
030900 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
031000 01  CCVS-H-1.
031100     02  FILLER                    PIC X(39)    VALUE SPACES.
031200     02  FILLER                    PIC X(42)    VALUE
031300     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
031400     02  FILLER                    PIC X(39)    VALUE SPACES.
031500 01  CCVS-H-2A.
031600   02  FILLER                        PIC X(40)  VALUE SPACE.
031700   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
031800   02  FILLER                        PIC XXXX   VALUE
031900     "4.2 ".
032000   02  FILLER                        PIC X(28)  VALUE
032100            " COPY - NOT FOR DISTRIBUTION".
032200   02  FILLER                        PIC X(41)  VALUE SPACE.
032300
032400 01  CCVS-H-2B.
032500   02  FILLER                        PIC X(15)  VALUE
032600            "TEST RESULT OF ".
032700   02  TEST-ID                       PIC X(9).
032800   02  FILLER                        PIC X(4)   VALUE
032900            " IN ".
033000   02  FILLER                        PIC X(12)  VALUE
033100     " HIGH       ".
033200   02  FILLER                        PIC X(22)  VALUE
033300            " LEVEL VALIDATION FOR ".
033400   02  FILLER                        PIC X(58)  VALUE
033500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
033600 01  CCVS-H-3.
033700     02  FILLER                      PIC X(34)  VALUE
033800            " FOR OFFICIAL USE ONLY    ".
033900     02  FILLER                      PIC X(58)  VALUE
034000     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
034100     02  FILLER                      PIC X(28)  VALUE
034200            "  COPYRIGHT   1985 ".
034300 01  CCVS-E-1.
034400     02 FILLER                       PIC X(52)  VALUE SPACE.
034500     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
034600     02 ID-AGAIN                     PIC X(9).
034700     02 FILLER                       PIC X(45)  VALUE SPACES.
034800 01  CCVS-E-2.
034900     02  FILLER                      PIC X(31)  VALUE SPACE.
035000     02  FILLER                      PIC X(21)  VALUE SPACE.
035100     02 CCVS-E-2-2.
035200         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
035300         03 FILLER                   PIC X      VALUE SPACE.
035400         03 ENDER-DESC               PIC X(44)  VALUE
035500            "ERRORS ENCOUNTERED".
035600 01  CCVS-E-3.
035700     02  FILLER                      PIC X(22)  VALUE
035800            " FOR OFFICIAL USE ONLY".
035900     02  FILLER                      PIC X(12)  VALUE SPACE.
036000     02  FILLER                      PIC X(58)  VALUE
036100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
036200     02  FILLER                      PIC X(13)  VALUE SPACE.
036300     02 FILLER                       PIC X(15)  VALUE
036400             " COPYRIGHT 1985".
036500 01  CCVS-E-4.
036600     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
036700     02 FILLER                       PIC X(4)   VALUE " OF ".
036800     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
036900     02 FILLER                       PIC X(40)  VALUE
037000      "  TESTS WERE EXECUTED SUCCESSFULLY".
037100 01  XXINFO.
037200     02 FILLER                       PIC X(19)  VALUE
037300            "*** INFORMATION ***".
037400     02 INFO-TEXT.
037500       04 FILLER                     PIC X(8)   VALUE SPACE.
037600       04 XXCOMPUTED                 PIC X(20).
037700       04 FILLER                     PIC X(5)   VALUE SPACE.
037800       04 XXCORRECT                  PIC X(20).
037900     02 INF-ANSI-REFERENCE           PIC X(48).
038000 01  HYPHEN-LINE.
038100     02 FILLER  PIC IS X VALUE IS SPACE.
038200     02 FILLER  PIC IS X(65)    VALUE IS "************************
038300-    "*****************************************".
038400     02 FILLER  PIC IS X(54)    VALUE IS "************************
038500-    "******************************".
038600 01  CCVS-PGM-ID                     PIC X(9)   VALUE
038700     "OBNC1M".
038800 PROCEDURE DIVISION.
038900 CCVS1 SECTION.
039000 OPEN-FILES.
039100     OPEN     OUTPUT PRINT-FILE.
039200     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
039300     MOVE    SPACE TO TEST-RESULTS.
039400     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
039500     GO TO CCVS1-EXIT.
039600 CLOSE-FILES.
039700     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
039800 TERMINATE-CCVS.
039900S    EXIT PROGRAM.
040000STERMINATE-CALL.
040100     STOP     RUN.
040200 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
040300 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
040400 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
040500 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
040600     MOVE "****TEST DELETED****" TO RE-MARK.
040700 PRINT-DETAIL.
040800     IF REC-CT NOT EQUAL TO ZERO
040900             MOVE "." TO PARDOT-X
041000             MOVE REC-CT TO DOTVALUE.
041100     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
041200     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
041300        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
041400          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
041500     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
041600     MOVE SPACE TO CORRECT-X.
041700     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
041800     MOVE     SPACE TO RE-MARK.
041900 HEAD-ROUTINE.
042000     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042100     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042200     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
042300     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
042400 COLUMN-NAMES-ROUTINE.
042500     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
042600     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
042800 END-ROUTINE.
042900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
043000 END-RTN-EXIT.
043100     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043200 END-ROUTINE-1.
043300      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
043400      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
043500      ADD PASS-COUNTER TO ERROR-HOLD.
043600*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
043700      MOVE PASS-COUNTER TO CCVS-E-4-1.
043800      MOVE ERROR-HOLD TO CCVS-E-4-2.
043900      MOVE CCVS-E-4 TO CCVS-E-2-2.
044000      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
044100  END-ROUTINE-12.
044200      MOVE "TEST(S) FAILED" TO ENDER-DESC.
044300     IF       ERROR-COUNTER IS EQUAL TO ZERO
044400         MOVE "NO " TO ERROR-TOTAL
044500         ELSE
044600         MOVE ERROR-COUNTER TO ERROR-TOTAL.
044700     MOVE     CCVS-E-2 TO DUMMY-RECORD.
044800     PERFORM WRITE-LINE.
044900 END-ROUTINE-13.
045000     IF DELETE-COUNTER IS EQUAL TO ZERO
045100         MOVE "NO " TO ERROR-TOTAL  ELSE
045200         MOVE DELETE-COUNTER TO ERROR-TOTAL.
045300     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
045400     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
045500      IF   INSPECT-COUNTER EQUAL TO ZERO
045600          MOVE "NO " TO ERROR-TOTAL
045700      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
045800      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
045900      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
046000     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
046100 WRITE-LINE.
046200     ADD 1 TO RECORD-COUNT.
046300Y    IF RECORD-COUNT GREATER 42
046400Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
046500Y        MOVE SPACE TO DUMMY-RECORD
046600Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
046700Y        MOVE CCVS-H-1  TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
046800Y        MOVE CCVS-H-2A TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
046900Y        MOVE CCVS-H-2B TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
047000Y        MOVE CCVS-H-3  TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
047100Y        MOVE CCVS-C-1  TO DUMMY-RECORD  PERFORM WRT-LN
047200Y        MOVE CCVS-C-2  TO DUMMY-RECORD  PERFORM WRT-LN
047300Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
047400Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
047500Y        MOVE ZERO TO RECORD-COUNT.
047600     PERFORM WRT-LN.
047700 WRT-LN.
047800     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
047900     MOVE SPACE TO DUMMY-RECORD.
048000 BLANK-LINE-PRINT.
048100     PERFORM WRT-LN.
048200 FAIL-ROUTINE.
048300     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
048400     IF   CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
048500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
048600     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
048700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
048800     MOVE   SPACES TO INF-ANSI-REFERENCE.
048900     GO TO  FAIL-ROUTINE-EX.
049000 FAIL-ROUTINE-WRITE.
049100     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
049200     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
049300     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
049400     MOVE   SPACES TO COR-ANSI-REFERENCE.
049500 FAIL-ROUTINE-EX. EXIT.
049600 BAIL-OUT.
049700     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
049800     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
049900 BAIL-OUT-WRITE.
050000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
050100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
050200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
050300     MOVE   SPACES TO INF-ANSI-REFERENCE.
050400 BAIL-OUT-EX. EXIT.
050500 CCVS1-EXIT.
050600     EXIT.
050700 SECT-NC107A-001 SECTION.
050800 REMARKS-TEST.
050900     MOVE   "IV-11 7.2.4" TO ANSI-REFERENCE.
051000     MOVE   "COBOL REMARKS PARA" TO FEATURE.
051100     MOVE   "REMARKS" TO PAR-NAME.
051200     MOVE   "PHONY LINES SHOULDNT EXECUT" TO RE-MARK.
051300     PERFORM PRINT-DETAIL.
051400*    THE FOLLOWING HAS BEEN MOVED FROM THE END TO ENSURE
051500*    EXECUTION
051600 NOTE-TEST-6.
051700*    PERFORM  FAIL.
051800*        NOTE ENTER                         GO TO NOTE-WRITE-6
051900*             USE                           GO TO NOTE-WRITE-6
052000*             DECLARATIVES                  GO TO NOTE-WRITE-6
052100*             DATA DIVISION                 GO TO NOTE-WRITE-6
052200*             COPY (SEE ALSO PROGRAM LB104) GO TO NOTE-WRITE-6
052300*             THE COMPILER SHOULD "IGNORE" THE ABOVE WORDS.
052400*    PERFORM PASS.
052500     GO TO   NOTE-WRITE-6.
052600 NOTE-DELETE-6.
052700     PERFORM DE-LETE.
052800 NOTE-WRITE-6.
052900     MOVE   "NOTE RESERVED WORDS" TO FEATURE.
053000     MOVE   "NOTE-TEST-6" TO PAR-NAME.
053100     PERFORM PRINT-DETAIL.
053200 NUM-INIT-1.
053300     MOVE   "NUMERIC PARA-NAMES" TO FEATURE.
053400     MOVE   "VI-75 6.7.2" TO ANSI-REFERENCE.
053500     PERFORM  PRINT-DETAIL.
053600 NUM-TEST-1.
053700     ALTER    02 TO PROCEED TO 77.
053800     GO       TO 02.
053900 NUM-DELETE-1.
054000     PERFORM  DE-LETE.
054100     GO       TO NUM-WRITE-1.
054200 02.
054300     GO       TO 50.
054400 50. PERFORM  FAIL.
054500     GO       TO NUM-WRITE-1.
054600 77.
054700     PERFORM  PASS.
054800 NUM-WRITE-1.
054900     MOVE     "NUM-TEST-1" TO PAR-NAME.
055000     PERFORM  PRINT-DETAIL.
055100 ALTER-INIT.
055200     MOVE   "ALTER" TO FEATURE.
055300     MOVE   "VI-75 6.7.2" TO ANSI-REFERENCE.
055400 ALTER-TEST-1.
055500     ALTER   ALTER-A TO PROCEED TO ALTER-C.
055600     GO TO   ALTER-A.
055700 ALTER-DELETE-1.
055800     PERFORM DE-LETE.
055900     GO TO   ALTER-WRITE-1.
056000 ALTER-A.
056100     GO TO   ALTER-B.
056200 ALTER-B.
056300     PERFORM FAIL.
056400     GO TO   ALTER-WRITE-1.
056500 ALTER-C.
056600     PERFORM PASS.
056700 ALTER-WRITE-1.
056800     MOVE   "ALTER-TEST-1" TO PAR-NAME.
056900     PERFORM PRINT-DETAIL.
057000 ALTER-TEST-2.
057100     ALTER   ALTER-D TO ALTER-F.
057200*    NOTE THE WORDS "PROCEED TO" ARE OPTIONAL.
057300     GO TO   ALTER-D.
057400 ALTER-DELETE-2.
057500     PERFORM DE-LETE.
057600     GO TO   ALTER-WRITE-2.
057700 ALTER-D.
057800     GO TO   ALTER-E.
057900 ALTER-E.
058000     PERFORM FAIL.
058100     GO TO   ALTER-WRITE-2.
058200 ALTER-F.
058300     PERFORM PASS.
058400 ALTER-WRITE-2.
058500     MOVE   "ALTER-TEST-2" TO PAR-NAME.
058600     PERFORM PRINT-DETAIL.
058700 ALTER-TEST-3.
058800     ALTER   ALTER-G TO PROCEED TO ALTER-I.
058900*    NOTE COMPOUND ALTERS, MULTIPLE ALTERS OF THE SAME SEQUENCE.
059000     GO TO   ALTER-G.
059100 ALTER-DELETE-3.
059200     PERFORM DE-LETE.
059300     GO TO   ALTER-WRITE-3.
059400 ALTER-G.
059500     GO TO   ALTER-H.
059600 ALTER-H.
059700     PERFORM FAIL.
059800     GO TO   ALTER-WRITE-3.
059900 ALTER-I.
060000     ADD     1 TO ALTERLOOP.
060100     IF      ALTERLOOP GREATER THAN 1
060200              PERFORM FAIL
060300             GO TO ALTER-WRITE-3.
060400     ALTER   ALTER-G TO PROCEED TO ALTER-J.
060500     GO TO   ALTER-G.
060600 ALTER-J.
060700     PERFORM PASS.
060800 ALTER-WRITE-3.
060900     MOVE   "ALTER-TEST-3" TO PAR-NAME.
061000     PERFORM PRINT-DETAIL.
061100*
061200 GO--TEST-1.
061300     ALTER GO--A TO PROCEED TO GO--C.
061400*    NOTE THE GO STATEMENT IN GO--A IS NOT LEGAL UNLESS IT IS
061500*        ALTERED AS SHOWN ABOVE BEFORE CONTROL PASSES TO IT.
061600     GO TO GO--A.
061700 GO--DELETE-1.
061800     PERFORM DE-LETE.
061900     GO TO GO--WRITE-1.
062000 GO--A.
062100     GO TO.
062200 GO--B.
062300     PERFORM FAIL.
062400     GO TO GO--WRITE-1.
062500 GO--C.
062600     PERFORM PASS.
062700 GO--WRITE-1.
062800     PERFORM END-ROUTINE.
062900     MOVE "UNFINISHED GO TO" TO FEATURE.
063000     MOVE "GO--TEST-1" TO PAR-NAME.
063100     PERFORM PRINT-DETAIL.
063200 COMMENT-ENTRIES-INIT.
063300     MOVE "VI-6 3.2.1.1" TO ANSI-REFERENCE.
063400 COMMENT-ENTRIES-TEST.
063500     MOVE "PLEASE VISUALLY VERIFY THE FOLLOWING PARAGRAPHS: "
063600        TO RE-MARK.
063700     PERFORM PRINT-DETAIL.
063800     MOVE "  AUTHOR, INSTALLATION, DATE-WRITTEN, SECURITY"
063900        TO RE-MARK.
064000     PERFORM PRINT-DETAIL.
064100 SECT-NC180M-001 SECTION.
064200 STOP-INIT-GF-1.
064300     MOVE     "STOP LITERAL" TO FEATURE.
064400     MOVE  "VI-88 6.14.3 SR3, 6.14.4 GR2" TO ANSI-REFERENCE.
064500 STOP-TEST-GF-1.
064600     STOP "OPERATOR PLEASE EXECUTE RUN CONTINUATION".
064700     PERFORM  PASS.
064800     GO TO    STOP-WRITE-GF-1.
064900 STOP-DELETE-GF-1.
065000     PERFORM  DE-LETE.
065100 STOP-WRITE-GF-1.
065200     MOVE "STOP-TEST-GF-1" TO PAR-NAME.
065300     PERFORM  PRINT-DETAIL.
065400*STOP-NOTE.
065500*        NOTE THE ABOVE TEST TESTS THE BASIC FUNCTIONING OF THE
065600*             STOP VERB WITH LITERAL - A MESSAGE TO THE OPERATOR
065700*             AND RESTART ABILITY. THE FOLLOWING TESTS ASCERTAIN
065800*             THAT THE "LITERAL" MAY BE ANY LEGAL COBOL LITERAL.
065900*             THE USER MUST VISUALLY CHECK THE MESSAGES TO THE
066000*             OPERATOR AND SEE THAT THEY ARE IDENTICAL TO THE
066100*             DATA SHOWN IN THE OUTPUT LISTING.
066200 STOP-INIT-GF-2.
066300     MOVE     "SEE STOP-NOTE PARAGRAPH" TO RE-MARK.
066400     PERFORM  PRINT-DETAIL.
066500 STOP-TEST-GF-2.
066600     STOP     "A".
066700     MOVE     "SEE OPERATOR MESSAGE" TO COMPUTED-A.
066800     MOVE     "SEE BELOW" TO CORRECT-A.
066900     GO       TO STOP-WRITE-GF-2.
067000 STOP-DELETE-GF-2.
067100     PERFORM  DE-LETE.
067200 STOP-WRITE-GF-2.
067300     MOVE     "STOP-TEST-GF-2 " TO PAR-NAME.
067400     PERFORM  PRINT-DETAIL.
067500     MOVE     " A" TO PRINT-REC.
067600     WRITE    PRINT-REC.
067700     MOVE    SPACE TO TEST-RESULTS.
067800 STOP-TEST-GF-3.
067900     STOP     "*".
068000     MOVE     "SEE OPERATOR MESSAGE" TO COMPUTED-A.
068100     MOVE     "SEE BELOW" TO CORRECT-A.
068200     GO       TO STOP-WRITE-GF-3.
068300 STOP-DELETE-GF-3.
068400     PERFORM  DE-LETE.
068500 STOP-WRITE-GF-3.
068600     MOVE     "STOP-TEST-GF-3 " TO PAR-NAME.
068700     PERFORM  PRINT-DETAIL.
068800     MOVE     " *" TO PRINT-REC.
068900     WRITE    PRINT-REC.
069000 STOP-TEST-GF-4.
069100     STOP     QUOTE.
069200     MOVE     "SEE OPERATOR MESSAGE" TO COMPUTED-A.
069300     MOVE     "SEE BELOW" TO CORRECT-A.
069400     GO       TO STOP-WRITE-GF-4.
069500 STOP-DELETE-GF-4.
069600     PERFORM  DE-LETE.
069700 STOP-WRITE-GF-4.
069800     MOVE     "STOP-TEST-GF-4 " TO PAR-NAME.
069900     PERFORM PRINT-DETAIL.
070000     MOVE   " (A SINGLE QUOTE)" TO PRINT-REC.
070100     WRITE   PRINT-REC.
070200 STOP-TEST-GF-5.
070300     MOVE   "IV-9 4.3.3.3.1" TO ANSI-REFERENCE.
070400     STOP     " *  5 * 10 * 15 * 20 * 25 * 30 * 35 * 40 * 45 * 50
070500-    "* 55 * 60 * 65 * 70 * 75 * 80 * 85 * 90 * 95 *100 *105 *110
070600-    "*115 *120 *125 *130 *135 *140 *145 *150 *155 *160".
070700     MOVE     "SEE OPERATOR MESSAGE" TO COMPUTED-A.
070800     MOVE     "SEE BELOW" TO CORRECT-A.
070900     GO       TO STOP-WRITE-GF-5.
071000 STOP-DELETE-GF-5.
071100     PERFORM  DE-LETE.
071200 STOP-WRITE-GF-5.
071300     MOVE     "STOP-TEST-GF-5 " TO PAR-NAME.
071400     PERFORM  PRINT-DETAIL.
071500     MOVE     " *  5 * 10 * 15 * 20 * 25 * 30 * 35 * 40 * 45 * 50
071600-    "* 55 * 60 * 65 * 70 * 75 * 80 * 85 * 90 * 95 *100 *105 *110
071700-    "*115 *120 *125 *130 *135 *140 *145 *150 *155 *160"
071800           TO PRINT-REC.
071900     WRITE    PRINT-REC.
072000 STOP-TEST-GF-6.
072100     MOVE   "VI-129 6.23.4" TO ANSI-REFERENCE.
072200     STOP     7.
072300     MOVE     "SEE OPERATOR MESSAGE" TO COMPUTED-A.
072400     MOVE     "SEE BELOW" TO CORRECT-A.
072500     GO       TO STOP-WRITE-GF-6.
072600 STOP-DELETE-GF-6.
072700     PERFORM  DE-LETE.
072800 STOP-WRITE-GF-6.
072900     MOVE     "STOP-TEST-GF-6 " TO PAR-NAME.
073000     PERFORM  PRINT-DETAIL.
073100     MOVE     " 7" TO PRINT-REC.
073200     WRITE    PRINT-REC.
073300 STOP-TEST-GF-7.
073400     STOP     123456789987654321.
073500     MOVE     "SEE OPERATOR MESSAGE" TO COMPUTED-A.
073600     MOVE     "SEE BELOW" TO CORRECT-A.
073700     GO       TO STOP-WRITE-GF-7.
073800 STOP-DELETE-GF-7.
073900     PERFORM  DE-LETE.
074000 STOP-WRITE-GF-7.
074100     MOVE     "STOP-TEST-GF-7 " TO PAR-NAME.
074200     PERFORM  PRINT-DETAIL.
074300     MOVE     " 123456789987654321" TO PRINT-REC.
074400     WRITE    PRINT-REC.
074500 STOP-TEST-GF-8.
074600     STOP     ZERO.
074700     MOVE     "SEE OPERATOR MESSAGE" TO COMPUTED-A.
074800     MOVE     "SEE BELOW" TO CORRECT-A.
074900     GO       TO STOP-WRITE-GF-8.
075000 STOP-DELETE-GF-8.
075100     PERFORM  DE-LETE.
075200 STOP-WRITE-GF-8.
075300     MOVE "STOP-TEST-GF-8" TO PAR-NAME.
075400     PERFORM  PRINT-DETAIL.
075500     MOVE     " 0" TO PRINT-REC.
075600     WRITE    PRINT-REC.
075700 STOP-TEST-GF-9.
075800     MOVE SPACE TO DUMMY-RECORD.
075900     PERFORM  BLANK-LINE-PRINT 4 TIMES.
076000     MOVE     " STOP-TEST-GF-9 PASSES UNLESS A SECOND REPORT FOR
076100-    "OBNC1 IS GENERATED AFTER THIS ONE." TO TEST-RESULTS.
076200     PERFORM  PRINT-DETAIL.
076300     MOVE    SPACE TO TEST-RESULTS.
076400     PERFORM    END-ROUTINE THRU END-ROUTINE-13.
076500     CLOSE    PRINT-FILE.
076600     STOP     "OPERATOR KILL OBNC1".
076700     MOVE ZEROES TO ERROR-HOLD.
076800     OPEN     OUTPUT PRINT-FILE.
076900     PERFORM  HEAD-ROUTINE THROUGH COLUMN-NAMES-ROUTINE.
077000     PERFORM  FAIL.
077100     MOVE     "EXECUTION DID NOT HALT" TO RE-MARK.
077200     GO       TO STOP-WRITE-GF-9.
077300 STOP-DELETE-GF-9.
077400     PERFORM  DE-LETE.
077500 STOP-WRITE-GF-9.
077600     MOVE     "STOP LITERAL" TO FEATURE.
077700     MOVE     "STOP-GF-9-TEST" TO PAR-NAME.
077800     PERFORM  PRINT-DETAIL.
077900
078000 CCVS-EXIT SECTION.
078100 CCVS-999999.
078200     GO TO CLOSE-FILES.
