000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IX112A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*
001400*    1.  THE  ROUTINE  CREATES  THE  MASS  STORAGE  FILE  IX-VS2
001500*        CONTAINING  50  RECORDS. EACH BLOCK CONTAINS 2 RECORDS,
001600*        EACH  RECORD  CONTAINS  240 CHARACTERS, ORGANIZATION IS
001700*        INDEXED,  ACCESS  IS SEQUENTIAL. THEN THE FILE IS OPENED
001800*        AS I-O AND IT IS ATTEMTED TO REWRITE A RECORD WITH A
001900*        WRONG RECORD LENGTH.
002000*
002100*    2. THE ROUTINE READS THE CREATED FILE, VERIFIES IT AND
002200*       CHECKS THE FILE STATUS CODE:
002300*           44  -  AFTER REWRITE   (WITH WRONG RECORD LENGTH)
002400*
002500*    3. X-CARDS USED IN THIS PROGRAM:
002600*
002700*                 XXXXX024
002800*                 XXXXX055.
002900*                 XXXXX062.
003000*                 XXXXX082.
003100*                 XXXXX083.
003200*                 XXXXX084
003300*
003400*
003500 ENVIRONMENT DIVISION.
003600 CONFIGURATION SECTION.
003700 SOURCE-COMPUTER.
003800     XXXXX082.
003900 OBJECT-COMPUTER.
004000     XXXXX083.
004100 INPUT-OUTPUT SECTION.
004200 FILE-CONTROL.
004300P    SELECT RAW-DATA   ASSIGN TO
004400P    XXXXX062
004500P           ORGANIZATION IS INDEXED
004600P           ACCESS MODE IS RANDOM
004700P           RECORD KEY IS RAW-DATA-KEY.
004800*
004900     SELECT PRINT-FILE ASSIGN TO
005000     XXXXX055.
005100*
005200     SELECT IX-VS2 ASSIGN
005300     XXXXX024
005400     ORGANIZATION IS INDEXED
005500     ACCESS MODE IS SEQUENTIAL
005600     RECORD KEY IS IX-VS2-KEY
005700     FILE STATUS IS IX-VS2-STATUS.
005800
005900 DATA DIVISION.
006000
006100 FILE SECTION.
006200P
006300PFD  RAW-DATA.
006400P
006500P01  RAW-DATA-SATZ.
006600P    05  RAW-DATA-KEY        PIC X(6).
006700P    05  C-DATE              PIC 9(6).
006800P    05  C-TIME              PIC 9(8).
006900P    05  C-NO-OF-TESTS       PIC 99.
007000P    05  C-OK                PIC 999.
007100P    05  C-ALL               PIC 999.
007200P    05  C-FAIL              PIC 999.
007300P    05  C-DELETED           PIC 999.
007400P    05  C-INSPECT           PIC 999.
007500P    05  C-NOTE              PIC X(13).
007600P    05  C-INDENT            PIC X.
007700P    05  C-ABORT             PIC X(8).
007800
007900 FD  PRINT-FILE.
008000
008100 01  PRINT-REC               PIC X(120).
008200
008300 01  DUMMY-RECORD            PIC X(120).
008400
008500 FD  IX-VS2
008600C       DATA RECORDS IX-VS2R1-F-G-240 IX-VS2R1-F-G-200
008700C                                     IX-VS2R1-F-G-280
008800C       LABEL RECORD STANDARD
008900        RECORD 200 TO 280
009000        BLOCK CONTAINS 2 RECORDS.
009100
009200 01  IX-VS2R1-F-G-240.
009300     05  IX-VS2-REC-120      PIC X(120).
009400     05  IX-VS2-REC-120-240.
009500         10  FILLER          PIC X(8).
009600         10  IX-VS2-KEY      PIC X(29).
009700         10  FILLER          PIC X(9).
009800         10  IX-VS2-ALTER-KEY  PIC X(29).
009900         10  FILLER            PIC X(45).
010000
010100 01  IX-VS2R1-F-G-200.
010200     05  IX-VS2-REC-SHORT    PIC X(120).
010300     05  IX-VS2-REC-120-200  PIC X(80).
010400
010500 01  IX-VS2R1-F-G-280.
010600     05  IX-VS2-REC-LONG     PIC X(120).
010700     05  IX-VS2-REC-120-239  PIC X(120).
010800     05  IX-VS2-REC-240-280  PIC X(40).
010900
011000 WORKING-STORAGE SECTION.
011100
011200 01  GRP-0101.
011300     05  FILLER              PIC X(10) VALUE "RECORD-KEY".
011400     05  GRP-0101-KEY        PIC 9(9)  VALUE ZERO.
011500     05  FILLER              PIC X(10) VALUE "END-OF-KEY".
011600
011700 01  GRP-0102.
011800     05  FILLER              PIC X(10) VALUE "ALTERN-KEY".
011900     05  GRP-0102-KEY        PIC 9(9)  VALUE ZERO.
012000     05  FILLER              PIC X(10) VALUE "END-AL-KEY".
012100
012200 01  WRK-CS-09V00            PIC S9(9) COMP VALUE ZERO.
012300
012400 01  EOF-FLAG                PIC 9 VALUE ZERO.
012500
012600 01  RECORDS-IN-ERROR        PIC S9(5) COMP VALUE ZERO.
012700
012800 01  ERROR-FLAG              PIC 9 VALUE ZERO.
012900
013000 01  PERM-ERRORS             PIC S9(5) COMP VALUE ZERO.
013100
013200 01  STATUS-TEST-00          PIC 9 VALUE ZERO.
013300
013400 01  STATUS-TEST-10          PIC 9 VALUE ZERO.
013500 01  STATUS-TEST-READ        PIC 9 VALUE ZERO.
013600
013700 01  IX-VS2-STATUS.
013800     05  IX-VS2-STAT1        PIC X.
013900     05  IX-VS2-STAT2        PIC X.
014000
014100 01  COUNT-OF-RECS           PIC 9(5).
014200
014300 01  COUNT-OF-RECORDS REDEFINES COUNT-OF-RECS  PIC 9(5).
014400
014500 01  FILE-RECORD-INFORMATION-REC.
014600     05  FILE-RECORD-INFO-SKELETON.
014700         10  FILLER          PIC X(48) VALUE
014800              "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
014900         10  FILLER          PIC X(46) VALUE
015000                ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
015100         10  FILLER          PIC X(26) VALUE
015200                                    ",LFIL=000000,ORG=  ,LBLR= ".
015300         10  FILLER          PIC X(37) VALUE
015400                         ",RECKEY=                             ".
015500         10  FILLER          PIC X(38) VALUE
015600                        ",ALTKEY1=                             ".
015700         10  FILLER          PIC X(38) VALUE
015800                        ",ALTKEY2=                             ".
015900         10  FILLER          PIC X(7) VALUE SPACE.
016000     05  FILE-RECORD-INFO             OCCURS 10.
016100         10  FILE-RECORD-INFO-P1-120.
016200             15  FILLER      PIC X(5).
016300             15  XFILE-NAME  PIC X(6).
016400             15  FILLER      PIC X(8).
016500             15  XRECORD-NAME  PIC X(6).
016600             15  FILLER        PIC X(1).
016700             15  REELUNIT-NUMBER  PIC 9(1).
016800             15  FILLER           PIC X(7).
016900             15  XRECORD-NUMBER   PIC 9(6).
017000             15  FILLER           PIC X(6).
017100             15  UPDATE-NUMBER    PIC 9(2).
017200             15  FILLER           PIC X(5).
017300             15  ODO-NUMBER       PIC 9(4).
017400             15  FILLER           PIC X(5).
017500             15  XPROGRAM-NAME    PIC X(5).
017600             15  FILLER           PIC X(7).
017700             15  XRECORD-LENGTH   PIC 9(6).
017800             15  FILLER           PIC X(7).
017900             15  CHARS-OR-RECORDS  PIC X(2).
018000             15  FILLER            PIC X(1).
018100             15  XBLOCK-SIZE       PIC 9(4).
018200             15  FILLER            PIC X(6).
018300             15  RECORDS-IN-FILE   PIC 9(6).
018400             15  FILLER            PIC X(5).
018500             15  XFILE-ORGANIZATION  PIC X(2).
018600             15  FILLER              PIC X(6).
018700             15  XLABEL-TYPE         PIC X(1).
018800         10  FILE-RECORD-INFO-P121-240.
018900             15  FILLER              PIC X(8).
019000             15  XRECORD-KEY         PIC X(29).
019100             15  FILLER              PIC X(9).
019200             15  ALTERNATE-KEY1      PIC X(29).
019300             15  FILLER              PIC X(9).
019400             15  ALTERNATE-KEY2      PIC X(29).
019500             15  FILLER              PIC X(7).
019600
019700 01  TEST-RESULTS.
019800     02 FILLER                   PIC X      VALUE SPACE.
019900     02 FEATURE                  PIC X(20)  VALUE SPACE.
020000     02 FILLER                   PIC X      VALUE SPACE.
020100     02 P-OR-F                   PIC X(5)   VALUE SPACE.
020200     02 FILLER                   PIC X      VALUE SPACE.
020300     02  PAR-NAME.
020400       03 FILLER                 PIC X(19)  VALUE SPACE.
020500       03  PARDOT-X              PIC X      VALUE SPACE.
020600       03 DOTVALUE               PIC 99     VALUE ZERO.
020700     02 FILLER                   PIC X(8)   VALUE SPACE.
020800     02 RE-MARK                  PIC X(61).
020900 01  TEST-COMPUTED.
021000     02 FILLER                   PIC X(30)  VALUE SPACE.
021100     02 FILLER                   PIC X(17)  VALUE
021200            "       COMPUTED=".
021300     02 COMPUTED-X.
021400     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
021500     03 COMPUTED-N               REDEFINES COMPUTED-A
021600                                 PIC -9(9).9(9).
021700     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
021800     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
021900     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
022000     03       CM-18V0 REDEFINES COMPUTED-A.
022100         04 COMPUTED-18V0                    PIC -9(18).
022200         04 FILLER                           PIC X.
022300     03 FILLER PIC X(50) VALUE SPACE.
022400 01  TEST-CORRECT.
022500     02 FILLER PIC X(30) VALUE SPACE.
022600     02 FILLER PIC X(17) VALUE "       CORRECT =".
022700     02 CORRECT-X.
022800     03 CORRECT-A                  PIC X(20) VALUE SPACE.
022900     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
023000     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
023100     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
023200     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
023300     03      CR-18V0 REDEFINES CORRECT-A.
023400         04 CORRECT-18V0                     PIC -9(18).
023500         04 FILLER                           PIC X.
023600     03 FILLER PIC X(2) VALUE SPACE.
023700     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
023800 01  CCVS-C-1.
023900     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
024000-    "SS  PARAGRAPH-NAME
024100-    "       REMARKS".
024200     02 FILLER                     PIC X(20)    VALUE SPACE.
024300 01  CCVS-C-2.
024400     02 FILLER                     PIC X        VALUE SPACE.
024500     02 FILLER                     PIC X(6)     VALUE "TESTED".
024600     02 FILLER                     PIC X(15)    VALUE SPACE.
024700     02 FILLER                     PIC X(4)     VALUE "FAIL".
024800     02 FILLER                     PIC X(94)    VALUE SPACE.
024900 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
025000 01  REC-CT                        PIC 99       VALUE ZERO.
025100 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
025200 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
025300 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
025400 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
025500 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
025600 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
025700 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
025800 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
025900 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
026000 01  CCVS-H-1.
026100     02  FILLER                    PIC X(39)    VALUE SPACES.
026200     02  FILLER                    PIC X(42)    VALUE
026300     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
026400     02  FILLER                    PIC X(39)    VALUE SPACES.
026500 01  CCVS-H-2A.
026600   02  FILLER                        PIC X(40)  VALUE SPACE.
026700   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
026800   02  FILLER                        PIC XXXX   VALUE
026900     "4.2 ".
027000   02  FILLER                        PIC X(28)  VALUE
027100            " COPY - NOT FOR DISTRIBUTION".
027200   02  FILLER                        PIC X(41)  VALUE SPACE.
027300
027400 01  CCVS-H-2B.
027500   02  FILLER                        PIC X(15)  VALUE
027600            "TEST RESULT OF ".
027700   02  TEST-ID                       PIC X(9).
027800   02  FILLER                        PIC X(4)   VALUE
027900            " IN ".
028000   02  FILLER                        PIC X(12)  VALUE
028100     " HIGH       ".
028200   02  FILLER                        PIC X(22)  VALUE
028300            " LEVEL VALIDATION FOR ".
028400   02  FILLER                        PIC X(58)  VALUE
028500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
028600 01  CCVS-H-3.
028700     02  FILLER                      PIC X(34)  VALUE
028800            " FOR OFFICIAL USE ONLY    ".
028900     02  FILLER                      PIC X(58)  VALUE
029000     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
029100     02  FILLER                      PIC X(28)  VALUE
029200            "  COPYRIGHT   1985 ".
029300 01  CCVS-E-1.
029400     02 FILLER                       PIC X(52)  VALUE SPACE.
029500     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
029600     02 ID-AGAIN                     PIC X(9).
029700     02 FILLER                       PIC X(45)  VALUE SPACES.
029800 01  CCVS-E-2.
029900     02  FILLER                      PIC X(31)  VALUE SPACE.
030000     02  FILLER                      PIC X(21)  VALUE SPACE.
030100     02 CCVS-E-2-2.
030200         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
030300         03 FILLER                   PIC X      VALUE SPACE.
030400         03 ENDER-DESC               PIC X(44)  VALUE
030500            "ERRORS ENCOUNTERED".
030600 01  CCVS-E-3.
030700     02  FILLER                      PIC X(22)  VALUE
030800            " FOR OFFICIAL USE ONLY".
030900     02  FILLER                      PIC X(12)  VALUE SPACE.
031000     02  FILLER                      PIC X(58)  VALUE
031100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
031200     02  FILLER                      PIC X(13)  VALUE SPACE.
031300     02 FILLER                       PIC X(15)  VALUE
031400             " COPYRIGHT 1985".
031500 01  CCVS-E-4.
031600     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
031700     02 FILLER                       PIC X(4)   VALUE " OF ".
031800     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
031900     02 FILLER                       PIC X(40)  VALUE
032000      "  TESTS WERE EXECUTED SUCCESSFULLY".
032100 01  XXINFO.
032200     02 FILLER                       PIC X(19)  VALUE
032300            "*** INFORMATION ***".
032400     02 INFO-TEXT.
032500       04 FILLER                     PIC X(8)   VALUE SPACE.
032600       04 XXCOMPUTED                 PIC X(20).
032700       04 FILLER                     PIC X(5)   VALUE SPACE.
032800       04 XXCORRECT                  PIC X(20).
032900     02 INF-ANSI-REFERENCE           PIC X(48).
033000 01  HYPHEN-LINE.
033100     02 FILLER  PIC IS X VALUE IS SPACE.
033200     02 FILLER  PIC IS X(65)    VALUE IS "************************
033300-    "*****************************************".
033400     02 FILLER  PIC IS X(54)    VALUE IS "************************
033500-    "******************************".
033600 01  CCVS-PGM-ID                     PIC X(9)   VALUE
033700     "IX112A".
033800 01 TEST-NUMBER                      PIC 9 VALUE ZERO.
033900
034000 PROCEDURE DIVISION.
034100 DECLARATIVES.
034200
034300 SECT-IX105-0002 SECTION.
034400     USE AFTER EXCEPTION PROCEDURE ON IX-VS2.
034500 INPUT-PROCESS.
034600         MOVE 1 TO PERM-ERRORS.
034700         IF TEST-NUMBER NOT = 7 GO TO END-DECL.
034800 D-RWR-TEST-GF-01-1.
034900     IF IX-VS2-STATUS  = "00"
035000         GO TO D-RWR-PASS-GF-01-0.
035100     IF IX-VS2-STATUS  = "44"
035200         GO TO D-RWR-PASS-GF-01-0.
035300 D-RWR-FAIL-GF-01-0.
035400     MOVE "IX-5, 1.3.4, (5) d 1 & 2;  SHORT RECORD" TO RE-MARK.
035500     PERFORM D-FAIL.
035600     MOVE  IX-VS2-STATUS      TO COMPUTED-A.
035700     MOVE "00 OR 44" TO CORRECT-X.
035800     GO TO D-RWR-WRITE-GF-01-0.
035900 D-RWR-PASS-GF-01-0.
036000     PERFORM D-PASS.
036100 D-RWR-WRITE-GF-01-0.
036200     PERFORM D-PRINT-DETAIL.
036300 D-CLOSE-FILES.
036400P    OPEN I-O RAW-DATA.
036500P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
036600P    READ RAW-DATA INVALID KEY GO TO D-END-E-2.
036700P    MOVE "OK.     " TO C-ABORT.
036800P    MOVE PASS-COUNTER TO C-OK.
036900P    MOVE ERROR-HOLD   TO C-ALL.
037000P    MOVE ERROR-COUNTER TO C-FAIL.
037100P    MOVE DELETE-COUNTER TO C-DELETED.
037200P    MOVE INSPECT-COUNTER TO C-INSPECT.
037300P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO D-END-E-2.
037400PD-END-E-2.
037500P    CLOSE RAW-DATA.
037600     PERFORM D-END-ROUTINE THRU D-END-ROUTINE-13.
037700     CLOSE PRINT-FILE.
037800 D-TERMINATE-CCVS.
037900S    EXIT PROGRAM.
038000SD-TERMINATE-CALL.
038100     STOP     RUN.
038200 D-PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
038300 D-FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
038400 D-PRINT-DETAIL.
038500     IF REC-CT NOT EQUAL TO ZERO
038600             MOVE "." TO PARDOT-X
038700             MOVE REC-CT TO DOTVALUE.
038800     MOVE TEST-RESULTS TO PRINT-REC. PERFORM D-WRITE-LINE.
038900     IF P-OR-F EQUAL TO "FAIL*"  PERFORM D-WRITE-LINE
039000        PERFORM D-FAIL-ROUTINE THRU D-FAIL-ROUTINE-EX
039100     ELSE PERFORM D-BAIL-OUT THRU D-BAIL-OUT-EX.
039200     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
039300     MOVE SPACE TO CORRECT-X.
039400     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
039500     MOVE     SPACE TO RE-MARK.
039600 D-END-ROUTINE.
039700     MOVE HYPHEN-LINE TO DUMMY-RECORD.
039800     PERFORM D-WRITE-LINE 5 TIMES.
039900 D-END-RTN-EXIT.
040000     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM D-WRITE-LINE 2 TIMES.
040100 D-END-ROUTINE-1.
040200      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
040300      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
040400      ADD PASS-COUNTER TO ERROR-HOLD.
040500      MOVE PASS-COUNTER TO CCVS-E-4-1.
040600      MOVE ERROR-HOLD TO CCVS-E-4-2.
040700      MOVE CCVS-E-4 TO CCVS-E-2-2.
040800      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM D-WRITE-LINE.
040900 D-END-ROUTINE-12.
041000      MOVE "TEST(S) FAILED" TO ENDER-DESC.
041100     IF       ERROR-COUNTER IS EQUAL TO ZERO
041200         MOVE "NO " TO ERROR-TOTAL
041300         ELSE
041400         MOVE ERROR-COUNTER TO ERROR-TOTAL.
041500     MOVE     CCVS-E-2 TO DUMMY-RECORD.
041600     PERFORM D-WRITE-LINE.
041700 D-END-ROUTINE-13.
041800     IF DELETE-COUNTER IS EQUAL TO ZERO
041900         MOVE "NO " TO ERROR-TOTAL  ELSE
042000         MOVE DELETE-COUNTER TO ERROR-TOTAL.
042100     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
042200     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM D-WRITE-LINE.
042300      IF   INSPECT-COUNTER EQUAL TO ZERO
042400          MOVE "NO " TO ERROR-TOTAL
042500      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
042600      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
042700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM D-WRITE-LINE.
042800     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM D-WRITE-LINE.
042900 D-WRITE-LINE.
043000     ADD 1 TO RECORD-COUNT.
043100Y    IF RECORD-COUNT GREATER 42
043200Y      MOVE DUMMY-RECORD TO DUMMY-HOLD
043300Y      MOVE SPACE TO DUMMY-RECORD
043400Y      WRITE DUMMY-RECORD AFTER ADVANCING PAGE
043500Y      MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM D-WRT-LN 2 TIMES
043600Y      MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM D-WRT-LN 2 TIMES
043700Y      MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM D-WRT-LN 3 TIMES
043800Y      MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM D-WRT-LN 3 TIMES
043900Y      MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM D-WRT-LN
044000Y      MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM D-WRT-LN
044100Y      MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM D-WRT-LN
044200Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
044300Y        MOVE ZERO TO RECORD-COUNT.
044400     PERFORM D-WRT-LN.
044500 D-WRT-LN.
044600     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
044700     MOVE SPACE TO DUMMY-RECORD.
044800 D-BLANK-LINE-PRINT.
044900     PERFORM D-WRT-LN.
045000 D-FAIL-ROUTINE.
045100     IF     COMPUTED-X NOT EQUAL TO SPACE
045200            GO TO  D-FAIL-ROUTINE-WRITE.
045300     IF  CORRECT-X NOT EQUAL TO SPACE GO TO D-FAIL-ROUTINE-WRITE.
045400     MOVE ANSI-REFERENCE TO INF-ANSI-REFERENCE.
045500     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
045600     MOVE  XXINFO TO DUMMY-RECORD. PERFORM D-WRITE-LINE 2 TIMES.
045700     MOVE  SPACES TO INF-ANSI-REFERENCE.
045800     GO TO D-FAIL-ROUTINE-EX.
045900 D-FAIL-ROUTINE-WRITE.
046000     MOVE  TEST-COMPUTED TO PRINT-REC PERFORM D-WRITE-LINE
046100     MOVE  ANSI-REFERENCE TO COR-ANSI-REFERENCE.
046200     MOVE TEST-CORRECT TO PRINT-REC PERFORM D-WRITE-LINE 2 TIMES.
046300     MOVE  SPACES TO COR-ANSI-REFERENCE.
046400 D-FAIL-ROUTINE-EX. EXIT.
046500 D-BAIL-OUT.
046600     IF  COMPUTED-A NOT EQUAL TO SPACE GO TO D-BAIL-OUT-WRITE.
046700     IF  CORRECT-A EQUAL TO SPACE GO TO D-BAIL-OUT-EX.
046800 D-BAIL-OUT-WRITE.
046900     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
047000     MOVE  ANSI-REFERENCE TO INF-ANSI-REFERENCE.
047100     MOVE  XXINFO TO DUMMY-RECORD. PERFORM D-WRITE-LINE 2 TIMES.
047200     MOVE  SPACES TO INF-ANSI-REFERENCE.
047300 D-BAIL-OUT-EX. EXIT.
047400
047500 END-DECL.
047600 END DECLARATIVES.
047700
047800
047900 CCVS1 SECTION.
048000 OPEN-FILES.
048100P    OPEN I-O RAW-DATA.
048200P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
048300P    READ RAW-DATA INVALID KEY GO TO END-E-1.
048400P    MOVE "ABORTED " TO C-ABORT.
048500P    ADD 1 TO C-NO-OF-TESTS.
048600P    ACCEPT C-DATE  FROM DATE.
048700P    ACCEPT C-TIME  FROM TIME.
048800P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
048900PEND-E-1.
049000P    CLOSE RAW-DATA.
049100     OPEN    OUTPUT PRINT-FILE.
049200     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
049300     MOVE    SPACE TO TEST-RESULTS.
049400     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
049500     MOVE    ZERO TO REC-SKL-SUB.
049600     PERFORM CCVS-INIT-FILE 9 TIMES.
049700 CCVS-INIT-FILE.
049800     ADD     1 TO REC-SKL-SUB.
049900     MOVE    FILE-RECORD-INFO-SKELETON
050000          TO FILE-RECORD-INFO (REC-SKL-SUB).
050100 CCVS-INIT-EXIT.
050200     GO TO CCVS1-EXIT.
050300 CLOSE-FILES.
050400P    OPEN I-O RAW-DATA.
050500P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
050600P    READ RAW-DATA INVALID KEY GO TO END-E-2.
050700P    MOVE "OK.     " TO C-ABORT.
050800P    MOVE PASS-COUNTER TO C-OK.
050900P    MOVE ERROR-HOLD   TO C-ALL.
051000P    MOVE ERROR-COUNTER TO C-FAIL.
051100P    MOVE DELETE-COUNTER TO C-DELETED.
051200P    MOVE INSPECT-COUNTER TO C-INSPECT.
051300P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
051400PEND-E-2.
051500P    CLOSE RAW-DATA.
051600     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
051700 TERMINATE-CCVS.
051800S    EXIT PROGRAM.
051900STERMINATE-CALL.
052000     STOP     RUN.
052100 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
052200 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
052300 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
052400 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
052500     MOVE "****TEST DELETED****" TO RE-MARK.
052600 PRINT-DETAIL.
052700     IF REC-CT NOT EQUAL TO ZERO
052800             MOVE "." TO PARDOT-X
052900             MOVE REC-CT TO DOTVALUE.
053000     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
053100     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
053200        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
053300          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
053400     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
053500     MOVE SPACE TO CORRECT-X.
053600     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
053700     MOVE     SPACE TO RE-MARK.
053800 HEAD-ROUTINE.
053900     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
054000     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
054100     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
054200     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
054300 COLUMN-NAMES-ROUTINE.
054400     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
054500     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
054600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
054700 END-ROUTINE.
054800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
054900 END-RTN-EXIT.
055000     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
055100 END-ROUTINE-1.
055200      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
055300      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
055400      ADD PASS-COUNTER TO ERROR-HOLD.
055500*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
055600      MOVE PASS-COUNTER TO CCVS-E-4-1.
055700      MOVE ERROR-HOLD TO CCVS-E-4-2.
055800      MOVE CCVS-E-4 TO CCVS-E-2-2.
055900      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
056000  END-ROUTINE-12.
056100      MOVE "TEST(S) FAILED" TO ENDER-DESC.
056200     IF       ERROR-COUNTER IS EQUAL TO ZERO
056300         MOVE "NO " TO ERROR-TOTAL
056400         ELSE
056500         MOVE ERROR-COUNTER TO ERROR-TOTAL.
056600     MOVE     CCVS-E-2 TO DUMMY-RECORD.
056700     PERFORM WRITE-LINE.
056800 END-ROUTINE-13.
056900     IF DELETE-COUNTER IS EQUAL TO ZERO
057000         MOVE "NO " TO ERROR-TOTAL  ELSE
057100         MOVE DELETE-COUNTER TO ERROR-TOTAL.
057200     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
057300     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
057400      IF   INSPECT-COUNTER EQUAL TO ZERO
057500          MOVE "NO " TO ERROR-TOTAL
057600      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
057700      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
057800      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
057900     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
058000 WRITE-LINE.
058100     ADD 1 TO RECORD-COUNT.
058200Y    IF RECORD-COUNT GREATER 42
058300Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
058400Y        MOVE SPACE TO DUMMY-RECORD
058500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
058600Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
058700Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
058800Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
058900Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
059000Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
059100Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
059200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
059300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
059400Y        MOVE ZERO TO RECORD-COUNT.
059500     PERFORM WRT-LN.
059600 WRT-LN.
059700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
059800     MOVE SPACE TO DUMMY-RECORD.
059900 BLANK-LINE-PRINT.
060000     PERFORM WRT-LN.
060100 FAIL-ROUTINE.
060200     IF     COMPUTED-X NOT EQUAL TO SPACE
060300            GO TO   FAIL-ROUTINE-WRITE.
060400     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
060500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
060600     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
060700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
060800     MOVE   SPACES TO INF-ANSI-REFERENCE.
060900     GO TO  FAIL-ROUTINE-EX.
061000 FAIL-ROUTINE-WRITE.
061100     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
061200     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
061300     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
061400     MOVE   SPACES TO COR-ANSI-REFERENCE.
061500 FAIL-ROUTINE-EX. EXIT.
061600 BAIL-OUT.
061700     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
061800     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
061900 BAIL-OUT-WRITE.
062000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
062100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
062200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
062300     MOVE   SPACES TO INF-ANSI-REFERENCE.
062400 BAIL-OUT-EX. EXIT.
062500 CCVS1-EXIT.
062600     EXIT.
062700
062800 SECT-IX112A-0003 SECTION.
062900 SEQ-INIT-010.
063000     MOVE "IX-VS2" TO XFILE-NAME (1).
063100     MOVE "R1-F-G" TO XRECORD-NAME (1).
063200     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
063300     MOVE 000240 TO XRECORD-LENGTH (1).
063400     MOVE "RC" TO CHARS-OR-RECORDS (1).
063500     MOVE 0002 TO XBLOCK-SIZE (1).
063600     MOVE 000050 TO RECORDS-IN-FILE (1).
063700     MOVE "IX" TO XFILE-ORGANIZATION (1).
063800     MOVE "S" TO XLABEL-TYPE (1).
063900     MOVE 000001 TO XRECORD-NUMBER (1).
064000     MOVE 0 TO COUNT-OF-RECS.
064100
064200******************************************************************
064300*   TEST  1                                                      *
064400*         OPEN OUTPUT ...                 00 EXPECTED            *
064500*         IX-3, 1.3.4 (1) a                                      *
064600*    STATUS 00 CHECK ON OUTPUT FILE IX-VS2                       *
064700*    THE OUTPUT STATEMENT IS SUCCESSFULLY EXECUTED               *
064800******************************************************************
064900 OPN-INIT-GF-01-0.
065000     ADD  1 TO TEST-NUMBER.
065100     MOVE 1 TO STATUS-TEST-00.
065200     MOVE SPACES TO IX-VS2-STATUS.
065300     MOVE "OPEN OUTPUT: 00 EXP." TO FEATURE.
065400     MOVE "OPN-TEST-GF-01-0" TO PAR-NAME.
065500     OPEN
065600        OUTPUT IX-VS2.
065700     IF IX-VS2-STATUS EQUAL TO "00"
065800         GO TO OPN-PASS-GF-01-0.
065900 OPN-FAIL-GF-01-0.
066000     MOVE "IX-3, 1.3.4, (1) a. " TO RE-MARK.
066100     PERFORM FAIL.
066200     MOVE IX-VS2-STATUS TO COMPUTED-A.
066300     MOVE "00" TO CORRECT-X.
066400     GO TO OPN-WRITE-GF-01-0.
066500 OPN-PASS-GF-01-0.
066600     PERFORM PASS.
066700 OPN-WRITE-GF-01-0.
066800     PERFORM PRINT-DETAIL.
066900******************************************************************
067000*   TEST  2                                                      *
067100*         WRITE                           00 EXPECTED            *
067200*         IX-3, 1.3.4 (1) a                                      *
067300*    CREATING A INDEXED FILE WITH 50 RECORDS                     *
067400*    KEY:  FROM  000000001 TO 000000050                          *
067500******************************************************************
067600 WRI-INIT-GF-01-0.
067700     ADD  1 TO TEST-NUMBER.
067800     MOVE SPACES TO IX-VS2-STATUS.
067900     MOVE 0 TO STATUS-TEST-00.
068000     MOVE "WRITE: 00 EXPECTED" TO FEATURE.
068100     MOVE "WRI-TEST-GF-01-0" TO PAR-NAME.
068200 WRI-TEST-GF-01-0.
068300     MOVE XRECORD-NUMBER (1) TO GRP-0101-KEY, COUNT-OF-RECS.
068400     MOVE GRP-0101 TO XRECORD-KEY (1).
068500     MOVE GRP-0102 TO ALTERNATE-KEY1 (1).
068600*    THE VALUE OF THE ALTERNATE KEY IS 50 TIMES UNCHANGED        *
068700     MOVE FILE-RECORD-INFO (1) TO IX-VS2R1-F-G-240.
068800     WRITE IX-VS2R1-F-G-240.
068900     IF IX-VS2-STATUS  NOT = "00"
069000         MOVE 1 TO STATUS-TEST-00
069100         GO TO WRI-FAIL-GF-01-0.
069200     IF XRECORD-NUMBER (1) EQUAL TO 50
069300         GO TO WRI-TEST-GF-01-1.
069400     ADD 1 TO XRECORD-NUMBER (1).
069500     GO TO WRI-TEST-GF-01-0.
069600 WRI-TEST-GF-01-1.
069700     IF RECORDS-IN-ERROR EQUAL TO ZERO
069800         GO TO WRI-PASS-GF-01-0.
069900     MOVE "ERROR IN CREATING FILE" TO RE-MARK.
070000 WRI-FAIL-GF-01-0.
070100     MOVE "IX-3, 1.3.4, (1) a. " TO RE-MARK.
070200     PERFORM FAIL.
070300     MOVE "RECORDS WRITTEN =" TO COMPUTED-A.
070400     GO TO WRI-WRITE-GF-01-0.
070500 WRI-PASS-GF-01-0.
070600     PERFORM PASS.
070700 WRI-WRITE-GF-01-0.
070800     PERFORM PRINT-DETAIL.
070900     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
071000     MOVE "CREATE FILE IX-VS2" TO FEATURE.
071100     MOVE "WRI-TEST-GF-01-1" TO PAR-NAME.
071200     MOVE COUNT-OF-RECS TO CORRECT-18V0.
071300     PERFORM PRINT-DETAIL.
071400
071500******************************************************************
071600*   TEST  3                                                      *
071700*         WRITE  (WRONG SEQUENCE)         21 EXPECTED            *
071800*         IX-4, 1.3.4 (3) a                                      *
071900*    KEY:        000000049                                       *
072000******************************************************************
072100 WRI-INIT-GF-02-0.
072200     ADD  1 TO TEST-NUMBER.
072300     MOVE SPACES TO IX-VS2-STATUS.
072400     MOVE 0 TO STATUS-TEST-00.
072500     MOVE "WRITE:WRONG SEQ 21EX" TO FEATURE.
072600     MOVE "WRI-TEST-GF-02-0" TO PAR-NAME.
072700     MOVE 49 TO XRECORD-NUMBER (1).
072800 WRI-TEST-GF-02-0.
072900     MOVE XRECORD-NUMBER (1) TO GRP-0101-KEY, COUNT-OF-RECS.
073000     MOVE GRP-0101 TO XRECORD-KEY (1).
073100     MOVE GRP-0102 TO ALTERNATE-KEY1 (1).
073200     MOVE FILE-RECORD-INFO (1) TO IX-VS2R1-F-G-240.
073300     WRITE IX-VS2R1-F-G-240 INVALID KEY GO TO WRI-TEST-GF-02-1.
073400 WRI-TEST-GF-02-1.
073500     IF IX-VS2-STATUS  = "21"
073600         GO TO WRI-PASS-GF-02-0.
073700 WRI-FAIL-GF-02-0.
073800     MOVE "IX-4, 1.3.4, (3) a. " TO RE-MARK.
073900     PERFORM FAIL.
074000     MOVE  IX-VS2-STATUS      TO COMPUTED-A.
074100     MOVE "21" TO CORRECT-X.
074200     GO TO WRI-WRITE-GF-02-0.
074300 WRI-PASS-GF-02-0.
074400     PERFORM PASS.
074500 WRI-WRITE-GF-02-0.
074600     PERFORM PRINT-DETAIL.
074700
074800******************************************************************
074900*   TEST  4                                                      *
075000*         CLOSE OUTPUT                    00 EXPECTED            *
075100*         IX-3, 1.3.4 (1) a                                      *
075200******************************************************************
075300 CLO-INIT-GF-01-0.
075400     ADD  1 TO TEST-NUMBER.
075500     MOVE SPACES TO IX-VS2-STATUS.
075600     MOVE "CLOSE OUTPUT:00 EXP." TO FEATURE.
075700     MOVE "CLO-TEST-GF-01-0" TO PAR-NAME.
075800 CLO-TEST-GF-01-0.
075900     CLOSE IX-VS2.
076000     IF IX-VS2-STATUS = "00"
076100         GO TO CLO-PASS-GF-01-0.
076200 CLO-FAIL-GF-01-0.
076300     MOVE "IX-3, 1.3.4, (1) a. " TO RE-MARK.
076400     PERFORM FAIL.
076500     MOVE IX-VS2-STATUS TO COMPUTED-A.
076600     MOVE "00" TO CORRECT-X.
076700     GO TO CLO-WRITE-GF-01-0.
076800 CLO-PASS-GF-01-0.
076900     PERFORM PASS.
077000 CLO-WRITE-GF-01-0.
077100     PERFORM PRINT-DETAIL.
077200
077300******************************************************************
077400*    A INDEXED FILE WITH 50 RECORDS HAS BEEN CREATED.            *
077500******************************************************************
077600
077700******************************************************************
077800*   TEST  5                                                      *
077900*         OPEN INPUT                      00 EXPECTED            *
078000*         IX-3, 1.3.4 (1) a                                      *
078100******************************************************************
078200 OPN-INIT-GF-02-0.
078300     ADD  1 TO TEST-NUMBER.
078400     MOVE SPACES TO IX-VS2-STATUS.
078500     MOVE "OPEN INPUT:  00 EXP." TO FEATURE.
078600     MOVE "OPN-TEST-GF-02-0" TO PAR-NAME.
078700 OPN-TEST-GF-02-0.
078800     OPEN
078900        INPUT IX-VS2.
079000     IF IX-VS2-STATUS EQUAL TO "00"
079100         GO TO OPN-PASS-GF-02-0.
079200 OPN-FAIL-GF-02-0.
079300     MOVE "IX-3, 1.3.4, (1) a." TO RE-MARK.
079400     PERFORM FAIL.
079500     MOVE IX-VS2-STATUS TO COMPUTED-A.
079600     MOVE "00" TO CORRECT-X.
079700     GO TO OPN-WRITE-GF-02-0.
079800 OPN-PASS-GF-02-0.
079900     PERFORM PASS.
080000 OPN-WRITE-GF-02-0.
080100     PERFORM PRINT-DETAIL.
080200
080300******************************************************************
080400*   TEST  6                                                      *
080500*         READ                  OO EXPECTED                      *
080600*         IX-3, 1.3.4 (1) a                                      *
080700******************************************************************
080800 REA-INIT-F1-01-0.
080900     ADD  1 TO TEST-NUMBER.
081000     MOVE 1 TO STATUS-TEST-10.
081100     MOVE SPACES TO IX-VS2-STATUS.
081200     MOVE ZERO TO COUNT-OF-RECS.
081300     MOVE ZERO TO PERM-ERRORS.
081400     MOVE ZERO TO EOF-FLAG.
081500 REA-TEST-F1-01-0.
081600     READ IX-VS2.
081700     MOVE "REA-TEST-F1-01-0" TO PAR-NAME.
081800     MOVE "READ (USE):  00 EXP."     TO FEATURE.
081900     IF IX-VS2-STATUS = "00"
082000         GO TO REA-PASS-F1-01-0.
082100 REA-FAIL-F1-01-0.
082200     MOVE "IX-3, 1.3.4, (1) a. " TO RE-MARK.
082300     MOVE "I-O STATUS IS NOT 00" TO COMPUTED-A.
082400     MOVE "00" TO CORRECT-X.
082500     PERFORM FAIL.
082600     GO TO REA-WRITE-F1-01-0.
082700 REA-PASS-F1-01-0.
082800     PERFORM PASS.
082900 REA-WRITE-F1-01-0.
083000     PERFORM PRINT-DETAIL.
083100
083200******************************************************************
083300*   TEST  7                                                      *
083400*         REWRITE   (WITH WRONG RECORD LENGTH (SHORTER))         *
083500*         IX-5, 1.3.4 (5) d 1 & 2                                *
083600*         FILE STATUS  00   OR  44   EXPECTED                    *
083700*    KEY:        000000005                                       *
083800******************************************************************
083900 RWR-INIT-GF-01-0.
084000     ADD  1 TO TEST-NUMBER.
084100     CLOSE IX-VS2.
084200     OPEN I-O IX-VS2.
084300     MOVE SPACES TO IX-VS2-STATUS.
084400     MOVE 0 TO STATUS-TEST-00.
084500     MOVE "RWRTE SH. 00/44 EXP." TO FEATURE.
084600     MOVE "RWR-TEST-GF-01-0" TO PAR-NAME.
084700     READ IX-VS2 AT END       GO TO RWR-TEST-GF-01-0.
084800     READ IX-VS2 AT END       GO TO RWR-TEST-GF-01-0.
084900     READ IX-VS2 AT END       GO TO RWR-TEST-GF-01-0.
085000     READ IX-VS2 AT END       GO TO RWR-TEST-GF-01-0.
085100     READ IX-VS2 AT END       GO TO RWR-TEST-GF-01-0.
085200 RWR-TEST-GF-01-0.
085300     MOVE "WRONG RECORD LENGTH ( SHORTER)" TO IX-VS2-REC-LONG.
085400     REWRITE IX-VS2R1-F-G-200.
085500 RWR-TEST-GF-01-1.
085600     IF IX-VS2-STATUS  = "00"
085700         GO TO RWR-PASS-GF-01-0.
085800     IF IX-VS2-STATUS  = "44"
085900         GO TO RWR-PASS-GF-01-0.
086000 RWR-FAIL-GF-01-0.
086100     MOVE "IX-5, 1.3.4, (5) d 1 & 2;  SHORT RECORD" TO RE-MARK.
086200     PERFORM FAIL.
086300     MOVE  IX-VS2-STATUS      TO COMPUTED-A.
086400     MOVE "00 OR 44" TO CORRECT-X.
086500     GO TO RWR-WRITE-GF-01-0.
086600 RWR-PASS-GF-01-0.
086700     PERFORM PASS.
086800 RWR-WRITE-GF-01-0.
086900     PERFORM PRINT-DETAIL.
087000
087100 TERMINATE-ROUTINE.
087200     EXIT.
087300
087400 CCVS-EXIT SECTION.
087500 CCVS-999999.
087600     GO TO CLOSE-FILES.
