000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ139A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
000900*                             REVISED 1986, AUGUST             *
001000*                                                              *
001100*    CREATION DATE     /     VALIDATION DATE                   *
001200*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001300*                                                              *
001400****************************************************************
001500*                                                              *
001600*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001700*                                                              *
001800*            X-01   SEQUENTIAL MAGNETIC TAPE FILE.             *
001900*            X-55   SYSTEM PRINTER                             *
002000*            X-82   SOURCE-COMPUTER                            *
002100*            X-83   OBJECT-COMPUTER.                           *
002200*                                                              *
002300*                                                              *
002400****************************************************************
002500*                                                              *
002600*    SPLIT FROM SQ125A, THIS PROGRAM REPEATS THE SEQUENCE OF   *
002700*    FILE HANDLING ROUTINES IN ORDER TO CARRY OUT THE ISOLATED *
002800*    SPLIT TEST THAT CHECKS FOR THE CORRECT RESPONSE TO AN     *
002900*    OPEN FOR OUTPUT FOR A MAGNETIC TAPE FILE WHICH IS ALREADY *
003000*    OPEN IN THE OUTPUT MODE.  (SEE SQ125A).                   *
003100*                                                              *
003200****************************************************************
003300*
003400 ENVIRONMENT DIVISION.
003500 CONFIGURATION SECTION.
003600 SOURCE-COMPUTER.
003700     XXXXX082.
003800 OBJECT-COMPUTER.
003900     XXXXX083.
004000*
004100 INPUT-OUTPUT SECTION.
004200 FILE-CONTROL.
004300     SELECT PRINT-FILE ASSIGN TO
004400     XXXXX055.
004500*
004600P    SELECT RAW-DATA   ASSIGN TO
004700P    XXXXX062
004800P          ORGANIZATION IS INDEXED
004900P          ACCESS MODE  IS RANDOM
005000P          RECORD-KEY   IS RAW-DATA-KEY.
005100P
005200     SELECT SQ-FS1 ASSIGN TO
005300     XXXXX001
005400            FILE STATUS IS SQ-FS1-STATUS.
005500*
005600*
005700 DATA DIVISION.
005800 FILE SECTION.
005900 FD  PRINT-FILE
006000C    LABEL RECORDS
006100C    XXXXX084
006200C    DATA RECORD IS PRINT-REC DUMMY-RECORD
006300               .
006400 01  PRINT-REC    PICTURE X(120).
006500 01  DUMMY-RECORD PICTURE X(120).
006600P
006700PFD  RAW-DATA.
006800P01  RAW-DATA-SATZ.
006900P    05  RAW-DATA-KEY        PIC X(6).
007000P    05  C-DATE              PIC 9(6).
007100P    05  C-TIME              PIC 9(8).
007200P    05  NO-OF-TESTS         PIC 99.
007300P    05  C-OK                PIC 999.
007400P    05  C-ALL               PIC 999.
007500P    05  C-FAIL              PIC 999.
007600P    05  C-DELETED           PIC 999.
007700P    05  C-INSPECT           PIC 999.
007800P    05  C-NOTE              PIC X(13).
007900P    05  C-INDENT            PIC X.
008000P    05  C-ABORT             PIC X(8).
008100*
008200 FD  SQ-FS1
008300C    LABEL RECORD IS STANDARD
008400                .
008500 01  SQ-FS1R1-F-G-120 PIC X(120).
008600*
008700 WORKING-STORAGE SECTION.
008800*
008900***************************************************************
009000*                                                             *
009100*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
009200*                                                             *
009300***************************************************************
009400*
009500 01  SQ-FS1-STATUS.
009600   03  SQ-FS1-KEY-1   PIC X.
009700   03  SQ-FS1-KEY-2   PIC X.
009800*
009900 01  DECL-EXEC-SW  PIC 9.
010000*
010100*
010200***************************************************************
010300*                                                             *
010400*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
010500*                                                             *
010600***************************************************************
010700*
010800 01  REC-SKEL-SUB   PIC 99.
010900*
011000 01  FILE-RECORD-INFORMATION-REC.
011100     03 FILE-RECORD-INFO-SKELETON.
011200        05 FILLER                 PICTURE X(48)       VALUE
011300             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
011400        05 FILLER                 PICTURE X(46)       VALUE
011500             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
011600        05 FILLER                 PICTURE X(26)       VALUE
011700             ",LFIL=000000,ORG=  ,LBLR= ".
011800        05 FILLER                 PICTURE X(37)       VALUE
011900             ",RECKEY=                             ".
012000        05 FILLER                 PICTURE X(38)       VALUE
012100             ",ALTKEY1=                             ".
012200        05 FILLER                 PICTURE X(38)       VALUE
012300             ",ALTKEY2=                             ".
012400        05 FILLER                 PICTURE X(7)        VALUE SPACE.
012500     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
012600        05 FILE-RECORD-INFO-P1-120.
012700           07 FILLER              PIC X(5).
012800           07 XFILE-NAME          PIC X(6).
012900           07 FILLER              PIC X(8).
013000           07 XRECORD-NAME        PIC X(6).
013100           07 FILLER              PIC X(1).
013200           07 REELUNIT-NUMBER     PIC 9(1).
013300           07 FILLER              PIC X(7).
013400           07 XRECORD-NUMBER      PIC 9(6).
013500           07 FILLER              PIC X(6).
013600           07 UPDATE-NUMBER       PIC 9(2).
013700           07 FILLER              PIC X(5).
013800           07 ODO-NUMBER          PIC 9(4).
013900           07 FILLER              PIC X(5).
014000           07 XPROGRAM-NAME       PIC X(5).
014100           07 FILLER              PIC X(7).
014200           07 XRECORD-LENGTH      PIC 9(6).
014300           07 FILLER              PIC X(7).
014400           07 CHARS-OR-RECORDS    PIC X(2).
014500           07 FILLER              PIC X(1).
014600           07 XBLOCK-SIZE         PIC 9(4).
014700           07 FILLER              PIC X(6).
014800           07 RECORDS-IN-FILE     PIC 9(6).
014900           07 FILLER              PIC X(5).
015000           07 XFILE-ORGANIZATION  PIC X(2).
015100           07 FILLER              PIC X(6).
015200           07 XLABEL-TYPE         PIC X(1).
015300        05 FILE-RECORD-INFO-P121-240.
015400           07 FILLER              PIC X(8).
015500           07 XRECORD-KEY         PIC X(29).
015600           07 FILLER              PIC X(9).
015700           07 ALTERNATE-KEY1      PIC X(29).
015800           07 FILLER              PIC X(9).
015900           07 ALTERNATE-KEY2      PIC X(29).
016000           07 FILLER              PIC X(7).
016100*
016200 01  TEST-RESULTS.
016300     02 FILLER              PIC X      VALUE SPACE.
016400     02  PAR-NAME.
016500       03 FILLER              PIC X(14)  VALUE SPACE.
016600       03 PARDOT-X            PIC X      VALUE SPACE.
016700       03 DOTVALUE            PIC 99     VALUE ZERO.
016800     02 FILLER              PIC X      VALUE SPACE.
016900     02 FEATURE             PIC X(24)  VALUE SPACE.
017000     02 FILLER              PIC X      VALUE SPACE.
017100     02 P-OR-F              PIC X(5)   VALUE SPACE.
017200     02 FILLER              PIC X(9)   VALUE SPACE.
017300     02 RE-MARK             PIC X(61).
017400 01  TEST-COMPUTED.
017500   02 FILLER  PIC X(30)  VALUE SPACE.
017600   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
017700   02 COMPUTED-X.
017800     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
017900     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
018000     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
018100     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
018200     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
018300     03       CM-18V0 REDEFINES COMPUTED-A.
018400        04 COMPUTED-18V0                   PIC -9(18).
018500        04 FILLER                          PIC X.
018600     03 FILLER PIC X(50) VALUE SPACE.
018700 01  TEST-CORRECT.
018800     02 FILLER PIC X(30) VALUE SPACE.
018900     02 FILLER PIC X(17) VALUE "       CORRECT =".
019000     02 CORRECT-X.
019100     03 CORRECT-A                  PIC X(20) VALUE SPACE.
019200     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
019300     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
019400     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
019500     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
019600     03      CR-18V0 REDEFINES CORRECT-A.
019700         04 CORRECT-18V0                     PIC -9(18).
019800         04 FILLER                           PIC X.
019900     03 FILLER PIC X(2) VALUE SPACE.
020000     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
020100*
020200 01  CCVS-C-1.
020300     02 FILLER  PIC IS X        VALUE  SPACE.
020400     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
020500     02 FILLER  PIC IS X        VALUE  SPACE.
020600     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
020700     02 FILLER  PIC IS X        VALUE  SPACE.
020800     02 FILLER  PIC IS X(5)     VALUE "PASS ".
020900     02 FILLER  PIC IS X(9)     VALUE  SPACE.
021000     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
021100 01  CCVS-C-2.
021200     02 FILLER  PIC X(19)  VALUE  SPACE.
021300     02 FILLER  PIC X(6)   VALUE "TESTED".
021400     02 FILLER  PIC X(19)  VALUE  SPACE.
021500     02 FILLER  PIC X(4)   VALUE "FAIL".
021600     02 FILLER  PIC X(72)  VALUE  SPACE.
021700*
021800 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
021900 01  REC-CT            PIC 99       VALUE ZERO.
022000 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
022100 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
022200 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
022300 01  PASS-COUNTER      PIC 999      VALUE ZERO.
022400 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
022500 01  ERROR-HOLD        PIC 999      VALUE ZERO.
022600 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
022700 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
022800 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
022900 01  CCVS-H-1.
023000     02  FILLER          PIC X(39)    VALUE SPACES.
023100     02  FILLER          PIC X(42)    VALUE
023200     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
023300     02  FILLER          PIC X(39)    VALUE SPACES.
023400 01  CCVS-H-2A.
023500   02  FILLER            PIC X(40)  VALUE SPACE.
023600   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
023700   02  FILLER            PIC XXXX   VALUE
023800     "4.2 ".
023900   02  FILLER            PIC X(28)  VALUE
024000            " COPY - NOT FOR DISTRIBUTION".
024100   02  FILLER            PIC X(41)  VALUE SPACE.
024200*
024300 01  CCVS-H-2B.
024400   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
024500   02  TEST-ID           PIC X(9).
024600   02  FILLER            PIC X(4)   VALUE " IN ".
024700   02  FILLER            PIC X(12)  VALUE
024800     " HIGH       ".
024900   02  FILLER            PIC X(22)  VALUE
025000            " LEVEL VALIDATION FOR ".
025100   02  FILLER            PIC X(58)  VALUE
025200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025300 01  CCVS-H-3.
025400     02  FILLER          PIC X(34)  VALUE
025500            " FOR OFFICIAL USE ONLY    ".
025600     02  FILLER          PIC X(58)  VALUE
025700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
025800     02  FILLER          PIC X(28)  VALUE
025900            "  COPYRIGHT   1985,1986 ".
026000 01  CCVS-E-1.
026100     02 FILLER           PIC X(52)  VALUE SPACE.
026200     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
026300     02 ID-AGAIN         PIC X(9).
026400     02 FILLER           PIC X(45)  VALUE SPACES.
026500 01  CCVS-E-2.
026600     02  FILLER          PIC X(31)  VALUE SPACE.
026700     02  FILLER          PIC X(21)  VALUE SPACE.
026800     02  CCVS-E-2-2.
026900         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
027000         03 FILLER         PIC X      VALUE SPACE.
027100         03 ENDER-DESC     PIC X(44)  VALUE
027200            "ERRORS ENCOUNTERED".
027300 01  CCVS-E-3.
027400     02  FILLER          PIC X(22)  VALUE
027500            " FOR OFFICIAL USE ONLY".
027600     02  FILLER          PIC X(12)  VALUE SPACE.
027700     02  FILLER          PIC X(58)  VALUE
027800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
027900     02  FILLER          PIC X(8)   VALUE SPACE.
028000     02  FILLER          PIC X(20)  VALUE
028100             " COPYRIGHT 1985,1986".
028200 01  CCVS-E-4.
028300     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
028400     02 FILLER           PIC X(4)   VALUE " OF ".
028500     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
028600     02 FILLER           PIC X(40)  VALUE
028700      "  TESTS WERE EXECUTED SUCCESSFULLY".
028800 01  XXINFO.
028900     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
029000     02 INFO-TEXT.
029100       04 FILLER             PIC X(8)   VALUE SPACE.
029200       04 XXCOMPUTED         PIC X(20).
029300       04 FILLER             PIC X(5)   VALUE SPACE.
029400       04 XXCORRECT          PIC X(20).
029500     02 INF-ANSI-REFERENCE PIC X(48).
029600 01  HYPHEN-LINE.
029700     02 FILLER  PIC IS X VALUE IS SPACE.
029800     02 FILLER  PIC IS X(65)    VALUE IS "************************
029900-    "*****************************************".
030000     02 FILLER  PIC IS X(54)    VALUE IS "************************
030100-    "******************************".
030200 01  CCVS-PGM-ID  PIC X(9)   VALUE
030300     "SQ139A".
030400*
030500*
030600 PROCEDURE DIVISION.
030700 DECLARATIVES.
030800 SQ139A-DECLARATIVE-001-SECT SECTION.
030900     USE AFTER STANDARD EXCEPTION PROCEDURE SQ-FS1.
031000 INPUT-ERROR-PROCEDURE.
031100     IF DECL-EXEC-SW NOT = 9
031200         GO TO   NOT-DECL-9.
031300*
031400*    DECLARATIVE PROCEDURE ENTERED FROM SECOND OPEN OUTPUT
031500*
031600 DECL-OPEN-TEST.
031700     MOVE    SPACE TO DUMMY-RECORD
031800     PERFORM DECL-WRITE-LINE
031900     MOVE   "ABNORMAL TERMINATION AT THIS POINT IS ACCEPTABLE"
032000               TO DUMMY-RECORD
032100     PERFORM DECL-WRITE-LINE 3 TIMES.
032200     GO TO   END-DECLS.
032300*
032400*
032500 NOT-DECL-9.
032600     MOVE   "NOT-DECL-9"  TO PAR-NAME.
032700     MOVE    DECL-EXEC-SW TO COMPUTED-18V0.
032800     MOVE    9            TO CORRECT-18V0.
032900     MOVE   "UNEXPECTED ENTRY TO DECLARATIVES" TO RE-MARK.
033000     PERFORM DECL-FAIL.
033100     GO TO   END-DECLS.
033200*
033300*
033400*
033500 DECL-PASS.
033600     MOVE   "PASS " TO P-OR-F.
033700     ADD     1 TO PASS-COUNTER.
033800     PERFORM DECL-PRINT-DETAIL.
033900*
034000 DECL-FAIL.
034100     MOVE   "FAIL*" TO P-OR-F.
034200     ADD     1 TO ERROR-COUNTER.
034300     PERFORM DECL-PRINT-DETAIL.
034400*
034500 DECL-PRINT-DETAIL.
034600     IF REC-CT NOT EQUAL TO ZERO
034700             MOVE "." TO PARDOT-X
034800             MOVE REC-CT TO DOTVALUE.
034900     MOVE    TEST-RESULTS TO PRINT-REC.
035000     PERFORM DECL-WRITE-LINE.
035100     IF P-OR-F EQUAL TO "FAIL*"
035200         PERFORM DECL-WRITE-LINE
035300         PERFORM DECL-FAIL-ROUTINE THRU DECL-FAIL-EX
035400     ELSE
035500         PERFORM DECL-BAIL THRU DECL-BAIL-EX.
035600     MOVE    SPACE TO P-OR-F.
035700     MOVE    SPACE TO COMPUTED-X.
035800     MOVE    SPACE TO CORRECT-X.
035900     IF REC-CT EQUAL TO ZERO
036000         MOVE    SPACE TO PAR-NAME.
036100     MOVE    SPACE TO RE-MARK.
036200*
036300 DECL-WRITE-LINE.
036400     ADD     1 TO RECORD-COUNT.
036500Y    IF RECORD-COUNT GREATER 50
036600Y        MOVE    DUMMY-RECORD TO DUMMY-HOLD
036700Y        MOVE    SPACE TO DUMMY-RECORD
036800Y        WRITE   DUMMY-RECORD AFTER ADVANCING PAGE
036900Y        MOVE    CCVS-C-1 TO DUMMY-RECORD PERFORM DECL-WRT-LN
037000Y        MOVE    CCVS-C-2 TO DUMMY-RECORD
037100Y        PERFORM DECL-WRT-LN 2 TIMES
037200Y        MOVE    HYPHEN-LINE TO DUMMY-RECORD
037300Y        PERFORM DECL-WRT-LN
037400Y        MOVE    DUMMY-HOLD TO DUMMY-RECORD
037500Y        MOVE    ZERO TO RECORD-COUNT.
037600     PERFORM DECL-WRT-LN.
037700*
037800 DECL-WRT-LN.
037900     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
038000     MOVE    SPACE TO DUMMY-RECORD.
038100*
038200 DECL-FAIL-ROUTINE.
038300     IF COMPUTED-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
038400     IF CORRECT-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
038500     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
038600     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
038700     MOVE    XXINFO TO DUMMY-RECORD.
038800     PERFORM DECL-WRITE-LINE 2 TIMES.
038900     MOVE    SPACES TO INF-ANSI-REFERENCE.
039000     GO TO   DECL-FAIL-EX.
039100 DECL-FAIL-WRITE.
039200     MOVE    TEST-COMPUTED TO PRINT-REC
039300     PERFORM DECL-WRITE-LINE
039400     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
039500     MOVE    TEST-CORRECT TO PRINT-REC
039600     PERFORM DECL-WRITE-LINE 2 TIMES.
039700     MOVE    SPACES TO COR-ANSI-REFERENCE.
039800 DECL-FAIL-EX.
039900     EXIT.
040000*
040100 DECL-BAIL.
040200     IF COMPUTED-A NOT EQUAL TO SPACE GO TO DECL-BAIL-WRITE.
040300     IF CORRECT-A EQUAL TO SPACE GO TO DECL-BAIL-EX.
040400 DECL-BAIL-WRITE.
040500     MOVE    CORRECT-A TO XXCORRECT.
040600     MOVE    COMPUTED-A TO XXCOMPUTED.
040700     MOVE    XXINFO TO DUMMY-RECORD.
040800     PERFORM DECL-WRITE-LINE 2 TIMES.
040900 DECL-BAIL-EX.
041000     EXIT.
041100*
041200 END-DECLS.
041300     MOVE    ZERO TO DECL-EXEC-SW.
041400 END DECLARATIVES.
041500*
041600*
041700 CCVS1 SECTION.
041800 OPEN-FILES.
041900P    OPEN    I-O RAW-DATA.
042000P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
042100P    READ    RAW-DATA INVALID KEY GO TO END-E-1.
042200P    MOVE   "ABORTED "   TO C-ABORT.
042300P    ADD     1           TO C-NO-OF-TESTS.
042400P    ACCEPT  C-DATE      FROM DATE.
042500P    ACCEPT  C-TIME      FROM TIME.
042600P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
042700PEND-E-1.
042800P    CLOSE   RAW-DATA.
042900     OPEN    OUTPUT PRINT-FILE.
043000     MOVE    CCVS-PGM-ID TO TEST-ID.
043100     MOVE    CCVS-PGM-ID TO ID-AGAIN.
043200     MOVE    SPACE TO TEST-RESULTS.
043300     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
043400     MOVE    ZERO TO REC-SKEL-SUB.
043500     PERFORM CCVS-INIT-FILE 10 TIMES.
043600     GO TO CCVS1-EXIT.
043700*
043800 CCVS-INIT-FILE.
043900     ADD     1 TO REC-SKL-SUB.
044000     MOVE    FILE-RECORD-INFO-SKELETON TO
044100                  FILE-RECORD-INFO (REC-SKL-SUB).
044200*
044300 CLOSE-FILES.
044400     PERFORM END-ROUTINE THRU END-ROUTINE-13.
044500     CLOSE   PRINT-FILE.
044600P    OPEN    I-O RAW-DATA.
044700P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
044800P    READ    RAW-DATA INVALID KEY GO TO END-E-2.
044900P    MOVE   "OK.     " TO C-ABORT.
045000P    MOVE    PASS-COUNTER  TO C-OK.
045100P    MOVE    ERROR-HOLD    TO C-ALL.
045200P    MOVE    ERROR-COUNTER TO C-FAIL.
045300P    MOVE    DELETE-CNT    TO C-DELETED.
045400P    MOVE    INSPECT-COUNTER TO C-INSPECT.
045500P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
045600PEND-E-2.
045700P    CLOSE   RAW-DATA.
045800 TERMINATE-CCVS.
045900S    EXIT    PROGRAM.
046000     STOP    RUN.
046100*
046200 INSPT.
046300     MOVE   "INSPT" TO P-OR-F.
046400     ADD     1 TO INSPECT-COUNTER.
046500     PERFORM PRINT-DETAIL.
046600
046700 PASS.
046800     MOVE   "PASS " TO P-OR-F.
046900     ADD     1 TO PASS-COUNTER.
047000     PERFORM PRINT-DETAIL.
047100*
047200 FAIL.
047300     MOVE   "FAIL*" TO P-OR-F.
047400     ADD     1 TO ERROR-COUNTER.
047500     PERFORM PRINT-DETAIL.
047600*
047700 DE-LETE.
047800     MOVE   "****TEST DELETED****" TO RE-MARK.
047900     MOVE   "*****" TO P-OR-F.
048000     ADD     1 TO DELETE-COUNTER.
048100     PERFORM PRINT-DETAIL.
048200*
048300 PRINT-DETAIL.
048400     IF REC-CT NOT EQUAL TO ZERO
048500         MOVE   "." TO PARDOT-X
048600         MOVE    REC-CT TO DOTVALUE.
048700     MOVE    TEST-RESULTS TO PRINT-REC.
048800     PERFORM WRITE-LINE.
048900     IF P-OR-F EQUAL TO "FAIL*"
049000         PERFORM WRITE-LINE
049100         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
049200     ELSE
049300         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
049400     MOVE    SPACE TO P-OR-F.
049500     MOVE    SPACE TO COMPUTED-X.
049600     MOVE    SPACE TO CORRECT-X.
049700     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
049800     MOVE    SPACE TO RE-MARK.
049900*
050000 HEAD-ROUTINE.
050100     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
050200     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
050300     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
050400     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
050500 COLUMN-NAMES-ROUTINE.
050600     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
050700     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
050800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
050900 END-ROUTINE.
051000     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
051100     PERFORM WRITE-LINE 5 TIMES.
051200 END-RTN-EXIT.
051300     MOVE    CCVS-E-1 TO DUMMY-RECORD.
051400     PERFORM WRITE-LINE 2 TIMES.
051500*
051600 END-ROUTINE-1.
051700     ADD     ERROR-COUNTER   TO ERROR-HOLD
051800     ADD     INSPECT-COUNTER TO ERROR-HOLD.
051900     ADD     DELETE-COUNTER  TO ERROR-HOLD.
052000     ADD     PASS-COUNTER    TO ERROR-HOLD.
052100     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
052200     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
052300     MOVE    CCVS-E-4        TO CCVS-E-2-2.
052400     MOVE    CCVS-E-2        TO DUMMY-RECORD
052500     PERFORM WRITE-LINE.
052600     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
052700     IF ERROR-COUNTER IS EQUAL TO ZERO
052800         MOVE   "NO " TO ERROR-TOTAL
052900     ELSE
053000         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
053100     MOVE    CCVS-E-2 TO DUMMY-RECORD.
053200     PERFORM WRITE-LINE.
053300 END-ROUTINE-13.
053400     IF DELETE-COUNTER IS EQUAL TO ZERO
053500         MOVE   "NO " TO ERROR-TOTAL
053600     ELSE
053700         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
053800     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
053900     MOVE    CCVS-E-2 TO DUMMY-RECORD.
054000     PERFORM WRITE-LINE.
054100     IF INSPECT-COUNTER EQUAL TO ZERO
054200         MOVE   "NO " TO ERROR-TOTAL
054300     ELSE
054400         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
054500     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
054600     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
054700     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
054800*
054900 WRITE-LINE.
055000     ADD     1 TO RECORD-COUNT.
055100Y    IF RECORD-COUNT GREATER 50
055200Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
055300Y        MOVE  SPACE TO DUMMY-RECORD
055400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
055500Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
055600Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
055700Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
055800Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
055900Y        MOVE  ZERO TO RECORD-COUNT.
056000     PERFORM WRT-LN.
056100*
056200 WRT-LN.
056300     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
056400     MOVE    SPACE TO DUMMY-RECORD.
056500 BLANK-LINE-PRINT.
056600     PERFORM WRT-LN.
056700 FAIL-ROUTINE.
056800     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
056900     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
057000     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
057100     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
057200     MOVE    XXINFO TO DUMMY-RECORD.
057300     PERFORM WRITE-LINE 2 TIMES.
057400     MOVE    SPACES TO INF-ANSI-REFERENCE.
057500     GO TO   FAIL-ROUTINE-EX.
057600 FAIL-ROUTINE-WRITE.
057700     MOVE    TEST-COMPUTED  TO PRINT-REC
057800     PERFORM WRITE-LINE
057900     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
058000     MOVE    TEST-CORRECT   TO PRINT-REC
058100     PERFORM WRITE-LINE 2 TIMES.
058200     MOVE    SPACES         TO COR-ANSI-REFERENCE.
058300 FAIL-ROUTINE-EX.
058400     EXIT.
058500 BAIL-OUT.
058600     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
058700     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
058800 BAIL-OUT-WRITE.
058900     MOVE    CORRECT-A      TO XXCORRECT.
059000     MOVE    COMPUTED-A     TO XXCOMPUTED.
059100     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
059200     MOVE    XXINFO TO DUMMY-RECORD.
059300     PERFORM WRITE-LINE 2 TIMES.
059400     MOVE    SPACES TO INF-ANSI-REFERENCE.
059500 BAIL-OUT-EX.
059600     EXIT.
059700 CCVS1-EXIT.
059800     EXIT.
059900*
060000****************************************************************
060100*                                                              *
060200*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
060300*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
060400*                                                              *
060500****************************************************************
060600*
060700 SECT-SQ139A-MAIN SECTION.
060800*
060900*    THE FIRST ACTION IS TO CREATE THE FILE BY MEANS OF AN
061000*    OPEN OUTPUT STATEMENT.
061100*
061200 SEQ-INIT-01.
061300*
061400     MOVE    1 TO REC-CT
061500     MOVE   "CREATE FILE, OPEN OUTPUT" TO FEATURE
061600     MOVE   "SEQ-TEST-OP-01" TO PAR-NAME
061700     MOVE    1 TO DECL-EXEC-SW
061800     MOVE   "**" TO SQ-FS1-STATUS.
061900 SEQ-TEST-OP-01.
062000     OPEN    OUTPUT SQ-FS1.
062100 SEQ-INIT-02.
062200     MOVE    1 TO REC-CT
062300     MOVE   "OPEN OUTPUT ON OPEN FILE" TO FEATURE
062400     MOVE   "SEQ-TEST-OP-02" TO PAR-NAME
062500     MOVE    9 TO DECL-EXEC-SW
062600     MOVE   "**" TO SQ-FS1-STATUS.
062700 SEQ-TEST-OP-02.
062800     OPEN    OUTPUT SQ-FS1.
062900*
063000*    CHECK EXECUTION OF DECLARATIVE.
063100*
063200     MOVE   "SEQ-TEST-OP-02" TO PAR-NAME.
063300     MOVE    1 TO REC-CT.
063400     GO TO   SEQ-TEST-OP-02-01.
063500 SEQ-DELETE-02-01.
063600     PERFORM DE-LETE.
063700     GO TO   SEQ-TEST-02-01-END.
063800 SEQ-TEST-OP-02-01.
063900     IF      DECL-EXEC-SW = 0
064000         PERFORM PASS
064100     ELSE
064200         MOVE    DECL-EXEC-SW TO COMPUTED-18V0
064300         MOVE    0            TO CORRECT-18V0
064400         MOVE   "DECLARATIVE NOT EXECUTED" TO RE-MARK
064500         MOVE   "V11-2, 1.3.5" TO ANSI-REFERENCE
064600         PERFORM FAIL.
064700 SEQ-TEST-02-01-END.
064800 CCVS-EXIT SECTION.
064900 CCVS-999999.
065000     GO TO   CLOSE-FILES.
