000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IX216A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*
001400*         NEW TESTS:
001500*
001600*             SELECT OPTIONAL ...   WITH
001700*                    --------
001800*             OPEN EXTEND ...   (FOR A NON-EXISTING FILE)
001900*                  ------              ------------
002000*         THEN THE FILE IS CLOSED AFTER WRITING 300 RECORDS
002100*         AND OPENED WITH:
002200*
002300*             OPEN EXTEND ...   (FOR AN EXISTING FILE)
002400*                  ------               --------
002500*         AND     CLOSE IX-FS2 LOCK.
002600*                              ----
002700*
002800*         ALL OTHER TESTS ARE IDENTICAL WITH THE TESTS IN IX104.
002900*
003000*
003100*    THIS PROGRAM TESTS THE SYNTACTICAL CONSTRUCTS AND SEMANTIC
003200*    ACTIONS ASSOCIATED WITH THE FOLLOWING ELEMENTS:
003300*
003400*    (1) FILE STATUS
003500*    (2) USE AFTER EXCEPTION USING FILE-NAME
003600*    (3) READ
003700*    (4) WRITE
003800*    (5) REWRITE
003900*    (6) RECORD KEY
004000*    (7) ACCESS
004100*
004200*    THIS PROGRAM CREATES AN INDEXED FILE SEQUENTIALLY (ACCESS
004300*    MODE SEQUENTIAL) AND THEN UPDATES SELECTIVE RECORDS OF THE
004400*    FILE.  THE FILE STATUS CONTENTS ARE CAPTURED AND TESTED FOR
004500*    ACCURACY FOR EACH OPEN, CLOSE, READ AND REWRITE STATEMENT
004600*    USED.  THE READ, WRITE AND REWRITE STATEMENTS ARE USED
004700*    WITHOUT THE APPROPRIATE AT END OR INVALID KEY PHRASES. THE
004800*    OMISSION OF THESE PHRASES ARE PERMITTED IF AN APPLICABLE USE
004900*    PROCEDURE HAS BEEN SPECIFIED.
005000*
005100*
005200*       X-CARDS  WHICH MUST BE REPLACED FOR THIS PROGRAM ARE
005300*
005400*             X-25   INDEXED FILE IMPLEMENTOR-NAME IN ASSIGN TO
005500*                    CLAUSE FOR DATA FILE IX-FD2
005600*             X-45   INDEXED FILE IMPLEMENTOR-NAME IN ASSIGN TO
005700*                    CLAUSE FOR INDEX FILE IX-FD2
005800*             X-55   IMPLEMENTOR-NAME FOR SYSTEM PRINTER
005900*             X-62   IMPLEMENTOR-NAME FOR RAW-DATA (OPTIONAL)
006000*             X-82   IMPLEMENTOR-NAME FOR SOURCE-COMPUTER
006100*             X-83   IMPLEMENTOR-NAME FOR OBJECT-COMPUTER
006200*
006300*         NOTE:  X-CARDS 45 AND 62          ARE OPTIONAL
006400*               AND NEED ONLY TO BE PRESENT IF THE COMPILER RE-
006500*               QUIRES THIS CODE BE AVAILABLE FOR PROPER PROGRAM
006600*               COMPILATION AND EXECUTION. IF THE VP-ROUTINE IS
006700*               USED THE  X-CARDS MAY BE AUTOMATICALLY SELECTED
006800*               FOR INCLUSION IN THE PROGRAM BY SPECIFYING THE
006900*               APPROPRIATE LETTER IN THE "*OPT" VP-ROUTINE
007000*               CONTROL CARD. THE LETTER  CORRESPONDS TO A
007100*               CHARACTER IN POSITION 7 OF THE SOURCE LINE AND
007200*               THEY ARE AS FOLLOWS
007300*
007400*                  J  SELECTS X-CARD 45
007500*                  P  SELECTS X-CARD 62
007600*
007700******************************************************
007800 ENVIRONMENT DIVISION.
007900 CONFIGURATION SECTION.
008000 SOURCE-COMPUTER.
008100     XXXXX082.
008200 OBJECT-COMPUTER.
008300     XXXXX083.
008400 INPUT-OUTPUT SECTION.
008500 FILE-CONTROL.
008600P    SELECT RAW-DATA   ASSIGN TO
008700P    XXXXX062
008800P           ORGANIZATION IS INDEXED
008900P           ACCESS MODE IS RANDOM
009000P           RECORD KEY IS RAW-DATA-KEY.
009100     SELECT PRINT-FILE ASSIGN TO
009200     XXXXX055.
009300     SELECT OPTIONAL  IX-FS2 ASSIGN
009400     XXXXX025
009500J    XXXXX045
009600             ORGANIZATION IS INDEXED
009700        ACCESS SEQUENTIAL
009800        FILE STATUS IS IX-FS2-STATUS
009900        RECORD  IX-FS2-KEY.
010000 DATA DIVISION.
010100 FILE SECTION.
010200P
010300PFD  RAW-DATA.
010400P
010500P01  RAW-DATA-SATZ.
010600P    05  RAW-DATA-KEY        PIC X(6).
010700P    05  C-DATE              PIC 9(6).
010800P    05  C-TIME              PIC 9(8).
010900P    05  C-NO-OF-TESTS       PIC 99.
011000P    05  C-OK                PIC 999.
011100P    05  C-ALL               PIC 999.
011200P    05  C-FAIL              PIC 999.
011300P    05  C-DELETED           PIC 999.
011400P    05  C-INSPECT           PIC 999.
011500P    05  C-NOTE              PIC X(13).
011600P    05  C-INDENT            PIC X.
011700P    05  C-ABORT             PIC X(8).
011800 FD  PRINT-FILE.
011900 01  PRINT-REC PICTURE X(120).
012000 01  DUMMY-RECORD PICTURE X(120).
012100 FD  IX-FS2
012200C    LABEL RECORDS ARE STANDARD
012300C    DATA RECORDS IX-FS2R1-F-G-240
012400     BLOCK CONTAINS 480
012500     RECORD CONTAINS  240  CHARACTERS.
012600 01  IX-FS2R1-F-G-240.
012700     05 IX-FS2-REC-120    PIC X(120).
012800     05 IX-FS2-REC-120-240.
012900     10  FILLER PICTURE X(8).
013000     10  IX-FS2-KEY PIC X(29).
013100     10  FILLER PIC X(83).
013200 WORKING-STORAGE SECTION.
013300 01  GRP-0101.
013400     02 FILLER PIC X(10) VALUE "ABCD921XYZ".
013500     02  WRK-DU-09V00-001 PIC 9(9) VALUE ZERO.
013600     02 FILLER PIC X(10) VALUE "Z2F()$+-AB".
013700 01  GRP-0001.
013800     05 WRK-CS-09V00-012  PIC S9(9) USAGE COMP  VALUE ZERO.
013900     05 WRK-CS-09V00-013  PIC S9(9) USAGE COMP  VALUE ZERO.
014000     05 WRK-CS-09V00-014  PIC S9(9) USAGE COMP  VALUE ZERO.
014100     05 WRK-CS-09V00-015  PIC S9(9) USAGE COMP  VALUE ZERO.
014200     05 WRK-CS-09V00-016  PIC S9(9) USAGE COMP  VALUE ZERO.
014300     05 WRK-CS-09V00-017  PIC S9(9) USAGE COMP  VALUE ZERO.
014400     05 WRK-CS-09V00-018  PIC S9(9) USAGE COMP  VALUE ZERO.
014500     05 IX-FS2-STATUS     PIC  XX  VALUE  SPACE.
014600     05 WRK-XN-0002-001   PIC  X(2) VALUE  SPACE.
014700     05 WRK-XN-0002-002   PIC  X(2) VALUE  SPACE.
014800     05 WRK-XN-0002-003   PIC  X(2) VALUE  SPACE.
014900     05 WRK-XN-0002-004   PIC  X(2) VALUE  SPACE.
015000     05 WRK-XN-0002-005   PIC  X(2) VALUE  SPACE.
015100     05 WRK-XN-0002-006   PIC  X(2) VALUE  SPACE.
015200     05 WRK-XN-0002-007   PIC  X(2) VALUE  SPACE.
015300     05 WRK-XN-0002-008   PIC  X(2) VALUE  SPACE.
015400     05 WRK-XN-0002-009   PIC  X(2) VALUE  SPACE.
015500 01  DUMMY-WRK-REC.
015600     02 DUMMY-WRK1       PIC X(120).
015700     02 DUMMY-WRK2  REDEFINES  DUMMY-WRK1.
015800        03 FILLER   PIC X(5).
015900        03 DUMMY-WRK-INDENT-5  PIC X(115).
016000 01  FILE-RECORD-INFORMATION-REC.
016100     03 FILE-RECORD-INFO-SKELETON.
016200        05 FILLER                 PICTURE X(48)       VALUE
016300             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
016400        05 FILLER                 PICTURE X(46)       VALUE
016500             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
016600        05 FILLER                 PICTURE X(26)       VALUE
016700             ",LFIL=000000,ORG=  ,LBLR= ".
016800        05 FILLER                 PICTURE X(37)       VALUE
016900             ",RECKEY=                             ".
017000        05 FILLER                 PICTURE X(38)       VALUE
017100             ",ALTKEY1=                             ".
017200        05 FILLER                 PICTURE X(38)       VALUE
017300             ",ALTKEY2=                             ".
017400        05 FILLER                 PICTURE X(7)        VALUE SPACE.
017500     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
017600        05 FILE-RECORD-INFO-P1-120.
017700           07 FILLER              PIC X(5).
017800           07 XFILE-NAME           PIC X(6).
017900           07 FILLER              PIC X(8).
018000           07 XRECORD-NAME         PIC X(6).
018100           07 FILLER              PIC X(1).
018200           07 REELUNIT-NUMBER     PIC 9(1).
018300           07 FILLER              PIC X(7).
018400           07 XRECORD-NUMBER       PIC 9(6).
018500           07 FILLER              PIC X(6).
018600           07 UPDATE-NUMBER       PIC 9(2).
018700           07 FILLER              PIC X(5).
018800           07 ODO-NUMBER          PIC 9(4).
018900           07 FILLER              PIC X(5).
019000           07 XPROGRAM-NAME        PIC X(5).
019100           07 FILLER              PIC X(7).
019200           07 XRECORD-LENGTH       PIC 9(6).
019300           07 FILLER              PIC X(7).
019400           07 CHARS-OR-RECORDS    PIC X(2).
019500           07 FILLER              PIC X(1).
019600           07 XBLOCK-SIZE          PIC 9(4).
019700           07 FILLER              PIC X(6).
019800           07 RECORDS-IN-FILE     PIC 9(6).
019900           07 FILLER              PIC X(5).
020000           07 XFILE-ORGANIZATION   PIC X(2).
020100           07 FILLER              PIC X(6).
020200           07 XLABEL-TYPE          PIC X(1).
020300        05 FILE-RECORD-INFO-P121-240.
020400           07 FILLER              PIC X(8).
020500           07 XRECORD-KEY          PIC X(29).
020600           07 FILLER              PIC X(9).
020700           07 ALTERNATE-KEY1      PIC X(29).
020800           07 FILLER              PIC X(9).
020900           07 ALTERNATE-KEY2      PIC X(29).
021000           07 FILLER              PIC X(7).
021100 01  TEST-RESULTS.
021200     02 FILLER                   PIC X      VALUE SPACE.
021300     02 FEATURE                  PIC X(20)  VALUE SPACE.
021400     02 FILLER                   PIC X      VALUE SPACE.
021500     02 P-OR-F                   PIC X(5)   VALUE SPACE.
021600     02 FILLER                   PIC X      VALUE SPACE.
021700     02  PAR-NAME.
021800       03 FILLER                 PIC X(19)  VALUE SPACE.
021900       03  PARDOT-X              PIC X      VALUE SPACE.
022000       03 DOTVALUE               PIC 99     VALUE ZERO.
022100     02 FILLER                   PIC X(8)   VALUE SPACE.
022200     02 RE-MARK                  PIC X(61).
022300 01  TEST-COMPUTED.
022400     02 FILLER                   PIC X(30)  VALUE SPACE.
022500     02 FILLER                   PIC X(17)  VALUE
022600            "       COMPUTED=".
022700     02 COMPUTED-X.
022800     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
022900     03 COMPUTED-N               REDEFINES COMPUTED-A
023000                                 PIC -9(9).9(9).
023100     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
023200     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
023300     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
023400     03       CM-18V0 REDEFINES COMPUTED-A.
023500         04 COMPUTED-18V0                    PIC -9(18).
023600         04 FILLER                           PIC X.
023700     03 FILLER PIC X(50) VALUE SPACE.
023800 01  TEST-CORRECT.
023900     02 FILLER PIC X(30) VALUE SPACE.
024000     02 FILLER PIC X(17) VALUE "       CORRECT =".
024100     02 CORRECT-X.
024200     03 CORRECT-A                  PIC X(20) VALUE SPACE.
024300     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
024400     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
024500     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
024600     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
024700     03      CR-18V0 REDEFINES CORRECT-A.
024800         04 CORRECT-18V0                     PIC -9(18).
024900         04 FILLER                           PIC X.
025000     03 FILLER PIC X(2) VALUE SPACE.
025100     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
025200 01  CCVS-C-1.
025300     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
025400-    "SS  PARAGRAPH-NAME
025500-    "       REMARKS".
025600     02 FILLER                     PIC X(20)    VALUE SPACE.
025700 01  CCVS-C-2.
025800     02 FILLER                     PIC X        VALUE SPACE.
025900     02 FILLER                     PIC X(6)     VALUE "TESTED".
026000     02 FILLER                     PIC X(15)    VALUE SPACE.
026100     02 FILLER                     PIC X(4)     VALUE "FAIL".
026200     02 FILLER                     PIC X(94)    VALUE SPACE.
026300 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
026400 01  REC-CT                        PIC 99       VALUE ZERO.
026500 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
026600 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
026700 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
026800 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
026900 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
027000 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
027100 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
027200 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
027300 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
027400 01  CCVS-H-1.
027500     02  FILLER                    PIC X(39)    VALUE SPACES.
027600     02  FILLER                    PIC X(42)    VALUE
027700     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
027800     02  FILLER                    PIC X(39)    VALUE SPACES.
027900 01  CCVS-H-2A.
028000   02  FILLER                        PIC X(40)  VALUE SPACE.
028100   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
028200   02  FILLER                        PIC XXXX   VALUE
028300     "4.2 ".
028400   02  FILLER                        PIC X(28)  VALUE
028500            " COPY - NOT FOR DISTRIBUTION".
028600   02  FILLER                        PIC X(41)  VALUE SPACE.
028700
028800 01  CCVS-H-2B.
028900   02  FILLER                        PIC X(15)  VALUE
029000            "TEST RESULT OF ".
029100   02  TEST-ID                       PIC X(9).
029200   02  FILLER                        PIC X(4)   VALUE
029300            " IN ".
029400   02  FILLER                        PIC X(12)  VALUE
029500     " HIGH       ".
029600   02  FILLER                        PIC X(22)  VALUE
029700            " LEVEL VALIDATION FOR ".
029800   02  FILLER                        PIC X(58)  VALUE
029900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
030000 01  CCVS-H-3.
030100     02  FILLER                      PIC X(34)  VALUE
030200            " FOR OFFICIAL USE ONLY    ".
030300     02  FILLER                      PIC X(58)  VALUE
030400     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
030500     02  FILLER                      PIC X(28)  VALUE
030600            "  COPYRIGHT   1985 ".
030700 01  CCVS-E-1.
030800     02 FILLER                       PIC X(52)  VALUE SPACE.
030900     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
031000     02 ID-AGAIN                     PIC X(9).
031100     02 FILLER                       PIC X(45)  VALUE SPACES.
031200 01  CCVS-E-2.
031300     02  FILLER                      PIC X(31)  VALUE SPACE.
031400     02  FILLER                      PIC X(21)  VALUE SPACE.
031500     02 CCVS-E-2-2.
031600         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
031700         03 FILLER                   PIC X      VALUE SPACE.
031800         03 ENDER-DESC               PIC X(44)  VALUE
031900            "ERRORS ENCOUNTERED".
032000 01  CCVS-E-3.
032100     02  FILLER                      PIC X(22)  VALUE
032200            " FOR OFFICIAL USE ONLY".
032300     02  FILLER                      PIC X(12)  VALUE SPACE.
032400     02  FILLER                      PIC X(58)  VALUE
032500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
032600     02  FILLER                      PIC X(13)  VALUE SPACE.
032700     02 FILLER                       PIC X(15)  VALUE
032800             " COPYRIGHT 1985".
032900 01  CCVS-E-4.
033000     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
033100     02 FILLER                       PIC X(4)   VALUE " OF ".
033200     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
033300     02 FILLER                       PIC X(40)  VALUE
033400      "  TESTS WERE EXECUTED SUCCESSFULLY".
033500 01  XXINFO.
033600     02 FILLER                       PIC X(19)  VALUE
033700            "*** INFORMATION ***".
033800     02 INFO-TEXT.
033900       04 FILLER                     PIC X(8)   VALUE SPACE.
034000       04 XXCOMPUTED                 PIC X(20).
034100       04 FILLER                     PIC X(5)   VALUE SPACE.
034200       04 XXCORRECT                  PIC X(20).
034300     02 INF-ANSI-REFERENCE           PIC X(48).
034400 01  HYPHEN-LINE.
034500     02 FILLER  PIC IS X VALUE IS SPACE.
034600     02 FILLER  PIC IS X(65)    VALUE IS "************************
034700-    "*****************************************".
034800     02 FILLER  PIC IS X(54)    VALUE IS "************************
034900-    "******************************".
035000 01  CCVS-PGM-ID                     PIC X(9)   VALUE
035100     "IX216A".
035200 PROCEDURE DIVISION.
035300 DECLARATIVES.
035400 IX-FS2-01 SECTION.
035500     USE    AFTER STANDARD ERROR PROCEDURE ON IX-FS2.
035600 IX-FS2-01-01.
035700     ADD      1 TO  WRK-CS-09V00-013.
035800     GO TO    IX-FS2-01-03
035900              IX-FS2-01-05
036000              DEPENDING ON  WRK-CS-09V00-012.
036100     GO TO    IX-FS2-01-EXIT.
036200 IX-FS2-01-03.
036300*ENTRY FROM SEGMENT INX-TEST-001.
036400*    SHOULD NOT ENTER HERE UNLESS SPACE ALLOCATION TOO SMALL.
036500     ADD     1 TO  WRK-CS-09V00-014.
036600 IX-FS2-01-05.
036700     ADD      1 TO WRK-CS-09V00-017.
036800     IF       XRECORD-NUMBER (2) EQUAL TO 500
036900              MOVE   IX-FS2-STATUS TO WRK-XN-0002-002
037000              MOVE  "10" TO WRK-XN-0002-003.
037100 IX-FS2-01-EXIT.
037200     EXIT.
037300 END DECLARATIVES.
037400 CCVS1 SECTION.
037500 OPEN-FILES.
037600P    OPEN I-O RAW-DATA.
037700P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
037800P    READ RAW-DATA INVALID KEY GO TO END-E-1.
037900P    MOVE "ABORTED " TO C-ABORT.
038000P    ADD 1 TO C-NO-OF-TESTS.
038100P    ACCEPT C-DATE  FROM DATE.
038200P    ACCEPT C-TIME  FROM TIME.
038300P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
038400PEND-E-1.
038500P    CLOSE RAW-DATA.
038600     OPEN    OUTPUT PRINT-FILE.
038700     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
038800     MOVE    SPACE TO TEST-RESULTS.
038900     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
039000     MOVE    ZERO TO REC-SKL-SUB.
039100     PERFORM CCVS-INIT-FILE 9 TIMES.
039200 CCVS-INIT-FILE.
039300     ADD     1 TO REC-SKL-SUB.
039400     MOVE    FILE-RECORD-INFO-SKELETON
039500          TO FILE-RECORD-INFO (REC-SKL-SUB).
039600 CCVS-INIT-EXIT.
039700     GO TO CCVS1-EXIT.
039800 CLOSE-FILES.
039900P    OPEN I-O RAW-DATA.
040000P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
040100P    READ RAW-DATA INVALID KEY GO TO END-E-2.
040200P    MOVE "OK.     " TO C-ABORT.
040300P    MOVE PASS-COUNTER TO C-OK.
040400P    MOVE ERROR-HOLD   TO C-ALL.
040500P    MOVE ERROR-COUNTER TO C-FAIL.
040600P    MOVE DELETE-COUNTER TO C-DELETED.
040700P    MOVE INSPECT-COUNTER TO C-INSPECT.
040800P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
040900PEND-E-2.
041000P    CLOSE RAW-DATA.
041100     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
041200 TERMINATE-CCVS.
041300S    EXIT PROGRAM.
041400STERMINATE-CALL.
041500     STOP     RUN.
041600 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
041700 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
041800 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
041900 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
042000     MOVE "****TEST DELETED****" TO RE-MARK.
042100 PRINT-DETAIL.
042200     IF REC-CT NOT EQUAL TO ZERO
042300             MOVE "." TO PARDOT-X
042400             MOVE REC-CT TO DOTVALUE.
042500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
042600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
042700        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
042800          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
042900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
043000     MOVE SPACE TO CORRECT-X.
043100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
043200     MOVE     SPACE TO RE-MARK.
043300 HEAD-ROUTINE.
043400     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043500     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043600     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
043700     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
043800 COLUMN-NAMES-ROUTINE.
043900     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
044000     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
044200 END-ROUTINE.
044300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
044400 END-RTN-EXIT.
044500     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044600 END-ROUTINE-1.
044700      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
044800      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
044900      ADD PASS-COUNTER TO ERROR-HOLD.
045000*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
045100      MOVE PASS-COUNTER TO CCVS-E-4-1.
045200      MOVE ERROR-HOLD TO CCVS-E-4-2.
045300      MOVE CCVS-E-4 TO CCVS-E-2-2.
045400      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
045500  END-ROUTINE-12.
045600      MOVE "TEST(S) FAILED" TO ENDER-DESC.
045700     IF       ERROR-COUNTER IS EQUAL TO ZERO
045800         MOVE "NO " TO ERROR-TOTAL
045900         ELSE
046000         MOVE ERROR-COUNTER TO ERROR-TOTAL.
046100     MOVE     CCVS-E-2 TO DUMMY-RECORD.
046200     PERFORM WRITE-LINE.
046300 END-ROUTINE-13.
046400     IF DELETE-COUNTER IS EQUAL TO ZERO
046500         MOVE "NO " TO ERROR-TOTAL  ELSE
046600         MOVE DELETE-COUNTER TO ERROR-TOTAL.
046700     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
046800     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
046900      IF   INSPECT-COUNTER EQUAL TO ZERO
047000          MOVE "NO " TO ERROR-TOTAL
047100      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
047200      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
047300      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
047400     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
047500 WRITE-LINE.
047600     ADD 1 TO RECORD-COUNT.
047700Y    IF RECORD-COUNT GREATER 42
047800Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
047900Y        MOVE SPACE TO DUMMY-RECORD
048000Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
048100Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
048200Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
048300Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
048400Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
048500Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
048600Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
048700Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
048800Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
048900Y        MOVE ZERO TO RECORD-COUNT.
049000     PERFORM WRT-LN.
049100 WRT-LN.
049200     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
049300     MOVE SPACE TO DUMMY-RECORD.
049400 BLANK-LINE-PRINT.
049500     PERFORM WRT-LN.
049600 FAIL-ROUTINE.
049700     IF     COMPUTED-X NOT EQUAL TO SPACE
049800            GO TO   FAIL-ROUTINE-WRITE.
049900     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
050000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
050100     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
050200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
050300     MOVE   SPACES TO INF-ANSI-REFERENCE.
050400     GO TO  FAIL-ROUTINE-EX.
050500 FAIL-ROUTINE-WRITE.
050600     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
050700     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
050800     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
050900     MOVE   SPACES TO COR-ANSI-REFERENCE.
051000 FAIL-ROUTINE-EX. EXIT.
051100 BAIL-OUT.
051200     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
051300     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
051400 BAIL-OUT-WRITE.
051500     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
051600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
051700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
051800     MOVE   SPACES TO INF-ANSI-REFERENCE.
051900 BAIL-OUT-EX. EXIT.
052000 CCVS1-EXIT.
052100     EXIT.
052200 SECT-IX-04-001 SECTION.
052300 INX-INIT-001.
052400     MOVE     "CREATE IX-FS2" TO  FEATURE
052500     MOVE     "IX-FS2"        TO  XFILE-NAME (2).
052600     MOVE     "R1-F-G"        TO  XRECORD-NAME (2).
052700     MOVE     CCVS-PGM-ID     TO  XPROGRAM-NAME (2).
052800     MOVE     000240          TO  XRECORD-LENGTH (2).
052900     MOVE     "RC"            TO  CHARS-OR-RECORDS (2).
053000     MOVE     0001            TO  XBLOCK-SIZE       (2).
053100     MOVE     000500          TO  RECORDS-IN-FILE  (2).
053200     MOVE    "IX"                TO XFILE-ORGANIZATION (2).
053300     MOVE     "S"             TO  XLABEL-TYPE        (2).
053400     MOVE     000001          TO  XRECORD-NUMBER     (2).
053500*INITIALIZE  RECORD WORK AREA NUMBER 2.
053600     MOVE     1         TO  WRK-CS-09V00-012.
053700     MOVE     ZERO      TO  WRK-CS-09V00-013 WRK-CS-09V00-014
053800                            WRK-CS-09V00-015 WRK-CS-09V00-016
053900                            WRK-CS-09V00-017 WRK-CS-09V00-018.
054000 OPEN-INIT-GF-01.
054100     MOVE     SPACE     TO  IX-FS2-STATUS.
054200     MOVE    ZERO TO WRK-DU-09V00-001.
054300 OPEN-TEST-GF-01.
054400*   FILE IX-FS2   DOES NOT EXIST **********************
054500     OPEN    EXTEND     IX-FS2.
054600     IF IX-FS2-STATUS = "05"
054700         GO TO OPEN-PASS-GF-01.
054800 OPEN-FAIL-GF-01.
054900     PERFORM FAIL.
055000     MOVE IX-FS2-STATUS TO COMPUTED-A.
055100     MOVE "05" TO CORRECT-A.
055200     MOVE "IX-3; 1.3.4 (1) D; STATUS AFTER OPEN EXTEND" TO RE-MARK
055300     GO TO OPEN-WRITE-GF-01.
055400 OPEN-PASS-GF-01.
055500     PERFORM PASS.
055600 OPEN-WRITE-GF-01.
055700     MOVE "OPEN-TEST-GF-01" TO PAR-NAME.
055800     MOVE "OPEN EXTEND: EXP: 05"       TO FEATURE.
055900     PERFORM PRINT-DETAIL.
056000     MOVE GRP-0101 TO IX-FS2-KEY.
056100     MOVE     IX-FS2-STATUS TO WRK-XN-0002-001.
056200*CAPTURE STATUS KEY AFTER  OPEN STATEMENT IS EXECUTED.
056300 WRITE-INIT-GF-01.
056400     MOVE    "99"  TO IX-FS2-STATUS.
056500     MOVE     XRECORD-NUMBER (2) TO WRK-DU-09V00-001.
056600     MOVE     GRP-0101 TO XRECORD-KEY (2).
056700     MOVE     FILE-RECORD-INFO (2) TO IX-FS2R1-F-G-240.
056800     WRITE   IX-FS2R1-F-G-240.
056900     IF        IX-FS2-STATUS NOT EQUAL TO "00"
057000         ADD  1  TO WRK-CS-09V00-016.
057100     IF XRECORD-NUMBER (2) EQUAL TO 300
057200         PERFORM WRITE-TEST-GF-01 THRU WRITE-TEST-GF-01-END.
057300     IF       XRECORD-NUMBER (2) EQUAL TO 500
057400              GO TO  WRITE-TEST-GF-02.
057500     ADD      01 TO  XRECORD-NUMBER (2).
057600     GO TO    WRITE-INIT-GF-01.
057700 WRITE-TEST-GF-01.
057800     CLOSE IX-FS2.
057900     MOVE     SPACE     TO  IX-FS2-STATUS.
058000     OPEN     EXTEND    IX-FS2.
058100 WRITE-TEST-GF-01-02.
058200     IF IX-FS2-STATUS = "00"
058300         GO TO WRITE-TEST-GF-01-02-PASS.
058400 WRITE-TEST-GF-01-02-FAIL.
058500     PERFORM FAIL.
058600     MOVE IX-FS2-STATUS TO COMPUTED-A.
058700     MOVE "00" TO CORRECT-A.
058800     MOVE "IX-3; 1.3.4 (1) A; STATUS AFTER OPEN EXTEND" TO RE-MARK
058900     GO TO WRITE-TEST-GF-01-02-WRITE.
059000 WRITE-TEST-GF-01-02-PASS.
059100     PERFORM PASS.
059200 WRITE-TEST-GF-01-02-WRITE.
059300     MOVE "WRITE-TEST-GF-01   " TO PAR-NAME.
059400     MOVE "OPEN EXTEND EXISTING" TO FEATURE.
059500     PERFORM PRINT-DETAIL.
059600 WRITE-TEST-GF-01-END.
059700     EXIT.
059800
059900 WRITE-TEST-GF-02.
060000     IF       WRK-CS-09V00-014 NOT EQUAL TO ZERO
060100              MOVE "IX-41; EXCEPTIONS/ERRORS" TO RE-MARK
060200              MOVE  ZERO TO CORRECT-18V0
060300              MOVE WRK-CS-09V00-014 TO COMPUTED-18V0
060400              PERFORM   FAIL
060500              ELSE
060600              PERFORM   PASS.
060700     MOVE "OP EXT: ERROR/EXCEPT" TO FEATURE.
060800     MOVE "WRITE-TEST-GF-02" TO PAR-NAME.
060900     PERFORM  PRINT-DETAIL.
061000 WRITE-TEST-GF-03.
061100     MOVE "OP EXT: INCORR COUNT" TO FEATURE.
061200     MOVE "WRITE-TEST-GF-03" TO PAR-NAME.
061300     IF       XRECORD-NUMBER (2) NOT EQUAL TO 500
061400              MOVE "IX-41; INCORRECT COUNT" TO RE-MARK
061500              MOVE  500 TO CORRECT-18V0
061600             MOVE   XRECORD-NUMBER (2)  TO COMPUTED-18V0
061700              PERFORM  FAIL
061800              ELSE
061900              PERFORM PASS.
062000     PERFORM  PRINT-DETAIL.
062100 WRITE-TEST-GF-04.
062200     MOVE "OP EXT STATUS EXP:00" TO FEATURE.
062300     MOVE "WRITE-TEST-GF-04" TO PAR-NAME.
062400*    IF       WRK-XN-0002-001 NOT EQUAL TO  "00"
062500*           MOVE "IX-3; 1.3.4 (1) A; STATUS AFTER OPEN" TO RE-MARK
062600*             MOVE WRK-XN-0002-001 TO COMPUTED-A
062700*             MOVE "00" TO CORRECT-A
062800*             PERFORM  FAIL
062900*             ELSE
063000*             PERFORM  PASS.
063100     PERFORM DE-LETE.
063200     PERFORM  PRINT-DETAIL.
063300 WRITE-TEST-GF-05.
063400     MOVE "WRITE STATUS EXP: 00" TO FEATURE.
063500     MOVE "WRITE-TEST-GF-05" TO PAR-NAME.
063600     IF        IX-FS2-STATUS NOT EQUAL TO "00"
063700           MOVE "IX-3; 1.3.4 (1) A; STATUS AFTER WRITE" TO RE-MARK
063800              MOVE IX-FS2-STATUS TO COMPUTED-A
063900              MOVE "00" TO CORRECT-A
064000              PERFORM   FAIL
064100              ELSE
064200              PERFORM   PASS.
064300     PERFORM  PRINT-DETAIL.
064400 WRITE-TEST-GF-06.
064500     MOVE "WRITE STATUS EXP: 00" TO FEATURE.
064600     MOVE "WRITE-TEST-GF-06" TO PAR-NAME.
064700     IF      WRK-CS-09V00-016    NOT EQUAL TO ZERO
064800           MOVE "IX-3; 1.3.4 (1) A; STATUS AFTER WRITE" TO RE-MARK
064900              MOVE   ZERO TO CORRECT-18V0
065000              MOVE    WRK-CS-09V00-016 TO COMPUTED-18V0
065100              PERFORM   FAIL
065200              ELSE
065300              PERFORM  PASS.
065400     PERFORM  PRINT-DETAIL.
065500 WRITE-TEST-GF-07.
065600     MOVE "CLOSE STATUS EXP: 00" TO FEATURE.
065700     MOVE "WRITE-TEST-GF-07" TO PAR-NAME.
065800     MOVE   99       TO  IX-FS2-STATUS.
065900     CLOSE    IX-FS2.
066000     IF        IX-FS2-STATUS NOT EQUAL TO "00"
066100           MOVE "IX-3; 1.3.4 (1) A; STATUS AFTER CLOSE" TO RE-MARK
066200              MOVE   IX-FS2-STATUS TO COMPUTED-A
066300              MOVE "00" TO CORRECT-A
066400              PERFORM FAIL
066500              ELSE
066600              PERFORM PASS.
066700     PERFORM  PRINT-DETAIL.
066800
066900 RWRT-INIT-GF-01.
067000     MOVE     2     TO  WRK-CS-09V00-012.
067100     MOVE     ZERO  TO  WRK-CS-09V00-013.
067200     MOVE     ZERO  TO  WRK-CS-09V00-014.
067300     MOVE     ZERO  TO  WRK-CS-09V00-015.
067400     MOVE     ZERO  TO  WRK-CS-09V00-016.
067500     MOVE     ZERO  TO  WRK-CS-09V00-017.
067600     MOVE     ZERO  TO  WRK-CS-09V00-018.
067700     MOVE    SPACE TO IX-FS2-STATUS.
067800     MOVE "RWRT-TEST-GF-01" TO PAR-NAME.
067900     OPEN     I-O  IX-FS2.
068000     MOVE     SPACE     TO  WRK-XN-0002-002
068100     MOVE     SPACE     TO  WRK-XN-0002-003
068200     MOVE     SPACE     TO  WRK-XN-0002-004
068300     MOVE      IX-FS2-STATUS TO WRK-XN-0002-001
068400     MOVE     SPACE TO IX-FS2-STATUS.
068500     MOVE    "UPDATE  IX-FS2"  TO FEATURE.
068600*CAPTURE THE CONTENTS OF STATUS KEY AFTER OPEN IS EXECUTED.
068700 RWRT-TEST-GF-01.
068800     ADD      1 TO WRK-CS-09V00-014.
068900     ADD      1 TO WRK-CS-09V00-015.
069000     READ  IX-FS2.
069100     IF        IX-FS2-STATUS EQUAL TO "10"
069200              GO TO  RWRT-TEST-GF-01-1.
069300     MOVE     IX-FS2R1-F-G-240 TO FILE-RECORD-INFO (2).
069400     IF       WRK-CS-09V00-015 EQUAL TO 5
069500              ADD 01 TO UPDATE-NUMBER (2)
069600     MOVE     FILE-RECORD-INFO (2) TO IX-FS2R1-F-G-240
069700             PERFORM  RWRT-010-UPDATE
069800           MOVE ZERO TO WRK-CS-09V00-015
069900              GO TO  RWRT-TEST-GF-01-2.
070000     IF       WRK-CS-09V00-014 GREATER 500
070100              GO TO  RWRT-TEST-GF-01-1.
070200     GO TO    RWRT-TEST-GF-01.
070300 RWRT-010-UPDATE.
070400     REWRITE   IX-FS2R1-F-G-240.
070500 RWRT-TEST-GF-01-2.
070600     IF        IX-FS2-STATUS NOT EQUAL TO "00"
070700              ADD 1 TO WRK-CS-09V00-016.
070800     MOVE    SPACE  TO   IX-FS2-STATUS.
070900     GO TO    RWRT-TEST-GF-01.
071000 RWRT-TEST-GF-01-1.
071100     MOVE "REWRITE ERR/EXCEPTIO" TO FEATURE.
071200     MOVE "RWRT-TEST-GF-01" TO PAR-NAME.
071300     IF       WRK-CS-09V00-013 NOT EQUAL TO 1
071400              MOVE "IX-33; EXCEPTIONS/ERRORS" TO RE-MARK
071500              MOVE WRK-CS-09V00-013 TO COMPUTED-18V0
071600              MOVE  1 TO CORRECT-18V0
071700              PERFORM FAIL
071800              ELSE
071900              PERFORM PASS.
072000     PERFORM  PRINT-DETAIL.
072100 RWRT-TEST-GF-02.
072200     MOVE "REWRITE ERR/EXCEPTIO" TO FEATURE.
072300     MOVE "RWRT-TEST-GF-02" TO PAR-NAME.
072400     IF       WRK-CS-09V00-014 NOT EQUAL TO 501
072500              MOVE "IX-33;INCORRECT COUNT" TO RE-MARK
072600              MOVE WRK-CS-09V00-014 TO COMPUTED-18V0
072700              MOVE 501 TO CORRECT-18V0
072800              PERFORM FAIL
072900              ELSE
073000              PERFORM PASS.
073100     PERFORM  PRINT-DETAIL.
073200 RWRT-TEST-GF-03.
073300     MOVE "OPEN STATUS EXP:  00" TO FEATURE.
073400     MOVE "RWRT-TEST-GF-03" TO PAR-NAME.
073500     IF       WRK-XN-0002-001 NOT EQUAL TO "00"
073600            MOVE "IX-3; 1.3.4 (1) A; STATUS AFTER OPEN" TO RE-MARK
073700              MOVE WRK-XN-0002-001 TO COMPUTED-A
073800              MOVE  "00" TO CORRECT-A
073900              PERFORM FAIL
074000              ELSE
074100              PERFORM PASS.
074200     PERFORM  PRINT-DETAIL.
074300 RWRT-TEST-GF-04.
074400     MOVE "AT END STATUS EXP:10" TO FEATURE.
074500     MOVE "RWRT-TEST-GF-04" TO PAR-NAME.
074600     IF        IX-FS2-STATUS NOT EQUAL  TO "10"
074700            MOVE "IX-4; 1.3.4 (2) A; STATUS AT END    " TO RE-MARK
074800              MOVE  IX-FS2-STATUS TO COMPUTED-A
074900              MOVE "10" TO CORRECT-A
075000              PERFORM FAIL
075100              ELSE
075200              PERFORM PASS.
075300     PERFORM  PRINT-DETAIL.
075400 RWRT-TEST-GF-05.
075500     MOVE "REWRITE ERR/EXCEPTIO" TO FEATURE.
075600     MOVE "RWRT-TEST-GF-05" TO PAR-NAME.
075700     IF       WRK-XN-0002-002 NOT EQUAL TO "10"
075800            MOVE "IX-4; 1.3.4 (2) A; STATUS AFTER  END" TO RE-MARK
075900              MOVE  "EXCEPTIN/STATUS" TO RE-MARK
076000              MOVE  WRK-XN-0002-002 TO COMPUTED-A
076100              MOVE  "10" TO CORRECT-A
076200              PERFORM FAIL
076300              ELSE
076400              PERFORM PASS.
076500     PERFORM  PRINT-DETAIL.
076600 RWRT-TEST-GF-06.
076700     MOVE "REWRITE ERR/EXCEPTIO" TO FEATURE.
076800     MOVE "RWRT-TEST-GF-06" TO PAR-NAME.
076900     IF       WRK-XN-0002-003 NOT EQUAL TO "10"
077000            MOVE "IX-4; 1.3.4 (2) A; NO/ EXCEPTION    " TO RE-MARK
077100              MOVE WRK-XN-0002-003 TO COMPUTED-A
077200              MOVE "10" TO CORRECT-A
077300              PERFORM FAIL
077400              ELSE
077500              PERFORM PASS.
077600     PERFORM  PRINT-DETAIL.
077700 RWRT-TEST-GF-07.
077800     MOVE "CLOSE LOCK STAT:  00" TO FEATURE.
077900     MOVE "RWRT-TEST-GF-07" TO PAR-NAME.
078000     MOVE     SPACE TO IX-FS2-STATUS.
078100     CLOSE    IX-FS2      LOCK.
078200     IF        IX-FS2-STATUS NOT EQUAL TO "00"
078300           MOVE "IX-3; 1.3.4 (1) A; STATUS AFTER CLOSE" TO RE-MARK
078400              MOVE  IX-FS2-STATUS TO  COMPUTED-A
078500              MOVE "00" TO CORRECT-A
078600              PERFORM FAIL
078700              ELSE
078800              PERFORM PASS.
078900     PERFORM  PRINT-DETAIL.
079000 CCVS-EXIT SECTION.
079100 CCVS-999999.
079200     GO TO CLOSE-FILES.
