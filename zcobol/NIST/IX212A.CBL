000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IX212A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*                                                              *
002200*    THIS IS IX212A.
002300*    THIS  PROGRAM  CREATES  A  100  RECORD FIXED LENGTH INDEXED
002400*    FILE  WHOSE  ACCESS  IS  DYNAMIC  AND CONTAINS 10 ALTERNATE
002500*    KEYS. THE INDEXED FILE IS MANIPULATED BY THE ALTERNATE KEYS
002600*    USING THE FOLLOWING VERBS:
002700*         . DELETE
002800*         . READ ... NEXT RECORD
002900*         . READ ... RECORD KEY
003000*         . REWRITE
003100*         . START
003200*
003300 ENVIRONMENT DIVISION.
003400 CONFIGURATION SECTION.
003500 SOURCE-COMPUTER.
003600     XXXXX082.
003700 OBJECT-COMPUTER.
003800     XXXXX083.
003900 INPUT-OUTPUT SECTION.
004000 FILE-CONTROL.
004100P    SELECT RAW-DATA   ASSIGN TO
004200P    XXXXX062
004300P           ORGANIZATION IS INDEXED
004400P           ACCESS MODE IS RANDOM
004500P           RECORD KEY IS RAW-DATA-KEY.
004600     SELECT PRINT-FILE ASSIGN TO
004700     XXXXX055.
004800     SELECT IX-FS1
004900     ASSIGN TO
005000     XXXXX024
005100J    XXXXX044
005200     ACCESS MODE IS DYNAMIC
005300     RECORD KEY IS IX-FS1-KEY
005400     ALTERNATE RECORD KEY IS IX-FS1-ALT01
005500     ALTERNATE RECORD KEY IS IX-FS1-ALT02
005600     ALTERNATE RECORD KEY IS IX-FS1-ALT03
005700     ALTERNATE RECORD KEY IS IX-FS1-ALT04
005800     ALTERNATE RECORD KEY IS IX-FS1-ALT05
005900     ALTERNATE RECORD KEY IS IX-FS1-ALT06
006000     ALTERNATE RECORD KEY IS IX-FS1-ALT07
006100     ALTERNATE RECORD KEY IS IX-FS1-ALT08
006200     ALTERNATE RECORD KEY IS IX-FS1-ALT09
006300     ALTERNATE RECORD KEY IS IX-FS1-ALT10
006400     ORGANIZATION IS INDEXED.
006500 DATA DIVISION.
006600 FILE SECTION.
006700P
006800PFD  RAW-DATA.
006900P
007000P01  RAW-DATA-SATZ.
007100P    05  RAW-DATA-KEY        PIC X(6).
007200P    05  C-DATE              PIC 9(6).
007300P    05  C-TIME              PIC 9(8).
007400P    05  C-NO-OF-TESTS       PIC 99.
007500P    05  C-OK                PIC 999.
007600P    05  C-ALL               PIC 999.
007700P    05  C-FAIL              PIC 999.
007800P    05  C-DELETED           PIC 999.
007900P    05  C-INSPECT           PIC 999.
008000P    05  C-NOTE              PIC X(13).
008100P    05  C-INDENT            PIC X.
008200P    05  C-ABORT             PIC X(8).
008300 FD  PRINT-FILE.
008400 01  PRINT-REC PICTURE X(120).
008500 01  DUMMY-RECORD PICTURE X(120).
008600 FD  IX-FS1
008700C    LABEL RECORDS ARE STANDARD
008800C    DATA RECORD IS IX-FS1-RECORD
008900     RECORD CONTAINS 116 CHARACTERS.
009000 01  IX-FS1-RECORD.
009100     02 IX-FS1-KEY               PIC X(6).
009200     02 IX-FS1-ALT01             PIC X(11).
009300     02 IX-FS1-ALT02             PIC X(11).
009400     02 IX-FS1-ALT03             PIC X(11).
009500     02 IX-FS1-ALT04             PIC X(11).
009600     02 IX-FS1-ALT05             PIC X(11).
009700     02 IX-FS1-ALT06             PIC X(11).
009800     02 IX-FS1-ALT07             PIC X(11).
009900     02 IX-FS1-ALT08             PIC X(11).
010000     02 IX-FS1-ALT09             PIC X(11).
010100     02 IX-FS1-ALT10             PIC X(11).
010200 WORKING-STORAGE SECTION.
010300 01  RECORD-COUNTER              PIC 999    VALUE ZEROS.
010400 01  INVKEY-COUNTER              PIC 999    VALUE ZEROS.
010500 01  WORK-RECORD.
010600     02 FILLER                   PIC XXX    VALUE "AAA".
010700     02 COUNTER00                PIC 999.
010800     02 FILLER                   PIC XXX    VALUE "CCC".
010900     02 COUNTER01                PIC 999.
011000     02 FILLER                   PIC X(5)   VALUE "ALT01".
011100     02 FILLER                   PIC XXX    VALUE "EEE".
011200     02 COUNTER02                PIC 999.
011300     02 FILLER                   PIC X(5)   VALUE "ALT02".
011400     02 FILLER                   PIC XXX    VALUE "GGG".
011500     02 COUNTER03                PIC 999.
011600     02 FILLER                   PIC X(5)   VALUE "ALT03".
011700     02 FILLER                   PIC XXX    VALUE "III".
011800     02 COUNTER04                PIC 999.
011900     02 FILLER                   PIC X(5)   VALUE "ALT04".
012000     02 FILLER                   PIC XXX    VALUE "KKK".
012100     02 COUNTER05                PIC 999.
012200     02 FILLER                   PIC X(5)   VALUE "ALT05".
012300     02 FILLER                   PIC XXX    VALUE "MMM".
012400     02 COUNTER06                PIC 999.
012500     02 FILLER                   PIC X(5)   VALUE "ALT06".
012600     02 FILLER                   PIC XXX    VALUE "OOO".
012700     02 COUNTER07                PIC 999.
012800     02 FILLER                   PIC X(5)   VALUE "ALT07".
012900     02 FILLER                   PIC XXX    VALUE "QQQ".
013000     02 COUNTER08                PIC 999.
013100     02 FILLER                   PIC X(5)   VALUE "ALT08".
013200     02 FILLER                   PIC XXX    VALUE "SSS".
013300     02 COUNTER09                PIC 999.
013400     02 FILLER                   PIC X(5)   VALUE "ALT09".
013500     02 FILLER                   PIC XXX    VALUE "UUU".
013600     02 COUNTER10                PIC 999.
013700     02 FILLER                   PIC X(5)   VALUE "ALT10".
013800 01  TEST-RESULTS.
013900     02 FILLER                   PIC X      VALUE SPACE.
014000     02 FEATURE                  PIC X(20)  VALUE SPACE.
014100     02 FILLER                   PIC X      VALUE SPACE.
014200     02 P-OR-F                   PIC X(5)   VALUE SPACE.
014300     02 FILLER                   PIC X      VALUE SPACE.
014400     02  PAR-NAME.
014500       03 FILLER                 PIC X(19)  VALUE SPACE.
014600       03  PARDOT-X              PIC X      VALUE SPACE.
014700       03 DOTVALUE               PIC 99     VALUE ZERO.
014800     02 FILLER                   PIC X(8)   VALUE SPACE.
014900     02 RE-MARK                  PIC X(61).
015000 01  TEST-COMPUTED.
015100     02 FILLER                   PIC X(30)  VALUE SPACE.
015200     02 FILLER                   PIC X(17)  VALUE
015300            "       COMPUTED=".
015400     02 COMPUTED-X.
015500     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
015600     03 COMPUTED-N               REDEFINES COMPUTED-A
015700                                 PIC -9(9).9(9).
015800     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
015900     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
016000     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
016100     03       CM-18V0 REDEFINES COMPUTED-A.
016200         04 COMPUTED-18V0                    PIC -9(18).
016300         04 FILLER                           PIC X.
016400     03 FILLER PIC X(50) VALUE SPACE.
016500 01  TEST-CORRECT.
016600     02 FILLER PIC X(30) VALUE SPACE.
016700     02 FILLER PIC X(17) VALUE "       CORRECT =".
016800     02 CORRECT-X.
016900     03 CORRECT-A                  PIC X(20) VALUE SPACE.
017000     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
017100     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
017200     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
017300     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
017400     03      CR-18V0 REDEFINES CORRECT-A.
017500         04 CORRECT-18V0                     PIC -9(18).
017600         04 FILLER                           PIC X.
017700     03 FILLER PIC X(2) VALUE SPACE.
017800     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
017900 01  CCVS-C-1.
018000     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
018100-    "SS  PARAGRAPH-NAME
018200-    "       REMARKS".
018300     02 FILLER                     PIC X(20)    VALUE SPACE.
018400 01  CCVS-C-2.
018500     02 FILLER                     PIC X        VALUE SPACE.
018600     02 FILLER                     PIC X(6)     VALUE "TESTED".
018700     02 FILLER                     PIC X(15)    VALUE SPACE.
018800     02 FILLER                     PIC X(4)     VALUE "FAIL".
018900     02 FILLER                     PIC X(94)    VALUE SPACE.
019000 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
019100 01  REC-CT                        PIC 99       VALUE ZERO.
019200 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
019300 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
019400 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
019500 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
019600 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
019700 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
019800 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
019900 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
020000 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
020100 01  CCVS-H-1.
020200     02  FILLER                    PIC X(39)    VALUE SPACES.
020300     02  FILLER                    PIC X(42)    VALUE
020400     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
020500     02  FILLER                    PIC X(39)    VALUE SPACES.
020600 01  CCVS-H-2A.
020700   02  FILLER                        PIC X(40)  VALUE SPACE.
020800   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
020900   02  FILLER                        PIC XXXX   VALUE
021000     "4.2 ".
021100   02  FILLER                        PIC X(28)  VALUE
021200            " COPY - NOT FOR DISTRIBUTION".
021300   02  FILLER                        PIC X(41)  VALUE SPACE.
021400
021500 01  CCVS-H-2B.
021600   02  FILLER                        PIC X(15)  VALUE
021700            "TEST RESULT OF ".
021800   02  TEST-ID                       PIC X(9).
021900   02  FILLER                        PIC X(4)   VALUE
022000            " IN ".
022100   02  FILLER                        PIC X(12)  VALUE
022200     " HIGH       ".
022300   02  FILLER                        PIC X(22)  VALUE
022400            " LEVEL VALIDATION FOR ".
022500   02  FILLER                        PIC X(58)  VALUE
022600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
022700 01  CCVS-H-3.
022800     02  FILLER                      PIC X(34)  VALUE
022900            " FOR OFFICIAL USE ONLY    ".
023000     02  FILLER                      PIC X(58)  VALUE
023100     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
023200     02  FILLER                      PIC X(28)  VALUE
023300            "  COPYRIGHT   1985 ".
023400 01  CCVS-E-1.
023500     02 FILLER                       PIC X(52)  VALUE SPACE.
023600     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
023700     02 ID-AGAIN                     PIC X(9).
023800     02 FILLER                       PIC X(45)  VALUE SPACES.
023900 01  CCVS-E-2.
024000     02  FILLER                      PIC X(31)  VALUE SPACE.
024100     02  FILLER                      PIC X(21)  VALUE SPACE.
024200     02 CCVS-E-2-2.
024300         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
024400         03 FILLER                   PIC X      VALUE SPACE.
024500         03 ENDER-DESC               PIC X(44)  VALUE
024600            "ERRORS ENCOUNTERED".
024700 01  CCVS-E-3.
024800     02  FILLER                      PIC X(22)  VALUE
024900            " FOR OFFICIAL USE ONLY".
025000     02  FILLER                      PIC X(12)  VALUE SPACE.
025100     02  FILLER                      PIC X(58)  VALUE
025200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025300     02  FILLER                      PIC X(13)  VALUE SPACE.
025400     02 FILLER                       PIC X(15)  VALUE
025500             " COPYRIGHT 1985".
025600 01  CCVS-E-4.
025700     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
025800     02 FILLER                       PIC X(4)   VALUE " OF ".
025900     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
026000     02 FILLER                       PIC X(40)  VALUE
026100      "  TESTS WERE EXECUTED SUCCESSFULLY".
026200 01  XXINFO.
026300     02 FILLER                       PIC X(19)  VALUE
026400            "*** INFORMATION ***".
026500     02 INFO-TEXT.
026600       04 FILLER                     PIC X(8)   VALUE SPACE.
026700       04 XXCOMPUTED                 PIC X(20).
026800       04 FILLER                     PIC X(5)   VALUE SPACE.
026900       04 XXCORRECT                  PIC X(20).
027000     02 INF-ANSI-REFERENCE           PIC X(48).
027100 01  HYPHEN-LINE.
027200     02 FILLER  PIC IS X VALUE IS SPACE.
027300     02 FILLER  PIC IS X(65)    VALUE IS "************************
027400-    "*****************************************".
027500     02 FILLER  PIC IS X(54)    VALUE IS "************************
027600-    "******************************".
027700 01  CCVS-PGM-ID                     PIC X(9)   VALUE
027800     "IX212A".
027900 PROCEDURE DIVISION.
028000 CCVS1 SECTION.
028100 OPEN-FILES.
028200P    OPEN I-O RAW-DATA.
028300P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
028400P    READ RAW-DATA INVALID KEY GO TO END-E-1.
028500P    MOVE "ABORTED " TO C-ABORT.
028600P    ADD 1 TO C-NO-OF-TESTS.
028700P    ACCEPT C-DATE  FROM DATE.
028800P    ACCEPT C-TIME  FROM TIME.
028900P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
029000PEND-E-1.
029100P    CLOSE RAW-DATA.
029200     OPEN    OUTPUT PRINT-FILE.
029300     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
029400     MOVE    SPACE TO TEST-RESULTS.
029500     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
029600     GO TO CCVS1-EXIT.
029700 CLOSE-FILES.
029800P    OPEN I-O RAW-DATA.
029900P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
030000P    READ RAW-DATA INVALID KEY GO TO END-E-2.
030100P    MOVE "OK.     " TO C-ABORT.
030200P    MOVE PASS-COUNTER TO C-OK.
030300P    MOVE ERROR-HOLD   TO C-ALL.
030400P    MOVE ERROR-COUNTER TO C-FAIL.
030500P    MOVE DELETE-COUNTER TO C-DELETED.
030600P    MOVE INSPECT-COUNTER TO C-INSPECT.
030700P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
030800PEND-E-2.
030900P    CLOSE RAW-DATA.
031000     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
031100 TERMINATE-CCVS.
031200S    EXIT PROGRAM.
031300STERMINATE-CALL.
031400     STOP     RUN.
031500 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
031600 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
031700 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
031800 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
031900     MOVE "****TEST DELETED****" TO RE-MARK.
032000 PRINT-DETAIL.
032100     IF REC-CT NOT EQUAL TO ZERO
032200             MOVE "." TO PARDOT-X
032300             MOVE REC-CT TO DOTVALUE.
032400     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
032500     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
032600        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
032700          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
032800     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
032900     MOVE SPACE TO CORRECT-X.
033000     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
033100     MOVE     SPACE TO RE-MARK.
033200 HEAD-ROUTINE.
033300     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033400     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033500     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
033600     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
033700 COLUMN-NAMES-ROUTINE.
033800     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033900     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
034100 END-ROUTINE.
034200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
034300 END-RTN-EXIT.
034400     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034500 END-ROUTINE-1.
034600      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
034700      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
034800      ADD PASS-COUNTER TO ERROR-HOLD.
034900*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
035000      MOVE PASS-COUNTER TO CCVS-E-4-1.
035100      MOVE ERROR-HOLD TO CCVS-E-4-2.
035200      MOVE CCVS-E-4 TO CCVS-E-2-2.
035300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
035400  END-ROUTINE-12.
035500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
035600     IF       ERROR-COUNTER IS EQUAL TO ZERO
035700         MOVE "NO " TO ERROR-TOTAL
035800         ELSE
035900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
036000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
036100     PERFORM WRITE-LINE.
036200 END-ROUTINE-13.
036300     IF DELETE-COUNTER IS EQUAL TO ZERO
036400         MOVE "NO " TO ERROR-TOTAL  ELSE
036500         MOVE DELETE-COUNTER TO ERROR-TOTAL.
036600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
036700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036800      IF   INSPECT-COUNTER EQUAL TO ZERO
036900          MOVE "NO " TO ERROR-TOTAL
037000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
037100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
037200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037400 WRITE-LINE.
037500     ADD 1 TO RECORD-COUNT.
037600Y    IF RECORD-COUNT GREATER 42
037700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
037800Y        MOVE SPACE TO DUMMY-RECORD
037900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
038000Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
038100Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
038200Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
038300Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
038400Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
038500Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
038600Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
038700Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
038800Y        MOVE ZERO TO RECORD-COUNT.
038900     PERFORM WRT-LN.
039000 WRT-LN.
039100     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
039200     MOVE SPACE TO DUMMY-RECORD.
039300 BLANK-LINE-PRINT.
039400     PERFORM WRT-LN.
039500 FAIL-ROUTINE.
039600     IF     COMPUTED-X NOT EQUAL TO SPACE
039700            GO TO   FAIL-ROUTINE-WRITE.
039800     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
039900     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
040000     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
040100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040200     MOVE   SPACES TO INF-ANSI-REFERENCE.
040300     GO TO  FAIL-ROUTINE-EX.
040400 FAIL-ROUTINE-WRITE.
040500     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
040600     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
040700     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
040800     MOVE   SPACES TO COR-ANSI-REFERENCE.
040900 FAIL-ROUTINE-EX. EXIT.
041000 BAIL-OUT.
041100     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
041200     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
041300 BAIL-OUT-WRITE.
041400     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
041500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
041600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041700     MOVE   SPACES TO INF-ANSI-REFERENCE.
041800 BAIL-OUT-EX. EXIT.
041900 CCVS1-EXIT.
042000     EXIT.
042100 WRITE-INIT-GF-01.
042200     OPEN OUTPUT IX-FS1.
042300     PERFORM CREATE-IX-FS1 VARYING RECORD-COUNTER FROM 1 BY 1
042400        UNTIL RECORD-COUNTER IS GREATER THAN 100.
042500     GO TO WRITE-TEST-GF-01.
042600 CREATE-IX-FS1.
042700     MOVE RECORD-COUNTER TO COUNTER00, COUNTER01, COUNTER02,
042800        COUNTER03, COUNTER04, COUNTER05, COUNTER06, COUNTER07,
042900        COUNTER08, COUNTER09, COUNTER10.
043000     WRITE IX-FS1-RECORD FROM WORK-RECORD INVALID KEY
043100        ADD 1 TO INVKEY-COUNTER.
043200 WRITE-TEST-GF-01.
043300     MOVE "WRITE INVALID KEY" TO FEATURE.
043400     MOVE "WRITE-TEST-GF-01" TO PAR-NAME.
043500     MOVE "CREATE IX-FS1" TO RE-MARK.
043600     IF INVKEY-COUNTER = 0
043700        PERFORM PASS
043800        ELSE GO TO WRITE-FAIL-GF-01.
043900     GO TO WRITE-WRITE-GF-01.
044000 WRITE-DELETE-GF-01.
044100     PERFORM DE-LETE.
044200     GO TO WRITE-WRITE-GF-01.
044300 WRITE-FAIL-GF-01.
044400     MOVE "IX-41; ONE WRITE FAILED AT LEAST" TO RE-MARK.
044500     PERFORM FAIL.
044600     MOVE INVKEY-COUNTER TO COMPUTED-18V0.
044700     MOVE 0 TO CORRECT-18V0.
044800 WRITE-WRITE-GF-01.
044900     PERFORM PRINT-DETAIL.
045000 READ-TEST-F2-01.
045100     CLOSE IX-FS1.
045200     OPEN I-O IX-FS1.
045300     MOVE "READ...RECORD KEY" TO FEATURE.
045400     MOVE "READ-TEST-F2-01" TO PAR-NAME.
045500     MOVE "RETRIEVED BY ALTERNATE KEY 1" TO RE-MARK.
045600     MOVE "CCC012ALT01" TO IX-FS1-ALT01.
045700     READ IX-FS1 RECORD
045800                      KEY IS IX-FS1-ALT01
045900      INVALID KEY   GO TO READ-INVALID-F2-01.
046000     IF IX-FS1-KEY = "AAA012"
046100        PERFORM PASS
046200        ELSE GO TO READ-FAIL-F2-01.
046300     GO TO READ-WRITE-F2-01.
046400 READ-DELETE-F2-01.
046500     PERFORM DE-LETE.
046600     GO TO READ-WRITE-F2-01.
046700 READ-INVALID-F2-01.
046800     PERFORM FAIL.
046900     MOVE "IX-28; INVALID KEY CONDITION (IX-6) EXISTS" TO RE-MARK.
047000     MOVE "INVALID KEY" TO COMPUTED-A.
047100     MOVE "CCC012ALT01" TO CORRECT-A.
047200     GO TO READ-WRITE-F2-01.
047300 READ-FAIL-F2-01.
047400     MOVE "IX-28; RETRIEVED BY ALTERENATE KEY 1" TO RE-MARK.
047500     PERFORM FAIL.
047600     MOVE IX-FS1-KEY TO COMPUTED-A.
047700     MOVE "AAA012" TO CORRECT-A.
047800 READ-WRITE-F2-01.
047900     PERFORM PRINT-DETAIL.
048000 READ-TEST-F2-02.
048100     MOVE "READ...RECORD KEY" TO FEATURE.
048200     MOVE "READ-TEST-F2-02" TO PAR-NAME.
048300     MOVE "RETRIEVED BY ALTERNATE KEY 8" TO RE-MARK.
048400     MOVE "QQQ043ALT08" TO IX-FS1-ALT08.
048500     READ IX-FS1 RECORD
048600                      KEY IS IX-FS1-ALT08
048700       INVALID KEY  GO TO READ-INVALID-F2-02.
048800     IF IX-FS1-KEY = "AAA043"
048900        PERFORM PASS
049000        ELSE GO TO READ-FAIL-F2-02.
049100     GO TO READ-WRITE-F2-02.
049200 READ-DELETE-F2-02.
049300     PERFORM DE-LETE.
049400     GO TO READ-WRITE-F2-02.
049500 READ-INVALID-F2-02.
049600     PERFORM FAIL.
049700     MOVE "IX-28; 4.5.2 F2, INVALID KEY CONDITION (IX-6) "
049800          TO RE-MARK.
049900     MOVE "QQQ043ALT08" TO CORRECT-A.
050000     GO TO READ-WRITE-F2-02.
050100 READ-FAIL-F2-02.
050200     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
050300     PERFORM FAIL.
050400     MOVE IX-FS1-KEY TO COMPUTED-A.
050500     MOVE "AAA043" TO CORRECT-A.
050600 READ-WRITE-F2-02.
050700     PERFORM PRINT-DETAIL.
050800 DELETE-TEST-GF-01.
050900     MOVE "DELETE...RECORD" TO FEATURE.
051000     MOVE "DELETE-TEST-GF-01" TO PAR-NAME.
051100     MOVE "DELETES RECORD FOUND IN READ-TEST-F2-02" TO RE-MARK.
051200     DELETE IX-FS1 RECORD INVALID KEY GO TO DELETE-INVALID-GF-01.
051300     PERFORM PASS.
051400     GO TO DELETE-WRITE-GF-01.
051500 DELETE-DELETE-GF-01.
051600     PERFORM DE-LETE.
051700     GO TO DELETE-WRITE-GF-01.
051800 DELETE-INVALID-GF-01.
051900     MOVE "IX-21; 4.3.2 F2, INVALID KEY CONDITION (IX-6) "
052000         TO RE-MARK.
052100     PERFORM FAIL.
052200     MOVE "INVALID KEY" TO COMPUTED-A.
052300     MOVE "AAA043" TO CORRECT-A.
052400 DELETE-WRITE-GF-01.
052500     PERFORM PRINT-DETAIL.
052600 READ-TEST-F2-03.
052700     MOVE "READ...RECORD KEY" TO FEATURE.
052800     MOVE "READ-TEST-F2-03" TO PAR-NAME.
052900     MOVE "RETRIEVED BY ALTERNATE KEY 4" TO RE-MARK.
053000     MOVE "III017ALT04" TO IX-FS1-ALT04.
053100     READ IX-FS1 RECORD
053200                      KEY IS IX-FS1-ALT04
053300      INVALID KEY   GO TO READ-INVALID-F2-03.
053400     IF IX-FS1-KEY = "AAA017"
053500        PERFORM PASS
053600        ELSE GO TO READ-FAIL-F2-03.
053700     GO TO READ-WRITE-F2-03.
053800 READ-DELETE-F2-03.
053900     PERFORM DE-LETE.
054000     GO TO READ-WRITE-F2-03.
054100 READ-INVALID-F2-03.
054200     MOVE "IX-28; 4.5.2 F2, INVALID KEY CONDITION (IX-6) "
054300         TO RE-MARK.
054400     PERFORM FAIL.
054500     MOVE "INVALID KEY" TO COMPUTED-A.
054600     MOVE "III017ALT04" TO CORRECT-A.
054700     GO TO READ-WRITE-F2-03.
054800 READ-FAIL-F2-03.
054900     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
055000     PERFORM FAIL.
055100     MOVE IX-FS1-KEY TO COMPUTED-A.
055200     MOVE "AAA017" TO CORRECT-A.
055300 READ-WRITE-F2-03.
055400     PERFORM PRINT-DETAIL.
055500 REWRITE-TEST-GF-01.
055600     MOVE "REWRITE...INVALID..." TO FEATURE.
055700     MOVE "REWRITE-TEST-GF-01" TO PAR-NAME.
055800     MOVE "REWRITES RECORD FOUND IN READ-TEST-F2-03" TO RE-MARK.
055900     MOVE "III917ALT04" TO IX-FS1-ALT04.
056000     REWRITE IX-FS1-RECORD INVALID KEY
056100                  GO TO REWRITE-INVALID-GF-01.
056200     PERFORM PASS.
056300     GO TO REWRITE-WRITE-GF-01.
056400 REWRITE-DELETE-GF-01.
056500     PERFORM DE-LETE.
056600     GO TO REWRITE-WRITE-GF-01.
056700 REWRITE-INVALID-GF-01.
056800     MOVE "IX-33; 4.6.2, INVALID KEY CONDITION (IX-6) " TO RE-MARK
056900     PERFORM FAIL.
057000     MOVE "INVALID KEY" TO COMPUTED-A.
057100     MOVE "III917ALT04" TO CORRECT-A.
057200 REWRITE-WRITE-GF-01.
057300     PERFORM PRINT-DETAIL.
057400 READ-TEST-F2-04.
057500     MOVE "READ...RECORD KEY" TO FEATURE.
057600     MOVE "READ-TEST-F2-04" TO PAR-NAME.
057700     MOVE "INVALID KEY PATH SHOULD BE TAKEN" TO RE-MARK.
057800     MOVE "ZZZ999ALT09" TO IX-FS1-ALT09.
057900     READ IX-FS1 RECORD
058000                      KEY IS IX-FS1-ALT09
058100      INVALID KEY   PERFORM PASS
058200        GO TO READ-WRITE-F2-04.
058300     GO TO READ-FAIL-F2-04.
058400 READ-DELETE-F2-04.
058500     PERFORM DE-LETE.
058600     GO TO READ-WRITE-F2-04.
058700 READ-FAIL-F2-04.
058800     MOVE "IX-28; 4.5.2 F2, INVALID KEY NOT TAKEN (IX-6)"
058900          TO RE-MARK.
059000     PERFORM FAIL.
059100     MOVE IX-FS1-KEY TO COMPUTED-A.
059200     MOVE "INVALID KEY" TO CORRECT-A.
059300 READ-WRITE-F2-04.
059400     PERFORM PRINT-DETAIL.
059500 START-TEST-GF-01.
059600     MOVE "START...KEY IS EQUAL"    TO FEATURE.
059700     MOVE "START-TEST-GF-01" TO PAR-NAME.
059800     MOVE "RETRIEVED BY ALTERNATE KEY 3" TO RE-MARK.
059900     MOVE "GGG058ALT03" TO IX-FS1-ALT03.
060000     START IX-FS1
060100                KEY IS EQUAL TO IX-FS1-ALT03
060200        INVALID KEY  GO TO START-INVALID-GF-01.
060300     READ IX-FS1 NEXT RECORD AT END GO TO START-END-GF-01.
060400     IF IX-FS1-KEY = "AAA058"
060500        PERFORM PASS
060600        ELSE GO TO START-FAIL-GF-01.
060700     GO TO START-WRITE-GF-01.
060800 START-DELETE-GF-01.
060900     PERFORM DE-LETE.
061000     GO TO START-WRITE-GF-01.
061100 START-INVALID-GF-01.
061200     MOVE "IX-36; 4.7.2, INVALID KEY CONDITION (IX-6)" TO RE-MARK.
061300     PERFORM FAIL.
061400     MOVE "INVALID KEY" TO COMPUTED-A.
061500     MOVE "GGG058ALT03" TO CORRECT-A.
061600     GO TO START-WRITE-GF-01.
061700 START-END-GF-01.
061800     MOVE "IX-28; 4.5.2 F1, AT END CONDITION     " TO RE-MARK.
061900     PERFORM FAIL.
062000     MOVE "FILE IS AT END" TO COMPUTED-A.
062100     MOVE "AAA058" TO CORRECT-A.
062200     GO TO START-WRITE-GF-01.
062300 START-FAIL-GF-01.
062400     MOVE "IX-28; 4.5.2 F1, WRONG KEY OR IX-36 WRONG START  "
062500           TO RE-MARK.
062600     PERFORM FAIL.
062700     MOVE IX-FS1-KEY TO COMPUTED-A.
062800     MOVE "AAA058" TO CORRECT-A.
062900 START-WRITE-GF-01.
063000     PERFORM PRINT-DETAIL.
063100 START-TEST-GF-02.
063200     MOVE "START...KEY >" TO FEATURE.
063300     MOVE "START-TEST-GF-02" TO PAR-NAME.
063400     MOVE "RETRIEVED BY ALTERNATE KEY 6" TO RE-MARK.
063500     MOVE "MMM089ALT06" TO IX-FS1-ALT06.
063600     START IX-FS1
063700                KEY > IX-FS1-ALT06
063800        INVALID KEY GO TO START-INVALID-GF-02.
063900     READ IX-FS1 NEXT RECORD AT END GO TO START-END-GF-02.
064000     IF IX-FS1-KEY = "AAA090"
064100        PERFORM PASS
064200        ELSE GO TO START-FAIL-GF-02.
064300     GO TO START-WRITE-GF-02.
064400 START-DELETE-GF-02.
064500     PERFORM DE-LETE.
064600     GO TO START-WRITE-GF-02.
064700 START-INVALID-GF-02.
064800     MOVE "IX-36; 4.7.2, INVALID KEY CONDITION (IX-6)" TO RE-MARK.
064900     PERFORM FAIL.
065000     MOVE "INVALID KEY" TO COMPUTED-A.
065100     MOVE "MMM089ALT09" TO CORRECT-A.
065200     GO TO START-WRITE-GF-02.
065300 START-END-GF-02.
065400     MOVE "IX-28; 4.5.2 F1, AT END CONDITION (IX-6)" TO RE-MARK.
065500     PERFORM FAIL.
065600     MOVE "FILE IS AT END" TO COMPUTED-A.
065700     MOVE "AAA090" TO CORRECT-A.
065800     GO TO START-WRITE-GF-02.
065900 START-FAIL-GF-02.
066000     MOVE "IX-28; 4.5.2 F1, AT END OR IX-36 START WRONG KEY"
066100           TO RE-MARK.
066200     PERFORM FAIL.
066300     MOVE IX-FS1-KEY TO COMPUTED-A.
066400     MOVE "AAA090" TO CORRECT-A.
066500 START-WRITE-GF-02.
066600     PERFORM PRINT-DETAIL.
066700 START-TEST-GF-03.
066800     MOVE "START...KEY NOT <" TO FEATURE.
066900     MOVE "START-TEST-GF-03" TO PAR-NAME.
067000     MOVE "RETRIEVED BY ALTERNATE KEY 10" TO RE-MARK.
067100     MOVE "UUU002ALT10" TO IX-FS1-ALT10.
067200     START IX-FS1
067300                KEY NOT < IX-FS1-ALT10
067400      INVALID KEY   GO TO START-INVALID-GF-03.
067500     READ IX-FS1 NEXT RECORD
067600      AT END GO TO START-END-GF-03.
067700     IF IX-FS1-KEY = "AAA002"
067800        PERFORM PASS
067900        ELSE GO TO START-FAIL-GF-03.
068000     GO TO START-WRITE-GF-03.
068100 START-DELETE-GF-03.
068200     PERFORM DE-LETE.
068300     GO TO START-WRITE-GF-03.
068400 START-INVALID-GF-03.
068500     MOVE "IX-36; 4.7.2 F2, INVALID KEY CONDITION (IX-6)"
068600          TO RE-MARK.
068700     PERFORM FAIL.
068800     MOVE "INVALID KEY" TO COMPUTED-A.
068900     MOVE "UUU002ALT10" TO CORRECT-A.
069000     GO TO START-WRITE-GF-03.
069100 START-END-GF-03.
069200     MOVE "IX-28; 4.5.2 F1, AT END CONDITION (IX-6)" TO RE-MARK.
069300     PERFORM FAIL.
069400     MOVE "FILE IS AT END" TO COMPUTED-A.
069500     MOVE "AAA002" TO CORRECT-A.
069600     GO TO START-WRITE-GF-03.
069700 START-FAIL-GF-03.
069800     MOVE "IX-28; 4.5.2 F1, AT END OR IX-36 START WRONG KEY"
069900           TO RE-MARK.
070000     PERFORM FAIL.
070100     MOVE IX-FS1-KEY TO COMPUTED-A.
070200     MOVE "AAA002" TO CORRECT-A.
070300 START-WRITE-GF-03.
070400     PERFORM PRINT-DETAIL.
070500 START-TEST-GF-04.
070600     MOVE "START...KEY >=   " TO FEATURE.
070700     MOVE "START-TEST-GF-04" TO PAR-NAME.
070800     MOVE "RETRIEVED BY ALTERNATE KEY 10" TO RE-MARK.
070900     MOVE "UUU002ALT10" TO IX-FS1-ALT10.
071000     START IX-FS1
071100                KEY >=    IX-FS1-ALT10
071200      INVALID KEY   GO TO START-INVALID-GF-04.
071300     READ IX-FS1 NEXT RECORD
071400      AT END GO TO START-END-GF-04.
071500     IF IX-FS1-KEY = "AAA002"
071600        PERFORM PASS
071700        ELSE GO TO START-FAIL-GF-04.
071800     GO TO START-WRITE-GF-04.
071900 START-DELETE-GF-04.
072000     PERFORM DE-LETE.
072100     GO TO START-WRITE-GF-04.
072200 START-INVALID-GF-04.
072300     MOVE "IX-36; 4.7.2 F2, INVALID KEY CONDITION (IX-6)"
072400          TO RE-MARK.
072500     PERFORM FAIL.
072600     MOVE "INVALID KEY" TO COMPUTED-A.
072700     MOVE "UUU002ALT10" TO CORRECT-A.
072800     GO TO START-WRITE-GF-04.
072900 START-END-GF-04.
073000     MOVE "IX-28; 4.5.2 F1, AT END CONDITION (IX-6)" TO RE-MARK.
073100     PERFORM FAIL.
073200     MOVE "FILE IS AT END" TO COMPUTED-A.
073300     MOVE "AAA002" TO CORRECT-A.
073400     GO TO START-WRITE-GF-04.
073500 START-FAIL-GF-04.
073600     MOVE "IX-28; 4.5.2 F1, AT END OR IX-36 START WRONG KEY"
073700           TO RE-MARK.
073800     PERFORM FAIL.
073900     MOVE IX-FS1-KEY TO COMPUTED-A.
074000     MOVE "AAA002" TO CORRECT-A.
074100 START-WRITE-GF-04.
074200     PERFORM PRINT-DETAIL.
074300 READ-TEST-F2-05.
074400     MOVE "READ...RECORD KEY" TO FEATURE.
074500     MOVE "READ-TEST-F2-05"  TO PAR-NAME.
074600     MOVE "INVALID KEY PATH SHOULD BE TAKEN" TO RE-MARK.
074700     MOVE "QQQ043ALT08" TO IX-FS1-ALT08.
074800     READ IX-FS1 RECORD
074900                      KEY IS IX-FS1-ALT08
075000       INVALID KEY  PERFORM PASS
075100        GO TO READ-WRITE-F2-05.
075200     GO TO READ-FAIL-F2-05.
075300 READ-DELETE-F2-05.
075400     PERFORM DE-LETE.
075500     GO TO READ-WRITE-F2-05.
075600 READ-FAIL-F2-05.
075700     MOVE "IX-28; 4.5.2 F2, INVALID KEY PATH NOT TAKEN (IX-6) "
075800             TO RE-MARK.
075900     PERFORM FAIL.
076000     MOVE IX-FS1-KEY TO COMPUTED-A.
076100     MOVE "INVALID KEY" TO CORRECT-A.
076200 READ-WRITE-F2-05.
076300     PERFORM PRINT-DETAIL.
076400 READ-TEST-F2-06.
076500     MOVE "READ...RECORD KEY" TO FEATURE.
076600     MOVE "READ-TEST-F2-06" TO PAR-NAME.
076700     MOVE "RETRIEVED BY ALTERNATE KEY 4" TO RE-MARK.
076800     MOVE "III917ALT04" TO IX-FS1-ALT04.
076900     READ IX-FS1 RECORD
077000                      KEY IS IX-FS1-ALT04
077100      INVALID KEY   GO TO READ-INVALID-F2-06.
077200     IF IX-FS1-KEY = "AAA017"
077300        PERFORM PASS
077400        ELSE GO TO READ-FAIL-F2-06.
077500     GO TO READ-WRITE-F2-06.
077600 READ-DELETE-F2-06.
077700     PERFORM DE-LETE.
077800     GO TO READ-WRITE-F2-06.
077900 READ-INVALID-F2-06.
078000     MOVE "IX-28; 4.5.2 F2, INVALID KEY CONDITION (IX-6) "
078100           TO RE-MARK.
078200     PERFORM FAIL.
078300     MOVE "INVALID KEY" TO COMPUTED-A.
078400     MOVE "III917ALT04" TO CORRECT-A.
078500     GO TO READ-WRITE-F2-06.
078600 READ-FAIL-F2-06.
078700     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
078800     PERFORM FAIL.
078900     MOVE IX-FS1-KEY TO COMPUTED-A.
079000     MOVE "AAA017" TO CORRECT-A.
079100 READ-WRITE-F2-06.
079200     PERFORM PRINT-DETAIL.
079300 READ-TEST-F2-07.
079400     MOVE "READ...RECORD KEY" TO FEATURE.
079500     MOVE "READ-TEST-F2-07"  TO PAR-NAME.
079600     MOVE "RETRIEVED BY PRIMARY KEY" TO RE-MARK.
079700     MOVE "AAA018" TO IX-FS1-KEY.
079800     READ IX-FS1 RECORD
079900                      KEY IS IX-FS1-KEY
080000       INVALID KEY  GO TO READ-INVALID-F2-07.
080100     IF IX-FS1-KEY = "AAA018"
080200        PERFORM PASS
080300        ELSE GO TO READ-FAIL-F2-07.
080400     GO TO READ-WRITE-F2-07.
080500 READ-DELETE-F2-07.
080600     PERFORM DE-LETE.
080700     GO TO READ-WRITE-F2-07.
080800 READ-INVALID-F2-07.
080900     MOVE "IX-28; 4.5.2 F2, INVALID KEY CONDITION (IX-6) "
081000          TO RE-MARK.
081100     PERFORM FAIL.
081200     MOVE "INVALID KEY" TO COMPUTED-A.
081300     MOVE "AAA018" TO CORRECT-A.
081400     GO TO READ-WRITE-F2-07.
081500 READ-FAIL-F2-07.
081600     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
081700     PERFORM FAIL.
081800     MOVE IX-FS1-KEY TO COMPUTED-A.
081900     MOVE "AAA018" TO CORRECT-A.
082000 READ-WRITE-F2-07.
082100     PERFORM PRINT-DETAIL.
082200 DELETE-TEST-GF-02.
082300     MOVE "DELETE...RECORD" TO FEATURE.
082400     MOVE "DELETE-TEST-GF-02" TO PAR-NAME.
082500     MOVE "DELETES RECORD FOUND IN READ-TEST-F2-07" TO RE-MARK.
082600     DELETE IX-FS1 RECORD INVALID KEY GO TO DELETE-FAIL-GF-02.
082700     PERFORM PASS.
082800     GO TO DELETE-WRITE-GF-02.
082900 DELETE-DELETE-GF-02.
083000     PERFORM DE-LETE.
083100     GO TO DELETE-WRITE-GF-02.
083200 DELETE-FAIL-GF-02.
083300     MOVE "IX-21; 4.3.2 INVALID KEY PATH TAKEN (IX-6)" TO RE-MARK.
083400     PERFORM FAIL.
083500     MOVE "INVALID KEY" TO COMPUTED-A.
083600     MOVE "AAA018" TO CORRECT-A.
083700 DELETE-WRITE-GF-02.
083800     PERFORM PRINT-DETAIL.
083900 READ-TEST-F1-08.
084000     MOVE "READ...NEXT RECORD" TO FEATURE.
084100     MOVE "READ-TEST-F1-08"  TO PAR-NAME.
084200     MOVE "READS NEXT RECORD" TO RE-MARK.
084300     READ IX-FS1 NEXT RECORD AT END GO TO READ-END-F1-08.
084400     IF IX-FS1-KEY = "AAA019"
084500        PERFORM PASS
084600        ELSE GO TO READ-FAIL-F1-08.
084700     GO TO READ-WRITE-F1-08.
084800 READ-DELETE-F1-08.
084900     PERFORM DE-LETE.
085000     GO TO READ-WRITE-F1-08.
085100 READ-END-F1-08.
085200     MOVE "IX-28; 4.5.2 F1, AT END CONDITION TAKEN" TO RE-MARK.
085300     PERFORM FAIL.
085400     MOVE "FILE IS AT END" TO COMPUTED-A.
085500     MOVE "AAA019" TO CORRECT-A.
085600     GO TO READ-WRITE-F1-08.
085700 READ-FAIL-F1-08.
085800     MOVE "IX-28; 4.5.2 F1, WRONG KEY            " TO RE-MARK.
085900     PERFORM FAIL.
086000     MOVE IX-FS1-KEY TO COMPUTED-A.
086100     MOVE "AAA019" TO CORRECT-A.
086200 READ-WRITE-F1-08.
086300     PERFORM PRINT-DETAIL.
086400 REWRITE-TEST-GF-02.
086500     MOVE "REWRITE...INVALID..." TO FEATURE.
086600     MOVE "REWRITE-TEST-GF-02" TO PAR-NAME.
086700     MOVE "REWRITES RECORD FOUND IN READ-TEST-F1-08" TO RE-MARK.
086800     MOVE "SSSSSSALT09" TO IX-FS1-ALT09.
086900     REWRITE IX-FS1-RECORD INVALID KEY GO TO REWRITE-FAIL-GF-02.
087000     PERFORM PASS.
087100     GO TO REWRITE-WRITE-GF-02.
087200 REWRITE-DELETE-GF-02.
087300     PERFORM DE-LETE.
087400     GO TO REWRITE-WRITE-GF-02.
087500 REWRITE-FAIL-GF-02.
087600     MOVE "IX-33; 4.6.2 F2, INVALID KEY CONDITION (IX-6) "
087700           TO RE-MARK.
087800     PERFORM FAIL.
087900     MOVE "INVALID KEY" TO COMPUTED-A.
088000     MOVE "SSSSSSALT09" TO CORRECT-A.
088100 REWRITE-WRITE-GF-02.
088200     PERFORM PRINT-DETAIL.
088300 READ-TEST-F2-09.
088400     MOVE "READ...RECORD KEY" TO FEATURE.
088500     MOVE "READ-TEST-F2-09" TO PAR-NAME.
088600     MOVE "RETRIEVED BY ALTERNATE KEY 2" TO RE-MARK.
088700     MOVE "EEE075ALT02" TO IX-FS1-ALT02.
088800     READ IX-FS1 RECORD
088900                      KEY IS IX-FS1-ALT02
089000       INVALID KEY  GO TO READ-INVALID-F2-09.
089100     IF IX-FS1-KEY = "AAA075"
089200        PERFORM PASS
089300        ELSE GO TO READ-FAIL-F2-09.
089400     GO TO READ-WRITE-F2-09.
089500 READ-DELETE-F2-09.
089600     PERFORM DE-LETE.
089700     GO TO READ-WRITE-F2-09.
089800 READ-INVALID-F2-09.
089900     MOVE "IX-28; 4.5.2 F2, INVALID KEY CONDITION (IX-6) "
090000           TO RE-MARK.
090100     PERFORM FAIL.
090200     MOVE "INVALID KEY" TO COMPUTED-A.
090300     MOVE "EEE075ALT02" TO CORRECT-A.
090400     GO TO READ-WRITE-F2-09.
090500 READ-FAIL-F2-09.
090600     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
090700     PERFORM FAIL.
090800     MOVE IX-FS1-KEY TO COMPUTED-A.
090900     MOVE "AAA075" TO CORRECT-A.
091000 READ-WRITE-F2-09.
091100     PERFORM PRINT-DETAIL.
091200 REWRITE-TEST-GF-03.
091300     MOVE "REWRITE...INVALID..." TO FEATURE.
091400     MOVE "REWRITE-TEST-GF-03" TO PAR-NAME.
091500     MOVE "INVALID KEY PATH SHOULD BE TAKEN" TO RE-MARK.
091600     MOVE "EEE076ALT02" TO IX-FS1-ALT02.
091700     REWRITE IX-FS1-RECORD INVALID KEY
091800        PERFORM PASS
091900        GO TO REWRITE-WRITE-GF-03.
092000     GO TO REWRITE-FAIL-GF-03.
092100 REWRITE-DELETE-GF-03.
092200     PERFORM DE-LETE.
092300     GO TO REWRITE-WRITE-GF-03.
092400 REWRITE-FAIL-GF-03.
092500     MOVE "IX-33; 4.6.2 & INVALID KEY CONDITION (IX-6) PATH NOT BE
092600-      " TAKEN"   TO RE-MARK.
092700     PERFORM FAIL.
092800     MOVE IX-FS1-KEY TO COMPUTED-A.
092900     MOVE "INVALID KEY" TO CORRECT-A.
093000 REWRITE-WRITE-GF-03.
093100     PERFORM PRINT-DETAIL.
093200 READ-TEST-F2-10.
093300     MOVE "READ...RECORD KEY" TO FEATURE.
093400     MOVE "READ-TEST-F2-10" TO PAR-NAME.
093500     MOVE "INVALID KEY PATH SHOULD BE TAKEN" TO RE-MARK.
093600     MOVE "KKK018ALT05" TO IX-FS1-ALT05.
093700     READ IX-FS1 RECORD
093800                      KEY IS IX-FS1-ALT05
093900       INVALID KEY  PERFORM PASS
094000        GO TO READ-WRITE-F2-10.
094100     GO TO READ-FAIL-F2-10.
094200 READ-DELETE-F2-10.
094300     PERFORM DE-LETE.
094400     GO TO READ-WRITE-F2-10.
094500 READ-FAIL-F2-10.
094600     MOVE "IX-28; 4.5.2 & INVALID KEY CONDITION (IX-6) PATH NOT BE
094700-      " TAKEN"   TO RE-MARK.
094800     PERFORM FAIL.
094900     MOVE IX-FS1-KEY TO COMPUTED-A.
095000     MOVE "INVALID KEY" TO CORRECT-A.
095100 READ-WRITE-F2-10.
095200     PERFORM PRINT-DETAIL.
095300 READ-TEST-F2-11.
095400     MOVE "READ...RECORD KEY" TO FEATURE.
095500     MOVE "READ-TEST-F2-11"  TO PAR-NAME.
095600     MOVE "RETRIEVED BY ALTERNATE KEY 9" TO RE-MARK.
095700     MOVE "SSSSSSALT09" TO IX-FS1-ALT09.
095800     READ IX-FS1 RECORD
095900                      KEY IS IX-FS1-ALT09
096000        INVALID KEY GO TO READ-INVALID-F2-11.
096100     IF IX-FS1-KEY = "AAA019"
096200        PERFORM PASS
096300        ELSE GO TO READ-FAIL-F2-11.
096400     GO TO READ-WRITE-F2-11.
096500 READ-DELETE-F2-11.
096600     PERFORM DE-LETE.
096700     GO TO READ-WRITE-F2-11.
096800 READ-INVALID-F2-11.
096900     MOVE "IX-28; 4.5.2 & INVALID KEY CONDITION (IX-6) PATH     BE
097000-      " TAKEN"   TO RE-MARK.
097100     PERFORM FAIL.
097200     MOVE "INVALID KEY" TO COMPUTED-A.
097300     MOVE "SSSSSSALT09" TO CORRECT-A.
097400     GO TO READ-WRITE-F2-11.
097500 READ-FAIL-F2-11.
097600     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
097700     PERFORM FAIL.
097800     MOVE IX-FS1-KEY TO COMPUTED-A.
097900     MOVE "AAA019" TO CORRECT-A.
098000 READ-WRITE-F2-11.
098100     PERFORM PRINT-DETAIL.
098200 READ-TEST-F2-12.
098300     MOVE "READ...RECORD KEY" TO FEATURE.
098400     MOVE "READ-TEST-F2-12" TO PAR-NAME.
098500     MOVE "RETRIEVED BY ALTERNATE KEY 7" TO RE-MARK.
098600     MOVE "OOO026ALT07"  TO IX-FS1-ALT07.
098700     READ IX-FS1 RECORD
098800                      KEY IS IX-FS1-ALT07
098900        INVALID KEY GO TO READ-INVALID-F2-12.
099000     IF IX-FS1-KEY = "AAA026"
099100        PERFORM PASS
099200        ELSE GO TO READ-FAIL-F2-12.
099300     GO TO READ-WRITE-F2-12.
099400 READ-DELETE-F2-12.
099500     PERFORM DE-LETE.
099600     GO TO READ-WRITE-F2-12.
099700 READ-INVALID-F2-12.
099800     MOVE "IX-28; 4.5.2 & INVALID KEY CONDITION (IX-6) PATH     BE
099900-      " TAKEN"   TO RE-MARK.
100000     PERFORM FAIL.
100100     MOVE "INVALID KEY" TO COMPUTED-A.
100200     MOVE "OOO026ALT07" TO CORRECT-A.
100300     GO TO READ-WRITE-F2-12.
100400 READ-FAIL-F2-12.
100500     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
100600     PERFORM FAIL.
100700     MOVE IX-FS1-KEY TO COMPUTED-A.
100800     MOVE "AAA026" TO CORRECT-A.
100900 READ-WRITE-F2-12.
101000     PERFORM PRINT-DETAIL.
101100 DELETE-TEST-GF-03.
101200     MOVE "DELETE...RECORD" TO FEATURE.
101300     MOVE "DELETE-TEST-GF-03" TO PAR-NAME.
101400     MOVE "DELETES RECORD FOUND IN READ-TEST-F2-12" TO RE-MARK.
101500     DELETE IX-FS1 RECORD INVALID KEY GO TO DELETE-FAIL-GF-03.
101600     PERFORM PASS.
101700     GO TO DELETE-WRITE-GF-03.
101800 DELETE-DELETE-GF-03.
101900     PERFORM DE-LETE.
102000     GO TO DELETE-WRITE-GF-03.
102100 DELETE-FAIL-GF-03.
102200     MOVE "IX-21; 4.3.2 & INVALID KEY CONDITION (IX-6) PATH     BE
102300-      " TAKEN"   TO RE-MARK.
102400     PERFORM FAIL.
102500     MOVE "INVALID KEY" TO COMPUTED-A.
102600     MOVE "AAA026" TO CORRECT-A.
102700 DELETE-WRITE-GF-03.
102800     PERFORM PRINT-DETAIL.
102900 READ-TEST-F2-13.
103000     MOVE "READ...RECORD KEY" TO FEATURE.
103100     MOVE "READ-TEST-F2-13" TO PAR-NAME.
103200     MOVE "INVALID KEY PATH SHOULD BE TAKEN" TO RE-MARK.
103300     MOVE "KKK026ALT05" TO IX-FS1-ALT05.
103400     READ IX-FS1 RECORD
103500                      KEY IS IX-FS1-ALT05
103600       INVALID KEY  PERFORM PASS
103700        GO TO READ-WRITE-F2-13.
103800     GO TO READ-FAIL-F2-13.
103900 READ-DELETE-F2-13.
104000     PERFORM DE-LETE.
104100     GO TO READ-WRITE-F2-13.
104200 READ-FAIL-F2-13.
104300     MOVE "IX-28; 4.5.2 & INVALID KEY CONDITION (IX-6) PATH NOT BE
104400-      " TAKEN"   TO RE-MARK.
104500     PERFORM FAIL.
104600     MOVE IX-FS1-KEY TO COMPUTED-A.
104700     MOVE "INVALID KEY" TO CORRECT-A.
104800 READ-WRITE-F2-13.
104900     PERFORM PRINT-DETAIL.
105000     CLOSE IX-FS1.
105100 CCVS-EXIT SECTION.
105200 CCVS-999999.
105300     GO TO CLOSE-FILES.
