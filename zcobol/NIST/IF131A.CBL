000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IF131A.
000400
000500***********************************************************
000600*                                                         *
000700* This program forms part of the CCVS85 COBOL Test Suite. *
000800* It contains tests for the Intrinsic Function            *
000900* RANDOM.                                                 *
001000*                                                         *
001100***********************************************************
001200 ENVIRONMENT DIVISION.
001300 CONFIGURATION SECTION.
001400 SOURCE-COMPUTER.
001500     XXXXX082.
001600 OBJECT-COMPUTER.
001700     XXXXX083.
001800 INPUT-OUTPUT SECTION.
001900 FILE-CONTROL.
002000     SELECT PRINT-FILE ASSIGN TO
002100     XXXXX055.
002200 DATA DIVISION.
002300 FILE SECTION.
002400 FD  PRINT-FILE.
002500 01  PRINT-REC PICTURE X(120).
002600 01  DUMMY-RECORD PICTURE X(120).
002700 WORKING-STORAGE SECTION.
002800***********************************************************
002900* Variables specific to the Intrinsic Function Test IF131A*
003000***********************************************************
003100 01  A                   PIC S9(10)          VALUE 4.
003200 01  Q                   PIC S9(10)          VALUE 3.
003300 01  ARR                                     VALUE "40537".
003400     02  IND OCCURS 5 TIMES PIC 9.
003500 01  TEMP                PIC S9(8)V9(8).
003600 01  WS-NUM              PIC S9(5)V9(6).
003700 01  MIN-RANGE           PIC S9(5)V9(7).
003800 01  MAX-RANGE           PIC S9(5)V9(7).
003900*
004000**********************************************************
004100*
004200 01  TEST-RESULTS.
004300     02 FILLER                   PIC X      VALUE SPACE.
004400     02 FEATURE                  PIC X(20)  VALUE SPACE.
004500     02 FILLER                   PIC X      VALUE SPACE.
004600     02 P-OR-F                   PIC X(5)   VALUE SPACE.
004700     02 FILLER                   PIC X      VALUE SPACE.
004800     02  PAR-NAME.
004900       03 FILLER                 PIC X(19)  VALUE SPACE.
005000       03  PARDOT-X              PIC X      VALUE SPACE.
005100       03 DOTVALUE               PIC 99     VALUE ZERO.
005200     02 FILLER                   PIC X(8)   VALUE SPACE.
005300     02 RE-MARK                  PIC X(61).
005400 01  TEST-COMPUTED.
005500     02 FILLER                   PIC X(30)  VALUE SPACE.
005600     02 FILLER                   PIC X(17)  VALUE
005700            "       COMPUTED=".
005800     02 COMPUTED-X.
005900     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
006000     03 COMPUTED-N               REDEFINES COMPUTED-A
006100                                 PIC -9(9).9(9).
006200     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
006300     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
006400     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
006500     03       CM-18V0 REDEFINES COMPUTED-A.
006600         04 COMPUTED-18V0                    PIC -9(18).
006700         04 FILLER                           PIC X.
006800     03 FILLER PIC X(50) VALUE SPACE.
006900 01  TEST-CORRECT.
007000     02 FILLER PIC X(30) VALUE SPACE.
007100     02 FILLER PIC X(17) VALUE "       CORRECT =".
007200     02 CORRECT-X.
007300     03 CORRECT-A                  PIC X(20) VALUE SPACE.
007400     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
007500     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
007600     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
007700     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
007800     03      CR-18V0 REDEFINES CORRECT-A.
007900         04 CORRECT-18V0                     PIC -9(18).
008000         04 FILLER                           PIC X.
008100     03 FILLER PIC X(2) VALUE SPACE.
008200     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
008300 01  TEST-CORRECT-MIN.
008400     02 FILLER PIC X(30) VALUE SPACE.
008500     02 FILLER PIC X(17) VALUE "     MIN VALUE =".
008600     02 CORRECTMI-X.
008700     03 CORRECTMI-A                 PIC X(20) VALUE SPACE.
008800     03 CORRECT-MIN    REDEFINES CORRECTMI-A     PIC -9(9).9(9).
008900     03 CORRECTMI-0V18 REDEFINES CORRECTMI-A     PIC -.9(18).
009000     03 CORRECTMI-4V14 REDEFINES CORRECTMI-A     PIC -9(4).9(14).
009100     03 CORRECTMI-14V4 REDEFINES CORRECTMI-A     PIC -9(14).9(4).
009200     03      CR-18V0 REDEFINES CORRECTMI-A.
009300         04 CORRECTMI-18V0                     PIC -9(18).
009400         04 FILLER                           PIC X.
009500     03 FILLER PIC X(2) VALUE SPACE.
009600     03 FILLER                           PIC X(48) VALUE SPACE.
009700 01  TEST-CORRECT-MAX.
009800     02 FILLER PIC X(30) VALUE SPACE.
009900     02 FILLER PIC X(17) VALUE "     MAX VALUE =".
010000     02 CORRECTMA-X.
010100     03 CORRECTMA-A                  PIC X(20) VALUE SPACE.
010200     03 CORRECT-MAX    REDEFINES CORRECTMA-A     PIC -9(9).9(9).
010300     03 CORRECTMA-0V18 REDEFINES CORRECTMA-A     PIC -.9(18).
010400     03 CORRECTMA-4V14 REDEFINES CORRECTMA-A     PIC -9(4).9(14).
010500     03 CORRECTMA-14V4 REDEFINES CORRECTMA-A     PIC -9(14).9(4).
010600     03      CR-18V0 REDEFINES CORRECTMA-A.
010700         04 CORRECTMA-18V0                     PIC -9(18).
010800         04 FILLER                           PIC X.
010900     03 FILLER PIC X(2) VALUE SPACE.
011000     03 CORMA-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
011100 01  CCVS-C-1.
011200     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
011300-    "SS  PARAGRAPH-NAME
011400-    "       REMARKS".
011500     02 FILLER                     PIC X(20)    VALUE SPACE.
011600 01  CCVS-C-2.
011700     02 FILLER                     PIC X        VALUE SPACE.
011800     02 FILLER                     PIC X(6)     VALUE "TESTED".
011900     02 FILLER                     PIC X(15)    VALUE SPACE.
012000     02 FILLER                     PIC X(4)     VALUE "FAIL".
012100     02 FILLER                     PIC X(94)    VALUE SPACE.
012200 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
012300 01  REC-CT                        PIC 99       VALUE ZERO.
012400 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
012500 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
012600 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
012700 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
012800 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
012900 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
013000 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
013100 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
013200 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
013300 01  CCVS-H-1.
013400     02  FILLER                    PIC X(39)    VALUE SPACES.
013500     02  FILLER                    PIC X(42)    VALUE
013600     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
013700     02  FILLER                    PIC X(39)    VALUE SPACES.
013800 01  CCVS-H-2A.
013900   02  FILLER                        PIC X(40)  VALUE SPACE.
014000   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
014100   02  FILLER                        PIC XXXX   VALUE
014200     "4.2 ".
014300   02  FILLER                        PIC X(28)  VALUE
014400            " COPY - NOT FOR DISTRIBUTION".
014500   02  FILLER                        PIC X(41)  VALUE SPACE.
014600
014700 01  CCVS-H-2B.
014800   02  FILLER                        PIC X(15)  VALUE
014900            "TEST RESULT OF ".
015000   02  TEST-ID                       PIC X(9).
015100   02  FILLER                        PIC X(4)   VALUE
015200            " IN ".
015300   02  FILLER                        PIC X(12)  VALUE
015400     " HIGH       ".
015500   02  FILLER                        PIC X(22)  VALUE
015600            " LEVEL VALIDATION FOR ".
015700   02  FILLER                        PIC X(58)  VALUE
015800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
015900 01  CCVS-H-3.
016000     02  FILLER                      PIC X(34)  VALUE
016100            " FOR OFFICIAL USE ONLY    ".
016200     02  FILLER                      PIC X(58)  VALUE
016300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
016400     02  FILLER                      PIC X(28)  VALUE
016500            "  COPYRIGHT   1985 ".
016600 01  CCVS-E-1.
016700     02 FILLER                       PIC X(52)  VALUE SPACE.
016800     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
016900     02 ID-AGAIN                     PIC X(9).
017000     02 FILLER                       PIC X(45)  VALUE SPACES.
017100 01  CCVS-E-2.
017200     02  FILLER                      PIC X(31)  VALUE SPACE.
017300     02  FILLER                      PIC X(21)  VALUE SPACE.
017400     02 CCVS-E-2-2.
017500         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
017600         03 FILLER                   PIC X      VALUE SPACE.
017700         03 ENDER-DESC               PIC X(44)  VALUE
017800            "ERRORS ENCOUNTERED".
017900 01  CCVS-E-3.
018000     02  FILLER                      PIC X(22)  VALUE
018100            " FOR OFFICIAL USE ONLY".
018200     02  FILLER                      PIC X(12)  VALUE SPACE.
018300     02  FILLER                      PIC X(58)  VALUE
018400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
018500     02  FILLER                      PIC X(13)  VALUE SPACE.
018600     02 FILLER                       PIC X(15)  VALUE
018700             " COPYRIGHT 1985".
018800 01  CCVS-E-4.
018900     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
019000     02 FILLER                       PIC X(4)   VALUE " OF ".
019100     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
019200     02 FILLER                       PIC X(40)  VALUE
019300      "  TESTS WERE EXECUTED SUCCESSFULLY".
019400 01  XXINFO.
019500     02 FILLER                       PIC X(19)  VALUE
019600            "*** INFORMATION ***".
019700     02 INFO-TEXT.
019800       04 FILLER                     PIC X(8)   VALUE SPACE.
019900       04 XXCOMPUTED                 PIC X(20).
020000       04 FILLER                     PIC X(5)   VALUE SPACE.
020100       04 XXCORRECT                  PIC X(20).
020200     02 INF-ANSI-REFERENCE           PIC X(48).
020300 01  HYPHEN-LINE.
020400     02 FILLER  PIC IS X VALUE IS SPACE.
020500     02 FILLER  PIC IS X(65)    VALUE IS "************************
020600-    "*****************************************".
020700     02 FILLER  PIC IS X(54)    VALUE IS "************************
020800-    "******************************".
020900 01  CCVS-PGM-ID                     PIC X(9)   VALUE
021000     "IF131A".
021100 PROCEDURE DIVISION.
021200 CCVS1 SECTION.
021300 OPEN-FILES.
021400     OPEN     OUTPUT PRINT-FILE.
021500     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
021600     MOVE    SPACE TO TEST-RESULTS.
021700     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
021800     GO TO CCVS1-EXIT.
021900 CLOSE-FILES.
022000     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
022100 TERMINATE-CCVS.
022200     STOP     RUN.
022300 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
022400 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
022500 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
022600 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
022700     MOVE "****TEST DELETED****" TO RE-MARK.
022800 PRINT-DETAIL.
022900     IF REC-CT NOT EQUAL TO ZERO
023000             MOVE "." TO PARDOT-X
023100             MOVE REC-CT TO DOTVALUE.
023200     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
023300     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
023400        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
023500          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
023600     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
023700     MOVE SPACE TO CORRECT-X.
023800     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
023900     MOVE     SPACE TO RE-MARK.
024000 HEAD-ROUTINE.
024100     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024200     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024300     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
024400     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
024500 COLUMN-NAMES-ROUTINE.
024600     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
024700     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
024900 END-ROUTINE.
025000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
025100 END-RTN-EXIT.
025200     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025300 END-ROUTINE-1.
025400      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
025500      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
025600      ADD PASS-COUNTER TO ERROR-HOLD.
025700      MOVE PASS-COUNTER TO CCVS-E-4-1.
025800      MOVE ERROR-HOLD TO CCVS-E-4-2.
025900      MOVE CCVS-E-4 TO CCVS-E-2-2.
026000      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
026100  END-ROUTINE-12.
026200      MOVE "TEST(S) FAILED" TO ENDER-DESC.
026300     IF       ERROR-COUNTER IS EQUAL TO ZERO
026400         MOVE "NO " TO ERROR-TOTAL
026500         ELSE
026600         MOVE ERROR-COUNTER TO ERROR-TOTAL.
026700     MOVE     CCVS-E-2 TO DUMMY-RECORD.
026800     PERFORM WRITE-LINE.
026900 END-ROUTINE-13.
027000     IF DELETE-COUNTER IS EQUAL TO ZERO
027100         MOVE "NO " TO ERROR-TOTAL  ELSE
027200         MOVE DELETE-COUNTER TO ERROR-TOTAL.
027300     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
027400     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027500      IF   INSPECT-COUNTER EQUAL TO ZERO
027600          MOVE "NO " TO ERROR-TOTAL
027700      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
027800      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
027900      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028000     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028100 WRITE-LINE.
028200     ADD 1 TO RECORD-COUNT.
028300Y    IF RECORD-COUNT GREATER 42
028400Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
028500Y        MOVE SPACE TO DUMMY-RECORD
028600Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
028700Y        MOVE CCVS-H-1  TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
028800Y        MOVE CCVS-H-2A TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
028900Y        MOVE CCVS-H-2B TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
029000Y        MOVE CCVS-H-3  TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
029100Y        MOVE CCVS-C-1  TO DUMMY-RECORD  PERFORM WRT-LN
029200Y        MOVE CCVS-C-2  TO DUMMY-RECORD  PERFORM WRT-LN
029300Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
029400Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
029500Y        MOVE ZERO TO RECORD-COUNT.
029600     PERFORM WRT-LN.
029700 WRT-LN.
029800     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
029900     MOVE SPACE TO DUMMY-RECORD.
030000 BLANK-LINE-PRINT.
030100     PERFORM WRT-LN.
030200 FAIL-ROUTINE.
030300     IF     COMPUTED-X NOT EQUAL TO SPACE
030400            GO TO FAIL-ROUTINE-WRITE.
030500     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
030600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
030700     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
030800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030900     MOVE   SPACES TO INF-ANSI-REFERENCE.
031000     GO TO  FAIL-ROUTINE-EX.
031100 FAIL-ROUTINE-WRITE.
031200     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE.
031300     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE
031400                              CORMA-ANSI-REFERENCE.
031500     IF CORRECT-MIN NOT EQUAL TO SPACES THEN
031600           MOVE TEST-CORRECT-MIN TO PRINT-REC PERFORM WRITE-LINE
031700           MOVE TEST-CORRECT-MAX TO PRINT-REC PERFORM WRITE-LINE
031800     ELSE
031900           MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE.
032000     PERFORM WRITE-LINE.
032100     MOVE   SPACES TO COR-ANSI-REFERENCE.
032200 FAIL-ROUTINE-EX. EXIT.
032300 BAIL-OUT.
032400     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
032500     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
032600 BAIL-OUT-WRITE.
032700     MOVE CORRECT-A TO XXCORRECT.
032800     MOVE COMPUTED-A TO XXCOMPUTED.
032900     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
033000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033100     MOVE   SPACES TO INF-ANSI-REFERENCE.
033200 BAIL-OUT-EX. EXIT.
033300 CCVS1-EXIT.
033400     EXIT.
033500********************************************************
033600*                                                      *
033700*    Intrinsic Function Tests         IF131A - RANDOM  *
033800*                                                      *
033900********************************************************
034000 SECT-IF131A SECTION.
034100 F-RANDOM-INFO.
034200     MOVE     "See ref. A-64 2.35" TO ANSI-REFERENCE.
034300     MOVE     "RANDOM Function" TO FEATURE.
034400*****************TEST (a) ******************************
034500 F-RANDOM-01.
034600     MOVE ZERO TO WS-NUM.
034700     MOVE 0 TO MIN-RANGE.
034800     MOVE 1 TO MAX-RANGE.
034900 F-RANDOM-TEST-01.
035000     COMPUTE WS-NUM = FUNCTION RANDOM.
035100     IF (WS-NUM >= MIN-RANGE) AND
035200        (WS-NUM < MAX-RANGE) THEN
035300                    PERFORM PASS
035400     ELSE
035500                    MOVE WS-NUM TO COMPUTED-N
035600                    MOVE MIN-RANGE TO CORRECT-MIN
035700                    MOVE MAX-RANGE TO CORRECT-MAX
035800                    PERFORM FAIL.
035900     GO TO F-RANDOM-WRITE-01.
036000 F-RANDOM-DELETE-01.
036100     PERFORM  DE-LETE.
036200     GO TO    F-RANDOM-WRITE-01.
036300 F-RANDOM-WRITE-01.
036400     MOVE "F-RANDOM-01" TO PAR-NAME.
036500     PERFORM  PRINT-DETAIL.
036600*****************TEST (b) ******************************
036700 F-RANDOM-02.
036800     EVALUATE FUNCTION RANDOM(3)
036900     WHEN 0 THRU 1
037000                    PERFORM PASS
037100     WHEN OTHER
037200                    PERFORM FAIL.
037300     GO TO F-RANDOM-WRITE-02.
037400 F-RANDOM-DELETE-02.
037500     PERFORM  DE-LETE.
037600     GO TO    F-RANDOM-WRITE-02.
037700 F-RANDOM-WRITE-02.
037800     MOVE "F-RANDOM-02" TO PAR-NAME.
037900     PERFORM  PRINT-DETAIL.
038000*****************TEST (c) ******************************
038100 F-RANDOM-03.
038200     MOVE 0 TO MIN-RANGE.
038300     MOVE 1 TO MAX-RANGE.
038400 F-RANDOM-TEST-03.
038500     IF (FUNCTION RANDOM(Q) >= MIN-RANGE) AND
038600        (FUNCTION RANDOM(Q) <  MAX-RANGE) THEN
038700                    PERFORM PASS
038800     ELSE
038900                    PERFORM FAIL.
039000     GO TO F-RANDOM-WRITE-03.
039100 F-RANDOM-DELETE-03.
039200     PERFORM  DE-LETE.
039300     GO TO    F-RANDOM-WRITE-03.
039400 F-RANDOM-WRITE-03.
039500     MOVE "F-RANDOM-03" TO PAR-NAME.
039600     PERFORM  PRINT-DETAIL.
039700*****************TEST (d) ******************************
039800 F-RANDOM-04.
039900     MOVE ZERO TO WS-NUM.
040000     MOVE 0 TO MIN-RANGE.
040100     MOVE 1 TO MAX-RANGE.
040200 F-RANDOM-TEST-04.
040300     COMPUTE WS-NUM = FUNCTION RANDOM(IND(4)).
040400     IF (WS-NUM >= MIN-RANGE) AND
040500        (WS-NUM < MAX-RANGE) THEN
040600                    PERFORM PASS
040700     ELSE
040800                    MOVE WS-NUM TO COMPUTED-N
040900                    MOVE MIN-RANGE TO CORRECT-MIN
041000                    MOVE MAX-RANGE TO CORRECT-MAX
041100                    PERFORM FAIL.
041200     GO TO F-RANDOM-WRITE-04.
041300 F-RANDOM-DELETE-04.
041400     PERFORM  DE-LETE.
041500     GO TO    F-RANDOM-WRITE-04.
041600 F-RANDOM-WRITE-04.
041700     MOVE "F-RANDOM-04" TO PAR-NAME.
041800     PERFORM  PRINT-DETAIL.
041900*****************TEST (e) ******************************
042000 F-RANDOM-05.
042100     MOVE ZERO TO WS-NUM.
042200     MOVE 0 TO MIN-RANGE.
042300     MOVE 1 TO MAX-RANGE.
042400 F-RANDOM-TEST-05.
042500     COMPUTE WS-NUM = FUNCTION RANDOM(IND(A)).
042600     IF (WS-NUM >= MIN-RANGE) AND
042700        (WS-NUM < MAX-RANGE) THEN
042800                    PERFORM PASS
042900     ELSE
043000                    MOVE WS-NUM TO COMPUTED-N
043100                    MOVE MIN-RANGE TO CORRECT-MIN
043200                    MOVE MAX-RANGE TO CORRECT-MAX
043300                    PERFORM FAIL.
043400     GO TO F-RANDOM-WRITE-05.
043500 F-RANDOM-DELETE-05.
043600     PERFORM  DE-LETE.
043700     GO TO    F-RANDOM-WRITE-05.
043800 F-RANDOM-WRITE-05.
043900     MOVE "F-RANDOM-05" TO PAR-NAME.
044000     PERFORM  PRINT-DETAIL.
044100*****************TEST (f) ******************************
044200 F-RANDOM-06.
044300     MOVE ZERO TO WS-NUM.
044400     MOVE 1 TO MIN-RANGE.
044500     MOVE 2 TO MAX-RANGE.
044600 F-RANDOM-TEST-06.
044700     COMPUTE WS-NUM = FUNCTION RANDOM(2) + 1.
044800     IF (WS-NUM >= MIN-RANGE) AND
044900        (WS-NUM < MAX-RANGE) THEN
045000                    PERFORM PASS
045100     ELSE
045200                    MOVE WS-NUM TO COMPUTED-N
045300                    MOVE MIN-RANGE TO CORRECT-MIN
045400                    MOVE MAX-RANGE TO CORRECT-MAX
045500                    PERFORM FAIL.
045600     GO TO F-RANDOM-WRITE-06.
045700 F-RANDOM-DELETE-06.
045800     PERFORM  DE-LETE.
045900     GO TO    F-RANDOM-WRITE-06.
046000 F-RANDOM-WRITE-06.
046100     MOVE "F-RANDOM-06" TO PAR-NAME.
046200     PERFORM  PRINT-DETAIL.
046300*****************TEST (g) ******************************
046400 F-RANDOM-07.
046500     MOVE ZERO TO WS-NUM.
046600     MOVE 0 TO MIN-RANGE.
046700     MOVE 2 TO MAX-RANGE.
046800 F-RANDOM-TEST-07.
046900     COMPUTE WS-NUM = FUNCTION RANDOM(1) +
047000                      FUNCTION RANDOM(2).
047100     IF (WS-NUM >= MIN-RANGE) AND
047200        (WS-NUM < MAX-RANGE) THEN
047300                    PERFORM PASS
047400     ELSE
047500                    MOVE WS-NUM TO COMPUTED-N
047600                    MOVE MIN-RANGE TO CORRECT-MIN
047700                    MOVE MAX-RANGE TO CORRECT-MAX
047800                    PERFORM FAIL.
047900     GO TO F-RANDOM-WRITE-07.
048000 F-RANDOM-DELETE-07.
048100     PERFORM  DE-LETE.
048200     GO TO    F-RANDOM-WRITE-07.
048300 F-RANDOM-WRITE-07.
048400     MOVE "F-RANDOM-07" TO PAR-NAME.
048500     PERFORM  PRINT-DETAIL.
048600*****************TEST (h) ******************************
048700 F-RANDOM-08.
048800     MOVE ZERO TO WS-NUM.
048900     MOVE 0 TO MIN-RANGE.
049000     MOVE 1 TO MAX-RANGE.
049100 F-RANDOM-TEST-08.
049200     COMPUTE WS-NUM = FUNCTION RANDOM(
049300             FUNCTION INTEGER(100 * FUNCTION RANDOM(1))).
049400     IF (WS-NUM >= MIN-RANGE) AND
049500        (WS-NUM < MAX-RANGE) THEN
049600                    PERFORM PASS
049700     ELSE
049800                    MOVE WS-NUM TO COMPUTED-N
049900                    MOVE MIN-RANGE TO CORRECT-MIN
050000                    MOVE MAX-RANGE TO CORRECT-MAX
050100                    PERFORM FAIL.
050200     GO TO F-RANDOM-WRITE-08.
050300 F-RANDOM-DELETE-08.
050400     PERFORM  DE-LETE.
050500     GO TO    F-RANDOM-WRITE-08.
050600 F-RANDOM-WRITE-08.
050700     MOVE "F-RANDOM-08" TO PAR-NAME.
050800     PERFORM  PRINT-DETAIL.
050900********************END OF TESTS***************
051000 CCVS-EXIT SECTION.
051100 CCVS-999999.
051200     GO TO CLOSE-FILES.
