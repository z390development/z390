000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IX208A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*    THE FUNCTION OF THIS PROGRAM IS TO TEST THE PERMISSIBLE SYN-
001400*    TACTICAL CONSTRUCTS OF COBOL ELEMENTS ASSOCIATED WITH LEVEL 2
001500*    OF THE INDEXED I-O MODULE.  THE ELEMENTS TESTED IN THIS
001600*    ROUTINE ARE:
001700*
001800*    (1) READ STATEMENT;
001900*    (2) START STATEMENT;
002000*    (3) USE STATEMENT.
002100*
002200*    EACH ELEMENT TESTED WILL BE EXERCISED SEMANTICALLY BY THIS
002300*    ROUTINE.
002400*
002500*
002600*       X-CARDS  WHICH MUST BE REPLACED FOR THIS PROGRAM ARE
002700*
002800*             X-24   INDEXED FILE IMPLEMENTOR-NAME IN ASSGN TO
002900*                    CLAUSE FOR DATA FILE IX-FS1
003000*             X-25   INDEXED FILE IMPLEMENTOR-NAME IN ASSIGN TO
003100*                    CLAUSE FOR DATA FILE IX-FD2
003200*             X-44   INDEXED FILE IMPLEMENTOR-NAME IN ASSGN TO
003300*                    CLAUSE FOR INDEX FILE IX-FS1
003400*             X-45   INDEXED FILE IMPLEMENTOR-NAME IN ASSIGN TO
003500*                    CLAUSE FOR INDEX FILE IX-FD2
003600*             X-55   IMPLEMENTOR-NAME FOR SYSTEM PRINTER
003700*             X-69   ADDITIONAL VALUE OF PHRASES
003800*             X-74   VALUE OF IMPLEMENTOR-NAME
003900*             X-75   OBJECT OF VALUE OF CLAUSE FOR FILE IX-FS1
004000*             X-76   OBJECT OF VALUE OF CLAUSE FOR FILE IX-FD2
004100*             X-82   IMPLEMENTOR-NAME FOR SOURCE-COMPUTER
004200*             X-83   IMPLEMENTOR-NAME FOR OBJECT-COMPUTER
004300*
004400*        NOTE:  X-CARDS 44,45,69,74,75 AND 76 ARE OPTIONAL
004500*               AND NEED ONLY TO BE PRESENT IF THE COMPILER RE-
004600*               QUIRES THIS CODE BE AVAILABLE FOR PROPER PROGRAM
004700*               COMPILATION AND EXECUTION. IF THE VP-ROUTINE IS
004800*               USED THE  X-CARDS MAY BE AUTOMATICALLY SELECTED
004900*               FOR INCLUSION IN THE PROGRAM BY SPECIFYING THE
005000*               APPROPRIATE LETTER IN THE "*OPT" VP-ROUTINE
005100*               CONTROL CARD. THE LETTER  CORRESPONDS TO A
005200*               CHARACTER IN POSITION 7 OF THE SOURCE LINE AND
005300*               THEY ARE AS FOLLOWS
005400*
005500*                  C  SELECTS X-CARDS 74,75 AND 76
005600*                  G  SELECTS X-CARDS 69
005700*                  J  SELECTS X-CARDS 44 AND 45
005800*
005900*        NOTE:  THERE IS OPTIONAL SOURCE CODE IN THIS PROGRAM
006000*               FOR THE CONVENIENCE OF THE USER.  THIS OPTIONAL
006100*               CODE IS IDENTIFIED BY THE LETTER T,U OR X IN
006200*               POSITION 7  OF THE SOURCE LINE.  USE OF
006300*               SOURCE CODE WITH LETTER X WILL PRINT THE CONTENTS
006400*               OF THE FILES AFTER THE TEST REPORT.  FOR CODE
006500*               WITH LETTERS T OR U ONLY ONE SHOULD BE SELECTED.
006600*               EITHER THE T"S OR THE U"S SHOULD BE USED EXCLU-
006700*               SIVELY, NOT BOTH.  THE T"S PROVIDE A 29 CHARACTER
006800*               INDEXED KEY SIZE FOR THE FILE AND THE U"S PROVIDE
006900*               AN INDEXED KEY NO GREATER THAN 8 CHARACTERS.
007000*               IF THE VP-ROUTINE IS USED THE APPROPRIATE
007100*               SOURCE CODE MAY BE SELECTED BY SPECIFYING THE
007200*               RESPECTIVE LETTER IN THE "*OPT" VP-ROUTINE CONTROL
007300*               CARD.
007400*
007500******************************************************
007600 ENVIRONMENT DIVISION.
007700 CONFIGURATION SECTION.
007800 SOURCE-COMPUTER.
007900     XXXXX082.
008000 OBJECT-COMPUTER.
008100     XXXXX083.
008200 INPUT-OUTPUT SECTION.
008300 FILE-CONTROL.
008400P    SELECT RAW-DATA   ASSIGN TO
008500P    XXXXX062
008600P           ORGANIZATION IS INDEXED
008700P           ACCESS MODE IS RANDOM
008800P           RECORD KEY IS RAW-DATA-KEY.
008900     SELECT PRINT-FILE ASSIGN TO
009000     XXXXX055.
009100     SELECT   IX-FD1
009200        ASSIGN TO
009300     XXXXX024
009400J    XXXXX044
009500         ORGANIZATION IS INDEXED
009600        ALTERNATE RECORD KEY IS IX-FD1-ALTKEY1
009700        RECORD KEY IS   IX-FD1-KEY
009800        ACCESS MODE IS DYNAMIC.
009900     SELECT   IX-FS2
010000         ASSIGN TO
010100     XXXXX025
010200J    XXXXX045
010300     RECORD KEY IS IX-FS2-KEY
010400        ALTERNATE RECORD KEY IS IX-FS2-ALTKEY1
010500        ACCESS MODE IS SEQUENTIAL
010600         ORGANIZATION IS INDEXED.
010700 DATA DIVISION.
010800 FILE SECTION.
010900P
011000PFD  RAW-DATA.
011100P
011200P01  RAW-DATA-SATZ.
011300P    05  RAW-DATA-KEY        PIC X(6).
011400P    05  C-DATE              PIC 9(6).
011500P    05  C-TIME              PIC 9(8).
011600P    05  C-NO-OF-TESTS       PIC 99.
011700P    05  C-OK                PIC 999.
011800P    05  C-ALL               PIC 999.
011900P    05  C-FAIL              PIC 999.
012000P    05  C-DELETED           PIC 999.
012100P    05  C-INSPECT           PIC 999.
012200P    05  C-NOTE              PIC X(13).
012300P    05  C-INDENT            PIC X.
012400P    05  C-ABORT             PIC X(8).
012500 FD  PRINT-FILE.
012600 01  PRINT-REC PICTURE X(120).
012700 01  DUMMY-RECORD PICTURE X(120).
012800 FD  IX-FD1
012900C    LABEL RECORD IS STANDARD
013000C    DATA RECORD IS IX-FD1R1-F-G-240
013100     RECORD CONTAINS 240 CHARACTERS.
013200 01  IX-FD1R1-F-G-240.
013300     05 IX-FD1-REC-001-120        PICTURE X(120).
013400     05 IX-FD1-REC-121-240.
013500     10 FILLER          PICTURE X(8).
013600     10 IX-FD1-KEY.
013700        15 IX-FS1-KEYNUM PICTURE 9(5).
013800T       15 FILLER        PICTURE 9(5).
013900U    10 FILLER           PICTURE X(5).
014000     10 FILLER           PICTURE X(19).
014100     10 FILLER           PICTURE X(9).
014200     10 IX-FD1-ALTKEY1.
014300T       15 FILLER        PICTURE 9(5).
014400        15 IX-FD1-ALTKEY1NUM      PICTURE 9(5).
014500U    10 FILLER                    PICTURE 9(5).
014600     10 FILLER                    PICTURE X(19).
014700     10 FILLER                    PICTURE X(45).
014800 FD  IX-FS2
014900C    LABEL RECORDS ARE STANDARD
015000C    DATA RECORD IS IX-FS2R1-F-G-240
015100          .
015200 01  IX-FS2R1-F-G-240.
015300     05 IX-FS2-REC-001-120        PICTURE X(120).
015400     05 IX-FS2-REC-121-240.
015500        10 FILLER                 PICTURE X(8).
015600        10 IX-FS2-KEY.
015700           15 IX-FS2-KEYNUM       PICTURE 9(5).
015800T          15 FILLER              PICTURE 9(5).
015900U       10 FILLER                 PICTURE 9(5).
016000        10 FILLER                 PICTURE X(19).
016100        10 FILLER                 PICTURE X(9).
016200        10 IX-FS2-ALTKEY1.
016300T          15 FILLER              PICTURE 9(5).
016400           15 IX-FS2-ALTKEY1NUM   PICTURE 9(5).
016500U       10 FILLER                 PICTURE 9(5).
016600        10 FILLER                 PICTURE X(19).
016700        10 FILLER                 PICTURE X(45).
016800 WORKING-STORAGE SECTION.
016900 01  IX-FD1-FILESIZE              PICTURE 9(6) VALUE 300.
017000 01  IX-FS2-FILESIZE              PICTURE 9(6) VALUE 300.
017100 01  WRK-IX-FD1-RECKEY.
017200     03 WRK-DU-05V00-001          PICTURE 9(5) VALUE ZERO.
017300T    03 FILLER                    PICTURE 9(5) VALUE ZERO.
017400 01  WRK-IX-FS2-RECKEY.
017500     03 WRK-DU-05V00-003          PICTURE 9(5)  VALUE  ZERO.
017600T    03 FILLER                    PICTURE 9(5)  VALUE  ZERO.
017700 01  WRK-IX-FD1-ALTKEY.
017800T    03 FILLER                    PICTURE 9(5)  VALUE  ZERO.
017900     03 WRK-DU-05V00-002          PICTURE 9(5)  VALUE  ZERO.
018000 01  WRK-IX-FS2-ALTKEY.
018100T    03 FILLER                    PICTURE 9(5)  VALUE  ZERO.
018200     03 WRK-DU-05V00-004          PICTURE 9(5)  VALUE  ZERO.
018300 01  EXCUT-COUNTER-06V00          PICTURE S9(6) VALUE  ZERO.
018400 01  INV-KEY-COUNTER              PICTURE S9(6) VALUE  ZERO.
018500 01  LOGICAL-FILE-REC             PICTURE S9(6) VALUE  ZERO.
018600 01  ERROR-COUNTER-06V00          PICTURE S9(6) VALUE  ZERO.
018700 01  ASCEND-DESEND-SWITCH        PICTURE XX   VALUE "UP".
018800             88 ASCEND VALUE "UP".
018900             88 DSCEND VALUE "DN".
019000 01  FILE-RECORD-INFORMATION-REC.
019100     03 FILE-RECORD-INFO-SKELETON.
019200        05 FILLER                 PICTURE X(48)       VALUE
019300             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
019400        05 FILLER                 PICTURE X(46)       VALUE
019500             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
019600        05 FILLER                 PICTURE X(26)       VALUE
019700             ",LFIL=000000,ORG=  ,LBLR= ".
019800        05 FILLER                 PICTURE X(37)       VALUE
019900             ",RECKEY=                             ".
020000        05 FILLER                 PICTURE X(38)       VALUE
020100             ",ALTKEY1=                             ".
020200        05 FILLER                 PICTURE X(38)       VALUE
020300             ",ALTKEY2=                             ".
020400        05 FILLER                 PICTURE X(7)        VALUE SPACE.
020500     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
020600        05 FILE-RECORD-INFO-P1-120.
020700           07 FILLER              PIC X(5).
020800           07 XFILE-NAME           PIC X(6).
020900           07 FILLER              PIC X(8).
021000           07 XRECORD-NAME         PIC X(6).
021100           07 FILLER              PIC X(1).
021200           07 REELUNIT-NUMBER     PIC 9(1).
021300           07 FILLER              PIC X(7).
021400           07 XRECORD-NUMBER       PIC 9(6).
021500           07 FILLER              PIC X(6).
021600           07 UPDATE-NUMBER       PIC 9(2).
021700           07 FILLER              PIC X(5).
021800           07 ODO-NUMBER          PIC 9(4).
021900           07 FILLER              PIC X(5).
022000           07 XPROGRAM-NAME        PIC X(5).
022100           07 FILLER              PIC X(7).
022200           07 XRECORD-LENGTH       PIC 9(6).
022300           07 FILLER              PIC X(7).
022400           07 CHARS-OR-RECORDS    PIC X(2).
022500           07 FILLER              PIC X(1).
022600           07 XBLOCK-SIZE          PIC 9(4).
022700           07 FILLER              PIC X(6).
022800           07 RECORDS-IN-FILE     PIC 9(6).
022900           07 FILLER              PIC X(5).
023000           07 XFILE-ORGANIZATION   PIC X(2).
023100           07 FILLER              PIC X(6).
023200           07 XLABEL-TYPE          PIC X(1).
023300        05 FILE-RECORD-INFO-P121-240.
023400           07 FILLER              PIC X(8).
023500           07 XRECORD-KEY          PIC X(29).
023600           07 FILLER              PIC X(9).
023700           07 ALTERNATE-KEY1      PIC X(29).
023800           07 FILLER              PIC X(9).
023900           07 ALTERNATE-KEY2      PIC X(29).
024000           07 FILLER              PIC X(7).
024100 01  TEST-RESULTS.
024200     02 FILLER                   PIC X      VALUE SPACE.
024300     02 FEATURE                  PIC X(20)  VALUE SPACE.
024400     02 FILLER                   PIC X      VALUE SPACE.
024500     02 P-OR-F                   PIC X(5)   VALUE SPACE.
024600     02 FILLER                   PIC X      VALUE SPACE.
024700     02  PAR-NAME.
024800       03 FILLER                 PIC X(19)  VALUE SPACE.
024900       03  PARDOT-X              PIC X      VALUE SPACE.
025000       03 DOTVALUE               PIC 99     VALUE ZERO.
025100     02 FILLER                   PIC X(8)   VALUE SPACE.
025200     02 RE-MARK                  PIC X(61).
025300 01  TEST-COMPUTED.
025400     02 FILLER                   PIC X(30)  VALUE SPACE.
025500     02 FILLER                   PIC X(17)  VALUE
025600            "       COMPUTED=".
025700     02 COMPUTED-X.
025800     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
025900     03 COMPUTED-N               REDEFINES COMPUTED-A
026000                                 PIC -9(9).9(9).
026100     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
026200     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
026300     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
026400     03       CM-18V0 REDEFINES COMPUTED-A.
026500         04 COMPUTED-18V0                    PIC -9(18).
026600         04 FILLER                           PIC X.
026700     03 FILLER PIC X(50) VALUE SPACE.
026800 01  TEST-CORRECT.
026900     02 FILLER PIC X(30) VALUE SPACE.
027000     02 FILLER PIC X(17) VALUE "       CORRECT =".
027100     02 CORRECT-X.
027200     03 CORRECT-A                  PIC X(20) VALUE SPACE.
027300     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
027400     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
027500     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
027600     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
027700     03      CR-18V0 REDEFINES CORRECT-A.
027800         04 CORRECT-18V0                     PIC -9(18).
027900         04 FILLER                           PIC X.
028000     03 FILLER PIC X(2) VALUE SPACE.
028100     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
028200 01  CCVS-C-1.
028300     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
028400-    "SS  PARAGRAPH-NAME
028500-    "       REMARKS".
028600     02 FILLER                     PIC X(20)    VALUE SPACE.
028700 01  CCVS-C-2.
028800     02 FILLER                     PIC X        VALUE SPACE.
028900     02 FILLER                     PIC X(6)     VALUE "TESTED".
029000     02 FILLER                     PIC X(15)    VALUE SPACE.
029100     02 FILLER                     PIC X(4)     VALUE "FAIL".
029200     02 FILLER                     PIC X(94)    VALUE SPACE.
029300 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
029400 01  REC-CT                        PIC 99       VALUE ZERO.
029500 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
029600 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
029700 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
029800 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
029900 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
030000 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
030100 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
030200 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
030300 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
030400 01  CCVS-H-1.
030500     02  FILLER                    PIC X(39)    VALUE SPACES.
030600     02  FILLER                    PIC X(42)    VALUE
030700     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
030800     02  FILLER                    PIC X(39)    VALUE SPACES.
030900 01  CCVS-H-2A.
031000   02  FILLER                        PIC X(40)  VALUE SPACE.
031100   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
031200   02  FILLER                        PIC XXXX   VALUE
031300     "4.2 ".
031400   02  FILLER                        PIC X(28)  VALUE
031500            " COPY - NOT FOR DISTRIBUTION".
031600   02  FILLER                        PIC X(41)  VALUE SPACE.
031700
031800 01  CCVS-H-2B.
031900   02  FILLER                        PIC X(15)  VALUE
032000            "TEST RESULT OF ".
032100   02  TEST-ID                       PIC X(9).
032200   02  FILLER                        PIC X(4)   VALUE
032300            " IN ".
032400   02  FILLER                        PIC X(12)  VALUE
032500     " HIGH       ".
032600   02  FILLER                        PIC X(22)  VALUE
032700            " LEVEL VALIDATION FOR ".
032800   02  FILLER                        PIC X(58)  VALUE
032900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
033000 01  CCVS-H-3.
033100     02  FILLER                      PIC X(34)  VALUE
033200            " FOR OFFICIAL USE ONLY    ".
033300     02  FILLER                      PIC X(58)  VALUE
033400     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
033500     02  FILLER                      PIC X(28)  VALUE
033600            "  COPYRIGHT   1985 ".
033700 01  CCVS-E-1.
033800     02 FILLER                       PIC X(52)  VALUE SPACE.
033900     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
034000     02 ID-AGAIN                     PIC X(9).
034100     02 FILLER                       PIC X(45)  VALUE SPACES.
034200 01  CCVS-E-2.
034300     02  FILLER                      PIC X(31)  VALUE SPACE.
034400     02  FILLER                      PIC X(21)  VALUE SPACE.
034500     02 CCVS-E-2-2.
034600         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
034700         03 FILLER                   PIC X      VALUE SPACE.
034800         03 ENDER-DESC               PIC X(44)  VALUE
034900            "ERRORS ENCOUNTERED".
035000 01  CCVS-E-3.
035100     02  FILLER                      PIC X(22)  VALUE
035200            " FOR OFFICIAL USE ONLY".
035300     02  FILLER                      PIC X(12)  VALUE SPACE.
035400     02  FILLER                      PIC X(58)  VALUE
035500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
035600     02  FILLER                      PIC X(13)  VALUE SPACE.
035700     02 FILLER                       PIC X(15)  VALUE
035800             " COPYRIGHT 1985".
035900 01  CCVS-E-4.
036000     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
036100     02 FILLER                       PIC X(4)   VALUE " OF ".
036200     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
036300     02 FILLER                       PIC X(40)  VALUE
036400      "  TESTS WERE EXECUTED SUCCESSFULLY".
036500 01  XXINFO.
036600     02 FILLER                       PIC X(19)  VALUE
036700            "*** INFORMATION ***".
036800     02 INFO-TEXT.
036900       04 FILLER                     PIC X(8)   VALUE SPACE.
037000       04 XXCOMPUTED                 PIC X(20).
037100       04 FILLER                     PIC X(5)   VALUE SPACE.
037200       04 XXCORRECT                  PIC X(20).
037300     02 INF-ANSI-REFERENCE           PIC X(48).
037400 01  HYPHEN-LINE.
037500     02 FILLER  PIC IS X VALUE IS SPACE.
037600     02 FILLER  PIC IS X(65)    VALUE IS "************************
037700-    "*****************************************".
037800     02 FILLER  PIC IS X(54)    VALUE IS "************************
037900-    "******************************".
038000 01  CCVS-PGM-ID                     PIC X(9)   VALUE
038100     "IX208A".
038200 PROCEDURE DIVISION.
038300 DECLARATIVES.
038400 USE-IX208A-TEST SECTION.
038500     USE      AFTER ERROR PROCEDURE IX-FD1  IX-FS2.
038600 USE-PAR-001.
038700     ADD      010000  TO ERROR-COUNTER-06V00.
038800 USE-PAR-EXIT.
038900     EXIT.
039000 END DECLARATIVES.
039100 CCVS1 SECTION.
039200 OPEN-FILES.
039300P    OPEN I-O RAW-DATA.
039400P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
039500P    READ RAW-DATA INVALID KEY GO TO END-E-1.
039600P    MOVE "ABORTED " TO C-ABORT.
039700P    ADD 1 TO C-NO-OF-TESTS.
039800P    ACCEPT C-DATE  FROM DATE.
039900P    ACCEPT C-TIME  FROM TIME.
040000P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
040100PEND-E-1.
040200P    CLOSE RAW-DATA.
040300     OPEN    OUTPUT PRINT-FILE.
040400     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
040500     MOVE    SPACE TO TEST-RESULTS.
040600     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
040700     MOVE    ZERO TO REC-SKL-SUB.
040800     PERFORM CCVS-INIT-FILE 9 TIMES.
040900 CCVS-INIT-FILE.
041000     ADD     1 TO REC-SKL-SUB.
041100     MOVE    FILE-RECORD-INFO-SKELETON
041200          TO FILE-RECORD-INFO (REC-SKL-SUB).
041300 CCVS-INIT-EXIT.
041400     GO TO CCVS1-EXIT.
041500 CLOSE-FILES.
041600P    OPEN I-O RAW-DATA.
041700P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
041800P    READ RAW-DATA INVALID KEY GO TO END-E-2.
041900P    MOVE "OK.     " TO C-ABORT.
042000P    MOVE PASS-COUNTER TO C-OK.
042100P    MOVE ERROR-HOLD   TO C-ALL.
042200P    MOVE ERROR-COUNTER TO C-FAIL.
042300P    MOVE DELETE-COUNTER TO C-DELETED.
042400P    MOVE INSPECT-COUNTER TO C-INSPECT.
042500P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
042600PEND-E-2.
042700P    CLOSE RAW-DATA.
042800     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
042900 TERMINATE-CCVS.
043000S    EXIT PROGRAM.
043100STERMINATE-CALL.
043200     STOP     RUN.
043300 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
043400 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
043500 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
043600 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
043700     MOVE "****TEST DELETED****" TO RE-MARK.
043800 PRINT-DETAIL.
043900     IF REC-CT NOT EQUAL TO ZERO
044000             MOVE "." TO PARDOT-X
044100             MOVE REC-CT TO DOTVALUE.
044200     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
044300     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
044400        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
044500          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
044600     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
044700     MOVE SPACE TO CORRECT-X.
044800     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
044900     MOVE     SPACE TO RE-MARK.
045000 HEAD-ROUTINE.
045100     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045200     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045300     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
045400     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
045500 COLUMN-NAMES-ROUTINE.
045600     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
045700     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
045900 END-ROUTINE.
046000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
046100 END-RTN-EXIT.
046200     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
046300 END-ROUTINE-1.
046400      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
046500      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
046600      ADD PASS-COUNTER TO ERROR-HOLD.
046700*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
046800      MOVE PASS-COUNTER TO CCVS-E-4-1.
046900      MOVE ERROR-HOLD TO CCVS-E-4-2.
047000      MOVE CCVS-E-4 TO CCVS-E-2-2.
047100      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
047200  END-ROUTINE-12.
047300      MOVE "TEST(S) FAILED" TO ENDER-DESC.
047400     IF       ERROR-COUNTER IS EQUAL TO ZERO
047500         MOVE "NO " TO ERROR-TOTAL
047600         ELSE
047700         MOVE ERROR-COUNTER TO ERROR-TOTAL.
047800     MOVE     CCVS-E-2 TO DUMMY-RECORD.
047900     PERFORM WRITE-LINE.
048000 END-ROUTINE-13.
048100     IF DELETE-COUNTER IS EQUAL TO ZERO
048200         MOVE "NO " TO ERROR-TOTAL  ELSE
048300         MOVE DELETE-COUNTER TO ERROR-TOTAL.
048400     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
048500     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
048600      IF   INSPECT-COUNTER EQUAL TO ZERO
048700          MOVE "NO " TO ERROR-TOTAL
048800      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
048900      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
049000      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
049100     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
049200 WRITE-LINE.
049300     ADD 1 TO RECORD-COUNT.
049400Y    IF RECORD-COUNT GREATER 42
049500Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
049600Y        MOVE SPACE TO DUMMY-RECORD
049700Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
049800Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
049900Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
050000Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
050100Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
050200Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
050300Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
050400Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
050500Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
050600Y        MOVE ZERO TO RECORD-COUNT.
050700     PERFORM WRT-LN.
050800 WRT-LN.
050900     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
051000     MOVE SPACE TO DUMMY-RECORD.
051100 BLANK-LINE-PRINT.
051200     PERFORM WRT-LN.
051300 FAIL-ROUTINE.
051400     IF     COMPUTED-X NOT EQUAL TO SPACE
051500            GO TO   FAIL-ROUTINE-WRITE.
051600     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
051700     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
051800     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
051900     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
052000     MOVE   SPACES TO INF-ANSI-REFERENCE.
052100     GO TO  FAIL-ROUTINE-EX.
052200 FAIL-ROUTINE-WRITE.
052300     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
052400     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
052500     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
052600     MOVE   SPACES TO COR-ANSI-REFERENCE.
052700 FAIL-ROUTINE-EX. EXIT.
052800 BAIL-OUT.
052900     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
053000     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
053100 BAIL-OUT-WRITE.
053200     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
053300     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
053400     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
053500     MOVE   SPACES TO INF-ANSI-REFERENCE.
053600 BAIL-OUT-EX. EXIT.
053700 CCVS1-EXIT.
053800     EXIT.
053900 SECT-IX208A-0001 SECTION.
054000 WRITE-INIT-GF-01.
054100     OPEN     OUTPUT  IX-FD1.
054200     OPEN     OUTPUT  IX-FS2.
054300     MOVE     "IX-FD1"  TO XFILE-NAME (1).
054400     MOVE     "R1-F-G"  TO XRECORD-NAME (1).
054500     MOVE     ZERO      TO XRECORD-NUMBER (1).
054600     MOVE     CCVS-PGM-ID TO XPROGRAM-NAME (1).
054700     MOVE     000240    TO XRECORD-LENGTH (1).
054800     MOVE     0001      TO XBLOCK-SIZE (1).
054900     MOVE     "RC"      TO CHARS-OR-RECORDS (1).
055000     MOVE     "IX"      TO XFILE-ORGANIZATION (1).
055100     MOVE     "S"       TO XLABEL-TYPE (1).
055200     MOVE     000300    TO IX-FD1-FILESIZE.
055300     MOVE     000300    TO RECORDS-IN-FILE (1).
055400     MOVE     00001     TO WRK-DU-05V00-001.
055500     MOVE     00300     TO WRK-DU-05V00-002.
055600     MOVE     ZERO      TO EXCUT-COUNTER-06V00.
055700     MOVE     ZERO      TO INV-KEY-COUNTER.
055800     MOVE     "WRITE-INIT-GF-01" TO PAR-NAME.
055900     MOVE     "IX-FS2"  TO XFILE-NAME (2).
056000     MOVE     "R1-F-G"  TO XRECORD-NAME (2).
056100     MOVE     ZERO      TO XRECORD-NUMBER (2).
056200     MOVE     CCVS-PGM-ID TO XPROGRAM-NAME (2).
056300     MOVE     000240    TO XRECORD-LENGTH (2).
056400     MOVE     0001      TO XBLOCK-SIZE (2).
056500     MOVE     "RC"      TO CHARS-OR-RECORDS (2).
056600     MOVE     "IX"      TO XFILE-ORGANIZATION (2).
056700     MOVE     "S"       TO XLABEL-TYPE (2).
056800     MOVE     00300     TO IX-FS2-FILESIZE.
056900     MOVE     00300     TO RECORDS-IN-FILE (2).
057000     MOVE     00001     TO WRK-DU-05V00-003.
057100     MOVE     00300     TO WRK-DU-05V00-004.
057200 WRITE-TEST-GF-00.
057300     ADD      0001 TO   XRECORD-NUMBER (1).
057400     MOVE     WRK-IX-FD1-RECKEY  TO XRECORD-KEY (1).
057500     MOVE     WRK-IX-FD1-ALTKEY  TO ALTERNATE-KEY1 (1).
057600     MOVE     FILE-RECORD-INFO (1) TO IX-FD1R1-F-G-240.
057700     WRITE    IX-FD1R1-F-G-240
057800              INVALID KEY
057900              ADD       000001 TO INV-KEY-COUNTER.
058000     ADD      000001  TO EXCUT-COUNTER-06V00.
058100     ADD      00001   TO WRK-DU-05V00-001.
058200     SUBTRACT 00001   FROM WRK-DU-05V00-002.
058300     IF       XRECORD-NUMBER (1) LESS THAN IX-FD1-FILESIZE
058400              GO TO WRITE-TEST-GF-00.
058500     CLOSE    IX-FD1.
058600 WRITE-TEST-GF-01.
058700     MOVE     "CREATE FILE IX-FD1"  TO FEATURE.
058800     IF       EXCUT-COUNTER-06V00  NOT EQUAL TO IX-FD1-FILESIZE
058900              PERFORM   FAIL
059000              MOVE      IX-FD1-FILESIZE  TO  CORRECT-N
059100              MOVE      EXCUT-COUNTER-06V00 TO COMPUTED-N
059200     MOVE "INCORRECT NUMBER OF WRITES; IX-41"        TO RE-MARK
059300              PERFORM   PRINT-DETAIL
059400              GO TO    WRITE-INIT-GF-02.
059500     IF       INV-KEY-COUNTER NOT EQUAL TO ZERO
059600              PERFORM   FAIL
059700              MOVE      INV-KEY-COUNTER TO COMPUTED-N
059800              MOVE      ZERO TO  CORRECT-N
059900       MOVE "INVALID KEY ON WRITE; IX-41" TO RE-MARK
060000              PERFORM   PRINT-DETAIL
060100              GO TO    WRITE-INIT-GF-02.
060200*
060300*    01
060400*
060500     PERFORM  PASS.
060600     PERFORM  PRINT-DETAIL.
060700 WRITE-INIT-GF-02.
060800     MOVE     ZERO   TO INV-KEY-COUNTER.
060900     MOVE     ZERO   TO EXCUT-COUNTER-06V00.
061000 WRITE-TEST-GF-02-1.
061100     ADD      0001  TO  XRECORD-NUMBER (2).
061200     MOVE     WRK-IX-FS2-RECKEY  TO  XRECORD-KEY (2).
061300     MOVE     WRK-IX-FS2-ALTKEY  TO  ALTERNATE-KEY1 (2).
061400     MOVE     FILE-RECORD-INFO (2) TO IX-FS2R1-F-G-240.
061500     WRITE    IX-FS2R1-F-G-240
061600              INVALID KEY
061700              ADD   000001 TO INV-KEY-COUNTER.
061800     ADD      000001 TO EXCUT-COUNTER-06V00.
061900     ADD      00001  TO WRK-DU-05V00-003.
062000     SUBTRACT 00001  FROM WRK-DU-05V00-004.
062100     IF       XRECORD-NUMBER (2) LESS THAN IX-FS2-FILESIZE
062200              GO TO  WRITE-TEST-GF-02-1.
062300     CLOSE    IX-FS2.
062400 WRITE-TEST-GF-02.
062500     MOVE     "CREATE FILE IX-FS2" TO  FEATURE.
062600     MOVE     "WRITE-TEST-GF-02  " TO PAR-NAME.
062700     IF       EXCUT-COUNTER-06V00 NOT EQUAL TO IX-FS2-FILESIZE
062800              PERFORM   FAIL
062900              MOVE      IX-FS2-FILESIZE  TO  CORRECT-N
063000              MOVE      EXCUT-COUNTER-06V00 TO COMPUTED-N
063100       MOVE      "INCORRECT NUMBER OF WRITES; IX-41" TO RE-MARK
063200              PERFORM   PRINT-DETAIL
063300              GO  TO    READ-INIT-F1-01.
063400*
063500*    02
063600*
063700     IF       INV-KEY-COUNTER  NOT EQUAL TO ZERO
063800              PERFORM   FAIL
063900              MOVE      INV-KEY-COUNTER  TO COMPUTED-N
064000              MOVE      ZERO TO CORRECT-N
064100       MOVE      "INVALID KEY ON WRITE; IX-41" TO RE-MARK
064200              PERFORM   PRINT-DETAIL
064300              GO TO     READ-INIT-F1-01.
064400     PERFORM  PASS.
064500     PERFORM  PRINT-DETAIL.
064600 READ-INIT-F1-01.
064700     PERFORM  BLANK-LINE-PRINT.
064800     MOVE     "THE FOLLOWING  TESTS ACCESS A FILE DEFINED AS
064900-             "ACCESS MODE IS DYNAMIC."  TO  PRINT-REC.
065000     PERFORM  WRITE-LINE.
065100     PERFORM  BLANK-LINE-PRINT.
065200     MOVE     "READ NEXT"  TO FEATURE.
065300     MOVE     "READ-TEST-F1-01" TO PAR-NAME.
065400 READ-INIT-F1-01-R1.
065500     OPEN  INPUT  IX-FD1.
065600     PERFORM  INX-INIT-002-R.
065700 READ-TEST-F1-01-1.
065800     READ     IX-FD1 NEXT.
065900     MOVE     IX-FD1R1-F-G-240  TO  FILE-RECORD-INFO (1).
066000     PERFORM  INX-VERIFY-002.
066100     IF       EXCUT-COUNTER-06V00 LESS THAN  10
066200              GO TO READ-TEST-F1-01-1.
066300     CLOSE    IX-FD1.
066400 READ-TEST-F1-01.
066500     PERFORM  INX-TEST-002.
066600     GO TO  READ-INIT-F1-02.
066700*
066800*    01
066900*
067000 READ-DELETE-F1-01.
067100     PERFORM  DE-LETE.
067200     PERFORM  PRINT-DETAIL.
067300 READ-INIT-F1-02.
067400     PERFORM  INX-INIT-002-R.
067500     OPEN     INPUT     IX-FD1.
067600 READ-TEST-F1-02.
067700     MOVE     SPACE TO FILE-RECORD-INFO (9).
067800     MOVE     SPACE TO FILE-RECORD-INFO (1).
067900     READ     IX-FD1   NEXT RECORD
068000              INTO   FILE-RECORD-INFO (9).
068100     MOVE     IX-FD1R1-F-G-240  TO  FILE-RECORD-INFO (1).
068200     PERFORM  INX-VERIFY-002.
068300     IF       XRECORD-NUMBER (9) NOT EQUAL TO LOGICAL-FILE-REC
068400              ADD   000100  TO ERROR-COUNTER-06V00.
068500     IF       EXCUT-COUNTER-06V00 LESS THAN 10
068600              GO TO  READ-TEST-F1-02.
068700     CLOSE    IX-FD1.
068800     MOVE "READ-TEST-F1-02" TO PAR-NAME.
068900     MOVE "READ . NEXT INTO" TO FEATURE.
069000     PERFORM  INX-TEST-002.
069100*
069200*    02
069300*
069400     GO TO  READ-INIT-F1-03.
069500 READ-DELETE-F1-02.
069600     MOVE "READ-TEST-F1-02     " TO PAR-NAME.
069700     MOVE "READ ... INTO       " TO FEATURE.
069800     PERFORM  DE-LETE.
069900     PERFORM  PRINT-DETAIL.
070000 READ-INIT-F1-03.
070100     OPEN     INPUT  IX-FD1.
070200     PERFORM  INX-INIT-002-R.
070300 READ-TEST-F1-03.
070400     MOVE     SPACE TO FILE-RECORD-INFO (9).
070500     MOVE     SPACE TO FILE-RECORD-INFO (1).
070600     READ     IX-FD1  NEXT
070700              INTO   FILE-RECORD-INFO (9).
070800     MOVE     IX-FD1R1-F-G-240 TO FILE-RECORD-INFO (1).
070900     PERFORM  INX-VERIFY-002.
071000     IF       XRECORD-NUMBER (9) NOT EQUAL TO LOGICAL-FILE-REC
071100              ADD   000100  TO  ERROR-COUNTER-06V00.
071200     IF       EXCUT-COUNTER-06V00 LESS THAN 10
071300              GO TO READ-TEST-F1-03.
071400     CLOSE    IX-FD1.
071500 READ-TEST-F1-03-1.
071600     MOVE "READ-TEST-F1-03" TO PAR-NAME.
071700     MOVE "READ . NEXT INTO" TO FEATURE.
071800     PERFORM  INX-TEST-002.
071900*
072000*    03
072100*
072200     GO TO  READ-INIT-F1-04.
072300 READ-DELETE-TEST-F1-03.
072400     MOVE "READ-TEST-F1-03     " TO PAR-NAME.
072500     PERFORM  DE-LETE.
072600     PERFORM  PRINT-DETAIL.
072700 READ-INIT-F1-04.
072800     OPEN     INPUT  IX-FD1.
072900     PERFORM  INX-INIT-002-R.
073000     MOVE     IX-FD1-FILESIZE TO ERROR-COUNTER-06V00.
073100     ADD      000001  TO ERROR-COUNTER-06V00.
073200     MOVE "READ-TEST-F1-04" TO PAR-NAME.
073300     MOVE "READ . NEXT INTO" TO FEATURE.
073400 READ-TEST-F1-04.
073500     MOVE     SPACE TO FILE-RECORD-INFO (9).
073600     MOVE     SPACE TO FILE-RECORD-INFO (1).
073700     READ     IX-FD1  NEXT INTO  FILE-RECORD-INFO (9) AT END
073800              SUBTRACT   000001  FROM  ERROR-COUNTER-06V00
073900             GO TO  READ-TEST-F1-04-1.
074000     MOVE     IX-FD1R1-F-G-240  TO  FILE-RECORD-INFO (1).
074100     PERFORM  INX-VERIFY-002.
074200     IF       EXCUT-COUNTER-06V00  GREATER THAN IX-FD1-FILESIZE
074300              NEXT SENTENCE
074400              ELSE
074500              GO TO   READ-TEST-F1-04.
074600*
074700*    TEST READ-TEST-F1-04 TESTS THE COBOL CONSTRUCT  "READ FILE-
074800*    NAME NEXT INTO IDENTIFIER AT END".  THE TEST READS THE FILE
074900*    SEQUENTIALY VIA THE RECORD KEY  (RECORD KEY IS THE KEY OF
075000*    REFERENCE) UNTIL AN END-OF-FILE CONDITION OCCURS.  A CHECK
075100*    IS MADE TO VERIFY THAT THE PROPER RECORDS WERE RETRIVED AND
075200*    THE AT END PATH WAS TAKEN ON THE 301 ST READ.
075300*
075400 READ-TEST-F1-04-1.
075500     CLOSE   IX-FD1.
075600     PERFORM  INX-TEST-002.
075700*   .04
075800     GO TO  READ-INIT-F2-01.
075900 READ-DELETE-F1-04.
076000     MOVE "READ-TEST-F1-04     " TO PAR-NAME.
076100     PERFORM  DE-LETE.
076200     PERFORM  PRINT-DETAIL.
076300 READ-INIT-F2-01.
076400     OPEN     INPUT  IX-FD1.
076500     MOVE "READ-TEST-F2-01" TO PAR-NAME.
076600     MOVE "READ . KEY IS .." TO FEATURE.
076700     PERFORM  INX-INIT-002-R.
076800     MOVE     ZERO TO WRK-DU-05V00-001.
076900 READ-TEST-F2-01.
077000     ADD      00005   TO WRK-DU-05V00-001.
077100     ADD      000004  TO LOGICAL-FILE-REC.
077200     MOVE     WRK-IX-FD1-RECKEY TO IX-FD1-KEY.
077300     READ     IX-FD1
077400                      KEY IS  IX-FD1-KEY.
077500     MOVE     IX-FD1R1-F-G-240  TO  FILE-RECORD-INFO (1).
077600     PERFORM  INX-VERIFY-002.
077700     MOVE     SPACE TO FILE-RECORD-INFO (1).
077800     IF       EXCUT-COUNTER-06V00  LESS THAN 10
077900              GO TO   READ-TEST-F2-01.
078000     CLOSE    IX-FD1.
078100     PERFORM  INX-TEST-002.
078200*   .05
078300     GO TO  READ-INIT-F2-02.
078400 READ-DELETE-F2-01.
078500     MOVE "READ-TEST-F2-01     " TO PAR-NAME.
078600     PERFORM  DE-LETE.
078700     PERFORM  PRINT-DETAIL.
078800 READ-INIT-F2-02.
078900     MOVE "READ-TEST-F2-02     " TO PAR-NAME.
079000     MOVE "READ ... INTO       " TO FEATURE.
079100     OPEN     INPUT  IX-FD1.
079200     PERFORM  INX-INIT-002-R.
079300     MOVE     ZERO TO WRK-DU-05V00-001.
079400 READ-TEST-F2-02.
079500     MOVE     SPACE TO FILE-RECORD-INFO (9).
079600     MOVE     SPACE TO FILE-RECORD-INFO (1).
079700     ADD      00005   TO WRK-DU-05V00-001.
079800     ADD      000004  TO LOGICAL-FILE-REC.
079900     MOVE     WRK-IX-FD1-RECKEY TO IX-FD1-KEY.
080000     READ     IX-FD1  INTO   FILE-RECORD-INFO (9)
080100              KEY IS IX-FD1-KEY.
080200     MOVE     IX-FD1R1-F-G-240  TO  FILE-RECORD-INFO (1).
080300     PERFORM  INX-VERIFY-002.
080400     IF       XRECORD-NUMBER (9)   NOT EQUAL   TO LOGICAL-FILE-REC
080500              ADD   000100 TO ERROR-COUNTER-06V00.
080600     IF       EXCUT-COUNTER-06V00  LESS THAN 10
080700              GO TO   READ-TEST-F2-02.
080800     CLOSE    IX-FD1.
080900     PERFORM  INX-TEST-002.
081000*   .06
081100     GO TO  READ-INIT-F2-03.
081200 READ-DELETE-F2-02.
081300     MOVE "READ-TEST-F2-02     " TO PAR-NAME.
081400     PERFORM  DE-LETE.
081500     PERFORM  PRINT-DETAIL.
081600 READ-INIT-F2-03.
081700     MOVE "READ-TEST-F2-03     " TO PAR-NAME.
081800     MOVE "READ . KEY ALTERNATE" TO FEATURE.
081900     OPEN     INPUT  IX-FD1.
082000     PERFORM  INX-INIT-002-R.
082100     MOVE     ZERO  TO WRK-DU-05V00-002.
082200     MOVE     301  TO LOGICAL-FILE-REC.
082300 READ-TEST-F2-03.
082400     MOVE      SPACE TO FILE-RECORD-INFO (1).
082500     ADD      00005   TO WRK-DU-05V00-002.
082600     SUBTRACT  00006  FROM LOGICAL-FILE-REC.
082700     MOVE     WRK-IX-FD1-ALTKEY  TO IX-FD1-ALTKEY1.
082800     READ     IX-FD1  RECORD
082900                             KEY IX-FD1-ALTKEY1.
083000     MOVE     IX-FD1R1-F-G-240  TO  FILE-RECORD-INFO (1).
083100     PERFORM  INX-VERIFY-002.
083200     IF       EXCUT-COUNTER-06V00  LESS THAN 10
083300              GO TO   READ-TEST-F2-03.
083400     CLOSE    IX-FD1.
083500     PERFORM  INX-TEST-002.
083600*   .07
083700     GO TO  READ-INIT-F2-04.
083800 READ-DELETE-F2-03.
083900     MOVE "READ-TEST-F2-03     " TO PAR-NAME.
084000     PERFORM  DE-LETE.
084100     PERFORM  PRINT-DETAIL.
084200 READ-INIT-F2-04.
084300     MOVE "READ-TEST-F2-04     " TO PAR-NAME.
084400     MOVE "READ .RECORD KEY ..." TO FEATURE.
084500     OPEN     INPUT  IX-FD1.
084600     PERFORM  INX-INIT-002-R.
084700     MOVE     00301  TO WRK-DU-05V00-001.
084800     MOVE     SPACE TO IX-FD1R1-F-G-240.
084900 READ-TEST-F2-04.
085000     ADD      00005   TO WRK-DU-05V00-001.
085100     MOVE     WRK-IX-FD1-RECKEY TO IX-FD1-KEY.
085200     READ     IX-FD1  RECORD
085300                             KEY IX-FD1-KEY
085400     INVALID  SUBTRACT  000001  FROM ERROR-COUNTER-06V00.
085500     ADD     000001  TO EXCUT-COUNTER-06V00.
085600     IF       EXCUT-COUNTER-06V00  LESS THAN 10
085700              GO TO   READ-TEST-F2-04.
085800     CLOSE    IX-FD1.
085900     PERFORM  INX-TEST-002.
086000*   .08
086100     GO TO  READ-INIT-F2-05.
086200 READ-DELETE-F2-04.
086300     MOVE "READ-TEST-F2-04     " TO PAR-NAME.
086400     PERFORM  DE-LETE.
086500     PERFORM  PRINT-DETAIL.
086600 READ-INIT-F2-05.
086700     MOVE "READ-TEST-F2-05     " TO PAR-NAME.
086800     MOVE "READ RECORD KEY IS A" TO FEATURE.
086900     OPEN     INPUT  IX-FD1.
087000     PERFORM  INX-INIT-002-R.
087100     MOVE     00010  TO WRK-DU-05V00-001.
087200     MOVE     00301  TO WRK-DU-05V00-002.
087300     MOVE     SPACE TO IX-FD1R1-F-G-240.
087400 READ-TEST-F2-05.
087500     MOVE     WRK-IX-FD1-RECKEY TO IX-FD1-KEY.
087600     MOVE     SPACE TO FILE-RECORD-INFO (1).
087700     ADD      00005   TO WRK-DU-05V00-002.
087800     MOVE     WRK-IX-FD1-ALTKEY  TO IX-FD1-ALTKEY1.
087900     READ     IX-FD1  RECORD
088000                             KEY IS IX-FD1-ALTKEY1
088100     INVALID KEY SUBTRACT  000001  FROM ERROR-COUNTER-06V00.
088200     ADD    00001  TO EXCUT-COUNTER-06V00.
088300     IF       EXCUT-COUNTER-06V00  LESS THAN 10
088400              GO TO   READ-TEST-F2-05.
088500     CLOSE    IX-FD1.
088600     PERFORM  INX-TEST-002.
088700*   .09
088800     GO TO START-INIT-GF-01.
088900 READ-DELETE-F2-05.
089000     MOVE "READ-TEST-F2-05     " TO PAR-NAME.
089100     PERFORM  DE-LETE.
089200     PERFORM  PRINT-DETAIL.
089300 INX-INIT-002-R.
089400     MOVE     00010  TO ERROR-COUNTER-06V00.
089500     MOVE     ZERO TO EXCUT-COUNTER-06V00.
089600     MOVE     ZERO TO INV-KEY-COUNTER.
089700     MOVE     ZERO TO LOGICAL-FILE-REC.
089800 INX-VERIFY-002.
089900     ADD      000001    TO  EXCUT-COUNTER-06V00.
090000     ADD      000001    TO  LOGICAL-FILE-REC.
090100     IF       XRECORD-NUMBER (1) EQUAL TO  LOGICAL-FILE-REC
090200              SUBTRACT   000001 FROM  ERROR-COUNTER-06V00.
090300 INX-TEST-002.
090400     IF       ERROR-COUNTER-06V00 EQUAL TO ZERO
090500              PERFORM   PASS
090600              ELSE
090700              PERFORM   FAIL
090800              MOVE      ZERO TO   CORRECT-N
090900              MOVE      ERROR-COUNTER-06V00 TO COMPUTED-N
091000              MOVE "SEE PROGRAM (READ-TEST- ; IX-28)" TO RE-MARK.
091100     PERFORM  PRINT-DETAIL.
091200*
091300*       EACH TEST IS EXECUTED 10 TIMES EXCEPT FOR  INX-TEST-002-04
091400*    WHICH IS EXECUTED 300 TIMES.  FOLLOWING THE LAST
091500*    EXECUTION A TEST IS MADE ON ERROR-COUNTER-06V00 WHICH IS
091600*    EXPECTED TO BE ZERO.  IF ERROR-COUNTER-06V00 IS NOT ZERO
091700*    THE VALUE IN THE COUNTER INDICATES HOW THE EXECUTION FAILED
091800*    AND THE NUMBER OF TIMES THE UNEXPECTED ACTION OCCURRED
091900*    DURING THE TEST.  BEFORE THE TEST BEGINS ERROR-COUNTER-06V00
092000*    IS INITIALIZED WITH A VALUE.  EACH TIME THE CORRECT RECORD
092100*    WAS MADE AVAILABLE FOLLOWING THE READ, OR AN INVALID KEY
092200*    CONDITION OCCURRED THAT WAS EXPECTED FOLLOWING A READ OR
092300*    START, ERROR-COUNTER-06V00 IS DECREMENTED BY 1.
092400*    FOR EACH EXECUTION THAT DID NOT PRODUCE THE EXPECTED
092500*    RESULTS  THE ERROR-COUNTER-06V00 IS INCREMENTED BY THE VALUE
092600*    FOR THE ACTION LISTED BELOW, E.G., VALUE 20003 WOULD INDICATE
092700*    THAT OF THE 10 EXECUTIONS DURING THE TEST (READING LEFT TO
092800*    RIGHT)  2 INVALID KEY CONDITIONS AND 3 RECORDS RETRIEVED
092900*    AS A RESULT OF THE READ OR START WAS NOT-AS EXPECTED.
093000*
093100*
093200*
093300*    COMPUTED RESULT                 INDICATED
093400*       INCREMENTS                     ACTION
093500*
093600*       000100          THE  RECORD  FOUND IN THE IDENTIFIER
093700*                       SPECIFIED IN THE INTO PHRASE OF THE
093800*                       READ STATEMENT WAS NOT THE RECORD
093900*                       EXPECTED FOLLOWING EXECUTION OF THE
094000*                       READ.
094100*
094200*       000001          THE RECORD RETREIVED FROM THE FILE
094300*                       FOLLOWING THE READ WAS NOT THE ONE
094400*                       EXPECTED.
094500*
094600*       010000          AN UNEXPECTED INVALID KEY OR AT END
094700*                       CONDITION OCCURRED.  NOTE - ASSUMPTION
094800*                       IS THAT THE "USE" STATEMENT IS ONLY
094900*                       EXECUTED WHEN AN INVALID KEY OR AT END
095000*                       CONDITION OCCURS AND THE INVALID KEY OR
095100*                       AT END PHRASE HAS NOT BEEN SPECIFIED.
095200*
095300 START-INIT-GF-01.
095400     OPEN     INPUT  IX-FD1.
095500     OPEN     INPUT  IX-FS2.
095600     PERFORM  BLANK-LINE-PRINT.
095700     MOVE     "THE FOLLOWING TESTS ACCESS A FILE DEFINE AS
095800-             "ACCESS MODE IS SEQUENTIAL"  TO PRINT-REC.
095900     PERFORM  WRITE-LINE.
096000     PERFORM  BLANK-LINE-PRINT.
096100     MOVE "START-TEST-GF-01    " TO PAR-NAME.
096200     MOVE     "START  EQUAL TO"  TO FEATURE.
096300     PERFORM  INX-INIT-003-R.
096400 START-TEST-GF-01.
096500     ADD      00003   TO WRK-DU-05V00-003.
096600     MOVE     WRK-IX-FS2-RECKEY TO IX-FS2-KEY.
096700     START    IX-FS2.
096800     READ     IX-FS2       RECORD  AT END
096900             ADD   010000  TO ERROR-COUNTER-06V00
097000              GO TO      START-TEST-GF-01-1.
097100     MOVE     IX-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
097200     PERFORM  INX-VERIFY-003A.
097300     IF       EXCUT-COUNTER-06V00  LESS THAN 10
097400              GO TO   START-TEST-GF-01.
097500 START-TEST-GF-01-1.
097600     PERFORM  INX-TEST-003.
097700*   .01
097800     GO TO  START-INIT-GF-02.
097900 INX-DELETE-003-01.
098000     MOVE "START-TEST-GF-01    " TO PAR-NAME.
098100     PERFORM  DE-LETE.
098200     PERFORM  PRINT-DETAIL.
098300 START-INIT-GF-02.
098400     PERFORM  INX-INIT-003-R.
098500 START-TEST-GF-02.
098600     ADD      00003   TO WRK-DU-05V00-003.
098700     MOVE     WRK-IX-FS2-RECKEY TO IX-FS2-KEY.
098800     START    IX-FS2
098900                      KEY EQUAL TO IX-FS2-KEY.
099000     READ     IX-FS2       RECORD  AT END
099100             ADD   010000  TO ERROR-COUNTER-06V00
099200              GO TO     START-TEST-GF-02-1.
099300     MOVE     IX-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
099400     PERFORM  INX-VERIFY-003A.
099500     IF       EXCUT-COUNTER-06V00  LESS THAN 10
099600              GO TO    START-TEST-GF-02.
099700 START-TEST-GF-02-1.
099800     MOVE "START-TEST-GF-02    " TO PAR-NAME.
099900     MOVE "START KEY EQUAL TO  " TO FEATURE.
100000     PERFORM  INX-TEST-003.
100100*   .02
100200     GO TO   START-INIT-GF-03.
100300 START-DELETE-GF-02.
100400     MOVE "START-TEST-GF-02    " TO PAR-NAME.
100500     PERFORM  DE-LETE.
100600     PERFORM  PRINT-DETAIL.
100700 START-INIT-GF-03.
100800     PERFORM  INX-INIT-003-R.
100900 START-TEST-GF-03.
101000     ADD      00003   TO WRK-DU-05V00-003.
101100     MOVE     WRK-IX-FS2-RECKEY TO IX-FS2-KEY.
101200     START    IX-FS2
101300                      KEY IS EQUAL TO  IX-FS2-KEY.
101400     READ     IX-FS2       RECORD  AT END
101500             ADD   010000  TO ERROR-COUNTER-06V00
101600              GO TO    START-TEST-GF-03-1.
101700     MOVE     IX-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
101800     PERFORM  INX-VERIFY-003A.
101900     IF       EXCUT-COUNTER-06V00  LESS THAN 10
102000              GO TO    START-TEST-GF-03.
102100 START-TEST-GF-03-1.
102200     MOVE "START-TEST-GF-03    " TO PAR-NAME.
102300     MOVE "START KEY IS EQUAL  " TO FEATURE.
102400     PERFORM  INX-TEST-003.
102500*   .03
102600     GO TO  START-INIT-GF-04.
102700 START-DELETE-GF-03.
102800     MOVE "START-TEST-GF-03    " TO PAR-NAME.
102900     MOVE "START KEY IS EQUAL  " TO FEATURE.
103000     PERFORM  DE-LETE.
103100     PERFORM  PRINT-DETAIL.
103200 START-INIT-GF-04.
103300     PERFORM  INX-INIT-003-R.
103400 START-TEST-GF-04.
103500     ADD      00003   TO WRK-DU-05V00-003.
103600     MOVE     WRK-IX-FS2-RECKEY TO IX-FS2-KEY.
103700     START    IX-FS2
103800                      KEY IS EQUAL  IX-FS2-KEY.
103900     READ     IX-FS2       RECORD  AT END
104000             ADD   010000  TO ERROR-COUNTER-06V00
104100              GO TO       START-TEST-GF-04-1.
104200     MOVE     IX-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
104300     PERFORM  INX-VERIFY-003A.
104400     IF       EXCUT-COUNTER-06V00  LESS THAN 10
104500              GO TO   START-TEST-GF-04.
104600 START-TEST-GF-04-1.
104700     MOVE "START-TEST-GF-04    " TO PAR-NAME.
104800     MOVE "START KEY IS EQUAL  " TO FEATURE.
104900     PERFORM  INX-TEST-003.
105000*   .04
105100     GO TO START-INIT-GF-05.
105200 INX-DELETE-003-04.
105300     MOVE "START-TEST-GF-04    " TO PAR-NAME.
105400     PERFORM  DE-LETE.
105500     PERFORM  PRINT-DETAIL.
105600 START-INIT-GF-05.
105700     PERFORM  INX-INIT-003-R.
105800 START-TEST-GF-05.
105900     ADD      00003   TO WRK-DU-05V00-003.
106000     MOVE     WRK-IX-FS2-RECKEY TO IX-FS2-KEY.
106100     START    IX-FS2
106200                      KEY IS  =  IX-FS2-KEY.
106300     READ     IX-FS2       RECORD  AT END
106400             ADD   010000  TO ERROR-COUNTER-06V00
106500              GO TO       START-TEST-GF-05-1.
106600     MOVE     IX-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
106700     PERFORM  INX-VERIFY-003A.
106800     IF       EXCUT-COUNTER-06V00  LESS THAN 10
106900              GO TO    START-TEST-GF-05.
107000 START-TEST-GF-05-1.
107100     MOVE "START-TEST-GF-05    " TO PAR-NAME.
107200     MOVE "START KEY IS = ...  " TO FEATURE.
107300     PERFORM  INX-TEST-003.
107400*   .05
107500     GO TO  START-INIT-GF-06.
107600 START-DELETE-GF-05.
107700     MOVE "START-TEST-GF-05    " TO PAR-NAME.
107800     PERFORM  DE-LETE.
107900     PERFORM  PRINT-DETAIL.
108000 START-INIT-GF-06.
108100     PERFORM  INX-INIT-003-R.
108200     ADD      000001 TO LOGICAL-FILE-REC.
108300 START-TEST-GF-06.
108400     ADD      00003   TO WRK-DU-05V00-003.
108500     MOVE     WRK-IX-FS2-RECKEY TO IX-FS2-KEY.
108600     START    IX-FS2
108700                      KEY IS GREATER THAN  IX-FS2-KEY.
108800     READ     IX-FS2       RECORD  AT END
108900             ADD   010000  TO ERROR-COUNTER-06V00
109000              GO TO   START-TEST-GF-06-1.
109100     MOVE     IX-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
109200     PERFORM  INX-VERIFY-003A.
109300     IF       EXCUT-COUNTER-06V00  LESS THAN 10
109400              GO TO   START-TEST-GF-06.
109500 START-TEST-GF-06-1.
109600     MOVE "START-TEST-GF-06    " TO PAR-NAME.
109700     MOVE     "START  GREATER THAN"  TO FEATURE.
109800     PERFORM  INX-TEST-003.
109900*   .06
110000     GO TO START-INIT-GF-07.
110100 START-DELETE-GF-06.
110200     MOVE "START-TEST-GF-06    " TO PAR-NAME.
110300     PERFORM  DE-LETE.
110400     PERFORM  PRINT-DETAIL.
110500 START-INIT-GF-07.
110600     PERFORM  INX-INIT-003-R.
110700     ADD      000001 TO LOGICAL-FILE-REC.
110800 START-TEST-GF-07.
110900     ADD      00003   TO WRK-DU-05V00-003.
111000     MOVE     WRK-IX-FS2-RECKEY TO IX-FS2-KEY.
111100     START    IX-FS2
111200                      KEY GREATER THAN IX-FS2-KEY.
111300     READ     IX-FS2       RECORD  AT END
111400             ADD   010000  TO ERROR-COUNTER-06V00
111500              GO TO   START-TEST-GF-07-1.
111600     MOVE     IX-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
111700     PERFORM  INX-VERIFY-003A.
111800     IF       EXCUT-COUNTER-06V00  LESS THAN 10
111900              GO TO   START-TEST-GF-07.
112000 START-TEST-GF-07-1.
112100     MOVE "START-TEST-GF-07    " TO PAR-NAME.
112200     MOVE "START KEY GREATER THAN" TO FEATURE.
112300*   .07
112400     GO TO  START-INIT-GF-08.
112500 START-DELETE-GF-07.
112600     MOVE "START-TEST-GF-07    " TO PAR-NAME.
112700     PERFORM  DE-LETE.
112800     PERFORM  PRINT-DETAIL.
112900 START-INIT-GF-08.
113000     PERFORM  INX-INIT-003-R.
113100     SUBTRACT   WRK-DU-05V00-004  FROM  IX-FS2-FILESIZE
113200              GIVING     LOGICAL-FILE-REC.
113300     MOVE     "DN"  TO ASCEND-DESEND-SWITCH.
113400 START-TEST-GF-08.
113500     ADD      00003   TO WRK-DU-05V00-004.
113600     MOVE     WRK-IX-FS2-ALTKEY  TO IX-FS2-ALTKEY1.
113700     START    IX-FS2
113800                      KEY IS GREATER IX-FS2-ALTKEY1.
113900     READ     IX-FS2       RECORD  AT END
114000             ADD   010000  TO ERROR-COUNTER-06V00
114100              GO TO       START-TEST-GF-08-1.
114200     MOVE     IX-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
114300     PERFORM  INX-VERIFY-003A.
114400     IF       EXCUT-COUNTER-06V00  LESS THAN 10
114500              GO TO    START-TEST-GF-08.
114600 START-TEST-GF-08-1.
114700     MOVE "START-TEST-GF-08    " TO PAR-NAME.
114800     MOVE "START KEY IS GREATER" TO FEATURE.
114900     PERFORM  INX-TEST-003.
115000*   .08
115100     GO TO   START-INIT-GF-09.
115200 START-DELETE-GF-08.
115300     MOVE "START-TEST-GF-08    " TO PAR-NAME.
115400     PERFORM  DE-LETE.
115500     PERFORM  PRINT-DETAIL.
115600 START-INIT-GF-09.
115700     PERFORM  INX-INIT-003-R.
115800     SUBTRACT   WRK-DU-05V00-004  FROM  IX-FS2-FILESIZE
115900              GIVING     LOGICAL-FILE-REC.
116000     MOVE     "DN"  TO ASCEND-DESEND-SWITCH.
116100 START-TEST-GF-09.
116200     ADD      00003   TO WRK-DU-05V00-004.
116300     MOVE     WRK-IX-FS2-ALTKEY  TO IX-FS2-ALTKEY1.
116400     START    IX-FS2
116500                      KEY IS >  IX-FS2-ALTKEY1.
116600     READ     IX-FS2       RECORD  AT END
116700             ADD   010000  TO ERROR-COUNTER-06V00
116800              GO TO       START-TEST-GF-09-1.
116900     MOVE     IX-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
117000     PERFORM   INX-VERIFY-003A.
117100     IF       EXCUT-COUNTER-06V00  LESS THAN 10
117200              GO TO START-TEST-GF-09.
117300 START-TEST-GF-09-1.
117400     MOVE "START-TEST-GF-09    " TO PAR-NAME.
117500     MOVE "START KEY IS > ...  " TO FEATURE.
117600     PERFORM  INX-TEST-003.
117700*   .09
117800     GO TO START-INIT-GF-10.
117900 START-DELETE-GF-09.
118000     MOVE "START-TEST-GF-09    " TO PAR-NAME.
118100     PERFORM  DE-LETE.
118200     PERFORM  PRINT-DETAIL.
118300 START-INIT-GF-10.
118400     PERFORM  INX-INIT-003-R.
118500     SUBTRACT   WRK-DU-05V00-004  FROM  IX-FS2-FILESIZE
118600              GIVING     LOGICAL-FILE-REC.
118700     MOVE     "DN"  TO ASCEND-DESEND-SWITCH.
118800 START-TEST-GF-10.
118900     ADD      00003   TO WRK-DU-05V00-004.
119000     MOVE     WRK-IX-FS2-ALTKEY  TO IX-FS2-ALTKEY1.
119100     START    IX-FS2
119200                      KEY  > IX-FS2-ALTKEY1.
119300     READ     IX-FS2       RECORD  AT END
119400             ADD   010000  TO ERROR-COUNTER-06V00
119500              GO TO       START-TEST-GF-10-1.
119600     MOVE     IX-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
119700     PERFORM  INX-VERIFY-003A.
119800     IF       EXCUT-COUNTER-06V00  LESS THAN 10
119900              GO TO   START-TEST-GF-10.
120000 START-TEST-GF-10-1.
120100     MOVE "START-TEST-GF-10    " TO PAR-NAME.
120200     MOVE "START ... KEY > ... " TO FEATURE.
120300     PERFORM  INX-TEST-003.
120400*   .10
120500     GO TO  START-INIT-GF-11.
120600 START-DELETE-GF-10.
120700     MOVE "START-TEST-GF-10    " TO PAR-NAME.
120800     PERFORM  DE-LETE.
120900     PERFORM  PRINT-DETAIL.
121000 START-INIT-GF-11.
121100     MOVE     "START  NOT LESS THAN" TO FEATURE.
121200     PERFORM  INX-INIT-003-R.
121300     SUBTRACT   WRK-DU-05V00-004  FROM  IX-FS2-FILESIZE
121400              GIVING     LOGICAL-FILE-REC.
121500     ADD      000001  TO LOGICAL-FILE-REC.
121600     MOVE     "DN"  TO ASCEND-DESEND-SWITCH.
121700 START-TEST-GF-11.
121800     ADD      00003   TO WRK-DU-05V00-004.
121900     MOVE     WRK-IX-FS2-ALTKEY  TO IX-FS2-ALTKEY1.
122000     START    IX-FS2
122100                      KEY IS NOT LESS THAN IX-FS2-ALTKEY1.
122200     READ     IX-FS2       RECORD  AT END
122300             ADD   010000  TO ERROR-COUNTER-06V00
122400              GO TO       START-TEST-GF-11-1.
122500     MOVE     IX-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
122600     PERFORM  INX-VERIFY-003A.
122700     IF       EXCUT-COUNTER-06V00  LESS THAN 10
122800              GO TO    START-TEST-GF-11.
122900 START-TEST-GF-11-1.
123000     MOVE "START-TEST-GF-11    " TO PAR-NAME.
123100     MOVE "START KEY IS NOT LESS THAN" TO FEATURE.
123200     PERFORM  INX-TEST-003.
123300*   .11
123400     GO TO START-INIT-GF-12.
123500 START-DELETE-GF-22.
123600     MOVE "START-TEST-GF-11    " TO PAR-NAME.
123700     PERFORM  DE-LETE.
123800     PERFORM PRINT-DETAIL.
123900 START-INIT-GF-12.
124000     PERFORM  INX-INIT-003-R.
124100     SUBTRACT   WRK-DU-05V00-004  FROM  IX-FS2-FILESIZE
124200              GIVING     LOGICAL-FILE-REC.
124300     ADD      000001  TO LOGICAL-FILE-REC.
124400     MOVE     "DN"  TO ASCEND-DESEND-SWITCH.
124500 START-TEST-GF-12.
124600     ADD      00003   TO WRK-DU-05V00-004.
124700     MOVE     WRK-IX-FS2-ALTKEY  TO IX-FS2-ALTKEY1.
124800     START    IX-FS2
124900                      KEY IS NOT LESS  IX-FS2-ALTKEY1.
125000     READ     IX-FS2       RECORD  AT END
125100             ADD   010000  TO ERROR-COUNTER-06V00
125200              GO TO       START-TEST-GF-12-1.
125300     MOVE     IX-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
125400     PERFORM  INX-VERIFY-003A.
125500     IF       EXCUT-COUNTER-06V00  LESS THAN 10
125600              GO TO   START-TEST-GF-12.
125700 START-TEST-GF-12-1.
125800     MOVE "START-TEST-GF-12    " TO PAR-NAME.
125900     MOVE "START KEY IS NOT LESS" TO FEATURE.
126000     PERFORM  INX-TEST-003.
126100*   .12
126200     GO TO START-INIT-GF-13.
126300 START-DELETE-GF-12.
126400     MOVE "START-TEST-GF-12    " TO PAR-NAME.
126500     PERFORM  DE-LETE.
126600     PERFORM  PRINT-DETAIL.
126700 START-INIT-GF-13.
126800     PERFORM  INX-INIT-003-R.
126900     SUBTRACT   WRK-DU-05V00-004  FROM  IX-FS2-FILESIZE
127000              GIVING     LOGICAL-FILE-REC.
127100     ADD      000001  TO LOGICAL-FILE-REC.
127200     MOVE     "DN"  TO ASCEND-DESEND-SWITCH.
127300 START-TEST-GF-13.
127400     ADD      00003   TO WRK-DU-05V00-004.
127500     MOVE     WRK-IX-FS2-ALTKEY  TO IX-FS2-ALTKEY1.
127600     START    IX-FS2
127700                      KEY NOT LESS THAN  IX-FS2-ALTKEY1.
127800     READ     IX-FS2       RECORD  AT END
127900             ADD   010000  TO ERROR-COUNTER-06V00
128000              GO TO       START-TEST-GF-13-1.
128100     MOVE     IX-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
128200     PERFORM  INX-VERIFY-003A.
128300     IF       EXCUT-COUNTER-06V00  LESS THAN 10
128400              GO TO    START-TEST-GF-13.
128500 START-TEST-GF-13-1.
128600     MOVE "START-TEST-GF-13    " TO PAR-NAME.
128700     MOVE "START KEY NOT LESS THAN " TO FEATURE.
128800     PERFORM  INX-TEST-003.
128900*   .13
129000     GO TO START-INIT-GF-14.
129100 START-DELETE-GF-13.
129200     MOVE "START-TEST-GF-13    " TO PAR-NAME.
129300     PERFORM  DE-LETE.
129400     PERFORM  PRINT-DETAIL.
129500 START-INIT-GF-14.
129600     PERFORM  INX-INIT-003-R.
129700     SUBTRACT   WRK-DU-05V00-004  FROM  IX-FS2-FILESIZE
129800              GIVING     LOGICAL-FILE-REC.
129900     ADD      000001  TO LOGICAL-FILE-REC.
130000     MOVE     "DN"  TO ASCEND-DESEND-SWITCH.
130100 START-TEST-GF-14.
130200     ADD      00003   TO WRK-DU-05V00-004.
130300     MOVE     WRK-IX-FS2-ALTKEY  TO IX-FS2-ALTKEY1.
130400     START    IX-FS2
130500                      KEY IS NOT  <   IX-FS2-ALTKEY1.
130600     READ     IX-FS2       RECORD  AT END
130700             ADD   010000  TO ERROR-COUNTER-06V00
130800              GO TO       START-TEST-GF-14-1.
130900     MOVE     IX-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
131000     PERFORM  INX-VERIFY-003A.
131100     IF       EXCUT-COUNTER-06V00  LESS THAN 10
131200              GO TO   START-TEST-GF-14.
131300 START-TEST-GF-14-1.
131400     MOVE "START-TEST-GF-14    " TO PAR-NAME.
131500     MOVE "START KEY IS NOT <  " TO FEATURE.
131600     PERFORM  INX-TEST-003.
131700*   .14
131800     GO TO  START-INIT-GF-15.
131900 START-DELETE-GF-14.
132000     MOVE "START-TEST-GF-14    " TO PAR-NAME.
132100     PERFORM  DE-LETE.
132200     PERFORM  PRINT-DETAIL.
132300 START-INIT-GF-15.
132400     PERFORM  BLANK-LINE-PRINT.
132500     MOVE     "THE FOLLOWING TESTS ACCESS A FILE DEFINED AS
132600-             "ACCESS MODE IS DYNAMIC"  TO PRINT-REC.
132700     PERFORM  WRITE-LINE.
132800     PERFORM  BLANK-LINE-PRINT.
132900     MOVE     "START  EQUAL TO " TO FEATURE.
133000     PERFORM  INX-INIT-003-R.
133100     SUBTRACT   WRK-DU-05V00-002  FROM  IX-FD1-FILESIZE
133200              GIVING     LOGICAL-FILE-REC.
133300     ADD      000001  TO LOGICAL-FILE-REC.
133400     MOVE     "DN"  TO ASCEND-DESEND-SWITCH.
133500 START-TEST-GF-15.
133600     ADD      000002  TO WRK-DU-05V00-002.
133700     MOVE     WRK-IX-FD1-ALTKEY  TO IX-FD1-ALTKEY1.
133800     START    IX-FD1
133900                      KEY IS EQUAL TO  IX-FD1-ALTKEY1
134000     INVALID KEY  ADD 010000  TO ERROR-COUNTER-06V00.
134100     READ     IX-FD1  NEXT RECORD  AT END
134200              ADD   010000  TO ERROR-COUNTER-06V00
134300              GO TO       START-TEST-GF-15-1.
134400     MOVE     IX-FD1R1-F-G-240  TO  FILE-RECORD-INFO (1).
134500     PERFORM  INX-VERIFY-003B.
134600     IF       EXCUT-COUNTER-06V00  LESS THAN 10
134700              GO TO    START-TEST-GF-15.
134800 START-TEST-GF-15-1.
134900     MOVE "START-TEST-GF-15    " TO PAR-NAME.
135000     MOVE "START KEY IS EQUAL TO" TO FEATURE.
135100     PERFORM  INX-TEST-003.
135200*   .15
135300     GO TO START-INIT-GF-16.
135400 START-DELETE-GF-15.
135500     MOVE "START-TEST-GF-15    " TO PAR-NAME.
135600     PERFORM  DE-LETE.
135700     PERFORM  PRINT-DETAIL.
135800 START-INIT-GF-16.
135900     MOVE      00055  TO WRK-DU-05V00-001.
136000     MOVE     WRK-IX-FD1-RECKEY TO IX-FD1-KEY.
136100     MOVE     "START  INVALID KEY"  TO FEATURE.
136200     PERFORM  INX-INIT-003-R.
136300     MOVE     IX-FD1-FILESIZE  TO  LOGICAL-FILE-REC.
136400     MOVE     IX-FD1-FILESIZE  TO  WRK-DU-05V00-002.
136500 START-TEST-GF-16.
136600     ADD      000002  TO WRK-DU-05V00-002.
136700     MOVE     WRK-IX-FD1-ALTKEY  TO IX-FD1-ALTKEY1.
136800     START    IX-FD1
136900                      KEY IS EQUAL TO IX-FD1-ALTKEY1
137000      INVALID SUBTRACT   000001  FROM ERROR-COUNTER-06V00.
137100     ADD      000001 TO EXCUT-COUNTER-06V00.
137200     IF       EXCUT-COUNTER-06V00  LESS THAN 10
137300              GO TO    START-TEST-GF-16.
137400     MOVE "START-TEST-GF-16    " TO PAR-NAME.
137500     PERFORM  INX-TEST-003.
137600*   .16
137700     GO TO    START-INIT-GF-17.
137800 START-DELETE-GF-16.
137900     MOVE "START-TEST-GF-16    " TO PAR-NAME.
138000     PERFORM  DE-LETE.
138100     PERFORM PRINT-DETAIL.
138200 START-INIT-GF-17.
138300     MOVE     00055  TO WRK-DU-05V00-002.
138400     MOVE     WRK-IX-FD1-ALTKEY TO IX-FD1-ALTKEY1.
138500     PERFORM  INX-INIT-003-R.
138600     MOVE     IX-FD1-FILESIZE  TO  LOGICAL-FILE-REC.
138700     MOVE     IX-FD1-FILESIZE  TO  WRK-DU-05V00-001.
138800 START-TEST-GF-17.
138900     ADD      00003   TO WRK-DU-05V00-001.
139000     MOVE     WRK-IX-FD1-RECKEY TO IX-FD1-KEY.
139100     START    IX-FD1   INVALID KEY
139200              SUBTRACT   000001  FROM ERROR-COUNTER-06V00.
139300     ADD      000001 TO EXCUT-COUNTER-06V00.
139400     IF       EXCUT-COUNTER-06V00  LESS THAN 10
139500              GO TO    START-TEST-GF-17.
139600     MOVE "START-TEST-GF-17    " TO PAR-NAME.
139700     PERFORM  INX-TEST-003.
139800*   .17
139900     GO TO   START-INIT-GF-18.
140000 START-DELETE-GF-17.
140100     MOVE "START-TEST-GF-17    " TO PAR-NAME.
140200     PERFORM  DE-LETE.
140300     PERFORM  PRINT-DETAIL.
140400 START-INIT-GF-18.
140500     MOVE     00055  TO WRK-DU-05V00-002.
140600     MOVE     WRK-IX-FD1-ALTKEY TO IX-FD1-ALTKEY1.
140700     PERFORM  INX-INIT-003-R.
140800     MOVE     IX-FD1-FILESIZE  TO  LOGICAL-FILE-REC.
140900     MOVE     IX-FD1-FILESIZE  TO  WRK-DU-05V00-001.
141000 START-TEST-GF-18.
141100     ADD      00003   TO WRK-DU-05V00-001.
141200     MOVE     WRK-IX-FD1-RECKEY TO IX-FD1-KEY.
141300     START    IX-FD1  ; INVALID KEY
141400              SUBTRACT   000001  FROM ERROR-COUNTER-06V00.
141500     ADD      000001 TO EXCUT-COUNTER-06V00.
141600     IF       EXCUT-COUNTER-06V00  LESS THAN 10
141700              GO TO    START-TEST-GF-18.
141800     MOVE "START-TEST-GF-18    " TO PAR-NAME.
141900     PERFORM  INX-TEST-003.
142000*   .18
142100     GO TO START-INIT-GF-19.
142200 START-DELETE-GF-18.
142300     MOVE "START-TEST-GF-18    " TO PAR-NAME.
142400     PERFORM  DE-LETE.
142500     PERFORM  PRINT-DETAIL.
142600 START-INIT-GF-19.
142700     PERFORM  INX-INIT-003-R.
142800     MOVE     IX-FD1-FILESIZE  TO  WRK-DU-05V00-001.
142900     MOVE     WRK-IX-FD1-RECKEY TO IX-FD1-KEY.
143000     MOVE     IX-FD1-FILESIZE  TO  WRK-DU-05V00-002.
143100 START-TEST-GF-19.
143200     ADD      000002  TO WRK-DU-05V00-002.
143300     MOVE     WRK-IX-FD1-ALTKEY TO IX-FD1-ALTKEY1.
143400     START    IX-FD1
143500                     KEY IS EQUAL TO  IX-FD1-ALTKEY1
143600     ; INVALID KEY SUBTRACT 000001  FROM ERROR-COUNTER-06V00.
143700     ADD      000001  TO EXCUT-COUNTER-06V00.
143800     IF       EXCUT-COUNTER-06V00  LESS THAN 10
143900              GO TO   START-TEST-GF-19.
144000     MOVE "START-TEST-GF-19    " TO PAR-NAME.
144100     PERFORM  INX-TEST-003.
144200*   .19
144300     GO TO START-END.
144400 START-DELETE-GF-19.
144500     MOVE "START-TEST-GF-19    " TO PAR-NAME.
144600     PERFORM  DE-LETE.
144700     PERFORM  PRINT-DETAIL.
144800 INX-INIT-003-R.
144900     MOVE     ZERO TO LOGICAL-FILE-REC.
145000     MOVE     ZERO TO EXCUT-COUNTER-06V00.
145100     MOVE     00055  TO WRK-DU-05V00-002.
145200     MOVE     00050  TO WRK-DU-05V00-004.
145300     MOVE     ZERO TO WRK-DU-05V00-003.
145400     MOVE     10  TO ERROR-COUNTER-06V00.
145500 INX-VERIFY-003A.
145600     IF       ASCEND
145700              ADD    000003  TO LOGICAL-FILE-REC
145800              ELSE
145900              SUBTRACT   000003  FROM  LOGICAL-FILE-REC.
146000     IF       LOGICAL-FILE-REC  EQUAL  TO XRECORD-NUMBER (2)
146100              SUBTRACT   000001  FROM ERROR-COUNTER-06V00.
146200     ADD      000001 TO EXCUT-COUNTER-06V00.
146300 INX-VERIFY-003B.
146400     IF       ASCEND
146500              ADD    000002  TO LOGICAL-FILE-REC
146600              ELSE
146700              SUBTRACT   000002  FROM  LOGICAL-FILE-REC.
146800     IF       LOGICAL-FILE-REC  EQUAL  TO XRECORD-NUMBER (1)
146900              SUBTRACT   000001  FROM ERROR-COUNTER-06V00.
147000     ADD      000001 TO EXCUT-COUNTER-06V00.
147100 INX-TEST-003.
147200     IF       EXCUT-COUNTER-06V00  NOT EQUAL  TO 000010
147300              MULTIPLY  100  BY   EXCUT-COUNTER-06V00
147400              ADD  EXCUT-COUNTER-06V00 TO ERROR-COUNTER-06V00.
147500     IF       ERROR-COUNTER-06V00 EQUAL TO ZERO
147600              PERFORM PASS
147700              ELSE
147800              PERFORM   FAIL
147900              MOVE   ZERO  TO CORRECT-N
148000              MOVE     ERROR-COUNTER-06V00  TO COMPUTED-N
148100              MOVE "SEE PROGRAM (START-TEST- ); IX-36" TO RE-MARK.
148200     PERFORM  PRINT-DETAIL.
148300*
148400*       EACH TEST IS EXECUTED 10 TIMES.  FOLLOWING THE 10TH
148500*    EXECUTION A TEST IS MADE ON ERROR-COUNTER-06V00 WHICH IS
148600*    EXPECTED TO BE ZERO.  IF ERROR-COUNTER-06V00 IS NOT ZERO
148700*    THE VALUE IN THE COUNTER INDICATES HOW THE EXECUTION FAILED
148800*    AND THE NUMBER OF TIMES THE UNEXPECTED ACTION OCCURRED
148900*    DURING THE TEST.  BEFORE THE TEST BEGINS ERROR-COUNTER-06V00
149000*    IS LOADED WITH THE VALUE 10.  EACH TIME THE CORRECT RECORD
149100*    WAS MADE AVAILABLE FOLLOWING THE READ, OR AN INVALID KEY
149200*    CONDITION OCCURRED THAT WAS EXPECTED FOLLOWING A READ OR
149300*    START, ERROR-COUNTER-06V00 IS DECREMENTED BY 1.
149400*    FOR EACH ACTION THAT DID NOT OCCUR AS
149500*    EXPECTED THE ERROR-COUNTER-06V00 IS INCREMENTED BY THE VALUE
149600*    FOR THE ACTION LISTED BELOW, E.G., VALUE 20003 WOULD INDICATE
149700*    THAT OF THE 10 EXECUTIONS DURING THE TEST (READING LEFT TO
149800*    RIGHT)  2 INVALID KEY CONDITIONS AND 3 RECORDS RETRIEVED
149900*    AS A RESULT OF THE READ OR START WAS NOT AS EXPECTED.
150000*
150100*    COMPUTED RESULT                 INDICATED
150200*       INCREMENTS                     ACTION
150300*
150400*       000001          THE RECORD RETREIVED FROM THE FILE
150500*                       FOLLOWING THE READ WAS NOT THE ONE
150600*                       EXPECTED.
150700*
150800*       000100          INDICATES,BY 10"S THE NUMBER OF TIMES THE
150900*                       TEST WAS EXECUTED.
151000*
151100*       010000          AN UNEXPECTED INVALID KEY OR AT END
151200*                       CONDITION OCCURRED.  NOTE - ASSUMPTION
151300*                       IS THAT THE "USE" STATEMENT IS ONLY
151400*                       EXECUTED WHEN AN INVALID KEY OR AT END
151500*                       CONDITION OCCURS AND THE INVALID KEY OR
151600*                       AT END PHRASE HAS NOT BEEN SPECIFIED.
151700*
151800 START-END.
151900     CLOSE    IX-FD1.
152000      CLOSE   IX-FS2.
152100 INX-EXIT-003.
152200     EXIT.
152300 CCVS-EXIT SECTION.
152400 CCVS-999999.
152500     GO TO CLOSE-FILES.
