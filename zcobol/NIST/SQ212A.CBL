000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ212A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    " HIGH       ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "4.2 ".
001100*                                                              *
001200*        THIS ROUTINE CHECKS THE
001300*                   FILE STATUS VALUE  44 (BOUNDARY VIOLATION)
001400*
001500*         FOR:    WRITE SMALLER OR LAGER RECORDS
001600*         AND:    REWRITE SMALLER OR LAGER RECORDS
001700*
001800*         FOR A FILE WITH VARIABLE LENGTH RECORDS FOLLOWING:
001900*
002000*           RECORD IS VARYING IN SIZE FROM 18 TO 2048 CHARACTERS
002100*             DEPENDING ON DATA-NAME-1.
002200*
002300*    AN  ATTEMPT  IS  MADE  TO WRITE 3 SMALLER RECORDS. THEN 2031
002400*    RECORDS  SHOULD  BE WRITTEN AND THEN FUTHER 9 LARGER RECORDS
002500*    SHOULD  CAUSE  A  BOUNDARY  VIOLATION  WITH  STATUS CODE 44.
002600*    THEN  THE  FILE  IS  CLOSED  AND  OPENED  AGAIN  FOR  INPUT.
002700*    2031  RECORDS WILL BE READ. THEN THE RECORD NO 2031 IS TRIED
002800*    BE   READ.  THIS  READ  STATEMENT  MUST  CAUSE  THE  AT  END
002900*    CONDITION.  IF  THERE  IS  ANOTHER RECORD, IT DOES MEAN THAT
003000*    EITHER A SMALLER OR A LARGER RECORD HAVE BEEN WRITTEN.
003100*    (SEE VII-5; 1.3.7 AND VII-54; GR (13) ).
003200*
003300*
003400*    THIS  ROUTINE  BUILDS  A  SEQUENTIAL MASS STORAGE FILE WHICH
003500*    CONTAINS  2031 RECORDS OF A LENGTH OF 18 TO 2048 CHARACTERS.
003600*    THE  MASS STORAGE FILE IS READ AND FIELDS IN THE RECORDS ARE
003700*    CHECKED AGAINST THE EXPECTED VALUES.
003800*
003900 ENVIRONMENT DIVISION.
004000 CONFIGURATION SECTION.
004100 SOURCE-COMPUTER.
004200     XXXXX082.
004300 OBJECT-COMPUTER.
004400     XXXXX083.
004500 INPUT-OUTPUT SECTION.
004600 FILE-CONTROL.
004700P    SELECT RAW-DATA   ASSIGN TO
004800P    XXXXX062
004900P           ORGANIZATION IS INDEXED
005000P           ACCESS MODE IS RANDOM
005100P           RECORD KEY IS RAW-DATA-KEY.
005200     SELECT PRINT-FILE ASSIGN TO
005300     XXXXX055.
005400     SELECT SQ-VS7 ASSIGN TO
005500     XXXXX014
005600     ORGANIZATION SEQUENTIAL
005700     ACCESS SEQUENTIAL
005800     STATUS IS SQ-VS7-STATUS.
005900 DATA DIVISION.
006000 FILE SECTION.
006100P
006200PFD  RAW-DATA.
006300P
006400P01  RAW-DATA-SATZ.
006500P    05  RAW-DATA-KEY        PIC X(6).
006600P    05  C-DATE              PIC 9(6).
006700P    05  C-TIME              PIC 9(8).
006800P    05  C-NO-OF-TESTS       PIC 99.
006900P    05  C-OK                PIC 999.
007000P    05  C-ALL               PIC 999.
007100P    05  C-FAIL              PIC 999.
007200P    05  C-DELETED           PIC 999.
007300P    05  C-INSPECT           PIC 999.
007400P    05  C-NOTE              PIC X(13).
007500P    05  C-INDENT            PIC X.
007600P    05  C-ABORT             PIC X(8).
007700 FD  PRINT-FILE
007800C    LABEL RECORDS
007900C    XXXXX084
008000C    DATA RECORD IS PRINT-REC DUMMY-RECORD
008100               .
008200 01  PRINT-REC PICTURE X(120).
008300 01  DUMMY-RECORD PICTURE X(120).
008400 FD  SQ-VS7
008500C    LABEL RECORDS ARE STANDARD
008600     RECORD IS VARYING IN SIZE FROM 18 TO 2048 CHARACTERS
008700       DEPENDING ON RECORD-LENGTH.
008800 01  SQ-VSR7R1-M-G-2048.
008900     02  SQ-VS7R1-FIRST PICTURE X(2048).
009000 WORKING-STORAGE SECTION.
009100 01  SWITCH-WRITE-REWRITE PICTURE 9   VALUE ZERO.
009200 01  RECORD-LENGTH       PICTURE 9999 VALUE ZERO.
009300 01  SQ-VS7-STATUS       PICTURE XX   VALUE SPACES.
009400 01  SAVE-COUNT-OF-RECS  PICTURE X(5) VALUE SPACE.
009500 01  COUNT-OF-RECS  PICTURE S9(5) COMPUTATIONAL.
009600 01  RECORDS-IN-ERROR  PICTURE S9(5) COMPUTATIONAL
009700                              VALUE ZERO.
009800 01  ERROR-FLAG PICTURE 9.
009900 01  EOF-FLAG  PICTURE 9.
010000 01  DUMP-AREA.
010100     02  TYPE-OF-REC PICTURE X(5).
010200     02  RECNO  PICTURE 9(5).
010300     02  REC-FILLER PICTURE X(21).
010400     02  REC-FILLER PICTURE X(21).
010500 01  VAR-RECORD-18-2048.
010600     05  FILLER PIC X(13) VALUE "SQ-VS7LENGTH=".
010700     05  RECORD-NUMBER PIC 9999 VALUE ZERO.
010800     05  FILLER      PIC X(100) VALUE
010900     "........10........20........30........40........50........60
011000-    "........70........80........90.......100".
011100     05  FILLER      PIC X(100) VALUE
011200     ".......110.......120.......130.......140.......150.......160
011300-    ".......170.......180.......190.......200".
011400     05  FILLER      PIC X(100) VALUE
011500     ".......210.......220.......230.......240.......250.......260
011600-    ".......270.......280.......290.......300".
011700     05  FILLER      PIC X(100) VALUE
011800     ".......310.......320.......330.......340.......350.......360
011900-    ".......370.......380.......390.......400".
012000     05  FILLER      PIC X(100) VALUE
012100     ".......410.......420.......430.......440.......450.......460
012200-    ".......470.......480.......490.......500".
012300     05  FILLER      PIC X(100) VALUE
012400     ".......510.......520.......530.......540.......550.......560
012500-    ".......570.......580.......590.......600".
012600     05  FILLER      PIC X(100) VALUE
012700     ".......610.......620.......630.......640.......650.......660
012800-    ".......670.......680.......690.......700".
012900     05  FILLER      PIC X(100) VALUE
013000     ".......710.......720.......730.......740.......750.......760
013100-    ".......770.......780.......790.......800".
013200     05  FILLER      PIC X(100) VALUE
013300     ".......810.......820.......830.......840.......850.......860
013400-    ".......870.......880.......890.......900".
013500     05  FILLER      PIC X(100) VALUE
013600     ".......910.......920.......930.......940.......950.......960
013700-    ".......970.......980.......990......1000".
013800     05  FILLER      PIC X(100) VALUE
013900     "......1010......1020......1030......1040......1050......1060
014000-    "......1070......1080......1090......1100".
014100     05  FILLER      PIC X(100) VALUE
014200     "......1110......1120......1130......1140......1150......1160
014300-    "......1170......1180......1190......1200".
014400     05  FILLER      PIC X(100) VALUE
014500     "......1210......1220......1230......1240......1250......1260
014600-    ".......270.......280.......290.......300".
014700     05  FILLER      PIC X(100) VALUE
014800     "......1310......1320......1330......1340......1350......1360
014900-    "......1370......1380......1390......1400".
015000     05  FILLER      PIC X(100) VALUE
015100     "......1410......1420......1430......1440......1450......1460
015200-    "......1470......1480......1490......1500".
015300     05  FILLER      PIC X(100) VALUE
015400     "......1510......1520......1530......1540......1550......1560
015500-    "......1570......1580......1590......1600".
015600     05  FILLER      PIC X(100) VALUE
015700     "......1610......1620......1630......1640......1650......1660
015800-    "......1670......1680......1690......1700".
015900     05  FILLER      PIC X(100) VALUE
016000     "......1710......1720......1730......1740......1750......1760
016100-    "......1770......1780......1790......1800".
016200     05  FILLER      PIC X(100) VALUE
016300     "......1810......1820......1830......1840......1850......1860
016400-    "......1870......1880......1890......1900".
016500     05  FILLER      PIC X(100) VALUE
016600     "......1910......1920......1930......1940......1950......1960
016700-    "......1970......1980......1990......2000".
016800     05  FILLER      PIC X(100) VALUE
016900     "......2010......2020......2030......2040....,...".
017000 01  TEST-RESULTS.
017100     02 FILLER                    PICTURE X VALUE SPACE.
017200     02 FEATURE                   PICTURE X(20) VALUE SPACE.
017300     02 FILLER                    PICTURE X VALUE SPACE.
017400     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
017500     02 FILLER                    PICTURE X  VALUE SPACE.
017600     02  PAR-NAME.
017700       03 FILLER PICTURE X(12) VALUE SPACE.
017800       03  PARDOT-X PICTURE X  VALUE SPACE.
017900       03 DOTVALUE PICTURE 99  VALUE ZERO.
018000       03 FILLER PIC X(5) VALUE SPACE.
018100     02 FILLER PIC X(10) VALUE SPACE.
018200     02 RE-MARK PIC X(61).
018300 01  TEST-COMPUTED.
018400     02 FILLER PIC X(30) VALUE SPACE.
018500     02 FILLER PIC X(17) VALUE "       COMPUTED=".
018600     02 COMPUTED-X.
018700     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
018800     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
018900     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
019000     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
019100     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
019200     03       CM-18V0 REDEFINES COMPUTED-A.
019300         04 COMPUTED-18V0                   PICTURE -9(18).
019400         04 FILLER                          PICTURE X.
019500     03 FILLER PIC X(50) VALUE SPACE.
019600 01  TEST-CORRECT.
019700     02 FILLER PIC X(30) VALUE SPACE.
019800     02 FILLER PIC X(17) VALUE "       CORRECT =".
019900     02 CORRECT-X.
020000     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
020100     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
020200     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
020300     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
020400     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
020500     03      CR-18V0 REDEFINES CORRECT-A.
020600         04 CORRECT-18V0                    PICTURE -9(18).
020700         04 FILLER                          PICTURE X.
020800     03 FILLER PIC X(50) VALUE SPACE.
020900 01  CCVS-C-1.
021000     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
021100-    "SS  PARAGRAPH-NAME
021200-    "        REMARKS".
021300     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
021400 01  CCVS-C-2.
021500     02 FILLER PICTURE IS X VALUE IS SPACE.
021600     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
021700     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
021800     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
021900     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
022000 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
022100 01  REC-CT PICTURE 99 VALUE ZERO.
022200 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
022300 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
022400 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
022500 01  PASS-COUNTER PIC 999 VALUE ZERO.
022600 01  TOTAL-ERROR PIC 999 VALUE ZERO.
022700 01  ERROR-HOLD PIC 999 VALUE ZERO.
022800 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
022900 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
023000 01  CCVS-H-1.
023100     02  FILLER   PICTURE X(27)  VALUE SPACE.
023200     02 FILLER PICTURE X(67) VALUE
023300     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
023400-    " SYSTEM".
023500     02  FILLER     PICTURE X(26)  VALUE SPACE.
023600 01  CCVS-H-2.
023700     02 FILLER PICTURE X(52) VALUE IS
023800     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
023900     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
024000     02 TEST-ID PICTURE IS X(9).
024100     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
024200 01  CCVS-H-3.
024300     02  FILLER PICTURE X(34) VALUE
024400     " FOR OFFICIAL USE ONLY    ".
024500     02  FILLER PICTURE X(58) VALUE
024600     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
024700     02  FILLER PICTURE X(28) VALUE
024800     "  COPYRIGHT   1985 ".
024900 01  CCVS-E-1.
025000     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
025100     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
025200     02 ID-AGAIN PICTURE IS X(9).
025300     02 FILLER PICTURE X(45) VALUE IS
025400     " NTIS DISTRIBUTION COBOL 85".
025500 01  CCVS-E-2.
025600     02  FILLER                   PICTURE X(31)  VALUE
025700     SPACE.
025800     02  FILLER                   PICTURE X(21)  VALUE SPACE.
025900     02 CCVS-E-2-2.
026000         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
026100         03 FILLER PICTURE IS X VALUE IS SPACE.
026200         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
026300 01  CCVS-E-3.
026400     02  FILLER PICTURE X(22) VALUE
026500     " FOR OFFICIAL USE ONLY".
026600     02  FILLER PICTURE X(12) VALUE SPACE.
026700     02  FILLER PICTURE X(58) VALUE
026800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
026900     02  FILLER PICTURE X(13) VALUE SPACE.
027000     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
027100 01  CCVS-E-4.
027200     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
027300     02 FILLER PIC XXXX VALUE " OF ".
027400     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
027500     02 FILLER PIC X(40) VALUE
027600      "  TESTS WERE EXECUTED SUCCESSFULLY".
027700 01  XXINFO.
027800     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
027900     02 INFO-TEXT.
028000     04 FILLER PIC X(20) VALUE SPACE.
028100     04 XXCOMPUTED PIC X(20).
028200     04 FILLER PIC X(5) VALUE SPACE.
028300     04 XXCORRECT PIC X(20).
028400 01  HYPHEN-LINE.
028500     02 FILLER PICTURE IS X VALUE IS SPACE.
028600     02 FILLER PICTURE IS X(65) VALUE IS "************************
028700-    "*****************************************".
028800     02 FILLER PICTURE IS X(54) VALUE IS "************************
028900-    "******************************".
029000 01  CCVS-PGM-ID PIC X(6) VALUE
029100     "SQ212A".
029200 PROCEDURE DIVISION.
029300 DECLARATIVES.
029400 SECT-SQ212A-0001 SECTION.
029500     USE AFTER STANDARD EXCEPTION PROCEDURE ON SQ-VS7.
029600 TEST-STATUS-44-00.
029700     IF SWITCH-WRITE-REWRITE = 1
029800         GO TO TEST-STATUS-44-0.
029900     GO TO TEST-STATUS-44-1-0.
030000 TEST-STATUS-44-0.
030100     IF SQ-VS7-STATUS  = "44"
030200         GO TO TEST-STATUS-44-PASS.
030300 TEST-STATUS-44-FAIL.
030400     MOVE "VII-4 (3) D. 1)" TO RE-MARK.
030500     PERFORM FAIL1.
030600     MOVE SQ-VS7-STATUS TO COMPUTED-A.
030700     MOVE "44" TO CORRECT-A.
030800     GO TO TEST-STATUS-44-WRITE.
030900 TEST-STATUS-44-PASS.
031000     PERFORM PASS1.
031100 TEST-STATUS-44-WRITE.
031200     MOVE "DECL-STATUS-44-0" TO PAR-NAME.
031300     PERFORM PRINT-DETAIL1.
031400     ADD 1 TO RECORDS-IN-ERROR.
031500     GO TO EXIT-PARA.
031600 TEST-STATUS-44-1-0.
031700     IF SQ-VS7-STATUS  = "44"
031800         GO TO TEST-STATUS-44-1-PASS.
031900 TEST-STATUS-44-1-FAIL.
032000     MOVE "VII-4 (3) D. 1)" TO RE-MARK.
032100     PERFORM FAIL1.
032200     MOVE SQ-VS7-STATUS TO COMPUTED-A.
032300     MOVE "44" TO CORRECT-A.
032400     GO TO TEST-STATUS-44-1-WRITE.
032500 TEST-STATUS-44-1-PASS.
032600     PERFORM PASS1.
032700 TEST-STATUS-44-1-WRITE.
032800*          RWRT SHORTER & LONGER
032900     PERFORM PRINT-DETAIL1.
033000     ADD 1 TO RECORDS-IN-ERROR.
033100     GO TO EXIT-PARA.
033200 PASS1.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
033300 FAIL1.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
033400 PRINT-DETAIL1.
033500     IF REC-CT NOT EQUAL TO ZERO
033600             MOVE "." TO PARDOT-X
033700             MOVE REC-CT TO DOTVALUE.
033800     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE1.
033900     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE1
034000        PERFORM FAIL-ROUTINE1 THRU FAIL-ROUTINE-EX1
034100          ELSE PERFORM BAIL-OUT1 THRU BAIL-OUT-EX1.
034200     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
034300     MOVE SPACE TO CORRECT-X.
034400     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
034500     MOVE     SPACE TO RE-MARK.
034600 END-ROUTINE1.
034700     MOVE HYPHEN-LINE TO DUMMY-RECORD.
034800     PERFORM WRITE-LINE1 5 TIMES.
034900 END-RTN1-EXIT.
035000     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE1 2 TIMES.
035100 END-ROUTINE1-1.
035200      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
035300      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
035400      ADD PASS-COUNTER TO ERROR-HOLD.
035500*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE1-12.
035600      MOVE PASS-COUNTER TO CCVS-E-4-1.
035700      MOVE ERROR-HOLD TO CCVS-E-4-2.
035800      MOVE CCVS-E-4 TO CCVS-E-2-2.
035900      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE1.
036000  END-ROUTINE1-12.
036100      MOVE "TEST(S) FAILED" TO ENDER-DESC.
036200     IF       ERROR-COUNTER IS EQUAL TO ZERO
036300         MOVE "NO " TO ERROR-TOTAL
036400         ELSE
036500         MOVE ERROR-COUNTER TO ERROR-TOTAL.
036600     MOVE     CCVS-E-2 TO DUMMY-RECORD.
036700     PERFORM WRITE-LINE1.
036800 END-ROUTINE1-13.
036900     IF DELETE-CNT IS EQUAL TO ZERO
037000         MOVE "NO " TO ERROR-TOTAL  ELSE
037100         MOVE DELETE-CNT TO ERROR-TOTAL.
037200     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
037300     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE1.
037400      IF   INSPECT-COUNTER EQUAL TO ZERO
037500          MOVE "NO " TO ERROR-TOTAL
037600      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
037700      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
037800      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE1.
037900     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE1.
038000 WRITE-LINE1.
038100     ADD 1 TO RECORD-COUNT.
038200Y    IF RECORD-COUNT GREATER 50
038300Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
038400Y        MOVE SPACE TO DUMMY-RECORD
038500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
038600Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN1
038700Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN1 2 TIMES
038800Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN1
038900Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
039000Y        MOVE ZERO TO RECORD-COUNT.
039100     PERFORM WRT-LN1.
039200 WRT-LN1.
039300     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
039400     MOVE SPACE TO DUMMY-RECORD.
039500 FAIL-ROUTINE1.
039600     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE1.
039700     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE1.
039800     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
039900     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE1 2 TIMES.
040000     GO TO FAIL-ROUTINE-EX1.
040100 FAIL-ROUTINE-WRITE1.
040200     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE1
040300     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE1 2 TIMES.
040400 FAIL-ROUTINE-EX1. EXIT.
040500 BAIL-OUT1.
040600     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE1.
040700     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX1.
040800 BAIL-OUT-WRITE1.
040900     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
041000     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE1 2 TIMES.
041100 BAIL-OUT-EX1. EXIT.
041200 EXIT-PARA.
041300     EXIT.
041400 CLOSE-FILES1.
041500     PERFORM END-ROUTINE1 THRU END-ROUTINE1-13. CLOSE PRINT-FILE.
041600P    OPEN I-O RAW-DATA.
041700P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
041800P    READ RAW-DATA INVALID KEY GO TO END1-E-2.
041900P    MOVE "OK.     " TO C-ABORT.
042000P    MOVE PASS-COUNTER TO C-OK.
042100P    MOVE ERROR-HOLD   TO C-ALL.
042200P    MOVE ERROR-COUNTER TO C-FAIL.
042300P    MOVE DELETE-CNT TO C-DELETED.
042400P    MOVE INSPECT-COUNTER TO C-INSPECT.
042500P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END1-E-2.
042600PEND1-E-2.
042700P    CLOSE RAW-DATA.
042800 TERMINATE1-CCVS.
042900S    EXIT PROGRAM.
043000STERMINATE1-CALL.
043100     STOP     RUN.
043200 END DECLARATIVES.
043300 CCVS1 SECTION.
043400 OPEN-FILES.
043500P    OPEN I-O RAW-DATA.
043600P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
043700P    READ RAW-DATA INVALID KEY GO TO END-E-1.
043800P    MOVE "ABORTED " TO C-ABORT.
043900P    ADD 1 TO C-NO-OF-TESTS.
044000P    ACCEPT C-DATE  FROM DATE.
044100P    ACCEPT C-TIME  FROM TIME.
044200P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
044300PEND-E-1.
044400P    CLOSE RAW-DATA.
044500     OPEN     OUTPUT PRINT-FILE.
044600     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
044700     MOVE    SPACE TO TEST-RESULTS.
044800     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
044900     MOVE ZERO TO REC-SKL-SUB.
045000 CCVS-INIT-EXIT.
045100     GO TO CCVS1-EXIT.
045200 CLOSE-FILES.
045300     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
045400P    OPEN I-O RAW-DATA.
045500P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
045600P    READ RAW-DATA INVALID KEY GO TO END-E-2.
045700P    MOVE "OK.     " TO C-ABORT.
045800P    MOVE PASS-COUNTER TO C-OK.
045900P    MOVE ERROR-HOLD   TO C-ALL.
046000P    MOVE ERROR-COUNTER TO C-FAIL.
046100P    MOVE DELETE-CNT TO C-DELETED.
046200P    MOVE INSPECT-COUNTER TO C-INSPECT.
046300P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
046400PEND-E-2.
046500P    CLOSE RAW-DATA.
046600 TERMINATE-CCVS.
046700S    EXIT PROGRAM.
046800STERMINATE-CALL.
046900     STOP     RUN.
047000 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
047100 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
047200 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
047300 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
047400     MOVE "****TEST DELETED****" TO RE-MARK.
047500 PRINT-DETAIL.
047600     IF REC-CT NOT EQUAL TO ZERO
047700             MOVE "." TO PARDOT-X
047800             MOVE REC-CT TO DOTVALUE.
047900     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
048000     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
048100        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
048200          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
048300     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
048400     MOVE SPACE TO CORRECT-X.
048500     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
048600     MOVE     SPACE TO RE-MARK.
048700 HEAD-ROUTINE.
048800     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
048900     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
049000     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
049100 COLUMN-NAMES-ROUTINE.
049200     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
049300     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
049400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
049500 END-ROUTINE.
049600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
049700 END-RTN-EXIT.
049800     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
049900 END-ROUTINE-1.
050000      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
050100      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
050200      ADD PASS-COUNTER TO ERROR-HOLD.
050300*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
050400      MOVE PASS-COUNTER TO CCVS-E-4-1.
050500      MOVE ERROR-HOLD TO CCVS-E-4-2.
050600      MOVE CCVS-E-4 TO CCVS-E-2-2.
050700      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
050800  END-ROUTINE-12.
050900      MOVE "TEST(S) FAILED" TO ENDER-DESC.
051000     IF       ERROR-COUNTER IS EQUAL TO ZERO
051100         MOVE "NO " TO ERROR-TOTAL
051200         ELSE
051300         MOVE ERROR-COUNTER TO ERROR-TOTAL.
051400     MOVE     CCVS-E-2 TO DUMMY-RECORD.
051500     PERFORM WRITE-LINE.
051600 END-ROUTINE-13.
051700     IF DELETE-CNT IS EQUAL TO ZERO
051800         MOVE "NO " TO ERROR-TOTAL  ELSE
051900         MOVE DELETE-CNT TO ERROR-TOTAL.
052000     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
052100     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
052200      IF   INSPECT-COUNTER EQUAL TO ZERO
052300          MOVE "NO " TO ERROR-TOTAL
052400      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
052500      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
052600      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
052700     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
052800 WRITE-LINE.
052900     ADD 1 TO RECORD-COUNT.
053000Y    IF RECORD-COUNT GREATER 50
053100Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
053200Y        MOVE SPACE TO DUMMY-RECORD
053300Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
053400Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
053500Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
053600Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
053700Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
053800Y        MOVE ZERO TO RECORD-COUNT.
053900     PERFORM WRT-LN.
054000 WRT-LN.
054100     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
054200     MOVE SPACE TO DUMMY-RECORD.
054300 BLANK-LINE-PRINT.
054400     PERFORM WRT-LN.
054500 FAIL-ROUTINE.
054600     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
054700     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
054800     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
054900     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
055000     GO TO FAIL-ROUTINE-EX.
055100 FAIL-ROUTINE-WRITE.
055200     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
055300     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
055400 FAIL-ROUTINE-EX. EXIT.
055500 BAIL-OUT.
055600     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
055700     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
055800 BAIL-OUT-WRITE.
055900     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
056000     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
056100 BAIL-OUT-EX. EXIT.
056200 CCVS1-EXIT.
056300     EXIT.
056400 SECT-SQ212A-0002 SECTION.
056500 WRITE-INIT-GF-01.
056600     MOVE ZERO TO COUNT-OF-RECS.
056700******************************************************************
056800*                                                                *
056900*    ATTEMPT IS MADE TO WRITE 3 SHORTER RECORDS.                 *
057000*                                                                *
057100******************************************************************
057200     MOVE "3 SHORTER RECORDS" TO RE-MARK.
057300     MOVE 14   TO RECORD-LENGTH.
057400     MOVE 1 TO SWITCH-WRITE-REWRITE.
057500     OPEN OUTPUT SQ-VS7.
057600     MOVE "WRITE SHORTER RECORDS" TO FEATURE.
057700     PERFORM WRITE-RECORDS-1   3  TIMES.
057800     MOVE 0 TO COUNT-OF-RECS.
057900 WRITE-TEST-GF-01.
058000     PERFORM WRITE-RECORDS-1 1030 TIMES.
058100     PERFORM WRITE-RECORDS-2 1001 TIMES.
058200 WRITE-WRITE-GF-01.
058300     MOVE "CREATE FILE SQ-VS7" TO FEATURE.
058400     MOVE "WRITE-TEST-GF-01" TO PAR-NAME.
058500     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
058600     MOVE COUNT-OF-RECS TO CORRECT-18V0.
058700     MOVE "FILE CONTAINS 18 THRU 2048 CHAR RECS" TO RE-MARK.
058800     PERFORM PRINT-DETAIL.
058900*        A SEQUENTIAL MASS STORAGE FILE CONTAINING 2031
059000*    RECORDS HAS BEEN CREATED.  THE FILE CONTAINS RECORDS
059100*    OF 18  THROUGH 2048 CHARACTERS BEGINNING WITH THE 18 CHAR REC
059200*    AND ENDING WITH THE 2048 CHAR REC.
059300*
059400******************************************************************
059500*                                                                *
059600*   RECORD NO.  2031 TO 2080  SHOULD NOT BE WRITTEN              *
059700*                                                                *
059800******************************************************************
059900 TEST-STATUS-44.
060000     MOVE "9 LONGER RECORDS" TO RE-MARK.
060100     MOVE "WRITE LONGER RECORDS" TO FEATURE.
060200     PERFORM WRITE-RECORDS-1  9   TIMES.
060300 WRITE-CLOSE-GF-01.
060400     CLOSE SQ-VS7.
060500     GO TO READ-INIT-F1-01.
060600 WRITE-RECORDS-1.
060700******************************************************************
060800*   MOVE  ...  TO  OUTPUT-RECORD          1030 RECORDS           *
060900*   WRITE   OUTPUT-RECORD.                                       *
061000******************************************************************
061100     ADD 1 TO COUNT-OF-RECS.
061200     ADD 1 TO RECORD-LENGTH.
061300     MOVE COUNT-OF-RECS TO RECORD-NUMBER.
061400     MOVE VAR-RECORD-18-2048 TO SQ-VS7R1-FIRST.
061500     MOVE SPACE TO SQ-VS7-STATUS.
061600     WRITE SQ-VSR7R1-M-G-2048.
061700 WRITE-RECORDS-2.
061800******************************************************************
061900*WRITE ...  FROM  ....  .                 1000 RECORDS           *
062000******************************************************************
062100     ADD 1 TO COUNT-OF-RECS.
062200     ADD 1 TO RECORD-LENGTH.
062300     MOVE COUNT-OF-RECS TO RECORD-NUMBER.
062400     WRITE SQ-VSR7R1-M-G-2048 FROM VAR-RECORD-18-2048.
062500 READ-INIT-F1-01.
062600     MOVE 17   TO RECORD-LENGTH.
062700     MOVE ZERO TO COUNT-OF-RECS.
062800     MOVE ZERO TO EOF-FLAG.
062900     MOVE ZERO TO RECORDS-IN-ERROR.
063000     MOVE ZERO TO ERROR-FLAG.
063100     OPEN INPUT SQ-VS7.
063200 READ-TEST-F1-01.
063300     PERFORM READ-REC-1 THRU READ-REC-1-EXIT 1030 TIMES.
063400     IF EOF-FLAG EQUAL TO 1
063500         MOVE "EOF ON FIRST READ" TO RE-MARK
063600         GO TO READ-EOF-F1-03.
063700     IF ERROR-FLAG EQUAL TO 1
063800         GO TO READ-FAIL-F1-01.
063900 READ-PASS-F1-01.
064000     PERFORM PASS.
064100     GO TO READ-WRITE-F1-01.
064200 READ-FAIL-F1-01.
064300     MOVE "VII-30 FORMAT 2" TO RE-MARK.
064400     PERFORM FAIL.
064500 READ-WRITE-F1-01.
064600     MOVE "READ 1030 RECORDS" TO FEATURE.
064700     MOVE "READ-TEST-F1-01" TO PAR-NAME.
064800     PERFORM PRINT-DETAIL.
064900     GO TO READ-INIT-F1-02.
065000 READ-REC-1.
065100******************************************************************
065200*   READ      <FILE>     AT END ...                              *
065300******************************************************************
065400     IF EOF-FLAG EQUAL TO 1
065500         GO TO READ-REC-1-EXIT.
065600     READ SQ-VS7 AT END
065700         MOVE 1 TO EOF-FLAG
065800         GO TO READ-REC-1-EXIT.
065900     ADD 1 TO COUNT-OF-RECS.
066000     MOVE SQ-VS7R1-FIRST TO VAR-RECORD-18-2048.
066100     ADD 17 TO COUNT-OF-RECS.
066200     IF  RECORD-LENGTH     NOT EQUAL TO COUNT-OF-RECS
066300         GO TO READ-REC-1-ERROR.
066400     SUBTRACT 17 FROM COUNT-OF-RECS.
066500     GO TO READ-REC-1-EXIT.
066600 READ-REC-1-ERROR.
066700     SUBTRACT 17 FROM COUNT-OF-RECS.
066800     ADD 1 TO RECORDS-IN-ERROR.
066900     MOVE 1 TO ERROR-FLAG.
067000 READ-REC-1-EXIT.
067100     EXIT.
067200 READ-REC-2.
067300******************************************************************
067400*   READ  <FILE> INTO ....  AT END                               *
067500******************************************************************
067600     READ SQ-VS7 INTO VAR-RECORD-18-2048 AT END
067700         MOVE 1 TO EOF-FLAG
067800         GO TO READ-REC-2-EXIT.
067900     ADD 1 TO COUNT-OF-RECS.
068000     ADD 17 TO COUNT-OF-RECS.
068100     IF  RECORD-LENGTH     NOT EQUAL TO COUNT-OF-RECS
068200         GO TO READ-REC-2-ERROR.
068300     SUBTRACT 17 FROM COUNT-OF-RECS.
068400     GO TO READ-REC-2-EXIT.
068500 READ-REC-2-ERROR.
068600     SUBTRACT 17 FROM COUNT-OF-RECS.
068700     MOVE 1 TO ERROR-FLAG.
068800 READ-REC-2-EXIT.
068900     EXIT.
069000 READ-INIT-F1-02.
069100     MOVE ZERO TO ERROR-FLAG.
069200 READ-TEST-F1-02.
069300     PERFORM READ-REC-2 THRU READ-REC-2-EXIT 1001 TIMES.
069400     IF EOF-FLAG EQUAL TO 1
069500         MOVE "EOF ON SECOND READ" TO RE-MARK
069600         GO TO READ-EOF-F1-03.
069700     IF ERROR-FLAG EQUAL TO 1
069800         GO TO READ-FAIL-F1-02.
069900 READ-PASS-F1-02.
070000     PERFORM PASS.
070100     GO TO READ-WRITE-F1-02.
070200 READ-FAIL-F1-02.
070300     MOVE "VII-30 FORMAT 2" TO RE-MARK.
070400     MOVE RECORD-LENGTH TO COMPUTED-N.
070500     ADD 17 TO COUNT-OF-RECS.
070600     MOVE COUNT-OF-RECS TO CORRECT-N.
070700     SUBTRACT 17 FROM COUNT-OF-RECS.
070800     PERFORM FAIL.
070900 READ-WRITE-F1-02.
071000     MOVE "READ 1001 RECORDS" TO FEATURE.
071100     MOVE "READ-TEST-F1-02" TO PAR-NAME.
071200     PERFORM PRINT-DETAIL.
071300 READ-INIT-F1-03.
071400     READ SQ-VS7 RECORD END
071500         GO TO READ-TEST-F1-03.
071600     MOVE "MORE THAN 2031 RECORDS" TO RE-MARK.
071700 READ-EOF-F1-03.
071800     MOVE "RECORDS READ =" TO COMPUTED-A.
071900     MOVE COUNT-OF-RECS TO CORRECT-18V0.
072000     GO TO READ-FAIL-F1-03.
072100 READ-TEST-F1-03.
072200     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
072300         MOVE "RECORDS IN ERROR =" TO COMPUTED-A
072400     MOVE RECORDS-IN-ERROR TO CORRECT-18V0
072500         GO TO READ-FAIL-F1-03.
072600 READ-PASS-F1-03.
072700     PERFORM PASS.
072800     GO TO READ-WRITE-F1-03.
072900 READ-FAIL-F1-03.
073000     MOVE "VII-30 FORMAT 2; TOO MUCH RECORDS" TO RE-MARK.
073100     PERFORM FAIL.
073200 READ-WRITE-F1-03.
073300     MOVE "READ-TEST-F1-03" TO PAR-NAME.
073400     MOVE "AT END            " TO FEATURE.
073500     PERFORM PRINT-DETAIL.
073600 READ-CLOSE-F1-03.
073700     CLOSE SQ-VS7.
073800 REWRITE-44-1.
073900     OPEN I-O SQ-VS7.
074000******************************************************************
074100*                                                                *
074200*         READ   1ST  RECORD; REWRITE SMALLER RECORD.            *
074300*                                                                *
074400******************************************************************
074500     READ SQ-VS7
074600     MOVE 15 TO RECORD-LENGTH.
074700     MOVE 2 TO SWITCH-WRITE-REWRITE.
074800     MOVE "REWRITE-44-1" TO PAR-NAME.
074900     MOVE "RWRT SMALLER RECORD" TO FEATURE.
075000     REWRITE SQ-VSR7R1-M-G-2048.
075100 REWRITE-44-2.
075200******************************************************************
075300*                                                                *
075400*         READ   2ND  RECORD; REWRITE LARGER  RECORD.            *
075500*                                                                *
075600******************************************************************
075700     READ SQ-VS7.
075800     MOVE 2500 TO RECORD-LENGTH.
075900     MOVE "REWRITE-44-2" TO PAR-NAME.
076000     MOVE "RWRT LARGER RECORD" TO FEATURE.
076100     REWRITE SQ-VSR7R1-M-G-2048.
076200     CLOSE SQ-VS7.
076300 TERMINATE-ROUTINE.
076400     EXIT.
076500 CCVS-EXIT SECTION.
076600 CCVS-999999.
076700     GO TO CLOSE-FILES.
