000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RL209A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*    THE FUNCTION OF THIS PROGRAM IS TO CREATE A RELATIVE FILE *
001500*    SEQUENTIALLY WITH VARIABLE LENGTH RECORDS AND VERIFY THAT *
001600*    IT WAS CREATED CORRECTLY.                                 *
001700*    THE FILE WILL BE IDENTIFIED AS: "RL-VS1".                 *
001800*    THE PROGRAM WILL CREATE A RELATIVE FILE OF 500 VARIABLE   *
001900*    LENGTH RECORDS.                                           *
002000*    THE RECORD SIZE WILL BE 120 TO 140 CHARACTERS.            *
002100*                                                              *
002200****************************************************************
002300*            X-CARD PARAMETERS WHICH MUST BE SUPPLIED FOR THIS
002400*            PROGRAM ARE:
002500*
002600*                 X-21   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
002700*                         RELATIVE  I-O DATA FILE
002800*                 X-55   SYSTEM PRINTER
002900*                 X-69   ADDITIONAL VALUE OF CLAUSES
003000*                 X-74   VALUE OF IMPLEMENTOR-NAME
003100*                 X-75   OBJECT OF VALUE OF CLAUSE
003200*                 X-82   SOURCE-COMPUTER
003300*                 X-83   OBJECT-COMPUTER.
003400*
003500****************************************************************
003600 ENVIRONMENT DIVISION.
003700 CONFIGURATION SECTION.
003800 SOURCE-COMPUTER.
003900     XXXXX082.
004000 OBJECT-COMPUTER.
004100     XXXXX083.
004200 INPUT-OUTPUT SECTION.
004300 FILE-CONTROL.
004400     SELECT PRINT-FILE ASSIGN TO
004500     XXXXX055.
004600     SELECT   RL-FS1 ASSIGN TO
004700     XXXXP021
004800             ORGANIZATION IS RELATIVE.
004900*    ABSENCE OF THE ACCESS CLAUSE IS TREATED AS THOUGH
005000*     SEQUENTIAL HAD BEEN SPECIFIED.
005100 DATA DIVISION.
005200 FILE SECTION.
005300 FD  PRINT-FILE.
005400 01  PRINT-REC PICTURE X(120).
005500 01  DUMMY-RECORD PICTURE X(120).
005600 FD  RL-FS1
005700     LABEL RECORDS STANDARD
005800C    VALUE OF
005900C    XXXXX074
006000C    IS
006100C    XXXXX075
006200G    XXXXX069
006300     RECORD IS VARYING IN SIZE
006400     FROM 120 TO 140 CHARACTERS
006500     DEPENDING ON WRK-SIZE.
006600 01  RL-FS1R1-F-G-120.
006700     02 FILLER PIC X(140).
006800 WORKING-STORAGE SECTION.
006900 01  WRK-SIZE     PIC  9(3).
007000 01  WRK-CS-09V00 PIC S9(9) USAGE COMP VALUE ZERO.
007100 01  FILE-RECORD-INFORMATION-REC.
007200     03 FILE-RECORD-INFO-SKELETON.
007300        05 FILLER                 PICTURE X(48)       VALUE
007400             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
007500        05 FILLER                 PICTURE X(46)       VALUE
007600             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
007700        05 FILLER                 PICTURE X(26)       VALUE
007800             ",LFIL=000000,ORG=  ,LBLR= ".
007900        05 FILLER                 PICTURE X(37)       VALUE
008000             ",RECKEY=                             ".
008100        05 FILLER                 PICTURE X(38)       VALUE
008200             ",ALTKEY1=                             ".
008300        05 FILLER                 PICTURE X(38)       VALUE
008400             ",ALTKEY2=                             ".
008500        05 FILLER                 PICTURE X(7)        VALUE SPACE.
008600     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
008700        05 FILE-RECORD-INFO-P1-120.
008800           07 FILLER              PIC X(5).
008900           07 XFILE-NAME           PIC X(6).
009000           07 FILLER              PIC X(8).
009100           07 XRECORD-NAME         PIC X(6).
009200           07 FILLER              PIC X(1).
009300           07 REELUNIT-NUMBER     PIC 9(1).
009400           07 FILLER              PIC X(7).
009500           07 XRECORD-NUMBER       PIC 9(6).
009600           07 FILLER              PIC X(6).
009700           07 UPDATE-NUMBER       PIC 9(2).
009800           07 FILLER              PIC X(5).
009900           07 ODO-NUMBER          PIC 9(4).
010000           07 FILLER              PIC X(5).
010100           07 XPROGRAM-NAME        PIC X(5).
010200           07 FILLER              PIC X(7).
010300           07 XRECORD-LENGTH       PIC 9(6).
010400           07 FILLER              PIC X(7).
010500           07 CHARS-OR-RECORDS    PIC X(2).
010600           07 FILLER              PIC X(1).
010700           07 XBLOCK-SIZE          PIC 9(4).
010800           07 FILLER              PIC X(6).
010900           07 RECORDS-IN-FILE     PIC 9(6).
011000           07 FILLER              PIC X(5).
011100           07 XFILE-ORGANIZATION   PIC X(2).
011200           07 FILLER              PIC X(6).
011300           07 XLABEL-TYPE          PIC X(1).
011400        05 FILE-RECORD-INFO-P121-240.
011500           07 FILLER              PIC X(8).
011600           07 XRECORD-KEY          PIC X(29).
011700           07 FILLER              PIC X(9).
011800           07 ALTERNATE-KEY1      PIC X(29).
011900           07 FILLER              PIC X(9).
012000           07 ALTERNATE-KEY2      PIC X(29).
012100           07 FILLER              PIC X(7).
012200 01  TEST-RESULTS.
012300     02 FILLER                   PIC X      VALUE SPACE.
012400     02 FEATURE                  PIC X(20)  VALUE SPACE.
012500     02 FILLER                   PIC X      VALUE SPACE.
012600     02 P-OR-F                   PIC X(5)   VALUE SPACE.
012700     02 FILLER                   PIC X      VALUE SPACE.
012800     02  PAR-NAME.
012900       03 FILLER                 PIC X(19)  VALUE SPACE.
013000       03  PARDOT-X              PIC X      VALUE SPACE.
013100       03 DOTVALUE               PIC 99     VALUE ZERO.
013200     02 FILLER                   PIC X(8)   VALUE SPACE.
013300     02 RE-MARK                  PIC X(61).
013400 01  TEST-COMPUTED.
013500     02 FILLER                   PIC X(30)  VALUE SPACE.
013600     02 FILLER                   PIC X(17)  VALUE
013700            "       COMPUTED=".
013800     02 COMPUTED-X.
013900     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
014000     03 COMPUTED-N               REDEFINES COMPUTED-A
014100                                 PIC -9(9).9(9).
014200     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
014300     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
014400     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
014500     03       CM-18V0 REDEFINES COMPUTED-A.
014600         04 COMPUTED-18V0                    PIC -9(18).
014700         04 FILLER                           PIC X.
014800     03 FILLER PIC X(50) VALUE SPACE.
014900 01  TEST-CORRECT.
015000     02 FILLER PIC X(30) VALUE SPACE.
015100     02 FILLER PIC X(17) VALUE "       CORRECT =".
015200     02 CORRECT-X.
015300     03 CORRECT-A                  PIC X(20) VALUE SPACE.
015400     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
015500     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
015600     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
015700     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
015800     03      CR-18V0 REDEFINES CORRECT-A.
015900         04 CORRECT-18V0                     PIC -9(18).
016000         04 FILLER                           PIC X.
016100     03 FILLER PIC X(2) VALUE SPACE.
016200     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
016300 01  CCVS-C-1.
016400     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
016500-    "SS  PARAGRAPH-NAME
016600-    "       REMARKS".
016700     02 FILLER                     PIC X(20)    VALUE SPACE.
016800 01  CCVS-C-2.
016900     02 FILLER                     PIC X        VALUE SPACE.
017000     02 FILLER                     PIC X(6)     VALUE "TESTED".
017100     02 FILLER                     PIC X(15)    VALUE SPACE.
017200     02 FILLER                     PIC X(4)     VALUE "FAIL".
017300     02 FILLER                     PIC X(94)    VALUE SPACE.
017400 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
017500 01  REC-CT                        PIC 99       VALUE ZERO.
017600 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
017700 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
017800 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
017900 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
018000 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
018100 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
018200 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
018300 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
018400 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
018500 01  CCVS-H-1.
018600     02  FILLER                    PIC X(39)    VALUE SPACES.
018700     02  FILLER                    PIC X(42)    VALUE
018800     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
018900     02  FILLER                    PIC X(39)    VALUE SPACES.
019000 01  CCVS-H-2A.
019100   02  FILLER                        PIC X(40)  VALUE SPACE.
019200   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
019300   02  FILLER                        PIC XXXX   VALUE
019400     "4.2 ".
019500   02  FILLER                        PIC X(28)  VALUE
019600            " COPY - NOT FOR DISTRIBUTION".
019700   02  FILLER                        PIC X(41)  VALUE SPACE.
019800
019900 01  CCVS-H-2B.
020000   02  FILLER                        PIC X(15)  VALUE
020100            "TEST RESULT OF ".
020200   02  TEST-ID                       PIC X(9).
020300   02  FILLER                        PIC X(4)   VALUE
020400            " IN ".
020500   02  FILLER                        PIC X(12)  VALUE
020600     " HIGH       ".
020700   02  FILLER                        PIC X(22)  VALUE
020800            " LEVEL VALIDATION FOR ".
020900   02  FILLER                        PIC X(58)  VALUE
021000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
021100 01  CCVS-H-3.
021200     02  FILLER                      PIC X(34)  VALUE
021300            " FOR OFFICIAL USE ONLY    ".
021400     02  FILLER                      PIC X(58)  VALUE
021500     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
021600     02  FILLER                      PIC X(28)  VALUE
021700            "  COPYRIGHT   1985 ".
021800 01  CCVS-E-1.
021900     02 FILLER                       PIC X(52)  VALUE SPACE.
022000     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
022100     02 ID-AGAIN                     PIC X(9).
022200     02 FILLER                       PIC X(45)  VALUE SPACES.
022300 01  CCVS-E-2.
022400     02  FILLER                      PIC X(31)  VALUE SPACE.
022500     02  FILLER                      PIC X(21)  VALUE SPACE.
022600     02 CCVS-E-2-2.
022700         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
022800         03 FILLER                   PIC X      VALUE SPACE.
022900         03 ENDER-DESC               PIC X(44)  VALUE
023000            "ERRORS ENCOUNTERED".
023100 01  CCVS-E-3.
023200     02  FILLER                      PIC X(22)  VALUE
023300            " FOR OFFICIAL USE ONLY".
023400     02  FILLER                      PIC X(12)  VALUE SPACE.
023500     02  FILLER                      PIC X(58)  VALUE
023600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
023700     02  FILLER                      PIC X(13)  VALUE SPACE.
023800     02 FILLER                       PIC X(15)  VALUE
023900             " COPYRIGHT 1985".
024000 01  CCVS-E-4.
024100     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
024200     02 FILLER                       PIC X(4)   VALUE " OF ".
024300     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
024400     02 FILLER                       PIC X(40)  VALUE
024500      "  TESTS WERE EXECUTED SUCCESSFULLY".
024600 01  XXINFO.
024700     02 FILLER                       PIC X(19)  VALUE
024800            "*** INFORMATION ***".
024900     02 INFO-TEXT.
025000       04 FILLER                     PIC X(8)   VALUE SPACE.
025100       04 XXCOMPUTED                 PIC X(20).
025200       04 FILLER                     PIC X(5)   VALUE SPACE.
025300       04 XXCORRECT                  PIC X(20).
025400     02 INF-ANSI-REFERENCE           PIC X(48).
025500 01  HYPHEN-LINE.
025600     02 FILLER  PIC IS X VALUE IS SPACE.
025700     02 FILLER  PIC IS X(65)    VALUE IS "************************
025800-    "*****************************************".
025900     02 FILLER  PIC IS X(54)    VALUE IS "************************
026000-    "******************************".
026100 01  CCVS-PGM-ID                     PIC X(9)   VALUE
026200     "RL209A".
026300 PROCEDURE DIVISION.
026400 CCVS1 SECTION.
026500 OPEN-FILES.
026600     OPEN    OUTPUT PRINT-FILE.
026700     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
026800     MOVE    SPACE TO TEST-RESULTS.
026900     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
027000     MOVE    ZERO TO REC-SKL-SUB.
027100     PERFORM CCVS-INIT-FILE 9 TIMES.
027200 CCVS-INIT-FILE.
027300     ADD     1 TO REC-SKL-SUB.
027400     MOVE    FILE-RECORD-INFO-SKELETON
027500          TO FILE-RECORD-INFO (REC-SKL-SUB).
027600 CCVS-INIT-EXIT.
027700     GO TO CCVS1-EXIT.
027800 CLOSE-FILES.
027900     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
028000 TERMINATE-CCVS.
028100S    EXIT PROGRAM.
028200STERMINATE-CALL.
028300     STOP     RUN.
028400 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
028500 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
028600 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
028700 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
028800     MOVE "****TEST DELETED****" TO RE-MARK.
028900 PRINT-DETAIL.
029000     IF REC-CT NOT EQUAL TO ZERO
029100             MOVE "." TO PARDOT-X
029200             MOVE REC-CT TO DOTVALUE.
029300     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
029400     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
029500        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
029600          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
029700     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
029800     MOVE SPACE TO CORRECT-X.
029900     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
030000     MOVE     SPACE TO RE-MARK.
030100 HEAD-ROUTINE.
030200     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030300     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030400     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030500     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030600 COLUMN-NAMES-ROUTINE.
030700     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030800     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
031000 END-ROUTINE.
031100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
031200 END-RTN-EXIT.
031300     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031400 END-ROUTINE-1.
031500      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
031600      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
031700      ADD PASS-COUNTER TO ERROR-HOLD.
031800*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
031900      MOVE PASS-COUNTER TO CCVS-E-4-1.
032000      MOVE ERROR-HOLD TO CCVS-E-4-2.
032100      MOVE CCVS-E-4 TO CCVS-E-2-2.
032200      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
032300  END-ROUTINE-12.
032400      MOVE "TEST(S) FAILED" TO ENDER-DESC.
032500     IF       ERROR-COUNTER IS EQUAL TO ZERO
032600         MOVE "NO " TO ERROR-TOTAL
032700         ELSE
032800         MOVE ERROR-COUNTER TO ERROR-TOTAL.
032900     MOVE     CCVS-E-2 TO DUMMY-RECORD.
033000     PERFORM WRITE-LINE.
033100 END-ROUTINE-13.
033200     IF DELETE-COUNTER IS EQUAL TO ZERO
033300         MOVE "NO " TO ERROR-TOTAL  ELSE
033400         MOVE DELETE-COUNTER TO ERROR-TOTAL.
033500     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
033600     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033700      IF   INSPECT-COUNTER EQUAL TO ZERO
033800          MOVE "NO " TO ERROR-TOTAL
033900      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
034000      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
034100      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034200     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034300 WRITE-LINE.
034400     ADD 1 TO RECORD-COUNT.
034500Y    IF RECORD-COUNT GREATER 50
034600Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
034700Y        MOVE SPACE TO DUMMY-RECORD
034800Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
034900Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
035000Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
035100Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
035200Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
035300Y        MOVE ZERO TO RECORD-COUNT.
035400     PERFORM WRT-LN.
035500 WRT-LN.
035600     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
035700     MOVE SPACE TO DUMMY-RECORD.
035800 BLANK-LINE-PRINT.
035900     PERFORM WRT-LN.
036000 FAIL-ROUTINE.
036100     IF     COMPUTED-X NOT EQUAL TO SPACE
036200            GO TO   FAIL-ROUTINE-WRITE.
036300     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
036400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
036500     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
036600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036700     MOVE   SPACES TO INF-ANSI-REFERENCE.
036800     GO TO  FAIL-ROUTINE-EX.
036900 FAIL-ROUTINE-WRITE.
037000     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
037100     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
037200     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
037300     MOVE   SPACES TO COR-ANSI-REFERENCE.
037400 FAIL-ROUTINE-EX. EXIT.
037500 BAIL-OUT.
037600     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
037700     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
037800 BAIL-OUT-WRITE.
037900     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
038000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
038100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038200     MOVE   SPACES TO INF-ANSI-REFERENCE.
038300 BAIL-OUT-EX. EXIT.
038400 CCVS1-EXIT.
038500     EXIT.
038600 SECT-RL201-001 SECTION.
038700 REL-INIT-001.
038800     MOVE     "FILE CREATE RL-FS1" TO FEATURE.
038900     OPEN     OUTPUT    RL-FS1.
039000     MOVE     "RL-FS1" TO XFILE-NAME (1).
039100     MOVE     "R1-F-G" TO XRECORD-NAME (1).
039200     MOVE CCVS-PGM-ID  TO XPROGRAM-NAME (1).
039300     MOVE     000120   TO XRECORD-LENGTH (1).
039400     MOVE     "RC"     TO CHARS-OR-RECORDS (1).
039500     MOVE     0001     TO XBLOCK-SIZE (1).
039600     MOVE     000500   TO RECORDS-IN-FILE (1).
039700     MOVE     "RL"     TO XFILE-ORGANIZATION (1).
039800     MOVE     "S"      TO XLABEL-TYPE (1).
039900     MOVE     000001   TO XRECORD-NUMBER (1).
040000 REL-TEST-001.
040100     MOVE     120 TO WRK-SIZE.
040200     MOVE     FILE-RECORD-INFO-P1-120 (1) TO RL-FS1R1-F-G-120.
040300     WRITE    RL-FS1R1-F-G-120
040400              INVALID KEY GO TO REL-FAIL-001.
040500     IF      XRECORD-NUMBER (1) EQUAL TO 250
040600             GO TO REL-TEST-001-2.
040700     ADD      000001 TO XRECORD-NUMBER (1).
040800     GO       TO REL-TEST-001.
040900 REL-TEST-001-1.
041000     MOVE     140 TO WRK-SIZE XRECORD-LENGTH(1).
041100     MOVE     FILE-RECORD-INFO(1) TO RL-FS1R1-F-G-120.
041200     WRITE    RL-FS1R1-F-G-120
041300              INVALID KEY GO TO REL-FAIL-001.
041400     IF XRECORD-NUMBER(1) EQUAL TO 500
041500              GO TO REL-WRITE-001.
041600 REL-TEST-001-2.
041700     ADD      000001 TO XRECORD-NUMBER(1).
041800     GO TO REL-TEST-001-1.
041900 REL-DELETE-001.
042000     PERFORM   DE-LETE.
042100     GO TO REL-WRITE-001.
042200 REL-FAIL-001.
042300     PERFORM   FAIL.
042400     MOVE    "BOUNDARY VIOLATION"  TO RE-MARK.
042500 REL-WRITE-001.
042600     MOVE     "REL-TEST-001" TO   PAR-NAME
042700     MOVE     "FILE CREATED, LFILE "  TO COMPUTED-A.
042800     MOVE    XRECORD-NUMBER (1) TO CORRECT-18V0.
042900     PERFORM  PRINT-DETAIL.
043000     CLOSE    RL-FS1.
043100 REL-INIT-002.
043200     OPEN     INPUT     RL-FS1.
043300     MOVE     ZERO      TO WRK-CS-09V00.
043400 REL-TEST-002.
043500     READ     RL-FS1
043600              AT END GO TO REL-TEST-002-1.
043700     MOVE     RL-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
043800     ADD      1 TO WRK-CS-09V00.
043900     IF       WRK-CS-09V00 GREATER 500
044000             MOVE "MORE THAN 500 RECORDS" TO RE-MARK
044100              GO TO REL-TEST-002-1.
044200     GO       TO REL-TEST-002.
044300 REL-DELETE-002.
044400     PERFORM     DE-LETE.
044500     PERFORM    PRINT-DETAIL.
044600 REL-TEST-002-1.
044700     IF       XRECORD-NUMBER (1) NOT EQUAL TO 500
044800              PERFORM FAIL
044900              ELSE
045000              PERFORM PASS.
045100     GO       TO REL-WRITE-002.
045200 REL-WRITE-002.
045300     MOVE     "REL-TEST-002" TO PAR-NAME.
045400     MOVE     "FILE VERIFIED, LFILE" TO COMPUTED-A.
045500     MOVE    XRECORD-NUMBER (1) TO CORRECT-18V0.
045600     PERFORM  PRINT-DETAIL.
045700     CLOSE   RL-FS1.
045800 CCVS-EXIT SECTION.
045900 CCVS-999999.
046000     GO TO CLOSE-FILES.
