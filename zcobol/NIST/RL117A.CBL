000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RL117A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*            X-22   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR   *
001700*                    RELATIVE  I-O DATA FILE                   *
001800*            X-55   SYSTEM PRINTER                             *
001900*            X-69   ADDITIONAL VALUE OF CLAUSES                *
002000*            X-74   VALUE OF IMPLEMENTOR-NAME                  *
002100*            X-75   OBJECT OF VALUE OF CLAUSE                  *
002200*            X-82   SOURCE-COMPUTER                            *
002300*            X-83   OBJECT-COMPUTER.                           *
002400*                                                              *
002500****************************************************************
002600*    RL117A                                                    *
002700****************************************************************
002800*            THIS PROGRAM TESTS THE SYNTACTICAL CONSTRUCTS AND *
002900*            SEMANTIC ACTIONS ASSOCIATED WITH THE "STATUS"     *
003000*            CLAUSE FOR THE VALUES "10" AND "14".              *
003100*                                                              *
003200*                                                              *
003300*                                                              *
003400****************************************************************
003500 ENVIRONMENT DIVISION.
003600 CONFIGURATION SECTION.
003700 SOURCE-COMPUTER.
003800     XXXXX082.
003900 OBJECT-COMPUTER.
004000     XXXXX083.
004100 INPUT-OUTPUT SECTION.
004200 FILE-CONTROL.
004300     SELECT PRINT-FILE ASSIGN TO
004400     XXXXX055.
004500     SELECT   RL-FD2 ASSIGN
004600     XXXXX022
004700              ORGANIZATION RELATIVE
004800              ACCESS  RANDOM
004900              RELATIVE  RL-FD2-KEY
005000         FILE STATUS IS RL-FD2-STATUS.
005100     SELECT   RL-FD3 ASSIGN
005200     XXXXX022
005300              ORGANIZATION RELATIVE
005400              ACCESS  SEQUENTIAL
005500              RELATIVE  RL-FD3-KEY
005600         FILE STATUS IS RL-FD3-STATUS.
005700 DATA DIVISION.
005800 FILE SECTION.
005900 FD  PRINT-FILE.
006000 01  PRINT-REC PICTURE X(120).
006100 01  DUMMY-RECORD PICTURE X(120).
006200 FD  RL-FD2
006300C    VALUE OF
006400C    XXXXX074
006500C    IS
006600C    XXXXX076
006700G    XXXXX069
006800     LABEL RECORDS ARE STANDARD
006900     BLOCK CONTAINS 1 RECORDS
007000     DATA RECORD RL-FD2R1-F-G-240.
007100 01  RL-FD2R1-F-G-240.
007200     05 RL-FD2-WRK-120 PIC X(120).
007300     05 RL-FD2-GRP-120.
007400        10 RL-FD2-WRK-XN-0001-O120F
007500                        PICTURE X OCCURS 120 TIMES.
007600 FD  RL-FD3
007700C    VALUE OF
007800C    XXXXX074
007900C    IS
008000C    XXXXX076
008100G    XXXXX069
008200     LABEL RECORDS ARE STANDARD
008300     BLOCK CONTAINS 1 RECORDS
008400     DATA RECORD RL-FD3R1-F-G-240.
008500 01  RL-FD3R1-F-G-240.
008600     05 RL-FD3-WRK-120 PIC X(120).
008700     05 RL-FD3-GRP-120.
008800        10 RL-FD3-WRK-XN-0001-O120F
008900                        PICTURE X OCCURS 120 TIMES.
009000 WORKING-STORAGE SECTION.
009100 01  GRP-0001.
009200     05 RL-FD2-KEY   PIC 9(8)  VALUE ZERO.
009300     05 RL-FD3-KEY   PIC  99   VALUE ZERO.
009400     05 WRK-CS-09V00-012  PIC S9(9) USAGE COMP  VALUE ZERO.
009500     05 WRK-CS-09V00-013  PIC S9(9) USAGE COMP  VALUE ZERO.
009600     05 WRK-CS-09V00-014  PIC S9(9) USAGE COMP  VALUE ZERO.
009700     05 WRK-CS-09V00-015  PIC S9(9) USAGE COMP  VALUE ZERO.
009800     05 WRK-CS-09V00-016  PIC S9(9) USAGE COMP  VALUE ZERO.
009900     05 WRK-CS-09V00-017  PIC S9(9) USAGE COMP  VALUE ZERO.
010000     05 WRK-CS-09V00-018  PIC S9(9) USAGE COMP  VALUE ZERO.
010100     05 RL-FD2-STATUS     PIC  XX  VALUE  SPACE.
010200     05 RL-FD3-STATUS     PIC  XX  VALUE  SPACE.
010300     05 WRK-XN-0002-001   PIC  X(2) VALUE  SPACE.
010400     05 WRK-XN-0002-002   PIC  X(2) VALUE  SPACE.
010500     05 WRK-XN-0002-003   PIC  X(2) VALUE  SPACE.
010600     05 WRK-XN-0002-004   PIC  X(2) VALUE  SPACE.
010700     05 WRK-XN-0002-005   PIC  X(2) VALUE  SPACE.
010800     05 WRK-XN-0002-006   PIC  X(2) VALUE  SPACE.
010900     05 WRK-XN-0002-007   PIC  X(2) VALUE  SPACE.
011000     05 WRK-XN-0002-008   PIC  X(2) VALUE  SPACE.
011100     05 WRK-XN-0002-009   PIC  X(2) VALUE  SPACE.
011200 01  FILE-RECORD-INFORMATION-REC.
011300     03 FILE-RECORD-INFO-SKELETON.
011400        05 FILLER                 PICTURE X(48)       VALUE
011500             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
011600        05 FILLER                 PICTURE X(46)       VALUE
011700             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
011800        05 FILLER                 PICTURE X(26)       VALUE
011900             ",LFIL=000000,ORG=  ,LBLR= ".
012000        05 FILLER                 PICTURE X(37)       VALUE
012100             ",RECKEY=                             ".
012200        05 FILLER                 PICTURE X(38)       VALUE
012300             ",ALTKEY1=                             ".
012400        05 FILLER                 PICTURE X(38)       VALUE
012500             ",ALTKEY2=                             ".
012600        05 FILLER                 PICTURE X(7)        VALUE SPACE.
012700     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
012800        05 FILE-RECORD-INFO-P1-120.
012900           07 FILLER              PIC X(5).
013000           07 XFILE-NAME           PIC X(6).
013100           07 FILLER              PIC X(8).
013200           07 XRECORD-NAME         PIC X(6).
013300           07 FILLER              PIC X(1).
013400           07 REELUNIT-NUMBER     PIC 9(1).
013500           07 FILLER              PIC X(7).
013600           07 XRECORD-NUMBER       PIC 9(6).
013700           07 FILLER              PIC X(6).
013800           07 UPDATE-NUMBER       PIC 9(2).
013900           07 FILLER              PIC X(5).
014000           07 ODO-NUMBER          PIC 9(4).
014100           07 FILLER              PIC X(5).
014200           07 XPROGRAM-NAME        PIC X(5).
014300           07 FILLER              PIC X(7).
014400           07 XRECORD-LENGTH       PIC 9(6).
014500           07 FILLER              PIC X(7).
014600           07 CHARS-OR-RECORDS    PIC X(2).
014700           07 FILLER              PIC X(1).
014800           07 XBLOCK-SIZE          PIC 9(4).
014900           07 FILLER              PIC X(6).
015000           07 RECORDS-IN-FILE     PIC 9(6).
015100           07 FILLER              PIC X(5).
015200           07 XFILE-ORGANIZATION   PIC X(2).
015300           07 FILLER              PIC X(6).
015400           07 XLABEL-TYPE          PIC X(1).
015500        05 FILE-RECORD-INFO-P121-240.
015600           07 FILLER              PIC X(8).
015700           07 XRECORD-KEY          PIC X(29).
015800           07 FILLER              PIC X(9).
015900           07 ALTERNATE-KEY1      PIC X(29).
016000           07 FILLER              PIC X(9).
016100           07 ALTERNATE-KEY2      PIC X(29).
016200           07 FILLER              PIC X(7).
016300 01  TEST-RESULTS.
016400     02 FILLER                   PIC X      VALUE SPACE.
016500     02 FEATURE                  PIC X(20)  VALUE SPACE.
016600     02 FILLER                   PIC X      VALUE SPACE.
016700     02 P-OR-F                   PIC X(5)   VALUE SPACE.
016800     02 FILLER                   PIC X      VALUE SPACE.
016900     02  PAR-NAME.
017000       03 FILLER                 PIC X(19)  VALUE SPACE.
017100       03  PARDOT-X              PIC X      VALUE SPACE.
017200       03 DOTVALUE               PIC 99     VALUE ZERO.
017300     02 FILLER                   PIC X(8)   VALUE SPACE.
017400     02 RE-MARK                  PIC X(61).
017500 01  TEST-COMPUTED.
017600     02 FILLER                   PIC X(30)  VALUE SPACE.
017700     02 FILLER                   PIC X(17)  VALUE
017800            "       COMPUTED=".
017900     02 COMPUTED-X.
018000     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
018100     03 COMPUTED-N               REDEFINES COMPUTED-A
018200                                 PIC -9(9).9(9).
018300     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
018400     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
018500     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
018600     03       CM-18V0 REDEFINES COMPUTED-A.
018700         04 COMPUTED-18V0                    PIC -9(18).
018800         04 FILLER                           PIC X.
018900     03 FILLER PIC X(50) VALUE SPACE.
019000 01  TEST-CORRECT.
019100     02 FILLER PIC X(30) VALUE SPACE.
019200     02 FILLER PIC X(17) VALUE "       CORRECT =".
019300     02 CORRECT-X.
019400     03 CORRECT-A                  PIC X(20) VALUE SPACE.
019500     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
019600     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
019700     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
019800     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
019900     03      CR-18V0 REDEFINES CORRECT-A.
020000         04 CORRECT-18V0                     PIC -9(18).
020100         04 FILLER                           PIC X.
020200     03 FILLER PIC X(2) VALUE SPACE.
020300     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
020400 01  CCVS-C-1.
020500     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
020600-    "SS  PARAGRAPH-NAME
020700-    "       REMARKS".
020800     02 FILLER                     PIC X(20)    VALUE SPACE.
020900 01  CCVS-C-2.
021000     02 FILLER                     PIC X        VALUE SPACE.
021100     02 FILLER                     PIC X(6)     VALUE "TESTED".
021200     02 FILLER                     PIC X(15)    VALUE SPACE.
021300     02 FILLER                     PIC X(4)     VALUE "FAIL".
021400     02 FILLER                     PIC X(94)    VALUE SPACE.
021500 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
021600 01  REC-CT                        PIC 99       VALUE ZERO.
021700 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
021800 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
021900 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
022000 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
022100 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
022200 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
022300 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
022400 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
022500 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
022600 01  CCVS-H-1.
022700     02  FILLER                    PIC X(39)    VALUE SPACES.
022800     02  FILLER                    PIC X(42)    VALUE
022900     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
023000     02  FILLER                    PIC X(39)    VALUE SPACES.
023100 01  CCVS-H-2A.
023200   02  FILLER                        PIC X(40)  VALUE SPACE.
023300   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
023400   02  FILLER                        PIC XXXX   VALUE
023500     "4.2 ".
023600   02  FILLER                        PIC X(28)  VALUE
023700            " COPY - NOT FOR DISTRIBUTION".
023800   02  FILLER                        PIC X(41)  VALUE SPACE.
023900
024000 01  CCVS-H-2B.
024100   02  FILLER                        PIC X(15)  VALUE
024200            "TEST RESULT OF ".
024300   02  TEST-ID                       PIC X(9).
024400   02  FILLER                        PIC X(4)   VALUE
024500            " IN ".
024600   02  FILLER                        PIC X(12)  VALUE
024700     " HIGH       ".
024800   02  FILLER                        PIC X(22)  VALUE
024900            " LEVEL VALIDATION FOR ".
025000   02  FILLER                        PIC X(58)  VALUE
025100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025200 01  CCVS-H-3.
025300     02  FILLER                      PIC X(34)  VALUE
025400            " FOR OFFICIAL USE ONLY    ".
025500     02  FILLER                      PIC X(58)  VALUE
025600     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
025700     02  FILLER                      PIC X(28)  VALUE
025800            "  COPYRIGHT   1985 ".
025900 01  CCVS-E-1.
026000     02 FILLER                       PIC X(52)  VALUE SPACE.
026100     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
026200     02 ID-AGAIN                     PIC X(9).
026300     02 FILLER                       PIC X(45)  VALUE SPACES.
026400 01  CCVS-E-2.
026500     02  FILLER                      PIC X(31)  VALUE SPACE.
026600     02  FILLER                      PIC X(21)  VALUE SPACE.
026700     02 CCVS-E-2-2.
026800         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
026900         03 FILLER                   PIC X      VALUE SPACE.
027000         03 ENDER-DESC               PIC X(44)  VALUE
027100            "ERRORS ENCOUNTERED".
027200 01  CCVS-E-3.
027300     02  FILLER                      PIC X(22)  VALUE
027400            " FOR OFFICIAL USE ONLY".
027500     02  FILLER                      PIC X(12)  VALUE SPACE.
027600     02  FILLER                      PIC X(58)  VALUE
027700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
027800     02  FILLER                      PIC X(13)  VALUE SPACE.
027900     02 FILLER                       PIC X(15)  VALUE
028000             " COPYRIGHT 1985".
028100 01  CCVS-E-4.
028200     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
028300     02 FILLER                       PIC X(4)   VALUE " OF ".
028400     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
028500     02 FILLER                       PIC X(40)  VALUE
028600      "  TESTS WERE EXECUTED SUCCESSFULLY".
028700 01  XXINFO.
028800     02 FILLER                       PIC X(19)  VALUE
028900            "*** INFORMATION ***".
029000     02 INFO-TEXT.
029100       04 FILLER                     PIC X(8)   VALUE SPACE.
029200       04 XXCOMPUTED                 PIC X(20).
029300       04 FILLER                     PIC X(5)   VALUE SPACE.
029400       04 XXCORRECT                  PIC X(20).
029500     02 INF-ANSI-REFERENCE           PIC X(48).
029600 01  HYPHEN-LINE.
029700     02 FILLER  PIC IS X VALUE IS SPACE.
029800     02 FILLER  PIC IS X(65)    VALUE IS "************************
029900-    "*****************************************".
030000     02 FILLER  PIC IS X(54)    VALUE IS "************************
030100-    "******************************".
030200 01  CCVS-PGM-ID                     PIC X(9)   VALUE
030300     "RL117A".
030400 PROCEDURE DIVISION.
030500 CCVS1 SECTION.
030600 OPEN-FILES.
030700     OPEN    OUTPUT PRINT-FILE.
030800     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
030900     MOVE    SPACE TO TEST-RESULTS.
031000     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
031100     MOVE    ZERO TO REC-SKL-SUB.
031200     PERFORM CCVS-INIT-FILE 9 TIMES.
031300 CCVS-INIT-FILE.
031400     ADD     1 TO REC-SKL-SUB.
031500     MOVE    FILE-RECORD-INFO-SKELETON
031600          TO FILE-RECORD-INFO (REC-SKL-SUB).
031700 CCVS-INIT-EXIT.
031800     GO TO CCVS1-EXIT.
031900 CLOSE-FILES.
032000     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
032100 TERMINATE-CCVS.
032200S    EXIT PROGRAM.
032300STERMINATE-CALL.
032400     STOP     RUN.
032500 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
032600 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
032700 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
032800 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
032900     MOVE "****TEST DELETED****" TO RE-MARK.
033000 PRINT-DETAIL.
033100     IF REC-CT NOT EQUAL TO ZERO
033200             MOVE "." TO PARDOT-X
033300             MOVE REC-CT TO DOTVALUE.
033400     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
033500     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
033600        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
033700          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
033800     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
033900     MOVE SPACE TO CORRECT-X.
034000     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
034100     MOVE     SPACE TO RE-MARK.
034200 HEAD-ROUTINE.
034300     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034400     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034500     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
034600     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
034700 COLUMN-NAMES-ROUTINE.
034800     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034900     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
035100 END-ROUTINE.
035200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
035300 END-RTN-EXIT.
035400     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035500 END-ROUTINE-1.
035600      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
035700      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
035800      ADD PASS-COUNTER TO ERROR-HOLD.
035900*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
036000      MOVE PASS-COUNTER TO CCVS-E-4-1.
036100      MOVE ERROR-HOLD TO CCVS-E-4-2.
036200      MOVE CCVS-E-4 TO CCVS-E-2-2.
036300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
036400  END-ROUTINE-12.
036500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
036600     IF       ERROR-COUNTER IS EQUAL TO ZERO
036700         MOVE "NO " TO ERROR-TOTAL
036800         ELSE
036900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
037000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
037100     PERFORM WRITE-LINE.
037200 END-ROUTINE-13.
037300     IF DELETE-COUNTER IS EQUAL TO ZERO
037400         MOVE "NO " TO ERROR-TOTAL  ELSE
037500         MOVE DELETE-COUNTER TO ERROR-TOTAL.
037600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
037700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037800      IF   INSPECT-COUNTER EQUAL TO ZERO
037900          MOVE "NO " TO ERROR-TOTAL
038000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
038100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
038200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038400 WRITE-LINE.
038500     ADD 1 TO RECORD-COUNT.
038600Y    IF RECORD-COUNT GREATER 50
038700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
038800Y        MOVE SPACE TO DUMMY-RECORD
038900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
039000Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
039100Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
039200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
039300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
039400Y        MOVE ZERO TO RECORD-COUNT.
039500     PERFORM WRT-LN.
039600 WRT-LN.
039700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
039800     MOVE SPACE TO DUMMY-RECORD.
039900 BLANK-LINE-PRINT.
040000     PERFORM WRT-LN.
040100 FAIL-ROUTINE.
040200     IF     COMPUTED-X NOT EQUAL TO SPACE
040300            GO TO   FAIL-ROUTINE-WRITE.
040400     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
040500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
040600     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
040700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040800     MOVE   SPACES TO INF-ANSI-REFERENCE.
040900     GO TO  FAIL-ROUTINE-EX.
041000 FAIL-ROUTINE-WRITE.
041100     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
041200     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
041300     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
041400     MOVE   SPACES TO COR-ANSI-REFERENCE.
041500 FAIL-ROUTINE-EX. EXIT.
041600 BAIL-OUT.
041700     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
041800     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
041900 BAIL-OUT-WRITE.
042000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
042100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
042200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042300     MOVE   SPACES TO INF-ANSI-REFERENCE.
042400 BAIL-OUT-EX. EXIT.
042500 CCVS1-EXIT.
042600     EXIT.
042700 SECT-RL117A-001 SECTION.
042800 REL-INIT-009.
042900     MOVE    "VIII-36 4.8.4 GR4" TO ANSI-REFERENCE.
043000     MOVE    "REL-TEST-009" TO PAR-NAME.
043100     MOVE     "CREATE RL-FD2" TO  FEATURE
043200     MOVE     "RL-FD2"        TO  XFILE-NAME (2).
043300     MOVE     "R1-F-G"        TO  XRECORD-NAME (2).
043400     MOVE     CCVS-PGM-ID     TO  XPROGRAM-NAME (2).
043500     MOVE     000240          TO  XRECORD-LENGTH (2).
043600     MOVE     "RC"            TO  CHARS-OR-RECORDS (2).
043700     MOVE     0001            TO  XBLOCK-SIZE       (2).
043800     MOVE     000500          TO  RECORDS-IN-FILE  (2).
043900     MOVE     "RL"            TO  XFILE-ORGANIZATION (2).
044000     MOVE     "S"             TO  XLABEL-TYPE        (2).
044100     MOVE     000001          TO  XRECORD-NUMBER     (2).
044200*INITIALIZE  RECORD WORK AREA NUMBER 2.
044300     MOVE     1         TO  WRK-CS-09V00-012.
044400     MOVE     ZERO      TO  WRK-CS-09V00-013 WRK-CS-09V00-014
044500                            WRK-CS-09V00-015 WRK-CS-09V00-016
044600                            WRK-CS-09V00-017 WRK-CS-09V00-018.
044700     MOVE     SPACE     TO  RL-FD2-STATUS.
044800     MOVE     90000002  TO  RL-FD2-KEY.
044900     MOVE     01 TO REC-CT.
045000     OPEN     OUTPUT    RL-FD2.
045100     MOVE     RL-FD2-STATUS TO WRK-XN-0002-001.
045200*CAPTURE STATUS KEY AFTER  OPEN STATEMENT IS EXECUTED.
045300 REL-TEST-009-R.
045400     MOVE XRECORD-NUMBER (2) TO RL-FD2-KEY.
045500     MOVE    "99"  TO RL-FD2-STATUS.
045600     MOVE     FILE-RECORD-INFO-P1-120 (2) TO RL-FD2-WRK-120.
045700     MOVE     FILE-RECORD-INFO-P1-120 (2) TO
045800               RL-FD2-GRP-120.
045900     WRITE    RL-FD2R1-F-G-240 INVALID KEY
046000              GO TO REL-TEST-009-2.
046100     IF        RL-FD2-STATUS NOT EQUAL TO "00"
046200              GO TO  REL-TEST-009-2.
046300     IF       XRECORD-NUMBER (2) EQUAL TO 500
046400             GO TO REL-TEST-009-2.
046500     ADD      01 TO  XRECORD-NUMBER (2).
046600     GO TO    REL-TEST-009-R.
046700 REL-TEST-009-2.
046800     IF       WRK-CS-09V00-014 NOT EQUAL TO ZERO
046900              MOVE "EXCEPTIONS/ERRORS" TO RE-MARK
047000              MOVE ZERO TO CORRECT-18V0
047100              MOVE WRK-CS-09V00-014 TO COMPUTED-18V0
047200              PERFORM   FAIL
047300              ELSE
047400              PERFORM   PASS.
047500     PERFORM  PRINT-DETAIL.
047600     ADD      01 TO REC-CT.
047700*    .01
047800     IF       XRECORD-NUMBER (2) NOT EQUAL TO 500
047900              MOVE "INCORRECT COUNT" TO RE-MARK
048000              MOVE  500 TO CORRECT-18V0
048100             MOVE    XRECORD-NUMBER (2)  TO COMPUTED-18V0
048200              PERFORM  FAIL
048300              ELSE
048400              PERFORM PASS.
048500     PERFORM  PRINT-DETAIL.
048600     ADD      01 TO REC-CT.
048700*    .02
048800     IF       WRK-XN-0002-001 NOT EQUAL TO  "00"
048900              MOVE "STATUS/OPEN" TO RE-MARK
049000              MOVE WRK-XN-0002-001 TO COMPUTED-A
049100              MOVE "00" TO CORRECT-A
049200              PERFORM  FAIL
049300              ELSE
049400              PERFORM  PASS.
049500     PERFORM  PRINT-DETAIL.
049600     ADD      01 TO REC-CT.
049700*    .03
049800     IF        RL-FD2-STATUS NOT EQUAL TO "00"
049900              MOVE "STATUS/WRITE" TO RE-MARK
050000              MOVE RL-FD2-STATUS TO COMPUTED-A
050100              MOVE "00" TO CORRECT-A
050200              PERFORM   FAIL
050300              ELSE
050400              PERFORM   PASS.
050500     PERFORM  PRINT-DETAIL.
050600     ADD      01 TO REC-CT.
050700*    .04
050800     MOVE     SPACE  TO  RL-FD2-STATUS.
050900     CLOSE    RL-FD2.
051000     IF        RL-FD2-STATUS NOT EQUAL TO "00"
051100              MOVE "CLOSE/STATUS" TO RE-MARK
051200              MOVE   RL-FD2-STATUS TO COMPUTED-A
051300              MOVE "00" TO CORRECT-A
051400              PERFORM FAIL
051500              ELSE
051600              PERFORM PASS.
051700     PERFORM  PRINT-DETAIL.
051800*
051900 REL-INIT-1.
052000     MOVE   "REL-TEST-1" TO PAR-NAME.
052100     MOVE   "VII-3 1.3.4 2A" TO ANSI-REFERENCE.
052200     MOVE    0 TO REC-CT.
052300     OPEN    I-O  RL-FD3.
052400* DELETE THE NEXT LINE TO DELETE THE TEST
052500*    GO TO REL-INIT-1-BETA.
052600 REL-INIT-1-ALPHA.
052700     GO TO REL-DELETE-1.
052800 REL-INIT-1-BETA.
052900     MOVE    SPACE TO RL-FD3-STATUS.
053000     PERFORM REL-INIT-1-A 501 TIMES.
053100     GO TO   REL-TEST-1.
053200 REL-INIT-1-A.
053300     READ    RL-FD3 AT END GO TO REL-TEST-1.
053400 REL-DELETE-1.
053500     PERFORM DE-LETE.
053600     PERFORM PRINT-DETAIL.
053700     GO TO   REL-INIT-2.
053800 REL-TEST-1.
053900     IF      RL-FD3-STATUS NOT EQUAL  TO "10"
054000             MOVE   "AT END STATUS" TO RE-MARK
054100             MOVE    RL-FD3-STATUS TO COMPUTED-A
054200             MOVE   "10" TO CORRECT-A
054300             PERFORM FAIL
054400             PERFORM PRINT-DETAIL
054500     ELSE
054600             PERFORM PASS
054700             PERFORM PRINT-DETAIL.
054800*
054900 REL-INIT-2.
055000     MOVE   "REL-TEST-2" TO PAR-NAME.
055100     MOVE   "VII-3 1.3.4 2D" TO ANSI-REFERENCE.
055200     MOVE    SPACE TO RL-FD3-STATUS.
055300* DELETE THE NEXT LINE TO DELETE THE TEST
055400*    GO TO REL-INIT-2-BETA.
055500 REL-INIT-2-ALPHA.
055600     GO TO REL-DELETE-2.
055700 REL-INIT-2-BETA.
055800     READ    RL-FD3   AT END GO TO REL-TEST-2.
055900     GO TO   REL-TEST-2.
056000 REL-DELETE-2.
056100     PERFORM DE-LETE.
056200     PERFORM PRINT-DETAIL.
056300     GO TO   REL-INIT-3.
056400 REL-TEST-2.
056500     IF      RL-FD3-STATUS NOT EQUAL  TO "46"
056600             MOVE   "SEQUENTIAL READ FOLLOWING 'AT END' CONDITION"
056700                  TO RE-MARK
056800             MOVE    RL-FD3-STATUS TO COMPUTED-A
056900             MOVE   "46" TO CORRECT-A
057000             PERFORM FAIL
057100             PERFORM PRINT-DETAIL
057200     ELSE
057300             PERFORM PASS
057400             PERFORM PRINT-DETAIL.
057500*
057600 REL-INIT-3.
057700     MOVE   "REL-TEST-3" TO PAR-NAME.
057800     MOVE   "VII-3 1.3.4 2B" TO ANSI-REFERENCE.
057900     CLOSE   RL-FD3.
058000     OPEN    INPUT RL-FD3.
058100     PERFORM REL-INIT-3-A 100 TIMES.
058200     GO TO   REL-TEST-3.
058300 REL-INIT-3-A.
058400     READ    RL-FD3 RECORD AT END GO TO REL-TEST-3.
058500 REL-DELETE-3.
058600     PERFORM DE-LETE.
058700     PERFORM PRINT-DETAIL.
058800     GO TO   RL-TEST-3-EXIT.
058900 REL-TEST-3.
059000     IF      RL-FD3-STATUS NOT EQUAL  TO "14"
059100             MOVE    RL-FD3-STATUS TO COMPUTED-A
059200             MOVE   "14" TO CORRECT-A
059300             PERFORM FAIL
059400             PERFORM PRINT-DETAIL
059500     ELSE
059600             PERFORM PASS
059700             PERFORM PRINT-DETAIL
059800     CLOSE   RL-FD3.
059900 RL-TEST-3-EXIT.
060000     EXIT.
060100*
060200 CCVS-EXIT SECTION.
060300 CCVS-999999.
060400     GO TO CLOSE-FILES.
