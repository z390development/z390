000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST116A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*        X-XXXD01  -  SQ-FS1             *
002000*        X-XXXP02  -  SQ-FS2             *
002100*        X-XXX027  -  SORT FILE ST-FS1   *
002200*                                                              *
002300****************************************************************
002400******************************************************************
002500*
002600*
002700*    ST116
002800*
002900*
003000*    OBJECTIVE -
003100*        ROUTINE ST116 IS A TEST OF THE SORT STATEMENT USING
003200*    FIXED LENGTH RECORDS ( 507 CHARACTERS PER RECORD ).
003300*
003400*
003500*    FEATURES TESTED -
003600*    *   COLLATING SEQUENCE IS NATIVE.  NO COLLATING SEQUENCE
003700*            STATEMENT IS USED IN THE ACTUAL SORT STATEMENT.
003800*    *   FIXED LENGTH RECORDS
003900*    *   OCCURS CLAUSES
004000*    *   QUALIFIED ALPHANUMERIC AND NUMERIC SORT KEYS
004100*
004200*    *   SORT  SORT-FILE-NAME
004300*        ON ASCENDING KEY KEY-1 OF DATA-NAME-1
004400*        ASCENDING KEY-2 OF DATA-NAME-2
004500*        USING FILE-NAME-1
004600*        GIVING FILE-NAME-2.
004700*
004800*
004900*    ANSI X3.23-1974 REFERENCES -
005000*    *   SECTION 4.4  THE SORT STATEMENT  PAGE VII-14
005100*
005200*
005300*    FILES USED -
005400*    *   FILES SQ-FS1 AND SQ-FS2 ON MAGNETIC TAPE OR MASS-STORAGE
005500*
005600*    FILE SQ-FS1 IS CREATED IN ST115 AND PASSED TO ST116.  THE
005700*    FILE SQ-FS2 IS PASSED TO ROUTINE ST117 FOR CHECKING.
005800*
005900*        SQ-FS1 -
006000*    NUMBER OF RECORDS IS SET BY THE INTEGER X-65.
006100*    FIXED LENGTH ( 507 CHARACTERS PER RECORD )
006200*    BLOCKED 1
006300*    RESERVE 2 AREAS
006400*
006500*    SQ-FS1 IS SORTED GIVING SQ-FS2.
006600*
006700*        SQ-FS2 -
006800*    SAME NUMBER OF RECORDS AS IN SQ-FS1  ( SET BY X-65 )
006900*    FIXED LENGTH ( 507 CHARACTERS PER RECORD )
007000*    BLOCKED 2
007100*    RESERVE 4 AREAS
007200*
007300*
007400*
007500*
007600*    OPTIONS RECOMMENDED -
007700*        NOT APPLICABLE.
007800*
007900*
008000*    TEST DESCRIPTIONS -
008100*        NOT APPLICABLE.  ROUTINE ST116 ONLY CONTAINS THE SORT.
008200*
008300*
008400*    ************************************************************
008500 ENVIRONMENT DIVISION.
008600 CONFIGURATION SECTION.
008700 SOURCE-COMPUTER.
008800     XXXXX082.
008900 OBJECT-COMPUTER.
009000     XXXXX083.
009100 INPUT-OUTPUT SECTION.
009200 FILE-CONTROL.
009300     SELECT SQ-FS1 ASSIGN TO
009400     XXXXD001
009500     ORGANIZATION IS SEQUENTIAL
009600     ACCESS MODE IS SEQUENTIAL.
009700     SELECT SQ-FS2 ASSIGN TO
009800     XXXXP002
009900     ORGANIZATION IS SEQUENTIAL
010000     ACCESS MODE IS SEQUENTIAL.
010100     SELECT ST-FS1 ASSIGN TO
010200     XXXXX027.
010300 DATA DIVISION.
010400 FILE SECTION.
010500 FD  SQ-FS1
010600     LABEL RECORDS STANDARD
010700C    VALUE OF
010800C    XXXXX074
010900C    IS
011000C    XXXXX075
011100G    XXXXX069
011200     BLOCK CONTAINS 1 RECORDS
011300     RECORD CONTAINS 507 CHARACTERS
011400     DATA RECORD IS SQ-FS1R1-F-G-507.
011500 01  SQ-FS1R1-F-G-507.
011600     10 REC-PREAMBLE PIC X(120).
011700     10  LENGTH-1  PIC 999.
011800     10  THE-THREE-KEYS.
011900     20 KEY-1.
012000         30 ALPHAN-KEY PIC X.
012100         30 NUM-KEY PIC 999.
012200     20 KEY-2.
012300         30 ALPHAN-KEY PIC X.
012400         30 NUM-KEY PIC 999.
012500     20 KEY-3.
012600         30 ALPHAN-KEY PIC X.
012700         30 NUM-KEY PIC 999.
012800     10  STUFF-1 OCCURS
012900             31 TIMES.
013000         30  FILL-ME-UPS  PIC  X(12).
013100 FD  SQ-FS2
013200     LABEL RECORDS STANDARD
013300C    VALUE OF
013400C    XXXXX074
013500C    IS
013600C    XXXXX076
013700G    XXXXX069
013800     BLOCK CONTAINS 2 RECORDS
013900     RECORD CONTAINS 507 CHARACTERS
014000     DATA RECORD IS SQ-FS2R1-F-G-507.
014100 01  SQ-FS2R1-F-G-507.
014200     10 REC-PRE-2 PIC X(120).
014300     10  LENGTH-2  PIC 999.
014400     10  THE-NEW-KEYS.
014500     20 KEY-4.
014600         30 ALPHAN-KEY PIC X.
014700         30 NUM-KEY PIC 999.
014800     20 KEY-5.
014900         30 ALPHAN-KEY PIC X.
015000         30 NUM-KEY PIC 999.
015100     20 KEY-6.
015200         30 ALPHAN-KEY PIC X.
015300         30 NUM-KEY PIC 999.
015400     10  STUFF-2 OCCURS
015500             31 TIMES.
015600         30  FILLER PIC X(12).
015700 SD  ST-FS1
015800     RECORD CONTAINS 507 CHARACTERS
015900     DATA RECORD IS ST-FS1R1-F-G-507.
016000 01  ST-FS1R1-F-G-507.
016100     02 FILLER PIC X(120).
016200     02 LENGTH-3 PIC 999.
016300     02 NON-KEY-1.
016400         03 A-KEY-NK1 PIC X.
016500         03 N-KEY-NK1 PIC 999.
016600     02 SORT-KEY.
016700         03 A-KEY-SK PIC X.
016800         03 N-KEY-SK PIC 999.
016900     02 NON-KEY-2.
017000         03 A-KEY-NK2 PIC X.
017100         03 N-KEY-NK2 PIC 999.
017200     02  STUFF-3 OCCURS
017300             31 TIMES.
017400         03  FILLER PIC X(12).
017500 PROCEDURE DIVISION.
017600 SECT-ST116-0001 SECTION.
017700 SRT-INIT-001.
017800     SORT ST-FS1
017900         ON ASCENDING KEY A-KEY-SK
018000         ASCENDING N-KEY-NK2
018100         USING SQ-FS1
018200         GIVING SQ-FS2.
018300 STOP-THE-RUN.
018400     STOP RUN.
