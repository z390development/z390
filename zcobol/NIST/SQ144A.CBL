000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ144A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
000900*                             REVISED 1986, AUGUST             *
001000*                                                              *
001100*    CREATION DATE     /     VALIDATION DATE                   *
001200*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001300*                                                              *
001400****************************************************************
001500*                                                              *
001600*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001700*                                                              *
001800*            X-14   SEQUENTIAL MASS STORAGE FILE               *
001900*            X-55   SYSTEM PRINTER                             *
002000*            X-82   SOURCE-COMPUTER                            *
002100*            X-83   OBJECT-COMPUTER.                           *
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    SPLIT FROM SQ133A, THIS PROGRAM REPEATS THE SEQUENCE OF   *
002600*    FILE HANDLING ROUTINES IN ORDER TO CARRY OUT THE ISOLATED *
002700*    SPLIT TEST THAT CHECKS FOR THE CORRECT RESPONSE WHEN AN   *
002800*    ATTEMPT IS MADE TO REWRITE AFTER AT END.  (SEE SQ133A).   *
002900*                                                              *
003000****************************************************************
003100*
003200 ENVIRONMENT DIVISION.
003300 CONFIGURATION SECTION.
003400 SOURCE-COMPUTER.
003500     XXXXX082.
003600 OBJECT-COMPUTER.
003700     XXXXX083.
003800*
003900 INPUT-OUTPUT SECTION.
004000 FILE-CONTROL.
004100     SELECT PRINT-FILE ASSIGN TO
004200     XXXXX055.
004300*
004400P    SELECT RAW-DATA   ASSIGN TO
004500P    XXXXX062
004600P          ORGANIZATION IS INDEXED
004700P          ACCESS MODE  IS RANDOM
004800P          RECORD-KEY   IS RAW-DATA-KEY.
004900P
005000     SELECT SQ-FS4
005100            ASSIGN
005200     XXXXX014
005300            STATUS SQ-FS4-STATUS OF STATUS-GROUP
005400            SEQUENTIAL
005500            .
005600*
005700*
005800 DATA DIVISION.
005900 FILE SECTION.
006000 FD  PRINT-FILE
006100C    LABEL RECORDS
006200C    XXXXX084
006300C    DATA RECORD IS PRINT-REC DUMMY-RECORD
006400               .
006500 01  PRINT-REC    PICTURE X(120).
006600 01  DUMMY-RECORD PICTURE X(120).
006700P
006800PFD  RAW-DATA.
006900P01  RAW-DATA-SATZ.
007000P    05  RAW-DATA-KEY        PIC X(6).
007100P    05  C-DATE              PIC 9(6).
007200P    05  C-TIME              PIC 9(8).
007300P    05  NO-OF-TESTS         PIC 99.
007400P    05  C-OK                PIC 999.
007500P    05  C-ALL               PIC 999.
007600P    05  C-FAIL              PIC 999.
007700P    05  C-DELETED           PIC 999.
007800P    05  C-INSPECT           PIC 999.
007900P    05  C-NOTE              PIC X(13).
008000P    05  C-INDENT            PIC X.
008100P    05  C-ABORT             PIC X(8).
008200*
008300 FD  SQ-FS4
008400C    LABEL RECORD IS STANDARD
008500     BLOCK  120 CHARACTERS
008600     RECORD CONTAINS 120 CHARACTERS
008700                .
008800 01  SQ-FS4R1-F-G-120.
008900        05 FFILE-RECORD-INFO-P1-120.
009000           07 FILLER              PIC X(5).
009100           07 FFILE-NAME          PIC X(6).
009200           07 FILLER              PIC X(8).
009300           07 FRECORD-NAME        PIC X(6).
009400           07 FILLER              PIC X(1).
009500           07 FREELUNIT-NUMBER    PIC 9(1).
009600           07 FILLER              PIC X(7).
009700           07 FRECORD-NUMBER      PIC 9(6).
009800           07 FILLER              PIC X(6).
009900           07 FUPDATE-NUMBER      PIC 9(2).
010000           07 FILLER              PIC X(5).
010100           07 FODO-NUMBER         PIC 9(4).
010200           07 FILLER              PIC X(5).
010300           07 FPROGRAM-NAME       PIC X(5).
010400           07 FILLER              PIC X(7).
010500           07 FRECORD-LENGTH      PIC 9(6).
010600           07 FILLER              PIC X(7).
010700           07 FCHARS-OR-RECORDS   PIC X(2).
010800           07 FILLER              PIC X(1).
010900           07 FBLOCK-SIZE         PIC 9(4).
011000           07 FILLER              PIC X(6).
011100           07 FRECORDS-IN-FILE    PIC 9(6).
011200           07 FILLER              PIC X(5).
011300           07 FFILE-ORGANIZATION  PIC X(2).
011400           07 FILLER              PIC X(6).
011500           07 FLABEL-TYPE         PIC X(1).
011600*
011700 WORKING-STORAGE SECTION.
011800*
011900***************************************************************
012000*                                                             *
012100*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
012200*                                                             *
012300***************************************************************
012400*
012500 01  STATUS-GROUP.
012600     04  SQ-FS4-STATUS.
012700         07  SQ-FS4-KEY-1   PIC X.
012800         07  SQ-FS4-KEY-2   PIC X.
012900*
013000 01  DELETE-SW.
013100     03  DELETE-SW-1 PIC X.
013200     03  DELETE-SW-1-GROUP.
013300         05  DELETE-SW-2 PIC X.
013400*
013500 01  DECL-EXEC-I-O PIC X(12).
013600*
013700 01  DECL-EXEC-SW PIC X.
013800*
013900***************************************************************
014000*                                                             *
014100*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
014200*                                                             *
014300***************************************************************
014400*
014500 01  REC-SKEL-SUB   PIC 99.
014600*
014700 01  FILE-RECORD-INFORMATION-REC.
014800     03 FILE-RECORD-INFO-SKELETON.
014900        05 FILLER                 PICTURE X(48)       VALUE
015000             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
015100        05 FILLER                 PICTURE X(46)       VALUE
015200             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
015300        05 FILLER                 PICTURE X(26)       VALUE
015400             ",LFIL=000000,ORG=  ,LBLR= ".
015500        05 FILLER                 PICTURE X(37)       VALUE
015600             ",RECKEY=                             ".
015700        05 FILLER                 PICTURE X(38)       VALUE
015800             ",ALTKEY1=                             ".
015900        05 FILLER                 PICTURE X(38)       VALUE
016000             ",ALTKEY2=                             ".
016100        05 FILLER                 PICTURE X(7)        VALUE SPACE.
016200     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
016300        05 FILE-RECORD-INFO-P1-120.
016400           07 FILLER              PIC X(5).
016500           07 XFILE-NAME          PIC X(6).
016600           07 FILLER              PIC X(8).
016700           07 XRECORD-NAME        PIC X(6).
016800           07 FILLER              PIC X(1).
016900           07 REELUNIT-NUMBER     PIC 9(1).
017000           07 FILLER              PIC X(7).
017100           07 XRECORD-NUMBER      PIC 9(6).
017200           07 FILLER              PIC X(6).
017300           07 UPDATE-NUMBER       PIC 9(2).
017400           07 FILLER              PIC X(5).
017500           07 ODO-NUMBER          PIC 9(4).
017600           07 FILLER              PIC X(5).
017700           07 XPROGRAM-NAME       PIC X(5).
017800           07 FILLER              PIC X(7).
017900           07 XRECORD-LENGTH      PIC 9(6).
018000           07 FILLER              PIC X(7).
018100           07 CHARS-OR-RECORDS    PIC X(2).
018200           07 FILLER              PIC X(1).
018300           07 XBLOCK-SIZE         PIC 9(4).
018400           07 FILLER              PIC X(6).
018500           07 RECORDS-IN-FILE     PIC 9(6).
018600           07 FILLER              PIC X(5).
018700           07 XFILE-ORGANIZATION  PIC X(2).
018800           07 FILLER              PIC X(6).
018900           07 XLABEL-TYPE         PIC X(1).
019000        05 FILE-RECORD-INFO-P121-240.
019100           07 FILLER              PIC X(8).
019200           07 XRECORD-KEY         PIC X(29).
019300           07 FILLER              PIC X(9).
019400           07 ALTERNATE-KEY1      PIC X(29).
019500           07 FILLER              PIC X(9).
019600           07 ALTERNATE-KEY2      PIC X(29).
019700           07 FILLER              PIC X(7).
019800*
019900 01  TEST-RESULTS.
020000     02 FILLER              PIC X      VALUE SPACE.
020100     02  PAR-NAME.
020200       03 FILLER              PIC X(14)  VALUE SPACE.
020300       03 PARDOT-X            PIC X      VALUE SPACE.
020400       03 DOTVALUE            PIC 99     VALUE ZERO.
020500     02 FILLER              PIC X      VALUE SPACE.
020600     02 FEATURE             PIC X(24)  VALUE SPACE.
020700     02 FILLER              PIC X      VALUE SPACE.
020800     02 P-OR-F              PIC X(5)   VALUE SPACE.
020900     02 FILLER              PIC X(9)   VALUE SPACE.
021000     02 RE-MARK             PIC X(61).
021100 01  TEST-COMPUTED.
021200   02 FILLER  PIC X(30)  VALUE SPACE.
021300   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
021400   02 COMPUTED-X.
021500     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
021600     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
021700     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
021800     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
021900     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
022000     03       CM-18V0 REDEFINES COMPUTED-A.
022100        04 COMPUTED-18V0                   PIC -9(18).
022200        04 FILLER                          PIC X.
022300     03 FILLER PIC X(50) VALUE SPACE.
022400 01  TEST-CORRECT.
022500     02 FILLER PIC X(30) VALUE SPACE.
022600     02 FILLER PIC X(17) VALUE "       CORRECT =".
022700     02 CORRECT-X.
022800     03 CORRECT-A                  PIC X(20) VALUE SPACE.
022900     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
023000     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
023100     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
023200     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
023300     03      CR-18V0 REDEFINES CORRECT-A.
023400         04 CORRECT-18V0                     PIC -9(18).
023500         04 FILLER                           PIC X.
023600     03 FILLER PIC X(2) VALUE SPACE.
023700     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
023800*
023900 01  CCVS-C-1.
024000     02 FILLER  PIC IS X        VALUE  SPACE.
024100     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
024200     02 FILLER  PIC IS X        VALUE  SPACE.
024300     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
024400     02 FILLER  PIC IS X        VALUE  SPACE.
024500     02 FILLER  PIC IS X(5)     VALUE "PASS ".
024600     02 FILLER  PIC IS X(9)     VALUE  SPACE.
024700     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
024800 01  CCVS-C-2.
024900     02 FILLER  PIC X(19)  VALUE  SPACE.
025000     02 FILLER  PIC X(6)   VALUE "TESTED".
025100     02 FILLER  PIC X(19)  VALUE  SPACE.
025200     02 FILLER  PIC X(4)   VALUE "FAIL".
025300     02 FILLER  PIC X(72)  VALUE  SPACE.
025400*
025500 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
025600 01  REC-CT            PIC 99       VALUE ZERO.
025700 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
025800 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
025900 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
026000 01  PASS-COUNTER      PIC 999      VALUE ZERO.
026100 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
026200 01  ERROR-HOLD        PIC 999      VALUE ZERO.
026300 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
026400 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
026500 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
026600 01  CCVS-H-1.
026700     02  FILLER          PIC X(39)    VALUE SPACES.
026800     02  FILLER          PIC X(42)    VALUE
026900     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
027000     02  FILLER          PIC X(39)    VALUE SPACES.
027100 01  CCVS-H-2A.
027200   02  FILLER            PIC X(40)  VALUE SPACE.
027300   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
027400   02  FILLER            PIC XXXX   VALUE
027500     "4.2 ".
027600   02  FILLER            PIC X(28)  VALUE
027700            " COPY - NOT FOR DISTRIBUTION".
027800   02  FILLER            PIC X(41)  VALUE SPACE.
027900*
028000 01  CCVS-H-2B.
028100   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
028200   02  TEST-ID           PIC X(9).
028300   02  FILLER            PIC X(4)   VALUE " IN ".
028400   02  FILLER            PIC X(12)  VALUE
028500     " HIGH       ".
028600   02  FILLER            PIC X(22)  VALUE
028700            " LEVEL VALIDATION FOR ".
028800   02  FILLER            PIC X(58)  VALUE
028900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
029000 01  CCVS-H-3.
029100     02  FILLER          PIC X(34)  VALUE
029200            " FOR OFFICIAL USE ONLY    ".
029300     02  FILLER          PIC X(58)  VALUE
029400     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
029500     02  FILLER          PIC X(28)  VALUE
029600            "  COPYRIGHT   1985,1986 ".
029700 01  CCVS-E-1.
029800     02 FILLER           PIC X(52)  VALUE SPACE.
029900     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
030000     02 ID-AGAIN         PIC X(9).
030100     02 FILLER           PIC X(45)  VALUE SPACES.
030200 01  CCVS-E-2.
030300     02  FILLER          PIC X(31)  VALUE SPACE.
030400     02  FILLER          PIC X(21)  VALUE SPACE.
030500     02  CCVS-E-2-2.
030600         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
030700         03 FILLER         PIC X      VALUE SPACE.
030800         03 ENDER-DESC     PIC X(44)  VALUE
030900            "ERRORS ENCOUNTERED".
031000 01  CCVS-E-3.
031100     02  FILLER          PIC X(22)  VALUE
031200            " FOR OFFICIAL USE ONLY".
031300     02  FILLER          PIC X(12)  VALUE SPACE.
031400     02  FILLER          PIC X(58)  VALUE
031500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
031600     02  FILLER          PIC X(8)   VALUE SPACE.
031700     02  FILLER          PIC X(20)  VALUE
031800             " COPYRIGHT 1985,1986".
031900 01  CCVS-E-4.
032000     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
032100     02 FILLER           PIC X(4)   VALUE " OF ".
032200     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
032300     02 FILLER           PIC X(40)  VALUE
032400      "  TESTS WERE EXECUTED SUCCESSFULLY".
032500 01  XXINFO.
032600     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
032700     02 INFO-TEXT.
032800       04 FILLER             PIC X(8)   VALUE SPACE.
032900       04 XXCOMPUTED         PIC X(20).
033000       04 FILLER             PIC X(5)   VALUE SPACE.
033100       04 XXCORRECT          PIC X(20).
033200     02 INF-ANSI-REFERENCE PIC X(48).
033300 01  HYPHEN-LINE.
033400     02 FILLER  PIC IS X VALUE IS SPACE.
033500     02 FILLER  PIC IS X(65)    VALUE IS "************************
033600-    "*****************************************".
033700     02 FILLER  PIC IS X(54)    VALUE IS "************************
033800-    "******************************".
033900 01  CCVS-PGM-ID  PIC X(9)   VALUE
034000     "SQ144A".
034100*
034200*
034300 PROCEDURE DIVISION.
034400 DECLARATIVES.
034500*
034600 SECT-SQ144A-0001 SECTION.
034700     USE AFTER EXCEPTION PROCEDURE I-O.
034800 I-O-ERROR-PROCESS.
034900     MOVE   "EXECUTED" TO DECL-EXEC-I-O.
035000     IF DECL-EXEC-SW NOT = SPACE
035100         GO TO   END-DECLS.
035200*
035300     MOVE    1 TO REC-CT.
035400     MOVE   "REWRITE AFTER FAILED RD"  TO FEATURE.
035500     MOVE   "DCL-REWRITE-01" TO PAR-NAME.
035600     GO TO   DCL-REWRITE-01.
035700 DECL-DELETE-01.
035800     PERFORM DECL-DE-LETE.
035900     GO TO   DECL-TEST-01-END.
036000 DCL-REWRITE-01.
036100 DECL-TEST-01-END.
036200*
036300     PERFORM DECL-WRITE-LINE.
036400     MOVE   "ABNORMAL TERMINATION AT THIS POINT IS ACCEPTABLE"
036500               TO DUMMY-RECORD.
036600     PERFORM DECL-WRITE-LINE 3 TIMES.
036700     GO TO   END-DECLS.
036800*
036900*
037000 DECL-PASS.
037100     MOVE   "PASS " TO P-OR-F.
037200     ADD     1 TO PASS-COUNTER.
037300     PERFORM DECL-PRINT-DETAIL.
037400*
037500 DECL-FAIL.
037600     MOVE   "FAIL*" TO P-OR-F.
037700     ADD     1 TO ERROR-COUNTER.
037800     PERFORM DECL-PRINT-DETAIL.
037900*
038000 DECL-DE-LETE.
038100     MOVE   "****TEST DELETED****" TO RE-MARK.
038200     MOVE   "*****" TO P-OR-F.
038300     ADD     1 TO DELETE-COUNTER.
038400     PERFORM DECL-PRINT-DETAIL.
038500*
038600 DECL-PRINT-DETAIL.
038700     IF REC-CT NOT EQUAL TO ZERO
038800             MOVE "." TO PARDOT-X
038900             MOVE REC-CT TO DOTVALUE.
039000     MOVE    TEST-RESULTS TO PRINT-REC.
039100     PERFORM DECL-WRITE-LINE.
039200     IF P-OR-F EQUAL TO "FAIL*"
039300         PERFORM DECL-WRITE-LINE
039400         PERFORM DECL-FAIL-ROUTINE THRU DECL-FAIL-EX
039500     ELSE
039600         PERFORM DECL-BAIL THRU DECL-BAIL-EX.
039700     MOVE    SPACE TO P-OR-F.
039800     MOVE    SPACE TO COMPUTED-X.
039900     MOVE    SPACE TO CORRECT-X.
040000     IF REC-CT EQUAL TO ZERO
040100         MOVE    SPACE TO PAR-NAME.
040200     MOVE    SPACE TO RE-MARK.
040300*
040400 DECL-WRITE-LINE.
040500     ADD     1 TO RECORD-COUNT.
040600Y    IF RECORD-COUNT GREATER 50
040700Y        MOVE    DUMMY-RECORD TO DUMMY-HOLD
040800Y        MOVE    SPACE TO DUMMY-RECORD
040900Y        WRITE   DUMMY-RECORD AFTER ADVANCING PAGE
041000Y        MOVE    CCVS-C-1 TO DUMMY-RECORD PERFORM DECL-WRT-LN
041100Y        MOVE    CCVS-C-2 TO DUMMY-RECORD
041200Y        PERFORM DECL-WRT-LN 2 TIMES
041300Y        MOVE    HYPHEN-LINE TO DUMMY-RECORD
041400Y        PERFORM DECL-WRT-LN
041500Y        MOVE    DUMMY-HOLD TO DUMMY-RECORD
041600Y        MOVE    ZERO TO RECORD-COUNT.
041700     PERFORM DECL-WRT-LN.
041800*
041900 DECL-WRT-LN.
042000     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
042100     MOVE    SPACE TO DUMMY-RECORD.
042200*
042300 DECL-FAIL-ROUTINE.
042400     IF COMPUTED-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
042500     IF CORRECT-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
042600     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
042700     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
042800     MOVE    XXINFO TO DUMMY-RECORD.
042900     PERFORM DECL-WRITE-LINE 2 TIMES.
043000     MOVE    SPACES TO INF-ANSI-REFERENCE.
043100     GO TO   DECL-FAIL-EX.
043200 DECL-FAIL-WRITE.
043300     MOVE    TEST-COMPUTED TO PRINT-REC
043400     PERFORM DECL-WRITE-LINE
043500     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
043600     MOVE    TEST-CORRECT TO PRINT-REC
043700     PERFORM DECL-WRITE-LINE 2 TIMES.
043800     MOVE    SPACES TO COR-ANSI-REFERENCE.
043900 DECL-FAIL-EX.
044000     EXIT.
044100*
044200 DECL-BAIL.
044300     IF COMPUTED-A NOT EQUAL TO SPACE GO TO DECL-BAIL-WRITE.
044400     IF CORRECT-A EQUAL TO SPACE GO TO DECL-BAIL-EX.
044500 DECL-BAIL-WRITE.
044600     MOVE    CORRECT-A TO XXCORRECT.
044700     MOVE    COMPUTED-A TO XXCOMPUTED.
044800     MOVE    XXINFO TO DUMMY-RECORD.
044900     PERFORM DECL-WRITE-LINE 2 TIMES.
045000 DECL-BAIL-EX.
045100     EXIT.
045200*
045300 END-DECLS.
045400 END DECLARATIVES.
045500*
045600*
045700 CCVS1 SECTION.
045800 OPEN-FILES.
045900P    OPEN    I-O RAW-DATA.
046000P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
046100P    READ    RAW-DATA INVALID KEY GO TO END-E-1.
046200P    MOVE   "ABORTED "   TO C-ABORT.
046300P    ADD     1           TO C-NO-OF-TESTS.
046400P    ACCEPT  C-DATE      FROM DATE.
046500P    ACCEPT  C-TIME      FROM TIME.
046600P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
046700PEND-E-1.
046800P    CLOSE   RAW-DATA.
046900     OPEN    OUTPUT PRINT-FILE.
047000     MOVE    CCVS-PGM-ID TO TEST-ID.
047100     MOVE    CCVS-PGM-ID TO ID-AGAIN.
047200     MOVE    SPACE TO TEST-RESULTS.
047300     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
047400     MOVE    ZERO TO REC-SKEL-SUB.
047500     PERFORM CCVS-INIT-FILE 10 TIMES.
047600     GO TO CCVS1-EXIT.
047700*
047800 CCVS-INIT-FILE.
047900     ADD     1 TO REC-SKL-SUB.
048000     MOVE    FILE-RECORD-INFO-SKELETON TO
048100                  FILE-RECORD-INFO (REC-SKL-SUB).
048200*
048300 CLOSE-FILES.
048400     PERFORM END-ROUTINE THRU END-ROUTINE-13.
048500     CLOSE   PRINT-FILE.
048600P    OPEN    I-O RAW-DATA.
048700P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
048800P    READ    RAW-DATA INVALID KEY GO TO END-E-2.
048900P    MOVE   "OK.     " TO C-ABORT.
049000P    MOVE    PASS-COUNTER  TO C-OK.
049100P    MOVE    ERROR-HOLD    TO C-ALL.
049200P    MOVE    ERROR-COUNTER TO C-FAIL.
049300P    MOVE    DELETE-CNT    TO C-DELETED.
049400P    MOVE    INSPECT-COUNTER TO C-INSPECT.
049500P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
049600PEND-E-2.
049700P    CLOSE   RAW-DATA.
049800 TERMINATE-CCVS.
049900S    EXIT    PROGRAM.
050000     STOP    RUN.
050100*
050200 INSPT.
050300     MOVE   "INSPT" TO P-OR-F.
050400     ADD     1 TO INSPECT-COUNTER.
050500     PERFORM PRINT-DETAIL.
050600*
050700 PASS.
050800     MOVE   "PASS " TO P-OR-F.
050900     ADD     1 TO PASS-COUNTER.
051000     PERFORM PRINT-DETAIL.
051100*
051200 FAIL.
051300     MOVE   "FAIL*" TO P-OR-F.
051400     ADD     1 TO ERROR-COUNTER.
051500     PERFORM PRINT-DETAIL.
051600*
051700 DE-LETE.
051800     MOVE   "****TEST DELETED****" TO RE-MARK.
051900     MOVE   "*****" TO P-OR-F.
052000     ADD     1 TO DELETE-COUNTER.
052100     PERFORM PRINT-DETAIL.
052200*
052300 PRINT-DETAIL.
052400     IF REC-CT NOT EQUAL TO ZERO
052500         MOVE   "." TO PARDOT-X
052600         MOVE    REC-CT TO DOTVALUE.
052700     MOVE    TEST-RESULTS TO PRINT-REC.
052800     PERFORM WRITE-LINE.
052900     IF P-OR-F EQUAL TO "FAIL*"
053000         PERFORM WRITE-LINE
053100         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
053200     ELSE
053300         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
053400     MOVE    SPACE TO P-OR-F.
053500     MOVE    SPACE TO COMPUTED-X.
053600     MOVE    SPACE TO CORRECT-X.
053700     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
053800     MOVE    SPACE TO RE-MARK.
053900*
054000 HEAD-ROUTINE.
054100     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
054200     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
054300     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
054400     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
054500 COLUMN-NAMES-ROUTINE.
054600     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
054700     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
054800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
054900 END-ROUTINE.
055000     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
055100     PERFORM WRITE-LINE 5 TIMES.
055200 END-RTN-EXIT.
055300     MOVE    CCVS-E-1 TO DUMMY-RECORD.
055400     PERFORM WRITE-LINE 2 TIMES.
055500*
055600 END-ROUTINE-1.
055700     ADD     ERROR-COUNTER   TO ERROR-HOLD
055800     ADD     INSPECT-COUNTER TO ERROR-HOLD.
055900     ADD     DELETE-COUNTER  TO ERROR-HOLD.
056000     ADD     PASS-COUNTER    TO ERROR-HOLD.
056100     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
056200     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
056300     MOVE    CCVS-E-4        TO CCVS-E-2-2.
056400     MOVE    CCVS-E-2        TO DUMMY-RECORD
056500     PERFORM WRITE-LINE.
056600     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
056700     IF ERROR-COUNTER IS EQUAL TO ZERO
056800         MOVE   "NO " TO ERROR-TOTAL
056900     ELSE
057000         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
057100     MOVE    CCVS-E-2 TO DUMMY-RECORD.
057200     PERFORM WRITE-LINE.
057300 END-ROUTINE-13.
057400     IF DELETE-COUNTER IS EQUAL TO ZERO
057500         MOVE   "NO " TO ERROR-TOTAL
057600     ELSE
057700         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
057800     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
057900     MOVE    CCVS-E-2 TO DUMMY-RECORD.
058000     PERFORM WRITE-LINE.
058100     IF INSPECT-COUNTER EQUAL TO ZERO
058200         MOVE   "NO " TO ERROR-TOTAL
058300     ELSE
058400         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
058500     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
058600     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
058700     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
058800*
058900 WRITE-LINE.
059000     ADD     1 TO RECORD-COUNT.
059100Y    IF RECORD-COUNT GREATER 50
059200Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
059300Y        MOVE  SPACE TO DUMMY-RECORD
059400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
059500Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
059600Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
059700Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
059800Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
059900Y        MOVE  ZERO TO RECORD-COUNT.
060000     PERFORM WRT-LN.
060100*
060200 WRT-LN.
060300     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
060400     MOVE    SPACE TO DUMMY-RECORD.
060500 BLANK-LINE-PRINT.
060600     PERFORM WRT-LN.
060700 FAIL-ROUTINE.
060800     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
060900     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
061000     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
061100     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
061200     MOVE    XXINFO TO DUMMY-RECORD.
061300     PERFORM WRITE-LINE 2 TIMES.
061400     MOVE    SPACES TO INF-ANSI-REFERENCE.
061500     GO TO   FAIL-ROUTINE-EX.
061600 FAIL-ROUTINE-WRITE.
061700     MOVE    TEST-COMPUTED  TO PRINT-REC
061800     PERFORM WRITE-LINE
061900     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
062000     MOVE    TEST-CORRECT   TO PRINT-REC
062100     PERFORM WRITE-LINE 2 TIMES.
062200     MOVE    SPACES         TO COR-ANSI-REFERENCE.
062300 FAIL-ROUTINE-EX.
062400     EXIT.
062500 BAIL-OUT.
062600     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
062700     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
062800 BAIL-OUT-WRITE.
062900     MOVE    CORRECT-A      TO XXCORRECT.
063000     MOVE    COMPUTED-A     TO XXCOMPUTED.
063100     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
063200     MOVE    XXINFO TO DUMMY-RECORD.
063300     PERFORM WRITE-LINE 2 TIMES.
063400     MOVE    SPACES TO INF-ANSI-REFERENCE.
063500 BAIL-OUT-EX.
063600     EXIT.
063700 CCVS1-EXIT.
063800     EXIT.
063900*
064000****************************************************************
064100*                                                              *
064200*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
064300*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
064400*                                                              *
064500****************************************************************
064600*
064700 SECT-SQ144A-0002 SECTION.
064800 STA-INIT.
064900     MOVE    SPACE TO DELETE-SW.
065000*
065100     MOVE   "SQ-FS4" TO XFILE-NAME (1).
065200     MOVE   "R1-F-G" TO XRECORD-NAME (1).
065300     MOVE    CCVS-PGM-ID TO XPROGRAM-NAME (1).
065400     MOVE    120 TO XRECORD-LENGTH (1).
065500     MOVE   "CC" TO CHARS-OR-RECORDS (1).
065600     MOVE    1   TO XBLOCK-SIZE (1).
065700     MOVE    1   TO RECORDS-IN-FILE (1).
065800     MOVE   "SQ" TO XFILE-ORGANIZATION (1).
065900     MOVE   "S"  TO XLABEL-TYPE (1).
066000*
066100*    OPEN THE FILE IN THE OUTPUT MODE
066200*
066300 SEQ-INIT-01.
066400     MOVE    0 TO REC-CT.
066500     MOVE   "*" TO DECL-EXEC-SW.
066600     MOVE   "**" TO SQ-FS4-STATUS.
066700     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
066800     MOVE    ZERO TO XRECORD-NUMBER (1).
066900     MOVE   "OPEN, CREATE FILE"  TO FEATURE.
067000     MOVE   "SEQ-TEST-OP-01" TO PAR-NAME.
067100     GO TO   SEQ-TEST-OP-01.
067200 SEQ-DELETE-01.
067300     MOVE   "*" TO DELETE-SW-1.
067400 SEQ-TEST-OP-01.
067500     OPEN    OUTPUT SQ-FS4.
067600 SEQ-INIT-02.
067700     MOVE    0 TO REC-CT.
067800     MOVE   "*" TO DECL-EXEC-SW.
067900     ADD     1 TO XRECORD-NUMBER (1).
068000     MOVE   "**" TO SQ-FS4-STATUS.
068100     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
068200     MOVE   "WRITE A RECORD"  TO FEATURE.
068300     MOVE   "SEQ-TEST-WR-02" TO PAR-NAME.
068400 SEQ-TEST-WR-02.
068500     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-FS4R1-F-G-120.
068600     WRITE   SQ-FS4R1-F-G-120.
068700 SEQ-INIT-03.
068800     MOVE    0 TO REC-CT.
068900     MOVE   "*" TO DECL-EXEC-SW.
069000     MOVE   "**" TO SQ-FS4-STATUS.
069100     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
069200     MOVE   "CLOSE FILE" TO FEATURE.
069300     MOVE   "SEQ-TEST-CL-03" TO PAR-NAME.
069400 SEQ-TEST-CL-03.
069500     CLOSE   SQ-FS4.
069600 SEQ-INIT-04.
069700     MOVE    0 TO REC-CT.
069800     MOVE   "*" TO DECL-EXEC-SW.
069900     MOVE   "**" TO SQ-FS4-STATUS.
070000     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
070100     MOVE    ZERO TO XRECORD-NUMBER (1).
070200     MOVE   "OPEN FILE FOR I-O" TO FEATURE.
070300     MOVE   "SEQ-TEST-OP-04" TO PAR-NAME.
070400 SEQ-TEST-OP-04.
070500     OPEN    I-O SQ-FS4.
070600 SEQ-INIT-05.
070700     MOVE    0 TO REC-CT.
070800     MOVE   "*" TO DECL-EXEC-SW.
070900     ADD     1 TO XRECORD-NUMBER (1).
071000     MOVE   "**" TO SQ-FS4-STATUS.
071100     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
071200     MOVE   "READ FIRST RECORD" TO FEATURE.
071300     MOVE   "SEQ-TEST-RD-05" TO PAR-NAME.
071400 SEQ-TEST-RD-05.
071500     MOVE    SPACE TO SQ-FS4R1-F-G-120.
071600     READ    SQ-FS4.
071700 SEQ-INIT-06.
071800     MOVE    0 TO REC-CT.
071900     MOVE   "*" TO DECL-EXEC-SW.
072000     ADD     1 TO XRECORD-NUMBER (1).
072100     MOVE   "**" TO SQ-FS4-STATUS.
072200     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
072300     MOVE   "READ GIVING AT END" TO FEATURE.
072400     MOVE   "SEQ-TEST-RD-06" TO PAR-NAME.
072500 SEQ-TEST-RD-06.
072600     READ    SQ-FS4 RECORD.
072700 SEQ-INIT-07.
072800     MOVE    0 TO REC-CT.
072900     MOVE    SPACE TO DECL-EXEC-SW.
073000     MOVE   "**" TO SQ-FS4-STATUS.
073100     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
073200     MOVE   "REWRITE AFTER AT END" TO FEATURE.
073300     MOVE   "SEQ-TEST-RW-07" TO PAR-NAME.
073400 SEQ-TEST-RW-07.
073500     REWRITE SQ-FS4R1-F-G-120.
073600     MOVE    0 TO REC-CT.
073700     MOVE   "REWRITE AFTER AT END" TO FEATURE.
073800     MOVE   "SEQ-TEST-RW-07" TO PAR-NAME.
073900*
074000*    CHECK I-O STATUS RETURNED FROM REWRITE
074100*
074200     ADD    1 TO REC-CT.
074300 SEQ-TEST-07-01-END.
074400*
074500*    CHECK EXECUTION OF I-O DECLARATIVE
074600*
074700     ADD     1 TO REC-CT.
074800     IF DELETE-SW NOT = SPACE
074900         GO TO   SEQ-DELETE-07-02.
075000     GO TO   SEQ-TEST-RW-07-02.
075100 SEQ-DELETE-07-02.
075200     PERFORM DE-LETE.
075300     GO TO   SEQ-TEST-07-02-END.
075400 SEQ-TEST-RW-07-02.
075500     IF DECL-EXEC-I-O = "EXECUTED"
075600         PERFORM PASS
075700     ELSE
075800         MOVE    DECL-EXEC-I-O TO COMPUTED-A
075900         MOVE   "EXECUTED" TO CORRECT-A
076000         MOVE   "I-O DECLARATIVE NOT EXECUTED"
076100                   TO RE-MARK
076200         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
076300         PERFORM FAIL.
076400 SEQ-TEST-07-02-END.
076500*
076600*
076700 CCVS-EXIT SECTION.
076800 CCVS-999999.
076900     GO TO   CLOSE-FILES.
