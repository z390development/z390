000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ136A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
000900*                             REVISED 1986, AUGUST             *
001000*                                                              *
001100*    CREATION DATE     /     VALIDATION DATE                   *
001200*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001300*                                                              *
001400****************************************************************
001500*                                                              *
001600*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001700*                                                              *
001800*            X-14   SEQUENTIAL MASS STORAGE FILE               *
001900*            X-55   SYSTEM PRINTER                             *
002000*            X-82   SOURCE-COMPUTER                            *
002100*            X-83   OBJECT-COMPUTER.                           *
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    SPLIT FROM SQ122A, THIS PROGRAM REPEATS THE SEQUENCE OF   *
002600*    FILE HANDLING ROUTINES IN ORDER TO CARRY OUT THE ISOLATED *
002700*    SPLIT TEST THAT CHECKS FOR THE CORRECT RESPONSE TO READING*
002800*    PAST THE END OF A FILE. (SEE SQ122A).                     *
002900*                                                              *
003000****************************************************************
003100*
003200 ENVIRONMENT DIVISION.
003300 CONFIGURATION SECTION.
003400 SOURCE-COMPUTER.
003500     XXXXX082.
003600 OBJECT-COMPUTER.
003700     XXXXX083.
003800*
003900 INPUT-OUTPUT SECTION.
004000 FILE-CONTROL.
004100     SELECT PRINT-FILE ASSIGN TO
004200     XXXXX055.
004300*
004400P    SELECT RAW-DATA   ASSIGN TO
004500P    XXXXX062
004600P          ORGANIZATION IS INDEXED
004700P          ACCESS MODE  IS RANDOM
004800P          RECORD-KEY   IS RAW-DATA-KEY.
004900P
005000     SELECT SQ-FS4 ASSIGN
005100     XXXXX014
005200            FILE STATUS IS SQ-FS4-STATUS.
005300*
005400*
005500 DATA DIVISION.
005600 FILE SECTION.
005700 FD  PRINT-FILE
005800C    LABEL RECORDS
005900C    XXXXX084
006000C    DATA RECORD IS PRINT-REC DUMMY-RECORD
006100               .
006200 01  PRINT-REC    PICTURE X(120).
006300 01  DUMMY-RECORD PICTURE X(120).
006400P
006500PFD  RAW-DATA.
006600P01  RAW-DATA-SATZ.
006700P    05  RAW-DATA-KEY        PIC X(6).
006800P    05  C-DATE              PIC 9(6).
006900P    05  C-TIME              PIC 9(8).
007000P    05  NO-OF-TESTS         PIC 99.
007100P    05  C-OK                PIC 999.
007200P    05  C-ALL               PIC 999.
007300P    05  C-FAIL              PIC 999.
007400P    05  C-DELETED           PIC 999.
007500P    05  C-INSPECT           PIC 999.
007600P    05  C-NOTE              PIC X(13).
007700P    05  C-INDENT            PIC X.
007800P    05  C-ABORT             PIC X(8).
007900*
008000 FD  SQ-FS4
008100C    LABEL RECORD IS STANDARD
008200     BLOCK  2 RECORDS
008300     RECORD 125
008400                .
008500 01  SQ-FS4R1-F-G-125.
008600     05  SQ-FS4-FIRST  PIC X(120).
008700     05  SQ-FS4-REC-NO PIC 99999.
008800*
008900 WORKING-STORAGE SECTION.
009000*
009100***************************************************************
009200*                                                             *
009300*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
009400*                                                             *
009500***************************************************************
009600*
009700 01  SQ-FS4-STATUS.
009800   03  SQ-FS4-KEY-1   PIC X.
009900   03  SQ-FS4-KEY-2   PIC X.
010000*
010100 01  DELETE-SW.
010200     03  DELETE-SW-1 PIC X.
010300     03  DELETE-SW-1-GROUP.
010400         05  DELETE-SW-2 PIC X.
010500*
010600 01  DECL-EXEC-I  PIC X(12).
010700 01  DECL-EXEC-O  PIC X(12).
010800 01  DECL-EXEC-SW PIC X.
010900*
011000***************************************************************
011100*                                                             *
011200*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
011300*                                                             *
011400***************************************************************
011500*
011600 01  REC-SKEL-SUB   PIC 99.
011700*
011800 01  FILE-RECORD-INFORMATION-REC.
011900     03 FILE-RECORD-INFO-SKELETON.
012000        05 FILLER                 PICTURE X(48)       VALUE
012100             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
012200        05 FILLER                 PICTURE X(46)       VALUE
012300             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
012400        05 FILLER                 PICTURE X(26)       VALUE
012500             ",LFIL=000000,ORG=  ,LBLR= ".
012600        05 FILLER                 PICTURE X(37)       VALUE
012700             ",RECKEY=                             ".
012800        05 FILLER                 PICTURE X(38)       VALUE
012900             ",ALTKEY1=                             ".
013000        05 FILLER                 PICTURE X(38)       VALUE
013100             ",ALTKEY2=                             ".
013200        05 FILLER                 PICTURE X(7)        VALUE SPACE.
013300     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
013400        05 FILE-RECORD-INFO-P1-120.
013500           07 FILLER              PIC X(5).
013600           07 XFILE-NAME          PIC X(6).
013700           07 FILLER              PIC X(8).
013800           07 XRECORD-NAME        PIC X(6).
013900           07 FILLER              PIC X(1).
014000           07 REELUNIT-NUMBER     PIC 9(1).
014100           07 FILLER              PIC X(7).
014200           07 XRECORD-NUMBER      PIC 9(6).
014300           07 FILLER              PIC X(6).
014400           07 UPDATE-NUMBER       PIC 9(2).
014500           07 FILLER              PIC X(5).
014600           07 ODO-NUMBER          PIC 9(4).
014700           07 FILLER              PIC X(5).
014800           07 XPROGRAM-NAME       PIC X(5).
014900           07 FILLER              PIC X(7).
015000           07 XRECORD-LENGTH      PIC 9(6).
015100           07 FILLER              PIC X(7).
015200           07 CHARS-OR-RECORDS    PIC X(2).
015300           07 FILLER              PIC X(1).
015400           07 XBLOCK-SIZE         PIC 9(4).
015500           07 FILLER              PIC X(6).
015600           07 RECORDS-IN-FILE     PIC 9(6).
015700           07 FILLER              PIC X(5).
015800           07 XFILE-ORGANIZATION  PIC X(2).
015900           07 FILLER              PIC X(6).
016000           07 XLABEL-TYPE         PIC X(1).
016100        05 FILE-RECORD-INFO-P121-240.
016200           07 FILLER              PIC X(8).
016300           07 XRECORD-KEY         PIC X(29).
016400           07 FILLER              PIC X(9).
016500           07 ALTERNATE-KEY1      PIC X(29).
016600           07 FILLER              PIC X(9).
016700           07 ALTERNATE-KEY2      PIC X(29).
016800           07 FILLER              PIC X(7).
016900*
017000 01  TEST-RESULTS.
017100     02 FILLER              PIC X      VALUE SPACE.
017200     02  PAR-NAME.
017300       03 FILLER              PIC X(14)  VALUE SPACE.
017400       03 PARDOT-X            PIC X      VALUE SPACE.
017500       03 DOTVALUE            PIC 99     VALUE ZERO.
017600     02 FILLER              PIC X      VALUE SPACE.
017700     02 FEATURE             PIC X(24)  VALUE SPACE.
017800     02 FILLER              PIC X      VALUE SPACE.
017900     02 P-OR-F              PIC X(5)   VALUE SPACE.
018000     02 FILLER              PIC X(9)   VALUE SPACE.
018100     02 RE-MARK             PIC X(61).
018200 01  TEST-COMPUTED.
018300   02 FILLER  PIC X(30)  VALUE SPACE.
018400   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
018500   02 COMPUTED-X.
018600     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
018700     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
018800     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
018900     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
019000     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
019100     03       CM-18V0 REDEFINES COMPUTED-A.
019200        04 COMPUTED-18V0                   PIC -9(18).
019300        04 FILLER                          PIC X.
019400     03 FILLER PIC X(50) VALUE SPACE.
019500 01  TEST-CORRECT.
019600     02 FILLER PIC X(30) VALUE SPACE.
019700     02 FILLER PIC X(17) VALUE "       CORRECT =".
019800     02 CORRECT-X.
019900     03 CORRECT-A                  PIC X(20) VALUE SPACE.
020000     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
020100     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
020200     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
020300     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
020400     03      CR-18V0 REDEFINES CORRECT-A.
020500         04 CORRECT-18V0                     PIC -9(18).
020600         04 FILLER                           PIC X.
020700     03 FILLER PIC X(2) VALUE SPACE.
020800     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
020900*
021000 01  CCVS-C-1.
021100     02 FILLER  PIC IS X        VALUE  SPACE.
021200     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
021300     02 FILLER  PIC IS X        VALUE  SPACE.
021400     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
021500     02 FILLER  PIC IS X        VALUE  SPACE.
021600     02 FILLER  PIC IS X(5)     VALUE "PASS ".
021700     02 FILLER  PIC IS X(9)     VALUE  SPACE.
021800     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
021900 01  CCVS-C-2.
022000     02 FILLER  PIC X(19)  VALUE  SPACE.
022100     02 FILLER  PIC X(6)   VALUE "TESTED".
022200     02 FILLER  PIC X(19)  VALUE  SPACE.
022300     02 FILLER  PIC X(4)   VALUE "FAIL".
022400     02 FILLER  PIC X(72)  VALUE  SPACE.
022500*
022600 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
022700 01  REC-CT            PIC 99       VALUE ZERO.
022800 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
022900 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
023000 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
023100 01  PASS-COUNTER      PIC 999      VALUE ZERO.
023200 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
023300 01  ERROR-HOLD        PIC 999      VALUE ZERO.
023400 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
023500 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
023600 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
023700 01  CCVS-H-1.
023800     02  FILLER          PIC X(39)    VALUE SPACES.
023900     02  FILLER          PIC X(42)    VALUE
024000     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
024100     02  FILLER          PIC X(39)    VALUE SPACES.
024200 01  CCVS-H-2A.
024300   02  FILLER            PIC X(40)  VALUE SPACE.
024400   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
024500   02  FILLER            PIC XXXX   VALUE
024600     "4.2 ".
024700   02  FILLER            PIC X(28)  VALUE
024800            " COPY - NOT FOR DISTRIBUTION".
024900   02  FILLER            PIC X(41)  VALUE SPACE.
025000*
025100 01  CCVS-H-2B.
025200   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
025300   02  TEST-ID           PIC X(9).
025400   02  FILLER            PIC X(4)   VALUE " IN ".
025500   02  FILLER            PIC X(12)  VALUE
025600     " HIGH       ".
025700   02  FILLER            PIC X(22)  VALUE
025800            " LEVEL VALIDATION FOR ".
025900   02  FILLER            PIC X(58)  VALUE
026000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
026100 01  CCVS-H-3.
026200     02  FILLER          PIC X(34)  VALUE
026300            " FOR OFFICIAL USE ONLY    ".
026400     02  FILLER          PIC X(58)  VALUE
026500     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
026600     02  FILLER          PIC X(28)  VALUE
026700            "  COPYRIGHT   1985,1986 ".
026800 01  CCVS-E-1.
026900     02 FILLER           PIC X(52)  VALUE SPACE.
027000     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
027100     02 ID-AGAIN         PIC X(9).
027200     02 FILLER           PIC X(45)  VALUE SPACES.
027300 01  CCVS-E-2.
027400     02  FILLER          PIC X(31)  VALUE SPACE.
027500     02  FILLER          PIC X(21)  VALUE SPACE.
027600     02  CCVS-E-2-2.
027700         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
027800         03 FILLER         PIC X      VALUE SPACE.
027900         03 ENDER-DESC     PIC X(44)  VALUE
028000            "ERRORS ENCOUNTERED".
028100 01  CCVS-E-3.
028200     02  FILLER          PIC X(22)  VALUE
028300            " FOR OFFICIAL USE ONLY".
028400     02  FILLER          PIC X(12)  VALUE SPACE.
028500     02  FILLER          PIC X(58)  VALUE
028600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
028700     02  FILLER          PIC X(8)   VALUE SPACE.
028800     02  FILLER          PIC X(20)  VALUE
028900             " COPYRIGHT 1985,1986".
029000 01  CCVS-E-4.
029100     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
029200     02 FILLER           PIC X(4)   VALUE " OF ".
029300     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
029400     02 FILLER           PIC X(40)  VALUE
029500      "  TESTS WERE EXECUTED SUCCESSFULLY".
029600 01  XXINFO.
029700     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
029800     02 INFO-TEXT.
029900       04 FILLER             PIC X(8)   VALUE SPACE.
030000       04 XXCOMPUTED         PIC X(20).
030100       04 FILLER             PIC X(5)   VALUE SPACE.
030200       04 XXCORRECT          PIC X(20).
030300     02 INF-ANSI-REFERENCE PIC X(48).
030400 01  HYPHEN-LINE.
030500     02 FILLER  PIC IS X VALUE IS SPACE.
030600     02 FILLER  PIC IS X(65)    VALUE IS "************************
030700-    "*****************************************".
030800     02 FILLER  PIC IS X(54)    VALUE IS "************************
030900-    "******************************".
031000 01  CCVS-PGM-ID  PIC X(9)   VALUE
031100     "SQ136A".
031200*
031300*
031400 PROCEDURE DIVISION.
031500 DECLARATIVES.
031600*
031700*    FIRST, A DECLARATIVE FOR THE PRINT FILE, IN CASE THERE
031800*    IS AN ERROR ON PRINTING DURING EXECUTION OF THE OUTPUT
031900*    DECLARATIVE.  PAGE VII-51, 4.6.4(7) STATES THAT THE
032000*    INVOCATION OF THE SAME DECLARATIVE TWICE IS ILLEGAL.
032100*
032200 SECT-SQ136A-0000 SECTION.
032300     USE AFTER STANDARD ERROR PROCEDURE ON PRINT-FILE.
032400 PRINT-FILE-ERROR-PROCESS.
032500     EXIT.
032600*
032700 SECT-SQ136A-0001 SECTION.
032800     USE AFTER STANDARD EXCEPTION PROCEDURE OUTPUT.
032900 OUTPUT-ERROR-PROCESS.
033000     MOVE   "EXECUTED" TO DECL-EXEC-O.
033100*
033200 SECT-SQ136A-0002 SECTION.
033300     USE AFTER EXCEPTION PROCEDURE INPUT.
033400 INPUT-ERROR-PROCESS.
033500     MOVE   "EXECUTED" TO DECL-EXEC-I.
033600*
033700     IF DECL-EXEC-SW NOT = SPACE
033800         GO TO   END-DECLS.
033900*
034000     MOVE    1 TO REC-CT.
034100     MOVE   "READ AFTER EOF READ" TO FEATURE.
034200     MOVE   "DECL-EOF-READ" TO PAR-NAME.
034300     GO TO   DECL-EOF-READ-01.
034400 DECL-DELETE-01.
034500     PERFORM DECL-DE-LETE.
034600     GO TO   DECL-TEST-01-END.
034700 DECL-EOF-READ-01.
034800 DECL-TEST-01-END.
034900*
035000     ADD     1 TO REC-CT.
035100     GO TO   DECL-EOF-READ-02.
035200 DECL-DELETE-02.
035300     PERFORM DECL-DE-LETE.
035400     GO TO   DECL-TEST-02-END.
035500 DECL-EOF-READ-02.
035600 DECL-TEST-02-END.
035700*
035800     MOVE    SPACE TO DUMMY-RECORD.
035900     PERFORM DECL-WRITE-LINE.
036000     MOVE   "ABNORMAL TERMINATION OF PROGRAM HERE IS ACCEPTABLE"
036100                TO DUMMY-RECORD.
036200     PERFORM DECL-WRITE-LINE 3 TIMES.
036300     GO TO   END-DECLS.
036400*
036500*
036600 DECL-PASS.
036700     MOVE   "PASS " TO P-OR-F.
036800     ADD     1 TO PASS-COUNTER.
036900     PERFORM DECL-PRINT-DETAIL.
037000*
037100 DECL-FAIL.
037200     MOVE   "FAIL*" TO P-OR-F.
037300     ADD     1 TO ERROR-COUNTER.
037400     PERFORM DECL-PRINT-DETAIL.
037500*
037600 DECL-DE-LETE.
037700     MOVE   "****TEST DELETED****" TO RE-MARK.
037800     MOVE   "*****" TO P-OR-F.
037900     ADD     1 TO DELETE-COUNTER.
038000     PERFORM DECL-PRINT-DETAIL.
038100*
038200 DECL-PRINT-DETAIL.
038300     IF REC-CT NOT EQUAL TO ZERO
038400             MOVE "." TO PARDOT-X
038500             MOVE REC-CT TO DOTVALUE.
038600     MOVE    TEST-RESULTS TO PRINT-REC.
038700     PERFORM DECL-WRITE-LINE.
038800     IF P-OR-F EQUAL TO "FAIL*"
038900         PERFORM DECL-WRITE-LINE
039000         PERFORM DECL-FAIL-ROUTINE THRU DECL-FAIL-EX
039100     ELSE
039200         PERFORM DECL-BAIL THRU DECL-BAIL-EX.
039300     MOVE    SPACE TO P-OR-F.
039400     MOVE    SPACE TO COMPUTED-X.
039500     MOVE    SPACE TO CORRECT-X.
039600     IF REC-CT EQUAL TO ZERO
039700         MOVE    SPACE TO PAR-NAME.
039800     MOVE    SPACE TO RE-MARK.
039900*
040000 DECL-WRITE-LINE.
040100     ADD     1 TO RECORD-COUNT.
040200Y    IF RECORD-COUNT GREATER 50
040300Y        MOVE    DUMMY-RECORD TO DUMMY-HOLD
040400Y        MOVE    SPACE TO DUMMY-RECORD
040500Y        WRITE   DUMMY-RECORD AFTER ADVANCING PAGE
040600Y        MOVE    CCVS-C-1 TO DUMMY-RECORD PERFORM DECL-WRT-LN
040700Y        MOVE    CCVS-C-2 TO DUMMY-RECORD
040800Y        PERFORM DECL-WRT-LN 2 TIMES
040900Y        MOVE    HYPHEN-LINE TO DUMMY-RECORD
041000Y        PERFORM DECL-WRT-LN
041100Y        MOVE    DUMMY-HOLD TO DUMMY-RECORD
041200Y        MOVE    ZERO TO RECORD-COUNT.
041300     PERFORM DECL-WRT-LN.
041400*
041500 DECL-WRT-LN.
041600     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
041700     MOVE    SPACE TO DUMMY-RECORD.
041800*
041900 DECL-FAIL-ROUTINE.
042000     IF COMPUTED-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
042100     IF CORRECT-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
042200     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
042300     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
042400     MOVE    XXINFO TO DUMMY-RECORD.
042500     PERFORM DECL-WRITE-LINE 2 TIMES.
042600     MOVE    SPACES TO INF-ANSI-REFERENCE.
042700     GO TO   DECL-FAIL-EX.
042800 DECL-FAIL-WRITE.
042900     MOVE    TEST-COMPUTED TO PRINT-REC
043000     PERFORM DECL-WRITE-LINE
043100     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
043200     MOVE    TEST-CORRECT TO PRINT-REC
043300     PERFORM DECL-WRITE-LINE 2 TIMES.
043400     MOVE    SPACES TO COR-ANSI-REFERENCE.
043500 DECL-FAIL-EX.
043600     EXIT.
043700*
043800 DECL-BAIL.
043900     IF COMPUTED-A NOT EQUAL TO SPACE GO TO DECL-BAIL-WRITE.
044000     IF CORRECT-A EQUAL TO SPACE GO TO DECL-BAIL-EX.
044100 DECL-BAIL-WRITE.
044200     MOVE    CORRECT-A TO XXCORRECT.
044300     MOVE    COMPUTED-A TO XXCOMPUTED.
044400     MOVE    XXINFO TO DUMMY-RECORD.
044500     PERFORM DECL-WRITE-LINE 2 TIMES.
044600 DECL-BAIL-EX.
044700     EXIT.
044800*
044900 END-DECLS.
045000 END DECLARATIVES.
045100*
045200*
045300 CCVS1 SECTION.
045400 OPEN-FILES.
045500P    OPEN    I-O RAW-DATA.
045600P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
045700P    READ    RAW-DATA INVALID KEY GO TO END-E-1.
045800P    MOVE   "ABORTED "   TO C-ABORT.
045900P    ADD     1           TO C-NO-OF-TESTS.
046000P    ACCEPT  C-DATE      FROM DATE.
046100P    ACCEPT  C-TIME      FROM TIME.
046200P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
046300PEND-E-1.
046400P    CLOSE   RAW-DATA.
046500     OPEN    OUTPUT PRINT-FILE.
046600     MOVE    CCVS-PGM-ID TO TEST-ID.
046700     MOVE    CCVS-PGM-ID TO ID-AGAIN.
046800     MOVE    SPACE TO TEST-RESULTS.
046900     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
047000     MOVE    ZERO TO REC-SKEL-SUB.
047100     PERFORM CCVS-INIT-FILE 10 TIMES.
047200     GO TO CCVS1-EXIT.
047300*
047400 CCVS-INIT-FILE.
047500     ADD     1 TO REC-SKL-SUB.
047600     MOVE    FILE-RECORD-INFO-SKELETON TO
047700                  FILE-RECORD-INFO (REC-SKL-SUB).
047800*
047900 CLOSE-FILES.
048000     PERFORM END-ROUTINE THRU END-ROUTINE-13.
048100     CLOSE   PRINT-FILE.
048200P    OPEN    I-O RAW-DATA.
048300P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
048400P    READ    RAW-DATA INVALID KEY GO TO END-E-2.
048500P    MOVE   "OK.     " TO C-ABORT.
048600P    MOVE    PASS-COUNTER  TO C-OK.
048700P    MOVE    ERROR-HOLD    TO C-ALL.
048800P    MOVE    ERROR-COUNTER TO C-FAIL.
048900P    MOVE    DELETE-CNT    TO C-DELETED.
049000P    MOVE    INSPECT-COUNTER TO C-INSPECT.
049100P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
049200PEND-E-2.
049300P    CLOSE   RAW-DATA.
049400 TERMINATE-CCVS.
049500S    EXIT    PROGRAM.
049600     STOP    RUN.
049700*
049800 INSPT.
049900     MOVE   "INSPT" TO P-OR-F.
050000     ADD     1 TO INSPECT-COUNTER.
050100     PERFORM PRINT-DETAIL.
050200*
050300 PASS.
050400     MOVE   "PASS " TO P-OR-F.
050500     ADD     1 TO PASS-COUNTER.
050600     PERFORM PRINT-DETAIL.
050700*
050800 FAIL.
050900     MOVE   "FAIL*" TO P-OR-F.
051000     ADD     1 TO ERROR-COUNTER.
051100     PERFORM PRINT-DETAIL.
051200*
051300 DE-LETE.
051400     MOVE   "****TEST DELETED****" TO RE-MARK.
051500     MOVE   "*****" TO P-OR-F.
051600     ADD     1 TO DELETE-COUNTER.
051700     PERFORM PRINT-DETAIL.
051800*
051900 PRINT-DETAIL.
052000     IF REC-CT NOT EQUAL TO ZERO
052100         MOVE   "." TO PARDOT-X
052200         MOVE    REC-CT TO DOTVALUE.
052300     MOVE    TEST-RESULTS TO PRINT-REC.
052400     PERFORM WRITE-LINE.
052500     IF P-OR-F EQUAL TO "FAIL*"
052600         PERFORM WRITE-LINE
052700         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
052800     ELSE
052900         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
053000     MOVE    SPACE TO P-OR-F.
053100     MOVE    SPACE TO COMPUTED-X.
053200     MOVE    SPACE TO CORRECT-X.
053300     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
053400     MOVE    SPACE TO RE-MARK.
053500*
053600 HEAD-ROUTINE.
053700     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
053800     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
053900     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
054000     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
054100 COLUMN-NAMES-ROUTINE.
054200     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
054300     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
054400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
054500 END-ROUTINE.
054600     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
054700     PERFORM WRITE-LINE 5 TIMES.
054800 END-RTN-EXIT.
054900     MOVE    CCVS-E-1 TO DUMMY-RECORD.
055000     PERFORM WRITE-LINE 2 TIMES.
055100*
055200 END-ROUTINE-1.
055300     ADD     ERROR-COUNTER   TO ERROR-HOLD
055400     ADD     INSPECT-COUNTER TO ERROR-HOLD.
055500     ADD     DELETE-COUNTER  TO ERROR-HOLD.
055600     ADD     PASS-COUNTER    TO ERROR-HOLD.
055700     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
055800     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
055900     MOVE    CCVS-E-4        TO CCVS-E-2-2.
056000     MOVE    CCVS-E-2        TO DUMMY-RECORD
056100     PERFORM WRITE-LINE.
056200     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
056300     IF ERROR-COUNTER IS EQUAL TO ZERO
056400         MOVE   "NO " TO ERROR-TOTAL
056500     ELSE
056600         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
056700     MOVE    CCVS-E-2 TO DUMMY-RECORD.
056800     PERFORM WRITE-LINE.
056900 END-ROUTINE-13.
057000     IF DELETE-COUNTER IS EQUAL TO ZERO
057100         MOVE   "NO " TO ERROR-TOTAL
057200     ELSE
057300         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
057400     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
057500     MOVE    CCVS-E-2 TO DUMMY-RECORD.
057600     PERFORM WRITE-LINE.
057700     IF INSPECT-COUNTER EQUAL TO ZERO
057800         MOVE   "NO " TO ERROR-TOTAL
057900     ELSE
058000         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
058100     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
058200     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
058300     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
058400*
058500 WRITE-LINE.
058600     ADD     1 TO RECORD-COUNT.
058700Y    IF RECORD-COUNT GREATER 50
058800Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
058900Y        MOVE  SPACE TO DUMMY-RECORD
059000Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
059100Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
059200Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
059300Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
059400Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
059500Y        MOVE  ZERO TO RECORD-COUNT.
059600     PERFORM WRT-LN.
059700*
059800 WRT-LN.
059900     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
060000     MOVE    SPACE TO DUMMY-RECORD.
060100 BLANK-LINE-PRINT.
060200     PERFORM WRT-LN.
060300 FAIL-ROUTINE.
060400     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
060500     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
060600     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
060700     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
060800     MOVE    XXINFO TO DUMMY-RECORD.
060900     PERFORM WRITE-LINE 2 TIMES.
061000     MOVE    SPACES TO INF-ANSI-REFERENCE.
061100     GO TO   FAIL-ROUTINE-EX.
061200 FAIL-ROUTINE-WRITE.
061300     MOVE    TEST-COMPUTED  TO PRINT-REC
061400     PERFORM WRITE-LINE
061500     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
061600     MOVE    TEST-CORRECT   TO PRINT-REC
061700     PERFORM WRITE-LINE 2 TIMES.
061800     MOVE    SPACES         TO COR-ANSI-REFERENCE.
061900 FAIL-ROUTINE-EX.
062000     EXIT.
062100 BAIL-OUT.
062200     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
062300     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
062400 BAIL-OUT-WRITE.
062500     MOVE    CORRECT-A      TO XXCORRECT.
062600     MOVE    COMPUTED-A     TO XXCOMPUTED.
062700     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
062800     MOVE    XXINFO TO DUMMY-RECORD.
062900     PERFORM WRITE-LINE 2 TIMES.
063000     MOVE    SPACES TO INF-ANSI-REFERENCE.
063100 BAIL-OUT-EX.
063200     EXIT.
063300 CCVS1-EXIT.
063400     EXIT.
063500*
063600****************************************************************
063700*                                                              *
063800*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
063900*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
064000*                                                              *
064100****************************************************************
064200*
064300 SECT-SQ136A-0004 SECTION.
064400 STA-INIT.
064500     MOVE    SPACE TO DELETE-SW.
064600*
064700     MOVE   "SQ-FS4" TO XFILE-NAME (1).
064800     MOVE   "R1-F-G" TO XRECORD-NAME (1).
064900     MOVE    CCVS-PGM-ID TO XPROGRAM-NAME (1).
065000     MOVE    125 TO XRECORD-LENGTH (1).
065100     MOVE   "RC" TO CHARS-OR-RECORDS (1).
065200     MOVE    2   TO XBLOCK-SIZE (1).
065300     MOVE    1   TO RECORDS-IN-FILE (1).
065400     MOVE   "SQ" TO XFILE-ORGANIZATION (1).
065500     MOVE   "S"  TO XLABEL-TYPE (1).
065600     MOVE    ZERO TO XRECORD-NUMBER (1).
065700*
065800*    OPEN THE FILE IN THE OUTPUT MODE
065900*
066000 SEQ-INIT-01.
066100     MOVE    0 TO REC-CT.
066200     MOVE   "*"  TO DECL-EXEC-SW.
066300     MOVE   "**" TO SQ-FS4-STATUS.
066400     MOVE   "NOT EXECUTED" TO DECL-EXEC-I.
066500     MOVE   "NOT EXECUTED" TO DECL-EXEC-O.
066600     MOVE   "OPEN, CREATE FILE"  TO FEATURE.
066700     MOVE   "SEQ-TEST-OP-01" TO PAR-NAME.
066800     GO TO   SEQ-TEST-OP-01.
066900 SEQ-DELETE-01.
067000     MOVE   "*" TO DELETE-SW-1.
067100 SEQ-TEST-OP-01.
067200     OPEN    OUTPUT SQ-FS4.
067300 SEQ-INIT-02.
067400     MOVE    0 TO REC-CT.
067500     MOVE   "*"  TO DECL-EXEC-SW.
067600     MOVE   "**" TO SQ-FS4-STATUS.
067700     MOVE   "NOT EXECUTED" TO DECL-EXEC-I.
067800     MOVE   "NOT EXECUTED" TO DECL-EXEC-O.
067900     ADD     1 TO XRECORD-NUMBER (1).
068000     MOVE   "WRITE ONE RECORD"  TO FEATURE.
068100     MOVE   "SEQ-TEST-WR-02" TO PAR-NAME.
068200     IF DELETE-SW NOT EQUAL TO SPACE
068300         GO TO SEQ-DELETE-02.
068400     GO TO   SEQ-TEST-WR-02.
068500 SEQ-DELETE-02.
068600     MOVE   "*" TO DELETE-SW-2.
068700 SEQ-TEST-WR-02.
068800     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-FS4-FIRST.
068900     MOVE    XRECORD-NUMBER (1) TO SQ-FS4-REC-NO.
069000     WRITE   SQ-FS4R1-F-G-125.
069100 SEQ-INIT-03.
069200     MOVE    0 TO REC-CT.
069300     MOVE   "*"  TO DECL-EXEC-SW.
069400     MOVE   "**" TO SQ-FS4-STATUS.
069500     MOVE   "NOT EXECUTED" TO DECL-EXEC-I.
069600     MOVE   "NOT EXECUTED" TO DECL-EXEC-O.
069700     MOVE   "CLOSE AFTER CREATE"  TO FEATURE.
069800     MOVE   "SEQ-TEST-CL-03" TO PAR-NAME.
069900     IF DELETE-SW NOT EQUAL TO SPACE
070000         GO TO SEQ-DELETE-03.
070100     GO TO   SEQ-TEST-CL-03.
070200 SEQ-DELETE-03.
070300     MOVE   "*" TO DELETE-SW-2.
070400 SEQ-TEST-CL-03.
070500     CLOSE   SQ-FS4.
070600 SEQ-INIT-04.
070700     MOVE    0 TO REC-CT.
070800     MOVE    ZERO TO XRECORD-NUMBER (1).
070900     MOVE   "*"  TO DECL-EXEC-SW.
071000     MOVE   "**" TO SQ-FS4-STATUS.
071100     MOVE   "NOT EXECUTED" TO DECL-EXEC-I.
071200     MOVE   "NOT EXECUTED" TO DECL-EXEC-O.
071300     MOVE   "OPEN, TO READ FILE"  TO FEATURE.
071400     MOVE   "SEQ-TEST-OP-04" TO PAR-NAME.
071500     IF DELETE-SW NOT = SPACE
071600         GO TO SEQ-DELETE-04.
071700     GO TO   SEQ-TEST-OP-04.
071800 SEQ-DELETE-04.
071900     MOVE   "*" TO DELETE-SW-2.
072000 SEQ-TEST-OP-04.
072100     OPEN    INPUT SQ-FS4.
072200     MOVE    SPACE TO SQ-FS4R1-F-G-125.
072300*
072400*
072500*    READ THE FIRST (AND ONLY) RECORD FROM THE FILE
072600*
072700 SEQ-INIT-05.
072800     MOVE    0 TO REC-CT.
072900     MOVE   "*"  TO DECL-EXEC-SW.
073000     MOVE   "**" TO SQ-FS4-STATUS.
073100     MOVE   "NOT EXECUTED" TO DECL-EXEC-I.
073200     MOVE   "NOT EXECUTED" TO DECL-EXEC-O.
073300     MOVE   "READ FIRST RECORD"  TO FEATURE.
073400     MOVE   "SEQ-TEST-RD-05" TO PAR-NAME.
073500     IF DELETE-SW NOT = SPACE
073600         GO TO SEQ-DELETE-05.
073700     GO TO   SEQ-TEST-RD-05.
073800 SEQ-DELETE-05.
073900     MOVE   "*" TO DELETE-SW-2.
074000 SEQ-TEST-RD-05.
074100     READ    SQ-FS4.
074200     MOVE    SQ-FS4R1-F-G-125 TO FILE-RECORD-INFO (2).
074300*
074400*
074500*    READ AGAIN, TO RAISE THE AT END CONDITION
074600*
074700 SEQ-INIT-06.
074800     MOVE    0 TO REC-CT.
074900     MOVE   "*" TO DECL-EXEC-SW.
075000     MOVE   "**" TO SQ-FS4-STATUS.
075100     MOVE   "NOT EXECUTED" TO DECL-EXEC-I.
075200     MOVE   "NOT EXECUTED" TO DECL-EXEC-O.
075300     MOVE   "READ, GIVING AT END"  TO FEATURE.
075400     MOVE   "SEQ-TEST-RD-06" TO PAR-NAME.
075500     IF DELETE-SW NOT = SPACE
075600         GO TO SEQ-DELETE-06.
075700     GO TO   SEQ-TEST-RD-06.
075800 SEQ-DELETE-06.
075900     MOVE   "*" TO DELETE-SW-2.
076000 SEQ-TEST-RD-06.
076100     READ    SQ-FS4.
076200*
076300*
076400*    READ AGAIN, AFTER AT END, TO RAISE I-O STATUS 46
076500*
076600 SEQ-INIT-07.
076700     MOVE    0 TO REC-CT.
076800     MOVE    SPACE TO DECL-EXEC-SW.
076900     MOVE   "**" TO SQ-FS4-STATUS.
077000     MOVE   "NOT EXECUTED" TO DECL-EXEC-I.
077100     MOVE   "NOT EXECUTED" TO DECL-EXEC-O.
077200     MOVE   "READ AFTER AT END"  TO FEATURE.
077300     MOVE   "SEQ-TEST-RD-07" TO PAR-NAME.
077400     IF DELETE-SW NOT = SPACE
077500         GO TO SEQ-DELETE-07.
077600     GO TO   SEQ-TEST-RD-07.
077700 SEQ-DELETE-07.
077800     MOVE   "*" TO DELETE-SW-2.
077900     GO TO   SEQ-DELETE-07-01.
078000 SEQ-TEST-RD-07.
078100     READ    SQ-FS4.
078200*
078300*    THE TESTS FOLLOWING THIS READ STATEMENT MAY NOT BE
078400*    EXECUTED.  THE IMPLEMENTOR MAY LEGITIMATELY TERMINATE
078500*    EXECUTION ON EXIT FROM THE DECLARATIVE.
078600*
078700     MOVE    ZERO TO REC-CT.
078800     MOVE   "READ AFTER AT END"  TO FEATURE.
078900     MOVE   "SEQ-TEST-RD-07" TO PAR-NAME.
079000*
079100*    CHECK I-O STATUS RETURNED FROM READ AFTER AT END
079200*
079300     ADD    1 TO REC-CT.
079400     IF DELETE-SW NOT = SPACE
079500         GO TO   SEQ-DELETE-07-01.
079600     GO TO   SEQ-TEST-RD-07-01.
079700 SEQ-DELETE-07-01.
079800     PERFORM DE-LETE.
079900     GO TO   SEQ-TEST-07-01-END.
080000 SEQ-TEST-RD-07-01.
080100     IF SQ-FS4-STATUS = "46"
080200         PERFORM PASS
080300     ELSE
080400         MOVE    SQ-FS4-STATUS TO COMPUTED-A
080500         MOVE   "46" TO CORRECT-A
080600         MOVE   "UNEXPECTED I-O STATUS BEYOND END OF FILE"
080700                   TO RE-MARK
080800         MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
080900         PERFORM FAIL.
081000 SEQ-TEST-07-01-END.
081100 CCVS-EXIT SECTION.
081200 CCVS-999999.
081300     GO TO   CLOSE-FILES.
