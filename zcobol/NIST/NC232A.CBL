000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     NC232A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100
002200*
002300*    PROGRAM NC232A USES FORMAT 1 OF THE "SEARCH" STATEMENT TO *
002400*    ACCESS A THREE DIMENSIONAL TABLE.  THE OPTIONAL "VARYING" *
002500*    PHRASE IS USED WITH AN INDEX-NAME.                        *
002600*                                                              *
002700****************************************************************
002800 ENVIRONMENT DIVISION.
002900 CONFIGURATION SECTION.
003000 SOURCE-COMPUTER.
003100     XXXXX082.
003200 OBJECT-COMPUTER.
003300     XXXXX083.
003400 INPUT-OUTPUT SECTION.
003500 FILE-CONTROL.
003600     SELECT PRINT-FILE ASSIGN TO
003700     XXXXX055.
003800 DATA DIVISION.
003900 FILE SECTION.
004000 FD  PRINT-FILE.
004100 01  PRINT-REC PICTURE X(120).
004200 01  DUMMY-RECORD PICTURE X(120).
004300 WORKING-STORAGE SECTION.
004400 77  SUB-1              PICTURE S99  VALUE ZERO.
004500 77  SUB-2              PICTURE 99   VALUE ZERO.
004600 77  SUB-3              PICTURE 99   VALUE ZERO.
004700 77  CON-7              PICTURE 99  VALUE 07.
004800 77  CON-10             PICTURE 99  VALUE 10.
004900 77  ELEM-HOLD-AREA               PICTURE X(15)  VALUE SPACES.
005000 77  CON-5              PICTURE 99  VALUE 05.
005100 77  SEC-HOLD-AREA                PICTURE X(11)  VALUE SPACES.
005200 77  CON-6              PICTURE 99  VALUE 06.
005300 77  GRP-HOLD-AREA                PICTURE X(5)  VALUE SPACES.
005400 01  GRP-NAME.
005500     02  FILLER              PICTURE XXX    VALUE "GRP".
005600     02  ADD-GRP             PICTURE 99     VALUE 01.
005700
005800 01  SEC-NAME.
005900     02  FILLER              PICTURE X(5)   VALUE "SEC (".
006000     02  SEC-GRP             PICTURE 99     VALUE 00.
006100     02  FILLER              PICTURE X      VALUE ",".
006200     02  ADD-SEC             PICTURE 99     VALUE 01.
006300     02  FILLER              PICTURE X      VALUE ")".
006400
006500 01  ELEM-NAME.
006600     02  FILLER              PICTURE X(6)   VALUE "ELEM (".
006700     02  ELEM-GRP            PICTURE 99     VALUE 00.
006800     02  FILLER              PICTURE X      VALUE ",".
006900     02  ELEM-SEC            PICTURE 99     VALUE 00.
007000     02  FILLER              PICTURE X      VALUE ",".
007100     02  ADD-ELEM            PICTURE 99     VALUE 01.
007200     02  FILLER              PICTURE X      VALUE ")".
007300
007400 01  3-DIMENSION-TBL.
007500     02  GRP-ENTRY OCCURS 10 TIMES INDEXED BY IDX-1.
007600         03  ENTRY-1         PICTURE X(5).
007700         03  GRP2-ENTRY OCCURS 10 TIMES INDEXED BY IDX-2.
007800             04  ENTRY-2     PICTURE X(11).
007900             04  GRP3-ENTRY OCCURS 10 TIMES INDEXED BY IDX-3.
008000                 05  ENTRY-3 PICTURE X(15).
008100
008200 01  END-STMT.
008300     02  FILLER              PICTURE X(7)  VALUE "AT END ".
008400     02  END-IDX             PICTURE X(5)  VALUE SPACES.
008500     02  FILLER              PICTURE XXX   VALUE " = ".
008600     02  IDX-VALU            PICTURE 99    VALUE 00.
008700     02  FILLER              PICTURE XXX   VALUE SPACES.
008800 01  NOTE-1.
008900     02  FILLER                   PICTURE X(74)  VALUE
009000     "NOTE 1 - CORRECT AND COMPUTED DATA ARE EQUAL BUT THE AT END
009100-    "PATH WAS TAKEN".
009200     02  FILLER                   PICTURE X(46)  VALUE SPACES.
009300 01  NOTE-2.
009400     02  FILLER                   PICTURE X(112)  VALUE
009500     "NOTE 2 - CORRECT AND COMPUTED DATA ARE NOT EQUAL. THE COMPUT
009600-    "ED ENTRY WAS EXTRACTED FROM THE TABLE BY SUBSCRIPTS.".
009700     02  FILLER                   PICTURE X(8)  VALUE SPACES.
009800 01  TEST-RESULTS.
009900     02 FILLER                   PIC X      VALUE SPACE.
010000     02 FEATURE                  PIC X(20)  VALUE SPACE.
010100     02 FILLER                   PIC X      VALUE SPACE.
010200     02 P-OR-F                   PIC X(5)   VALUE SPACE.
010300     02 FILLER                   PIC X      VALUE SPACE.
010400     02  PAR-NAME.
010500       03 FILLER                 PIC X(19)  VALUE SPACE.
010600       03  PARDOT-X              PIC X      VALUE SPACE.
010700       03 DOTVALUE               PIC 99     VALUE ZERO.
010800     02 FILLER                   PIC X(8)   VALUE SPACE.
010900     02 RE-MARK                  PIC X(61).
011000 01  TEST-COMPUTED.
011100     02 FILLER                   PIC X(30)  VALUE SPACE.
011200     02 FILLER                   PIC X(17)  VALUE
011300            "       COMPUTED=".
011400     02 COMPUTED-X.
011500     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
011600     03 COMPUTED-N               REDEFINES COMPUTED-A
011700                                 PIC -9(9).9(9).
011800     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
011900     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
012000     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
012100     03       CM-18V0 REDEFINES COMPUTED-A.
012200         04 COMPUTED-18V0                    PIC -9(18).
012300         04 FILLER                           PIC X.
012400     03 FILLER PIC X(50) VALUE SPACE.
012500 01  TEST-CORRECT.
012600     02 FILLER PIC X(30) VALUE SPACE.
012700     02 FILLER PIC X(17) VALUE "       CORRECT =".
012800     02 CORRECT-X.
012900     03 CORRECT-A                  PIC X(20) VALUE SPACE.
013000     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
013100     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
013200     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
013300     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
013400     03      CR-18V0 REDEFINES CORRECT-A.
013500         04 CORRECT-18V0                     PIC -9(18).
013600         04 FILLER                           PIC X.
013700     03 FILLER PIC X(2) VALUE SPACE.
013800     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
013900 01  CCVS-C-1.
014000     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
014100-    "SS  PARAGRAPH-NAME
014200-    "       REMARKS".
014300     02 FILLER                     PIC X(20)    VALUE SPACE.
014400 01  CCVS-C-2.
014500     02 FILLER                     PIC X        VALUE SPACE.
014600     02 FILLER                     PIC X(6)     VALUE "TESTED".
014700     02 FILLER                     PIC X(15)    VALUE SPACE.
014800     02 FILLER                     PIC X(4)     VALUE "FAIL".
014900     02 FILLER                     PIC X(94)    VALUE SPACE.
015000 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
015100 01  REC-CT                        PIC 99       VALUE ZERO.
015200 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
015300 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
015400 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
015500 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
015600 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
015700 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
015800 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
015900 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
016000 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
016100 01  CCVS-H-1.
016200     02  FILLER                    PIC X(39)    VALUE SPACES.
016300     02  FILLER                    PIC X(42)    VALUE
016400     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
016500     02  FILLER                    PIC X(39)    VALUE SPACES.
016600 01  CCVS-H-2A.
016700   02  FILLER                        PIC X(40)  VALUE SPACE.
016800   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
016900   02  FILLER                        PIC XXXX   VALUE
017000     "4.2 ".
017100   02  FILLER                        PIC X(28)  VALUE
017200            " COPY - NOT FOR DISTRIBUTION".
017300   02  FILLER                        PIC X(41)  VALUE SPACE.
017400
017500 01  CCVS-H-2B.
017600   02  FILLER                        PIC X(15)  VALUE
017700            "TEST RESULT OF ".
017800   02  TEST-ID                       PIC X(9).
017900   02  FILLER                        PIC X(4)   VALUE
018000            " IN ".
018100   02  FILLER                        PIC X(12)  VALUE
018200     " HIGH       ".
018300   02  FILLER                        PIC X(22)  VALUE
018400            " LEVEL VALIDATION FOR ".
018500   02  FILLER                        PIC X(58)  VALUE
018600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
018700 01  CCVS-H-3.
018800     02  FILLER                      PIC X(34)  VALUE
018900            " FOR OFFICIAL USE ONLY    ".
019000     02  FILLER                      PIC X(58)  VALUE
019100     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
019200     02  FILLER                      PIC X(28)  VALUE
019300            "  COPYRIGHT   1985 ".
019400 01  CCVS-E-1.
019500     02 FILLER                       PIC X(52)  VALUE SPACE.
019600     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
019700     02 ID-AGAIN                     PIC X(9).
019800     02 FILLER                       PIC X(45)  VALUE SPACES.
019900 01  CCVS-E-2.
020000     02  FILLER                      PIC X(31)  VALUE SPACE.
020100     02  FILLER                      PIC X(21)  VALUE SPACE.
020200     02 CCVS-E-2-2.
020300         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
020400         03 FILLER                   PIC X      VALUE SPACE.
020500         03 ENDER-DESC               PIC X(44)  VALUE
020600            "ERRORS ENCOUNTERED".
020700 01  CCVS-E-3.
020800     02  FILLER                      PIC X(22)  VALUE
020900            " FOR OFFICIAL USE ONLY".
021000     02  FILLER                      PIC X(12)  VALUE SPACE.
021100     02  FILLER                      PIC X(58)  VALUE
021200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
021300     02  FILLER                      PIC X(13)  VALUE SPACE.
021400     02 FILLER                       PIC X(15)  VALUE
021500             " COPYRIGHT 1985".
021600 01  CCVS-E-4.
021700     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
021800     02 FILLER                       PIC X(4)   VALUE " OF ".
021900     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
022000     02 FILLER                       PIC X(40)  VALUE
022100      "  TESTS WERE EXECUTED SUCCESSFULLY".
022200 01  XXINFO.
022300     02 FILLER                       PIC X(19)  VALUE
022400            "*** INFORMATION ***".
022500     02 INFO-TEXT.
022600       04 FILLER                     PIC X(8)   VALUE SPACE.
022700       04 XXCOMPUTED                 PIC X(20).
022800       04 FILLER                     PIC X(5)   VALUE SPACE.
022900       04 XXCORRECT                  PIC X(20).
023000     02 INF-ANSI-REFERENCE           PIC X(48).
023100 01  HYPHEN-LINE.
023200     02 FILLER  PIC IS X VALUE IS SPACE.
023300     02 FILLER  PIC IS X(65)    VALUE IS "************************
023400-    "*****************************************".
023500     02 FILLER  PIC IS X(54)    VALUE IS "************************
023600-    "******************************".
023700 01  CCVS-PGM-ID                     PIC X(9)   VALUE
023800     "NC232A".
023900 PROCEDURE DIVISION.
024000 CCVS1 SECTION.
024100 OPEN-FILES.
024200     OPEN     OUTPUT PRINT-FILE.
024300     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
024400     MOVE    SPACE TO TEST-RESULTS.
024500     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
024600     GO TO CCVS1-EXIT.
024700 CLOSE-FILES.
024800     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
024900 TERMINATE-CCVS.
025000S    EXIT PROGRAM.
025100STERMINATE-CALL.
025200     STOP     RUN.
025300 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
025400 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
025500 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
025600 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
025700     MOVE "****TEST DELETED****" TO RE-MARK.
025800 PRINT-DETAIL.
025900     IF REC-CT NOT EQUAL TO ZERO
026000             MOVE "." TO PARDOT-X
026100             MOVE REC-CT TO DOTVALUE.
026200     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
026300     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
026400        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
026500          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
026600     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
026700     MOVE SPACE TO CORRECT-X.
026800     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
026900     MOVE     SPACE TO RE-MARK.
027000 HEAD-ROUTINE.
027100     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027200     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027300     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
027400     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
027500 COLUMN-NAMES-ROUTINE.
027600     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027700     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
027900 END-ROUTINE.
028000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
028100 END-RTN-EXIT.
028200     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028300 END-ROUTINE-1.
028400      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
028500      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
028600      ADD PASS-COUNTER TO ERROR-HOLD.
028700*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
028800      MOVE PASS-COUNTER TO CCVS-E-4-1.
028900      MOVE ERROR-HOLD TO CCVS-E-4-2.
029000      MOVE CCVS-E-4 TO CCVS-E-2-2.
029100      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
029200  END-ROUTINE-12.
029300      MOVE "TEST(S) FAILED" TO ENDER-DESC.
029400     IF       ERROR-COUNTER IS EQUAL TO ZERO
029500         MOVE "NO " TO ERROR-TOTAL
029600         ELSE
029700         MOVE ERROR-COUNTER TO ERROR-TOTAL.
029800     MOVE     CCVS-E-2 TO DUMMY-RECORD.
029900     PERFORM WRITE-LINE.
030000 END-ROUTINE-13.
030100     IF DELETE-COUNTER IS EQUAL TO ZERO
030200         MOVE "NO " TO ERROR-TOTAL  ELSE
030300         MOVE DELETE-COUNTER TO ERROR-TOTAL.
030400     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
030500     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030600      IF   INSPECT-COUNTER EQUAL TO ZERO
030700          MOVE "NO " TO ERROR-TOTAL
030800      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
030900      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
031000      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031100     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031200 WRITE-LINE.
031300     ADD 1 TO RECORD-COUNT.
031400Y    IF RECORD-COUNT GREATER 50
031500Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
031600Y        MOVE SPACE TO DUMMY-RECORD
031700Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
031800Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
031900Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
032000Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
032100Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
032200Y        MOVE ZERO TO RECORD-COUNT.
032300     PERFORM WRT-LN.
032400 WRT-LN.
032500     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
032600     MOVE SPACE TO DUMMY-RECORD.
032700 BLANK-LINE-PRINT.
032800     PERFORM WRT-LN.
032900 FAIL-ROUTINE.
033000     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
033100     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
033200     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
033300     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
033400     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033500     MOVE   SPACES TO INF-ANSI-REFERENCE.
033600     GO TO  FAIL-ROUTINE-EX.
033700 FAIL-ROUTINE-WRITE.
033800     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
033900     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
034000     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
034100     MOVE   SPACES TO COR-ANSI-REFERENCE.
034200 FAIL-ROUTINE-EX. EXIT.
034300 BAIL-OUT.
034400     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
034500     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
034600 BAIL-OUT-WRITE.
034700     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
034800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
034900     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035000     MOVE   SPACES TO INF-ANSI-REFERENCE.
035100 BAIL-OUT-EX. EXIT.
035200 CCVS1-EXIT.
035300     EXIT.
035400 SECT-NC232A-001 SECTION.
035500 TH-03-001.
035600*
035700 BUILD-LEVEL-1.
035800     ADD 1 TO SUB-1.
035900     IF SUB-1 = 11 GO TO CHECK-ENTRIES.
036000     MOVE GRP-NAME TO ENTRY-1 (SUB-1).
036100     ADD 1 TO ADD-GRP.
036200
036300 BUILD-LEVEL-2.
036400     ADD 1 TO SUB-2.
036500     IF SUB-2 = 11
036600         MOVE ZERO TO SUB-2
036700         MOVE 01 TO ADD-SEC
036800         GO TO BUILD-LEVEL-1.
036900     MOVE SUB-1 TO SEC-GRP.
037000     MOVE SEC-NAME TO ENTRY-2 (SUB-1, SUB-2).
037100     ADD 1 TO ADD-SEC.
037200
037300 BUILD-LEVEL-3.
037400     ADD 1 TO SUB-3.
037500     IF SUB-3 = 11
037600         MOVE ZERO TO SUB-3
037700              MOVE 01 TO ADD-ELEM
037800              GO TO BUILD-LEVEL-2.
037900     MOVE SUB-1 TO ELEM-GRP.
038000     MOVE SUB-2 TO ELEM-SEC.
038100     MOVE ELEM-NAME TO ENTRY-3 (SUB-1, SUB-2, SUB-3).
038200     ADD 1 TO ADD-ELEM.
038300     GO TO BUILD-LEVEL-3.
038400
038500 CHECK-ENTRIES.
038600     MOVE "SEARCH VARYING LEV 1" TO FEATURE.
038700     MOVE "CHECK-ENTRIES       " TO PAR-NAME.
038800     MOVE "GRP02" TO GRP-HOLD-AREA.
038900     MOVE 02 TO SUB-2.
039000     SET IDX-1 TO 1.
039100     SEARCH GRP-ENTRY VARYING IDX-1 AT END
039200         PERFORM GRP-FAIL-PARGRAPH
039300         GO TO TH1-TEST-F1-2
039400         WHEN ENTRY-1 (IDX-1) = GRP-HOLD-AREA NEXT SENTENCE.
039500     PERFORM PASS
039600     PERFORM PRINT-DETAIL.
039700     GO TO TH1-TEST-F1-2.
039800
039900 GRP-FAIL-PARGRAPH.
040000     MOVE GRP-HOLD-AREA TO CORRECT-A.
040100     IF ENTRY-1 (SUB-2) EQUAL TO GRP-HOLD-AREA
040200         MOVE "IDX-1" TO END-IDX
040300         SET IDX-VALU TO IDX-1
040400         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
040500         MOVE END-STMT TO COMPUTED-A  ELSE
040600     MOVE ENTRY-1 (SUB-2) TO COMPUTED-A
040700     MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
040800
040900     PERFORM FAIL
041000     PERFORM PRINT-DETAIL.
041100*
041200 TH1-INIT-F1-2.
041300     MOVE "TH1-TEST-F1-2      " TO PAR-NAME.
041400     MOVE "VI-122 6.21"   TO ANSI-REFERENCE.
041500     MOVE "GRP01" TO GRP-HOLD-AREA.
041600     MOVE 01 TO SUB-2.
041700     SET IDX-1 TO 1.
041800 TH1-TEST-F1-2.
041900     SEARCH GRP-ENTRY VARYING IDX-1 AT END
042000         GO TO TH1-FAIL-F1-2
042100         WHEN ENTRY-1 (IDX-1) = GRP-HOLD-AREA NEXT SENTENCE.
042200
042300     PERFORM PASS
042400     GO TO TH1-WRITE-F1-2.
042500 TH1-DELETE-F1-2.
042600     PERFORM DE-LETE.
042700     GO TO TH1-WRITE-F1-2.
042800 TH1-FAIL-F1-2.
042900     PERFORM FAIL.
043000 TH1-WRITE-F1-2.
043100     PERFORM PRINT-DETAIL.
043200*
043300 TH1-INIT-F1-3.
043400     MOVE "TH1-TEST-F1-3      " TO PAR-NAME.
043500     MOVE "VI-122 6.21"   TO ANSI-REFERENCE.
043600     MOVE "GRP10" TO GRP-HOLD-AREA.
043700     MOVE 10 TO SUB-2.
043800     SET IDX-1 TO 1.
043900 TH1-TEST-F1-3.
044000     SEARCH GRP-ENTRY VARYING IDX-1 AT END
044100         GO TO TH1-FAIL-F1-3
044200         WHEN ENTRY-1 (IDX-1) = GRP-HOLD-AREA NEXT SENTENCE.
044300
044400     PERFORM PASS
044500     GO TO TH1-WRITE-F1-3.
044600 TH1-DELETE-F1-3.
044700     PERFORM DE-LETE.
044800     GO TO TH1-WRITE-F1-3.
044900 TH1-FAIL-F1-3.
045000     PERFORM FAIL.
045100 TH1-WRITE-F1-3.
045200     PERFORM PRINT-DETAIL.
045300*
045400 TH1-INIT-F1-4.
045500     MOVE "TH1-TEST-F1-4      " TO PAR-NAME.
045600     MOVE "VI-122 6.21"   TO ANSI-REFERENCE.
045700     MOVE "GRP05" TO GRP-HOLD-AREA.
045800     MOVE 05 TO SUB-2.
045900     SET IDX-1 TO 05.
046000 TH1-TEST-F1-4.
046100     SEARCH GRP-ENTRY VARYING IDX-1
046200         WHEN ENTRY-1 (IDX-1) = GRP-HOLD-AREA
046300             GO TO PASS-TH1-F1-4.
046400     GO TO TH1-FAIL-F1-4.
046500 PASS-TH1-F1-4.
046600
046700     PERFORM PASS
046800     GO TO TH1-WRITE-F1-4.
046900 TH1-DELETE-F1-4.
047000     PERFORM DE-LETE.
047100     GO TO TH1-WRITE-F1-4.
047200 TH1-FAIL-F1-4.
047300     PERFORM GRP-FAIL-PARGRAPH.
047400 TH1-WRITE-F1-4.
047500     PERFORM PRINT-DETAIL.
047600*
047700 TH2-INIT-F1-1.
047800     MOVE "TH2-TEST-F1-1      " TO PAR-NAME.
047900     MOVE "VI-122 6.21"   TO ANSI-REFERENCE.
048000     MOVE "SEARCH VARYING LEV 2" TO FEATURE.
048100     MOVE "SEC (01,01)" TO SEC-HOLD-AREA.
048200     MOVE 1 TO SUB-1 SUB-2.
048300     SET IDX-1 IDX-2 TO 1.
048400 TH2-TEST-F1-1.
048500     SEARCH GRP2-ENTRY VARYING IDX-2 AT END
048600         GO TO TH2-FAIL-F1-1
048700         WHEN ENTRY-2 (IDX-1, IDX-2) = SEC-HOLD-AREA
048800             NEXT SENTENCE.
048900
049000     PERFORM PASS.
049100     GO TO TH2-WRITE-F1-1.
049200 TH2-DELETE-F1-1.
049300     PERFORM DE-LETE.
049400     GO TO TH2-WRITE-F1-1.
049500 TH2-FAIL-F1-1.
049600     PERFORM SEC-FAIL-PARGRAF.
049700 TH2-WRITE-F1-1.
049800     PERFORM PRINT-DETAIL.
049900
050000 TH2-INIT-F1-2.
050100     MOVE "TH2-TEST-F1-2      " TO PAR-NAME.
050200     MOVE "VI-122 6.21"   TO ANSI-REFERENCE.
050300     MOVE "SEARCH VARYING LEV 2" TO FEATURE.
050400     MOVE "SEC (05,10)" TO SEC-HOLD-AREA.
050500     MOVE 05 TO SUB-1.
050600     MOVE 10 TO SUB-2.
050700     SET IDX-1 TO 5.
050800     SET IDX-2 TO 1.
050900 TH2-TEST-F1-2.
051000     SEARCH GRP2-ENTRY VARYING IDX-2 AT END
051100         GO TO TH2-FAIL-F1-2
051200         WHEN ENTRY-2 (IDX-1, IDX-2) = SEC-HOLD-AREA
051300             NEXT SENTENCE.
051400
051500     PERFORM PASS
051600     GO TO TH2-WRITE-F1-2.
051700 TH2-DELETE-F1-2.
051800     PERFORM DE-LETE.
051900     GO TO TH2-WRITE-F1-2.
052000 TH2-FAIL-F1-2.
052100     PERFORM SEC-FAIL-PARGRAF.
052200 TH2-WRITE-F1-2.
052300     PERFORM PRINT-DETAIL.
052400*
052500 TH2-INIT-F1-3.
052600     MOVE "TH2-TEST-F1-3      " TO PAR-NAME.
052700     MOVE "VI-122 6.21"   TO ANSI-REFERENCE.
052800     MOVE "SEARCH VARYING LEV 2" TO FEATURE.
052900     MOVE "SEC (10,10)" TO SEC-HOLD-AREA.
053000     SET IDX-1 TO 10.
053100     SET IDX-2 TO 1.
053200     MOVE 10 TO SUB-1  SUB-2.
053300 TH2-TEST-F1-3.
053400     SEARCH GRP2-ENTRY VARYING IDX-2 AT END
053500         GO TO TH2-FAIL-F1-3
053600         WHEN ENTRY-2 (IDX-1, IDX-2) = SEC-HOLD-AREA
053700             NEXT SENTENCE.
053800
053900     PERFORM PASS
054000     GO TO TH2-WRITE-F1-3.
054100 TH2-DELETE-F1-3.
054200     PERFORM DE-LETE.
054300     GO TO TH2-WRITE-F1-3.
054400 TH2-FAIL-F1-3.
054500     PERFORM SEC-FAIL-PARGRAF.
054600 TH2-WRITE-F1-3.
054700     PERFORM PRINT-DETAIL.
054800*
054900 TH2-INIT-F1-4.
055000     MOVE "TH2-TEST-F1-4      " TO PAR-NAME.
055100     MOVE "VI-122 6.21"   TO ANSI-REFERENCE.
055200     MOVE "SEARCH VARYING LEV 2" TO FEATURE.
055300     MOVE "SEC (08,02)" TO SEC-HOLD-AREA.
055400     MOVE 08 TO SUB-1.
055500     MOVE 02 TO SUB-2.
055600     SET IDX-1 TO 08.
055700     SET IDX-2 TO 01.
055800 TH2-TEST-F1-4.
055900     SEARCH GRP2-ENTRY VARYING IDX-2
056000         WHEN ENTRY-2 (IDX-1, IDX-2) = SEC-HOLD-AREA
056100             PERFORM PASS
056200             GO TO TH2-WRITE-F1-4.
056300     GO TO TH2-FAIL-F1-4.
056400 TH2-DELETE-F1-4.
056500     PERFORM DE-LETE.
056600     GO TO TH2-WRITE-F1-4.
056700 TH2-FAIL-F1-4.
056800     PERFORM SEC-FAIL-PARGRAF.
056900 TH2-WRITE-F1-4.
057000     PERFORM PRINT-DETAIL.
057100     GO TO TH3-INIT-F1-1.
057200*
057300 SEC-FAIL-PARGRAF.
057400     MOVE SEC-HOLD-AREA TO CORRECT-A.
057500     IF ENTRY-2 (SUB-1, SUB-2) EQUAL TO SEC-HOLD-AREA
057600         MOVE "IDX-2" TO END-IDX
057700         SET IDX-VALU TO IDX-2
057800         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
057900         MOVE END-STMT TO COMPUTED-A ELSE
058000     MOVE ENTRY-2 (SUB-1, SUB-2) TO COMPUTED-A
058100     MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
058200
058300     PERFORM FAIL.
058400
058500 TH3-INIT-F1-1.
058600     MOVE "TH3-TEST-F1-1      " TO PAR-NAME.
058700     MOVE "VI-122 6.21"   TO ANSI-REFERENCE.
058800     MOVE "SEARCH VARYING LEV 3" TO FEATURE.
058900     MOVE 1 TO SUB-1  SUB-2  SUB-3.
059000     MOVE "ELEM (01,01,01)" TO ELEM-HOLD-AREA.
059100     SET IDX-1 IDX-2 IDX-3 TO 1.
059200 TH3-TEST-F1-1.
059300     SEARCH GRP3-ENTRY VARYING IDX-3
059400         WHEN ENTRY-3 (IDX-1, IDX-2, IDX-3) = ELEM-HOLD-AREA
059500             GO TO PASS-TH3-1.
059600     GO TO TH3-FAIL-F1-1.
059700 PASS-TH3-1.
059800
059900     PERFORM PASS.
060000     GO TO TH3-WRITE-F1-1.
060100 TH3-DELETE-F1-1.
060200     PERFORM DE-LETE.
060300     GO TO TH3-WRITE-F1-1.
060400 TH3-FAIL-F1-1.
060500     PERFORM ELEM-FAIL-PARA.
060600 TH3-WRITE-F1-1.
060700     PERFORM PRINT-DETAIL.
060800*
060900 TH3-INIT-F1-2.
061000     MOVE "TH3-TEST-F1-2      " TO PAR-NAME.
061100     MOVE "VI-122 6.21"   TO ANSI-REFERENCE.
061200     MOVE "SEARCH VARYING LEV 3" TO FEATURE.
061300     MOVE 05 TO SUB-1.
061400     MOVE 06 TO SUB-2.
061500     MOVE 07 TO SUB-3.
061600     SET IDX-1 TO 05.
061700     SET IDX-2 TO 06.
061800     SET IDX-3 TO 1.
061900     MOVE "ELEM (05,06,07)" TO ELEM-HOLD-AREA.
062000 TH3-TEST-F1-2.
062100     SEARCH GRP3-ENTRY VARYING IDX-3 AT END
062200         GO TO TH3-FAIL-F1-2
062300         WHEN ENTRY-3 (IDX-1, IDX-2, IDX-3) = ELEM-HOLD-AREA
062400             NEXT SENTENCE.
062500
062600     PERFORM PASS
062700     GO TO TH3-WRITE-F1-2.
062800 TH3-DELETE-F1-2.
062900     PERFORM DE-LETE.
063000     GO TO TH3-WRITE-F1-2.
063100 TH3-FAIL-F1-2.
063200     PERFORM ELEM-FAIL-PARA.
063300 TH3-WRITE-F1-2.
063400     PERFORM PRINT-DETAIL.
063500*
063600 TH3-INIT-F1-3.
063700     MOVE "TH3-TEST-F1-3      " TO PAR-NAME.
063800     MOVE "VI-122 6.21"   TO ANSI-REFERENCE.
063900     MOVE "SEARCH VARYING LEV 3" TO FEATURE.
064000     MOVE 10 TO SUB-1 SUB-2 SUB-3.
064100     SET IDX-1 IDX-2 TO 10.
064200     SET IDX-3 TO 1.
064300 TH3-TEST-F1-3.
064400     MOVE "ELEM (10,10,10)" TO ELEM-HOLD-AREA.
064500     SEARCH GRP3-ENTRY VARYING IDX-3 AT END
064600         GO TO TH3-FAIL-F1-3
064700         WHEN ENTRY-3 (IDX-1, IDX-2, IDX-3) = ELEM-HOLD-AREA
064800             NEXT SENTENCE.
064900
065000     PERFORM PASS
065100     GO TO TH3-WRITE-F1-3.
065200 TH3-DELETE-F1-3.
065300     PERFORM DE-LETE.
065400     GO TO TH3-WRITE-F1-3.
065500 TH3-FAIL-F1-3.
065600     PERFORM ELEM-FAIL-PARA.
065700 TH3-WRITE-F1-3.
065800     PERFORM PRINT-DETAIL.
065900*
066000 TH3-INIT-F1-4.
066100     MOVE "TH3-TEST-F1-4      " TO PAR-NAME.
066200     MOVE "VI-122 6.21"   TO ANSI-REFERENCE.
066300     MOVE "SEARCH VARYING LEV 3" TO FEATURE.
066400     MOVE "ELEM (07,06,05)" TO ELEM-HOLD-AREA.
066500     MOVE 07 TO SUB-1.
066600     MOVE 06 TO SUB-2.
066700     MOVE 05 TO SUB-3.
066800     SET IDX-1 TO 07.
066900     SET IDX-2 TO 06.
067000     SET IDX-3 TO 03.
067100 TH3-TEST-F1-4.
067200     SEARCH GRP3-ENTRY VARYING IDX-3 AT END
067300         GO TO TH3-TEST-F1-4
067400         WHEN ENTRY-3 (IDX-1, IDX-2, IDX-3) = ELEM-HOLD-AREA
067500         NEXT SENTENCE.
067600
067700     PERFORM PASS
067800     GO TO TH3-WRITE-F1-4.
067900 TH3-DELETE-F1-4.
068000     PERFORM DE-LETE.
068100     GO TO TH3-WRITE-F1-4.
068200 TH3-FAIL-F1-4.
068300     PERFORM ELEM-FAIL-PARA.
068400 TH3-WRITE-F1-4.
068500     PERFORM PRINT-DETAIL.
068600     GO TO SCH-INIT-F1-1.
068700*
068800 ELEM-FAIL-PARA.
068900     MOVE ELEM-HOLD-AREA TO CORRECT-A.
069000     IF ENTRY-3 (SUB-1, SUB-2, SUB-3) EQUAL TO ELEM-HOLD-AREA
069100         MOVE "IDX-3" TO END-IDX
069200         SET IDX-VALU TO IDX-3
069300         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
069400         MOVE END-STMT TO COMPUTED-A  ELSE
069500     MOVE ENTRY-3 (SUB-1, SUB-2, SUB-3) TO COMPUTED-A
069600     MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
069700     PERFORM FAIL.
069800*
069900 SCH-INIT-F1-1.
070000     MOVE "SCH-TEST-F1-1  " TO PAR-NAME.
070100     MOVE "VI-122 6.21"   TO ANSI-REFERENCE.
070200     MOVE "MULTIPLE SEARCH STMT" TO FEATURE.
070300     MOVE "GRP08" TO GRP-HOLD-AREA.
070400     MOVE "SEC (08,07)" TO SEC-HOLD-AREA.
070500     SET IDX-1 IDX-2 TO 1.
070600 SCH-TEST-F1-1.
070700     SEARCH GRP-ENTRY VARYING IDX-1 AT END GO TO SCH-FAIL-F1-1-A
070800         WHEN ENTRY-1 (IDX-1) = "GRP08" NEXT SENTENCE.
070900     SEARCH GRP2-ENTRY VARYING IDX-2 AT END GO TO SCH-FAIL-F1-1-B
071000         WHEN ENTRY-2 (IDX-1, IDX-2) = SEC-HOLD-AREA
071100             NEXT SENTENCE.
071200     PERFORM PASS
071300     GO TO SCH-WRITE-F1-1.
071400 SCH-DELETE-F1-1.
071500     PERFORM DE-LETE.
071600     GO TO SCH-WRITE-F1-1.
071700 SCH-FAIL-F1-1-A.
071800     MOVE GRP-HOLD-AREA TO CORRECT-A.
071900     IF ENTRY-1 (08) EQUAL TO GRP-HOLD-AREA
072000         MOVE "IDX-1" TO END-IDX
072100         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
072200         SET IDX-VALU TO IDX-1
072300         MOVE END-STMT TO COMPUTED-A  ELSE
072400     MOVE ENTRY-1 (08) TO COMPUTED-A
072500     MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
072600
072700     PERFORM FAIL
072800     GO TO SCH-WRITE-F1-1.
072900 SCH-FAIL-F1-1-B.
073000     MOVE SEC-HOLD-AREA TO CORRECT-A.
073100     IF ENTRY-2 (08, 07) EQUAL TO SEC-HOLD-AREA
073200         MOVE "IDX-2" TO END-IDX
073300         SET IDX-VALU TO IDX-2
073400         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
073500         MOVE END-STMT TO COMPUTED-A  ELSE
073600     MOVE ENTRY-2 (08, 07) TO COMPUTED-A
073700     MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
073800
073900     PERFORM FAIL.
074000 SCH-WRITE-F1-1.
074100     PERFORM PRINT-DETAIL.
074200*
074300 SCH-INIT-F1-2.
074400     MOVE "SCH-TEST-F1-2  " TO PAR-NAME.
074500     MOVE "VI-122 6.21"   TO ANSI-REFERENCE.
074600     MOVE "MULTIPLE SEARCH STMT" TO FEATURE.
074700     MOVE "GRP04" TO GRP-HOLD-AREA.
074800     MOVE "SEC (04,04)" TO SEC-HOLD-AREA.
074900     MOVE "ELEM (04,04,04)" TO ELEM-HOLD-AREA.
075000     SET IDX-1 IDX-2 IDX-3 TO 1.
075100 SCH-TEST-F1-2.
075200     SEARCH GRP-ENTRY VARYING IDX-1
075300         AT END
075400              GO TO SCH-FAIL-F1-2-A
075500         WHEN ENTRY-1 (IDX-1) = GRP-HOLD-AREA
075600              NEXT SENTENCE.
075700*
075800     SEARCH GRP2-ENTRY VARYING IDX-2
075900         AT END
076000              GO TO SCH-FAIL-F1-2-B
076100         WHEN ENTRY-2 (IDX-1, IDX-2) = SEC-HOLD-AREA
076200              NEXT SENTENCE.
076300*
076400     SEARCH GRP3-ENTRY VARYING IDX-3
076500         AT END
076600              GO TO SCH-FAIL-F1-2-C
076700         WHEN ENTRY-3 (IDX-1, IDX-2, IDX-3) = ELEM-HOLD-AREA
076800              NEXT SENTENCE.
076900
077000     PERFORM PASS
077100     GO TO SCH-WRITE-F1-2.
077200 SCH-FAIL-F1-2-A.
077300     MOVE GRP-HOLD-AREA TO CORRECT-A.
077400     IF ENTRY-1 (04) EQUAL TO GRP-HOLD-AREA
077500         MOVE "IDX-1" TO END-IDX
077600         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
077700         SET IDX-VALU TO IDX-1
077800         MOVE END-STMT TO COMPUTED-A
077900     ELSE
078000         MOVE ENTRY-1 (04) TO COMPUTED-A
078100         MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
078200     PERFORM FAIL.
078300     GO TO SCH-WRITE-F1-2.
078400 SCH-FAIL-F1-2-B.
078500     MOVE  SEC-HOLD-AREA TO CORRECT-A.
078600     IF ENTRY-2 (04, 04) EQUAL TO SEC-HOLD-AREA
078700         MOVE "IDX-2" TO END-IDX
078800         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
078900         SET IDX-VALU TO IDX-2
079000         MOVE END-STMT TO COMPUTED-A
079100     ELSE
079200         MOVE ENTRY-2 (04, 04) TO COMPUTED-A
079300         MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
079400     PERFORM FAIL
079500     GO TO SCH-WRITE-F1-2.
079600 SCH-FAIL-F1-2-C.
079700     MOVE ELEM-HOLD-AREA TO CORRECT-A.
079800     IF ENTRY-3 (04, 04, 04) EQUAL TO ELEM-HOLD-AREA
079900         MOVE "IDX-3" TO END-IDX
080000         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
080100         SET IDX-VALU TO IDX-3
080200         MOVE END-STMT TO COMPUTED-A
080300     ELSE
080400         MOVE ENTRY-3 (04, 04, 04) TO COMPUTED-A
080500         MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
080600     PERFORM FAIL.
080700 SCH-WRITE-F1-2.
080800     PERFORM PRINT-DETAIL.
080900*
081000 SPC-INIT-F1-1.
081100     MOVE "SPC-TEST-F1-1      " TO PAR-NAME.
081200     MOVE "VI-122 6.21"   TO ANSI-REFERENCE.
081300     MOVE "SEARCH WITH HI INDEX" TO FEATURE.
081400     SET IDX-1 TO 4.
081500 SPC-TEST-F1-1.
081600     SEARCH GRP-ENTRY VARYING IDX-1
081700         AT END
081800              PERFORM PASS
081900              GO TO SPC-WRITE-F1-1
082000         WHEN ENTRY-1 (IDX-1) = "GRP03"
082100              GO TO SPC-FAIL-F1-1.
082200 SPC-DELETE-F1-1.
082300     PERFORM DE-LETE.
082400     GO TO SPC-WRITE-F1-1.
082500 SPC-FAIL-F1-1.
082600     MOVE SPACES TO CORRECT-A.
082700     MOVE ENTRY-1 (03) TO COMPUTED-A.
082800     MOVE SPACES TO RE-MARK.
082900     PERFORM FAIL.
083000 SPC-WRITE-F1-1.
083100     PERFORM PRINT-DETAIL.
083200*
083300 SPC-INIT-F1-2.
083400     MOVE "SPC-TEST-F1-2" TO PAR-NAME.
083500     MOVE "VI-122 6.21"   TO ANSI-REFERENCE.
083600     MOVE "SEARCH WITH HI INDEX" TO FEATURE.
083700     SET IDX-1 TO 4.
083800     SET IDX-2 TO 5.
083900 SPC-TEST-F1-2.
084000     SEARCH GRP-ENTRY VARYING IDX-1
084100         AT END GO TO SPC-FAIL-F1-2-A
084200         WHEN ENTRY-1 (IDX-1) = "GRP04" NEXT SENTENCE.
084300     SEARCH GRP2-ENTRY VARYING IDX-2
084400         AT END PERFORM PASS
084500                GO TO SPC-WRITE-F1-2
084600         WHEN ENTRY-2 (IDX-1, IDX-2) = "SEC (04,04)"
084700                GO TO SPC-FAIL-F1-2-B.
084800 SPC-DELETE-F1-2.
084900     PERFORM DE-LETE.
085000     GO TO SPC-WRITE-F1-2.
085100 SPC-FAIL-F1-2-A.
085200     MOVE "GRP04" TO CORRECT-A.
085300     IF ENTRY-1 (04) EQUAL TO "GRP04"
085400         MOVE "IDX-2" TO END-IDX
085500         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
085600         SET IDX-VALU TO IDX-2
085700         MOVE END-STMT TO COMPUTED-A  ELSE
085800     MOVE ENTRY-1 (04) TO COMPUTED-A
085900     MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
086000     PERFORM FAIL
086100     GO TO SPC-WRITE-F1-2.
086200 SPC-FAIL-F1-2-B.
086300     MOVE ENTRY-2 (04, 04) TO COMPUTED-A
086400     MOVE SPACES TO CORRECT-A.
086500     PERFORM FAIL.
086600 SPC-WRITE-F1-2.
086700     PERFORM PRINT-DETAIL.
086800*
086900 SPC-INIT-F1-3.
087000     MOVE "SPC-TEST-F1-3" TO PAR-NAME.
087100     MOVE "VI-122 6.21"   TO ANSI-REFERENCE.
087200     MOVE "SEARCH WITH HI INDEX" TO FEATURE.
087300     SET IDX-1 TO 02.
087400 SPC-TEST-F1-3.
087500     SEARCH GRP-ENTRY VARYING IDX-1
087600         AT END
087700                GO TO SPC-FAIL-F1-3-A
087800         WHEN ENTRY-1 (IDX-1) EQUAL TO "GRP02"
087900                NEXT SENTENCE.
088000     SET IDX-2 TO 01.
088100     SEARCH GRP2-ENTRY VARYING IDX-2
088200         AT END
088300                GO TO SPC-FAIL-F1-3-B
088400         WHEN ENTRY-2 (IDX-1, IDX-2) = "SEC (02,03)"
088500                NEXT SENTENCE.
088600     SET IDX-3 TO 05.
088700     SEARCH GRP3-ENTRY VARYING IDX-3
088800         AT END PERFORM PASS
088900                GO TO SPC-WRITE-F1-3
089000         WHEN ENTRY-3 (IDX-1, IDX-2, IDX-3) = "ELEM (02,03,04)"
089100                GO TO SPC-FAIL-F1-3-C.
089200 SPC-FAIL-F1-3-A.
089300     MOVE "GRP02" TO CORRECT-A.
089400     IF ENTRY-1 (02) EQUAL TO "GRP02"
089500         MOVE "IDX-1" TO END-IDX
089600         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
089700         SET IDX-VALU TO IDX-1
089800         MOVE END-STMT TO COMPUTED-A  ELSE
089900     MOVE ENTRY-1 (02) TO COMPUTED-A
090000     MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
090100     PERFORM FAIL
090200     GO TO SPC-WRITE-F1-3.
090300 SPC-FAIL-F1-3-B.
090400     MOVE "SEC (02,03)" TO CORRECT-A.
090500     IF ENTRY-2 (02, 03) EQUAL TO "SEC (02,03)"
090600         MOVE "IDX-2" TO END-IDX
090700         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
090800         SET IDX-VALU TO IDX-2
090900         MOVE END-STMT TO COMPUTED-A  ELSE
091000     MOVE ENTRY-2 (02, 03) TO COMPUTED-A
091100     MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
091200     PERFORM FAIL
091300     GO TO SPC-WRITE-F1-3.
091400 SPC-FAIL-F1-3-C.
091500     MOVE "INDEX SET HIGHER THAN ENTRY" TO RE-MARK
091600     MOVE SPACES TO CORRECT-A
091700     MOVE "ELEM (02,03,04)" TO COMPUTED-A
091800     PERFORM FAIL.
091900 SPC-WRITE-F1-3.
092000     PERFORM PRINT-DETAIL.
092100 CCVS-EXIT SECTION.
092200 CCVS-999999.
092300     GO TO CLOSE-FILES.
