000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ127A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300
001400*     THIS ROUTINE CHECKS THE SAME AS SQ104 IN COMBINATION
001500*     WITH
001600*
001700*         SELECT ... ASSIGN TO   "LITERAL-1"
001800*                                -----------
001900*             (X-CARD X-60 IS UESD FOR LITERAL-1)
002000*
002100*
002200*        THE ROUTINE SQ127A CREATES A SEQUENTIAL MASS STORAGE
002300*    FILE WHICH HAS FIXED LENGTH RECORDS.  THE FILE IS THEN
002400*    CLOSED AND OPENED AS AN INPUT FILE.  THE FILE IS READ AND
002500*    FIELDS IN THE INPUT RECORDS ARE COMPARED TO THE VALUES
002600*    WRITTEN TO ENSURE THAT THE RECORDS WERE PROCESSED CORRECTLY.
002700*    THE FILE IS CLOSED AND OPENED AGAIN AS AN INPUT FILE.  FOUR
002800*    READ FORMAT OPTIONS ARE USED TO READ THE FILE AND FIELDS IN
002900*    THE RECORDS ARE VERIFIED.  THE OPEN, CLOSE, READ, AND WRITE
003000*    STATEMENTS ARE TESTED FOR LEVEL ONE FEATURES.
003100*
003200*    USED X-CARDS:
003300*         XXXXX055
003400*         XXXXX060        FOR "SQ-FS3"
003500*     P   XXXXX062
003600*         XXXXX082
003700*         XXXXX083
003800*     C   XXXXX084
003900*
004000*
004100 ENVIRONMENT DIVISION.
004200 CONFIGURATION SECTION.
004300 SOURCE-COMPUTER.
004400     XXXXX082.
004500 OBJECT-COMPUTER.
004600     XXXXX083.
004700 INPUT-OUTPUT SECTION.
004800 FILE-CONTROL.
004900P    SELECT RAW-DATA   ASSIGN TO
005000P    XXXXX062
005100P           ORGANIZATION IS INDEXED
005200P           ACCESS MODE IS RANDOM
005300P           RECORD KEY IS RAW-DATA-KEY.
005400     SELECT PRINT-FILE ASSIGN TO
005500     XXXXX055.
005600     SELECT SQ-FS3 ASSIGN TO
005700     XXXXX060
005800     ORGANIZATION IS SEQUENTIAL
005900     ACCESS MODE IS SEQUENTIAL.
006000 DATA DIVISION.
006100 FILE SECTION.
006200P
006300PFD  RAW-DATA.
006400P
006500P01  RAW-DATA-SATZ.
006600P    05  RAW-DATA-KEY        PIC X(6).
006700P    05  C-DATE              PIC 9(6).
006800P    05  C-TIME              PIC 9(8).
006900P    05  C-NO-OF-TESTS       PIC 99.
007000P    05  C-OK                PIC 999.
007100P    05  C-ALL               PIC 999.
007200P    05  C-FAIL              PIC 999.
007300P    05  C-DELETED           PIC 999.
007400P    05  C-INSPECT           PIC 999.
007500P    05  C-NOTE              PIC X(13).
007600P    05  C-INDENT            PIC X.
007700P    05  C-ABORT             PIC X(8).
007800 FD  PRINT-FILE
007900C    LABEL RECORDS
008000C    XXXXX084
008100C    DATA RECORD IS PRINT-REC DUMMY-RECORD
008200               .
008300 01  PRINT-REC PICTURE X(120).
008400 01  DUMMY-RECORD PICTURE X(120).
008500 FD  SQ-FS3
008600C    LABEL RECORDS ARE STANDARD
008700C    DATA RECORD SQ-FS3R1-F-G-120
008800     BLOCK CONTAINS 120 CHARACTERS
008900     RECORD CONTAINS 120 CHARACTERS.
009000 01  SQ-FS3R1-F-G-120.
009100     02  FILLER PIC X(120).
009200 WORKING-STORAGE SECTION.
009300 01  WRK-CS-09V00 PICTURE S9(9) USAGE COMP VALUE ZERO.
009400 01  RECORDS-IN-ERROR  PIC S9(5) USAGE COMP VALUE 0.
009500 01  ERROR-FLAG PICTURE 9 VALUE 0.
009600 01  EOF-FLAG PICTURE 9 VALUE 0.
009700 01  FILE-RECORD-INFORMATION-REC.
009800     03 FILE-RECORD-INFO-SKELETON.
009900        05 FILLER                 PICTURE X(48)       VALUE
010000             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
010100        05 FILLER                 PICTURE X(46)       VALUE
010200             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
010300        05 FILLER                 PICTURE X(26)       VALUE
010400             ",LFIL=000000,ORG=  ,LBLR= ".
010500        05 FILLER                 PICTURE X(37)       VALUE
010600             ",RECKEY=                             ".
010700        05 FILLER                 PICTURE X(38)       VALUE
010800             ",ALTKEY1=                             ".
010900        05 FILLER                 PICTURE X(38)       VALUE
011000             ",ALTKEY2=                             ".
011100        05 FILLER                 PICTURE X(7)        VALUE SPACE.
011200     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
011300        05 FILE-RECORD-INFO-P1-120.
011400           07 FILLER              PIC X(5).
011500           07 XFILE-NAME           PIC X(6).
011600           07 FILLER              PIC X(8).
011700           07 XRECORD-NAME         PIC X(6).
011800           07 FILLER              PIC X(1).
011900           07 REELUNIT-NUMBER     PIC 9(1).
012000           07 FILLER              PIC X(7).
012100           07 XRECORD-NUMBER       PIC 9(6).
012200           07 FILLER              PIC X(6).
012300           07 UPDATE-NUMBER       PIC 9(2).
012400           07 FILLER              PIC X(5).
012500           07 ODO-NUMBER          PIC 9(4).
012600           07 FILLER              PIC X(5).
012700           07 XPROGRAM-NAME        PIC X(5).
012800           07 FILLER              PIC X(7).
012900           07 XRECORD-LENGTH       PIC 9(6).
013000           07 FILLER              PIC X(7).
013100           07 CHARS-OR-RECORDS    PIC X(2).
013200           07 FILLER              PIC X(1).
013300           07 XBLOCK-SIZE          PIC 9(4).
013400           07 FILLER              PIC X(6).
013500           07 RECORDS-IN-FILE     PIC 9(6).
013600           07 FILLER              PIC X(5).
013700           07 XFILE-ORGANIZATION   PIC X(2).
013800           07 FILLER              PIC X(6).
013900           07 XLABEL-TYPE          PIC X(1).
014000        05 FILE-RECORD-INFO-P121-240.
014100           07 FILLER              PIC X(8).
014200           07 XRECORD-KEY          PIC X(29).
014300           07 FILLER              PIC X(9).
014400           07 ALTERNATE-KEY1      PIC X(29).
014500           07 FILLER              PIC X(9).
014600           07 ALTERNATE-KEY2      PIC X(29).
014700           07 FILLER              PIC X(7).
014800 01  TEST-RESULTS.
014900     02 FILLER                    PICTURE X VALUE SPACE.
015000     02 FEATURE                   PICTURE X(20) VALUE SPACE.
015100     02 FILLER                    PICTURE X VALUE SPACE.
015200     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
015300     02 FILLER                    PICTURE X  VALUE SPACE.
015400     02  PAR-NAME.
015500       03 FILLER PICTURE X(12) VALUE SPACE.
015600       03  PARDOT-X PICTURE X  VALUE SPACE.
015700       03 DOTVALUE PICTURE 99  VALUE ZERO.
015800       03 FILLER PIC X(5) VALUE SPACE.
015900     02 FILLER PIC X(10) VALUE SPACE.
016000     02 RE-MARK PIC X(61).
016100 01  TEST-COMPUTED.
016200     02 FILLER PIC X(30) VALUE SPACE.
016300     02 FILLER PIC X(17) VALUE "       COMPUTED=".
016400     02 COMPUTED-X.
016500     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
016600     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
016700     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
016800     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
016900     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
017000     03       CM-18V0 REDEFINES COMPUTED-A.
017100         04 COMPUTED-18V0                   PICTURE -9(18).
017200         04 FILLER                          PICTURE X.
017300     03 FILLER PIC X(50) VALUE SPACE.
017400 01  TEST-CORRECT.
017500     02 FILLER PIC X(30) VALUE SPACE.
017600     02 FILLER PIC X(17) VALUE "       CORRECT =".
017700     02 CORRECT-X.
017800     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
017900     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
018000     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
018100     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
018200     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
018300     03      CR-18V0 REDEFINES CORRECT-A.
018400         04 CORRECT-18V0                    PICTURE -9(18).
018500         04 FILLER                          PICTURE X.
018600     03 FILLER PIC X(50) VALUE SPACE.
018700 01  CCVS-C-1.
018800     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
018900-    "SS  PARAGRAPH-NAME
019000-    "        REMARKS".
019100     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
019200 01  CCVS-C-2.
019300     02 FILLER PICTURE IS X VALUE IS SPACE.
019400     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
019500     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
019600     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
019700     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
019800 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
019900 01  REC-CT PICTURE 99 VALUE ZERO.
020000 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
020100 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
020200 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
020300 01  PASS-COUNTER PIC 999 VALUE ZERO.
020400 01  TOTAL-ERROR PIC 999 VALUE ZERO.
020500 01  ERROR-HOLD PIC 999 VALUE ZERO.
020600 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
020700 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
020800 01  CCVS-H-1.
020900     02  FILLER   PICTURE X(27)  VALUE SPACE.
021000     02 FILLER PICTURE X(67) VALUE
021100     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
021200-    " SYSTEM".
021300     02  FILLER     PICTURE X(26)  VALUE SPACE.
021400 01  CCVS-H-2.
021500     02 FILLER PICTURE X(52) VALUE IS
021600     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
021700     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
021800     02 TEST-ID PICTURE IS X(9).
021900     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
022000 01  CCVS-H-3.
022100     02  FILLER PICTURE X(34) VALUE
022200     " FOR OFFICIAL USE ONLY    ".
022300     02  FILLER PICTURE X(58) VALUE
022400     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022500     02  FILLER PICTURE X(28) VALUE
022600     "  COPYRIGHT   1985 ".
022700 01  CCVS-E-1.
022800     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
022900     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
023000     02 ID-AGAIN PICTURE IS X(9).
023100     02 FILLER PICTURE X(45) VALUE IS
023200     " NTIS DISTRIBUTION COBOL 85".
023300 01  CCVS-E-2.
023400     02  FILLER                   PICTURE X(31)  VALUE
023500     SPACE.
023600     02  FILLER                   PICTURE X(21)  VALUE SPACE.
023700     02 CCVS-E-2-2.
023800         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
023900         03 FILLER PICTURE IS X VALUE IS SPACE.
024000         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
024100 01  CCVS-E-3.
024200     02  FILLER PICTURE X(22) VALUE
024300     " FOR OFFICIAL USE ONLY".
024400     02  FILLER PICTURE X(12) VALUE SPACE.
024500     02  FILLER PICTURE X(58) VALUE
024600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024700     02  FILLER PICTURE X(13) VALUE SPACE.
024800     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
024900 01  CCVS-E-4.
025000     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
025100     02 FILLER PIC XXXX VALUE " OF ".
025200     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
025300     02 FILLER PIC X(40) VALUE
025400      "  TESTS WERE EXECUTED SUCCESSFULLY".
025500 01  XXINFO.
025600     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
025700     02 INFO-TEXT.
025800     04 FILLER PIC X(20) VALUE SPACE.
025900     04 XXCOMPUTED PIC X(20).
026000     04 FILLER PIC X(5) VALUE SPACE.
026100     04 XXCORRECT PIC X(20).
026200 01  HYPHEN-LINE.
026300     02 FILLER PICTURE IS X VALUE IS SPACE.
026400     02 FILLER PICTURE IS X(65) VALUE IS "************************
026500-    "*****************************************".
026600     02 FILLER PICTURE IS X(54) VALUE IS "************************
026700-    "******************************".
026800 01  CCVS-PGM-ID PIC X(6) VALUE
026900     "SQ127A".
027000 PROCEDURE DIVISION.
027100 CCVS1 SECTION.
027200 OPEN-FILES.
027300P    OPEN I-O RAW-DATA.
027400P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
027500P    READ RAW-DATA INVALID KEY GO TO END-E-1.
027600P    MOVE "ABORTED " TO C-ABORT.
027700P    ADD 1 TO C-NO-OF-TESTS.
027800P    ACCEPT C-DATE  FROM DATE.
027900P    ACCEPT C-TIME  FROM TIME.
028000P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
028100PEND-E-1.
028200P    CLOSE RAW-DATA.
028300     OPEN     OUTPUT PRINT-FILE.
028400     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
028500     MOVE    SPACE TO TEST-RESULTS.
028600     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
028700     MOVE ZERO TO REC-SKL-SUB.
028800     PERFORM CCVS-INIT-FILE 9 TIMES.
028900 CCVS-INIT-FILE.
029000     ADD 1 TO REC-SKL-SUB.
029100     MOVE FILE-RECORD-INFO-SKELETON TO
029200                  FILE-RECORD-INFO (REC-SKL-SUB).
029300 CCVS-INIT-EXIT.
029400     GO TO CCVS1-EXIT.
029500 CLOSE-FILES.
029600     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
029700P    OPEN I-O RAW-DATA.
029800P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
029900P    READ RAW-DATA INVALID KEY GO TO END-E-2.
030000P    MOVE "OK.     " TO C-ABORT.
030100P    MOVE PASS-COUNTER TO C-OK.
030200P    MOVE ERROR-HOLD   TO C-ALL.
030300P    MOVE ERROR-COUNTER TO C-FAIL.
030400P    MOVE DELETE-CNT TO C-DELETED.
030500P    MOVE INSPECT-COUNTER TO C-INSPECT.
030600P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
030700PEND-E-2.
030800P    CLOSE RAW-DATA.
030900 TERMINATE-CCVS.
031000S    EXIT PROGRAM.
031100STERMINATE-CALL.
031200     STOP     RUN.
031300 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
031400 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
031500 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
031600 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
031700     MOVE "****TEST DELETED****" TO RE-MARK.
031800 PRINT-DETAIL.
031900     IF REC-CT NOT EQUAL TO ZERO
032000             MOVE "." TO PARDOT-X
032100             MOVE REC-CT TO DOTVALUE.
032200     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
032300     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
032400        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
032500          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
032600     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
032700     MOVE SPACE TO CORRECT-X.
032800     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
032900     MOVE     SPACE TO RE-MARK.
033000 HEAD-ROUTINE.
033100     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033200     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033300     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
033400 COLUMN-NAMES-ROUTINE.
033500     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033600     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
033800 END-ROUTINE.
033900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
034000 END-RTN-EXIT.
034100     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034200 END-ROUTINE-1.
034300      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
034400      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
034500      ADD PASS-COUNTER TO ERROR-HOLD.
034600*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
034700      MOVE PASS-COUNTER TO CCVS-E-4-1.
034800      MOVE ERROR-HOLD TO CCVS-E-4-2.
034900      MOVE CCVS-E-4 TO CCVS-E-2-2.
035000      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
035100  END-ROUTINE-12.
035200      MOVE "TEST(S) FAILED" TO ENDER-DESC.
035300     IF       ERROR-COUNTER IS EQUAL TO ZERO
035400         MOVE "NO " TO ERROR-TOTAL
035500         ELSE
035600         MOVE ERROR-COUNTER TO ERROR-TOTAL.
035700     MOVE     CCVS-E-2 TO DUMMY-RECORD.
035800     PERFORM WRITE-LINE.
035900 END-ROUTINE-13.
036000     IF DELETE-CNT IS EQUAL TO ZERO
036100         MOVE "NO " TO ERROR-TOTAL  ELSE
036200         MOVE DELETE-CNT TO ERROR-TOTAL.
036300     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
036400     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036500      IF   INSPECT-COUNTER EQUAL TO ZERO
036600          MOVE "NO " TO ERROR-TOTAL
036700      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
036800      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
036900      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037000     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037100 WRITE-LINE.
037200     ADD 1 TO RECORD-COUNT.
037300Y    IF RECORD-COUNT GREATER 50
037400Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
037500Y        MOVE SPACE TO DUMMY-RECORD
037600Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
037700Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
037800Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
037900Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
038000Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
038100Y        MOVE ZERO TO RECORD-COUNT.
038200     PERFORM WRT-LN.
038300 WRT-LN.
038400     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
038500     MOVE SPACE TO DUMMY-RECORD.
038600 BLANK-LINE-PRINT.
038700     PERFORM WRT-LN.
038800 FAIL-ROUTINE.
038900     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
039000     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
039100     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
039200     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039300     GO TO FAIL-ROUTINE-EX.
039400 FAIL-ROUTINE-WRITE.
039500     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
039600     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
039700 FAIL-ROUTINE-EX. EXIT.
039800 BAIL-OUT.
039900     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
040000     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
040100 BAIL-OUT-WRITE.
040200     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
040300     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040400 BAIL-OUT-EX. EXIT.
040500 CCVS1-EXIT.
040600     EXIT.
040700 SECT-SQ127A-0001 SECTION.
040800 SEQ-INIT-007.
040900     MOVE "SQ-FS3" TO XFILE-NAME (1).
041000     MOVE "R1-F-G" TO XRECORD-NAME (1).
041100     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
041200     MOVE 120 TO XRECORD-LENGTH (1).
041300     MOVE "CH" TO CHARS-OR-RECORDS (1).
041400     MOVE 120 TO XBLOCK-SIZE (1).
041500     MOVE 000649 TO RECORDS-IN-FILE (1).
041600     MOVE "SQ" TO XFILE-ORGANIZATION (1).
041700     MOVE "S" TO XLABEL-TYPE (1).
041800     MOVE 000001 TO XRECORD-NUMBER (1).
041900     OPEN OUTPUT SQ-FS3.
042000 SEQ-TEST-007.
042100     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-FS3R1-F-G-120.
042200     WRITE SQ-FS3R1-F-G-120.
042300     IF XRECORD-NUMBER (1) EQUAL TO 649
042400        GO TO SEQ-WRITE-007.
042500     ADD 1 TO XRECORD-NUMBER (1).
042600     GO TO SEQ-TEST-007.
042700 SEQ-WRITE-007.
042800     MOVE "CREATE FILE SQ-FS3" TO FEATURE.
042900     MOVE "SEQ-TEST-007" TO PAR-NAME.
043000     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
043100     MOVE XRECORD-NUMBER (1) TO CORRECT-18V0.
043200     PERFORM PRINT-DETAIL.
043300     CLOSE SQ-FS3.
043400*        A MASS STORAGE SEQUENTIAL FILE WITH 120 CHARACTER
043500*    RECORDS HAS BEEN CREATED.  THE FILE CONTAINS 649 RECORDS.
043600 READ-INIT-GF-01.
043700     MOVE ZERO TO WRK-CS-09V00.
043800*        THIS TEST READS AND CHECKS THE FILE CREATED IN
043900*    SEQ-TEST-007.
044000     OPEN INPUT SQ-FS3.
044100 READ-TEST-GF-01.
044200     READ SQ-FS3 RECORD
044300         AT END GO TO READ-TEST-GF-01-1.
044400     MOVE SQ-FS3R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
044500     ADD 1 TO WRK-CS-09V00.
044600     IF WRK-CS-09V00 GREATER THAN 649
044700         MOVE "MORE THAN 649 RECORDS" TO RE-MARK
044800         GO TO READ-FAIL-GF-01.
044900     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
045000         ADD 1 TO RECORDS-IN-ERROR
045100         GO TO READ-TEST-GF-01.
045200     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS3"
045300         ADD 1 TO RECORDS-IN-ERROR
045400         GO TO READ-TEST-GF-01.
045500     IF XLABEL-TYPE (1) NOT EQUAL TO "S"
045600     ADD 1 TO RECORDS-IN-ERROR.
045700     GO TO READ-TEST-GF-01.
045800 READ-TEST-GF-01-1.
045900     IF RECORDS-IN-ERROR EQUAL TO ZERO
046000          GO TO READ-PASS-GF-01.
046100     MOVE "ERRORS IN READING SQ-FS3" TO RE-MARK.
046200 READ-FAIL-GF-01.
046300     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
046400     MOVE "VII-44 4.4.2,                      " TO RE-MARK.
046500     PERFORM FAIL.
046600     GO TO READ-WRITE-GF-01.
046700 READ-PASS-GF-01.
046800     PERFORM PASS.
046900     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
047000     MOVE WRK-CS-09V00 TO CORRECT-18V0.
047100 READ-WRITE-GF-01.
047200     MOVE "READ-TEST-GF-01" TO PAR-NAME.
047300     MOVE "VERIFY FILE SQ-FS3" TO FEATURE.
047400     PERFORM PRINT-DETAIL.
047500 SEQ-CLOSE-008.
047600     CLOSE SQ-FS3.
047700 READ-INIT-GF-02.
047800     MOVE ZERO TO WRK-CS-09V00.
047900     MOVE ZERO TO RECORDS-IN-ERROR.
048000     OPEN INPUT SQ-FS3.
048100*        FOUR OPTIONS FOR THE READ STATEMENT ARE CHECKED
048200*    IN THIS SERIES OF TESTS.
048300     MOVE "READ...RECORD AT END ..." TO FEATURE.
048400     MOVE "READ-TEST-GF-02" TO PAR-NAME.
048500     MOVE ZERO TO ERROR-FLAG.
048600 READ-TEST-GF-02.
048700     READ SQ-FS3 RECORD
048800          AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
048900          MOVE 1 TO EOF-FLAG
049000          GO TO READ-FAIL-GF-02.
049100     PERFORM RECORD-CHECK.
049200     IF WRK-CS-09V00 EQUAL TO 50
049300           GO TO READ-TEST-GF-02-1.
049400     GO TO READ-TEST-GF-02.
049500 RECORD-CHECK.
049600     MOVE SQ-FS3R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
049700     ADD 1 TO WRK-CS-09V00.
049800     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
049900         ADD 1 TO RECORDS-IN-ERROR
050000         MOVE 1 TO ERROR-FLAG.
050100 READ-TEST-GF-02-1.
050200     IF ERROR-FLAG EQUAL TO ZERO
050300         GO TO READ-PASS-GF-02.
050400     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
050500 READ-FAIL-GF-02.
050600     MOVE "VII-44 4.4.2,                      " TO RE-MARK.
050700     PERFORM FAIL.
050800     GO TO READ-WRITE-GF-02.
050900 READ-PASS-GF-02.
051000     PERFORM PASS.
051100 READ-WRITE-GF-02.
051200     PERFORM PRINT-DETAIL.
051300 READ-INIT-GF-03.
051400     IF EOF-FLAG EQUAL TO 1
051500         GO TO READ-EOF-GF-06.
051600     MOVE ZERO TO ERROR-FLAG.
051700     MOVE "READ...AT END..." TO FEATURE.
051800     MOVE "READ-TEST-GF-03" TO PAR-NAME.
051900 READ-TEST-GF-03.
052000     READ SQ-FS3  AT END
052100          MOVE "UNEXPECTED EOF" TO COMPUTED-A
052200          MOVE 1 TO EOF-FLAG
052300          GO TO READ-FAIL-GF-03.
052400     PERFORM RECORD-CHECK.
052500     IF WRK-CS-09V00 EQUAL TO 200
052600         GO TO READ-TEST-GF-03-1.
052700     GO TO READ-TEST-GF-03.
052800 READ-TEST-GF-03-1.
052900     IF ERROR-FLAG EQUAL TO ZERO
053000          GO TO READ-PASS-GF-03.
053100     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
053200 READ-FAIL-GF-03.
053300     MOVE "VII-44 4.4.2,                      " TO RE-MARK.
053400     PERFORM FAIL.
053500     GO TO READ-WRITE-GF-03.
053600 READ-PASS-GF-03.
053700     PERFORM PASS.
053800 READ-WRITE-GF-03.
053900     PERFORM PRINT-DETAIL.
054000 READ-INIT-GF-04.
054100     IF EOF-FLAG EQUAL TO 1
054200         GO TO READ-EOF-GF-06.
054300     MOVE ZERO TO ERROR-FLAG.
054400     MOVE "READ...RECORD END..." TO FEATURE.
054500     MOVE "READ-TEST-GF-04" TO PAR-NAME.
054600 READ-TEST-GF-04.
054700     READ SQ-FS3 RECORD END
054800          MOVE "UNEXPECTED EOF" TO COMPUTED-A
054900          MOVE 1 TO EOF-FLAG
055000          GO TO READ-FAIL-GF-04.
055100     PERFORM RECORD-CHECK.
055200     IF WRK-CS-09V00 EQUAL TO 499
055300          GO TO READ-TEST-GF-04-1.
055400     GO TO READ-TEST-GF-04.
055500 READ-TEST-GF-04-1.
055600     IF ERROR-FLAG EQUAL TO ZERO
055700           GO TO READ-PASS-GF-04.
055800     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
055900 READ-FAIL-GF-04.
056000     MOVE "VII-44 4.4.2,                      " TO RE-MARK.
056100     PERFORM FAIL.
056200     GO TO READ-WRITE-GF-04.
056300 READ-PASS-GF-04.
056400     PERFORM PASS.
056500 READ-WRITE-GF-04.
056600     PERFORM PRINT-DETAIL.
056700 READ-INIT-GF-05.
056800     IF EOF-FLAG EQUAL TO 1
056900         GO TO READ-EOF-GF-06.
057000     MOVE ZERO TO ERROR-FLAG.
057100     MOVE "READ...END..." TO FEATURE.
057200     MOVE "READ-TEST-GF-05" TO PAR-NAME.
057300 READ-TEST-GF-05.
057400     READ SQ-FS3 END
057500          GO TO READ-TEST-GF-05-1.
057600     PERFORM RECORD-CHECK.
057700     IF WRK-CS-09V00 GREATER THAN 649
057800          GO TO READ-TEST-GF-05-1.
057900     GO TO READ-TEST-GF-05.
058000 READ-TEST-GF-05-1.
058100     IF ERROR-FLAG EQUAL TO ZERO
058200         GO TO READ-PASS-GF-05.
058300 READ-FAIL-GF-05.
058400     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
058500     MOVE "VII-44 4.4.2,                      " TO RE-MARK.
058600     PERFORM FAIL.
058700     GO TO READ-WRITE-GF-05.
058800 READ-PASS-GF-05.
058900     PERFORM PASS.
059000 READ-WRITE-GF-05.
059100     PERFORM PRINT-DETAIL.
059200 READ-TEST-GF-06.
059300     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
059400          MOVE "RECORDS IN ERROR =" TO COMPUTED-A
059500          MOVE RECORDS-IN-ERROR TO CORRECT-18V0
059600          GO TO READ-FAIL-GF-06.
059700     IF WRK-CS-09V00 GREATER THAN 649
059800          MOVE "MORE THAN 649 RECORDS" TO RE-MARK
059900          GO TO READ-FAIL-GF-06.
060000 READ-PASS-GF-06.
060100     PERFORM PASS
060200     GO TO READ-WRITE-GF-06.
060300 READ-EOF-GF-06.
060400     MOVE "LESS THAN 649 RECORDS" TO RE-MARK.
060500     MOVE "RECORDS READ =" TO COMPUTED-A.
060600     MOVE WRK-CS-09V00 TO CORRECT-18V0.
060700 READ-FAIL-GF-06.
060800     PERFORM FAIL.
060900 READ-WRITE-GF-06.
061000     MOVE "READ-TEST-GF-06" TO PAR-NAME.
061100     MOVE "READ FILE SQ-FS3" TO FEATURE.
061200     PERFORM PRINT-DETAIL.
061300 READ-CLOSE-GF-06.
061400     CLOSE SQ-FS3.
061500 TERMINATE-ROUTINE.
061600     EXIT.
061700 CCVS-EXIT SECTION.
061800 CCVS-999999.
061900     GO TO CLOSE-FILES.
