000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ117A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
000900*                                                              *
001000*    CREATION DATE     /     VALIDATION DATE                   *
001100*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001200*                                                              *
001300****************************************************************
001400
001500*        THIS ROUTINE CREATES A SEQUENTIAL MASS STORAGE FILE
001600*    USING WRITE...FROM STATEMENTS.  THE FILE IS READ AND FIELDS
001700*    IN THE RECORDS ARE CHECKED TO ENSURE THAT TRUNCATION AND
001800*    BLANK FILLING OF THE RECORD OCCURS WHEN REQUIRED.
001900*
002000*    USED X-CARDS:
002100*         XXXXX014
002200*         XXXXX055
002300*     P   XXXXX062
002400*         XXXXX082
002500*         XXXXX083
002600*     C   XXXXX084
002700*
002800*
002900 ENVIRONMENT DIVISION.
003000 CONFIGURATION SECTION.
003100 SOURCE-COMPUTER.
003200     XXXXX082.
003300 OBJECT-COMPUTER.
003400     XXXXX083.
003500 INPUT-OUTPUT SECTION.
003600 FILE-CONTROL.
003700P    SELECT RAW-DATA   ASSIGN TO
003800P    XXXXX062
003900P           ORGANIZATION IS INDEXED
004000P           ACCESS MODE IS RANDOM
004100P           RECORD KEY IS RAW-DATA-KEY.
004200     SELECT PRINT-FILE ASSIGN TO
004300     XXXXX055.
004400     SELECT SQ-FS9 ASSIGN TO
004500     XXXXX014
004600     ORGANIZATION IS SEQUENTIAL
004700     ACCESS MODE IS SEQUENTIAL.
004800 DATA DIVISION.
004900 FILE SECTION.
005000P
005100PFD  RAW-DATA.
005200P
005300P01  RAW-DATA-SATZ.
005400P    05  RAW-DATA-KEY        PIC X(6).
005500P    05  C-DATE              PIC 9(6).
005600P    05  C-TIME              PIC 9(8).
005700P    05  C-NO-OF-TESTS       PIC 99.
005800P    05  C-OK                PIC 999.
005900P    05  C-ALL               PIC 999.
006000P    05  C-FAIL              PIC 999.
006100P    05  C-DELETED           PIC 999.
006200P    05  C-INSPECT           PIC 999.
006300P    05  C-NOTE              PIC X(13).
006400P    05  C-INDENT            PIC X.
006500P    05  C-ABORT             PIC X(8).
006600 FD  PRINT-FILE
006700C    LABEL RECORDS
006800C    XXXXX084
006900C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007000               .
007100 01  PRINT-REC PICTURE X(120).
007200 01  DUMMY-RECORD PICTURE X(120).
007300 FD  SQ-FS9
007400C    LABEL RECORD STANDARD
007500     BLOCK CONTAINS 1 RECORDS.
007600 01  SQ-FS9R1-F-G-141.
007700     02  SQ-FS9R1-PART1  PICTURE X(120).
007800     02  SQ-FS9R1-PART2  PICTURE X(21).
007900 WORKING-STORAGE SECTION.
008000 01  COUNT-OF-RECS PICTURE 9(5)  VALUE 0.
008100 01  RECORDS-IN-ERROR PIC S9(5) USAGE COMP VALUE 0.
008200 01  ERROR-FLAG PICTURE 9 VALUE 0.
008300 01  EOF-FLAG PIC 9 VALUE 0.
008400 01  WRITE-FROM-AREA1.
008500     02  AREA1-1  PIC X(87).
008600 01  FOLLOWS-AREA1  PIC  X(10).
008700 01  WRITE-FROM-AREA2.
008800     02  AREA2-1  PIC  X(120).
008900 01  WRITE-FROM-AREA3.
009000     02  AREA3-1  PIC X(141).
009100     02  AREA3-2  PIC X(7).
009200 01  WRITE-FROM-AREA4.
009300     02  AREA4-1  PIC X(120).
009400     02  AREA4-2  PIC X(21).
009500 01  END-OF-RECORD-AREA.
009600     02  ALPHA-AREA  PIC X(17).
009700     02  NUMBER-AREA PIC 9999.
009800 01  FILE-RECORD-INFORMATION-REC.
009900     03 FILE-RECORD-INFO-SKELETON.
010000        05 FILLER                 PICTURE X(48)       VALUE
010100             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
010200        05 FILLER                 PICTURE X(46)       VALUE
010300             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
010400        05 FILLER                 PICTURE X(26)       VALUE
010500             ",LFIL=000000,ORG=  ,LBLR= ".
010600        05 FILLER                 PICTURE X(37)       VALUE
010700             ",RECKEY=                             ".
010800        05 FILLER                 PICTURE X(38)       VALUE
010900             ",ALTKEY1=                             ".
011000        05 FILLER                 PICTURE X(38)       VALUE
011100             ",ALTKEY2=                             ".
011200        05 FILLER                 PICTURE X(7)        VALUE SPACE.
011300     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
011400        05 FILE-RECORD-INFO-P1-120.
011500           07 FILLER              PIC X(5).
011600           07 XFILE-NAME           PIC X(6).
011700           07 FILLER              PIC X(8).
011800           07 XRECORD-NAME         PIC X(6).
011900           07 FILLER              PIC X(1).
012000           07 REELUNIT-NUMBER     PIC 9(1).
012100           07 FILLER              PIC X(7).
012200           07 XRECORD-NUMBER       PIC 9(6).
012300           07 FILLER              PIC X(6).
012400           07 UPDATE-NUMBER       PIC 9(2).
012500           07 FILLER              PIC X(5).
012600           07 ODO-NUMBER          PIC 9(4).
012700           07 FILLER              PIC X(5).
012800           07 XPROGRAM-NAME        PIC X(5).
012900           07 FILLER              PIC X(7).
013000           07 XRECORD-LENGTH       PIC 9(6).
013100           07 FILLER              PIC X(7).
013200           07 CHARS-OR-RECORDS    PIC X(2).
013300           07 FILLER              PIC X(1).
013400           07 XBLOCK-SIZE          PIC 9(4).
013500           07 FILLER              PIC X(6).
013600           07 RECORDS-IN-FILE     PIC 9(6).
013700           07 FILLER              PIC X(5).
013800           07 XFILE-ORGANIZATION   PIC X(2).
013900           07 FILLER              PIC X(6).
014000           07 XLABEL-TYPE          PIC X(1).
014100        05 FILE-RECORD-INFO-P121-240.
014200           07 FILLER              PIC X(8).
014300           07 XRECORD-KEY          PIC X(29).
014400           07 FILLER              PIC X(9).
014500           07 ALTERNATE-KEY1      PIC X(29).
014600           07 FILLER              PIC X(9).
014700           07 ALTERNATE-KEY2      PIC X(29).
014800           07 FILLER              PIC X(7).
014900 01  TEST-RESULTS.
015000     02 FILLER                    PICTURE X VALUE SPACE.
015100     02 FEATURE                   PICTURE X(20) VALUE SPACE.
015200     02 FILLER                    PICTURE X VALUE SPACE.
015300     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
015400     02 FILLER                    PICTURE X  VALUE SPACE.
015500     02  PAR-NAME.
015600       03 FILLER PICTURE X(12) VALUE SPACE.
015700       03  PARDOT-X PICTURE X  VALUE SPACE.
015800       03 DOTVALUE PICTURE 99  VALUE ZERO.
015900       03 FILLER PIC X(5) VALUE SPACE.
016000     02 FILLER PIC X(10) VALUE SPACE.
016100     02 RE-MARK PIC X(61).
016200 01  TEST-COMPUTED.
016300     02 FILLER PIC X(30) VALUE SPACE.
016400     02 FILLER PIC X(17) VALUE "       COMPUTED=".
016500     02 COMPUTED-X.
016600     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
016700     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
016800     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
016900     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
017000     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
017100     03       CM-18V0 REDEFINES COMPUTED-A.
017200         04 COMPUTED-18V0                   PICTURE -9(18).
017300         04 FILLER                          PICTURE X.
017400     03 FILLER PIC X(50) VALUE SPACE.
017500 01  TEST-CORRECT.
017600     02 FILLER PIC X(30) VALUE SPACE.
017700     02 FILLER PIC X(17) VALUE "       CORRECT =".
017800     02 CORRECT-X.
017900     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
018000     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
018100     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
018200     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
018300     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
018400     03      CR-18V0 REDEFINES CORRECT-A.
018500         04 CORRECT-18V0                    PICTURE -9(18).
018600         04 FILLER                          PICTURE X.
018700     03 FILLER PIC X(50) VALUE SPACE.
018800 01  CCVS-C-1.
018900     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
019000-    "SS  PARAGRAPH-NAME
019100-    "        REMARKS".
019200     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
019300 01  CCVS-C-2.
019400     02 FILLER PICTURE IS X VALUE IS SPACE.
019500     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
019600     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
019700     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
019800     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
019900 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
020000 01  REC-CT PICTURE 99 VALUE ZERO.
020100 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
020200 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
020300 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
020400 01  PASS-COUNTER PIC 999 VALUE ZERO.
020500 01  TOTAL-ERROR PIC 999 VALUE ZERO.
020600 01  ERROR-HOLD PIC 999 VALUE ZERO.
020700 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
020800 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
020900 01  CCVS-H-1.
021000     02  FILLER   PICTURE X(27)  VALUE SPACE.
021100     02 FILLER PICTURE X(67) VALUE
021200     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
021300-    " SYSTEM".
021400     02  FILLER     PICTURE X(26)  VALUE SPACE.
021500 01  CCVS-H-2.
021600     02 FILLER PICTURE X(52) VALUE IS
021700     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
021800     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
021900     02 TEST-ID PICTURE IS X(9).
022000     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
022100 01  CCVS-H-3.
022200     02  FILLER PICTURE X(34) VALUE
022300     " FOR OFFICIAL USE ONLY    ".
022400     02  FILLER PICTURE X(58) VALUE
022500     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022600     02  FILLER PICTURE X(28) VALUE
022700     "  COPYRIGHT   1985 ".
022800 01  CCVS-E-1.
022900     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
023000     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
023100     02 ID-AGAIN PICTURE IS X(9).
023200     02 FILLER PICTURE X(45) VALUE IS
023300     " NTIS DISTRIBUTION COBOL 85".
023400 01  CCVS-E-2.
023500     02  FILLER                   PICTURE X(31)  VALUE
023600     SPACE.
023700     02  FILLER                   PICTURE X(21)  VALUE SPACE.
023800     02 CCVS-E-2-2.
023900         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
024000         03 FILLER PICTURE IS X VALUE IS SPACE.
024100         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
024200 01  CCVS-E-3.
024300     02  FILLER PICTURE X(22) VALUE
024400     " FOR OFFICIAL USE ONLY".
024500     02  FILLER PICTURE X(12) VALUE SPACE.
024600     02  FILLER PICTURE X(58) VALUE
024700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024800     02  FILLER PICTURE X(13) VALUE SPACE.
024900     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
025000 01  CCVS-E-4.
025100     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
025200     02 FILLER PIC XXXX VALUE " OF ".
025300     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
025400     02 FILLER PIC X(40) VALUE
025500      "  TESTS WERE EXECUTED SUCCESSFULLY".
025600 01  XXINFO.
025700     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
025800     02 INFO-TEXT.
025900     04 FILLER PIC X(20) VALUE SPACE.
026000     04 XXCOMPUTED PIC X(20).
026100     04 FILLER PIC X(5) VALUE SPACE.
026200     04 XXCORRECT PIC X(20).
026300 01  HYPHEN-LINE.
026400     02 FILLER PICTURE IS X VALUE IS SPACE.
026500     02 FILLER PICTURE IS X(65) VALUE IS "************************
026600-    "*****************************************".
026700     02 FILLER PICTURE IS X(54) VALUE IS "************************
026800-    "******************************".
026900 01  CCVS-PGM-ID PIC X(6) VALUE
027000     "SQ117A".
027100 PROCEDURE DIVISION.
027200 CCVS1 SECTION.
027300 OPEN-FILES.
027400P    OPEN I-O RAW-DATA.
027500P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
027600P    READ RAW-DATA INVALID KEY GO TO END-E-1.
027700P    MOVE "ABORTED " TO C-ABORT.
027800P    ADD 1 TO C-NO-OF-TESTS.
027900P    ACCEPT C-DATE  FROM DATE.
028000P    ACCEPT C-TIME  FROM TIME.
028100P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
028200PEND-E-1.
028300P    CLOSE RAW-DATA.
028400     OPEN     OUTPUT PRINT-FILE.
028500     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
028600     MOVE    SPACE TO TEST-RESULTS.
028700     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
028800     MOVE ZERO TO REC-SKL-SUB.
028900     PERFORM CCVS-INIT-FILE 9 TIMES.
029000 CCVS-INIT-FILE.
029100     ADD 1 TO REC-SKL-SUB.
029200     MOVE FILE-RECORD-INFO-SKELETON TO
029300                  FILE-RECORD-INFO (REC-SKL-SUB).
029400 CCVS-INIT-EXIT.
029500     GO TO CCVS1-EXIT.
029600 CLOSE-FILES.
029700     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
029800P    OPEN I-O RAW-DATA.
029900P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
030000P    READ RAW-DATA INVALID KEY GO TO END-E-2.
030100P    MOVE "OK.     " TO C-ABORT.
030200P    MOVE PASS-COUNTER TO C-OK.
030300P    MOVE ERROR-HOLD   TO C-ALL.
030400P    MOVE ERROR-COUNTER TO C-FAIL.
030500P    MOVE DELETE-CNT TO C-DELETED.
030600P    MOVE INSPECT-COUNTER TO C-INSPECT.
030700P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
030800PEND-E-2.
030900P    CLOSE RAW-DATA.
031000 TERMINATE-CCVS.
031100S    EXIT PROGRAM.
031200STERMINATE-CALL.
031300     STOP     RUN.
031400 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
031500 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
031600 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
031700 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
031800     MOVE "****TEST DELETED****" TO RE-MARK.
031900 PRINT-DETAIL.
032000     IF REC-CT NOT EQUAL TO ZERO
032100             MOVE "." TO PARDOT-X
032200             MOVE REC-CT TO DOTVALUE.
032300     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
032400     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
032500        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
032600          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
032700     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
032800     MOVE SPACE TO CORRECT-X.
032900     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
033000     MOVE     SPACE TO RE-MARK.
033100 HEAD-ROUTINE.
033200     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033300     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033400     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
033500 COLUMN-NAMES-ROUTINE.
033600     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033700     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
033900 END-ROUTINE.
034000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
034100 END-RTN-EXIT.
034200     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034300 END-ROUTINE-1.
034400      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
034500      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
034600      ADD PASS-COUNTER TO ERROR-HOLD.
034700*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
034800      MOVE PASS-COUNTER TO CCVS-E-4-1.
034900      MOVE ERROR-HOLD TO CCVS-E-4-2.
035000      MOVE CCVS-E-4 TO CCVS-E-2-2.
035100      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
035200  END-ROUTINE-12.
035300      MOVE "TEST(S) FAILED" TO ENDER-DESC.
035400     IF       ERROR-COUNTER IS EQUAL TO ZERO
035500         MOVE "NO " TO ERROR-TOTAL
035600         ELSE
035700         MOVE ERROR-COUNTER TO ERROR-TOTAL.
035800     MOVE     CCVS-E-2 TO DUMMY-RECORD.
035900     PERFORM WRITE-LINE.
036000 END-ROUTINE-13.
036100     IF DELETE-CNT IS EQUAL TO ZERO
036200         MOVE "NO " TO ERROR-TOTAL  ELSE
036300         MOVE DELETE-CNT TO ERROR-TOTAL.
036400     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
036500     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036600      IF   INSPECT-COUNTER EQUAL TO ZERO
036700          MOVE "NO " TO ERROR-TOTAL
036800      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
036900      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
037000      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037100     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037200 WRITE-LINE.
037300     ADD 1 TO RECORD-COUNT.
037400Y    IF RECORD-COUNT GREATER 50
037500Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
037600Y        MOVE SPACE TO DUMMY-RECORD
037700Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
037800Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
037900Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
038000Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
038100Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
038200Y        MOVE ZERO TO RECORD-COUNT.
038300     PERFORM WRT-LN.
038400 WRT-LN.
038500     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
038600     MOVE SPACE TO DUMMY-RECORD.
038700 BLANK-LINE-PRINT.
038800     PERFORM WRT-LN.
038900 FAIL-ROUTINE.
039000     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
039100     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
039200     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
039300     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039400     GO TO FAIL-ROUTINE-EX.
039500 FAIL-ROUTINE-WRITE.
039600     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
039700     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
039800 FAIL-ROUTINE-EX. EXIT.
039900 BAIL-OUT.
040000     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
040100     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
040200 BAIL-OUT-WRITE.
040300     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
040400     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040500 BAIL-OUT-EX. EXIT.
040600 CCVS1-EXIT.
040700     EXIT.
040800 SECT-SQ117A-0001 SECTION.
040900 WRITE-INIT-GF-01.
041000     MOVE "SQ-FS9" TO XFILE-NAME (1).
041100     MOVE "R1-F-G" TO XRECORD-NAME (1).
041200     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
041300     MOVE 141 TO XRECORD-LENGTH (1).
041400     MOVE "RC" TO CHARS-OR-RECORDS (1).
041500     MOVE 1 TO XBLOCK-SIZE (1).
041600     MOVE 493 TO RECORDS-IN-FILE (1).
041700     MOVE "SQ" TO XFILE-ORGANIZATION (1).
041800     MOVE "O" TO XLABEL-TYPE (1).
041900     OPEN OUTPUT SQ-FS9.
042000     MOVE "WRITE...FROM FILE" TO ALPHA-AREA.
042100 WRITE-TEST-GF-01.
042200     ADD 1 TO COUNT-OF-RECS.
042300     MOVE COUNT-OF-RECS TO XRECORD-NUMBER (1).
042400     MOVE COUNT-OF-RECS TO NUMBER-AREA.
042500     MOVE FILE-RECORD-INFO-P1-120 (1) TO AREA4-1.
042600     MOVE END-OF-RECORD-AREA TO AREA4-2.
042700     WRITE SQ-FS9R1-F-G-141 FROM WRITE-FROM-AREA4.
042800*        THIS TEST CONTAINS A WRITE RECORD FROM IDENTIFIER
042900*    STATEMENT WITH THE SIZE OF THE IDENTIFIER EQUAL TO THE SIZE
043000*    OF FILE RECORD.  THE IDENTIFIER AREA IS CHECKED AFTER THE
043100*    WRITE TO ENSURE THIS AREA WAS LEFT INTACT BY THE WRITE
043200*    STATEMENT.
043300     IF FILE-RECORD-INFO-P1-120 (1) NOT EQUAL TO AREA4-1
043400             MOVE  1 TO ERROR-FLAG.
043500     IF END-OF-RECORD-AREA NOT EQUAL TO AREA4-2
043600          MOVE 1 TO ERROR-FLAG.
043700     IF COUNT-OF-RECS EQUAL TO 50
043800         GO TO WRITE-TEST-GF-01-1.
043900     GO TO WRITE-TEST-GF-01.
044000 WRITE-TEST-GF-01-1.
044100     IF ERROR-FLAG EQUAL TO ZERO
044200          GO TO WRITE-PASS-GF-01.
044300 WRITE-FAIL-GF-01.
044400     MOVE "VII-53; 4.7.3 (4); FROM AREA DESTROYED BY WRITE"
044500            TO RE-MARK.
044600     GO TO WRITE-WRITE-GF-01.
044700 WRITE-PASS-GF-01.
044800     PERFORM PASS.
044900 WRITE-WRITE-GF-01.
045000     MOVE "WRTE-TEST-GF-01" TO PAR-NAME.
045100     MOVE "WRITE...FROM EQUAL" TO FEATURE.
045200     PERFORM PRINT-DETAIL.
045300 WRITE-INIT-GF-02-A.
045400*        THIS TEST WRITES A RECORD FROM AN IDENTIFIER WHICH IS
045500*    LARGER THAN THE SIZE OF THE FILE RECORD.  THE RIGHTMOST 7
045600*    CHARACTERS SHOULD BE TRUNCATED IN THE OUTPUT RECORD.
045700     ADD 1 TO COUNT-OF-RECS.
045800     MOVE COUNT-OF-RECS TO XRECORD-NUMBER (1).
045900     MOVE COUNT-OF-RECS TO NUMBER-AREA.
046000     MOVE FILE-RECORD-INFO-P1-120 (1) TO AREA4-1.
046100     MOVE END-OF-RECORD-AREA TO AREA4-2.
046200     MOVE WRITE-FROM-AREA4 TO AREA3-1.
046300     MOVE "ABCDEFG" TO AREA3-2.
046400     WRITE SQ-FS9R1-F-G-141 FROM WRITE-FROM-AREA3.
046500     IF COUNT-OF-RECS EQUAL TO 100
046600         GO TO WRITE-INIT-GF-03-A.
046700     GO TO WRITE-INIT-GF-02-A.
046800 WRITE-INIT-GF-03-A.
046900*        THIS TEST WRITES A RECORD FROM AN IDENTIFIER OF 87
047000*    CHARACTERS LENGTH.  IN THE OUTPUT RECORD CHARACTERS 88
047100*    THROUGH 141 SHOULD BE BLANK.  ONLY THE NUMBER OF CHARACTERS
047200*    IN THE FROM IDENTIFIER SHOULD BE MOVED TO THE OUTPUT RECORD.
047300*    THE CHARACTERS IN THE AREA FOLLOWING IDENTIFIER
047400*    ARE NOT MOVED INTO THE OUTPUT AREA.
047500     ADD 1 TO COUNT-OF-RECS.
047600     MOVE COUNT-OF-RECS TO XRECORD-NUMBER (1).
047700     MOVE FILE-RECORD-INFO-P1-120 (1) TO AREA1-1.
047800     MOVE "ZXYUVST" TO FOLLOWS-AREA1.
047900     WRITE SQ-FS9R1-F-G-141 FROM WRITE-FROM-AREA1.
048000     IF COUNT-OF-RECS EQUAL TO 150
048100         GO TO WRITE-INIT-GF-04-A.
048200     GO TO WRITE-INIT-GF-03-A.
048300 WRITE-INIT-GF-04-A.
048400*        THIS TEST WRITES A RECORD FROM AN IDENTIFIER OF 120
048500*    CHARACTERS.  THE LAST 21 CHARACTERS IN THE FD RECORD AREA
048600*    ARE SET TO JUNK WHICH SHOULD BE REPLACED WITH BLANKS DURING
048700*    THE WRITE...FROM STATEMENT.  THE IDENTIFIER IS LEVEL 02.
048800     ADD 1 TO COUNT-OF-RECS.
048900     MOVE COUNT-OF-RECS TO XRECORD-NUMBER (1).
049000     MOVE FILE-RECORD-INFO-P1-120 (1) TO AREA2-1.
049100     MOVE "AREA SHOULD BE BLANK" TO SQ-FS9R1-PART2.
049200     WRITE SQ-FS9R1-F-G-141 FROM AREA2-1.
049300     IF COUNT-OF-RECS EQUAL TO 200
049400         GO TO WRITE-INIT-GF-05-A.
049500     GO TO WRITE-INIT-GF-04-A.
049600 WRITE-INIT-GF-05-A.
049700*        THIS TEST WRITES A RECORD OF 121 CHARACTERS FROM A
049800*    SUBSCRIPTED DATA ITEM. THE LAST 21 CHARACTERS IN THE FD
049900*    RECORD AREA ARE SET TO JUNK WHICH SHOULD BE REPLACED WITH
050000*    BLANKS DURING THE WRITE...FROM STATEMENT. IDENT IS LEVEL 05.
050100     ADD 1 TO COUNT-OF-RECS.
050200     MOVE COUNT-OF-RECS TO XRECORD-NUMBER (1).
050300     MOVE "AREA SHOULD BE BLANK" TO SQ-FS9R1-PART2.
050400     WRITE SQ-FS9R1-F-G-141 FROM FILE-RECORD-INFO-P1-120 (1).
050500     IF COUNT-OF-RECS EQUAL TO 250
050600         GO TO WRITE-INIT-GF-06-A.
050700     GO TO WRITE-INIT-GF-05-A.
050800 WRITE-INIT-GF-06-A.
050900*        THIS TEST WRITES RECORDS FROM AN IDENTIFIER THE SAME
051000*    SIZE AS THE OUTPUT RECORD AREA.
051100     ADD 1 TO COUNT-OF-RECS.
051200     MOVE COUNT-OF-RECS TO XRECORD-NUMBER (1).
051300     MOVE COUNT-OF-RECS TO NUMBER-AREA.
051400     MOVE FILE-RECORD-INFO-P1-120 (1) TO AREA4-1.
051500     MOVE END-OF-RECORD-AREA TO AREA4-2.
051600     WRITE SQ-FS9R1-F-G-141 FROM WRITE-FROM-AREA4.
051700     IF COUNT-OF-RECS EQUAL TO 493
051800        GO TO WRITE-FROM-CLOSE.
051900     GO TO WRITE-INIT-GF-06-A.
052000 WRITE-FROM-CLOSE.
052100     CLOSE SQ-FS9.
052200     MOVE 0 TO ERROR-FLAG.
052300     MOVE 0 TO COUNT-OF-RECS.
052400 WRITE-INIT-GF-02.
052500     OPEN INPUT SQ-FS9.
052600 WRITE-TEST-GF-02.
052700     IF COUNT-OF-RECS EQUAL TO 50
052800         GO TO WRITE-TEST-GF-02-1.
052900     READ SQ-FS9 RECORD
053000          AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
053100                 MOVE 1 TO EOF-FLAG
053200                 GO TO WRITE-FAIL-GF-02.
053300     ADD 1 TO COUNT-OF-RECS.
053400     MOVE SQ-FS9R1-PART1 TO FILE-RECORD-INFO-P1-120 (1).
053500     MOVE SQ-FS9R1-PART2 TO END-OF-RECORD-AREA.
053600     IF ALPHA-AREA NOT EQUAL TO "WRITE...FROM FILE"
053700          GO TO WRITE-FAIL-GF-02-1.
053800     IF NUMBER-AREA NOT EQUAL TO COUNT-OF-RECS
053900          GO TO WRITE-FAIL-GF-02-1.
054000     IF XRECORD-NUMBER (1) NOT EQUAL TO COUNT-OF-RECS
054100          GO TO WRITE-FAIL-GF-02-1.
054200     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS9"
054300          GO TO WRITE-FAIL-GF-02-1.
054400     IF XLABEL-TYPE (1) NOT EQUAL TO "O"
054500          GO TO WRITE-FAIL-GF-02-1.
054600     GO TO WRITE-TEST-GF-02.
054700 WRITE-FAIL-GF-02-1.
054800     ADD 1 TO RECORDS-IN-ERROR.
054900     MOVE 1 TO ERROR-FLAG.
055000     GO TO WRITE-TEST-GF-02.
055100 WRITE-TEST-GF-02-1.
055200     IF ERROR-FLAG EQUAL TO ZERO
055300        GO TO WRITE-PASS-GF-02.
055400     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
055500 WRITE-FAIL-GF-02.
055600     MOVE "VII-53; 4.7.3 (3) LARGER RECORDS:TRUNCATED            "
055700           TO RE-MARK.
055800     PERFORM FAIL.
055900     GO TO WRITE-WRITE-GF-02.
056000 WRITE-PASS-GF-02.
056100     PERFORM PASS.
056200 WRITE-WRITE-GF-02.
056300     MOVE "WRITE .. FROM LARGER" TO FEATURE.
056400     MOVE "WRTE-TEST-GF-02" TO PAR-NAME.
056500     PERFORM PRINT-DETAIL.
056600 WRITE-INIT-GF-03.
056700     MOVE 0 TO ERROR-FLAG.
056800     IF EOF-FLAG EQUAL TO 1
056900          GO TO SEQ-EOF-22.
057000     MOVE "WRTE-TEST-GF-03" TO PAR-NAME.
057100     MOVE "WRITE ... FROP SHORTER" TO FEATURE.
057200 WRITE-TEST-GF-03.
057300     IF COUNT-OF-RECS EQUAL TO 100
057400          GO TO WRITE-TEST-GF-03-1.
057500     READ SQ-FS9 RECORD
057600          AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
057700                 MOVE 1 TO EOF-FLAG
057800                 GO TO WRITE-FAIL-GF-03.
057900     ADD 1 TO COUNT-OF-RECS.
058000     MOVE SPACE TO AREA3-2.
058100     MOVE SQ-FS9R1-F-G-141 TO WRITE-FROM-AREA3.
058200     IF AREA3-2 NOT EQUAL TO SPACE
058300          MOVE "NO TRUNCATION" TO RE-MARK
058400          GO TO WRITE-FAIL-GF-03-1.
058500     MOVE SQ-FS9R1-PART1 TO FILE-RECORD-INFO-P1-120 (1).
058600     MOVE SQ-FS9R1-PART2 TO END-OF-RECORD-AREA.
058700     IF ALPHA-AREA NOT EQUAL TO "WRITE...FROM FILE"
058800          GO TO WRITE-FAIL-GF-03-1.
058900     IF NUMBER-AREA NOT EQUAL TO COUNT-OF-RECS
059000          GO TO WRITE-FAIL-GF-03-1.
059100     IF XRECORD-NUMBER (1) NOT EQUAL TO COUNT-OF-RECS
059200          GO TO WRITE-FAIL-GF-03-1.
059300     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS9"
059400          GO TO WRITE-FAIL-GF-03-1.
059500     IF XLABEL-TYPE (1) NOT EQUAL TO "O"
059600          GO TO WRITE-FAIL-GF-03-1.
059700     GO TO WRITE-TEST-GF-03.
059800 WRITE-FAIL-GF-03-1.
059900     ADD 1 TO RECORDS-IN-ERROR.
060000     MOVE 1 TO ERROR-FLAG.
060100     GO TO WRITE-TEST-GF-03.
060200 WRITE-TEST-GF-03-1.
060300     IF ERROR-FLAG EQUAL TO ZERO
060400         GO TO WRITE-PASS-GF-03.
060500     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
060600 WRITE-FAIL-GF-03.
060700     MOVE "VII-53; 4.7.3 (3) SHORTER  RECORDS: NOT SPACE FILLED  "
060800           TO RE-MARK.
060900     PERFORM FAIL.
061000     GO TO WRITE-WRITE-GF-03.
061100 WRITE-PASS-GF-03.
061200     PERFORM PASS.
061300 WRITE-WRITE-GF-03.
061400     PERFORM PRINT-DETAIL.
061500 WRITE-INIT-GF-04.
061600     MOVE 0 TO ERROR-FLAG.
061700     IF EOF-FLAG EQUAL TO 1
061800         GO TO SEQ-EOF-22.
061900     MOVE "WRTE-TEST-GF-04" TO PAR-NAME.
062000 WRITE-TEST-GF-04.
062100     IF COUNT-OF-RECS EQUAL TO 150
062200         GO TO WRITE-TEST-GF-04-1.
062300     READ SQ-FS9 RECORD
062400          AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
062500                 MOVE 1 TO EOF-FLAG
062600                 GO TO WRITE-FAIL-GF-04.
062700     ADD 1 TO COUNT-OF-RECS.
062800     IF SQ-FS9R1-PART2 NOT EQUAL TO SPACE
062900         MOVE "NO SPACE FILLING" TO RE-MARK
063000         GO TO WRITE-FAIL-GF-04-1.
063100     MOVE SQ-FS9R1-PART1 TO FILE-RECORD-INFO-P1-120 (1).
063200     IF CHARS-OR-RECORDS (1) NOT EQUAL TO SPACE
063300         MOVE "NO SPACE FILLING" TO RE-MARK
063400         GO TO WRITE-FAIL-GF-04-1.
063500     IF XLABEL-TYPE (1) NOT EQUAL TO SPACE
063600         MOVE "NO SPACE FILLING" TO RE-MARK
063700         GO TO WRITE-FAIL-GF-04-1.
063800     IF XFILE-NAME (1) NOT EQUAL "SQ-FS9"
063900         GO TO WRITE-FAIL-GF-04-1.
064000     IF XRECORD-NUMBER (1) NOT EQUAL TO COUNT-OF-RECS
064100         GO TO WRITE-FAIL-GF-04-1.
064200     GO TO WRITE-TEST-GF-04.
064300 WRITE-FAIL-GF-04-1.
064400     ADD 1 TO RECORDS-IN-ERROR.
064500     MOVE 1 TO ERROR-FLAG.
064600     GO TO WRITE-TEST-GF-04.
064700 WRITE-TEST-GF-04-1.
064800     IF ERROR-FLAG EQUAL TO ZERO
064900         GO TO WRITE-PASS-GF-04.
065000     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
065100 WRITE-FAIL-GF-04.
065200     MOVE "VII-53; 4.7.3 (3) SHORTER RECORDS: NOT SPACE FILLED   "
065300           TO RE-MARK.
065400     PERFORM FAIL.
065500     GO TO WRITE-WRITE-GF-04.
065600 WRITE-PASS-GF-04.
065700     PERFORM PASS.
065800 WRITE-WRITE-GF-04.
065900     MOVE "WRITE ... FROM 02 SHORT RECS" TO FEATURE.
066000     PERFORM PRINT-DETAIL.
066100 WRITE-INIT-GF-05.
066200     MOVE 0 TO ERROR-FLAG.
066300     IF EOF-FLAG EQUAL TO 1
066400         GO TO SEQ-EOF-22.
066500     MOVE "WRTE-TEST-GF-05" TO PAR-NAME.
066600 WRITE-TEST-GF-05.
066700     IF COUNT-OF-RECS EQUAL TO 200
066800          GO TO WRITE-TEST-GF-05-1.
066900     READ SQ-FS9 RECORD
067000         AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
067100         MOVE 1 TO EOF-FLAG
067200         GO TO WRITE-FAIL-GF-05.
067300     ADD 1 TO COUNT-OF-RECS.
067400     IF SQ-FS9R1-PART2 NOT EQUAL TO SPACE
067500         MOVE "NOT BLANK FILLED" TO RE-MARK
067600         GO TO WRITE-FAIL-GF-05-1.
067700     MOVE SQ-FS9R1-PART1 TO FILE-RECORD-INFO-P1-120 (1).
067800     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS9"
067900         GO TO WRITE-FAIL-GF-05-1.
068000     IF XRECORD-NUMBER (1) NOT EQUAL TO COUNT-OF-RECS
068100         GO TO WRITE-FAIL-GF-05-1.
068200     IF XLABEL-TYPE (1) NOT EQUAL TO "O"
068300         GO TO WRITE-FAIL-GF-05-1.
068400     GO TO WRITE-TEST-GF-05.
068500 WRITE-FAIL-GF-05-1.
068600     ADD 1 TO RECORDS-IN-ERROR.
068700     MOVE 1 TO ERROR-FLAG.
068800     GO TO WRITE-TEST-GF-05.
068900 WRITE-TEST-GF-05-1.
069000     IF ERROR-FLAG EQUAL TO 0
069100         GO TO WRITE-PASS-GF-05.
069200     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
069300 WRITE-FAIL-GF-05.
069400     MOVE "VII-53; 4.7.3 (3) SHORTER RECORDS: NOT SPACE FILLED   "
069500           TO RE-MARK.
069600     PERFORM FAIL.
069700     GO TO WRITE-WRITE-GF-05.
069800 WRITE-PASS-GF-05.
069900     PERFORM PASS.
070000 WRITE-WRITE-GF-05.
070100     MOVE "WRITE .. FROM SHORT SUBSC 02" TO FEATURE.
070200     PERFORM PRINT-DETAIL.
070300 WRITE-INIT-GF-06.
070400     MOVE 0 TO ERROR-FLAG.
070500     IF EOF-FLAG EQUAL TO 1
070600         GO TO SEQ-EOF-22.
070700     MOVE "WRTE-TEST-GF-06" TO PAR-NAME.
070800 WRITE-TEST-GF-06.
070900     IF COUNT-OF-RECS EQUAL TO 250
071000          GO TO WRITE-TEST-GF-06-1.
071100     READ SQ-FS9 RECORD
071200          AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
071300                 MOVE 1 TO EOF-FLAG
071400                 GO TO WRITE-FAIL-GF-06.
071500     ADD 1 TO COUNT-OF-RECS.
071600     IF SQ-FS9R1-PART2 NOT EQUAL TO SPACE
071700          MOVE "NOT BLANK FILLED" TO RE-MARK
071800          GO TO WRITE-FAIL-GF-06-1.
071900     MOVE SQ-FS9R1-PART1 TO FILE-RECORD-INFO-P1-120 (1).
072000     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS9"
072100          GO TO WRITE-FAIL-GF-06-1.
072200     IF XRECORD-NUMBER (1) NOT EQUAL TO COUNT-OF-RECS
072300          GO TO WRITE-FAIL-GF-06-1.
072400     IF XLABEL-TYPE (1) NOT EQUAL TO "O"
072500          GO TO WRITE-FAIL-GF-06-1.
072600     GO TO WRITE-TEST-GF-06.
072700 WRITE-FAIL-GF-06-1.
072800     ADD 1 TO RECORDS-IN-ERROR.
072900     MOVE 1 TO ERROR-FLAG.
073000     GO TO WRITE-TEST-GF-06.
073100 WRITE-TEST-GF-06-1.
073200     IF ERROR-FLAG EQUAL TO 0
073300           GO TO WRITE-PASS-GF-06.
073400     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
073500 WRITE-FAIL-GF-06.
073600     MOVE "VII-53; 4.7.3 (3) SHORTER RECORDS: NOT SPACE FILLED   "
073700           TO RE-MARK.
073800     PERFORM FAIL.
073900     GO TO WRITE-WRITE-GF-06.
074000 WRITE-PASS-GF-06.
074100     PERFORM PASS.
074200 WRITE-WRITE-GF-06.
074300     MOVE "WRITE .. FROM SHORT SUBSC 05 " TO FEATURE.
074400     PERFORM PRINT-DETAIL.
074500 WRITE-INIT-GF-07.
074600     MOVE 0 TO ERROR-FLAG.
074700     IF EOF-FLAG EQUAL TO 1
074800         GO TO SEQ-EOF-22.
074900     MOVE "WRTE-TEST-GF-07" TO PAR-NAME.
075000 WRITE-TEST-GF-07.
075100     IF COUNT-OF-RECS EQUAL TO 493
075200          GO TO WRITE-TEST-GF-07-1.
075300     READ SQ-FS9 RECORD
075400          AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
075500          MOVE 1 TO EOF-FLAG
075600          GO TO WRITE-FAIL-GF-07.
075700     ADD 1 TO COUNT-OF-RECS.
075800     MOVE SQ-FS9R1-PART1 TO FILE-RECORD-INFO-P1-120 (1).
075900     MOVE SQ-FS9R1-PART2 TO END-OF-RECORD-AREA.
076000     IF ALPHA-AREA NOT EQUAL TO "WRITE...FROM FILE"
076100          GO TO WRITE-FAIL-GF-07-1.
076200     IF NUMBER-AREA NOT EQUAL TO COUNT-OF-RECS
076300          GO TO WRITE-FAIL-GF-07-1.
076400     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS9"
076500          GO TO WRITE-FAIL-GF-07-1.
076600     IF XRECORD-NUMBER (1) NOT EQUAL TO COUNT-OF-RECS
076700          GO TO WRITE-FAIL-GF-07-1.
076800     IF XLABEL-TYPE (1) NOT EQUAL TO "O"
076900          GO TO WRITE-FAIL-GF-07-1.
077000     GO TO WRITE-TEST-GF-07.
077100 WRITE-FAIL-GF-07-1.
077200     ADD 1 TO RECORDS-IN-ERROR.
077300     MOVE 1 TO ERROR-FLAG.
077400     GO TO WRITE-TEST-GF-07.
077500 WRITE-TEST-GF-07-1.
077600     IF ERROR-FLAG EQUAL TO ZERO
077700         GO TO WRITE-PASS-GF-07.
077800     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
077900 WRITE-FAIL-GF-07.
078000     MOVE "VII-53; 4.7.3 (3) SAME SIZE" TO RE-MARK.
078100     PERFORM FAIL.
078200     GO TO WRITE-WRITE-GF-07.
078300 WRITE-PASS-GF-07.
078400     PERFORM PASS.
078500 WRITE-WRITE-GF-07.
078600     MOVE "WRITE .. FROM SAME SIZE" TO FEATURE.
078700     PERFORM PRINT-DETAIL.
078800 SEQ-TEST-022.
078900     IF EOF-FLAG EQUAL TO 1
079000          GO TO SEQ-EOF-22.
079100     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
079200          MOVE "RECORDS IN ERROR =" TO COMPUTED-A
079300          MOVE RECORDS-IN-ERROR TO CORRECT-18V0
079400          GO TO SEQ-FAIL-22.
079500     READ SQ-FS9 RECORD
079600          AT END PERFORM PASS
079700                 GO TO SEQ-WRITE-22.
079800     MOVE "MORE THAN 493 RECORDS" TO RE-MARK.
079900     GO TO SEQ-FAIL-22.
080000 SEQ-EOF-22.
080100     MOVE "LESS THAN 493 RECORDS" TO RE-MARK.
080200     MOVE "RECORDS READ =" TO COMPUTED-A.
080300     MOVE COUNT-OF-RECS TO CORRECT-18V0.
080400 SEQ-FAIL-22.
080500     MOVE "VII-52; 4.7.2 (3)                         " TO RE-MARK.
080600     PERFORM FAIL.
080700 SEQ-WRITE-22.
080800     MOVE "READ FILE SQ-FS9" TO FEATURE.
080900     MOVE "SEQ-TEST-022" TO PAR-NAME.
081000     PERFORM PRINT-DETAIL.
081100 SEQ-CLOSE-22.
081200     CLOSE SQ-FS9.
081300 TERMINATE-ROUTINE.
081400     EXIT.
081500 CCVS-EXIT SECTION.
081600 CCVS-999999.
081700     GO TO CLOSE-FILES.
