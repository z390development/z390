000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IC216A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*    THIS IS MAIN PROGRAM IC216.
002200****************************************************************
002300 ENVIRONMENT DIVISION.
002400 CONFIGURATION SECTION.
002500 SOURCE-COMPUTER.
002600     XXXXX082.
002700 OBJECT-COMPUTER.
002800     XXXXX083.
002900 INPUT-OUTPUT SECTION.
003000 FILE-CONTROL.
003100     SELECT PRINT-FILE ASSIGN TO
003200     XXXXX055.
003300 DATA DIVISION.
003400 FILE SECTION.
003500 FD  PRINT-FILE.
003600 01  PRINT-REC PICTURE X(120).
003700 01  DUMMY-RECORD PICTURE X(120).
003800 WORKING-STORAGE SECTION.
003900 01  DN1.
004000     02  DN2                     PICTURE X(5).
004100     02  DN3                     REDEFINES DN2   PICTURE 9(5).
004200 01  DN4.
004300     02  DN5.
004400          03  DN6                 PICTURE X(3).
004500         03  DN7                 PICTURE X(3).
004600         03  DN8                 REDEFINES DN7   PICTURE 9(3).
004700     02  DN9                     PICTURE XX.
004800 01  TEST-RESULTS.
004900     02 FILLER                   PIC X      VALUE SPACE.
005000     02 FEATURE                  PIC X(20)  VALUE SPACE.
005100     02 FILLER                   PIC X      VALUE SPACE.
005200     02 P-OR-F                   PIC X(5)   VALUE SPACE.
005300     02 FILLER                   PIC X      VALUE SPACE.
005400     02  PAR-NAME.
005500       03 FILLER                 PIC X(19)  VALUE SPACE.
005600       03  PARDOT-X              PIC X      VALUE SPACE.
005700       03 DOTVALUE               PIC 99     VALUE ZERO.
005800     02 FILLER                   PIC X(8)   VALUE SPACE.
005900     02 RE-MARK                  PIC X(61).
006000 01  TEST-COMPUTED.
006100     02 FILLER                   PIC X(30)  VALUE SPACE.
006200     02 FILLER                   PIC X(17)  VALUE
006300            "       COMPUTED=".
006400     02 COMPUTED-X.
006500     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
006600     03 COMPUTED-N               REDEFINES COMPUTED-A
006700                                 PIC -9(9).9(9).
006800     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
006900     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
007000     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
007100     03       CM-18V0 REDEFINES COMPUTED-A.
007200         04 COMPUTED-18V0                    PIC -9(18).
007300         04 FILLER                           PIC X.
007400     03 FILLER PIC X(50) VALUE SPACE.
007500 01  TEST-CORRECT.
007600     02 FILLER PIC X(30) VALUE SPACE.
007700     02 FILLER PIC X(17) VALUE "       CORRECT =".
007800     02 CORRECT-X.
007900     03 CORRECT-A                  PIC X(20) VALUE SPACE.
008000     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
008100     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
008200     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
008300     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
008400     03      CR-18V0 REDEFINES CORRECT-A.
008500         04 CORRECT-18V0                     PIC -9(18).
008600         04 FILLER                           PIC X.
008700     03 FILLER PIC X(2) VALUE SPACE.
008800     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
008900 01  CCVS-C-1.
009000     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
009100-    "SS  PARAGRAPH-NAME
009200-    "       REMARKS".
009300     02 FILLER                     PIC X(20)    VALUE SPACE.
009400 01  CCVS-C-2.
009500     02 FILLER                     PIC X        VALUE SPACE.
009600     02 FILLER                     PIC X(6)     VALUE "TESTED".
009700     02 FILLER                     PIC X(15)    VALUE SPACE.
009800     02 FILLER                     PIC X(4)     VALUE "FAIL".
009900     02 FILLER                     PIC X(94)    VALUE SPACE.
010000 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
010100 01  REC-CT                        PIC 99       VALUE ZERO.
010200 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
010300 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
010400 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
010500 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
010600 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
010700 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
010800 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
010900 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
011000 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
011100 01  CCVS-H-1.
011200     02  FILLER                    PIC X(39)    VALUE SPACES.
011300     02  FILLER                    PIC X(42)    VALUE
011400     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
011500     02  FILLER                    PIC X(39)    VALUE SPACES.
011600 01  CCVS-H-2A.
011700   02  FILLER                        PIC X(40)  VALUE SPACE.
011800   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
011900   02  FILLER                        PIC XXXX   VALUE
012000     "4.2 ".
012100   02  FILLER                        PIC X(28)  VALUE
012200            " COPY - NOT FOR DISTRIBUTION".
012300   02  FILLER                        PIC X(41)  VALUE SPACE.
012400
012500 01  CCVS-H-2B.
012600   02  FILLER                        PIC X(15)  VALUE
012700            "TEST RESULT OF ".
012800   02  TEST-ID                       PIC X(9).
012900   02  FILLER                        PIC X(4)   VALUE
013000            " IN ".
013100   02  FILLER                        PIC X(12)  VALUE
013200     " HIGH       ".
013300   02  FILLER                        PIC X(22)  VALUE
013400            " LEVEL VALIDATION FOR ".
013500   02  FILLER                        PIC X(58)  VALUE
013600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
013700 01  CCVS-H-3.
013800     02  FILLER                      PIC X(34)  VALUE
013900            " FOR OFFICIAL USE ONLY    ".
014000     02  FILLER                      PIC X(58)  VALUE
014100     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
014200     02  FILLER                      PIC X(28)  VALUE
014300            "  COPYRIGHT   1985 ".
014400 01  CCVS-E-1.
014500     02 FILLER                       PIC X(52)  VALUE SPACE.
014600     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
014700     02 ID-AGAIN                     PIC X(9).
014800     02 FILLER                       PIC X(45)  VALUE SPACES.
014900 01  CCVS-E-2.
015000     02  FILLER                      PIC X(31)  VALUE SPACE.
015100     02  FILLER                      PIC X(21)  VALUE SPACE.
015200     02 CCVS-E-2-2.
015300         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
015400         03 FILLER                   PIC X      VALUE SPACE.
015500         03 ENDER-DESC               PIC X(44)  VALUE
015600            "ERRORS ENCOUNTERED".
015700 01  CCVS-E-3.
015800     02  FILLER                      PIC X(22)  VALUE
015900            " FOR OFFICIAL USE ONLY".
016000     02  FILLER                      PIC X(12)  VALUE SPACE.
016100     02  FILLER                      PIC X(58)  VALUE
016200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
016300     02  FILLER                      PIC X(13)  VALUE SPACE.
016400     02 FILLER                       PIC X(15)  VALUE
016500             " COPYRIGHT 1985".
016600 01  CCVS-E-4.
016700     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
016800     02 FILLER                       PIC X(4)   VALUE " OF ".
016900     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
017000     02 FILLER                       PIC X(40)  VALUE
017100      "  TESTS WERE EXECUTED SUCCESSFULLY".
017200 01  XXINFO.
017300     02 FILLER                       PIC X(19)  VALUE
017400            "*** INFORMATION ***".
017500     02 INFO-TEXT.
017600       04 FILLER                     PIC X(8)   VALUE SPACE.
017700       04 XXCOMPUTED                 PIC X(20).
017800       04 FILLER                     PIC X(5)   VALUE SPACE.
017900       04 XXCORRECT                  PIC X(20).
018000     02 INF-ANSI-REFERENCE           PIC X(48).
018100 01  HYPHEN-LINE.
018200     02 FILLER  PIC IS X VALUE IS SPACE.
018300     02 FILLER  PIC IS X(65)    VALUE IS "************************
018400-    "*****************************************".
018500     02 FILLER  PIC IS X(54)    VALUE IS "************************
018600-    "******************************".
018700 01  CCVS-PGM-ID                     PIC X(9)   VALUE
018800     "IC216A".
018900 PROCEDURE DIVISION.
019000 CCVS1 SECTION.
019100 OPEN-FILES.
019200     OPEN     OUTPUT PRINT-FILE.
019300     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
019400     MOVE    SPACE TO TEST-RESULTS.
019500     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
019600     GO TO CCVS1-EXIT.
019700 CLOSE-FILES.
019800     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
019900 TERMINATE-CCVS.
020000S    EXIT PROGRAM.
020100STERMINATE-CALL.
020200     STOP     RUN.
020300 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
020400 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
020500 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
020600 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
020700     MOVE "****TEST DELETED****" TO RE-MARK.
020800 PRINT-DETAIL.
020900     IF REC-CT NOT EQUAL TO ZERO
021000             MOVE "." TO PARDOT-X
021100             MOVE REC-CT TO DOTVALUE.
021200     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
021300     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
021400        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
021500          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
021600     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
021700     MOVE SPACE TO CORRECT-X.
021800     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
021900     MOVE     SPACE TO RE-MARK.
022000 HEAD-ROUTINE.
022100     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
022200     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
022300     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
022400     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
022500 COLUMN-NAMES-ROUTINE.
022600     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
022700     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
022800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
022900 END-ROUTINE.
023000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
023100 END-RTN-EXIT.
023200     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023300 END-ROUTINE-1.
023400      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
023500      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
023600      ADD PASS-COUNTER TO ERROR-HOLD.
023700*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
023800      MOVE PASS-COUNTER TO CCVS-E-4-1.
023900      MOVE ERROR-HOLD TO CCVS-E-4-2.
024000      MOVE CCVS-E-4 TO CCVS-E-2-2.
024100      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
024200  END-ROUTINE-12.
024300      MOVE "TEST(S) FAILED" TO ENDER-DESC.
024400     IF       ERROR-COUNTER IS EQUAL TO ZERO
024500         MOVE "NO " TO ERROR-TOTAL
024600         ELSE
024700         MOVE ERROR-COUNTER TO ERROR-TOTAL.
024800     MOVE     CCVS-E-2 TO DUMMY-RECORD.
024900     PERFORM WRITE-LINE.
025000 END-ROUTINE-13.
025100     IF DELETE-COUNTER IS EQUAL TO ZERO
025200         MOVE "NO " TO ERROR-TOTAL  ELSE
025300         MOVE DELETE-COUNTER TO ERROR-TOTAL.
025400     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
025500     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025600      IF   INSPECT-COUNTER EQUAL TO ZERO
025700          MOVE "NO " TO ERROR-TOTAL
025800      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
025900      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
026000      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026100     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026200 WRITE-LINE.
026300     ADD 1 TO RECORD-COUNT.
026400Y    IF RECORD-COUNT GREATER 50
026500Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
026600Y        MOVE SPACE TO DUMMY-RECORD
026700Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
026800Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
026900Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
027000Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
027100Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
027200Y        MOVE ZERO TO RECORD-COUNT.
027300     PERFORM WRT-LN.
027400 WRT-LN.
027500     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
027600     MOVE SPACE TO DUMMY-RECORD.
027700 BLANK-LINE-PRINT.
027800     PERFORM WRT-LN.
027900 FAIL-ROUTINE.
028000     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
028100     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
028200     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
028300     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
028400     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028500     MOVE   SPACES TO INF-ANSI-REFERENCE.
028600     GO TO  FAIL-ROUTINE-EX.
028700 FAIL-ROUTINE-WRITE.
028800     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
028900     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
029000     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
029100     MOVE   SPACES TO COR-ANSI-REFERENCE.
029200 FAIL-ROUTINE-EX. EXIT.
029300 BAIL-OUT.
029400     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
029500     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
029600 BAIL-OUT-WRITE.
029700     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
029800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
029900     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030000     MOVE   SPACES TO INF-ANSI-REFERENCE.
030100 BAIL-OUT-EX. EXIT.
030200 CCVS1-EXIT.
030300     EXIT.
030400 CALL-TEST-1.
030500     MOVE "CALL...USING DATA-NM" TO FEATURE.
030600     MOVE "CALL-TEST-1" TO PAR-NAME.
030700     MOVE "REFERENCING REDEFINED DATA-NAMES" TO RE-MARK.
030800     CALL "IC217A" USING DN1, DN4.
030900     IF DN1 = 12345
031000        PERFORM PASS
031100        GO TO CALL-WRITE-1.
031200 CALL-FAIL-1.
031300     MOVE DN1 TO COMPUTED-A.
031400     MOVE 12345 TO CORRECT-A.
031500     PERFORM FAIL.
031600 CALL-WRITE-1.
031700     PERFORM PRINT-DETAIL.
031800 CALL-TEST-2.
031900     MOVE "CALL...USING DATA-NM" TO FEATURE.
032000     MOVE "CALL-TEST-2" TO PAR-NAME.
032100     MOVE "REFERENCING REDEFINED DATA-NAMES" TO RE-MARK.
032200     IF DN4 = "YES987NO"
032300        PERFORM PASS
032400        GO TO CALL-WRITE-2.
032500 CALL-FAIL-2.
032600     MOVE DN4 TO COMPUTED-A.
032700     MOVE "YES987NO" TO CORRECT-A.
032800     PERFORM FAIL.
032900 CALL-WRITE-2.
033000     PERFORM PRINT-DETAIL.
033100 CCVS-EXIT SECTION.
033200 CCVS-999999.
033300     GO TO CLOSE-FILES.
