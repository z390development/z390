000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST144A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*
001400*    OBJECTIVE -
001500*        ROUTINE ST144A IS A TEST OF THE MERGE STATEMENT USING
001600*    A NATIVE  COLLATING SEQUENCE AND MULTIPLE FILE TAPE.
001700*    THIS ROUTINE IS A TEST OF THE COMPILERS ABILITY TO MERGE
001800*    THE SECOND FILE OF A MULTI-FILE REEL WITH A MASS-STORAGE
001900*    FILE TO PRODUCE A MASS-STORAGE FILE.
002000*
002100*
002200*    FEATURES TESTED -
002300*    *   MULTIPLE FILE TAPE
002400*    *   FIXED LENGTH RECORDS
002500*    *   SAME SORT AREA IN THE I-O-CONTROL PARAGRAPH
002600*    *   QUALIFIED ALPHANUMERIC AND NUMERIC SORT KEYS
002700*    *   USING FILE-NAME SERIES
002800*    *   OUTPUT PROCEDURE IS SECTION-NAME
002900*    *   RETURN RECORD INTO     PART OF THE OUTPUT PROCEDURE
003000*
003100*    *   MERGE MERGE-FILE-NAME
003200*        ON DESCENDING KEY KEY-1 OF DATA-NAME-1
003300*        ASCENDING KEY-2 OF DATA-NAME-2
003400*        USING  FILE-NAME-2, FILE-NAME-3
003500*        OUTPUT PROCEDURE IS SECTION-NAME.
003600*
003700*
003800*    FILES USED -
003900*    *   FILES SQ-FS1 AND SQ-FS3 ARE WRITTEN ONTO A MULTIPLE
004000*    FILE TAPE.  FILE SQ-FS2 IS WRITTEN ONTO MASS-STORAGE.
004100*    THEN THE MERGE STATEMENT USES SQ-FS3 AND SQ-FS2 TO CREATE  A
004200*    NEW MASS-STORAGE FILE SQ-FS4.  ALL FILES HAVE FIXED LENGTH
004300*    RECORDS AND 132 CHARACTERS PER RECORD.
004400*
004500*        SQ-FS1
004600*    51 RECORDS
004700*    FIXED LENGTH RECORDS 132 CHARACTERS
004800*    BLOCKED 1
004900*    RESERVE 2 AREAS
005000*
005100*        SQ-FS2
005200*    51 RECORDS
005300*    FIXED LENGTH RECORDS 132 CHARACTERS
005400*    BLOCKED 2
005500*    RESERVE 4 AREAS
005600*
005700*        SQ-FS3
005800*    51 RECORDS
005900*    FIXED LENGTH RECORDS 132 CHARACTERS
006000*    BLOCKED 1
006100*    RESERVE 6 AREAS
006200*
006300*        NOTE THAT FILE SQ-FS3 IS THE SECOND POSITION
006400*    ON A MULTIPLE FILE TAPE.  BOTH FILES SQ-FS1 AND SQ-FS3 ARE
006500*    ON THE SAME MULTIPLE FILE TAPE.
006600*
006700*        SQ-FS4
006800*    FINAL TOTAL OF 102 RECORDS AS A RESULT OF THE MERGE
006900*    FIXED LENGTH RECORDS 132 CHARACTERS
007000*    BLOCKED 3
007100*    RESERVE 4 AREAS
007200*
007300*
007400*    X-CARDS USED  -
007500*    X-XXX008     SQ-FS1
007600*    X-XXX014     SQ-FS2
007700*    X-XXX009     SQ-FS3
007800*    X-XXX015     SQ-FS4
007900*    X-XXX027     MERGE FILE ST-FS1
008000*    X-55         SYSTEM PRINTER NAME.
008100*    X-XXX064     NATIVE COLLATING SEQUENCE DESCENDING ORDER-NOTE
008200*        THAT THE QUOTE CHARACTER IS NOT TO APPEAR IN THE X-64
008300*        CARD AND THE DOLLAR SIGN $ IS TO APPEAR TWICE WHEREVER
008400*        THE $ BELONGS IN THE NATIVE COLLATING SEQUENCE).  IF
008500*        THE NATIVE COLLATING SEQUENCE IS ACTUALLY THE ASCII
008600*        COLLATING SEQUENCE SEE BELOW FOR A SAMPLE X-64 CARD.....
008700*
008800*    X-64  "ZYXWVUTSRQPONMLKJIHGFEDCBA>=<;9876543210/.-,+*)($$ ".
008900*    X-82         SOURCE COMPUTER NAME.
009000*    X-83         OBJECT COMPUTER NAME.
009100*
009200*
009300*    OPTIONS RECOMMENDED -
009400*    *   *OPT8  X  TO BE USED IF NECESSARY TO DUMP THE
009500*                  FILES AS THEY ARE CREATED AND READ DURING
009600*                  MRG-TESTS 3 THRU 8.
009700*
009800*
009900*    TEST DESCRIPTIONS -
010000*    BLD-TEST-001     CHECKS THE CREATION OF SQ-FS1
010100*    BLD-TEST-002     CHECKS THE CREATION OF SQ-FS2
010200*    BLD-TEST-003     CHECKS THE CREATION OF SQ-FS3
010300*    MRG-TEST-003     TESTS RECORDS 1-20 ON MERGE RESULT SQ-FS4
010400*    MRG-TEST-004     TESTS RECORDS 21-40 ON MERGE RESULT SQ-FS4
010500*    MRG-TEST-005     TESTS RECORDS 41-60 ON MERGE RESULT SQ-FS4
010600*    MRG-TEST-006     TESTS RECORDS 61-80 ON MERGE RESULT SQ-FS4
010700*    MRG-TEST-007     TESTS RECORDS 81-100 ON MERGE RESULT SQ-FS4
010800*    MRG-TEST-008     TESTS RECORDS 101-102 ON MERGE RESULT SQ-FS4
010900*    MRG-TEST-009     AN EOF CHECK ON SQ-FS4
011000*    MRG-TEST-010     CHECK THAT THE NUMERIC KEY ON THE LAST
011100*                     RECORD ON SQ-FS4 EQUALS 102
011200*
011300*
011400*    ************************************************************
011500 ENVIRONMENT DIVISION.
011600 CONFIGURATION SECTION.
011700 SOURCE-COMPUTER.
011800     XXXXX082.
011900 OBJECT-COMPUTER.
012000     XXXXX083.
012100 INPUT-OUTPUT SECTION.
012200 FILE-CONTROL.
012300     SELECT PRINT-FILE ASSIGN TO
012400     XXXXX055.
012500     SELECT SQ-FS1 ASSIGN
012600     XXXXX008
012700     ; ORGANIZATION IS SEQUENTIAL
012800     ACCESS MODE SEQUENTIAL
012900     RESERVE 2 AREAS.
013000     SELECT SQ-FS2 ASSIGN TO
013100     XXXXX014
013200     ORGANIZATION IS SEQUENTIAL
013300     ACCESS MODE IS SEQUENTIAL
013400     RESERVE 4 AREAS.
013500     SELECT SQ-FS3 ASSIGN TO
013600     XXXXX009
013700     ORGANIZATION SEQUENTIAL
013800     ; ACCESS MODE IS SEQUENTIAL
013900     RESERVE 6 AREAS.
014000     SELECT SQ-FS4 ASSIGN TO
014100     XXXXX015
014200     ORGANIZATION IS SEQUENTIAL
014300     ; ACCESS MODE IS SEQUENTIAL
014400     RESERVE 4 AREAS.
014500     SELECT ST-FS1 ASSIGN TO
014600     XXXXX027.
014700 I-O-CONTROL.
014800     SAME SORT AREA FOR SQ-FS1 ST-FS1,
014900     MULTIPLE FILE TAPE CONTAINS SQ-FS1 POSITION 1
015000     SQ-FS3 POSITION 2.
015100 DATA DIVISION.
015200 FILE SECTION.
015300 FD  PRINT-FILE.
015400 01  PRINT-REC PICTURE X(120).
015500 01  DUMMY-RECORD PICTURE X(120).
015600 FD  SQ-FS1
015700     LABEL RECORDS STANDARD
015800C    VALUE OF
015900C    XXXXX074
016000C    IS
016100C    XXXXX075
016200G    XXXXX069
016300     BLOCK CONTAINS 1 RECORDS
016400     RECORD CONTAINS 132 CHARACTERS
016500     DATA RECORDS SQ-FS1R1-F-G-132, SQ-FS1R2-F-G-132.
016600 01  SQ-FS1R1-F-G-132.
016700     10 REC-PREAMBLE PIC X(120).
016800     10 REST-OF-1.
016900     20 KEY-1.
017000         30 ALPHAN-KEY PIC X.
017100         30 NUM-KEY PIC 999.
017200     20 KEY-2.
017300         30 ALPHAN-KEY PIC X.
017400         30 NUM-KEY PIC 999.
017500     20 KEY-3.
017600         30 ALPHAN-KEY PIC X.
017700         30 NUM-KEY PIC 999.
017800 01  SQ-FS1R2-F-G-132.
017900     02 FILLER PIC X(120).
018000     02 GARBAGE PIC X(12).
018100 FD  SQ-FS2
018200     LABEL RECORD STANDARD
018300C    VALUE OF
018400C    XXXXX074
018500C    IS
018600C    XXXXX076
018700G    XXXXX069
018800     BLOCK CONTAINS 2 RECORDS
018900     RECORD CONTAINS 132 CHARACTERS
019000     DATA RECORD SQ-FS2R1-F-G-132.
019100 01  SQ-FS2R1-F-G-132.
019200     10 REC-PRE-2 PIC X(120).
019300     10 REST-OF-2.
019400     20 KEY-4.
019500         30 ALPHAN-KEY PIC X.
019600         30 NUM-KEY PIC 999.
019700     20 KEY-5.
019800         30 ALPHAN-KEY PIC X.
019900         30 NUM-KEY PIC 999.
020000     20 KEY-6.
020100         30 ALPHAN-KEY PIC X.
020200         30 NUM-KEY PIC 999.
020300 FD  SQ-FS3
020400     LABEL RECORDS STANDARD
020500C    VALUE OF
020600C    XXXXX074
020700C    IS
020800C    XXXXX077
020900G    XXXXX069
021000     BLOCK CONTAINS 1 RECORDS
021100     RECORD CONTAINS 132 CHARACTERS
021200     DATA RECORD SQ-FS3R1-F-G-132.
021300 01  SQ-FS3R1-F-G-132.
021400     10 REC-PRE-3 PIC X(120).
021500     10 REST-OF-3.
021600     20 KEY-7.
021700         30 ALPHAN-KEY PIC X.
021800         30 NUM-KEY PIC 999.
021900     20 KEY-8.
022000         30 ALPHAN-KEY PIC X.
022100         30 NUM-KEY PIC 999.
022200     20 KEY-9.
022300         30 ALPHAN-KEY PIC X.
022400         30 NUM-KEY PIC 999.
022500 FD  SQ-FS4
022600     LABEL RECORD IS STANDARD
022700C    ; VALUE OF
022800C    XXXXX074
022900C    IS
023000C    XXXXX078
023100G    XXXXX069
023200     ; BLOCK CONTAINS 3 RECORDS
023300     RECORD CONTAINS 132 CHARACTERS
023400     DATA RECORD SQ-FS4R1-F-G-132.
023500 01  SQ-FS4R1-F-G-132.
023600     10  REC-PRE-4 PIC X(120).
023700     10  REST-OF-4.
023800     20  KEY-10.
023900          30  ALPHAN-KEY PIC X.
024000          30  NUM-KEY PIC 999.
024100     20  KEY-11.
024200          30  ALPHAN-KEY PIC X.
024300          30  NUM-KEY PIC 999.
024400     20  KEY-12.
024500          30  ALPHAN-KEY PIC X.
024600          30  NUM-KEY PIC 999.
024700 SD  ST-FS1
024800     RECORD CONTAINS 132 CHARACTERS
024900     DATA RECORD IS ST-FS1R1-F-G-132.
025000 01  ST-FS1R1-F-G-132.
025100     02 FILLER PIC X(120).
025200     02 NON-KEY-1.
025300         03 A-KEY PIC X.
025400         03 N-KEY PIC 999.
025500     02 SORT-KEY.
025600         03 A-KEY PIC X.
025700         03 N-KEY PIC 999.
025800     02 NON-KEY-2.
025900         03 A-KEY PIC X.
026000         03 N-KEY PIC 999.
026100 WORKING-STORAGE SECTION.
026200 77  WRK-DU-9-0001 PIC 9 VALUE 0.
026300 77  WRK-DU-999-0001 PIC 999.
026400 77  WRK-DU-999-2 PIC 999 VALUE 001.
026500 77  LAST-REC-NUM  PIC 999 VALUE ZERO.
026600 01  WRK-XN-0001 PIC X(51) VALUE
026700     XXXXX064.
026800 01  WRK-XN-O051F-X-0001 REDEFINES WRK-XN-0001.
026900     02 CHAR PIC X OCCURS 51 TIMES.
027000 01  WRK-XN-2    PIC X(51) VALUE
027100     XXXXX064.
027200 01  WRK-XN-0051F-X-0002 REDEFINES WRK-XN-2.
027300     02 ASCIIS PIC X OCCURS 51 TIMES.
027400 01  WRK-XN-O020F-0001.
027500     02 COMPU PIC X OCCURS 20 TIMES.
027600 01  WRK-XN-X-0001 REDEFINES WRK-XN-O020F-0001.
027700     02 FILLER PIC X(20).
027800 01  WRK-XN-O120F-1.
027900     02 COLLS PIC X OCCURS 120 TIMES.
028000 01  WRK-XN-X-2 REDEFINES WRK-XN-O120F-1.
028100     02 WRK-XN-0002 PIC X(20).
028200     02 WRK-XN-0003 PIC X(20).
028300     02 WRK-XN-0004 PIC X(20).
028400     02 WRK-XN-0005 PIC X(20).
028500     02 WRK-XN-0006 PIC X(20).
028600     02 WRK-XN-0007 PIC X(20).
028700 01  FILE-RECORD-INFORMATION-REC.
028800     03 FILE-RECORD-INFO-SKELETON.
028900        05 FILLER                 PICTURE X(48)       VALUE
029000             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
029100        05 FILLER                 PICTURE X(46)       VALUE
029200             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
029300        05 FILLER                 PICTURE X(26)       VALUE
029400             ",LFIL=000000,ORG=  ,LBLR= ".
029500        05 FILLER                 PICTURE X(37)       VALUE
029600             ",RECKEY=                             ".
029700        05 FILLER                 PICTURE X(38)       VALUE
029800             ",ALTKEY1=                             ".
029900        05 FILLER                 PICTURE X(38)       VALUE
030000             ",ALTKEY2=                             ".
030100        05 FILLER                 PICTURE X(7)        VALUE SPACE.
030200     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
030300        05 FILE-RECORD-INFO-P1-120.
030400           07 FILLER              PIC X(5).
030500           07 XFILE-NAME           PIC X(6).
030600           07 FILLER              PIC X(8).
030700           07 XRECORD-NAME         PIC X(6).
030800           07 FILLER              PIC X(1).
030900           07 REELUNIT-NUMBER     PIC 9(1).
031000           07 FILLER              PIC X(7).
031100           07 XRECORD-NUMBER       PIC 9(6).
031200           07 FILLER              PIC X(6).
031300           07 UPDATE-NUMBER       PIC 9(2).
031400           07 FILLER              PIC X(5).
031500           07 ODO-NUMBER          PIC 9(4).
031600           07 FILLER              PIC X(5).
031700           07 XPROGRAM-NAME        PIC X(5).
031800           07 FILLER              PIC X(7).
031900           07 XRECORD-LENGTH       PIC 9(6).
032000           07 FILLER              PIC X(7).
032100           07 CHARS-OR-RECORDS    PIC X(2).
032200           07 FILLER              PIC X(1).
032300           07 XBLOCK-SIZE          PIC 9(4).
032400           07 FILLER              PIC X(6).
032500           07 RECORDS-IN-FILE     PIC 9(6).
032600           07 FILLER              PIC X(5).
032700           07 XFILE-ORGANIZATION   PIC X(2).
032800           07 FILLER              PIC X(6).
032900           07 XLABEL-TYPE          PIC X(1).
033000        05 FILE-RECORD-INFO-P121-240.
033100           07 FILLER              PIC X(8).
033200           07 XRECORD-KEY          PIC X(29).
033300           07 FILLER              PIC X(9).
033400           07 ALTERNATE-KEY1      PIC X(29).
033500           07 FILLER              PIC X(9).
033600           07 ALTERNATE-KEY2      PIC X(29).
033700           07 FILLER              PIC X(7).
033800 01  TEST-RESULTS.
033900     02 FILLER                   PIC X      VALUE SPACE.
034000     02 FEATURE                  PIC X(20)  VALUE SPACE.
034100     02 FILLER                   PIC X      VALUE SPACE.
034200     02 P-OR-F                   PIC X(5)   VALUE SPACE.
034300     02 FILLER                   PIC X      VALUE SPACE.
034400     02  PAR-NAME.
034500       03 FILLER                 PIC X(19)  VALUE SPACE.
034600       03  PARDOT-X              PIC X      VALUE SPACE.
034700       03 DOTVALUE               PIC 99     VALUE ZERO.
034800     02 FILLER                   PIC X(8)   VALUE SPACE.
034900     02 RE-MARK                  PIC X(61).
035000 01  TEST-COMPUTED.
035100     02 FILLER                   PIC X(30)  VALUE SPACE.
035200     02 FILLER                   PIC X(17)  VALUE
035300            "       COMPUTED=".
035400     02 COMPUTED-X.
035500     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
035600     03 COMPUTED-N               REDEFINES COMPUTED-A
035700                                 PIC -9(9).9(9).
035800     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
035900     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
036000     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
036100     03       CM-18V0 REDEFINES COMPUTED-A.
036200         04 COMPUTED-18V0                    PIC -9(18).
036300         04 FILLER                           PIC X.
036400     03 FILLER PIC X(50) VALUE SPACE.
036500 01  TEST-CORRECT.
036600     02 FILLER PIC X(30) VALUE SPACE.
036700     02 FILLER PIC X(17) VALUE "       CORRECT =".
036800     02 CORRECT-X.
036900     03 CORRECT-A                  PIC X(20) VALUE SPACE.
037000     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
037100     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
037200     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
037300     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
037400     03      CR-18V0 REDEFINES CORRECT-A.
037500         04 CORRECT-18V0                     PIC -9(18).
037600         04 FILLER                           PIC X.
037700     03 FILLER PIC X(2) VALUE SPACE.
037800     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
037900 01  CCVS-C-1.
038000     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
038100-    "SS  PARAGRAPH-NAME
038200-    "       REMARKS".
038300     02 FILLER                     PIC X(20)    VALUE SPACE.
038400 01  CCVS-C-2.
038500     02 FILLER                     PIC X        VALUE SPACE.
038600     02 FILLER                     PIC X(6)     VALUE "TESTED".
038700     02 FILLER                     PIC X(15)    VALUE SPACE.
038800     02 FILLER                     PIC X(4)     VALUE "FAIL".
038900     02 FILLER                     PIC X(94)    VALUE SPACE.
039000 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
039100 01  REC-CT                        PIC 99       VALUE ZERO.
039200 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
039300 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
039400 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
039500 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
039600 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
039700 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
039800 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
039900 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
040000 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
040100 01  CCVS-H-1.
040200     02  FILLER                    PIC X(39)    VALUE SPACES.
040300     02  FILLER                    PIC X(42)    VALUE
040400     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
040500     02  FILLER                    PIC X(39)    VALUE SPACES.
040600 01  CCVS-H-2A.
040700   02  FILLER                        PIC X(40)  VALUE SPACE.
040800   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
040900   02  FILLER                        PIC XXXX   VALUE
041000     "4.2 ".
041100   02  FILLER                        PIC X(28)  VALUE
041200            " COPY - NOT FOR DISTRIBUTION".
041300   02  FILLER                        PIC X(41)  VALUE SPACE.
041400
041500 01  CCVS-H-2B.
041600   02  FILLER                        PIC X(15)  VALUE
041700            "TEST RESULT OF ".
041800   02  TEST-ID                       PIC X(9).
041900   02  FILLER                        PIC X(4)   VALUE
042000            " IN ".
042100   02  FILLER                        PIC X(12)  VALUE
042200     " HIGH       ".
042300   02  FILLER                        PIC X(22)  VALUE
042400            " LEVEL VALIDATION FOR ".
042500   02  FILLER                        PIC X(58)  VALUE
042600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
042700 01  CCVS-H-3.
042800     02  FILLER                      PIC X(34)  VALUE
042900            " FOR OFFICIAL USE ONLY    ".
043000     02  FILLER                      PIC X(58)  VALUE
043100     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
043200     02  FILLER                      PIC X(28)  VALUE
043300            "  COPYRIGHT   1985 ".
043400 01  CCVS-E-1.
043500     02 FILLER                       PIC X(52)  VALUE SPACE.
043600     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
043700     02 ID-AGAIN                     PIC X(9).
043800     02 FILLER                       PIC X(45)  VALUE SPACES.
043900 01  CCVS-E-2.
044000     02  FILLER                      PIC X(31)  VALUE SPACE.
044100     02  FILLER                      PIC X(21)  VALUE SPACE.
044200     02 CCVS-E-2-2.
044300         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
044400         03 FILLER                   PIC X      VALUE SPACE.
044500         03 ENDER-DESC               PIC X(44)  VALUE
044600            "ERRORS ENCOUNTERED".
044700 01  CCVS-E-3.
044800     02  FILLER                      PIC X(22)  VALUE
044900            " FOR OFFICIAL USE ONLY".
045000     02  FILLER                      PIC X(12)  VALUE SPACE.
045100     02  FILLER                      PIC X(58)  VALUE
045200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
045300     02  FILLER                      PIC X(13)  VALUE SPACE.
045400     02 FILLER                       PIC X(15)  VALUE
045500             " COPYRIGHT 1985".
045600 01  CCVS-E-4.
045700     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
045800     02 FILLER                       PIC X(4)   VALUE " OF ".
045900     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
046000     02 FILLER                       PIC X(40)  VALUE
046100      "  TESTS WERE EXECUTED SUCCESSFULLY".
046200 01  XXINFO.
046300     02 FILLER                       PIC X(19)  VALUE
046400            "*** INFORMATION ***".
046500     02 INFO-TEXT.
046600       04 FILLER                     PIC X(8)   VALUE SPACE.
046700       04 XXCOMPUTED                 PIC X(20).
046800       04 FILLER                     PIC X(5)   VALUE SPACE.
046900       04 XXCORRECT                  PIC X(20).
047000     02 INF-ANSI-REFERENCE           PIC X(48).
047100 01  HYPHEN-LINE.
047200     02 FILLER  PIC IS X VALUE IS SPACE.
047300     02 FILLER  PIC IS X(65)    VALUE IS "************************
047400-    "*****************************************".
047500     02 FILLER  PIC IS X(54)    VALUE IS "************************
047600-    "******************************".
047700 01  CCVS-PGM-ID                     PIC X(9)   VALUE
047800     "ST144A".
047900 PROCEDURE DIVISION.
048000 DECLARATIVES.
048100 SECT-ST214-DEC SECTION.
048200     USE AFTER STANDARD EXCEPTION PROCEDURE ON INPUT.
048300 SRT-WRITE-DEC.
048400     MOVE "ERROR ON OUTPUT DECL." TO FEATURE.
048500     MOVE "SRT-TEST-DEC" TO PAR-NAME.
048600     WRITE   PRINT-REC FROM TEST-RESULTS AFTER ADVANCING 2 LINES.
048700     STOP RUN.
048800 END DECLARATIVES.
048900 CCVS1 SECTION.
049000 OPEN-FILES.
049100     OPEN    OUTPUT PRINT-FILE.
049200     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
049300     MOVE    SPACE TO TEST-RESULTS.
049400     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
049500     MOVE    ZERO TO REC-SKL-SUB.
049600     PERFORM CCVS-INIT-FILE 9 TIMES.
049700 CCVS-INIT-FILE.
049800     ADD     1 TO REC-SKL-SUB.
049900     MOVE    FILE-RECORD-INFO-SKELETON
050000          TO FILE-RECORD-INFO (REC-SKL-SUB).
050100 CCVS-INIT-EXIT.
050200     GO TO CCVS1-EXIT.
050300 CLOSE-FILES.
050400     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
050500 TERMINATE-CCVS.
050600S    EXIT PROGRAM.
050700STERMINATE-CALL.
050800     STOP     RUN.
050900 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
051000 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
051100 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
051200 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
051300     MOVE "****TEST DELETED****" TO RE-MARK.
051400 PRINT-DETAIL.
051500     IF REC-CT NOT EQUAL TO ZERO
051600             MOVE "." TO PARDOT-X
051700             MOVE REC-CT TO DOTVALUE.
051800     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
051900     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
052000        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
052100          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
052200     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
052300     MOVE SPACE TO CORRECT-X.
052400     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
052500     MOVE     SPACE TO RE-MARK.
052600 HEAD-ROUTINE.
052700     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
052800     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
052900     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
053000     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
053100 COLUMN-NAMES-ROUTINE.
053200     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
053300     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
053400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
053500 END-ROUTINE.
053600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
053700 END-RTN-EXIT.
053800     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
053900 END-ROUTINE-1.
054000      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
054100      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
054200      ADD PASS-COUNTER TO ERROR-HOLD.
054300*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
054400      MOVE PASS-COUNTER TO CCVS-E-4-1.
054500      MOVE ERROR-HOLD TO CCVS-E-4-2.
054600      MOVE CCVS-E-4 TO CCVS-E-2-2.
054700      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
054800  END-ROUTINE-12.
054900      MOVE "TEST(S) FAILED" TO ENDER-DESC.
055000     IF       ERROR-COUNTER IS EQUAL TO ZERO
055100         MOVE "NO " TO ERROR-TOTAL
055200         ELSE
055300         MOVE ERROR-COUNTER TO ERROR-TOTAL.
055400     MOVE     CCVS-E-2 TO DUMMY-RECORD.
055500     PERFORM WRITE-LINE.
055600 END-ROUTINE-13.
055700     IF DELETE-COUNTER IS EQUAL TO ZERO
055800         MOVE "NO " TO ERROR-TOTAL  ELSE
055900         MOVE DELETE-COUNTER TO ERROR-TOTAL.
056000     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
056100     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
056200      IF   INSPECT-COUNTER EQUAL TO ZERO
056300          MOVE "NO " TO ERROR-TOTAL
056400      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
056500      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
056600      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
056700     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
056800 WRITE-LINE.
056900     ADD 1 TO RECORD-COUNT.
057000Y    IF RECORD-COUNT GREATER 42
057100Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
057200Y        MOVE SPACE TO DUMMY-RECORD
057300Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
057400Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
057500Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
057600Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
057700Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
057800Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
057900Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
058000Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
058100Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
058200Y        MOVE ZERO TO RECORD-COUNT.
058300     PERFORM WRT-LN.
058400 WRT-LN.
058500     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
058600     MOVE SPACE TO DUMMY-RECORD.
058700 BLANK-LINE-PRINT.
058800     PERFORM WRT-LN.
058900 FAIL-ROUTINE.
059000     IF     COMPUTED-X NOT EQUAL TO SPACE
059100            GO TO   FAIL-ROUTINE-WRITE.
059200     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
059300     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
059400     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
059500     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
059600     MOVE   SPACES TO INF-ANSI-REFERENCE.
059700     GO TO  FAIL-ROUTINE-EX.
059800 FAIL-ROUTINE-WRITE.
059900     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
060000     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
060100     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
060200     MOVE   SPACES TO COR-ANSI-REFERENCE.
060300 FAIL-ROUTINE-EX. EXIT.
060400 BAIL-OUT.
060500     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
060600     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
060700 BAIL-OUT-WRITE.
060800     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
060900     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
061000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
061100     MOVE   SPACES TO INF-ANSI-REFERENCE.
061200 BAIL-OUT-EX. EXIT.
061300 CCVS1-EXIT.
061400     EXIT.
061500 SECT-ST214-0001 SECTION.
061600 BLD-INIT-001.
061700     MOVE "CREATE FILE SQ-FS1" TO FEATURE.
061800     OPEN OUTPUT SQ-FS1.
061900     MOVE "SQ-FS1" TO XFILE-NAME (1).
062000     MOVE "R1-F-G" TO XRECORD-NAME (1).
062100     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
062200     MOVE 000132 TO XRECORD-LENGTH (1).
062300     MOVE "RC" TO CHARS-OR-RECORDS (1).
062400     MOVE 0001 TO XBLOCK-SIZE (1).
062500     MOVE 000051 TO RECORDS-IN-FILE (1).
062600     MOVE "SQ" TO XFILE-ORGANIZATION (1).
062700     MOVE "S" TO XLABEL-TYPE (1).
062800     MOVE 000001 TO XRECORD-NUMBER (1).
062900             MOVE SPACES TO WRK-XN-O120F-1.
063000 BLD-TEST-001.
063100     PERFORM BLD-TEST-001-BUILD VARYING WRK-DU-999-0001
063200         FROM 1 BY 1 UNTIL WRK-DU-999-0001 IS GREATER THAN 51.
063300X    MOVE    SPACES TO PRINT-REC.
063400X    WRITE   PRINT-REC.
063500     IF XRECORD-NUMBER (1) IS NOT EQUAL TO 000052
063600         PERFORM FAIL MOVE "INCORR. NO. OF RECS." TO RE-MARK
063700         ELSE
063800         PERFORM PASS.
063900     GO TO BLD-WRITE-001.
064000 BLD-TEST-001-BUILD.
064100     MOVE "JUNKSLOPJUNK" TO GARBAGE.
064200     MOVE WRK-DU-999-0001 TO NUM-KEY OF KEY-1 NUM-KEY OF KEY-2
064300         NUM-KEY OF KEY-3.
064400     MOVE FILE-RECORD-INFO-P1-120 (1) TO REC-PREAMBLE.
064500     ADD 1 TO XRECORD-NUMBER (1).
064600     MOVE ASCIIS (WRK-DU-999-0001) TO COLLS (WRK-DU-999-2).
064700     ADD 1 TO WRK-DU-999-2.
064800     MOVE ASCIIS (WRK-DU-999-0001) TO COLLS (WRK-DU-999-2).
064900     ADD 1 TO WRK-DU-999-2.
065000X    WRITE PRINT-REC FROM SQ-FS1R1-F-G-132.
065100X    WRITE PRINT-REC FROM REST-OF-1.
065200X    MOVE SPACES TO PRINT-REC.
065300     WRITE   SQ-FS1R1-F-G-132.
065400 BLD-DELETE-001.
065500     PERFORM DE-LETE.
065600 BLD-WRITE-001.
065700     MOVE "BLD-TEST-001" TO PAR-NAME.
065800     MOVE "FIRST FILE CREATED" TO COMPUTED-A.
065900     MOVE XRECORD-NUMBER (1) TO CORRECT-18V0.
066000     PERFORM PRINT-DETAIL.
066100X    MOVE    SPACES TO PRINT-REC.
066200X    WRITE   PRINT-REC.
066300     CLOSE SQ-FS1 WITH NO REWIND.
066400 BLD-INIT-002.
066500     MOVE "CREATE FILE SQ-FS2" TO FEATURE.
066600     OPEN OUTPUT SQ-FS2.
066700     MOVE  "SQ-FS2" TO XFILE-NAME (1).
066800     MOVE 000001 TO XRECORD-NUMBER (1).
066900     MOVE 0002 TO XBLOCK-SIZE (1).
067000 BLD-TEST-002.
067100     PERFORM BLD-TEST-002-BUILD VARYING WRK-DU-999-0001 FROM
067200         1 BY 1 UNTIL WRK-DU-999-0001 IS GREATER THAN 51.
067300X    MOVE    SPACES TO PRINT-REC.
067400X    WRITE   PRINT-REC.
067500     IF XRECORD-NUMBER (1) IS NOT EQUAL TO 000052
067600         PERFORM FAIL MOVE "INCORR. NO. OF RECS." TO RE-MARK
067700         ELSE
067800         PERFORM PASS.
067900     GO TO BLD-WRITE-002.
068000 BLD-TEST-002-BUILD.
068100     MOVE CHAR (WRK-DU-999-0001) TO ALPHAN-KEY OF KEY-4
068200         ALPHAN-KEY OF KEY-5 ALPHAN-KEY OF KEY-6.
068300     ADD 51 WRK-DU-999-0001 GIVING NUM-KEY OF KEY-4
068400         NUM-KEY OF KEY-5 NUM-KEY OF KEY-6.
068500     MOVE FILE-RECORD-INFO-P1-120 (1) TO REC-PRE-2.
068600     ADD 000001 TO XRECORD-NUMBER (1).
068700X    WRITE PRINT-REC FROM SQ-FS2R1-F-G-132.
068800X    WRITE PRINT-REC FROM REST-OF-2.
068900X    MOVE SPACES TO PRINT-REC.
069000     WRITE   SQ-FS2R1-F-G-132.
069100 BLD-DELETE-002.
069200     PERFORM DE-LETE.
069300 BLD-WRITE-002.
069400     MOVE "BLD-TEST-002" TO PAR-NAME.
069500     MOVE "2ND FILE CREATED" TO COMPUTED-A.
069600     MOVE XRECORD-NUMBER (1) TO CORRECT-18V0.
069700     PERFORM PRINT-DETAIL.
069800X    MOVE    SPACES TO PRINT-REC.
069900X    WRITE   PRINT-REC.
070000     CLOSE SQ-FS2.
070100 BLD-INIT-003.
070200     MOVE "CREATE FILE SQ-FS3" TO FEATURE.
070300     OPEN    OUTPUT SQ-FS3.
070400     MOVE  "SQ-FS3" TO XFILE-NAME (1).
070500     MOVE 000001 TO XRECORD-NUMBER (1).
070600     MOVE 0001 TO XBLOCK-SIZE (1).
070700 BLD-TEST-003.
070800     PERFORM BLD-TEST-003-BUILD VARYING WRK-DU-999-0001 FROM
070900         1 BY 1 UNTIL WRK-DU-999-0001 IS GREATER THAN 51.
071000X    MOVE    SPACES TO PRINT-REC.
071100X    WRITE   PRINT-REC.
071200     IF XRECORD-NUMBER (1) IS NOT EQUAL TO 52
071300         PERFORM FAIL MOVE "INCORR. NO. OF RECS." TO RE-MARK
071400         ELSE
071500         PERFORM PASS.
071600     GO TO BLD-WRITE-003.
071700 BLD-TEST-003-BUILD.
071800     MOVE CHAR (WRK-DU-999-0001) TO ALPHAN-KEY OF KEY-7
071900         ALPHAN-KEY OF KEY-8 ALPHAN-KEY OF KEY-9.
072000     MOVE WRK-DU-999-0001 TO NUM-KEY OF KEY-7 NUM-KEY OF KEY-8
072100         NUM-KEY OF KEY-9.
072200     MOVE FILE-RECORD-INFO-P1-120 (1) TO REC-PRE-3.
072300     ADD 000001 TO XRECORD-NUMBER (1).
072400X    WRITE PRINT-REC FROM SQ-FS3R1-F-G-132.
072500X    WRITE PRINT-REC FROM REST-OF-3.
072600X    MOVE SPACES TO PRINT-REC.
072700     WRITE   SQ-FS3R1-F-G-132.
072800 BLD-DELETE-003.
072900     PERFORM DE-LETE.
073000 BLD-WRITE-003.
073100     MOVE "BLD-TEST-003" TO PAR-NAME.
073200     MOVE "3RD FILE CREATED" TO COMPUTED-A.
073300     MOVE XRECORD-NUMBER (1) TO CORRECT-18V0.
073400     PERFORM PRINT-DETAIL.
073500X    MOVE    SPACES TO PRINT-REC.
073600X    WRITE   PRINT-REC.
073700     CLOSE SQ-FS3.
073800 MRG-INIT-001.
073900     MERGE ST-FS1
074000         ON DESCENDING KEY A-KEY OF SORT-KEY
074100         ASCENDING N-KEY OF NON-KEY-2
074200         USING SQ-FS2, SQ-FS3
074300     OUTPUT PROCEDURE IS SECT-ST214-0002.
074400 SRT-TEST-003.
074500     MOVE SPACES TO WRK-XN-X-0001.
074600     OPEN INPUT SQ-FS4.
074700     PERFORM RD-1 THRU R1-EXIT VARYING WRK-DU-999-0001 FROM 1 BY 1
074800         UNTIL WRK-DU-999-0001 IS GREATER THAN 20.
074900X    MOVE    SPACES TO PRINT-REC.
075000X    WRITE   PRINT-REC.
075100     IF WRK-XN-X-0001 IS NOT EQUAL TO WRK-XN-0002
075200         PERFORM FAIL GO TO SRT-FAIL-003
075300         ELSE
075400         PERFORM PASS.
075500     GO TO SRT-WRITE-003.
075600 SRT-DELETE-003.
075700     PERFORM DE-LETE.
075800     GO TO SRT-WRITE-003.
075900 SRT-FAIL-003.
076000     MOVE WRK-XN-X-0001 TO COMPUTED-A.
076100     MOVE WRK-XN-0002 TO CORRECT-A.
076200 SRT-WRITE-003.
076300     MOVE "MRG-TEST-003" TO PAR-NAME.
076400     MOVE "NATIVE COLL.SEQUENCE " TO FEATURE.
076500     PERFORM PRINT-DETAIL.
076600X    MOVE    SPACES TO PRINT-REC.
076700X    WRITE   PRINT-REC.
076800 SRT-INIT-004.
076900     MOVE SPACES TO WRK-XN-X-0001.
077000 SRT-TEST-004.
077100     PERFORM RD-1 THRU R1-EXIT VARYING WRK-DU-999-0001 FROM 1 BY 1
077200         UNTIL WRK-DU-999-0001 IS GREATER THAN 20.
077300X    MOVE    SPACES TO PRINT-REC.
077400X    WRITE   PRINT-REC.
077500     IF WRK-XN-X-0001 IS NOT EQUAL TO WRK-XN-0003
077600         PERFORM FAIL GO TO SRT-FAIL-004
077700         ELSE
077800         PERFORM PASS.
077900     GO TO SRT-WRITE-004.
078000 SRT-DELETE-004.
078100     PERFORM DE-LETE.
078200     GO TO SRT-WRITE-004.
078300 SRT-FAIL-004.
078400     MOVE WRK-XN-X-0001 TO COMPUTED-A.
078500     MOVE WRK-XN-0003 TO CORRECT-A.
078600 SRT-WRITE-004.
078700     MOVE "MRG-TEST-004" TO PAR-NAME.
078800     MOVE "NATIVE COLL.SEQUENCE " TO FEATURE.
078900     PERFORM PRINT-DETAIL.
079000X    MOVE    SPACES TO PRINT-REC.
079100X    WRITE   PRINT-REC.
079200 SRT-INIT-005.
079300     MOVE SPACES TO WRK-XN-X-0001.
079400 SRT-TEST-005.
079500     PERFORM RD-1 THRU R1-EXIT VARYING WRK-DU-999-0001 FROM 1 BY 1
079600         UNTIL WRK-DU-999-0001 IS GREATER THAN 20.
079700X    MOVE    SPACES TO PRINT-REC.
079800X    WRITE   PRINT-REC.
079900     IF WRK-XN-X-0001 IS NOT EQUAL TO WRK-XN-0004
080000         PERFORM FAIL GO TO SRT-FAIL-005
080100         ELSE
080200         PERFORM PASS.
080300     GO TO SRT-WRITE-005.
080400 SRT-DELETE-005.
080500     PERFORM DE-LETE.
080600     GO TO SRT-WRITE-005.
080700 SRT-FAIL-005.
080800     MOVE WRK-XN-X-0001 TO COMPUTED-A.
080900     MOVE WRK-XN-0004 TO CORRECT-A.
081000 SRT-WRITE-005.
081100     MOVE "MRG-TEST-005" TO PAR-NAME.
081200     MOVE "NATIVE COLL.SEQUENCE " TO FEATURE.
081300     PERFORM PRINT-DETAIL.
081400X    MOVE    SPACES TO PRINT-REC.
081500X    WRITE   PRINT-REC.
081600 SRT-INIT-006.
081700     MOVE SPACES TO WRK-XN-X-0001.
081800 SRT-TEST-006.
081900     PERFORM RD-1 THRU R1-EXIT VARYING WRK-DU-999-0001 FROM 1 BY 1
082000         UNTIL WRK-DU-999-0001 IS GREATER THAN 20.
082100X    MOVE    SPACES TO PRINT-REC.
082200X    WRITE   PRINT-REC.
082300     IF WRK-XN-X-0001 IS NOT EQUAL TO WRK-XN-0005
082400         PERFORM FAIL GO TO SRT-FAIL-006
082500         ELSE
082600         PERFORM PASS.
082700     GO TO SRT-WRITE-006.
082800 SRT-DELETE-006.
082900     PERFORM DE-LETE.
083000     GO TO SRT-WRITE-006.
083100 SRT-FAIL-006.
083200     MOVE WRK-XN-X-0001 TO COMPUTED-A.
083300     MOVE WRK-XN-0005 TO CORRECT-A.
083400 SRT-WRITE-006.
083500     MOVE "MRG-TEST-006" TO PAR-NAME.
083600     MOVE "NATIVE COLL.SEQUENCE " TO FEATURE.
083700     PERFORM PRINT-DETAIL.
083800X    MOVE    SPACES TO PRINT-REC.
083900X    WRITE   PRINT-REC.
084000 SRT-INIT-007.
084100     MOVE SPACES TO WRK-XN-X-0001.
084200 SRT-TEST-007.
084300     PERFORM RD-1 THRU R1-EXIT VARYING WRK-DU-999-0001 FROM 1 BY 1
084400         UNTIL WRK-DU-999-0001 IS GREATER THAN 20.
084500X    MOVE    SPACES TO PRINT-REC.
084600X    WRITE   PRINT-REC.
084700     IF WRK-XN-X-0001 IS NOT EQUAL TO WRK-XN-0006
084800         PERFORM FAIL GO TO SRT-FAIL-007
084900         ELSE
085000         PERFORM PASS.
085100     GO TO SRT-WRITE-007.
085200 SRT-DELETE-007.
085300     PERFORM DE-LETE.
085400     GO TO SRT-WRITE-007.
085500 SRT-FAIL-007.
085600     MOVE WRK-XN-X-0001 TO COMPUTED-A.
085700     MOVE WRK-XN-0006 TO CORRECT-A.
085800 SRT-WRITE-007.
085900     MOVE "MRG-TEST-007" TO PAR-NAME.
086000     MOVE "NATIVE COLL.SEQUENCE " TO FEATURE.
086100     PERFORM PRINT-DETAIL.
086200X    MOVE    SPACES TO PRINT-REC.
086300X    WRITE   PRINT-REC.
086400 SRT-INIT-008.
086500     MOVE SPACES TO WRK-XN-X-0001.
086600 SRT-TEST-008.
086700     PERFORM RD-1 THRU R1-EXIT VARYING WRK-DU-999-0001 FROM 1 BY 1
086800         UNTIL WRK-DU-999-0001 IS GREATER THAN 2.
086900X    MOVE    SPACES TO PRINT-REC.
087000X    WRITE   PRINT-REC.
087100     IF WRK-XN-X-0001 IS NOT EQUAL TO WRK-XN-0007
087200         PERFORM FAIL GO TO SRT-FAIL-008
087300         ELSE
087400         PERFORM PASS.
087500     GO TO SRT-WRITE-008.
087600 SRT-DELETE-008.
087700     PERFORM DE-LETE.
087800     GO TO SRT-WRITE-008.
087900 SRT-FAIL-008.
088000     MOVE WRK-XN-X-0001 TO COMPUTED-A.
088100     MOVE WRK-XN-0007 TO CORRECT-A.
088200 SRT-WRITE-008.
088300     MOVE "MRG-TEST-008" TO PAR-NAME.
088400     MOVE "NATIVE COLL.SEQUENCE " TO FEATURE.
088500     PERFORM PRINT-DETAIL.
088600     MOVE    NUM-KEY OF KEY-11 TO LAST-REC-NUM.
088700 SRT-TEST-009.
088800     IF WRK-DU-9-0001 IS NOT EQUAL TO ZERO
088900         GO TO SRT-FAIL-009.
089000     READ SQ-FS4 AT END PERFORM PASS
089100         GO TO SRT-WRITE-009.
089200     GO TO SRT-FAIL-009.
089300 SRT-DELETE-009.
089400     PERFORM DE-LETE.
089500     GO TO SRT-WRITE-009.
089600 SRT-FAIL-009.
089700     MOVE "EOF NOT FOUND" TO RE-MARK.
089800     PERFORM FAIL .
089900 SRT-WRITE-009.
090000     MOVE "EOF CHECK SQ-FS4" TO FEATURE.
090100     MOVE "MRG-TEST-009" TO PAR-NAME.
090200     PERFORM PRINT-DETAIL.
090300 SRT-TEST-010.
090400     IF LAST-REC-NUM IS NOT EQUAL TO 102
090500         PERFORM FAIL GO TO SRT-FAIL-010
090600         ELSE
090700         PERFORM PASS.
090800     GO TO SRT-WRITE-010.
090900 SRT-DELETE-010.
091000     PERFORM DE-LETE.
091100     GO TO SRT-WRITE-010.
091200 SRT-FAIL-010.
091300     MOVE LAST-REC-NUM TO COMPUTED-18V0.
091400     MOVE 102 TO CR-18V0.
091500 SRT-WRITE-010.
091600     MOVE "NUMER. SEQ. CHECK" TO FEATURE.
091700     MOVE "MRG-TEST-010" TO PAR-NAME.
091800     PERFORM PRINT-DETAIL.
091900     CLOSE   SQ-FS4.
092000     GO TO CCVS-999999.
092100 READ-SQ-FS1 SECTION.
092200 RD-1.
092300     IF WRK-DU-9-0001 IS NOT EQUAL TO ZERO
092400         GO TO R1-EXIT.
092500     READ SQ-FS4 AT END GO TO PREMATURE-EOF.
092600X    WRITE PRINT-REC FROM SQ-FS4R1-F-G-132.
092700X    WRITE PRINT-REC FROM REST-OF-4.
092800X    MOVE SPACES TO PRINT-REC.
092900     MOVE ALPHAN-KEY OF KEY-12 TO COMPU (WRK-DU-999-0001).
093000     GO TO R1-EXIT.
093100 PREMATURE-EOF.
093200     MOVE 1 TO WRK-DU-9-0001.
093300     MOVE "PREMATURE EOF FOUND" TO RE-MARK.
093400 R1-EXIT.
093500     EXIT.
093600 SECT-ST214-0002 SECTION.
093700 SORT-OUTPUT-PROC.
093800     OPEN OUTPUT SQ-FS4.
093900 RETURN-THE-OLD-RECORDS.
094000     RETURN ST-FS1 RECORD INTO SQ-FS4R1-F-G-132
094100         AT END GO TO CLOSE-AFTER-SORT.
094200X    WRITE PRINT-REC FROM SQ-FS4R1-F-G-132.
094300X    WRITE PRINT-REC FROM REST-OF-4.
094400X    MOVE SPACES TO PRINT-REC.
094500     WRITE   SQ-FS4R1-F-G-132.
094600     GO TO RETURN-THE-OLD-RECORDS.
094700 CLOSE-AFTER-SORT.
094800     CLOSE SQ-FS4.
094900 CCVS-EXIT SECTION.
095000 CCVS-999999.
095100     GO TO CLOSE-FILES.
