000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ122A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 3.1                                  *
000900*                                                              *
001000*    CREATION DATE     /     VALIDATION DATE                   *
001100*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001200*                                                              *
001300****************************************************************
001400*                                                              *
001500*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001600*                                                              *
001700*            X-14   SEQUENTIAL MASS STORAGE FILE               *
001800*            X-55   SYSTEM PRINTER                             *
001900*            X-82   SOURCE-COMPUTER                            *
002000*            X-83   OBJECT-COMPUTER                            *
002100*            X-84   LABEL RECORDS OPTION                       *
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    A ONE RECORD FILE WITH TWO CHARACTERS PER BLOCK IS CREATED*
002600*    WITH THE INTENTION THAT IT SHOULD END PART-WAY THROUGH A  *
002700*    BLOCK.                     THE FILE IS RE-OPENED AND      *
002800*    THREE READ STATEMENTS EXECUTED.  THE FIRST SHOULD BE      *
002900*    EXECUTED SUCCESSFULLY, THE SECOND RAISE THE AT END        *
003000*    CONDITION, AND THE THIRD, WHICH IS A READ AFTER END OF    *
003100*    FILE, SHOULD CAUSE THE I-O STATUS CODE 46.                *
003200*                                                              *
003300****************************************************************
003400*
003500 ENVIRONMENT DIVISION.
003600 CONFIGURATION SECTION.
003700 SOURCE-COMPUTER.
003800     XXXXX082.
003900 OBJECT-COMPUTER.
004000     XXXXX083.
004100*
004200 INPUT-OUTPUT SECTION.
004300 FILE-CONTROL.
004400     SELECT PRINT-FILE ASSIGN TO
004500     XXXXX055.
004600*
004700     SELECT SQ-FS4 ASSIGN
004800     XXXXX014
004900            FILE STATUS IS SQ-FS4-STATUS.
005000*
005100*
005200 DATA DIVISION.
005300 FILE SECTION.
005400 FD  PRINT-FILE
005500C    LABEL RECORDS
005600C    XXXXX084
005700C    DATA RECORD IS PRINT-REC DUMMY-RECORD
005800               .
005900 01  PRINT-REC    PICTURE X(120).
006000 01  DUMMY-RECORD PICTURE X(120).
006100*
006200 FD  SQ-FS4
006300C    LABEL RECORD IS STANDARD
006400     BLOCK  2 RECORDS
006500     RECORD 125
006600                .
006700 01  SQ-FS4R1-F-G-125.
006800     05  SQ-FS4-FIRST  PIC X(120).
006900     05  SQ-FS4-REC-NO PIC 99999.
007000*
007100 WORKING-STORAGE SECTION.
007200*
007300***************************************************************
007400*                                                             *
007500*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
007600*                                                             *
007700***************************************************************
007800*
007900 01  SQ-FS4-STATUS.
008000   03  SQ-FS4-KEY-1   PIC X.
008100   03  SQ-FS4-KEY-2   PIC X.
008200*
008300***************************************************************
008400*                                                             *
008500*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
008600*                                                             *
008700***************************************************************
008800*
008900 01  REC-SKEL-SUB   PIC 99.
009000*
009100 01  FILE-RECORD-INFORMATION-REC.
009200     03 FILE-RECORD-INFO-SKELETON.
009300        05 FILLER                 PICTURE X(48)       VALUE
009400             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
009500        05 FILLER                 PICTURE X(46)       VALUE
009600             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
009700        05 FILLER                 PICTURE X(26)       VALUE
009800             ",LFIL=000000,ORG=  ,LBLR= ".
009900        05 FILLER                 PICTURE X(37)       VALUE
010000             ",RECKEY=                             ".
010100        05 FILLER                 PICTURE X(38)       VALUE
010200             ",ALTKEY1=                             ".
010300        05 FILLER                 PICTURE X(38)       VALUE
010400             ",ALTKEY2=                             ".
010500        05 FILLER                 PICTURE X(7)        VALUE SPACE.
010600     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
010700        05 FILE-RECORD-INFO-P1-120.
010800           07 FILLER              PIC X(5).
010900           07 XFILE-NAME          PIC X(6).
011000           07 FILLER              PIC X(8).
011100           07 XRECORD-NAME        PIC X(6).
011200           07 FILLER              PIC X(1).
011300           07 REELUNIT-NUMBER     PIC 9(1).
011400           07 FILLER              PIC X(7).
011500           07 XRECORD-NUMBER      PIC 9(6).
011600           07 FILLER              PIC X(6).
011700           07 UPDATE-NUMBER       PIC 9(2).
011800           07 FILLER              PIC X(5).
011900           07 ODO-NUMBER          PIC 9(4).
012000           07 FILLER              PIC X(5).
012100           07 XPROGRAM-NAME       PIC X(5).
012200           07 FILLER              PIC X(7).
012300           07 XRECORD-LENGTH      PIC 9(6).
012400           07 FILLER              PIC X(7).
012500           07 CHARS-OR-RECORDS    PIC X(2).
012600           07 FILLER              PIC X(1).
012700           07 XBLOCK-SIZE         PIC 9(4).
012800           07 FILLER              PIC X(6).
012900           07 RECORDS-IN-FILE     PIC 9(6).
013000           07 FILLER              PIC X(5).
013100           07 XFILE-ORGANIZATION  PIC X(2).
013200           07 FILLER              PIC X(6).
013300           07 XLABEL-TYPE         PIC X(1).
013400        05 FILE-RECORD-INFO-P121-240.
013500           07 FILLER              PIC X(8).
013600           07 XRECORD-KEY         PIC X(29).
013700           07 FILLER              PIC X(9).
013800           07 ALTERNATE-KEY1      PIC X(29).
013900           07 FILLER              PIC X(9).
014000           07 ALTERNATE-KEY2      PIC X(29).
014100           07 FILLER              PIC X(7).
014200*
014300 01  TEST-RESULTS.
014400     02 FILLER              PIC X      VALUE SPACE.
014500     02  PAR-NAME.
014600       03 FILLER              PIC X(14)  VALUE SPACE.
014700       03 PARDOT-X            PIC X      VALUE SPACE.
014800       03 DOTVALUE            PIC 99     VALUE ZERO.
014900     02 FILLER              PIC X      VALUE SPACE.
015000     02 FEATURE             PIC X(24)  VALUE SPACE.
015100     02 FILLER              PIC X      VALUE SPACE.
015200     02 P-OR-F              PIC X(5)   VALUE SPACE.
015300     02 FILLER              PIC X(9)   VALUE SPACE.
015400     02 RE-MARK             PIC X(61).
015500 01  TEST-COMPUTED.
015600   02 FILLER  PIC X(30)  VALUE SPACE.
015700   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
015800   02 COMPUTED-X.
015900     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
016000     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
016100     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
016200     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
016300     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
016400     03       CM-18V0 REDEFINES COMPUTED-A.
016500        04 COMPUTED-18V0                   PIC -9(18).
016600        04 FILLER                          PIC X.
016700     03 FILLER PIC X(50) VALUE SPACE.
016800 01  TEST-CORRECT.
016900     02 FILLER PIC X(30) VALUE SPACE.
017000     02 FILLER PIC X(17) VALUE "       CORRECT =".
017100     02 CORRECT-X.
017200     03 CORRECT-A                  PIC X(20) VALUE SPACE.
017300     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
017400     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
017500     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
017600     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
017700     03      CR-18V0 REDEFINES CORRECT-A.
017800         04 CORRECT-18V0                     PIC -9(18).
017900         04 FILLER                           PIC X.
018000     03 FILLER PIC X(2) VALUE SPACE.
018100     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
018200*
018300 01  CCVS-C-1.
018400     02 FILLER  PIC IS X        VALUE  SPACE.
018500     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
018600     02 FILLER  PIC IS X        VALUE  SPACE.
018700     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
018800     02 FILLER  PIC IS X        VALUE  SPACE.
018900     02 FILLER  PIC IS X(5)     VALUE "PASS ".
019000     02 FILLER  PIC IS X(9)     VALUE  SPACE.
019100     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
019200 01  CCVS-C-2.
019300     02 FILLER  PIC X(19)  VALUE  SPACE.
019400     02 FILLER  PIC X(6)   VALUE "TESTED".
019500     02 FILLER  PIC X(19)  VALUE  SPACE.
019600     02 FILLER  PIC X(4)   VALUE "FAIL".
019700     02 FILLER  PIC X(72)  VALUE  SPACE.
019800*
019900 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
020000 01  REC-CT            PIC 99       VALUE ZERO.
020100 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
020200 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
020300 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
020400 01  PASS-COUNTER      PIC 999      VALUE ZERO.
020500 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
020600 01  ERROR-HOLD        PIC 999      VALUE ZERO.
020700 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
020800 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
020900 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
021000 01  CCVS-H-1.
021100     02  FILLER          PIC X(39)    VALUE SPACES.
021200     02  FILLER          PIC X(42)    VALUE
021300     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
021400     02  FILLER          PIC X(39)    VALUE SPACES.
021500 01  CCVS-H-2A.
021600   02  FILLER            PIC X(40)  VALUE SPACE.
021700   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
021800   02  FILLER            PIC XXXX   VALUE
021900     "4.2 ".
022000   02  FILLER            PIC X(28)  VALUE
022100            " COPY - NOT FOR DISTRIBUTION".
022200   02  FILLER            PIC X(41)  VALUE SPACE.
022300*
022400 01  CCVS-H-2B.
022500   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
022600   02  TEST-ID           PIC X(9).
022700   02  FILLER            PIC X(4)   VALUE " IN ".
022800   02  FILLER            PIC X(12)  VALUE
022900     " HIGH       ".
023000   02  FILLER            PIC X(22)  VALUE
023100            " LEVEL VALIDATION FOR ".
023200   02  FILLER            PIC X(58)  VALUE
023300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
023400 01  CCVS-H-3.
023500     02  FILLER          PIC X(34)  VALUE
023600            " FOR OFFICIAL USE ONLY    ".
023700     02  FILLER          PIC X(58)  VALUE
023800     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
023900     02  FILLER          PIC X(28)  VALUE
024000            "  COPYRIGHT   1985,1986 ".
024100 01  CCVS-E-1.
024200     02 FILLER           PIC X(52)  VALUE SPACE.
024300     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
024400     02 ID-AGAIN         PIC X(9).
024500     02 FILLER           PIC X(45)  VALUE SPACES.
024600 01  CCVS-E-2.
024700     02  FILLER          PIC X(31)  VALUE SPACE.
024800     02  FILLER          PIC X(21)  VALUE SPACE.
024900     02  CCVS-E-2-2.
025000         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
025100         03 FILLER         PIC X      VALUE SPACE.
025200         03 ENDER-DESC     PIC X(44)  VALUE
025300            "ERRORS ENCOUNTERED".
025400 01  CCVS-E-3.
025500     02  FILLER          PIC X(22)  VALUE
025600            " FOR OFFICIAL USE ONLY".
025700     02  FILLER          PIC X(12)  VALUE SPACE.
025800     02  FILLER          PIC X(58)  VALUE
025900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
026000     02  FILLER          PIC X(8)   VALUE SPACE.
026100     02  FILLER          PIC X(20)  VALUE
026200             " COPYRIGHT 1985,1986".
026300 01  CCVS-E-4.
026400     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
026500     02 FILLER           PIC X(4)   VALUE " OF ".
026600     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
026700     02 FILLER           PIC X(40)  VALUE
026800      "  TESTS WERE EXECUTED SUCCESSFULLY".
026900 01  XXINFO.
027000     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
027100     02 INFO-TEXT.
027200       04 FILLER             PIC X(8)   VALUE SPACE.
027300       04 XXCOMPUTED         PIC X(20).
027400       04 FILLER             PIC X(5)   VALUE SPACE.
027500       04 XXCORRECT          PIC X(20).
027600     02 INF-ANSI-REFERENCE PIC X(48).
027700 01  HYPHEN-LINE.
027800     02 FILLER  PIC IS X VALUE IS SPACE.
027900     02 FILLER  PIC IS X(65)    VALUE IS "************************
028000-    "*****************************************".
028100     02 FILLER  PIC IS X(54)    VALUE IS "************************
028200-    "******************************".
028300 01  CCVS-PGM-ID  PIC X(9)   VALUE
028400     "SQ122A".
028500*
028600*
028700 PROCEDURE DIVISION.
028800 DECLARATIVES.
028900 SECT-SQ122A-0002 SECTION.
029000     USE AFTER EXCEPTION PROCEDURE INPUT.
029100 INPUT-ERROR-PROCESS.
029200     IF SQ-FS4-STATUS = "10"
029300             GO TO END-DECLS.
029400     IF SQ-FS4-STATUS = "46"
029500             PERFORM DECL-PASS
029600             GO TO ABNORMAL-TERM-DECL
029700     ELSE
029800             MOVE "46" TO CORRECT-A
029900             MOVE SQ-FS4-STATUS TO COMPUTED-A
030000             MOVE "STATUS OF READ AFTER EOF READ INCORRECT"
030100                     TO RE-MARK
030200             MOVE "VII-4, 1.3.5(4)E, FILE STATUS"
030300                     TO ANSI-REFERENCE
030400             PERFORM DECL-FAIL
030500             GO TO ABNORMAL-TERM-DECL
030600     END-IF.
030700*
030800 DECL-PASS.
030900     MOVE   "PASS " TO P-OR-F.
031000     ADD     1 TO PASS-COUNTER.
031100     PERFORM DECL-PRINT-DETAIL.
031200*
031300 DECL-FAIL.
031400     MOVE   "FAIL*" TO P-OR-F.
031500     ADD     1 TO ERROR-COUNTER.
031600     PERFORM DECL-PRINT-DETAIL.
031700*
031800 DECL-PRINT-DETAIL.
031900     IF REC-CT NOT EQUAL TO ZERO
032000             MOVE "." TO PARDOT-X
032100             MOVE REC-CT TO DOTVALUE.
032200     MOVE    TEST-RESULTS TO PRINT-REC.
032300     PERFORM DECL-WRITE-LINE.
032400     IF P-OR-F EQUAL TO "FAIL*"
032500         PERFORM DECL-WRITE-LINE
032600         PERFORM DECL-FAIL-ROUTINE THRU DECL-FAIL-EX
032700     ELSE
032800         PERFORM DECL-BAIL THRU DECL-BAIL-EX.
032900     MOVE    SPACE TO P-OR-F.
033000     MOVE    SPACE TO COMPUTED-X.
033100     MOVE    SPACE TO CORRECT-X.
033200     IF REC-CT EQUAL TO ZERO
033300         MOVE    SPACE TO PAR-NAME.
033400     MOVE    SPACE TO RE-MARK.
033500*
033600 DECL-WRITE-LINE.
033700     ADD     1 TO RECORD-COUNT.
033800Y    IF RECORD-COUNT GREATER 50
033900Y        MOVE    DUMMY-RECORD TO DUMMY-HOLD
034000Y        MOVE    SPACE TO DUMMY-RECORD
034100Y        WRITE   DUMMY-RECORD AFTER ADVANCING PAGE
034200Y        MOVE    CCVS-C-1 TO DUMMY-RECORD PERFORM DECL-WRT-LN
034300Y        MOVE    CCVS-C-2 TO DUMMY-RECORD
034400Y        PERFORM DECL-WRT-LN 2 TIMES
034500Y        MOVE    HYPHEN-LINE TO DUMMY-RECORD
034600Y        PERFORM DECL-WRT-LN
034700Y        MOVE    DUMMY-HOLD TO DUMMY-RECORD
034800Y        MOVE    ZERO TO RECORD-COUNT.
034900     PERFORM DECL-WRT-LN.
035000*
035100 DECL-WRT-LN.
035200     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
035300     MOVE    SPACE TO DUMMY-RECORD.
035400*
035500 DECL-FAIL-ROUTINE.
035600     IF COMPUTED-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
035700     IF CORRECT-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
035800     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
035900     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
036000     MOVE    XXINFO TO DUMMY-RECORD.
036100     PERFORM DECL-WRITE-LINE 2 TIMES.
036200     MOVE    SPACES TO INF-ANSI-REFERENCE.
036300     GO TO   DECL-FAIL-EX.
036400 DECL-FAIL-WRITE.
036500     MOVE    TEST-COMPUTED TO PRINT-REC
036600     PERFORM DECL-WRITE-LINE
036700     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
036800     MOVE    TEST-CORRECT TO PRINT-REC
036900     PERFORM DECL-WRITE-LINE 2 TIMES.
037000     MOVE    SPACES TO COR-ANSI-REFERENCE.
037100 DECL-FAIL-EX.
037200     EXIT.
037300*
037400 DECL-BAIL.
037500     IF COMPUTED-A NOT EQUAL TO SPACE GO TO DECL-BAIL-WRITE.
037600     IF CORRECT-A EQUAL TO SPACE GO TO DECL-BAIL-EX.
037700 DECL-BAIL-WRITE.
037800     MOVE    CORRECT-A TO XXCORRECT.
037900     MOVE    COMPUTED-A TO XXCOMPUTED.
038000     MOVE    XXINFO TO DUMMY-RECORD.
038100     PERFORM DECL-WRITE-LINE 2 TIMES.
038200 DECL-BAIL-EX.
038300     EXIT.
038400*
038500 ABNORMAL-TERM-DECL.
038600     MOVE SPACE TO DUMMY-RECORD.
038700     PERFORM DECL-WRITE-LINE.
038800     MOVE "ABNORMAL TERMINATION AT THIS POINT IS ACCEPTABLE"
038900             TO DUMMY-RECORD.
039000     PERFORM DECL-WRITE-LINE 3 TIMES.
039100*
039200 END-DECLS.
039300 END DECLARATIVES.
039400*
039500*
039600 CCVS1 SECTION.
039700 OPEN-FILES.
039800     OPEN    OUTPUT PRINT-FILE.
039900     MOVE    CCVS-PGM-ID TO TEST-ID.
040000     MOVE    CCVS-PGM-ID TO ID-AGAIN.
040100     MOVE    SPACE TO TEST-RESULTS.
040200     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
040300     MOVE    ZERO TO REC-SKEL-SUB.
040400     PERFORM CCVS-INIT-FILE 10 TIMES.
040500     GO TO CCVS1-EXIT.
040600*
040700 CCVS-INIT-FILE.
040800     ADD     1 TO REC-SKL-SUB.
040900     MOVE    FILE-RECORD-INFO-SKELETON TO
041000                  FILE-RECORD-INFO (REC-SKL-SUB).
041100*
041200 CLOSE-FILES.
041300     PERFORM END-ROUTINE THRU END-ROUTINE-13.
041400     CLOSE   PRINT-FILE.
041500 TERMINATE-CCVS.
041600     STOP    RUN.
041700*
041800 INSPT.
041900     MOVE   "INSPT" TO P-OR-F.
042000     ADD     1 TO INSPECT-COUNTER.
042100     PERFORM PRINT-DETAIL.
042200*
042300 PASS.
042400     MOVE   "PASS " TO P-OR-F.
042500     ADD     1 TO PASS-COUNTER.
042600     PERFORM PRINT-DETAIL.
042700*
042800 FAIL.
042900     MOVE   "FAIL*" TO P-OR-F.
043000     ADD     1 TO ERROR-COUNTER.
043100     PERFORM PRINT-DETAIL.
043200*
043300 DE-LETE.
043400     MOVE   "****TEST DELETED****" TO RE-MARK.
043500     MOVE   "*****" TO P-OR-F.
043600     ADD     1 TO DELETE-COUNTER.
043700     PERFORM PRINT-DETAIL.
043800*
043900 PRINT-DETAIL.
044000     IF REC-CT NOT EQUAL TO ZERO
044100         MOVE   "." TO PARDOT-X
044200         MOVE    REC-CT TO DOTVALUE.
044300     MOVE    TEST-RESULTS TO PRINT-REC.
044400     PERFORM WRITE-LINE.
044500     IF P-OR-F EQUAL TO "FAIL*"
044600         PERFORM WRITE-LINE
044700         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
044800     ELSE
044900         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
045000     MOVE    SPACE TO P-OR-F.
045100     MOVE    SPACE TO COMPUTED-X.
045200     MOVE    SPACE TO CORRECT-X.
045300     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
045400     MOVE    SPACE TO RE-MARK.
045500*
045600 HEAD-ROUTINE.
045700     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045800     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045900     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
046000     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
046100 COLUMN-NAMES-ROUTINE.
046200     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
046300     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
046400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
046500 END-ROUTINE.
046600     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
046700     PERFORM WRITE-LINE 5 TIMES.
046800 END-RTN-EXIT.
046900     MOVE    CCVS-E-1 TO DUMMY-RECORD.
047000     PERFORM WRITE-LINE 2 TIMES.
047100*
047200 END-ROUTINE-1.
047300     ADD     ERROR-COUNTER   TO ERROR-HOLD
047400     ADD     INSPECT-COUNTER TO ERROR-HOLD.
047500     ADD     DELETE-COUNTER  TO ERROR-HOLD.
047600     ADD     PASS-COUNTER    TO ERROR-HOLD.
047700     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
047800     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
047900     MOVE    CCVS-E-4        TO CCVS-E-2-2.
048000     MOVE    CCVS-E-2        TO DUMMY-RECORD
048100     PERFORM WRITE-LINE.
048200     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
048300     IF ERROR-COUNTER IS EQUAL TO ZERO
048400         MOVE   "NO " TO ERROR-TOTAL
048500     ELSE
048600         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
048700     MOVE    CCVS-E-2 TO DUMMY-RECORD.
048800     PERFORM WRITE-LINE.
048900 END-ROUTINE-13.
049000     IF DELETE-COUNTER IS EQUAL TO ZERO
049100         MOVE   "NO " TO ERROR-TOTAL
049200     ELSE
049300         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
049400     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
049500     MOVE    CCVS-E-2 TO DUMMY-RECORD.
049600     PERFORM WRITE-LINE.
049700     IF INSPECT-COUNTER EQUAL TO ZERO
049800         MOVE   "NO " TO ERROR-TOTAL
049900     ELSE
050000         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
050100     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
050200     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
050300     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
050400*
050500 WRITE-LINE.
050600     ADD     1 TO RECORD-COUNT.
050700Y    IF RECORD-COUNT GREATER 50
050800Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
050900Y        MOVE  SPACE TO DUMMY-RECORD
051000Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
051100Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
051200Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
051300Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
051400Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
051500Y        MOVE  ZERO TO RECORD-COUNT.
051600     PERFORM WRT-LN.
051700*
051800 WRT-LN.
051900     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
052000     MOVE    SPACE TO DUMMY-RECORD.
052100 BLANK-LINE-PRINT.
052200     PERFORM WRT-LN.
052300 FAIL-ROUTINE.
052400     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
052500     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
052600     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
052700     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
052800     MOVE    XXINFO TO DUMMY-RECORD.
052900     PERFORM WRITE-LINE 2 TIMES.
053000     MOVE    SPACES TO INF-ANSI-REFERENCE.
053100     GO TO   FAIL-ROUTINE-EX.
053200 FAIL-ROUTINE-WRITE.
053300     MOVE    TEST-COMPUTED  TO PRINT-REC
053400     PERFORM WRITE-LINE
053500     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
053600     MOVE    TEST-CORRECT   TO PRINT-REC
053700     PERFORM WRITE-LINE 2 TIMES.
053800     MOVE    SPACES         TO COR-ANSI-REFERENCE.
053900 FAIL-ROUTINE-EX.
054000     EXIT.
054100 BAIL-OUT.
054200     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
054300     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
054400 BAIL-OUT-WRITE.
054500     MOVE    CORRECT-A      TO XXCORRECT.
054600     MOVE    COMPUTED-A     TO XXCOMPUTED.
054700     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
054800     MOVE    XXINFO TO DUMMY-RECORD.
054900     PERFORM WRITE-LINE 2 TIMES.
055000     MOVE    SPACES TO INF-ANSI-REFERENCE.
055100 BAIL-OUT-EX.
055200     EXIT.
055300 CCVS1-EXIT.
055400     EXIT.
055500*
055600****************************************************************
055700*                                                              *
055800*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
055900*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
056000*                                                              *
056100****************************************************************
056200*
056300 SECT-SQ122A-0004 SECTION.
056400 STA-INIT.
056500*
056600     MOVE   "SQ-FS4" TO XFILE-NAME (1).
056700     MOVE   "R1-F-G" TO XRECORD-NAME (1).
056800     MOVE    CCVS-PGM-ID TO XPROGRAM-NAME (1).
056900     MOVE    125 TO XRECORD-LENGTH (1).
057000     MOVE   "RC" TO CHARS-OR-RECORDS (1).
057100     MOVE    2   TO XBLOCK-SIZE (1).
057200     MOVE    1   TO RECORDS-IN-FILE (1).
057300     MOVE   "SQ" TO XFILE-ORGANIZATION (1).
057400     MOVE   "S"  TO XLABEL-TYPE (1).
057500     MOVE    ZERO TO XRECORD-NUMBER (1).
057600*
057700*    OPEN THE FILE IN THE OUTPUT MODE
057800*
057900 SEQ-INIT-01.
058000     MOVE    0 TO REC-CT.
058100     MOVE   "**" TO SQ-FS4-STATUS.
058200     MOVE   "OPEN, CREATE FILE"  TO FEATURE.
058300     MOVE   "SEQ-TEST-OP-01" TO PAR-NAME.
058400 SEQ-TEST-OP-01.
058500     OPEN    OUTPUT SQ-FS4.
058600*
058700*    CHECK I-O STATUS RETURNED FROM OPEN OUTPUT
058800*
058900     ADD    1 TO REC-CT.
059000 SEQ-TEST-OP-01-01.
059100     IF SQ-FS4-STATUS = "00"
059200         PERFORM PASS
059300     ELSE
059400         MOVE    SQ-FS4-STATUS TO COMPUTED-A
059500         MOVE   "00" TO CORRECT-A
059600         MOVE   "UNEXPECTED ERROR CODE FROM OPEN OUTPUT"
059700                   TO RE-MARK
059800         MOVE   "VII-3, VII-23" TO ANSI-REFERENCE
059900         PERFORM FAIL.
060000 SEQ-TEST-01-01-END.
060100*
060200*
060300*    THE FILE HAS BEEN CREATED.  WE NOW WRITE ONE RECORD TO IT.
060400*
060500 SEQ-INIT-02.
060600     MOVE    0 TO REC-CT.
060700     MOVE   "**" TO SQ-FS4-STATUS.
060800     ADD     1 TO XRECORD-NUMBER (1).
060900     MOVE   "WRITE ONE RECORD"  TO FEATURE.
061000     MOVE   "SEQ-TEST-WR-02" TO PAR-NAME.
061100 SEQ-TEST-WR-02.
061200     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-FS4-FIRST.
061300     MOVE    XRECORD-NUMBER (1) TO SQ-FS4-REC-NO.
061400     WRITE   SQ-FS4R1-F-G-125.
061500*
061600*    CHECK I-O STATUS RETURNED FROM WRITE
061700*
061800     ADD    1 TO REC-CT.
061900 SEQ-TEST-WR-02-01.
062000     IF SQ-FS4-STATUS = "00"
062100         PERFORM PASS
062200     ELSE
062300         MOVE    SQ-FS4-STATUS TO COMPUTED-A
062400         MOVE   "00" TO CORRECT-A
062500         MOVE   "UNEXPECTED ERROR CODE FROM WRITE"
062600                   TO RE-MARK
062700         MOVE   "VII-3, VII-53,4.7.4(6)" TO ANSI-REFERENCE
062800         PERFORM FAIL.
062900 SEQ-TEST-02-01-END.
063000*
063100*
063200*    HAVING WRITTEN ONE RECORD, CLOSE THE FILE.
063300*
063400 SEQ-INIT-03.
063500     MOVE    0 TO REC-CT.
063600     MOVE   "**" TO SQ-FS4-STATUS.
063700     MOVE   "CLOSE AFTER CREATE"  TO FEATURE.
063800     MOVE   "SEQ-TEST-CL-03" TO PAR-NAME.
063900 SEQ-TEST-CL-03.
064000     CLOSE   SQ-FS4.
064100*
064200*    CHECK I-O STATUS RETURNED FROM CLOSE
064300*
064400     ADD    1 TO REC-CT.
064500 SEQ-TEST-CL-03-01.
064600     IF SQ-FS4-STATUS = "00"
064700         PERFORM PASS
064800     ELSE
064900         MOVE    SQ-FS4-STATUS TO COMPUTED-A
065000         MOVE   "00" TO CORRECT-A
065100         MOVE   "UNEXPECTED ERROR CODE FROM CLOSE"
065200                   TO RE-MARK
065300         MOVE   "VII-3, VII-38,4.2.4(4)" TO ANSI-REFERENCE
065400         PERFORM FAIL.
065500 SEQ-TEST-03-01-END.
065600*
065700*
065800*    CREATION OF THE FILE IS NOW COMPLETE.  THE NEXT ACTION
065900*    IS TO OPEN THE FILE IN THE INPUT MODE
066000*
066100 SEQ-INIT-04.
066200     MOVE    0 TO REC-CT.
066300     MOVE    ZERO TO XRECORD-NUMBER (1).
066400     MOVE   "**" TO SQ-FS4-STATUS.
066500     MOVE   "OPEN, TO READ FILE"  TO FEATURE.
066600     MOVE   "SEQ-TEST-OP-04" TO PAR-NAME.
066700 SEQ-TEST-OP-04.
066800*
066900*    OPEN THE TEST FILE AND CLEAR THE RECORD AREA, JUST IN
067000*    CASE THERE IS A SINGLE BUFFER WHICH STILL HAS A COPY OF
067100*    THE LAST RECORD WRITTEN IN IT.
067200*
067300     OPEN    INPUT SQ-FS4.
067400     MOVE    SPACE TO SQ-FS4R1-F-G-125.
067500*
067600*    CHECK I-O STATUS RETURNED FROM OPEN INPUT
067700*
067800     ADD    1 TO REC-CT.
067900 SEQ-TEST-OP-04-01.
068000     IF SQ-FS4-STATUS = "00"
068100         PERFORM PASS
068200     ELSE
068300         MOVE    SQ-FS4-STATUS TO COMPUTED-A
068400         MOVE   "00" TO CORRECT-A
068500         MOVE   "UNEXPECTED ERROR CODE FROM OPEN INPUT"
068600                   TO RE-MARK
068700         MOVE   "VII-3, VII-23" TO ANSI-REFERENCE
068800         PERFORM FAIL.
068900 SEQ-TEST-04-01-END.
069000*
069100*
069200*    READ THE FIRST (AND ONLY) RECORD FROM THE FILE
069300*
069400 SEQ-INIT-05.
069500     MOVE    0 TO REC-CT.
069600     MOVE   "**" TO SQ-FS4-STATUS.
069700     MOVE   "READ FIRST RECORD"  TO FEATURE.
069800     MOVE   "SEQ-TEST-RD-05" TO PAR-NAME.
069900 SEQ-TEST-RD-05.
070000     READ    SQ-FS4.
070100     MOVE    SQ-FS4R1-F-G-125 TO FILE-RECORD-INFO (2).
070200*
070300*    CHECK I-O STATUS RETURNED FROM READ
070400*
070500     ADD    1 TO REC-CT.
070600 SEQ-TEST-RD-05-01.
070700     IF SQ-FS4-STATUS = "00"
070800         PERFORM PASS
070900     ELSE
071000         MOVE    SQ-FS4-STATUS TO COMPUTED-A
071100         MOVE   "00" TO CORRECT-A
071200         MOVE   "UNEXPECTED I-O STATUS FROM READ"
071300                   TO RE-MARK
071400         MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
071500         PERFORM FAIL.
071600 SEQ-TEST-05-01-END.
071700*
071800*
071900*    READ AGAIN, TO RAISE THE AT END CONDITION
072000*
072100 SEQ-INIT-06.
072200     MOVE    0 TO REC-CT.
072300     MOVE   "**" TO SQ-FS4-STATUS.
072400     MOVE   "READ, GIVING AT END"  TO FEATURE.
072500     MOVE   "SEQ-TEST-RD-06" TO PAR-NAME.
072600 SEQ-TEST-RD-06.
072700     READ    SQ-FS4.
072800*
072900*    CHECK I-O STATUS RETURNED FROM READ
073000*
073100     ADD    1 TO REC-CT.
073200 SEQ-TEST-RD-06-01.
073300     IF SQ-FS4-STATUS = "10"
073400         PERFORM PASS
073500     ELSE
073600         MOVE    SQ-FS4-STATUS TO COMPUTED-A
073700         MOVE   "10" TO CORRECT-A
073800         MOVE   "UNEXPECTED I-O STATUS AT END OF FILE"
073900                   TO RE-MARK
074000         MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
074100         PERFORM FAIL.
074200 SEQ-TEST-06-01-END.
074300*
074400*
074500*    READ AGAIN, AFTER AT END, TO RAISE I-O STATUS 46
074600*
074700 SEQ-INIT-07.
074800     MOVE    0 TO REC-CT.
074900     MOVE   "**" TO SQ-FS4-STATUS.
075000     MOVE   "READ AFTER AT END"  TO FEATURE.
075100     MOVE   "SEQ-TEST-RD-07" TO PAR-NAME.
075200 SEQ-TEST-RD-07.
075300     READ    SQ-FS4.
075400 CCVS-EXIT SECTION.
075500 CCVS-999999.
075600     GO TO   CLOSE-FILES.
