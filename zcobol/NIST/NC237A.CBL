000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     NC237A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100
002200*
002300*    PROGRAM NC237A TESTS FORMAT 2 OF THE "SEARCH" STATEMENT   *
002400*    WITH A THREE-DIMENSIONAL TABLE CONTAINING ASCENDING AND   *
002500*    DESCENDING KEYS.                                          *
002600*                                                              *
002700****************************************************************
002800 ENVIRONMENT DIVISION.
002900 CONFIGURATION SECTION.
003000 SOURCE-COMPUTER.
003100     XXXXX082.
003200 OBJECT-COMPUTER.
003300     XXXXX083.
003400 INPUT-OUTPUT SECTION.
003500 FILE-CONTROL.
003600     SELECT PRINT-FILE ASSIGN TO
003700     XXXXX055.
003800 DATA DIVISION.
003900 FILE SECTION.
004000 FD  PRINT-FILE.
004100 01  PRINT-REC PICTURE X(120).
004200 01  DUMMY-RECORD PICTURE X(120).
004300 WORKING-STORAGE SECTION.
004400 77  IDENT-1  PICTURE S9(18) VALUE ZERO  COMPUTATIONAL.
004500 77  IDENT-2  PICTURE S9(18) VALUE ZERO  COMPUTATIONAL.
004600 77  IDENT-3  PICTURE S9(18) VALUE ZERO  COMPUTATIONAL.
004700 77  IDENT-4  PICTURE 9  VALUE ZERO COMPUTATIONAL.
004800 77  IDENT-5  PICTURE 9  VALUE ZERO COMPUTATIONAL.
004900 77  IDENT-6  PICTURE 9(18) VALUE 3.
005000 77  IDENT-7  PICTURE 9(18) VALUE 1.
005100 77  IDENT-8  PICTURE 9   VALUE 6.
005200 77  IDENT-9  PICTURE 9   VALUE 5.
005300 01  TABLE-TH310.
005400     02  ENTRY-310 OCCURS 9 TIMES ASCENDING GRP
005500         INDEXED BY IDX-1.
005600         03  ENTRY-1.
005700             04  GRP    PIC 99.
005800         03  ENTRY-310-2 OCCURS 9 ASCENDING KEY GRP-1
005900             DESCENDING KEY IS SEC INDEXED BY IDX-2.
006000             04  ENTRY-2.
006100                 05  GRP-1  PIC 99.
006200                 05  SEC    PIC 99.
006300             04  ENTRY-310-3 OCCURS 9 TIMES ASCENDING IS GRP-2
006400             DESCENDING KEY SEC-1 ASCENDING ELEM INDEXED IDX-3.
006500                 05  ENTRY-3.
006600                     06  GRP-2   PICTURE 99.
006700                     06  SEC-1   PICTURE 99.
006800                     06  ELEM    PICTURE 99.
006900 01  ENTRIES-X.
007000     02  ONE-99  PICTURE 99 VALUE 01.
007100     02  TWO-99  PICTURE 99  VALUE 09.
007200     02  THREE-99  PICTURE 99  VALUE 01.
007300 01  CT  PICTURE 999  VALUE 111.
007400 01  SU REDEFINES CT.
007500     02  S1  PICTURE 9.
007600     02  S2  PICTURE 9.
007700     02  S3  PICTURE 9.
007800 01  TEST-RESULTS.
007900     02 FILLER                   PIC X      VALUE SPACE.
008000     02 FEATURE                  PIC X(20)  VALUE SPACE.
008100     02 FILLER                   PIC X      VALUE SPACE.
008200     02 P-OR-F                   PIC X(5)   VALUE SPACE.
008300     02 FILLER                   PIC X      VALUE SPACE.
008400     02  PAR-NAME.
008500       03 FILLER                 PIC X(19)  VALUE SPACE.
008600       03  PARDOT-X              PIC X      VALUE SPACE.
008700       03 DOTVALUE               PIC 99     VALUE ZERO.
008800     02 FILLER                   PIC X(8)   VALUE SPACE.
008900     02 RE-MARK                  PIC X(61).
009000 01  TEST-COMPUTED.
009100     02 FILLER                   PIC X(30)  VALUE SPACE.
009200     02 FILLER                   PIC X(17)  VALUE
009300            "       COMPUTED=".
009400     02 COMPUTED-X.
009500     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
009600     03 COMPUTED-N               REDEFINES COMPUTED-A
009700                                 PIC -9(9).9(9).
009800     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
009900     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
010000     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
010100     03       CM-18V0 REDEFINES COMPUTED-A.
010200         04 COMPUTED-18V0                    PIC -9(18).
010300         04 FILLER                           PIC X.
010400     03 FILLER PIC X(50) VALUE SPACE.
010500 01  TEST-CORRECT.
010600     02 FILLER PIC X(30) VALUE SPACE.
010700     02 FILLER PIC X(17) VALUE "       CORRECT =".
010800     02 CORRECT-X.
010900     03 CORRECT-A                  PIC X(20) VALUE SPACE.
011000     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
011100     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
011200     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
011300     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
011400     03      CR-18V0 REDEFINES CORRECT-A.
011500         04 CORRECT-18V0                     PIC -9(18).
011600         04 FILLER                           PIC X.
011700     03 FILLER PIC X(2) VALUE SPACE.
011800     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
011900 01  CCVS-C-1.
012000     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
012100-    "SS  PARAGRAPH-NAME
012200-    "       REMARKS".
012300     02 FILLER                     PIC X(20)    VALUE SPACE.
012400 01  CCVS-C-2.
012500     02 FILLER                     PIC X        VALUE SPACE.
012600     02 FILLER                     PIC X(6)     VALUE "TESTED".
012700     02 FILLER                     PIC X(15)    VALUE SPACE.
012800     02 FILLER                     PIC X(4)     VALUE "FAIL".
012900     02 FILLER                     PIC X(94)    VALUE SPACE.
013000 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
013100 01  REC-CT                        PIC 99       VALUE ZERO.
013200 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
013300 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
013400 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
013500 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
013600 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
013700 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
013800 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
013900 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
014000 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
014100 01  CCVS-H-1.
014200     02  FILLER                    PIC X(39)    VALUE SPACES.
014300     02  FILLER                    PIC X(42)    VALUE
014400     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
014500     02  FILLER                    PIC X(39)    VALUE SPACES.
014600 01  CCVS-H-2A.
014700   02  FILLER                        PIC X(40)  VALUE SPACE.
014800   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
014900   02  FILLER                        PIC XXXX   VALUE
015000     "4.2 ".
015100   02  FILLER                        PIC X(28)  VALUE
015200            " COPY - NOT FOR DISTRIBUTION".
015300   02  FILLER                        PIC X(41)  VALUE SPACE.
015400
015500 01  CCVS-H-2B.
015600   02  FILLER                        PIC X(15)  VALUE
015700            "TEST RESULT OF ".
015800   02  TEST-ID                       PIC X(9).
015900   02  FILLER                        PIC X(4)   VALUE
016000            " IN ".
016100   02  FILLER                        PIC X(12)  VALUE
016200     " HIGH       ".
016300   02  FILLER                        PIC X(22)  VALUE
016400            " LEVEL VALIDATION FOR ".
016500   02  FILLER                        PIC X(58)  VALUE
016600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
016700 01  CCVS-H-3.
016800     02  FILLER                      PIC X(34)  VALUE
016900            " FOR OFFICIAL USE ONLY    ".
017000     02  FILLER                      PIC X(58)  VALUE
017100     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
017200     02  FILLER                      PIC X(28)  VALUE
017300            "  COPYRIGHT   1985 ".
017400 01  CCVS-E-1.
017500     02 FILLER                       PIC X(52)  VALUE SPACE.
017600     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
017700     02 ID-AGAIN                     PIC X(9).
017800     02 FILLER                       PIC X(45)  VALUE SPACES.
017900 01  CCVS-E-2.
018000     02  FILLER                      PIC X(31)  VALUE SPACE.
018100     02  FILLER                      PIC X(21)  VALUE SPACE.
018200     02 CCVS-E-2-2.
018300         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
018400         03 FILLER                   PIC X      VALUE SPACE.
018500         03 ENDER-DESC               PIC X(44)  VALUE
018600            "ERRORS ENCOUNTERED".
018700 01  CCVS-E-3.
018800     02  FILLER                      PIC X(22)  VALUE
018900            " FOR OFFICIAL USE ONLY".
019000     02  FILLER                      PIC X(12)  VALUE SPACE.
019100     02  FILLER                      PIC X(58)  VALUE
019200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
019300     02  FILLER                      PIC X(13)  VALUE SPACE.
019400     02 FILLER                       PIC X(15)  VALUE
019500             " COPYRIGHT 1985".
019600 01  CCVS-E-4.
019700     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
019800     02 FILLER                       PIC X(4)   VALUE " OF ".
019900     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
020000     02 FILLER                       PIC X(40)  VALUE
020100      "  TESTS WERE EXECUTED SUCCESSFULLY".
020200 01  XXINFO.
020300     02 FILLER                       PIC X(19)  VALUE
020400            "*** INFORMATION ***".
020500     02 INFO-TEXT.
020600       04 FILLER                     PIC X(8)   VALUE SPACE.
020700       04 XXCOMPUTED                 PIC X(20).
020800       04 FILLER                     PIC X(5)   VALUE SPACE.
020900       04 XXCORRECT                  PIC X(20).
021000     02 INF-ANSI-REFERENCE           PIC X(48).
021100 01  HYPHEN-LINE.
021200     02 FILLER  PIC IS X VALUE IS SPACE.
021300     02 FILLER  PIC IS X(65)    VALUE IS "************************
021400-    "*****************************************".
021500     02 FILLER  PIC IS X(54)    VALUE IS "************************
021600-    "******************************".
021700 01  CCVS-PGM-ID                     PIC X(9)   VALUE
021800     "NC237A".
021900 PROCEDURE DIVISION.
022000 CCVS1 SECTION.
022100 OPEN-FILES.
022200     OPEN     OUTPUT PRINT-FILE.
022300     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
022400     MOVE    SPACE TO TEST-RESULTS.
022500     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
022600     GO TO CCVS1-EXIT.
022700 CLOSE-FILES.
022800     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
022900 TERMINATE-CCVS.
023000S    EXIT PROGRAM.
023100STERMINATE-CALL.
023200     STOP     RUN.
023300 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
023400 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
023500 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
023600 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
023700     MOVE "****TEST DELETED****" TO RE-MARK.
023800 PRINT-DETAIL.
023900     IF REC-CT NOT EQUAL TO ZERO
024000             MOVE "." TO PARDOT-X
024100             MOVE REC-CT TO DOTVALUE.
024200     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
024300     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
024400        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
024500          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
024600     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
024700     MOVE SPACE TO CORRECT-X.
024800     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
024900     MOVE     SPACE TO RE-MARK.
025000 HEAD-ROUTINE.
025100     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025200     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025300     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
025400     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
025500 COLUMN-NAMES-ROUTINE.
025600     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025700     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
025900 END-ROUTINE.
026000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
026100 END-RTN-EXIT.
026200     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026300 END-ROUTINE-1.
026400      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
026500      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
026600      ADD PASS-COUNTER TO ERROR-HOLD.
026700*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
026800      MOVE PASS-COUNTER TO CCVS-E-4-1.
026900      MOVE ERROR-HOLD TO CCVS-E-4-2.
027000      MOVE CCVS-E-4 TO CCVS-E-2-2.
027100      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
027200  END-ROUTINE-12.
027300      MOVE "TEST(S) FAILED" TO ENDER-DESC.
027400     IF       ERROR-COUNTER IS EQUAL TO ZERO
027500         MOVE "NO " TO ERROR-TOTAL
027600         ELSE
027700         MOVE ERROR-COUNTER TO ERROR-TOTAL.
027800     MOVE     CCVS-E-2 TO DUMMY-RECORD.
027900     PERFORM WRITE-LINE.
028000 END-ROUTINE-13.
028100     IF DELETE-COUNTER IS EQUAL TO ZERO
028200         MOVE "NO " TO ERROR-TOTAL  ELSE
028300         MOVE DELETE-COUNTER TO ERROR-TOTAL.
028400     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
028500     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028600      IF   INSPECT-COUNTER EQUAL TO ZERO
028700          MOVE "NO " TO ERROR-TOTAL
028800      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
028900      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
029000      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029100     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029200 WRITE-LINE.
029300     ADD 1 TO RECORD-COUNT.
029400Y    IF RECORD-COUNT GREATER 50
029500Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
029600Y        MOVE SPACE TO DUMMY-RECORD
029700Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
029800Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
029900Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
030000Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
030100Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
030200Y        MOVE ZERO TO RECORD-COUNT.
030300     PERFORM WRT-LN.
030400 WRT-LN.
030500     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
030600     MOVE SPACE TO DUMMY-RECORD.
030700 BLANK-LINE-PRINT.
030800     PERFORM WRT-LN.
030900 FAIL-ROUTINE.
031000     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
031100     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
031200     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
031300     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
031400     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031500     MOVE   SPACES TO INF-ANSI-REFERENCE.
031600     GO TO  FAIL-ROUTINE-EX.
031700 FAIL-ROUTINE-WRITE.
031800     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
031900     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
032000     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
032100     MOVE   SPACES TO COR-ANSI-REFERENCE.
032200 FAIL-ROUTINE-EX. EXIT.
032300 BAIL-OUT.
032400     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
032500     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
032600 BAIL-OUT-WRITE.
032700     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
032800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
032900     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033000     MOVE   SPACES TO INF-ANSI-REFERENCE.
033100 BAIL-OUT-EX. EXIT.
033200 CCVS1-EXIT.
033300     EXIT.
033400 SECT-NC237A-001 SECTION.
033500 TH-10-001.
033600*
033700 BUILD-3DEM-TABLE.
033800     MOVE "PERFORM VARYING" TO FEATURE.
033900     SET IDX-1, IDX-2, IDX-3 TO 1.
034000     PERFORM BUILD-TABLE THRU BUILD-EXIT VARYING ONE-99 FROM 1
034100         BY 1 UNTIL ONE-99 EQUAL TO 10 AFTER TWO-99 FROM 9 BY -1
034200         UNTIL TWO-99 EQUAL TO 0 AFTER THREE-99 FROM 1 BY 1
034300         UNTIL THREE-99 EQUAL TO 10.
034400     GO TO IDX-INIT-GF-1.
034500*
034600 BUILD-TABLE.
034700     MOVE ONE-99 TO GRP (IDX-1), GRP-1 (IDX-1, IDX-2),
034800         GRP-2 (IDX-1, IDX-2, IDX-3).
034900     MOVE TWO-99 TO SEC (IDX-1, IDX-2) SEC-1 (IDX-1, IDX-2, IDX-3)
035000     MOVE THREE-99 TO ELEM (IDX-1, IDX-2, IDX-3).
035100     IF CT = 999
035200          MOVE 0 TO CT
035300     ELSE
035400          ADD 1 TO CT.
035500     IF S3 EQUAL TO 0 ADD 1 TO S3.
035600     IF S2 EQUAL TO 0 ADD 1 TO S2.
035700     IF S1 EQUAL TO 0 ADD 1 TO S1.
035800     SET IDX-1 TO S1.
035900     SET IDX-2 TO S2.
036000     SET IDX-3 TO S3.
036100 BUILD-EXIT.
036200     EXIT.
036300*
036400 IDX-INIT-GF-1.
036500     MOVE "IDX-TEST-GF-1" TO PAR-NAME.
036600     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
036700     MOVE "SET AND SEARCH-ALL" TO FEATURE.
036800 IDX-TEST-GF-1.
036900     IF ENTRY-3 (9, 9, 9) EQUAL TO 090109
037000         PERFORM PASS
037100         MOVE "TABLE BUILT CORRECTLY" TO RE-MARK
037200         GO TO IDX-WRITE-GF-1.
037300     GO TO IDX-FAIL-GF-1.
037400 IDX-DELETE-GF-1.
037500     PERFORM DE-LETE.
037600     GO TO IDX-WRITE-GF-1.
037700 IDX-FAIL-GF-1.
037800     MOVE "TABLE CREATED INCORRECTLY" TO RE-MARK.
037900     PERFORM FAIL.
038000 IDX-WRITE-GF-1.
038100     PERFORM PRINT-DETAIL.
038200*
038300 IDX-INIT-GF-2.
038400     MOVE "IDX-TEST-GF-2 " TO PAR-NAME.
038500     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
038600     MOVE "SET AND SEARCH-ALL" TO FEATURE.
038700     MOVE 7 TO IDENT-1.
038800     SET IDX-1  IDX-2  IDX-3 TO IDENT-1.
038900     SET IDX-1  IDX-3 DOWN BY IDENT-6.
039000 IDX-TEST-GF-2.
039100     IF ENTRY-3 (IDX-1, IDX-2, IDX-3) EQUAL TO 040304
039200         PERFORM PASS
039300         GO TO IDX-WRITE-GF-2.
039400     GO TO IDX-FAIL-GF-2.
039500 IDX-DELETE-GF-2.
039600     PERFORM DE-LETE.
039700     GO TO IDX-WRITE-GF-2.
039800 IDX-FAIL-GF-2.
039900     MOVE "040304" TO CORRECT-A.
040000     MOVE ENTRY-3 (IDX-1, IDX-2, IDX-3) TO COMPUTED-A.
040100     PERFORM FAIL.
040200 IDX-WRITE-GF-2.
040300     PERFORM PRINT-DETAIL.
040400*
040500 IDX-INIT-GF-3.
040600     MOVE "IDX-TEST-GF-3" TO PAR-NAME.
040700     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
040800     MOVE "SET AND SEARCH-ALL" TO FEATURE.
040900     MOVE 4 TO IDENT-1.
041000     SET IDX-1 TO IDENT-7.
041100     SET IDX-1 UP BY IDENT-1.
041200 IDX-TEST-GF-3.
041300     IF ENTRY-1 (IDX-1) EQUAL TO "05"
041400         PERFORM PASS
041500         GO TO IDX-WRITE-GF-3.
041600     GO TO IDX-FAIL-GF-3.
041700 IDX-DELETE-GF-3.
041800     PERFORM DE-LETE.
041900     GO TO IDX-WRITE-GF-3.
042000 IDX-FAIL-GF-3.
042100     MOVE ENTRY-1 (IDX-1) TO COMPUTED-A.
042200     MOVE "05" TO CORRECT-A.
042300     PERFORM FAIL.
042400 IDX-WRITE-GF-3.
042500     PERFORM PRINT-DETAIL.
042600*
042700 IDX-INIT-GF-4.
042800     MOVE "IDX-TEST-GF-4" TO PAR-NAME.
042900     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
043000     MOVE "SET AND SEARCH-ALL" TO FEATURE.
043100     MOVE 1 TO IDENT-1.
043200     SET IDX-1  IDX-2 TO IDENT-1.
043300     SET IDX-2 UP BY IDENT-9.
043400     SET IDX-2 UP BY IDENT-6.
043500 IDX-TEST-GF-4.
043600     IF ENTRY-2 (IDX-1, IDX-2) EQUAL TO "0101"
043700         PERFORM PASS
043800         GO TO IDX-WRITE-GF-4.
043900     GO TO IDX-FAIL-GF-4.
044000 IDX-DELETE-GF-4.
044100     PERFORM DE-LETE.
044200     GO TO IDX-WRITE-GF-4.
044300 IDX-FAIL-GF-4.
044400     MOVE "0101" TO CORRECT-A.
044500     MOVE ENTRY-2 (IDX-1, IDX-2) TO COMPUTED-A.
044600     PERFORM FAIL.
044700 IDX-WRITE-GF-4.
044800     PERFORM PRINT-DETAIL.
044900*
045000 IDX-INIT-GF-5.
045100     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
045200     MOVE "SET AND SEARCH-ALL" TO FEATURE.
045300     MOVE "IDX-TEST-GF-5" TO PAR-NAME.
045400     MOVE 1 TO IDENT-1.
045500     SET IDX-1 TO IDENT-6.
045600     SET IDX-1 UP BY IDENT-1.
045700 IDX-TEST-GF-5.
045800     IF ENTRY-1 (IDX-1) EQUAL TO 04
045900         PERFORM PASS
046000         GO TO IDX-WRITE-GF-5.
046100     GO TO IDX-FAIL-GF-5.
046200 IDX-DELETE-GF-5.
046300     PERFORM DE-LETE.
046400     GO TO IDX-WRITE-GF-5.
046500 IDX-FAIL-GF-5.
046600     MOVE "04" TO CORRECT-A.
046700     MOVE ENTRY-1 (IDX-1) TO COMPUTED-A.
046800     PERFORM FAIL.
046900 IDX-WRITE-GF-5.
047000     PERFORM PRINT-DETAIL.
047100*
047200 IDX-INIT-GF-6.
047300     MOVE "IDX-TEST-GF-6" TO PAR-NAME.
047400     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
047500     MOVE "SET AND SEARCH-ALL" TO FEATURE.
047600     SET IDX-3 TO 4.
047700     SET IDX-1  IDX-2 TO IDX-3.
047800     SET IDX-1  IDX-2  IDX-3 DOWN BY IDENT-7.
047900     MOVE 4 TO IDENT-1.
048000     SET IDX-1  IDX-2  IDX-3 UP BY IDENT-1.
048100 IDX-TEST-GF-6.
048200     IF ENTRY-3 (IDX-1, IDX-2, IDX-3) EQUAL TO "070307"
048300         PERFORM PASS
048400         GO TO IDX-WRITE-GF-6.
048500     GO TO IDX-FAIL-GF-6.
048600 IDX-DELETE-GF-6.
048700     PERFORM DE-LETE.
048800     GO TO IDX-WRITE-GF-6.
048900 IDX-FAIL-GF-6.
049000     MOVE ENTRY-3 (IDX-1, IDX-2, IDX-3) TO COMPUTED-A.
049100     MOVE "070307" TO CORRECT-A.
049200     PERFORM FAIL.
049300 IDX-WRITE-GF-6.
049400     PERFORM PRINT-DETAIL.
049500*
049600 IDX-INIT-GF-7.
049700     MOVE "IDX-TEST-GF-7" TO PAR-NAME.
049800     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
049900     MOVE "SET AND SEARCH-ALL" TO FEATURE.
050000     MOVE 3 TO IDENT-1  IDENT-2  IDENT-4.
050100     SET IDX-1 TO IDENT-1.
050200     SET IDX-2 TO IDENT-2.
050300     SET IDX-3 TO IDENT-4.
050400     SET IDX-1  IDX-2  IDX-3 UP BY IDENT-7.
050500 IDX-TEST-GF-7.
050600     IF ENTRY-3 (IDX-1, IDX-2, IDX-3) EQUAL TO "040604"
050700         PERFORM PASS
050800         GO TO IDX-WRITE-GF-7.
050900     GO TO IDX-FAIL-GF-7.
051000 IDX-DELETE-GF-7.
051100     PERFORM DE-LETE.
051200     GO TO IDX-WRITE-GF-7.
051300 IDX-FAIL-GF-7.
051400     MOVE "040604" TO CORRECT-A.
051500     MOVE ENTRY-3 (IDX-1, IDX-2, IDX-3) TO COMPUTED-A.
051600     PERFORM FAIL.
051700 IDX-WRITE-GF-7.
051800     PERFORM PRINT-DETAIL.
051900*
052000 IDX-INIT-GF-8.
052100     MOVE "IDX-TEST-GF-8" TO PAR-NAME.
052200     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
052300     MOVE "SET AND SEARCH-ALL" TO FEATURE.
052400     MOVE 9 TO IDENT-1.
052500     SET IDX-1, IDX-2, IDX-3 TO IDENT-1.
052600     SET IDX-1, IDX-2, IDX-3 DOWN BY 5.
052700 IDX-TEST-GF-8.
052800     IF ENTRY-3 (IDX-1, IDX-2, IDX-3) EQUAL TO "040604"
052900         PERFORM PASS
053000         GO TO IDX-WRITE-GF-8.
053100     GO TO IDX-FAIL-GF-8.
053200 IDX-DELETE-GF-8.
053300     PERFORM DE-LETE.
053400     GO TO IDX-WRITE-GF-8.
053500 IDX-FAIL-GF-8.
053600     MOVE "040604" TO CORRECT-A.
053700     MOVE ENTRY-3 (IDX-1, IDX-2, IDX-3) TO COMPUTED-A.
053800     PERFORM FAIL.
053900 IDX-WRITE-GF-8.
054000     PERFORM PRINT-DETAIL.
054100*
054200 IDX-INIT-F2-9.
054300     MOVE "IDX-TEST-F2-9" TO PAR-NAME.
054400     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
054500     MOVE "SET AND SEARCH-ALL" TO FEATURE.
054600     SET IDX-1 TO 05.
054700 IDX-TEST-F2-9.
054800     SEARCH ALL ENTRY-310-2 END
054900         GO TO IDX-FAIL-F2-9
055000     WHEN GRP-1 (IDX-1, IDX-2) EQUAL TO "05" AND
055100         SEC (IDX-1, IDX-2) EQUAL TO "07"
055200         PERFORM PASS
055300         GO TO IDX-WRITE-F2-9.
055400 IDX-DELETE-F2-9.
055500     PERFORM DE-LETE.
055600     GO TO IDX-WRITE-F2-9.
055700 IDX-FAIL-F2-9.
055800     MOVE ENTRY-2 (05, 03) TO COMPUTED-A
055900     MOVE "0507" TO CORRECT-A
056000     MOVE "SUBSCRIPT USED FOR COMPUTED" TO RE-MARK
056100     PERFORM FAIL.
056200 IDX-WRITE-F2-9.
056300     PERFORM PRINT-DETAIL.
056400*
056500 IDX-INIT-F2-10.
056600     MOVE "IDX-TEST-F2-10" TO PAR-NAME.
056700     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
056800     MOVE "SET AND SEARCH-ALL" TO FEATURE.
056900     SET     IDX-1  IDX-2 TO 9.
057000 IDX-TEST-F2-10.
057100     SEARCH  ALL ENTRY-310-3 END
057200             PERFORM PASS
057300             GO TO   IDX-WRITE-F2-10
057400             WHEN    GRP-2 (IDX-1, IDX-2, IDX-3) EQUAL "09"
057500                 AND SEC-1 (IDX-1, IDX-2, IDX-3) EQUAL "01"
057600                 AND ELEM  (IDX-1, IDX-2, IDX-3) EQUAL "10"
057700                     GO TO   IDX-FAIL-F2-10.
057800 IDX-DELETE-F2-10.
057900     PERFORM DE-LETE.
058000     GO TO IDX-WRITE-F2-10.
058100 IDX-FAIL-F2-10.
058200     MOVE  "090110" TO COMPUTED-A
058300     MOVE  "ENTRY SHOULD NOT BE FOUND" TO RE-MARK
058400     PERFORM FAIL.
058500 IDX-WRITE-F2-10.
058600     PERFORM PRINT-DETAIL.
058700*
058800 IDX-INIT-F2-11.
058900     MOVE "IDX-TEST-F2-11" TO PAR-NAME.
059000     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
059100     MOVE "SET AND SEARCH-ALL" TO FEATURE.
059200     SET IDX-1 TO 09.
059300 IDX-TEST-F2-11.
059400     SEARCH ALL ENTRY-310                                      END
059500         GO TO IDX-FAIL-F2-11
059600     WHEN GRP (IDX-1) EQUAL TO "07"
059700         PERFORM PASS
059800         GO TO IDX-WRITE-F2-11.
059900 IDX-DELETE-F2-11.
060000     PERFORM DE-LETE.
060100     GO TO IDX-WRITE-F2-11.
060200 IDX-FAIL-F2-11.
060300     MOVE ENTRY-1 (07) TO COMPUTED-A
060400     MOVE "07" TO CORRECT-A
060500     PERFORM FAIL
060600     MOVE "SUBSCRIPT USED FOR COMPUTED" TO RE-MARK.
060700 IDX-WRITE-F2-11.
060800     PERFORM PRINT-DETAIL.
060900*
061000 IDX-INIT-F2-12.
061100     MOVE "IDX-TEST-F2-12" TO PAR-NAME.
061200     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
061300     MOVE "SET AND SEARCH-ALL" TO FEATURE.
061400     MOVE 04 TO IDENT-1.
061500     SET IDX-1, IDX-2, IDX-3 TO IDENT-1.
061600     SET IDX-1 UP BY 1.
061700 IDX-TEST-F2-12.
061800     SEARCH ALL ENTRY-310-3 AT END
061900         GO TO IDX-FAIL-F2-12
062000     WHEN GRP-2 (IDX-1, IDX-2, IDX-3) EQUAL TO "05" AND
062100         SEC-1 (IDX-1, IDX-2, IDX-3) EQUAL TO "06" AND
062200             ELEM (IDX-1, IDX-2, IDX-3) EQUAL TO "03"
062300         PERFORM PASS
062400         GO TO IDX-WRITE-F2-12.
062500 IDX-DELETE-F2-12.
062600     PERFORM DE-LETE.
062700     GO TO IDX-WRITE-F2-12.
062800 IDX-FAIL-F2-12.
062900     MOVE ENTRY-3 (05, 04, 03) TO COMPUTED-A
063000     MOVE "SUBSCRIPT USED FOR COMPUTED" TO RE-MARK
063100     MOVE "050603" TO CORRECT-A
063200     PERFORM FAIL.
063300 IDX-WRITE-F2-12.
063400     PERFORM PRINT-DETAIL.
063500*
063600 IDX-INIT-F2-13.
063700     MOVE "IDX-TEST-F2-13" TO PAR-NAME.
063800     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
063900     MOVE "SET AND SEARCH-ALL" TO FEATURE.
064000     SET IDX-1 TO 9.
064100 IDX-TEST-F2-13.
064200     SEARCH ALL ENTRY-310-2 AT END
064300         GO TO IDX-FAIL-F2-13
064400     WHEN GRP-1 (IDX-1, IDX-2) EQUAL TO "09" AND SEC
064500         (IDX-1, IDX-2) EQUAL TO "01"
064600         PERFORM PASS
064700         GO TO IDX-WRITE-F2-13.
064800 IDX-DELETE-F2-13.
064900     PERFORM DE-LETE.
065000     GO TO IDX-WRITE-F2-13.
065100 IDX-FAIL-F2-13.
065200     MOVE ENTRY-2 (09, 09) TO COMPUTED-A
065300     MOVE "SUBSCRIPT USED FOR COMPUTED" TO RE-MARK
065400     MOVE "0901" TO CORRECT-A
065500     PERFORM FAIL.
065600 IDX-WRITE-F2-13.
065700     PERFORM PRINT-DETAIL.
065800*
065900 CCVS-EXIT SECTION.
066000 CCVS-999999.
066100     GO TO CLOSE-FILES.
