000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SM105A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*                                                              *
002200*    PROGRAM NC105A TESTS THE USE OF THE "COPY" STATEMENT IN   *
002300*    THE DATA DIVISION FOR A SORT DESCRIPTION ENTRY AND THE    *
002400*    ASSOCIATED RECORD DESCRIPTION ENTRIES.                    *
002500*                                                              *
002600****************************************************************
002700
002800 ENVIRONMENT DIVISION.
002900 CONFIGURATION SECTION.
003000 SOURCE-COMPUTER.
003100     XXXXX082.
003200 OBJECT-COMPUTER.
003300     XXXXX083.
003400 INPUT-OUTPUT SECTION.
003500 FILE-CONTROL.
003600     SELECT PRINT-FILE ASSIGN TO
003700     XXXXX055.
003800     SELECT SORTFILE-1E ASSIGN TO
003900     XXXXX027.
004000     SELECT SORTOUT-1E ASSIGN TO
004100     XXXXX001.
004200 DATA DIVISION.
004300 FILE SECTION.
004400 FD  PRINT-FILE.
004500 01  PRINT-REC PICTURE X(120).
004600 01  DUMMY-RECORD PICTURE X(120).
004700
004800
004900
005000
005100
005200*
005300*********************** COPY STATEMENT USED **********************
005400*
005500*SD  SORTFILE-1E                                      COPY K5SDA.
005600*
005700******************** COPIED TEXT BEGINS BELOW ********************
005800 SD  SORTFILE-1E                                       COPY K5SDA.
005900*********************** END OF COPIED TEXT ***********************
006000
006100
006200
006300
006400
006500 01  S-RECORD.
006600*
006700*********************** COPY STATEMENT USED **********************
006800*
006900*                                                     COPY K501A.
007000*
007100******************** COPIED TEXT BEGINS BELOW ********************
007200                                                       COPY K501A.
007300*********************** END OF COPIED TEXT ***********************
007400 FD  SORTOUT-1E
007500     BLOCK CONTAINS 10 RECORDS
007600     LABEL RECORDS ARE STANDARD
007700C    VALUE OF
007800C    XXXXX074
007900C    IS
008000C    XXXXX075
008100G    XXXXX069
008200     DATA RECORD SORTED.
008300 01  SORTED PICTURE X(120).
008400 WORKING-STORAGE SECTION.
008500 77  C0 PICTURE 9 VALUE 0.
008600 77  C1 PICTURE 9 VALUE 1.
008700 77  C2 PICTURE 9 VALUE 2.
008800 77  C6 PICTURE 9 VALUE 6.
008900 77  C3 PICTURE 9 VALUE 3.
009000 01  WKEYS-GROUP.
009100     02  WKEY-1  PICTURE 9.
009200     02  WKEY-2  PICTURE 99.
009300     02  WKEY-3  PICTURE 999.
009400     02  WKEY-4  PICTURE 9999.
009500     02  WKEY-5 PICTURE 9(5).
009600 01  WKEYS-RDF REDEFINES WKEYS-GROUP PICTURE 9(15).
009700 01  TEST-RESULTS.
009800     02 FILLER                   PIC X      VALUE SPACE.
009900     02 FEATURE                  PIC X(20)  VALUE SPACE.
010000     02 FILLER                   PIC X      VALUE SPACE.
010100     02 P-OR-F                   PIC X(5)   VALUE SPACE.
010200     02 FILLER                   PIC X      VALUE SPACE.
010300     02  PAR-NAME.
010400       03 FILLER                 PIC X(19)  VALUE SPACE.
010500       03  PARDOT-X              PIC X      VALUE SPACE.
010600       03 DOTVALUE               PIC 99     VALUE ZERO.
010700     02 FILLER                   PIC X(8)   VALUE SPACE.
010800     02 RE-MARK                  PIC X(61).
010900 01  TEST-COMPUTED.
011000     02 FILLER                   PIC X(30)  VALUE SPACE.
011100     02 FILLER                   PIC X(17)  VALUE
011200            "       COMPUTED=".
011300     02 COMPUTED-X.
011400     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
011500     03 COMPUTED-N               REDEFINES COMPUTED-A
011600                                 PIC -9(9).9(9).
011700     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
011800     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
011900     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
012000     03       CM-18V0 REDEFINES COMPUTED-A.
012100         04 COMPUTED-18V0                    PIC -9(18).
012200         04 FILLER                           PIC X.
012300     03 FILLER PIC X(50) VALUE SPACE.
012400 01  TEST-CORRECT.
012500     02 FILLER PIC X(30) VALUE SPACE.
012600     02 FILLER PIC X(17) VALUE "       CORRECT =".
012700     02 CORRECT-X.
012800     03 CORRECT-A                  PIC X(20) VALUE SPACE.
012900     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
013000     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
013100     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
013200     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
013300     03      CR-18V0 REDEFINES CORRECT-A.
013400         04 CORRECT-18V0                     PIC -9(18).
013500         04 FILLER                           PIC X.
013600     03 FILLER PIC X(2) VALUE SPACE.
013700     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
013800 01  CCVS-C-1.
013900     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
014000-    "SS  PARAGRAPH-NAME
014100-    "       REMARKS".
014200     02 FILLER                     PIC X(20)    VALUE SPACE.
014300 01  CCVS-C-2.
014400     02 FILLER                     PIC X        VALUE SPACE.
014500     02 FILLER                     PIC X(6)     VALUE "TESTED".
014600     02 FILLER                     PIC X(15)    VALUE SPACE.
014700     02 FILLER                     PIC X(4)     VALUE "FAIL".
014800     02 FILLER                     PIC X(94)    VALUE SPACE.
014900 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
015000 01  REC-CT                        PIC 99       VALUE ZERO.
015100 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
015200 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
015300 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
015400 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
015500 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
015600 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
015700 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
015800 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
015900 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
016000 01  CCVS-H-1.
016100     02  FILLER                    PIC X(39)    VALUE SPACES.
016200     02  FILLER                    PIC X(42)    VALUE
016300     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
016400     02  FILLER                    PIC X(39)    VALUE SPACES.
016500 01  CCVS-H-2A.
016600   02  FILLER                        PIC X(41)  VALUE SPACE.
016700   02  FILLER                        PIC X(39)  VALUE
016800            "CCVS85  NCC COPY - NOT FOR DISTRIBUTION".
016900   02  FILLER                        PIC X(40)  VALUE SPACE.
017000
017100 01  CCVS-H-2B.
017200   02  FILLER                        PIC X(15)  VALUE
017300            "TEST RESULT OF ".
017400   02  TEST-ID                       PIC X(9).
017500   02  FILLER                        PIC X(4)   VALUE
017600            " IN ".
017700   02  FILLER                        PIC X(12)  VALUE
017800     " HIGH       ".
017900   02  FILLER                        PIC X(22)  VALUE
018000            " LEVEL VALIDATION FOR ".
018100   02  FILLER                        PIC X(58)  VALUE
018200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
018300 01  CCVS-H-3.
018400     02  FILLER                      PIC X(34)  VALUE
018500            " FOR OFFICIAL USE ONLY    ".
018600     02  FILLER                      PIC X(58)  VALUE
018700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
018800     02  FILLER                      PIC X(28)  VALUE
018900            "  COPYRIGHT   1985 ".
019000 01  CCVS-E-1.
019100     02 FILLER                       PIC X(52)  VALUE SPACE.
019200     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
019300     02 ID-AGAIN                     PIC X(9).
019400     02 FILLER                       PIC X(45)  VALUE
019500            " NTIS DISTRIBUTION COBOL 85".
019600 01  CCVS-E-2.
019700     02  FILLER                      PIC X(31)  VALUE SPACE.
019800     02  FILLER                      PIC X(21)  VALUE SPACE.
019900     02 CCVS-E-2-2.
020000         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
020100         03 FILLER                   PIC X      VALUE SPACE.
020200         03 ENDER-DESC               PIC X(44)  VALUE
020300            "ERRORS ENCOUNTERED".
020400 01  CCVS-E-3.
020500     02  FILLER                      PIC X(22)  VALUE
020600            " FOR OFFICIAL USE ONLY".
020700     02  FILLER                      PIC X(12)  VALUE SPACE.
020800     02  FILLER                      PIC X(58)  VALUE
020900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
021000     02  FILLER                      PIC X(13)  VALUE SPACE.
021100     02 FILLER                       PIC X(15)  VALUE
021200             " COPYRIGHT 1985".
021300 01  CCVS-E-4.
021400     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
021500     02 FILLER                       PIC X(4)   VALUE " OF ".
021600     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
021700     02 FILLER                       PIC X(40)  VALUE
021800      "  TESTS WERE EXECUTED SUCCESSFULLY".
021900 01  XXINFO.
022000     02 FILLER                       PIC X(19)  VALUE
022100            "*** INFORMATION ***".
022200     02 INFO-TEXT.
022300       04 FILLER                     PIC X(8)   VALUE SPACE.
022400       04 XXCOMPUTED                 PIC X(20).
022500       04 FILLER                     PIC X(5)   VALUE SPACE.
022600       04 XXCORRECT                  PIC X(20).
022700     02 INF-ANSI-REFERENCE           PIC X(48).
022800 01  HYPHEN-LINE.
022900     02 FILLER  PIC IS X VALUE IS SPACE.
023000     02 FILLER  PIC IS X(65)    VALUE IS "************************
023100-    "*****************************************".
023200     02 FILLER  PIC IS X(54)    VALUE IS "************************
023300-    "******************************".
023400 01  CCVS-PGM-ID                     PIC X(9)   VALUE
023500     "SM105A".
023600 PROCEDURE DIVISION.
023700 CCVS1 SECTION.
023800 OPEN-FILES.
023900     OPEN     OUTPUT PRINT-FILE.
024000     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
024100     MOVE    SPACE TO TEST-RESULTS.
024200     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
024300     GO TO CCVS1-EXIT.
024400 CLOSE-FILES.
024500     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
024600 TERMINATE-CCVS.
024700S    EXIT PROGRAM.
024800STERMINATE-CALL.
024900     STOP     RUN.
025000 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
025100 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
025200 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
025300 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
025400     MOVE "****TEST DELETED****" TO RE-MARK.
025500 PRINT-DETAIL.
025600     IF REC-CT NOT EQUAL TO ZERO
025700             MOVE "." TO PARDOT-X
025800             MOVE REC-CT TO DOTVALUE.
025900     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
026000     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
026100        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
026200          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
026300     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
026400     MOVE SPACE TO CORRECT-X.
026500     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
026600     MOVE     SPACE TO RE-MARK.
026700 HEAD-ROUTINE.
026800     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026900     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027000     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
027100     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
027200 COLUMN-NAMES-ROUTINE.
027300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
027600 END-ROUTINE.
027700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
027800 END-RTN-EXIT.
027900     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028000 END-ROUTINE-1.
028100      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
028200      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
028300      ADD PASS-COUNTER TO ERROR-HOLD.
028400*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
028500      MOVE PASS-COUNTER TO CCVS-E-4-1.
028600      MOVE ERROR-HOLD TO CCVS-E-4-2.
028700      MOVE CCVS-E-4 TO CCVS-E-2-2.
028800      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
028900  END-ROUTINE-12.
029000      MOVE "TEST(S) FAILED" TO ENDER-DESC.
029100     IF       ERROR-COUNTER IS EQUAL TO ZERO
029200         MOVE "NO " TO ERROR-TOTAL
029300         ELSE
029400         MOVE ERROR-COUNTER TO ERROR-TOTAL.
029500     MOVE     CCVS-E-2 TO DUMMY-RECORD.
029600     PERFORM WRITE-LINE.
029700 END-ROUTINE-13.
029800     IF DELETE-COUNTER IS EQUAL TO ZERO
029900         MOVE "NO " TO ERROR-TOTAL  ELSE
030000         MOVE DELETE-COUNTER TO ERROR-TOTAL.
030100     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
030200     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030300      IF   INSPECT-COUNTER EQUAL TO ZERO
030400          MOVE "NO " TO ERROR-TOTAL
030500      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
030600      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
030700      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030800     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030900 WRITE-LINE.
031000     ADD 1 TO RECORD-COUNT.
031100Y    IF RECORD-COUNT GREATER 50
031200Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
031300Y        MOVE SPACE TO DUMMY-RECORD
031400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
031500Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
031600Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
031700Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
031800Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
031900Y        MOVE ZERO TO RECORD-COUNT.
032000     PERFORM WRT-LN.
032100 WRT-LN.
032200     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
032300     MOVE SPACE TO DUMMY-RECORD.
032400 BLANK-LINE-PRINT.
032500     PERFORM WRT-LN.
032600 FAIL-ROUTINE.
032700     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
032800     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
032900     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
033000     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
033100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033200     MOVE   SPACES TO INF-ANSI-REFERENCE.
033300     GO TO  FAIL-ROUTINE-EX.
033400 FAIL-ROUTINE-WRITE.
033500     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
033600     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
033700     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
033800     MOVE   SPACES TO COR-ANSI-REFERENCE.
033900 FAIL-ROUTINE-EX. EXIT.
034000 BAIL-OUT.
034100     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
034200     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
034300 BAIL-OUT-WRITE.
034400     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
034500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
034600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034700     MOVE   SPACES TO INF-ANSI-REFERENCE.
034800 BAIL-OUT-EX. EXIT.
034900 CCVS1-EXIT.
035000     EXIT.
035100 SORT-INIT SECTION.
035200 I-1.
035300     SORT SORTFILE-1E
035400     ON ASCENDING KEY KEY-1
035500     ON DESCENDING KEY KEY-2
035600     ON ASCENDING KEY KEY-3
035700     DESCENDING KEY-4 KEY-5
035800     INPUT PROCEDURE IS INSORT
035900     OUTPUT PROCEDURE IS OUTP1 THRU OUTP3.
036000 I-2.
036100     GO TO    CLOSE-FILES.
036200 INSORT SECTION.
036300 IN-2.
036400     MOVE 900009000000000 TO RDF-KEYS.
036500     RELEASE S-RECORD.
036600     MOVE 009000000900009 TO RDF-KEYS.
036700     RELEASE S-RECORD.
036800     MOVE 900008000000000 TO RDF-KEYS.
036900     RELEASE S-RECORD.
037000     MOVE 009000000900008 TO RDF-KEYS.
037100     RELEASE S-RECORD.
037200*    NOTE HI-LOW CONTROL RECORDS DONE.
037300     MOVE 300003000000000 TO WKEYS-RDF.
037400 IN-3.
037500     PERFORM IN-4 2 TIMES.
037600     GO TO IN-EXIT.
037700 IN-4.
037800     SUBTRACT C1 FROM WKEY-1.
037900     PERFORM IN-5 6 TIMES.
038000 IN-5.
038100     IF WKEY-2 IS EQUAL TO C6
038200         MOVE C0 TO WKEY-2.
038300     ADD C1 TO WKEY-2.
038400     PERFORM IN-6 2 TIMES.
038500 IN-6.
038600     IF WKEY-3 IS EQUAL TO C1
038700         MOVE C3 TO WKEY-3.
038800     SUBTRACT C1 FROM WKEY-3.
038900     PERFORM IN-7 2 TIMES.
039000 IN-7.
039100     IF WKEY-4 EQUAL TO C2
039200         MOVE C0 TO WKEY-4.
039300     ADD C1 TO WKEY-4.
039400     PERFORM IN-8 2 TIMES.
039500 IN-8.
039600     IF WKEY-5 IS EQUAL TO C2
039700         MOVE C0 TO WKEY-5.
039800     ADD C1 TO WKEY-5.
039900     MOVE WKEYS-RDF TO RDF-KEYS.
040000     RELEASE S-RECORD.
040100 IN-EXIT.
040200     EXIT.
040300 OUTP1 SECTION.
040400 SM105-INIT.
040500     OPEN     OUTPUT SORTOUT-1E.
040600     MOVE     "COPY SORT DESCR" TO FEATURE.
040700 COPY-TEST-1.
040800     PERFORM  RET-1.
040900     IF       RDF-KEYS EQUAL TO 009000000900009
041000              PERFORM PASS-1 GO TO COPY-WRITE-1.
041100     GO       TO COPY-FAIL-1-1.
041200 COPY-DELETE-1.
041300     PERFORM  DE-LETE-1.
041400     GO       TO COPY-WRITE-1.
041500 COPY-FAIL-1-1.
041600     MOVE     RDF-KEYS TO COMPUTED-18V0.
041700     MOVE     009000000900009 TO CORRECT-18V0.
041800     PERFORM  FAIL-1.
041900 COPY-WRITE-1.
042000     MOVE     "COPY-TEST-1 " TO PAR-NAME.
042100     PERFORM  PRINT-DETAIL-1.
042200 COPY-TEST-2.
042300     PERFORM  RET-1.
042400     IF       RDF-KEYS EQUAL TO 009000000900008
042500              PERFORM PASS-1 GO TO COPY-WRITE-2.
042600     GO       TO COPY-FAIL-1-2.
042700 COPY-DELETE-2.
042800     PERFORM  DE-LETE-1.
042900     GO       TO COPY-WRITE-2.
043000 COPY-FAIL-1-2.
043100     MOVE     RDF-KEYS TO COMPUTED-18V0.
043200     MOVE     009000000900008 TO CORRECT-18V0.
043300     PERFORM  FAIL-1.
043400 COPY-WRITE-2.
043500     MOVE     "COPY-TEST-2 " TO PAR-NAME.
043600     PERFORM  PRINT-DETAIL-1.
043700 COPY-TEST-3.
043800     PERFORM  RET-1.
043900     IF       RDF-KEYS EQUAL TO 106001000200002
044000              PERFORM PASS-1 GO TO COPY-WRITE-3.
044100     GO       TO COPY-FAIL-1-3.
044200 COPY-DELETE-3.
044300     PERFORM  DE-LETE-1.
044400     GO       TO COPY-WRITE-3.
044500 COPY-FAIL-1-3.
044600     MOVE     RDF-KEYS TO COMPUTED-18V0.
044700     MOVE     106001000200002 TO CORRECT-18V0.
044800     PERFORM  FAIL-1.
044900 COPY-WRITE-3.
045000     MOVE     "COPY-TEST-3 " TO PAR-NAME.
045100     PERFORM  PRINT-DETAIL-1.
045200 OUTP2 SECTION.
045300 COPY-TEST-4.
045400     PERFORM  RET-2 48 TIMES.
045500     IF       RDF-KEYS EQUAL TO 206001000200002
045600              PERFORM PASS-1 GO TO COPY-WRITE-4.
045700     GO       TO COPY-FAIL-1-4.
045800 COPY-DELETE-4.
045900     PERFORM  DE-LETE-1.
046000     GO       TO COPY-WRITE-4.
046100 COPY-FAIL-1-4.
046200     MOVE     RDF-KEYS TO COMPUTED-18V0.
046300     MOVE     206001000200002 TO CORRECT-18V0.
046400     PERFORM  FAIL-1.
046500 COPY-WRITE-4.
046600     MOVE     "COPY-TEST-4 " TO PAR-NAME.
046700     PERFORM  PRINT-DETAIL-1.
046800 COPY-TEST-5.
046900     PERFORM  RET-2 40 TIMES.
047000     IF       RDF-KEYS EQUAL TO 201001000200002
047100              PERFORM PASS-1 GO TO COPY-WRITE-5.
047200     GO       TO COPY-FAIL-1-5.
047300 COPY-DELETE-5.
047400     PERFORM  DE-LETE-1.
047500     GO       TO COPY-WRITE-5.
047600 COPY-FAIL-1-5.
047700     MOVE     RDF-KEYS TO COMPUTED-18V0.
047800     MOVE     201001000200002 TO CORRECT-18V0.
047900     PERFORM  FAIL-1.
048000 COPY-WRITE-5.
048100     MOVE     "COPY-TEST-5 " TO PAR-NAME.
048200     PERFORM  PRINT-DETAIL-1.
048300 COPY-TEST-6.
048400     PERFORM  RET-2  7 TIMES.
048500     IF       RDF-KEYS EQUAL TO 201002000100001
048600              PERFORM PASS-1 GO TO COPY-WRITE-6.
048700     GO       TO COPY-FAIL-1-6.
048800 COPY-DELETE-6.
048900     PERFORM  DE-LETE-1.
049000     GO       TO COPY-WRITE-6.
049100 COPY-FAIL-1-6.
049200     MOVE     RDF-KEYS TO COMPUTED-18V0.
049300     MOVE     201002000100001 TO CORRECT-18V0.
049400     PERFORM  FAIL-1.
049500 COPY-WRITE-6.
049600     MOVE     "COPY-TEST-6 " TO PAR-NAME.
049700     PERFORM  PRINT-DETAIL-1.
049800 COPY-TEST-7.
049900     PERFORM  RET-2.
050000     IF       RDF-KEYS EQUAL TO 900008000000000
050100              PERFORM PASS-1 GO TO COPY-WRITE-7.
050200     GO       TO COPY-FAIL-1-7.
050300 COPY-DELETE-7.
050400     PERFORM  DE-LETE-1.
050500     GO       TO COPY-WRITE-7.
050600 COPY-FAIL-1-7.
050700     MOVE     RDF-KEYS TO COMPUTED-18V0.
050800     MOVE     900008000000000 TO CORRECT-18V0.
050900     PERFORM  FAIL-1.
051000 COPY-WRITE-7.
051100     MOVE     "COPY-TEST-7 " TO PAR-NAME.
051200     PERFORM  PRINT-DETAIL-1.
051300 COPY-TEST-8.
051400     PERFORM  RET-2.
051500     IF       RDF-KEYS EQUAL TO 900009000000000
051600              PERFORM PASS-1 GO TO COPY-WRITE-8.
051700     GO       TO COPY-FAIL-1-8.
051800 COPY-DELETE-8.
051900     PERFORM  DE-LETE-1.
052000     GO       TO COPY-WRITE-8.
052100 COPY-FAIL-1-8.
052200     MOVE     RDF-KEYS TO COMPUTED-18V0.
052300     MOVE     900009000000000 TO CORRECT-18V0.
052400     PERFORM  FAIL-1.
052500 COPY-WRITE-8.
052600     MOVE     "COPY-TEST-8 " TO PAR-NAME.
052700     PERFORM  PRINT-DETAIL-1.
052800 COPY-TEST-9.
052900     RETURN   SORTFILE-1E END
053000              PERFORM PASS-1 GO TO COPY-WRITE-9.
053100*    NOTE     THE FOLLOWING STATEMENTS SHOULD NOT BE EXECUTED.
053200     PERFORM  FAIL-1.
053300     MOVE     RDF-KEYS TO COMPUTED-18V0.
053400     MOVE     "END OF FILE NOT FOUND" TO RE-MARK.
053500     GO       TO COPY-WRITE-9.
053600 COPY-DELETE-9.
053700     PERFORM  DE-LETE-1.
053800 COPY-WRITE-9.
053900     MOVE     "COPY-TEST-9 " TO PAR-NAME.
054000     PERFORM  PRINT-DETAIL-1.
054100 OUTP3 SECTION.
054200 RET-0.
054300     CLOSE    SORTOUT-1E.
054400     GO       TO LIB1E-EXIT.
054500 RET-1.
054600     RETURN   SORTFILE-1E RECORD AT END GO TO BAD-FILE.
054700     MOVE     S-RECORD TO SORTED.
054800     WRITE    SORTED.
054900 RET-2.
055000     RETURN   SORTFILE-1E           END GO TO BAD-FILE.
055100     MOVE     S-RECORD TO SORTED.
055200     WRITE    SORTED.
055300 BAD-FILE.
055400     PERFORM  FAIL-1.
055500     MOVE     "BAD-FILE" TO PAR-NAME.
055600     MOVE     "EOF PREMATURELY FOUND" TO RE-MARK.
055700     PERFORM  PRINT-DETAIL-1.
055800     CLOSE    SORTOUT-1E.
055900     GO TO    LIB1E-EXIT.
056000 INSPT-1. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
056100 PASS-1.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
056200 FAIL-1.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
056300 DE-LETE-1.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
056400     MOVE "****TEST DELETED****" TO RE-MARK.
056500 PRINT-DETAIL-1.
056600     IF REC-CT NOT EQUAL TO ZERO
056700             MOVE "." TO PARDOT-X
056800             MOVE REC-CT TO DOTVALUE.
056900     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE-1.
057000     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE-1
057100        PERFORM FAIL-ROUTINE-1 THRU FAIL-ROUTINE-EX-1
057200          ELSE PERFORM BAIL-OUT-1 THRU BAIL-OUT-EX-1.
057300     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
057400     MOVE SPACE TO CORRECT-X.
057500     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
057600     MOVE     SPACE TO RE-MARK.
057700 WRITE-LINE-1.
057800     ADD 1 TO RECORD-COUNT.
057900Y    IF RECORD-COUNT GREATER 50
058000Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
058100Y        MOVE SPACE TO DUMMY-RECORD
058200Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
058300Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN-1
058400Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN-1 2 TIMES
058500Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN-1
058600Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
058700Y        MOVE ZERO TO RECORD-COUNT.
058800     PERFORM WRT-LN-1.
058900 WRT-LN-1.
059000     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
059100     MOVE SPACE TO DUMMY-RECORD.
059200 BLANK-LINE-PRINT-1.
059300     PERFORM WRT-LN-1.
059400 FAIL-ROUTINE-1.
059500     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-1.
059600     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-1.
059700     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
059800     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-1 2 TIMES.
059900     GO TO FAIL-ROUTINE-EX-1.
060000 FAIL-RTN-WRITE-1.
060100     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE-1
060200     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE-1 2 TIMES.
060300 FAIL-ROUTINE-EX-1. EXIT.
060400 BAIL-OUT-1.
060500     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE-1.
060600     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX-1.
060700 BAIL-OUT-WRITE-1.
060800     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
060900     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-1 2 TIMES.
061000 BAIL-OUT-EX-1. EXIT.
061100 LIB1E-EXIT.
061200     EXIT.
