000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST119A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100 ENVIRONMENT DIVISION.
002200 CONFIGURATION SECTION.
002300 SOURCE-COMPUTER.
002400     XXXXX082.
002500 OBJECT-COMPUTER.
002600     XXXXX083.
002700 INPUT-OUTPUT SECTION.
002800 FILE-CONTROL.
002900     SELECT PRINT-FILE ASSIGN TO
003000     XXXXX055.
003100     SELECT SORTFILE-1A ASSIGN TO
003200     XXXXX027.
003300     SELECT SORTOUT-1A ASSIGN TO
003400     XXXXP001.
003500 DATA DIVISION.
003600 FILE SECTION.
003700 FD  PRINT-FILE.
003800 01  PRINT-REC PICTURE X(120).
003900 01  DUMMY-RECORD PICTURE X(120).
004000 SD  SORTFILE-1A
004100     DATA RECORD IS S-RECORD.
004200 01  S-RECORD.
004300     02  KEYS-GROUP.
004400         03  KEY-1 PICTURE 9.
004500         03  KEY-2 PICTURE 99.
004600         03  KEY-3 PICTURE 999.
004700         03  KEY-4 PICTURE 9999.
004800         03  KEY-5 PICTURE 9(5).
004900     02  RDF-KEYS REDEFINES KEYS-GROUP PICTURE 9(15).
005000     02  FILLER PICTURE X(105).
005100 FD  SORTOUT-1A
005200     BLOCK CONTAINS 10 RECORDS
005300     LABEL RECORDS ARE STANDARD
005400C    VALUE OF
005500C    XXXXX074
005600C    IS
005700C    XXXXX075
005800G    XXXXX069
005900     DATA RECORD IS SORTED.
006000 01  SORTED PICTURE X(120).
006100 WORKING-STORAGE SECTION.
006200 77  COMMENT-SENTENCE PIC X(120) VALUE " THE FILE BUILT IN ST119A
006300-    "IS SORTED IN ST120A.  ST120A DOES NOT PRODUCE A REPORT - THE
006400-    " RESULTS ARE CHECKED IN ST121A.".
006500 77  WRK-XN-00001-1  PIC X.
006600 77  WRK-XN-00001-2  PIC X.
006700 77  WRK-XN-00001-3  PIC X.
006800 77  C0 PICTURE 9 VALUE 0.
006900 77  C1 PICTURE 9 VALUE 1.
007000 77  C2 PICTURE 9 VALUE 2.
007100 77  C6 PICTURE 9 VALUE 6.
007200 77  C3 PICTURE 9 VALUE 3.
007300 01  WKEYS-GROUP.
007400     02  WKEY-1 PICTURE 9.
007500     02  WKEY-2 PICTURE 99.
007600     02  WKEY-3 PICTURE 999.
007700     02  WKEY-4 PICTURE 9999.
007800     02  WKEY-5 PICTURE 9(5).
007900 01  WKEYS-RDF REDEFINES WKEYS-GROUP PICTURE 9(15).
008000 01  TEST-RESULTS.
008100     02 FILLER                   PIC X      VALUE SPACE.
008200     02 FEATURE                  PIC X(20)  VALUE SPACE.
008300     02 FILLER                   PIC X      VALUE SPACE.
008400     02 P-OR-F                   PIC X(5)   VALUE SPACE.
008500     02 FILLER                   PIC X      VALUE SPACE.
008600     02  PAR-NAME.
008700       03 FILLER                 PIC X(19)  VALUE SPACE.
008800       03  PARDOT-X              PIC X      VALUE SPACE.
008900       03 DOTVALUE               PIC 99     VALUE ZERO.
009000     02 FILLER                   PIC X(8)   VALUE SPACE.
009100     02 RE-MARK                  PIC X(61).
009200 01  TEST-COMPUTED.
009300     02 FILLER                   PIC X(30)  VALUE SPACE.
009400     02 FILLER                   PIC X(17)  VALUE
009500            "       COMPUTED=".
009600     02 COMPUTED-X.
009700     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
009800     03 COMPUTED-N               REDEFINES COMPUTED-A
009900                                 PIC -9(9).9(9).
010000     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
010100     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
010200     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
010300     03       CM-18V0 REDEFINES COMPUTED-A.
010400         04 COMPUTED-18V0                    PIC -9(18).
010500         04 FILLER                           PIC X.
010600     03 FILLER PIC X(50) VALUE SPACE.
010700 01  TEST-CORRECT.
010800     02 FILLER PIC X(30) VALUE SPACE.
010900     02 FILLER PIC X(17) VALUE "       CORRECT =".
011000     02 CORRECT-X.
011100     03 CORRECT-A                  PIC X(20) VALUE SPACE.
011200     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
011300     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
011400     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
011500     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
011600     03      CR-18V0 REDEFINES CORRECT-A.
011700         04 CORRECT-18V0                     PIC -9(18).
011800         04 FILLER                           PIC X.
011900     03 FILLER PIC X(2) VALUE SPACE.
012000     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
012100 01  CCVS-C-1.
012200     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
012300-    "SS  PARAGRAPH-NAME
012400-    "       REMARKS".
012500     02 FILLER                     PIC X(20)    VALUE SPACE.
012600 01  CCVS-C-2.
012700     02 FILLER                     PIC X        VALUE SPACE.
012800     02 FILLER                     PIC X(6)     VALUE "TESTED".
012900     02 FILLER                     PIC X(15)    VALUE SPACE.
013000     02 FILLER                     PIC X(4)     VALUE "FAIL".
013100     02 FILLER                     PIC X(94)    VALUE SPACE.
013200 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
013300 01  REC-CT                        PIC 99       VALUE ZERO.
013400 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
013500 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
013600 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
013700 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
013800 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
013900 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
014000 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
014100 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
014200 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
014300 01  CCVS-H-1.
014400     02  FILLER                    PIC X(39)    VALUE SPACES.
014500     02  FILLER                    PIC X(42)    VALUE
014600     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
014700     02  FILLER                    PIC X(39)    VALUE SPACES.
014800 01  CCVS-H-2A.
014900   02  FILLER                        PIC X(40)  VALUE SPACE.
015000   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
015100   02  FILLER                        PIC XXXX   VALUE
015200     "4.2 ".
015300   02  FILLER                        PIC X(28)  VALUE
015400            " COPY - NOT FOR DISTRIBUTION".
015500   02  FILLER                        PIC X(41)  VALUE SPACE.
015600
015700 01  CCVS-H-2B.
015800   02  FILLER                        PIC X(15)  VALUE
015900            "TEST RESULT OF ".
016000   02  TEST-ID                       PIC X(9).
016100   02  FILLER                        PIC X(4)   VALUE
016200            " IN ".
016300   02  FILLER                        PIC X(12)  VALUE
016400     " HIGH       ".
016500   02  FILLER                        PIC X(22)  VALUE
016600            " LEVEL VALIDATION FOR ".
016700   02  FILLER                        PIC X(58)  VALUE
016800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
016900 01  CCVS-H-3.
017000     02  FILLER                      PIC X(34)  VALUE
017100            " FOR OFFICIAL USE ONLY    ".
017200     02  FILLER                      PIC X(58)  VALUE
017300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
017400     02  FILLER                      PIC X(28)  VALUE
017500            "  COPYRIGHT   1985 ".
017600 01  CCVS-E-1.
017700     02 FILLER                       PIC X(52)  VALUE SPACE.
017800     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
017900     02 ID-AGAIN                     PIC X(9).
018000     02 FILLER                       PIC X(45)  VALUE SPACES.
018100 01  CCVS-E-2.
018200     02  FILLER                      PIC X(31)  VALUE SPACE.
018300     02  FILLER                      PIC X(21)  VALUE SPACE.
018400     02 CCVS-E-2-2.
018500         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
018600         03 FILLER                   PIC X      VALUE SPACE.
018700         03 ENDER-DESC               PIC X(44)  VALUE
018800            "ERRORS ENCOUNTERED".
018900 01  CCVS-E-3.
019000     02  FILLER                      PIC X(22)  VALUE
019100            " FOR OFFICIAL USE ONLY".
019200     02  FILLER                      PIC X(12)  VALUE SPACE.
019300     02  FILLER                      PIC X(58)  VALUE
019400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
019500     02  FILLER                      PIC X(13)  VALUE SPACE.
019600     02 FILLER                       PIC X(15)  VALUE
019700             " COPYRIGHT 1985".
019800 01  CCVS-E-4.
019900     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
020000     02 FILLER                       PIC X(4)   VALUE " OF ".
020100     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
020200     02 FILLER                       PIC X(40)  VALUE
020300      "  TESTS WERE EXECUTED SUCCESSFULLY".
020400 01  XXINFO.
020500     02 FILLER                       PIC X(19)  VALUE
020600            "*** INFORMATION ***".
020700     02 INFO-TEXT.
020800       04 FILLER                     PIC X(8)   VALUE SPACE.
020900       04 XXCOMPUTED                 PIC X(20).
021000       04 FILLER                     PIC X(5)   VALUE SPACE.
021100       04 XXCORRECT                  PIC X(20).
021200     02 INF-ANSI-REFERENCE           PIC X(48).
021300 01  HYPHEN-LINE.
021400     02 FILLER  PIC IS X VALUE IS SPACE.
021500     02 FILLER  PIC IS X(65)    VALUE IS "************************
021600-    "*****************************************".
021700     02 FILLER  PIC IS X(54)    VALUE IS "************************
021800-    "******************************".
021900 01  CCVS-PGM-ID                     PIC X(9)   VALUE
022000     "ST119A".
022100 PROCEDURE DIVISION.
022200 CCVS1 SECTION.
022300 OPEN-FILES.
022400     OPEN     OUTPUT PRINT-FILE.
022500     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
022600     MOVE    SPACE TO TEST-RESULTS.
022700     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
022800     GO TO CCVS1-EXIT.
022900 CLOSE-FILES.
023000     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
023100 TERMINATE-CCVS.
023200S    EXIT PROGRAM.
023300STERMINATE-CALL.
023400     STOP     RUN.
023500 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
023600 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
023700 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
023800 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
023900     MOVE "****TEST DELETED****" TO RE-MARK.
024000 PRINT-DETAIL.
024100     IF REC-CT NOT EQUAL TO ZERO
024200             MOVE "." TO PARDOT-X
024300             MOVE REC-CT TO DOTVALUE.
024400     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
024500     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
024600        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
024700          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
024800     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
024900     MOVE SPACE TO CORRECT-X.
025000     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
025100     MOVE     SPACE TO RE-MARK.
025200 HEAD-ROUTINE.
025300     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025400     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025500     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
025600     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
025700 COLUMN-NAMES-ROUTINE.
025800     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025900     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
026100 END-ROUTINE.
026200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
026300 END-RTN-EXIT.
026400     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026500 END-ROUTINE-1.
026600      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
026700      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
026800      ADD PASS-COUNTER TO ERROR-HOLD.
026900*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
027000      MOVE PASS-COUNTER TO CCVS-E-4-1.
027100      MOVE ERROR-HOLD TO CCVS-E-4-2.
027200      MOVE CCVS-E-4 TO CCVS-E-2-2.
027300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
027400  END-ROUTINE-12.
027500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
027600     IF       ERROR-COUNTER IS EQUAL TO ZERO
027700         MOVE "NO " TO ERROR-TOTAL
027800         ELSE
027900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
028000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
028100     PERFORM WRITE-LINE.
028200 END-ROUTINE-13.
028300     IF DELETE-COUNTER IS EQUAL TO ZERO
028400         MOVE "NO " TO ERROR-TOTAL  ELSE
028500         MOVE DELETE-COUNTER TO ERROR-TOTAL.
028600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
028700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028800      IF   INSPECT-COUNTER EQUAL TO ZERO
028900          MOVE "NO " TO ERROR-TOTAL
029000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
029100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
029200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029400 WRITE-LINE.
029500     ADD 1 TO RECORD-COUNT.
029600Y    IF RECORD-COUNT GREATER 42
029700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
029800Y        MOVE SPACE TO DUMMY-RECORD
029900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
030000Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
030100Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
030200Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
030300Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
030400Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
030500Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
030600Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
030700Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
030800Y        MOVE ZERO TO RECORD-COUNT.
030900     PERFORM WRT-LN.
031000 WRT-LN.
031100     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
031200     MOVE SPACE TO DUMMY-RECORD.
031300 BLANK-LINE-PRINT.
031400     PERFORM WRT-LN.
031500 FAIL-ROUTINE.
031600     IF     COMPUTED-X NOT EQUAL TO SPACE
031700            GO TO   FAIL-ROUTINE-WRITE.
031800     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
031900     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
032000     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
032100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032200     MOVE   SPACES TO INF-ANSI-REFERENCE.
032300     GO TO  FAIL-ROUTINE-EX.
032400 FAIL-ROUTINE-WRITE.
032500     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
032600     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
032700     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
032800     MOVE   SPACES TO COR-ANSI-REFERENCE.
032900 FAIL-ROUTINE-EX. EXIT.
033000 BAIL-OUT.
033100     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
033200     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
033300 BAIL-OUT-WRITE.
033400     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
033500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
033600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033700     MOVE   SPACES TO INF-ANSI-REFERENCE.
033800 BAIL-OUT-EX. EXIT.
033900 CCVS1-EXIT.
034000     EXIT.
034100
034200 SORT-INIT SECTION.
034300 MAIN-SORT-PARAGRAPH.
034400     SORT SORTFILE-1A
034500     ON ASCENDING KEY KEY-1
034600     ON DESCENDING KEY KEY-2
034700     ON ASCENDING KEY KEY-3
034800     DESCENDING KEY-4 KEY-5
034900     INPUT PROCEDURE IS IN-1 THROUGH IN-EXIT
035000     OUTPUT PROCEDURE IS OUT-PROC-1 THRU SORT-END.
035100
035200 INTERNAL-OUTPUT-PROC-CODE SECTION.
035300*=================================
035400 INT-INIT-1.
035500*    ===--> ACCESSING OF CODE WITHIN THE OUTPUT PROCEDURE <--===
035600     MOVE   "XI-19 4.4.4 GR(10)" TO ANSI-REFERENCE.
035700     MOVE   "INT-TEST-1"       TO PAR-NAME.
035800     MOVE   "INTNL CODE PERFORMED" TO FEATURE.
035900     MOVE    SPACE TO WRK-XN-00001-1.
036000     PERFORM INTERNAL-CODE-1.
036100     GO TO   INT-TEST-1.
036200 INT-DELETE-1.
036300     PERFORM DE-LETE.
036400     PERFORM PRINT-DETAIL.
036500     GO TO   INT-INIT-2.
036600 INT-TEST-1.
036700     IF      WRK-XN-00001-1 = "C"
036800             PERFORM PASS
036900             PERFORM PRINT-DETAIL
037000     ELSE
037100             MOVE   "INTERNAL OUTPUT PROC CODE NOT PERFORMED"
037200                  TO RE-MARK
037300             MOVE   "C" TO CORRECT-X
037400             MOVE    WRK-XN-00001-1 TO COMPUTED-X
037500             PERFORM FAIL
037600             PERFORM PRINT-DETAIL.
037700
037800 INT-INIT-2.
037900*    ===--> ACCESSING OF CODE WITHIN THE OUTPUT PROCEDURE <--===
038000     MOVE   "XI-19 4.4.4 GR(10)"  TO ANSI-REFERENCE.
038100     MOVE   "INT-TEST-2-1"      TO PAR-NAME.
038200     MOVE   "GO TO INTERNAL CODE" TO FEATURE.
038300     MOVE    SPACE TO WRK-XN-00001-1.
038400     MOVE   "Y"    TO WRK-XN-00001-2.
038500     MOVE    1 TO REC-CT.
038600     GO TO   INTERNAL-CODE-2.
038700 INT-FAIL-2-1.
038800     MOVE   "X"    TO WRK-XN-00001-2.
038900     GO TO   INT-TEST-2-2.
039000 INT-DELETE-2-1.
039100     PERFORM DE-LETE.
039200     PERFORM PRINT-DETAIL.
039300     GO TO   INT-INIT-3.
039400 INT-TEST-2-1.
039500     IF      WRK-XN-00001-2 = "Y"
039600             PERFORM PASS
039700             PERFORM PRINT-DETAIL
039800             GO TO   INT-TEST-2-2.
039900     MOVE   "GO TO INTERNAL CODE ERROR OR RETURN FROM CODE ERROR"
040000          TO RE-MARK.
040100     MOVE   "Y" TO CORRECT-X.
040200     MOVE    WRK-XN-00001-2 TO COMPUTED-X.
040300     PERFORM FAIL.
040400     PERFORM PRINT-DETAIL.
040500 INT-TEST-2-2.
040600     MOVE   "INT-TEST-2-1"      TO PAR-NAME.
040700     ADD     1 TO REC-CT.
040800     IF      WRK-XN-00001-1 = "D"
040900             PERFORM PASS
041000             PERFORM PRINT-DETAIL
041100     ELSE
041200             MOVE   "GO TO INTERNAL OUTPUT PROC. CODE ERROR"
041300                  TO RE-MARK
041400             MOVE   "D" TO CORRECT-X
041500             MOVE    WRK-XN-00001-1 TO COMPUTED-X
041600             PERFORM FAIL
041700             PERFORM PRINT-DETAIL.
041800
041900 INTERNAL-INPUT-PROC-CODE SECTION.
042000*================================
042100 INT-INIT-3.
042200*    ===--> ACCESSING OF CODE WITHIN THE INPUT PROCEDURE <--===
042300     MOVE   "XI-19 4.4.4 GR(7)" TO ANSI-REFERENCE.
042400     MOVE   "INT-TEST-3"       TO PAR-NAME.
042500     MOVE   "INTNL CODE PERFORMED" TO FEATURE.
042600     MOVE    SPACE TO WRK-XN-00001-1.
042700     PERFORM INTERNAL-CODE-3.
042800     GO TO   INT-TEST-3.
042900 INT-DELETE-3.
043000     PERFORM DE-LETE.
043100     PERFORM PRINT-DETAIL.
043200     GO TO   INT-INIT-4.
043300 INT-TEST-3.
043400     IF      WRK-XN-00001-1 = "L"
043500             PERFORM PASS
043600             PERFORM PRINT-DETAIL
043700     ELSE
043800             MOVE   "INTERNAL INPUT PROC CODE NOT PERFORMED"
043900                  TO RE-MARK
044000             MOVE   "L" TO CORRECT-X
044100             MOVE    WRK-XN-00001-1 TO COMPUTED-X
044200             PERFORM FAIL
044300             PERFORM PRINT-DETAIL.
044400
044500 INT-INIT-4.
044600*    ===--> ACCESSING OF CODE WITHIN THE OUTPUT PROCEDURE <--===
044700     MOVE   "XI-19 4.4.4 GR(7)"  TO ANSI-REFERENCE.
044800     MOVE   "INT-TEST-4-1"      TO PAR-NAME.
044900     MOVE   "GO TO INTERNAL CODE" TO FEATURE.
045000     MOVE    SPACE TO WRK-XN-00001-1.
045100     MOVE   "N"    TO WRK-XN-00001-2.
045200     MOVE    1 TO REC-CT.
045300     GO TO   INTERNAL-CODE-4.
045400 INT-FAIL-4-1.
045500     MOVE   "O"    TO WRK-XN-00001-2.
045600     GO TO   INT-TEST-4-1.
045700 INT-DELETE-4.
045800     PERFORM DE-LETE.
045900     PERFORM PRINT-DETAIL.
046000     GO TO   I-2.
046100 INT-TEST-4-1.
046200     IF      WRK-XN-00001-2 = "N"
046300             PERFORM PASS
046400             PERFORM PRINT-DETAIL
046500             GO TO   INT-TEST-4-2.
046600     MOVE   "GO TO INTERNAL CODE ERROR OR RETURN FROM CODE ERROR"
046700          TO RE-MARK.
046800     MOVE   "N" TO CORRECT-X.
046900     MOVE    WRK-XN-00001-2 TO COMPUTED-X.
047000     PERFORM FAIL.
047100     PERFORM PRINT-DETAIL.
047200 INT-TEST-4-2.
047300     MOVE   "INT-TEST-4-2"      TO PAR-NAME.
047400     ADD     1 TO REC-CT.
047500     IF      WRK-XN-00001-1 = "M"
047600             PERFORM PASS
047700             PERFORM PRINT-DETAIL
047800     ELSE
047900             MOVE   "GO TO INTERNAL OUTPUT PROC. CODE ERROR"
048000                  TO RE-MARK
048100             MOVE   "M" TO CORRECT-X
048200             MOVE    WRK-XN-00001-1 TO COMPUTED-X
048300             PERFORM FAIL
048400             PERFORM PRINT-DETAIL.
048500
048600 I-2.
048700     GO TO   CCVS-EXIT.
048800
048900 IN-1.
049000 INPT-INIT-1.
049100*    ===--> ACCESSING OF CODE OUTSIDE THE INPUT PROCEDURE <--===
049200     MOVE   "XI-19 4.4.4 GR(7)" TO ANSI-REFERENCE.
049300     MOVE   "INPT-TEST-1"       TO PAR-NAME.
049400     MOVE   "PERFORM EXTNL CODE" TO FEATURE.
049500     MOVE    SPACE TO WRK-XN-00001-1.
049600     PERFORM EXTERNAL-CODE-3.
049700     GO TO   INPT-TEST-1.
049800 INPT-DELETE-1.
049900     PERFORM DE-LETE.
050000     PERFORM PRINT-DETAIL.
050100     GO TO   INPT-INIT-2.
050200 INPT-TEST-1.
050300     IF      WRK-XN-00001-1 = "J"
050400             PERFORM PASS
050500             PERFORM PRINT-DETAIL
050600     ELSE
050700             MOVE   "EXTERNAL CODE NOT PERFORMED FROM INPUT PROC"
050800                  TO RE-MARK
050900             MOVE   "J" TO CORRECT-X
051000             MOVE    WRK-XN-00001-1 TO COMPUTED-X
051100             PERFORM FAIL
051200             PERFORM PRINT-DETAIL.
051300
051400 INPT-INIT-2.
051500     MOVE   "XI-19 4.4.4 GR(7)"  TO ANSI-REFERENCE.
051600     MOVE   "INPT-TEST-2-1"      TO PAR-NAME.
051700     MOVE   "GO TO EXTERNAL CODE" TO FEATURE.
051800     MOVE    SPACE TO WRK-XN-00001-1.
051900     MOVE   "S"    TO WRK-XN-00001-2.
052000     MOVE    1 TO REC-CT.
052100     GO TO   EXTERNAL-CODE-4.
052200 INPT-FAIL-2-1.
052300     MOVE   "W"    TO WRK-XN-00001-1.
052400     GO TO   INPT-TEST-2-1.
052500 INPT-DELETE-2.
052600     PERFORM DE-LETE.
052700     PERFORM PRINT-DETAIL.
052800     GO TO   IN-2.
052900 INPT-TEST-2-1.
053000     IF      WRK-XN-00001-2 = "S"
053100             PERFORM PASS
053200             PERFORM PRINT-DETAIL
053300             GO TO   INPT-TEST-2-2.
053400     MOVE   "GO TO EXTERNAL CODE ERROR OR RETURN FROM CODE ERROR"
053500          TO RE-MARK.
053600     MOVE   "S" TO CORRECT-X.
053700     MOVE    WRK-XN-00001-2 TO COMPUTED-X.
053800     PERFORM FAIL.
053900     PERFORM PRINT-DETAIL.
054000 INPT-TEST-2-2.
054100     MOVE   "INPT-TEST-2-1"      TO PAR-NAME.
054200     ADD     1 TO REC-CT.
054300     IF      WRK-XN-00001-1 = "K"
054400             PERFORM PASS
054500             PERFORM PRINT-DETAIL
054600     ELSE
054700             MOVE   "GO TO EXTERNAL CODE ERROR"
054800                  TO RE-MARK
054900             MOVE   "K" TO CORRECT-X
055000             MOVE    WRK-XN-00001-1 TO COMPUTED-X
055100             PERFORM FAIL
055200             PERFORM PRINT-DETAIL.
055300     GO TO   IN-2.
055400*
055500*    THE FOLLOWING CODE IS ACCESSED FROM OUTSIDE THE INPUT
055600*    PROCEEDURE:
055700*
055800 INTERNAL-CODE-3.
055900     MOVE   "L" TO WRK-XN-00001-1.
056000 INTERNAL-CODE-4.
056100     MOVE   "M" TO WRK-XN-00001-1.
056200     GO TO   INT-TEST-4-1.
056300*
056400*    NOTE.
056500*       KEYS 1 AND 3 THRU 5 WILL VARY IN VALUE BETWEEN 1 AND 2.
056600*       KEY 2 VARIES FROM 1 THRU 6. THUS 96 RECORDS ARE CREATED
056700*       IN REVERSE SEQUENCE OF SORTING ORDER. TWO RECORDS ARE
056800*       ADDED TO EACH END OF THE SORTED STRING FOR HI-LOW CONTROL.
056900*       THE SORT STATEMENT TESTS THE SERIES AND THRU OPTIONS WITH
057000*       INCLUSION AND OMISSION OF OPTIONAL WORDS. THE SORT
057100*       STATEMENT REPRESENTS BASIC SORTING PERMITTED BY LEVEL 1 OF
057200*       THE SORT MODULE.
057300 IN-2.
057400     MOVE 900009000000000 TO RDF-KEYS.
057500     RELEASE S-RECORD.
057600     MOVE 009000000900009 TO RDF-KEYS.
057700     RELEASE S-RECORD.
057800     MOVE 900008000000000 TO RDF-KEYS.
057900     RELEASE S-RECORD.
058000     MOVE 009000000900008 TO RDF-KEYS.
058100     RELEASE S-RECORD.
058200*    NOTE HI-LOW CONTROL RECORDS DONE.
058300     MOVE 300003000000000 TO WKEYS-RDF.
058400 IN-3.
058500     PERFORM IN-4 2 TIMES.
058600     GO TO IN-EXIT.
058700 IN-4.
058800     SUBTRACT C1 FROM WKEY-1.
058900     PERFORM IN-5 6 TIMES.
059000 IN-5.
059100     IF WKEY-2 IS EQUAL TO C6
059200         MOVE C0 TO WKEY-2.
059300     ADD C1 TO WKEY-2.
059400     PERFORM IN-6 2 TIMES.
059500 IN-6.
059600     IF WKEY-3 IS EQUAL TO C1
059700         MOVE C3 TO WKEY-3.
059800     SUBTRACT C1 FROM WKEY-3.
059900     PERFORM IN-7 2 TIMES.
060000 IN-7.
060100     IF WKEY-4 IS EQUAL TO C2
060200         MOVE C0 TO WKEY-4.
060300     ADD C1 TO WKEY-4.
060400     PERFORM IN-8 2 TIMES.
060500 IN-8.
060600     IF WKEY-5 IS EQUAL TO C2
060700         MOVE C0 TO WKEY-5.
060800     ADD C1 TO WKEY-5.
060900     MOVE WKEYS-RDF TO RDF-KEYS.
061000     RELEASE S-RECORD.
061100 IN-EXIT.
061200     EXIT.
061300
061400 OUT-PROC-1.
061500     MOVE    SPACES TO PAR-NAME.
061600     MOVE    SPACES TO FEATURE.
061700     MOVE    ZERO TO REC-CT.
061800     MOVE   "XI-19 4.4.4 GR(7)" TO ANSI-REFERENCE.
061900     MOVE   "ST119 GENERATES OUTPUT" TO RE-MARK.
062000     PERFORM PRINT-DETAIL.
062100     MOVE   "WHICH AFFECTS PROGRAMS" TO RE-MARK.
062200     PERFORM PRINT-DETAIL.
062300     MOVE   "ST120 AND ST121."       TO RE-MARK.
062400     PERFORM PRINT-DETAIL.
062500     MOVE   "SORT --- FIVE KEYS" TO FEATURE.
062600     OPEN    OUTPUT SORTOUT-1A.
062700 SORT-TEST-1.
062800     PERFORM  RET-1.
062900     IF       RDF-KEYS EQUAL TO 009000000900009
063000              PERFORM PASS GO TO SORT-WRITE-1.
063100     GO       TO SORT-FAIL-1.
063200 SORT-DELETE-1.
063300     PERFORM  DE-LETE.
063400     GO       TO SORT-WRITE-1.
063500 SORT-FAIL-1.
063600     MOVE     RDF-KEYS TO COMPUTED-18V0.
063700     MOVE     009000000900009 TO CORRECT-18V0.
063800     PERFORM  FAIL.
063900 SORT-WRITE-1.
064000     MOVE     "SORT-TEST-1 " TO PAR-NAME.
064100     PERFORM  PRINT-DETAIL.
064200 SORT-TEST-2.
064300     PERFORM  RET-1.
064400     IF       RDF-KEYS EQUAL TO 009000000900008
064500              PERFORM PASS GO TO SORT-WRITE-2.
064600     GO       TO SORT-FAIL-2.
064700 SORT-DELETE-2.
064800     PERFORM  DE-LETE.
064900     GO       TO SORT-WRITE-2.
065000 SORT-FAIL-2.
065100     MOVE     RDF-KEYS TO COMPUTED-18V0.
065200     MOVE     009000000900009 TO CORRECT-18V0.
065300     PERFORM  FAIL.
065400 SORT-WRITE-2.
065500     MOVE     "SORT-TEST-2 " TO PAR-NAME.
065600     PERFORM  PRINT-DETAIL.
065700 SORT-TEST-3.
065800     PERFORM  RET-1.
065900     IF       RDF-KEYS EQUAL TO 106001000200002
066000              PERFORM PASS GO TO SORT-WRITE-3.
066100     GO       TO SORT-FAIL-3.
066200 SORT-DELETE-3.
066300     PERFORM  DE-LETE.
066400     GO       TO SORT-WRITE-3.
066500 SORT-FAIL-3.
066600     MOVE     RDF-KEYS TO COMPUTED-18V0.
066700     MOVE     106001000200002  TO CORRECT-18V0.
066800     PERFORM  FAIL.
066900 SORT-WRITE-3.
067000     MOVE     "SORT-TEST-3 " TO PAR-NAME.
067100     PERFORM  PRINT-DETAIL.
067200
067300 SORT-TEST-4.
067400     PERFORM  RET-2 48 TIMES.
067500     IF       RDF-KEYS EQUAL TO 206001000200002
067600              PERFORM PASS GO TO SORT-WRITE-4.
067700     GO       TO SORT-FAIL-4.
067800 SORT-DELETE-4.
067900     PERFORM  DE-LETE.
068000     GO       TO SORT-WRITE-4.
068100 SORT-FAIL-4.
068200     MOVE     RDF-KEYS TO COMPUTED-18V0.
068300     MOVE    206001000200002 TO CORRECT-18V0.
068400     PERFORM  FAIL.
068500 SORT-WRITE-4.
068600     MOVE     "SORT-TEST-4 " TO PAR-NAME.
068700     PERFORM  PRINT-DETAIL.
068800 SORT-TEST-5.
068900     PERFORM  RET-2 40 TIMES.
069000     IF       RDF-KEYS EQUAL TO 201001000200002
069100              PERFORM PASS GO TO SORT-WRITE-5.
069200     GO       TO SORT-FAIL-5.
069300 SORT-DELETE-5.
069400     PERFORM  DE-LETE.
069500     GO       TO SORT-WRITE-5.
069600 SORT-FAIL-5.
069700     MOVE     RDF-KEYS TO COMPUTED-18V0.
069800     MOVE     201001000200002 TO CORRECT-18V0.
069900     PERFORM  FAIL.
070000 SORT-WRITE-5.
070100     MOVE     "SORT-TEST-5 " TO PAR-NAME.
070200     PERFORM  PRINT-DETAIL.
070300 SORT-TEST-6.
070400     PERFORM  RET-2.
070500     PERFORM  RET-3 THRU RET-3-EXIT.
070600     PERFORM  RET-4 THRU RET-4-EXIT.
070700     PERFORM  RET-5 THRU RET-5-EXIT.
070800     PERFORM  RET-6 THRU RET-6-EXIT.
070900     PERFORM  RET-7 THRU RET-7-EXIT.
071000     PERFORM  RET-8 THRU RET-8-EXIT.
071100     IF       RDF-KEYS EQUAL TO 201002000100001
071200              PERFORM PASS GO TO SORT-WRITE-6.
071300     GO       TO SORT-FAIL-6.
071400 SORT-DELETE-6.
071500     PERFORM  DE-LETE.
071600     GO       TO SORT-WRITE-6.
071700 SORT-FAIL-6.
071800     MOVE     RDF-KEYS TO COMPUTED-18V0.
071900     MOVE     201002000100001 TO CORRECT-18V0.
072000     PERFORM  FAIL.
072100 SORT-WRITE-6.
072200     MOVE     "SORT-TEST-6 " TO PAR-NAME.
072300     PERFORM  PRINT-DETAIL.
072400 SORT-TEST-7.
072500     PERFORM  RET-2.
072600     IF       RDF-KEYS EQUAL TO 900008000000000
072700              PERFORM PASS GO TO SORT-WRITE-7.
072800     GO       TO SORT-FAIL-7.
072900 SORT-DELETE-7.
073000     PERFORM  DE-LETE.
073100     GO       TO SORT-WRITE-7.
073200 SORT-FAIL-7.
073300     MOVE     RDF-KEYS TO COMPUTED-18V0.
073400     MOVE     900008000000000 TO CORRECT-18V0.
073500     PERFORM  FAIL.
073600 SORT-WRITE-7.
073700     MOVE     "SORT-TEST-7 " TO PAR-NAME.
073800     PERFORM  PRINT-DETAIL.
073900 SORT-TEST-8.
074000     PERFORM  RET-2.
074100     IF       RDF-KEYS EQUAL TO 900009000000000
074200              PERFORM PASS GO TO SORT-WRITE-8.
074300     GO       TO SORT-FAIL-8.
074400 SORT-DELETE-8.
074500     PERFORM  DE-LETE.
074600     GO       TO SORT-WRITE-8.
074700 SORT-FAIL-8.
074800     MOVE     RDF-KEYS TO COMPUTED-18V0.
074900     MOVE     900009000000000 TO CORRECT-18V0.
075000     PERFORM  FAIL.
075100 SORT-WRITE-8.
075200     MOVE     "SORT-TEST-8 " TO PAR-NAME.
075300     PERFORM  PRINT-DETAIL.
075400 SORT-TEST-9.
075500     RETURN   SORTFILE-1A AT END
075600              PERFORM PASS GO TO SORT-WRITE-9.
075700     GO       TO SORT-FAIL-9.
075800 SORT-DELETE-9.
075900     PERFORM  DE-LETE.
076000     GO       TO SORT-WRITE-9.
076100 SORT-FAIL-9.
076200     MOVE     RDF-KEYS TO COMPUTED-18V0.
076300     MOVE     "END OF FILE NOT FOUND" TO RE-MARK.
076400     PERFORM  FAIL.
076500 SORT-WRITE-9.
076600     MOVE     "SORT-TEST-9 " TO PAR-NAME.
076700     PERFORM  PRINT-DETAIL.
076800 SORT-INIT-10.
076900     MOVE   "XI-19 4.4.4 GR(10)" TO ANSI-REFERENCE.
077000     MOVE   "SORT-TEST-10"       TO PAR-NAME.
077100     MOVE   "PERFORM EXTNL CODE" TO FEATURE.
077200     MOVE    SPACE TO WRK-XN-00001-1.
077300     PERFORM EXTERNAL-CODE-1.
077400     GO TO   SORT-TEST-10.
077500 SORT-DELETE-10.
077600     PERFORM DE-LETE.
077700     PERFORM PRINT-DETAIL.
077800     GO TO   SORT-INIT-11.
077900 SORT-TEST-10.
078000     IF      WRK-XN-00001-1 = "A"
078100             PERFORM PASS
078200             PERFORM PRINT-DETAIL
078300     ELSE
078400             MOVE   "EXTERNAL CODE NOT PERFORMED FROM OUTPUT PROC"
078500                  TO RE-MARK
078600             MOVE   "A" TO CORRECT-X
078700             MOVE    WRK-XN-00001-1 TO COMPUTED-X
078800             PERFORM FAIL
078900             PERFORM PRINT-DETAIL.
079000
079100 SORT-INIT-11.
079200     MOVE   "XI-19 4.4.4 GR(10)"  TO ANSI-REFERENCE.
079300     MOVE   "SORT-TEST-11-1"      TO PAR-NAME.
079400     MOVE   "GO TO EXTERNAL CODE" TO FEATURE.
079500     MOVE    SPACE TO WRK-XN-00001-1.
079600     MOVE   "D"    TO WRK-XN-00001-2.
079700     MOVE    1 TO REC-CT.
079800     GO TO   EXTERNAL-CODE-2.
079900 SORT-FAIL-11-1.
080000     MOVE   "Z"    TO WRK-XN-00001-2.
080100     GO TO   SORT-TEST-11-1.
080200 SORT-DELETE-11.
080300     PERFORM DE-LETE.
080400     PERFORM PRINT-DETAIL.
080500     GO TO   SORT-INIT-11.
080600 SORT-TEST-11-1.
080700     IF      WRK-XN-00001-2 = "D"
080800             PERFORM PASS
080900             PERFORM PRINT-DETAIL
081000             GO TO   SORT-TEST-11-2.
081100     MOVE   "GO TO EXTERNAL CODE ERROR OR RETURN FROM CODE ERROR"
081200          TO RE-MARK.
081300     MOVE   "D" TO CORRECT-X.
081400     MOVE    WRK-XN-00001-2 TO COMPUTED-X.
081500     PERFORM FAIL.
081600     PERFORM PRINT-DETAIL.
081700 SORT-TEST-11-2.
081800     MOVE   "SORT-TEST-11-2"      TO PAR-NAME.
081900     ADD     1 TO REC-CT.
082000     IF      WRK-XN-00001-1 = "B"
082100             PERFORM PASS
082200             PERFORM PRINT-DETAIL
082300     ELSE
082400             MOVE   "GO TO EXTERNAL CODE ERROR"
082500                  TO RE-MARK
082600             MOVE   "B" TO CORRECT-X
082700             MOVE    WRK-XN-00001-1 TO COMPUTED-X
082800             PERFORM FAIL
082900             PERFORM PRINT-DETAIL.
083000     GO TO   SORT-END.
083100*
083200*    THE FOLLOWING CODE IS ACCESSED FROM OUTSIDE THE OUTPUT
083300*    PROCEEDURE:
083400*
083500 INTERNAL-CODE-1.
083600     MOVE  "C" TO WRK-XN-00001-1.
083700 INTERNAL-CODE-2.
083800     MOVE  "D" TO WRK-XN-00001-1.
083900     GO TO  INT-TEST-2-1.
084000
084100 SORT-END.
084200     CLOSE  SORTOUT-1A.
084300
084400 BAD-FILE.
084500     MOVE   "BAD-FILE" TO PAR-NAME.
084600     PERFORM FAIL.
084700     MOVE   "END OF FILE PREMATURELY" TO RE-MARK.
084800     PERFORM PRINT-DETAIL.
084900     MOVE   "REACHED, PREVIOUS TEST WAS" TO RE-MARK.
085000     PERFORM PRINT-DETAIL.
085100     MOVE   "THE LAST SUCCESSFUL TEST." TO RE-MARK.
085200     PERFORM PRINT-DETAIL.
085300     MOVE    SPACE TO FEATURE.
085400     GO TO   CCVS-EXIT.
085500 RET-1.
085600     RETURN  SORTFILE-1A RECORD AT END GO TO BAD-FILE.
085700     MOVE     S-RECORD TO SORTED.
085800     WRITE    SORTED.
085900*    NOTE     THE RETURN VERB WITH ALL OPTIONAL WORDS.
086000 RET-2.
086100     RETURN  SORTFILE-1A           END GO TO BAD-FILE.
086200     MOVE    S-RECORD TO SORTED.
086300     WRITE   SORTED.
086400*    NOTE    THE RETURN VERB WITHOUT OPTIONAL WORDS.
086500 RET-3.
086600     MOVE   "XI-14 4.3.4 GR(2) & (4)" TO ANSI-REFERENCE.
086700     MOVE   "RET-3" TO PAR-NAME.
086800     RETURN  SORTFILE-1A
086900             AT END  GO TO BAD-FILE
087000         NOT AT END
087100             PERFORM PASS
087200             PERFORM PRINT-DETAIL
087300             MOVE    S-RECORD TO SORTED
087400             WRITE   SORTED
087500             GO TO RET-3-EXIT.
087600 RET-3-EXIT.
087700     EXIT.
087800 RET-4.
087900     MOVE   "XI-14 4.3.4 GR(2) & (4)" TO ANSI-REFERENCE.
088000     MOVE   "RET-4" TO PAR-NAME.
088100     MOVE   "A"     TO WRK-XN-00001-3.
088200     RETURN  SORTFILE-1A
088300             AT END  GO TO BAD-FILE
088400     END-RETURN
088500     MOVE   "S" TO WRK-XN-00001-3.
088600     MOVE    S-RECORD TO SORTED.
088700     WRITE   SORTED.
088800     IF      WRK-XN-00001-3 = "S"
088900             PERFORM PASS
089000             PERFORM PRINT-DETAIL
089100     ELSE
089200             MOVE   "SCOPE DELIMITER IGNORED" TO RE-MARK
089300             MOVE   "S" TO CORRECT-X
089400             MOVE    WRK-XN-00001-3 TO COMPUTED-X
089500             PERFORM FAIL
089600             PERFORM PRINT-DETAIL.
089700 RET-4-EXIT.
089800     EXIT.
089900 RET-5.
090000     MOVE   "XI-14 4.3.4 GR(2) & (4)" TO ANSI-REFERENCE.
090100     MOVE   "RET-5" TO PAR-NAME.
090200     RETURN  SORTFILE-1A
090300             AT END
090400             PERFORM FAIL
090500             PERFORM PRINT-DETAIL
090600             GO TO   BAD-FILE
090700         NOT AT END
090800             PERFORM PASS
090900             PERFORM PRINT-DETAIL
091000             MOVE    S-RECORD TO SORTED
091100             WRITE   SORTED.
091200 RET-5-EXIT.
091300     EXIT.
091400 RET-6.
091500     MOVE   "XI-14 4.3.4 GR(2) & (4)" TO ANSI-REFERENCE.
091600     MOVE   "RET-6" TO PAR-NAME.
091700     MOVE   "V" TO WRK-XN-00001-3.
091800     RETURN  SORTFILE-1A
091900             AT END
092000             GO TO BAD-FILE
092100     END-RETURN
092200     MOVE   "W"     TO WRK-XN-00001-3.
092300     MOVE    S-RECORD TO SORTED.
092400     WRITE   SORTED.
092500     IF      WRK-XN-00001-3 = "W"
092600             PERFORM PASS
092700             PERFORM PRINT-DETAIL
092800     ELSE
092900             MOVE   "SCOPE DELIMITER IGNORED" TO RE-MARK
093000             MOVE   "W" TO CORRECT-X
093100             MOVE    WRK-XN-00001-3 TO COMPUTED-X
093200             PERFORM FAIL
093300             PERFORM PRINT-DETAIL.
093400 RET-6-EXIT.
093500     EXIT.
093600 RET-7.
093700     MOVE   "XI-14 4.3.4 GR(2) & (4)" TO ANSI-REFERENCE.
093800     MOVE   "RET-7" TO PAR-NAME.
093900     MOVE   "G" TO WRK-XN-00001-3.
094000     RETURN  SORTFILE-1A
094100             AT END  GO TO BAD-FILE
094200             NOT AT END
094300             MOVE    S-RECORD TO SORTED
094400             WRITE   SORTED
094500     END-RETURN
094600     MOVE   "K"     TO WRK-XN-00001-3.
094700     IF      WRK-XN-00001-3 = "K"
094800             PERFORM PASS
094900             PERFORM PRINT-DETAIL
095000     ELSE
095100             MOVE   "SCOPE DELIMITER IGNORED" TO RE-MARK
095200             MOVE   "K" TO CORRECT-X
095300             MOVE    WRK-XN-00001-3 TO COMPUTED-X
095400             PERFORM FAIL
095500             PERFORM PRINT-DETAIL.
095600 RET-7-EXIT.
095700     EXIT.
095800 RET-8.
095900     MOVE   "XI-14 4.3.4 GR(2) & (4)" TO ANSI-REFERENCE.
096000     MOVE   "RET-8" TO PAR-NAME.
096100     MOVE   "X" TO WRK-XN-00001-3.
096200     RETURN  SORTFILE-1A
096300             AT END
096400             GO TO BAD-FILE
096500         NOT AT END
096600             MOVE    S-RECORD TO SORTED
096700             WRITE   SORTED
096800     END-RETURN
096900     MOVE   "T"     TO WRK-XN-00001-3.
097000     IF      WRK-XN-00001-3 = "T"
097100             PERFORM PASS
097200             PERFORM PRINT-DETAIL
097300     ELSE
097400             MOVE   "SCOPE DELIMITER IGNORED" TO RE-MARK
097500             MOVE   "T" TO CORRECT-X
097600             MOVE    WRK-XN-00001-3 TO COMPUTED-X
097700             PERFORM FAIL
097800             PERFORM PRINT-DETAIL.
097900     MOVE SPACES TO TEST-RESULTS.
098000     MOVE COMMENT-SENTENCE TO TEST-RESULTS.
098100     PERFORM PRINT-DETAIL.
098200     MOVE SPACES TO TEST-RESULTS.
098300 RET-8-EXIT.
098400     EXIT.
098500
098600 EXTERNAL-CODE-1.
098700     MOVE   "A" TO WRK-XN-00001-1.
098800 EXTERNAL-CODE-2.
098900     MOVE   "B" TO WRK-XN-00001-1.
099000     GO TO   SORT-TEST-11-1.
099100 EXTERNAL-CODE-3.
099200     MOVE   "J" TO WRK-XN-00001-1.
099300 EXTERNAL-CODE-4.
099400     MOVE   "K" TO WRK-XN-00001-1.
099500     GO TO   INPT-TEST-2-1.
099600
099700 CCVS-EXIT SECTION.
099800 CCVS-9999.
099900     GO TO   CLOSE-FILES.
