000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IF121A.
000400
000500***********************************************************
000600*                                                         *
000700* This program forms part of the CCVS85 COBOL Test Suite. *
000800* It contains tests for the Intrinsic Function MEDIAN.    *
000900*                                                         *
001000***********************************************************
001100 ENVIRONMENT DIVISION.
001200 CONFIGURATION SECTION.
001300 SOURCE-COMPUTER.
001400     XXXXX082.
001500 OBJECT-COMPUTER.
001600     XXXXX083.
001700 INPUT-OUTPUT SECTION.
001800 FILE-CONTROL.
001900     SELECT PRINT-FILE ASSIGN TO
002000     XXXXX055.
002100 DATA DIVISION.
002200 FILE SECTION.
002300 FD  PRINT-FILE.
002400 01  PRINT-REC PICTURE X(120).
002500 01  DUMMY-RECORD PICTURE X(120).
002600 WORKING-STORAGE SECTION.
002700***********************************************************
002800* Variables specific to the Intrinsic Function Test IF121A*
002900***********************************************************
003000 01  A                   PIC S9(10)          VALUE 5.
003100 01  B                   PIC S9(10)          VALUE 7.
003200 01  C                   PIC S9(10)          VALUE -4.
003300 01  D                   PIC S9(10)          VALUE 10.
003400 01  E                   PIC S9(5)V9(5)      VALUE 34.26.
003500 01  F                   PIC S9(5)V9(5)      VALUE -8.32.
003600 01  G                   PIC S9(5)V9(5)      VALUE 4.08.
003700 01  H                   PIC S9(5)V9(5)      VALUE -5.3.
003800 01  M                   PIC S9(10)          VALUE 320000.
003900 01  N                   PIC S9(10)          VALUE 650000.
004000 01  O                   PIC S9(10)          VALUE -430000.
004100 01  P                   PIC S9(10)          VALUE 1.
004200 01  Q                   PIC S9(10)          VALUE 3.
004300 01  R                   PIC S9(10)          VALUE 5.
004400 01  ARG1                PIC S9(10)          VALUE 2.
004500 01  ARG2                PIC S9(10)          VALUE 2.
004600 01  ARR                                     VALUE "40537".
004700     02  IND OCCURS 5 TIMES PIC 9.
004800 01  TEMP                PIC S9(10)V9(5).
004900 01  WS-NUM              PIC S9(6)V9(7).
005000 01  MIN-RANGE           PIC S9(5)V9(7).
005100 01  MAX-RANGE           PIC S9(5)V9(7).
005200*
005300**********************************************************
005400*
005500 01  TEST-RESULTS.
005600     02 FILLER                   PIC X      VALUE SPACE.
005700     02 FEATURE                  PIC X(20)  VALUE SPACE.
005800     02 FILLER                   PIC X      VALUE SPACE.
005900     02 P-OR-F                   PIC X(5)   VALUE SPACE.
006000     02 FILLER                   PIC X      VALUE SPACE.
006100     02  PAR-NAME.
006200       03 FILLER                 PIC X(19)  VALUE SPACE.
006300       03  PARDOT-X              PIC X      VALUE SPACE.
006400       03 DOTVALUE               PIC 99     VALUE ZERO.
006500     02 FILLER                   PIC X(8)   VALUE SPACE.
006600     02 RE-MARK                  PIC X(61).
006700 01  TEST-COMPUTED.
006800     02 FILLER                   PIC X(30)  VALUE SPACE.
006900     02 FILLER                   PIC X(17)  VALUE
007000            "       COMPUTED=".
007100     02 COMPUTED-X.
007200     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
007300     03 COMPUTED-N               REDEFINES COMPUTED-A
007400                                 PIC -9(9).9(9).
007500     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
007600     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
007700     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
007800     03       CM-18V0 REDEFINES COMPUTED-A.
007900         04 COMPUTED-18V0                    PIC -9(18).
008000         04 FILLER                           PIC X.
008100     03 FILLER PIC X(50) VALUE SPACE.
008200 01  TEST-CORRECT.
008300     02 FILLER PIC X(30) VALUE SPACE.
008400     02 FILLER PIC X(17) VALUE "       CORRECT =".
008500     02 CORRECT-X.
008600     03 CORRECT-A                  PIC X(20) VALUE SPACE.
008700     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
008800     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
008900     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
009000     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
009100     03      CR-18V0 REDEFINES CORRECT-A.
009200         04 CORRECT-18V0                     PIC -9(18).
009300         04 FILLER                           PIC X.
009400     03 FILLER PIC X(2) VALUE SPACE.
009500     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
009600 01  TEST-CORRECT-MIN.
009700     02 FILLER PIC X(30) VALUE SPACE.
009800     02 FILLER PIC X(17) VALUE "     MIN VALUE =".
009900     02 CORRECTMI-X.
010000     03 CORRECTMI-A                 PIC X(20) VALUE SPACE.
010100     03 CORRECT-MIN    REDEFINES CORRECTMI-A     PIC -9(9).9(9).
010200     03 CORRECTMI-0V18 REDEFINES CORRECTMI-A     PIC -.9(18).
010300     03 CORRECTMI-4V14 REDEFINES CORRECTMI-A     PIC -9(4).9(14).
010400     03 CORRECTMI-14V4 REDEFINES CORRECTMI-A     PIC -9(14).9(4).
010500     03      CR-18V0 REDEFINES CORRECTMI-A.
010600         04 CORRECTMI-18V0                     PIC -9(18).
010700         04 FILLER                           PIC X.
010800     03 FILLER PIC X(2) VALUE SPACE.
010900     03 FILLER                           PIC X(48) VALUE SPACE.
011000 01  TEST-CORRECT-MAX.
011100     02 FILLER PIC X(30) VALUE SPACE.
011200     02 FILLER PIC X(17) VALUE "     MAX VALUE =".
011300     02 CORRECTMA-X.
011400     03 CORRECTMA-A                  PIC X(20) VALUE SPACE.
011500     03 CORRECT-MAX    REDEFINES CORRECTMA-A     PIC -9(9).9(9).
011600     03 CORRECTMA-0V18 REDEFINES CORRECTMA-A     PIC -.9(18).
011700     03 CORRECTMA-4V14 REDEFINES CORRECTMA-A     PIC -9(4).9(14).
011800     03 CORRECTMA-14V4 REDEFINES CORRECTMA-A     PIC -9(14).9(4).
011900     03      CR-18V0 REDEFINES CORRECTMA-A.
012000         04 CORRECTMA-18V0                     PIC -9(18).
012100         04 FILLER                           PIC X.
012200     03 FILLER PIC X(2) VALUE SPACE.
012300     03 CORMA-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
012400 01  CCVS-C-1.
012500     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
012600-    "SS  PARAGRAPH-NAME
012700-    "       REMARKS".
012800     02 FILLER                     PIC X(20)    VALUE SPACE.
012900 01  CCVS-C-2.
013000     02 FILLER                     PIC X        VALUE SPACE.
013100     02 FILLER                     PIC X(6)     VALUE "TESTED".
013200     02 FILLER                     PIC X(15)    VALUE SPACE.
013300     02 FILLER                     PIC X(4)     VALUE "FAIL".
013400     02 FILLER                     PIC X(94)    VALUE SPACE.
013500 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
013600 01  REC-CT                        PIC 99       VALUE ZERO.
013700 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
013800 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
013900 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
014000 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
014100 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
014200 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
014300 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
014400 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
014500 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
014600 01  CCVS-H-1.
014700     02  FILLER                    PIC X(39)    VALUE SPACES.
014800     02  FILLER                    PIC X(42)    VALUE
014900     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
015000     02  FILLER                    PIC X(39)    VALUE SPACES.
015100 01  CCVS-H-2A.
015200   02  FILLER                        PIC X(40)  VALUE SPACE.
015300   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
015400   02  FILLER                        PIC XXXX   VALUE
015500     "4.2 ".
015600   02  FILLER                        PIC X(28)  VALUE
015700            " COPY - NOT FOR DISTRIBUTION".
015800   02  FILLER                        PIC X(41)  VALUE SPACE.
015900
016000 01  CCVS-H-2B.
016100   02  FILLER                        PIC X(15)  VALUE
016200            "TEST RESULT OF ".
016300   02  TEST-ID                       PIC X(9).
016400   02  FILLER                        PIC X(4)   VALUE
016500            " IN ".
016600   02  FILLER                        PIC X(12)  VALUE
016700     " HIGH       ".
016800   02  FILLER                        PIC X(22)  VALUE
016900            " LEVEL VALIDATION FOR ".
017000   02  FILLER                        PIC X(58)  VALUE
017100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
017200 01  CCVS-H-3.
017300     02  FILLER                      PIC X(34)  VALUE
017400            " FOR OFFICIAL USE ONLY    ".
017500     02  FILLER                      PIC X(58)  VALUE
017600     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
017700     02  FILLER                      PIC X(28)  VALUE
017800            "  COPYRIGHT   1985 ".
017900 01  CCVS-E-1.
018000     02 FILLER                       PIC X(52)  VALUE SPACE.
018100     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
018200     02 ID-AGAIN                     PIC X(9).
018300     02 FILLER                       PIC X(45)  VALUE SPACES.
018400 01  CCVS-E-2.
018500     02  FILLER                      PIC X(31)  VALUE SPACE.
018600     02  FILLER                      PIC X(21)  VALUE SPACE.
018700     02 CCVS-E-2-2.
018800         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
018900         03 FILLER                   PIC X      VALUE SPACE.
019000         03 ENDER-DESC               PIC X(44)  VALUE
019100            "ERRORS ENCOUNTERED".
019200 01  CCVS-E-3.
019300     02  FILLER                      PIC X(22)  VALUE
019400            " FOR OFFICIAL USE ONLY".
019500     02  FILLER                      PIC X(12)  VALUE SPACE.
019600     02  FILLER                      PIC X(58)  VALUE
019700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
019800     02  FILLER                      PIC X(13)  VALUE SPACE.
019900     02 FILLER                       PIC X(15)  VALUE
020000             " COPYRIGHT 1985".
020100 01  CCVS-E-4.
020200     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
020300     02 FILLER                       PIC X(4)   VALUE " OF ".
020400     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
020500     02 FILLER                       PIC X(40)  VALUE
020600      "  TESTS WERE EXECUTED SUCCESSFULLY".
020700 01  XXINFO.
020800     02 FILLER                       PIC X(19)  VALUE
020900            "*** INFORMATION ***".
021000     02 INFO-TEXT.
021100       04 FILLER                     PIC X(8)   VALUE SPACE.
021200       04 XXCOMPUTED                 PIC X(20).
021300       04 FILLER                     PIC X(5)   VALUE SPACE.
021400       04 XXCORRECT                  PIC X(20).
021500     02 INF-ANSI-REFERENCE           PIC X(48).
021600 01  HYPHEN-LINE.
021700     02 FILLER  PIC IS X VALUE IS SPACE.
021800     02 FILLER  PIC IS X(65)    VALUE IS "************************
021900-    "*****************************************".
022000     02 FILLER  PIC IS X(54)    VALUE IS "************************
022100-    "******************************".
022200 01  CCVS-PGM-ID                     PIC X(9)   VALUE
022300     "IF121A".
022400 PROCEDURE DIVISION.
022500 CCVS1 SECTION.
022600 OPEN-FILES.
022700     OPEN     OUTPUT PRINT-FILE.
022800     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
022900     MOVE    SPACE TO TEST-RESULTS.
023000     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
023100     GO TO CCVS1-EXIT.
023200 CLOSE-FILES.
023300     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
023400 TERMINATE-CCVS.
023500     STOP     RUN.
023600 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
023700 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
023800 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
023900 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
024000     MOVE "****TEST DELETED****" TO RE-MARK.
024100 PRINT-DETAIL.
024200     IF REC-CT NOT EQUAL TO ZERO
024300             MOVE "." TO PARDOT-X
024400             MOVE REC-CT TO DOTVALUE.
024500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
024600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
024700        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
024800          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
024900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
025000     MOVE SPACE TO CORRECT-X.
025100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
025200     MOVE     SPACE TO RE-MARK.
025300 HEAD-ROUTINE.
025400     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025500     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025600     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
025700     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
025800 COLUMN-NAMES-ROUTINE.
025900     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026000     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
026200 END-ROUTINE.
026300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
026400 END-RTN-EXIT.
026500     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026600 END-ROUTINE-1.
026700      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
026800      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
026900      ADD PASS-COUNTER TO ERROR-HOLD.
027000      MOVE PASS-COUNTER TO CCVS-E-4-1.
027100      MOVE ERROR-HOLD TO CCVS-E-4-2.
027200      MOVE CCVS-E-4 TO CCVS-E-2-2.
027300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
027400  END-ROUTINE-12.
027500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
027600     IF       ERROR-COUNTER IS EQUAL TO ZERO
027700         MOVE "NO " TO ERROR-TOTAL
027800         ELSE
027900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
028000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
028100     PERFORM WRITE-LINE.
028200 END-ROUTINE-13.
028300     IF DELETE-COUNTER IS EQUAL TO ZERO
028400         MOVE "NO " TO ERROR-TOTAL  ELSE
028500         MOVE DELETE-COUNTER TO ERROR-TOTAL.
028600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
028700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028800      IF   INSPECT-COUNTER EQUAL TO ZERO
028900          MOVE "NO " TO ERROR-TOTAL
029000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
029100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
029200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029400 WRITE-LINE.
029500     ADD 1 TO RECORD-COUNT.
029600Y    IF RECORD-COUNT GREATER 42
029700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
029800Y        MOVE SPACE TO DUMMY-RECORD
029900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
030000Y        MOVE CCVS-H-1  TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
030100Y        MOVE CCVS-H-2A TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
030200Y        MOVE CCVS-H-2B TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
030300Y        MOVE CCVS-H-3  TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
030400Y        MOVE CCVS-C-1  TO DUMMY-RECORD  PERFORM WRT-LN
030500Y        MOVE CCVS-C-2  TO DUMMY-RECORD  PERFORM WRT-LN
030600Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
030700Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
030800Y        MOVE ZERO TO RECORD-COUNT.
030900     PERFORM WRT-LN.
031000 WRT-LN.
031100     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
031200     MOVE SPACE TO DUMMY-RECORD.
031300 BLANK-LINE-PRINT.
031400     PERFORM WRT-LN.
031500 FAIL-ROUTINE.
031600     IF     COMPUTED-X NOT EQUAL TO SPACE
031700            GO TO FAIL-ROUTINE-WRITE.
031800     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
031900     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
032000     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
032100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032200     MOVE   SPACES TO INF-ANSI-REFERENCE.
032300     GO TO  FAIL-ROUTINE-EX.
032400 FAIL-ROUTINE-WRITE.
032500     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE.
032600     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE
032700                              CORMA-ANSI-REFERENCE.
032800     IF CORRECT-MIN NOT EQUAL TO SPACES THEN
032900           MOVE TEST-CORRECT-MIN TO PRINT-REC PERFORM WRITE-LINE
033000           MOVE TEST-CORRECT-MAX TO PRINT-REC PERFORM WRITE-LINE
033100     ELSE
033200           MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE.
033300     PERFORM WRITE-LINE.
033400     MOVE   SPACES TO COR-ANSI-REFERENCE.
033500 FAIL-ROUTINE-EX. EXIT.
033600 BAIL-OUT.
033700     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
033800     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
033900 BAIL-OUT-WRITE.
034000     MOVE CORRECT-A TO XXCORRECT.
034100     MOVE COMPUTED-A TO XXCOMPUTED.
034200     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
034300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034400     MOVE   SPACES TO INF-ANSI-REFERENCE.
034500 BAIL-OUT-EX. EXIT.
034600 CCVS1-EXIT.
034700     EXIT.
034800********************************************************
034900*                                                      *
035000*    Intrinsic Function Tests         IF121A - MEDIAN  *
035100*                                                      *
035200********************************************************
035300 SECT-IF121A SECTION.
035400 F-MEDIAN-INFO.
035500     MOVE     "See ref. A-54 2.25" TO ANSI-REFERENCE.
035600     MOVE     "MEDIAN Function" TO FEATURE.
035700*****************TEST (a) - SIMPLE TEST*****************
035800 F-MEDIAN-01.
035900     MOVE ZERO TO WS-NUM.
036000 F-MEDIAN-TEST-01.
036100     COMPUTE WS-NUM = FUNCTION MEDIAN(5, -2, -14, 0).
036200     IF WS-NUM = -1 THEN
036300                    PERFORM PASS
036400     ELSE
036500                    MOVE WS-NUM TO COMPUTED-N
036600                    MOVE -1 TO CORRECT-N
036700                    PERFORM FAIL.
036800     GO TO F-MEDIAN-WRITE-01.
036900 F-MEDIAN-DELETE-01.
037000     PERFORM  DE-LETE.
037100     GO TO    F-MEDIAN-WRITE-01.
037200 F-MEDIAN-WRITE-01.
037300     MOVE "F-MEDIAN-01" TO PAR-NAME.
037400     PERFORM  PRINT-DETAIL.
037500*****************TEST (b) - SIMPLE TEST*****************
037600 F-MEDIAN-02.
037700     EVALUATE FUNCTION MEDIAN(3.9, -0.3, 8.7, 100.2)
037800     WHEN 6.29987 THRU 6.30013
037900                    PERFORM PASS
038000     WHEN OTHER
038100                    PERFORM FAIL.
038200     GO TO F-MEDIAN-WRITE-02.
038300 F-MEDIAN-DELETE-02.
038400     PERFORM  DE-LETE.
038500     GO TO    F-MEDIAN-WRITE-02.
038600 F-MEDIAN-WRITE-02.
038700     MOVE "F-MEDIAN-02" TO PAR-NAME.
038800     PERFORM  PRINT-DETAIL.
038900*****************TEST (c) - SIMPLE TEST*****************
039000 F-MEDIAN-03.
039100     IF FUNCTION MEDIAN(A, B, C, D) = 6    THEN
039200                    PERFORM PASS
039300     ELSE
039400                    PERFORM FAIL.
039500     GO TO F-MEDIAN-WRITE-03.
039600 F-MEDIAN-DELETE-03.
039700     PERFORM  DE-LETE.
039800     GO TO    F-MEDIAN-WRITE-03.
039900 F-MEDIAN-WRITE-03.
040000     MOVE "F-MEDIAN-03" TO PAR-NAME.
040100     PERFORM  PRINT-DETAIL.
040200*****************TEST (d) - SIMPLE TEST*****************
040300 F-MEDIAN-04.
040400     MOVE ZERO TO WS-NUM.
040500 F-MEDIAN-TEST-04.
040600     COMPUTE WS-NUM = FUNCTION MEDIAN(E, F, G).
040700     IF (WS-NUM >= 4.07992) AND
040800        (WS-NUM <= 4.08008)
040900                    PERFORM PASS
041000     ELSE
041100                    MOVE WS-NUM TO COMPUTED-N
041200                    MOVE 4.08 TO CORRECT-N
041300                    PERFORM FAIL.
041400     GO TO F-MEDIAN-WRITE-04.
041500 F-MEDIAN-DELETE-04.
041600     PERFORM  DE-LETE.
041700     GO TO    F-MEDIAN-WRITE-04.
041800 F-MEDIAN-WRITE-04.
041900     MOVE "F-MEDIAN-04" TO PAR-NAME.
042000     PERFORM  PRINT-DETAIL.
042100*****************TEST (e) - SIMPLE TEST*****************
042200 F-MEDIAN-05.
042300     MOVE ZERO TO WS-NUM.
042400 F-MEDIAN-TEST-05.
042500     COMPUTE WS-NUM = FUNCTION MEDIAN(10.2, -0.2, 5.6, -15.6).
042600     IF (WS-NUM >= 2.69995) AND
042700        (WS-NUM <= 2.70005)
042800                    PERFORM PASS
042900     ELSE
043000                    MOVE WS-NUM TO COMPUTED-N
043100                    MOVE 2.7 TO CORRECT-N
043200                    PERFORM FAIL.
043300     GO TO F-MEDIAN-WRITE-05.
043400 F-MEDIAN-DELETE-05.
043500     PERFORM  DE-LETE.
043600     GO TO    F-MEDIAN-WRITE-05.
043700 F-MEDIAN-WRITE-05.
043800     MOVE "F-MEDIAN-05" TO PAR-NAME.
043900     PERFORM  PRINT-DETAIL.
044000*****************TEST (f) - SIMPLE TEST*****************
044100 F-MEDIAN-06.
044200     MOVE ZERO TO WS-NUM.
044300 F-MEDIAN-TEST-06.
044400     COMPUTE WS-NUM = FUNCTION MEDIAN(A, B, C, D, E, F, G).
044500     IF (WS-NUM >= 4.99990) AND
044600        (WS-NUM <= 5.00010)
044700                    PERFORM PASS
044800     ELSE
044900                    MOVE WS-NUM TO COMPUTED-N
045000                    MOVE 5 TO CORRECT-N
045100                    PERFORM FAIL.
045200     GO TO F-MEDIAN-WRITE-06.
045300 F-MEDIAN-DELETE-06.
045400     PERFORM  DE-LETE.
045500     GO TO    F-MEDIAN-WRITE-06.
045600 F-MEDIAN-WRITE-06.
045700     MOVE "F-MEDIAN-06" TO PAR-NAME.
045800     PERFORM  PRINT-DETAIL.
045900*****************TEST (g) - SIMPLE TEST*****************
046000 F-MEDIAN-07.
046100     MOVE ZERO TO WS-NUM.
046200 F-MEDIAN-TEST-07.
046300     COMPUTE WS-NUM = FUNCTION MEDIAN(IND(1), IND(2), IND(3)).
046400     IF WS-NUM = 4 THEN
046500                    PERFORM PASS
046600     ELSE
046700                    MOVE WS-NUM TO COMPUTED-N
046800                    MOVE 4 TO CORRECT-N
046900                    PERFORM FAIL.
047000     GO TO F-MEDIAN-WRITE-07.
047100 F-MEDIAN-DELETE-07.
047200     PERFORM  DE-LETE.
047300     GO TO    F-MEDIAN-WRITE-07.
047400 F-MEDIAN-WRITE-07.
047500     MOVE "F-MEDIAN-07" TO PAR-NAME.
047600     PERFORM  PRINT-DETAIL.
047700*****************TEST (h) - SIMPLE TEST*****************
047800 F-MEDIAN-08.
047900     MOVE ZERO TO WS-NUM.
048000 F-MEDIAN-TEST-08.
048100     COMPUTE WS-NUM = FUNCTION MEDIAN(IND(P), IND(Q), IND(R)).
048200
048300     IF WS-NUM = 5 THEN
048400                    PERFORM PASS
048500     ELSE
048600                    MOVE WS-NUM TO COMPUTED-N
048700                    MOVE 5 TO CORRECT-N
048800                    PERFORM FAIL.
048900     GO TO F-MEDIAN-WRITE-08.
049000 F-MEDIAN-DELETE-08.
049100     PERFORM  DE-LETE.
049200     GO TO    F-MEDIAN-WRITE-08.
049300 F-MEDIAN-WRITE-08.
049400     MOVE "F-MEDIAN-08" TO PAR-NAME.
049500     PERFORM  PRINT-DETAIL.
049600*****************TEST (i) - SIMPLE TEST*****************
049700 F-MEDIAN-09.
049800     MOVE ZERO TO WS-NUM.
049900 F-MEDIAN-TEST-09.
050000     COMPUTE WS-NUM = FUNCTION MEDIAN(IND(ALL)).
050100     IF WS-NUM = 4 THEN
050200                    PERFORM PASS
050300     ELSE
050400                    MOVE WS-NUM TO COMPUTED-N
050500                    MOVE 4 TO CORRECT-N
050600                    PERFORM FAIL.
050700     GO TO F-MEDIAN-WRITE-09.
050800 F-MEDIAN-DELETE-09.
050900     PERFORM  DE-LETE.
051000     GO TO    F-MEDIAN-WRITE-09.
051100 F-MEDIAN-WRITE-09.
051200     MOVE "F-MEDIAN-09" TO PAR-NAME.
051300     PERFORM  PRINT-DETAIL.
051400*****************TEST (k) - SIMPLE TEST*****************
051500 F-MEDIAN-11.
051600     MOVE ZERO TO WS-NUM.
051700 F-MEDIAN-TEST-11.
051800     COMPUTE WS-NUM = FUNCTION MEDIAN(M, N, O).
051900     IF WS-NUM = 320000 THEN
052000                    PERFORM PASS
052100     ELSE
052200                    MOVE WS-NUM TO COMPUTED-N
052300                    MOVE 320000 TO CORRECT-N
052400                    PERFORM FAIL.
052500     GO TO F-MEDIAN-WRITE-11.
052600 F-MEDIAN-DELETE-11.
052700     PERFORM  DE-LETE.
052800     GO TO    F-MEDIAN-WRITE-11.
052900 F-MEDIAN-WRITE-11.
053000     MOVE "F-MEDIAN-11" TO PAR-NAME.
053100     PERFORM  PRINT-DETAIL.
053200*****************TEST (l) - SIMPLE TEST*****************
053300 F-MEDIAN-12.
053400     MOVE ZERO TO WS-NUM.
053500 F-MEDIAN-TEST-12.
053600     COMPUTE WS-NUM = FUNCTION MEDIAN(A, 5, A).
053700     IF WS-NUM = 5 THEN
053800                    PERFORM PASS
053900     ELSE
054000                    MOVE WS-NUM TO COMPUTED-N
054100                    MOVE 5 TO CORRECT-N
054200                    PERFORM FAIL.
054300     GO TO F-MEDIAN-WRITE-12.
054400 F-MEDIAN-DELETE-12.
054500     PERFORM  DE-LETE.
054600     GO TO    F-MEDIAN-WRITE-12.
054700 F-MEDIAN-WRITE-12.
054800     MOVE "F-MEDIAN-12" TO PAR-NAME.
054900     PERFORM  PRINT-DETAIL.
055000*****************TEST (a) - COMPLEX TEST****************
055100 F-MEDIAN-13.
055200     MOVE ZERO TO WS-NUM.
055300     MOVE  20.7996 TO MIN-RANGE.
055400     MOVE  20.8004 TO MAX-RANGE.
055500 F-MEDIAN-TEST-13.
055600     COMPUTE WS-NUM = FUNCTION MEDIAN(2.6 + 30, 4.5 * 2).
055700     IF (WS-NUM >= MIN-RANGE) AND
055800        (WS-NUM <= MAX-RANGE) THEN
055900                    PERFORM PASS
056000     ELSE
056100                    MOVE WS-NUM TO COMPUTED-N
056200                    MOVE MIN-RANGE TO CORRECT-MIN
056300                    MOVE MAX-RANGE TO CORRECT-MAX
056400                    PERFORM FAIL.
056500     GO TO F-MEDIAN-WRITE-13.
056600 F-MEDIAN-DELETE-13.
056700     PERFORM  DE-LETE.
056800     GO TO    F-MEDIAN-WRITE-13.
056900 F-MEDIAN-WRITE-13.
057000     MOVE "F-MEDIAN-13" TO PAR-NAME.
057100     PERFORM  PRINT-DETAIL.
057200*****************TEST (b) - COMPLEX TEST****************
057300 F-MEDIAN-14.
057400     MOVE ZERO TO WS-NUM.
057500     MOVE  34.2593 TO MIN-RANGE.
057600     MOVE  34.2607 TO MAX-RANGE.
057700 F-MEDIAN-TEST-14.
057800     COMPUTE WS-NUM = FUNCTION MEDIAN(E, 9 * A, B / 2).
057900     IF (WS-NUM >= MIN-RANGE) AND
058000        (WS-NUM <= MAX-RANGE) THEN
058100                    PERFORM PASS
058200     ELSE
058300                    MOVE WS-NUM TO COMPUTED-N
058400                    MOVE MIN-RANGE TO CORRECT-MIN
058500                    MOVE MAX-RANGE TO CORRECT-MAX
058600                    PERFORM FAIL.
058700     GO TO F-MEDIAN-WRITE-14.
058800 F-MEDIAN-DELETE-14.
058900     PERFORM  DE-LETE.
059000     GO TO    F-MEDIAN-WRITE-14.
059100 F-MEDIAN-WRITE-14.
059200     MOVE "F-MEDIAN-14" TO PAR-NAME.
059300     PERFORM  PRINT-DETAIL.
059400*****************TEST (c) - COMPLEX TEST****************
059500 F-MEDIAN-15.
059600     MOVE ZERO TO WS-NUM.
059700     MOVE 83.9983 TO MIN-RANGE.
059800     MOVE 84.0017 TO MAX-RANGE.
059900 F-MEDIAN-TEST-15.
060000     COMPUTE WS-NUM = FUNCTION MEDIAN(A, B) + 78.
060100     IF (WS-NUM >= MIN-RANGE) AND
060200        (WS-NUM <= MAX-RANGE) THEN
060300                    PERFORM PASS
060400     ELSE
060500                    MOVE WS-NUM TO COMPUTED-N
060600                    MOVE MIN-RANGE TO CORRECT-MIN
060700                    MOVE MAX-RANGE TO CORRECT-MAX
060800                    PERFORM FAIL.
060900     GO TO F-MEDIAN-WRITE-15.
061000 F-MEDIAN-DELETE-15.
061100     PERFORM  DE-LETE.
061200     GO TO    F-MEDIAN-WRITE-15.
061300 F-MEDIAN-WRITE-15.
061400     MOVE "F-MEDIAN-15" TO PAR-NAME.
061500     PERFORM  PRINT-DETAIL.
061600*****************TEST (d) - COMPLEX TEST****************
061700 F-MEDIAN-16.
061800     MOVE ZERO TO WS-NUM.
061900     MOVE 3.39932 TO MIN-RANGE.
062000     MOVE 3.40007 TO MAX-RANGE.
062100 F-MEDIAN-TEST-16.
062200     COMPUTE WS-NUM = FUNCTION MEDIAN(A, B) +
062300                      FUNCTION MEDIAN(-2.6, -4.4, 1).
062400     IF (WS-NUM >= MIN-RANGE) AND
062500        (WS-NUM <= MAX-RANGE) THEN
062600                    PERFORM PASS
062700     ELSE
062800                    MOVE WS-NUM TO COMPUTED-N
062900                    MOVE MIN-RANGE TO CORRECT-MIN
063000                    MOVE MAX-RANGE TO CORRECT-MAX
063100                    PERFORM FAIL.
063200     GO TO F-MEDIAN-WRITE-16.
063300 F-MEDIAN-DELETE-16.
063400     PERFORM  DE-LETE.
063500     GO TO    F-MEDIAN-WRITE-16.
063600 F-MEDIAN-WRITE-16.
063700     MOVE "F-MEDIAN-16" TO PAR-NAME.
063800     PERFORM  PRINT-DETAIL.
063900*****************TEST (e) - COMPLEX TEST****************
064000 F-MEDIAN-17.
064100     MOVE ZERO TO WS-NUM.
064200     MOVE 2.24995 TO MIN-RANGE.
064300     MOVE 2.25004 TO MAX-RANGE.
064400 F-MEDIAN-TEST-17.
064500     COMPUTE WS-NUM =
064600                 FUNCTION MEDIAN(FUNCTION MEDIAN(1, 2), 3).
064700     IF (WS-NUM >= MIN-RANGE) AND
064800        (WS-NUM <= MAX-RANGE) THEN
064900                    PERFORM PASS
065000     ELSE
065100                    MOVE WS-NUM TO COMPUTED-N
065200                    MOVE MIN-RANGE TO CORRECT-MIN
065300                    MOVE MAX-RANGE TO CORRECT-MAX
065400                    PERFORM FAIL.
065500     GO TO F-MEDIAN-WRITE-17.
065600 F-MEDIAN-DELETE-17.
065700     PERFORM  DE-LETE.
065800     GO TO    F-MEDIAN-WRITE-17.
065900 F-MEDIAN-WRITE-17.
066000     MOVE "F-MEDIAN-17" TO PAR-NAME.
066100     PERFORM  PRINT-DETAIL.
066200*****************SPECIAL PERFORM TEST**********************
066300 F-MEDIAN-18.
066400     PERFORM F-MEDIAN-TEST-18
066500       UNTIL FUNCTION MEDIAN(1, ARG1, ARG2, 20) > 10.
066600     PERFORM PASS.
066700     GO TO F-MEDIAN-WRITE-18.
066800 F-MEDIAN-TEST-18.
066900     COMPUTE ARG1 = ARG1 + 1.
067000     COMPUTE ARG2 = ARG2 + 1.
067100 F-MEDIAN-DELETE-18.
067200     PERFORM  DE-LETE.
067300     GO TO    F-MEDIAN-WRITE-18.
067400 F-MEDIAN-WRITE-18.
067500     MOVE "F-MEDIAN-18" TO PAR-NAME.
067600     PERFORM  PRINT-DETAIL.
067700********************END OF TESTS***************
067800 CCVS-EXIT SECTION.
067900 CCVS-999999.
068000     GO TO CLOSE-FILES.
