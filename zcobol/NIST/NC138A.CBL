000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     NC138A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*
002200*    PROGRAM NC138A TESTS THE USE OF SPACES, COMMAS,
002300*    SEMI-COLONS AND LEFT AND RIGHT PARENTHESIS AS SEPARATORS
002400*    IN STATEMENTS WHICH REFERENCE TABLE ITEMS.
002500*
002600 ENVIRONMENT DIVISION.
002700 CONFIGURATION SECTION.
002800 SOURCE-COMPUTER.
002900     XXXXX082.
003000 OBJECT-COMPUTER.
003100     XXXXX083.
003200 INPUT-OUTPUT SECTION.
003300 FILE-CONTROL.
003400     SELECT PRINT-FILE ASSIGN TO
003500     XXXXX055.
003600 DATA DIVISION.
003700 FILE SECTION.
003800 FD  PRINT-FILE.
003900 01  PRINT-REC PICTURE X(120).
004000 01  DUMMY-RECORD PICTURE X(120).
004100 WORKING-STORAGE SECTION.
004200 77  WRK1    PIC S999  VALUE ZERO.
004300 77  TEMP  PIC S9(5).
004400 77  EXPECTED-VALUE   PIC  S9(5).
004500*    SUBSCRIPTS FOR REFERENCING TABLE ITEMS.
004600 77  S1     PIC  S999 VALUE 1.
004700 77  S21    PIC  S999 VALUE 1.
004800 77  S22    PIC  S999 SIGN IS LEADING SEPARATE CHARACTER
004900        VALUE 1.
005000 77  S31    PIC  S999 COMPUTATIONAL  VALUE 1.
005100 77  S32    PIC  S999 SYNC LEFT VALUE 1.
005200 77  S33    PIC  S999            VALUE 1.
005300*    ONE DIMENSIONAL TABLE.
005400 01  GRP-TAB1.
005500     02  ELEM1  PIC 99
005600         OCCURS 60 TIMES.
005700*    TWO DIMENSIONAL TABLE,  12 BY 5.
005800 01  GRP-TAP2.
005900     02  GRP-LEV2-O012F    OCCURS 12 TIMES.
006000         03  ELEM2   PIC 9999  COMPUTATIONAL
006100             OCCURS 5 TIMES.
006200*    THREE DIMENSIONAL TABLE,  4 BY 3 BY 5.
006300 01  GRP-TAB3.
006400     02 GRP-LEV2-00004F
006500           OCCURS 4 TIMES
006600           INDEXED BY WRK-IX-0001.
006700        03 GRP-LEV3-O0003F    OCCURS 3 TIMES.
006800           04 ELEM3  PICTURE IS S999
006900              USAGE IS DISPLAY SIGN IS LEADING SEPARATE CHARACTER
007000              OCCURS 5 TIMES.
007100 01  TEST-RESULTS.
007200     02 FILLER                   PIC X      VALUE SPACE.
007300     02 FEATURE                  PIC X(20)  VALUE SPACE.
007400     02 FILLER                   PIC X      VALUE SPACE.
007500     02 P-OR-F                   PIC X(5)   VALUE SPACE.
007600     02 FILLER                   PIC X      VALUE SPACE.
007700     02  PAR-NAME.
007800       03 FILLER                 PIC X(19)  VALUE SPACE.
007900       03  PARDOT-X              PIC X      VALUE SPACE.
008000       03 DOTVALUE               PIC 99     VALUE ZERO.
008100     02 FILLER                   PIC X(8)   VALUE SPACE.
008200     02 RE-MARK                  PIC X(61).
008300 01  TEST-COMPUTED.
008400     02 FILLER                   PIC X(30)  VALUE SPACE.
008500     02 FILLER                   PIC X(17)  VALUE
008600            "       COMPUTED=".
008700     02 COMPUTED-X.
008800     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
008900     03 COMPUTED-N               REDEFINES COMPUTED-A
009000                                 PIC -9(9).9(9).
009100     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
009200     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
009300     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
009400     03       CM-18V0 REDEFINES COMPUTED-A.
009500         04 COMPUTED-18V0                    PIC -9(18).
009600         04 FILLER                           PIC X.
009700     03 FILLER PIC X(50) VALUE SPACE.
009800 01  TEST-CORRECT.
009900     02 FILLER PIC X(30) VALUE SPACE.
010000     02 FILLER PIC X(17) VALUE "       CORRECT =".
010100     02 CORRECT-X.
010200     03 CORRECT-A                  PIC X(20) VALUE SPACE.
010300     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
010400     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
010500     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
010600     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
010700     03      CR-18V0 REDEFINES CORRECT-A.
010800         04 CORRECT-18V0                     PIC -9(18).
010900         04 FILLER                           PIC X.
011000     03 FILLER PIC X(2) VALUE SPACE.
011100     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
011200 01  CCVS-C-1.
011300     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
011400-    "SS  PARAGRAPH-NAME
011500-    "       REMARKS".
011600     02 FILLER                     PIC X(20)    VALUE SPACE.
011700 01  CCVS-C-2.
011800     02 FILLER                     PIC X        VALUE SPACE.
011900     02 FILLER                     PIC X(6)     VALUE "TESTED".
012000     02 FILLER                     PIC X(15)    VALUE SPACE.
012100     02 FILLER                     PIC X(4)     VALUE "FAIL".
012200     02 FILLER                     PIC X(94)    VALUE SPACE.
012300 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
012400 01  REC-CT                        PIC 99       VALUE ZERO.
012500 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
012600 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
012700 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
012800 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
012900 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
013000 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
013100 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
013200 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
013300 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
013400 01  CCVS-H-1.
013500     02  FILLER                    PIC X(39)    VALUE SPACES.
013600     02  FILLER                    PIC X(42)    VALUE
013700     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
013800     02  FILLER                    PIC X(39)    VALUE SPACES.
013900 01  CCVS-H-2A.
014000   02  FILLER                        PIC X(40)  VALUE SPACE.
014100   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
014200   02  FILLER                        PIC XXXX   VALUE
014300     "4.2 ".
014400   02  FILLER                        PIC X(28)  VALUE
014500            " COPY - NOT FOR DISTRIBUTION".
014600   02  FILLER                        PIC X(41)  VALUE SPACE.
014700
014800 01  CCVS-H-2B.
014900   02  FILLER                        PIC X(15)  VALUE
015000            "TEST RESULT OF ".
015100   02  TEST-ID                       PIC X(9).
015200   02  FILLER                        PIC X(4)   VALUE
015300            " IN ".
015400   02  FILLER                        PIC X(12)  VALUE
015500     " HIGH       ".
015600   02  FILLER                        PIC X(22)  VALUE
015700            " LEVEL VALIDATION FOR ".
015800   02  FILLER                        PIC X(58)  VALUE
015900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
016000 01  CCVS-H-3.
016100     02  FILLER                      PIC X(34)  VALUE
016200            " FOR OFFICIAL USE ONLY    ".
016300     02  FILLER                      PIC X(58)  VALUE
016400     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
016500     02  FILLER                      PIC X(28)  VALUE
016600            "  COPYRIGHT   1985 ".
016700 01  CCVS-E-1.
016800     02 FILLER                       PIC X(52)  VALUE SPACE.
016900     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
017000     02 ID-AGAIN                     PIC X(9).
017100     02 FILLER                       PIC X(45)  VALUE SPACES.
017200 01  CCVS-E-2.
017300     02  FILLER                      PIC X(31)  VALUE SPACE.
017400     02  FILLER                      PIC X(21)  VALUE SPACE.
017500     02 CCVS-E-2-2.
017600         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
017700         03 FILLER                   PIC X      VALUE SPACE.
017800         03 ENDER-DESC               PIC X(44)  VALUE
017900            "ERRORS ENCOUNTERED".
018000 01  CCVS-E-3.
018100     02  FILLER                      PIC X(22)  VALUE
018200            " FOR OFFICIAL USE ONLY".
018300     02  FILLER                      PIC X(12)  VALUE SPACE.
018400     02  FILLER                      PIC X(58)  VALUE
018500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
018600     02  FILLER                      PIC X(13)  VALUE SPACE.
018700     02 FILLER                       PIC X(15)  VALUE
018800             " COPYRIGHT 1985".
018900 01  CCVS-E-4.
019000     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
019100     02 FILLER                       PIC X(4)   VALUE " OF ".
019200     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
019300     02 FILLER                       PIC X(40)  VALUE
019400      "  TESTS WERE EXECUTED SUCCESSFULLY".
019500 01  XXINFO.
019600     02 FILLER                       PIC X(19)  VALUE
019700            "*** INFORMATION ***".
019800     02 INFO-TEXT.
019900       04 FILLER                     PIC X(8)   VALUE SPACE.
020000       04 XXCOMPUTED                 PIC X(20).
020100       04 FILLER                     PIC X(5)   VALUE SPACE.
020200       04 XXCORRECT                  PIC X(20).
020300     02 INF-ANSI-REFERENCE           PIC X(48).
020400 01  HYPHEN-LINE.
020500     02 FILLER  PIC IS X VALUE IS SPACE.
020600     02 FILLER  PIC IS X(65)    VALUE IS "************************
020700-    "*****************************************".
020800     02 FILLER  PIC IS X(54)    VALUE IS "************************
020900-    "******************************".
021000 01  CCVS-PGM-ID                     PIC X(9)   VALUE
021100     "NC138A".
021200 PROCEDURE DIVISION.
021300 CCVS1 SECTION.
021400 OPEN-FILES.
021500     OPEN     OUTPUT PRINT-FILE.
021600     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
021700     MOVE    SPACE TO TEST-RESULTS.
021800     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
021900     GO TO CCVS1-EXIT.
022000 CLOSE-FILES.
022100     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
022200 TERMINATE-CCVS.
022300S    EXIT PROGRAM.
022400STERMINATE-CALL.
022500     STOP     RUN.
022600 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
022700 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
022800 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
022900 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
023000     MOVE "****TEST DELETED****" TO RE-MARK.
023100 PRINT-DETAIL.
023200     IF REC-CT NOT EQUAL TO ZERO
023300             MOVE "." TO PARDOT-X
023400             MOVE REC-CT TO DOTVALUE.
023500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
023600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
023700        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
023800          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
023900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
024000     MOVE SPACE TO CORRECT-X.
024100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
024200     MOVE     SPACE TO RE-MARK.
024300 HEAD-ROUTINE.
024400     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024500     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024600     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
024700     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
024800 COLUMN-NAMES-ROUTINE.
024900     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025000     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
025200 END-ROUTINE.
025300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
025400 END-RTN-EXIT.
025500     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025600 END-ROUTINE-1.
025700      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
025800      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
025900      ADD PASS-COUNTER TO ERROR-HOLD.
026000*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
026100      MOVE PASS-COUNTER TO CCVS-E-4-1.
026200      MOVE ERROR-HOLD TO CCVS-E-4-2.
026300      MOVE CCVS-E-4 TO CCVS-E-2-2.
026400      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
026500  END-ROUTINE-12.
026600      MOVE "TEST(S) FAILED" TO ENDER-DESC.
026700     IF       ERROR-COUNTER IS EQUAL TO ZERO
026800         MOVE "NO " TO ERROR-TOTAL
026900         ELSE
027000         MOVE ERROR-COUNTER TO ERROR-TOTAL.
027100     MOVE     CCVS-E-2 TO DUMMY-RECORD.
027200     PERFORM WRITE-LINE.
027300 END-ROUTINE-13.
027400     IF DELETE-COUNTER IS EQUAL TO ZERO
027500         MOVE "NO " TO ERROR-TOTAL  ELSE
027600         MOVE DELETE-COUNTER TO ERROR-TOTAL.
027700     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
027800     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027900      IF   INSPECT-COUNTER EQUAL TO ZERO
028000          MOVE "NO " TO ERROR-TOTAL
028100      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
028200      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
028300      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028400     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028500 WRITE-LINE.
028600     ADD 1 TO RECORD-COUNT.
028700Y    IF RECORD-COUNT GREATER 42
028800Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
028900Y        MOVE SPACE TO DUMMY-RECORD
029000Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
029100Y        MOVE CCVS-H-1  TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
029200Y        MOVE CCVS-H-2A TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
029300Y        MOVE CCVS-H-2B TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
029400Y        MOVE CCVS-H-3  TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
029500Y        MOVE CCVS-C-1  TO DUMMY-RECORD  PERFORM WRT-LN
029600Y        MOVE CCVS-C-2  TO DUMMY-RECORD  PERFORM WRT-LN
029700Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
029800Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
029900Y        MOVE ZERO TO RECORD-COUNT.
030000     PERFORM WRT-LN.
030100 WRT-LN.
030200     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
030300     MOVE SPACE TO DUMMY-RECORD.
030400 BLANK-LINE-PRINT.
030500     PERFORM WRT-LN.
030600 FAIL-ROUTINE.
030700     IF     COMPUTED-X NOT EQUAL TO SPACE
030800            GO TO FAIL-ROUTINE-WRITE.
030900     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
031000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
031100     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
031200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031300     MOVE   SPACES TO INF-ANSI-REFERENCE.
031400     GO TO  FAIL-ROUTINE-EX.
031500 FAIL-ROUTINE-WRITE.
031600     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
031700     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
031800     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
031900     MOVE   SPACES TO COR-ANSI-REFERENCE.
032000 FAIL-ROUTINE-EX. EXIT.
032100 BAIL-OUT.
032200     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
032300     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
032400 BAIL-OUT-WRITE.
032500     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
032600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
032700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032800     MOVE   SPACES TO INF-ANSI-REFERENCE.
032900 BAIL-OUT-EX. EXIT.
033000 CCVS1-EXIT.
033100     EXIT.
033200 SECT-NC138A-0001 SECTION.
033300 NC138A-0001.
033400     MOVE "IV-4 4.2.1" TO ANSI-REFERENCE.
033500*    THIS SECTION STORES THE NUMBERS 1 THROUGH 60 IN THE 3 TABLES.
033600 MOVE-VALUE.
033700     ADD 1 TO WRK1.
033800     MOVE WRK1 TO ELEM1 (S1)  ELEM2 (S21, S22)
033900                  ELEM3 (S31, S32, S33).
034000     IF WRK1 EQUAL TO 60   GO TO SECT-TH109-0002.
034100 INCRE-SUBS.
034200     ADD 1 TO S1.
034300     ADD 1 TO S22.
034400     ADD 1 TO S33.
034500     IF S22 LESS THAN 6 GO TO MOVE-VALUE.
034600     MOVE 1 TO S22 S33.
034700     ADD 1 TO S21.
034800     ADD 1 TO S32.
034900     IF S32 LESS THAN 4 GO TO MOVE-VALUE.
035000     MOVE 1 TO S32.
035100     ADD 1 TO S31.
035200     GO TO MOVE-VALUE.
035300 SECT-TH109-0002 SECTION.
035400 SECT-0002-INIT.
035500     MOVE "LEFT PAREN SEPARATOR" TO FEATURE.
035600*       THIS SECTION TESTS THE USE OF LEFT PARENTHESIS AS A
035700*    SEPARATOR IN REFERENCING TABLE ITEMS.
035800 SEP-INIT-001.
035900     MOVE 6 TO S1.
036000 SEP-TEST-001.
036100     IF ELEM1(S1) IS EQUAL TO 6
036200             PERFORM PASS
036300             GO TO SEP-WRITE-001.
036400         PERFORM FAIL.
036500         GO TO SEP-FAIL-001.
036600 SEP-DELETE-001.
036700     PERFORM DE-LETE.
036800     GO TO SEP-WRITE-001.
036900 SEP-FAIL-001.
037000     MOVE ELEM1 (S1) TO COMPUTED-18V0.
037100     MOVE 6 TO CORRECT-18V0.
037200 SEP-WRITE-001.
037300     MOVE "SEP-TEST-001" TO PAR-NAME.
037400     PERFORM PRINT-DETAIL.
037500 SEP-INIT-002.
037600     MOVE 2 TO S21 S22.
037700 SEP-TEST-002.
037800     MOVE ELEM2(S21, S22) TO TEMP.
037900     IF TEMP EQUAL TO 7
038000             PERFORM PASS
038100             GO TO SEP-WRITE-002.
038200         PERFORM FAIL.
038300         GO TO SEP-FAIL-002.
038400 SEP-DELETE-002.
038500     PERFORM DE-LETE.
038600     GO TO SEP-WRITE-002.
038700 SEP-FAIL-002.
038800     MOVE TEMP TO COMPUTED-18V0.
038900     MOVE 7 TO CORRECT-18V0.
039000 SEP-WRITE-002.
039100     MOVE "SEP-TEST-002" TO PAR-NAME.
039200     PERFORM PRINT-DETAIL.
039300 SEP-INIT-003.
039400     MOVE 3 TO S31 S32 S33.
039500 SEP-TEST-003.
039600     MOVE ELEM3(S31, S32, S33)  TO TEMP.
039700     IF TEMP EQUAL TO 43
039800             PERFORM PASS
039900             GO TO SEP-WRITE-003.
040000         PERFORM FAIL.
040100         GO TO SEP-FAIL-003.
040200 SEP-DELETE-003.
040300     PERFORM DE-LETE.
040400     GO TO SEP-WRITE-003.
040500 SEP-FAIL-003.
040600     MOVE TEMP TO COMPUTED-18V0.
040700     MOVE 43 TO CORRECT-18V0.
040800 SEP-WRITE-003.
040900     MOVE "SEP-TEST-003" TO PAR-NAME.
041000     PERFORM PRINT-DETAIL.
041100 SEP-INIT-004.
041200     MOVE "SPACES AS SEPARATOR" TO FEATURE.
041300     MOVE "SEP-TEST-004" TO PAR-NAME.
041400     MOVE 0 TO REC-CT.
041500     MOVE 19 TO S1.
041600*        THIS TEST USES SPACES AS SEPARATORS IN REFERENCING
041700*    ONE DIMENSIONAL TABLE ELEMENTS.
041800     MOVE ZERO TO TEMP.
041900     MOVE 19 TO EXPECTED-VALUE.
042000 SEP-TEST-004-01.
042100     MOVE ELEM1 (S1 ) TO TEMP.
042200     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
042300 SEP-TEST-004-02.
042400     MOVE ELEM1    (S1) TO TEMP.
042500     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
042600 SEP-TEST-004-03.
042700     MOVE ELEM1   (S1     )   TO  TEMP.
042800     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
042900 SEP-TEST-004-04.
043000     MOVE ELEM1( S1) TO TEMP.
043100     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
043200 SEP-TEST-004-05.
043300     MOVE ELEM1 ( S1) TO TEMP.
043400     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
043500 SEP-TEST-004-06.
043600     MOVE ELEM1 ( S1 ) TO TEMP.
043700     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
043800 SEP-TEST-004-07.
043900     MOVE ELEM1 ( 19) TO TEMP.
044000     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
044100 SEP-TEST-004-08.
044200     MOVE ELEM1(S1 ) TO TEMP.
044300     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
044400 SEP-TEST-004-09.
044500     MOVE ELEM1 (   19     )   TO  TEMP.
044600     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
044700     GO TO SEP-INIT-005.
044800*         IF THE COMPILER REJECTS ANY OF THE ABOVE TABLE
044900*    REFERENCES, DELETE THAT LINE OF CODE BY PLACING
045000*    AN * IN COLUMN 7.  LEAVE THE PERFORM...THRU STATEMENT.
045100*    THE ELEMENT DELETED APPEARS AS A FAILURE ON THE
045200*    OUTPUT REPORT.
045300 SEP-DELETE-004.
045400     PERFORM DE-LETE.
045500     PERFORM SYNTAX-CHECK-WRITE.
045600 SEP-INIT-005.
045700     MOVE "SEP-TEST-005" TO PAR-NAME.
045800     MOVE 0 TO REC-CT.
045900     MOVE 10 TO S21.
046000     MOVE 03 TO S22.
046100     MOVE ZERO TO TEMP.
046200     MOVE 48 TO EXPECTED-VALUE.
046300*        THIS TEST USES SPACES AND COMMAS AS SEPARATORS IN
046400*    REFERENCING TWO DIMENSIONAL TABLE ELEMENTS.
046500 SEP-TEST-005-01.
046600     MOVE ELEM2 (S21 S22) TO TEMP.
046700     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
046800 SEP-TEST-005-02.
046900     MOVE ELEM2 (S21,  S22)  TO  TEMP.
047000     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
047100 SEP-TEST-005-03.
047200     MOVE ELEM2 (S21, S22) TO TEMP.
047300     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
047400 SEP-TEST-005-04.
047500     ADD ELEM2 ( S21   S22 ) TO TEMP.
047600     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
047700 SEP-TEST-005-05.
047800     MOVE 96 TO TEMP.
047900     SUBTRACT ELEM2(S21 S22) FROM TEMP.
048000     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
048100 SEP-TEST-005-06.
048200     MOVE ELEM2( S21,  S22) TO TEMP.
048300     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
048400 SEP-TEST-005-07.
048500     MOVE ELEM2   (   S21   S22  ) TO TEMP.
048600     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
048700 SEP-TEST-005-08.
048800     MOVE ELEM2 (S21 , S22) TO TEMP.
048900     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
049000 SEP-TEST-005-09.
049100     ADD ELEM2 (3 5)  ELEM2(7, 3) TO TEMP.
049200     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
049300 SEP-TEST-005-10.
049400     ADD ELEM2( 3  5 )  ELEM2 ( 7 3    )  TO  TEMP.
049500     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
049600     GO TO SEP-INIT-006.
049700*         IF THE COMPILER REJECTS ANY OF THE ABOVE TABLE
049800*    REFERENCES, DELETE THAT LINE OF CODE BY PLACING
049900*    AN ASTERISK IN COLUMN 7. LEAVE THE PERFORM...THRU STATEMENT.
050000*    THE ELEMENT DELETED APPEARS AS A FAILURE ON THE
050100*    OUTPUT REPORT.
050200 SEP-DELETE-005.
050300     PERFORM DE-LETE.
050400     PERFORM SYNTAX-CHECK-WRITE.
050500 SEP-INIT-006.
050600     MOVE "SEP-TEST-006" TO PAR-NAME.
050700     MOVE 0 TO REC-CT.
050800     MOVE ZERO TO TEMP.
050900     MOVE 3 TO S31.
051000     MOVE 2 TO S32 S33.
051100     MOVE 37 TO EXPECTED-VALUE.
051200*         THIS TEST USES SPACES AND COMMAS AS SEPARATORS IN
051300*    REFERENCING THREE DIMENSIONAL TABLE ELEMENTS.
051400 SEP-TEST-006-01.
051500     MOVE ELEM3(S31 S32 S33) TO TEMP.
051600     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
051700 SEP-TEST-006-02.
051800     MOVE ELEM3(S31, S32 S33)   TO TEMP.
051900     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
052000 SEP-TEST-006-03.
052100     ADD ELEM3  (  S31  S32  S33  )   TO  TEMP.
052200     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
052300 SEP-TEST-006-04.
052400     MOVE 74 TO TEMP.
052500     SUBTRACT ELEM3(S31 , S32 , S33) FROM TEMP.
052600     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
052700 SEP-TEST-006-05.
052800     MOVE 37 TO TEMP.
052900     IF ELEM3 ( S31, S32, S33 )
053000              NOT EQUAL TO TEMP
053100              MOVE ZERO TO TEMP.
053200     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
053300 SEP-TEST-006-06.
053400     MULTIPLY ELEM3 (3 2 2) BY 1
053500              GIVING TEMP.
053600     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
053700 SEP-TEST-006-07.
053800     ADD ELEM3 (1, 1, 1)   ELEM3( 3  2  1 )
053900              GIVING TEMP.
054000     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
054100     GO TO SEP-INIT-007.
054200*         IF THE COMPILER REJECTS ANY OF THE ABOVE TABLE
054300*    REFERENCES, DELETE THAT LINE OF CODE BY PLACING
054400*    AN * IN COLUMN 7.  LEAVE THE PERFORM...THRU STATEMENT.
054500*    THE ELEMENT DELETED APPEARS AS A FAILURE ON THE
054600*    OUTPUT REPORT.
054700 SEP-DELETE-006.
054800     PERFORM DE-LETE.
054900     PERFORM SYNTAX-CHECK-WRITE.
055000 SEP-INIT-007.
055100     MOVE "SEP-TEST-007" TO PAR-NAME.
055200     MOVE ZERO TO REC-CT.
055300     MOVE ZERO TO TEMP.
055400     MOVE 12 TO EXPECTED-VALUE.
055500*        THIS TEST USES SIGNED POSITIVE INTEGERS AS
055600*    SUBSCRIPTS AND SPACES AND COMMAS AS SEPARATORS.
055700 SEP-TEST-007-01.
055800     MOVE ELEM1(+12) TO TEMP.
055900     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
056000 SEP-TEST-007-02.
056100     IF ELEM2(+3 +2) EQUAL TO 12
056200        MOVE 12 TO TEMP.
056300     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
056400 SEP-TEST-007-03.
056500     ADD ELEM2 (+3, +2) TO TEMP.
056600     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
056700 SEP-TEST-007-04.
056800     MOVE 24 TO TEMP.
056900     SUBTRACT ELEM2 ( +3   +2 ) FROM TEMP.
057000     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
057100 SEP-TEST-007-05.
057200     MULTIPLY ELEM3(+1, +3, +2) BY +1
057300             GIVING TEMP.
057400     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
057500 SEP-TEST-007-06.
057600     DIVIDE ELEM3(+1 +3 +2) BY 1
057700             GIVING TEMP.
057800     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
057900 SEP-TEST-007-07.
058000     MOVE ELEM3 ( +1,  +3,  +2 ) TO TEMP.
058100     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
058200     GO TO CCVS-EXIT.
058300*         IF THE COMPILER REJECTS ANY OF THE ABOVE TABLE
058400*    REFERENCES, DELETE THAT LINE OF CODE BY PLACING
058500*    AN * IN COLUMN 7.  LEAVE THE PERFORM...THRU STATEMENT.
058600*    THE ELEMENT DELETED APPEARS AS A FAILURE ON THE
058700*    OUTPUT REPORT.
058800 SEP-DELETE-007.
058900     PERFORM DE-LETE.
059000     PERFORM SYNTAX-CHECK-WRITE.
059100     GO TO CCVS-EXIT.
059200 SEP-INIT-008.
059300     MOVE "IV-4 4.2.1(2)" TO ANSI-REFERENCE.
059400     MOVE "SEP-TEST-008" TO PAR-NAME.
059500     MOVE 0 TO REC-CT.
059600     MOVE ZERO TO TEMP.
059700     MOVE 3 TO S31.
059800     MOVE 2 TO S32 S33.
059900     MOVE 37 TO EXPECTED-VALUE.
060000*         THIS TEST USES SPACES AND COMMAS AND SEMI-COLONS
060100*         AS SEPARATORS IN
060200*         REFERENCING THREE DIMENSIONAL TABLE ELEMENTS.
060300 SEP-TEST-008-01.
060400     MOVE ELEM3(S31 S32; S33) TO TEMP.
060500     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
060600 SEP-TEST-008-02.
060700     MOVE ELEM3(S31, S32; S33)   TO TEMP.
060800     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
060900 SEP-TEST-008-03.
061000     ADD ELEM3  (  S31;  S32  S33  )   TO  TEMP.
061100     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
061200 SEP-TEST-008-04.
061300     MOVE 74 TO TEMP.
061400     SUBTRACT ELEM3(S31; S32 , S33) FROM TEMP.
061500     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
061600 SEP-TEST-008-05.
061700     MOVE 37 TO TEMP.
061800     IF ELEM3 ( S31; S32; S33 )
061900              NOT EQUAL TO TEMP
062000              MOVE ZERO TO TEMP.
062100     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
062200 SEP-TEST-008-06.
062300     MULTIPLY ELEM3 (3; 2, 2) BY 1
062400              GIVING TEMP.
062500     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
062600 SEP-TEST-008-07.
062700     ADD ELEM3 (1; 1, 1)   ELEM3( 3  2; 1 )
062800              GIVING TEMP.
062900     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
063000     GO TO SEP-INIT-007.
063100*         IF THE COMPILER REJECTS ANY OF THE ABOVE TABLE
063200*    REFERENCES, DELETE THAT LINE OF CODE BY PLACING
063300*    AN * IN COLUMN 7.  LEAVE THE PERFORM...THRU STATEMENT.
063400*    THE ELEMENT DELETED APPEARS AS A FAILURE ON THE
063500*    OUTPUT REPORT.
063600 SEP-DELETE-008.
063700     PERFORM DE-LETE.
063800     PERFORM SYNTAX-CHECK-WRITE.
063900 SECT-TH109-0003 SECTION.
064000 SYNTAX-CHECK.
064100     ADD 1 TO REC-CT.
064200     IF TEMP EQUAL TO EXPECTED-VALUE
064300             PERFORM PASS
064400             GO TO SYNTAX-CHECK-WRITE.
064500 SYNTAX-FAIL.
064600     PERFORM FAIL.
064700     MOVE TEMP TO COMPUTED-18V0.
064800     MOVE EXPECTED-VALUE TO CORRECT-18V0.
064900 SYNTAX-CHECK-WRITE.
065000     PERFORM PRINT-DETAIL.
065100     MOVE ZERO TO TEMP.
065200 CCVS-EXIT SECTION.
065300 CCVS-999999.
065400     GO TO CLOSE-FILES.
