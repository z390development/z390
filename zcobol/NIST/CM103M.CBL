000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     CM103M.
000400 AUTHOR.
000500     FEDERAL COMPILER TESTING CENTER.
000600 INSTALLATION.
000700     GENERAL SERVICES ADMINISTRATION
000800     AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
000900     SOFTWARE DEVELOPMENT OFFICE.
001000     5203 LEESBURG PIKE  SUITE 1100
001100     FALLS CHURCH VIRGINIA 22041.
001200
001300     PHONE   (703) 756-6153
001400
001500     " HIGH       ".
001600 DATE-WRITTEN.
001700     CCVS-74 VERSION 4.0 - 1980 JULY 1.
001800     CREATION DATE     /    VALIDATION DATE
001900     "4.2 ".
002000 SECURITY.
002100     NONE.
002200 ENVIRONMENT DIVISION.
002300 CONFIGURATION SECTION.
002400 SOURCE-COMPUTER.
002500     XXXXX082.
002600 OBJECT-COMPUTER.
002700     XXXXX083.
002800 INPUT-OUTPUT SECTION.
002900 FILE-CONTROL.
003000     SELECT PRINT-FILE ASSIGN TO
003100     XXXXX055.
003200 DATA DIVISION.
003300 FILE SECTION.
003400 FD  PRINT-FILE
003500     LABEL RECORDS
003600     XXXXX084
003700     DATA RECORD IS PRINT-REC DUMMY-RECORD.
003800 01  PRINT-REC PICTURE X(120).
003900 01  DUMMY-RECORD PICTURE X(120).
004000 WORKING-STORAGE SECTION.
004100 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
004200 01  REC-CT PICTURE 99 VALUE ZERO.
004300 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
004400 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
004500 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
004600 01  PASS-COUNTER PIC 999 VALUE ZERO.
004700 01  TOTAL-ERROR PIC 999 VALUE ZERO.
004800 01  ERROR-HOLD PIC 999 VALUE ZERO.
004900 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
005000 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
005100 01  CCVS-H-1.
005200     02  FILLER   PICTURE X(27)  VALUE SPACE.
005300     02 FILLER PICTURE X(67) VALUE
005400     " FEDERAL COMPILER TESTING CENTER COBOL COMPILER VALIDATION
005500-    " SYSTEM".
005600     02  FILLER     PICTURE X(26)  VALUE SPACE.
005700 01  CCVS-H-2.
005800     02 FILLER PICTURE X(52) VALUE IS
005900     "CCVS74 NCC  COPY, NOT FOR DISTRIBUTION.".
006000     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
006100     02 TEST-ID PICTURE IS X(9).
006200     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
006300 01  CCVS-H-3.
006400     02  FILLER PICTURE X(34) VALUE
006500     " FOR OFFICIAL USE ONLY    ".
006600     02  FILLER PICTURE X(58) VALUE
006700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
006800     02  FILLER PICTURE X(28) VALUE
006900     "  COPYRIGHT   1974 ".
007000 01  CCVS-E-1.
007100     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
007200     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
007300     02 ID-AGAIN PICTURE IS X(9).
007400     02 FILLER PICTURE X(45) VALUE IS
007500     " NTIS DISTRIBUTION COBOL 74".
007600 01  CCVS-E-2.
007700     02  FILLER                   PICTURE X(31)  VALUE
007800     SPACE.
007900     02  FILLER                   PICTURE X(21)  VALUE SPACE.
008000     02 CCVS-E-2-2.
008100         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
008200         03 FILLER PICTURE IS X VALUE IS SPACE.
008300         03 ENDER-DESC PIC X(44) VALUE "ERRORS ENCOUNTERED".
008400 01  CCVS-E-3.
008500     02  FILLER PICTURE X(22) VALUE
008600     " FOR OFFICIAL USE ONLY".
008700     02  FILLER PICTURE X(12) VALUE SPACE.
008800     02  FILLER PICTURE X(58) VALUE
008900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
009000     02  FILLER PICTURE X(13) VALUE SPACE.
009100     02 FILLER PIC X(15) VALUE " COPYRIGHT 1974".
009200 01  CCVS-E-4.
009300     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
009400     02 FILLER PIC XXXX VALUE " OF ".
009500     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
009600     02 FILLER PIC X(40) VALUE
009700      "  TESTS WERE EXECUTED SUCCESSFULLY".
009800 01  XXINFO.
009900     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
010000     02 INFO-TEXT.
010100     04 FILLER PIC X(20) VALUE SPACE.
010200     04 XXCOMPUTED PIC X(20).
010300     04 FILLER PIC X(5) VALUE SPACE.
010400     04 XXCORRECT PIC X(20).
010500 01  HYPHEN-LINE.
010600     02 FILLER PICTURE IS X VALUE IS SPACE.
010700     02 FILLER PICTURE IS X(65) VALUE IS "************************
010800-    "*****************************************".
010900     02 FILLER PICTURE IS X(54) VALUE IS "************************
011000-    "******************************".
011100 01  CCVS-PGM-ID PIC X(6) VALUE
011200     "CM103M".
011300 01  MCS-TIME.
011400     02  HRS PIC 99.
011500     02  MINS PIC 99.
011600     02  SECS PIC 99V99.
011700 01  IN-TIME.
011800     02  IN-HRS PIC 99.
011900     02  IN-MINS PIC 99.
012000     02  IN-SECS PIC 99V99.
012100 01  OUT-TIME.
012200     02  OUT-HRS PIC 99.
012300     02  OUT-MINS PIC 99.
012400     02  OUT-SECS PIC 99V99.
012500 01  LOG-HDR-1.
012600     02  FILLER PIC X(54) VALUE SPACES.
012700     02  FILLER PIC X(11) VALUE "MESSAGE LOG".
012800 01  LOG-HDR-2.
012900     02  FILLER PIC X VALUE SPACE.
013000     02  FILLER PIC X(12) VALUE "MCS RECEIPT".
013100     02  FILLER PIC X(8) VALUE "PROGRAM".
013200     02  FILLER PIC X(9) VALUE "MCS REC".
013300     02  FILLER PIC X(12) VALUE "RECV SEND".
013400     02  FILLER PIC X(38) VALUE "MSG".
013500     02  FILLER PIC X(7) VALUE "MESSAGE".
013600 01  LOG-HDR-3.
013700     02  FILLER PIC XXX VALUE SPACE.
013800     02  FILLER PIC X(10) VALUE "INBOUND".
013900     02  FILLER PIC X(8) VALUE "RECEIPT".
014000     02  FILLER PIC X(9) VALUE "OUTB""ND".
014100     02  FILLER PIC X(11) VALUE "STAT STAT".
014200     02  FILLER PIC X(39) VALUE "LENGTH".
014300     02  FILLER PIC X(7) VALUE "CONTENT".
014400 01  LOG-HDR-4.
014500     02  FILLER PIC X VALUE SPACE.
014600     02  FILLER PIC X(11) VALUE ALL "-".
014700     02  FILLER PIC X VALUE SPACE.
014800     02  FILLER PIC X(7) VALUE ALL "-".
014900     02  FILLER PIC X VALUE SPACE.
015000     02  FILLER PIC X(7) VALUE ALL "-".
015100     02  FILLER PIC XX VALUE SPACES.
015200     02  FILLER PIC X(11) VALUE "---- ----".
015300     02  FILLER PIC X(5) VALUE ALL "-".
015400     02  FILLER PIC XX VALUE SPACES.
015500     02  FILLER PIC X(72) VALUE ALL "-".
015600 01  LOG-LINE.
015700     02  FILLER PIC X VALUE SPACE.
015800     02  TIME-REC.
015900         03  HRS PIC 99.
016000         03  FILLER PIC X VALUE ":".
016100         03  MINS PIC 99.
016200         03  FILLER PIC X VALUE ":".
016300         03  SECS PIC 99.99.
016400     02  FILLER PIC X VALUE SPACE.
016500     02  PROG-TIME PIC ---.99.
016600     02  FILLER PIC XX VALUE SPACES.
016700     02  TIME-SENT PIC ---.99.
016800     02  FILLER PIC XXXX VALUE SPACES.
016900     02  RECV-STATUS PIC XX.
017000     02  FILLER PIC XX VALUE SPACES.
017100     02  SEND-STATUS PIC XX.
017200     02  FILLER PIC X VALUE "/".
017300     02  SEND-ERR PIC X.
017400     02  FILLER PIC XXX VALUE SPACES.
017500     02  MSG-LNGTH PIC ZZ9.
017600     02  FILLER PIC XXX VALUE SPACES.
017700     02  MSG.
017800         03  KILL-FIELD PIC X(4).
017900         03  FILLER PIC X(68).
018000 COMMUNICATION SECTION.
018100 CD  CM-INQUE-1 FOR INPUT
018200     MAIN-QUEUE NO-SPEC-1 NO-SPEC-2 NO-SPEC-3 FILLER TIME-RECEIVED
018300     FILLER IN-LENGTH END-KEY IN-STATUS FILLER.
018400 CD  CM-OUTQUE-1 FOR OUTPUT.
018500 01  OUTQUE-SPECIFICATIONS.
018600     02  ONE PIC 9999 VALUE IS 1.
018700     02  OUT-LENGTH PIC 9999.
018800     02  OUT-STATUS PIC XX.
018900     02  ERR-KEY PIC X.
019000     02  SYM-DEST PIC X(12) VALUE IS
019100     XXXXX032.
019200 PROCEDURE    DIVISION.
019300 SECT-CM103M-0001 SECTION.
019400 CM103M-INIT.
019500     OPEN     OUTPUT PRINT-FILE.
019600     MOVE "CM103M     " TO TEST-ID.
019700     MOVE     TEST-ID TO ID-AGAIN.
019800     MOVE SPACES TO NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
019900     MOVE
020000     XXXXX030
020100         TO MAIN-QUEUE.
020200     ENABLE INPUT CM-INQUE-1 WITH KEY
020300     XXXXX031.
020400     ENABLE OUTPUT CM-OUTQUE-1 WITH KEY
020500     XXXXX033.
020600     PERFORM HEAD-ROUTINE.
020700     PERFORM LOG-HEADER.
020800 RECEIVE-ECHO-AND-LOG.
020900     MOVE SPACES TO MSG.
021000     RECEIVE CM-INQUE-1 MESSAGE INTO MSG.
021100     ACCEPT IN-TIME FROM TIME.
021200     IF IN-LENGTH IS GREATER THAN 72
021300         MOVE 72 TO OUT-LENGTH
021400         ELSE MOVE IN-LENGTH TO OUT-LENGTH.
021500     SEND CM-OUTQUE-1 FROM MSG WITH EMI.
021600     ACCEPT OUT-TIME FROM TIME.
021700     MOVE TIME-RECEIVED TO MCS-TIME.
021800     MOVE CORR MCS-TIME TO TIME-REC.
021900     COMPUTE PROG-TIME =
022000         (IN-HRS * 3600 + IN-MINS * 60 + IN-SECS)  -
022100         (HRS OF MCS-TIME * 3600 + MINS OF MCS-TIME * 60 +
022200          SECS OF MCS-TIME).
022300     COMPUTE TIME-SENT =
022400         (OUT-HRS * 3600 + OUT-MINS * 60 + OUT-SECS)  -
022500         (HRS OF MCS-TIME * 3600 + MINS OF MCS-TIME * 60 +
022600          SECS OF MCS-TIME).
022700     MOVE IN-STATUS TO RECV-STATUS.
022800     MOVE OUT-STATUS TO SEND-STATUS.
022900     MOVE ERR-KEY TO SEND-ERR.
023000     MOVE IN-LENGTH TO MSG-LNGTH.
023100     MOVE LOG-LINE TO PRINT-REC.
023200     WRITE PRINT-REC.
023300     IF KILL-FIELD IS NOT EQUAL TO "KILL"
023400         GO TO RECEIVE-ECHO-AND-LOG.
023500     PERFORM END-ROUTINE THRU END-ROUTINE-3.
023600     CLOSE    PRINT-FILE.
023700     STOP     RUN.
023800 END-ROUTINE.
023900     MOVE     HYPHEN-LINE TO DUMMY-RECORD.
024000     PERFORM WRITE-LINE.
024100 PARA-Z.
024200     PERFORM  BLANK-LINE-PRINT 4 TIMES.
024300     MOVE     CCVS-E-1 TO DUMMY-RECORD.
024400     PERFORM WRITE-LINE.
024500 END-ROUTINE-3.
024600     MOVE     CCVS-E-2 TO DUMMY-RECORD.
024700     PERFORM WRITE-LINE.
024800     MOVE CCVS-E-3 TO DUMMY-RECORD.
024900     PERFORM WRITE-LINE.
025000 BLANK-LINE-PRINT.
025100     MOVE     SPACE TO DUMMY-RECORD.
025200     PERFORM WRITE-LINE.
025300 WRITE-LINE.
025400     WRITE DUMMY-RECORD AFTER ADVANCING 1 LINE.
025500 LOG-HEADER.
025600     MOVE LOG-HDR-1 TO PRINT-REC
025700     WRITE PRINT-REC
025800         AFTER 3 LINES.
025900     MOVE LOG-HDR-2 TO PRINT-REC.
026000     WRITE PRINT-REC
026100         AFTER 3 LINES.
026200     MOVE LOG-HDR-3 TO PRINT-REC.
026300     WRITE PRINT-REC
026400     MOVE LOG-HDR-4 TO PRINT-REC.
026500     PERFORM WRITE-LINE.
026600     MOVE SPACES TO PRINT-REC.
026700     PERFORM WRITE-LINE.
026800 HEAD-ROUTINE.
026900     MOVE CCVS-H-1 TO PRINT-REC
027000     WRITE PRINT-REC
027100         AFTER ADVANCING PAGE.
027200     MOVE CCVS-H-2 TO PRINT-REC.
027300     WRITE PRINT-REC
027400         AFTER 2 LINES.
027500     MOVE CCVS-H-3 TO PRINT-REC.
027600     WRITE PRINT-REC
027700         AFTER 5 LINES.
027800     MOVE HYPHEN-LINE TO PRINT-REC.
027900     PERFORM WRITE-LINE.
