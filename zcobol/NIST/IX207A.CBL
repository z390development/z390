000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IX207A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*IX207A
001400******************************************************************
001500*GENERAL:  THE FUNCTION OF THIS PROGRAM IS TO TEST THE PERMISSIBLE
001600*    SYNTACTICAL CONSTRUCTS OF COBOL ELEMENTS ASSOCIATED WITH
001700*    LEVEL 2 OF INDEXED I-O.  THE ELEMENTS TESTED IN THIS
001800*     ROUTINE ARE:
001900*
002000*    (1) ORDERING OF CLAUSES IN FILE-CONTROL-ENTRY;
002100*    (2) ALTERNATE RECORD KEY WITH THE DUPLICATES OPTION;
002200*    (3) USE AFTER STANDARD EXCEPTION FILE-NAME-1, FILE-NAME-2;
002300*    (4) FILE STATUS.
002400*
002500*    EACH ELEMENT TESTED WILL BE EXERCISED SEMANTICALLY BY THIS
002600*    ROUTINE.  FILES ARE CREATED AND ACCESSED IN THE SEQUENTIAL
002700*    ACCESS MODE.
002800*
002900*
003000*       X-CARDS  WHICH MUST BE REPLACED FOR THIS PROGRAM ARE
003100*
003200*             X-24   INDEXED FILE IMPLEMENTOR-NAME IN ASSGN TO
003300*                    CLAUSE FOR DATA FILE IX-FS1
003400*             X-25   INDEXED FILE IMPLEMENTOR-NAME IN ASSIGN TO
003500*                    CLAUSE FOR DATA FILE IX-FD2
003600*             X-44   INDEXED FILE IMPLEMENTOR-NAME IN ASSGN TO
003700*                    CLAUSE FOR INDEX FILE IX-FS1
003800*             X-45   INDEXED FILE IMPLEMENTOR-NAME IN ASSIGN TO
003900*                    CLAUSE FOR INDEX FILE IX-FD2
004000*             X-55   IMPLEMENTOR-NAME FOR SYSTEM PRINTER
004100*             X-62   FOR RAW-DATA
004200*             X-82   IMPLEMENTOR-NAME FOR SOURCE-COMPUTER
004300*             X-83   IMPLEMENTOR-NAME FOR OBJECT-COMPUTER
004400*             X-84   LABEL RECORDS  FOR PRINT-FILE
004500*
004600*        NOTE:  X-CARDS 44, 45, 62 AND 84     ARE OPTIONAL
004700*               AND NEED ONLY TO BE PRESENT IF THE COMPILER RE-
004800*               QUIRES THIS CODE BE AVAILABLE FOR PROPER PROGRAM
004900*               COMPILATION AND EXECUTION. IF THE VP-ROUTINE IS
005000*               USED THE  X-CARDS MAY BE AUTOMATICALLY SELECTED
005100*               FOR INCLUSION IN THE PROGRAM BY SPECIFYING THE
005200*               APPROPRIATE LETTER IN THE "*OPT" VP-ROUTINE
005300*               CONTROL CARD. THE LETTER  CORRESPONDS TO A
005400*               CHARACTER IN POSITION 7 OF THE SOURCE LINE AND
005500*               THEY ARE AS FOLLOWS
005600*
005700*                  P  SELECTS X-CARDS 62
005800*                  C  SELECTS X-CARDS 84
005900*
006000*        NOTE:  THERE IS OPTIONAL SOURCE CODE IN THIS PROGRAM
006100*               FOR THE CONVENIENCE OF THE USER.  THIS OPTIONAL
006200*               CODE IS IDENTIFIED BY THE LETTER T,U OR X IN
006300*               POSITION 7  OF THE SOURCE LINE.  USE OF
006400*               SOURCE CODE WITH LETTER X WILL PRINT THE CONTENTS
006500*               OF THE FILES AFTER THE TEST REPORT.  FOR CODE
006600*               WITH LETTERS T OR U ONLY ONE SHOULD BE SELECTED.
006700*               EITHER THE T"S OR THE U"S SHOULD BE USED EXCLU-
006800*               SIVELY, NOT BOTH.  THE T"S PROVIDE A 29 CHARACTER
006900*               INDEXED KEY SIZE FOR THE FILE AND THE U"S PROVIDE
007000*               AN INDEXED KEY NO GREATER THAN 8 CHARACTERS.
007100*               IF THE VP-ROUTINE IS USED THE APPROPRIATE
007200*               SOURCE CODE MAY BE SELECTED BY SPECIFYING THE
007300*               RESPECTIVE LETTER IN THE "*OPT" VP-ROUTINE CONTROL
007400*               CARD.
007500*
007600******************************************************
007700 ENVIRONMENT DIVISION.
007800 CONFIGURATION SECTION.
007900 SOURCE-COMPUTER.
008000     XXXXX082.
008100 OBJECT-COMPUTER.
008200     XXXXX083.
008300 INPUT-OUTPUT SECTION.
008400 FILE-CONTROL.
008500P    SELECT RAW-DATA   ASSIGN TO
008600P    XXXXX062
008700P           ORGANIZATION IS INDEXED
008800P           ACCESS MODE IS RANDOM
008900P           RECORD KEY IS RAW-DATA-KEY.
009000     SELECT PRINT-FILE ASSIGN TO
009100     XXXXX055.
009200
009300     SELECT   IX-FS1
009400     ACCESS MODE IS  SEQUENTIAL
009500     ALTERNATE RECORD  IX-FS1-ALTKEY1
009600              WITH  DUPLICATES
009700     FILE STATUS FS1-STATUS
009800     RECORD KEY IS  IX-FS1-KEY
009900     ORGANIZATION  IS INDEXED
010000     ASSIGN TO
010100J    XXXXX044
010200     XXXXX024.
010300
010400     SELECT   IX-FS2
010500     ASSIGN  TO
010600     XXXXX025
010700J    XXXXX045
010800     ORGANIZATION IS INDEXED
010900     ALTERNATE  RECORD KEY  IX-FS2-ALTKEY1
011000              DUPLICATES
011100     RECORD  KEY  IS  IX-FS2-KEY.
011200
011300 DATA DIVISION.
011400 FILE SECTION.
011500P
011600PFD  RAW-DATA.
011700P
011800P01  RAW-DATA-SATZ.
011900P    05  RAW-DATA-KEY        PIC X(6).
012000P    05  C-DATE              PIC 9(6).
012100P    05  C-TIME              PIC 9(8).
012200P    05  C-NO-OF-TESTS       PIC 99.
012300P    05  C-OK                PIC 999.
012400P    05  C-ALL               PIC 999.
012500P    05  C-FAIL              PIC 999.
012600P    05  C-DELETED           PIC 999.
012700P    05  C-INSPECT           PIC 999.
012800P    05  C-NOTE              PIC X(13).
012900P    05  C-INDENT            PIC X.
013000P    05  C-ABORT             PIC X(8).
013100 FD  PRINT-FILE.
013200 01  PRINT-REC PICTURE X(120).
013300 01  DUMMY-RECORD PICTURE X(120).
013400 FD  IX-FS1
013500C    LABEL RECORD IS STANDARD
013600C    DATA RECORD IS  IX-FS1R1-F-G-240
013700     RECORD CONTAINS  240 CHARACTERS.
013800 01  IX-FS1R1-F-G-240.
013900     05 IX-FS1-REC-120           PIC X(120).
014000     05 IX-FS1-REC-121-240.
014100        10 FILLER                 PIC X(8).
014200        10 IX-FS1-KEY.
014300           15 IX-FS1-KEYNUM       PIC 9(5).
014400T          15 FILLER              PIC X(24).
014500U       10 FILLER                 PIC X(24).
014600        10 FILLER                 PIC X(9).
014700        10 IX-FS1-ALTKEY1.
014800T          15 FILLER              PIC X(24).
014900           15 IX-FS1-ALTKEY1NUM   PIC 9(5).
015000U       10 FILLER                 PIC X(24).
015100        10 FILLER                 PIC X(45).
015200 FD  IX-FS2
015300C    LABEL RECORDS ARE STANDARD
015400C    DATA RECORD IS IX-FS2R1-F-G-240
015500     RECORD CONTAINS 240 CHARACTERS.
015600 01  IX-FS2R1-F-G-240.
015700     05 IX-FS2-REC-120            PIC X(120).
015800     05 IX-FS2-REC-121-240.
015900        10 FILLER                 PIC X(8).
016000        10 IX-FS2-KEY.
016100           15 IX-FS2-KEYNUM       PIC 9(5).
016200T          15 FILLER              PIC A(24).
016300U       10 FILLER                 PIC X(24).
016400        10 FILLER                 PIC X(9).
016500        10 IX-FS2-ALTKEY1.
016600T          15 FILLER              PIC X(24).
016700           15 IX-FS2-ALTKEY1NUM   PIC 9(5).
016800U       10 FILLER                 PIC X(24).
016900        10 FILLER                 PIC X(45).
017000 WORKING-STORAGE SECTION.
017100 01  IX-FS1-FILESIZE              PIC 9(6)  VALUE 300.
017200 01  IX-FS2-FILESIZE              PIC 9(6)  VALUE 300.
017300 01  WRK-FS1-RECKEY.
017400     03 WRK-DU-05V00-001          PIC 9(5) VALUE ZERO.
017500T    03 WRK-XN-24V00-001          PIC X(24) VALUE
017600T             "123456789009876543211234".
017700 01  WRK-FS2-RECKEY.
017800     03 WRK-DU-05V00-002          PIC 9(5) VALUE  ZERO.
017900T    03 WRK-XN-24V00-002          PIC A(24) VALUE
018000T             "ABCDEFGHIJKLMNOPQRSTUVWX".
018100 01  WRK-FS1-ALTKEY.
018200T    03 WRK-XN-24V00-003          PIC X(24) VALUE
018300T             "+-*/=$,;.(()><""<>()).;,$".
018400*
018500*    THE ALPHNUMERIC POSITIONS OF THE DATA ITEM ABOVE CONTAINS A
018600*    LITERAL VALUE WITH INBEDDED QUOTES.
018700*
018800     03 WRK-DU-05V00-003          PIC 9(5)  VALUE ZERO.
018900 01  WRK-FS2-ALTKEY.
019000T    03 WRK-XN-24V00-003          PIC X(24) VALUE
019100T             "AB12CD34EF56GH78IJ90KL*,".
019200     03 WRK-DU-05V00-004          PIC 9(5)  VALUE ZERO.
019300 01  WRK-DS-05V00-005             PIC S9(5) VALUE  ZERO.
019400 01  WRK-DS-05V00-006             PIC S9(5) VALUE  ZERO.
019500 01  WRK-DS-05V00-007             PIC S9(5) VALUE  ZERO.
019600 01  WRK-DS-05V00-008             PIC S9(5) VALUE  ZERO.
019700 01  WRK-DS-04V00-001             PIC S9(4) VALUE  ZERO.
019800 01  WRK-DS-04V00-002             PIC S9(4) VALUE  ZERO.
019900 01  FS1-STATUS                   PIC XX  VALUE SPACE.
020000 01  FILE-RECORD-INFORMATION-REC.
020100     03 FILE-RECORD-INFO-SKELETON.
020200        05 FILLER                 PICTURE X(48)       VALUE
020300             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
020400        05 FILLER                 PICTURE X(46)       VALUE
020500             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
020600        05 FILLER                 PICTURE X(26)       VALUE
020700             ",LFIL=000000,ORG=  ,LBLR= ".
020800        05 FILLER                 PICTURE X(37)       VALUE
020900             ",RECKEY=                             ".
021000        05 FILLER                 PICTURE X(38)       VALUE
021100             ",ALTKEY1=                             ".
021200        05 FILLER                 PICTURE X(38)       VALUE
021300             ",ALTKEY2=                             ".
021400        05 FILLER                 PICTURE X(7)        VALUE SPACE.
021500     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
021600        05 FILE-RECORD-INFO-P1-120.
021700           07 FILLER              PIC X(5).
021800           07 XFILE-NAME           PIC X(6).
021900           07 FILLER              PIC X(8).
022000           07 XRECORD-NAME         PIC X(6).
022100           07 FILLER              PIC X(1).
022200           07 REELUNIT-NUMBER     PIC 9(1).
022300           07 FILLER              PIC X(7).
022400           07 XRECORD-NUMBER       PIC 9(6).
022500           07 FILLER              PIC X(6).
022600           07 UPDATE-NUMBER       PIC 9(2).
022700           07 FILLER              PIC X(5).
022800           07 ODO-NUMBER          PIC 9(4).
022900           07 FILLER              PIC X(5).
023000           07 XPROGRAM-NAME        PIC X(5).
023100           07 FILLER              PIC X(7).
023200           07 XRECORD-LENGTH       PIC 9(6).
023300           07 FILLER              PIC X(7).
023400           07 CHARS-OR-RECORDS    PIC X(2).
023500           07 FILLER              PIC X(1).
023600           07 XBLOCK-SIZE          PIC 9(4).
023700           07 FILLER              PIC X(6).
023800           07 RECORDS-IN-FILE     PIC 9(6).
023900           07 FILLER              PIC X(5).
024000           07 XFILE-ORGANIZATION   PIC X(2).
024100           07 FILLER              PIC X(6).
024200           07 XLABEL-TYPE          PIC X(1).
024300        05 FILE-RECORD-INFO-P121-240.
024400           07 FILLER              PIC X(8).
024500           07 XRECORD-KEY          PIC X(29).
024600           07 FILLER              PIC X(9).
024700           07 ALTERNATE-KEY1      PIC X(29).
024800           07 FILLER              PIC X(9).
024900           07 ALTERNATE-KEY2      PIC X(29).
025000           07 FILLER              PIC X(7).
025100 01  TEST-RESULTS.
025200     02 FILLER                   PIC X      VALUE SPACE.
025300     02 FEATURE                  PIC X(20)  VALUE SPACE.
025400     02 FILLER                   PIC X      VALUE SPACE.
025500     02 P-OR-F                   PIC X(5)   VALUE SPACE.
025600     02 FILLER                   PIC X      VALUE SPACE.
025700     02  PAR-NAME.
025800       03 FILLER                 PIC X(19)  VALUE SPACE.
025900       03  PARDOT-X              PIC X      VALUE SPACE.
026000       03 DOTVALUE               PIC 99     VALUE ZERO.
026100     02 FILLER                   PIC X(8)   VALUE SPACE.
026200     02 RE-MARK                  PIC X(61).
026300 01  TEST-COMPUTED.
026400     02 FILLER                   PIC X(30)  VALUE SPACE.
026500     02 FILLER                   PIC X(17)  VALUE
026600            "       COMPUTED=".
026700     02 COMPUTED-X.
026800     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
026900     03 COMPUTED-N               REDEFINES COMPUTED-A
027000                                 PIC -9(9).9(9).
027100     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
027200     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
027300     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
027400     03       CM-18V0 REDEFINES COMPUTED-A.
027500         04 COMPUTED-18V0                    PIC -9(18).
027600         04 FILLER                           PIC X.
027700     03 FILLER PIC X(50) VALUE SPACE.
027800 01  TEST-CORRECT.
027900     02 FILLER PIC X(30) VALUE SPACE.
028000     02 FILLER PIC X(17) VALUE "       CORRECT =".
028100     02 CORRECT-X.
028200     03 CORRECT-A                  PIC X(20) VALUE SPACE.
028300     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
028400     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
028500     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
028600     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
028700     03      CR-18V0 REDEFINES CORRECT-A.
028800         04 CORRECT-18V0                     PIC -9(18).
028900         04 FILLER                           PIC X.
029000     03 FILLER PIC X(2) VALUE SPACE.
029100     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
029200 01  CCVS-C-1.
029300     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
029400-    "SS  PARAGRAPH-NAME
029500-    "       REMARKS".
029600     02 FILLER                     PIC X(20)    VALUE SPACE.
029700 01  CCVS-C-2.
029800     02 FILLER                     PIC X        VALUE SPACE.
029900     02 FILLER                     PIC X(6)     VALUE "TESTED".
030000     02 FILLER                     PIC X(15)    VALUE SPACE.
030100     02 FILLER                     PIC X(4)     VALUE "FAIL".
030200     02 FILLER                     PIC X(94)    VALUE SPACE.
030300 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
030400 01  REC-CT                        PIC 99       VALUE ZERO.
030500 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
030600 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
030700 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
030800 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
030900 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
031000 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
031100 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
031200 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
031300 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
031400 01  CCVS-H-1.
031500     02  FILLER                    PIC X(39)    VALUE SPACES.
031600     02  FILLER                    PIC X(42)    VALUE
031700     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
031800     02  FILLER                    PIC X(39)    VALUE SPACES.
031900 01  CCVS-H-2A.
032000   02  FILLER                        PIC X(40)  VALUE SPACE.
032100   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
032200   02  FILLER                        PIC XXXX   VALUE
032300     "4.2 ".
032400   02  FILLER                        PIC X(28)  VALUE
032500            " COPY - NOT FOR DISTRIBUTION".
032600   02  FILLER                        PIC X(41)  VALUE SPACE.
032700
032800 01  CCVS-H-2B.
032900   02  FILLER                        PIC X(15)  VALUE
033000            "TEST RESULT OF ".
033100   02  TEST-ID                       PIC X(9).
033200   02  FILLER                        PIC X(4)   VALUE
033300            " IN ".
033400   02  FILLER                        PIC X(12)  VALUE
033500     " HIGH       ".
033600   02  FILLER                        PIC X(22)  VALUE
033700            " LEVEL VALIDATION FOR ".
033800   02  FILLER                        PIC X(58)  VALUE
033900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
034000 01  CCVS-H-3.
034100     02  FILLER                      PIC X(34)  VALUE
034200            " FOR OFFICIAL USE ONLY    ".
034300     02  FILLER                      PIC X(58)  VALUE
034400     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
034500     02  FILLER                      PIC X(28)  VALUE
034600            "  COPYRIGHT   1985 ".
034700 01  CCVS-E-1.
034800     02 FILLER                       PIC X(52)  VALUE SPACE.
034900     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
035000     02 ID-AGAIN                     PIC X(9).
035100     02 FILLER                       PIC X(45)  VALUE SPACES.
035200 01  CCVS-E-2.
035300     02  FILLER                      PIC X(31)  VALUE SPACE.
035400     02  FILLER                      PIC X(21)  VALUE SPACE.
035500     02 CCVS-E-2-2.
035600         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
035700         03 FILLER                   PIC X      VALUE SPACE.
035800         03 ENDER-DESC               PIC X(44)  VALUE
035900            "ERRORS ENCOUNTERED".
036000 01  CCVS-E-3.
036100     02  FILLER                      PIC X(22)  VALUE
036200            " FOR OFFICIAL USE ONLY".
036300     02  FILLER                      PIC X(12)  VALUE SPACE.
036400     02  FILLER                      PIC X(58)  VALUE
036500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
036600     02  FILLER                      PIC X(13)  VALUE SPACE.
036700     02 FILLER                       PIC X(15)  VALUE
036800             " COPYRIGHT 1985".
036900 01  CCVS-E-4.
037000     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
037100     02 FILLER                       PIC X(4)   VALUE " OF ".
037200     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
037300     02 FILLER                       PIC X(40)  VALUE
037400      "  TESTS WERE EXECUTED SUCCESSFULLY".
037500 01  XXINFO.
037600     02 FILLER                       PIC X(19)  VALUE
037700            "*** INFORMATION ***".
037800     02 INFO-TEXT.
037900       04 FILLER                     PIC X(8)   VALUE SPACE.
038000       04 XXCOMPUTED                 PIC X(20).
038100       04 FILLER                     PIC X(5)   VALUE SPACE.
038200       04 XXCORRECT                  PIC X(20).
038300     02 INF-ANSI-REFERENCE           PIC X(48).
038400 01  HYPHEN-LINE.
038500     02 FILLER  PIC IS X VALUE IS SPACE.
038600     02 FILLER  PIC IS X(65)    VALUE IS "************************
038700-    "*****************************************".
038800     02 FILLER  PIC IS X(54)    VALUE IS "************************
038900-    "******************************".
039000 01  CCVS-PGM-ID                     PIC X(9)   VALUE
039100     "IX207A".
039200 PROCEDURE DIVISION.
039300 DECLARATIVES.
039400 USE-IX207A-TEST SECTION.
039500     USE     AFTER STANDARD EXCEPTION PROCEDURE
039600              IX-FS1, IX-FS2.
039700 USE-PAR-001.
039800     ADD      00001  TO WRK-DS-05V00-006.
039900     IF       WRK-DS-05V00-005 LESS THAN 301
040000              GO TO USE-PAR-EXIT.
040100 USE-PAR-002.
040200     IF       WRK-DS-05V00-006 EQUAL TO 0001
040300             MOVE  "PASS"  TO P-OR-F.
040400     ADD     1 TO DOTVALUE.
040500     MOVE    "EXCEPTION PROCEDURE EXECUTED" TO RE-MARK.
040600     MOVE     TEST-RESULTS TO  PRINT-REC.
040700     WRITE    PRINT-REC.
040800 USE-PAR-EXIT.
040900     EXIT.
041000 END DECLARATIVES.
041100 CCVS1 SECTION.
041200 OPEN-FILES.
041300P    OPEN I-O RAW-DATA.
041400P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
041500P    READ RAW-DATA INVALID KEY GO TO END-E-1.
041600P    MOVE "ABORTED " TO C-ABORT.
041700P    ADD 1 TO C-NO-OF-TESTS.
041800P    ACCEPT C-DATE  FROM DATE.
041900P    ACCEPT C-TIME  FROM TIME.
042000P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
042100PEND-E-1.
042200P    CLOSE RAW-DATA.
042300     OPEN    OUTPUT PRINT-FILE.
042400     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
042500     MOVE    SPACE TO TEST-RESULTS.
042600     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
042700     MOVE    ZERO TO REC-SKL-SUB.
042800     PERFORM CCVS-INIT-FILE 9 TIMES.
042900 CCVS-INIT-FILE.
043000     ADD     1 TO REC-SKL-SUB.
043100     MOVE    FILE-RECORD-INFO-SKELETON
043200          TO FILE-RECORD-INFO (REC-SKL-SUB).
043300 CCVS-INIT-EXIT.
043400     GO TO CCVS1-EXIT.
043500 CLOSE-FILES.
043600P    OPEN I-O RAW-DATA.
043700P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
043800P    READ RAW-DATA INVALID KEY GO TO END-E-2.
043900P    MOVE "OK.     " TO C-ABORT.
044000P    MOVE PASS-COUNTER TO C-OK.
044100P    MOVE ERROR-HOLD   TO C-ALL.
044200P    MOVE ERROR-COUNTER TO C-FAIL.
044300P    MOVE DELETE-COUNTER TO C-DELETED.
044400P    MOVE INSPECT-COUNTER TO C-INSPECT.
044500P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
044600PEND-E-2.
044700P    CLOSE RAW-DATA.
044800     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
044900 TERMINATE-CCVS.
045000S    EXIT PROGRAM.
045100STERMINATE-CALL.
045200     STOP     RUN.
045300 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
045400 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
045500 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
045600 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
045700     MOVE "****TEST DELETED****" TO RE-MARK.
045800 PRINT-DETAIL.
045900     IF REC-CT NOT EQUAL TO ZERO
046000             MOVE "." TO PARDOT-X
046100             MOVE REC-CT TO DOTVALUE.
046200     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
046300     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
046400        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
046500          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
046600     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
046700     MOVE SPACE TO CORRECT-X.
046800     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
046900     MOVE     SPACE TO RE-MARK.
047000 HEAD-ROUTINE.
047100     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
047200     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
047300     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
047400     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
047500 COLUMN-NAMES-ROUTINE.
047600     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
047700     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
047800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
047900 END-ROUTINE.
048000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
048100 END-RTN-EXIT.
048200     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
048300 END-ROUTINE-1.
048400      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
048500      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
048600      ADD PASS-COUNTER TO ERROR-HOLD.
048700*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
048800      MOVE PASS-COUNTER TO CCVS-E-4-1.
048900      MOVE ERROR-HOLD TO CCVS-E-4-2.
049000      MOVE CCVS-E-4 TO CCVS-E-2-2.
049100      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
049200  END-ROUTINE-12.
049300      MOVE "TEST(S) FAILED" TO ENDER-DESC.
049400     IF       ERROR-COUNTER IS EQUAL TO ZERO
049500         MOVE "NO " TO ERROR-TOTAL
049600         ELSE
049700         MOVE ERROR-COUNTER TO ERROR-TOTAL.
049800     MOVE     CCVS-E-2 TO DUMMY-RECORD.
049900     PERFORM WRITE-LINE.
050000 END-ROUTINE-13.
050100     IF DELETE-COUNTER IS EQUAL TO ZERO
050200         MOVE "NO " TO ERROR-TOTAL  ELSE
050300         MOVE DELETE-COUNTER TO ERROR-TOTAL.
050400     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
050500     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
050600      IF   INSPECT-COUNTER EQUAL TO ZERO
050700          MOVE "NO " TO ERROR-TOTAL
050800      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
050900      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
051000      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
051100     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
051200 WRITE-LINE.
051300     ADD 1 TO RECORD-COUNT.
051400Y    IF RECORD-COUNT GREATER 42
051500Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
051600Y        MOVE SPACE TO DUMMY-RECORD
051700Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
051800Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
051900Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
052000Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
052100Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
052200Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
052300Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
052400Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
052500Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
052600Y        MOVE ZERO TO RECORD-COUNT.
052700     PERFORM WRT-LN.
052800 WRT-LN.
052900     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
053000     MOVE SPACE TO DUMMY-RECORD.
053100 BLANK-LINE-PRINT.
053200     PERFORM WRT-LN.
053300 FAIL-ROUTINE.
053400     IF     COMPUTED-X NOT EQUAL TO SPACE
053500            GO TO   FAIL-ROUTINE-WRITE.
053600     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
053700     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
053800     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
053900     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
054000     MOVE   SPACES TO INF-ANSI-REFERENCE.
054100     GO TO  FAIL-ROUTINE-EX.
054200 FAIL-ROUTINE-WRITE.
054300     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
054400     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
054500     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
054600     MOVE   SPACES TO COR-ANSI-REFERENCE.
054700 FAIL-ROUTINE-EX. EXIT.
054800 BAIL-OUT.
054900     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
055000     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
055100 BAIL-OUT-WRITE.
055200     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
055300     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
055400     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
055500     MOVE   SPACES TO INF-ANSI-REFERENCE.
055600 BAIL-OUT-EX. EXIT.
055700 CCVS1-EXIT.
055800     EXIT.
055900 SECT-IX207A-0001 SECTION.
056000 WRITE-INT-GF-01.
056100     OPEN     OUTPUT  IX-FS1.
056200     MOVE     "IX-FS1"  TO XFILE-NAME (1).
056300     MOVE     "R1-F-G"  TO XRECORD-NAME (1).
056400     MOVE     ZERO      TO XRECORD-NUMBER (1).
056500     MOVE     CCVS-PGM-ID TO XPROGRAM-NAME (1).
056600     MOVE     000240    TO XRECORD-LENGTH (1).
056700     MOVE     0001      TO XBLOCK-SIZE (1).
056800     MOVE     "RC"      TO CHARS-OR-RECORDS (1).
056900     MOVE     "IX"      TO XFILE-ORGANIZATION (1).
057000     MOVE     "S"       TO XLABEL-TYPE (1).
057100     MOVE     000300    TO IX-FS1-FILESIZE
057200     MOVE     000300    TO RECORDS-IN-FILE (1).
057300     MOVE     ZERO      TO WRK-DS-05V00-005.
057400     MOVE     ZERO      TO WRK-DS-04V00-001.
057500     MOVE     ZERO      TO WRK-DS-04V00-002.
057600     MOVE     00001 TO  WRK-DU-05V00-001.
057700     MOVE     IX-FS1-FILESIZE     TO WRK-DU-05V00-003.
057800     MOVE     ZERO      TO WRK-DS-05V00-006.
057900     MOVE     00001     TO WRK-DS-05V00-007.
058000     MOVE "TESTED FEATURES:                                      "
058100                        TO PRINT-REC.   PERFORM WRITE-LINE.
058200     MOVE "ORDERING OF CLAUSES IN SELECT STATEMENT IX-8 2.3.3 (1)"
058300                        TO PRINT-REC.   PERFORM WRITE-LINE.
058400     MOVE "ALERNATE RECORD KEY WITH DUPLICATES; IX-11            "
058500                        TO PRINT-REC.   PERFORM WRITE-LINE.
058600     MOVE "USE AFTER STANDARD EXECPTION; IX-39                   "
058700                        TO PRINT-REC.   PERFORM WRITE-LINE.
058800     MOVE "FILE STATUS;                  IX-3                    "
058900                        TO PRINT-REC.   PERFORM WRITE-LINE.
059000     PERFORM  BLANK-LINE-PRINT.
059100*
059200*    WRK-DS-05V00-005  = COUNTS THE NUMBER OF TIMES READ/WRITE
059300*                        WAS EXECUTED.
059400*
059500*    WRK-DS-04V00-001  = THIS COUNTER IS INCREMENTED EACH TIME
059600*                        A WRITE STATEMENT IS ENCOUNTERED
059700*                        THE COUNTER IS DECREMENTED EACH TIME AN
059800*                        INVALID KEY CONDITION OCCURS ON THE WRITE
059900*    WRK-DU-05V00-001  = NUMERIC FIELD ENBEDDED IN  RECORD KEY
060000*                        WHICH MAKES THE KEY UNIQUE.
060100*
060200*    WRK-DU-05V00-003  = NUMERIC FIELD ENBEDDED IN  ALTERNATE KEY
060300*                        WHICH MAKES THE KEY UNIQUE.
060400*
060500*    WRK-DS-05V00-006  = COUNTER IS INCREMENTED EACH TIME A RECORD
060600*                        RETRIEVED IS NOT THE ONE EXPECTED.
060700*
060800*    WRK-DS-05V00-007  = THIS COUNTER IS USED TO CREATE A
060900*                        DUPLICATE  ALTERNATE KEY - I.E., EVERY
061000*                        50TH RECORD.
061100*
061200*    WRK-DS-05V00-008  = COUNTER CONTAINING THE RECORD NUMBER
061300*                        WHICH IS EXPECTED TO BE FOUND.
061400*
061500*    NOTE  -  RECORDS OF THE FILE ARE CREATED SEQUENTIALLY
061600*             BY RECORD KEY VALUE .  THE ALTERNATE RECORD KEY
061700*             VALUES ARE CREATED INVERSE TO TO THE RECORD
061800*             CREATION SEQUENCE OF THE FILE.
061900*
062000*    FOLLOWING IS AN EXAMPLE OF THE SEQUENTIAL ORDER OF THE
062100*    RECORDS AS CREATED.
062200*
062300*               RECORD    RECORD    ALTERNATE
062400*              NUMBER      KEY        KEY
062500*
062600*                001        001        300
062700*                002        002        299
062800*                003        003        298
062900*                  .          .          .
063000*                  .          .          .
063100*                  .          .          .
063200*                 50        050        251
063300*                 51        051        251
063400*                 52        052        249
063500*
063600*
063700 WRITE-TEST-GF-01-R1.
063800     ADD      000001    TO XRECORD-NUMBER (1).
063900     MOVE     WRK-FS1-RECKEY  TO XRECORD-KEY (1).
064000     MOVE     WRK-FS1-ALTKEY  TO ALTERNATE-KEY1 (1).
064100     WRITE   IX-FS1R1-F-G-240 FROM FILE-RECORD-INFO (1)
064200              INVALID KEY
064300               SUBTRACT   0001  FROM WRK-DS-04V00-001.
064400     ADD      0001  TO WRK-DS-04V00-001.
064500     ADD      0001   TO WRK-DS-05V00-005.
064600     ADD      00001  TO WRK-DS-05V00-007.
064700     IF       WRK-DS-05V00-007 GREATER THAN  50
064800              MOVE  0001 TO WRK-DS-05V00-007
064900              ELSE
065000              SUBTRACT   WRK-DU-05V00-001 FROM IX-FS1-FILESIZE
065100                  GIVING WRK-DU-05V00-003.
065200*
065300*    EVERY    50TH AND 51ST ALTERNATE KEY VALUE WILL BE EQUAL.
065400*
065500     ADD      00001  TO WRK-DU-05V00-001.
065600     IF       WRK-DS-05V00-005     LESS THAN IX-FS1-FILESIZE
065700              GO TO     WRITE-TEST-GF-01-R1.
065800     CLOSE    IX-FS1.
065900 WRITE-TEST-GF-01.
066000     MOVE     "WRITE"   TO FEATURE.
066100     MOVE     "WRITE-TEST-GF-01" TO PAR-NAME.
066200     IF       WRK-DS-04V00-001 NOT EQUAL TO IX-FS1-FILESIZE
066300              PERFORM  FAIL
066400              MOVE      WRK-DS-04V00-001 TO COMPUTED-N
066500              MOVE      IX-FS1-FILESIZE  TO  CORRECT-N
066600        ELSE
066700              PERFORM  PASS.
066800     PERFORM   PRINT-DETAIL.
066900*
067000*
067100 READ-INIT-F1-01.
067200     MOVE     001   TO  WRK-DS-05V00-008.
067300     MOVE     ZERO   TO  WRK-DS-05V00-006.
067400     MOVE     ZERO  TO  WRK-DS-05V00-005.
067500     OPEN     INPUT  IX-FS1.
067600 READ-TEST-F1-01-R2.
067700     READ     IX-FS1  RECORD  AT END
067800              GO TO READ-TEST-F1-01.
067900     MOVE     IX-FS1R1-F-G-240  TO FILE-RECORD-INFO (1).
068000     ADD      0001      TO WRK-DS-05V00-005.
068100     IF       WRK-DS-05V00-008  NOT EQUAL TO XRECORD-NUMBER (1)
068200              ADD       00001  TO WRK-DS-05V00-006.
068300     ADD       00001  TO WRK-DS-05V00-008.
068400     IF       WRK-DS-05V00-005  LESS   THAN  IX-FS1-FILESIZE
068500              GO TO     READ-TEST-F1-01-R2.
068600 READ-TEST-F1-01.
068700     MOVE "READ RECORD KEY     " TO FEATURE.
068800     MOVE "READ-TEST-F1-01     " TO PAR-NAME.
068900     CLOSE    IX-FS1.
069000     SUBTRACT  IX-FS1-FILESIZE  FROM WRK-DS-05V00-005.
069100     ADD      WRK-DS-05V00-005  TO WRK-DS-05V00-006.
069200     IF       WRK-DS-05V00-006  NOT EQUAL TO ZERO
069300              PERFORM   FAIL
069400              MOVE      ZERO TO CORRECT-N
069500              MOVE      WRK-DS-05V00-006  TO COMPUTED-N
069600        ELSE
069700              PERFORM  PASS.
069800     PERFORM   PRINT-DETAIL.
069900*
070000*
070100 READ-INT-F1-02.
070200     MOVE    00020 TO   WRK-DS-05V00-006.
070300     MOVE    00241 TO   WRK-DS-05V00-008.
070400     MOVE     ZERO TO   WRK-DS-05V00-005.
070500     MOVE    00060 TO   WRK-DU-05V00-003.
070600     OPEN     INPUT  IX-FS1.
070700     MOVE     WRK-FS1-ALTKEY  TO  IX-FS1-ALTKEY1.
070800     START    IX-FS1  KEY IS EQUAL TO
070900                  IX-FS1-ALTKEY1
071000            INVALID KEY
071100              ADD        1000  TO WRK-DS-05V00-006.
071200 READ-TEST-F1-02-R3.
071300     READ     IX-FS1  RECORD  AT END
071400              ADD  10000  TO WRK-DS-05V00-006
071500              GO TO     READ-TEST-F1-02.
071600     MOVE     IX-FS1R1-F-G-240  TO FILE-RECORD-INFO (1).
071700     ADD      00001     TO  WRK-DS-05V00-005.
071800     IF       WRK-DS-05V00-008  EQUAL TO XRECORD-NUMBER (1)
071900              SUBTRACT  00001  FROM  WRK-DS-05V00-006.
072000     IF       WRK-DS-05V00-005  LESS   THAN 20
072100              SUBTRACT   00001  FROM WRK-DS-05V00-008
072200              GO  TO    READ-TEST-F1-02-R3.
072300 READ-TEST-F1-02.
072400     MOVE "READ ALTERNATE KEY  " TO FEATURE.
072500     MOVE "READ-TEST-F1-02     " TO PAR-NAME.
072600     CLOSE    IX-FS1.
072700     MOVE     "READ ALTERNATE KEY" TO FEATURE.
072800     IF      WRK-DS-05V00-006  NOT EQUAL TO ZERO
072900              PERFORM   FAIL
073000             MOVE    WRK-DS-05V00-006 TO COMPUTED-N
073100              MOVE      ZERO TO  CORRECT-N
073200              MOVE      "SEE  PROGRAM"  TO  RE-MARK
073300              ELSE
073400              PERFORM  PASS.
073500*
073600*    COMPUTED  RESULTS  IN INCREMENTS OF 1000 INDICATES THAT
073700*             AN INVALID KEY CONDITION  OCCURRED  ON  THE  START
073800*             STATEMENT  -  SEE  PARAGRAPH  INX-INIT-001-3.
073900*
074000*    COMPUTED RESULTS IN INCREMENTS OF 10000 INDICATE THAT THE
074100*             AT END PATH ON THE READ WAS TAKEN.
074200*
074300*    COMPUTED RESULTS IN INCREMENTS OF 00001 INDICATE THAT THE
074400*             RECORD MADE AVAILABLE AS A RESULT OF THE READ
074500*             WAS NOT THE ONE EXPECTED.
074600*
074700     PERFORM  PRINT-DETAIL.
074800*
074900*    03
075000*
075100 READ-INIT-F1-03.
075200     MOVE     00060  TO WRK-DS-05V00-006.
075300     MOVE     00001  TO WRK-DU-05V00-003.
075400     MOVE     00300  TO WRK-DS-05V00-008.
075500     MOVE     ZERO   TO WRK-DS-05V00-005.
075600     OPEN     INPUT    IX-FS1.
075700     MOVE     WRK-FS1-ALTKEY TO  IX-FS1-ALTKEY1.
075800     START    IX-FS1  KEY IS EQUAL TO
075900                    IX-FS1-ALTKEY1
076000            INVALID KEY
076100              ADD       01000  TO WRK-DS-05V00-006.
076200 READ-TEST-F1-03-R4.
076300     READ     IX-FS1    RECORD  AT  END
076400              ADD   10000  TO WRK-DS-05V00-006
076500              GO TO     READ-TEST-F1-03.
076600     MOVE     IX-FS1R1-F-G-240  TO FILE-RECORD-INFO (1).
076700     IF       WRK-DS-05V00-008  EQUAL TO XRECORD-NUMBER (1)
076800         SUBTRACT  00001  FROM WRK-DS-05V00-006.
076900     ADD       00001  TO WRK-DS-05V00-005.
077000     IF      WRK-DS-05V00-005  EQUAL TO 50 AND
077100             XRECORD-NUMBER (1) EQUAL TO 250
077200             SUBTRACT  00001  FROM WRK-DS-05V00-006.
077300     IF      WRK-DS-05V00-005  EQUAL TO 51   AND
077400             XRECORD-NUMBER (1) EQUAL TO 251
077500             SUBTRACT  00001  FROM WRK-DS-05V00-006.
077600     SUBTRACT     00001  FROM WRK-DS-05V00-008.
077700     IF       WRK-DS-05V00-005 LESS THAN  60
077800              GO TO READ-TEST-F1-03-R4.
077900 READ-TEST-F1-03.
078000     MOVE "READ DUPLICATE KEY  " TO FEATURE.
078100     MOVE "READ-TEST-F1-03     " TO PAR-NAME.
078200     CLOSE    IX-FS1.
078300     IF       WRK-DS-05V00-006  NOT EQUAL TO  ZERO
078400              PERFORM   FAIL
078500              MOVE      WRK-DS-05V00-006  TO COMPUTED-N
078600              MOVE      ZERO  TO  CORRECT-N
078700             MOVE     "SEE  PROGRAM"  TO RE-MARK
078800              ELSE
078900              PERFORM   PASS.
079000*
079100*    WITH THE GIVEN SYNTACTICAL COBOL ENTRIES IN THE FILE-CONTROL
079200*    PARAGRAPH THIS TEST VERIFIES THAT     RECORDS WITH DUPLICATE
079300*    KEYS CAN BE ACCESSED WHEN THE FILE IS READ
079400*    SEQUENTIALLY.  THE START STATEMENT ESTABLISHES THE ALTERNATE
079500*    KEY AS THE KEY OF REFERENCE AND POSITIONS THE CURRENT
079600*    RECORD POINTER TO THE LAST RECORD IN THE FILE (ALTERNATE
079700*    KEY VALUE OF 1).  SIXTY RECORDS ARE READ SEQUENTIALLY USING
079800*    THE ALTERNATE KEY - THE FILE IS BEING READ INVERSE TO ITS
079900*    CREATION.  ON THE 50 TH AND 51 ST READ (RECORD NUMBERS 250
080000*    AND 251) THESE RECORDS SHOULD CONTAIN ALTERNATE KEYS
080100*    WHICH ARE THE SAME.  RECORDS WITH LIKE KEYS SHOULD BE MADE
080200*    AVAILABLE IN THE SEQUENCE IN WHICH THEY ARE CREATED,
080300*    THEREFORE RECORD NUMBER 250 SHOULD BE READ BEFORE RECORD
080400*    NUMBER 251.
080500*
080600*    COMPUTE  RESULTS  IN INCREMENTS OF  1000 INDICATES THAT
080700*             AN INVALID  KEY CONDITION OCCURRED ON THE  START
080800*             STATEMENT  -  SEE  PARAGRAPH  READ-INIT-001-4.
080900*
081000*    COMPUTED RESULTS IN INCREMENTS OF 10000 INDICATE THAT THE
081100*             AT END PATH ON THE READ WAS TAKEN.
081200*
081300*    COMPUTED RESULTS IN INCREMENTS OF 00001 INDICATE THAT THE
081400*             RECORD MADE AVAILABLE AS A RESULT OF THE READ
081500*             WAS NOT THE ONE EXPECTED.
081600*
081700*
081800     PERFORM  PRINT-DETAIL.
081900*
082000*
082100 READ-INIT-F1-04.
082200     MOVE     20300 TO  WRK-DS-05V00-006.
082300     MOVE     ZERO   TO WRK-DS-05V00-005.
082400     MOVE     00001  TO WRK-DU-05V00-003.
082500     MOVE     ZERO   TO WRK-DS-04V00-001.
082600     MOVE     ZERO   TO WRK-DS-04V00-002
082700     OPEN     INPUT     IX-FS1.
082800     MOVE     WRK-FS1-ALTKEY  TO  IX-FS1-ALTKEY1.
082900     START    IX-FS1    KEY IS EQUAL TO
083000                IX-FS1-ALTKEY1
083100              INVALID  KEY
083200              ADD  01000  TO  WRK-DS-05V00-006.
083300     MOVE      IX-FS1-FILESIZE  TO  WRK-DS-05V00-008.
083400     MOVE     "44"   TO  FS1-STATUS.
083500*
083600*    WRK-DS-04V00-001  = A COUNTER WHICH IS INCREMENTED BY 1 EACH
083700*                        TIME A FILE STATUS VALUE "00" (SUCCESS-
083800*                        FUL READ) WAS ENCOUNTERED DURING THE READ
083900*                        OF THE FILE.
084000*
084100*    WRK-DS-04V00-002  = A COUNTER WHICH IS INCREMENTED BY 1
084200*                        EACH TIME A FILE STATUS OF "02" (DUP-
084300*                        LICATE KEY) IS ENCOUNTERED DURING A READ.
084400*
084500 READ-TEST-F1-04-R5.
084600     READ     IX-FS1    RECORD  AT  END
084700              SUBTRACT  20000  FROM WRK-DS-05V00-006
084800              GO TO     READ-TEST-F1-04.
084900     MOVE     IX-FS1R1-F-G-240  TO  FILE-RECORD-INFO (1).
085000     ADD      00001   TO WRK-DS-05V00-005.
085100     IF      FS1-STATUS  EQUAL TO "00"
085200             ADD  0001  TO WRK-DS-04V00-001.
085300     IF      FS1-STATUS  EQUAL TO "02"
085400             ADD  1  TO WRK-DS-04V00-002.
085500     IF      WRK-DS-05V00-005  GREATER THAN WRK-DS-05V00-008
085600              ADD   00001  TO  WRK-DS-05V00-006
085700              ELSE
085800              GO  TO    READ-TEST-F1-04-R5.
085900 READ-TEST-F1-04.
086000     MOVE "READ-TEST-F1-04     " TO PAR-NAME.
086100     MOVE     "FILE STATUS"  TO FEATURE.
086200     IF       FS1-STATUS   NOT EQUAL TO  "10"
086300              ADD   10000 TO WRK-DS-05V00-006.
086400     SUBTRACT  WRK-DS-04V00-001 FROM WRK-DS-05V00-006.
086500     SUBTRACT  WRK-DS-04V00-002 FROM WRK-DS-05V00-006.
086600     IF       WRK-DS-05V00-006  NOT EQUAL TO ZERO
086700              PERFORM   FAIL
086800              MOVE      WRK-DS-05V00-006 TO COMPUTED-N
086900              MOVE      ZERO TO  CORRECT-N
087000             MOVE     "SEE PROGRAM"  TO RE-MARK
087100              ELSE
087200              PERFORM   PASS.
087300*
087400*             COMPUTED RESULT             INDICATED
087500*               INCREMENTS                  ACTION
087600*
087700*                10000     FILE STATUS  NOT UPDATED ON EOF
087800*                20000     AT END PATH OF READ NOT TAKEN
087900*                01000     INVALID KEY ON START STATEMENT.
088000*                00001     FILE STATUS DID NOT REFLECT
088100*                          APPROPRIATE STATUS CONTENTS OF A
088200*                               SUCCESSFUL READ
088300*
088400     PERFORM  PRINT-DETAIL.
088500     CLOSE    IX-FS1.
088600*
088700*
088800 SECTION-IX207A-0002 SECTION.
088900 WRITE-INIT-GF-02.
089000     OPEN     OUTPUT    IX-FS2.
089100     MOVE     "IX-FS2"  TO XFILE-NAME (2).
089200     MOVE     "R1-F-G"  TO XRECORD-NAME (2).
089300     MOVE     ZERO      TO XRECORD-NUMBER (2).
089400     MOVE     CCVS-PGM-ID  TO XPROGRAM-NAME  (2).
089500     MOVE     000240    TO XRECORD-LENGTH (2).
089600     MOVE     0001      TO XBLOCK-SIZE  (2).
089700     MOVE     "RC"      TO CHARS-OR-RECORDS (2).
089800     MOVE     "IX"      TO XFILE-ORGANIZATION (2).
089900     MOVE     "S"       TO XLABEL-TYPE (2).
090000     MOVE     000300    TO RECORDS-IN-FILE (2).
090100     MOVE     000300    TO IX-FS2-FILESIZE.
090200     MOVE     ZERO      TO WRK-DS-05V00-005.
090300     MOVE    ZERO      TO WRK-DS-04V00-001.
090400     MOVE     ZERO      TO WRK-DS-04V00-002.
090500     MOVE     00001 TO WRK-DU-05V00-002.
090600     MOVE     IX-FS2-FILESIZE     TO WRK-DU-05V00-004.
090700     MOVE     ZERO      TO WRK-DS-05V00-006.
090800     MOVE     00001     TO WRK-DS-05V00-007.
090900*
091000*    WRK-DU-05V00-002  = NUMERIC FIELD EMBEDDED IN RECORD KEY
091100*                        WHICH MAKES THE KEY UNIQUE.
091200*
091300*    WRK-DU-05V00-004  = NUMERIC FIELD EMBEDDED IN ALTERNATE KEY
091400*                        WHICH MAKES THE KEY UNIQUE.
091500*
091600*    WRK-DS-05V00-005  = COUNTS THE NUMBER OF TIMES A  READ/WRITE
091700*                        WAS EXECUTED.
091800*
091900*    WRK-DS-05V00-006  = ERROR COUNTER WHICH IS INCREMENTED EACH
092000*                        TIME  AN UNEXPECTED CONDITION OCCURS.
092100*
092200*
092300*    WRK-DS-05V00-007  = THIS COUNTERIS USED TO CREATE A DUPLICATE
092400*                        ALTERNATE KEY - I.E., EVERY 50TH RECORD.
092500*
092600*    WRK-DS-05V00-008  = COUNTER CONTAINING THE RECORD NUMBER
092700*                        WHICH IS EXPECTED TO BE FOUND.
092800*
092900*    WRK-DS-04V00-001  = THIS COUNTER IS INCREMENTED EACH TIME
093000*                        AN INVALID KEY CONDITION OCCURS ON THE
093100*                        WRITE.
093200*
093300     PERFORM  BLANK-LINE-PRINT.
093400     MOVE     "SELECT ENTRY  -  ACCESS MODE NOT PRESENT - ACCESS
093500-    "MODE SEQUENTIAL IS ASSUMED" TO PRINT-REC.
093600     PERFORM  WRITE-LINE.
093700     PERFORM  BLANK-LINE-PRINT.
093800 WRITE-TEST-GF-02-R1.
093900     ADD      000001    TO XRECORD-NUMBER (2).
094000     MOVE     WRK-FS2-RECKEY TO XRECORD-KEY (2).
094100     MOVE     WRK-FS2-ALTKEY TO ALTERNATE-KEY1 (2).
094200     WRITE   IX-FS2R1-F-G-240  FROM FILE-RECORD-INFO (2)
094300              INVALID KEY
094400              ADD   0001  TO  WRK-DS-04V00-001.
094500     ADD      00001     TO  WRK-DS-05V00-005.
094600*    INCREMENT RECORD KEY VALUE.
094700     ADD      00001     TO WRK-DS-05V00-007.
094800     IF       WRK-DS-05V00-007  GREATER THAN 50
094900              MOVE  00001 TO WRK-DS-05V00-007
095000              ELSE
095100              SUBTRACT  WRK-DU-05V00-002  FROM IX-FS2-FILESIZE
095200                   GIVING  WRK-DU-05V00-004.
095300*
095400*    EVERY  50TH AND 51ST ALTERNATE KEY VALUE WILL BE  EQUAL.
095500*
095600     ADD      00001  TO  WRK-DU-05V00-002.
095700     IF       WRK-DS-05V00-005  LESS THAN IX-FS2-FILESIZE
095800              GO TO     WRITE-TEST-GF-02-R1.
095900 WRITE-TEST-GF-02.
096000     MOVE "WRITE IX-FS2        " TO FEATURE.
096100     MOVE "WRITE-TEST-GF-02    " TO PAR-NAME.
096200     CLOSE    IX-FS2.
096300     ADD      WRK-DS-04V00-001 WRK-DS-05V00-005
096400                        GIVING    WRK-DS-05V00-006.
096500     IF       WRK-DS-05V00-006 NOT EQUAL TO 00300
096600              PERFORM   FAIL
096700              MOVE      WRK-DS-05V00-006 TO  COMPUTED-N
096800              MOVE      300  TO CORRECT-N
096900        ELSE
097000              PERFORM  PASS.
097100     PERFORM   PRINT-DETAIL.
097200*
097300*
097400 READ-INIT-F1-04.
097500     MOVE     ZERO TO   WRK-DS-04V00-001.
097600     MOVE     ZERO TO   WRK-DS-04V00-002.
097700     MOVE     ZERO TO   WRK-DS-05V00-005.
097800     MOVE    00120 TO  WRK-DS-05V00-006.
097900     MOVE     ZERO  TO  WRK-DS-05V00-007.
098000     MOVE     300  TO  WRK-DS-05V00-008.
098100     MOVE    0001  TO WRK-DU-05V00-004.
098200     OPEN     INPUT IX-FS2.
098300     MOVE    WRK-FS2-ALTKEY TO IX-FS2-ALTKEY1.
098400     START    IX-FS2  KEY IS EQUAL TO
098500                IX-FS2-ALTKEY1
098600           INVALID KEY
098700              ADD       01000 TO  WRK-DS-05V00-006.
098800 READ-TEST-F1-04-R2.
098900     READ     IX-FS2 RECORD AT END
099000              ADD  10000 TO  WRK-DS-05V00-006
099100              GO TO READ-TEST-F1-04-R3.
099200     MOVE     IX-FS2R1-F-G-240 TO FILE-RECORD-INFO (2).
099300     ADD      00001  TO WRK-DS-05V00-005.
099400     IF      WRK-DS-05V00-005  EQUAL TO 50 AND
099500             XRECORD-NUMBER (2) EQUAL TO 250
099600             SUBTRACT  00001  FROM WRK-DS-05V00-006.
099700     IF      WRK-DS-05V00-005  EQUAL TO 51     AND
099800             XRECORD-NUMBER (2) EQUAL TO 251
099900             SUBTRACT  00001  FROM WRK-DS-05V00-006.
100000     IF      WRK-DS-05V00-005  EQUAL TO 100  AND
100100              XRECORD-NUMBER (2)  EQUAL TO 200
100200              SUBTRACT  00001  FROM WRK-DS-05V00-006.
100300     IF      WRK-DS-05V00-005  EQUAL TO 101  AND
100400              XRECORD-NUMBER (2) EQUAL TO 201
100500              SUBTRACT  00001  FROM WRK-DS-05V00-006.
100600*
100700*    THE PRECEEDING 4 IF STATEMENTS CHECK THOSE RECORDS WHICH HAVE
100800*    LIKE ALTERNATE RECORD KEYS (DUPLICATE KEYS).  THE FILE WAS
100900*    CREATED SEQUENTIALLY BY RECORD KEY VALUE HOWEVER THE
101000*    ALTERNATE RECORD KEY SEQUENCE IS INVERSE TO THE FILE
101100*    CREATION SEQUENCE WITH DUPLICATE ALTERNATE KEYS ESTABLISHED
101200*    IN RECORD KEY SEQUENCE.  THE TEST EXPECTS THE RECORDS WHICH
101300*    HAVE LIKE KEYS TO BE PROVIDED IN THE ORDER IN WHICH THEY WERE
101400*    WRITTEN WHEN THE FILE IS SEQUENTIALLY READ BY THE ALTERNATE
101500*    RECORD KEY .
101600*
101700     IF       WRK-DS-05V00-008  EQUAL TO XRECORD-NUMBER (2)
101800          SUBTRACT  00001  FROM WRK-DS-05V00-006.
101900     SUBTRACT   00001  FROM  WRK-DS-05V00-008.
102000     IF       WRK-DS-05V00-005  LESS THAN 120
102100              GO TO  READ-TEST-F1-04-R2.
102200 READ-TEST-F1-04-R3.
102300     MOVE "READ ALTERNATE KEY  " TO FEATURE.
102400     MOVE "READ-TEST-F1-04-R3. " TO PAR-NAME.
102500     CLOSE    IX-FS2.
102600     IF       WRK-DS-05V00-006    NOT EQUAL TO  ZERO
102700              PERFORM   FAIL
102800              MOVE      WRK-DS-05V00-006 TO COMPUTED-N
102900              MOVE      ZERO TO   CORRECT-N
103000              MOVE      "SEE PROGRAM" TO RE-MARK
103100              ELSE
103200              PERFORM   PASS.
103300*
103400*  COMPUTED RESULTS IN INCREMENTS OF 1000 INDICATES AN INVALID KEY
103500*             CONDITION OCCURRED ON THE START STATEMENT  - SEE
103600*             PARAGRAPH READ-INIT-F1-04-2; INCREMENTS OF 10000
103700*             INDICATES THAT AN UNEXPECTED AT END PATH ON THE
103800*             READ WAS TAKEN; INCREMENTS OF 00001 INDICATES THAT
103900*             THE RECORD RETRIEVED WAS NOT THE ONE EXPECTED.
104000*
104100     PERFORM  PRINT-DETAIL.
104200*
104300*
104400 READ-INIT-F1-05.
104500     MOVE     00301   TO WRK-DS-05V00-006.
104600     MOVE     ZERO  TO WRK-DS-05V00-005.
104700     MOVE     ZERO   TO WRK-DS-05V00-007.
104800     MOVE     ZERO   TO WRK-DS-05V00-008.
104900     MOVE     ZERO   TO WRK-DS-04V00-001.
105000     MOVE     ZERO   TO WRK-DS-04V00-002.
105100     OPEN     INPUT IX-FS1.
105200     OPEN     INPUT IX-FS2.
105300 READ-TEST-F1-05-R3.
105400     READ     IX-FS1.
105500     READ     IX-FS2.
105600     ADD      0001 TO   WRK-DS-05V00-005.
105700     IF       WRK-DS-05V00-005 LESS THAN  301
105800             GO TO   READ-TEST-F1-05-R3.
105900 READ-TEST-F1-05.
106000     MOVE "USE                 " TO FEATURE.
106100     MOVE "READ-TEST-F1-05     " TO PAR-NAME.
106200     CLOSE   IX-FS1.
106300     SUBTRACT  WRK-DS-05V00-005 FROM  WRK-DS-05V00-006.
106400     IF      WRK-DS-05V00-006  NOT EQUAL TO 00002
106500              PERFORM   FAIL
106600              MOVE      WRK-DS-05V00-006 TO COMPUTED-N
106700              MOVE      00002 TO CORRECT-N
106800              ELSE
106900              PERFORM   PASS.
107000*
107100*    USE  PROCEDURE SHOULD BE EXECUTED ONCE FOR EACH FILE.
107200*
107300     PERFORM  PRINT-DETAIL.
107400*
107500*
107600     CLOSE    IX-FS2.
107700
107800
107900 CCVS-EXIT SECTION.
108000 CCVS-999999.
108100     GO TO CLOSE-FILES.
