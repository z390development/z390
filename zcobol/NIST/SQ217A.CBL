000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ217A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200*        THIS ROUTINE TESTS THE CLAUSE:
001300*             PADDING CHARACTER IS  DATA-NAME-1   (VALUE "Z").
001400*
001500*        THE ROUTINE SQ217A CREATES A TAPE FILE WHICH HAS 750 FIXE
001600*    LENGTH RECORDS.  THE FILE IS THEN CLOSED AND OPENED AS AN
001700*    INPUT FILE.  THE FILE IS READ AND FIELDS IN THE INPUT RECORDS
001800*    ARE COMPARED TO THE VALUES WRITTEN TO ENSURE THAT THE RECORDS
001900*    WERE PROCESSED CORRECTLY.  THE FILE IS CLOSED AND OPENED
002000*    AGAIN AS AN INPUT FILE.  FOUR READ FORMAT OPTIONS ARE USED
002100*    TO READ THE FILE AND FIELDS IN THE RECORDS ARE VERIFIED.
002200*    THE OPEN, CLOSE, READ, AND WRITE STATEMENTS ARE TESTED FOR
002300*    LEVEL TWO            PADDING CHARCTER IS "Z".
002400*
002500*    THE LAST 9 RECORDS MUST BE FILLED WITH THE PADDING CHARACTER
002600*        PADDING-CHARACTER PIC X VALUE "Z".
002700*
002800 ENVIRONMENT DIVISION.
002900 CONFIGURATION SECTION.
003000 SOURCE-COMPUTER.
003100     XXXXX082.
003200 OBJECT-COMPUTER.
003300     XXXXX083.
003400 INPUT-OUTPUT SECTION.
003500 FILE-CONTROL.
003600P    SELECT RAW-DATA   ASSIGN TO
003700P    XXXXX062
003800P           ORGANIZATION IS INDEXED
003900P           ACCESS MODE IS RANDOM
004000P           RECORD KEY IS RAW-DATA-KEY.
004100     SELECT PRINT-FILE ASSIGN TO
004200     XXXXX055.
004300     SELECT SQ-FS1 ASSIGN TO
004400     XXXXX001
004500     ORGANIZATION IS SEQUENTIAL
004600     PADDING        PADDING-CHARACTER
004700     ACCESS MODE IS SEQUENTIAL.
004800 DATA DIVISION.
004900 FILE SECTION.
005000P
005100PFD  RAW-DATA.
005200P
005300P01  RAW-DATA-SATZ.
005400P    05  RAW-DATA-KEY        PIC X(6).
005500P    05  C-DATE              PIC 9(6).
005600P    05  C-TIME              PIC 9(8).
005700P    05  C-NO-OF-TESTS       PIC 99.
005800P    05  C-OK                PIC 999.
005900P    05  C-ALL               PIC 999.
006000P    05  C-FAIL              PIC 999.
006100P    05  C-DELETED           PIC 999.
006200P    05  C-INSPECT           PIC 999.
006300P    05  C-NOTE              PIC X(13).
006400P    05  C-INDENT            PIC X.
006500P    05  C-ABORT             PIC X(8).
006600 FD  PRINT-FILE
006700C    LABEL RECORDS
006800C    XXXXX084
006900C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007000               .
007100 01  PRINT-REC PICTURE X(120).
007200 01  DUMMY-RECORD PICTURE X(120).
007300 FD  SQ-FS1
007400C    LABEL RECORD STANDARD
007500     RECORD CONTAINS 120 CHARACTERS
007600     BLOCK CONTAINS 13 RECORDS.
007700 01  SQ-FS1R1-F-G-120.
007800     02  FILLER PIC X(120).
007900 WORKING-STORAGE SECTION.
008000 01  PADDING-CHARACTER  PIC X  VALUE "Z".
008100 01  WRK-CS-09V00 PIC S9(9) USAGE COMP VALUE ZERO.
008200 01  RECORDS-IN-ERROR PIC S9(5) USAGE COMP VALUE ZERO.
008300 01  ERROR-FLAG PIC 9 VALUE ZERO.
008400 01  EOF-FLAG   PICTURE 9 VALUE ZERO.
008500 01  FILE-RECORD-INFORMATION-REC.
008600     03 FILE-RECORD-INFO-SKELETON.
008700        05 FILLER                 PICTURE X(48)       VALUE
008800             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
008900        05 FILLER                 PICTURE X(46)       VALUE
009000             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
009100        05 FILLER                 PICTURE X(26)       VALUE
009200             ",LFIL=000000,ORG=  ,LBLR= ".
009300        05 FILLER                 PICTURE X(37)       VALUE
009400             ",RECKEY=                             ".
009500        05 FILLER                 PICTURE X(38)       VALUE
009600             ",ALTKEY1=                             ".
009700        05 FILLER                 PICTURE X(38)       VALUE
009800             ",ALTKEY2=                             ".
009900        05 FILLER                 PICTURE X(7)        VALUE SPACE.
010000     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
010100        05 FILE-RECORD-INFO-P1-120.
010200           07 FILLER              PIC X(5).
010300           07 XFILE-NAME           PIC X(6).
010400           07 FILLER              PIC X(8).
010500           07 XRECORD-NAME         PIC X(6).
010600           07 FILLER              PIC X(1).
010700           07 REELUNIT-NUMBER     PIC 9(1).
010800           07 FILLER              PIC X(7).
010900           07 XRECORD-NUMBER       PIC 9(6).
011000           07 FILLER              PIC X(6).
011100           07 UPDATE-NUMBER       PIC 9(2).
011200           07 FILLER              PIC X(5).
011300           07 ODO-NUMBER          PIC 9(4).
011400           07 FILLER              PIC X(5).
011500           07 XPROGRAM-NAME        PIC X(5).
011600           07 FILLER              PIC X(7).
011700           07 XRECORD-LENGTH       PIC 9(6).
011800           07 FILLER              PIC X(7).
011900           07 CHARS-OR-RECORDS    PIC X(2).
012000           07 FILLER              PIC X(1).
012100           07 XBLOCK-SIZE          PIC 9(4).
012200           07 FILLER              PIC X(6).
012300           07 RECORDS-IN-FILE     PIC 9(6).
012400           07 FILLER              PIC X(5).
012500           07 XFILE-ORGANIZATION   PIC X(2).
012600           07 FILLER              PIC X(6).
012700           07 XLABEL-TYPE          PIC X(1).
012800        05 FILE-RECORD-INFO-P121-240.
012900           07 FILLER              PIC X(8).
013000           07 XRECORD-KEY          PIC X(29).
013100           07 FILLER              PIC X(9).
013200           07 ALTERNATE-KEY1      PIC X(29).
013300           07 FILLER              PIC X(9).
013400           07 ALTERNATE-KEY2      PIC X(29).
013500           07 FILLER              PIC X(7).
013600 01  TEST-RESULTS.
013700     02 FILLER                    PICTURE X VALUE SPACE.
013800     02 FEATURE                   PICTURE X(20) VALUE SPACE.
013900     02 FILLER                    PICTURE X VALUE SPACE.
014000     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
014100     02 FILLER                    PICTURE X  VALUE SPACE.
014200     02  PAR-NAME.
014300       03 FILLER PICTURE X(12) VALUE SPACE.
014400       03  PARDOT-X PICTURE X  VALUE SPACE.
014500       03 DOTVALUE PICTURE 99  VALUE ZERO.
014600       03 FILLER PIC X(5) VALUE SPACE.
014700     02 FILLER PIC X(10) VALUE SPACE.
014800     02 RE-MARK PIC X(61).
014900 01  TEST-COMPUTED.
015000     02 FILLER PIC X(30) VALUE SPACE.
015100     02 FILLER PIC X(17) VALUE "       COMPUTED=".
015200     02 COMPUTED-X.
015300     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
015400     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
015500     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
015600     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
015700     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
015800     03       CM-18V0 REDEFINES COMPUTED-A.
015900         04 COMPUTED-18V0                   PICTURE -9(18).
016000         04 FILLER                          PICTURE X.
016100     03 FILLER PIC X(50) VALUE SPACE.
016200 01  TEST-CORRECT.
016300     02 FILLER PIC X(30) VALUE SPACE.
016400     02 FILLER PIC X(17) VALUE "       CORRECT =".
016500     02 CORRECT-X.
016600     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
016700     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
016800     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
016900     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
017000     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
017100     03      CR-18V0 REDEFINES CORRECT-A.
017200         04 CORRECT-18V0                    PICTURE -9(18).
017300         04 FILLER                          PICTURE X.
017400     03 FILLER PIC X(50) VALUE SPACE.
017500 01  CCVS-C-1.
017600     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
017700-    "SS  PARAGRAPH-NAME
017800-    "        REMARKS".
017900     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
018000 01  CCVS-C-2.
018100     02 FILLER PICTURE IS X VALUE IS SPACE.
018200     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
018300     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
018400     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
018500     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
018600 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
018700 01  REC-CT PICTURE 99 VALUE ZERO.
018800 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
018900 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
019000 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
019100 01  PASS-COUNTER PIC 999 VALUE ZERO.
019200 01  TOTAL-ERROR PIC 999 VALUE ZERO.
019300 01  ERROR-HOLD PIC 999 VALUE ZERO.
019400 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
019500 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
019600 01  CCVS-H-1.
019700     02  FILLER   PICTURE X(27)  VALUE SPACE.
019800     02 FILLER PICTURE X(67) VALUE
019900     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
020000-    " SYSTEM".
020100     02  FILLER     PICTURE X(26)  VALUE SPACE.
020200 01  CCVS-H-2.
020300     02 FILLER PICTURE X(52) VALUE IS
020400     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
020500     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
020600     02 TEST-ID PICTURE IS X(9).
020700     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
020800 01  CCVS-H-3.
020900     02  FILLER PICTURE X(34) VALUE
021000     " FOR OFFICIAL USE ONLY    ".
021100     02  FILLER PICTURE X(58) VALUE
021200     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
021300     02  FILLER PICTURE X(28) VALUE
021400     "  COPYRIGHT   1985 ".
021500 01  CCVS-E-1.
021600     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
021700     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
021800     02 ID-AGAIN PICTURE IS X(9).
021900     02 FILLER PICTURE X(45) VALUE IS
022000     " NTIS DISTRIBUTION COBOL 85".
022100 01  CCVS-E-2.
022200     02  FILLER                   PICTURE X(31)  VALUE
022300     SPACE.
022400     02  FILLER                   PICTURE X(21)  VALUE SPACE.
022500     02 CCVS-E-2-2.
022600         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
022700         03 FILLER PICTURE IS X VALUE IS SPACE.
022800         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
022900 01  CCVS-E-3.
023000     02  FILLER PICTURE X(22) VALUE
023100     " FOR OFFICIAL USE ONLY".
023200     02  FILLER PICTURE X(12) VALUE SPACE.
023300     02  FILLER PICTURE X(58) VALUE
023400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
023500     02  FILLER PICTURE X(13) VALUE SPACE.
023600     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
023700 01  CCVS-E-4.
023800     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
023900     02 FILLER PIC XXXX VALUE " OF ".
024000     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
024100     02 FILLER PIC X(40) VALUE
024200      "  TESTS WERE EXECUTED SUCCESSFULLY".
024300 01  XXINFO.
024400     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
024500     02 INFO-TEXT.
024600     04 FILLER PIC X(20) VALUE SPACE.
024700     04 XXCOMPUTED PIC X(20).
024800     04 FILLER PIC X(5) VALUE SPACE.
024900     04 XXCORRECT PIC X(20).
025000 01  HYPHEN-LINE.
025100     02 FILLER PICTURE IS X VALUE IS SPACE.
025200     02 FILLER PICTURE IS X(65) VALUE IS "************************
025300-    "*****************************************".
025400     02 FILLER PICTURE IS X(54) VALUE IS "************************
025500-    "******************************".
025600 01  CCVS-PGM-ID PIC X(6) VALUE
025700     "SQ217A".
025800 PROCEDURE DIVISION.
025900 CCVS1 SECTION.
026000 OPEN-FILES.
026100P    OPEN I-O RAW-DATA.
026200P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
026300P    READ RAW-DATA INVALID KEY GO TO END-E-1.
026400P    MOVE "ABORTED " TO C-ABORT.
026500P    ADD 1 TO C-NO-OF-TESTS.
026600P    ACCEPT C-DATE  FROM DATE.
026700P    ACCEPT C-TIME  FROM TIME.
026800P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
026900PEND-E-1.
027000P    CLOSE RAW-DATA.
027100     OPEN     OUTPUT PRINT-FILE.
027200     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
027300     MOVE    SPACE TO TEST-RESULTS.
027400     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
027500     MOVE ZERO TO REC-SKL-SUB.
027600     PERFORM CCVS-INIT-FILE 9 TIMES.
027700 CCVS-INIT-FILE.
027800     ADD 1 TO REC-SKL-SUB.
027900     MOVE FILE-RECORD-INFO-SKELETON TO
028000                  FILE-RECORD-INFO (REC-SKL-SUB).
028100 CCVS-INIT-EXIT.
028200     GO TO CCVS1-EXIT.
028300 CLOSE-FILES.
028400     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
028500P    OPEN I-O RAW-DATA.
028600P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
028700P    READ RAW-DATA INVALID KEY GO TO END-E-2.
028800P    MOVE "OK.     " TO C-ABORT.
028900P    MOVE PASS-COUNTER TO C-OK.
029000P    MOVE ERROR-HOLD   TO C-ALL.
029100P    MOVE ERROR-COUNTER TO C-FAIL.
029200P    MOVE DELETE-CNT TO C-DELETED.
029300P    MOVE INSPECT-COUNTER TO C-INSPECT.
029400P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
029500PEND-E-2.
029600P    CLOSE RAW-DATA.
029700 TERMINATE-CCVS.
029800S    EXIT PROGRAM.
029900STERMINATE-CALL.
030000     STOP     RUN.
030100 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
030200 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
030300 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
030400 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
030500     MOVE "****TEST DELETED****" TO RE-MARK.
030600 PRINT-DETAIL.
030700     IF REC-CT NOT EQUAL TO ZERO
030800             MOVE "." TO PARDOT-X
030900             MOVE REC-CT TO DOTVALUE.
031000     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
031100     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
031200        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
031300          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
031400     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
031500     MOVE SPACE TO CORRECT-X.
031600     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
031700     MOVE     SPACE TO RE-MARK.
031800 HEAD-ROUTINE.
031900     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032000     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
032100     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
032200 COLUMN-NAMES-ROUTINE.
032300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
032400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
032600 END-ROUTINE.
032700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
032800 END-RTN-EXIT.
032900     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033000 END-ROUTINE-1.
033100      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
033200      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
033300      ADD PASS-COUNTER TO ERROR-HOLD.
033400*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
033500      MOVE PASS-COUNTER TO CCVS-E-4-1.
033600      MOVE ERROR-HOLD TO CCVS-E-4-2.
033700      MOVE CCVS-E-4 TO CCVS-E-2-2.
033800      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
033900  END-ROUTINE-12.
034000      MOVE "TEST(S) FAILED" TO ENDER-DESC.
034100     IF       ERROR-COUNTER IS EQUAL TO ZERO
034200         MOVE "NO " TO ERROR-TOTAL
034300         ELSE
034400         MOVE ERROR-COUNTER TO ERROR-TOTAL.
034500     MOVE     CCVS-E-2 TO DUMMY-RECORD.
034600     PERFORM WRITE-LINE.
034700 END-ROUTINE-13.
034800     IF DELETE-CNT IS EQUAL TO ZERO
034900         MOVE "NO " TO ERROR-TOTAL  ELSE
035000         MOVE DELETE-CNT TO ERROR-TOTAL.
035100     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
035200     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035300      IF   INSPECT-COUNTER EQUAL TO ZERO
035400          MOVE "NO " TO ERROR-TOTAL
035500      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
035600      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
035700      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035800     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035900 WRITE-LINE.
036000     ADD 1 TO RECORD-COUNT.
036100Y    IF RECORD-COUNT GREATER 50
036200Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
036300Y        MOVE SPACE TO DUMMY-RECORD
036400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
036500Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
036600Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
036700Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
036800Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
036900Y        MOVE ZERO TO RECORD-COUNT.
037000     PERFORM WRT-LN.
037100 WRT-LN.
037200     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
037300     MOVE SPACE TO DUMMY-RECORD.
037400 BLANK-LINE-PRINT.
037500     PERFORM WRT-LN.
037600 FAIL-ROUTINE.
037700     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
037800     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
037900     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
038000     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038100     GO TO FAIL-ROUTINE-EX.
038200 FAIL-ROUTINE-WRITE.
038300     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
038400     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
038500 FAIL-ROUTINE-EX. EXIT.
038600 BAIL-OUT.
038700     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
038800     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
038900 BAIL-OUT-WRITE.
039000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
039100     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039200 BAIL-OUT-EX. EXIT.
039300 CCVS1-EXIT.
039400     EXIT.
039500 SECT-SQ217A-0001 SECTION.
039600 WRITE-INIT-GF-01.
039700     MOVE "SQ-FS1" TO XFILE-NAME (1).
039800     MOVE "R1-F-G" TO XRECORD-NAME (1).
039900     MOVE "SQ217"     TO XPROGRAM-NAME (1).
040000     MOVE 000120 TO XRECORD-LENGTH (1).
040100     MOVE "RC"   TO CHARS-OR-RECORDS (1).
040200     MOVE 0001   TO XBLOCK-SIZE (1).
040300     MOVE 000750 TO RECORDS-IN-FILE (1).
040400     MOVE "SQ"   TO XFILE-ORGANIZATION (1).
040500     MOVE "S" TO XLABEL-TYPE (1).
040600     MOVE 000001 TO XRECORD-NUMBER (1).
040700     OPEN OUTPUT SQ-FS1.
040800 WRITE-TEST-GF-01.
040900     MOVE FILE-RECORD-INFO-P1-120 (1)  TO SQ-FS1R1-F-G-120.
041000     WRITE SQ-FS1R1-F-G-120.
041100     IF XRECORD-NUMBER (1) EQUAL TO 750
041200         GO TO WRITE-WRITE-GF-01.
041300     ADD 1 TO XRECORD-NUMBER (1).
041400     GO TO WRITE-TEST-GF-01.
041500 WRITE-WRITE-GF-01.
041600     MOVE "CREATE FILE SQ-FS1" TO FEATURE.
041700     MOVE "WRITE-TEST-GF-01" TO PAR-NAME.
041800     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
041900     MOVE  XRECORD-NUMBER (1) TO CORRECT-18V0.
042000     PERFORM PASS.
042100     PERFORM PRINT-DETAIL.
042200     CLOSE SQ-FS1.
042300*        A SEQUENTIAL TAPE FILE WITH 120 CHARACTER RECORDS
042400*    HAS BEEN CREATED. THE FILE CONTAINS 750 RECORDS.
042500 READ-INIT-F1-01.
042600     MOVE ZERO TO WRK-CS-09V00.
042700*        THIS TEST READS AND CHECKS THE FILE CREATED IN
042800*    WRITE-TEST-GF-01.
042900     OPEN INPUT SQ-FS1.
043000 READ-TEST-F1-01.
043100     READ SQ-FS1
043200          AT END GO TO READ-TEST-F1-01-1.
043300     MOVE   SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
043400     ADD 1 TO WRK-CS-09V00.
043500     IF WRK-CS-09V00 GREATER THAN 750
043600        MOVE "MORE THAN 750 RECORDS" TO RE-MARK
043700        GO TO READ-FAIL-F1-01.
043800     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
043900         ADD 1 TO RECORDS-IN-ERROR
044000         GO TO READ-TEST-F1-01.
044100     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS1"
044200        ADD 1 TO RECORDS-IN-ERROR
044300        GO TO READ-TEST-F1-01.
044400     IF XLABEL-TYPE (1) NOT EQUAL TO "S"
044500        ADD 1 TO RECORDS-IN-ERROR.
044600     GO TO READ-TEST-F1-01.
044700 READ-TEST-F1-01-1.
044800     IF RECORDS-IN-ERROR EQUAL TO ZERO
044900         GO TO READ-PASS-F1-01.
045000     MOVE "ERRORS IN READING SQ-FS1" TO RE-MARK.
045100 READ-FAIL-F1-01.
045200     MOVE "VII-12; PADDING CHARACTER"  TO RE-MARK.
045300     MOVE "RECORDS IN ERROR =" TO COMPUTED-A.
045400     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
045500     PERFORM FAIL.
045600     GO TO READ-WRITE-F1-01.
045700 READ-PASS-F1-01.
045800     PERFORM PASS.
045900     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
046000     MOVE WRK-CS-09V00 TO CORRECT-18V0.
046100 READ-WRITE-F1-01.
046200     MOVE "READ-TEST-F1-01"  TO PAR-NAME.
046300     MOVE "VERIFY FILE SQ-FS1" TO FEATURE.
046400     PERFORM PRINT-DETAIL.
046500 READ-CLOSE-F1-01.
046600     CLOSE SQ-FS1.
046700 READ-INIT-F1-02.
046800     MOVE ZERO TO WRK-CS-09V00.
046900     MOVE ZERO TO RECORDS-IN-ERROR.
047000     OPEN INPUT   SQ-FS1.
047100*            FOUR OPTIONS FOR THE READ STATEMENT ARE CHECKED
047200*    IN THIS SERIES OF TESTS.
047300     MOVE "LEV 2 PADDING CHARS " TO FEATURE.
047400     MOVE "READ...RECORD AT END ..." TO RE-MARK.
047500     MOVE "READ-TEST-F1-02" TO PAR-NAME.
047600     MOVE ZERO TO ERROR-FLAG.
047700 READ-TEST-F1-02.
047800     READ SQ-FS1 RECORD AT END
047900              MOVE "UNEXPECTED EOF" TO COMPUTED-A
048000              MOVE 1 TO EOF-FLAG
048100              GO TO READ-FAIL-F1-02.
048200     PERFORM RECORD-CHECK.
048300     IF WRK-CS-09V00 EQUAL TO 200
048400              GO TO READ-TEST-F1-02-1.
048500             GO TO READ-TEST-F1-02.
048600 RECORD-CHECK.
048700     MOVE SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
048800     ADD 1 TO WRK-CS-09V00.
048900     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
049000         ADD 1 TO RECORDS-IN-ERROR
049100         MOVE 1 TO ERROR-FLAG.
049200 READ-TEST-F1-02-1.
049300     IF ERROR-FLAG EQUAL TO ZERO
049400         GO TO READ-PASS-F1-02.
049500     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
049600 READ-FAIL-F1-02.
049700     PERFORM FAIL.
049800     GO TO READ-WRITE-F1-02.
049900 READ-PASS-F1-02.
050000     PERFORM PASS.
050100 READ-WRITE-F1-02.
050200     PERFORM PRINT-DETAIL.
050300 READ-INIT-F1-F1-03.
050400     IF EOF-FLAG EQUAL TO 1
050500        GO TO  READ-EOF-06.
050600     MOVE ZERO TO ERROR-FLAG.
050700     MOVE "READ...AT END..." TO RE-MARK.
050800     MOVE "READ-TEST-F1-03" TO PAR-NAME.
050900 READ-TEST-F1-03.
051000     READ SQ-FS1 AT END
051100         MOVE "UNEXPECTED EOF" TO COMPUTED-A
051200         MOVE 1 TO EOF-FLAG
051300         GO TO READ-FAIL-F1-03.
051400     PERFORM RECORD-CHECK.
051500     IF WRK-CS-09V00 EQUAL TO 400
051600         GO TO READ-TEST-F1-03-1.
051700     GO TO READ-TEST-F1-03.
051800 READ-TEST-F1-03-1.
051900     IF ERROR-FLAG EQUAL TO ZERO
052000         GO TO READ-PASS-F1-03.
052100     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
052200 READ-FAIL-F1-03.
052300     MOVE "VII-12; PADDING CHARACTER"  TO RE-MARK.
052400     PERFORM FAIL.
052500     GO TO READ-WRITE-F1-03.
052600 READ-PASS-F1-03.
052700     PERFORM PASS.
052800 READ-WRITE-F1-03.
052900     PERFORM PRINT-DETAIL.
053000 READ-INIT-F1-04.
053100     IF EOF-FLAG EQUAL TO 1
053200        GO TO  READ-EOF-06.
053300     MOVE ZERO TO ERROR-FLAG.
053400     MOVE "READ...RECORD END..." TO RE-MARK.
053500     MOVE "READ-TEST-F1-04" TO PAR-NAME.
053600 READ-TEST-F1-04.
053700     READ SQ-FS1 RECORD END
053800          MOVE "UNEXPECTED EOF" TO COMPUTED-A
053900          MOVE 1 TO EOF-FLAG
054000          GO TO READ-FAIL-F1-04.
054100     PERFORM RECORD-CHECK.
054200     IF WRK-CS-09V00 EQUAL TO 600
054300         GO TO READ-TEST-F1-04-1.
054400     GO TO READ-TEST-F1-04.
054500 READ-TEST-F1-04-1.
054600     IF ERROR-FLAG EQUAL TO ZERO
054700         GO TO READ-PASS-F1-04.
054800     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
054900 READ-FAIL-F1-04.
055000     MOVE "VII-12; PADDING CHARACTER"  TO RE-MARK.
055100     PERFORM FAIL.
055200     GO TO READ-WRITE-F1-04.
055300 READ-PASS-F1-04.
055400     PERFORM PASS.
055500 READ-WRITE-F1-04.
055600     PERFORM PRINT-DETAIL.
055700 READ-INIT-F1-05.
055800     IF EOF-FLAG EQUAL TO 1
055900         GO TO  READ-EOF-06.
056000     MOVE ZERO TO ERROR-FLAG.
056100     MOVE "READ...END..." TO RE-MARK.
056200     MOVE  "READ-TEST-F1-05" TO PAR-NAME.
056300 READ-TEST-F1-05.
056400     READ SQ-FS1 END GO TO READ-TEST-F1-05-1.
056500     PERFORM RECORD-CHECK.
056600     IF WRK-CS-09V00 GREATER THAN 750
056700          GO TO READ-TEST-F1-05-1.
056800     GO TO READ-TEST-F1-05.
056900 READ-TEST-F1-05-1.
057000     IF ERROR-FLAG EQUAL TO ZERO
057100          GO TO READ-PASS-F1-05.
057200 READ-FAIL-F1-05.
057300     MOVE "VII-12; PADDING CHARACTER"  TO RE-MARK.
057400     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
057500     PERFORM FAIL.
057600     GO TO READ-WRITE-F1-05.
057700 READ-PASS-F1-05.
057800     PERFORM PASS.
057900 READ-WRITE-F1-05.
058000     PERFORM PRINT-DETAIL.
058100 READ-TEST-06.
058200     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
058300          MOVE "RECORDS IN ERROR =" TO COMPUTED-A
058400          MOVE "VII-12; PADDING CHARACTER"  TO RE-MARK
058500          MOVE RECORDS-IN-ERROR TO CORRECT-18V0
058600          GO TO READ-FAIL-06.
058700     IF WRK-CS-09V00 GREATER THAN 750
058800     MOVE "MORE THAN 750 RECORDS; VII-12 PADDING CHARS" TO RE-MARK
058900          GO TO READ-FAIL-06.
059000 READ-PASS-06.
059100     PERFORM PASS.
059200     GO TO READ-WRITE-06.
059300 READ-EOF-06.
059400     MOVE "LESS THAN 750 RECORDS" TO RE-MARK.
059500     MOVE "RECORDS READ =" TO COMPUTED-A.
059600     MOVE WRK-CS-09V00 TO CORRECT-18V0.
059700 READ-FAIL-06.
059800     PERFORM FAIL.
059900 READ-WRITE-06.
060000     MOVE "READ-TEST-06 "  TO PAR-NAME.
060100     MOVE "READ FILE SQ-FS1" TO FEATURE.
060200     PERFORM PRINT-DETAIL.
060300 READ-CLOSE-003.
060400     CLOSE SQ-FS1.
060500 TERMINATE-ROUTINE.
060600     EXIT.
060700 CCVS-EXIT SECTION.
060800 CCVS-999999.
060900     GO TO CLOSE-FILES.
