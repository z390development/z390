000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ226A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
000900*                             REVISED 1986, AUGUST             *
001000*                                                              *
001100*    CREATION DATE     /     VALIDATION DATE                   *
001200*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001300*                                                              *
001400****************************************************************
001500*                                                              *
001600*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001700*                                                              *
001800*            X-14   SEQUENTIAL MASS STORAGE FILE               *
001900*            X-55   SYSTEM PRINTER                             *
002000*            X-82   SOURCE-COMPUTER                            *
002100*            X-83   OBJECT-COMPUTER.                           *
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    THIS PROGRAM OPENS FOR OUTPUT A FILE WHICH IS ASSIGNED    *
002600*    TO A MASS STORAGE MEDIUM, WRITES ONE RECORD AND CLOSES    *
002700*    THE FILE.  THE FILE IS THEN OPENED FOR INPUT, AND TWO     *
002800*    READ STATEMENTS EXECUTED.  THE SECOND SHOULD CAUSE AN     *
002900*    AT END CONDITION.  AN OPEN EXTEND STATEMENT IS THEN       *
003000*    EXECUTED.  THIS SHOULD CAUSE AN EXCEPTION CONDITION,      *
003100*    WITH I-O STATUS "41" AND ENTRY TO THE APPLICABLE ERROR    *
003200*    DECLARATIVE.  THERE ARE DECLARATIVES FOR ALL FOUR OPEN    *
003300*    MODES, AND EITHER THE "INPUT" OR THE "EXTEND" DECLARATIVE *
003400*    COULD BE CONSIDERED APPLICABLE.  THE STANDARD IS          *
003500*    AMBIGUOUS ON THIS POINT, SEE PAGE VII-51, 4.6.4, GENERAL  *
003600*    RULE (5), SUB-RULES B AND E.  THE PROGRAM ACCEPTS         *
003700*    EXECUTION OF EITHER DECLARATIVE AS CORRECT, SO LONG AS    *
003800*    ONLY ONE OF THEM IS EXECUTED.                             *
003900*                                                              *
004000****************************************************************
004100*
004200 ENVIRONMENT DIVISION.
004300 CONFIGURATION SECTION.
004400 SOURCE-COMPUTER.
004500     XXXXX082.
004600 OBJECT-COMPUTER.
004700     XXXXX083.
004800*
004900 INPUT-OUTPUT SECTION.
005000 FILE-CONTROL.
005100     SELECT PRINT-FILE ASSIGN TO
005200     XXXXX055.
005300*
005400P    SELECT RAW-DATA   ASSIGN TO
005500P    XXXXX062
005600P          ORGANIZATION IS INDEXED
005700P          ACCESS MODE  IS RANDOM
005800P          RECORD-KEY   IS RAW-DATA-KEY.
005900P
006000     SELECT SQ-FS4
006100            RESERVE 1
006200            ASSIGN
006300     XXXXX014
006400            SEQUENTIAL
006500            STATUS IS SQ-FS4-STATUS OF STATUS-GROUP.
006600*
006700*
006800 DATA DIVISION.
006900 FILE SECTION.
007000 FD  PRINT-FILE
007100C    LABEL RECORDS
007200C    XXXXX084
007300C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007400               .
007500 01  PRINT-REC    PICTURE X(120).
007600 01  DUMMY-RECORD PICTURE X(120).
007700P
007800PFD  RAW-DATA.
007900P01  RAW-DATA-SATZ.
008000P    05  RAW-DATA-KEY        PIC X(6).
008100P    05  C-DATE              PIC 9(6).
008200P    05  C-TIME              PIC 9(8).
008300P    05  NO-OF-TESTS         PIC 99.
008400P    05  C-OK                PIC 999.
008500P    05  C-ALL               PIC 999.
008600P    05  C-FAIL              PIC 999.
008700P    05  C-DELETED           PIC 999.
008800P    05  C-INSPECT           PIC 999.
008900P    05  C-NOTE              PIC X(13).
009000P    05  C-INDENT            PIC X.
009100P    05  C-ABORT             PIC X(8).
009200*
009300 FD  SQ-FS4
009400C    LABEL RECORD IS STANDARD
009500     BLOCK  120
009600     RECORD 120
009700                .
009800 01  SQ-FS4R1-F-G-120.
009900        05 FFILE-RECORD-INFO-P1-120.
010000           07 FILLER              PIC X(5).
010100           07 FFILE-NAME          PIC X(6).
010200           07 FILLER              PIC X(8).
010300           07 FRECORD-NAME        PIC X(6).
010400           07 FILLER              PIC X(1).
010500           07 FREELUNIT-NUMBER    PIC 9(1).
010600           07 FILLER              PIC X(7).
010700           07 FRECORD-NUMBER      PIC 9(6).
010800           07 FILLER              PIC X(6).
010900           07 FUPDATE-NUMBER      PIC 9(2).
011000           07 FILLER              PIC X(5).
011100           07 FODO-NUMBER         PIC 9(4).
011200           07 FILLER              PIC X(5).
011300           07 FPROGRAM-NAME       PIC X(5).
011400           07 FILLER              PIC X(7).
011500           07 FRECORD-LENGTH      PIC 9(6).
011600           07 FILLER              PIC X(7).
011700           07 FCHARS-OR-RECORDS   PIC X(2).
011800           07 FILLER              PIC X(1).
011900           07 FBLOCK-SIZE         PIC 9(4).
012000           07 FILLER              PIC X(6).
012100           07 FRECORDS-IN-FILE    PIC 9(6).
012200           07 FILLER              PIC X(5).
012300           07 FFILE-ORGANIZATION  PIC X(2).
012400           07 FILLER              PIC X(6).
012500           07 FLABEL-TYPE         PIC X(1).
012600*
012700 WORKING-STORAGE SECTION.
012800*
012900***************************************************************
013000*                                                             *
013100*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
013200*                                                             *
013300***************************************************************
013400*
013500 01  STATUS-GROUP.
013600     04  SQ-FS4-STATUS.
013700         07  SQ-FS4-KEY-1   PIC X.
013800         07  SQ-FS4-KEY-2   PIC X.
013900*
014000 01  DELETE-SW.
014100     03  DELETE-SW-1 PIC X.
014200     03  DELETE-SW-1-GROUP.
014300         05  DELETE-SW-2 PIC X.
014400*
014500 01  DECL-EXEC-E   PIC X(12).
014600 01  DECL-EXEC-I   PIC X(12).
014700 01  DECL-EXEC-I-O PIC X(12).
014800 01  DECL-EXEC-O   PIC X(12).
014900*
015000 01  DECL-EXEC-SW PIC X.
015100 01  DECL-EXEC-CT PIC 9.
015200*
015300***************************************************************
015400*                                                             *
015500*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
015600*                                                             *
015700***************************************************************
015800*
015900 01  REC-SKEL-SUB   PIC 99.
016000*
016100 01  FILE-RECORD-INFORMATION-REC.
016200     03 FILE-RECORD-INFO-SKELETON.
016300        05 FILLER                 PICTURE X(48)       VALUE
016400             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
016500        05 FILLER                 PICTURE X(46)       VALUE
016600             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
016700        05 FILLER                 PICTURE X(26)       VALUE
016800             ",LFIL=000000,ORG=  ,LBLR= ".
016900        05 FILLER                 PICTURE X(37)       VALUE
017000             ",RECKEY=                             ".
017100        05 FILLER                 PICTURE X(38)       VALUE
017200             ",ALTKEY1=                             ".
017300        05 FILLER                 PICTURE X(38)       VALUE
017400             ",ALTKEY2=                             ".
017500        05 FILLER                 PICTURE X(7)        VALUE SPACE.
017600     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
017700        05 FILE-RECORD-INFO-P1-120.
017800           07 FILLER              PIC X(5).
017900           07 XFILE-NAME          PIC X(6).
018000           07 FILLER              PIC X(8).
018100           07 XRECORD-NAME        PIC X(6).
018200           07 FILLER              PIC X(1).
018300           07 REELUNIT-NUMBER     PIC 9(1).
018400           07 FILLER              PIC X(7).
018500           07 XRECORD-NUMBER      PIC 9(6).
018600           07 FILLER              PIC X(6).
018700           07 UPDATE-NUMBER       PIC 9(2).
018800           07 FILLER              PIC X(5).
018900           07 ODO-NUMBER          PIC 9(4).
019000           07 FILLER              PIC X(5).
019100           07 XPROGRAM-NAME       PIC X(5).
019200           07 FILLER              PIC X(7).
019300           07 XRECORD-LENGTH      PIC 9(6).
019400           07 FILLER              PIC X(7).
019500           07 CHARS-OR-RECORDS    PIC X(2).
019600           07 FILLER              PIC X(1).
019700           07 XBLOCK-SIZE         PIC 9(4).
019800           07 FILLER              PIC X(6).
019900           07 RECORDS-IN-FILE     PIC 9(6).
020000           07 FILLER              PIC X(5).
020100           07 XFILE-ORGANIZATION  PIC X(2).
020200           07 FILLER              PIC X(6).
020300           07 XLABEL-TYPE         PIC X(1).
020400        05 FILE-RECORD-INFO-P121-240.
020500           07 FILLER              PIC X(8).
020600           07 XRECORD-KEY         PIC X(29).
020700           07 FILLER              PIC X(9).
020800           07 ALTERNATE-KEY1      PIC X(29).
020900           07 FILLER              PIC X(9).
021000           07 ALTERNATE-KEY2      PIC X(29).
021100           07 FILLER              PIC X(7).
021200*
021300 01  TEST-RESULTS.
021400     02 FILLER              PIC X      VALUE SPACE.
021500     02  PAR-NAME.
021600       03 FILLER              PIC X(14)  VALUE SPACE.
021700       03 PARDOT-X            PIC X      VALUE SPACE.
021800       03 DOTVALUE            PIC 99     VALUE ZERO.
021900     02 FILLER              PIC X      VALUE SPACE.
022000     02 FEATURE             PIC X(24)  VALUE SPACE.
022100     02 FILLER              PIC X      VALUE SPACE.
022200     02 P-OR-F              PIC X(5)   VALUE SPACE.
022300     02 FILLER              PIC X(9)   VALUE SPACE.
022400     02 RE-MARK             PIC X(61).
022500 01  TEST-COMPUTED.
022600   02 FILLER  PIC X(30)  VALUE SPACE.
022700   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
022800   02 COMPUTED-X.
022900     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
023000     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
023100     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
023200     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
023300     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
023400     03       CM-18V0 REDEFINES COMPUTED-A.
023500        04 COMPUTED-18V0                   PIC -9(18).
023600        04 FILLER                          PIC X.
023700     03 FILLER PIC X(50) VALUE SPACE.
023800 01  TEST-CORRECT.
023900     02 FILLER PIC X(30) VALUE SPACE.
024000     02 FILLER PIC X(17) VALUE "       CORRECT =".
024100     02 CORRECT-X.
024200     03 CORRECT-A                  PIC X(20) VALUE SPACE.
024300     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
024400     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
024500     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
024600     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
024700     03      CR-18V0 REDEFINES CORRECT-A.
024800         04 CORRECT-18V0                     PIC -9(18).
024900         04 FILLER                           PIC X.
025000     03 FILLER PIC X(2) VALUE SPACE.
025100     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
025200*
025300 01  CCVS-C-1.
025400     02 FILLER  PIC IS X        VALUE  SPACE.
025500     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
025600     02 FILLER  PIC IS X        VALUE  SPACE.
025700     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
025800     02 FILLER  PIC IS X        VALUE  SPACE.
025900     02 FILLER  PIC IS X(5)     VALUE "PASS ".
026000     02 FILLER  PIC IS X(9)     VALUE  SPACE.
026100     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
026200 01  CCVS-C-2.
026300     02 FILLER  PIC X(19)  VALUE  SPACE.
026400     02 FILLER  PIC X(6)   VALUE "TESTED".
026500     02 FILLER  PIC X(19)  VALUE  SPACE.
026600     02 FILLER  PIC X(4)   VALUE "FAIL".
026700     02 FILLER  PIC X(72)  VALUE  SPACE.
026800*
026900 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
027000 01  REC-CT            PIC 99       VALUE ZERO.
027100 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
027200 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
027300 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
027400 01  PASS-COUNTER      PIC 999      VALUE ZERO.
027500 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
027600 01  ERROR-HOLD        PIC 999      VALUE ZERO.
027700 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
027800 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
027900 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
028000 01  CCVS-H-1.
028100     02  FILLER          PIC X(39)    VALUE SPACES.
028200     02  FILLER          PIC X(42)    VALUE
028300     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
028400     02  FILLER          PIC X(39)    VALUE SPACES.
028500 01  CCVS-H-2A.
028600   02  FILLER            PIC X(40)  VALUE SPACE.
028700   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
028800   02  FILLER            PIC XXXX   VALUE
028900     "4.2 ".
029000   02  FILLER            PIC X(28)  VALUE
029100            " COPY - NOT FOR DISTRIBUTION".
029200   02  FILLER            PIC X(41)  VALUE SPACE.
029300*
029400 01  CCVS-H-2B.
029500   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
029600   02  TEST-ID           PIC X(9).
029700   02  FILLER            PIC X(4)   VALUE " IN ".
029800   02  FILLER            PIC X(12)  VALUE
029900     " HIGH       ".
030000   02  FILLER            PIC X(22)  VALUE
030100            " LEVEL VALIDATION FOR ".
030200   02  FILLER            PIC X(58)  VALUE
030300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
030400 01  CCVS-H-3.
030500     02  FILLER          PIC X(34)  VALUE
030600            " FOR OFFICIAL USE ONLY    ".
030700     02  FILLER          PIC X(58)  VALUE
030800     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
030900     02  FILLER          PIC X(28)  VALUE
031000            "  COPYRIGHT   1985,1986 ".
031100 01  CCVS-E-1.
031200     02 FILLER           PIC X(52)  VALUE SPACE.
031300     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
031400     02 ID-AGAIN         PIC X(9).
031500     02 FILLER           PIC X(45)  VALUE SPACES.
031600 01  CCVS-E-2.
031700     02  FILLER          PIC X(31)  VALUE SPACE.
031800     02  FILLER          PIC X(21)  VALUE SPACE.
031900     02  CCVS-E-2-2.
032000         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
032100         03 FILLER         PIC X      VALUE SPACE.
032200         03 ENDER-DESC     PIC X(44)  VALUE
032300            "ERRORS ENCOUNTERED".
032400 01  CCVS-E-3.
032500     02  FILLER          PIC X(22)  VALUE
032600            " FOR OFFICIAL USE ONLY".
032700     02  FILLER          PIC X(12)  VALUE SPACE.
032800     02  FILLER          PIC X(58)  VALUE
032900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
033000     02  FILLER          PIC X(8)   VALUE SPACE.
033100     02  FILLER          PIC X(20)  VALUE
033200             " COPYRIGHT 1985,1986".
033300 01  CCVS-E-4.
033400     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
033500     02 FILLER           PIC X(4)   VALUE " OF ".
033600     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
033700     02 FILLER           PIC X(40)  VALUE
033800      "  TESTS WERE EXECUTED SUCCESSFULLY".
033900 01  XXINFO.
034000     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
034100     02 INFO-TEXT.
034200       04 FILLER             PIC X(8)   VALUE SPACE.
034300       04 XXCOMPUTED         PIC X(20).
034400       04 FILLER             PIC X(5)   VALUE SPACE.
034500       04 XXCORRECT          PIC X(20).
034600     02 INF-ANSI-REFERENCE PIC X(48).
034700 01  HYPHEN-LINE.
034800     02 FILLER  PIC IS X VALUE IS SPACE.
034900     02 FILLER  PIC IS X(65)    VALUE IS "************************
035000-    "*****************************************".
035100     02 FILLER  PIC IS X(54)    VALUE IS "************************
035200-    "******************************".
035300 01  CCVS-PGM-ID  PIC X(9)   VALUE
035400     "SQ226A".
035500*
035600*
035700 PROCEDURE DIVISION.
035800 DECLARATIVES.
035900*
036000*    FIRST, A DECLARATIVE FOR THE PRINT FILE, IN CASE THERE
036100*    IS AN ERROR ON PRINTING DURING EXECUTION OF THE OUTPUT
036200*    DECLARATIVE.  PAGE VII-51, 4.6.4(7) STATES THAT THE
036300*    INVOCATION OF THE SAME DECLARATIVE TWICE IS ILLEGAL.
036400*
036500 SECT-SQ226A-0000 SECTION.
036600     USE AFTER STANDARD ERROR PROCEDURE ON PRINT-FILE.
036700 PRINT-FILE-ERROR-PROCESS.
036800     EXIT.
036900*
037000 SECT-SQ226A-0001 SECTION.
037100     USE AFTER EXCEPTION PROCEDURE EXTEND.
037200 EXTEND-ERROR-PROCESS.
037300     MOVE   "EXECUTED" TO DECL-EXEC-E.
037400     ADD     1 TO DECL-EXEC-CT.
037500     PERFORM OUTPUT-ERROR-PROCESS THRU END-DECLS.
037600*
037700 SECT-SQ226A-0002 SECTION.
037800     USE AFTER STANDARD ERROR PROCEDURE ON INPUT.
037900 INPUT-ERROR-PROCESS.
038000     MOVE   "EXECUTED" TO DECL-EXEC-I.
038100     ADD     1 TO DECL-EXEC-CT.
038200     PERFORM OUTPUT-ERROR-PROCESS THRU END-DECLS.
038300*
038400 SECT-SQ226A-0003 SECTION.
038500     USE AFTER EXCEPTION PROCEDURE I-O.
038600 I-O-ERROR-PROCESS.
038700     MOVE   "EXECUTED" TO DECL-EXEC-I-O.
038800     ADD     1 TO DECL-EXEC-CT.
038900     PERFORM OUTPUT-ERROR-PROCESS THRU END-DECLS.
039000*
039100 SECT-SQ226A-0004 SECTION.
039200     USE AFTER ERROR PROCEDURE OUTPUT.
039300 OUTPUT-ERROR-PROCESS.
039400     IF DECL-EXEC-CT = 0
039500         MOVE   "EXECUTED" TO DECL-EXEC-O
039600         ADD     1 TO DECL-EXEC-CT.
039700*
039800     IF DECL-EXEC-SW NOT = SPACE
039900         GO TO   END-DECLS.
040000*
040100     MOVE    1 TO REC-CT.
040200     MOVE   "OPEN EXTEND OPEN FILE"  TO FEATURE.
040300     MOVE   "DECL-OPEN-02" TO PAR-NAME.
040400     GO TO   DECL-OPEN-02.
040500 DECL-DELETE-02.
040600     PERFORM DECL-DE-LETE.
040700     GO TO   DECL-TEST-01-END.
040800 DECL-OPEN-02.
040900     IF SQ-FS4-STATUS = "41"
041000         PERFORM DECL-PASS
041100     ELSE
041200         MOVE    SQ-FS4-STATUS TO COMPUTED-A
041300         MOVE   "41" TO CORRECT-A
041400         MOVE   "UNEXPECTED I-O STATUS ON OPEN OF OPEN FILE"
041500                   TO RE-MARK
041600         MOVE   "VII-3, VII-38,4.2.4(3)F" TO ANSI-REFERENCE
041700         PERFORM DECL-FAIL.
041800 DECL-TEST-01-END.
041900*
042000     PERFORM DECL-WRITE-LINE.
042100     MOVE   "ABNORMAL TERMINATION AT THIS POINT IS ACCEPTABLE"
042200               TO DUMMY-RECORD.
042300     PERFORM DECL-WRITE-LINE 3 TIMES.
042400     GO TO   END-DECLS.
042500*
042600*
042700 DECL-PASS.
042800     MOVE   "PASS " TO P-OR-F.
042900     ADD     1 TO PASS-COUNTER.
043000     PERFORM DECL-PRINT-DETAIL.
043100*
043200 DECL-FAIL.
043300     MOVE   "FAIL*" TO P-OR-F.
043400     ADD     1 TO ERROR-COUNTER.
043500     PERFORM DECL-PRINT-DETAIL.
043600*
043700 DECL-DE-LETE.
043800     MOVE   "****TEST DELETED****" TO RE-MARK.
043900     MOVE   "*****" TO P-OR-F.
044000     ADD     1 TO DELETE-COUNTER.
044100     PERFORM DECL-PRINT-DETAIL.
044200*
044300 DECL-PRINT-DETAIL.
044400     IF REC-CT NOT EQUAL TO ZERO
044500             MOVE "." TO PARDOT-X
044600             MOVE REC-CT TO DOTVALUE.
044700     MOVE    TEST-RESULTS TO PRINT-REC.
044800     PERFORM DECL-WRITE-LINE.
044900     IF P-OR-F EQUAL TO "FAIL*"
045000         PERFORM DECL-WRITE-LINE
045100         PERFORM DECL-FAIL-ROUTINE THRU DECL-FAIL-EX
045200     ELSE
045300         PERFORM DECL-BAIL THRU DECL-BAIL-EX.
045400     MOVE    SPACE TO P-OR-F.
045500     MOVE    SPACE TO COMPUTED-X.
045600     MOVE    SPACE TO CORRECT-X.
045700     IF REC-CT EQUAL TO ZERO
045800         MOVE    SPACE TO PAR-NAME.
045900     MOVE    SPACE TO RE-MARK.
046000*
046100 DECL-WRITE-LINE.
046200     ADD     1 TO RECORD-COUNT.
046300Y    IF RECORD-COUNT GREATER 50
046400Y        MOVE    DUMMY-RECORD TO DUMMY-HOLD
046500Y        MOVE    SPACE TO DUMMY-RECORD
046600Y        WRITE   DUMMY-RECORD AFTER ADVANCING PAGE
046700Y        MOVE    CCVS-C-1 TO DUMMY-RECORD PERFORM DECL-WRT-LN
046800Y        MOVE    CCVS-C-2 TO DUMMY-RECORD
046900Y        PERFORM DECL-WRT-LN 2 TIMES
047000Y        MOVE    HYPHEN-LINE TO DUMMY-RECORD
047100Y        PERFORM DECL-WRT-LN
047200Y        MOVE    DUMMY-HOLD TO DUMMY-RECORD
047300Y        MOVE    ZERO TO RECORD-COUNT.
047400     PERFORM DECL-WRT-LN.
047500*
047600 DECL-WRT-LN.
047700     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
047800     MOVE    SPACE TO DUMMY-RECORD.
047900*
048000 DECL-FAIL-ROUTINE.
048100     IF COMPUTED-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
048200     IF CORRECT-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
048300     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
048400     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
048500     MOVE    XXINFO TO DUMMY-RECORD.
048600     PERFORM DECL-WRITE-LINE 2 TIMES.
048700     MOVE    SPACES TO INF-ANSI-REFERENCE.
048800     GO TO   DECL-FAIL-EX.
048900 DECL-FAIL-WRITE.
049000     MOVE    TEST-COMPUTED TO PRINT-REC
049100     PERFORM DECL-WRITE-LINE
049200     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
049300     MOVE    TEST-CORRECT TO PRINT-REC
049400     PERFORM DECL-WRITE-LINE 2 TIMES.
049500     MOVE    SPACES TO COR-ANSI-REFERENCE.
049600 DECL-FAIL-EX.
049700     EXIT.
049800*
049900 DECL-BAIL.
050000     IF COMPUTED-A NOT EQUAL TO SPACE GO TO DECL-BAIL-WRITE.
050100     IF CORRECT-A EQUAL TO SPACE GO TO DECL-BAIL-EX.
050200 DECL-BAIL-WRITE.
050300     MOVE    CORRECT-A TO XXCORRECT.
050400     MOVE    COMPUTED-A TO XXCOMPUTED.
050500     MOVE    XXINFO TO DUMMY-RECORD.
050600     PERFORM DECL-WRITE-LINE 2 TIMES.
050700 DECL-BAIL-EX.
050800     EXIT.
050900*
051000 END-DECLS.
051100 END DECLARATIVES.
051200*
051300*
051400 CCVS1 SECTION.
051500 OPEN-FILES.
051600P    OPEN    I-O RAW-DATA.
051700P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
051800P    READ    RAW-DATA INVALID KEY GO TO END-E-1.
051900P    MOVE   "ABORTED "   TO C-ABORT.
052000P    ADD     1           TO C-NO-OF-TESTS.
052100P    ACCEPT  C-DATE      FROM DATE.
052200P    ACCEPT  C-TIME      FROM TIME.
052300P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
052400PEND-E-1.
052500P    CLOSE   RAW-DATA.
052600     OPEN    OUTPUT PRINT-FILE.
052700     MOVE    CCVS-PGM-ID TO TEST-ID.
052800     MOVE    CCVS-PGM-ID TO ID-AGAIN.
052900     MOVE    SPACE TO TEST-RESULTS.
053000     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
053100     MOVE    ZERO TO REC-SKEL-SUB.
053200     PERFORM CCVS-INIT-FILE 10 TIMES.
053300     GO TO CCVS1-EXIT.
053400*
053500 CCVS-INIT-FILE.
053600     ADD     1 TO REC-SKL-SUB.
053700     MOVE    FILE-RECORD-INFO-SKELETON TO
053800                  FILE-RECORD-INFO (REC-SKL-SUB).
053900*
054000 CLOSE-FILES.
054100     PERFORM END-ROUTINE THRU END-ROUTINE-13.
054200     CLOSE   PRINT-FILE.
054300P    OPEN    I-O RAW-DATA.
054400P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
054500P    READ    RAW-DATA INVALID KEY GO TO END-E-2.
054600P    MOVE   "OK.     " TO C-ABORT.
054700P    MOVE    PASS-COUNTER  TO C-OK.
054800P    MOVE    ERROR-HOLD    TO C-ALL.
054900P    MOVE    ERROR-COUNTER TO C-FAIL.
055000P    MOVE    DELETE-CNT    TO C-DELETED.
055100P    MOVE    INSPECT-COUNTER TO C-INSPECT.
055200P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
055300PEND-E-2.
055400P    CLOSE   RAW-DATA.
055500 TERMINATE-CCVS.
055600S    EXIT    PROGRAM.
055700     STOP    RUN.
055800*
055900 INSPT.
056000     MOVE   "INSPT" TO P-OR-F.
056100     ADD     1 TO INSPECT-COUNTER.
056200     PERFORM PRINT-DETAIL.
056300*
056400 PASS.
056500     MOVE   "PASS " TO P-OR-F.
056600     ADD     1 TO PASS-COUNTER.
056700     PERFORM PRINT-DETAIL.
056800*
056900 FAIL.
057000     MOVE   "FAIL*" TO P-OR-F.
057100     ADD     1 TO ERROR-COUNTER.
057200     PERFORM PRINT-DETAIL.
057300*
057400 DE-LETE.
057500     MOVE   "****TEST DELETED****" TO RE-MARK.
057600     MOVE   "*****" TO P-OR-F.
057700     ADD     1 TO DELETE-COUNTER.
057800     PERFORM PRINT-DETAIL.
057900*
058000 PRINT-DETAIL.
058100     IF REC-CT NOT EQUAL TO ZERO
058200         MOVE   "." TO PARDOT-X
058300         MOVE    REC-CT TO DOTVALUE.
058400     MOVE    TEST-RESULTS TO PRINT-REC.
058500     PERFORM WRITE-LINE.
058600     IF P-OR-F EQUAL TO "FAIL*"
058700         PERFORM WRITE-LINE
058800         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
058900     ELSE
059000         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
059100     MOVE    SPACE TO P-OR-F.
059200     MOVE    SPACE TO COMPUTED-X.
059300     MOVE    SPACE TO CORRECT-X.
059400     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
059500     MOVE    SPACE TO RE-MARK.
059600*
059700 HEAD-ROUTINE.
059800     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
059900     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
060000     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
060100     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
060200 COLUMN-NAMES-ROUTINE.
060300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
060400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
060500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
060600 END-ROUTINE.
060700     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
060800     PERFORM WRITE-LINE 5 TIMES.
060900 END-RTN-EXIT.
061000     MOVE    CCVS-E-1 TO DUMMY-RECORD.
061100     PERFORM WRITE-LINE 2 TIMES.
061200*
061300 END-ROUTINE-1.
061400     ADD     ERROR-COUNTER   TO ERROR-HOLD
061500     ADD     INSPECT-COUNTER TO ERROR-HOLD.
061600     ADD     DELETE-COUNTER  TO ERROR-HOLD.
061700     ADD     PASS-COUNTER    TO ERROR-HOLD.
061800     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
061900     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
062000     MOVE    CCVS-E-4        TO CCVS-E-2-2.
062100     MOVE    CCVS-E-2        TO DUMMY-RECORD
062200     PERFORM WRITE-LINE.
062300     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
062400     IF ERROR-COUNTER IS EQUAL TO ZERO
062500         MOVE   "NO " TO ERROR-TOTAL
062600     ELSE
062700         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
062800     MOVE    CCVS-E-2 TO DUMMY-RECORD.
062900     PERFORM WRITE-LINE.
063000 END-ROUTINE-13.
063100     IF DELETE-COUNTER IS EQUAL TO ZERO
063200         MOVE   "NO " TO ERROR-TOTAL
063300     ELSE
063400         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
063500     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
063600     MOVE    CCVS-E-2 TO DUMMY-RECORD.
063700     PERFORM WRITE-LINE.
063800     IF INSPECT-COUNTER EQUAL TO ZERO
063900         MOVE   "NO " TO ERROR-TOTAL
064000     ELSE
064100         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
064200     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
064300     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
064400     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
064500*
064600 WRITE-LINE.
064700     ADD     1 TO RECORD-COUNT.
064800Y    IF RECORD-COUNT GREATER 50
064900Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
065000Y        MOVE  SPACE TO DUMMY-RECORD
065100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
065200Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
065300Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
065400Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
065500Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
065600Y        MOVE  ZERO TO RECORD-COUNT.
065700     PERFORM WRT-LN.
065800*
065900 WRT-LN.
066000     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
066100     MOVE    SPACE TO DUMMY-RECORD.
066200 BLANK-LINE-PRINT.
066300     PERFORM WRT-LN.
066400 FAIL-ROUTINE.
066500     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
066600     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
066700     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
066800     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
066900     MOVE    XXINFO TO DUMMY-RECORD.
067000     PERFORM WRITE-LINE 2 TIMES.
067100     MOVE    SPACES TO INF-ANSI-REFERENCE.
067200     GO TO   FAIL-ROUTINE-EX.
067300 FAIL-ROUTINE-WRITE.
067400     MOVE    TEST-COMPUTED  TO PRINT-REC
067500     PERFORM WRITE-LINE
067600     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
067700     MOVE    TEST-CORRECT   TO PRINT-REC
067800     PERFORM WRITE-LINE 2 TIMES.
067900     MOVE    SPACES         TO COR-ANSI-REFERENCE.
068000 FAIL-ROUTINE-EX.
068100     EXIT.
068200 BAIL-OUT.
068300     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
068400     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
068500 BAIL-OUT-WRITE.
068600     MOVE    CORRECT-A      TO XXCORRECT.
068700     MOVE    COMPUTED-A     TO XXCOMPUTED.
068800     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
068900     MOVE    XXINFO TO DUMMY-RECORD.
069000     PERFORM WRITE-LINE 2 TIMES.
069100     MOVE    SPACES TO INF-ANSI-REFERENCE.
069200 BAIL-OUT-EX.
069300     EXIT.
069400 CCVS1-EXIT.
069500     EXIT.
069600*
069700****************************************************************
069800*                                                              *
069900*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
070000*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
070100*                                                              *
070200****************************************************************
070300*
070400 SECT-SQ226A-0005 SECTION.
070500 STA-INIT.
070600     MOVE    SPACE TO DELETE-SW.
070700*
070800     MOVE   "SQ-FS4" TO XFILE-NAME (1).
070900     MOVE   "R1-F-G" TO XRECORD-NAME (1).
071000     MOVE    CCVS-PGM-ID TO XPROGRAM-NAME (1).
071100     MOVE    120 TO XRECORD-LENGTH (1).
071200     MOVE   "CC" TO CHARS-OR-RECORDS (1).
071300     MOVE    1   TO XBLOCK-SIZE (1).
071400     MOVE    1   TO RECORDS-IN-FILE (1).
071500     MOVE   "SQ" TO XFILE-ORGANIZATION (1).
071600     MOVE   "S"  TO XLABEL-TYPE (1).
071700*
071800*    OPEN THE FILE IN THE OUTPUT MODE
071900*
072000 SEQ-INIT-01.
072100     MOVE    0 TO REC-CT.
072200     MOVE    0 TO DECL-EXEC-CT.
072300     MOVE   "*" TO DECL-EXEC-SW.
072400     MOVE   "**" TO SQ-FS4-STATUS.
072500     MOVE   "NOT EXECUTED" TO DECL-EXEC-E.
072600     MOVE   "NOT EXECUTED" TO DECL-EXEC-I.
072700     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
072800     MOVE   "NOT EXECUTED" TO DECL-EXEC-O.
072900     MOVE    ZERO TO XRECORD-NUMBER (1).
073000     MOVE   "OPEN, CREATE FILE"  TO FEATURE.
073100     MOVE   "SEQ-TEST-OP-01" TO PAR-NAME.
073200     GO TO   SEQ-TEST-OP-01.
073300 SEQ-DELETE-01.
073400     MOVE   "*" TO DELETE-SW-1.
073500     GO TO   SEQ-DELETE-01-01.
073600 SEQ-TEST-OP-01.
073700     OPEN    OUTPUT SQ-FS4.
073800*
073900*    CHECK I-O STATUS RETURNED FROM OPEN OUTPUT
074000*
074100     ADD    1 TO REC-CT.
074200     IF DELETE-SW NOT = SPACE
074300         GO TO   SEQ-DELETE-01-01.
074400     GO TO   SEQ-TEST-OP-01-01.
074500 SEQ-DELETE-01-01.
074600     PERFORM DE-LETE.
074700     GO TO   SEQ-TEST-01-01-END.
074800 SEQ-TEST-OP-01-01.
074900     IF SQ-FS4-STATUS = "00"
075000         PERFORM PASS
075100     ELSE
075200         MOVE    SQ-FS4-STATUS TO COMPUTED-A
075300         MOVE   "00" TO CORRECT-A
075400         MOVE   "UNEXPECTED ERROR CODE FROM OPEN OUTPUT"
075500                   TO RE-MARK
075600         MOVE   "VII-3, VII-43" TO ANSI-REFERENCE
075700         PERFORM FAIL.
075800 SEQ-TEST-01-01-END.
075900*
076000*    CHECK EXECUTION OF EXTEND DECLARATIVE
076100*
076200     ADD     1 TO REC-CT.
076300     IF DELETE-SW NOT = SPACE
076400         GO TO   SEQ-DELETE-01-02.
076500     GO TO   SEQ-TEST-OP-01-02.
076600 SEQ-DELETE-01-02.
076700     PERFORM DE-LETE.
076800     GO TO   SEQ-TEST-01-02-END.
076900 SEQ-TEST-OP-01-02.
077000     IF DECL-EXEC-E = "NOT EXECUTED"
077100         PERFORM PASS
077200     ELSE
077300         MOVE    DECL-EXEC-E TO COMPUTED-A
077400         MOVE   "NOT EXECUTED" TO CORRECT-A
077500         MOVE   "UNEXPECTED EXECUTION OF EXTEND DECLARATIVE"
077600                   TO RE-MARK
077700         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
077800         PERFORM FAIL.
077900 SEQ-TEST-01-02-END.
078000*
078100*    CHECK EXECUTION OF INPUT DECLARATIVE
078200*
078300     ADD     1 TO REC-CT.
078400     IF DELETE-SW NOT = SPACE
078500         GO TO   SEQ-DELETE-01-03.
078600     GO TO   SEQ-TEST-OP-01-03.
078700 SEQ-DELETE-01-03.
078800     PERFORM DE-LETE.
078900     GO TO   SEQ-TEST-01-03-END.
079000 SEQ-TEST-OP-01-03.
079100     IF DECL-EXEC-I = "NOT EXECUTED"
079200         PERFORM PASS
079300     ELSE
079400         MOVE    DECL-EXEC-I TO COMPUTED-A
079500         MOVE   "NOT EXECUTED" TO CORRECT-A
079600         MOVE   "UNEXPECTED EXECUTION OF INPUT DECLARATIVE"
079700                   TO RE-MARK
079800         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
079900         PERFORM FAIL.
080000 SEQ-TEST-01-03-END.
080100*
080200*    CHECK EXECUTION OF I-O DECLARATIVE
080300*
080400     ADD     1 TO REC-CT.
080500     IF DELETE-SW NOT = SPACE
080600         GO TO   SEQ-DELETE-01-04.
080700     GO TO   SEQ-TEST-OP-01-04.
080800 SEQ-DELETE-01-04.
080900     PERFORM DE-LETE.
081000     GO TO   SEQ-TEST-01-04-END.
081100 SEQ-TEST-OP-01-04.
081200     IF DECL-EXEC-I-O = "NOT EXECUTED"
081300         PERFORM PASS
081400     ELSE
081500         MOVE    DECL-EXEC-I-O TO COMPUTED-A
081600         MOVE   "NOT EXECUTED" TO CORRECT-A
081700         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
081800                   TO RE-MARK
081900         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
082000         PERFORM FAIL.
082100 SEQ-TEST-01-04-END.
082200*
082300*    CHECK EXECUTION OF OUTPUT DECLARATIVE
082400*
082500     ADD     1 TO REC-CT.
082600     IF DELETE-SW NOT = SPACE
082700         GO TO   SEQ-DELETE-01-05.
082800     GO TO   SEQ-TEST-OP-01-05.
082900 SEQ-DELETE-01-05.
083000     PERFORM DE-LETE.
083100     GO TO   SEQ-TEST-01-05-END.
083200 SEQ-TEST-OP-01-05.
083300     IF DECL-EXEC-O = "NOT EXECUTED"
083400         PERFORM PASS
083500     ELSE
083600         MOVE    DECL-EXEC-O TO COMPUTED-A
083700         MOVE   "NOT EXECUTED" TO CORRECT-A
083800         MOVE   "UNEXPECTED EXECUTION OF INPUT DECLARATIVE"
083900                   TO RE-MARK
084000         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
084100         PERFORM FAIL.
084200 SEQ-TEST-01-05-END.
084300*
084400*
084500*    A NEW FILE IS OPEN.  WE NOW WRITE ONE RECORD.
084600*
084700 SEQ-INIT-02.
084800     MOVE    0 TO REC-CT.
084900     MOVE    0 TO DECL-EXEC-CT.
085000     MOVE   "*" TO DECL-EXEC-SW.
085100     ADD     1 TO XRECORD-NUMBER (1).
085200     MOVE   "**" TO SQ-FS4-STATUS.
085300     MOVE   "NOT EXECUTED" TO DECL-EXEC-E.
085400     MOVE   "NOT EXECUTED" TO DECL-EXEC-I.
085500     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
085600     MOVE   "NOT EXECUTED" TO DECL-EXEC-O.
085700     MOVE   "WRITE A RECORD"  TO FEATURE.
085800     MOVE   "SEQ-TEST-WR-02" TO PAR-NAME.
085900     IF DELETE-SW NOT EQUAL TO SPACE
086000         GO TO SEQ-DELETE-02.
086100     GO TO   SEQ-TEST-WR-02.
086200 SEQ-DELETE-02.
086300     MOVE   "*" TO DELETE-SW-2.
086400     GO TO   SEQ-DELETE-02-01.
086500 SEQ-TEST-WR-02.
086600     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-FS4R1-F-G-120.
086700     WRITE   SQ-FS4R1-F-G-120.
086800*
086900*    CHECK I-O STATUS RETURNED FROM WRITE
087000*
087100     ADD    1 TO REC-CT.
087200     IF DELETE-SW NOT = SPACE
087300         GO TO   SEQ-DELETE-02-01.
087400     GO TO   SEQ-TEST-WR-02-01.
087500 SEQ-DELETE-02-01.
087600     PERFORM DE-LETE.
087700     GO TO   SEQ-TEST-02-01-END.
087800 SEQ-TEST-WR-02-01.
087900     IF SQ-FS4-STATUS = "00"
088000         PERFORM PASS
088100     ELSE
088200         MOVE    SQ-FS4-STATUS TO COMPUTED-A
088300         MOVE   "00" TO CORRECT-A
088400         MOVE   "UNEXPECTED ERROR CODE FROM WRITE"
088500                   TO RE-MARK
088600         MOVE   "VII-3, VII-53" TO ANSI-REFERENCE
088700         PERFORM FAIL.
088800 SEQ-TEST-02-01-END.
088900*
089000*    CHECK EXECUTION OF EXTEND DECLARATIVE
089100*
089200     ADD     1 TO REC-CT.
089300     IF DELETE-SW NOT = SPACE
089400         GO TO   SEQ-DELETE-02-02.
089500     GO TO   SEQ-TEST-WR-02-02.
089600 SEQ-DELETE-02-02.
089700     PERFORM DE-LETE.
089800     GO TO   SEQ-TEST-02-02-END.
089900 SEQ-TEST-WR-02-02.
090000     IF DECL-EXEC-E = "NOT EXECUTED"
090100         PERFORM PASS
090200     ELSE
090300         MOVE    DECL-EXEC-E TO COMPUTED-A
090400         MOVE   "NOT EXECUTED" TO CORRECT-A
090500         MOVE   "UNEXPECTED EXECUTION OF EXTEND DECLARATIVE"
090600                   TO RE-MARK
090700         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
090800         PERFORM FAIL.
090900 SEQ-TEST-02-02-END.
091000*
091100*    CHECK EXECUTION OF INPUT DECLARATIVE
091200*
091300     ADD     1 TO REC-CT.
091400     IF DELETE-SW NOT = SPACE
091500         GO TO   SEQ-DELETE-02-03.
091600     GO TO   SEQ-TEST-WR-02-03.
091700 SEQ-DELETE-02-03.
091800     PERFORM DE-LETE.
091900     GO TO   SEQ-TEST-02-03-END.
092000 SEQ-TEST-WR-02-03.
092100     IF DECL-EXEC-I = "NOT EXECUTED"
092200         PERFORM PASS
092300     ELSE
092400         MOVE    DECL-EXEC-I TO COMPUTED-A
092500         MOVE   "NOT EXECUTED" TO CORRECT-A
092600         MOVE   "UNEXPECTED EXECUTION OF INPUT DECLARATIVE"
092700                   TO RE-MARK
092800         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
092900         PERFORM FAIL.
093000 SEQ-TEST-02-03-END.
093100*
093200*    CHECK EXECUTION OF I-O DECLARATIVE
093300*
093400     ADD     1 TO REC-CT.
093500     IF DELETE-SW NOT = SPACE
093600         GO TO   SEQ-DELETE-02-04.
093700     GO TO   SEQ-TEST-WR-02-04.
093800 SEQ-DELETE-02-04.
093900     PERFORM DE-LETE.
094000     GO TO   SEQ-TEST-02-04-END.
094100 SEQ-TEST-WR-02-04.
094200     IF DECL-EXEC-I-O = "NOT EXECUTED"
094300         PERFORM PASS
094400     ELSE
094500         MOVE    DECL-EXEC-I-O TO COMPUTED-A
094600         MOVE   "NOT EXECUTED" TO CORRECT-A
094700         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
094800                   TO RE-MARK
094900         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
095000         PERFORM FAIL.
095100 SEQ-TEST-02-04-END.
095200*
095300*    CHECK EXECUTION OF OUTPUT DECLARATIVE
095400*
095500     ADD     1 TO REC-CT.
095600     IF DELETE-SW NOT = SPACE
095700         GO TO   SEQ-DELETE-02-05.
095800     GO TO   SEQ-TEST-WR-02-05.
095900 SEQ-DELETE-02-05.
096000     PERFORM DE-LETE.
096100     GO TO   SEQ-TEST-02-05-END.
096200 SEQ-TEST-WR-02-05.
096300     IF DECL-EXEC-O = "NOT EXECUTED"
096400         PERFORM PASS
096500     ELSE
096600         MOVE    DECL-EXEC-O TO COMPUTED-A
096700         MOVE   "NOT EXECUTED" TO CORRECT-A
096800         MOVE   "UNEXPECTED EXECUTION OF INPUT DECLARATIVE"
096900                   TO RE-MARK
097000         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
097100         PERFORM FAIL.
097200 SEQ-TEST-02-05-END.
097300     MOVE    SPACE TO DELETE-SW-2.
097400*
097500*
097600*    NOW CLOSE THE FILE.
097700*
097800 SEQ-INIT-03.
097900     MOVE    0 TO REC-CT.
098000     MOVE    0 TO DECL-EXEC-CT.
098100     MOVE   "*" TO DECL-EXEC-SW.
098200     MOVE   "**" TO SQ-FS4-STATUS.
098300     MOVE   "NOT EXECUTED" TO DECL-EXEC-E.
098400     MOVE   "NOT EXECUTED" TO DECL-EXEC-I.
098500     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
098600     MOVE   "NOT EXECUTED" TO DECL-EXEC-O.
098700     MOVE   "CLOSE FILE" TO FEATURE.
098800     MOVE   "SEQ-TEST-CL-03" TO PAR-NAME.
098900     IF DELETE-SW NOT EQUAL TO SPACE
099000         GO TO SEQ-DELETE-03.
099100     GO TO   SEQ-TEST-CL-03.
099200 SEQ-DELETE-03.
099300     MOVE   "*" TO DELETE-SW-2.
099400     GO TO   SEQ-DELETE-03-01.
099500 SEQ-TEST-CL-03.
099600     CLOSE   SQ-FS4.
099700*
099800*    CHECK I-O STATUS RETURNED FROM CLOSE
099900*
100000     ADD    1 TO REC-CT.
100100     IF DELETE-SW NOT = SPACE
100200         GO TO   SEQ-DELETE-03-01.
100300     GO TO   SEQ-TEST-CL-03-01.
100400 SEQ-DELETE-03-01.
100500     PERFORM DE-LETE.
100600     GO TO   SEQ-TEST-03-01-END.
100700 SEQ-TEST-CL-03-01.
100800     IF SQ-FS4-STATUS = "00"
100900         PERFORM PASS
101000     ELSE
101100         MOVE    SQ-FS4-STATUS TO COMPUTED-A
101200         MOVE   "00" TO CORRECT-A
101300         MOVE   "UNEXPECTED ERROR CODE FROM CLOSE"
101400                   TO RE-MARK
101500         MOVE   "VII-3, VII-38,4.2.4(4)" TO ANSI-REFERENCE
101600         PERFORM FAIL.
101700 SEQ-TEST-03-01-END.
101800*
101900*    CHECK EXECUTION OF EXTEND DECLARATIVE
102000*
102100     ADD     1 TO REC-CT.
102200     IF DELETE-SW NOT = SPACE
102300         GO TO   SEQ-DELETE-03-02.
102400     GO TO   SEQ-TEST-CL-03-02.
102500 SEQ-DELETE-03-02.
102600     PERFORM DE-LETE.
102700     GO TO   SEQ-TEST-03-02-END.
102800 SEQ-TEST-CL-03-02.
102900     IF DECL-EXEC-E = "NOT EXECUTED"
103000         PERFORM PASS
103100     ELSE
103200         MOVE    DECL-EXEC-E TO COMPUTED-A
103300         MOVE   "NOT EXECUTED" TO CORRECT-A
103400         MOVE   "UNEXPECTED EXECUTION OF EXTEND DECLARATIVE"
103500                   TO RE-MARK
103600         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
103700         PERFORM FAIL.
103800 SEQ-TEST-03-02-END.
103900*
104000*    CHECK EXECUTION OF INPUT DECLARATIVE
104100*
104200     ADD     1 TO REC-CT.
104300     IF DELETE-SW NOT = SPACE
104400         GO TO   SEQ-DELETE-03-03.
104500     GO TO   SEQ-TEST-CL-03-03.
104600 SEQ-DELETE-03-03.
104700     PERFORM DE-LETE.
104800     GO TO   SEQ-TEST-03-03-END.
104900 SEQ-TEST-CL-03-03.
105000     IF DECL-EXEC-I = "NOT EXECUTED"
105100         PERFORM PASS
105200     ELSE
105300         MOVE    DECL-EXEC-I TO COMPUTED-A
105400         MOVE   "NOT EXECUTED" TO CORRECT-A
105500         MOVE   "UNEXPECTED EXECUTION OF INPUT DECLARATIVE"
105600                   TO RE-MARK
105700         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
105800         PERFORM FAIL.
105900 SEQ-TEST-03-03-END.
106000*
106100*    CHECK EXECUTION OF I-O DECLARATIVE
106200*
106300     ADD     1 TO REC-CT.
106400     IF DELETE-SW NOT = SPACE
106500         GO TO   SEQ-DELETE-03-04.
106600     GO TO   SEQ-TEST-CL-03-04.
106700 SEQ-DELETE-03-04.
106800     PERFORM DE-LETE.
106900     GO TO   SEQ-TEST-03-04-END.
107000 SEQ-TEST-CL-03-04.
107100     IF DECL-EXEC-I-O = "NOT EXECUTED"
107200         PERFORM PASS
107300     ELSE
107400         MOVE    DECL-EXEC-I-O TO COMPUTED-A
107500         MOVE   "NOT EXECUTED" TO CORRECT-A
107600         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
107700                   TO RE-MARK
107800         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
107900         PERFORM FAIL.
108000 SEQ-TEST-03-04-END.
108100*
108200*    CHECK EXECUTION OF OUTPUT DECLARATIVE
108300*
108400     ADD     1 TO REC-CT.
108500     IF DELETE-SW NOT = SPACE
108600         GO TO   SEQ-DELETE-03-05.
108700     GO TO   SEQ-TEST-CL-03-05.
108800 SEQ-DELETE-03-05.
108900     PERFORM DE-LETE.
109000     GO TO   SEQ-TEST-03-05-END.
109100 SEQ-TEST-CL-03-05.
109200     IF DECL-EXEC-O = "NOT EXECUTED"
109300         PERFORM PASS
109400     ELSE
109500         MOVE    DECL-EXEC-O TO COMPUTED-A
109600         MOVE   "NOT EXECUTED" TO CORRECT-A
109700         MOVE   "UNEXPECTED EXECUTION OF INPUT DECLARATIVE"
109800                   TO RE-MARK
109900         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
110000         PERFORM FAIL.
110100 SEQ-TEST-03-05-END.
110200     MOVE    SPACE TO DELETE-SW-2.
110300*
110400*
110500*    OPEN THE FILE IN THE INPUT MODE
110600*
110700 SEQ-INIT-04.
110800     MOVE    0 TO REC-CT.
110900     MOVE    0 TO DECL-EXEC-CT.
111000     MOVE   "*" TO DECL-EXEC-SW.
111100     MOVE   "**" TO SQ-FS4-STATUS.
111200     MOVE   "NOT EXECUTED" TO DECL-EXEC-E.
111300     MOVE   "NOT EXECUTED" TO DECL-EXEC-I.
111400     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
111500     MOVE   "NOT EXECUTED" TO DECL-EXEC-O.
111600     MOVE    ZERO TO XRECORD-NUMBER (1).
111700     MOVE   "OPEN FILE FOR INPUT"  TO FEATURE.
111800     MOVE   "SEQ-TEST-OP-04" TO PAR-NAME.
111900     IF DELETE-SW NOT = SPACE
112000         GO TO SEQ-DELETE-04-01.
112100     GO TO   SEQ-TEST-OP-04.
112200 SEQ-DELETE-04.
112300     MOVE   "*" TO DELETE-SW-2.
112400     GO TO   SEQ-DELETE-04-01.
112500 SEQ-TEST-OP-04.
112600     OPEN    INPUT SQ-FS4.
112700*
112800*    CHECK I-O STATUS RETURNED FROM OPEN INPUT
112900*
113000     ADD    1 TO REC-CT.
113100     IF DELETE-SW NOT = SPACE
113200         GO TO   SEQ-DELETE-04-01.
113300     GO TO   SEQ-TEST-OP-04-01.
113400 SEQ-DELETE-04-01.
113500     PERFORM DE-LETE.
113600     GO TO   SEQ-TEST-04-01-END.
113700 SEQ-TEST-OP-04-01.
113800     IF SQ-FS4-STATUS = "00"
113900         PERFORM PASS
114000     ELSE
114100         MOVE    SQ-FS4-STATUS TO COMPUTED-A
114200         MOVE   "00" TO CORRECT-A
114300         MOVE   "UNEXPECTED ERROR CODE FROM OPEN INPUT"
114400                   TO RE-MARK
114500         MOVE   "VII-3, VII-40" TO ANSI-REFERENCE
114600         PERFORM FAIL.
114700 SEQ-TEST-04-01-END.
114800*
114900*    CHECK EXECUTION OF EXTEND DECLARATIVE
115000*
115100     ADD     1 TO REC-CT.
115200     IF DELETE-SW NOT = SPACE
115300         GO TO   SEQ-DELETE-04-02.
115400     GO TO   SEQ-TEST-OP-04-02.
115500 SEQ-DELETE-04-02.
115600     PERFORM DE-LETE.
115700     GO TO   SEQ-TEST-04-02-END.
115800 SEQ-TEST-OP-04-02.
115900     IF DECL-EXEC-E = "NOT EXECUTED"
116000         PERFORM PASS
116100     ELSE
116200         MOVE    DECL-EXEC-E TO COMPUTED-A
116300         MOVE   "NOT EXECUTED" TO CORRECT-A
116400         MOVE   "UNEXPECTED EXECUTION OF EXTEND DECLARATIVE"
116500                   TO RE-MARK
116600         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
116700         PERFORM FAIL.
116800 SEQ-TEST-04-02-END.
116900*
117000*    CHECK EXECUTION OF INPUT DECLARATIVE
117100*
117200     ADD     1 TO REC-CT.
117300     IF DELETE-SW NOT = SPACE
117400         GO TO   SEQ-DELETE-04-03.
117500     GO TO   SEQ-TEST-OP-04-03.
117600 SEQ-DELETE-04-03.
117700     PERFORM DE-LETE.
117800     GO TO   SEQ-TEST-04-03-END.
117900 SEQ-TEST-OP-04-03.
118000     IF DECL-EXEC-I = "NOT EXECUTED"
118100         PERFORM PASS
118200     ELSE
118300         MOVE    DECL-EXEC-I TO COMPUTED-A
118400         MOVE   "NOT EXECUTED" TO CORRECT-A
118500         MOVE   "UNEXPECTED EXECUTION OF INPUT DECLARATIVE"
118600                   TO RE-MARK
118700         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
118800         PERFORM FAIL.
118900 SEQ-TEST-04-03-END.
119000*
119100*    CHECK EXECUTION OF I-O DECLARATIVE
119200*
119300     ADD     1 TO REC-CT.
119400     IF DELETE-SW NOT = SPACE
119500         GO TO   SEQ-DELETE-04-04.
119600     GO TO   SEQ-TEST-OP-04-04.
119700 SEQ-DELETE-04-04.
119800     PERFORM DE-LETE.
119900     GO TO   SEQ-TEST-04-04-END.
120000 SEQ-TEST-OP-04-04.
120100     IF DECL-EXEC-I-O = "NOT EXECUTED"
120200         PERFORM PASS
120300     ELSE
120400         MOVE    DECL-EXEC-I-O TO COMPUTED-A
120500         MOVE   "NOT EXECUTED" TO CORRECT-A
120600         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
120700                   TO RE-MARK
120800         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
120900         PERFORM FAIL.
121000 SEQ-TEST-04-04-END.
121100*
121200*    CHECK EXECUTION OF OUTPUT DECLARATIVE
121300*
121400     ADD     1 TO REC-CT.
121500     IF DELETE-SW NOT = SPACE
121600         GO TO   SEQ-DELETE-04-05.
121700     GO TO   SEQ-TEST-OP-04-05.
121800 SEQ-DELETE-04-05.
121900     PERFORM DE-LETE.
122000     GO TO   SEQ-TEST-04-05-END.
122100 SEQ-TEST-OP-04-05.
122200     IF DECL-EXEC-O = "NOT EXECUTED"
122300         PERFORM PASS
122400     ELSE
122500         MOVE    DECL-EXEC-O TO COMPUTED-A
122600         MOVE   "NOT EXECUTED" TO CORRECT-A
122700         MOVE   "UNEXPECTED EXECUTION OF INPUT DECLARATIVE"
122800                   TO RE-MARK
122900         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
123000         PERFORM FAIL.
123100 SEQ-TEST-04-05-END.
123200*
123300*
123400*    THE FILE IS OPEN FOR INPUT.  WE READ THE ONLY RECORD.
123500*
123600 SEQ-INIT-05.
123700     MOVE    0 TO REC-CT.
123800     MOVE    0 TO DECL-EXEC-CT.
123900     MOVE   "*" TO DECL-EXEC-SW.
124000     ADD     1 TO XRECORD-NUMBER (1).
124100     MOVE   "**" TO SQ-FS4-STATUS.
124200     MOVE   "NOT EXECUTED" TO DECL-EXEC-E.
124300     MOVE   "NOT EXECUTED" TO DECL-EXEC-I.
124400     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
124500     MOVE   "NOT EXECUTED" TO DECL-EXEC-O.
124600     MOVE   "READ FIRST RECORD" TO FEATURE.
124700     MOVE   "SEQ-TEST-RD-05" TO PAR-NAME.
124800     IF DELETE-SW NOT EQUAL TO SPACE
124900         GO TO SEQ-DELETE-05.
125000     GO TO   SEQ-TEST-RD-05.
125100 SEQ-DELETE-05.
125200     MOVE   "*" TO DELETE-SW-2.
125300     GO TO   SEQ-DELETE-05-01.
125400 SEQ-TEST-RD-05.
125500     MOVE    SPACE TO SQ-FS4R1-F-G-120.
125600     READ    SQ-FS4.
125700*
125800*    CHECK I-O STATUS RETURNED FROM READ
125900*
126000     ADD    1 TO REC-CT.
126100     IF DELETE-SW NOT = SPACE
126200         GO TO   SEQ-DELETE-05-01.
126300     GO TO   SEQ-TEST-RD-05-01.
126400 SEQ-DELETE-05-01.
126500     PERFORM DE-LETE.
126600     GO TO   SEQ-TEST-05-01-END.
126700 SEQ-TEST-RD-05-01.
126800     IF SQ-FS4-STATUS = "00"
126900         PERFORM PASS
127000     ELSE
127100         MOVE    SQ-FS4-STATUS TO COMPUTED-A
127200         MOVE   "00" TO CORRECT-A
127300         MOVE   "UNEXPECTED STATUS CODE FROM READ"
127400                   TO RE-MARK
127500         MOVE   "VII-3, VII-44" TO ANSI-REFERENCE
127600         PERFORM FAIL.
127700 SEQ-TEST-05-01-END.
127800*
127900*    CHECK EXECUTION OF EXTEND DECLARATIVE
128000*
128100     ADD     1 TO REC-CT.
128200     IF DELETE-SW NOT = SPACE
128300         GO TO   SEQ-DELETE-05-02.
128400     GO TO   SEQ-TEST-RD-05-02.
128500 SEQ-DELETE-05-02.
128600     PERFORM DE-LETE.
128700     GO TO   SEQ-TEST-05-02-END.
128800 SEQ-TEST-RD-05-02.
128900     IF DECL-EXEC-E = "NOT EXECUTED"
129000         PERFORM PASS
129100     ELSE
129200         MOVE    DECL-EXEC-E TO COMPUTED-A
129300         MOVE   "NOT EXECUTED" TO CORRECT-A
129400         MOVE   "UNEXPECTED EXECUTION OF EXTEND DECLARATIVE"
129500                   TO RE-MARK
129600         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
129700         PERFORM FAIL.
129800 SEQ-TEST-05-02-END.
129900*
130000*    CHECK EXECUTION OF INPUT DECLARATIVE
130100*
130200     ADD     1 TO REC-CT.
130300     IF DELETE-SW NOT = SPACE
130400         GO TO   SEQ-DELETE-05-03.
130500     GO TO   SEQ-TEST-RD-05-03.
130600 SEQ-DELETE-05-03.
130700     PERFORM DE-LETE.
130800     GO TO   SEQ-TEST-05-03-END.
130900 SEQ-TEST-RD-05-03.
131000     IF DECL-EXEC-I = "NOT EXECUTED"
131100         PERFORM PASS
131200     ELSE
131300         MOVE    DECL-EXEC-I TO COMPUTED-A
131400         MOVE   "NOT EXECUTED" TO CORRECT-A
131500         MOVE   "UNEXPECTED EXECUTION OF INPUT DECLARATIVE"
131600                   TO RE-MARK
131700         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
131800         PERFORM FAIL.
131900 SEQ-TEST-05-03-END.
132000*
132100*    CHECK EXECUTION OF I-O DECLARATIVE
132200*
132300     ADD     1 TO REC-CT.
132400     IF DELETE-SW NOT = SPACE
132500         GO TO   SEQ-DELETE-05-04.
132600     GO TO   SEQ-TEST-RD-05-04.
132700 SEQ-DELETE-05-04.
132800     PERFORM DE-LETE.
132900     GO TO   SEQ-TEST-05-04-END.
133000 SEQ-TEST-RD-05-04.
133100     IF DECL-EXEC-I-O = "NOT EXECUTED"
133200         PERFORM PASS
133300     ELSE
133400         MOVE    DECL-EXEC-I-O TO COMPUTED-A
133500         MOVE   "NOT EXECUTED" TO CORRECT-A
133600         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
133700                   TO RE-MARK
133800         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
133900         PERFORM FAIL.
134000 SEQ-TEST-05-04-END.
134100*
134200*    CHECK EXECUTION OF OUTPUT DECLARATIVE
134300*
134400     ADD     1 TO REC-CT.
134500     IF DELETE-SW NOT = SPACE
134600         GO TO   SEQ-DELETE-05-05.
134700     GO TO   SEQ-TEST-RD-05-05.
134800 SEQ-DELETE-05-05.
134900     PERFORM DE-LETE.
135000     GO TO   SEQ-TEST-05-05-END.
135100 SEQ-TEST-RD-05-05.
135200     IF DECL-EXEC-O = "NOT EXECUTED"
135300         PERFORM PASS
135400     ELSE
135500         MOVE    DECL-EXEC-O TO COMPUTED-A
135600         MOVE   "NOT EXECUTED" TO CORRECT-A
135700         MOVE   "UNEXPECTED EXECUTION OF INPUT DECLARATIVE"
135800                   TO RE-MARK
135900         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
136000         PERFORM FAIL.
136100 SEQ-TEST-05-05-END.
136200*
136300*    CHECK THAT THE CORRECT RECORD HAS BEEN RETURNED, BY
136400*    CHECKING THE RECORD-NUMBER FIELD.
136500*
136600     ADD     1 TO REC-CT.
136700     IF DELETE-SW NOT = SPACE
136800         GO TO   SEQ-DELETE-05-06.
136900     GO TO   SEQ-TEST-RD-05-06.
137000 SEQ-DELETE-05-06.
137100     PERFORM DE-LETE.
137200     GO TO   SEQ-TEST-05-06-END.
137300 SEQ-TEST-RD-05-06.
137400     IF FRECORD-NUMBER = XRECORD-NUMBER (1)
137500         PERFORM PASS
137600     ELSE
137700         MOVE    FRECORD-NUMBER TO COMPUTED-18V0
137800         MOVE    XRECORD-NUMBER (1) TO CORRECT-18V0
137900         MOVE   "INCORRECT RECORD NUMBER FOUND" TO RE-MARK
138000         PERFORM FAIL.
138100 SEQ-TEST-05-06-END.
138200     MOVE    SPACE TO DELETE-SW-2.
138300*
138400*
138500*    ANOTHER READ SHOULD CAUSE THE AT END CONDITION.
138600*
138700 SEQ-INIT-06.
138800     MOVE    0 TO REC-CT.
138900     MOVE    0 TO DECL-EXEC-CT.
139000     MOVE   "*" TO DECL-EXEC-SW.
139100     ADD     1 TO XRECORD-NUMBER (1).
139200     MOVE   "**" TO SQ-FS4-STATUS.
139300     MOVE   "NOT EXECUTED" TO DECL-EXEC-E.
139400     MOVE   "NOT EXECUTED" TO DECL-EXEC-I.
139500     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
139600     MOVE   "NOT EXECUTED" TO DECL-EXEC-O.
139700     MOVE   "READ GIVING AT END" TO FEATURE.
139800     MOVE   "SEQ-TEST-RD-06" TO PAR-NAME.
139900     IF DELETE-SW NOT EQUAL TO SPACE
140000         GO TO SEQ-DELETE-06.
140100     GO TO   SEQ-TEST-RD-06.
140200 SEQ-DELETE-06.
140300     MOVE   "*" TO DELETE-SW-2.
140400     GO TO   SEQ-DELETE-06-01.
140500 SEQ-TEST-RD-06.
140600     MOVE    SPACE TO SQ-FS4R1-F-G-120.
140700     READ    SQ-FS4 RECORD.
140800*
140900*    CHECK I-O STATUS RETURNED FROM READ
141000*
141100     ADD    1 TO REC-CT.
141200     IF DELETE-SW NOT = SPACE
141300         GO TO   SEQ-DELETE-06-01.
141400     GO TO   SEQ-TEST-RD-06-01.
141500 SEQ-DELETE-06-01.
141600     PERFORM DE-LETE.
141700     GO TO   SEQ-TEST-06-01-END.
141800 SEQ-TEST-RD-06-01.
141900     IF SQ-FS4-STATUS = "10"
142000         PERFORM PASS
142100     ELSE
142200         MOVE    SQ-FS4-STATUS TO COMPUTED-A
142300         MOVE   "10" TO CORRECT-A
142400         MOVE   "AT END STATUS NOT RETURNED FROM READ"
142500                   TO RE-MARK
142600         MOVE   "VII-3, VII-44" TO ANSI-REFERENCE
142700         PERFORM FAIL.
142800 SEQ-TEST-06-01-END.
142900*
143000*    CHECK EXECUTION OF EXTEND DECLARATIVE
143100*
143200     ADD     1 TO REC-CT.
143300     IF DELETE-SW NOT = SPACE
143400         GO TO   SEQ-DELETE-06-02.
143500     GO TO   SEQ-TEST-RD-06-02.
143600 SEQ-DELETE-06-02.
143700     PERFORM DE-LETE.
143800     GO TO   SEQ-TEST-06-02-END.
143900 SEQ-TEST-RD-06-02.
144000     IF DECL-EXEC-E = "NOT EXECUTED"
144100         PERFORM PASS
144200     ELSE
144300         MOVE    DECL-EXEC-E TO COMPUTED-A
144400         MOVE   "NOT EXECUTED" TO CORRECT-A
144500         MOVE   "UNEXPECTED EXECUTION OF EXTEND DECLARATIVE"
144600                   TO RE-MARK
144700         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
144800         PERFORM FAIL.
144900 SEQ-TEST-06-02-END.
145000*
145100*    CHECK EXECUTION OF INPUT DECLARATIVE
145200*
145300     ADD     1 TO REC-CT.
145400     IF DELETE-SW NOT = SPACE
145500         GO TO   SEQ-DELETE-06-03.
145600     GO TO   SEQ-TEST-RD-06-03.
145700 SEQ-DELETE-06-03.
145800     PERFORM DE-LETE.
145900     GO TO   SEQ-TEST-06-03-END.
146000 SEQ-TEST-RD-06-03.
146100     IF DECL-EXEC-I = "EXECUTED"
146200         PERFORM PASS
146300     ELSE
146400         MOVE    DECL-EXEC-I TO COMPUTED-A
146500         MOVE   "EXECUTED" TO CORRECT-A
146600         MOVE   "INPUT DECLARATIVE NOT EXECUTED AT END OF FILE"
146700                   TO RE-MARK
146800         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
146900         PERFORM FAIL.
147000 SEQ-TEST-06-03-END.
147100*
147200*    CHECK EXECUTION OF I-O DECLARATIVE
147300*
147400     ADD     1 TO REC-CT.
147500     IF DELETE-SW NOT = SPACE
147600         GO TO   SEQ-DELETE-06-04.
147700     GO TO   SEQ-TEST-RD-06-04.
147800 SEQ-DELETE-06-04.
147900     PERFORM DE-LETE.
148000     GO TO   SEQ-TEST-06-04-END.
148100 SEQ-TEST-RD-06-04.
148200     IF DECL-EXEC-I-O = "NOT EXECUTED"
148300         PERFORM PASS
148400     ELSE
148500         MOVE    DECL-EXEC-I-O TO COMPUTED-A
148600         MOVE   "NOT EXECUTED" TO CORRECT-A
148700         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
148800                   TO RE-MARK
148900         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
149000         PERFORM FAIL.
149100 SEQ-TEST-06-04-END.
149200*
149300*    CHECK EXECUTION OF OUTPUT DECLARATIVE
149400*
149500     ADD     1 TO REC-CT.
149600     IF DELETE-SW NOT = SPACE
149700         GO TO   SEQ-DELETE-06-05.
149800     GO TO   SEQ-TEST-RD-06-05.
149900 SEQ-DELETE-06-05.
150000     PERFORM DE-LETE.
150100     GO TO   SEQ-TEST-06-05-END.
150200 SEQ-TEST-RD-06-05.
150300     IF DECL-EXEC-O = "NOT EXECUTED"
150400         PERFORM PASS
150500     ELSE
150600         MOVE    DECL-EXEC-O TO COMPUTED-A
150700         MOVE   "NOT EXECUTED" TO CORRECT-A
150800         MOVE   "UNEXPECTED EXECUTION OF INPUT DECLARATIVE"
150900                   TO RE-MARK
151000         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
151100         PERFORM FAIL.
151200 SEQ-TEST-06-05-END.
151300     MOVE    SPACE TO DELETE-SW-2.
151400*
151500*
151600*    FINALLY, TRY TO OPEN THE FILE AGAIN, IN THE EXTEND MODE
151700*
151800 SEQ-INIT-07.
151900     MOVE    0 TO REC-CT.
152000     MOVE    0 TO DECL-EXEC-CT.
152100     MOVE    SPACE TO DECL-EXEC-SW.
152200     MOVE   "**" TO SQ-FS4-STATUS.
152300     MOVE   "NOT EXECUTED" TO DECL-EXEC-E.
152400     MOVE   "NOT EXECUTED" TO DECL-EXEC-I.
152500     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
152600     MOVE   "NOT EXECUTED" TO DECL-EXEC-O.
152700     MOVE    ZERO TO XRECORD-NUMBER (1).
152800     MOVE   "OPEN FILE SECOND TIME"  TO FEATURE.
152900     MOVE   "SEQ-TEST-OP-07" TO PAR-NAME.
153000     IF DELETE-SW NOT = SPACE
153100         GO TO SEQ-DELETE-07-01.
153200     GO TO   SEQ-TEST-OP-07.
153300 SEQ-DELETE-07.
153400     MOVE   "*" TO DELETE-SW-2.
153500     GO TO   SEQ-DELETE-07-01.
153600 SEQ-TEST-OP-07.
153700     OPEN    EXTEND SQ-FS4.
153800     MOVE    0 TO REC-CT.
153900     MOVE   "OPEN FILE SECOND TIME"  TO FEATURE.
154000     MOVE   "SEQ-TEST-OP-07" TO PAR-NAME.
154100*
154200*    CHECK I-O STATUS RETURNED FROM OPEN EXTEND
154300*
154400     ADD    1 TO REC-CT.
154500     IF DELETE-SW NOT = SPACE
154600         GO TO   SEQ-DELETE-07-01.
154700     GO TO   SEQ-TEST-OP-07-01.
154800 SEQ-DELETE-07-01.
154900     PERFORM DE-LETE.
155000     GO TO   SEQ-TEST-07-01-END.
155100 SEQ-TEST-OP-07-01.
155200     IF SQ-FS4-STATUS = "41"
155300         PERFORM PASS
155400     ELSE
155500         MOVE    SQ-FS4-STATUS TO COMPUTED-A
155600         MOVE   "41" TO CORRECT-A
155700         MOVE   "UNEXPECTED STATUS CODE FROM SECOND OPEN"
155800                   TO RE-MARK
155900         MOVE   "VII-4,1.5.3(4)A, VII-40" TO ANSI-REFERENCE
156000         PERFORM FAIL.
156100 SEQ-TEST-07-01-END.
156200*
156300*    CHECK EXECUTION OF EXTEND AND INPUT DECLARATIVES
156400*
156500     ADD     1 TO REC-CT.
156600     IF DELETE-SW NOT = SPACE
156700         GO TO   SEQ-DELETE-07-02.
156800     GO TO   SEQ-TEST-OP-07-02.
156900 SEQ-DELETE-07-02.
157000     PERFORM DE-LETE.
157100     GO TO   SEQ-TEST-07-02-END.
157200 SEQ-TEST-OP-07-02.
157300     IF DECL-EXEC-E = "EXECUTED" OR DECL-EXEC-I = "EXECUTED"
157400         PERFORM PASS
157500     ELSE
157600         MOVE   "DECL NOT EXECUTED" TO COMPUTED-A
157700         MOVE   "EXECUTED" TO CORRECT-A
157800         MOVE   "EXECUTION OF ONE DECLARATIVE EXPECTED"
157900                   TO RE-MARK
158000         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
158100         PERFORM FAIL.
158200 SEQ-TEST-07-02-END.
158300*
158400*    CHECK NUMBER OF DECLARATIVES EXECUTED
158500*
158600     ADD     1 TO REC-CT.
158700     IF DELETE-SW NOT = SPACE
158800         GO TO   SEQ-DELETE-07-03.
158900     GO TO   SEQ-TEST-OP-07-03.
159000 SEQ-DELETE-07-03.
159100     PERFORM DE-LETE.
159200     GO TO   SEQ-TEST-07-03-END.
159300 SEQ-TEST-OP-07-03.
159400     IF DECL-EXEC-CT = 1
159500         PERFORM PASS
159600     ELSE
159700         MOVE    DECL-EXEC-CT  TO COMPUTED-18V0
159800         MOVE    1 TO CORRECT-18V0
159900         MOVE   "ONLY ONE EXECUTION OF A DECLARATIVE EXPECTED"
160000                   TO RE-MARK
160100         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
160200         PERFORM FAIL.
160300 SEQ-TEST-07-03-END.
160400*
160500*    CHECK EXECUTION OF I-O DECLARATIVE
160600*
160700     ADD     1 TO REC-CT.
160800     IF DELETE-SW NOT = SPACE
160900         GO TO   SEQ-DELETE-07-04.
161000     GO TO   SEQ-TEST-OP-07-04.
161100 SEQ-DELETE-07-04.
161200     PERFORM DE-LETE.
161300     GO TO   SEQ-TEST-07-04-END.
161400 SEQ-TEST-OP-07-04.
161500     IF DECL-EXEC-I-O = "NOT EXECUTED"
161600         PERFORM PASS
161700     ELSE
161800         MOVE    DECL-EXEC-I-O TO COMPUTED-A
161900         MOVE   "NOT EXECUTED" TO CORRECT-A
162000         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
162100                   TO RE-MARK
162200         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
162300         PERFORM FAIL.
162400 SEQ-TEST-07-04-END.
162500*
162600*    CHECK EXECUTION OF OUTPUT DECLARATIVE
162700*
162800     ADD     1 TO REC-CT.
162900     IF DELETE-SW NOT = SPACE
163000         GO TO   SEQ-DELETE-07-05.
163100     GO TO   SEQ-TEST-OP-07-05.
163200 SEQ-DELETE-07-05.
163300     PERFORM DE-LETE.
163400     GO TO   SEQ-TEST-07-05-END.
163500 SEQ-TEST-OP-07-05.
163600     IF DECL-EXEC-O = "NOT EXECUTED"
163700         PERFORM PASS
163800     ELSE
163900         MOVE    DECL-EXEC-O TO COMPUTED-A
164000         MOVE   "NOT EXECUTED" TO CORRECT-A
164100         MOVE   "UNEXPECTED EXECUTION OF INPUT DECLARATIVE"
164200                   TO RE-MARK
164300         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
164400         PERFORM FAIL.
164500 SEQ-TEST-07-05-END.
164600*
164700*
164800 CCVS-EXIT SECTION.
164900 CCVS-999999.
165000     GO TO   CLOSE-FILES.
