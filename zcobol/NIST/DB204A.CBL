000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     DB204A.
000400 AUTHOR.
000500     FEDERAL COMPILER TESTING CENTER.
000600 INSTALLATION.
000700     GENERAL SERVICES ADMINISTRATION
000800     AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
000900     SOFTWARE DEVELOPMENT OFFICE.
001000     5203 LEESBURG PIKE  SUITE 1100
001100     FALLS CHURCH VIRGINIA 22041.
001200
001300     PHONE   (703) 756-6153
001400
001500     " HIGH       ".
001600 DATE-WRITTEN.
001700     CCVS-74 VERSION 4.0 - 1980 JULY 1.
001800     CREATION DATE     /    VALIDATION DATE
001900     "4.2 ".
002000 SECURITY.
002100     NONE.
002200*
002300*    *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
002400*
002500*                       PROGRAM ABSTRACT
002600*
002700*    DB204A TESTS THE CAPABILITY OF THE DEBUG MODULE TO HANDLE A
002800*    DEBUGGING PROCEDURE WHICH IS MONITORING A "MERGE OUTPUT"
002900*    PROCEDURE.  THIS PROGRAM IS TO BE COMPILED AND EXECUTED
003000*    WITH BOTH COMPILE AND OBJECT TIME DEBUGGING SWITCHES ON.
003100*    THE DEBUGGING PROCEDURE SHOULD BE INCLUDED IN COMPILATION
003200*    AND GENERATE CODE.  DURING EXECUTION, TWO SEQUENTIAL FILES
003300*    ARE CREATED WITH EACH CONTAINING 80-CHARACTER RECORDS IN
003400*    SORTED ORDER.  THE TWO FILES ARE THEN MERGED.  EXECUTION
003500*    OF THE MERGE OPERATION SHOULD TRIGGER THE DEBUGGING PRO-
003600*    CEDURE LINKED TO THE MERGE OUTPUT PROCEDURE-NAME.
003700*
003800*
003900*
004000 ENVIRONMENT DIVISION.
004100 CONFIGURATION SECTION.
004200 SOURCE-COMPUTER.
004300     XXXXX082
004400         WITH DEBUGGING MODE.
004500 OBJECT-COMPUTER.
004600     XXXXX083.
004700 INPUT-OUTPUT SECTION.
004800 FILE-CONTROL.
004900     SELECT PRINT-FILE ASSIGN TO
005000     XXXXX055.
005100     SELECT SQ-FS1 ASSIGN TO
005200     XXXXX014.
005300     SELECT SQ-FS2  ASSIGN TO
005400     XXXXX015.
005500     SELECT SQ-FS3  ASSIGN TO
005600     XXXXX016.
005700     SELECT ST-FS4  ASSIGN TO
005800     XXXXX027.
005900 DATA DIVISION.
006000 FILE SECTION.
006100 FD  PRINT-FILE
006200     LABEL RECORDS
006300     XXXXX084
006400     DATA RECORD IS PRINT-REC DUMMY-RECORD.
006500 01  PRINT-REC PICTURE X(120).
006600 01  DUMMY-RECORD PICTURE X(120).
006700 FD  SQ-FS1
006800C    VALUE OF
006900C    XXXXX074
007000*      XXXXX074  REPLACE WITH IMPLEMENTOR NAME (*OPT C ONLY)
007100C    IS
007200C    XXXXX075
007300*      XXXXX075  REPLACE WITH VALUE CLAUSE OBJECT (*OPT C ONLY)
007400G    XXXXX069
007500*      XXXXX069  REPLACE WITH ADDITIONAL INFO (*OPT G ONLY)
007600     LABEL RECORDS ARE STANDARD.
007700 01  REC-1 PIC X(120).
007800 FD  SQ-FS2
007900C    VALUE OF
008000C    XXXXX074
008100*      XXXXX074  REPLACE WITH IMPLEMENTOR NAME (*OPT C ONLY)
008200C    IS
008300C    XXXXX076
008400*      XXXXX076  REPLACE WITH VALUE CLAUSE OBJECT (*OPT C ONLY)
008500G    XXXXX069
008600*      XXXXX069  REPLACE WITH ADDITIONAL INFO (*OPT G ONLY)
008700     LABEL RECORDS ARE STANDARD.
008800 01  REC-2 PIC X(120).
008900 FD  SQ-FS3
009000C    VALUE OF
009100C    XXXXX074
009200*      XXXXX074  REPLACE WITH IMPLEMENTOR NAME (*OPT C ONLY)
009300C    IS
009400C    XXXXX077
009500*      XXXXX077  REPLACE WITH VALUE CLAUSE OBJECT (*OPT C ONLY)
009600G    XXXXX069
009700*      XXXXX069  REPLACE WITH ADDITIONAL INFO (*OPT G ONLY)
009800     LABEL RECORDS ARE STANDARD.
009900 01  REC-3 PIC X(120).
010000 SD  ST-FS4.
010100 01  REC-4.
010200     02  FILLER PIC X(34).
010300     02  SORT-KEY PIC X(6).
010400     02  FILLER PIC X(80).
010500 WORKING-STORAGE SECTION.
010600 01  ITEM-1.
010700     02  KEY-1 PIC 99.
010800     02  LINE-1 PIC X(6).
010900     02  NAME-1 PIC X(30).
011000     02  UNQUAL-NAME-1 PIC X(30).
011100     02  CONTENTS-1 PIC X(30).
011200 01  FILE-RECORD-INFORMATION-REC.
011300     03 FILE-RECORD-INFO-SKELETON.
011400        05 FILLER                 PICTURE X(48)       VALUE
011500             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
011600        05 FILLER                 PICTURE X(46)       VALUE
011700             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
011800        05 FILLER                 PICTURE X(26)       VALUE
011900             ",LFIL=000000,ORG=  ,LBLR= ".
012000        05 FILLER                 PICTURE X(37)       VALUE
012100             ",RECKEY=                             ".
012200        05 FILLER                 PICTURE X(38)       VALUE
012300             ",ALTKEY1=                             ".
012400        05 FILLER                 PICTURE X(38)       VALUE
012500             ",ALTKEY2=                             ".
012600        05 FILLER                 PICTURE X(7)        VALUE SPACE.
012700     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
012800        05 FILE-RECORD-INFO-P1-120.
012900           07 FILLER              PIC X(5).
013000           07 XFILE-NAME           PIC X(6).
013100           07 FILLER              PIC X(8).
013200           07 XRECORD-NAME         PIC X(6).
013300           07 FILLER              PIC X(1).
013400           07 REELUNIT-NUMBER     PIC 9(1).
013500           07 FILLER              PIC X(7).
013600           07 XRECORD-NUMBER       PIC 9(6).
013700           07 FILLER              PIC X(6).
013800           07 UPDATE-NUMBER       PIC 9(2).
013900           07 FILLER              PIC X(5).
014000           07 ODO-NUMBER          PIC 9(4).
014100           07 FILLER              PIC X(5).
014200           07 XPROGRAM-NAME        PIC X(5).
014300           07 FILLER              PIC X(7).
014400           07 XRECORD-LENGTH       PIC 9(6).
014500           07 FILLER              PIC X(7).
014600           07 CHARS-OR-RECORDS    PIC X(2).
014700           07 FILLER              PIC X(1).
014800           07 XBLOCK-SIZE          PIC 9(4).
014900           07 FILLER              PIC X(6).
015000           07 RECORDS-IN-FILE     PIC 9(6).
015100           07 FILLER              PIC X(5).
015200           07 XFILE-ORGANIZATION   PIC X(2).
015300           07 FILLER              PIC X(6).
015400           07 XLABEL-TYPE          PIC X(1).
015500        05 FILE-RECORD-INFO-P121-240.
015600           07 FILLER              PIC X(8).
015700           07 XRECORD-KEY          PIC X(29).
015800           07 FILLER              PIC X(9).
015900           07 ALTERNATE-KEY1      PIC X(29).
016000           07 FILLER              PIC X(9).
016100           07 ALTERNATE-KEY2      PIC X(29).
016200           07 FILLER              PIC X(7).
016300 01  TEST-RESULTS.
016400     02 FILLER                    PICTURE X VALUE SPACE.
016500     02 FEATURE                   PICTURE X(20) VALUE SPACE.
016600     02 FILLER                    PICTURE X VALUE SPACE.
016700     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
016800     02 FILLER                    PICTURE X  VALUE SPACE.
016900     02  PAR-NAME.
017000       03 FILLER PICTURE X(12) VALUE SPACE.
017100       03  PARDOT-X PICTURE X  VALUE SPACE.
017200       03 DOTVALUE PICTURE 99  VALUE ZERO.
017300       03 FILLER PIC X(5) VALUE SPACE.
017400     02 FILLER PIC X(10) VALUE SPACE.
017500     02 RE-MARK PIC X(61).
017600 01  TEST-COMPUTED.
017700     02 FILLER PIC X(30) VALUE SPACE.
017800     02 FILLER PIC X(17) VALUE "       COMPUTED=".
017900     02 COMPUTED-X.
018000     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
018100     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
018200     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
018300     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
018400     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
018500     03       CM-18V0 REDEFINES COMPUTED-A.
018600         04 COMPUTED-18V0                   PICTURE -9(18).
018700         04 FILLER                          PICTURE X.
018800     03 FILLER PIC X(50) VALUE SPACE.
018900 01  TEST-CORRECT.
019000     02 FILLER PIC X(30) VALUE SPACE.
019100     02 FILLER PIC X(17) VALUE "       CORRECT =".
019200     02 CORRECT-X.
019300     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
019400     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
019500     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
019600     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
019700     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
019800     03      CR-18V0 REDEFINES CORRECT-A.
019900         04 CORRECT-18V0                    PICTURE -9(18).
020000         04 FILLER                          PICTURE X.
020100     03 FILLER PIC X(50) VALUE SPACE.
020200 01  CCVS-C-1.
020300     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
020400-    "SS  PARAGRAPH-NAME
020500-    "        REMARKS".
020600     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
020700 01  CCVS-C-2.
020800     02 FILLER PICTURE IS X VALUE IS SPACE.
020900     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
021000     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
021100     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
021200     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
021300 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
021400 01  REC-CT PICTURE 99 VALUE ZERO.
021500 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
021600 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
021700 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
021800 01  PASS-COUNTER PIC 999 VALUE ZERO.
021900 01  TOTAL-ERROR PIC 999 VALUE ZERO.
022000 01  ERROR-HOLD PIC 999 VALUE ZERO.
022100 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
022200 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
022300 01  CCVS-H-1.
022400     02  FILLER   PICTURE X(27)  VALUE SPACE.
022500     02 FILLER PICTURE X(67) VALUE
022600     " FEDERAL COMPILER TESTING CENTER COBOL COMPILER VALIDATION
022700-    " SYSTEM".
022800     02  FILLER     PICTURE X(26)  VALUE SPACE.
022900 01  CCVS-H-2.
023000     02 FILLER PICTURE X(52) VALUE IS
023100     "CCVS74 NCC  COPY, NOT FOR DISTRIBUTION.".
023200     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
023300     02 TEST-ID PICTURE IS X(9).
023400     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
023500 01  CCVS-H-3.
023600     02  FILLER PICTURE X(34) VALUE
023700     " FOR OFFICIAL USE ONLY    ".
023800     02  FILLER PICTURE X(58) VALUE
023900     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
024000     02  FILLER PICTURE X(28) VALUE
024100     "  COPYRIGHT   1974 ".
024200 01  CCVS-E-1.
024300     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
024400     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
024500     02 ID-AGAIN PICTURE IS X(9).
024600     02 FILLER PICTURE X(45) VALUE IS
024700     " NTIS DISTRIBUTION COBOL 74".
024800 01  CCVS-E-2.
024900     02  FILLER                   PICTURE X(31)  VALUE
025000     SPACE.
025100     02  FILLER                   PICTURE X(21)  VALUE SPACE.
025200     02 CCVS-E-2-2.
025300         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
025400         03 FILLER PICTURE IS X VALUE IS SPACE.
025500         03 ENDER-DESC PIC X(44) VALUE "ERRORS ENCOUNTERED".
025600 01  CCVS-E-3.
025700     02  FILLER PICTURE X(22) VALUE
025800     " FOR OFFICIAL USE ONLY".
025900     02  FILLER PICTURE X(12) VALUE SPACE.
026000     02  FILLER PICTURE X(58) VALUE
026100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
026200     02  FILLER PICTURE X(13) VALUE SPACE.
026300     02 FILLER PIC X(15) VALUE " COPYRIGHT 1974".
026400 01  CCVS-E-4.
026500     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
026600     02 FILLER PIC XXXX VALUE " OF ".
026700     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
026800     02 FILLER PIC X(40) VALUE
026900      "  TESTS WERE EXECUTED SUCCESSFULLY".
027000 01  XXINFO.
027100     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
027200     02 INFO-TEXT.
027300     04 FILLER PIC X(20) VALUE SPACE.
027400     04 XXCOMPUTED PIC X(20).
027500     04 FILLER PIC X(5) VALUE SPACE.
027600     04 XXCORRECT PIC X(20).
027700 01  HYPHEN-LINE.
027800     02 FILLER PICTURE IS X VALUE IS SPACE.
027900     02 FILLER PICTURE IS X(65) VALUE IS "************************
028000-    "*****************************************".
028100     02 FILLER PICTURE IS X(54) VALUE IS "************************
028200-    "******************************".
028300 01  CCVS-PGM-ID PIC X(6) VALUE
028400     "DB204A".
028500 PROCEDURE DIVISION.
028600 DECLARATIVES.
028700 MERGE-PROC SECTION.
028800     USE FOR DEBUGGING ON MERGE-OUTPUT-PROC.
028900 MERGE-1.
029000     ADD 1 TO KEY-1.
029100     MOVE DEBUG-LINE TO LINE-1.
029200     MOVE DEBUG-NAME TO NAME-1  UNQUAL-NAME-1.
029300     MOVE DEBUG-CONTENTS TO CONTENTS-1.
029400     INSPECT UNQUAL-NAME-1 REPLACING CHARACTERS BY SPACES
029500         AFTER INITIAL SPACE.
029600 END DECLARATIVES.
029700 CCVS1 SECTION.
029800 OPEN-FILES.
029900     OPEN     OUTPUT PRINT-FILE.
030000     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
030100     MOVE    SPACE TO TEST-RESULTS.
030200     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
030300     GO TO CCVS1-EXIT.
030400 CLOSE-FILES.
030500     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
030600 TERMINATE-CCVS.
030700S    EXIT PROGRAM.
030800STERMINATE-CALL.
030900     STOP     RUN.
031000 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
031100 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
031200 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
031300 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
031400     MOVE "****TEST DELETED****" TO RE-MARK.
031500 PRINT-DETAIL.
031600     IF REC-CT NOT EQUAL TO ZERO
031700             MOVE "." TO PARDOT-X
031800             MOVE REC-CT TO DOTVALUE.
031900     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
032000     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
032100        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
032200          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
032300     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
032400     MOVE SPACE TO CORRECT-X.
032500     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
032600     MOVE     SPACE TO RE-MARK.
032700 HEAD-ROUTINE.
032800     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032900     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033000     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
033100 COLUMN-NAMES-ROUTINE.
033200     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033300     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
033500 END-ROUTINE.
033600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033700 END-RTN-EXIT.
033800     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033900 END-ROUTINE-1.
034000      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
034100      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
034200      ADD PASS-COUNTER TO ERROR-HOLD.
034300*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
034400      MOVE PASS-COUNTER TO CCVS-E-4-1.
034500      MOVE ERROR-HOLD TO CCVS-E-4-2.
034600      MOVE CCVS-E-4 TO CCVS-E-2-2.
034700      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
034800  END-ROUTINE-12.
034900      MOVE "TEST(S) FAILED" TO ENDER-DESC.
035000     IF       ERROR-COUNTER IS EQUAL TO ZERO
035100         MOVE "NO " TO ERROR-TOTAL
035200         ELSE
035300         MOVE ERROR-COUNTER TO ERROR-TOTAL.
035400     MOVE     CCVS-E-2 TO DUMMY-RECORD.
035500     PERFORM WRITE-LINE.
035600 END-ROUTINE-13.
035700     IF DELETE-CNT IS EQUAL TO ZERO
035800         MOVE "NO " TO ERROR-TOTAL  ELSE
035900         MOVE DELETE-CNT TO ERROR-TOTAL.
036000     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
036100     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036200      IF   INSPECT-COUNTER EQUAL TO ZERO
036300          MOVE "NO " TO ERROR-TOTAL
036400      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
036500      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
036600      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036700     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036800 WRITE-LINE.
036900     ADD 1 TO RECORD-COUNT.
037000Y    IF RECORD-COUNT GREATER 50
037100Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
037200Y        MOVE SPACE TO DUMMY-RECORD
037300Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
037400Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
037500Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
037600Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
037700Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
037800Y        MOVE ZERO TO RECORD-COUNT.
037900     PERFORM WRT-LN.
038000 WRT-LN.
038100     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
038200     MOVE SPACE TO DUMMY-RECORD.
038300 BLANK-LINE-PRINT.
038400     PERFORM WRT-LN.
038500 FAIL-ROUTINE.
038600     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
038700     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
038800     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
038900     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039000     GO TO FAIL-ROUTINE-EX.
039100 FAIL-ROUTINE-WRITE.
039200     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
039300     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
039400 FAIL-ROUTINE-EX. EXIT.
039500 BAIL-OUT.
039600     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
039700     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
039800 BAIL-OUT-WRITE.
039900     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
040000     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040100 BAIL-OUT-EX. EXIT.
040200 CCVS1-EXIT.
040300     EXIT.
040400 CREATE-INPUT-FILES SECTION.
040500 SET-UP-REC-AREAS.
040600     MOVE FILE-RECORD-INFO-SKELETON TO FILE-RECORD-INFO (1)
040700                                       FILE-RECORD-INFO (2).
040800     MOVE "SQ-FS1" TO XFILE-NAME (1).
040900     MOVE "SQ-FS2" TO XFILE-NAME (2).
041000     MOVE "REC-1" TO XRECORD-NAME (1).
041100     MOVE "REC-2" TO XRECORD-NAME (2).
041200     MOVE ".XXX." TO XPROGRAM-NAME (1)
041300                     XPROGRAM-NAME (2).
041400     MOVE 120 TO XRECORD-LENGTH (1)
041500                 XRECORD-LENGTH (2).
041600     MOVE "RC" TO CHARS-OR-RECORDS (1)
041700                  CHARS-OR-RECORDS (2).
041800     MOVE 1 TO XBLOCK-SIZE (1)
041900               XBLOCK-SIZE (2).
042000     MOVE 10 TO RECORDS-IN-FILE (1)
042100                RECORDS-IN-FILE (2).
042200     MOVE "SQ" TO XFILE-ORGANIZATION (1)
042300                  XFILE-ORGANIZATION (2).
042400     MOVE "S" TO XLABEL-TYPE (1)
042500                 XLABEL-TYPE (2).
042600     OPEN OUTPUT SQ-FS1  SQ-FS2.
042700 WRITE-FILES.
042800     MOVE 1 TO XRECORD-NUMBER (1).
042900     MOVE 2 TO XRECORD-NUMBER (2).
043000     PERFORM WRITE-FILES-SUBROUTINE 10 TIMES.
043100     CLOSE SQ-FS1  SQ-FS2.
043200      GO TO BEGIN-DB204A-TESTS.
043300 WRITE-FILES-SUBROUTINE.
043400     MOVE FILE-RECORD-INFO (1) TO REC-1.
043500     WRITE REC-1.
043600     ADD 2 TO XRECORD-NUMBER (1).
043700     MOVE FILE-RECORD-INFO (2) TO REC-2.
043800     WRITE REC-2.
043900     ADD 2 TO XRECORD-NUMBER (2).
044000 BEGIN-DB204A-TESTS SECTION.
044100 MERGE-TEST-INIT.
044200     MOVE "MERGE-TEST" TO PAR-NAME.
044300     MOVE "MERGE OUTPUT PROC" TO FEATURE.
044400     MOVE SPACES TO ITEM-1.
044500     MOVE 0 TO KEY-1.
044600******************************************************************
044700*    THE DEBUG-LINE (INSPT) TEST NAMED IN THE OUTPUT REPORT AS   *
044800*    "MERGE-TEST-A" SHOULD POINT TO THE EXECUTABLE STATEMENT     *
044900*    WHICH FOLLOWS THIS COMMENT SET AND WHICH READS, "MERGE      *
045000*    ST-FS4  ON ASCENDING KEY SORT-KEY  USING SQ-FS1 SQ-FS2      *
045100*    OUTPUT PROCEDURE IS MERGE-OUTPUT-PROC.".                    *
045200******************************************************************
045300 MERGE-TEST.
045400     MERGE ST-FS4  ON ASCENDING KEY SORT-KEY
045500         USING  SQ-FS1  SQ-FS2
045600         OUTPUT PROCEDURE IS MERGE-OUTPUT-PROC.
045700     IF KEY-1 IS EQUAL TO 1
045800         PERFORM PASS
045900         MOVE "DEBUG PROC WAS EXECUTED" TO RE-MARK
046000     ELSE  PERFORM FAIL
046100         MOVE "NO. TIMES DEBUG PROC EXECUTED" TO RE-MARK
046200         MOVE 1 TO CORRECT-18V0
046300         MOVE KEY-1 TO COMPUTED-18V0.
046400     PERFORM PRINT-DETAIL
046500     IF KEY-1 IS EQUAL TO 0
046600         PERFORM DELETE-MERGE-TEST-SUBTESTS
046700         GO TO END-OF-DB204A
046800     ELSE GO TO MERGE-TEST-A.
046900 MERGE-TEST-DELETE.
047000     PERFORM DE-LETE.
047100     PERFORM PRINT-DETAIL.
047200     PERFORM DELETE-MERGE-TEST-SUBTESTS.
047300     GO TO END-OF-DB204A.
047400 DELETE-MERGE-TEST-SUBTESTS.
047500     MOVE "MERGE-TEST-A" TO PAR-NAME.
047600     PERFORM DE-LETE.
047700     PERFORM PRINT-DETAIL.
047800     MOVE "MERGE-TEST-B" TO PAR-NAME.
047900     PERFORM DE-LETE.
048000     PERFORM PRINT-DETAIL.
048100     MOVE "MERGE-TEST-C" TO PAR-NAME.
048200     PERFORM DE-LETE.
048300     PERFORM PRINT-DETAIL.
048400 MERGE-TEST-A.
048500     MOVE "MERGE-TEST-A" TO PAR-NAME.
048600     MOVE "DEBUG-LINE; SEE NEXT LINE" TO RE-MARK.
048700     MOVE "<===  DEBUG-LINE" TO CORRECT-A.
048800     MOVE LINE-1 TO COMPUTED-A.
048900     PERFORM INSPT.
049000     PERFORM PRINT-DETAIL.
049100 MERGE-TEST-B.
049200     MOVE "MERGE-TEST-B" TO PAR-NAME.
049300     IF UNQUAL-NAME-1 IS EQUAL TO "MERGE-OUTPUT-PROC"
049400         PERFORM PASS
049500     ELSE  PERFORM FAIL
049600         MOVE "MERGE-OUTPUT-PROC" TO CORRECT-A
049700         MOVE NAME-1 TO COMPUTED-A.
049800     MOVE "DEBUG-NAME" TO RE-MARK
049900     PERFORM PRINT-DETAIL.
050000 MERGE-TEST-C.
050100     MOVE "MERGE-TEST-C" TO PAR-NAME.
050200     IF CONTENTS-1 IS EQUAL TO "MERGE OUTPUT"
050300         PERFORM PASS
050400     ELSE  PERFORM FAIL
050500         MOVE "MERGE OUTPUT" TO CORRECT-A
050600         MOVE CONTENTS-1 TO COMPUTED-A.
050700     MOVE "DEBUG-CONTENTS" TO RE-MARK.
050800     PERFORM PRINT-DETAIL.
050900     GO TO END-OF-DB204A.
051000 MERGE-OUTPUT-PROC SECTION.
051100 OPEN-OUTPUT-FILE.
051200     OPEN OUTPUT SQ-FS3.
051300 RETURN-RECORDS.
051400     RETURN ST-FS4 RECORD INTO REC-3
051500         AT END GO TO CLOSE-OUTPUT-FILE.
051600     WRITE REC-3.
051700     GO TO RETURN-RECORDS.
051800 CLOSE-OUTPUT-FILE.
051900     CLOSE SQ-FS3.
052000 END-OF-DB204A SECTION.
052100XDUMP-SQ-FS1.
052200X    OPEN INPUT SQ-FS1.
052300X    MOVE "DUMP OF SQ-FS1 FOLLOWS:" TO PRINT-REC.
052400X    PERFORM WRITE-LINE.
052500XREAD-SQ-FS1.
052600X    READ SQ-FS1  AT END GO TO DUMP-SQ-FS2.
052700X    MOVE REC-1 TO PRINT-REC.
052800X    PERFORM WRITE-LINE.
052900X    GO TO READ-SQ-FS1.
053000XDUMP-SQ-FS2.
053100X    CLOSE SQ-FS1.
053200X    OPEN INPUT SQ-FS2.
053300X    MOVE "DUMP OF SQ-FS2 FOLLOWS:" TO PRINT-REC.
053400X    PERFORM WRITE-LINE.
053500XREAD-SQ-FS2.
053600X    READ SQ-FS2 AT END GO TO DUMP-SQ-FS3.
053700X    MOVE REC-2 TO PRINT-REC.
053800X    PERFORM WRITE-LINE.
053900X    GO TO READ-SQ-FS2.
054000XDUMP-SQ-FS3.
054100X    CLOSE SQ-FS2.
054200X    OPEN INPUT SQ-FS3.
054300X    MOVE "DUMP OF SQ-FS3 FOLLOWS:" TO PRINT-REC.
054400X    PERFORM WRITE-LINE.
054500XREAD-SQ-FS3.
054600X    READ SQ-FS3 AT END GO TO END-OF-TESTS.
054700X    MOVE REC-3 TO PRINT-REC.
054800X    PERFORM WRITE-LINE.
054900X    GO TO READ-SQ-FS3.
055000 END-OF-TESTS.
055100     EXIT.
055200 CCVS-EXIT SECTION.
055300 CCVS-999999.
055400     GO TO CLOSE-FILES.
