000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IF105A.
000400
000500***********************************************************
000600*                                                         *
000700* This program forms part of the CCVS85 COBOL Test Suite. *
000800* It contains tests for the Intrinsic Function CHAR.      *
000900*                                                         *
001000*                                                         *
001100***********************************************************
001200 ENVIRONMENT DIVISION.
001300 CONFIGURATION SECTION.
001400 SOURCE-COMPUTER.
001500     XXXXX082.
001600 OBJECT-COMPUTER.
001700     XXXXX083
001800     PROGRAM COLLATING SEQUENCE IS PRG-COLL-SEQ.
001900 SPECIAL-NAMES.
002000     ALPHABET PRG-COLL-SEQ IS
002100     STANDARD-2.
002200 INPUT-OUTPUT SECTION.
002300 FILE-CONTROL.
002400     SELECT PRINT-FILE ASSIGN TO
002500     XXXXX055.
002600 DATA DIVISION.
002700 FILE SECTION.
002800 FD  PRINT-FILE.
002900 01  PRINT-REC PICTURE X(120).
003000 01  DUMMY-RECORD PICTURE X(120).
003100 WORKING-STORAGE SECTION.
003200***********************************************************
003300* Variables specific to the Intrinsic Function Test IF105A*
003400***********************************************************
003500 01  B                   PIC S9(10)     VALUE 37.
003600 01  C                   PIC S9(10)     VALUE 2.
003700 01  D                   PIC S9(10)     VALUE 100.
003800 01  ARR                 VALUE "066037100070044".
003900     02 IND OCCURS 5 TIMES PIC 9(3).
004000 01  TEMP                PIC S9(5)V9(5).
004100 01  WS-ANUM          PIC X.
004200*
004300**********************************************************
004400*
004500 01  TEST-RESULTS.
004600     02 FILLER                   PIC X      VALUE SPACE.
004700     02 FEATURE                  PIC X(20)  VALUE SPACE.
004800     02 FILLER                   PIC X      VALUE SPACE.
004900     02 P-OR-F                   PIC X(5)   VALUE SPACE.
005000     02 FILLER                   PIC X      VALUE SPACE.
005100     02  PAR-NAME.
005200       03 FILLER                 PIC X(19)  VALUE SPACE.
005300       03  PARDOT-X              PIC X      VALUE SPACE.
005400       03 DOTVALUE               PIC 99     VALUE ZERO.
005500     02 FILLER                   PIC X(8)   VALUE SPACE.
005600     02 RE-MARK                  PIC X(61).
005700 01  TEST-COMPUTED.
005800     02 FILLER                   PIC X(30)  VALUE SPACE.
005900     02 FILLER                   PIC X(17)  VALUE
006000            "       COMPUTED=".
006100     02 COMPUTED-X.
006200     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
006300     03 COMPUTED-N               REDEFINES COMPUTED-A
006400                                 PIC -9(9).9(9).
006500     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
006600     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
006700     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
006800     03       CM-18V0 REDEFINES COMPUTED-A.
006900         04 COMPUTED-18V0                    PIC -9(18).
007000         04 FILLER                           PIC X.
007100     03 FILLER PIC X(50) VALUE SPACE.
007200 01  TEST-CORRECT.
007300     02 FILLER PIC X(30) VALUE SPACE.
007400     02 FILLER PIC X(17) VALUE "       CORRECT =".
007500     02 CORRECT-X.
007600     03 CORRECT-A                  PIC X(20) VALUE SPACE.
007700     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
007800     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
007900     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
008000     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
008100     03      CR-18V0 REDEFINES CORRECT-A.
008200         04 CORRECT-18V0                     PIC -9(18).
008300         04 FILLER                           PIC X.
008400     03 FILLER PIC X(2) VALUE SPACE.
008500     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
008600 01  TEST-CORRECT-MIN.
008700     02 FILLER PIC X(30) VALUE SPACE.
008800     02 FILLER PIC X(17) VALUE "     MIN VALUE =".
008900     02 CORRECTMI-X.
009000     03 CORRECTMI-A                 PIC X(20) VALUE SPACE.
009100     03 CORRECT-MIN    REDEFINES CORRECTMI-A     PIC -9(9).9(9).
009200     03 CORRECTMI-0V18 REDEFINES CORRECTMI-A     PIC -.9(18).
009300     03 CORRECTMI-4V14 REDEFINES CORRECTMI-A     PIC -9(4).9(14).
009400     03 CORRECTMI-14V4 REDEFINES CORRECTMI-A     PIC -9(14).9(4).
009500     03      CR-18V0 REDEFINES CORRECTMI-A.
009600         04 CORRECTMI-18V0                     PIC -9(18).
009700         04 FILLER                           PIC X.
009800     03 FILLER PIC X(2) VALUE SPACE.
009900     03 FILLER                           PIC X(48) VALUE SPACE.
010000 01  TEST-CORRECT-MAX.
010100     02 FILLER PIC X(30) VALUE SPACE.
010200     02 FILLER PIC X(17) VALUE "     MAX VALUE =".
010300     02 CORRECTMA-X.
010400     03 CORRECTMA-A                  PIC X(20) VALUE SPACE.
010500     03 CORRECT-MAX    REDEFINES CORRECTMA-A     PIC -9(9).9(9).
010600     03 CORRECTMA-0V18 REDEFINES CORRECTMA-A     PIC -.9(18).
010700     03 CORRECTMA-4V14 REDEFINES CORRECTMA-A     PIC -9(4).9(14).
010800     03 CORRECTMA-14V4 REDEFINES CORRECTMA-A     PIC -9(14).9(4).
010900     03      CR-18V0 REDEFINES CORRECTMA-A.
011000         04 CORRECTMA-18V0                     PIC -9(18).
011100         04 FILLER                           PIC X.
011200     03 FILLER PIC X(2) VALUE SPACE.
011300     03 CORMA-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
011400 01  CCVS-C-1.
011500     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
011600-    "SS  PARAGRAPH-NAME
011700-    "       REMARKS".
011800     02 FILLER                     PIC X(20)    VALUE SPACE.
011900 01  CCVS-C-2.
012000     02 FILLER                     PIC X        VALUE SPACE.
012100     02 FILLER                     PIC X(6)     VALUE "TESTED".
012200     02 FILLER                     PIC X(15)    VALUE SPACE.
012300     02 FILLER                     PIC X(4)     VALUE "FAIL".
012400     02 FILLER                     PIC X(94)    VALUE SPACE.
012500 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
012600 01  REC-CT                        PIC 99       VALUE ZERO.
012700 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
012800 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
012900 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
013000 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
013100 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
013200 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
013300 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
013400 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
013500 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
013600 01  CCVS-H-1.
013700     02  FILLER                    PIC X(39)    VALUE SPACES.
013800     02  FILLER                    PIC X(42)    VALUE
013900     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
014000     02  FILLER                    PIC X(39)    VALUE SPACES.
014100 01  CCVS-H-2A.
014200   02  FILLER                        PIC X(40)  VALUE SPACE.
014300   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
014400   02  FILLER                        PIC XXXX   VALUE
014500     "4.2 ".
014600   02  FILLER                        PIC X(28)  VALUE
014700            " COPY - NOT FOR DISTRIBUTION".
014800   02  FILLER                        PIC X(41)  VALUE SPACE.
014900
015000 01  CCVS-H-2B.
015100   02  FILLER                        PIC X(15)  VALUE
015200            "TEST RESULT OF ".
015300   02  TEST-ID                       PIC X(9).
015400   02  FILLER                        PIC X(4)   VALUE
015500            " IN ".
015600   02  FILLER                        PIC X(12)  VALUE
015700     " HIGH       ".
015800   02  FILLER                        PIC X(22)  VALUE
015900            " LEVEL VALIDATION FOR ".
016000   02  FILLER                        PIC X(58)  VALUE
016100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
016200 01  CCVS-H-3.
016300     02  FILLER                      PIC X(34)  VALUE
016400            " FOR OFFICIAL USE ONLY    ".
016500     02  FILLER                      PIC X(58)  VALUE
016600     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
016700     02  FILLER                      PIC X(28)  VALUE
016800            "  COPYRIGHT   1985 ".
016900 01  CCVS-E-1.
017000     02 FILLER                       PIC X(52)  VALUE SPACE.
017100     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
017200     02 ID-AGAIN                     PIC X(9).
017300     02 FILLER                       PIC X(45)  VALUE SPACES.
017400 01  CCVS-E-2.
017500     02  FILLER                      PIC X(31)  VALUE SPACE.
017600     02  FILLER                      PIC X(21)  VALUE SPACE.
017700     02 CCVS-E-2-2.
017800         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
017900         03 FILLER                   PIC X      VALUE SPACE.
018000         03 ENDER-DESC               PIC X(44)  VALUE
018100            "ERRORS ENCOUNTERED".
018200 01  CCVS-E-3.
018300     02  FILLER                      PIC X(22)  VALUE
018400            " FOR OFFICIAL USE ONLY".
018500     02  FILLER                      PIC X(12)  VALUE SPACE.
018600     02  FILLER                      PIC X(58)  VALUE
018700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
018800     02  FILLER                      PIC X(13)  VALUE SPACE.
018900     02 FILLER                       PIC X(15)  VALUE
019000             " COPYRIGHT 1985".
019100 01  CCVS-E-4.
019200     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
019300     02 FILLER                       PIC X(4)   VALUE " OF ".
019400     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
019500     02 FILLER                       PIC X(40)  VALUE
019600      "  TESTS WERE EXECUTED SUCCESSFULLY".
019700 01  XXINFO.
019800     02 FILLER                       PIC X(19)  VALUE
019900            "*** INFORMATION ***".
020000     02 INFO-TEXT.
020100       04 FILLER                     PIC X(8)   VALUE SPACE.
020200       04 XXCOMPUTED                 PIC X(20).
020300       04 FILLER                     PIC X(5)   VALUE SPACE.
020400       04 XXCORRECT                  PIC X(20).
020500     02 INF-ANSI-REFERENCE           PIC X(48).
020600 01  HYPHEN-LINE.
020700     02 FILLER  PIC IS X VALUE IS SPACE.
020800     02 FILLER  PIC IS X(65)    VALUE IS "************************
020900-    "*****************************************".
021000     02 FILLER  PIC IS X(54)    VALUE IS "************************
021100-    "******************************".
021200 01  CCVS-PGM-ID                     PIC X(9)   VALUE
021300     "IF105A".
021400 PROCEDURE DIVISION.
021500 CCVS1 SECTION.
021600 OPEN-FILES.
021700     OPEN     OUTPUT PRINT-FILE.
021800     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
021900     MOVE    SPACE TO TEST-RESULTS.
022000     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
022100     GO TO CCVS1-EXIT.
022200 CLOSE-FILES.
022300     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
022400 TERMINATE-CCVS.
022500     STOP     RUN.
022600 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
022700 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
022800 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
022900 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
023000     MOVE "****TEST DELETED****" TO RE-MARK.
023100 PRINT-DETAIL.
023200     IF REC-CT NOT EQUAL TO ZERO
023300             MOVE "." TO PARDOT-X
023400             MOVE REC-CT TO DOTVALUE.
023500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
023600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
023700        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
023800          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
023900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
024000     MOVE SPACE TO CORRECT-X.
024100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
024200     MOVE     SPACE TO RE-MARK.
024300 HEAD-ROUTINE.
024400     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024500     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024600     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
024700     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
024800 COLUMN-NAMES-ROUTINE.
024900     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025000     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
025200 END-ROUTINE.
025300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
025400 END-RTN-EXIT.
025500     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025600 END-ROUTINE-1.
025700      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
025800      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
025900      ADD PASS-COUNTER TO ERROR-HOLD.
026000      MOVE PASS-COUNTER TO CCVS-E-4-1.
026100      MOVE ERROR-HOLD TO CCVS-E-4-2.
026200      MOVE CCVS-E-4 TO CCVS-E-2-2.
026300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
026400  END-ROUTINE-12.
026500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
026600     IF       ERROR-COUNTER IS EQUAL TO ZERO
026700         MOVE "NO " TO ERROR-TOTAL
026800         ELSE
026900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
027000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
027100     PERFORM WRITE-LINE.
027200 END-ROUTINE-13.
027300     IF DELETE-COUNTER IS EQUAL TO ZERO
027400         MOVE "NO " TO ERROR-TOTAL  ELSE
027500         MOVE DELETE-COUNTER TO ERROR-TOTAL.
027600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
027700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027800      IF   INSPECT-COUNTER EQUAL TO ZERO
027900          MOVE "NO " TO ERROR-TOTAL
028000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
028100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
028200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028400 WRITE-LINE.
028500     ADD 1 TO RECORD-COUNT.
028600Y    IF RECORD-COUNT GREATER 42
028700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
028800Y        MOVE SPACE TO DUMMY-RECORD
028900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
029000Y        MOVE CCVS-H-1  TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
029100Y        MOVE CCVS-H-2A TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
029200Y        MOVE CCVS-H-2B TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
029300Y        MOVE CCVS-H-3  TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
029400Y        MOVE CCVS-C-1  TO DUMMY-RECORD  PERFORM WRT-LN
029500Y        MOVE CCVS-C-2  TO DUMMY-RECORD  PERFORM WRT-LN
029600Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
029700Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
029800Y        MOVE ZERO TO RECORD-COUNT.
029900     PERFORM WRT-LN.
030000 WRT-LN.
030100     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
030200     MOVE SPACE TO DUMMY-RECORD.
030300 BLANK-LINE-PRINT.
030400     PERFORM WRT-LN.
030500 FAIL-ROUTINE.
030600     IF     COMPUTED-X NOT EQUAL TO SPACE
030700            GO TO FAIL-ROUTINE-WRITE.
030800     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
030900     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
031000     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
031100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031200     MOVE   SPACES TO INF-ANSI-REFERENCE.
031300     GO TO  FAIL-ROUTINE-EX.
031400 FAIL-ROUTINE-WRITE.
031500     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE.
031600     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE
031700                              CORMA-ANSI-REFERENCE.
031800     IF CORRECT-MIN NOT EQUAL TO SPACES THEN
031900           MOVE TEST-CORRECT-MIN TO PRINT-REC PERFORM WRITE-LINE
032000           MOVE TEST-CORRECT-MAX TO PRINT-REC PERFORM WRITE-LINE
032100     ELSE
032200           MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE.
032300     PERFORM WRITE-LINE.
032400     MOVE   SPACES TO COR-ANSI-REFERENCE.
032500 FAIL-ROUTINE-EX. EXIT.
032600 BAIL-OUT.
032700     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
032800     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
032900 BAIL-OUT-WRITE.
033000     MOVE CORRECT-A TO XXCORRECT.
033100     MOVE COMPUTED-A TO XXCOMPUTED.
033200     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
033300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033400     MOVE   SPACES TO INF-ANSI-REFERENCE.
033500 BAIL-OUT-EX. EXIT.
033600 CCVS1-EXIT.
033700     EXIT.
033800********************************************************
033900*                                                      *
034000*    Intrinsic Function Tests         IF105A - CHAR    *
034100*                                                      *
034200********************************************************
034300 SECT-IF105A SECTION.
034400 F-CHAR-INFO.
034500     MOVE     "See ref. A-37 2.9" TO ANSI-REFERENCE.
034600     MOVE     "CHAR Function" TO FEATURE.
034700*****************TEST (a) ******************************
034800 F-CHAR-01.
034900     MOVE SPACE TO WS-ANUM.
035000 F-CHAR-TEST-01.
035100     MOVE FUNCTION CHAR(37) TO WS-ANUM.
035200     IF WS-ANUM = "$" THEN
035300                        PERFORM PASS
035400     ELSE
035500                        MOVE  "$"  TO CORRECT-X
035600                        MOVE WS-ANUM TO COMPUTED-A
035700                        PERFORM FAIL.
035800     GO TO F-CHAR-WRITE-01.
035900 F-CHAR-DELETE-01.
036000     PERFORM  DE-LETE.
036100     GO TO    F-CHAR-WRITE-01.
036200 F-CHAR-WRITE-01.
036300     MOVE "F-CHAR-01" TO PAR-NAME.
036400     PERFORM  PRINT-DETAIL.
036500*****************TEST (b) ******************************
036600 F-CHAR-TEST-02.
036700     IF FUNCTION CHAR(B) = "$" THEN
036800                                 PERFORM PASS
036900     ELSE
037000                                 PERFORM FAIL.
037100     GO TO F-CHAR-WRITE-02.
037200 F-CHAR-DELETE-02.
037300     PERFORM  DE-LETE.
037400     GO TO    F-CHAR-WRITE-02.
037500 F-CHAR-WRITE-02.
037600     MOVE "F-CHAR-02" TO PAR-NAME.
037700     PERFORM  PRINT-DETAIL.
037800*****************TEST (c) ******************************
037900 F-CHAR-03.
038000     MOVE SPACE TO WS-ANUM.
038100 F-CHAR-TEST-03.
038200     MOVE FUNCTION CHAR(IND(5)) TO WS-ANUM.
038300     IF WS-ANUM = "+" THEN
038400                        PERFORM PASS
038500     ELSE
038600                        MOVE  "+"  TO CORRECT-X
038700                        MOVE WS-ANUM TO COMPUTED-A
038800                        PERFORM FAIL.
038900     GO TO F-CHAR-WRITE-03.
039000 F-CHAR-DELETE-03.
039100     PERFORM  DE-LETE.
039200     GO TO    F-CHAR-WRITE-03.
039300 F-CHAR-WRITE-03.
039400     MOVE "F-CHAR-03" TO PAR-NAME.
039500     PERFORM  PRINT-DETAIL.
039600*****************TEST (d) ******************************
039700 F-CHAR-04.
039800     MOVE SPACE TO WS-ANUM.
039900 F-CHAR-TEST-04.
040000     MOVE FUNCTION CHAR(IND(C)) TO WS-ANUM.
040100     IF WS-ANUM = "$" THEN
040200                        PERFORM PASS
040300     ELSE
040400                        MOVE  "$"  TO CORRECT-X
040500                        MOVE WS-ANUM TO COMPUTED-A
040600                        PERFORM FAIL.
040700     GO TO F-CHAR-WRITE-04.
040800 F-CHAR-DELETE-04.
040900     PERFORM  DE-LETE.
041000     GO TO    F-CHAR-WRITE-04.
041100 F-CHAR-WRITE-04.
041200     MOVE "F-CHAR-04" TO PAR-NAME.
041300     PERFORM  PRINT-DETAIL.
041400*****************TEST (e) ******************************
041500 F-CHAR-05.
041600     MOVE SPACE TO WS-ANUM.
041700 F-CHAR-TEST-05.
041800     MOVE FUNCTION CHAR(87) TO WS-ANUM.
041900     IF WS-ANUM = "V" THEN
042000                        PERFORM PASS
042100     ELSE
042200                        MOVE  "V"  TO CORRECT-X
042300                        MOVE WS-ANUM TO COMPUTED-A
042400                        PERFORM FAIL.
042500     GO TO F-CHAR-WRITE-05.
042600 F-CHAR-DELETE-05.
042700     PERFORM  DE-LETE.
042800     GO TO    F-CHAR-WRITE-05.
042900 F-CHAR-WRITE-05.
043000     MOVE "F-CHAR-05" TO PAR-NAME.
043100     PERFORM  PRINT-DETAIL.
043200*****************TEST (f) ******************************
043300 F-CHAR-06.
043400     MOVE SPACE TO WS-ANUM.
043500 F-CHAR-TEST-06.
043600     MOVE FUNCTION CHAR(D) TO WS-ANUM.
043700     IF WS-ANUM = "c" THEN
043800                        PERFORM PASS
043900     ELSE
044000                        MOVE  "c"  TO CORRECT-X
044100                        MOVE WS-ANUM TO COMPUTED-A
044200                        PERFORM FAIL.
044300     GO TO F-CHAR-WRITE-06.
044400 F-CHAR-DELETE-06.
044500     PERFORM  DE-LETE.
044600     GO TO    F-CHAR-WRITE-06.
044700 F-CHAR-WRITE-06.
044800     MOVE "F-CHAR-06" TO PAR-NAME.
044900     PERFORM  PRINT-DETAIL.
045000*****************TEST (g) ******************************
045100 F-CHAR-07.
045200     MOVE SPACE TO WS-ANUM.
045300 F-CHAR-TEST-07.
045400
045500     IF FUNCTION ORD(FUNCTION CHAR(2)) = 2 THEN
045600                        PERFORM PASS
045700     ELSE
045800                        MOVE  2  TO CORRECT-N
045900                        MOVE WS-ANUM TO COMPUTED-A
046000                        PERFORM FAIL.
046100     GO TO F-CHAR-WRITE-07.
046200 F-CHAR-DELETE-07.
046300     PERFORM  DE-LETE.
046400     GO TO    F-CHAR-WRITE-07.
046500 F-CHAR-WRITE-07.
046600     MOVE "F-CHAR-07" TO PAR-NAME.
046700     PERFORM  PRINT-DETAIL.
046800*****************TEST (h) ******************************
046900 F-CHAR-08.
047000     MOVE SPACE TO WS-ANUM.
047100 F-CHAR-TEST-08.
047200     IF FUNCTION ORD(FUNCTION CHAR(4)) +
047300        FUNCTION ORD(FUNCTION CHAR(7)) = 11 THEN
047400                        PERFORM PASS
047500     ELSE
047600                        PERFORM FAIL.
047700     GO TO F-CHAR-WRITE-08.
047800 F-CHAR-DELETE-08.
047900     PERFORM  DE-LETE.
048000     GO TO    F-CHAR-WRITE-08.
048100 F-CHAR-WRITE-08.
048200     MOVE "F-CHAR-08" TO PAR-NAME.
048300     PERFORM  PRINT-DETAIL.
048400*******************END OF TESTS**************************
048500 CCVS-EXIT SECTION.
048600 CCVS-999999.
048700     GO TO CLOSE-FILES.
