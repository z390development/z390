000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ222A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200*        THIS ROUTINE CHECKS:
001300*
001400*           RECORD    VARYING.
001500*
001600*        THIS ROUTINE BUILDS A SEQUENTIAL MASS STORAGE FILE
001700*    WHICH CONTAINS BOTH 120 CHARACTER AND 151 CHARACTER
001800*    RECORDS.  THE MASS STORAGE FILE CONSISTS OF 1 SHORT,
001900*    1 LONG, 10 SHORT, 100 LONG, AND 338 SHORT RECORDS FOR
002000*    A TOTAL OF 450 RECORDS IN THE FILE.  THE MASS STORAGE
002100*    FILE IS READ AND FIELDS IN THE RECORDS ARE CHECKED
002200*    AGAINST THE EXPECTED VALUES.
002300*
002400*        AN INFORMATION SECTION AT THE END OF THE ROUTINE
002500*    CHECKS THE FIELD WHICH CONTAINS THE XRECORD-NUMBER.
002600*    THIS FIELD IS PART OF A LONG RECORD ONLY.  IF THE
002700*    XRECORD-NUMBER IS THERE FOR A SHORT RECORD, IT MEANS
002800*    THE MAXIMUM SIZE RECORD IS ALWAYS WRITTEN.
002900 ENVIRONMENT DIVISION.
003000 CONFIGURATION SECTION.
003100 SOURCE-COMPUTER.
003200     XXXXX082.
003300 OBJECT-COMPUTER.
003400     XXXXX083.
003500 INPUT-OUTPUT SECTION.
003600 FILE-CONTROL.
003700P    SELECT RAW-DATA   ASSIGN TO
003800P    XXXXX062
003900P           ORGANIZATION IS INDEXED
004000P           ACCESS MODE IS RANDOM
004100P           RECORD KEY IS RAW-DATA-KEY.
004200     SELECT PRINT-FILE ASSIGN TO
004300     XXXXX055.
004400     SELECT SQ-VS7 ASSIGN TO
004500     XXXXX014
004600     ORGANIZATION SEQUENTIAL
004700     ACCESS SEQUENTIAL.
004800 DATA DIVISION.
004900 FILE SECTION.
005000P
005100PFD  RAW-DATA.
005200P
005300P01  RAW-DATA-SATZ.
005400P    05  RAW-DATA-KEY        PIC X(6).
005500P    05  C-DATE              PIC 9(6).
005600P    05  C-TIME              PIC 9(8).
005700P    05  C-NO-OF-TESTS       PIC 99.
005800P    05  C-OK                PIC 999.
005900P    05  C-ALL               PIC 999.
006000P    05  C-FAIL              PIC 999.
006100P    05  C-DELETED           PIC 999.
006200P    05  C-INSPECT           PIC 999.
006300P    05  C-NOTE              PIC X(13).
006400P    05  C-INDENT            PIC X.
006500P    05  C-ABORT             PIC X(8).
006600 FD  PRINT-FILE
006700C    LABEL RECORDS
006800C    XXXXX084
006900C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007000               .
007100 01  PRINT-REC PICTURE X(120).
007200 01  DUMMY-RECORD PICTURE X(120).
007300 FD  SQ-VS7
007400C    LABEL RECORDS ARE STANDARD
007500     RECORD    VARYING.
007600 01  SQ-VS7R1-M-G-120.
007700     02  SQ-VS7R1-FIRST PICTURE X(120).
007800 01  SQ-VS7R2-M-G-151.
007900     02  SQ-VS7R2-FIRST PICTURE X(120).
008000     02  LONG-OR-SHORT  PICTURE X(5).
008100     02  SQ-VS7-RECNO  PICTURE X(5).
008200     02  SQ-VS7-FILLER  PICTURE X(21).
008300 WORKING-STORAGE SECTION.
008400 01  SAVE-COUNT-OF-RECS  PICTURE X(5) VALUE SPACE.
008500 01  COUNT-OF-RECS  PICTURE S9(5) COMPUTATIONAL.
008600 01  RECORDS-IN-ERROR  PICTURE S9(5) COMPUTATIONAL.
008700 01  ERROR-FLAG PICTURE 9.
008800 01  EOF-FLAG  PICTURE 9.
008900 01  DUMP-AREA.
009000     02  TYPE-OF-REC PICTURE X(5).
009100     02  RECNO  PICTURE 9(5).
009200     02  REC-FILLER PICTURE X(21).
009300 01  FILE-RECORD-INFORMATION-REC.
009400     03 FILE-RECORD-INFO-SKELETON.
009500        05 FILLER                 PICTURE X(48)       VALUE
009600             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
009700        05 FILLER                 PICTURE X(46)       VALUE
009800             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
009900        05 FILLER                 PICTURE X(26)       VALUE
010000             ",LFIL=000000,ORG=  ,LBLR= ".
010100        05 FILLER                 PICTURE X(37)       VALUE
010200             ",RECKEY=                             ".
010300        05 FILLER                 PICTURE X(38)       VALUE
010400             ",ALTKEY1=                             ".
010500        05 FILLER                 PICTURE X(38)       VALUE
010600             ",ALTKEY2=                             ".
010700        05 FILLER                 PICTURE X(7)        VALUE SPACE.
010800     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
010900        05 FILE-RECORD-INFO-P1-120.
011000           07 FILLER              PIC X(5).
011100           07 XFILE-NAME           PIC X(6).
011200           07 FILLER              PIC X(8).
011300           07 XRECORD-NAME         PIC X(6).
011400           07 FILLER              PIC X(1).
011500           07 REELUNIT-NUMBER     PIC 9(1).
011600           07 FILLER              PIC X(7).
011700           07 XRECORD-NUMBER       PIC 9(6).
011800           07 FILLER              PIC X(6).
011900           07 UPDATE-NUMBER       PIC 9(2).
012000           07 FILLER              PIC X(5).
012100           07 ODO-NUMBER          PIC 9(4).
012200           07 FILLER              PIC X(5).
012300           07 XPROGRAM-NAME        PIC X(5).
012400           07 FILLER              PIC X(7).
012500           07 XRECORD-LENGTH       PIC 9(6).
012600           07 FILLER              PIC X(7).
012700           07 CHARS-OR-RECORDS    PIC X(2).
012800           07 FILLER              PIC X(1).
012900           07 XBLOCK-SIZE          PIC 9(4).
013000           07 FILLER              PIC X(6).
013100           07 RECORDS-IN-FILE     PIC 9(6).
013200           07 FILLER              PIC X(5).
013300           07 XFILE-ORGANIZATION   PIC X(2).
013400           07 FILLER              PIC X(6).
013500           07 XLABEL-TYPE          PIC X(1).
013600        05 FILE-RECORD-INFO-P121-240.
013700           07 FILLER              PIC X(8).
013800           07 XRECORD-KEY          PIC X(29).
013900           07 FILLER              PIC X(9).
014000           07 ALTERNATE-KEY1      PIC X(29).
014100           07 FILLER              PIC X(9).
014200           07 ALTERNATE-KEY2      PIC X(29).
014300           07 FILLER              PIC X(7).
014400 01  TEST-RESULTS.
014500     02 FILLER                    PICTURE X VALUE SPACE.
014600     02 FEATURE                   PICTURE X(20) VALUE SPACE.
014700     02 FILLER                    PICTURE X VALUE SPACE.
014800     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
014900     02 FILLER                    PICTURE X  VALUE SPACE.
015000     02  PAR-NAME.
015100       03 FILLER PICTURE X(12) VALUE SPACE.
015200       03  PARDOT-X PICTURE X  VALUE SPACE.
015300       03 DOTVALUE PICTURE 99  VALUE ZERO.
015400       03 FILLER PIC X(5) VALUE SPACE.
015500     02 FILLER PIC X(10) VALUE SPACE.
015600     02 RE-MARK PIC X(61).
015700 01  TEST-COMPUTED.
015800     02 FILLER PIC X(30) VALUE SPACE.
015900     02 FILLER PIC X(17) VALUE "       COMPUTED=".
016000     02 COMPUTED-X.
016100     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
016200     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
016300     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
016400     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
016500     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
016600     03       CM-18V0 REDEFINES COMPUTED-A.
016700         04 COMPUTED-18V0                   PICTURE -9(18).
016800         04 FILLER                          PICTURE X.
016900     03 FILLER PIC X(50) VALUE SPACE.
017000 01  TEST-CORRECT.
017100     02 FILLER PIC X(30) VALUE SPACE.
017200     02 FILLER PIC X(17) VALUE "       CORRECT =".
017300     02 CORRECT-X.
017400     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
017500     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
017600     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
017700     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
017800     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
017900     03      CR-18V0 REDEFINES CORRECT-A.
018000         04 CORRECT-18V0                    PICTURE -9(18).
018100         04 FILLER                          PICTURE X.
018200     03 FILLER PIC X(50) VALUE SPACE.
018300 01  CCVS-C-1.
018400     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
018500-    "SS  PARAGRAPH-NAME
018600-    "        REMARKS".
018700     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
018800 01  CCVS-C-2.
018900     02 FILLER PICTURE IS X VALUE IS SPACE.
019000     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
019100     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
019200     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
019300     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
019400 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
019500 01  REC-CT PICTURE 99 VALUE ZERO.
019600 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
019700 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
019800 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
019900 01  PASS-COUNTER PIC 999 VALUE ZERO.
020000 01  TOTAL-ERROR PIC 999 VALUE ZERO.
020100 01  ERROR-HOLD PIC 999 VALUE ZERO.
020200 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
020300 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
020400 01  CCVS-H-1.
020500     02  FILLER   PICTURE X(27)  VALUE SPACE.
020600     02 FILLER PICTURE X(67) VALUE
020700     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
020800-    " SYSTEM".
020900     02  FILLER     PICTURE X(26)  VALUE SPACE.
021000 01  CCVS-H-2.
021100     02 FILLER PICTURE X(52) VALUE IS
021200     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
021300     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
021400     02 TEST-ID PICTURE IS X(9).
021500     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
021600 01  CCVS-H-3.
021700     02  FILLER PICTURE X(34) VALUE
021800     " FOR OFFICIAL USE ONLY    ".
021900     02  FILLER PICTURE X(58) VALUE
022000     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022100     02  FILLER PICTURE X(28) VALUE
022200     "  COPYRIGHT   1985 ".
022300 01  CCVS-E-1.
022400     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
022500     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
022600     02 ID-AGAIN PICTURE IS X(9).
022700     02 FILLER PICTURE X(45) VALUE IS
022800     " NTIS DISTRIBUTION COBOL 85".
022900 01  CCVS-E-2.
023000     02  FILLER                   PICTURE X(31)  VALUE
023100     SPACE.
023200     02  FILLER                   PICTURE X(21)  VALUE SPACE.
023300     02 CCVS-E-2-2.
023400         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
023500         03 FILLER PICTURE IS X VALUE IS SPACE.
023600         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
023700 01  CCVS-E-3.
023800     02  FILLER PICTURE X(22) VALUE
023900     " FOR OFFICIAL USE ONLY".
024000     02  FILLER PICTURE X(12) VALUE SPACE.
024100     02  FILLER PICTURE X(58) VALUE
024200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024300     02  FILLER PICTURE X(13) VALUE SPACE.
024400     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
024500 01  CCVS-E-4.
024600     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
024700     02 FILLER PIC XXXX VALUE " OF ".
024800     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
024900     02 FILLER PIC X(40) VALUE
025000      "  TESTS WERE EXECUTED SUCCESSFULLY".
025100 01  XXINFO.
025200     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
025300     02 INFO-TEXT.
025400     04 FILLER PIC X(20) VALUE SPACE.
025500     04 XXCOMPUTED PIC X(20).
025600     04 FILLER PIC X(5) VALUE SPACE.
025700     04 XXCORRECT PIC X(20).
025800 01  HYPHEN-LINE.
025900     02 FILLER PICTURE IS X VALUE IS SPACE.
026000     02 FILLER PICTURE IS X(65) VALUE IS "************************
026100-    "*****************************************".
026200     02 FILLER PICTURE IS X(54) VALUE IS "************************
026300-    "******************************".
026400 01  CCVS-PGM-ID PIC X(6) VALUE
026500     "SQ222A".
026600 PROCEDURE DIVISION.
026700 CCVS1 SECTION.
026800 OPEN-FILES.
026900P    OPEN I-O RAW-DATA.
027000P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
027100P    READ RAW-DATA INVALID KEY GO TO END-E-1.
027200P    MOVE "ABORTED " TO C-ABORT.
027300P    ADD 1 TO C-NO-OF-TESTS.
027400P    ACCEPT C-DATE  FROM DATE.
027500P    ACCEPT C-TIME  FROM TIME.
027600P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
027700PEND-E-1.
027800P    CLOSE RAW-DATA.
027900     OPEN     OUTPUT PRINT-FILE.
028000     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
028100     MOVE    SPACE TO TEST-RESULTS.
028200     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
028300     MOVE ZERO TO REC-SKL-SUB.
028400     PERFORM CCVS-INIT-FILE 9 TIMES.
028500 CCVS-INIT-FILE.
028600     ADD 1 TO REC-SKL-SUB.
028700     MOVE FILE-RECORD-INFO-SKELETON TO
028800                  FILE-RECORD-INFO (REC-SKL-SUB).
028900 CCVS-INIT-EXIT.
029000     GO TO CCVS1-EXIT.
029100 CLOSE-FILES.
029200     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
029300P    OPEN I-O RAW-DATA.
029400P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
029500P    READ RAW-DATA INVALID KEY GO TO END-E-2.
029600P    MOVE "OK.     " TO C-ABORT.
029700P    MOVE PASS-COUNTER TO C-OK.
029800P    MOVE ERROR-HOLD   TO C-ALL.
029900P    MOVE ERROR-COUNTER TO C-FAIL.
030000P    MOVE DELETE-CNT TO C-DELETED.
030100P    MOVE INSPECT-COUNTER TO C-INSPECT.
030200P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
030300PEND-E-2.
030400P    CLOSE RAW-DATA.
030500 TERMINATE-CCVS.
030600S    EXIT PROGRAM.
030700STERMINATE-CALL.
030800     STOP     RUN.
030900 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
031000 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
031100 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
031200 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
031300     MOVE "****TEST DELETED****" TO RE-MARK.
031400 PRINT-DETAIL.
031500     IF REC-CT NOT EQUAL TO ZERO
031600             MOVE "." TO PARDOT-X
031700             MOVE REC-CT TO DOTVALUE.
031800     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
031900     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
032000        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
032100          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
032200     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
032300     MOVE SPACE TO CORRECT-X.
032400     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
032500     MOVE     SPACE TO RE-MARK.
032600 HEAD-ROUTINE.
032700     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032800     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
032900     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
033000 COLUMN-NAMES-ROUTINE.
033100     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033200     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
033400 END-ROUTINE.
033500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033600 END-RTN-EXIT.
033700     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033800 END-ROUTINE-1.
033900      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
034000      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
034100      ADD PASS-COUNTER TO ERROR-HOLD.
034200*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
034300      MOVE PASS-COUNTER TO CCVS-E-4-1.
034400      MOVE ERROR-HOLD TO CCVS-E-4-2.
034500      MOVE CCVS-E-4 TO CCVS-E-2-2.
034600      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
034700  END-ROUTINE-12.
034800      MOVE "TEST(S) FAILED" TO ENDER-DESC.
034900     IF       ERROR-COUNTER IS EQUAL TO ZERO
035000         MOVE "NO " TO ERROR-TOTAL
035100         ELSE
035200         MOVE ERROR-COUNTER TO ERROR-TOTAL.
035300     MOVE     CCVS-E-2 TO DUMMY-RECORD.
035400     PERFORM WRITE-LINE.
035500 END-ROUTINE-13.
035600     IF DELETE-CNT IS EQUAL TO ZERO
035700         MOVE "NO " TO ERROR-TOTAL  ELSE
035800         MOVE DELETE-CNT TO ERROR-TOTAL.
035900     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
036000     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036100      IF   INSPECT-COUNTER EQUAL TO ZERO
036200          MOVE "NO " TO ERROR-TOTAL
036300      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
036400      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
036500      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036600     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036700 WRITE-LINE.
036800     ADD 1 TO RECORD-COUNT.
036900Y    IF RECORD-COUNT GREATER 50
037000Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
037100Y        MOVE SPACE TO DUMMY-RECORD
037200Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
037300Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
037400Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
037500Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
037600Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
037700Y        MOVE ZERO TO RECORD-COUNT.
037800     PERFORM WRT-LN.
037900 WRT-LN.
038000     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
038100     MOVE SPACE TO DUMMY-RECORD.
038200 BLANK-LINE-PRINT.
038300     PERFORM WRT-LN.
038400 FAIL-ROUTINE.
038500     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
038600     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
038700     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
038800     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038900     GO TO FAIL-ROUTINE-EX.
039000 FAIL-ROUTINE-WRITE.
039100     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
039200     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
039300 FAIL-ROUTINE-EX. EXIT.
039400 BAIL-OUT.
039500     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
039600     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
039700 BAIL-OUT-WRITE.
039800     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
039900     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040000 BAIL-OUT-EX. EXIT.
040100 CCVS1-EXIT.
040200     EXIT.
040300 SECT-SQ222A-0001 SECTION.
040400 WRITE-INIT-GF-01.
040500     MOVE "SQ-VS7" TO XFILE-NAME (1).
040600     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
040700     MOVE "RC" TO CHARS-OR-RECORDS (1).
040800     MOVE 0001 TO XBLOCK-SIZE (1).
040900     MOVE 000450 TO RECORDS-IN-FILE (1).
041000     MOVE "SQ" TO XFILE-ORGANIZATION (1).
041100     MOVE "S" TO XLABEL-TYPE (1).
041200     MOVE 000000 TO XRECORD-NUMBER (1).
041300     MOVE ZERO TO COUNT-OF-RECS.
041400     OPEN OUTPUT SQ-VS7.
041500     MOVE "MULTIPLE LENGTH RECS" TO SQ-VS7-FILLER.
041600 WRITE-TEST-GF-01.
041700     PERFORM WRITE-SHORT-REC.
041800     PERFORM WRITE-LONG-REC.
041900     PERFORM WRITE-SHORT-REC 10 TIMES.
042000     PERFORM WRITE-LONG-REC 100 TIMES.
042100     PERFORM WRITE-SHORT-REC 338 TIMES.
042200 WRITE-WRITE-GF-01.
042300     MOVE "CREATE FILE SQ-VS7" TO FEATURE.
042400     MOVE "WRITE-TEST-GF-01" TO PAR-NAME.
042500     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
042600     MOVE COUNT-OF-RECS TO CORRECT-18V0.
042700     MOVE "FILE HAS 120 AND 151 CHAR RECS" TO RE-MARK.
042800     PERFORM PRINT-DETAIL.
042900*        A SEQUENTIAL MASS STORAGE FILE CONTAINING 450
043000*    RECORDS HAS BEEN CREATED.  THE FILE CONTAINS RECORDS
043100*    OF 120 CHARACTERS AND RECORDS OF 151 CHARACTERS.  THE
043200*    SEQUENCE IN WHICH THE RECORDS WERE WRITTEN IS S-L-10S-
043300*    100L-338S.
043400 WRITE-CLOSE-GF-01.
043500     CLOSE SQ-VS7.
043600     GO TO READ-INIT-F1-01.
043700 WRITE-SHORT-REC.
043800     MOVE "R1-M-G" TO XRECORD-NAME (1).
043900     MOVE 000120 TO XRECORD-LENGTH (1).
044000     ADD 1 TO COUNT-OF-RECS.
044100     MOVE COUNT-OF-RECS TO XRECORD-NUMBER (1).
044200     MOVE "SHORT" TO LONG-OR-SHORT.
044300     MOVE COUNT-OF-RECS TO SQ-VS7-RECNO.
044400     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-VS7R1-FIRST.
044500     WRITE SQ-VS7R1-M-G-120.
044600 WRITE-LONG-REC.
044700     MOVE "R2-M-G" TO XRECORD-NAME (1).
044800     MOVE 000151 TO XRECORD-LENGTH (1).
044900     ADD 1 TO COUNT-OF-RECS.
045000     MOVE COUNT-OF-RECS TO XRECORD-NUMBER (1).
045100     MOVE "LONG" TO LONG-OR-SHORT.
045200     MOVE COUNT-OF-RECS TO SQ-VS7-RECNO.
045300     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-VS7R2-FIRST.
045400     WRITE SQ-VS7R2-M-G-151.
045500 READ-INIT-F1-01.
045600     MOVE ZERO TO COUNT-OF-RECS.
045700     MOVE ZERO TO EOF-FLAG.
045800     MOVE ZERO TO RECORDS-IN-ERROR.
045900     MOVE ZERO TO ERROR-FLAG.
046000     OPEN INPUT SQ-VS7.
046100 READ-TEST-F1-01.
046200     PERFORM READ-SHORT-REC THRU READ-SHORT-REC-EXIT.
046300     IF EOF-FLAG EQUAL TO 1
046400         MOVE "EOF ON FIRST READ" TO RE-MARK
046500         GO TO READ-EOF-F1-06.
046600     IF ERROR-FLAG EQUAL TO 1
046700         GO TO READ-FAIL-F1-01.
046800 READ-PASS-F1-01.
046900     PERFORM PASS.
047000     GO TO READ-WRITE-F1-01.
047100 READ-FAIL-F1-01.
047200     MOVE "ERROR: SEE VII-52 WRITE  OR VII-44 READ" TO RE-MARK.
047300     PERFORM FAIL.
047400 READ-WRITE-F1-01.
047500     MOVE "READ SHORT RECORD" TO FEATURE.
047600     MOVE "READ-TEST-F1-01" TO PAR-NAME.
047700     MOVE "EXPECTED RECORD LENGTH: 120" TO RE-MARK.
047800     PERFORM PRINT-DETAIL.
047900     GO TO READ-INIT-F1-02.
048000 READ-SHORT-REC.
048100     IF EOF-FLAG EQUAL TO 1
048200         GO TO READ-SHORT-REC-EXIT.
048300     READ SQ-VS7 AT END
048400         MOVE 1 TO EOF-FLAG
048500         GO TO READ-SHORT-REC-EXIT.
048600     ADD 1 TO COUNT-OF-RECS.
048700     MOVE SQ-VS7R1-FIRST TO FILE-RECORD-INFO-P1-120 (1).
048800     IF XRECORD-NAME (1) NOT EQUAL TO "R1-M-G"
048900         GO TO READ-SHORT-REC-ERROR.
049000     IF XRECORD-LENGTH (1) NOT EQUAL TO 120
049100         GO TO READ-SHORT-REC-ERROR.
049200     IF COUNT-OF-RECS NOT EQUAL TO XRECORD-NUMBER (1)
049300         GO TO READ-SHORT-REC-ERROR.
049400     IF XLABEL-TYPE (1) EQUAL TO "S"
049500         GO TO READ-SHORT-REC-EXIT.
049600 READ-SHORT-REC-ERROR.
049700     ADD 1 TO RECORDS-IN-ERROR.
049800     MOVE 1 TO ERROR-FLAG.
049900 READ-SHORT-REC-EXIT.
050000     EXIT.
050100 READ-INIT-F1-02.
050200     MOVE ZERO TO ERROR-FLAG.
050300 READ-TEST-F1-02.
050400     PERFORM READ-LONG-REC THRU READ-LONG-REC-EXIT.
050500     IF EOF-FLAG EQUAL TO 1
050600         MOVE "EOF ON SECOND READ" TO RE-MARK
050700         GO TO READ-EOF-F1-06.
050800     IF ERROR-FLAG EQUAL TO 1
050900         GO TO READ-FAIL-F1-02.
051000 READ-PASS-F1-02.
051100     PERFORM PASS.
051200     GO TO READ-WRITE-F1-02.
051300 READ-FAIL-F1-02.
051400     MOVE "ERROR: SEE VII-52 WRITE  OR VII-44 READ" TO RE-MARK.
051500     PERFORM FAIL.
051600 READ-WRITE-F1-02.
051700     MOVE "READ LONG RECORD" TO FEATURE.
051800     MOVE "READ-TEST-F1-02" TO PAR-NAME.
051900     MOVE "EXPECTED RECORD LENGTH: 151" TO RE-MARK.
052000     PERFORM PRINT-DETAIL.
052100     GO TO READ-INIT-F1-03.
052200 READ-LONG-REC.
052300     IF EOF-FLAG EQUAL TO 1
052400         GO TO READ-LONG-REC-EXIT.
052500     READ SQ-VS7 END
052600         MOVE 1 TO EOF-FLAG
052700         GO TO READ-LONG-REC-EXIT.
052800     ADD 1 TO COUNT-OF-RECS.
052900     MOVE SQ-VS7R2-FIRST TO FILE-RECORD-INFO-P1-120 (1).
053000     IF XRECORD-NAME (1) NOT EQUAL TO "R2-M-G"
053100         GO TO READ-LONG-REC-ERROR.
053200     IF XRECORD-LENGTH (1) NOT EQUAL TO 151
053300         GO TO READ-LONG-REC-ERROR.
053400     MOVE COUNT-OF-RECS TO SAVE-COUNT-OF-RECS.
053500     IF SAVE-COUNT-OF-RECS NOT EQUAL TO SQ-VS7-RECNO
053600         GO TO READ-LONG-REC-ERROR.
053700     IF LONG-OR-SHORT EQUAL TO "LONG "
053800         GO TO READ-LONG-REC-EXIT.
053900 READ-LONG-REC-ERROR.
054000     ADD 1 TO RECORDS-IN-ERROR.
054100     MOVE 1 TO ERROR-FLAG.
054200 READ-LONG-REC-EXIT.
054300     EXIT.
054400 READ-INIT-F1-03.
054500     MOVE ZERO TO ERROR-FLAG.
054600 READ-TEST-F1-03.
054700     PERFORM READ-SHORT-REC THRU READ-SHORT-REC-EXIT 10 TIMES.
054800     IF EOF-FLAG EQUAL TO 1
054900         MOVE "UNEXPECTED EOF" TO RE-MARK
055000         GO TO READ-EOF-F1-06.
055100     IF ERROR-FLAG EQUAL TO 1
055200         GO TO READ-FAIL-F1-03.
055300 READ-PASS-F1-03.
055400     PERFORM PASS.
055500     GO TO READ-WRITE-F1-03.
055600 READ-FAIL-F1-03.
055700     MOVE "ERROR: SEE VII-52 WRITE  OR VII-44 READ" TO RE-MARK.
055800     PERFORM FAIL.
055900 READ-WRITE-F1-03.
056000     MOVE "READ SHORT RECORDS" TO FEATURE.
056100     MOVE "READ-TEST-F1-03" TO PAR-NAME.
056200     MOVE "EXPECTED RECORD LENGTH: 120" TO RE-MARK.
056300     PERFORM PRINT-DETAIL.
056400 READ-INIT-F1-04.
056500     MOVE ZERO TO ERROR-FLAG.
056600 READ-TEST-F1-04.
056700     PERFORM READ-LONG-REC THRU READ-LONG-REC-EXIT 100 TIMES.
056800     IF EOF-FLAG EQUAL TO 1
056900         MOVE "UNEXPECTED EOF" TO RE-MARK
057000         GO TO READ-EOF-F1-06.
057100     IF ERROR-FLAG EQUAL TO 1
057200         GO TO READ-FAIL-F1-04.
057300 READ-PASS-F1-04.
057400     PERFORM PASS.
057500     GO TO READ-WRITE-F1-04.
057600 READ-FAIL-F1-04.
057700     MOVE "ERROR: SEE VII-52 WRITE  OR VII-44 READ" TO RE-MARK.
057800     PERFORM FAIL.
057900 READ-WRITE-F1-04.
058000     MOVE "READ LONG RECORDS" TO FEATURE.
058100     MOVE "READ-TEST-F1-04" TO PAR-NAME.
058200     MOVE "EXPECTED RECORD LENGTH: 151" TO RE-MARK.
058300     PERFORM PRINT-DETAIL.
058400 READ-INIT-F1-05.
058500     MOVE ZERO TO ERROR-FLAG.
058600 READ-TEST-F1-05.
058700     PERFORM READ-SHORT-REC THRU READ-SHORT-REC-EXIT 338 TIMES.
058800     IF EOF-FLAG EQUAL TO 1
058900         MOVE "UNEXPECTED EOF" TO RE-MARK
059000         GO TO READ-EOF-F1-06.
059100     IF ERROR-FLAG EQUAL TO 1
059200         GO TO READ-FAIL-F1-05.
059300 READ-PASS-F1-05.
059400     PERFORM PASS.
059500     GO TO READ-WRITE-F1-05.
059600 READ-FAIL-F1-05.
059700     MOVE "ERROR: SEE VII-52 WRITE  OR VII-44 READ" TO RE-MARK.
059800     PERFORM FAIL.
059900 READ-WRITE-F1-05.
060000     MOVE "READ SHORT RECORDS" TO FEATURE.
060100     MOVE "READ-TEST-F1-05" TO PAR-NAME.
060200     MOVE "EXPECTED RECORD LENGTH: 120" TO RE-MARK.
060300     PERFORM PRINT-DETAIL.
060400 READ-INIT-F1-06.
060500     READ SQ-VS7 RECORD END
060600         GO TO READ-TEST-F1-06.
060700     MOVE "MORE THAN 450 RECORDS" TO RE-MARK.
060800     GO TO READ-FAIL-F1-06.
060900 READ-EOF-F1-06.
061000     MOVE "RECORDS READ =" TO COMPUTED-A.
061100     MOVE COUNT-OF-RECS TO CORRECT-18V0.
061200     GO TO READ-FAIL-F1-06.
061300 READ-TEST-F1-06.
061400     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
061500         MOVE "RECORDS IN ERROR =" TO COMPUTED-A
061600         MOVE RECORDS-IN-ERROR TO CORRECT-18V0
061700         GO TO READ-FAIL-F1-06.
061800 READ-PASS-F1-06.
061900     PERFORM PASS.
062000     GO TO READ-WRITE-F1-06.
062100 READ-FAIL-F1-06.
062200     PERFORM FAIL.
062300 READ-WRITE-F1-06.
062400     MOVE "READ-TEST-F1-06" TO PAR-NAME.
062500     MOVE "VERIFY FILE SQ-VS7" TO FEATURE.
062600     PERFORM PRINT-DETAIL.
062700 READ-CLOSE-F1-06.
062800     CLOSE SQ-VS7.
062900 SECT-SQ222A-0002 SECTION.
063000*        THIS SECTION CHECKS IF THE ENTIRE RECORD AREA IS
063100*    WRITTEN ON THE MASS STORAGE DEVICE WHEN A SHORT RECORD
063200*    IS WRITTEN.  THE RECORD NUMBER IN CHARACTERS 126 THROUGH
063300*    130 IS UNIQUE FOR EACH RECORD.
063400 INFO-INIT-01.
063500     OPEN INPUT SQ-VS7.
063600     MOVE ZERO TO COUNT-OF-RECS.
063700 INFO-TEST-01.
063800     READ SQ-VS7 AT END
063900         GO TO INFO-END.
064000     ADD 1 TO COUNT-OF-RECS.
064100     IF SQ-VS7-RECNO NOT EQUAL TO "00001"
064200         GO TO NO-INFO-01.
064300     MOVE "MAXIMUM RECORD SIZE WRITTEN" TO RE-MARK.
064400     MOVE "RECORD READ =" TO COMPUTED-A.
064500     MOVE 0001 TO CORRECT-18V0.
064600     GO TO INFO-WRITE-01.
064700 NO-INFO-01.
064800     MOVE "NO DEFINITE CONCLUSION POSSIBLE" TO RE-MARK.
064900 INFO-WRITE-01.
065000     MOVE "READ SHORT RECORD" TO FEATURE.
065100     MOVE "SEQ-INFO-01 " TO PAR-NAME.
065200     PERFORM PRINT-DETAIL.
065300 INFO-INIT-02.
065400     READ SQ-VS7 RECORD AT END
065500         GO TO INFO-END.
065600     READ SQ-VS7 END
065700         GO TO INFO-END.
065800 INFO-TEST-02.
065900     READ SQ-VS7 AT END
066000         GO TO INFO-END.
066100     IF SQ-VS7-RECNO NOT EQUAL TO "00004"
066200         GO TO NO-INFO-02.
066300     MOVE "MAXIMUM RECORD SIZE WRITTEN" TO RE-MARK.
066400     MOVE "RECORD READ =" TO COMPUTED-A.
066500     MOVE 0004 TO CORRECT-18V0.
066600     GO TO INFO-WRITE-02.
066700 NO-INFO-02.
066800     MOVE "NO DEFINITE CONCLUSION POSSIBLE" TO RE-MARK.
066900 INFO-WRITE-02.
067000     MOVE "READ SHORT RECORD" TO FEATURE.
067100     MOVE "SEQ-INFO-02 " TO PAR-NAME.
067200     PERFORM PRINT-DETAIL.
067300 INFO-INIT-03.
067400     ADD 3 TO COUNT-OF-RECS.
067500 INFO-INIT-03-1.
067600     READ SQ-VS7 RECORD
067700         END GO TO INFO-END.
067800     ADD 1 TO COUNT-OF-RECS.
067900     IF COUNT-OF-RECS EQUAL TO 450
068000         GO TO INFO-TEST-03.
068100     GO TO INFO-INIT-03-1.
068200 INFO-TEST-03.
068300     IF SQ-VS7-RECNO NOT EQUAL TO "00450"
068400         GO TO NO-INFO-03.
068500     MOVE "MAXIMUM RECORD SIZE WRITTEN" TO RE-MARK.
068600     MOVE "RECORD READ =" TO COMPUTED-A.
068700     MOVE 0450 TO CORRECT-18V0.
068800     GO TO INFO-WRITE-03.
068900 NO-INFO-03.
069000     MOVE "NO DEFINITE CONCLUSION POSSIBLE" TO RE-MARK.
069100 INFO-WRITE-03.
069200     MOVE "READ SHORT RECORD" TO FEATURE.
069300     MOVE "SEQ-INFO-03 " TO PAR-NAME.
069400     PERFORM PRINT-DETAIL.
069500 INFO-END.
069600     CLOSE SQ-VS7.
069700 TERMINATE-ROUTINE.
069800     EXIT.
069900 CCVS-EXIT SECTION.
070000 CCVS-999999.
070100     GO TO CLOSE-FILES.
