000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IX119A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*
001400*    THIS ROUTINE USES THE MASS STORAGE FILE IX-FS3 CREATED IN
001500*    IX113A.
001600*    THE FILE IS OPENED I-O AND THE STATUS CHECKED (00 EXPECTED),
001700*    THEN AN ATTEMPT IS MADE TO REWRITE A RECORD WITH THE WRONG
001800*    PRIME RECORD KEY (STATUS 21 EXPECTED).  THEN AN ATTEMPT
001900*    IS MADE TO DELETE A RECORD, AT WHICH POINT THE DECLARATIVES
002000*    SHOULD BE ACTIONED AND THE FILE STATUS SHOULD BE 43 .
002100*
002200*    STANDARD REFERENCE IX-5, 1.3.4 (3) A
002300*    STANDARD REFERENCE IX-5, 1.3.4 (5) C
002400*
002500*    X-CARDS USED IN THIS PROGRAM:
002600*
002700*                 XXXXX024
002800*                 XXXXX055.
002900*         P       XXXXX062.
003000*                 XXXXX082.
003100*                 XXXXX083.
003200*         C       XXXXX084
003300*
003400*
003500 ENVIRONMENT DIVISION.
003600 CONFIGURATION SECTION.
003700 SOURCE-COMPUTER.
003800     XXXXX082.
003900 OBJECT-COMPUTER.
004000     XXXXX083.
004100 INPUT-OUTPUT SECTION.
004200 FILE-CONTROL.
004300P    SELECT RAW-DATA   ASSIGN TO
004400P    XXXXX062
004500P           ORGANIZATION IS INDEXED
004600P           ACCESS MODE IS RANDOM
004700P           RECORD KEY IS RAW-DATA-KEY.
004800*
004900     SELECT PRINT-FILE ASSIGN TO
005000     XXXXX055.
005100*
005200     SELECT IX-FS3 ASSIGN
005300     XXXXX024
005400     ORGANIZATION IS INDEXED
005500     ACCESS MODE IS SEQUENTIAL
005600     RECORD KEY IS IX-FS3-KEY
005700     FILE STATUS IS IX-FS3-STATUS.
005800
005900 DATA DIVISION.
006000
006100 FILE SECTION.
006200P
006300PFD  RAW-DATA.
006400P
006500P01  RAW-DATA-SATZ.
006600P    05  RAW-DATA-KEY        PIC X(6).
006700P    05  C-DATE              PIC 9(6).
006800P    05  C-TIME              PIC 9(8).
006900P    05  C-NO-OF-TESTS       PIC 99.
007000P    05  C-OK                PIC 999.
007100P    05  C-ALL               PIC 999.
007200P    05  C-FAIL              PIC 999.
007300P    05  C-DELETED           PIC 999.
007400P    05  C-INSPECT           PIC 999.
007500P    05  C-NOTE              PIC X(13).
007600P    05  C-INDENT            PIC X.
007700P    05  C-ABORT             PIC X(8).
007800
007900 FD  PRINT-FILE.
008000
008100 01  PRINT-REC               PIC X(120).
008200
008300 01  DUMMY-RECORD            PIC X(120).
008400
008500 FD  IX-FS3
008600C       DATA RECORDS IX-FS3R1-F-G-240
008700C       LABEL RECORD STANDARD
008800        RECORD 240
008900        BLOCK CONTAINS 2 RECORDS.
009000
009100 01  IX-FS3R1-F-G-240.
009200     05  IX-FS3-REC-120      PIC X(120).
009300     05  IX-FS3-REC-120-240.
009400         10  FILLER          PIC X(8).
009500         10  IX-FS3-KEY      PIC X(29).
009600         10  FILLER          PIC X(9).
009700         10  IX-FS3-ALTER-KEY  PIC X(29).
009800         10  FILLER            PIC X(45).
009900
010000
010100 WORKING-STORAGE SECTION.
010200
010300 01  GRP-0101.
010400     05  FILLER              PIC X(10) VALUE "RECORD-KEY".
010500     05  GRP-0101-KEY        PIC 9(9)  VALUE ZERO.
010600     05  FILLER              PIC X(10) VALUE "END-OF-KEY".
010700
010800 01  GRP-0102.
010900     05  FILLER              PIC X(10) VALUE "ALTERN-KEY".
011000     05  GRP-0102-KEY        PIC 9(9)  VALUE ZERO.
011100     05  FILLER              PIC X(10) VALUE "END-AL-KEY".
011200
011300 01  WRK-CS-09V00            PIC S9(9) COMP VALUE ZERO.
011400
011500 01  EOF-FLAG                PIC 9 VALUE ZERO.
011600
011700 01  RECORDS-IN-ERROR        PIC S9(5) COMP VALUE ZERO.
011800
011900 01  ERROR-FLAG              PIC 9 VALUE ZERO.
012000
012100 01  PERM-ERRORS             PIC S9(5) COMP VALUE ZERO.
012200
012300 01  STATUS-TEST-00          PIC 9 VALUE ZERO.
012400
012500 01  STATUS-TEST-10          PIC 9 VALUE ZERO.
012600 01  STATUS-TEST-READ        PIC 9 VALUE ZERO.
012700
012800 01  IX-FS3-STATUS.
012900     05  IX-FS3-STAT1        PIC X.
013000     05  IX-FS3-STAT2        PIC X.
013100
013200 01  COUNT-OF-RECS           PIC 9(5).
013300
013400 01  COUNT-OF-RECORDS REDEFINES COUNT-OF-RECS  PIC 9(5).
013500
013600 01  FILE-RECORD-INFORMATION-REC.
013700     05  FILE-RECORD-INFO-SKELETON.
013800         10  FILLER          PIC X(48) VALUE
013900              "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
014000         10  FILLER          PIC X(46) VALUE
014100                ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
014200         10  FILLER          PIC X(26) VALUE
014300                                    ",LFIL=000000,ORG=  ,LBLR= ".
014400         10  FILLER          PIC X(37) VALUE
014500                         ",RECKEY=                             ".
014600         10  FILLER          PIC X(38) VALUE
014700                        ",ALTKEY1=                             ".
014800         10  FILLER          PIC X(38) VALUE
014900                        ",ALTKEY2=                             ".
015000         10  FILLER          PIC X(7) VALUE SPACE.
015100     05  FILE-RECORD-INFO             OCCURS 10.
015200         10  FILE-RECORD-INFO-P1-120.
015300             15  FILLER      PIC X(5).
015400             15  XFILE-NAME  PIC X(6).
015500             15  FILLER      PIC X(8).
015600             15  XRECORD-NAME  PIC X(6).
015700             15  FILLER        PIC X(1).
015800             15  REELUNIT-NUMBER  PIC 9(1).
015900             15  FILLER           PIC X(7).
016000             15  XRECORD-NUMBER   PIC 9(6).
016100             15  FILLER           PIC X(6).
016200             15  UPDATE-NUMBER    PIC 9(2).
016300             15  FILLER           PIC X(5).
016400             15  ODO-NUMBER       PIC 9(4).
016500             15  FILLER           PIC X(5).
016600             15  XPROGRAM-NAME    PIC X(5).
016700             15  FILLER           PIC X(7).
016800             15  XRECORD-LENGTH   PIC 9(6).
016900             15  FILLER           PIC X(7).
017000             15  CHARS-OR-RECORDS  PIC X(2).
017100             15  FILLER            PIC X(1).
017200             15  XBLOCK-SIZE       PIC 9(4).
017300             15  FILLER            PIC X(6).
017400             15  RECORDS-IN-FILE   PIC 9(6).
017500             15  FILLER            PIC X(5).
017600             15  XFILE-ORGANIZATION  PIC X(2).
017700             15  FILLER              PIC X(6).
017800             15  XLABEL-TYPE         PIC X(1).
017900         10  FILE-RECORD-INFO-P121-240.
018000             15  FILLER              PIC X(8).
018100             15  XRECORD-KEY         PIC X(29).
018200             15  FILLER              PIC X(9).
018300             15  ALTERNATE-KEY1      PIC X(29).
018400             15  FILLER              PIC X(9).
018500             15  ALTERNATE-KEY2      PIC X(29).
018600             15  FILLER              PIC X(7).
018700
018800 01  TEST-RESULTS.
018900     02 FILLER                   PIC X      VALUE SPACE.
019000     02 FEATURE                  PIC X(20)  VALUE SPACE.
019100     02 FILLER                   PIC X      VALUE SPACE.
019200     02 P-OR-F                   PIC X(5)   VALUE SPACE.
019300     02 FILLER                   PIC X      VALUE SPACE.
019400     02  PAR-NAME.
019500       03 FILLER                 PIC X(19)  VALUE SPACE.
019600       03  PARDOT-X              PIC X      VALUE SPACE.
019700       03 DOTVALUE               PIC 99     VALUE ZERO.
019800     02 FILLER                   PIC X(8)   VALUE SPACE.
019900     02 RE-MARK                  PIC X(61).
020000 01  TEST-COMPUTED.
020100     02 FILLER                   PIC X(30)  VALUE SPACE.
020200     02 FILLER                   PIC X(17)  VALUE
020300            "       COMPUTED=".
020400     02 COMPUTED-X.
020500     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
020600     03 COMPUTED-N               REDEFINES COMPUTED-A
020700                                 PIC -9(9).9(9).
020800     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
020900     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
021000     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
021100     03       CM-18V0 REDEFINES COMPUTED-A.
021200         04 COMPUTED-18V0                    PIC -9(18).
021300         04 FILLER                           PIC X.
021400     03 FILLER PIC X(50) VALUE SPACE.
021500 01  TEST-CORRECT.
021600     02 FILLER PIC X(30) VALUE SPACE.
021700     02 FILLER PIC X(17) VALUE "       CORRECT =".
021800     02 CORRECT-X.
021900     03 CORRECT-A                  PIC X(20) VALUE SPACE.
022000     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
022100     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
022200     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
022300     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
022400     03      CR-18V0 REDEFINES CORRECT-A.
022500         04 CORRECT-18V0                     PIC -9(18).
022600         04 FILLER                           PIC X.
022700     03 FILLER PIC X(2) VALUE SPACE.
022800     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
022900 01  CCVS-C-1.
023000     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
023100-    "SS  PARAGRAPH-NAME
023200-    "       REMARKS".
023300     02 FILLER                     PIC X(20)    VALUE SPACE.
023400 01  CCVS-C-2.
023500     02 FILLER                     PIC X        VALUE SPACE.
023600     02 FILLER                     PIC X(6)     VALUE "TESTED".
023700     02 FILLER                     PIC X(15)    VALUE SPACE.
023800     02 FILLER                     PIC X(4)     VALUE "FAIL".
023900     02 FILLER                     PIC X(94)    VALUE SPACE.
024000 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
024100 01  REC-CT                        PIC 99       VALUE ZERO.
024200 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
024300 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
024400 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
024500 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
024600 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
024700 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
024800 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
024900 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
025000 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
025100 01  CCVS-H-1.
025200     02  FILLER                    PIC X(39)    VALUE SPACES.
025300     02  FILLER                    PIC X(42)    VALUE
025400     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
025500     02  FILLER                    PIC X(39)    VALUE SPACES.
025600 01  CCVS-H-2A.
025700   02  FILLER                        PIC X(40)  VALUE SPACE.
025800   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
025900   02  FILLER                        PIC XXXX   VALUE
026000     "4.2 ".
026100   02  FILLER                        PIC X(28)  VALUE
026200            " COPY - NOT FOR DISTRIBUTION".
026300   02  FILLER                        PIC X(41)  VALUE SPACE.
026400
026500 01  CCVS-H-2B.
026600   02  FILLER                        PIC X(15)  VALUE
026700            "TEST RESULT OF ".
026800   02  TEST-ID                       PIC X(9).
026900   02  FILLER                        PIC X(4)   VALUE
027000            " IN ".
027100   02  FILLER                        PIC X(12)  VALUE
027200     " HIGH       ".
027300   02  FILLER                        PIC X(22)  VALUE
027400            " LEVEL VALIDATION FOR ".
027500   02  FILLER                        PIC X(58)  VALUE
027600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
027700 01  CCVS-H-3.
027800     02  FILLER                      PIC X(34)  VALUE
027900            " FOR OFFICIAL USE ONLY    ".
028000     02  FILLER                      PIC X(58)  VALUE
028100     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
028200     02  FILLER                      PIC X(28)  VALUE
028300            "  COPYRIGHT   1985 ".
028400 01  CCVS-E-1.
028500     02 FILLER                       PIC X(52)  VALUE SPACE.
028600     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
028700     02 ID-AGAIN                     PIC X(9).
028800     02 FILLER                       PIC X(45)  VALUE SPACES.
028900 01  CCVS-E-2.
029000     02  FILLER                      PIC X(31)  VALUE SPACE.
029100     02  FILLER                      PIC X(21)  VALUE SPACE.
029200     02 CCVS-E-2-2.
029300         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
029400         03 FILLER                   PIC X      VALUE SPACE.
029500         03 ENDER-DESC               PIC X(44)  VALUE
029600            "ERRORS ENCOUNTERED".
029700 01  CCVS-E-3.
029800     02  FILLER                      PIC X(22)  VALUE
029900            " FOR OFFICIAL USE ONLY".
030000     02  FILLER                      PIC X(12)  VALUE SPACE.
030100     02  FILLER                      PIC X(58)  VALUE
030200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
030300     02  FILLER                      PIC X(13)  VALUE SPACE.
030400     02 FILLER                       PIC X(15)  VALUE
030500             " COPYRIGHT 1985".
030600 01  CCVS-E-4.
030700     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
030800     02 FILLER                       PIC X(4)   VALUE " OF ".
030900     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
031000     02 FILLER                       PIC X(40)  VALUE
031100      "  TESTS WERE EXECUTED SUCCESSFULLY".
031200 01  XXINFO.
031300     02 FILLER                       PIC X(19)  VALUE
031400            "*** INFORMATION ***".
031500     02 INFO-TEXT.
031600       04 FILLER                     PIC X(8)   VALUE SPACE.
031700       04 XXCOMPUTED                 PIC X(20).
031800       04 FILLER                     PIC X(5)   VALUE SPACE.
031900       04 XXCORRECT                  PIC X(20).
032000     02 INF-ANSI-REFERENCE           PIC X(48).
032100 01  HYPHEN-LINE.
032200     02 FILLER  PIC IS X VALUE IS SPACE.
032300     02 FILLER  PIC IS X(65)    VALUE IS "************************
032400-    "*****************************************".
032500     02 FILLER  PIC IS X(54)    VALUE IS "************************
032600-    "******************************".
032700 01  TEST-NO                         PIC 99.
032800 01  CCVS-PGM-ID                     PIC X(9)   VALUE
032900     "IX119A".
033000 PROCEDURE DIVISION.
033100 DECLARATIVES.
033200
033300 SECT-IX105-0002 SECTION.
033400     USE AFTER EXCEPTION PROCEDURE ON IX-FS3.
033500 INPUT-PROCESS.
033600     IF TEST-NO = 5
033700        GO TO D-C-TEST-GF-01-1.
033800     IF STATUS-TEST-10 EQUAL TO 1
033900        IF  IX-FS3-STAT1 EQUAL TO "1"
034000            MOVE 1 TO EOF-FLAG
034100        ELSE
034200           IF  IX-FS3-STAT1 GREATER THAN "1"
034300           MOVE 1 TO PERM-ERRORS.
034400     GO TO DECL-EXIT.
034500 D-C-TEST-GF-01-1.
034600     IF IX-FS3-STATUS EQUAL TO "43"
034700         GO TO D-C-PASS-GF-01-0.
034800 D-C-FAIL-GF-01-0.
034900     MOVE IX-FS3-STATUS TO COMPUTED-A.
035000     MOVE "43" TO CORRECT-X.
035100     MOVE "IX-5, 1.3.4, (5) C" TO RE-MARK.
035200     PERFORM D-FAIL.
035300     GO TO D-C-WRITE-GF-01-0.
035400 D-C-PASS-GF-01-0.
035500     PERFORM D-PASS.
035600 D-C-WRITE-GF-01-0.
035700     PERFORM D-PRINT-DETAIL.
035800 D-CLOSE-FILES.
035900     CLOSE IX-FS3.
036000P    OPEN I-O RAW-DATA.
036100P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
036200P    READ RAW-DATA INVALID KEY GO TO D-END-E-2.
036300P    MOVE "OK.     " TO C-ABORT.
036400P    MOVE PASS-COUNTER TO C-OK.
036500P    MOVE ERROR-HOLD   TO C-ALL.
036600P    MOVE ERROR-COUNTER TO C-FAIL.
036700P    MOVE DELETE-COUNTER TO C-DELETED.
036800P    MOVE INSPECT-COUNTER TO C-INSPECT.
036900P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO D-END-E-2.
037000PD-END-E-2.
037100P    CLOSE RAW-DATA.
037200     PERFORM D-END-ROUTINE THRU D-END-ROUTINE-13.
037300     CLOSE PRINT-FILE.
037400 D-TERMINATE-CCVS.
037500S    EXIT PROGRAM.
037600SD-TERMINATE-CALL.
037700     STOP     RUN.
037800 D-PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
037900 D-FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
038000 D-PRINT-DETAIL.
038100     IF   REC-CT NOT EQUAL TO ZERO
038200          MOVE "." TO PARDOT-X
038300          MOVE REC-CT TO DOTVALUE.
038400     MOVE TEST-RESULTS TO PRINT-REC.
038500     PERFORM D-WRITE-LINE.
038600     IF   P-OR-F EQUAL TO "FAIL*"
038700          PERFORM D-WRITE-LINE
038800          PERFORM D-FAIL-ROUTINE THRU D-FAIL-ROUTINE-EX
038900     ELSE
039000          PERFORM D-BAIL-OUT THRU D-BAIL-OUT-EX.
039100     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
039200     MOVE SPACE TO CORRECT-X.
039300     IF   REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
039400     MOVE SPACE TO RE-MARK.
039500 D-END-ROUTINE.
039600     MOVE HYPHEN-LINE TO DUMMY-RECORD.
039700     PERFORM D-WRITE-LINE 5 TIMES.
039800 D-END-RTN-EXIT.
039900     MOVE CCVS-E-1 TO DUMMY-RECORD.
040000     PERFORM D-WRITE-LINE 2 TIMES.
040100 D-END-ROUTINE-1.
040200     ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
040300     ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
040400     ADD PASS-COUNTER TO ERROR-HOLD.
040500     MOVE PASS-COUNTER TO CCVS-E-4-1.
040600     MOVE ERROR-HOLD TO CCVS-E-4-2.
040700     MOVE CCVS-E-4 TO CCVS-E-2-2.
040800     MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM D-WRITE-LINE.
040900  D-END-ROUTINE-12.
041000     MOVE "TEST(S) FAILED" TO ENDER-DESC.
041100     IF  ERROR-COUNTER IS EQUAL TO ZERO
041200         MOVE "NO " TO ERROR-TOTAL
041300     ELSE
041400         MOVE ERROR-COUNTER TO ERROR-TOTAL.
041500     MOVE    CCVS-E-2 TO DUMMY-RECORD.
041600     PERFORM D-WRITE-LINE.
041700 D-END-ROUTINE-13.
041800     IF  DELETE-COUNTER IS EQUAL TO ZERO
041900         MOVE "NO " TO ERROR-TOTAL  ELSE
042000         MOVE DELETE-COUNTER TO ERROR-TOTAL.
042100     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
042200     MOVE CCVS-E-2 TO DUMMY-RECORD.
042300     PERFORM D-WRITE-LINE.
042400     IF   INSPECT-COUNTER EQUAL TO ZERO
042500          MOVE "NO " TO ERROR-TOTAL
042600     ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
042700     MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
042800     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM D-WRITE-LINE.
042900     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM D-WRITE-LINE.
043000 D-WRITE-LINE.
043100     ADD 1 TO RECORD-COUNT.
043200Y    IF RECORD-COUNT GREATER 42
043300Y       MOVE DUMMY-RECORD TO DUMMY-HOLD
043400Y       MOVE SPACE TO DUMMY-RECORD
043500Y       WRITE DUMMY-RECORD AFTER ADVANCING PAGE
043600Y       MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM D-WRT-LN 2 TIMES
043700Y       MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM D-WRT-LN 2 TIMES
043800Y       MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM D-WRT-LN 3 TIMES
043900Y       MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM D-WRT-LN 3 TIMES
044000Y       MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM D-WRT-LN
044100Y       MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM D-WRT-LN
044200Y       MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM D-WRT-LN
044300Y       MOVE DUMMY-HOLD TO DUMMY-RECORD
044400Y       MOVE ZERO TO RECORD-COUNT.
044500     PERFORM D-WRT-LN.
044600 D-WRT-LN.
044700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
044800     MOVE SPACE TO DUMMY-RECORD.
044900 D-FAIL-ROUTINE.
045000     IF   COMPUTED-X NOT EQUAL TO SPACE
045100          GO TO D-FAIL-ROUTINE-WRITE.
045200     IF   CORRECT-X NOT EQUAL TO SPACE GO TO D-FAIL-ROUTINE-WRITE.
045300     MOVE ANSI-REFERENCE TO INF-ANSI-REFERENCE.
045400     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
045500     MOVE XXINFO TO DUMMY-RECORD. PERFORM D-WRITE-LINE 2 TIMES.
045600     MOVE SPACES TO INF-ANSI-REFERENCE.
045700     GO TO D-FAIL-ROUTINE-EX.
045800 D-FAIL-ROUTINE-WRITE.
045900     MOVE TEST-COMPUTED TO PRINT-REC PERFORM D-WRITE-LINE
046000     MOVE ANSI-REFERENCE TO COR-ANSI-REFERENCE.
046100     MOVE TEST-CORRECT TO PRINT-REC PERFORM D-WRITE-LINE 2 TIMES.
046200     MOVE SPACES TO COR-ANSI-REFERENCE.
046300 D-FAIL-ROUTINE-EX. EXIT.
046400 D-BAIL-OUT.
046500     IF  COMPUTED-A NOT EQUAL TO SPACE GO TO D-BAIL-OUT-WRITE.
046600     IF  CORRECT-A EQUAL TO SPACE GO TO D-BAIL-OUT-EX.
046700 D-BAIL-OUT-WRITE.
046800     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
046900     MOVE ANSI-REFERENCE TO INF-ANSI-REFERENCE.
047000     MOVE XXINFO TO DUMMY-RECORD. PERFORM D-WRITE-LINE 2 TIMES.
047100     MOVE SPACES TO INF-ANSI-REFERENCE.
047200 D-BAIL-OUT-EX. EXIT.
047300 DECL-EXIT.  EXIT.
047400 END DECLARATIVES.
047500
047600
047700 CCVS1 SECTION.
047800 OPEN-FILES.
047900P    OPEN I-O RAW-DATA.
048000P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
048100P    READ RAW-DATA INVALID KEY GO TO END-E-1.
048200P    MOVE "ABORTED " TO C-ABORT.
048300P    ADD 1 TO C-NO-OF-TESTS.
048400P    ACCEPT C-DATE  FROM DATE.
048500P    ACCEPT C-TIME  FROM TIME.
048600P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
048700PEND-E-1.
048800P    CLOSE RAW-DATA.
048900     OPEN    OUTPUT PRINT-FILE.
049000     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
049100     MOVE    SPACE TO TEST-RESULTS.
049200     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
049300     MOVE    ZERO TO REC-SKL-SUB.
049400     PERFORM CCVS-INIT-FILE 9 TIMES.
049500 CCVS-INIT-FILE.
049600     ADD     1 TO REC-SKL-SUB.
049700     MOVE    FILE-RECORD-INFO-SKELETON
049800          TO FILE-RECORD-INFO (REC-SKL-SUB).
049900 CCVS-INIT-EXIT.
050000     GO TO CCVS1-EXIT.
050100 CLOSE-FILES.
050200P    OPEN I-O RAW-DATA.
050300P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
050400P    READ RAW-DATA INVALID KEY GO TO END-E-2.
050500P    MOVE "OK.     " TO C-ABORT.
050600P    MOVE PASS-COUNTER TO C-OK.
050700P    MOVE ERROR-HOLD   TO C-ALL.
050800P    MOVE ERROR-COUNTER TO C-FAIL.
050900P    MOVE DELETE-COUNTER TO C-DELETED.
051000P    MOVE INSPECT-COUNTER TO C-INSPECT.
051100P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
051200PEND-E-2.
051300P    CLOSE RAW-DATA.
051400     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
051500 TERMINATE-CCVS.
051600S    EXIT PROGRAM.
051700STERMINATE-CALL.
051800     STOP     RUN.
051900 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
052000 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
052100 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
052200 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
052300     MOVE "****TEST DELETED****" TO RE-MARK.
052400 PRINT-DETAIL.
052500     IF REC-CT NOT EQUAL TO ZERO
052600             MOVE "." TO PARDOT-X
052700             MOVE REC-CT TO DOTVALUE.
052800     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
052900     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
053000        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
053100          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
053200     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
053300     MOVE SPACE TO CORRECT-X.
053400     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
053500     MOVE     SPACE TO RE-MARK.
053600 HEAD-ROUTINE.
053700     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
053800     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
053900     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
054000     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
054100 COLUMN-NAMES-ROUTINE.
054200     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
054300     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
054400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
054500 END-ROUTINE.
054600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
054700 END-RTN-EXIT.
054800     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
054900 END-ROUTINE-1.
055000      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
055100      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
055200      ADD PASS-COUNTER TO ERROR-HOLD.
055300*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
055400      MOVE PASS-COUNTER TO CCVS-E-4-1.
055500      MOVE ERROR-HOLD TO CCVS-E-4-2.
055600      MOVE CCVS-E-4 TO CCVS-E-2-2.
055700      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
055800  END-ROUTINE-12.
055900      MOVE "TEST(S) FAILED" TO ENDER-DESC.
056000     IF       ERROR-COUNTER IS EQUAL TO ZERO
056100         MOVE "NO " TO ERROR-TOTAL
056200         ELSE
056300         MOVE ERROR-COUNTER TO ERROR-TOTAL.
056400     MOVE     CCVS-E-2 TO DUMMY-RECORD.
056500     PERFORM WRITE-LINE.
056600 END-ROUTINE-13.
056700     IF DELETE-COUNTER IS EQUAL TO ZERO
056800         MOVE "NO " TO ERROR-TOTAL  ELSE
056900         MOVE DELETE-COUNTER TO ERROR-TOTAL.
057000     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
057100     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
057200      IF   INSPECT-COUNTER EQUAL TO ZERO
057300          MOVE "NO " TO ERROR-TOTAL
057400      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
057500      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
057600      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
057700     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
057800 WRITE-LINE.
057900     ADD 1 TO RECORD-COUNT.
058000Y    IF RECORD-COUNT GREATER 42
058100Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
058200Y        MOVE SPACE TO DUMMY-RECORD
058300Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
058400Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
058500Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
058600Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
058700Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
058800Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
058900Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
059000Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
059100Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
059200Y        MOVE ZERO TO RECORD-COUNT.
059300     PERFORM WRT-LN.
059400 WRT-LN.
059500     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
059600     MOVE SPACE TO DUMMY-RECORD.
059700 BLANK-LINE-PRINT.
059800     PERFORM WRT-LN.
059900 FAIL-ROUTINE.
060000     IF     COMPUTED-X NOT EQUAL TO SPACE
060100            GO TO   FAIL-ROUTINE-WRITE.
060200     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
060300     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
060400     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
060500     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
060600     MOVE   SPACES TO INF-ANSI-REFERENCE.
060700     GO TO  FAIL-ROUTINE-EX.
060800 FAIL-ROUTINE-WRITE.
060900     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
061000     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
061100     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
061200     MOVE   SPACES TO COR-ANSI-REFERENCE.
061300 FAIL-ROUTINE-EX. EXIT.
061400 BAIL-OUT.
061500     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
061600     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
061700 BAIL-OUT-WRITE.
061800     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
061900     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
062000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
062100     MOVE   SPACES TO INF-ANSI-REFERENCE.
062200 BAIL-OUT-EX. EXIT.
062300 CCVS1-EXIT.
062400     EXIT.
062500
062600 SECT-IX119A-0003 SECTION.
062700 SEQ-INIT-010.
062800     MOVE ZERO TO TEST-NO.
062900     MOVE "IX-FS3" TO XFILE-NAME (1).
063000     MOVE "R1-F-G" TO XRECORD-NAME (1).
063100     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
063200     MOVE 000240 TO XRECORD-LENGTH (1).
063300     MOVE "RC" TO CHARS-OR-RECORDS (1).
063400     MOVE 0002 TO XBLOCK-SIZE (1).
063500     MOVE 000050 TO RECORDS-IN-FILE (1).
063600     MOVE "IX" TO XFILE-ORGANIZATION (1).
063700     MOVE "S" TO XLABEL-TYPE (1).
063800     MOVE 000001 TO XRECORD-NUMBER (1).
063900     MOVE 0 TO COUNT-OF-RECS.
064000
064100******************************************************************
064200*   TEST  1                                                      *
064300*         OPEN OUTPUT ...                 00 EXPECTED            *
064400*         IX-3, 1.3.4 (1) A                                      *
064500*    STATUS 00 CHECK ON OUTPUT FILE IX-FS3                       *
064600*    THE OUTPUT STATEMENT IS SUCCESSFULLY EXECUTED               *
064700******************************************************************
064800 OPN-INIT-GF-01-0.
064900     MOVE 1 TO STATUS-TEST-00.
065000     MOVE SPACES TO IX-FS3-STATUS.
065100     MOVE "OPEN I-O   : 00 EXP." TO FEATURE.
065200     MOVE "OPN-TEST-GF-01-0" TO PAR-NAME.
065300     OPEN
065400        I-O    IX-FS3.
065500     IF IX-FS3-STATUS EQUAL TO "00"
065600         GO TO OPN-PASS-GF-01-0.
065700 OPN-FAIL-GF-01-0.
065800     MOVE "IX-3, 1.3.4, (1) A. " TO RE-MARK.
065900     PERFORM FAIL.
066000     MOVE IX-FS3-STATUS TO COMPUTED-A.
066100     MOVE "00" TO CORRECT-X.
066200     GO TO OPN-WRITE-GF-01-0.
066300 OPN-PASS-GF-01-0.
066400     PERFORM PASS.
066500 OPN-WRITE-GF-01-0.
066600     PERFORM PRINT-DETAIL.
066700******************************************************************
066800*   TEST  4                                                      *
066900*      REWRITE  PRIME RECORD SHOULD BE CHANGED 21 OR 22 EXPECTED
067000*         IX-3, 1.3.4 (3) A                                      *
067100******************************************************************
067200 RWR-INIT-GF-01-0.
067300     MOVE SPACES TO IX-FS3-STATUS.
067400     MOVE 0 TO STATUS-TEST-00.
067500     MOVE "REWRITE: 21/22  EXP." TO FEATURE.
067600     MOVE "RWR-TEST-GF-01-0" TO PAR-NAME.
067700     READ IX-FS3 AT END MOVE 0 TO IX-FS3-KEY.
067800     MOVE 9 TO XRECORD-NUMBER (1).
067900 RWR-TEST-GF-01-0.
068000     MOVE XRECORD-NUMBER (1) TO GRP-0101-KEY, COUNT-OF-RECS.
068100     MOVE GRP-0101 TO XRECORD-KEY (1).
068200     MOVE GRP-0102 TO ALTERNATE-KEY1 (1).
068300     MOVE FILE-RECORD-INFO (1) TO IX-FS3R1-F-G-240.
068400     REWRITE IX-FS3R1-F-G-240 INVALID KEY GO TO RWR-TEST-GF-01-1.
068500 RWR-TEST-GF-01-1.
068600     IF IX-FS3-STATUS = "21"
068700        GO TO RWR-PASS-GF-01-0.
068800     IF IX-FS3-STATUS = "22"
068900        GO TO RWR-PASS-GF-01-0.
069000 RWR-FAIL-GF-01-0.
069100     MOVE "IX-3, 1.3.4, (3) A. " TO RE-MARK.
069200     PERFORM FAIL.
069300     MOVE IX-FS3-STATUS TO COMPUTED-A.
069400     MOVE "21" TO CORRECT-X.
069500     GO TO RWR-WRITE-GF-01-0.
069600 RWR-PASS-GF-01-0.
069700     PERFORM PASS.
069800 RWR-WRITE-GF-01-0.
069900     PERFORM PRINT-DETAIL.
070000
070100******************************************************************
070200*   TEST  5                                                      *
070300*         DELETE....  STATUS 43 EXPECTED
070400*         IX-5, 1.3.4 (5) C
070500******************************************************************
070600 DEL-TEST-GF-01-0.
070700     MOVE  5 TO TEST-NO.
070800     MOVE SPACES TO IX-FS3-STATUS.
070900     MOVE "DELETE       43 EXP." TO FEATURE
071000     MOVE "DEL-TEST-GF-01-0" TO PAR-NAME.
071100     DELETE IX-FS3 RECORD.
071200 DEL-TEST-GF-01-1.
071300     IF IX-FS3-STATUS EQUAL TO "43"
071400        MOVE "SHOULD HAVE EXECUTED DECLARATIVES IX-3,1.3.4(4)"
071500          TO RE-MARK
071600        GO TO DEL-WRITE-GF-01-0.
071700 DEL-FAIL-GF-01-0.
071800     MOVE "IX-5, 1.3.4, (5) C" TO RE-MARK.
071900 DEL-WRITE-GF-01-0.
072000     MOVE IX-FS3-STATUS TO COMPUTED-A.
072100     MOVE "43" TO CORRECT-X.
072200     PERFORM FAIL.
072300     PERFORM PRINT-DETAIL.
072400     CLOSE IX-FS3.
072500
072600 TERMINATE-ROUTINE.
072700     EXIT.
072800
072900 CCVS-EXIT SECTION.
073000 CCVS-999999.
073100     GO TO CLOSE-FILES.
