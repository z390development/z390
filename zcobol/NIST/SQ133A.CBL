000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ133A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
000900*                             REVISED 1986, AUGUST             *
001000*                                                              *
001100*    CREATION DATE     /     VALIDATION DATE                   *
001200*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001300*                                                              *
001400****************************************************************
001500*                                                              *
001600*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001700*                                                              *
001800*            X-14   SEQUENTIAL MASS STORAGE FILE               *
001900*            X-55   SYSTEM PRINTER                             *
002000*            X-82   SOURCE-COMPUTER                            *
002100*            X-83   OBJECT-COMPUTER.                           *
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    THIS PROGRAM OPENS FOR OUTPUT A FILE WHICH IS ASSIGNED    *
002600*    TO A MASS STORAGE MEDIUM, WRITES ONE RECORD AND CLOSES    *
002700*    THE FILE.  THE FILE IS THEN OPENED FOR I-O, AND TWO READ  *
002800*    STATEMENTS EXECUTED.  THE SECOND SHOULD CAUSE AN AT END   *
002900*    CONDITION, AND THUS BE UNSUCCESSFUL.  A REWRITE STATEMENT *
003000*    IS THEN EXECUTED.  THIS SHOULD CAUSE AN EXCEPTION         *
003100*    CONDITION, WITH I-O STATUS "43" AND ENTRY TO THE          *
003200*    APPLICABLE ERROR DECLARATIVE.                             *
003300*                                                              *
003400*    THIS PROGRAM HAS BEEN SPLIT FROM V2.0 ONWARDS.            *
003500*    THE NEW PROGRAM IS SQ144A.                                *
003600****************************************************************
003700*
003800 ENVIRONMENT DIVISION.
003900 CONFIGURATION SECTION.
004000 SOURCE-COMPUTER.
004100     XXXXX082.
004200 OBJECT-COMPUTER.
004300     XXXXX083.
004400*
004500 INPUT-OUTPUT SECTION.
004600 FILE-CONTROL.
004700     SELECT PRINT-FILE ASSIGN TO
004800     XXXXX055.
004900*
005000P    SELECT RAW-DATA   ASSIGN TO
005100P    XXXXX062
005200P          ORGANIZATION IS INDEXED
005300P          ACCESS MODE  IS RANDOM
005400P          RECORD-KEY   IS RAW-DATA-KEY.
005500P
005600     SELECT SQ-FS4
005700            ASSIGN
005800     XXXXX014
005900            STATUS SQ-FS4-STATUS OF STATUS-GROUP
006000            SEQUENTIAL
006100            .
006200*
006300*
006400 DATA DIVISION.
006500 FILE SECTION.
006600 FD  PRINT-FILE
006700C    LABEL RECORDS
006800C    XXXXX084
006900C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007000               .
007100 01  PRINT-REC    PICTURE X(120).
007200 01  DUMMY-RECORD PICTURE X(120).
007300P
007400PFD  RAW-DATA.
007500P01  RAW-DATA-SATZ.
007600P    05  RAW-DATA-KEY        PIC X(6).
007700P    05  C-DATE              PIC 9(6).
007800P    05  C-TIME              PIC 9(8).
007900P    05  NO-OF-TESTS         PIC 99.
008000P    05  C-OK                PIC 999.
008100P    05  C-ALL               PIC 999.
008200P    05  C-FAIL              PIC 999.
008300P    05  C-DELETED           PIC 999.
008400P    05  C-INSPECT           PIC 999.
008500P    05  C-NOTE              PIC X(13).
008600P    05  C-INDENT            PIC X.
008700P    05  C-ABORT             PIC X(8).
008800*
008900 FD  SQ-FS4
009000C    LABEL RECORD IS STANDARD
009100     BLOCK  120 CHARACTERS
009200     RECORD CONTAINS 120 CHARACTERS
009300                .
009400 01  SQ-FS4R1-F-G-120.
009500        05 FFILE-RECORD-INFO-P1-120.
009600           07 FILLER              PIC X(5).
009700           07 FFILE-NAME          PIC X(6).
009800           07 FILLER              PIC X(8).
009900           07 FRECORD-NAME        PIC X(6).
010000           07 FILLER              PIC X(1).
010100           07 FREELUNIT-NUMBER    PIC 9(1).
010200           07 FILLER              PIC X(7).
010300           07 FRECORD-NUMBER      PIC 9(6).
010400           07 FILLER              PIC X(6).
010500           07 FUPDATE-NUMBER      PIC 9(2).
010600           07 FILLER              PIC X(5).
010700           07 FODO-NUMBER         PIC 9(4).
010800           07 FILLER              PIC X(5).
010900           07 FPROGRAM-NAME       PIC X(5).
011000           07 FILLER              PIC X(7).
011100           07 FRECORD-LENGTH      PIC 9(6).
011200           07 FILLER              PIC X(7).
011300           07 FCHARS-OR-RECORDS   PIC X(2).
011400           07 FILLER              PIC X(1).
011500           07 FBLOCK-SIZE         PIC 9(4).
011600           07 FILLER              PIC X(6).
011700           07 FRECORDS-IN-FILE    PIC 9(6).
011800           07 FILLER              PIC X(5).
011900           07 FFILE-ORGANIZATION  PIC X(2).
012000           07 FILLER              PIC X(6).
012100           07 FLABEL-TYPE         PIC X(1).
012200*
012300 WORKING-STORAGE SECTION.
012400*
012500***************************************************************
012600*                                                             *
012700*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
012800*                                                             *
012900***************************************************************
013000*
013100 01  STATUS-GROUP.
013200     04  SQ-FS4-STATUS.
013300         07  SQ-FS4-KEY-1   PIC X.
013400         07  SQ-FS4-KEY-2   PIC X.
013500*
013600 01  DELETE-SW.
013700     03  DELETE-SW-1 PIC X.
013800     03  DELETE-SW-1-GROUP.
013900         05  DELETE-SW-2 PIC X.
014000*
014100 01  DECL-EXEC-I-O PIC X(12).
014200*
014300 01  DECL-EXEC-SW PIC X.
014400*
014500***************************************************************
014600*                                                             *
014700*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
014800*                                                             *
014900***************************************************************
015000*
015100 01  REC-SKEL-SUB   PIC 99.
015200*
015300 01  FILE-RECORD-INFORMATION-REC.
015400     03 FILE-RECORD-INFO-SKELETON.
015500        05 FILLER                 PICTURE X(48)       VALUE
015600             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
015700        05 FILLER                 PICTURE X(46)       VALUE
015800             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
015900        05 FILLER                 PICTURE X(26)       VALUE
016000             ",LFIL=000000,ORG=  ,LBLR= ".
016100        05 FILLER                 PICTURE X(37)       VALUE
016200             ",RECKEY=                             ".
016300        05 FILLER                 PICTURE X(38)       VALUE
016400             ",ALTKEY1=                             ".
016500        05 FILLER                 PICTURE X(38)       VALUE
016600             ",ALTKEY2=                             ".
016700        05 FILLER                 PICTURE X(7)        VALUE SPACE.
016800     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
016900        05 FILE-RECORD-INFO-P1-120.
017000           07 FILLER              PIC X(5).
017100           07 XFILE-NAME          PIC X(6).
017200           07 FILLER              PIC X(8).
017300           07 XRECORD-NAME        PIC X(6).
017400           07 FILLER              PIC X(1).
017500           07 REELUNIT-NUMBER     PIC 9(1).
017600           07 FILLER              PIC X(7).
017700           07 XRECORD-NUMBER      PIC 9(6).
017800           07 FILLER              PIC X(6).
017900           07 UPDATE-NUMBER       PIC 9(2).
018000           07 FILLER              PIC X(5).
018100           07 ODO-NUMBER          PIC 9(4).
018200           07 FILLER              PIC X(5).
018300           07 XPROGRAM-NAME       PIC X(5).
018400           07 FILLER              PIC X(7).
018500           07 XRECORD-LENGTH      PIC 9(6).
018600           07 FILLER              PIC X(7).
018700           07 CHARS-OR-RECORDS    PIC X(2).
018800           07 FILLER              PIC X(1).
018900           07 XBLOCK-SIZE         PIC 9(4).
019000           07 FILLER              PIC X(6).
019100           07 RECORDS-IN-FILE     PIC 9(6).
019200           07 FILLER              PIC X(5).
019300           07 XFILE-ORGANIZATION  PIC X(2).
019400           07 FILLER              PIC X(6).
019500           07 XLABEL-TYPE         PIC X(1).
019600        05 FILE-RECORD-INFO-P121-240.
019700           07 FILLER              PIC X(8).
019800           07 XRECORD-KEY         PIC X(29).
019900           07 FILLER              PIC X(9).
020000           07 ALTERNATE-KEY1      PIC X(29).
020100           07 FILLER              PIC X(9).
020200           07 ALTERNATE-KEY2      PIC X(29).
020300           07 FILLER              PIC X(7).
020400*
020500 01  TEST-RESULTS.
020600     02 FILLER              PIC X      VALUE SPACE.
020700     02  PAR-NAME.
020800       03 FILLER              PIC X(14)  VALUE SPACE.
020900       03 PARDOT-X            PIC X      VALUE SPACE.
021000       03 DOTVALUE            PIC 99     VALUE ZERO.
021100     02 FILLER              PIC X      VALUE SPACE.
021200     02 FEATURE             PIC X(24)  VALUE SPACE.
021300     02 FILLER              PIC X      VALUE SPACE.
021400     02 P-OR-F              PIC X(5)   VALUE SPACE.
021500     02 FILLER              PIC X(9)   VALUE SPACE.
021600     02 RE-MARK             PIC X(61).
021700 01  TEST-COMPUTED.
021800   02 FILLER  PIC X(30)  VALUE SPACE.
021900   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
022000   02 COMPUTED-X.
022100     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
022200     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
022300     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
022400     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
022500     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
022600     03       CM-18V0 REDEFINES COMPUTED-A.
022700        04 COMPUTED-18V0                   PIC -9(18).
022800        04 FILLER                          PIC X.
022900     03 FILLER PIC X(50) VALUE SPACE.
023000 01  TEST-CORRECT.
023100     02 FILLER PIC X(30) VALUE SPACE.
023200     02 FILLER PIC X(17) VALUE "       CORRECT =".
023300     02 CORRECT-X.
023400     03 CORRECT-A                  PIC X(20) VALUE SPACE.
023500     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
023600     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
023700     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
023800     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
023900     03      CR-18V0 REDEFINES CORRECT-A.
024000         04 CORRECT-18V0                     PIC -9(18).
024100         04 FILLER                           PIC X.
024200     03 FILLER PIC X(2) VALUE SPACE.
024300     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
024400*
024500 01  CCVS-C-1.
024600     02 FILLER  PIC IS X        VALUE  SPACE.
024700     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
024800     02 FILLER  PIC IS X        VALUE  SPACE.
024900     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
025000     02 FILLER  PIC IS X        VALUE  SPACE.
025100     02 FILLER  PIC IS X(5)     VALUE "PASS ".
025200     02 FILLER  PIC IS X(9)     VALUE  SPACE.
025300     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
025400 01  CCVS-C-2.
025500     02 FILLER  PIC X(19)  VALUE  SPACE.
025600     02 FILLER  PIC X(6)   VALUE "TESTED".
025700     02 FILLER  PIC X(19)  VALUE  SPACE.
025800     02 FILLER  PIC X(4)   VALUE "FAIL".
025900     02 FILLER  PIC X(72)  VALUE  SPACE.
026000*
026100 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
026200 01  REC-CT            PIC 99       VALUE ZERO.
026300 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
026400 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
026500 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
026600 01  PASS-COUNTER      PIC 999      VALUE ZERO.
026700 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
026800 01  ERROR-HOLD        PIC 999      VALUE ZERO.
026900 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
027000 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
027100 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
027200 01  CCVS-H-1.
027300     02  FILLER          PIC X(39)    VALUE SPACES.
027400     02  FILLER          PIC X(42)    VALUE
027500     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
027600     02  FILLER          PIC X(39)    VALUE SPACES.
027700 01  CCVS-H-2A.
027800   02  FILLER            PIC X(40)  VALUE SPACE.
027900   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
028000   02  FILLER            PIC XXXX   VALUE
028100     "4.2 ".
028200   02  FILLER            PIC X(28)  VALUE
028300            " COPY - NOT FOR DISTRIBUTION".
028400   02  FILLER            PIC X(41)  VALUE SPACE.
028500*
028600 01  CCVS-H-2B.
028700   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
028800   02  TEST-ID           PIC X(9).
028900   02  FILLER            PIC X(4)   VALUE " IN ".
029000   02  FILLER            PIC X(12)  VALUE
029100     " HIGH       ".
029200   02  FILLER            PIC X(22)  VALUE
029300            " LEVEL VALIDATION FOR ".
029400   02  FILLER            PIC X(58)  VALUE
029500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
029600 01  CCVS-H-3.
029700     02  FILLER          PIC X(34)  VALUE
029800            " FOR OFFICIAL USE ONLY    ".
029900     02  FILLER          PIC X(58)  VALUE
030000     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
030100     02  FILLER          PIC X(28)  VALUE
030200            "  COPYRIGHT   1985,1986 ".
030300 01  CCVS-E-1.
030400     02 FILLER           PIC X(52)  VALUE SPACE.
030500     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
030600     02 ID-AGAIN         PIC X(9).
030700     02 FILLER           PIC X(45)  VALUE SPACES.
030800 01  CCVS-E-2.
030900     02  FILLER          PIC X(31)  VALUE SPACE.
031000     02  FILLER          PIC X(21)  VALUE SPACE.
031100     02  CCVS-E-2-2.
031200         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
031300         03 FILLER         PIC X      VALUE SPACE.
031400         03 ENDER-DESC     PIC X(44)  VALUE
031500            "ERRORS ENCOUNTERED".
031600 01  CCVS-E-3.
031700     02  FILLER          PIC X(22)  VALUE
031800            " FOR OFFICIAL USE ONLY".
031900     02  FILLER          PIC X(12)  VALUE SPACE.
032000     02  FILLER          PIC X(58)  VALUE
032100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
032200     02  FILLER          PIC X(8)   VALUE SPACE.
032300     02  FILLER          PIC X(20)  VALUE
032400             " COPYRIGHT 1985,1986".
032500 01  CCVS-E-4.
032600     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
032700     02 FILLER           PIC X(4)   VALUE " OF ".
032800     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
032900     02 FILLER           PIC X(40)  VALUE
033000      "  TESTS WERE EXECUTED SUCCESSFULLY".
033100 01  XXINFO.
033200     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
033300     02 INFO-TEXT.
033400       04 FILLER             PIC X(8)   VALUE SPACE.
033500       04 XXCOMPUTED         PIC X(20).
033600       04 FILLER             PIC X(5)   VALUE SPACE.
033700       04 XXCORRECT          PIC X(20).
033800     02 INF-ANSI-REFERENCE PIC X(48).
033900 01  HYPHEN-LINE.
034000     02 FILLER  PIC IS X VALUE IS SPACE.
034100     02 FILLER  PIC IS X(65)    VALUE IS "************************
034200-    "*****************************************".
034300     02 FILLER  PIC IS X(54)    VALUE IS "************************
034400-    "******************************".
034500 01  CCVS-PGM-ID  PIC X(9)   VALUE
034600     "SQ133A".
034700*
034800*
034900 PROCEDURE DIVISION.
035000 DECLARATIVES.
035100*
035200 SECT-SQ133A-0001 SECTION.
035300     USE AFTER EXCEPTION PROCEDURE I-O.
035400 I-O-ERROR-PROCESS.
035500     MOVE   "EXECUTED" TO DECL-EXEC-I-O.
035600     IF DECL-EXEC-SW NOT = SPACE
035700         GO TO   END-DECLS.
035800*
035900     MOVE    1 TO REC-CT.
036000     MOVE   "REWRITE AFTER FAILED RD"  TO FEATURE.
036100     MOVE   "DCL-REWRITE-01" TO PAR-NAME.
036200     GO TO   DCL-REWRITE-01.
036300 DECL-DELETE-01.
036400     PERFORM DECL-DE-LETE.
036500     GO TO   DECL-TEST-01-END.
036600 DCL-REWRITE-01.
036700     IF SQ-FS4-STATUS = "43"
036800         PERFORM DECL-PASS
036900     ELSE
037000         MOVE    SQ-FS4-STATUS TO COMPUTED-A
037100         MOVE   "43" TO CORRECT-A
037200         MOVE   "UNEXPECTED I-O STATUS ON FAILED REWRITE"
037300                   TO RE-MARK
037400         MOVE   "VII-4, VII-48,4.5.4(2)" TO ANSI-REFERENCE
037500         PERFORM DECL-FAIL.
037600 DECL-TEST-01-END.
037700*
037800     PERFORM DECL-WRITE-LINE.
037900     MOVE   "ABNORMAL TERMINATION AT THIS POINT IS ACCEPTABLE"
038000               TO DUMMY-RECORD.
038100     PERFORM DECL-WRITE-LINE 3 TIMES.
038200     GO TO   END-DECLS.
038300*
038400*
038500 DECL-PASS.
038600     MOVE   "PASS " TO P-OR-F.
038700     ADD     1 TO PASS-COUNTER.
038800     PERFORM DECL-PRINT-DETAIL.
038900*
039000 DECL-FAIL.
039100     MOVE   "FAIL*" TO P-OR-F.
039200     ADD     1 TO ERROR-COUNTER.
039300     PERFORM DECL-PRINT-DETAIL.
039400*
039500 DECL-DE-LETE.
039600     MOVE   "****TEST DELETED****" TO RE-MARK.
039700     MOVE   "*****" TO P-OR-F.
039800     ADD     1 TO DELETE-COUNTER.
039900     PERFORM DECL-PRINT-DETAIL.
040000*
040100 DECL-PRINT-DETAIL.
040200     IF REC-CT NOT EQUAL TO ZERO
040300             MOVE "." TO PARDOT-X
040400             MOVE REC-CT TO DOTVALUE.
040500     MOVE    TEST-RESULTS TO PRINT-REC.
040600     PERFORM DECL-WRITE-LINE.
040700     IF P-OR-F EQUAL TO "FAIL*"
040800         PERFORM DECL-WRITE-LINE
040900         PERFORM DECL-FAIL-ROUTINE THRU DECL-FAIL-EX
041000     ELSE
041100         PERFORM DECL-BAIL THRU DECL-BAIL-EX.
041200     MOVE    SPACE TO P-OR-F.
041300     MOVE    SPACE TO COMPUTED-X.
041400     MOVE    SPACE TO CORRECT-X.
041500     IF REC-CT EQUAL TO ZERO
041600         MOVE    SPACE TO PAR-NAME.
041700     MOVE    SPACE TO RE-MARK.
041800*
041900 DECL-WRITE-LINE.
042000     ADD     1 TO RECORD-COUNT.
042100Y    IF RECORD-COUNT GREATER 50
042200Y        MOVE    DUMMY-RECORD TO DUMMY-HOLD
042300Y        MOVE    SPACE TO DUMMY-RECORD
042400Y        WRITE   DUMMY-RECORD AFTER ADVANCING PAGE
042500Y        MOVE    CCVS-C-1 TO DUMMY-RECORD PERFORM DECL-WRT-LN
042600Y        MOVE    CCVS-C-2 TO DUMMY-RECORD
042700Y        PERFORM DECL-WRT-LN 2 TIMES
042800Y        MOVE    HYPHEN-LINE TO DUMMY-RECORD
042900Y        PERFORM DECL-WRT-LN
043000Y        MOVE    DUMMY-HOLD TO DUMMY-RECORD
043100Y        MOVE    ZERO TO RECORD-COUNT.
043200     PERFORM DECL-WRT-LN.
043300*
043400 DECL-WRT-LN.
043500     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
043600     MOVE    SPACE TO DUMMY-RECORD.
043700*
043800 DECL-FAIL-ROUTINE.
043900     IF COMPUTED-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
044000     IF CORRECT-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
044100     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
044200     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
044300     MOVE    XXINFO TO DUMMY-RECORD.
044400     PERFORM DECL-WRITE-LINE 2 TIMES.
044500     MOVE    SPACES TO INF-ANSI-REFERENCE.
044600     GO TO   DECL-FAIL-EX.
044700 DECL-FAIL-WRITE.
044800     MOVE    TEST-COMPUTED TO PRINT-REC
044900     PERFORM DECL-WRITE-LINE
045000     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
045100     MOVE    TEST-CORRECT TO PRINT-REC
045200     PERFORM DECL-WRITE-LINE 2 TIMES.
045300     MOVE    SPACES TO COR-ANSI-REFERENCE.
045400 DECL-FAIL-EX.
045500     EXIT.
045600*
045700 DECL-BAIL.
045800     IF COMPUTED-A NOT EQUAL TO SPACE GO TO DECL-BAIL-WRITE.
045900     IF CORRECT-A EQUAL TO SPACE GO TO DECL-BAIL-EX.
046000 DECL-BAIL-WRITE.
046100     MOVE    CORRECT-A TO XXCORRECT.
046200     MOVE    COMPUTED-A TO XXCOMPUTED.
046300     MOVE    XXINFO TO DUMMY-RECORD.
046400     PERFORM DECL-WRITE-LINE 2 TIMES.
046500 DECL-BAIL-EX.
046600     EXIT.
046700*
046800 END-DECLS.
046900 END DECLARATIVES.
047000*
047100*
047200 CCVS1 SECTION.
047300 OPEN-FILES.
047400P    OPEN    I-O RAW-DATA.
047500P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
047600P    READ    RAW-DATA INVALID KEY GO TO END-E-1.
047700P    MOVE   "ABORTED "   TO C-ABORT.
047800P    ADD     1           TO C-NO-OF-TESTS.
047900P    ACCEPT  C-DATE      FROM DATE.
048000P    ACCEPT  C-TIME      FROM TIME.
048100P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
048200PEND-E-1.
048300P    CLOSE   RAW-DATA.
048400     OPEN    OUTPUT PRINT-FILE.
048500     MOVE    CCVS-PGM-ID TO TEST-ID.
048600     MOVE    CCVS-PGM-ID TO ID-AGAIN.
048700     MOVE    SPACE TO TEST-RESULTS.
048800     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
048900     MOVE    ZERO TO REC-SKEL-SUB.
049000     PERFORM CCVS-INIT-FILE 10 TIMES.
049100     GO TO CCVS1-EXIT.
049200*
049300 CCVS-INIT-FILE.
049400     ADD     1 TO REC-SKL-SUB.
049500     MOVE    FILE-RECORD-INFO-SKELETON TO
049600                  FILE-RECORD-INFO (REC-SKL-SUB).
049700*
049800 CLOSE-FILES.
049900     PERFORM END-ROUTINE THRU END-ROUTINE-13.
050000     CLOSE   PRINT-FILE.
050100P    OPEN    I-O RAW-DATA.
050200P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
050300P    READ    RAW-DATA INVALID KEY GO TO END-E-2.
050400P    MOVE   "OK.     " TO C-ABORT.
050500P    MOVE    PASS-COUNTER  TO C-OK.
050600P    MOVE    ERROR-HOLD    TO C-ALL.
050700P    MOVE    ERROR-COUNTER TO C-FAIL.
050800P    MOVE    DELETE-CNT    TO C-DELETED.
050900P    MOVE    INSPECT-COUNTER TO C-INSPECT.
051000P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
051100PEND-E-2.
051200P    CLOSE   RAW-DATA.
051300 TERMINATE-CCVS.
051400S    EXIT    PROGRAM.
051500     STOP    RUN.
051600*
051700 INSPT.
051800     MOVE   "INSPT" TO P-OR-F.
051900     ADD     1 TO INSPECT-COUNTER.
052000     PERFORM PRINT-DETAIL.
052100*
052200 PASS.
052300     MOVE   "PASS " TO P-OR-F.
052400     ADD     1 TO PASS-COUNTER.
052500     PERFORM PRINT-DETAIL.
052600*
052700 FAIL.
052800     MOVE   "FAIL*" TO P-OR-F.
052900     ADD     1 TO ERROR-COUNTER.
053000     PERFORM PRINT-DETAIL.
053100*
053200 DE-LETE.
053300     MOVE   "****TEST DELETED****" TO RE-MARK.
053400     MOVE   "*****" TO P-OR-F.
053500     ADD     1 TO DELETE-COUNTER.
053600     PERFORM PRINT-DETAIL.
053700*
053800 PRINT-DETAIL.
053900     IF REC-CT NOT EQUAL TO ZERO
054000         MOVE   "." TO PARDOT-X
054100         MOVE    REC-CT TO DOTVALUE.
054200     MOVE    TEST-RESULTS TO PRINT-REC.
054300     PERFORM WRITE-LINE.
054400     IF P-OR-F EQUAL TO "FAIL*"
054500         PERFORM WRITE-LINE
054600         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
054700     ELSE
054800         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
054900     MOVE    SPACE TO P-OR-F.
055000     MOVE    SPACE TO COMPUTED-X.
055100     MOVE    SPACE TO CORRECT-X.
055200     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
055300     MOVE    SPACE TO RE-MARK.
055400*
055500 HEAD-ROUTINE.
055600     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
055700     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
055800     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
055900     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
056000 COLUMN-NAMES-ROUTINE.
056100     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
056200     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
056300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
056400 END-ROUTINE.
056500     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
056600     PERFORM WRITE-LINE 5 TIMES.
056700 END-RTN-EXIT.
056800     MOVE    CCVS-E-1 TO DUMMY-RECORD.
056900     PERFORM WRITE-LINE 2 TIMES.
057000*
057100 END-ROUTINE-1.
057200     ADD     ERROR-COUNTER   TO ERROR-HOLD
057300     ADD     INSPECT-COUNTER TO ERROR-HOLD.
057400     ADD     DELETE-COUNTER  TO ERROR-HOLD.
057500     ADD     PASS-COUNTER    TO ERROR-HOLD.
057600     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
057700     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
057800     MOVE    CCVS-E-4        TO CCVS-E-2-2.
057900     MOVE    CCVS-E-2        TO DUMMY-RECORD
058000     PERFORM WRITE-LINE.
058100     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
058200     IF ERROR-COUNTER IS EQUAL TO ZERO
058300         MOVE   "NO " TO ERROR-TOTAL
058400     ELSE
058500         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
058600     MOVE    CCVS-E-2 TO DUMMY-RECORD.
058700     PERFORM WRITE-LINE.
058800 END-ROUTINE-13.
058900     IF DELETE-COUNTER IS EQUAL TO ZERO
059000         MOVE   "NO " TO ERROR-TOTAL
059100     ELSE
059200         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
059300     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
059400     MOVE    CCVS-E-2 TO DUMMY-RECORD.
059500     PERFORM WRITE-LINE.
059600     IF INSPECT-COUNTER EQUAL TO ZERO
059700         MOVE   "NO " TO ERROR-TOTAL
059800     ELSE
059900         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
060000     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
060100     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
060200     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
060300*
060400 WRITE-LINE.
060500     ADD     1 TO RECORD-COUNT.
060600Y    IF RECORD-COUNT GREATER 50
060700Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
060800Y        MOVE  SPACE TO DUMMY-RECORD
060900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
061000Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
061100Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
061200Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
061300Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
061400Y        MOVE  ZERO TO RECORD-COUNT.
061500     PERFORM WRT-LN.
061600*
061700 WRT-LN.
061800     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
061900     MOVE    SPACE TO DUMMY-RECORD.
062000 BLANK-LINE-PRINT.
062100     PERFORM WRT-LN.
062200 FAIL-ROUTINE.
062300     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
062400     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
062500     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
062600     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
062700     MOVE    XXINFO TO DUMMY-RECORD.
062800     PERFORM WRITE-LINE 2 TIMES.
062900     MOVE    SPACES TO INF-ANSI-REFERENCE.
063000     GO TO   FAIL-ROUTINE-EX.
063100 FAIL-ROUTINE-WRITE.
063200     MOVE    TEST-COMPUTED  TO PRINT-REC
063300     PERFORM WRITE-LINE
063400     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
063500     MOVE    TEST-CORRECT   TO PRINT-REC
063600     PERFORM WRITE-LINE 2 TIMES.
063700     MOVE    SPACES         TO COR-ANSI-REFERENCE.
063800 FAIL-ROUTINE-EX.
063900     EXIT.
064000 BAIL-OUT.
064100     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
064200     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
064300 BAIL-OUT-WRITE.
064400     MOVE    CORRECT-A      TO XXCORRECT.
064500     MOVE    COMPUTED-A     TO XXCOMPUTED.
064600     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
064700     MOVE    XXINFO TO DUMMY-RECORD.
064800     PERFORM WRITE-LINE 2 TIMES.
064900     MOVE    SPACES TO INF-ANSI-REFERENCE.
065000 BAIL-OUT-EX.
065100     EXIT.
065200 CCVS1-EXIT.
065300     EXIT.
065400*
065500****************************************************************
065600*                                                              *
065700*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
065800*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
065900*                                                              *
066000****************************************************************
066100*
066200 SECT-SQ133A-0002 SECTION.
066300 STA-INIT.
066400     MOVE    SPACE TO DELETE-SW.
066500*
066600     MOVE   "SQ-FS4" TO XFILE-NAME (1).
066700     MOVE   "R1-F-G" TO XRECORD-NAME (1).
066800     MOVE    CCVS-PGM-ID TO XPROGRAM-NAME (1).
066900     MOVE    120 TO XRECORD-LENGTH (1).
067000     MOVE   "CC" TO CHARS-OR-RECORDS (1).
067100     MOVE    1   TO XBLOCK-SIZE (1).
067200     MOVE    1   TO RECORDS-IN-FILE (1).
067300     MOVE   "SQ" TO XFILE-ORGANIZATION (1).
067400     MOVE   "S"  TO XLABEL-TYPE (1).
067500*
067600*    OPEN THE FILE IN THE OUTPUT MODE
067700*
067800 SEQ-INIT-01.
067900     MOVE    0 TO REC-CT.
068000     MOVE   "*" TO DECL-EXEC-SW.
068100     MOVE   "**" TO SQ-FS4-STATUS.
068200     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
068300     MOVE    ZERO TO XRECORD-NUMBER (1).
068400     MOVE   "OPEN, CREATE FILE"  TO FEATURE.
068500     MOVE   "SEQ-TEST-OP-01" TO PAR-NAME.
068600     GO TO   SEQ-TEST-OP-01.
068700 SEQ-DELETE-01.
068800     MOVE   "*" TO DELETE-SW-1.
068900     GO TO   SEQ-DELETE-01-01.
069000 SEQ-TEST-OP-01.
069100     OPEN    OUTPUT SQ-FS4.
069200*
069300*    CHECK I-O STATUS RETURNED FROM OPEN OUTPUT
069400*
069500     ADD    1 TO REC-CT.
069600     IF DELETE-SW NOT = SPACE
069700         GO TO   SEQ-DELETE-01-01.
069800     GO TO   SEQ-TEST-OP-01-01.
069900 SEQ-DELETE-01-01.
070000     PERFORM DE-LETE.
070100     GO TO   SEQ-TEST-01-01-END.
070200 SEQ-TEST-OP-01-01.
070300     IF SQ-FS4-STATUS = "00"
070400         PERFORM PASS
070500     ELSE
070600         MOVE    SQ-FS4-STATUS TO COMPUTED-A
070700         MOVE   "00" TO CORRECT-A
070800         MOVE   "UNEXPECTED ERROR CODE FROM OPEN OUTPUT"
070900                   TO RE-MARK
071000         MOVE   "VII-3, VII-43" TO ANSI-REFERENCE
071100         PERFORM FAIL.
071200 SEQ-TEST-01-01-END.
071300*
071400*    CHECK EXECUTION OF I-O DECLARATIVE
071500*
071600     ADD     1 TO REC-CT.
071700     IF DELETE-SW NOT = SPACE
071800         GO TO   SEQ-DELETE-01-02.
071900     GO TO   SEQ-TEST-OP-01-02.
072000 SEQ-DELETE-01-02.
072100     PERFORM DE-LETE.
072200     GO TO   SEQ-TEST-01-02-END.
072300 SEQ-TEST-OP-01-02.
072400     IF DECL-EXEC-I-O = "NOT EXECUTED"
072500         PERFORM PASS
072600     ELSE
072700         MOVE    DECL-EXEC-I-O TO COMPUTED-A
072800         MOVE   "NOT EXECUTED" TO CORRECT-A
072900         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
073000                   TO RE-MARK
073100         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
073200         PERFORM FAIL.
073300 SEQ-TEST-01-02-END.
073400*
073500*
073600*    A NEW FILE IS OPEN.  WE NOW WRITE ONE RECORD.
073700*
073800 SEQ-INIT-02.
073900     MOVE    0 TO REC-CT.
074000     MOVE   "*" TO DECL-EXEC-SW.
074100     ADD     1 TO XRECORD-NUMBER (1).
074200     MOVE   "**" TO SQ-FS4-STATUS.
074300     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
074400     MOVE   "WRITE A RECORD"  TO FEATURE.
074500     MOVE   "SEQ-TEST-WR-02" TO PAR-NAME.
074600     IF DELETE-SW NOT EQUAL TO SPACE
074700         GO TO SEQ-DELETE-02.
074800     GO TO   SEQ-TEST-WR-02.
074900 SEQ-DELETE-02.
075000     MOVE   "*" TO DELETE-SW-2.
075100     GO TO   SEQ-DELETE-02-01.
075200 SEQ-TEST-WR-02.
075300     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-FS4R1-F-G-120.
075400     WRITE   SQ-FS4R1-F-G-120.
075500*
075600*    CHECK I-O STATUS RETURNED FROM WRITE
075700*
075800     ADD    1 TO REC-CT.
075900     IF DELETE-SW NOT = SPACE
076000         GO TO   SEQ-DELETE-02-01.
076100     GO TO   SEQ-TEST-WR-02-01.
076200 SEQ-DELETE-02-01.
076300     PERFORM DE-LETE.
076400     GO TO   SEQ-TEST-02-01-END.
076500 SEQ-TEST-WR-02-01.
076600     IF SQ-FS4-STATUS = "00"
076700         PERFORM PASS
076800     ELSE
076900         MOVE    SQ-FS4-STATUS TO COMPUTED-A
077000         MOVE   "00" TO CORRECT-A
077100         MOVE   "UNEXPECTED ERROR CODE FROM WRITE"
077200                   TO RE-MARK
077300         MOVE   "VII-3, VII-53" TO ANSI-REFERENCE
077400         PERFORM FAIL.
077500 SEQ-TEST-02-01-END.
077600*
077700*    CHECK EXECUTION OF I-O DECLARATIVE
077800*
077900     ADD     1 TO REC-CT.
078000     IF DELETE-SW NOT = SPACE
078100         GO TO   SEQ-DELETE-02-02.
078200     GO TO   SEQ-TEST-WR-02-02.
078300 SEQ-DELETE-02-02.
078400     PERFORM DE-LETE.
078500     GO TO   SEQ-TEST-02-02-END.
078600 SEQ-TEST-WR-02-02.
078700     IF DECL-EXEC-I-O = "NOT EXECUTED"
078800         PERFORM PASS
078900     ELSE
079000         MOVE    DECL-EXEC-I-O TO COMPUTED-A
079100         MOVE   "NOT EXECUTED" TO CORRECT-A
079200         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
079300                   TO RE-MARK
079400         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
079500         PERFORM FAIL.
079600 SEQ-TEST-02-02-END.
079700*
079800*
079900*    NOW CLOSE THE FILE.
080000*
080100 SEQ-INIT-03.
080200     MOVE    0 TO REC-CT.
080300     MOVE   "*" TO DECL-EXEC-SW.
080400     MOVE   "**" TO SQ-FS4-STATUS.
080500     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
080600     MOVE   "CLOSE FILE" TO FEATURE.
080700     MOVE   "SEQ-TEST-CL-03" TO PAR-NAME.
080800     IF DELETE-SW NOT EQUAL TO SPACE
080900         GO TO SEQ-DELETE-03.
081000     GO TO   SEQ-TEST-CL-03.
081100 SEQ-DELETE-03.
081200     MOVE   "*" TO DELETE-SW-2.
081300     GO TO   SEQ-DELETE-03-01.
081400 SEQ-TEST-CL-03.
081500     CLOSE   SQ-FS4.
081600*
081700*    CHECK I-O STATUS RETURNED FROM CLOSE
081800*
081900     ADD    1 TO REC-CT.
082000     IF DELETE-SW NOT = SPACE
082100         GO TO   SEQ-DELETE-03-01.
082200     GO TO   SEQ-TEST-CL-03-01.
082300 SEQ-DELETE-03-01.
082400     PERFORM DE-LETE.
082500     GO TO   SEQ-TEST-03-01-END.
082600 SEQ-TEST-CL-03-01.
082700     IF SQ-FS4-STATUS = "00"
082800         PERFORM PASS
082900     ELSE
083000         MOVE    SQ-FS4-STATUS TO COMPUTED-A
083100         MOVE   "00" TO CORRECT-A
083200         MOVE   "UNEXPECTED ERROR CODE FROM CLOSE"
083300                   TO RE-MARK
083400         MOVE   "VII-3, VII-38,4.2.4(4)" TO ANSI-REFERENCE
083500         PERFORM FAIL.
083600 SEQ-TEST-03-01-END.
083700*
083800*    CHECK EXECUTION OF I-O DECLARATIVE
083900*
084000     ADD     1 TO REC-CT.
084100     IF DELETE-SW NOT = SPACE
084200         GO TO   SEQ-DELETE-03-02.
084300     GO TO   SEQ-TEST-CL-03-02.
084400 SEQ-DELETE-03-02.
084500     PERFORM DE-LETE.
084600     GO TO   SEQ-TEST-03-02-END.
084700 SEQ-TEST-CL-03-02.
084800     IF DECL-EXEC-I-O = "NOT EXECUTED"
084900         PERFORM PASS
085000     ELSE
085100         MOVE    DECL-EXEC-I-O TO COMPUTED-A
085200         MOVE   "NOT EXECUTED" TO CORRECT-A
085300         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
085400                   TO RE-MARK
085500         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
085600         PERFORM FAIL.
085700 SEQ-TEST-03-02-END.
085800     MOVE    SPACE TO DELETE-SW-2.
085900*
086000*
086100*    OPEN THE FILE IN THE I-O MODE
086200*
086300 SEQ-INIT-04.
086400     MOVE    0 TO REC-CT.
086500     MOVE   "*" TO DECL-EXEC-SW.
086600     MOVE   "**" TO SQ-FS4-STATUS.
086700     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
086800     MOVE    ZERO TO XRECORD-NUMBER (1).
086900     MOVE   "OPEN FILE FOR I-O" TO FEATURE.
087000     MOVE   "SEQ-TEST-OP-04" TO PAR-NAME.
087100     IF DELETE-SW NOT = SPACE
087200         GO TO SEQ-DELETE-04-01.
087300     GO TO   SEQ-TEST-OP-04.
087400 SEQ-DELETE-04.
087500     MOVE   "*" TO DELETE-SW-2.
087600     GO TO   SEQ-DELETE-04-01.
087700 SEQ-TEST-OP-04.
087800     OPEN    I-O SQ-FS4.
087900*
088000*    CHECK I-O STATUS RETURNED FROM OPEN I-O
088100*
088200     ADD    1 TO REC-CT.
088300     IF DELETE-SW NOT = SPACE
088400         GO TO   SEQ-DELETE-04-01.
088500     GO TO   SEQ-TEST-OP-04-01.
088600 SEQ-DELETE-04-01.
088700     PERFORM DE-LETE.
088800     GO TO   SEQ-TEST-04-01-END.
088900 SEQ-TEST-OP-04-01.
089000     IF SQ-FS4-STATUS = "00"
089100         PERFORM PASS
089200     ELSE
089300         MOVE    SQ-FS4-STATUS TO COMPUTED-A
089400         MOVE   "00" TO CORRECT-A
089500         MOVE   "UNEXPECTED I-O STATUS CODE FROM OPEN I-O"
089600                   TO RE-MARK
089700         MOVE   "VII-3, VII-40" TO ANSI-REFERENCE
089800         PERFORM FAIL.
089900 SEQ-TEST-04-01-END.
090000*
090100*
090200     ADD     1 TO REC-CT.
090300     IF DELETE-SW NOT = SPACE
090400         GO TO   SEQ-DELETE-04-02.
090500     GO TO   SEQ-TEST-OP-04-02.
090600 SEQ-DELETE-04-02.
090700     PERFORM DE-LETE.
090800     GO TO   SEQ-TEST-04-02-END.
090900 SEQ-TEST-OP-04-02.
091000     IF DECL-EXEC-I-O = "NOT EXECUTED"
091100         PERFORM PASS
091200     ELSE
091300         MOVE    DECL-EXEC-I-O TO COMPUTED-A
091400         MOVE   "NOT EXECUTED" TO CORRECT-A
091500         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
091600                   TO RE-MARK
091700         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
091800         PERFORM FAIL.
091900 SEQ-TEST-04-02-END.
092000*
092100*
092200*    THE FILE IS OPEN FOR I-O.  WE READ THE ONLY RECORD.
092300*
092400 SEQ-INIT-05.
092500     MOVE    0 TO REC-CT.
092600     MOVE   "*" TO DECL-EXEC-SW.
092700     ADD     1 TO XRECORD-NUMBER (1).
092800     MOVE   "**" TO SQ-FS4-STATUS.
092900     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
093000     MOVE   "READ FIRST RECORD" TO FEATURE.
093100     MOVE   "SEQ-TEST-RD-05" TO PAR-NAME.
093200     IF DELETE-SW NOT EQUAL TO SPACE
093300         GO TO SEQ-DELETE-05.
093400     GO TO   SEQ-TEST-RD-05.
093500 SEQ-DELETE-05.
093600     MOVE   "*" TO DELETE-SW-2.
093700     GO TO   SEQ-DELETE-05-01.
093800 SEQ-TEST-RD-05.
093900     MOVE    SPACE TO SQ-FS4R1-F-G-120.
094000     READ    SQ-FS4.
094100*
094200*    CHECK I-O STATUS RETURNED FROM READ
094300*
094400     ADD    1 TO REC-CT.
094500     IF DELETE-SW NOT = SPACE
094600         GO TO   SEQ-DELETE-05-01.
094700     GO TO   SEQ-TEST-RD-05-01.
094800 SEQ-DELETE-05-01.
094900     PERFORM DE-LETE.
095000     GO TO   SEQ-TEST-05-01-END.
095100 SEQ-TEST-RD-05-01.
095200     IF SQ-FS4-STATUS = "00"
095300         PERFORM PASS
095400     ELSE
095500         MOVE    SQ-FS4-STATUS TO COMPUTED-A
095600         MOVE   "00" TO CORRECT-A
095700         MOVE   "UNEXPECTED STATUS CODE FROM READ"
095800                   TO RE-MARK
095900         MOVE   "VII-3, VII-44" TO ANSI-REFERENCE
096000         PERFORM FAIL.
096100 SEQ-TEST-05-01-END.
096200*
096300*    CHECK EXECUTION OF I-O DECLARATIVE
096400*
096500     ADD     1 TO REC-CT.
096600     IF DELETE-SW NOT = SPACE
096700         GO TO   SEQ-DELETE-05-02.
096800     GO TO   SEQ-TEST-RD-05-02.
096900 SEQ-DELETE-05-02.
097000     PERFORM DE-LETE.
097100     GO TO   SEQ-TEST-05-02-END.
097200 SEQ-TEST-RD-05-02.
097300     IF DECL-EXEC-I-O = "NOT EXECUTED"
097400         PERFORM PASS
097500     ELSE
097600         MOVE    DECL-EXEC-I-O TO COMPUTED-A
097700         MOVE   "NOT EXECUTED" TO CORRECT-A
097800         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
097900                   TO RE-MARK
098000         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
098100         PERFORM FAIL.
098200 SEQ-TEST-05-02-END.
098300*
098400*    CHECK THAT THE CORRECT RECORD HAS BEEN RETURNED, BY
098500*    CHECKING THE RECORD-NUMBER FIELD.
098600*
098700     ADD     1 TO REC-CT.
098800     IF DELETE-SW NOT = SPACE
098900         GO TO   SEQ-DELETE-05-03.
099000     GO TO   SEQ-TEST-RD-05-03.
099100 SEQ-DELETE-05-03.
099200     PERFORM DE-LETE.
099300     GO TO   SEQ-TEST-05-03-END.
099400 SEQ-TEST-RD-05-03.
099500     IF FRECORD-NUMBER = XRECORD-NUMBER (1)
099600         PERFORM PASS
099700     ELSE
099800         MOVE    FRECORD-NUMBER TO COMPUTED-18V0
099900         MOVE    XRECORD-NUMBER (1) TO CORRECT-18V0
100000         MOVE   "INCORRECT RECORD NUMBER FOUND" TO RE-MARK
100100         PERFORM FAIL.
100200 SEQ-TEST-05-03-END.
100300     MOVE    SPACE TO DELETE-SW-2.
100400*
100500*
100600*    ANOTHER READ SHOULD CAUSE THE AT END CONDITION.
100700*
100800 SEQ-INIT-06.
100900     MOVE    0 TO REC-CT.
101000     MOVE   "*" TO DECL-EXEC-SW.
101100     ADD     1 TO XRECORD-NUMBER (1).
101200     MOVE   "**" TO SQ-FS4-STATUS.
101300     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
101400     MOVE   "READ GIVING AT END" TO FEATURE.
101500     MOVE   "SEQ-TEST-RD-06" TO PAR-NAME.
101600     IF DELETE-SW NOT EQUAL TO SPACE
101700         GO TO SEQ-DELETE-06.
101800     GO TO   SEQ-TEST-RD-06.
101900 SEQ-DELETE-06.
102000     MOVE   "*" TO DELETE-SW-2.
102100     GO TO   SEQ-DELETE-06-01.
102200 SEQ-TEST-RD-06.
102300     READ    SQ-FS4 RECORD.
102400*
102500*    CHECK I-O STATUS RETURNED FROM READ
102600*
102700     ADD    1 TO REC-CT.
102800     IF DELETE-SW NOT = SPACE
102900         GO TO   SEQ-DELETE-06-01.
103000     GO TO   SEQ-TEST-RD-06-01.
103100 SEQ-DELETE-06-01.
103200     PERFORM DE-LETE.
103300     GO TO   SEQ-TEST-06-01-END.
103400 SEQ-TEST-RD-06-01.
103500     IF SQ-FS4-STATUS = "10"
103600         PERFORM PASS
103700     ELSE
103800         MOVE    SQ-FS4-STATUS TO COMPUTED-A
103900         MOVE   "10" TO CORRECT-A
104000         MOVE   "AT END STATUS NOT RETURNED FROM READ"
104100                   TO RE-MARK
104200         MOVE   "VII-3, VII-44" TO ANSI-REFERENCE
104300         PERFORM FAIL.
104400 SEQ-TEST-06-01-END.
104500*
104600*    CHECK EXECUTION OF I-O DECLARATIVE
104700*
104800     ADD     1 TO REC-CT.
104900     IF DELETE-SW NOT = SPACE
105000         GO TO   SEQ-DELETE-06-02.
105100     GO TO   SEQ-TEST-RD-06-02.
105200 SEQ-DELETE-06-02.
105300     PERFORM DE-LETE.
105400     GO TO   SEQ-TEST-06-02-END.
105500 SEQ-TEST-RD-06-02.
105600     IF DECL-EXEC-I-O = "EXECUTED"
105700         PERFORM PASS
105800     ELSE
105900         MOVE    DECL-EXEC-I-O TO COMPUTED-A
106000         MOVE   "EXECUTED" TO CORRECT-A
106100         MOVE   "I-O DECLARATIVE NOT EXECUTED AT END OF FILE"
106200                   TO RE-MARK
106300         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
106400         PERFORM FAIL.
106500 SEQ-TEST-06-02-END.
106600*
106700*
106800*    FINALLY, TRY TO EXECUTE A REWRITE AFTER THE FAILED READ
106900*
107000 SEQ-INIT-07.
107100     MOVE    0 TO REC-CT.
107200     MOVE    SPACE TO DECL-EXEC-SW.
107300     MOVE   "**" TO SQ-FS4-STATUS.
107400     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
107500     MOVE   "REWRITE AFTER AT END" TO FEATURE.
107600     MOVE   "SEQ-TEST-RW-07" TO PAR-NAME.
107700     IF DELETE-SW NOT = SPACE
107800         GO TO SEQ-DELETE-07-01.
107900     GO TO   SEQ-TEST-RW-07.
108000 SEQ-DELETE-07.
108100     MOVE   "*" TO DELETE-SW-2.
108200     GO TO   SEQ-DELETE-07-01.
108300 SEQ-TEST-RW-07.
108400     REWRITE SQ-FS4R1-F-G-120.
108500     MOVE    0 TO REC-CT.
108600     MOVE   "REWRITE AFTER AT END" TO FEATURE.
108700     MOVE   "SEQ-TEST-RW-07" TO PAR-NAME.
108800*
108900*    CHECK I-O STATUS RETURNED FROM REWRITE
109000*
109100     ADD    1 TO REC-CT.
109200     IF DELETE-SW NOT = SPACE
109300         GO TO   SEQ-DELETE-07-01.
109400     GO TO   SEQ-TEST-RW-07-01.
109500 SEQ-DELETE-07-01.
109600     PERFORM DE-LETE.
109700     GO TO   SEQ-TEST-07-01-END.
109800 SEQ-TEST-RW-07-01.
109900     IF SQ-FS4-STATUS = "43"
110000         PERFORM PASS
110100     ELSE
110200         MOVE    SQ-FS4-STATUS TO COMPUTED-A
110300         MOVE   "43" TO CORRECT-A
110400         MOVE   "UNEXPECTED STATUS CODE FROM FAILED REWRITE"
110500                   TO RE-MARK
110600         MOVE   "VII-4,1.5.3(4)C, VII-48" TO ANSI-REFERENCE
110700         PERFORM FAIL.
110800 SEQ-TEST-07-01-END.
110900*
111000*
111100 CCVS-EXIT SECTION.
111200 CCVS-999999.
111300     GO TO   CLOSE-FILES.
