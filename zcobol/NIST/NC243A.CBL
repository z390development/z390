000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     NC243A.
000400
000500****************************************************************
000600*                                                              *
000700*    VALIDATION FOR:-                                          *
000800*                                                              *
000900*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
001000*                                                              *
001100*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001200*                                                              *
001300****************************************************************
001400*                                                              *
001500*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001600*                                                              *
001700*        X-55  - SYSTEM PRINTER NAME.                          *
001800*        X-82  - SOURCE COMPUTER NAME.                         *
001900*        X-83  - OBJECT COMPUTER NAME.                         *
002000*                                                              *
002100****************************************************************
002200*                                                              *
002300*    PROGRAM NC243A TESTS THE CONSTRUCTION AND ACCES OF A      *
002400*    SEVEN-DIMENSIONAL TABLE.   THE CONSTRUCTION IS VIA        *
002500*    SUBSCRIPTED LOOPS AND ACCESS IS BY FORMAT 4 "PERFORM"     *
002600*    STATEMENTS USING INDICES.                                 *
002700*                                                              *
002800****************************************************************
002900 ENVIRONMENT DIVISION.
003000 CONFIGURATION SECTION.
003100 SOURCE-COMPUTER.
003200     XXXXX082.
003300 OBJECT-COMPUTER.
003400     XXXXX083.
003500 INPUT-OUTPUT SECTION.
003600 FILE-CONTROL.
003700     SELECT PRINT-FILE ASSIGN TO
003800     XXXXX055.
003900 DATA DIVISION.
004000 FILE SECTION.
004100 FD  PRINT-FILE.
004200 01  PRINT-REC PICTURE X(120).
004300 01  DUMMY-RECORD PICTURE X(120).
004400 WORKING-STORAGE SECTION.
004500 77  SUB-1              PICTURE S99  VALUE ZERO.
004600 77  SUB-2              PICTURE 99   VALUE ZERO.
004700 77  SUB-3              PICTURE 99   VALUE ZERO.
004800 77   TEST-CHECK PIC X(4) VALUE SPACE.
004900 77  CON-7              PICTURE 99  VALUE 07.
005000 77  CON-10             PICTURE 99  VALUE 10.
005100 77  ELEM-HOLD-AREA               PICTURE X(15)  VALUE SPACES.
005200 77  CON-5              PICTURE 99  VALUE 05.
005300 77  SEC-HOLD-AREA                PICTURE X(11)  VALUE SPACES.
005400 77  CON-6              PICTURE 99  VALUE 06.
005500 77  GRP-HOLD-AREA                PICTURE X(5)  VALUE SPACES.
005600 77  N1                 PIC 9.
005700 77  N2                 PIC 9.
005800 77  N3                 PIC 9.
005900 77  N4                 PIC 9.
006000 77  N5                 PIC 9.
006100 77  N6                 PIC 9.
006200 77  N7                 PIC 9.
006300 01  GRP-NAME.
006400     02  FILLER              PICTURE XXX    VALUE "GRP".
006500     02  ADD-GRP             PICTURE 99     VALUE 01.
006600
006700 01  SEC-NAME.
006800     02  FILLER              PICTURE X(5)   VALUE "SEC (".
006900     02  SEC-GRP             PICTURE 99     VALUE 00.
007000     02  FILLER              PICTURE X      VALUE ",".
007100     02  ADD-SEC             PICTURE 99     VALUE 01.
007200     02  FILLER              PICTURE X      VALUE ")".
007300
007400 01  ELEM-NAME.
007500     02  FILLER              PICTURE X(6)   VALUE "ELEM (".
007600     02  ELEM-GRP            PICTURE 99     VALUE 00.
007700     02  FILLER              PICTURE X      VALUE ",".
007800     02  ELEM-SEC            PICTURE 99     VALUE 00.
007900     02  FILLER              PICTURE X      VALUE ",".
008000     02  ADD-ELEM            PICTURE 99     VALUE 01.
008100     02  FILLER              PICTURE X      VALUE ")".
008200
008300 01  3-DIMENSION-TBL.
008400     02  GRP-ENTRY OCCURS 10 TIMES INDEXED BY IDX-1.
008500         03  ENTRY-1         PICTURE X(5).
008600         03  GRP2-ENTRY OCCURS 10 TIMES INDEXED BY IDX-2.
008700             04  ENTRY-2     PICTURE X(11).
008800             04  GRP3-ENTRY OCCURS 10 TIMES INDEXED BY IDX-3.
008900                 05  ENTRY-3 PICTURE X(15).
009000
009100 01  7-DIMENSION-TBL.
009200   02  GRP-7-1-ENTRY             OCCURS 2 INDEXED BY X1.
009300     03  ENTRY-7-1               PIC XX.
009400     03  GRP-7-2-ENTRY           OCCURS 2 INDEXED BY X2.
009500       04  ENTRY-7-2             PIC XX.
009600       04  GRP-7-3-ENTRY         OCCURS 2 INDEXED BY X3.
009700         05  ENTRY-7-3           PIC XX.
009800         05  GRP-7-4-ENTRY       OCCURS 2 INDEXED BY X4.
009900           06  ENTRY-7-4         PIC XX.
010000           06  GRP-7-5-ENTRY     OCCURS 2 INDEXED BY X5.
010100             07  ENTRY-7-5       PIC XX.
010200             07  GRP-7-6-ENTRY   OCCURS 2 INDEXED BY X6.
010300               08  ENTRY-7-6     PIC XX.
010400               08  GRP-7-7-ENTRY OCCURS 2 INDEXED BY X7.
010500                 09  ENTRY-7-7   PIC XX.
010600
010700 01  WS-FLAG                     PIC X(5).
010800 01  TEST-RESULTS.
010900     02 FILLER                   PIC X      VALUE SPACE.
011000     02 FEATURE                  PIC X(20)  VALUE SPACE.
011100     02 FILLER                   PIC X      VALUE SPACE.
011200     02 P-OR-F                   PIC X(5)   VALUE SPACE.
011300     02 FILLER                   PIC X      VALUE SPACE.
011400     02  PAR-NAME.
011500       03 FILLER                 PIC X(19)  VALUE SPACE.
011600       03  PARDOT-X              PIC X      VALUE SPACE.
011700       03 DOTVALUE               PIC 99     VALUE ZERO.
011800     02 FILLER                   PIC X(8)   VALUE SPACE.
011900     02 RE-MARK                  PIC X(61).
012000 01  TEST-COMPUTED.
012100     02 FILLER                   PIC X(30)  VALUE SPACE.
012200     02 FILLER                   PIC X(17)  VALUE
012300            "       COMPUTED=".
012400     02 COMPUTED-X.
012500     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
012600     03 COMPUTED-N               REDEFINES COMPUTED-A
012700                                 PIC -9(9).9(9).
012800     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
012900     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
013000     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
013100     03       CM-18V0 REDEFINES COMPUTED-A.
013200         04 COMPUTED-18V0                    PIC -9(18).
013300         04 FILLER                           PIC X.
013400     03 FILLER PIC X(50) VALUE SPACE.
013500 01  TEST-CORRECT.
013600     02 FILLER PIC X(30) VALUE SPACE.
013700     02 FILLER PIC X(17) VALUE "       CORRECT =".
013800     02 CORRECT-X.
013900     03 CORRECT-A                  PIC X(20) VALUE SPACE.
014000     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
014100     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
014200     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
014300     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
014400     03      CR-18V0 REDEFINES CORRECT-A.
014500         04 CORRECT-18V0                     PIC -9(18).
014600         04 FILLER                           PIC X.
014700     03 FILLER PIC X(2) VALUE SPACE.
014800     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
014900 01  CCVS-C-1.
015000     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
015100-    "SS  PARAGRAPH-NAME
015200-    "       REMARKS".
015300     02 FILLER                     PIC X(20)    VALUE SPACE.
015400 01  CCVS-C-2.
015500     02 FILLER                     PIC X        VALUE SPACE.
015600     02 FILLER                     PIC X(6)     VALUE "TESTED".
015700     02 FILLER                     PIC X(15)    VALUE SPACE.
015800     02 FILLER                     PIC X(4)     VALUE "FAIL".
015900     02 FILLER                     PIC X(94)    VALUE SPACE.
016000 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
016100 01  REC-CT                        PIC 99       VALUE ZERO.
016200 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
016300 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
016400 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
016500 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
016600 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
016700 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
016800 01  L4-HOLD                       PIC XX       VALUE SPACE.
016900 01  L5-HOLD                       PIC XX       VALUE SPACE.
017000 01  L6-HOLD                       PIC XX       VALUE SPACE.
017100 01  L7-HOLD                       PIC XX       VALUE SPACE.
017200 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
017300 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
017400 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
017500 01  CCVS-H-1.
017600     02  FILLER                    PIC X(39)    VALUE SPACES.
017700     02  FILLER                    PIC X(42)    VALUE
017800     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
017900     02  FILLER                    PIC X(39)    VALUE SPACES.
018000 01  CCVS-H-2A.
018100   02  FILLER                        PIC X(40)  VALUE SPACE.
018200   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
018300   02  FILLER                        PIC XXXX   VALUE
018400     "4.2 ".
018500   02  FILLER                        PIC X(28)  VALUE
018600            " COPY - NOT FOR DISTRIBUTION".
018700   02  FILLER                        PIC X(41)  VALUE SPACE.
018800
018900 01  CCVS-H-2B.
019000   02  FILLER                        PIC X(15)  VALUE
019100            "TEST RESULT OF ".
019200   02  TEST-ID                       PIC X(9).
019300   02  FILLER                        PIC X(4)   VALUE
019400            " IN ".
019500   02  FILLER                        PIC X(12)  VALUE
019600     " HIGH       ".
019700   02  FILLER                        PIC X(22)  VALUE
019800            " LEVEL VALIDATION FOR ".
019900   02  FILLER                        PIC X(58)  VALUE
020000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
020100 01  CCVS-H-3.
020200     02  FILLER                      PIC X(34)  VALUE
020300            " FOR OFFICIAL USE ONLY    ".
020400     02  FILLER                      PIC X(58)  VALUE
020500     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
020600     02  FILLER                      PIC X(28)  VALUE
020700            "  COPYRIGHT   1985 ".
020800 01  CCVS-E-1.
020900     02 FILLER                       PIC X(52)  VALUE SPACE.
021000     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
021100     02 ID-AGAIN                     PIC X(9).
021200     02 FILLER                       PIC X(45)  VALUE SPACES.
021300 01  CCVS-E-2.
021400     02  FILLER                      PIC X(31)  VALUE SPACE.
021500     02  FILLER                      PIC X(21)  VALUE SPACE.
021600     02 CCVS-E-2-2.
021700         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
021800         03 FILLER                   PIC X      VALUE SPACE.
021900         03 ENDER-DESC               PIC X(44)  VALUE
022000            "ERRORS ENCOUNTERED".
022100 01  CCVS-E-3.
022200     02  FILLER                      PIC X(22)  VALUE
022300            " FOR OFFICIAL USE ONLY".
022400     02  FILLER                      PIC X(12)  VALUE SPACE.
022500     02  FILLER                      PIC X(58)  VALUE
022600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
022700     02  FILLER                      PIC X(13)  VALUE SPACE.
022800     02 FILLER                       PIC X(15)  VALUE
022900             " COPYRIGHT 1985".
023000 01  CCVS-E-4.
023100     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
023200     02 FILLER                       PIC X(4)   VALUE " OF ".
023300     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
023400     02 FILLER                       PIC X(40)  VALUE
023500      "  TESTS WERE EXECUTED SUCCESSFULLY".
023600 01  XXINFO.
023700     02 FILLER                       PIC X(19)  VALUE
023800            "*** INFORMATION ***".
023900     02 INFO-TEXT.
024000       04 FILLER                     PIC X(8)   VALUE SPACE.
024100       04 XXCOMPUTED                 PIC X(20).
024200       04 FILLER                     PIC X(5)   VALUE SPACE.
024300       04 XXCORRECT                  PIC X(20).
024400     02 INF-ANSI-REFERENCE           PIC X(48).
024500 01  HYPHEN-LINE.
024600     02 FILLER  PIC IS X VALUE IS SPACE.
024700     02 FILLER  PIC IS X(65)    VALUE IS "************************
024800-    "*****************************************".
024900     02 FILLER  PIC IS X(54)    VALUE IS "************************
025000-    "******************************".
025100 01  CCVS-PGM-ID                     PIC X(9)   VALUE
025200     "NC243A".
025300 PROCEDURE DIVISION.
025400 CCVS1 SECTION.
025500 OPEN-FILES.
025600     OPEN     OUTPUT PRINT-FILE.
025700     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
025800     MOVE    SPACE TO TEST-RESULTS.
025900     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
026000     GO TO CCVS1-EXIT.
026100 CLOSE-FILES.
026200     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
026300 TERMINATE-CCVS.
026400S    EXIT PROGRAM.
026500STERMINATE-CALL.
026600     STOP     RUN.
026700 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
026800 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
026900 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
027000 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
027100     MOVE "****TEST DELETED****" TO RE-MARK.
027200 PRINT-DETAIL.
027300     IF REC-CT NOT EQUAL TO ZERO
027400             MOVE "." TO PARDOT-X
027500             MOVE REC-CT TO DOTVALUE.
027600     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
027700     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
027800        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
027900          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
028000     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
028100     MOVE SPACE TO CORRECT-X.
028200     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
028300     MOVE     SPACE TO RE-MARK.
028400 HEAD-ROUTINE.
028500     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028600     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028700     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
028800     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
028900 COLUMN-NAMES-ROUTINE.
029000     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029100     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
029300 END-ROUTINE.
029400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
029500 END-RTN-EXIT.
029600     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029700 END-ROUTINE-1.
029800      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
029900      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
030000      ADD PASS-COUNTER TO ERROR-HOLD.
030100*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
030200      MOVE PASS-COUNTER TO CCVS-E-4-1.
030300      MOVE ERROR-HOLD TO CCVS-E-4-2.
030400      MOVE CCVS-E-4 TO CCVS-E-2-2.
030500      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
030600  END-ROUTINE-12.
030700      MOVE "TEST(S) FAILED" TO ENDER-DESC.
030800     IF       ERROR-COUNTER IS EQUAL TO ZERO
030900         MOVE "NO " TO ERROR-TOTAL
031000         ELSE
031100         MOVE ERROR-COUNTER TO ERROR-TOTAL.
031200     MOVE     CCVS-E-2 TO DUMMY-RECORD.
031300     PERFORM WRITE-LINE.
031400 END-ROUTINE-13.
031500     IF DELETE-COUNTER IS EQUAL TO ZERO
031600         MOVE "NO " TO ERROR-TOTAL  ELSE
031700         MOVE DELETE-COUNTER TO ERROR-TOTAL.
031800     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
031900     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
032000      IF   INSPECT-COUNTER EQUAL TO ZERO
032100          MOVE "NO " TO ERROR-TOTAL
032200      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
032300      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
032400      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
032500     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
032600 WRITE-LINE.
032700     ADD 1 TO RECORD-COUNT.
032800Y    IF RECORD-COUNT GREATER 50
032900Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
033000Y        MOVE SPACE TO DUMMY-RECORD
033100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
033200Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
033300Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
033400Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
033500Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
033600Y        MOVE ZERO TO RECORD-COUNT.
033700     PERFORM WRT-LN.
033800 WRT-LN.
033900     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
034000     MOVE SPACE TO DUMMY-RECORD.
034100 BLANK-LINE-PRINT.
034200     PERFORM WRT-LN.
034300 FAIL-ROUTINE.
034400     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
034500     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
034600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
034700     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
034800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034900     MOVE   SPACES TO INF-ANSI-REFERENCE.
035000     GO TO  FAIL-ROUTINE-EX.
035100 FAIL-ROUTINE-WRITE.
035200     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
035300     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
035400     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
035500     MOVE   SPACES TO COR-ANSI-REFERENCE.
035600 FAIL-ROUTINE-EX. EXIT.
035700 BAIL-OUT.
035800     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
035900     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
036000 BAIL-OUT-WRITE.
036100     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
036200     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
036300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036400     MOVE   SPACES TO INF-ANSI-REFERENCE.
036500 BAIL-OUT-EX. EXIT.
036600 CCVS1-EXIT.
036700     EXIT.
036800 SECT-NC243A-001 SECTION.
036900 TH-17-001.
037000
037100 BUILD-LEVEL-1.
037200     ADD 1 TO SUB-1.
037300     IF SUB-1 = 11 GO TO CHECK-ENTRIES.
037400     MOVE GRP-NAME TO ENTRY-1 (SUB-1).
037500     ADD 1 TO ADD-GRP.
037600
037700 BUILD-LEVEL-2.
037800     ADD 1 TO SUB-2.
037900     IF SUB-2 = 11
038000         MOVE ZERO TO SUB-2
038100         MOVE 01 TO ADD-SEC
038200         GO TO BUILD-LEVEL-1.
038300     MOVE SUB-1 TO SEC-GRP.
038400     MOVE SEC-NAME TO ENTRY-2 (SUB-1, SUB-2).
038500     ADD 1 TO ADD-SEC.
038600
038700 BUILD-LEVEL-3.
038800     ADD 1 TO SUB-3.
038900     IF SUB-3 = 11
039000         MOVE ZERO TO SUB-3
039100              MOVE 01 TO ADD-ELEM
039200              GO TO BUILD-LEVEL-2.
039300     MOVE SUB-1 TO ELEM-GRP.
039400     MOVE SUB-2 TO ELEM-SEC.
039500     MOVE ELEM-NAME TO ENTRY-3 (SUB-1, SUB-2, SUB-3).
039600     ADD 1 TO ADD-ELEM.
039700     GO TO BUILD-LEVEL-3.
039800
039900 CHECK-ENTRIES.
040000     MOVE "PERFORM VARYING LEV1" TO FEATURE.
040100     MOVE "CHECK-ENTRIES       " TO PAR-NAME.
040200     MOVE SPACES TO TEST-CHECK.
040300     MOVE "GRP05" TO GRP-HOLD-AREA.
040400     PERFORM FIND-LEVEL-1-ENTRY VARYING IDX-1 FROM 1 BY 1
040500         UNTIL IDX-1 GREATER 10.
040600     IF TEST-CHECK = "PASS" GO TO LEVEL-1-TEST-2.
040700     MOVE GRP-HOLD-AREA TO CORRECT-A.
040800     MOVE ENTRY-1 (05) TO COMPUTED-A.
040900
041000     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
041100     PERFORM FAIL-TH.
041200
041300 LEVEL-1-TEST-2.
041400     MOVE "GRP10" TO GRP-HOLD-AREA.
041500     MOVE "LEVEL-1-TEST-2      " TO PAR-NAME.
041600     MOVE SPACES TO TEST-CHECK.
041700     PERFORM FIND-LEVEL-1-ENTRY VARYING IDX-1 FROM 1 BY 1
041800         UNTIL IDX-1 GREATER 10.
041900     IF TEST-CHECK = "PASS" GO TO LEVEL-1-TEST-3.
042000     MOVE GRP-HOLD-AREA TO CORRECT-A.
042100     MOVE ENTRY-1 (10) TO COMPUTED-A.
042200
042300     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
042400     PERFORM FAIL-TH.
042500
042600 LEVEL-1-TEST-3.
042700     MOVE "GRP07" TO GRP-HOLD-AREA.
042800     MOVE "LEVEL-1-TEST-3      " TO PAR-NAME.
042900     MOVE SPACES TO TEST-CHECK.
043000     PERFORM FIND-LEVEL-1-ENTRY VARYING IDX-1 FROM 1 BY 1
043100         UNTIL IDX-1 GREATER 10.
043200     IF TEST-CHECK = "PASS" GO TO LEVEL-1-TEST-4.
043300     MOVE GRP-HOLD-AREA TO CORRECT-A.
043400     MOVE ENTRY-1 (07) TO COMPUTED-A.
043500
043600     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
043700     PERFORM FAIL-TH.
043800 LEVEL-1-TEST-4.
043900     MOVE "LEVEL-1-TEST-4      " TO PAR-NAME.
044000     MOVE "GRP01" TO GRP-HOLD-AREA.
044100     PERFORM FIND-LEVEL-1-ENTRY VARYING IDX-1 FROM 1 BY 1
044200         UNTIL IDX-1 GREATER 10.
044300     IF TEST-CHECK = "PASS" GO TO LEVEL-2-TEST-1.
044400     MOVE GRP-HOLD-AREA TO CORRECT-A.
044500     MOVE ENTRY-1 (01) TO COMPUTED-A.
044600
044700     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
044800     PERFORM FAIL-TH.
044900     GO TO LEVEL-2-TEST-1.
045000
045100 FIND-LEVEL-1-ENTRY.
045200     IF ENTRY-1 (IDX-1) = GRP-HOLD-AREA
045300         MOVE "PASS" TO TEST-CHECK
045400         PERFORM PASS-TH.
045500
045600 LEVEL-2-TEST-1.
045700     MOVE "LEVEL-2-TEST-1      " TO PAR-NAME.
045800     MOVE "PERFORM VARYING LEV2" TO FEATURE.
045900     MOVE "SEC (03,05)" TO SEC-HOLD-AREA.
046000     MOVE SPACES TO TEST-CHECK.
046100     PERFORM FIND-LEVEL-2-ENTRY VARYING IDX-1 FROM 1 BY 1
046200         UNTIL IDX-1 GREATER 10 AFTER IDX-2 FROM 1 BY 1 UNTIL
046300         IDX-2 = 10.
046400     IF TEST-CHECK = "PASS" GO TO LEVEL-2-TEST-2.
046500     MOVE SEC-HOLD-AREA TO CORRECT-A.
046600     MOVE ENTRY-2 (03, 05) TO COMPUTED-A.
046700
046800     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
046900     PERFORM FAIL-TH.
047000
047100 LEVEL-2-TEST-2.
047200     MOVE "LEVEL-2-TEST-2      " TO PAR-NAME.
047300     MOVE SPACES TO TEST-CHECK.
047400     MOVE "SEC (01,01)" TO SEC-HOLD-AREA.
047500     PERFORM FIND-LEVEL-2-ENTRY VARYING IDX-1 FROM 1 BY 1
047600         UNTIL IDX-1 GREATER 10 AFTER IDX-2 FROM 1 BY 1
047700             UNTIL IDX-2 = 10.
047800     IF TEST-CHECK = "PASS" GO TO LEVEL-2-TEST-3.
047900     MOVE SEC-HOLD-AREA TO CORRECT-A.
048000     MOVE ENTRY-2 (01, 01) TO COMPUTED-A.
048100
048200     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
048300     PERFORM FAIL-TH.
048400
048500 LEVEL-2-TEST-3.
048600     MOVE "LEVEL-2-TEST-3      " TO PAR-NAME.
048700     MOVE SPACES TO TEST-CHECK.
048800     MOVE "SEC (10,01)" TO SEC-HOLD-AREA.
048900     PERFORM FIND-LEVEL-2-ENTRY VARYING IDX-1 FROM 1 BY 1
049000         UNTIL IDX-1 GREATER 10 AFTER IDX-2 FROM 1 BY 1
049100             UNTIL IDX-2 = 10.
049200     IF TEST-CHECK = "PASS" GO TO LEVEL-2-TEST-4.
049300     MOVE SEC-HOLD-AREA TO CORRECT-A.
049400     MOVE ENTRY-2 (10, 01) TO COMPUTED-A.
049500
049600     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
049700     PERFORM FAIL-TH.
049800 LEVEL-2-TEST-4.
049900     MOVE "LEVEL-2-TEST-4      " TO PAR-NAME.
050000     MOVE SPACES TO TEST-CHECK.
050100     MOVE SPACES TO TEST-CHECK.
050200     MOVE "SEC (10,10)" TO SEC-HOLD-AREA.
050300     PERFORM FIND-LEVEL-2-ENTRY VARYING IDX-1 FROM 2 BY 2
050400         UNTIL IDX-1 GREATER 10 AFTER IDX-2 FROM 2 BY 2
050500             UNTIL IDX-2 GREATER 10.
050600     IF TEST-CHECK = "PASS" GO TO LEVEL-3-TEST-1.
050700     MOVE SEC-HOLD-AREA TO CORRECT-A.
050800     MOVE ENTRY-2 (10, 10) TO COMPUTED-A.
050900
051000     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
051100     PERFORM FAIL-TH.
051200     GO TO LEVEL-3-TEST-1.
051300 FIND-LEVEL-2-ENTRY.
051400     IF ENTRY-2 (IDX-1, IDX-2) = SEC-HOLD-AREA
051500         MOVE "PASS" TO TEST-CHECK
051600         PERFORM PASS-TH.
051700 LEVEL-3-TEST-1.
051800     MOVE "PERFORM VARYING LEV3" TO FEATURE.
051900     MOVE SPACES TO TEST-CHECK.
052000     MOVE "LEVEL-3-TEST-1      " TO PAR-NAME.
052100     MOVE "ELEM (01,02,03)" TO ELEM-HOLD-AREA.
052200     PERFORM FIND-LEVEL-3-ENTRY VARYING IDX-1 FROM 1 BY 1
052300         UNTIL IDX-1 GREATER 10 AFTER IDX-2 FROM 1 BY 1 UNTIL
052400             IDX-2 = 10 AFTER IDX-3 FROM 1 BY 1 UNTIL
052500             IDX-3 = 10.
052600     IF TEST-CHECK = "PASS" GO TO LEVEL-3-TEST-2.
052700     MOVE ELEM-HOLD-AREA TO CORRECT-A.
052800     MOVE ENTRY-3 (01, 02, 03) TO COMPUTED-A.
052900
053000     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
053100     PERFORM FAIL-TH.
053200
053300 LEVEL-3-TEST-2.
053400     MOVE "LEVEL-3-TEST-2      " TO PAR-NAME.
053500     MOVE "ELEM (10,10,10)" TO ELEM-HOLD-AREA.
053600     MOVE SPACES TO TEST-CHECK.
053700     PERFORM FIND-LEVEL-3-ENTRY VARYING IDX-1 FROM 1 BY 1
053800         UNTIL IDX-1 GREATER 10 AFTER IDX-2 FROM 1 BY 1 UNTIL
053900         IDX-2 GREATER 10 AFTER IDX-3 FROM 1 BY 1 UNTIL
054000             IDX-3 GREATER 10.
054100     IF TEST-CHECK = "PASS" GO TO LEVEL-3-TEST-3.
054200     MOVE ELEM-HOLD-AREA TO CORRECT-A.
054300     MOVE ENTRY-3 (10, 10, 10) TO COMPUTED-A.
054400
054500     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
054600     PERFORM FAIL-TH.
054700
054800 LEVEL-3-TEST-3.
054900     MOVE "LEVEL-3-TEST-3      " TO PAR-NAME.
055000     MOVE "ELEM (08,07,06)" TO ELEM-HOLD-AREA.
055100     MOVE SPACES TO TEST-CHECK.
055200     PERFORM FIND-LEVEL-3-ENTRY VARYING IDX-1 FROM 1 BY 1
055300         UNTIL IDX-1 GREATER 10 AFTER IDX-2 FROM 1 BY 1 UNTIL
055400             IDX-2 = 10 AFTER IDX-3 FROM 1 BY 1 UNTIL
055500             IDX-3 = 10.
055600     IF TEST-CHECK = "PASS" GO TO LEVEL-3-TEST-4.
055700     MOVE ELEM-HOLD-AREA TO CORRECT-A.
055800     MOVE ENTRY-3 (08, 07, 06) TO COMPUTED-A.
055900
056000     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
056100     PERFORM FAIL-TH.
056200 LEVEL-3-TEST-4.
056300     MOVE "LEVEL-3-TEST-4      " TO PAR-NAME.
056400     MOVE SPACES TO TEST-CHECK.
056500     MOVE "ELEM (06,04,08)" TO ELEM-HOLD-AREA.
056600     PERFORM FIND-LEVEL-3-ENTRY VARYING IDX-1 FROM 3 BY 3
056700         UNTIL IDX-1 GREATER 10 AFTER IDX-2 FROM 2 BY 2 UNTIL
056800             IDX-2 GREATER 10 AFTER IDX-3 FROM 8 BY 8 UNTIL
056900             IDX-3 GREATER 10.
057000     IF TEST-CHECK = "PASS" GO TO END-3LEVEL-TEST.
057100     MOVE ELEM-HOLD-AREA TO CORRECT-A.
057200     MOVE ENTRY-3 (06, 04, 08) TO COMPUTED-A.
057300
057400     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
057500     PERFORM FAIL-TH.
057600     GO TO END-3LEVEL-TEST.
057700
057800 FIND-LEVEL-3-ENTRY.
057900     IF ENTRY-3 (IDX-1, IDX-2, IDX-3) = ELEM-HOLD-AREA
058000         MOVE "PASS" TO TEST-CHECK
058100         PERFORM PASS-TH.
058200
058300 PASS-TH.
058400     PERFORM PASS.
058500     PERFORM PRINT-DETAIL.
058600 FAIL-TH.
058700     PERFORM FAIL.
058800     PERFORM  PRINT-DETAIL.
058900 END-3LEVEL-TEST.
059000     EXIT.
059100*
059200 TH7-INIT-1.
059300     MOVE   "TH7-TEST"   TO PAR-NAME.
059400     MOVE   "VI-2 1.3.4" TO ANSI-REFERENCE.
059500     MOVE    ALL "ABCDEFGHIJKLMNOPQRSTUVWXYZ" TO 7-DIMENSION-TBL.
059600     MOVE   "KL" TO L4-HOLD.
059700     MOVE   "AB" TO L5-HOLD.
059800     MOVE   "CD" TO L6-HOLD.
059900     MOVE   "GH" TO L7-HOLD.
060000     MOVE    SPACES TO WS-FLAG.
060100     MOVE    1 TO REC-CT.
060200     GO TO   TH7-TEST-1-0.
060300 TH7-DELETE-1.
060400     PERFORM DE-LETE.
060500     PERFORM PRINT-DETAIL.
060600     GO TO   CCVS-EXIT.
060700 TH7-TEST-1-0.
060800     PERFORM TH7-FIND-LEVEL-4-ENTRY
060900             VARYING X1 FROM 1 BY 1 UNTIL X1 > 2
061000               AFTER X2 FROM 1 BY 1 UNTIL X2 > 2
061100               AFTER X3 FROM 1 BY 1 UNTIL X3 > 2
061200               AFTER X4 FROM 1 BY 1 UNTIL X4 > 2.
061300     GO TO   TH7-TEST-1-1.
061400 TH7-FIND-LEVEL-4-ENTRY.
061500     IF      ENTRY-7-4 (X1 X2 X3 X4) = L4-HOLD
061600             MOVE   "FOUND" TO WS-FLAG.
061700 TH7-TEST-1-1.
061800     IF      WS-FLAG = "FOUND"
061900             PERFORM PASS
062000             PERFORM PRINT-DETAIL
062100     ELSE
062200             MOVE   "TABLE NOT CORRECT AT 4TH LEVEL" TO RE-MARK
062300             MOVE    ENTRY-7-4 (X1 X2 X3 X4) TO COMPUTED-X
062400             MOVE    L4-HOLD TO CORRECT-X
062500             PERFORM FAIL
062600             PERFORM PRINT-DETAIL.
062700     MOVE    SPACES TO WS-FLAG.
062800     ADD     1 TO REC-CT.
062900 TH7-TEST-2-0.
063000     PERFORM TH7-FIND-LEVEL-5-ENTRY
063100             VARYING X1 FROM 1 BY 1 UNTIL X1 > 2
063200               AFTER X2 FROM 1 BY 1 UNTIL X2 > 2
063300               AFTER X3 FROM 1 BY 1 UNTIL X3 > 2
063400               AFTER X4 FROM 1 BY 1 UNTIL X4 > 2
063500               AFTER X5 FROM 1 BY 1 UNTIL X5 > 2.
063600     GO TO   TH7-TEST-2-1.
063700 TH7-FIND-LEVEL-5-ENTRY.
063800     IF      ENTRY-7-5 (X1 X2 X3 X4 X5) = L5-HOLD
063900             MOVE   "FOUND" TO WS-FLAG.
064000 TH7-TEST-2-1.
064100     IF      WS-FLAG = "FOUND"
064200             PERFORM PASS
064300             PERFORM PRINT-DETAIL
064400     ELSE
064500             MOVE   "TABLE NOT CORRECT AT 5TH LEVEL" TO RE-MARK
064600             MOVE    ENTRY-7-5 (X1 X2 X3 X4 X5) TO COMPUTED-X
064700             MOVE    L5-HOLD TO CORRECT-X
064800             PERFORM FAIL
064900             PERFORM PRINT-DETAIL.
065000     MOVE    SPACES TO WS-FLAG.
065100     ADD     1 TO REC-CT.
065200 TH7-TEST-3-0.
065300     PERFORM TH7-FIND-LEVEL-6-ENTRY
065400             VARYING X1 FROM 1 BY 1 UNTIL X1 > 2
065500               AFTER X2 FROM 1 BY 1 UNTIL X2 > 2
065600               AFTER X3 FROM 1 BY 1 UNTIL X3 > 2
065700               AFTER X4 FROM 1 BY 1 UNTIL X4 > 2
065800               AFTER X5 FROM 1 BY 1 UNTIL X5 > 2
065900               AFTER X6 FROM 1 BY 1 UNTIL X6 > 2.
066000     GO TO   TH7-TEST-3-1.
066100 TH7-FIND-LEVEL-6-ENTRY.
066200     IF      ENTRY-7-6 (X1 X2 X3 X4 X5 X6) = L6-HOLD
066300             MOVE   "FOUND" TO WS-FLAG.
066400 TH7-TEST-3-1.
066500     IF      WS-FLAG = "FOUND"
066600             PERFORM PASS
066700             PERFORM PRINT-DETAIL
066800     ELSE
066900             MOVE   "TABLE NOT CORRECT AT 6TH LEVEL" TO RE-MARK
067000             MOVE    ENTRY-7-6 (X1 X2 X3 X4 X5 X6) TO COMPUTED-X
067100             MOVE    L6-HOLD TO CORRECT-X
067200             PERFORM FAIL
067300             PERFORM PRINT-DETAIL.
067400     MOVE    SPACES TO WS-FLAG.
067500     ADD     1 TO REC-CT.
067600 TH7-TEST-4-0.
067700     PERFORM TH7-FIND-LEVEL-7-ENTRY
067800             VARYING X1 FROM 1 BY 1 UNTIL X1 > 2
067900               AFTER X2 FROM 1 BY 1 UNTIL X2 > 2
068000               AFTER X3 FROM 1 BY 1 UNTIL X3 > 2
068100               AFTER X4 FROM 1 BY 1 UNTIL X4 > 2
068200               AFTER X5 FROM 1 BY 1 UNTIL X5 > 2
068300               AFTER X6 FROM 1 BY 1 UNTIL X6 > 2
068400               AFTER X7 FROM 1 BY 1 UNTIL X7 > 2.
068500     GO TO   TH7-TEST-4-1.
068600 TH7-FIND-LEVEL-7-ENTRY.
068700     IF      ENTRY-7-7 (X1 X2 X3 X4 X5 X6 X7) = L7-HOLD
068800             MOVE   "FOUND" TO WS-FLAG.
068900 TH7-TEST-4-1.
069000     IF      WS-FLAG = "FOUND"
069100             PERFORM PASS
069200             PERFORM PRINT-DETAIL
069300     ELSE
069400             MOVE   "TABLE NOT CORRECT AT 6TH LEVEL" TO RE-MARK
069500             MOVE  ENTRY-7-7 (X1 X2 X3 X4 X5 X6 X7) TO COMPUTED-X
069600             MOVE    L7-HOLD TO CORRECT-X
069700             PERFORM FAIL
069800             PERFORM PRINT-DETAIL.
069900*
070000 CCVS-EXIT SECTION.
070100 CCVS-999999.
070200     GO TO CLOSE-FILES.
