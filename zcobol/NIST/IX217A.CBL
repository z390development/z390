000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IX217A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*
001400*                      THE FUNCTION OF THIS PROGRAM IS TO CREATE
001500*     THE  OPTIONAL  BUT  NOT EXISTING INDEXED FILES BY THE OPEN
001600*     I-O  AND  THE OPEN EXTEND STATEMENTS. THE FILE STATUS CODE
001700*     FOR  BOTH  FILES  MUST  BE  "05" AFTER PROCESSING THE OPEN
001800*     STATEMENT. FILE IX-FS1 CONTAINS 50 RECORDS AFTER CORRECT
001900*     EXECUTION AND FILE IX-VS1 CONTAINS 25 LONG RECORDS (240)
002000*     AND 25 SHORT RECORDS (200) AFTER CORRECT EXECUTION.
002100*
002200*
002300*       X-CARDS  WHICH MUST BE REPLACED FOR THIS PROGRAM ARE
002400*
002500*             X-24   INDEXED FILE IMPLEMENTOR-NAME IN ASSGN TO
002600*                    CLAUSE FOR DATA FILE IX-FS1
002700*             X-25   INDEXED FILE IMPLEMENTOR-NAME IN ASSGN TO
002800*                    CLAUSE FOR DATA FILE IX-VS1
002900*             X-44   INDEXED FILE IMPLEMENTOR-NAME IN ASSGN TO
003000*                    CLAUSE FOR INDEX FILE IX-FS1
003100*             X-45   INDEXED FILE IMPLEMENTOR-NAME IN ASSGN TO
003200*                    CLAUSE FOR INDEX FILE IX-VS1
003300*             X-55   IMPLEMENTOR-NAME FOR SYSTEM PRINTER
003400*             X-82   IMPLEMENTOR-NAME FOR SOURCE-COMPUTER
003500*             X-83   IMPLEMENTOR-NAME FOR OBJECT-COMPUTER
003600*
003700*         NOTE:  X-CARDS 44 AND 62          ARE OPTIONAL
003800*               AND NEED ONLY TO BE PRESENT IF THE COMPILER RE-
003900*               QUIRES THIS CODE BE AVAILABLE FOR PROPER PROGRAM
004000*               COMPILATION AND EXECUTION. IF THE VP-ROUTINE IS
004100*               USED THE  X-CARDS MAY BE AUTOMATICALLY SELECTED
004200*               FOR INCLUSION IN THE PROGRAM BY SPECIFYING THE
004300*               APPROPRIATE LETTER IN THE "*OPT" VP-ROUTINE
004400*               CONTROL CARD. THE LETTER  CORRESPONDS TO A
004500*               CHARACTER IN POSITION 7 OF THE SOURCE LINE AND
004600*               THEY ARE AS FOLLOWS
004700*
004800*                  J  SELECTS X-CARD 44
004900*                  J  SELECTS X-CARD 45
005000*                  C  SELECTS X-CARD 84
005100*
005200******************************************************
005300 ENVIRONMENT DIVISION.
005400 CONFIGURATION SECTION.
005500 SOURCE-COMPUTER.
005600     XXXXX082.
005700 OBJECT-COMPUTER.
005800     XXXXX083.
005900 INPUT-OUTPUT SECTION.
006000 FILE-CONTROL.
006100     SELECT PRINT-FILE ASSIGN TO
006200     XXXXX055.
006300
006400     SELECT OPTIONAL   IX-FS1 ASSIGN TO
006500     XXXXP024
006600J    XXXXP044
006700     ORGANIZATION IS INDEXED
006800     RECORD KEY IS IX-FS1-KEY
006900     ACCESS MODE IS DYNAMIC
007000     FILE STATUS IS IX-FS1-STATUS.
007100
007200     SELECT OPTIONAL   IX-VS1 ASSIGN TO
007300     XXXXP025
007400J    XXXXP045
007500     ORGANIZATION IS INDEXED
007600     RECORD KEY IS IX-VS1-KEY
007700     ACCESS MODE IS SEQUENTIAL
007800     FILE STATUS IS IX-VS1-STATUS.
007900
008000 DATA DIVISION.
008100 FILE SECTION.
008200 FD  PRINT-FILE.
008300 01  PRINT-REC PICTURE X(120).
008400 01  DUMMY-RECORD PICTURE X(120).
008500
008600 FD  IX-FS1
008700C    LABEL RECORD IS STANDARD
008800C    DATA RECORD IS IX-FS1R1-F-G-240
008900     BLOCK CONTAINS 1 RECORDS
009000     RECORD CONTAINS 240 CHARACTERS.
009100 01  IX-FS1R1-F-G-240.
009200     03 IX-FS1-WRK-120 PIC X(120).
009300     03 IX-FS1-GRP-120.
009400     05 FILLER   PIC   X(8).
009500     05 IX-FS1-KEY  PIC X(29).
009600     05 FILLER PIC X(83).
009700
009800 FD  IX-VS1
009900C    LABEL RECORD IS STANDARD
010000C    DATA RECORD IS IX-VS1R1-F-G-240 IX-VS1R1-F-G-200
010100     BLOCK CONTAINS 1 RECORDS
010200     RECORD VARYING  200 TO 240 DEPENDING REC-LENGTH.
010300
010400 01  IX-VS1R1-F-G-240.
010500     03 IX-VS1-WRK-120 PIC X(120).
010600     03 IX-VS1-GRP-120.
010700        05 FILLER   PIC   X(8).
010800        05 IX-VS1-KEY  PIC X(29).
010900        05 FILLER PIC X(83).
011000
011100 01  IX-VS1R1-F-G-200.
011200     03 IX-VS1-WRK-120-SHORT PIC X(120).
011300     03 IX-VS1-GRP-80.
011400        05 FILLER   PIC   X(8).
011500        05 FILLER-KEY  PIC X(29).
011600        05 VIERZIG PIC X(43).
011700
011800 WORKING-STORAGE SECTION.
011900 01  REC-LENGTH       PIC 9999 VALUE ZERO.
012000 01  STATUS-ERROR     PIC    9 VALUE ZERO.
012100 01  GRP-0101.
012200     02 FILLER   PIC X(10)  VALUE "ABCDLKJXYZ".
012300     02 WRK-DU-09V00-001 PIC 9(9)  VALUE ZERO.
012400     02 FILLER  PIC X(10)  VALUE "ZIF,.$-+CD".
012500 01  FILE-RECORD-INFORMATION-REC.
012600     03 FILE-RECORD-INFO-SKELETON.
012700        05 FILLER                 PICTURE X(48)       VALUE
012800             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
012900        05 FILLER                 PICTURE X(46)       VALUE
013000             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
013100        05 FILLER                 PICTURE X(26)       VALUE
013200             ",LFIL=000000,ORG=  ,LBLR= ".
013300        05 FILLER                 PICTURE X(37)       VALUE
013400             ",RECKEY=                             ".
013500        05 FILLER                 PICTURE X(38)       VALUE
013600             ",ALTKEY1=                             ".
013700        05 FILLER                 PICTURE X(38)       VALUE
013800             ",ALTKEY2=                             ".
013900        05 FILLER                 PICTURE X(7)        VALUE SPACE.
014000     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
014100        05 FILE-RECORD-INFO-P1-120.
014200           07 FILLER              PIC X(5).
014300           07 XFILE-NAME           PIC X(6).
014400           07 FILLER              PIC X(8).
014500           07 XRECORD-NAME         PIC X(6).
014600           07 FILLER              PIC X(1).
014700           07 REELUNIT-NUMBER     PIC 9(1).
014800           07 FILLER              PIC X(7).
014900           07 XRECORD-NUMBER       PIC 9(6).
015000           07 FILLER              PIC X(6).
015100           07 UPDATE-NUMBER       PIC 9(2).
015200           07 FILLER              PIC X(5).
015300           07 ODO-NUMBER          PIC 9(4).
015400           07 FILLER              PIC X(5).
015500           07 XPROGRAM-NAME        PIC X(5).
015600           07 FILLER              PIC X(7).
015700           07 XRECORD-LENGTH       PIC 9(6).
015800           07 FILLER              PIC X(7).
015900           07 CHARS-OR-RECORDS    PIC X(2).
016000           07 FILLER              PIC X(1).
016100           07 XBLOCK-SIZE          PIC 9(4).
016200           07 FILLER              PIC X(6).
016300           07 RECORDS-IN-FILE     PIC 9(6).
016400           07 FILLER              PIC X(5).
016500           07 XFILE-ORGANIZATION   PIC X(2).
016600           07 FILLER              PIC X(6).
016700           07 XLABEL-TYPE          PIC X(1).
016800        05 FILE-RECORD-INFO-P121-240.
016900           07 FILLER              PIC X(8).
017000           07 XRECORD-KEY          PIC X(29).
017100           07 FILLER              PIC X(9).
017200           07 ALTERNATE-KEY1      PIC X(29).
017300           07 FILLER              PIC X(9).
017400           07 ALTERNATE-KEY2      PIC X(29).
017500           07 FILLER              PIC X(7).
017600
017700 01  IX-FS1-STATUS.
017800     05  IX-FS1-STAT1        PIC X.
017900     05  IX-FS1-STAT2        PIC X.
018000
018100 01  IX-VS1-STATUS.
018200     05  IX-VS1-STAT1        PIC X.
018300     05  IX-VS1-STAT2        PIC X.
018400
018500 01  TEST-RESULTS.
018600     02 FILLER                   PIC X      VALUE SPACE.
018700     02 FEATURE                  PIC X(20)  VALUE SPACE.
018800     02 FILLER                   PIC X      VALUE SPACE.
018900     02 P-OR-F                   PIC X(5)   VALUE SPACE.
019000     02 FILLER                   PIC X      VALUE SPACE.
019100     02  PAR-NAME.
019200       03 FILLER                 PIC X(19)  VALUE SPACE.
019300       03  PARDOT-X              PIC X      VALUE SPACE.
019400       03 DOTVALUE               PIC 99     VALUE ZERO.
019500     02 FILLER                   PIC X(8)   VALUE SPACE.
019600     02 RE-MARK                  PIC X(61).
019700 01  TEST-COMPUTED.
019800     02 FILLER                   PIC X(30)  VALUE SPACE.
019900     02 FILLER                   PIC X(17)  VALUE
020000            "       COMPUTED=".
020100     02 COMPUTED-X.
020200     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
020300     03 COMPUTED-N               REDEFINES COMPUTED-A
020400                                 PIC -9(9).9(9).
020500     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
020600     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
020700     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
020800     03       CM-18V0 REDEFINES COMPUTED-A.
020900         04 COMPUTED-18V0                    PIC -9(18).
021000         04 FILLER                           PIC X.
021100     03 FILLER PIC X(50) VALUE SPACE.
021200 01  TEST-CORRECT.
021300     02 FILLER PIC X(30) VALUE SPACE.
021400     02 FILLER PIC X(17) VALUE "       CORRECT =".
021500     02 CORRECT-X.
021600     03 CORRECT-A                  PIC X(20) VALUE SPACE.
021700     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
021800     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
021900     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
022000     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
022100     03      CR-18V0 REDEFINES CORRECT-A.
022200         04 CORRECT-18V0                     PIC -9(18).
022300         04 FILLER                           PIC X.
022400     03 FILLER PIC X(2) VALUE SPACE.
022500     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
022600 01  CCVS-C-1.
022700     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
022800-    "SS  PARAGRAPH-NAME
022900-    "       REMARKS".
023000     02 FILLER                     PIC X(20)    VALUE SPACE.
023100 01  CCVS-C-2.
023200     02 FILLER                     PIC X        VALUE SPACE.
023300     02 FILLER                     PIC X(6)     VALUE "TESTED".
023400     02 FILLER                     PIC X(15)    VALUE SPACE.
023500     02 FILLER                     PIC X(4)     VALUE "FAIL".
023600     02 FILLER                     PIC X(94)    VALUE SPACE.
023700 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
023800 01  REC-CT                        PIC 99       VALUE ZERO.
023900 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
024000 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
024100 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
024200 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
024300 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
024400 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
024500 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
024600 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
024700 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
024800 01  CCVS-H-1.
024900     02  FILLER                    PIC X(39)    VALUE SPACES.
025000     02  FILLER                    PIC X(42)    VALUE
025100     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
025200     02  FILLER                    PIC X(39)    VALUE SPACES.
025300 01  CCVS-H-2A.
025400   02  FILLER                        PIC X(40)  VALUE SPACE.
025500   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
025600   02  FILLER                        PIC XXXX   VALUE
025700     "4.2 ".
025800   02  FILLER                        PIC X(28)  VALUE
025900            " COPY - NOT FOR DISTRIBUTION".
026000   02  FILLER                        PIC X(41)  VALUE SPACE.
026100
026200 01  CCVS-H-2B.
026300   02  FILLER                        PIC X(15)  VALUE
026400            "TEST RESULT OF ".
026500   02  TEST-ID                       PIC X(9).
026600   02  FILLER                        PIC X(4)   VALUE
026700            " IN ".
026800   02  FILLER                        PIC X(12)  VALUE
026900     " HIGH       ".
027000   02  FILLER                        PIC X(22)  VALUE
027100            " LEVEL VALIDATION FOR ".
027200   02  FILLER                        PIC X(58)  VALUE
027300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
027400 01  CCVS-H-3.
027500     02  FILLER                      PIC X(34)  VALUE
027600            " FOR OFFICIAL USE ONLY    ".
027700     02  FILLER                      PIC X(58)  VALUE
027800     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
027900     02  FILLER                      PIC X(28)  VALUE
028000            "  COPYRIGHT   1985 ".
028100 01  CCVS-E-1.
028200     02 FILLER                       PIC X(52)  VALUE SPACE.
028300     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
028400     02 ID-AGAIN                     PIC X(9).
028500     02 FILLER                       PIC X(45)  VALUE SPACES.
028600 01  CCVS-E-2.
028700     02  FILLER                      PIC X(31)  VALUE SPACE.
028800     02  FILLER                      PIC X(21)  VALUE SPACE.
028900     02 CCVS-E-2-2.
029000         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
029100         03 FILLER                   PIC X      VALUE SPACE.
029200         03 ENDER-DESC               PIC X(44)  VALUE
029300            "ERRORS ENCOUNTERED".
029400 01  CCVS-E-3.
029500     02  FILLER                      PIC X(22)  VALUE
029600            " FOR OFFICIAL USE ONLY".
029700     02  FILLER                      PIC X(12)  VALUE SPACE.
029800     02  FILLER                      PIC X(58)  VALUE
029900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
030000     02  FILLER                      PIC X(13)  VALUE SPACE.
030100     02 FILLER                       PIC X(15)  VALUE
030200             " COPYRIGHT 1985".
030300 01  CCVS-E-4.
030400     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
030500     02 FILLER                       PIC X(4)   VALUE " OF ".
030600     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
030700     02 FILLER                       PIC X(40)  VALUE
030800      "  TESTS WERE EXECUTED SUCCESSFULLY".
030900 01  XXINFO.
031000     02 FILLER                       PIC X(19)  VALUE
031100            "*** INFORMATION ***".
031200     02 INFO-TEXT.
031300       04 FILLER                     PIC X(8)   VALUE SPACE.
031400       04 XXCOMPUTED                 PIC X(20).
031500       04 FILLER                     PIC X(5)   VALUE SPACE.
031600       04 XXCORRECT                  PIC X(20).
031700     02 INF-ANSI-REFERENCE           PIC X(48).
031800 01  HYPHEN-LINE.
031900     02 FILLER  PIC IS X VALUE IS SPACE.
032000     02 FILLER  PIC IS X(65)    VALUE IS "************************
032100-    "*****************************************".
032200     02 FILLER  PIC IS X(54)    VALUE IS "************************
032300-    "******************************".
032400 01  CCVS-PGM-ID                     PIC X(9)   VALUE
032500     "IX217A".
032600 PROCEDURE DIVISION.
032700 CCVS1 SECTION.
032800 OPEN-FILES.
032900     OPEN    OUTPUT PRINT-FILE.
033000     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
033100     MOVE    SPACE TO TEST-RESULTS.
033200     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
033300     MOVE    ZERO TO REC-SKL-SUB.
033400     PERFORM CCVS-INIT-FILE 9 TIMES.
033500 CCVS-INIT-FILE.
033600     ADD     1 TO REC-SKL-SUB.
033700     MOVE    FILE-RECORD-INFO-SKELETON
033800          TO FILE-RECORD-INFO (REC-SKL-SUB).
033900 CCVS-INIT-EXIT.
034000     GO TO CCVS1-EXIT.
034100 CLOSE-FILES.
034200     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
034300 TERMINATE-CCVS.
034400     STOP     RUN.
034500 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
034600 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
034700 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
034800 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
034900     MOVE "****TEST DELETED****" TO RE-MARK.
035000 PRINT-DETAIL.
035100     IF REC-CT NOT EQUAL TO ZERO
035200             MOVE "." TO PARDOT-X
035300             MOVE REC-CT TO DOTVALUE.
035400     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
035500     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
035600        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
035700          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
035800     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
035900     MOVE SPACE TO CORRECT-X.
036000     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
036100     MOVE     SPACE TO RE-MARK.
036200 HEAD-ROUTINE.
036300     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036400     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036500     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
036600     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
036700 COLUMN-NAMES-ROUTINE.
036800     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036900     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
037100 END-ROUTINE.
037200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
037300 END-RTN-EXIT.
037400     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037500 END-ROUTINE-1.
037600      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
037700      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
037800      ADD PASS-COUNTER TO ERROR-HOLD.
037900*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
038000      MOVE PASS-COUNTER TO CCVS-E-4-1.
038100      MOVE ERROR-HOLD TO CCVS-E-4-2.
038200      MOVE CCVS-E-4 TO CCVS-E-2-2.
038300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
038400  END-ROUTINE-12.
038500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
038600     IF       ERROR-COUNTER IS EQUAL TO ZERO
038700         MOVE "NO " TO ERROR-TOTAL
038800         ELSE
038900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
039000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
039100     PERFORM WRITE-LINE.
039200 END-ROUTINE-13.
039300     IF DELETE-COUNTER IS EQUAL TO ZERO
039400         MOVE "NO " TO ERROR-TOTAL  ELSE
039500         MOVE DELETE-COUNTER TO ERROR-TOTAL.
039600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
039700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
039800      IF   INSPECT-COUNTER EQUAL TO ZERO
039900          MOVE "NO " TO ERROR-TOTAL
040000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
040100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
040200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
040300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
040400 WRITE-LINE.
040500     ADD 1 TO RECORD-COUNT.
040600Y    IF RECORD-COUNT GREATER 42
040700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
040800Y        MOVE SPACE TO DUMMY-RECORD
040900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
041000Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
041100Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
041200Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
041300Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
041400Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
041500Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
041600Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
041700Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
041800Y        MOVE ZERO TO RECORD-COUNT.
041900     PERFORM WRT-LN.
042000 WRT-LN.
042100     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
042200     MOVE SPACE TO DUMMY-RECORD.
042300 BLANK-LINE-PRINT.
042400     PERFORM WRT-LN.
042500 FAIL-ROUTINE.
042600     IF     COMPUTED-X NOT EQUAL TO SPACE
042700            GO TO   FAIL-ROUTINE-WRITE.
042800     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
042900     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
043000     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
043100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043200     MOVE   SPACES TO INF-ANSI-REFERENCE.
043300     GO TO  FAIL-ROUTINE-EX.
043400 FAIL-ROUTINE-WRITE.
043500     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
043600     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
043700     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
043800     MOVE   SPACES TO COR-ANSI-REFERENCE.
043900 FAIL-ROUTINE-EX. EXIT.
044000 BAIL-OUT.
044100     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
044200     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
044300 BAIL-OUT-WRITE.
044400     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
044500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
044600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044700     MOVE   SPACES TO INF-ANSI-REFERENCE.
044800 BAIL-OUT-EX. EXIT.
044900 CCVS1-EXIT.
045000     EXIT.
045100
045200******************************************************************
045300*   TEST  1                                                      *
045400*         OPEN I-O  (ACCESS IS DYNAMIC) OPTIONAL NOT EXISTING FILE
045500*                                       05  EXPECTED             *
045600*         IX-3, 1.3.4 (1) D                                      *
045700******************************************************************
045800 SECT-IX-01-001 SECTION.
045900 OPN-INIT-GF-01.
046000     MOVE SPACES TO IX-FS1-STATUS.
046100     MOVE "OPEN I-O:    05 EXP." TO FEATURE.
046200     MOVE "OPN-TEST-GF-01      " TO PAR-NAME.
046300 OPN-TEST-GF-01.
046400     OPEN
046500          I-O     IX-FS1.
046600     IF IX-FS1-STATUS      = "05"
046700         GO TO OPN-PASS-GF-01.
046800 OPN-FAIL-GF-01.
046900     MOVE "IX-3, 1.3.4, (1) D. " TO RE-MARK.
047000     PERFORM FAIL.
047100     MOVE IX-FS1-STATUS TO COMPUTED-A.
047200     MOVE "05" TO CORRECT-X.
047300     GO TO OPN-WRITE-GF-01.
047400 OPN-PASS-GF-01.
047500     PERFORM PASS.
047600 OPN-WRITE-GF-01.
047700     PERFORM PRINT-DETAIL.
047800
047900******************************************************************
048000*   TEST  2                                                      *
048100*         WRITE                            00 EXPECTED           *
048200*         IX-3, 1.3.4 (1) A                                      *
048300******************************************************************
048400 WRI-INIT-GF-01.
048500     MOVE    240 TO REC-LENGTH.
048600     MOVE   ZERO TO STATUS-ERROR.
048700     MOVE     "WRI-TEST-GF-01  " TO PAR-NAME
048800     MOVE     "WRITE (OPT)F 00 EXP." TO FEATURE.
048900     MOVE     "IX-FS1" TO XFILE-NAME (1).
049000     MOVE    "IX-F-G" TO XRECORD-NAME (1).
049100     MOVE  CCVS-PGM-ID TO XPROGRAM-NAME (1).
049200     MOVE    000240  TO XRECORD-LENGTH (1).
049300     MOVE     "RC"     TO CHARS-OR-RECORDS (1).
049400     MOVE     0001     TO XBLOCK-SIZE (1).
049500     MOVE     000500   TO RECORDS-IN-FILE (1).
049600     MOVE    "IX"  TO XFILE-ORGANIZATION (1).
049700     MOVE     "S"      TO XLABEL-TYPE (1).
049800     MOVE     000001   TO XRECORD-NUMBER (1).
049900 WRI-TEST-GF-01.
050000     MOVE    XRECORD-NUMBER (1) TO WRK-DU-09V00-001.
050100     MOVE    GRP-0101 TO XRECORD-KEY (1).
050200     MOVE    FILE-RECORD-INFO (1) TO IX-FS1R1-F-G-240.
050300     WRITE   IX-FS1R1-F-G-240
050400              INVALID KEY GO TO WRI-FAIL-GF-01.
050500     IF IX-FS1-STATUS NOT EQUAL TO "00"
050600          MOVE 1 TO STATUS-ERROR.
050700     IF      XRECORD-NUMBER (1) EQUAL TO 50
050800             GO TO WRI-TEST-GF-01-1.
050900     ADD      000001 TO XRECORD-NUMBER (1).
051000     GO       TO WRI-TEST-GF-01.
051100 WRI-TEST-GF-01-1.
051200     IF STATUS-ERROR EQUAL TO ZERO
051300                GO TO WRI-PASS-GF-01.
051400 WRI-FAIL-GF-01.
051500     MOVE "IX-3, 1.3.4, (1) A. " TO RE-MARK.
051600     PERFORM FAIL.
051700     GO TO WRI-WRITE-GF-01.
051800 WRI-PASS-GF-01.
051900     PERFORM PASS.
052000 WRI-WRITE-GF-01.
052100     PERFORM PRINT-DETAIL.
052200
052300     CLOSE    IX-FS1.
052400******************************************************************
052500*   TEST  3                                                      *
052600*         READ                               00 EXPECTED         *
052700*         IX-3, 1.3.4 (1) A                                      *
052800******************************************************************
052900 READ-INIT-F1-01.
053000     OPEN     INPUT     IX-FS1.
053100     MOVE   ZERO TO WRK-DU-09V00-001.
053200 READ-TEST-F1-01.
053300     READ     IX-FS1 NEXT RECORD
053400              AT END GO TO READ-TEST-F1-01-1.
053500     MOVE    IX-FS1R1-F-G-240 TO FILE-RECORD-INFO (1).
053600     ADD     1  TO WRK-DU-09V00-001.
053700     IF      WRK-DU-09V00-001     GREATER 50
053800             MOVE "MORE THAN 50  RECORDS" TO RE-MARK
053900              GO TO READ-TEST-F1-01-1.
054000     IF XRECORD-NUMBER (1) = WRK-DU-09V00-001
054100             GO TO READ-TEST-F1-01
054200         ELSE
054300             MOVE "WRONG RECORD NUMBER" TO RE-MARK
054400             PERFORM FAIL
054500             MOVE "READ (TO VERIFY)" TO FEATURE
054600             MOVE "READ-TEST-F1-01" TO PAR-NAME
054700             PERFORM PRINT-DETAIL
054800             GO TO READ-TEST-F1-01-3.
054900 READ-TEST-F1-01-1.
055000     IF       XRECORD-NUMBER (1) NOT EQUAL TO 50
055100              PERFORM FAIL
055200              ELSE
055300              PERFORM PASS.
055400     GO       TO READ-TEST-F1-01-2.
055500 READ-TEST-F1-01-2.
055600     MOVE     "READ  (TO VERIFY)   " TO FEATURE.
055700     MOVE     "READ-TEST-F1-01" TO PAR-NAME.
055800     MOVE     "FILE VERIFIED, LFILE" TO COMPUTED-A.
055900     MOVE    XRECORD-NUMBER (1) TO CORRECT-18V0.
056000     PERFORM  PRINT-DETAIL.
056100 READ-TEST-F1-01-3.
056200     CLOSE   IX-FS1.
056300
056400******************************************************************
056500*   TEST  4                                                      *
056600*       OPEN EXTEND (ACCESS IS DYNAMIC) OPTIONAL NOT EXISTING FILE
056700*                                       05  EXPECTED             *
056800*         IX-3, 1.3.4 (1) D                                      *
056900******************************************************************
057000 OPN-INIT-GF-02.
057100     MOVE SPACES TO IX-VS1-STATUS.
057200     MOVE "OPEN EXTEND: 05 EXP." TO FEATURE.
057300     MOVE "OPN-TEST-GF-02      " TO PAR-NAME.
057400 OPN-TEST-GF-02.
057500     OPEN
057600          EXTEND  IX-VS1.
057700     IF IX-VS1-STATUS      = "05"
057800         GO TO OPN-PASS-GF-02.
057900 OPN-FAIL-GF-02.
058000     MOVE "IX-3, 1.3.4, (1) D. " TO RE-MARK.
058100     PERFORM FAIL.
058200     MOVE IX-VS1-STATUS TO COMPUTED-A.
058300     MOVE "05" TO CORRECT-X.
058400     GO TO OPN-WRITE-GF-02.
058500 OPN-PASS-GF-02.
058600     PERFORM PASS.
058700 OPN-WRITE-GF-02.
058800     PERFORM PRINT-DETAIL.
058900
059000******************************************************************
059100*   TEST  5                                                      *
059200*         WRITE                            00 EXPECTED           *
059300*         IX-3, 1.3.4 (1) A                                      *
059400******************************************************************
059500 WRI-INIT-GF-02.
059600     MOVE    240 TO REC-LENGTH.
059700     MOVE   ZERO TO STATUS-ERROR.
059800     MOVE     "WRI-TEST-GF-02  " TO PAR-NAME
059900     MOVE     "WRITE (OPT)S 00 EXP." TO FEATURE.
060000     MOVE     "IX-VS1" TO XFILE-NAME (1).
060100     MOVE    " LONG " TO XRECORD-NAME (1).
060200     MOVE  CCVS-PGM-ID TO XPROGRAM-NAME (1).
060300     MOVE    000240  TO XRECORD-LENGTH (1).
060400     MOVE     "RC"     TO CHARS-OR-RECORDS (1).
060500     MOVE     0001     TO XBLOCK-SIZE (1).
060600     MOVE     000500   TO RECORDS-IN-FILE (1).
060700     MOVE    "IX"  TO XFILE-ORGANIZATION (1).
060800     MOVE     "S"      TO XLABEL-TYPE (1).
060900     MOVE     000001   TO XRECORD-NUMBER (1).
061000 WRI-TEST-GF-02.
061100     MOVE    XRECORD-NUMBER (1) TO WRK-DU-09V00-001.
061200     MOVE    GRP-0101 TO XRECORD-KEY (1).
061300     MOVE    FILE-RECORD-INFO (1) TO IX-VS1R1-F-G-240.
061400     IF XRECORD-NUMBER (1) LESS THAN 26
061500         WRITE   IX-VS1R1-F-G-240
061600              INVALID KEY GO TO WRI-FAIL-GF-02.
061700     IF IX-VS1-STATUS NOT EQUAL TO "00"
061800          MOVE 1 TO STATUS-ERROR.
061900     IF XRECORD-NUMBER (1) GREATER THAN 25
062000         WRITE   IX-VS1R1-F-G-200
062100              INVALID KEY GO TO WRI-FAIL-GF-02.
062200     IF IX-VS1-STATUS NOT EQUAL TO "00"
062300          MOVE 1 TO STATUS-ERROR.
062400     IF      XRECORD-NUMBER (1) EQUAL TO 50
062500             GO TO WRI-TEST-GF-02-1.
062600     IF      XRECORD-NUMBER (1) EQUAL TO 25
062700             MOVE " SHORT" TO XRECORD-NAME   (1)
062800             MOVE 200 TO REC-LENGTH
062900             MOVE 000200 TO XRECORD-LENGTH (1).
063000     ADD      000001 TO XRECORD-NUMBER (1).
063100     GO       TO WRI-TEST-GF-02.
063200 WRI-TEST-GF-02-1.
063300     IF STATUS-ERROR EQUAL TO ZERO
063400                GO TO WRI-PASS-GF-02.
063500 WRI-FAIL-GF-02.
063600     MOVE "IX-3, 1.3.4, (1) A. " TO RE-MARK.
063700     PERFORM FAIL.
063800     GO TO WRI-WRITE-GF-02.
063900 WRI-PASS-GF-02.
064000     PERFORM PASS.
064100 WRI-WRITE-GF-02.
064200     PERFORM PRINT-DETAIL.
064300
064400     CLOSE    IX-VS1.
064500******************************************************************
064600*   TEST  6                                                      *
064700*         READ                               00 EXPECTED         *
064800*         IX-3, 1.3.4 (1) A                                      *
064900******************************************************************
065000 READ-INIT-F1-02.
065100     OPEN     INPUT     IX-VS1.
065200     MOVE   ZERO TO WRK-DU-09V00-001.
065300 READ-TEST-F1-02.
065400     READ     IX-VS1 NEXT RECORD
065500              AT END GO TO READ-TEST-F1-02-1.
065600     MOVE    IX-VS1R1-F-G-240 TO FILE-RECORD-INFO (1).
065700     ADD     1  TO WRK-DU-09V00-001.
065800     IF      WRK-DU-09V00-001     GREATER 50
065900             MOVE "MORE THAN 50  RECORDS" TO RE-MARK
066000              GO TO READ-TEST-F1-02-1.
066100     IF XRECORD-NUMBER (1) = WRK-DU-09V00-001
066200              GO TO READ-TEST-F1-02
066300         ELSE
066400              MOVE "WRONG RECORD NUMBER" TO RE-MARK
066500              PERFORM FAIL
066600              MOVE "READ (TO VERIFY)" TO FEATURE
066700              MOVE "READ-TEST-F1-02" TO PAR-NAME
066800              PERFORM PRINT-DETAIL
066900              GO TO READ-TEST-F1-02-3.
067000 READ-TEST-F1-02-1.
067100     IF       XRECORD-NUMBER (1) NOT EQUAL TO 50
067200              PERFORM FAIL
067300              ELSE
067400              PERFORM PASS.
067500 READ-TEST-F1-02-2.
067600     MOVE     "READ  (TO VERIFY)   " TO FEATURE.
067700     MOVE     "READ-TEST-F1-02" TO PAR-NAME.
067800     MOVE     "FILE VERIFIED, LFILE" TO COMPUTED-A.
067900     MOVE    XRECORD-NUMBER (1) TO CORRECT-18V0.
068000     PERFORM  PRINT-DETAIL.
068100 READ-TEST-F1-02-3.
068200     CLOSE   IX-VS1.
068300
068400
068500 CCVS-EXIT SECTION.
068600 CCVS-999999.
068700     GO TO CLOSE-FILES.
