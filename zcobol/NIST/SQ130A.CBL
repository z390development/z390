000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ130A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
000900*                             REVISED 1986, AUGUST             *
001000*                                                              *
001100*    CREATION DATE     /     VALIDATION DATE                   *
001200*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001300*                                                              *
001400****************************************************************
001500*                                                              *
001600*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001700*                                                              *
001800*            X-14   SEQUENTIAL MASS STORAGE FILE               *
001900*            X-55   SYSTEM PRINTER                             *
002000*            X-82   SOURCE-COMPUTER                            *
002100*            X-83   OBJECT-COMPUTER.                           *
002200*                                                              *
002300*                                                              *
002400****************************************************************
002500*                                                              *
002600*    SQ130A ATTEMPTS TO OPEN FOR INPUT-OUTPUT A MASS STORAGE   *
002700*    FILE WHICH IS NOT PRESENT.  THIS SHOULD RESULT IN A       *
002800*    PERMANENT ERROR AND AN I-O STATUS OF "35".  THE PROGRAM   *
002900*    DOES NOT CONTAIN AN APPLICABLE DECLARATIVE PROCEDURE. IN  *
003000*    THESE CIRCUMSTANCES THE STANDARD ALLOWS THE IMPLEMENTOR   *
003100*    TO TERMINATE EXECUTION OF THE PROGRAM OR TO CONTINUE.     *
003200*                                                              *
003300****************************************************************
003400*
003500 ENVIRONMENT DIVISION.
003600 CONFIGURATION SECTION.
003700 SOURCE-COMPUTER.
003800     XXXXX082.
003900 OBJECT-COMPUTER.
004000     XXXXX083.
004100*
004200 INPUT-OUTPUT SECTION.
004300 FILE-CONTROL.
004400     SELECT PRINT-FILE ASSIGN TO
004500     XXXXX055.
004600*
004700P    SELECT RAW-DATA   ASSIGN TO
004800P    XXXXX062
004900P          ORGANIZATION IS INDEXED
005000P          ACCESS MODE  IS RANDOM
005100P          RECORD-KEY   IS RAW-DATA-KEY.
005200P
005300     SELECT SQ-FS1 ASSIGN TO
005400     XXXXX014
005500            FILE STATUS IS SQ-FS1-STATUS.
005600*
005700*
005800 DATA DIVISION.
005900 FILE SECTION.
006000 FD  PRINT-FILE
006100C    LABEL RECORDS
006200C    XXXXX084
006300C    DATA RECORD IS PRINT-REC DUMMY-RECORD
006400               .
006500 01  PRINT-REC    PICTURE X(120).
006600 01  DUMMY-RECORD PICTURE X(120).
006700P
006800PFD  RAW-DATA.
006900P01  RAW-DATA-SATZ.
007000P    05  RAW-DATA-KEY        PIC X(6).
007100P    05  C-DATE              PIC 9(6).
007200P    05  C-TIME              PIC 9(8).
007300P    05  NO-OF-TESTS         PIC 99.
007400P    05  C-OK                PIC 999.
007500P    05  C-ALL               PIC 999.
007600P    05  C-FAIL              PIC 999.
007700P    05  C-DELETED           PIC 999.
007800P    05  C-INSPECT           PIC 999.
007900P    05  C-NOTE              PIC X(13).
008000P    05  C-INDENT            PIC X.
008100P    05  C-ABORT             PIC X(8).
008200*
008300 FD  SQ-FS1
008400C    LABEL RECORD IS STANDARD
008500                .
008600 01  SQ-FS1R1-F-G-120 PIC X(120).
008700*
008800 WORKING-STORAGE SECTION.
008900*
009000***************************************************************
009100*                                                             *
009200*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
009300*                                                             *
009400***************************************************************
009500*
009600 01  SQ-FS1-STATUS.
009700   03  SQ-FS1-KEY-1   PIC X.
009800   03  SQ-FS1-KEY-2   PIC X.
009900*
010000*
010100***************************************************************
010200*                                                             *
010300*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
010400*                                                             *
010500***************************************************************
010600*
010700 01  REC-SKEL-SUB   PIC 99.
010800*
010900 01  FILE-RECORD-INFORMATION-REC.
011000     03 FILE-RECORD-INFO-SKELETON.
011100        05 FILLER                 PICTURE X(48)       VALUE
011200             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
011300        05 FILLER                 PICTURE X(46)       VALUE
011400             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
011500        05 FILLER                 PICTURE X(26)       VALUE
011600             ",LFIL=000000,ORG=  ,LBLR= ".
011700        05 FILLER                 PICTURE X(37)       VALUE
011800             ",RECKEY=                             ".
011900        05 FILLER                 PICTURE X(38)       VALUE
012000             ",ALTKEY1=                             ".
012100        05 FILLER                 PICTURE X(38)       VALUE
012200             ",ALTKEY2=                             ".
012300        05 FILLER                 PICTURE X(7)        VALUE SPACE.
012400     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
012500        05 FILE-RECORD-INFO-P1-120.
012600           07 FILLER              PIC X(5).
012700           07 XFILE-NAME          PIC X(6).
012800           07 FILLER              PIC X(8).
012900           07 XRECORD-NAME        PIC X(6).
013000           07 FILLER              PIC X(1).
013100           07 REELUNIT-NUMBER     PIC 9(1).
013200           07 FILLER              PIC X(7).
013300           07 XRECORD-NUMBER      PIC 9(6).
013400           07 FILLER              PIC X(6).
013500           07 UPDATE-NUMBER       PIC 9(2).
013600           07 FILLER              PIC X(5).
013700           07 ODO-NUMBER          PIC 9(4).
013800           07 FILLER              PIC X(5).
013900           07 XPROGRAM-NAME       PIC X(5).
014000           07 FILLER              PIC X(7).
014100           07 XRECORD-LENGTH      PIC 9(6).
014200           07 FILLER              PIC X(7).
014300           07 CHARS-OR-RECORDS    PIC X(2).
014400           07 FILLER              PIC X(1).
014500           07 XBLOCK-SIZE         PIC 9(4).
014600           07 FILLER              PIC X(6).
014700           07 RECORDS-IN-FILE     PIC 9(6).
014800           07 FILLER              PIC X(5).
014900           07 XFILE-ORGANIZATION  PIC X(2).
015000           07 FILLER              PIC X(6).
015100           07 XLABEL-TYPE         PIC X(1).
015200        05 FILE-RECORD-INFO-P121-240.
015300           07 FILLER              PIC X(8).
015400           07 XRECORD-KEY         PIC X(29).
015500           07 FILLER              PIC X(9).
015600           07 ALTERNATE-KEY1      PIC X(29).
015700           07 FILLER              PIC X(9).
015800           07 ALTERNATE-KEY2      PIC X(29).
015900           07 FILLER              PIC X(7).
016000*
016100 01  TEST-RESULTS.
016200     02 FILLER              PIC X      VALUE SPACE.
016300     02 FEATURE             PIC X(24)  VALUE SPACE.
016400     02 FILLER              PIC X      VALUE SPACE.
016500     02 P-OR-F              PIC X(5)   VALUE SPACE.
016600     02 FILLER              PIC X      VALUE SPACE.
016700     02  PAR-NAME.
016800       03 FILLER              PIC X(14)  VALUE SPACE.
016900       03 PARDOT-X            PIC X      VALUE SPACE.
017000       03 DOTVALUE            PIC 99     VALUE ZERO.
017100     02 FILLER              PIC X(9)   VALUE SPACE.
017200     02 RE-MARK             PIC X(61).
017300 01  TEST-COMPUTED.
017400   02 FILLER  PIC X(30)  VALUE SPACE.
017500   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
017600   02 COMPUTED-X.
017700     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
017800     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
017900     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
018000     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
018100     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
018200     03       CM-18V0 REDEFINES COMPUTED-A.
018300        04 COMPUTED-18V0                   PIC -9(18).
018400        04 FILLER                          PIC X.
018500     03 FILLER PIC X(50) VALUE SPACE.
018600 01  TEST-CORRECT.
018700     02 FILLER PIC X(30) VALUE SPACE.
018800     02 FILLER PIC X(17) VALUE "       CORRECT =".
018900     02 CORRECT-X.
019000     03 CORRECT-A                  PIC X(20) VALUE SPACE.
019100     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
019200     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
019300     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
019400     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
019500     03      CR-18V0 REDEFINES CORRECT-A.
019600         04 CORRECT-18V0                     PIC -9(18).
019700         04 FILLER                           PIC X.
019800     03 FILLER PIC X(2) VALUE SPACE.
019900     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
020000 01  CCVS-C-1.
020100     02 FILLER  PIC IS X(4)     VALUE SPACE.
020200     02 FILLER  PIC IS X(98)    VALUE IS "FEATURE               PA
020300-    "SS  PARAGRAPH-NAME
020400-    "       REMARKS".
020500     02 FILLER           PIC X(17)    VALUE SPACE.
020600 01  CCVS-C-2.
020700     02 FILLER           PIC XXXX     VALUE SPACE.
020800     02 FILLER           PIC X(6)     VALUE "TESTED".
020900     02 FILLER           PIC X(16)    VALUE SPACE.
021000     02 FILLER           PIC X(4)     VALUE "FAIL".
021100     02 FILLER           PIC X(90)    VALUE SPACE.
021200 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
021300 01  REC-CT            PIC 99       VALUE ZERO.
021400 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
021500 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
021600 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
021700 01  PASS-COUNTER      PIC 999      VALUE ZERO.
021800 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
021900 01  ERROR-HOLD        PIC 999      VALUE ZERO.
022000 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
022100 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
022200 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
022300 01  CCVS-H-1.
022400     02  FILLER          PIC X(39)    VALUE SPACES.
022500     02  FILLER          PIC X(42)    VALUE
022600     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
022700     02  FILLER          PIC X(39)    VALUE SPACES.
022800 01  CCVS-H-2A.
022900   02  FILLER            PIC X(40)  VALUE SPACE.
023000   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
023100   02  FILLER            PIC XXXX   VALUE
023200     "4.2 ".
023300   02  FILLER            PIC X(28)  VALUE
023400            " COPY - NOT FOR DISTRIBUTION".
023500   02  FILLER            PIC X(41)  VALUE SPACE.
023600*
023700 01  CCVS-H-2B.
023800   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
023900   02  TEST-ID           PIC X(9).
024000   02  FILLER            PIC X(4)   VALUE " IN ".
024100   02  FILLER            PIC X(12)  VALUE
024200     " HIGH       ".
024300   02  FILLER            PIC X(22)  VALUE
024400            " LEVEL VALIDATION FOR ".
024500   02  FILLER            PIC X(58)  VALUE
024600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024700 01  CCVS-H-3.
024800     02  FILLER          PIC X(34)  VALUE
024900            " FOR OFFICIAL USE ONLY    ".
025000     02  FILLER          PIC X(58)  VALUE
025100     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
025200     02  FILLER          PIC X(28)  VALUE
025300            "  COPYRIGHT   1985,1986 ".
025400 01  CCVS-E-1.
025500     02 FILLER           PIC X(52)  VALUE SPACE.
025600     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
025700     02 ID-AGAIN         PIC X(9).
025800     02 FILLER           PIC X(45)  VALUE SPACES.
025900 01  CCVS-E-2.
026000     02  FILLER          PIC X(31)  VALUE SPACE.
026100     02  FILLER          PIC X(21)  VALUE SPACE.
026200     02  CCVS-E-2-2.
026300         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
026400         03 FILLER         PIC X      VALUE SPACE.
026500         03 ENDER-DESC     PIC X(44)  VALUE
026600            "ERRORS ENCOUNTERED".
026700 01  CCVS-E-3.
026800     02  FILLER          PIC X(22)  VALUE
026900            " FOR OFFICIAL USE ONLY".
027000     02  FILLER          PIC X(12)  VALUE SPACE.
027100     02  FILLER          PIC X(58)  VALUE
027200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
027300     02  FILLER          PIC X(8)   VALUE SPACE.
027400     02  FILLER          PIC X(20)  VALUE
027500             " COPYRIGHT 1985,1986".
027600 01  CCVS-E-4.
027700     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
027800     02 FILLER           PIC X(4)   VALUE " OF ".
027900     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
028000     02 FILLER           PIC X(40)  VALUE
028100      "  TESTS WERE EXECUTED SUCCESSFULLY".
028200 01  XXINFO.
028300     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
028400     02 INFO-TEXT.
028500       04 FILLER             PIC X(8)   VALUE SPACE.
028600       04 XXCOMPUTED         PIC X(20).
028700       04 FILLER             PIC X(5)   VALUE SPACE.
028800       04 XXCORRECT          PIC X(20).
028900     02 INF-ANSI-REFERENCE PIC X(48).
029000 01  HYPHEN-LINE.
029100     02 FILLER  PIC IS X VALUE IS SPACE.
029200     02 FILLER  PIC IS X(65)    VALUE IS "************************
029300-    "*****************************************".
029400     02 FILLER  PIC IS X(54)    VALUE IS "************************
029500-    "******************************".
029600 01  CCVS-PGM-ID  PIC X(9)   VALUE
029700     "SQ130A".
029800*
029900*
030000 PROCEDURE DIVISION.
030100 CCVS1 SECTION.
030200 OPEN-FILES.
030300P    OPEN    I-O RAW-DATA.
030400P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
030500P    READ    RAW-DATA INVALID KEY GO TO END-E-1.
030600P    MOVE   "ABORTED "   TO C-ABORT.
030700P    ADD     1           TO C-NO-OF-TESTS.
030800P    ACCEPT  C-DATE      FROM DATE.
030900P    ACCEPT  C-TIME      FROM TIME.
031000P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
031100PEND-E-1.
031200P    CLOSE   RAW-DATA.
031300     OPEN    OUTPUT PRINT-FILE.
031400     MOVE    CCVS-PGM-ID TO TEST-ID.
031500     MOVE    CCVS-PGM-ID TO ID-AGAIN.
031600     MOVE    SPACE TO TEST-RESULTS.
031700     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
031800     MOVE    ZERO TO REC-SKEL-SUB.
031900     PERFORM CCVS-INIT-FILE 10 TIMES.
032000     GO TO CCVS1-EXIT.
032100*
032200 CCVS-INIT-FILE.
032300     ADD     1 TO REC-SKL-SUB.
032400     MOVE    FILE-RECORD-INFO-SKELETON TO
032500                  FILE-RECORD-INFO (REC-SKL-SUB).
032600*
032700 CLOSE-FILES.
032800     PERFORM END-ROUTINE THRU END-ROUTINE-13.
032900     CLOSE   PRINT-FILE.
033000P    OPEN    I-O RAW-DATA.
033100P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
033200P    READ    RAW-DATA INVALID KEY GO TO END-E-2.
033300P    MOVE   "OK.     " TO C-ABORT.
033400P    MOVE    PASS-COUNTER  TO C-OK.
033500P    MOVE    ERROR-HOLD    TO C-ALL.
033600P    MOVE    ERROR-COUNTER TO C-FAIL.
033700P    MOVE    DELETE-CNT    TO C-DELETED.
033800P    MOVE    INSPECT-COUNTER TO C-INSPECT.
033900P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
034000PEND-E-2.
034100P    CLOSE   RAW-DATA.
034200 TERMINATE-CCVS.
034300S    EXIT    PROGRAM.
034400     STOP    RUN.
034500*
034600 INSPT.
034700     MOVE   "INSPT" TO P-OR-F.
034800     ADD     1 TO INSPECT-COUNTER.
034900     PERFORM PRINT-DETAIL.
035000*
035100 PASS.
035200     MOVE   "PASS " TO P-OR-F.
035300     ADD     1 TO PASS-COUNTER.
035400     PERFORM PRINT-DETAIL.
035500*
035600 FAIL.
035700     MOVE   "FAIL*" TO P-OR-F.
035800     ADD     1 TO ERROR-COUNTER.
035900     PERFORM PRINT-DETAIL.
036000*
036100 DE-LETE.
036200     MOVE   "****TEST DELETED****" TO RE-MARK.
036300     MOVE   "*****" TO P-OR-F.
036400     ADD     1 TO DELETE-COUNTER.
036500     PERFORM PRINT-DETAIL.
036600*
036700 PRINT-DETAIL.
036800     IF REC-CT NOT EQUAL TO ZERO
036900         MOVE   "." TO PARDOT-X
037000         MOVE    REC-CT TO DOTVALUE.
037100     MOVE    TEST-RESULTS TO PRINT-REC.
037200     PERFORM WRITE-LINE.
037300     IF P-OR-F EQUAL TO "FAIL*"
037400         PERFORM WRITE-LINE
037500         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
037600     ELSE
037700         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
037800     MOVE    SPACE TO P-OR-F.
037900     MOVE    SPACE TO COMPUTED-X.
038000     MOVE    SPACE TO CORRECT-X.
038100     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
038200     MOVE    SPACE TO RE-MARK.
038300*
038400 HEAD-ROUTINE.
038500     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038600     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038700     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
038800     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
038900 COLUMN-NAMES-ROUTINE.
039000     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
039100     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
039300 END-ROUTINE.
039400     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
039500     PERFORM WRITE-LINE 5 TIMES.
039600 END-RTN-EXIT.
039700     MOVE    CCVS-E-1 TO DUMMY-RECORD.
039800     PERFORM WRITE-LINE 2 TIMES.
039900*
040000 END-ROUTINE-1.
040100     ADD     ERROR-COUNTER   TO ERROR-HOLD
040200     ADD     INSPECT-COUNTER TO ERROR-HOLD.
040300     ADD     DELETE-COUNTER  TO ERROR-HOLD.
040400     ADD     PASS-COUNTER    TO ERROR-HOLD.
040500     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
040600     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
040700     MOVE    CCVS-E-4        TO CCVS-E-2-2.
040800     MOVE    CCVS-E-2        TO DUMMY-RECORD
040900     PERFORM WRITE-LINE.
041000     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
041100     IF ERROR-COUNTER IS EQUAL TO ZERO
041200         MOVE   "NO " TO ERROR-TOTAL
041300     ELSE
041400         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
041500     MOVE    CCVS-E-2 TO DUMMY-RECORD.
041600     PERFORM WRITE-LINE.
041700 END-ROUTINE-13.
041800     IF DELETE-COUNTER IS EQUAL TO ZERO
041900         MOVE   "NO " TO ERROR-TOTAL
042000     ELSE
042100         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
042200     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
042300     MOVE    CCVS-E-2 TO DUMMY-RECORD.
042400     PERFORM WRITE-LINE.
042500     IF INSPECT-COUNTER EQUAL TO ZERO
042600         MOVE   "NO " TO ERROR-TOTAL
042700     ELSE
042800         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
042900     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
043000     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
043100     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
043200*
043300 WRITE-LINE.
043400     ADD     1 TO RECORD-COUNT.
043500Y    IF RECORD-COUNT GREATER 50
043600Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
043700Y        MOVE  SPACE TO DUMMY-RECORD
043800Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
043900Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
044000Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
044100Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
044200Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
044300Y        MOVE  ZERO TO RECORD-COUNT.
044400     PERFORM WRT-LN.
044500*
044600 WRT-LN.
044700     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
044800     MOVE    SPACE TO DUMMY-RECORD.
044900 BLANK-LINE-PRINT.
045000     PERFORM WRT-LN.
045100 FAIL-ROUTINE.
045200     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
045300     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
045400     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
045500     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
045600     MOVE    XXINFO TO DUMMY-RECORD.
045700     PERFORM WRITE-LINE 2 TIMES.
045800     MOVE    SPACES TO INF-ANSI-REFERENCE.
045900     GO TO   FAIL-ROUTINE-EX.
046000 FAIL-ROUTINE-WRITE.
046100     MOVE    TEST-COMPUTED  TO PRINT-REC
046200     PERFORM WRITE-LINE
046300     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
046400     MOVE    TEST-CORRECT   TO PRINT-REC
046500     PERFORM WRITE-LINE 2 TIMES.
046600     MOVE    SPACES         TO COR-ANSI-REFERENCE.
046700 FAIL-ROUTINE-EX.
046800     EXIT.
046900 BAIL-OUT.
047000     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
047100     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
047200 BAIL-OUT-WRITE.
047300     MOVE    CORRECT-A      TO XXCORRECT.
047400     MOVE    COMPUTED-A     TO XXCOMPUTED.
047500     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
047600     MOVE    XXINFO TO DUMMY-RECORD.
047700     PERFORM WRITE-LINE 2 TIMES.
047800     MOVE    SPACES TO INF-ANSI-REFERENCE.
047900 BAIL-OUT-EX.
048000     EXIT.
048100 CCVS1-EXIT.
048200     EXIT.
048300*
048400****************************************************************
048500*                                                              *
048600*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
048700*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
048800*                                                              *
048900****************************************************************
049000*
049100 SECT-SQ130A-MAIN SECTION.
049200 OPEN-INIT-01.
049300*
049400*    THIS PROGRAM ATTEMPTS TO OPEN IN THE INPUT-OUTPUT MODE
049500*    A FILE WHICH IS NOT PRESENT AND AVAILABLE TO IT.
049600*
049700     MOVE    1 TO REC-CT
049800     MOVE   "OPEN ABSENT FILE I-O" TO FEATURE
049900     MOVE   "OPEN-TEST-01" TO PAR-NAME
050000     MOVE   "**" TO SQ-FS1-STATUS.
050100*
050200     MOVE    SPACE TO DUMMY-RECORD.
050300     PERFORM WRITE-LINE.
050400     MOVE   "ABNORMAL TERMINATION AT THIS POINT IS ACCEPTABLE"
050500                TO DUMMY-RECORD.
050600     PERFORM WRITE-LINE.
050700     MOVE    SPACE TO DUMMY-RECORD.
050800     PERFORM WRITE-LINE 3 TIMES.
050900*
051000 OPEN-TEST-01.
051100     OPEN    I-O SQ-FS1.
051200     IF  SQ-FS1-STATUS NOT = "35"
051300         MOVE   "INCORRECT STATUS CODE RETURNED" TO RE-MARK
051400         MOVE   "VII-4, 1.5.3(3)C" TO ANSI-REFERENCE
051500         MOVE   "35" TO CORRECT-A
051600         MOVE    SQ-FS1-STATUS TO COMPUTED-A
051700         PERFORM FAIL
051800     ELSE
051900         PERFORM PASS.
052000*
052100*
052200 CCVS-EXIT SECTION.
052300 CCVS-999999.
052400     GO TO   CLOSE-FILES.
