000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ105A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
000900*                             REVISED 1986, AUGUST             *
001000*                                                              *
001100*    CREATION DATE     /     VALIDATION DATE                   *
001200*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001300*                                                              *
001400****************************************************************
001500*                                                              *
001600*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001700*                                                              *
001800*            X-14   SEQUENTIAL MASS STORAGE FILE               *
001900*            X-55   SYSTEM PRINTER                             *
002000*            X-82   SOURCE-COMPUTER                            *
002100*            X-83   OBJECT-COMPUTER.                           *
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    SQ105A CREATES A SEQUENTIAL MASS STORAGE FILE CONTAINING  *
002600*    980 RECORDS, EACH 125 CHARACTERS LONG.  THERE ARE TWO     *
002700*    USE PROCEDURES IN THE DECLARATIVE SECTION, ONE FOR        *
002800*    EXCEPTION ON OUTPUT, THE OTHER FOR EXCEPTION ON INPUT.    *
002900*    THE FILE IS READ TWICE.  IN THE FIRST PASS, RECORDS ARE   *
003000*    READ WITH READ STATEMENTS WHICH DO NOT CONTAIN ANY        *
003100*    OPTIONAL PHRASES EXCEPT THE OPTIONAL WORD "RECORD".  ON   *
003200*    THE SECOND PASS, THE READ STATEMENT CONTAINS NO OPTIONAL  *
003300*    WORDS OR PHRASES AT ALL.  ON BOTH PASSES, THE END OF FILE *
003400*    SHOULD CAUSE EXECUTION OF THE DECLARATIVE PROCEDURE FOR   *
003500*    INPUT.  THE DECLARATIVE PROCEDURE FOR OUTPUT SHOULD BE    *
003600*    ON BOTH PASSES.                                           *
003700*                                                              *
003800*    THE OPTIONAL ORGANIZATION AND ACCESS MODE CLAUSES ARE     *
003900*    BOTH OMITTED.                                             *
004000*                                                              *
004100****************************************************************
004200*
004300*
004400 ENVIRONMENT DIVISION.
004500 CONFIGURATION SECTION.
004600 SOURCE-COMPUTER.
004700     XXXXX082.
004800 OBJECT-COMPUTER.
004900     XXXXX083.
005000*
005100 INPUT-OUTPUT SECTION.
005200 FILE-CONTROL.
005300     SELECT PRINT-FILE ASSIGN TO
005400     XXXXX055.
005500*
005600P    SELECT RAW-DATA   ASSIGN TO
005700P    XXXXX062
005800P          ORGANIZATION IS INDEXED
005900P          ACCESS MODE  IS RANDOM
006000P          RECORD-KEY   IS RAW-DATA-KEY.
006100P
006200     SELECT SQ-FS4 ASSIGN
006300     XXXXX014
006400     STATUS SQ-FS4-STATUS.
006500*
006600*
006700 DATA DIVISION.
006800 FILE SECTION.
006900 FD  PRINT-FILE
007000C    LABEL RECORDS
007100C    XXXXX084
007200C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007300               .
007400 01  PRINT-REC    PICTURE X(120).
007500 01  DUMMY-RECORD PICTURE X(120).
007600P
007700PFD  RAW-DATA.
007800P01  RAW-DATA-SATZ.
007900P    05  RAW-DATA-KEY        PIC X(6).
008000P    05  C-DATE              PIC 9(6).
008100P    05  C-TIME              PIC 9(8).
008200P    05  NO-OF-TESTS         PIC 99.
008300P    05  C-OK                PIC 999.
008400P    05  C-ALL               PIC 999.
008500P    05  C-FAIL              PIC 999.
008600P    05  C-DELETED           PIC 999.
008700P    05  C-INSPECT           PIC 999.
008800P    05  C-NOTE              PIC X(13).
008900P    05  C-INDENT            PIC X.
009000P    05  C-ABORT             PIC X(8).
009100*
009200 FD  SQ-FS4
009300     BLOCK CONTAINS 2 RECORDS
009400     RECORD 125
009500C    LABEL RECORD STANDARD
009600     DATA RECORDS SQ-FS4R1-F-G-125.
009700*
009800 01  SQ-FS4R1-F-G-125.
009900     02  SQ-FS4-FIRST  PIC X(120).
010000     02  SQ-FS4-REC-NO   PIC  9(5).
010100*
010200 WORKING-STORAGE SECTION.
010300*
010400***************************************************************
010500*                                                             *
010600*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
010700*                                                             *
010800***************************************************************
010900*
011000 01  SQ-FS4-STATUS.
011100   03  SQ-FS4-STATUS-1   PIC X.
011200   03  SQ-FS4-STATUS-2   PIC X.
011300*
011400 01  SQ-FS4-STATUS-COPY PIC XX.
011500 01  DECL-EXEC-SW.
011600     05  DECL-EXEC-SW-O PIC X.
011700     05  DECL-EXEC-SW-I PIC X.
011800 01  WRK-CS-09V00  PIC  S9(9) USAGE COMPUTATIONAL VALUE ZERO.
011900 01  EOF-FLAG  PIC 9  VALUE ZERO.
012000 01  RECORDS-IN-ERROR  PIC S9(5) USAGE COMP VALUE ZERO.
012100 01  ERROR-FLAG PIC 9  VALUE ZERO.
012200 01  PERM-ERRORS  PIC S9(5) USAGE COMP VALUE ZERO.
012300*
012400 01  MAJOR-DELETIONS PIC 99.
012500 01  COUNT-OF-RECS   PIC 9(5).
012600*
012700*
012800***************************************************************
012900*                                                             *
013000*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
013100*                                                             *
013200***************************************************************
013300*
013400 01  REC-SKEL-SUB   PIC 99.
013500*
013600 01  FILE-RECORD-INFORMATION-REC.
013700     03 FILE-RECORD-INFO-SKELETON.
013800        05 FILLER                 PICTURE X(48)       VALUE
013900             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
014000        05 FILLER                 PICTURE X(46)       VALUE
014100             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
014200        05 FILLER                 PICTURE X(26)       VALUE
014300             ",LFIL=000000,ORG=  ,LBLR= ".
014400        05 FILLER                 PICTURE X(37)       VALUE
014500             ",RECKEY=                             ".
014600        05 FILLER                 PICTURE X(38)       VALUE
014700             ",ALTKEY1=                             ".
014800        05 FILLER                 PICTURE X(38)       VALUE
014900             ",ALTKEY2=                             ".
015000        05 FILLER                 PICTURE X(7)        VALUE SPACE.
015100     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
015200        05 FILE-RECORD-INFO-P1-120.
015300           07 FILLER              PIC X(5).
015400           07 XFILE-NAME          PIC X(6).
015500           07 FILLER              PIC X(8).
015600           07 XRECORD-NAME        PIC X(6).
015700           07 FILLER              PIC X(1).
015800           07 REELUNIT-NUMBER     PIC 9(1).
015900           07 FILLER              PIC X(7).
016000           07 XRECORD-NUMBER      PIC 9(6).
016100           07 FILLER              PIC X(6).
016200           07 UPDATE-NUMBER       PIC 9(2).
016300           07 FILLER              PIC X(5).
016400           07 ODO-NUMBER          PIC 9(4).
016500           07 FILLER              PIC X(5).
016600           07 XPROGRAM-NAME       PIC X(5).
016700           07 FILLER              PIC X(7).
016800           07 XRECORD-LENGTH      PIC 9(6).
016900           07 FILLER              PIC X(7).
017000           07 CHARS-OR-RECORDS    PIC X(2).
017100           07 FILLER              PIC X(1).
017200           07 XBLOCK-SIZE         PIC 9(4).
017300           07 FILLER              PIC X(6).
017400           07 RECORDS-IN-FILE     PIC 9(6).
017500           07 FILLER              PIC X(5).
017600           07 XFILE-ORGANIZATION  PIC X(2).
017700           07 FILLER              PIC X(6).
017800           07 XLABEL-TYPE         PIC X(1).
017900        05 FILE-RECORD-INFO-P121-240.
018000           07 FILLER              PIC X(8).
018100           07 XRECORD-KEY         PIC X(29).
018200           07 FILLER              PIC X(9).
018300           07 ALTERNATE-KEY1      PIC X(29).
018400           07 FILLER              PIC X(9).
018500           07 ALTERNATE-KEY2      PIC X(29).
018600           07 FILLER              PIC X(7).
018700*
018800 01  TEST-RESULTS.
018900     02 FILLER              PIC X      VALUE SPACE.
019000     02  PAR-NAME.
019100       03 FILLER              PIC X(14)  VALUE SPACE.
019200       03 PARDOT-X            PIC X      VALUE SPACE.
019300       03 DOTVALUE            PIC 99     VALUE ZERO.
019400     02 FILLER              PIC X      VALUE SPACE.
019500     02 FEATURE             PIC X(24)  VALUE SPACE.
019600     02 FILLER              PIC X      VALUE SPACE.
019700     02 P-OR-F              PIC X(5)   VALUE SPACE.
019800     02 FILLER              PIC X(9)   VALUE SPACE.
019900     02 RE-MARK             PIC X(61).
020000 01  TEST-COMPUTED.
020100   02 FILLER  PIC X(30)  VALUE SPACE.
020200   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
020300   02 COMPUTED-X.
020400     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
020500     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
020600     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
020700     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
020800     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
020900     03       CM-18V0 REDEFINES COMPUTED-A.
021000        04 COMPUTED-18V0                   PIC -9(18).
021100        04 FILLER                          PIC X.
021200     03 FILLER PIC X(50) VALUE SPACE.
021300 01  TEST-CORRECT.
021400     02 FILLER PIC X(30) VALUE SPACE.
021500     02 FILLER PIC X(17) VALUE "       CORRECT =".
021600     02 CORRECT-X.
021700     03 CORRECT-A                  PIC X(20) VALUE SPACE.
021800     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
021900     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
022000     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
022100     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
022200     03      CR-18V0 REDEFINES CORRECT-A.
022300         04 CORRECT-18V0                     PIC -9(18).
022400         04 FILLER                           PIC X.
022500     03 FILLER PIC X(2) VALUE SPACE.
022600     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
022700*
022800 01  CCVS-C-1.
022900     02 FILLER  PIC IS X        VALUE  SPACE.
023000     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
023100     02 FILLER  PIC IS X        VALUE  SPACE.
023200     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
023300     02 FILLER  PIC IS X        VALUE  SPACE.
023400     02 FILLER  PIC IS X(5)     VALUE "PASS ".
023500     02 FILLER  PIC IS X(9)     VALUE  SPACE.
023600     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
023700 01  CCVS-C-2.
023800     02 FILLER  PIC X(19)  VALUE  SPACE.
023900     02 FILLER  PIC X(6)   VALUE "TESTED".
024000     02 FILLER  PIC X(19)  VALUE  SPACE.
024100     02 FILLER  PIC X(4)   VALUE "FAIL".
024200     02 FILLER  PIC X(72)  VALUE  SPACE.
024300*
024400 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
024500 01  REC-CT            PIC 99       VALUE ZERO.
024600 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
024700 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
024800 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
024900 01  PASS-COUNTER      PIC 999      VALUE ZERO.
025000 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
025100 01  ERROR-HOLD        PIC 999      VALUE ZERO.
025200 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
025300 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
025400 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
025500 01  CCVS-H-1.
025600     02  FILLER          PIC X(39)    VALUE SPACES.
025700     02  FILLER          PIC X(42)    VALUE
025800     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
025900     02  FILLER          PIC X(39)    VALUE SPACES.
026000 01  CCVS-H-2A.
026100   02  FILLER            PIC X(40)  VALUE SPACE.
026200   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
026300   02  FILLER            PIC XXXX   VALUE
026400     "4.2 ".
026500   02  FILLER            PIC X(28)  VALUE
026600            " COPY - NOT FOR DISTRIBUTION".
026700   02  FILLER            PIC X(41)  VALUE SPACE.
026800*
026900 01  CCVS-H-2B.
027000   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
027100   02  TEST-ID           PIC X(9).
027200   02  FILLER            PIC X(4)   VALUE " IN ".
027300   02  FILLER            PIC X(12)  VALUE
027400     " HIGH       ".
027500   02  FILLER            PIC X(22)  VALUE
027600            " LEVEL VALIDATION FOR ".
027700   02  FILLER            PIC X(58)  VALUE
027800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
027900 01  CCVS-H-3.
028000     02  FILLER          PIC X(34)  VALUE
028100            " FOR OFFICIAL USE ONLY    ".
028200     02  FILLER          PIC X(58)  VALUE
028300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
028400     02  FILLER          PIC X(28)  VALUE
028500            "  COPYRIGHT   1985,1986 ".
028600 01  CCVS-E-1.
028700     02 FILLER           PIC X(52)  VALUE SPACE.
028800     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
028900     02 ID-AGAIN         PIC X(9).
029000     02 FILLER           PIC X(45)  VALUE SPACES.
029100 01  CCVS-E-2.
029200     02  FILLER          PIC X(31)  VALUE SPACE.
029300     02  FILLER          PIC X(21)  VALUE SPACE.
029400     02  CCVS-E-2-2.
029500         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
029600         03 FILLER         PIC X      VALUE SPACE.
029700         03 ENDER-DESC     PIC X(44)  VALUE
029800            "ERRORS ENCOUNTERED".
029900 01  CCVS-E-3.
030000     02  FILLER          PIC X(22)  VALUE
030100            " FOR OFFICIAL USE ONLY".
030200     02  FILLER          PIC X(12)  VALUE SPACE.
030300     02  FILLER          PIC X(58)  VALUE
030400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
030500     02  FILLER          PIC X(8)   VALUE SPACE.
030600     02  FILLER          PIC X(20)  VALUE
030700             " COPYRIGHT 1985,1986".
030800 01  CCVS-E-4.
030900     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
031000     02 FILLER           PIC X(4)   VALUE " OF ".
031100     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
031200     02 FILLER           PIC X(40)  VALUE
031300      "  TESTS WERE EXECUTED SUCCESSFULLY".
031400 01  XXINFO.
031500     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
031600     02 INFO-TEXT.
031700       04 FILLER             PIC X(8)   VALUE SPACE.
031800       04 XXCOMPUTED         PIC X(20).
031900       04 FILLER             PIC X(5)   VALUE SPACE.
032000       04 XXCORRECT          PIC X(20).
032100     02 INF-ANSI-REFERENCE PIC X(48).
032200 01  HYPHEN-LINE.
032300     02 FILLER  PIC IS X VALUE IS SPACE.
032400     02 FILLER  PIC IS X(65)    VALUE IS "************************
032500-    "*****************************************".
032600     02 FILLER  PIC IS X(54)    VALUE IS "************************
032700-    "******************************".
032800 01  CCVS-PGM-ID  PIC X(9)   VALUE
032900     "SQ105A".
033000*
033100*
033200 PROCEDURE DIVISION.
033300 DECLARATIVES.
033400 SECT-SQ105-0001 SECTION.
033500     USE AFTER STANDARD ERROR PROCEDURE OUTPUT.
033600 OUTPUT-ERROR-PROCESS.
033700     MOVE   "O" TO DECL-EXEC-SW-O.
033800     MOVE    2     TO PERM-ERRORS.
033900     ADD     1     TO RECORDS-IN-ERROR.
034000     IF SQ-FS4-STATUS-1 EQUAL TO "3"
034100          MOVE    1 TO PERM-ERRORS.
034200 SECT-SQ105-0002 SECTION.
034300     USE AFTER ERROR PROCEDURE ON INPUT.
034400 INPUT-PROCESS.
034500     MOVE   "I" TO DECL-EXEC-SW-I.
034600     IF SQ-FS4-STATUS-1 EQUAL TO "1"
034700          MOVE    1 TO EOF-FLAG.
034800     IF SQ-FS4-STATUS-1 GREATER THAN "1"
034900          MOVE    1 TO PERM-ERRORS.
035000*
035100 END DECLARATIVES.
035200*
035300*
035400 CCVS1 SECTION.
035500 OPEN-FILES.
035600P    OPEN    I-O RAW-DATA.
035700P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
035800P    READ    RAW-DATA INVALID KEY GO TO END-E-1.
035900P    MOVE   "ABORTED "   TO C-ABORT.
036000P    ADD     1           TO C-NO-OF-TESTS.
036100P    ACCEPT  C-DATE      FROM DATE.
036200P    ACCEPT  C-TIME      FROM TIME.
036300P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
036400PEND-E-1.
036500P    CLOSE   RAW-DATA.
036600     OPEN    OUTPUT PRINT-FILE.
036700     MOVE    CCVS-PGM-ID TO TEST-ID.
036800     MOVE    CCVS-PGM-ID TO ID-AGAIN.
036900     MOVE    SPACE TO TEST-RESULTS.
037000     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
037100     MOVE    ZERO TO REC-SKEL-SUB.
037200     PERFORM CCVS-INIT-FILE 10 TIMES.
037300     GO TO CCVS1-EXIT.
037400*
037500 CCVS-INIT-FILE.
037600     ADD     1 TO REC-SKL-SUB.
037700     MOVE    FILE-RECORD-INFO-SKELETON TO
037800                  FILE-RECORD-INFO (REC-SKL-SUB).
037900*
038000 CLOSE-FILES.
038100     PERFORM END-ROUTINE THRU END-ROUTINE-13.
038200     CLOSE   PRINT-FILE.
038300P    OPEN    I-O RAW-DATA.
038400P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
038500P    READ    RAW-DATA INVALID KEY GO TO END-E-2.
038600P    MOVE   "OK.     " TO C-ABORT.
038700P    MOVE    PASS-COUNTER  TO C-OK.
038800P    MOVE    ERROR-HOLD    TO C-ALL.
038900P    MOVE    ERROR-COUNTER TO C-FAIL.
039000P    MOVE    DELETE-CNT    TO C-DELETED.
039100P    MOVE    INSPECT-COUNTER TO C-INSPECT.
039200P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
039300PEND-E-2.
039400P    CLOSE   RAW-DATA.
039500 TERMINATE-CCVS.
039600S    EXIT    PROGRAM.
039700     STOP    RUN.
039800*
039900 INSPT.
040000     MOVE   "INSPT" TO P-OR-F.
040100     ADD     1 TO INSPECT-COUNTER.
040200     PERFORM PRINT-DETAIL.
040300*
040400 PASS.
040500     MOVE   "PASS " TO P-OR-F.
040600     ADD     1 TO PASS-COUNTER.
040700     PERFORM PRINT-DETAIL.
040800*
040900 FAIL.
041000     MOVE   "FAIL*" TO P-OR-F.
041100     ADD     1 TO ERROR-COUNTER.
041200     PERFORM PRINT-DETAIL.
041300*
041400 DE-LETE.
041500     MOVE   "****TEST DELETED****" TO RE-MARK.
041600     MOVE   "*****" TO P-OR-F.
041700     ADD     1 TO DELETE-COUNTER.
041800     PERFORM PRINT-DETAIL.
041900*
042000 PRINT-DETAIL.
042100     IF REC-CT NOT EQUAL TO ZERO
042200         MOVE   "." TO PARDOT-X
042300         MOVE    REC-CT TO DOTVALUE.
042400     MOVE    TEST-RESULTS TO PRINT-REC.
042500     PERFORM WRITE-LINE.
042600     IF P-OR-F EQUAL TO "FAIL*"
042700         PERFORM WRITE-LINE
042800         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
042900     ELSE
043000         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
043100     MOVE    SPACE TO P-OR-F.
043200     MOVE    SPACE TO COMPUTED-X.
043300     MOVE    SPACE TO CORRECT-X.
043400     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
043500     MOVE    SPACE TO RE-MARK.
043600*
043700 HEAD-ROUTINE.
043800     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043900     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044000     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
044100     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
044200 COLUMN-NAMES-ROUTINE.
044300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
044400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
044600 END-ROUTINE.
044700     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
044800     PERFORM WRITE-LINE 5 TIMES.
044900 END-RTN-EXIT.
045000     MOVE    CCVS-E-1 TO DUMMY-RECORD.
045100     PERFORM WRITE-LINE 2 TIMES.
045200*
045300 END-ROUTINE-1.
045400     ADD     ERROR-COUNTER   TO ERROR-HOLD
045500     ADD     INSPECT-COUNTER TO ERROR-HOLD.
045600     ADD     DELETE-COUNTER  TO ERROR-HOLD.
045700     ADD     PASS-COUNTER    TO ERROR-HOLD.
045800     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
045900     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
046000     MOVE    CCVS-E-4        TO CCVS-E-2-2.
046100     MOVE    CCVS-E-2        TO DUMMY-RECORD
046200     PERFORM WRITE-LINE.
046300     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
046400     IF ERROR-COUNTER IS EQUAL TO ZERO
046500         MOVE   "NO " TO ERROR-TOTAL
046600     ELSE
046700         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
046800     MOVE    CCVS-E-2 TO DUMMY-RECORD.
046900     PERFORM WRITE-LINE.
047000 END-ROUTINE-13.
047100     IF DELETE-COUNTER IS EQUAL TO ZERO
047200         MOVE   "NO " TO ERROR-TOTAL
047300     ELSE
047400         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
047500     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
047600     MOVE    CCVS-E-2 TO DUMMY-RECORD.
047700     PERFORM WRITE-LINE.
047800     IF INSPECT-COUNTER EQUAL TO ZERO
047900         MOVE   "NO " TO ERROR-TOTAL
048000     ELSE
048100         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
048200     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
048300     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
048400     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
048500*
048600 WRITE-LINE.
048700     ADD     1 TO RECORD-COUNT.
048800Y    IF RECORD-COUNT GREATER 50
048900Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
049000Y        MOVE  SPACE TO DUMMY-RECORD
049100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
049200Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
049300Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
049400Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
049500Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
049600Y        MOVE  ZERO TO RECORD-COUNT.
049700     PERFORM WRT-LN.
049800*
049900 WRT-LN.
050000     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
050100     MOVE    SPACE TO DUMMY-RECORD.
050200 BLANK-LINE-PRINT.
050300     PERFORM WRT-LN.
050400 FAIL-ROUTINE.
050500     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
050600     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
050700     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
050800     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
050900     MOVE    XXINFO TO DUMMY-RECORD.
051000     PERFORM WRITE-LINE 2 TIMES.
051100     MOVE    SPACES TO INF-ANSI-REFERENCE.
051200     GO TO   FAIL-ROUTINE-EX.
051300 FAIL-ROUTINE-WRITE.
051400     MOVE    TEST-COMPUTED  TO PRINT-REC
051500     PERFORM WRITE-LINE
051600     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
051700     MOVE    TEST-CORRECT   TO PRINT-REC
051800     PERFORM WRITE-LINE 2 TIMES.
051900     MOVE    SPACES         TO COR-ANSI-REFERENCE.
052000 FAIL-ROUTINE-EX.
052100     EXIT.
052200 BAIL-OUT.
052300     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
052400     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
052500 BAIL-OUT-WRITE.
052600     MOVE    CORRECT-A      TO XXCORRECT.
052700     MOVE    COMPUTED-A     TO XXCOMPUTED.
052800     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
052900     MOVE    XXINFO TO DUMMY-RECORD.
053000     PERFORM WRITE-LINE 2 TIMES.
053100     MOVE    SPACES TO INF-ANSI-REFERENCE.
053200 BAIL-OUT-EX.
053300     EXIT.
053400 CCVS1-EXIT.
053500     EXIT.
053600*
053700****************************************************************
053800*                                                              *
053900*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
054000*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
054100*                                                              *
054200****************************************************************
054300*
054400 SECT-SQ105-0003 SECTION.
054500 INITIAL-PARA.
054600     MOVE   "SQ-FS4" TO XFILE-NAME (1).
054700     MOVE   "R1-F-G" TO XRECORD-NAME (1).
054800     MOVE    CCVS-PGM-ID TO XPROGRAM-NAME (1).
054900     MOVE    000125 TO XRECORD-LENGTH (1).
055000     MOVE   "RC" TO CHARS-OR-RECORDS (1).
055100     MOVE    0002 TO XBLOCK-SIZE (1).
055200     MOVE    000980 TO RECORDS-IN-FILE (1).
055300     MOVE   "SQ" TO XFILE-ORGANIZATION (1).
055400     MOVE   "S" TO XLABEL-TYPE (1).
055500     MOVE    ZERO TO MAJOR-DELETIONS.
055600*
055700*    THE INITIAL ACTIONS ARE TO CREATE A FILE FOR USE
055800*    IN LATER TESTS.  FILE STATUS VALUES AND DECLARATIVE
055900*    EXECUTION DURING THE CREATION PROCESS ARE MONITORED.
056000*
056100 SEQ-INIT-01.
056200     MOVE    ZERO TO XRECORD-NUMBER (1).
056300     MOVE    0 TO COUNT-OF-RECS.
056400     MOVE   "CREATE 980 RECORD FILE" TO FEATURE.
056500     MOVE   "SEQ-TEST-WR-01" TO PAR-NAME.
056600     MOVE   "**"    TO SQ-FS4-STATUS.
056700     MOVE   "00"    TO SQ-FS4-STATUS-COPY.
056800     MOVE   "**"    TO DECL-EXEC-SW.
056900     MOVE    1 TO REC-CT.
057000     GO TO   SEQ-TEST-WR-01.
057100 SEQ-DELETE-01.
057200     MOVE    1 TO MAJOR-DELETIONS.
057300     GO TO   SEQ-DELETE-01-01.
057400 SEQ-TEST-WR-01.
057500     OPEN    OUTPUT SQ-FS4.
057600     IF SQ-FS4-STATUS NOT EQUAL TO "00"
057700         MOVE    SQ-FS4-STATUS TO SQ-FS4-STATUS-COPY
057800         MOVE   "00" TO SQ-FS4-STATUS.
057900*
058000 SEQ-TEST-WR-01-LOOP.
058100     ADD     1 TO XRECORD-NUMBER (1).
058200     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-FS4-FIRST.
058300     ADD     1 TO COUNT-OF-RECS.
058400     MOVE    COUNT-OF-RECS TO SQ-FS4-REC-NO.
058500     WRITE   SQ-FS4R1-F-G-125.
058600     IF SQ-FS4-STATUS NOT EQUAL TO "00"
058700         MOVE    SQ-FS4-STATUS TO SQ-FS4-STATUS-COPY
058800         MOVE   "00" TO SQ-FS4-STATUS.
058900     IF PERM-ERRORS EQUAL TO 1
059000         GO TO   SEQ-TEST-WR-01-LOOP-EXIT.
059100     IF COUNT-OF-RECS LESS THAN 980
059200         GO TO   SEQ-TEST-WR-01-LOOP.
059300*
059400 SEQ-TEST-WR-01-LOOP-EXIT.
059500*
059600     CLOSE   SQ-FS4.
059700     IF SQ-FS4-STATUS NOT EQUAL TO "00"
059800         MOVE    SQ-FS4-STATUS TO SQ-FS4-STATUS-COPY
059900         MOVE   "00" TO SQ-FS4-STATUS.
060000*
060100     GO TO   SEQ-TEST-WR-01-01.
060200 SEQ-DELETE-01-01.
060300     PERFORM DE-LETE.
060400     GO TO   SEQ-INIT-WR-01-02.
060500 SEQ-TEST-WR-01-01.
060600*
060700     IF SQ-FS4-STATUS-COPY EQUAL "00"
060800         PERFORM PASS
060900     ELSE
061000         MOVE    SQ-FS4-STATUS-COPY TO COMPUTED-A
061100         MOVE   "00" TO CORRECT-A
061200         MOVE   "ERROR I-O STATUS DURING FILE CREATION"
061300                    TO RE-MARK
061400         PERFORM FAIL.
061500*
061600 SEQ-INIT-WR-01-02.
061700     ADD     1 TO REC-CT.
061800     IF MAJOR-DELETIONS = 1
061900         GO TO   SEQ-DELETE-01-02.
062000     GO TO   SEQ-TEST-WR-01-02.
062100 SEQ-DELETE-01-02.
062200     PERFORM DE-LETE.
062300     GO TO   SEQ-TEST-01-END.
062400 SEQ-TEST-WR-01-02.
062500     IF DECL-EXEC-SW = "**"
062600         PERFORM PASS
062700     ELSE
062800         MOVE    DECL-EXEC-SW TO COMPUTED-A
062900         MOVE   "**" TO CORRECT-A
063000         MOVE
063100          "UNEXPECTED DECLARATIVE EXECUTION DURING FILE CREATION"
063200              TO RE-MARK
063300         PERFORM FAIL.
063400 SEQ-TEST-01-END.
063500*
063600*    A SEQUENTIAL MASS STORAGE FILE WITH 125 CHARACTER RECORDS,
063700*    TWO RECORDS PER BLOCK, HAS BEEN CREATED.  THE FILE
063800*    CONTAINS 980 RECORDS.  THE FOLLOWING TESTS READ AND
063900*    VERIFY THE RECORDS IN THE FILE.  THE READ STATEMENT DOES
064000*    NOT CONTAIN AN AT END PHRASE, SO THE INPUT DECLARATIVE
064100*    SHOULD BE EXECUTED AT THE END OF THE FILE.  THE READ
064200*    STATEMENT CONTAINS THE OPTIONAL WORD "RECORD"
064300*
064400 SEQ-INIT-02.
064500     MOVE    1 TO REC-CT.
064600     MOVE   "**" TO DECL-EXEC-SW.
064700     MOVE   "**" TO SQ-FS4-STATUS.
064800     MOVE   "OPEN FILE FOR CHECK" TO FEATURE.
064900     MOVE   "SEQ-TEST-GF-02" TO PAR-NAME.
065000     IF MAJOR-DELETIONS NOT = 0
065100         GO TO SEQ-DELETE-02.
065200     GO TO   SEQ-TEST-GF-02.
065300 SEQ-DELETE-02.
065400     ADD     2 TO MAJOR-DELETIONS.
065500     GO TO   SEQ-DELETE-02-01.
065600*
065700 SEQ-TEST-GF-02.
065800     OPEN INPUT SQ-FS4.
065900     GO TO   SEQ-TEST-GF-02-01.
066000 SEQ-DELETE-02-01.
066100     PERFORM DE-LETE.
066200     GO TO   SEQ-TEST-02-01-END.
066300 SEQ-TEST-GF-02-01.
066400     IF SQ-FS4-STATUS = "00"
066500         PERFORM PASS
066600     ELSE
066700         MOVE    SQ-FS4-STATUS TO COMPUTED-A
066800         MOVE   "00" TO CORRECT-A
066900         MOVE   "FAILURE STATUS CODE AFTER OPEN" TO RE-MARK
067000         PERFORM FAIL.
067100     IF SQ-FS4-STATUS GREATER THAN "10"
067200         ADD     2 TO MAJOR-DELETIONS.
067300 SEQ-TEST-02-01-END.
067400*
067500     ADD     1 TO REC-CT.
067600     GO TO   SEQ-TEST-GF-02-02.
067700 SEQ-DELETE-02-02.
067800     PERFORM DE-LETE.
067900     GO TO   SEQ-TEST-02-02-END.
068000 SEQ-TEST-GF-02-02.
068100     IF DECL-EXEC-SW = "**"
068200         PERFORM PASS
068300     ELSE
068400         MOVE    DECL-EXEC-SW TO COMPUTED-A
068500         MOVE   "**" TO CORRECT-A
068600         MOVE   "DECLARATIVE EXECUTED ON OPEN" TO RE-MARK
068700         PERFORM FAIL.
068800 SEQ-TEST-02-02-END.
068900*
069000 SEQ-INIT-03.
069100     MOVE    1 TO REC-CT.
069200     MOVE   "READ ... RECORD" TO FEATURE.
069300     MOVE   "SEQ-TEST-GF-03" TO PAR-NAME.
069400     IF MAJOR-DELETIONS NOT = 0
069500         GO TO SEQ-DELETE-03.
069600     GO TO   SEQ-TEST-GF-03.
069700 SEQ-DELETE-03.
069800     ADD     4 TO MAJOR-DELETIONS.
069900     GO TO   SEQ-DELETE-03-01.
070000 SEQ-TEST-GF-03.
070100     MOVE    ZERO TO XRECORD-NUMBER (1).
070200     MOVE    ZERO TO COUNT-OF-RECS.
070300     MOVE    ZERO TO PERM-ERRORS.
070400     MOVE    ZERO TO RECORDS-IN-ERROR.
070500     MOVE   "**" TO DECL-EXEC-SW.
070600     MOVE   "00" TO SQ-FS4-STATUS-COPY.
070700 SEQ-TEST-03-LOOP.
070800     MOVE   "**" TO SQ-FS4-STATUS.
070900     READ    SQ-FS4 RECORD.
071000     IF DECL-EXEC-SW NOT = "**"
071100          GO TO SEQ-TEST-GF-03-01.
071200     IF SQ-FS4-STATUS = "10"
071300          GO TO SEQ-TEST-GF-03-LOOP-END.
071400     IF SQ-FS4-STATUS NOT = "00"
071500          MOVE    SQ-FS4-STATUS TO SQ-FS4-STATUS-COPY.
071600     ADD     1 TO XRECORD-NUMBER (1).
071700     ADD     1 TO COUNT-OF-RECS.
071800     IF SQ-FS4-FIRST NOT EQUAL TO FILE-RECORD-INFO-P1-120 (1)
071900        OR SQ-FS4-REC-NO NOT EQUAL TO COUNT-OF-RECS
072000         ADD     1 TO RECORDS-IN-ERROR.
072100     IF COUNT-OF-RECS LESS THAN 980
072200         GO TO   SEQ-TEST-03-LOOP.
072300*
072400 SEQ-TEST-GF-03-LOOP-END.
072500     IF MAJOR-DELETIONS NOT = 0
072600         GO TO   SEQ-DELETE-03-01.
072700     GO TO   SEQ-TEST-GF-03-01.
072800 SEQ-DELETE-03-01.
072900     PERFORM DE-LETE.
073000     GO TO   SEQ-TEST-03-01-END.
073100 SEQ-TEST-GF-03-01.
073200     IF COUNT-OF-RECS EQUAL TO 980
073300         PERFORM PASS
073400     ELSE
073500         MOVE    COUNT-OF-RECS TO COMPUTED-18V0
073600         MOVE    980 TO CORRECT-18V0
073700         MOVE   "UNEXPECTED NUMBER OF RECORDS BEFORE EOF"
073800                    TO RE-MARK
073900         PERFORM FAIL.
074000 SEQ-TEST-03-01-END.
074100*
074200     ADD     1 TO REC-CT.
074300     IF MAJOR-DELETIONS NOT = 0
074400         GO TO   SEQ-TEST-03-02-END.
074500     GO TO   SEQ-TEST-GF-03-02.
074600 SEQ-DELETE-03-02.
074700     PERFORM DE-LETE.
074800     GO TO   SEQ-TEST-03-02-END.
074900 SEQ-TEST-GF-03-02.
075000     IF DECL-EXEC-SW = "**"
075100         PERFORM PASS
075200     ELSE
075300         MOVE    DECL-EXEC-SW TO COMPUTED-A
075400         MOVE   "**" TO CORRECT-A
075500         MOVE   "DECLARATIVES ENTERED AT LEAST ONCE" TO RE-MARK
075600         PERFORM FAIL.
075700 SEQ-TEST-03-02-END.
075800*
075900     ADD     1 TO REC-CT.
076000     IF MAJOR-DELETIONS NOT = 0
076100         GO TO   SEQ-TEST-03-03-END.
076200     GO TO   SEQ-TEST-GF-03-03.
076300 SEQ-DELETE-03-03.
076400     PERFORM DE-LETE.
076500     GO TO   SEQ-TEST-03-03-END.
076600 SEQ-TEST-GF-03-03.
076700     IF SQ-FS4-STATUS-COPY = "00"
076800         PERFORM PASS
076900     ELSE
077000         MOVE    SQ-FS4-STATUS-COPY TO COMPUTED-A
077100         MOVE   "00" TO CORRECT-A
077200         MOVE   "AT LEAST ONE UNSUCCESSFUL READ" TO RE-MARK
077300         MOVE   "VII-2" TO ANSI-REFERENCE
077400         PERFORM FAIL.
077500 SEQ-TEST-03-03-END.
077600*
077700     ADD     1 TO REC-CT.
077800     IF MAJOR-DELETIONS NOT = 0
077900         GO TO   SEQ-TEST-03-04-END.
078000     GO TO   SEQ-TEST-GF-03-04.
078100 SEQ-DELETE-03-04.
078200     PERFORM DE-LETE.
078300     GO TO   SEQ-TEST-03-04-END.
078400 SEQ-TEST-GF-03-04.
078500     IF RECORDS-IN-ERROR EQUAL TO ZERO
078600         PERFORM PASS
078700     ELSE
078800         MOVE    RECORDS-IN-ERROR TO COMPUTED-18V0
078900         MOVE    ZERO TO CORRECT-18V0
079000         MOVE   "ONE OR MORE ERRORS IN RECORDS READ" TO RE-MARK
079100         PERFORM FAIL.
079200 SEQ-TEST-03-04-END.
079300*
079400*
079500 SEQ-INIT-04.
079600     MOVE    1 TO REC-CT.
079700     MOVE   "**" TO SQ-FS4-STATUS.
079800     MOVE   "**" TO DECL-EXEC-SW.
079900     MOVE   "READ ... RECORD, EOF" TO FEATURE.
080000     MOVE   "SEQ-TEST-GF-04" TO PAR-NAME.
080100     IF MAJOR-DELETIONS NOT = 0
080200         GO TO SEQ-DELETE-04.
080300     GO TO   SEQ-TEST-GF-04.
080400 SEQ-DELETE-04.
080500     ADD     8 TO MAJOR-DELETIONS.
080600     PERFORM DE-LETE.
080700     GO TO   SEQ-DELETE-04-01.
080800 SEQ-TEST-GF-04.
080900     READ    SQ-FS4 RECORD.
081000*
081100     GO TO   SEQ-TEST-GF-04-01.
081200 SEQ-DELETE-04-01.
081300     PERFORM DE-LETE.
081400     GO TO   SEQ-TEST-04-01-END.
081500 SEQ-TEST-GF-04-01.
081600     IF SQ-FS4-STATUS = "10"
081700         PERFORM PASS
081800     ELSE
081900         MOVE    SQ-FS4-STATUS TO COMPUTED-A
082000         MOVE   "10" TO CORRECT-A
082100         MOVE   "END OF FILE STATUS CODE NOT GIVEN AT EOF"
082200                    TO RE-MARK
082300         MOVE   "VII-3, 1.3.5(2)A" TO ANSI-REFERENCE
082400         PERFORM FAIL.
082500 SEQ-TEST-04-01-END.
082600*
082700     ADD     1 TO REC-CT.
082800     IF MAJOR-DELETIONS NOT EQUAL TO 0
082900         GO TO   SEQ-DELETE-04-02.
083000     GO TO   SEQ-TEST-GF-04-02.
083100 SEQ-DELETE-04-02.
083200     PERFORM DE-LETE.
083300     GO TO   SEQ-TEST-04-02-END.
083400 SEQ-TEST-GF-04-02.
083500     IF DECL-EXEC-SW EQUAL "*I"
083600         PERFORM PASS
083700     ELSE
083800         MOVE    DECL-EXEC-SW TO COMPUTED-A
083900         MOVE   "*I" TO CORRECT-A
084000         MOVE   "CORRECT DECLARATIVE NOT EXECUTED AT EOF"
084100                   TO RE-MARK
084200         MOVE   "VII-2, VII-46, 4.4.4(10)C" TO ANSI-REFERENCE
084300         PERFORM FAIL.
084400 SEQ-TEST-04-02-END.
084500*
084600*
084700 SEQ-INIT-05.
084800     MOVE    1 TO REC-CT.
084900     MOVE   "**" TO SQ-FS4-STATUS.
085000     MOVE   "**" TO DECL-EXEC-SW.
085100     MOVE   "CLOSE AFTER READ" TO FEATURE.
085200     MOVE   "SEQ-TEST-GF-05" TO PAR-NAME.
085300     IF MAJOR-DELETIONS NOT = 0
085400         GO TO   SEQ-DELETE-05.
085500     GO TO   SEQ-TEST-GF-05.
085600 SEQ-DELETE-05.
085700     GO TO   SEQ-DELETE-05-01.
085800 SEQ-TEST-GF-05.
085900     CLOSE SQ-FS4.
086000*
086100     GO TO SEQ-TEST-GF-05-01.
086200 SEQ-DELETE-05-01.
086300     PERFORM DE-LETE.
086400     GO TO   SEQ-TEST-05-01-END.
086500 SEQ-TEST-GF-05-01.
086600     IF SQ-FS4-STATUS = "00"
086700         PERFORM PASS
086800     ELSE
086900         MOVE    SQ-FS4-STATUS TO COMPUTED-A
087000         MOVE   "00" TO CORRECT-A
087100         MOVE   "UNEXPECTED I-O STATUS VALUE FROM CLOSE"
087200                   TO RE-MARK
087300         MOVE   "VII-3, VII-38, 4.2.4(4)" TO ANSI-REFERENCE
087400         PERFORM FAIL.
087500 SEQ-TEST-05-01-END.
087600*
087700     ADD     1 TO REC-CT.
087800     IF MAJOR-DELETIONS NOT = 0
087900         GO TO SEQ-DELETE-05-02.
088000     GO TO   SEQ-TEST-GF-05-02.
088100 SEQ-DELETE-05-02.
088200     PERFORM DE-LETE.
088300     GO TO   SEQ-TEST-05-02-END.
088400 SEQ-TEST-GF-05-02.
088500     IF DECL-EXEC-SW = "**"
088600         PERFORM PASS
088700     ELSE
088800         MOVE    DECL-EXEC-SW TO COMPUTED-A
088900         MOVE   "**" TO CORRECT-A
089000         MOVE   "DECLARATIVE EXECUTED ON CLOSE FILE" TO RE-MARK
089100         PERFORM FAIL.
089200 SEQ-TEST-05-02-END.
089300     IF MAJOR-DELETIONS NOT LESS THAN 8
089400         SUBTRACT 8 FROM MAJOR-DELETIONS.
089500     IF MAJOR-DELETIONS NOT LESS THAN 4
089600         SUBTRACT 4 FROM MAJOR-DELETIONS.
089700     IF MAJOR-DELETIONS NOT LESS THAN 2
089800         SUBTRACT 2 FROM MAJOR-DELETIONS.
089900*
090000*
090100*    HAVING PROCESSED THE FILE WITH A READ ... RECORD STATEMENT,
090200*    IT WILL NOW BE PROCESSED WITH A READ STATEMENT WITHOUT THE
090300*    OPTIONAL WORD RECORD, AND THE SAME TESTS CARRIED OUT.
090400*
090500 SEQ-INIT-06.
090600     MOVE    1 TO REC-CT.
090700     MOVE   "**" TO DECL-EXEC-SW.
090800     MOVE   "**" TO SQ-FS4-STATUS.
090900     MOVE   "OPEN FILE FOR CHECK" TO FEATURE.
091000     MOVE   "SEQ-TEST-GF-06" TO PAR-NAME.
091100     IF MAJOR-DELETIONS NOT = 0
091200         GO TO SEQ-DELETE-06.
091300     GO TO   SEQ-TEST-GF-06.
091400 SEQ-DELETE-06.
091500     ADD     2 TO MAJOR-DELETIONS.
091600     GO TO   SEQ-DELETE-06-01.
091700*
091800 SEQ-TEST-GF-06.
091900     OPEN INPUT SQ-FS4.
092000     GO TO   SEQ-TEST-GF-06-01.
092100 SEQ-DELETE-06-01.
092200     PERFORM DE-LETE.
092300     GO TO   SEQ-TEST-06-01-END.
092400 SEQ-TEST-GF-06-01.
092500     IF SQ-FS4-STATUS = "00"
092600         PERFORM PASS
092700     ELSE
092800         MOVE    SQ-FS4-STATUS TO COMPUTED-A
092900         MOVE   "00" TO CORRECT-A
093000         MOVE   "FAILURE STATUS CODE AFTER OPEN" TO RE-MARK
093100         PERFORM FAIL.
093200     IF SQ-FS4-STATUS GREATER THAN "10"
093300         ADD     2 TO MAJOR-DELETIONS.
093400 SEQ-TEST-06-01-END.
093500*
093600     ADD     1 TO REC-CT.
093700     GO TO   SEQ-TEST-GF-06-02.
093800 SEQ-DELETE-06-02.
093900     PERFORM DE-LETE.
094000     GO TO   SEQ-TEST-06-02-END.
094100 SEQ-TEST-GF-06-02.
094200     IF DECL-EXEC-SW = "**"
094300         PERFORM PASS
094400     ELSE
094500         MOVE    DECL-EXEC-SW TO COMPUTED-A
094600         MOVE   "**" TO CORRECT-A
094700         MOVE   "DECLARATIVE EXECUTED ON OPEN" TO RE-MARK
094800         PERFORM FAIL.
094900 SEQ-TEST-06-02-END.
095000*
095100*
095200*    THE NEXT GROUP OF TEST READ THE RECORDS FROM THE FILE,
095300*    USING A READ STATEMENT WITHOUT OPTIONAL PHRASES.  THE
095400*    RECORDS RETURNED FROM THE FILE ARE CHECKED FOR EXPECTED
095500*    CONTENTS.  FILE STATUS VALUES AND EXECUTION OF
095600*    DECLARATIVE PROCEDURES ARE ALSO CHECKED.
095700*
095800 SEQ-INIT-07.
095900     MOVE    1 TO REC-CT.
096000     MOVE   "READ ..." TO FEATURE.
096100     MOVE   "SEQ-TEST-GF-07" TO PAR-NAME.
096200     IF MAJOR-DELETIONS NOT = 0
096300         GO TO SEQ-DELETE-07.
096400     GO TO   SEQ-TEST-GF-07.
096500 SEQ-DELETE-07.
096600     ADD     4 TO MAJOR-DELETIONS.
096700     GO TO   SEQ-DELETE-07-01.
096800 SEQ-TEST-GF-07.
096900     MOVE    ZERO TO XRECORD-NUMBER (1).
097000     MOVE    ZERO TO COUNT-OF-RECS.
097100     MOVE    ZERO TO PERM-ERRORS.
097200     MOVE    ZERO TO RECORDS-IN-ERROR.
097300     MOVE   "**" TO DECL-EXEC-SW.
097400     MOVE   "00" TO SQ-FS4-STATUS-COPY.
097500 SEQ-TEST-07-LOOP.
097600     MOVE   "**" TO SQ-FS4-STATUS.
097700     READ    SQ-FS4.
097800     IF DECL-EXEC-SW NOT = "**"
097900          GO TO SEQ-TEST-GF-07-01.
098000     IF SQ-FS4-STATUS = "10"
098100          GO TO SEQ-TEST-GF-07-LOOP-END.
098200     IF SQ-FS4-STATUS NOT = "00"
098300          MOVE    SQ-FS4-STATUS TO SQ-FS4-STATUS-COPY.
098400     ADD     1 TO XRECORD-NUMBER (1).
098500     ADD     1 TO COUNT-OF-RECS.
098600     IF SQ-FS4-FIRST NOT EQUAL TO FILE-RECORD-INFO-P1-120 (1)
098700        OR SQ-FS4-REC-NO NOT EQUAL TO COUNT-OF-RECS
098800         ADD     1 TO RECORDS-IN-ERROR.
098900     IF COUNT-OF-RECS LESS THAN 980
099000         GO TO   SEQ-TEST-07-LOOP.
099100*
099200 SEQ-TEST-GF-07-LOOP-END.
099300     IF MAJOR-DELETIONS NOT = 0
099400         GO TO   SEQ-DELETE-07-01.
099500     GO TO   SEQ-TEST-GF-07-01.
099600 SEQ-DELETE-07-01.
099700     PERFORM DE-LETE.
099800     GO TO   SEQ-TEST-07-01-END.
099900 SEQ-TEST-GF-07-01.
100000     IF COUNT-OF-RECS EQUAL TO 980
100100         PERFORM PASS
100200     ELSE
100300         MOVE    COUNT-OF-RECS TO COMPUTED-18V0
100400         MOVE    980 TO CORRECT-18V0
100500         MOVE   "UNEXPECTED NUMBER OF RECORDS BEFORE EOF"
100600                    TO RE-MARK
100700         PERFORM FAIL.
100800 SEQ-TEST-07-01-END.
100900*
101000     ADD     1 TO REC-CT.
101100     IF MAJOR-DELETIONS NOT = 0
101200         GO TO   SEQ-TEST-07-02-END.
101300     GO TO   SEQ-TEST-GF-07-02.
101400 SEQ-DELETE-07-02.
101500     PERFORM DE-LETE.
101600     GO TO   SEQ-TEST-07-02-END.
101700 SEQ-TEST-GF-07-02.
101800     IF DECL-EXEC-SW = "**"
101900         PERFORM PASS
102000     ELSE
102100         MOVE    DECL-EXEC-SW TO COMPUTED-A
102200         MOVE   "**" TO CORRECT-A
102300         MOVE   "DECLARATIVES ENTERED AT LEAST ONCE" TO RE-MARK
102400         PERFORM FAIL.
102500 SEQ-TEST-07-02-END.
102600*
102700     ADD     1 TO REC-CT.
102800     IF MAJOR-DELETIONS NOT = 0
102900         GO TO   SEQ-TEST-07-03-END.
103000     GO TO   SEQ-TEST-GF-07-03.
103100 SEQ-DELETE-07-03.
103200     PERFORM DE-LETE.
103300     GO TO   SEQ-TEST-07-03-END.
103400 SEQ-TEST-GF-07-03.
103500     IF SQ-FS4-STATUS-COPY = "00"
103600         PERFORM PASS
103700     ELSE
103800         MOVE    SQ-FS4-STATUS-COPY TO COMPUTED-A
103900         MOVE   "00" TO CORRECT-A
104000         MOVE   "AT LEAST ONE UNSUCCESSFUL READ" TO RE-MARK
104100         MOVE   "VII-2" TO ANSI-REFERENCE
104200         PERFORM FAIL.
104300 SEQ-TEST-07-03-END.
104400*
104500     ADD     1 TO REC-CT.
104600     IF MAJOR-DELETIONS NOT = 0
104700         GO TO   SEQ-TEST-07-04-END.
104800     GO TO   SEQ-TEST-GF-07-04.
104900 SEQ-DELETE-07-04.
105000     PERFORM DE-LETE.
105100     GO TO   SEQ-TEST-07-04-END.
105200 SEQ-TEST-GF-07-04.
105300     IF RECORDS-IN-ERROR EQUAL TO ZERO
105400         PERFORM PASS
105500     ELSE
105600         MOVE    RECORDS-IN-ERROR TO COMPUTED-18V0
105700         MOVE    ZERO TO CORRECT-18V0
105800         MOVE   "ONE OR MORE ERRORS IN RECORDS READ" TO RE-MARK
105900         PERFORM FAIL.
106000 SEQ-TEST-07-04-END.
106100*
106200*
106300*    THE NEXT TEST EXECUTES ONE READ STATEMENT WITH THE FILE
106400*    POSITIONED AFTER THE LAST RECORD.  THE READ STATEMENT DOES
106500*    NOT CONTAIN AN AT END PHRASE, SO THE APPROPRIATE
106600*    DECLARATIVE SHOULD BE EXECUTED.
106700*
106800 SEQ-INIT-08.
106900     MOVE    1 TO REC-CT.
107000     MOVE   "**" TO SQ-FS4-STATUS.
107100     MOVE   "**" TO DECL-EXEC-SW.
107200     MOVE   "READ ... EOF" TO FEATURE.
107300     MOVE   "SEQ-TEST-GF-08" TO PAR-NAME.
107400     IF MAJOR-DELETIONS NOT = 0
107500         GO TO SEQ-DELETE-08.
107600     GO TO   SEQ-TEST-GF-08.
107700 SEQ-DELETE-08.
107800     ADD     8 TO MAJOR-DELETIONS.
107900     PERFORM DE-LETE.
108000     GO TO   SEQ-DELETE-08-01.
108100 SEQ-TEST-GF-08.
108200     READ    SQ-FS4.
108300*
108400     GO TO   SEQ-TEST-GF-08-01.
108500 SEQ-DELETE-08-01.
108600     PERFORM DE-LETE.
108700     GO TO   SEQ-TEST-08-01-END.
108800 SEQ-TEST-GF-08-01.
108900     IF SQ-FS4-STATUS = "10"
109000         PERFORM PASS
109100     ELSE
109200         MOVE    SQ-FS4-STATUS TO COMPUTED-A
109300         MOVE   "10" TO CORRECT-A
109400         MOVE   "END OF FILE STATUS CODE NOT GIVEN AT EOF"
109500                    TO RE-MARK
109600         MOVE   "VII-3, 1.3.5(2)A" TO ANSI-REFERENCE
109700         PERFORM FAIL.
109800 SEQ-TEST-08-01-END.
109900*
110000     ADD     1 TO REC-CT.
110100     IF MAJOR-DELETIONS NOT EQUAL TO 0
110200         GO TO   SEQ-DELETE-08-02.
110300     GO TO   SEQ-TEST-GF-08-02.
110400 SEQ-DELETE-08-02.
110500     PERFORM DE-LETE.
110600     GO TO   SEQ-TEST-08-02-END.
110700 SEQ-TEST-GF-08-02.
110800     IF DECL-EXEC-SW EQUAL "*I"
110900         PERFORM PASS
111000     ELSE
111100         MOVE    DECL-EXEC-SW TO COMPUTED-A
111200         MOVE   "*I" TO CORRECT-A
111300         MOVE   "CORRECT DECLARATIVE NOT EXECUTED AT EOF"
111400                  TO RE-MARK
111500         MOVE   "VII-2, VII-46, 4.4.4(10)C" TO ANSI-REFERENCE
111600         PERFORM FAIL.
111700 SEQ-TEST-08-02-END.
111800*
111900*
112000*    CLOSE THE FILE AND CHECK FILE STATUS AND THAT THE
112100*    DECLARATIVE IS NOT EXECUTED
112200*
112300 SEQ-INIT-09.
112400     MOVE    1 TO REC-CT.
112500     MOVE   "**" TO SQ-FS4-STATUS.
112600     MOVE   "**" TO DECL-EXEC-SW.
112700     MOVE   "CLOSE AFTER READ" TO FEATURE.
112800     MOVE   "SEQ-TEST-GF-09" TO PAR-NAME.
112900     IF MAJOR-DELETIONS NOT = 0
113000         GO TO   SEQ-DELETE-09.
113100     GO TO   SEQ-TEST-GF-09.
113200 SEQ-DELETE-09.
113300     GO TO   SEQ-DELETE-09-01.
113400 SEQ-TEST-GF-09.
113500     CLOSE SQ-FS4.
113600*
113700     GO TO SEQ-TEST-GF-09-01.
113800 SEQ-DELETE-09-01.
113900     PERFORM DE-LETE.
114000     GO TO   SEQ-TEST-09-01-END.
114100 SEQ-TEST-GF-09-01.
114200     IF SQ-FS4-STATUS = "00"
114300         PERFORM PASS
114400     ELSE
114500         MOVE    SQ-FS4-STATUS TO COMPUTED-A
114600         MOVE   "00" TO CORRECT-A
114700         MOVE   "UNEXPECTED I-O STATUS VALUE FROM CLOSE"
114800                   TO RE-MARK
114900         MOVE   "VII-3, VII-38, 4.2.4(4)" TO ANSI-REFERENCE
115000         PERFORM FAIL.
115100 SEQ-TEST-09-01-END.
115200*
115300     ADD     1 TO REC-CT.
115400     IF MAJOR-DELETIONS NOT = 0
115500         GO TO SEQ-DELETE-09-02.
115600     GO TO   SEQ-TEST-GF-09-02.
115700 SEQ-DELETE-09-02.
115800     PERFORM DE-LETE.
115900     GO TO   SEQ-TEST-09-02-END.
116000 SEQ-TEST-GF-09-02.
116100     IF DECL-EXEC-SW = "**"
116200         PERFORM PASS
116300     ELSE
116400         MOVE    DECL-EXEC-SW TO COMPUTED-A
116500         MOVE   "**" TO CORRECT-A
116600         MOVE   "DECLARATIVE EXECUTED ON CLOSE FILE" TO RE-MARK
116700         PERFORM FAIL.
116800 SEQ-TEST-09-02-END.
116900*
117000 TERMINATE-ROUTINE.
117100     EXIT.
117200 CCVS-EXIT SECTION.
117300 CCVS-999999.
117400     GO TO CLOSE-FILES.
