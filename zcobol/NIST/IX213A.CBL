000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IX213A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*    THIS PROGRAM CREATES A 100 RECORD FIXED LENGTH INDEXED FILE
002200*    WHOSE  ACCESS  MODES  IS DYNAMIC AND CONTAINS 100 DUPLICATE
002300*    ALTERNATE  KEYS.  THE  INDEXED  FILE  IS MANIPULATED BY THE
002400*    DUPLICATE ALTERNATE KEYS USING THE FOLLOWING VERBS:
002500*
002600*            . DELETE
002700*            . READ ... NEXT RECORD
002800*            . READ ... RECORD KEY
002900*            . REWRITE
003000*            . START
003100*
003200 ENVIRONMENT DIVISION.
003300 CONFIGURATION SECTION.
003400 SOURCE-COMPUTER.
003500     XXXXX082.
003600 OBJECT-COMPUTER.
003700     XXXXX083.
003800 INPUT-OUTPUT SECTION.
003900 FILE-CONTROL.
004000P    SELECT RAW-DATA   ASSIGN TO
004100P    XXXXX062
004200P           ORGANIZATION IS INDEXED
004300P           ACCESS MODE IS RANDOM
004400P           RECORD KEY IS RAW-DATA-KEY.
004500     SELECT PRINT-FILE ASSIGN TO
004600     XXXXX055.
004700     SELECT IX-FS1
004800     ASSIGN TO
004900     XXXXX024
005000J    XXXXX044
005100     ACCESS MODE IS DYNAMIC
005200     RECORD KEY IS IX-FS1-KEY
005300     ALTERNATE RECORD KEY IS IX-FS1-ALT01 WITH DUPLICATES
005400     ALTERNATE RECORD KEY IS IX-FS1-ALT02 WITH DUPLICATES
005500     ALTERNATE RECORD KEY IS IX-FS1-ALT03 WITH DUPLICATES
005600     ALTERNATE RECORD KEY IS IX-FS1-ALT04 WITH DUPLICATES
005700     ALTERNATE RECORD KEY IS IX-FS1-ALT05 WITH DUPLICATES
005800     ALTERNATE RECORD KEY IS IX-FS1-ALT06 WITH DUPLICATES
005900     ALTERNATE RECORD KEY IS IX-FS1-ALT07 WITH DUPLICATES
006000     ALTERNATE RECORD KEY IS IX-FS1-ALT08 WITH DUPLICATES
006100     ALTERNATE RECORD KEY IS IX-FS1-ALT09 WITH DUPLICATES
006200     ALTERNATE RECORD KEY IS IX-FS1-ALT10 WITH DUPLICATES
006300     ORGANIZATION IS INDEXED.
006400 DATA DIVISION.
006500 FILE SECTION.
006600P
006700PFD  RAW-DATA.
006800P
006900P01  RAW-DATA-SATZ.
007000P    05  RAW-DATA-KEY        PIC X(6).
007100P    05  C-DATE              PIC 9(6).
007200P    05  C-TIME              PIC 9(8).
007300P    05  C-NO-OF-TESTS       PIC 99.
007400P    05  C-OK                PIC 999.
007500P    05  C-ALL               PIC 999.
007600P    05  C-FAIL              PIC 999.
007700P    05  C-DELETED           PIC 999.
007800P    05  C-INSPECT           PIC 999.
007900P    05  C-NOTE              PIC X(13).
008000P    05  C-INDENT            PIC X.
008100P    05  C-ABORT             PIC X(8).
008200 FD  PRINT-FILE.
008300 01  PRINT-REC PICTURE X(120).
008400 01  DUMMY-RECORD PICTURE X(120).
008500 FD  IX-FS1
008600C    LABEL RECORDS ARE STANDARD
008700C    DATA RECORD IS IX-FS1-RECORD
008800     RECORD CONTAINS 116 CHARACTERS.
008900 01  IX-FS1-RECORD.
009000     02 IX-FS1-KEY                 PIC X(6).
009100     02 IX-FS1-ALT01               PIC X(11).
009200     02 IX-FS1-ALT02               PIC X(11).
009300     02 IX-FS1-ALT03               PIC X(11).
009400     02 IX-FS1-ALT04               PIC X(11).
009500     02 IX-FS1-ALT05               PIC X(11).
009600     02 IX-FS1-ALT06               PIC X(11).
009700     02 IX-FS1-ALT07               PIC X(11).
009800     02 IX-FS1-ALT08               PIC X(11).
009900     02 IX-FS1-ALT09               PIC X(11).
010000     02 IX-FS1-ALT10               PIC X(11).
010100 WORKING-STORAGE SECTION.
010200 01  RECORD-COUNTER              PIC 999    VALUE ZEROS.
010300 01  INVKEY-COUNTER              PIC 999    VALUE ZEROS.
010400 01  WORK-RECORD.
010500     02 FILLER                   PIC XXX    VALUE "AAA".
010600     02 COUNTER00                PIC 999.
010700     02 FILLER                   PIC XXX    VALUE "CCC".
010800     02 COUNTER01                PIC 999.
010900     02 FILLER                   PIC X(5)   VALUE "ALT01".
011000     02 FILLER                   PIC XXX    VALUE "EEE".
011100     02 COUNTER02                PIC 999.
011200     02 FILLER                   PIC X(5)   VALUE "ALT02".
011300     02 FILLER                   PIC XXX    VALUE "GGG".
011400     02 COUNTER03                PIC 999.
011500     02 FILLER                   PIC X(5)   VALUE "ALT03".
011600     02 FILLER                   PIC XXX    VALUE "III".
011700     02 COUNTER04                PIC 999.
011800     02 FILLER                   PIC X(5)   VALUE "ALT04".
011900     02 FILLER                   PIC XXX    VALUE "KKK".
012000     02 COUNTER05                PIC 999.
012100     02 FILLER                   PIC X(5)   VALUE "ALT05".
012200     02 FILLER                   PIC XXX    VALUE "MMM".
012300     02 COUNTER06                PIC 999.
012400     02 FILLER                   PIC X(5)   VALUE "ALT06".
012500     02 FILLER                   PIC XXX    VALUE "OOO".
012600     02 COUNTER07                PIC 999.
012700     02 FILLER                   PIC X(5)   VALUE "ALT07".
012800     02 FILLER                   PIC XXX    VALUE "QQQ".
012900     02 COUNTER08                PIC 999.
013000     02 FILLER                   PIC X(5)   VALUE "ALT08".
013100     02 FILLER                   PIC XXX    VALUE "SSS".
013200     02 COUNTER09                PIC 999.
013300     02 FILLER                   PIC X(5)   VALUE "ALT09".
013400     02 FILLER                   PIC XXX    VALUE "UUU".
013500     02 COUNTER10                PIC 999.
013600     02 FILLER                   PIC X(5)   VALUE "ALT10".
013700 01  TEST-RESULTS.
013800     02 FILLER                   PIC X      VALUE SPACE.
013900     02 FEATURE                  PIC X(20)  VALUE SPACE.
014000     02 FILLER                   PIC X      VALUE SPACE.
014100     02 P-OR-F                   PIC X(5)   VALUE SPACE.
014200     02 FILLER                   PIC X      VALUE SPACE.
014300     02  PAR-NAME.
014400       03 FILLER                 PIC X(19)  VALUE SPACE.
014500       03  PARDOT-X              PIC X      VALUE SPACE.
014600       03 DOTVALUE               PIC 99     VALUE ZERO.
014700     02 FILLER                   PIC X(8)   VALUE SPACE.
014800     02 RE-MARK                  PIC X(61).
014900 01  TEST-COMPUTED.
015000     02 FILLER                   PIC X(30)  VALUE SPACE.
015100     02 FILLER                   PIC X(17)  VALUE
015200            "       COMPUTED=".
015300     02 COMPUTED-X.
015400     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
015500     03 COMPUTED-N               REDEFINES COMPUTED-A
015600                                 PIC -9(9).9(9).
015700     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
015800     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
015900     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
016000     03       CM-18V0 REDEFINES COMPUTED-A.
016100         04 COMPUTED-18V0                    PIC -9(18).
016200         04 FILLER                           PIC X.
016300     03 FILLER PIC X(50) VALUE SPACE.
016400 01  TEST-CORRECT.
016500     02 FILLER PIC X(30) VALUE SPACE.
016600     02 FILLER PIC X(17) VALUE "       CORRECT =".
016700     02 CORRECT-X.
016800     03 CORRECT-A                  PIC X(20) VALUE SPACE.
016900     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
017000     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
017100     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
017200     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
017300     03      CR-18V0 REDEFINES CORRECT-A.
017400         04 CORRECT-18V0                     PIC -9(18).
017500         04 FILLER                           PIC X.
017600     03 FILLER PIC X(2) VALUE SPACE.
017700     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
017800 01  CCVS-C-1.
017900     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
018000-    "SS  PARAGRAPH-NAME
018100-    "       REMARKS".
018200     02 FILLER                     PIC X(20)    VALUE SPACE.
018300 01  CCVS-C-2.
018400     02 FILLER                     PIC X        VALUE SPACE.
018500     02 FILLER                     PIC X(6)     VALUE "TESTED".
018600     02 FILLER                     PIC X(15)    VALUE SPACE.
018700     02 FILLER                     PIC X(4)     VALUE "FAIL".
018800     02 FILLER                     PIC X(94)    VALUE SPACE.
018900 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
019000 01  REC-CT                        PIC 99       VALUE ZERO.
019100 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
019200 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
019300 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
019400 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
019500 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
019600 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
019700 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
019800 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
019900 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
020000 01  CCVS-H-1.
020100     02  FILLER                    PIC X(39)    VALUE SPACES.
020200     02  FILLER                    PIC X(42)    VALUE
020300     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
020400     02  FILLER                    PIC X(39)    VALUE SPACES.
020500 01  CCVS-H-2A.
020600   02  FILLER                        PIC X(40)  VALUE SPACE.
020700   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
020800   02  FILLER                        PIC XXXX   VALUE
020900     "4.2 ".
021000   02  FILLER                        PIC X(28)  VALUE
021100            " COPY - NOT FOR DISTRIBUTION".
021200   02  FILLER                        PIC X(41)  VALUE SPACE.
021300
021400 01  CCVS-H-2B.
021500   02  FILLER                        PIC X(15)  VALUE
021600            "TEST RESULT OF ".
021700   02  TEST-ID                       PIC X(9).
021800   02  FILLER                        PIC X(4)   VALUE
021900            " IN ".
022000   02  FILLER                        PIC X(12)  VALUE
022100     " HIGH       ".
022200   02  FILLER                        PIC X(22)  VALUE
022300            " LEVEL VALIDATION FOR ".
022400   02  FILLER                        PIC X(58)  VALUE
022500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
022600 01  CCVS-H-3.
022700     02  FILLER                      PIC X(34)  VALUE
022800            " FOR OFFICIAL USE ONLY    ".
022900     02  FILLER                      PIC X(58)  VALUE
023000     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
023100     02  FILLER                      PIC X(28)  VALUE
023200            "  COPYRIGHT   1985 ".
023300 01  CCVS-E-1.
023400     02 FILLER                       PIC X(52)  VALUE SPACE.
023500     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
023600     02 ID-AGAIN                     PIC X(9).
023700     02 FILLER                       PIC X(45)  VALUE SPACES.
023800 01  CCVS-E-2.
023900     02  FILLER                      PIC X(31)  VALUE SPACE.
024000     02  FILLER                      PIC X(21)  VALUE SPACE.
024100     02 CCVS-E-2-2.
024200         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
024300         03 FILLER                   PIC X      VALUE SPACE.
024400         03 ENDER-DESC               PIC X(44)  VALUE
024500            "ERRORS ENCOUNTERED".
024600 01  CCVS-E-3.
024700     02  FILLER                      PIC X(22)  VALUE
024800            " FOR OFFICIAL USE ONLY".
024900     02  FILLER                      PIC X(12)  VALUE SPACE.
025000     02  FILLER                      PIC X(58)  VALUE
025100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025200     02  FILLER                      PIC X(13)  VALUE SPACE.
025300     02 FILLER                       PIC X(15)  VALUE
025400             " COPYRIGHT 1985".
025500 01  CCVS-E-4.
025600     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
025700     02 FILLER                       PIC X(4)   VALUE " OF ".
025800     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
025900     02 FILLER                       PIC X(40)  VALUE
026000      "  TESTS WERE EXECUTED SUCCESSFULLY".
026100 01  XXINFO.
026200     02 FILLER                       PIC X(19)  VALUE
026300            "*** INFORMATION ***".
026400     02 INFO-TEXT.
026500       04 FILLER                     PIC X(8)   VALUE SPACE.
026600       04 XXCOMPUTED                 PIC X(20).
026700       04 FILLER                     PIC X(5)   VALUE SPACE.
026800       04 XXCORRECT                  PIC X(20).
026900     02 INF-ANSI-REFERENCE           PIC X(48).
027000 01  HYPHEN-LINE.
027100     02 FILLER  PIC IS X VALUE IS SPACE.
027200     02 FILLER  PIC IS X(65)    VALUE IS "************************
027300-    "*****************************************".
027400     02 FILLER  PIC IS X(54)    VALUE IS "************************
027500-    "******************************".
027600 01  CCVS-PGM-ID                     PIC X(9)   VALUE
027700     "IX213A".
027800 PROCEDURE DIVISION.
027900 CCVS1 SECTION.
028000 OPEN-FILES.
028100P    OPEN I-O RAW-DATA.
028200P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
028300P    READ RAW-DATA INVALID KEY GO TO END-E-1.
028400P    MOVE "ABORTED " TO C-ABORT.
028500P    ADD 1 TO C-NO-OF-TESTS.
028600P    ACCEPT C-DATE  FROM DATE.
028700P    ACCEPT C-TIME  FROM TIME.
028800P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
028900PEND-E-1.
029000P    CLOSE RAW-DATA.
029100     OPEN    OUTPUT PRINT-FILE.
029200     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
029300     MOVE    SPACE TO TEST-RESULTS.
029400     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
029500     GO TO CCVS1-EXIT.
029600 CLOSE-FILES.
029700P    OPEN I-O RAW-DATA.
029800P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
029900P    READ RAW-DATA INVALID KEY GO TO END-E-2.
030000P    MOVE "OK.     " TO C-ABORT.
030100P    MOVE PASS-COUNTER TO C-OK.
030200P    MOVE ERROR-HOLD   TO C-ALL.
030300P    MOVE ERROR-COUNTER TO C-FAIL.
030400P    MOVE DELETE-COUNTER TO C-DELETED.
030500P    MOVE INSPECT-COUNTER TO C-INSPECT.
030600P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
030700PEND-E-2.
030800P    CLOSE RAW-DATA.
030900     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
031000 TERMINATE-CCVS.
031100S    EXIT PROGRAM.
031200STERMINATE-CALL.
031300     STOP     RUN.
031400 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
031500 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
031600 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
031700 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
031800     MOVE "****TEST DELETED****" TO RE-MARK.
031900 PRINT-DETAIL.
032000     IF REC-CT NOT EQUAL TO ZERO
032100             MOVE "." TO PARDOT-X
032200             MOVE REC-CT TO DOTVALUE.
032300     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
032400     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
032500        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
032600          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
032700     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
032800     MOVE SPACE TO CORRECT-X.
032900     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
033000     MOVE     SPACE TO RE-MARK.
033100 HEAD-ROUTINE.
033200     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033300     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033400     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
033500     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
033600 COLUMN-NAMES-ROUTINE.
033700     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033800     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
034000 END-ROUTINE.
034100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
034200 END-RTN-EXIT.
034300     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034400 END-ROUTINE-1.
034500      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
034600      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
034700      ADD PASS-COUNTER TO ERROR-HOLD.
034800*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
034900      MOVE PASS-COUNTER TO CCVS-E-4-1.
035000      MOVE ERROR-HOLD TO CCVS-E-4-2.
035100      MOVE CCVS-E-4 TO CCVS-E-2-2.
035200      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
035300  END-ROUTINE-12.
035400      MOVE "TEST(S) FAILED" TO ENDER-DESC.
035500     IF       ERROR-COUNTER IS EQUAL TO ZERO
035600         MOVE "NO " TO ERROR-TOTAL
035700         ELSE
035800         MOVE ERROR-COUNTER TO ERROR-TOTAL.
035900     MOVE     CCVS-E-2 TO DUMMY-RECORD.
036000     PERFORM WRITE-LINE.
036100 END-ROUTINE-13.
036200     IF DELETE-COUNTER IS EQUAL TO ZERO
036300         MOVE "NO " TO ERROR-TOTAL  ELSE
036400         MOVE DELETE-COUNTER TO ERROR-TOTAL.
036500     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
036600     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036700      IF   INSPECT-COUNTER EQUAL TO ZERO
036800          MOVE "NO " TO ERROR-TOTAL
036900      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
037000      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
037100      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037200     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037300 WRITE-LINE.
037400     ADD 1 TO RECORD-COUNT.
037500Y    IF RECORD-COUNT GREATER 42
037600Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
037700Y        MOVE SPACE TO DUMMY-RECORD
037800Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
037900Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
038000Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
038100Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
038200Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
038300Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
038400Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
038500Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
038600Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
038700Y        MOVE ZERO TO RECORD-COUNT.
038800     PERFORM WRT-LN.
038900 WRT-LN.
039000     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
039100     MOVE SPACE TO DUMMY-RECORD.
039200 BLANK-LINE-PRINT.
039300     PERFORM WRT-LN.
039400 FAIL-ROUTINE.
039500     IF     COMPUTED-X NOT EQUAL TO SPACE
039600            GO TO   FAIL-ROUTINE-WRITE.
039700     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
039800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
039900     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
040000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040100     MOVE   SPACES TO INF-ANSI-REFERENCE.
040200     GO TO  FAIL-ROUTINE-EX.
040300 FAIL-ROUTINE-WRITE.
040400     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
040500     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
040600     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
040700     MOVE   SPACES TO COR-ANSI-REFERENCE.
040800 FAIL-ROUTINE-EX. EXIT.
040900 BAIL-OUT.
041000     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
041100     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
041200 BAIL-OUT-WRITE.
041300     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
041400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
041500     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041600     MOVE   SPACES TO INF-ANSI-REFERENCE.
041700 BAIL-OUT-EX. EXIT.
041800 CCVS1-EXIT.
041900     EXIT.
042000 WRITE-INIT-GF-01.
042100     OPEN OUTPUT IX-FS1.
042200     PERFORM CREATE-IX-FS1 VARYING RECORD-COUNTER FROM 1 BY 1
042300        UNTIL RECORD-COUNTER IS GREATER THAN 100.
042400 CREATE-IX-FS1.
042500     MOVE RECORD-COUNTER TO COUNTER00, COUNTER01, COUNTER02,
042600        COUNTER03, COUNTER04, COUNTER05, COUNTER06, COUNTER07,
042700        COUNTER08, COUNTER09, COUNTER10.
042800     IF RECORD-COUNTER = 011 MOVE 010 TO COUNTER01, COUNTER02,
042900        COUNTER03, COUNTER04, COUNTER05, COUNTER06, COUNTER07,
043000        COUNTER08, COUNTER09, COUNTER10.
043100     IF RECORD-COUNTER = 021 MOVE 020 TO COUNTER01, COUNTER02,
043200        COUNTER03, COUNTER04, COUNTER05, COUNTER06, COUNTER07,
043300        COUNTER08, COUNTER09, COUNTER10.
043400     IF RECORD-COUNTER = 031 MOVE 030 TO COUNTER01, COUNTER02,
043500        COUNTER03, COUNTER04, COUNTER05, COUNTER06, COUNTER07,
043600        COUNTER08, COUNTER09, COUNTER10.
043700     IF RECORD-COUNTER = 041 MOVE 040 TO COUNTER01, COUNTER02,
043800        COUNTER03, COUNTER04, COUNTER05, COUNTER06, COUNTER07,
043900        COUNTER08, COUNTER09, COUNTER10.
044000     IF RECORD-COUNTER = 051 MOVE 050 TO COUNTER01, COUNTER02,
044100        COUNTER03, COUNTER04, COUNTER05, COUNTER06, COUNTER07,
044200        COUNTER08, COUNTER09, COUNTER10.
044300     IF RECORD-COUNTER = 061 MOVE 060 TO COUNTER01, COUNTER02,
044400        COUNTER03, COUNTER04, COUNTER05, COUNTER06, COUNTER07,
044500        COUNTER08, COUNTER09, COUNTER10.
044600     IF RECORD-COUNTER = 071 MOVE 070 TO COUNTER01, COUNTER02,
044700        COUNTER03, COUNTER04, COUNTER05, COUNTER06, COUNTER07,
044800        COUNTER08, COUNTER09, COUNTER10.
044900     IF RECORD-COUNTER = 081 MOVE 080 TO COUNTER01, COUNTER02,
045000        COUNTER03, COUNTER04, COUNTER05, COUNTER06, COUNTER07,
045100        COUNTER08, COUNTER09, COUNTER10.
045200     IF RECORD-COUNTER = 091 MOVE 090 TO COUNTER01, COUNTER02,
045300        COUNTER03, COUNTER04, COUNTER05, COUNTER06, COUNTER07,
045400        COUNTER08, COUNTER09, COUNTER10.
045500     WRITE IX-FS1-RECORD FROM WORK-RECORD INVALID KEY
045600        ADD 1 TO INVKEY-COUNTER.
045700 WRITE-TEST-GD-01.
045800     MOVE "WRITE INVALID KEY" TO FEATURE.
045900     MOVE "WRITE-TEST-GF-01" TO PAR-NAME.
046000     MOVE "CREATE IX-FS1" TO RE-MARK.
046100     IF INVKEY-COUNTER = 0
046200        PERFORM PASS
046300        ELSE GO TO WRITE-FAIL-GF-01.
046400     GO TO WRITE-WRITE-GF-01.
046500 INDEX-DELETE-1.
046600     PERFORM DE-LETE.
046700     GO TO WRITE-WRITE-GF-01.
046800 WRITE-FAIL-GF-01.
046900     MOVE "IX-41; 4.9.2, FILE NOT CREATED CORRECTLY" TO RE-MARK.
047000     PERFORM FAIL.
047100     MOVE INVKEY-COUNTER TO COMPUTED-18V0.
047200     MOVE 0 TO CORRECT-18V0.
047300 WRITE-WRITE-GF-01.
047400     PERFORM PRINT-DETAIL.
047500 READ-TEST-F2-01.
047600     CLOSE IX-FS1.
047700     OPEN I-O IX-FS1.
047800     MOVE "READ...RECORD KEY" TO FEATURE.
047900     MOVE "READ-TEST-F2-01" TO PAR-NAME.
048000     MOVE "RETRIEVED BY ALTERNATE KEY 1" TO RE-MARK.
048100     MOVE "CCC050ALT01" TO IX-FS1-ALT01.
048200     READ IX-FS1 RECORD
048300                        KEY IS IX-FS1-ALT01
048400       INVALID KEY  GO TO READ-INVALID-F2-01.
048500     IF IX-FS1-KEY = "AAA050"
048600        PERFORM PASS
048700        ELSE GO TO READ-FAIL-F2-01.
048800     GO TO READ-WRITE-F2-01.
048900 READ-DELETE-F2-01.
049000     PERFORM DE-LETE.
049100     GO TO READ-WRITE-F2-01.
049200 READ-INVALID-F2-01.
049300     MOVE "IX-28; 4.5.2 AND IX-6 1.3.5 INVALID KEY PATH TAKEN"
049400            TO RE-MARK.
049500     PERFORM FAIL.
049600     MOVE "INVALID KEY" TO COMPUTED-A.
049700     MOVE "CCC050ALT01" TO CORRECT-A.
049800     GO TO READ-WRITE-F2-01.
049900 READ-FAIL-F2-01.
050000     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
050100     PERFORM FAIL.
050200     MOVE IX-FS1-KEY TO COMPUTED-A.
050300     MOVE "AAA050" TO CORRECT-A.
050400 READ-WRITE-F2-01.
050500     PERFORM PRINT-DETAIL.
050600 READ-TEST-F2-02.
050700     MOVE "READ...RECORD KEY" TO FEATURE.
050800     MOVE "READ-TEST-F2-02"  TO PAR-NAME.
050900     MOVE "RETRIEVED BY ALTERNATE KEY 8" TO RE-MARK.
051000     MOVE "QQQ040ALT08" TO IX-FS1-ALT08.
051100     READ IX-FS1 RECORD
051200                        KEY IS IX-FS1-ALT08
051300       INVALID KEY  GO TO READ-INVALID-F2-02.
051400     IF IX-FS1-KEY = "AAA040"
051500        PERFORM PASS
051600        ELSE GO TO READ-FAIL-F2-02.
051700     GO TO READ-WRITE-F2-02.
051800 READ-DELETE-F2-02.
051900     PERFORM DE-LETE.
052000     GO TO READ-WRITE-F2-02.
052100 READ-INVALID-F2-02.
052200     MOVE "IX-28; 4.5.2 AND IX-6 1.3.5 INVALID KEY PATH TAKEN"
052300            TO RE-MARK.
052400     PERFORM FAIL.
052500     MOVE "INVALID KEY" TO COMPUTED-A.
052600     MOVE "QQQ040ALT08" TO CORRECT-A.
052700     GO TO READ-WRITE-F2-02.
052800 READ-FAIL-F2-02.
052900     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
053000     PERFORM FAIL.
053100     MOVE IX-FS1-KEY TO COMPUTED-A.
053200     MOVE "AAA040" TO CORRECT-A.
053300 READ-WRITE-F2-02.
053400     PERFORM PRINT-DETAIL.
053500 DELETE-TEST-GF-01.
053600     MOVE "DELETE...RECORD" TO FEATURE.
053700     MOVE "DELETE-TEST-GF-01" TO PAR-NAME.
053800     MOVE "DELETES RECORD FOUND IN READ-TEST-GF-02" TO RE-MARK.
053900     DELETE IX-FS1 RECORD INVALID KEY GO TO DELETE-INVALID-GF-01.
054000     PERFORM PASS.
054100     GO TO DELETE-WRITE-GF-01.
054200 DELETE-DELETE-GF-01.
054300     PERFORM DE-LETE.
054400     GO TO DELETE-WRITE-GF-01.
054500 DELETE-INVALID-GF-01.
054600     MOVE "IX-21; 4.3.2 AND IX-6 1.3.5 INVALID KEY PATH TAKEN"
054700            TO RE-MARK.
054800     PERFORM FAIL.
054900     MOVE "INVALID KEY" TO COMPUTED-A.
055000     MOVE "AAA040" TO CORRECT-A.
055100 DELETE-WRITE-GF-01.
055200     PERFORM PRINT-DETAIL.
055300 READ-TEST-F2-03.
055400     MOVE "READ...RECORD KEY" TO FEATURE.
055500     MOVE "READ-TEST-F2-03"  TO PAR-NAME.
055600     MOVE "RETRIEVED BY ALTERNATE KEY 4" TO RE-MARK.
055700     MOVE "III030ALT04" TO IX-FS1-ALT04.
055800     READ IX-FS1 RECORD
055900                        KEY IS IX-FS1-ALT04
056000       INVALID KEY  GO TO READ-INVALID-F2-03.
056100     IF IX-FS1-KEY = "AAA030"
056200        PERFORM PASS
056300        ELSE GO TO READ-FAIL-F2-03.
056400     GO TO READ-WRITE-F2-03.
056500 READ-DELETE-F2-03.
056600     PERFORM DE-LETE.
056700     GO TO READ-WRITE-F2-03.
056800 READ-INVALID-F2-03.
056900     MOVE "IX-28; 4.5.2 AND IX-6 1.3.5 INVALID KEY PATH TAKEN"
057000            TO RE-MARK.
057100     PERFORM FAIL.
057200     MOVE "INVALID KEY" TO COMPUTED-A.
057300     MOVE "III030ALT04" TO CORRECT-A.
057400     GO TO READ-WRITE-F2-03.
057500 READ-FAIL-F2-03.
057600     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
057700     PERFORM FAIL.
057800     MOVE IX-FS1-KEY TO COMPUTED-A.
057900     MOVE "AAA030" TO CORRECT-A.
058000 READ-WRITE-F2-03.
058100     PERFORM PRINT-DETAIL.
058200 REWRITE-TEST-GF-01.
058300     MOVE "REWRITE...INVALID..." TO FEATURE.
058400     MOVE "REWRITE-TEST-GF-01" TO PAR-NAME.
058500     MOVE "REWRITE-S RECORD FOUND IN READ-TEST-F2-03" TO RE-MARK.
058600     MOVE "IIIIIIALT04" TO IX-FS1-ALT04.
058700     REWRITE IX-FS1-RECORD INVALID KEY
058800              GO TO REWRITE-INVALID-GF-01.
058900     PERFORM PASS.
059000     GO TO REWRITE-WRITE-GF-01.
059100 REWRITE-DELETE-GF-01.
059200     PERFORM DE-LETE.
059300     GO TO REWRITE-WRITE-GF-01.
059400 REWRITE-INVALID-GF-01.
059500     MOVE "IX-33; 4.6.2 AND IX-6 1.3.5 INVALID KEY PATH TAKEN"
059600            TO RE-MARK.
059700     PERFORM FAIL.
059800     MOVE "INVALID KEY" TO COMPUTED-A.
059900     MOVE "IIIIIIALT04" TO CORRECT-A.
060000 REWRITE-WRITE-GF-01.
060100     PERFORM PRINT-DETAIL.
060200 READ-TEST-F2-04.
060300     MOVE "READ...RECORD KEY" TO FEATURE.
060400     MOVE "READ-TEST-F2-04"  TO PAR-NAME.
060500     MOVE "INVALID KEY PATH SHOULD BE TAKEN" TO RE-MARK.
060600     MOVE "ZZZ999ALT09" TO IX-FS1-ALT09.
060700     READ IX-FS1 RECORD
060800                        KEY IS IX-FS1-ALT09
060900       INVALID KEY  PERFORM PASS
061000        GO TO READ-WRITE-F2-04.
061100     GO TO READ-FAIL-F2-04.
061200 READ-DELETE-F2-04.
061300     PERFORM DE-LETE.
061400     GO TO READ-WRITE-F2-04.
061500 READ-FAIL-F2-04.
061600     MOVE "IX-28; 4.5.2 & IX-6 1.3.5 INVALID KEY SHOULD BE TAKEN"
061700            TO RE-MARK.
061800     PERFORM FAIL.
061900     MOVE IX-FS1-KEY TO COMPUTED-A.
062000     MOVE "INVALID KEY" TO CORRECT-A.
062100 READ-WRITE-F2-04.
062200     PERFORM PRINT-DETAIL.
062300 START-TEST-GF-01.
062400     MOVE "START...KEY IS EQUAL"    TO FEATURE.
062500     MOVE "START-TEST-GF-01" TO PAR-NAME.
062600     MOVE "RETRIEVED BY ALTERNATE KEY 3" TO RE-MARK.
062700     MOVE "GGG020ALT03" TO IX-FS1-ALT03.
062800     START IX-FS1
062900                  KEY IS EQUAL TO IX-FS1-ALT03
063000       INVALID KEY  GO TO START-INVALID-GF-01.
063100     READ IX-FS1 NEXT RECORD AT END GO TO START-END-GF-01.
063200     IF IX-FS1-KEY = "AAA020"
063300        PERFORM PASS
063400        ELSE GO TO START-FAIL-GF-01.
063500     GO TO START-WRITE-GF-01.
063600 START-DELETE-GF-01.
063700     PERFORM DE-LETE.
063800     GO TO START-WRITE-GF-01.
063900 START-INVALID-GF-01.
064000     MOVE "IX-36; 4.5.2 & IX-6 1.3.5 INVALID KEY PATH      TAKEN"
064100            TO RE-MARK.
064200     PERFORM FAIL.
064300     MOVE "INVALID KEY" TO COMPUTED-A.
064400     MOVE "GGG020ALT03" TO CORRECT-A.
064500     GO TO START-WRITE-GF-01.
064600 START-END-GF-01.
064700     MOVE "IX-28; 4.5.2 F1, READ AT END NOT EXPECTED" TO RE-MARK.
064800     PERFORM FAIL.
064900     MOVE "FILE IS AT END" TO COMPUTED-A.
065000     MOVE "AAA020" TO CORRECT-A.
065100     GO TO START-WRITE-GF-01.
065200 START-FAIL-GF-01.
065300     PERFORM FAIL.
065400     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
065500     MOVE IX-FS1-KEY TO COMPUTED-A.
065600     MOVE "AAA020" TO CORRECT-A.
065700 START-WRITE-GF-01.
065800     PERFORM PRINT-DETAIL.
065900 START-TEST-GF-02.
066000     MOVE "START...KEY >" TO FEATURE.
066100     MOVE "START-TEST-GF-02" TO PAR-NAME.
066200     MOVE "RETRIEVED BY ALTERNATE KEY 6" TO RE-MARK.
066300     MOVE "MMM090ALT06" TO IX-FS1-ALT06.
066400     START IX-FS1
066500                  KEY > IX-FS1-ALT06
066600       INVALID KEY  GO TO START-INVALID-GF-02.
066700     READ IX-FS1 NEXT RECORD AT END GO TO START-END-GF-02.
066800     IF IX-FS1-KEY = "AAA092"
066900        PERFORM PASS
067000        ELSE GO TO START-INVALID-GF-02.
067100     GO TO START-WRITE-GF-02.
067200 START-DELETE-GF-02.
067300     PERFORM DE-LETE.
067400     GO TO START-WRITE-GF-02.
067500 START-INVALID-GF-02.
067600     MOVE "IX-36; 4.5.2 & IX-6 1.3.5 INVALID KEY PATH      TAKEN"
067700            TO RE-MARK.
067800     PERFORM FAIL.
067900     MOVE "INVALID KEY" TO COMPUTED-A.
068000     MOVE "MMM090ALT09" TO CORRECT-A.
068100     GO TO START-WRITE-GF-02.
068200 START-END-GF-02.
068300     MOVE "IX-28; 4.5.2 F1, READ AT END NOT EXPECTED" TO RE-MARK.
068400     PERFORM FAIL.
068500     MOVE "FILE IS AT END" TO COMPUTED-A.
068600     MOVE "AAA092" TO CORRECT-A.
068700     GO TO START-WRITE-GF-02.
068800 START-FAIL-GF-02.
068900     MOVE "IX-28; 4.5.2 F1, WRONG KEY            " TO RE-MARK.
069000     PERFORM FAIL.
069100     MOVE IX-FS1-KEY TO COMPUTED-A.
069200     MOVE "AAA092" TO CORRECT-A.
069300 START-WRITE-GF-02.
069400     PERFORM PRINT-DETAIL.
069500 START-TEST-GF-03.
069600     MOVE "START...KEY >" TO FEATURE.
069700     MOVE "START-TEST-GF-03" TO PAR-NAME.
069800     MOVE "RETRIEVED BY ALTERNATE KEY 10" TO RE-MARK.
069900     MOVE "UUU080ALT10" TO IX-FS1-ALT10.
070000     START IX-FS1
070100                  KEY > IX-FS1-ALT10
070200       INVALID KEY  GO TO START-INVALID-GF-03.
070300     READ IX-FS1 NEXT RECORD AT END GO TO START-END-GF-03.
070400     IF IX-FS1-KEY = "AAA082"
070500        PERFORM PASS
070600        ELSE GO TO START-FAIL-GF-03.
070700     GO TO START-WRITE-GF-03.
070800 START-DELETE-GF-03.
070900     PERFORM DE-LETE.
071000     GO TO START-WRITE-GF-03.
071100 START-INVALID-GF-03.
071200     MOVE "IX-36; 4.5.2 & IX-6 1.3.5 INVALID KEY PATH      TAKEN"
071300            TO RE-MARK.
071400     PERFORM FAIL.
071500     MOVE "INVALID KEY" TO COMPUTED-A.
071600     MOVE "UUU080ALT10" TO CORRECT-A.
071700     GO TO START-WRITE-GF-03.
071800 START-END-GF-03.
071900     MOVE "IX-28; 4.5.2 F1, READ AT END NOT EXPECTED" TO RE-MARK.
072000     PERFORM FAIL.
072100     MOVE "FILE IS AT END" TO COMPUTED-A.
072200     MOVE "AAA082" TO CORRECT-A.
072300     GO TO START-WRITE-GF-03.
072400 START-FAIL-GF-03.
072500     MOVE "IX-28; 4.5.2 F1, WRONG KEY            " TO RE-MARK.
072600     PERFORM FAIL.
072700     MOVE IX-FS1-KEY TO COMPUTED-A.
072800     MOVE "AAA082" TO CORRECT-A.
072900 START-WRITE-GF-03.
073000     PERFORM PRINT-DETAIL.
073100 READ-TEST-F2-05.
073200     MOVE "READ...RECORD KEY" TO FEATURE.
073300     MOVE "READ-TEST-F2-05"  TO PAR-NAME.
073400     MOVE "RETRIEVED BY ALTERNATE KEY 8" TO RE-MARK.
073500     MOVE "QQQ040ALT08" TO IX-FS1-ALT08.
073600     READ IX-FS1 RECORD
073700                        KEY IS IX-FS1-ALT08
073800       INVALID KEY  GO TO READ-INVALID-F2-05.
073900     IF IX-FS1-KEY = "AAA041"
074000        PERFORM PASS
074100        ELSE GO TO READ-FAIL-F2-05.
074200     GO TO READ-WRITE-F2-05.
074300 READ-DELETE-F2-05.
074400     PERFORM DE-LETE.
074500     GO TO READ-WRITE-F2-05.
074600 READ-INVALID-F2-05.
074700     MOVE "IX-28; 4.5.2 & IX-6 1.3.5 INVALID KEY PATH      TAKEN"
074800            TO RE-MARK.
074900     PERFORM FAIL.
075000     MOVE "INVALID KEY" TO COMPUTED-A.
075100     MOVE "QQQ040ALT08" TO CORRECT-A.
075200     GO TO READ-WRITE-F2-05.
075300 READ-FAIL-F2-05.
075400     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
075500     PERFORM FAIL.
075600     MOVE IX-FS1-KEY TO COMPUTED-A.
075700     MOVE "AAA041" TO CORRECT-A.
075800 READ-WRITE-F2-05.
075900     PERFORM PRINT-DETAIL.
076000 READ-TEST-F2-06.
076100     MOVE "READ...RECORD KEY" TO FEATURE.
076200     MOVE "READ-TEST-F2-06" TO PAR-NAME.
076300     MOVE "RETRIEVED BY ALTERNATE KEY 4" TO RE-MARK.
076400     MOVE "IIIIIIALT04" TO IX-FS1-ALT04.
076500     READ IX-FS1 RECORD
076600                        KEY IS IX-FS1-ALT04
076700       INVALID KEY  GO TO READ-INVALID-F2-06.
076800     IF IX-FS1-KEY = "AAA030"
076900        PERFORM PASS
077000        ELSE GO TO READ-FAIL-F2-06.
077100     GO TO READ-WRITE-F2-06.
077200 READ-DELETE-F2-06.
077300     PERFORM DE-LETE.
077400     GO TO READ-WRITE-F2-06.
077500 READ-INVALID-F2-06.
077600     MOVE "IX-28; 4.5.2 & IX-6 1.3.5 INVALID KEY PATH      TAKEN"
077700            TO RE-MARK.
077800     PERFORM FAIL.
077900     MOVE "INVALID KEY" TO COMPUTED-A.
078000     MOVE "IIIIIIALT04" TO CORRECT-A.
078100     GO TO READ-WRITE-F2-06.
078200 READ-FAIL-F2-06.
078300     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
078400     PERFORM FAIL.
078500     MOVE IX-FS1-KEY TO COMPUTED-A.
078600     MOVE "AAA030" TO CORRECT-A.
078700 READ-WRITE-F2-06.
078800     PERFORM PRINT-DETAIL.
078900 READ-TEST-F2-07.
079000     MOVE "READ...RECORD KEY" TO FEATURE.
079100     MOVE "READ-TEST-F2-07"  TO PAR-NAME.
079200     MOVE "RETRIEVED BY PRIMARY KEY" TO RE-MARK.
079300     MOVE "AAA011" TO IX-FS1-KEY.
079400     READ IX-FS1 RECORD
079500                        KEY IS IX-FS1-KEY
079600       INVALID KEY  GO TO READ-INVALID-F2-07.
079700     IF IX-FS1-KEY = "AAA011"
079800        PERFORM PASS
079900        ELSE GO TO READ-FAIL-F2-07.
080000     GO TO READ-WRITE-F2-07.
080100 READ-DELETE-F2-07.
080200     PERFORM DE-LETE.
080300     GO TO READ-WRITE-F2-07.
080400 READ-INVALID-F2-07.
080500     MOVE "IX-28; 4.5.2 & IX-6 1.3.5 INVALID KEY PATH      TAKEN"
080600            TO RE-MARK.
080700     PERFORM FAIL.
080800     MOVE "INVALID KEY" TO COMPUTED-A.
080900     MOVE "AAA011" TO CORRECT-A.
081000     GO TO READ-WRITE-F2-07.
081100 READ-FAIL-F2-07.
081200     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
081300     PERFORM FAIL.
081400     MOVE IX-FS1-KEY TO COMPUTED-A.
081500     MOVE "AAA011" TO CORRECT-A.
081600 READ-WRITE-F2-07.
081700     PERFORM PRINT-DETAIL.
081800 DELETE-TEST-GF-02.
081900     MOVE "DELETE...RECORD" TO FEATURE.
082000     MOVE "DELETE-TEST-GF-02" TO PAR-NAME.
082100     MOVE "DELETES RECORD FOUND IN READ-TEST-F2-07" TO RE-MARK.
082200     DELETE IX-FS1 RECORD INVALID KEY GO TO DELETE-FAIL-GF-02.
082300     PERFORM PASS.
082400     GO TO DELETE-WRITE-GF-02.
082500 DELETE-DELETE-GF-02.
082600     PERFORM DE-LETE.
082700     GO TO DELETE-WRITE-GF-02.
082800 DELETE-FAIL-GF-02.
082900     MOVE "IX-21; 4.3.2 & IX-6 1.3.5 INVALID KEY PATH      TAKEN"
083000            TO RE-MARK.
083100     PERFORM FAIL.
083200     MOVE "INVALID KEY" TO COMPUTED-A.
083300     MOVE "AAA011" TO CORRECT-A.
083400 DELETE-WRITE-GF-02.
083500     PERFORM PRINT-DETAIL.
083600 READ-TEST-F2-08.
083700     MOVE "READ...RECORD KEY" TO FEATURE.
083800     MOVE "READ-TEST-F2-08"  TO PAR-NAME.
083900     MOVE "RETRIEVED BY ALTERNATE KEY 9" TO RE-MARK.
084000     MOVE "SSS060ALT09" TO IX-FS1-ALT09.
084100     READ IX-FS1 RECORD
084200                        KEY IS IX-FS1-ALT09
084300       INVALID KEY  GO TO READ-INVALID-F2-08.
084400     IF IX-FS1-KEY = "AAA060"
084500        PERFORM PASS
084600        ELSE GO TO READ-FAIL-F2-08.
084700     GO TO READ-WRITE-F2-08.
084800 READ-DELETE-F2-08.
084900     PERFORM DE-LETE.
085000     GO TO READ-WRITE-F2-08.
085100 READ-INVALID-F2-08.
085200     MOVE "IX-28; 4.5.2 & IX-6 1.3.5 INVALID KEY PATH      TAKEN"
085300            TO RE-MARK.
085400     PERFORM FAIL.
085500     MOVE "INVALID KEY" TO COMPUTED-A.
085600     MOVE "AAA060" TO CORRECT-A.
085700     GO TO READ-WRITE-F2-08.
085800 READ-FAIL-F2-08.
085900     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
086000     PERFORM FAIL.
086100     MOVE IX-FS1-KEY TO COMPUTED-A.
086200     MOVE "AAA060" TO CORRECT-A.
086300 READ-WRITE-F2-08.
086400     PERFORM PRINT-DETAIL.
086500 REWRITE-TEST-GF-02.
086600     MOVE "REWRITE...INVALID..." TO FEATURE.
086700     MOVE "REWRITE-TEST-GF-02" TO PAR-NAME.
086800     MOVE "REWRITES RECORD FOUND IN READ-TEST-GF-08" TO RE-MARK.
086900     MOVE "SSSSSSALT09" TO IX-FS1-ALT09.
087000     REWRITE IX-FS1-RECORD INVALID KEY GO TO REWRITE-FAIL-GF-02.
087100     PERFORM PASS.
087200     GO TO REWRITE-WRITE-GF-02.
087300 REWRITE-DELETE-GF-02.
087400     PERFORM DE-LETE.
087500     GO TO REWRITE-WRITE-GF-02.
087600 REWRITE-FAIL-GF-02.
087700     PERFORM FAIL.
087800     MOVE "INVALID KEY" TO COMPUTED-A.
087900     MOVE "SSSSSSALT09" TO CORRECT-A.
088000 REWRITE-WRITE-GF-02.
088100     PERFORM PRINT-DETAIL.
088200 READ-TEST-F2-09.
088300     MOVE "READ...RECORD KEY" TO FEATURE.
088400     MOVE "READ-TEST-F2-09"  TO PAR-NAME.
088500     MOVE "RETRIEVED BY ALTERNATE KEY 5" TO RE-MARK.
088600     MOVE "KKK010ALT05" TO IX-FS1-ALT05.
088700     READ IX-FS1 RECORD
088800                        KEY IS IX-FS1-ALT05
088900       INVALID KEY  GO TO READ-INVALID-F2-09.
089000     IF IX-FS1-KEY = "AAA010"
089100        PERFORM PASS
089200        ELSE GO TO READ-FAIL-F2-09.
089300     GO TO READ-WRITE-F2-09.
089400 READ-DELETE-F2-09.
089500     PERFORM DE-LETE.
089600     GO TO READ-WRITE-F2-09.
089700 READ-INVALID-F2-09.
089800     MOVE "IX-28; 4.5.2 & IX-6 1.3.5 INVALID KEY PATH      TAKEN"
089900            TO RE-MARK.
090000     PERFORM FAIL.
090100     MOVE "INVALID KEY" TO COMPUTED-A.
090200     MOVE "KKK010ALT05" TO CORRECT-A.
090300     GO TO READ-WRITE-F2-09.
090400 READ-FAIL-F2-09.
090500     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
090600     PERFORM FAIL.
090700     MOVE IX-FS1-KEY TO COMPUTED-A.
090800     MOVE "AAA010" TO CORRECT-A.
090900 READ-WRITE-F2-09.
091000     PERFORM PRINT-DETAIL.
091100 READ-TEST-F2-10.
091200     MOVE "READ...RECORD KEY" TO FEATURE.
091300     MOVE "READ-TEST-F2-10" TO PAR-NAME.
091400     MOVE "RETRIEVED BY ALTERNATE KEY 9" TO RE-MARK.
091500     MOVE "SSS060ALT09" TO IX-FS1-ALT09.
091600     READ IX-FS1 RECORD
091700                        KEY IS IX-FS1-ALT09
091800       INVALID KEY  GO TO READ-INVALID-F2-10.
091900     IF IX-FS1-KEY = "AAA061"
092000        PERFORM PASS
092100        ELSE GO TO READ-FAIL-F2-10.
092200     GO TO READ-WRITE-F2-10.
092300 READ-DELETE-F2-10.
092400     PERFORM DE-LETE.
092500     GO TO READ-WRITE-F2-10.
092600 READ-INVALID-F2-10.
092700     MOVE "IX-28; 4.5.2 & IX-6 1.3.5 INVALID KEY PATH      TAKEN"
092800            TO RE-MARK.
092900     PERFORM FAIL.
093000     MOVE "INVALID KEY" TO COMPUTED-A.
093100     MOVE "SSS060ALT09" TO CORRECT-A.
093200     GO TO READ-WRITE-F2-10.
093300 READ-FAIL-F2-10.
093400     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
093500     PERFORM FAIL.
093600     MOVE IX-FS1-KEY TO COMPUTED-A.
093700     MOVE "AAA061" TO CORRECT-A.
093800 READ-WRITE-F2-10.
093900     PERFORM PRINT-DETAIL.
094000 READ-TEST-F2-11.
094100     MOVE "READ...RECORD KEY" TO FEATURE.
094200     MOVE "READ-TEST-F2-11"   TO PAR-NAME.
094300     MOVE "RETRIEVED BY ALTERNATE KEY 7" TO RE-MARK.
094400     MOVE "OOO070ALT07"  TO IX-FS1-ALT07.
094500     READ IX-FS1 RECORD
094600                        KEY IS IX-FS1-ALT07
094700       INVALID KEY  GO TO READ-INVALID-F2-11.
094800     IF IX-FS1-KEY = "AAA070"
094900        PERFORM PASS
095000        ELSE GO TO READ-FAIL-F2-11.
095100     GO TO READ-WRITE-F2-11.
095200 READ-DELETE-F2-11.
095300     PERFORM DE-LETE.
095400     GO TO READ-WRITE-F2-11.
095500 READ-INVALID-F2-11.
095600     MOVE "IX-28; 4.5.2 & IX-6 1.3.5 INVALID KEY PATH      TAKEN"
095700            TO RE-MARK.
095800     PERFORM FAIL.
095900     MOVE "INVALID KEY" TO COMPUTED-A.
096000     MOVE "OOO070ALT07" TO CORRECT-A.
096100     GO TO READ-WRITE-F2-11.
096200 READ-FAIL-F2-11.
096300     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
096400     PERFORM FAIL.
096500     MOVE IX-FS1-KEY TO COMPUTED-A.
096600     MOVE "AAA070" TO CORRECT-A.
096700 READ-WRITE-F2-11.
096800     PERFORM PRINT-DETAIL.
096900 DELETE-TEST-GF-03.
097000     MOVE "DELETE...RECORD" TO FEATURE.
097100     MOVE "DELETE-TEST-GF-03" TO PAR-NAME.
097200     MOVE "DELETES RECORD FOUND IN READ-TEST-F2-11" TO RE-MARK.
097300     DELETE IX-FS1 RECORD INVALID KEY GO TO DELETE-FAIL-GF-03.
097400     PERFORM PASS.
097500     GO TO DELETE-WRITE-GF-03.
097600 DELETE-DELETE-GF-03.
097700     PERFORM DE-LETE.
097800     GO TO DELETE-WRITE-GF-03.
097900 DELETE-FAIL-GF-03.
098000     MOVE "IX-21; 4.3.2 & IX-6 1.3.5 INVALID KEY PATH      TAKEN"
098100            TO RE-MARK.
098200     PERFORM FAIL.
098300     MOVE "INVALID KEY" TO COMPUTED-A.
098400     MOVE "AAA070" TO CORRECT-A.
098500 DELETE-WRITE-GF-03.
098600     PERFORM PRINT-DETAIL.
098700 READ-TEST-F2-12.
098800     MOVE "READ...RECORD KEY" TO FEATURE.
098900     MOVE "READ-TEST-F2-12" TO PAR-NAME.
099000     MOVE "RETRIEVED BY ALTERNATE KEY 5" TO RE-MARK.
099100     MOVE "KKK070ALT05" TO IX-FS1-ALT05.
099200     READ IX-FS1 RECORD
099300                        KEY IS IX-FS1-ALT05
099400       INVALID KEY  GO TO READ-INVALID-F2-12.
099500     IF IX-FS1-KEY = "AAA071"
099600        PERFORM PASS
099700        ELSE GO TO READ-FAIL-F2-12.
099800     GO TO READ-WRITE-F2-12.
099900 READ-DELETE-F2-12.
100000     PERFORM DE-LETE.
100100     GO TO READ-WRITE-F2-12.
100200 READ-INVALID-F2-12.
100300     MOVE "IX-28; 4.5.2 & IX-6 1.3.5 INVALID KEY PATH      TAKEN"
100400            TO RE-MARK.
100500     PERFORM FAIL.
100600     MOVE "INVALID KEY" TO COMPUTED-A.
100700     MOVE "KKK070ALT05" TO CORRECT-A.
100800     GO TO READ-WRITE-F2-12.
100900 READ-FAIL-F2-12.
101000     MOVE "IX-28; 4.5.2 F2, WRONG KEY            " TO RE-MARK.
101100     PERFORM FAIL.
101200     MOVE IX-FS1-KEY TO COMPUTED-A.
101300     MOVE "AAA071" TO CORRECT-A.
101400 READ-WRITE-F2-12.
101500     PERFORM PRINT-DETAIL.
101600     CLOSE IX-FS1.
101700 CCVS-EXIT SECTION.
101800 CCVS-999999.
101900     GO TO CLOSE-FILES.
