000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     NC231A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*                                                              *
002200*    PROGRAM NC231A USES FORMAT 1 OF THE "SEARCH" STATEMENT TO *
002300*    ACCESS THREE AND SEVEN DIMENSIONAL TABLES.                *
002400*    THE OPTIONAL "VARYING" PHRASE IS USED WITH AN IDENTIFIER. *
002500*    THE SCOPE TERMINATOR "END-SEARCH" IS ALSO TESTED.         *
002600*                                                              *
002700****************************************************************
002800 ENVIRONMENT DIVISION.
002900 CONFIGURATION SECTION.
003000 SOURCE-COMPUTER.
003100     XXXXX082.
003200 OBJECT-COMPUTER.
003300     XXXXX083.
003400 INPUT-OUTPUT SECTION.
003500 FILE-CONTROL.
003600     SELECT PRINT-FILE ASSIGN TO
003700     XXXXX055.
003800 DATA DIVISION.
003900 FILE SECTION.
004000 FD  PRINT-FILE.
004100 01  PRINT-REC PICTURE X(120).
004200 01  DUMMY-RECORD PICTURE X(120).
004300 WORKING-STORAGE SECTION.
004400 77  SUB-1              PICTURE S99  VALUE ZERO.
004500 77  SUB-2              PICTURE 99   VALUE ZERO.
004600 77  SUB-3              PICTURE 99   VALUE ZERO.
004700 77  CON-7              PICTURE 99   VALUE 07.
004800 77  CON-10             PICTURE 99   VALUE 10.
004900 77  GRP-HOLD-AREA                PICTURE X(5) VALUE SPACES.
005000 77  CON-5              PICTURE 99  VALUE 05.
005100 77  SEC-HOLD-AREA                PICTURE X(11) VALUE SPACES.
005200 77  CON-6              PICTURE 99  VALUE 06.
005300 77  ELEM-HOLD-AREA               PICTURE X(15)  VALUE SPACES.
005400 77  L1-HOLD                     PIC XX.
005500 77  L2-HOLD                     PIC XX.
005600 77  L3-HOLD                     PIC XX.
005700 77  L4-HOLD                     PIC XX.
005800 77  L5-HOLD                     PIC XX.
005900 77  L6-HOLD                     PIC XX.
006000 77  L7-HOLD                     PIC XX.
006100 77  N1                         PIC 99.
006200 77  N2                         PIC 99.
006300 77  N3                         PIC 99.
006400 77  N4                         PIC 99.
006500 77  N5                         PIC 99.
006600 77  N6                         PIC 99.
006700 77  N7                         PIC 99.
006800 01  GRP-NAME.
006900     02  FILLER              PICTURE XXX    VALUE "GRP".
007000     02  ADD-GRP             PICTURE 99     VALUE 01.
007100
007200 01  SEC-NAME.
007300     02  FILLER              PICTURE X(5)   VALUE "SEC (".
007400     02  SEC-GRP             PICTURE 99     VALUE 00.
007500     02  FILLER              PICTURE X      VALUE ",".
007600     02  ADD-SEC             PICTURE 99     VALUE 01.
007700     02  FILLER              PICTURE X      VALUE ")".
007800
007900 01  ELEM-NAME.
008000     02  FILLER              PICTURE X(6)   VALUE "ELEM (".
008100     02  ELEM-GRP            PICTURE 99     VALUE 00.
008200     02  FILLER              PICTURE X      VALUE ",".
008300     02  ELEM-SEC            PICTURE 99     VALUE 00.
008400     02  FILLER              PICTURE X      VALUE ",".
008500     02  ADD-ELEM            PICTURE 99     VALUE 01.
008600     02  FILLER              PICTURE X      VALUE ")".
008700
008800
008900 01  3-DIMENSION-TBL.
009000     02  GRP-ENTRY OCCURS 10 TIMES INDEXED BY IDX-1.
009100         03  ENTRY-1         PICTURE X(5).
009200         03  GRP2-ENTRY OCCURS 10 TIMES INDEXED BY IDX-2.
009300             04  ENTRY-2     PICTURE X(11).
009400             04  GRP3-ENTRY OCCURS 10 TIMES INDEXED BY IDX-3.
009500                 05  ENTRY-3 PICTURE X(15).
009600
009700 01  7-DIMENSION-TBL.
009800   02  GRP-7-1-ENTRY             OCCURS 2 INDEXED BY IX-1.
009900     03  ENTRY-7-1               PIC XX.
010000     03  GRP-7-2-ENTRY           OCCURS 2 INDEXED BY IX-2.
010100       04  ENTRY-7-2             PIC XX.
010200       04  GRP-7-3-ENTRY         OCCURS 2 INDEXED BY IX-3.
010300         05  ENTRY-7-3           PIC XX.
010400         05  GRP-7-4-ENTRY       OCCURS 2 INDEXED BY IX-4.
010500           06  ENTRY-7-4         PIC XX.
010600           06  GRP-7-5-ENTRY     OCCURS 2 INDEXED BY IX-5.
010700             07  ENTRY-7-5       PIC XX.
010800             07  GRP-7-6-ENTRY   OCCURS 2 INDEXED BY IX-6.
010900               08  ENTRY-7-6     PIC XX.
011000               08  GRP-7-7-ENTRY OCCURS 2 INDEXED BY IX-7.
011100                 09  ENTRY-7-7   PIC XX.
011200
011300 01  END-STMT.
011400     02  FILLER                   PICTURE X(7) VALUE "AT END ".
011500     02  END-IDX                  PICTURE X(5) VALUE SPACES.
011600     02  FILLER                   PICTURE XXX  VALUE " = ".
011700     02  IDX-VALU                 PICTURE 99  VALUE 00.
011800     02  FILLER                   PICTURE XXX  VALUE SPACES.
011900
012000 01  NOTE-1.
012100     02  FILLER                   PICTURE X(74)  VALUE
012200     "NOTE 1 - CORRECT AND COMPUTED DATA ARE EQUAL BUT THE AT END
012300-     "PATH WAS TAKEN".
012400     02  FILLER                   PICTURE X(46)  VALUE SPACE.
012500
012600 01  NOTE-2.
012700     02  FILLER                   PICTURE X(112)  VALUE
012800     "NOTE 2 - CORRECT AND COMPUTED DATA ARE NOT EQUAL. THE COMPUT
012900-    "ED ENTRY WAS EXTRACTED FROM THE TABLE BY SUBSCRIPTS.".
013000     02  FILLER                   PICTURE X(8)  VALUE SPACE.
013100
013200 01  TEST-RESULTS.
013300     02 FILLER                   PIC X      VALUE SPACE.
013400     02 FEATURE                  PIC X(20)  VALUE SPACE.
013500     02 FILLER                   PIC X      VALUE SPACE.
013600     02 P-OR-F                   PIC X(5)   VALUE SPACE.
013700     02 FILLER                   PIC X      VALUE SPACE.
013800     02  PAR-NAME.
013900       03 FILLER                 PIC X(19)  VALUE SPACE.
014000       03  PARDOT-X              PIC X      VALUE SPACE.
014100       03 DOTVALUE               PIC 99     VALUE ZERO.
014200     02 FILLER                   PIC X(8)   VALUE SPACE.
014300     02 RE-MARK                  PIC X(61).
014400 01  TEST-COMPUTED.
014500     02 FILLER                   PIC X(30)  VALUE SPACE.
014600     02 FILLER                   PIC X(17)  VALUE
014700            "       COMPUTED=".
014800     02 COMPUTED-X.
014900     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
015000     03 COMPUTED-N               REDEFINES COMPUTED-A
015100                                 PIC -9(9).9(9).
015200     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
015300     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
015400     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
015500     03       CM-18V0 REDEFINES COMPUTED-A.
015600         04 COMPUTED-18V0                    PIC -9(18).
015700         04 FILLER                           PIC X.
015800     03 FILLER PIC X(50) VALUE SPACE.
015900 01  TEST-CORRECT.
016000     02 FILLER PIC X(30) VALUE SPACE.
016100     02 FILLER PIC X(17) VALUE "       CORRECT =".
016200     02 CORRECT-X.
016300     03 CORRECT-A                  PIC X(20) VALUE SPACE.
016400     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
016500     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
016600     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
016700     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
016800     03      CR-18V0 REDEFINES CORRECT-A.
016900         04 CORRECT-18V0                     PIC -9(18).
017000         04 FILLER                           PIC X.
017100     03 FILLER PIC X(2) VALUE SPACE.
017200     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
017300 01  CCVS-C-1.
017400     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
017500-    "SS  PARAGRAPH-NAME
017600-    "       REMARKS".
017700     02 FILLER                     PIC X(20)    VALUE SPACE.
017800 01  CCVS-C-2.
017900     02 FILLER                     PIC X        VALUE SPACE.
018000     02 FILLER                     PIC X(6)     VALUE "TESTED".
018100     02 FILLER                     PIC X(15)    VALUE SPACE.
018200     02 FILLER                     PIC X(4)     VALUE "FAIL".
018300     02 FILLER                     PIC X(94)    VALUE SPACE.
018400 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
018500 01  REC-CT                        PIC 99       VALUE ZERO.
018600 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
018700 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
018800 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
018900 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
019000 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
019100 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
019200 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
019300 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
019400 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
019500 01  CCVS-H-1.
019600     02  FILLER                    PIC X(39)    VALUE SPACES.
019700     02  FILLER                    PIC X(42)    VALUE
019800     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
019900     02  FILLER                    PIC X(39)    VALUE SPACES.
020000 01  CCVS-H-2A.
020100   02  FILLER                        PIC X(40)  VALUE SPACE.
020200   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
020300   02  FILLER                        PIC XXXX   VALUE
020400     "4.2 ".
020500   02  FILLER                        PIC X(28)  VALUE
020600            " COPY - NOT FOR DISTRIBUTION".
020700   02  FILLER                        PIC X(41)  VALUE SPACE.
020800
020900 01  CCVS-H-2B.
021000   02  FILLER                        PIC X(15)  VALUE
021100            "TEST RESULT OF ".
021200   02  TEST-ID                       PIC X(9).
021300   02  FILLER                        PIC X(4)   VALUE
021400            " IN ".
021500   02  FILLER                        PIC X(12)  VALUE
021600     " HIGH       ".
021700   02  FILLER                        PIC X(22)  VALUE
021800            " LEVEL VALIDATION FOR ".
021900   02  FILLER                        PIC X(58)  VALUE
022000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
022100 01  CCVS-H-3.
022200     02  FILLER                      PIC X(34)  VALUE
022300            " FOR OFFICIAL USE ONLY    ".
022400     02  FILLER                      PIC X(58)  VALUE
022500     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022600     02  FILLER                      PIC X(28)  VALUE
022700            "  COPYRIGHT   1985 ".
022800 01  CCVS-E-1.
022900     02 FILLER                       PIC X(52)  VALUE SPACE.
023000     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
023100     02 ID-AGAIN                     PIC X(9).
023200     02 FILLER                       PIC X(45)  VALUE SPACES.
023300 01  CCVS-E-2.
023400     02  FILLER                      PIC X(31)  VALUE SPACE.
023500     02  FILLER                      PIC X(21)  VALUE SPACE.
023600     02 CCVS-E-2-2.
023700         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
023800         03 FILLER                   PIC X      VALUE SPACE.
023900         03 ENDER-DESC               PIC X(44)  VALUE
024000            "ERRORS ENCOUNTERED".
024100 01  CCVS-E-3.
024200     02  FILLER                      PIC X(22)  VALUE
024300            " FOR OFFICIAL USE ONLY".
024400     02  FILLER                      PIC X(12)  VALUE SPACE.
024500     02  FILLER                      PIC X(58)  VALUE
024600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024700     02  FILLER                      PIC X(13)  VALUE SPACE.
024800     02 FILLER                       PIC X(15)  VALUE
024900             " COPYRIGHT 1985".
025000 01  CCVS-E-4.
025100     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
025200     02 FILLER                       PIC X(4)   VALUE " OF ".
025300     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
025400     02 FILLER                       PIC X(40)  VALUE
025500      "  TESTS WERE EXECUTED SUCCESSFULLY".
025600 01  XXINFO.
025700     02 FILLER                       PIC X(19)  VALUE
025800            "*** INFORMATION ***".
025900     02 INFO-TEXT.
026000       04 FILLER                     PIC X(8)   VALUE SPACE.
026100       04 XXCOMPUTED                 PIC X(20).
026200       04 FILLER                     PIC X(5)   VALUE SPACE.
026300       04 XXCORRECT                  PIC X(20).
026400     02 INF-ANSI-REFERENCE           PIC X(48).
026500 01  HYPHEN-LINE.
026600     02 FILLER  PIC IS X VALUE IS SPACE.
026700     02 FILLER  PIC IS X(65)    VALUE IS "************************
026800-    "*****************************************".
026900     02 FILLER  PIC IS X(54)    VALUE IS "************************
027000-    "******************************".
027100 01  CCVS-PGM-ID                     PIC X(9)   VALUE
027200     "NC231A".
027300 PROCEDURE DIVISION.
027400 CCVS1 SECTION.
027500 OPEN-FILES.
027600     OPEN     OUTPUT PRINT-FILE.
027700     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
027800     MOVE    SPACE TO TEST-RESULTS.
027900     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
028000     GO TO CCVS1-EXIT.
028100 CLOSE-FILES.
028200     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
028300 TERMINATE-CCVS.
028400S    EXIT PROGRAM.
028500STERMINATE-CALL.
028600     STOP     RUN.
028700 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
028800 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
028900 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
029000 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
029100     MOVE "****TEST DELETED****" TO RE-MARK.
029200 PRINT-DETAIL.
029300     IF REC-CT NOT EQUAL TO ZERO
029400             MOVE "." TO PARDOT-X
029500             MOVE REC-CT TO DOTVALUE.
029600     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
029700     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
029800        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
029900          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
030000     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
030100     MOVE SPACE TO CORRECT-X.
030200     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
030300     MOVE     SPACE TO RE-MARK.
030400 HEAD-ROUTINE.
030500     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030600     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030700     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030800     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030900 COLUMN-NAMES-ROUTINE.
031000     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031100     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
031300 END-ROUTINE.
031400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
031500 END-RTN-EXIT.
031600     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031700 END-ROUTINE-1.
031800      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
031900      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
032000      ADD PASS-COUNTER TO ERROR-HOLD.
032100*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
032200      MOVE PASS-COUNTER TO CCVS-E-4-1.
032300      MOVE ERROR-HOLD TO CCVS-E-4-2.
032400      MOVE CCVS-E-4 TO CCVS-E-2-2.
032500      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
032600  END-ROUTINE-12.
032700      MOVE "TEST(S) FAILED" TO ENDER-DESC.
032800     IF       ERROR-COUNTER IS EQUAL TO ZERO
032900         MOVE "NO " TO ERROR-TOTAL
033000         ELSE
033100         MOVE ERROR-COUNTER TO ERROR-TOTAL.
033200     MOVE     CCVS-E-2 TO DUMMY-RECORD.
033300     PERFORM WRITE-LINE.
033400 END-ROUTINE-13.
033500     IF DELETE-COUNTER IS EQUAL TO ZERO
033600         MOVE "NO " TO ERROR-TOTAL  ELSE
033700         MOVE DELETE-COUNTER TO ERROR-TOTAL.
033800     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
033900     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034000      IF   INSPECT-COUNTER EQUAL TO ZERO
034100          MOVE "NO " TO ERROR-TOTAL
034200      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
034300      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
034400      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034500     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034600 WRITE-LINE.
034700     ADD 1 TO RECORD-COUNT.
034800Y    IF RECORD-COUNT GREATER 50
034900Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
035000Y        MOVE SPACE TO DUMMY-RECORD
035100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
035200Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
035300Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
035400Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
035500Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
035600Y        MOVE ZERO TO RECORD-COUNT.
035700     PERFORM WRT-LN.
035800 WRT-LN.
035900     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
036000     MOVE SPACE TO DUMMY-RECORD.
036100 BLANK-LINE-PRINT.
036200     PERFORM WRT-LN.
036300 FAIL-ROUTINE.
036400     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
036500     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
036600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
036700     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
036800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036900     MOVE   SPACES TO INF-ANSI-REFERENCE.
037000     GO TO  FAIL-ROUTINE-EX.
037100 FAIL-ROUTINE-WRITE.
037200     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
037300     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
037400     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
037500     MOVE   SPACES TO COR-ANSI-REFERENCE.
037600 FAIL-ROUTINE-EX. EXIT.
037700 BAIL-OUT.
037800     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
037900     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
038000 BAIL-OUT-WRITE.
038100     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
038200     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
038300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038400     MOVE   SPACES TO INF-ANSI-REFERENCE.
038500 BAIL-OUT-EX. EXIT.
038600 CCVS1-EXIT.
038700     EXIT.
038800 SECT-NC231A-001 SECTION.
038900 TH-01-001.
039000     MOVE   "VI-2 1.3.4" TO ANSI-REFERENCE.
039100     PERFORM PARA-1 VARYING SUB-1 FROM 1 BY 1
039200         UNTIL SUB-1 EQUAL TO 11
039300         AFTER SUB-2 FROM 1 BY 1 UNTIL SUB-2 EQUAL TO 11
039400         AFTER SUB-3 FROM 1 BY 1 UNTIL SUB-3 EQUAL TO 11
039500     GO TO CHECK-ENTRIES.
039600
039700 PARA-1.
039800     SET IDX-1 TO SUB-1.
039900     SET IDX-2 TO SUB-2.
040000     SET IDX-3 TO SUB-3.
040100     SET ADD-GRP, SEC-GRP, ELEM-GRP TO IDX-1.
040200     MOVE GRP-NAME TO ENTRY-1 (IDX-1).
040300     SET ADD-SEC, ELEM-SEC TO IDX-2.
040400     MOVE SEC-NAME TO ENTRY-2 (IDX-1, IDX-2).
040500     SET ADD-ELEM TO IDX-3.
040600     MOVE ELEM-NAME TO ENTRY-3 (IDX-1, IDX-2, IDX-3).
040700
040800 CHECK-ENTRIES.
040900     MOVE "SEARCH VARYING LEV 1" TO FEATURE.
041000     MOVE "CHECK-ENTRIES       " TO PAR-NAME.
041100     MOVE "GRP02" TO GRP-HOLD-AREA.
041200     MOVE 02 TO SUB-2.
041300     MOVE 01 TO CON-5.
041400     SET IDX-1 TO 01.
041500     SEARCH GRP-ENTRY VARYING CON-5 AT END
041600         PERFORM GRP-FAIL-PARGRAPH
041700         GO TO LEVEL-1-TEST-2
041800         WHEN ENTRY-1 (IDX-1) = GRP-HOLD-AREA NEXT SENTENCE.
041900
042000     PERFORM PASS-TH.
042100     GO TO LEVEL-1-TEST-2.
042200
042300 GRP-FAIL-PARGRAPH.
042400     MOVE GRP-HOLD-AREA TO CORRECT-A.
042500     IF ENTRY-1 (SUB-2) NOT EQUAL TO GRP-HOLD-AREA
042600         MOVE ENTRY-1 (SUB-2) TO COMPUTED-A
042700         MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK  ELSE
042800     MOVE "IDX-1" TO END-IDX
042900     SET IDX-VALU TO IDX-1
043000     MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
043100     MOVE END-STMT TO COMPUTED-A.
043200
043300     PERFORM FAIL-TH.
043400 LEVEL-1-TEST-2.
043500     MOVE "LEVEL-1-TEST-2      " TO PAR-NAME.
043600     MOVE "GRP01" TO GRP-HOLD-AREA.
043700     MOVE 01 TO SUB-2.
043800     MOVE 01 TO CON-5.
043900     SET IDX-1 TO 01.
044000     SEARCH GRP-ENTRY VARYING CON-5 AT END
044100         PERFORM GRP-FAIL-PARGRAPH
044200         GO TO LEVEL-1-TEST-3
044300         WHEN ENTRY-1 (IDX-1) = GRP-HOLD-AREA NEXT SENTENCE.
044400
044500     PERFORM PASS-TH.
044600 LEVEL-1-TEST-3.
044700     MOVE "LEVEL-1-TEST-3      " TO PAR-NAME.
044800     MOVE "GRP10" TO GRP-HOLD-AREA.
044900     MOVE 10 TO SUB-2.
045000     MOVE 01 TO CON-5.
045100     SET IDX-1 TO 01.
045200     SEARCH GRP-ENTRY VARYING CON-5 AT END
045300         PERFORM GRP-FAIL-PARGRAPH
045400         GO TO LEVEL-1-TEST-4
045500         WHEN ENTRY-1 (IDX-1) = GRP-HOLD-AREA NEXT SENTENCE.
045600
045700     PERFORM PASS-TH.
045800 LEVEL-1-TEST-4.
045900     MOVE "LEVEL-1-TEST-4      " TO PAR-NAME.
046000     MOVE "GRP05" TO GRP-HOLD-AREA.
046100     MOVE 05 TO SUB-2.
046200     MOVE 05 TO CON-5.
046300     SET IDX-1 TO 05.
046400     SEARCH GRP-ENTRY VARYING CON-5 WHEN ENTRY-1 (CON-5)
046500         EQUAL TO GRP-HOLD-AREA GO TO PASS-TH-TEST-4.
046600     PERFORM GRP-FAIL-PARGRAPH.
046700     GO TO LEVEL-2-TEST-1.
046800 PASS-TH-TEST-4.
046900
047000     PERFORM PASS-TH.
047100
047200 LEVEL-2-TEST-1.
047300     MOVE "SEARCH VARYING LEV 2" TO FEATURE.
047400     MOVE "LEVEL-2-TEST-1      " TO PAR-NAME.
047500     MOVE "SEC (01,01)" TO SEC-HOLD-AREA.
047600     MOVE  1 TO SUB-1  SUB-2.
047700     SET IDX-1 IDX-2 TO 01.
047800     MOVE 01 TO CON-6.
047900     SEARCH GRP2-ENTRY VARYING CON-6 AT END
048000         PERFORM SEC-FAIL-PARGRAF
048100         GO TO LEVEL-2-TEST-2
048200         WHEN ENTRY-2 (IDX-1, IDX-2) = SEC-HOLD-AREA
048300             NEXT SENTENCE.
048400
048500     PERFORM PASS-TH.
048600
048700 LEVEL-2-TEST-2.
048800     MOVE "LEVEL-2-TEST-2      " TO PAR-NAME.
048900     MOVE "SEC (05,10)" TO SEC-HOLD-AREA.
049000     MOVE 05 TO SUB-1.
049100     MOVE 10 TO SUB-2.
049200     SET IDX-1 TO 5.
049300     MOVE 01 TO CON-6.
049400     SET IDX-2 TO 01.
049500     SEARCH GRP2-ENTRY VARYING CON-6 AT END
049600         PERFORM SEC-FAIL-PARGRAF
049700         GO TO LEVEL-2-TEST-3
049800         WHEN ENTRY-2 (IDX-1, IDX-2) = SEC-HOLD-AREA
049900             NEXT SENTENCE.
050000
050100     PERFORM PASS-TH.
050200
050300 LEVEL-2-TEST-3.
050400     MOVE "LEVEL-2-TEST-3      " TO PAR-NAME.
050500     MOVE "SEC (10,10)" TO SEC-HOLD-AREA.
050600     SET IDX-1 TO 10.
050700     MOVE 01 TO CON-6.
050800     SET IDX-2 TO 01.
050900     MOVE 10 TO SUB-1  SUB-2.
051000     SEARCH GRP2-ENTRY VARYING CON-6 AT END
051100         PERFORM SEC-FAIL-PARGRAF
051200         GO TO LEVEL-2-TEST-4
051300         WHEN ENTRY-2 (IDX-1, IDX-2) = SEC-HOLD-AREA
051400             NEXT SENTENCE.
051500
051600     PERFORM PASS-TH.
051700 LEVEL-2-TEST-4.
051800     MOVE "LEVEL-2-TEST-4      " TO PAR-NAME.
051900     MOVE "SEC (08,02)" TO SEC-HOLD-AREA.
052000     MOVE 08 TO SUB-1.
052100     MOVE 02 TO SUB-2.
052200     SET IDX-1 TO 08.
052300     MOVE 01 TO CON-6.
052400     SET IDX-2 TO 01.
052500     SEARCH GRP2-ENTRY VARYING CON-6
052600         WHEN ENTRY-2 (IDX-1, IDX-2) = SEC-HOLD-AREA
052700             GO TO PASS-TH-2-4.
052800     PERFORM SEC-FAIL-PARGRAF.
052900     GO TO LEVEL-3-TEST-1.
053000 PASS-TH-2-4.
053100
053200     PERFORM PASS-TH.
053300     GO TO LEVEL-3-TEST-1.
053400
053500 SEC-FAIL-PARGRAF.
053600     MOVE SEC-HOLD-AREA TO CORRECT-A.
053700     IF ENTRY-2 (SUB-1, SUB-2) = SEC-HOLD-AREA
053800         MOVE "IDX-2" TO END-IDX
053900         SET IDX-VALU TO IDX-2
054000         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
054100         MOVE END-STMT TO COMPUTED-A  ELSE
054200     MOVE ENTRY-2 (SUB-1, SUB-2) TO COMPUTED-A
054300     MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
054400
054500     PERFORM FAIL-TH.
054600
054700 LEVEL-3-TEST-1.
054800     MOVE "LEVEL-3-TEST-1      " TO PAR-NAME.
054900     MOVE "SEARCH VARYING LEV 3" TO FEATURE.
055000     MOVE 1 TO SUB-1  SUB-2  SUB-3.
055100     MOVE "ELEM (01,01,01)" TO ELEM-HOLD-AREA.
055200     SET IDX-1 IDX-2 IDX-3 TO 01.
055300     MOVE 01 TO CON-7.
055400     SEARCH GRP3-ENTRY VARYING CON-7
055500         WHEN ENTRY-3 (IDX-1, IDX-2, IDX-3) = ELEM-HOLD-AREA
055600             GO TO PASS-TH-3-1.
055700     PERFORM ELEM-FAIL-PARA.
055800     GO TO LEVEL-3-TEST-2.
055900 PASS-TH-3-1.
056000
056100     PERFORM PASS-TH.
056200
056300 LEVEL-3-TEST-2.
056400     MOVE "LEVEL-3-TEST-2      " TO PAR-NAME.
056500     MOVE 05 TO SUB-1.
056600     MOVE 06 TO SUB-2.
056700     MOVE 07 TO SUB-3.
056800     SET IDX-1 TO 05.
056900     SET IDX-2 TO 06.
057000     MOVE 01 TO CON-7.
057100     SET IDX-3 TO 01.
057200     MOVE "ELEM (05,06,07)" TO ELEM-HOLD-AREA.
057300     SEARCH GRP3-ENTRY VARYING CON-7 AT END
057400         PERFORM ELEM-FAIL-PARA
057500         GO TO LEVEL-3-TEST-3
057600         WHEN ENTRY-3 (IDX-1, IDX-2, IDX-3) = ELEM-HOLD-AREA
057700             NEXT SENTENCE.
057800
057900     PERFORM PASS-TH.
058000
058100 LEVEL-3-TEST-3.
058200     MOVE "LEVEL-3-TEST-3      " TO PAR-NAME.
058300     MOVE 10 TO SUB-1 SUB-2 SUB-3.
058400     SET IDX-1  IDX-2 TO 10.
058500     SET IDX-3 TO 01.
058600     MOVE 01 TO CON-7.
058700     MOVE "ELEM (10,10,10)" TO ELEM-HOLD-AREA.
058800     SEARCH GRP3-ENTRY VARYING CON-7 AT END
058900         PERFORM ELEM-FAIL-PARA
059000         GO TO LEVEL-3-TEST-4
059100         WHEN ENTRY-3 (IDX-1, IDX-2, IDX-3) = ELEM-HOLD-AREA
059200             NEXT SENTENCE.
059300
059400     PERFORM PASS-TH.
059500 LEVEL-3-TEST-4.
059600     MOVE "LEVEL-3-TEST-4      " TO PAR-NAME.
059700     MOVE "ELEM (07,06,05)" TO ELEM-HOLD-AREA.
059800     MOVE 07 TO SUB-1.
059900     MOVE 06 TO SUB-2.
060000     MOVE 05 TO SUB-3.
060100     SET IDX-1 TO 07.
060200     SET IDX-2 TO 06.
060300     SET IDX-3 TO 03.
060400     MOVE 03 TO CON-7.
060500     SEARCH GRP3-ENTRY VARYING CON-7 AT END
060600         PERFORM ELEM-FAIL-PARA
060700         GO TO MULT-SEARCH-TEST-1
060800         WHEN ENTRY-3 (IDX-1, IDX-2, IDX-3) = ELEM-HOLD-AREA
060900         NEXT SENTENCE.
061000
061100     PERFORM PASS-TH.
061200     GO TO MULT-SEARCH-TEST-1.
061300 ELEM-FAIL-PARA.
061400     MOVE ELEM-HOLD-AREA TO CORRECT-A.
061500     IF ENTRY-3 (SUB-1, SUB-2, SUB-3) = ELEM-HOLD-AREA
061600         MOVE "IDX-3" TO END-IDX
061700         SET IDX-VALU TO IDX-3
061800         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
061900         MOVE END-STMT TO COMPUTED-A  ELSE
062000     MOVE ENTRY-3 (SUB-1, SUB-2, SUB-3) TO COMPUTED-A
062100     MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
062200
062300     PERFORM FAIL-TH.
062400
062500 MULT-SEARCH-TEST-1.
062600     MOVE "MULT-SEARCH-TEST-1  " TO PAR-NAME.
062700     MOVE "MULTIPLE SEARCH STMT" TO FEATURE.
062800     MOVE "GRP08" TO GRP-HOLD-AREA.
062900     MOVE "SEC (08,07)" TO SEC-HOLD-AREA.
063000     MOVE 01 TO CON-5 CON-6.
063100     SET IDX-1 IDX-2 TO 01.
063200     SEARCH GRP-ENTRY VARYING CON-5 AT END GO TO MULT-SEARCH-FAIL1
063300         WHEN ENTRY-1 (CON-5) = "GRP08" NEXT SENTENCE.
063400     SEARCH GRP2-ENTRY VARYING CON-6 AT END GO TO MULT-SEARCH-FAIL
063500         WHEN ENTRY-2 (CON-5, CON-6) = SEC-HOLD-AREA
063600             NEXT SENTENCE.
063700
063800     PERFORM PASS-TH.
063900     GO TO MULT-SEARCH-TEST-2.
064000 MULT-SEARCH-FAIL1.
064100     MOVE GRP-HOLD-AREA TO CORRECT-A.
064200     IF ENTRY-1 (08) = GRP-HOLD-AREA
064300         MOVE "IDX-1" TO END-IDX
064400         SET IDX-VALU TO IDX-1
064500         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
064600         MOVE END-STMT TO COMPUTED-A  ELSE
064700     MOVE ENTRY-1 (08) TO COMPUTED-A
064800     MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
064900
065000     PERFORM FAIL-TH.
065100     GO TO MULT-SEARCH-TEST-2.
065200 MULT-SEARCH-FAIL.
065300     MOVE SEC-HOLD-AREA TO CORRECT-A.
065400     IF ENTRY-2 (08, 07) = SEC-HOLD-AREA
065500         MOVE "IDX-2" TO END-IDX
065600         SET IDX-VALU TO IDX-2
065700         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
065800         MOVE END-STMT TO COMPUTED-A  ELSE
065900     MOVE ENTRY-2 (08, 07) TO COMPUTED-A
066000     MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
066100
066200     PERFORM FAIL-TH.
066300
066400 MULT-SEARCH-TEST-2.
066500     MOVE "MULT-SEARCH-TEST-2  " TO PAR-NAME.
066600     MOVE "GRP04" TO GRP-HOLD-AREA.
066700     MOVE "SEC (04,04)" TO SEC-HOLD-AREA.
066800     MOVE "ELEM (04,04,04)" TO ELEM-HOLD-AREA.
066900     MOVE 01 TO CON-5 CON-6 CON-7.
067000     SET IDX-1  IDX-2  IDX-3 TO 01.
067100     SEARCH GRP-ENTRY VARYING CON-5 AT END
067200         GO TO MULT-SEARCH-2-FAIL WHEN ENTRY-1 (CON-5) =
067300         GRP-HOLD-AREA  NEXT SENTENCE.
067400     SEARCH GRP2-ENTRY VARYING CON-6 AT END
067500         GO TO MULT-SEARCH-3-FAIL WHEN ENTRY-2 (CON-5, CON-6) =
067600         SEC-HOLD-AREA  NEXT SENTENCE.
067700     SEARCH GRP3-ENTRY VARYING CON-7 AT END
067800         GO TO MULT-SEARCH-4-FAIL WHEN ENTRY-3
067900             (CON-5, CON-6, CON-7) = ELEM-HOLD-AREA NEXT SENTENCE.
068000
068100     PERFORM PASS-TH.
068200     GO TO   MULT-SEARCH-7-INIT-3.
068300
068400 MULT-SEARCH-2-FAIL.
068500     MOVE GRP-HOLD-AREA TO CORRECT-A.
068600     IF ENTRY-1 (04) = GRP-HOLD-AREA
068700         MOVE "IDX-1" TO END-IDX
068800         SET IDX-VALU TO IDX-1
068900         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
069000         MOVE END-STMT TO COMPUTED-A  ELSE
069100     MOVE ENTRY-1 (04) TO COMPUTED-A
069200     MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
069300
069400     PERFORM FAIL-TH.
069500     GO TO   MULT-SEARCH-7-INIT-3.
069600
069700 MULT-SEARCH-3-FAIL.
069800     MOVE  SEC-HOLD-AREA TO CORRECT-A.
069900     IF ENTRY-2 (04, 04) = SEC-HOLD-AREA
070000         MOVE "IDX-2" TO END-IDX
070100         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
070200         SET IDX-VALU TO IDX-2
070300         MOVE END-STMT TO COMPUTED-A  ELSE
070400     MOVE ENTRY-2 (04, 04) TO COMPUTED-A
070500     MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
070600
070700     PERFORM FAIL-TH.
070800     GO TO   MULT-SEARCH-7-INIT-3.
070900
071000 MULT-SEARCH-4-FAIL.
071100     MOVE ELEM-HOLD-AREA TO CORRECT-A.
071200     IF ENTRY-3 (04, 04, 04) = ELEM-HOLD-AREA
071300         MOVE "IDX-3" TO END-IDX
071400         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
071500         SET IDX-VALU TO IDX-3
071600         MOVE END-STMT TO COMPUTED-A  ELSE
071700     MOVE ENTRY-3 (04, 04, 04) TO COMPUTED-A
071800     MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
071900
072000     PERFORM FAIL-TH.
072100
072200 MULT-SEARCH-7-INIT-3.
072300     MOVE   "MULT-SEARCH-7-TEST-3" TO PAR-NAME.
072400     MOVE   "VI-122 6.21"          TO ANSI-REFERENCE.
072500     MOVE    ALL "ABCDEFGHIJKLMNOPQRSTUVWXYZ" TO 7-DIMENSION-TBL.
072600     MOVE   "UV" TO L1-HOLD.
072700     MOVE   "WX" TO L2-HOLD.
072800     MOVE   "IJ" TO L3-HOLD.
072900     MOVE   "KL" TO L4-HOLD.
073000     MOVE   "AB" TO L5-HOLD.
073100     MOVE   "CD" TO L6-HOLD.
073200     MOVE   "GH" TO L7-HOLD.
073300     SET     IX-1 IX-2 IX-3 IX-4 IX-5 IX-6 IX-7 TO 1.
073400     MOVE    1 TO N1 N2 N3 N4 N5 N6 N7.
073500     GO TO   MULT-SEARCH-7-TEST-3.
073600 MULT-SEARCH-7-DELETE-3.
073700     PERFORM DE-LETE.
073800     PERFORM PRINT-DETAIL.
073900     GO TO   SPECIAL-TEST-1.
074000 MULT-SEARCH-7-TEST-3.
074100     SEARCH  GRP-7-1-ENTRY VARYING N1
074200             AT END  GO TO MULT-SEARCH-7-FAIL-1
074300             WHEN    ENTRY-7-1 (N1) =  L1-HOLD
074400                     NEXT SENTENCE.
074500     SEARCH  GRP-7-2-ENTRY VARYING N2
074600             AT END  GO TO MULT-SEARCH-7-FAIL-2
074700             WHEN    ENTRY-7-2 (N1 N2) = L2-HOLD
074800                     NEXT SENTENCE.
074900     SEARCH  GRP-7-3-ENTRY VARYING N3
075000             AT END  GO TO MULT-SEARCH-7-FAIL-3
075100             WHEN    ENTRY-7-3 (N1 N2 N3) = L3-HOLD
075200                     NEXT SENTENCE.
075300     SEARCH  GRP-7-4-ENTRY VARYING N4
075400             AT END  GO TO MULT-SEARCH-7-FAIL-4
075500             WHEN    ENTRY-7-4 (N1 N2 N3 N4) =  L4-HOLD
075600                     NEXT SENTENCE.
075700     SEARCH  GRP-7-5-ENTRY VARYING N5
075800             AT END  GO TO MULT-SEARCH-7-FAIL-5
075900             WHEN    ENTRY-7-5 (N1 N2 N3 N4 N5) = L5-HOLD
076000                     NEXT SENTENCE.
076100     SEARCH  GRP-7-6-ENTRY VARYING N6
076200             AT END  GO TO MULT-SEARCH-7-FAIL-6
076300             WHEN    ENTRY-7-6 (N1 N2 N3 N4 N5 N6) = L6-HOLD
076400                     NEXT SENTENCE.
076500     SEARCH  GRP-7-7-ENTRY VARYING N7
076600             AT END  GO TO MULT-SEARCH-7-FAIL-7
076700             WHEN    ENTRY-7-7 (N1 N2 N3 N4 N5 N6 N7) = L7-HOLD
076800                     NEXT SENTENCE.
076900
077000     PERFORM PASS-TH.
077100     GO TO   SPECIAL-TEST-1.
077200
077300 MULT-SEARCH-7-FAIL-1.
077400     MOVE    L1-HOLD TO CORRECT-A.
077500     IF      ENTRY-7-1 (2) = L1-HOLD
077600             MOVE   "IX-1" TO END-IDX
077700             SET     IDX-VALU TO IX-1
077800             MOVE   "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
077900             MOVE    END-STMT TO COMPUTED-A
078000     ELSE
078100             MOVE    ENTRY-7-1 (2) TO COMPUTED-A
078200             MOVE   "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
078300
078400     PERFORM FAIL-TH.
078500     GO TO   SPECIAL-TEST-1.
078600
078700 MULT-SEARCH-7-FAIL-2.
078800     MOVE    L2-HOLD TO CORRECT-A.
078900     IF      ENTRY-7-2 (2 1) = L1-HOLD
079000             MOVE   "IX-2" TO END-IDX
079100             SET     IDX-VALU TO IX-2
079200             MOVE   "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
079300             MOVE    END-STMT TO COMPUTED-A
079400     ELSE
079500             MOVE    ENTRY-7-2 (2 1) TO COMPUTED-A
079600             MOVE   "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
079700
079800     PERFORM FAIL-TH.
079900     GO TO   SPECIAL-TEST-1.
080000
080100 MULT-SEARCH-7-FAIL-3.
080200     MOVE    L3-HOLD TO CORRECT-A.
080300     IF      ENTRY-7-3 (2 1 2) = L3-HOLD
080400             MOVE   "IX-3" TO END-IDX
080500             SET     IDX-VALU TO IX-3
080600             MOVE   "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
080700             MOVE    END-STMT TO COMPUTED-A
080800     ELSE
080900             MOVE    ENTRY-7-3 (2 1 2) TO COMPUTED-A
081000             MOVE   "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
081100
081200     PERFORM FAIL-TH.
081300     GO TO   SPECIAL-TEST-1.
081400
081500 MULT-SEARCH-7-FAIL-4.
081600     MOVE    L4-HOLD TO CORRECT-A.
081700     IF      ENTRY-7-4 (2 1 2 1) = L4-HOLD
081800             MOVE   "IX-4" TO END-IDX
081900             SET     IDX-VALU TO IX-4
082000             MOVE   "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
082100             MOVE    END-STMT TO COMPUTED-A
082200     ELSE
082300             MOVE    ENTRY-7-4 (2 1 2 1) TO COMPUTED-A
082400             MOVE   "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
082500
082600     PERFORM FAIL-TH.
082700     GO TO   SPECIAL-TEST-1.
082800
082900 MULT-SEARCH-7-FAIL-5.
083000     MOVE    L5-HOLD TO CORRECT-A.
083100     IF      ENTRY-7-5 (2 1 2 1 2) = L5-HOLD
083200             MOVE   "IX-5" TO END-IDX
083300             SET     IDX-VALU TO IX-5
083400             MOVE   "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
083500             MOVE    END-STMT TO COMPUTED-A
083600     ELSE
083700             MOVE    ENTRY-7-5 (2 1 2 1 2) TO COMPUTED-A
083800             MOVE   "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
083900
084000     PERFORM FAIL-TH.
084100     GO TO   SPECIAL-TEST-1.
084200
084300 MULT-SEARCH-7-FAIL-6.
084400     MOVE    L6-HOLD TO CORRECT-A.
084500     IF      ENTRY-7-6 (2 1 2 1 2 1) = L6-HOLD
084600             MOVE   "IX-6" TO END-IDX
084700             SET     IDX-VALU TO IX-6
084800             MOVE   "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
084900             MOVE    END-STMT TO COMPUTED-A
085000     ELSE
085100             MOVE    ENTRY-7-6 (2 1 2 1 2 1) TO COMPUTED-A
085200             MOVE   "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
085300
085400     PERFORM FAIL-TH.
085500     GO TO   SPECIAL-TEST-1.
085600
085700 MULT-SEARCH-7-FAIL-7.
085800     MOVE    L7-HOLD TO CORRECT-A.
085900     IF      ENTRY-7-7 (2 1 2 1 2 1 2) = L7-HOLD
086000             MOVE   "IX-7" TO END-IDX
086100             SET     IDX-VALU TO IX-7
086200             MOVE   "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
086300             MOVE    END-STMT TO COMPUTED-A
086400     ELSE
086500             MOVE    ENTRY-7-7 (2 1 2 1 2 1 2) TO COMPUTED-A
086600             MOVE   "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
086700
086800     PERFORM FAIL-TH.
086900
087000 SPECIAL-TEST-1.
087100     MOVE "SPECIAL-TEST-1      " TO PAR-NAME.
087200     MOVE "IDX SET HI TO ENTRY " TO FEATURE.
087300     MOVE 04 TO CON-5.
087400     SET IDX-1 TO 04.
087500     SEARCH GRP-ENTRY VARYING CON-5 AT END
087600     GO TO SPEC-PASS-PARAGRAPH-1 WHEN ENTRY-1 (CON-5) = "GRP03"
087700         GO TO SPEC-FAIL-PARAGRAPH-1.
087800 SPECIAL-2-LEVEL-SEARCH.
087900     MOVE "SPECIAL-2-LEVEL-SEAR" TO PAR-NAME.
088000     MOVE 04 TO CON-5.
088100     MOVE 05 TO CON-6.
088200     SET IDX-1 TO 04.
088300     SET IDX-2 TO 05.
088400     SEARCH GRP-ENTRY VARYING IDX-1 AT END
088500         GO TO SPEC-FAIL-PARAGRAPH-2
088600         WHEN ENTRY-1 (CON-5) = "GRP04" NEXT SENTENCE.
088700     SEARCH GRP2-ENTRY VARYING CON-6 AT END
088800         GO TO SPEC-PASS-PARAGRAPH-2
088900         WHEN ENTRY-2 (CON-5, CON-6) = "SEC (04,04)"
089000         GO TO SPEC-FAIL-PARAGRAPH-3.
089100 SPEC-PASS-PARAGRAPH-1.
089200
089300     PERFORM PASS-TH.
089400     GO TO SPECIAL-2-LEVEL-SEARCH.
089500
089600 SPEC-FAIL-PARAGRAPH-1.
089700     MOVE "ENTRY SHOULD NOT BE FOUND  " TO RE-MARK.
089800     MOVE "GRP03" TO COMPUTED-A.
089900
090000     MOVE SPACES TO CORRECT-A.
090100     PERFORM FAIL-TH.
090200     GO TO SPECIAL-2-LEVEL-SEARCH.
090300
090400 SPEC-FAIL-PARAGRAPH-2.
090500     MOVE "GRP04" TO CORRECT-A.
090600     MOVE ENTRY-1 (04) TO COMPUTED-A.
090700
090800     MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK.
090900     PERFORM FAIL-TH.
091000     GO TO SPECIAL-3-LEVEL-SEARCH.
091100
091200 SPEC-FAIL-PARAGRAPH-3.
091300     MOVE ENTRY-2 (04, 04) TO COMPUTED-A.
091400     MOVE SPACE TO CORRECT-A.
091500     MOVE "ENTRY SHOULD NOT BE FOUND  " TO RE-MARK.
091600
091700     PERFORM FAIL-TH.
091800     GO TO SPECIAL-3-LEVEL-SEARCH.
091900
092000 SPEC-PASS-PARAGRAPH-2.
092100
092200     PERFORM PASS-TH.
092300     GO TO SPECIAL-3-LEVEL-SEARCH.
092400
092500 SPECIAL-3-LEVEL-SEARCH.
092600     MOVE "SPECIAL-3-LEVEL-SEAR" TO PAR-NAME.
092700     SET IDX-1 TO 02.
092800     MOVE 02 TO CON-5.
092900     SEARCH GRP-ENTRY VARYING CON-5 AT END
093000         GO TO SPEC-FAIL-PARAGRAPH-4 WHEN ENTRY-1 (CON-5)
093100         EQUAL TO "GRP02" NEXT SENTENCE.
093200     MOVE 01 TO CON-6.
093300     SET IDX-2 TO 01.
093400     SEARCH GRP2-ENTRY VARYING CON-6 AT END
093500         GO TO SPEC-FAIL-PARAGRAPH-5
093600     WHEN ENTRY-2 (CON-5, CON-6) = "SEC (02,03)" NEXT SENTENCE.
093700     MOVE 05 TO CON-7.
093800     SET IDX-3 TO 05.
093900     SEARCH GRP3-ENTRY VARYING CON-7 AT END
094000         GO TO SPEC-PASS-PARAGRAPH-3
094100     WHEN ENTRY-3 (CON-5, CON-6, CON-7) = "ELEM (02,03,04)"
094200
094300     MOVE "INDEX SET HIGHER THAN ENTRY" TO RE-MARK
094400         MOVE SPACES TO CORRECT-A
094500         MOVE "ELEM (02,03,04)" TO COMPUTED-A
094600         PERFORM FAIL-TH
094700         GO TO SEARCH-INIT-1.
094800 SPEC-PASS-PARAGRAPH-3.
094900
095000     PERFORM PASS-TH.
095100     GO TO SEARCH-INIT-1.
095200
095300 SPEC-FAIL-PARAGRAPH-4.
095400     IF ENTRY-1 (02) = "GRP02"
095500         MOVE "IDX-1" TO END-IDX
095600         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
095700         SET IDX-VALU TO IDX-1
095800         MOVE END-STMT TO COMPUTED-A  ELSE
095900     MOVE ENTRY-1 (02) TO COMPUTED-A
096000     MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
096100
096200     MOVE "GRP02" TO CORRECT-A.
096300     PERFORM FAIL-TH.
096400     GO TO SEARCH-INIT-1.
096500 SPEC-FAIL-PARAGRAPH-5.
096600     IF ENTRY-2 (02, 03) = "SEC (02,03)"
096700         MOVE "IDX-2" TO END-IDX
096800         SET IDX-VALU TO IDX-2
096900         MOVE "SEE NOTE 1 FOR DIAGNOSTIC  " TO RE-MARK
097000         MOVE END-STMT TO COMPUTED-A  ELSE
097100     MOVE ENTRY-2 (02, 03) TO COMPUTED-A
097200     MOVE "SEE NOTE 2 FOR DIAGNOSTIC  " TO RE-MARK.
097300
097400     MOVE "SEC (02, 03)" TO CORRECT-A.
097500     PERFORM FAIL-TH.
097600
097700
097800 SEARCH-INIT-1.
097900     MOVE   "SEARCH-TEST-1" TO PAR-NAME.
098000     MOVE   "IV-41 6.4.3"   TO ANSI-REFERENCE.
098100     MOVE   "EXP.SCOPE TERMINATOR" TO FEATURE.
098200     MOVE   "CD"   TO L1-HOLD.
098300     MOVE   "CD"   TO ENTRY-7-1 (2).
098400     MOVE    SPACE TO L2-HOLD.
098500     MOVE    SPACE TO L3-HOLD.
098600     MOVE    SPACE TO L4-HOLD.
098700     MOVE    1 TO REC-CT.
098800     MOVE    1 TO N1.
098900     SET     IX-1 IX-2 IX-3 IX-4 IX-5 IX-6 IX-7 TO 1.
099000     GO TO   SEARCH-TEST-1-0.
099100 SEARCH-DELETE-1.
099200     PERFORM DE-LETE.
099300     PERFORM PRINT-DETAIL.
099400     GO TO   SEARCH-INIT-2.
099500 SEARCH-TEST-1-0.
099600     SEARCH  GRP-7-1-ENTRY VARYING N1
099700             WHEN    ENTRY-7-1 (N1) =  L1-HOLD
099800                     MOVE   "AA" TO L2-HOLD
099900                     MOVE   "BB" TO L3-HOLD
100000     END-SEARCH
100100     MOVE   "CC" TO L4-HOLD.
100200 SEARCH-TEST-1-1.
100300     MOVE   "SEARCH-TEST-1-1" TO PAR-NAME.
100400     IF      L2-HOLD = "AA"
100500             PERFORM PASS
100600             PERFORM PRINT-DETAIL
100700     ELSE
100800             MOVE   "'WHEN' PHRASE SHOULD BE TRUE" TO RE-MARK
100900             MOVE   "AA"  TO CORRECT-X
101000             MOVE    L2-HOLD TO COMPUTED-X
101100             PERFORM FAIL
101200             PERFORM PRINT-DETAIL.
101300     ADD     1 TO REC-CT.
101400 SEARCH-TEST-1-2.
101500     MOVE   "SEARCH-TEST-1-2" TO PAR-NAME.
101600     IF      L3-HOLD = "BB"
101700             PERFORM PASS
101800             PERFORM PRINT-DETAIL
101900     ELSE
102000             MOVE   "'WHEN' PHRASE SHOULD BE TRUE" TO RE-MARK
102100             MOVE   "BB"  TO CORRECT-X
102200             MOVE    L3-HOLD TO COMPUTED-X
102300             PERFORM FAIL
102400             PERFORM PRINT-DETAIL.
102500     ADD     1 TO REC-CT.
102600 SEARCH-TEST-1-3.
102700     MOVE   "SEARCH-TEST-1-3" TO PAR-NAME.
102800     IF      L4-HOLD = "CC"
102900             PERFORM PASS
103000             PERFORM PRINT-DETAIL
103100     ELSE
103200             MOVE   "SCOPE TERMINATOR IGNORED" TO RE-MARK
103300             MOVE   "CC"  TO CORRECT-X
103400             MOVE    L4-HOLD TO COMPUTED-X
103500             PERFORM FAIL
103600             PERFORM PRINT-DETAIL.
103700
103800
103900 SEARCH-INIT-2.
104000     MOVE   "SEARCH-TEST-2" TO PAR-NAME.
104100     MOVE   "IV-41 6.4.3"   TO ANSI-REFERENCE.
104200     MOVE   "CD"   TO L1-HOLD.
104300     MOVE   "ZZ"   TO ENTRY-7-1 (2).
104400     MOVE    SPACE TO L2-HOLD.
104500     MOVE    SPACE TO L3-HOLD.
104600     MOVE    SPACE TO L4-HOLD.
104700     MOVE    1 TO REC-CT.
104800     MOVE    1 TO N1.
104900     SET     IX-1 IX-2 IX-3 IX-4 IX-5 IX-6 IX-7 TO 1.
105000     GO TO   SEARCH-TEST-2-0.
105100 SEARCH-DELETE-2.
105200     PERFORM DE-LETE.
105300     PERFORM PRINT-DETAIL.
105400     GO TO   END-SEARCH-TEST.
105500 SEARCH-TEST-2-0.
105600     SEARCH  GRP-7-1-ENTRY VARYING N1
105700             WHEN    ENTRY-7-1 (N1) =  L1-HOLD
105800                     MOVE   "AA" TO L2-HOLD
105900                     MOVE   "BB" TO L3-HOLD
106000     END-SEARCH
106100     MOVE   "CC" TO L4-HOLD.
106200 SEARCH-TEST-2-1.
106300     MOVE   "SEARCH-TEST-2-1" TO PAR-NAME.
106400     IF      L2-HOLD = SPACE
106500             PERFORM PASS
106600             PERFORM PRINT-DETAIL
106700     ELSE
106800             MOVE   "'WHEN' PHRASE SHOULD BE FALSE" TO RE-MARK
106900             MOVE    SPACE TO CORRECT-X
107000             MOVE    L2-HOLD TO COMPUTED-X
107100             PERFORM FAIL
107200             PERFORM PRINT-DETAIL.
107300     ADD     1 TO REC-CT.
107400 SEARCH-TEST-2-2.
107500     MOVE   "SEARCH-TEST-2-2" TO PAR-NAME.
107600     IF      L3-HOLD = SPACE
107700             PERFORM PASS
107800             PERFORM PRINT-DETAIL
107900     ELSE
108000             MOVE   "'WHEN' PHRASE SHOULD BE FALSE" TO RE-MARK
108100             MOVE    SPACE TO CORRECT-X
108200             MOVE    L3-HOLD TO COMPUTED-X
108300             PERFORM FAIL
108400             PERFORM PRINT-DETAIL.
108500     ADD     1 TO REC-CT.
108600 SEARCH-TEST-2-3.
108700     MOVE   "SEARCH-TEST-2-3" TO PAR-NAME.
108800     IF      L4-HOLD = "CC"
108900             PERFORM PASS
109000             PERFORM PRINT-DETAIL
109100     ELSE
109200             MOVE   "SCOPE TERMINATOR IGNORED" TO RE-MARK
109300             MOVE   "CC"  TO CORRECT-X
109400             MOVE    L4-HOLD TO COMPUTED-X
109500             PERFORM FAIL
109600             PERFORM PRINT-DETAIL.
109700
109800     GO TO END-SEARCH-TEST.
109900
110000 PASS-TH.
110100     PERFORM PASS.
110200     PERFORM PRINT-DETAIL.
110300 FAIL-TH.
110400     PERFORM FAIL.
110500     PERFORM  PRINT-DETAIL.
110600 END-SEARCH-TEST.
110700     EXIT.
110800 CCVS-EXIT SECTION.
110900 CCVS-999999.
111000     GO TO CLOSE-FILES.
