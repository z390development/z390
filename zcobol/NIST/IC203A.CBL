000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IC203A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*        THE PROGRAM IC203 TESTS THE USE OF THE CANCEL         *
002200*    STATEMENT.  THIS PROGRAM VERIFIES THAT THE INITIAL        *
002300*    CALL TO A SUBPROGRAM AND THE FIRST CALL AFTER A CANCEL    *
002400*    RESULTS IN A SUBPROGRAM BEING INITIATED IN ITS INITIAL    *
002500*    STATE.  THE PROGRAM ALSO CANCELS A PROGRAM WHICH HAS      *
002600*    NOT BEEN CALLED, IN WHICH CASE CONTROL SHOULD PASS        *
002700*    TO THE NEXT SENTENCE.                                     *
002800****************************************************************
002900 ENVIRONMENT DIVISION.
003000 CONFIGURATION SECTION.
003100 SOURCE-COMPUTER.
003200     XXXXX082.
003300 OBJECT-COMPUTER.
003400     XXXXX083.
003500 INPUT-OUTPUT SECTION.
003600 FILE-CONTROL.
003700     SELECT PRINT-FILE ASSIGN TO
003800     XXXXX055.
003900 DATA DIVISION.
004000 FILE SECTION.
004100 FD  PRINT-FILE.
004200 01  PRINT-REC PICTURE X(120).
004300 01  DUMMY-RECORD PICTURE X(120).
004400 WORKING-STORAGE SECTION.
004500 77  ID1 PICTURE X(6)     VALUE "IC204A".
004600 77  ID2 PICTURE X(6)     VALUE "IC206A".
004700 77  DN1 PICTURE S999.
004800 77  DN5 PICTURE S999.
004900 01  TABLE-1.
005000     02  DN2 PICTURE XXX.
005100     02  DN3 PICTURE 99.
005200     02  DN4 PICTURE X(5).
005300 01  TABLE-2.
005400     02  DN6 PICTURE X
005500             OCCURS 2 TIMES.
005600 01  TEST-RESULTS.
005700     02 FILLER                   PIC X      VALUE SPACE.
005800     02 FEATURE                  PIC X(20)  VALUE SPACE.
005900     02 FILLER                   PIC X      VALUE SPACE.
006000     02 P-OR-F                   PIC X(5)   VALUE SPACE.
006100     02 FILLER                   PIC X      VALUE SPACE.
006200     02  PAR-NAME.
006300       03 FILLER                 PIC X(19)  VALUE SPACE.
006400       03  PARDOT-X              PIC X      VALUE SPACE.
006500       03 DOTVALUE               PIC 99     VALUE ZERO.
006600     02 FILLER                   PIC X(8)   VALUE SPACE.
006700     02 RE-MARK                  PIC X(61).
006800 01  TEST-COMPUTED.
006900     02 FILLER                   PIC X(30)  VALUE SPACE.
007000     02 FILLER                   PIC X(17)  VALUE
007100            "       COMPUTED=".
007200     02 COMPUTED-X.
007300     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
007400     03 COMPUTED-N               REDEFINES COMPUTED-A
007500                                 PIC -9(9).9(9).
007600     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
007700     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
007800     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
007900     03       CM-18V0 REDEFINES COMPUTED-A.
008000         04 COMPUTED-18V0                    PIC -9(18).
008100         04 FILLER                           PIC X.
008200     03 FILLER PIC X(50) VALUE SPACE.
008300 01  TEST-CORRECT.
008400     02 FILLER PIC X(30) VALUE SPACE.
008500     02 FILLER PIC X(17) VALUE "       CORRECT =".
008600     02 CORRECT-X.
008700     03 CORRECT-A                  PIC X(20) VALUE SPACE.
008800     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
008900     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
009000     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
009100     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
009200     03      CR-18V0 REDEFINES CORRECT-A.
009300         04 CORRECT-18V0                     PIC -9(18).
009400         04 FILLER                           PIC X.
009500     03 FILLER PIC X(2) VALUE SPACE.
009600     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
009700 01  CCVS-C-1.
009800     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
009900-    "SS  PARAGRAPH-NAME
010000-    "       REMARKS".
010100     02 FILLER                     PIC X(20)    VALUE SPACE.
010200 01  CCVS-C-2.
010300     02 FILLER                     PIC X        VALUE SPACE.
010400     02 FILLER                     PIC X(6)     VALUE "TESTED".
010500     02 FILLER                     PIC X(15)    VALUE SPACE.
010600     02 FILLER                     PIC X(4)     VALUE "FAIL".
010700     02 FILLER                     PIC X(94)    VALUE SPACE.
010800 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
010900 01  REC-CT                        PIC 99       VALUE ZERO.
011000 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
011100 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
011200 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
011300 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
011400 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
011500 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
011600 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
011700 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
011800 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
011900 01  CCVS-H-1.
012000     02  FILLER                    PIC X(39)    VALUE SPACES.
012100     02  FILLER                    PIC X(42)    VALUE
012200     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
012300     02  FILLER                    PIC X(39)    VALUE SPACES.
012400 01  CCVS-H-2A.
012500   02  FILLER                        PIC X(40)  VALUE SPACE.
012600   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
012700   02  FILLER                        PIC XXXX   VALUE
012800     "4.2 ".
012900   02  FILLER                        PIC X(28)  VALUE
013000            " COPY - NOT FOR DISTRIBUTION".
013100   02  FILLER                        PIC X(41)  VALUE SPACE.
013200
013300 01  CCVS-H-2B.
013400   02  FILLER                        PIC X(15)  VALUE
013500            "TEST RESULT OF ".
013600   02  TEST-ID                       PIC X(9).
013700   02  FILLER                        PIC X(4)   VALUE
013800            " IN ".
013900   02  FILLER                        PIC X(12)  VALUE
014000     " HIGH       ".
014100   02  FILLER                        PIC X(22)  VALUE
014200            " LEVEL VALIDATION FOR ".
014300   02  FILLER                        PIC X(58)  VALUE
014400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
014500 01  CCVS-H-3.
014600     02  FILLER                      PIC X(34)  VALUE
014700            " FOR OFFICIAL USE ONLY    ".
014800     02  FILLER                      PIC X(58)  VALUE
014900     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
015000     02  FILLER                      PIC X(28)  VALUE
015100            "  COPYRIGHT   1985 ".
015200 01  CCVS-E-1.
015300     02 FILLER                       PIC X(52)  VALUE SPACE.
015400     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
015500     02 ID-AGAIN                     PIC X(9).
015600     02 FILLER                       PIC X(45)  VALUE SPACES.
015700 01  CCVS-E-2.
015800     02  FILLER                      PIC X(31)  VALUE SPACE.
015900     02  FILLER                      PIC X(21)  VALUE SPACE.
016000     02 CCVS-E-2-2.
016100         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
016200         03 FILLER                   PIC X      VALUE SPACE.
016300         03 ENDER-DESC               PIC X(44)  VALUE
016400            "ERRORS ENCOUNTERED".
016500 01  CCVS-E-3.
016600     02  FILLER                      PIC X(22)  VALUE
016700            " FOR OFFICIAL USE ONLY".
016800     02  FILLER                      PIC X(12)  VALUE SPACE.
016900     02  FILLER                      PIC X(58)  VALUE
017000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
017100     02  FILLER                      PIC X(13)  VALUE SPACE.
017200     02 FILLER                       PIC X(15)  VALUE
017300             " COPYRIGHT 1985".
017400 01  CCVS-E-4.
017500     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
017600     02 FILLER                       PIC X(4)   VALUE " OF ".
017700     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
017800     02 FILLER                       PIC X(40)  VALUE
017900      "  TESTS WERE EXECUTED SUCCESSFULLY".
018000 01  XXINFO.
018100     02 FILLER                       PIC X(19)  VALUE
018200            "*** INFORMATION ***".
018300     02 INFO-TEXT.
018400       04 FILLER                     PIC X(8)   VALUE SPACE.
018500       04 XXCOMPUTED                 PIC X(20).
018600       04 FILLER                     PIC X(5)   VALUE SPACE.
018700       04 XXCORRECT                  PIC X(20).
018800     02 INF-ANSI-REFERENCE           PIC X(48).
018900 01  HYPHEN-LINE.
019000     02 FILLER  PIC IS X VALUE IS SPACE.
019100     02 FILLER  PIC IS X(65)    VALUE IS "************************
019200-    "*****************************************".
019300     02 FILLER  PIC IS X(54)    VALUE IS "************************
019400-    "******************************".
019500 01  CCVS-PGM-ID                     PIC X(9)   VALUE
019600     "IC203A".
019700 PROCEDURE DIVISION.
019800 CCVS1 SECTION.
019900 OPEN-FILES.
020000     OPEN     OUTPUT PRINT-FILE.
020100     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
020200     MOVE    SPACE TO TEST-RESULTS.
020300     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
020400     GO TO CCVS1-EXIT.
020500 CLOSE-FILES.
020600     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
020700 TERMINATE-CCVS.
020800S    EXIT PROGRAM.
020900STERMINATE-CALL.
021000     STOP     RUN.
021100 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
021200 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
021300 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
021400 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
021500     MOVE "****TEST DELETED****" TO RE-MARK.
021600 PRINT-DETAIL.
021700     IF REC-CT NOT EQUAL TO ZERO
021800             MOVE "." TO PARDOT-X
021900             MOVE REC-CT TO DOTVALUE.
022000     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
022100     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
022200        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
022300          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
022400     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
022500     MOVE SPACE TO CORRECT-X.
022600     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
022700     MOVE     SPACE TO RE-MARK.
022800 HEAD-ROUTINE.
022900     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023000     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023100     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
023200     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
023300 COLUMN-NAMES-ROUTINE.
023400     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
023500     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
023700 END-ROUTINE.
023800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
023900 END-RTN-EXIT.
024000     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024100 END-ROUTINE-1.
024200      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
024300      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
024400      ADD PASS-COUNTER TO ERROR-HOLD.
024500*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
024600      MOVE PASS-COUNTER TO CCVS-E-4-1.
024700      MOVE ERROR-HOLD TO CCVS-E-4-2.
024800      MOVE CCVS-E-4 TO CCVS-E-2-2.
024900      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
025000  END-ROUTINE-12.
025100      MOVE "TEST(S) FAILED" TO ENDER-DESC.
025200     IF       ERROR-COUNTER IS EQUAL TO ZERO
025300         MOVE "NO " TO ERROR-TOTAL
025400         ELSE
025500         MOVE ERROR-COUNTER TO ERROR-TOTAL.
025600     MOVE     CCVS-E-2 TO DUMMY-RECORD.
025700     PERFORM WRITE-LINE.
025800 END-ROUTINE-13.
025900     IF DELETE-COUNTER IS EQUAL TO ZERO
026000         MOVE "NO " TO ERROR-TOTAL  ELSE
026100         MOVE DELETE-COUNTER TO ERROR-TOTAL.
026200     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
026300     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026400      IF   INSPECT-COUNTER EQUAL TO ZERO
026500          MOVE "NO " TO ERROR-TOTAL
026600      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
026700      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
026800      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026900     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027000 WRITE-LINE.
027100     ADD 1 TO RECORD-COUNT.
027200Y    IF RECORD-COUNT GREATER 50
027300Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
027400Y        MOVE SPACE TO DUMMY-RECORD
027500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
027600Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
027700Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
027800Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
027900Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
028000Y        MOVE ZERO TO RECORD-COUNT.
028100     PERFORM WRT-LN.
028200 WRT-LN.
028300     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
028400     MOVE SPACE TO DUMMY-RECORD.
028500 BLANK-LINE-PRINT.
028600     PERFORM WRT-LN.
028700 FAIL-ROUTINE.
028800     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
028900     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
029000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
029100     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
029200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029300     MOVE   SPACES TO INF-ANSI-REFERENCE.
029400     GO TO  FAIL-ROUTINE-EX.
029500 FAIL-ROUTINE-WRITE.
029600     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
029700     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
029800     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
029900     MOVE   SPACES TO COR-ANSI-REFERENCE.
030000 FAIL-ROUTINE-EX. EXIT.
030100 BAIL-OUT.
030200     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
030300     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
030400 BAIL-OUT-WRITE.
030500     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
030600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
030700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030800     MOVE   SPACES TO INF-ANSI-REFERENCE.
030900 BAIL-OUT-EX. EXIT.
031000 CCVS1-EXIT.
031100     EXIT.
031200 SECT-IC203-0001 SECTION.
031300 CALL-TEST-04.
031400*        CALL-TEST-04 VERIFIES THAT A PROGRAM IS IN ITS
031500*    INITIAL STATE THE FIRST TIME IT IS CALLED.
031600     MOVE "CALL-TEST-04" TO PAR-NAME.
031700     MOVE "INITIAL STATE" TO FEATURE.
031800     MOVE 1 TO DN3.
031900     MOVE SPACE TO DN2, DN4.
032000     MOVE ZERO TO DN1.
032100     CALL ID1 USING TABLE-1, DN1.
032200     GO TO CALL-TEST-04-01.
032300 CALL-DELETE-04.
032400     PERFORM DE-LETE.
032500     PERFORM PRINT-DETAIL.
032600     GO TO CALL-TEST-05.
032700 CALL-TEST-04-01.
032800     MOVE 1 TO REC-CT.
032900     IF DN1 IS EQUAL TO 1
033000         PERFORM PASS
033100         GO TO CALL-WRITE-04-01.
033200 CALL-FAIL-04-01.
033300     PERFORM FAIL.
033400     MOVE DN1 TO COMPUTED-18V0.
033500     MOVE 1 TO CORRECT-18V0.
033600     MOVE "DN1 INCORRECT" TO RE-MARK.
033700 CALL-WRITE-04-01.
033800     PERFORM PRINT-DETAIL.
033900 CALL-TEST-04-02.
034000     ADD 1 TO REC-CT.
034100     IF DN2 IS EQUAL TO "YES"
034200         PERFORM PASS
034300         GO TO CALL-WRITE-04-02.
034400 CALL-FAIL-04-02.
034500     PERFORM FAIL.
034600     MOVE DN2 TO COMPUTED-A.
034700     MOVE "YES" TO CORRECT-A.
034800     MOVE "DN2 INCORRECT" TO RE-MARK.
034900 CALL-WRITE-04-02.
035000     PERFORM PRINT-DETAIL.
035100 CALL-TEST-04-03.
035200     ADD 1 TO REC-CT.
035300     IF DN4 EQUAL TO "EQUAL"
035400         PERFORM PASS
035500         GO TO CALL-WRITE-04-03.
035600 CALL-FAIL-04-03.
035700     PERFORM FAIL.
035800     MOVE DN4 TO COMPUTED-A.
035900     MOVE "EQUAL" TO CORRECT-A.
036000     MOVE "DN4 INCORRECT" TO RE-MARK.
036100 CALL-WRITE-04-03.
036200     PERFORM PRINT-DETAIL.
036300 CALL-TEST-05.
036400     MOVE "CALL-TEST-05" TO PAR-NAME.
036500     MOVE "STATE UNCHANGED" TO FEATURE.
036600*        CALL-TEST-05 TESTS THAT THE STATE OF THE SUBPROGRAM
036700*    IS UNCHANGED FROM ITS STATE WHEN LAST EXITED.
036800     MOVE 2 TO DN3.
036900     MOVE SPACE TO DN2, DN4.
037000     MOVE ZERO TO DN5.
037100     CALL ID1 USING TABLE-1, DN5.
037200     GO TO CALL-TEST-05-01.
037300 CALL-DELETE-05.
037400     PERFORM DE-LETE.
037500     PERFORM PRINT-DETAIL.
037600     GO TO CNCL-TEST-01.
037700 CALL-TEST-05-01.
037800     MOVE 1 TO REC-CT.
037900     IF DN5 EQUAL TO 2
038000         PERFORM PASS
038100         GO TO CALL-WRITE-05-01.
038200 CALL-FAIL-05-01.
038300     PERFORM FAIL.
038400     MOVE DN5 TO COMPUTED-18V0.
038500     MOVE 2 TO CORRECT-18V0.
038600     MOVE "DN5 INCORRECT" TO RE-MARK.
038700 CALL-WRITE-05-01.
038800     PERFORM PRINT-DETAIL.
038900 CALL-TEST-05-02.
039000     ADD 1 TO REC-CT.
039100     IF DN2 EQUAL TO "NO"
039200         PERFORM PASS
039300         GO TO CALL-WRITE-05-02.
039400 CALL-FAIL-05-02.
039500     PERFORM FAIL.
039600     MOVE DN2 TO COMPUTED-A.
039700     MOVE "NO" TO CORRECT-A.
039800     MOVE "DN2 INCORRECT" TO RE-MARK.
039900 CALL-WRITE-05-02.
040000     PERFORM PRINT-DETAIL.
040100 CALL-TEST-05-03.
040200     ADD 1 TO REC-CT.
040300     IF DN4 EQUAL TO "EQUAL"
040400         PERFORM PASS
040500         GO TO CALL-WRITE-05-03.
040600 CALL-FAIL-05-03.
040700     PERFORM FAIL.
040800     MOVE DN4 TO COMPUTED-A.
040900     MOVE "EQUAL" TO CORRECT-A.
041000     MOVE "DN4 INCORRECT" TO RE-MARK.
041100 CALL-WRITE-05-03.
041200     PERFORM PRINT-DETAIL.
041300 CNCL-TEST-01.
041400*        THIS TEST VERIFIES THAT A SUBPROGRAM IS IN ITS
041500*    INITIAL STATE THE FIRST TIME IT IS CALLED FOLLOWING
041600*    A CANCEL STATEMENT.
041700     MOVE "CNCL-TEST-01" TO PAR-NAME.
041800     MOVE "SET TO INITIAL STATE" TO FEATURE.
041900     CALL "IC204A" USING TABLE-1, DN1.
042000     CANCEL "IC204A".
042100     MOVE 1 TO DN3.
042200     MOVE SPACE TO DN2, DN4.
042300     MOVE ZERO TO DN1.
042400     CALL "IC204A" USING TABLE-1, DN1.
042500     GO TO CNCL-TEST-01-01.
042600 CNCL-DELETE-01.
042700     PERFORM DE-LETE.
042800     PERFORM PRINT-DETAIL.
042900     GO TO CNCL-TEST-02.
043000 CNCL-TEST-01-01.
043100     MOVE 1 TO REC-CT.
043200     IF DN1 IS EQUAL TO 1
043300         PERFORM PASS
043400         GO TO CNCL-WRITE-01-01.
043500 CNCL-FAIL-01-01.
043600     PERFORM FAIL.
043700     MOVE DN1 TO COMPUTED-18V0.
043800     MOVE 1 TO CORRECT-18V0.
043900     MOVE "DN1 INCORRECT" TO RE-MARK.
044000 CNCL-WRITE-01-01.
044100     PERFORM PRINT-DETAIL.
044200 CNCL-TEST-01-02.
044300     ADD 1 TO REC-CT.
044400     IF DN2 IS EQUAL TO "YES"
044500         PERFORM PASS
044600         GO TO CNCL-WRITE-01-02.
044700 CNCL-FAIL-01-02.
044800     PERFORM FAIL.
044900     MOVE DN2 TO COMPUTED-A.
045000     MOVE "YES" TO CORRECT-A.
045100     MOVE "DN2 INCORRECT" TO RE-MARK.
045200 CNCL-WRITE-01-02.
045300     PERFORM PRINT-DETAIL.
045400 CNCL-TEST-01-03.
045500     ADD 1 TO REC-CT.
045600     IF DN4 EQUAL TO "EQUAL"
045700         PERFORM PASS
045800         GO TO CNCL-WRITE-01-03.
045900 CNCL-FAIL-01-03.
046000     PERFORM FAIL.
046100     MOVE DN4 TO COMPUTED-A.
046200     MOVE "EQUAL" TO CORRECT-A.
046300     MOVE "DN4 INCORRECT" TO RE-MARK.
046400 CNCL-WRITE-01-03.
046500     PERFORM PRINT-DETAIL.
046600 CNCL-TEST-02.
046700*        THIS TEST USES AN IDENTIFIER IN THE CANCEL STATEMENT.
046800*    THE SUBPROGRAM SHOULD BE IN ITS INITIAL STATE ON THE FIRST
046900*    CALL FOLLOWING A CANCEL OF THE SUBPROGRAM.
047000     MOVE "CNCL-TEST-02" TO PAR-NAME.
047100     MOVE "SET TO INITIAL STATE" TO FEATURE.
047200     CALL "IC204A" USING TABLE-1, DN1.
047300     CANCEL ID1.
047400     MOVE 1 TO DN3.
047500     MOVE SPACE TO DN2, DN4.
047600     MOVE ZERO TO DN1.
047700     CALL ID1 USING TABLE-1, DN1.
047800     GO TO CNCL-TEST-02-01.
047900 CNCL-DELETE-02.
048000     PERFORM DE-LETE.
048100     PERFORM PRINT-DETAIL.
048200     GO TO CNCL-TEST-03.
048300 CNCL-TEST-02-01.
048400     MOVE 1 TO REC-CT.
048500     IF DN1 EQUAL TO 1
048600         PERFORM PASS
048700         GO TO CNCL-WRITE-02-01.
048800 CNCL-FAIL-02-01.
048900     PERFORM FAIL.
049000     MOVE 1 TO CORRECT-18V0.
049100     MOVE DN1 TO COMPUTED-18V0.
049200     MOVE "DN1 INCORRECT" TO RE-MARK.
049300 CNCL-WRITE-02-01.
049400     PERFORM PRINT-DETAIL.
049500 CNCL-TEST-02-02.
049600     ADD 1 TO REC-CT.
049700     IF DN2 EQUAL TO "YES"
049800         PERFORM PASS
049900         GO TO CNCL-WRITE-02-02.
050000 CNCL-FAIL-02-02.
050100     PERFORM FAIL.
050200     MOVE DN2 TO COMPUTED-A.
050300     MOVE "YES" TO CORRECT-A.
050400     MOVE "DN2 INCORRECT" TO RE-MARK.
050500 CNCL-WRITE-02-02.
050600     PERFORM PRINT-DETAIL.
050700 CNCL-TEST-02-03.
050800     ADD 1 TO REC-CT.
050900     IF DN4 EQUAL TO "EQUAL"
051000         PERFORM PASS
051100         GO TO CNCL-WRITE-02-03.
051200 CNCL-FAIL-02-03.
051300     PERFORM FAIL.
051400     MOVE DN4 TO COMPUTED-A.
051500     MOVE "EQUAL" TO CORRECT-A.
051600     MOVE "DN4 INCORRECT" TO RE-MARK.
051700 CNCL-WRITE-02-03.
051800     PERFORM PRINT-DETAIL.
051900 CNCL-TEST-03.
052000*        THIS TEST CANCELS A SUBPROGRAM WHICH HAS ALREADY
052100*    BEEN CANCELED.  THE SUBPROGRAM IS THEN CALLED AND A CHECK
052200*    IS MADE TO ENSURE THAT THE SUBPROGRAM WAS IN ITS INITIAL
052300*    STATE.
052400     MOVE "CNCL-TEST-03" TO PAR-NAME.
052500     MOVE "PREVIOUSLY CANCELED" TO FEATURE.
052600 CNCL-INIT-03.
052700     CALL "IC204A" USING TABLE-1, DN1.
052800     CANCEL ID1.
052900     CANCEL ID1.
053000     MOVE 1 TO DN3.
053100     MOVE SPACE TO DN2, DN4.
053200     MOVE ZERO TO DN1.
053300     CALL ID1 USING TABLE-1, DN1.
053400     GO TO CNCL-TEST-03-01.
053500 CNCL-DELETE-03.
053600     PERFORM DE-LETE.
053700     PERFORM PRINT-DETAIL.
053800     GO TO CNCL-TEST-04.
053900 CNCL-TEST-03-01.
054000     MOVE 1 TO REC-CT.
054100     IF DN1 EQUAL TO 1
054200         PERFORM PASS
054300         GO TO CNCL-WRITE-03-01.
054400 CNCL-FAIL-03-01.
054500     PERFORM FAIL.
054600     MOVE 1 TO CORRECT-18V0.
054700     MOVE DN1 TO COMPUTED-18V0.
054800     MOVE "DN1 INCORRECT" TO RE-MARK.
054900 CNCL-WRITE-03-01.
055000     PERFORM PRINT-DETAIL.
055100 CNCL-TEST-03-02.
055200     ADD 1 TO REC-CT.
055300     IF DN2 IS EQUAL TO "YES"
055400         PERFORM PASS
055500         GO TO CNCL-WRITE-03-02.
055600 CNCL-FAIL-03-02.
055700     PERFORM FAIL.
055800     MOVE DN2 TO COMPUTED-A.
055900     MOVE "YES" TO CORRECT-A.
056000     MOVE "DN2 INCORRECT" TO RE-MARK.
056100 CNCL-WRITE-03-02.
056200     PERFORM PRINT-DETAIL.
056300 CNCL-TEST-03-03.
056400     ADD 1 TO REC-CT.
056500     IF DN4 EQUAL TO "EQUAL"
056600         PERFORM PASS
056700         GO TO CNCL-WRITE-03-03.
056800 CNCL-FAIL-03-03.
056900     PERFORM FAIL.
057000     MOVE DN4 TO COMPUTED-A.
057100     MOVE "EQUAL" TO CORRECT-A.
057200     MOVE "DN4 INCORRECT" TO RE-MARK.
057300 CNCL-WRITE-03-03.
057400     PERFORM PRINT-DETAIL.
057500 CNCL-INIT-04.
057600     MOVE "CNCL-TEST-04" TO PAR-NAME.
057700     MOVE "CANCEL UNCALLED PROG" TO FEATURE.
057800     MOVE ZERO TO REC-CT.
057900 CNCL-TEST-04.
058000*        THIS TEST CANCELS A SUBPROGRAM WHICH HAS NEVER
058100*    BEEN CALLED.  THE NEXT SENTENCE SHOULD BE EXECUTED
058200*    IN THIS CASE.
058300     CANCEL "IC205A".
058400     GO TO CNCL-PASS-04.
058500 CNCL-DELETE-04.
058600     PERFORM DE-LETE.
058700     GO TO CNCL-WRITE-04.
058800 CNCL-PASS-04.
058900     PERFORM PASS.
059000 CNCL-WRITE-04.
059100     PERFORM PRINT-DETAIL.
059200 CNCL-INIT-05.
059300     MOVE "CNCL-TEST-05" TO PAR-NAME.
059400     MOVE "CANCEL IN SUBPROGRAM" TO FEATURE.
059500*        THIS TEST CALLS SUBPROGRAM IC205 WHICH CALLS AND
059600*    CANCELS A THIRD SUBPROGRAM IC206.
059700 CNCL-TEST-05.
059800     MOVE SPACE TO DN2, DN4, TABLE-2.
059900     MOVE ZERO TO DN1.
060000     CALL "IC205A" USING TABLE-1, TABLE-2, DN1.
060100     IF TABLE-2 EQUAL TO "AB"
060200         PERFORM PASS
060300         GO TO CNCL-WRITE-05.
060400     GO TO CNCL-FAIL-05.
060500 CNCL-DELETE-05.
060600     PERFORM DE-LETE.
060700     GO TO CNCL-WRITE-05.
060800 CNCL-FAIL-05.
060900     PERFORM FAIL.
061000     MOVE "AB" TO CORRECT-A.
061100     MOVE TABLE-2 TO COMPUTED-A.
061200     MOVE "TABLE-2 INCORRECT" TO RE-MARK.
061300 CNCL-WRITE-05.
061400     PERFORM PRINT-DETAIL.
061500 CNCL-INIT-06.
061600     MOVE "CNCL-TEST-06" TO PAR-NAME.
061700     MOVE "CALL CANCELED PROG" TO FEATURE.
061800*        THIS TEST CHECKS THAT THE CANCEL OF IC204 WHICH
061900*    WAS MADE IN THE SUBPROGRAM IC205 WAS EXECUTED PROPERLY.
062000*    THE SUBPROGRAM IC204 IS CALLED AND THE DATA VALUES
062100*    ARE CHECKED TO SEE IF IC204 WAS IN ITS INITIAL STATE.
062200 CNCL-TEST-06.
062300     MOVE 1 TO DN3.
062400     MOVE SPACE TO DN2, DN4.
062500     MOVE ZERO TO DN1.
062600     CALL ID1 USING TABLE-1, DN1.
062700     GO TO CNCL-TEST-06-01.
062800 CNCL-DELETE-06.
062900     PERFORM DE-LETE.
063000     GO TO CNCL-WRITE-06-03.
063100 CNCL-TEST-06-01.
063200     MOVE 1 TO REC-CT.
063300     IF DN1 IS EQUAL TO 1
063400         PERFORM PASS
063500         GO TO CNCL-WRITE-06-01.
063600 CNCL-FAIL-06-01.
063700     PERFORM FAIL.
063800     MOVE DN1 TO COMPUTED-18V0.
063900     MOVE 1 TO CORRECT-18V0.
064000     MOVE "DN1 INCORRECT" TO RE-MARK.
064100 CNCL-WRITE-06-01.
064200     PERFORM PRINT-DETAIL.
064300 CNCL-TEST-06-02.
064400     ADD 1 TO REC-CT.
064500     IF DN2 IS EQUAL TO "YES"
064600         PERFORM PASS
064700         GO TO CNCL-WRITE-06-02.
064800 CNCL-FAIL-06-02.
064900     PERFORM FAIL.
065000     MOVE DN2 TO COMPUTED-A.
065100     MOVE "YES" TO CORRECT-A.
065200     MOVE "DN2 INCORRECT" TO RE-MARK.
065300 CNCL-WRITE-06-02.
065400     PERFORM PRINT-DETAIL.
065500 CNCL-TEST-06-03.
065600     ADD 1 TO REC-CT.
065700     IF DN4 EQUAL TO "EQUAL"
065800         PERFORM PASS
065900         GO TO CNCL-WRITE-06-03.
066000 CNCL-FAIL-06-03.
066100     PERFORM FAIL.
066200     MOVE DN4 TO COMPUTED-A.
066300     MOVE "EQUAL" TO CORRECT-A.
066400     MOVE "DN4 INCORRECT" TO RE-MARK.
066500 CNCL-WRITE-06-03.
066600     PERFORM PRINT-DETAIL.
066700 CNCL-INIT-07.
066800*        THIS TEST CANCELS THE THREE SUBPROGRAMS
066900*    CALLED BY THIS ROUTINE.
067000     MOVE "CNCL-TEST-07" TO PAR-NAME.
067100     MOVE "CANCEL 3 PROGS" TO FEATURE.
067200     MOVE ZERO TO REC-CT.
067300 CNCL-TEST-07.
067400     CANCEL ID1, "IC205A", ID2.
067500     PERFORM PASS.
067600     GO TO CNCL-WRITE-07.
067700 CNCL-DELETE-07.
067800     PERFORM DE-LETE.
067900 CNCL-WRITE-07.
068000     PERFORM PRINT-DETAIL.
068100 CCVS-EXIT SECTION.
068200 CCVS-999999.
068300     GO TO CLOSE-FILES.
