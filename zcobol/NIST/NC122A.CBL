000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     NC122A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*
002200*   PROGRAM NC122A TESTS THE USE OF INDEXED IDENTIFIERS USING
002300*   FORMATS 1, 2 AND 3 OF THE "INSPECT" STATEMENT.
002400*   SINGLE LEVEL AND RELATIVE INDEXING ARE USED.
002500*
002600 ENVIRONMENT DIVISION.
002700 CONFIGURATION SECTION.
002800 SOURCE-COMPUTER.
002900     XXXXX082.
003000 OBJECT-COMPUTER.
003100     XXXXX083.
003200 INPUT-OUTPUT SECTION.
003300 FILE-CONTROL.
003400     SELECT PRINT-FILE ASSIGN TO
003500     XXXXX055.
003600 DATA DIVISION.
003700 FILE SECTION.
003800 FD  PRINT-FILE.
003900 01  PRINT-REC PICTURE X(120).
004000 01  DUMMY-RECORD PICTURE X(120).
004100 WORKING-STORAGE SECTION.
004200 01  WRK-OK.
004300   03  WRK-OK-1-20                  PIC X(20).
004400   03  WRK-OK-21-40                 PIC X(20).
004500   03  WRK-OK-41-60                 PIC X(20).
004600   03  WRK-OK-61-80                 PIC X(20).
004700   03  WRK-OK-81-83                 PIC X(3).
004800 01  WRK-ER.
004900   03  WRK-ER-1-20                  PIC X(20).
005000   03  WRK-ER-21-40                 PIC X(20).
005100   03  WRK-ER-41-60                 PIC X(20).
005200   03  WRK-ER-61-80                 PIC X(20).
005300   03  WRK-ER-81-83                 PIC X(3).
005400 01  TABLE1.
005500     02  TABLE1-REC              PICTURE X(83)
005600                                 OCCURS 4 TIMES
005700                                 INDEXED BY INDEX1.
005800 01  TABLE2.
005900     02  WRK-DU-999              PICTURE 999
006000                                 OCCURS 4 TIMES
006100                                 INDEXED BY INDEX2.
006200 01  TABLE3.
006300     02  TABLE3-SYMBOL           PICTURE X
006400                                 OCCURS 3 TIMES
006500                                 INDEXED BY INDEX3.
006600 01  TABLE4.
006700     02  TABLE4-LETTER           PICTURE X
006800                                 OCCURS 9 TIMES
006900                                 INDEXED BY INDEX4.
007000 01  WC-XN-83  PIC X(83) VALUE
007100     "AH YES AH YES W.C. FRITOES HERE. ANYONE WHO HATES DOGS AND K
007200-    "IDS CAN NOT BE ALL BAD.".
007300 01  ANS-XN-83-1 PIC X(83) VALUE
007400     "OH YES AH YES W.C. FRITOES HERE. ANYONE WHO HATES DOGS AND K
007500-    "IDS CAN NOT BE ALL BAD.".
007600 01  ANS-XN-83-2 PIC X(83) VALUE
007700     "AH YES,AH YES W.C. FRITOES HERE. ANYONE WHO HATES DOGS AND K
007800-    "IDS CAN NOT BE ALL BAD.".
007900 01  ANS-XN-83-3 PIC X(83) VALUE
008000     "AH YES AH YES W.C. FRITOES HERE. ANYONE WHO HATES DOGS AND K
008100-    "IDS CAN NOT BE ALL-BAD.".
008200 01  ANS-XN-83-4 PIC X(83) VALUE
008300     "EH YES EH YES W.C. FRITOES HERE. ENYONE WHO HETES DOGS END K
008400-    "IDS CEN NOT BE ELL BAD.".
008500 01  ANS-XN-83-5 PIC X(83) VALUE
008600     "AH YES OH YES W.C. FRITOES HERE. ANYONE WHO HATES DOGS AND K
008700-    "IDS CAN NOT BE ALL BAD.".
008800 01  TEST-RESULTS.
008900     02 FILLER                   PIC X      VALUE SPACE.
009000     02 FEATURE                  PIC X(20)  VALUE SPACE.
009100     02 FILLER                   PIC X      VALUE SPACE.
009200     02 P-OR-F                   PIC X(5)   VALUE SPACE.
009300     02 FILLER                   PIC X      VALUE SPACE.
009400     02  PAR-NAME.
009500       03 FILLER                 PIC X(19)  VALUE SPACE.
009600       03  PARDOT-X              PIC X      VALUE SPACE.
009700       03 DOTVALUE               PIC 99     VALUE ZERO.
009800     02 FILLER                   PIC X(8)   VALUE SPACE.
009900     02 RE-MARK                  PIC X(61).
010000 01  TEST-COMPUTED.
010100     02 FILLER                   PIC X(30)  VALUE SPACE.
010200     02 FILLER                   PIC X(17)  VALUE
010300            "       COMPUTED=".
010400     02 COMPUTED-X.
010500     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
010600     03 COMPUTED-N               REDEFINES COMPUTED-A
010700                                 PIC -9(9).9(9).
010800     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
010900     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
011000     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
011100     03       CM-18V0 REDEFINES COMPUTED-A.
011200         04 COMPUTED-18V0                    PIC -9(18).
011300         04 FILLER                           PIC X.
011400     03 FILLER PIC X(50) VALUE SPACE.
011500 01  TEST-CORRECT.
011600     02 FILLER PIC X(30) VALUE SPACE.
011700     02 FILLER PIC X(17) VALUE "       CORRECT =".
011800     02 CORRECT-X.
011900     03 CORRECT-A                  PIC X(20) VALUE SPACE.
012000     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
012100     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
012200     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
012300     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
012400     03      CR-18V0 REDEFINES CORRECT-A.
012500         04 CORRECT-18V0                     PIC -9(18).
012600         04 FILLER                           PIC X.
012700     03 FILLER PIC X(2) VALUE SPACE.
012800     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
012900 01  CCVS-C-1.
013000     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
013100-    "SS  PARAGRAPH-NAME
013200-    "       REMARKS".
013300     02 FILLER                     PIC X(20)    VALUE SPACE.
013400 01  CCVS-C-2.
013500     02 FILLER                     PIC X        VALUE SPACE.
013600     02 FILLER                     PIC X(6)     VALUE "TESTED".
013700     02 FILLER                     PIC X(15)    VALUE SPACE.
013800     02 FILLER                     PIC X(4)     VALUE "FAIL".
013900     02 FILLER                     PIC X(94)    VALUE SPACE.
014000 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
014100 01  REC-CT                        PIC 99       VALUE ZERO.
014200 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
014300 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
014400 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
014500 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
014600 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
014700 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
014800 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
014900 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
015000 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
015100 01  CCVS-H-1.
015200     02  FILLER                    PIC X(39)    VALUE SPACES.
015300     02  FILLER                    PIC X(42)    VALUE
015400     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
015500     02  FILLER                    PIC X(39)    VALUE SPACES.
015600 01  CCVS-H-2A.
015700   02  FILLER                        PIC X(40)  VALUE SPACE.
015800   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
015900   02  FILLER                        PIC XXXX   VALUE
016000     "4.2 ".
016100   02  FILLER                        PIC X(28)  VALUE
016200            " COPY - NOT FOR DISTRIBUTION".
016300   02  FILLER                        PIC X(41)  VALUE SPACE.
016400
016500 01  CCVS-H-2B.
016600   02  FILLER                        PIC X(15)  VALUE
016700            "TEST RESULT OF ".
016800   02  TEST-ID                       PIC X(9).
016900   02  FILLER                        PIC X(4)   VALUE
017000            " IN ".
017100   02  FILLER                        PIC X(12)  VALUE
017200     " HIGH       ".
017300   02  FILLER                        PIC X(22)  VALUE
017400            " LEVEL VALIDATION FOR ".
017500   02  FILLER                        PIC X(58)  VALUE
017600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
017700 01  CCVS-H-3.
017800     02  FILLER                      PIC X(34)  VALUE
017900            " FOR OFFICIAL USE ONLY    ".
018000     02  FILLER                      PIC X(58)  VALUE
018100     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
018200     02  FILLER                      PIC X(28)  VALUE
018300            "  COPYRIGHT   1985 ".
018400 01  CCVS-E-1.
018500     02 FILLER                       PIC X(52)  VALUE SPACE.
018600     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
018700     02 ID-AGAIN                     PIC X(9).
018800     02 FILLER                       PIC X(45)  VALUE SPACES.
018900 01  CCVS-E-2.
019000     02  FILLER                      PIC X(31)  VALUE SPACE.
019100     02  FILLER                      PIC X(21)  VALUE SPACE.
019200     02 CCVS-E-2-2.
019300         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
019400         03 FILLER                   PIC X      VALUE SPACE.
019500         03 ENDER-DESC               PIC X(44)  VALUE
019600            "ERRORS ENCOUNTERED".
019700 01  CCVS-E-3.
019800     02  FILLER                      PIC X(22)  VALUE
019900            " FOR OFFICIAL USE ONLY".
020000     02  FILLER                      PIC X(12)  VALUE SPACE.
020100     02  FILLER                      PIC X(58)  VALUE
020200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
020300     02  FILLER                      PIC X(13)  VALUE SPACE.
020400     02 FILLER                       PIC X(15)  VALUE
020500             " COPYRIGHT 1985".
020600 01  CCVS-E-4.
020700     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
020800     02 FILLER                       PIC X(4)   VALUE " OF ".
020900     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
021000     02 FILLER                       PIC X(40)  VALUE
021100      "  TESTS WERE EXECUTED SUCCESSFULLY".
021200 01  XXINFO.
021300     02 FILLER                       PIC X(19)  VALUE
021400            "*** INFORMATION ***".
021500     02 INFO-TEXT.
021600       04 FILLER                     PIC X(8)   VALUE SPACE.
021700       04 XXCOMPUTED                 PIC X(20).
021800       04 FILLER                     PIC X(5)   VALUE SPACE.
021900       04 XXCORRECT                  PIC X(20).
022000     02 INF-ANSI-REFERENCE           PIC X(48).
022100 01  HYPHEN-LINE.
022200     02 FILLER  PIC IS X VALUE IS SPACE.
022300     02 FILLER  PIC IS X(65)    VALUE IS "************************
022400-    "*****************************************".
022500     02 FILLER  PIC IS X(54)    VALUE IS "************************
022600-    "******************************".
022700 01  CCVS-PGM-ID                     PIC X(9)   VALUE
022800     "NC122A".
022900 PROCEDURE DIVISION.
023000 CCVS1 SECTION.
023100 OPEN-FILES.
023200     OPEN     OUTPUT PRINT-FILE.
023300     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
023400     MOVE    SPACE TO TEST-RESULTS.
023500     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
023600     GO TO CCVS1-EXIT.
023700 CLOSE-FILES.
023800     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
023900 TERMINATE-CCVS.
024000S    EXIT PROGRAM.
024100STERMINATE-CALL.
024200     STOP     RUN.
024300 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
024400 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
024500 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
024600 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
024700     MOVE "****TEST DELETED****" TO RE-MARK.
024800 PRINT-DETAIL.
024900     IF REC-CT NOT EQUAL TO ZERO
025000             MOVE "." TO PARDOT-X
025100             MOVE REC-CT TO DOTVALUE.
025200     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
025300     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
025400        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
025500          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
025600     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
025700     MOVE SPACE TO CORRECT-X.
025800     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
025900     MOVE     SPACE TO RE-MARK.
026000 HEAD-ROUTINE.
026100     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026200     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026300     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
026400     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
026500 COLUMN-NAMES-ROUTINE.
026600     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026700     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
026900 END-ROUTINE.
027000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
027100 END-RTN-EXIT.
027200     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027300 END-ROUTINE-1.
027400      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
027500      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
027600      ADD PASS-COUNTER TO ERROR-HOLD.
027700*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
027800      MOVE PASS-COUNTER TO CCVS-E-4-1.
027900      MOVE ERROR-HOLD TO CCVS-E-4-2.
028000      MOVE CCVS-E-4 TO CCVS-E-2-2.
028100      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
028200  END-ROUTINE-12.
028300      MOVE "TEST(S) FAILED" TO ENDER-DESC.
028400     IF       ERROR-COUNTER IS EQUAL TO ZERO
028500         MOVE "NO " TO ERROR-TOTAL
028600         ELSE
028700         MOVE ERROR-COUNTER TO ERROR-TOTAL.
028800     MOVE     CCVS-E-2 TO DUMMY-RECORD.
028900     PERFORM WRITE-LINE.
029000 END-ROUTINE-13.
029100     IF DELETE-COUNTER IS EQUAL TO ZERO
029200         MOVE "NO " TO ERROR-TOTAL  ELSE
029300         MOVE DELETE-COUNTER TO ERROR-TOTAL.
029400     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
029500     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029600      IF   INSPECT-COUNTER EQUAL TO ZERO
029700          MOVE "NO " TO ERROR-TOTAL
029800      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
029900      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
030000      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030100     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030200 WRITE-LINE.
030300     ADD 1 TO RECORD-COUNT.
030400Y    IF RECORD-COUNT GREATER 42
030500Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
030600Y        MOVE SPACE TO DUMMY-RECORD
030700Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
030800Y        MOVE CCVS-H-1  TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
030900Y        MOVE CCVS-H-2A TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
031000Y        MOVE CCVS-H-2B TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
031100Y        MOVE CCVS-H-3  TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
031200Y        MOVE CCVS-C-1  TO DUMMY-RECORD  PERFORM WRT-LN
031300Y        MOVE CCVS-C-2  TO DUMMY-RECORD  PERFORM WRT-LN
031400Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
031500Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
031600Y        MOVE ZERO TO RECORD-COUNT.
031700     PERFORM WRT-LN.
031800 WRT-LN.
031900     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
032000     MOVE SPACE TO DUMMY-RECORD.
032100 BLANK-LINE-PRINT.
032200     PERFORM WRT-LN.
032300 FAIL-ROUTINE.
032400     IF     COMPUTED-X NOT EQUAL TO SPACE
032500            GO TO FAIL-ROUTINE-WRITE.
032600     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
032700     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
032800     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
032900     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033000     MOVE   SPACES TO INF-ANSI-REFERENCE.
033100     GO TO  FAIL-ROUTINE-EX.
033200 FAIL-ROUTINE-WRITE.
033300     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
033400     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
033500     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
033600     MOVE   SPACES TO COR-ANSI-REFERENCE.
033700 FAIL-ROUTINE-EX. EXIT.
033800 BAIL-OUT.
033900     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
034000     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
034100 BAIL-OUT-WRITE.
034200     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
034300     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
034400     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034500     MOVE   SPACES TO INF-ANSI-REFERENCE.
034600 BAIL-OUT-EX. EXIT.
034700 CCVS1-EXIT.
034800     EXIT.
034900 BUILD-TABLE1.
035000     MOVE WC-XN-83 TO TABLE1-REC (1).
035100     MOVE WC-XN-83 TO TABLE1-REC (2).
035200     MOVE WC-XN-83 TO TABLE1-REC (3).
035300     MOVE WC-XN-83 TO TABLE1-REC (4).
035400 BUILD-TABLE3.
035500     MOVE " " TO TABLE3-SYMBOL (1).
035600     MOVE "," TO TABLE3-SYMBOL (2).
035700     MOVE "-" TO TABLE3-SYMBOL (3).
035800 BUILD-TABLE4.
035900     MOVE "A" TO TABLE4-LETTER (1).
036000     MOVE "D" TO TABLE4-LETTER (2).
036100     MOVE "G" TO TABLE4-LETTER (3).
036200     MOVE "H" TO TABLE4-LETTER (4).
036300     MOVE "L" TO TABLE4-LETTER (5).
036400     MOVE "O" TO TABLE4-LETTER (6).
036500     MOVE "Y" TO TABLE4-LETTER (7).
036600     MOVE "S" TO TABLE4-LETTER (8).
036700     MOVE "Z" TO TABLE4-LETTER (9).
036800 IND-INIT-GF-1.
036900     MOVE "IV-21 4.3.8.2.3/4" TO ANSI-REFERENCE.
037000     MOVE ZERO TO TABLE2.
037100     SET INDEX1 TO 1.
037200     SET INDEX2 TO 1.
037300 IND-TEST-GF-1-0.
037400     INSPECT TABLE1-REC (INDEX1) TALLYING WRK-DU-999 (INDEX2)
037500        FOR CHARACTERS.
037600 IND-TEST-GF-1-1.
037700     IF WRK-DU-999 (INDEX2) EQUAL TO 83
037800        PERFORM PASS
037900        GO TO IND-WRITE-GF-1.
038000     GO TO IND-FAIL-GF-1.
038100 IND-DELETE-GF-1.
038200     PERFORM DE-LETE.
038300     GO TO IND-WRITE-GF-1.
038400 IND-FAIL-GF-1.
038500     PERFORM FAIL.
038600     MOVE WRK-DU-999 (INDEX2) TO COMPUTED-N.
038700     MOVE 83 TO CORRECT-N.
038800 IND-WRITE-GF-1.
038900     MOVE "IND-TEST-GF-1" TO PAR-NAME.
039000     MOVE "TALLY FOR CHARACTERS" TO FEATURE.
039100     PERFORM PRINT-DETAIL.
039200 IND-INIT-GF-2.
039300     MOVE "IV-21 4.3.8.2.3/4" TO ANSI-REFERENCE.
039400     MOVE ZERO TO TABLE2.
039500     SET INDEX1 TO 2.
039600     SET INDEX2 TO 2.
039700     MOVE ZERO TO WRK-DU-999 (INDEX2).
039800 IND-TEST-GF-2-0.
039900     INSPECT TABLE1-REC (INDEX1) TALLYING WRK-DU-999 (INDEX2)
040000        FOR ALL "A".
040100 IND-TEST-GF-2-1.
040200     IF WRK-DU-999 (INDEX2) EQUAL TO 8
040300        PERFORM PASS
040400        GO TO IND-WRITE-GF-2.
040500     GO TO IND-FAIL-GF-2.
040600 IND-DELETE-GF-2.
040700     PERFORM DE-LETE.
040800     GO TO IND-WRITE-GF-2.
040900 IND-FAIL-GF-2.
041000     PERFORM FAIL.
041100     MOVE WRK-DU-999 (INDEX2) TO COMPUTED-N.
041200     MOVE 8 TO CORRECT-N.
041300 IND-WRITE-GF-2.
041400     MOVE "IND-TEST-GF-2" TO PAR-NAME.
041500     MOVE "TALLY FOR LITERAL" TO FEATURE.
041600     PERFORM PRINT-DETAIL.
041700 IND-INIT-GF-3.
041800     MOVE "IV-21 4.3.8.2.3/4" TO ANSI-REFERENCE.
041900     MOVE ZERO TO TABLE2.
042000     SET INDEX1 TO 3.
042100     SET INDEX2 TO 3.
042200     MOVE ZERO TO WRK-DU-999 (INDEX2).
042300 IND-TEST-GF-3-0.
042400     INSPECT TABLE1-REC (INDEX1) TALLYING WRK-DU-999 (INDEX2)
042500        FOR ALL SPACE.
042600 IND-TEST-GF-3-1.
042700     IF WRK-DU-999 (INDEX2) EQUAL TO 17
042800        PERFORM PASS
042900        GO TO IND-WRITE-GF-3.
043000     GO TO IND-FAIL-GF-3.
043100 IND-DELETE-GF-3.
043200     PERFORM DE-LETE.
043300     GO TO IND-WRITE-GF-3.
043400 IND-FAIL-GF-3.
043500     PERFORM FAIL.
043600     MOVE WRK-DU-999 (INDEX2) TO COMPUTED-N.
043700     MOVE 17 TO CORRECT-N.
043800 IND-WRITE-GF-3.
043900     MOVE "IND-TEST-GF-3" TO PAR-NAME.
044000     MOVE "TALLY FOR ALL SPACE" TO FEATURE.
044100     PERFORM PRINT-DETAIL.
044200 IND-INIT-GF-4.
044300     MOVE "IV-21 4.3.8.2.3/4" TO ANSI-REFERENCE.
044400     MOVE ZERO TO TABLE2.
044500     SET INDEX1 TO 4.
044600     SET INDEX2 TO 4.
044700     MOVE ZERO TO WRK-DU-999 (INDEX2).
044800 IND-TEST-GF-4-0.
044900     INSPECT TABLE1-REC (INDEX1) TALLYING WRK-DU-999 (INDEX2)
045000        FOR LEADING "A".
045100 IND-TEST-GF-4-1.
045200     IF WRK-DU-999 (INDEX2) EQUAL TO 1
045300        PERFORM PASS
045400        GO TO IND-WRITE-GF-4.
045500     GO TO IND-FAIL-GF-4.
045600 IND-DELETE-GF-4.
045700     PERFORM DE-LETE.
045800     GO TO IND-WRITE-GF-4.
045900 IND-FAIL-GF-4.
046000     PERFORM FAIL.
046100     MOVE WRK-DU-999 (INDEX2) TO COMPUTED-N.
046200     MOVE 1 TO CORRECT-N.
046300 IND-WRITE-GF-4.
046400     MOVE "IND-TEST-GF-4" TO PAR-NAME.
046500     MOVE "TALLY LEADING LIT." TO FEATURE.
046600     PERFORM PRINT-DETAIL.
046700 IND-INIT-GF-5.
046800     MOVE "IV-21 4.3.8.2.3/4" TO ANSI-REFERENCE.
046900     SET INDEX1 TO 1.
047000     SET INDEX2 TO 2.
047100     MOVE ZERO TO TABLE2.
047200     MOVE ZERO TO WRK-DU-999 (INDEX2 + 1).
047300 IND-TEST-GF-5-0.
047400     INSPECT TABLE1-REC (INDEX1 + 1) TALLYING
047500        WRK-DU-999 (INDEX2 + 1)
047600        FOR CHARACTERS AFTER "W".
047700 IND-TEST-GF-5-1.
047800     IF WRK-DU-999 (INDEX2 + 1) EQUAL TO 68
047900        PERFORM PASS
048000        GO TO IND-WRITE-GF-5.
048100     GO TO IND-FAIL-GF-5.
048200 IND-DELETE-GF-5.
048300     PERFORM DE-LETE.
048400     GO TO IND-WRITE-GF-5.
048500 IND-FAIL-GF-5.
048600     PERFORM FAIL.
048700     MOVE WRK-DU-999 (INDEX2 + 1) TO COMPUTED-N.
048800     MOVE 68 TO CORRECT-N.
048900 IND-WRITE-GF-5.
049000     MOVE "IND-TEST-GF-5" TO PAR-NAME.
049100     MOVE "FOR CHARS AFTER LIT." TO FEATURE.
049200     PERFORM PRINT-DETAIL.
049300 IND-INIT-GF-6.
049400     MOVE "IV-21 4.3.8.2.3/4" TO ANSI-REFERENCE.
049500     MOVE ZERO TO TABLE2.
049600     SET INDEX1 TO 3.
049700     SET INDEX2 TO 4.
049800     MOVE ZERO TO WRK-DU-999 (INDEX2 - 2).
049900 IND-TEST-GF-6-0.
050000     INSPECT TABLE1-REC (INDEX1 - 1)
050100        TALLYING WRK-DU-999 (INDEX2 - 2)
050200        FOR ALL " " BEFORE INITIAL "W".
050300 IND-TEST-GF-6-1.
050400     IF WRK-DU-999 (INDEX2 - 2) EQUAL TO 4
050500        PERFORM PASS
050600        GO TO IND-WRITE-GF-6.
050700     GO TO IND-FAIL-GF-6.
050800 IND-DELETE-GF-6.
050900     PERFORM DE-LETE.
051000     GO TO IND-WRITE-GF-6.
051100 IND-FAIL-GF-6.
051200     PERFORM FAIL.
051300     MOVE WRK-DU-999 (INDEX2 - 2) TO COMPUTED-N.
051400     MOVE 4 TO CORRECT-N.
051500 IND-WRITE-GF-6.
051600     MOVE "IND-TEST-GF-6" TO PAR-NAME.
051700     MOVE "ALL BEFORE INITIAL" TO FEATURE.
051800     PERFORM PRINT-DETAIL.
051900 IND-INIT-GF-7.
052000     MOVE "IV-21 4.3.8.2.3/4" TO ANSI-REFERENCE.
052100     MOVE ZERO TO TABLE2.
052200     SET INDEX1 TO 1.
052300     SET INDEX2 TO 1.
052400     MOVE ZERO TO WRK-DU-999 (INDEX2).
052500 IND-TEST-GF-7-0.
052600     INSPECT TABLE1-REC (INDEX1) TALLYING WRK-DU-999 (INDEX2)
052700        FOR LEADING "Y" AFTER INITIAL SPACE.
052800 IND-TEST-GF-7-1.
052900     IF WRK-DU-999 (INDEX2) EQUAL TO 1
053000        PERFORM PASS
053100        GO TO IND-WRITE-GF-7.
053200     GO TO IND-FAIL-GF-7.
053300 IND-DELETE-GF-7.
053400     PERFORM DE-LETE.
053500     GO TO IND-WRITE-GF-7.
053600 IND-FAIL-GF-7.
053700     PERFORM FAIL.
053800     MOVE WRK-DU-999 (INDEX2) TO COMPUTED-N.
053900     MOVE 1 TO CORRECT-N.
054000 IND-WRITE-GF-7.
054100     MOVE "IND-TEST-GF-7" TO PAR-NAME.
054200     MOVE "LEAD. LIT. INITIAL" TO FEATURE.
054300     PERFORM PRINT-DETAIL.
054400 IND-INIT-GF-8.
054500     MOVE "IV-21 4.3.8.2.3/4" TO ANSI-REFERENCE.
054600     PERFORM BUILD-TABLE1.
054700     SET INDEX1 TO 1.
054800 IND-TEST-GF-8-0.
054900     INSPECT TABLE1-REC (INDEX1) REPLACING CHARACTERS BY SPACE.
055000 IND-TEST-GF-8-1.
055100     IF TABLE1-REC (INDEX1) EQUAL TO SPACE
055200        PERFORM PASS
055300        GO TO IND-WRITE-GF-8.
055400     GO TO IND-FAIL-GF-8.
055500 IND-DELETE-GF-8.
055600     PERFORM DE-LETE.
055700     GO TO IND-WRITE-GF-8.
055800 IND-FAIL-GF-8.
055900     PERFORM FAIL.
056000     MOVE TABLE1-REC (INDEX1) TO COMPUTED-A.
056100     MOVE "SPACES" TO CORRECT-A.
056200 IND-WRITE-GF-8.
056300     MOVE "IND-TEST-GF-8" TO PAR-NAME.
056400     MOVE "REP. CHARS BY SPACE" TO FEATURE.
056500     PERFORM PRINT-DETAIL.
056600 IND-INIT-GF-9.
056700     MOVE "IV-21 4.3.8.2.3/4" TO ANSI-REFERENCE.
056800     PERFORM BUILD-TABLE1.
056900     SET INDEX1 TO 2.
057000 IND-TEST-GF-9-0.
057100     INSPECT TABLE1-REC (INDEX1) REPLACING CHARACTERS
057200        BY "O" BEFORE INITIAL "H".
057300 IND-TEST-GF-9-1.
057400     IF TABLE1-REC (INDEX1) EQUAL TO ANS-XN-83-1
057500        PERFORM PASS
057600        GO TO IND-WRITE-GF-9.
057700     GO TO IND-FAIL-GF-9.
057800 IND-DELETE-GF-9.
057900     PERFORM DE-LETE.
058000     GO TO IND-WRITE-GF-9.
058100 IND-FAIL-GF-9.
058200     PERFORM FAIL.
058300     MOVE    TABLE1-REC (INDEX1) TO WRK-ER.
058400     MOVE    ANS-XN-83-1 TO WRK-OK.
058500     MOVE    WRK-OK-1-20 TO CORRECT-X.
058600     MOVE    WRK-ER-1-20 TO COMPUTED-X.
058700     PERFORM PRINT-DETAIL.
058800     MOVE    WRK-OK-21-40 TO CORRECT-X.
058900     MOVE    WRK-ER-21-40 TO COMPUTED-X.
059000     PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
059100     MOVE    WRK-OK-41-60 TO CORRECT-X.
059200     MOVE    WRK-ER-41-60 TO COMPUTED-X.
059300     PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
059400     MOVE    WRK-OK-61-80 TO CORRECT-X.
059500     MOVE    WRK-ER-61-80 TO COMPUTED-X.
059600     PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
059700     MOVE    WRK-OK-81-83 TO CORRECT-X.
059800     MOVE    WRK-ER-81-83 TO COMPUTED-X.
059900     PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
060000 IND-WRITE-GF-9.
060100     MOVE "IND-TEST-GF-9" TO PAR-NAME.
060200     MOVE "CHARS BEFORE INITIAL" TO FEATURE.
060300     PERFORM PRINT-DETAIL.
060400 IND-INIT-GF-10.
060500     MOVE "IV-21 4.3.8.2.3/4" TO ANSI-REFERENCE.
060600     PERFORM BUILD-TABLE1.
060700     SET INDEX1 TO 3.
060800     SET INDEX3 TO 1.
060900     SET INDEX4 TO 8.
061000 IND-TEST-GF-10-0.
061100     INSPECT TABLE1-REC (INDEX1) REPLACING LEADING
061200        TABLE3-SYMBOL (INDEX3) BY TABLE3-SYMBOL (INDEX3 + 1)
061300        AFTER INITIAL TABLE4-LETTER (INDEX4).
061400 IND-TEST-GF-10-1.
061500     IF TABLE1-REC (INDEX1) EQUAL TO ANS-XN-83-2
061600        PERFORM PASS
061700        GO TO IND-WRITE-GF-10.
061800     GO TO IND-FAIL-GF-10.
061900 IND-DELETE-GF-10.
062000     PERFORM DE-LETE.
062100     GO TO IND-WRITE-GF-10.
062200 IND-FAIL-GF-10.
062300     PERFORM FAIL.
062400     MOVE    TABLE1-REC (INDEX1) TO WRK-ER.
062500     MOVE    ANS-XN-83-2 TO WRK-OK.
062600     MOVE    WRK-OK-1-20 TO CORRECT-X.
062700     MOVE    WRK-ER-1-20 TO COMPUTED-X.
062800     PERFORM PRINT-DETAIL.
062900     MOVE    WRK-OK-21-40 TO CORRECT-X.
063000     MOVE    WRK-ER-21-40 TO COMPUTED-X.
063100     PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
063200     MOVE    WRK-OK-41-60 TO CORRECT-X.
063300     MOVE    WRK-ER-41-60 TO COMPUTED-X.
063400     PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
063500     MOVE    WRK-OK-61-80 TO CORRECT-X.
063600     MOVE    WRK-ER-61-80 TO COMPUTED-X.
063700     PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
063800     MOVE    WRK-OK-81-83 TO CORRECT-X.
063900     MOVE    WRK-ER-81-83 TO COMPUTED-X.
064000     PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
064100 IND-WRITE-GF-10.
064200     MOVE "IND-TEST-GF-10" TO PAR-NAME.
064300     MOVE "LEAD. AFTER INIT. ID" TO FEATURE.
064400     PERFORM PRINT-DETAIL.
064500 IND-INIT-GF-11.
064600     MOVE "IV-21 4.3.8.2.3/4" TO ANSI-REFERENCE.
064700     PERFORM BUILD-TABLE1.
064800     SET INDEX1 TO 4.
064900     SET INDEX4 TO 6.
065000 IND-TEST-GF-11-0.
065100     INSPECT TABLE1-REC (INDEX1) REPLACING FIRST "A"
065200        BY TABLE4-LETTER (INDEX4) BEFORE INITIAL "H".
065300 IND-TEST-GF-11-1.
065400     IF TABLE1-REC (INDEX1) EQUAL TO ANS-XN-83-1
065500        PERFORM PASS
065600        GO TO IND-WRITE-GF-11.
065700     GO TO IND-FAIL-GF-11.
065800 IND-DELETE-GF-11.
065900     PERFORM DE-LETE.
066000     GO TO IND-WRITE-GF-11.
066100 IND-FAIL-GF-11.
066200     PERFORM FAIL.
066300     MOVE    TABLE1-REC (INDEX1) TO WRK-ER.
066400     MOVE    ANS-XN-83-1 TO WRK-OK.
066500     MOVE    WRK-OK-1-20 TO CORRECT-X.
066600     MOVE    WRK-ER-1-20 TO COMPUTED-X.
066700     PERFORM PRINT-DETAIL.
066800     MOVE    WRK-OK-21-40 TO CORRECT-X.
066900     MOVE    WRK-ER-21-40 TO COMPUTED-X.
067000     PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
067100     MOVE    WRK-OK-41-60 TO CORRECT-X.
067200     MOVE    WRK-ER-41-60 TO COMPUTED-X.
067300     PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
067400     MOVE    WRK-OK-61-80 TO CORRECT-X.
067500     MOVE    WRK-ER-61-80 TO COMPUTED-X.
067600     PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
067700     MOVE    WRK-OK-81-83 TO CORRECT-X.
067800     MOVE    WRK-ER-81-83 TO COMPUTED-X.
067900     PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
068000 IND-WRITE-GF-11.
068100     MOVE "IND-TEST-GF-11" TO PAR-NAME.
068200     MOVE "FIRST BY ID BEFORE" TO FEATURE.
068300     PERFORM PRINT-DETAIL.
068400 IND-INIT-GF-12.
068500     MOVE "IV-21 4.3.8.2.3/4" TO ANSI-REFERENCE.
068600     PERFORM BUILD-TABLE1.
068700     SET INDEX1 TO 1.
068800     SET INDEX3 TO 1.
068900     SET INDEX4 TO 5.
069000 IND-TEST-GF-12-0.
069100     INSPECT TABLE1-REC (INDEX1 + 1) REPLACING ALL
069200      TABLE3-SYMBOL (INDEX3) BY "-" AFTER TABLE4-LETTER (INDEX4).
069300 IND-TEST-GF-12-1.
069400     IF TABLE1-REC (INDEX1 + 1) EQUAL TO ANS-XN-83-3
069500        PERFORM PASS
069600        GO TO IND-WRITE-GF-12.
069700     GO TO IND-FAIL-GF-12.
069800 IND-DELETE-GF-12.
069900     PERFORM DE-LETE.
070000     GO TO IND-WRITE-GF-12.
070100 IND-FAIL-GF-12.
070200     PERFORM FAIL.
070300     MOVE    TABLE1-REC (INDEX1 + 1) TO WRK-ER.
070400     MOVE    ANS-XN-83-3 TO WRK-OK.
070500     MOVE    WRK-OK-1-20 TO CORRECT-X.
070600     MOVE    WRK-ER-1-20 TO COMPUTED-X.
070700     PERFORM PRINT-DETAIL.
070800     MOVE    WRK-OK-21-40 TO CORRECT-X.
070900     MOVE    WRK-ER-21-40 TO COMPUTED-X.
071000     PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
071100     MOVE    WRK-OK-41-60 TO CORRECT-X.
071200     MOVE    WRK-ER-41-60 TO COMPUTED-X.
071300     PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
071400     MOVE    WRK-OK-61-80 TO CORRECT-X.
071500     MOVE    WRK-ER-61-80 TO COMPUTED-X.
071600     PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
071700     MOVE    WRK-OK-81-83 TO CORRECT-X.
071800     MOVE    WRK-ER-81-83 TO COMPUTED-X.
071900     PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
072000 IND-WRITE-GF-12.
072100     MOVE "IND-TEST-GF-12" TO PAR-NAME.
072200     MOVE "ALL ID BY LIT. AFTER" TO FEATURE.
072300     PERFORM PRINT-DETAIL.
072400 IND-INIT-GF-13.
072500     MOVE "IV-21 4.3.8.2.3/4" TO ANSI-REFERENCE.
072600     MOVE "IND-TEST-GF-13" TO PAR-NAME.
072700     MOVE "TALLY REPLACE CHARS" TO FEATURE.
072800     MOVE 1 TO REC-CT.
072900     PERFORM BUILD-TABLE1.
073000     MOVE ZERO TO TABLE2.
073100     SET INDEX1 TO 1.
073200     SET INDEX2 TO 1.
073300     MOVE 0 TO WRK-DU-999 (INDEX2).
073400 IND-TEST-GF-13-0.
073500     INSPECT TABLE1-REC (INDEX1) TALLYING WRK-DU-999 (INDEX2)
073600        FOR CHARACTERS REPLACING CHARACTERS BY " ".
073700     GO TO IND-TEST-GF-13-1.
073800 IND-DELETE-GF-13.
073900     PERFORM DE-LETE.
074000     PERFORM PRINT-DETAIL.
074100     GO TO IND-INIT-GF-14.
074200 IND-TEST-GF-13-1.
074300     IF WRK-DU-999 (INDEX2) EQUAL TO 83
074400        PERFORM PASS
074500        PERFORM PRINT-DETAIL
074600        ELSE PERFORM FAIL
074700        MOVE WRK-DU-999 (INDEX2) TO COMPUTED-N
074800        MOVE 83 TO CORRECT-N
074900        PERFORM PRINT-DETAIL.
075000     ADD 1 TO REC-CT.
075100 IND-TEST-GF-13-2.
075200     IF TABLE1-REC (INDEX1) EQUAL TO SPACE
075300        PERFORM PASS
075400        PERFORM PRINT-DETAIL
075500     ELSE
075600         PERFORM FAIL
075700         MOVE    TABLE1-REC (INDEX1) TO WRK-ER
075800         MOVE    SPACES TO WRK-OK
075900         MOVE    WRK-OK-1-20 TO CORRECT-X
076000         MOVE    WRK-ER-1-20 TO COMPUTED-X
076100         PERFORM PRINT-DETAIL
076200         MOVE    WRK-OK-21-40 TO CORRECT-X
076300         MOVE    WRK-ER-21-40 TO COMPUTED-X
076400         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX
076500         MOVE    WRK-OK-41-60 TO CORRECT-X
076600         MOVE    WRK-ER-41-60 TO COMPUTED-X
076700         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX
076800         MOVE    WRK-OK-61-80 TO CORRECT-X
076900         MOVE    WRK-ER-61-80 TO COMPUTED-X
077000         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX
077100         MOVE    WRK-OK-81-83 TO CORRECT-X
077200         MOVE    WRK-ER-81-83 TO COMPUTED-X
077300         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
077400 IND-INIT-GF-14.
077500     MOVE "IV-21 4.3.8.2.3/4" TO ANSI-REFERENCE.
077600     MOVE "IND-TEST-GF-14" TO PAR-NAME.
077700     MOVE "LIT. BY BEFORE INIT." TO FEATURE.
077800     MOVE 1 TO REC-CT.
077900     PERFORM BUILD-TABLE1.
078000     MOVE ZERO TO TABLE2.
078100     SET INDEX1 TO 4.
078200     SET INDEX2 TO 2.
078300     SET INDEX4 TO 5.
078400 IND-TEST-GF-14-0.
078500     INSPECT TABLE1-REC (INDEX1 - 2) TALLYING
078600        WRK-DU-999 (INDEX2 + 2) FOR CHARACTERS
078700        AFTER TABLE4-LETTER (INDEX4 - 1) REPLACING ALL
078800        "A" BY "E" BEFORE INITIAL TABLE4-LETTER (INDEX4).
078900     GO TO IND-TEST-GF-14-1.
079000 IND-DELETE-GF-14.
079100     PERFORM DE-LETE.
079200     PERFORM PRINT-DETAIL.
079300     GO TO IND-INIT-GF-15.
079400 IND-TEST-GF-14-1.
079500     IF WRK-DU-999 (INDEX2 + 2) EQUAL TO 81
079600        PERFORM PASS
079700        PERFORM PRINT-DETAIL
079800        ELSE PERFORM FAIL
079900        MOVE WRK-DU-999 (INDEX2 + 2) TO COMPUTED-N
080000        MOVE 6 TO CORRECT-N
080100        PERFORM PRINT-DETAIL.
080200     ADD 1 TO REC-CT.
080300 IND-TEST-GF-14-2.
080400     IF TABLE1-REC (INDEX1 - 2) EQUAL TO ANS-XN-83-4
080500        PERFORM PASS
080600        PERFORM PRINT-DETAIL
080700     ELSE
080800        PERFORM FAIL
080900         MOVE    TABLE1-REC (INDEX1 - 2) TO WRK-ER
081000         MOVE    ANS-XN-83-4 TO WRK-OK
081100         MOVE    WRK-OK-1-20 TO CORRECT-X
081200         MOVE    WRK-ER-1-20 TO COMPUTED-X
081300         PERFORM PRINT-DETAIL
081400         MOVE    WRK-OK-21-40 TO CORRECT-X
081500         MOVE    WRK-ER-21-40 TO COMPUTED-X
081600         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX
081700         MOVE    WRK-OK-41-60 TO CORRECT-X
081800         MOVE    WRK-ER-41-60 TO COMPUTED-X
081900         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX
082000         MOVE    WRK-OK-61-80 TO CORRECT-X
082100         MOVE    WRK-ER-61-80 TO COMPUTED-X
082200         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX
082300         MOVE    WRK-OK-81-83 TO CORRECT-X
082400         MOVE    WRK-ER-81-83 TO COMPUTED-X
082500         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
082600 IND-INIT-GF-15.
082700     MOVE "IV-21 4.3.8.2.3/4" TO ANSI-REFERENCE.
082800     MOVE "IND-TEST-GF-15" TO PAR-NAME.
082900     MOVE "REPL. FIRST AFTER" TO FEATURE.
083000     MOVE 1 TO REC-CT.
083100     PERFORM BUILD-TABLE1.
083200     MOVE ZERO TO TABLE2.
083300     SET INDEX1 TO 1.
083400     SET INDEX2 TO 1.
083500     SET INDEX4 TO 4.
083600     MOVE 0 TO WRK-DU-999 (INDEX2).
083700 IND-TEST-GF-15-0.
083800     INSPECT TABLE1-REC (INDEX1) TALLYING WRK-DU-999 (INDEX2)
083900        FOR ALL "A" BEFORE TABLE4-LETTER (INDEX4 + 1)
084000        REPLACING FIRST TABLE4-LETTER (INDEX4 - 3)
084100        BY "O" AFTER INITIAL TABLE4-LETTER (INDEX4).
084200     GO TO IND-TEST-GF-15-1.
084300 IND-DELETE-GF-15.
084400     PERFORM DE-LETE.
084500     PERFORM PRINT-DETAIL.
084600     GO TO IND-INIT-GF-16.
084700 IND-TEST-GF-15-1.
084800     IF WRK-DU-999 (INDEX2) EQUAL TO 7
084900        PERFORM PASS
085000        PERFORM PRINT-DETAIL
085100        ELSE PERFORM FAIL
085200        MOVE WRK-DU-999 (INDEX2) TO COMPUTED-N
085300        MOVE 7 TO CORRECT-N
085400        PERFORM PRINT-DETAIL.
085500     ADD 1 TO REC-CT.
085600 IND-TEST-GF-15-2.
085700     IF TABLE1-REC (INDEX1) EQUAL TO ANS-XN-83-5
085800        PERFORM PASS
085900        PERFORM PRINT-DETAIL
086000        ELSE
086100         PERFORM FAIL
086200         MOVE    TABLE1-REC (INDEX1) TO WRK-ER
086300         MOVE    ANS-XN-83-5 TO WRK-OK
086400         MOVE    WRK-OK-1-20 TO CORRECT-X
086500         MOVE    WRK-ER-1-20 TO COMPUTED-X
086600         PERFORM PRINT-DETAIL
086700         MOVE    WRK-OK-21-40 TO CORRECT-X
086800         MOVE    WRK-ER-21-40 TO COMPUTED-X
086900         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX
087000         MOVE    WRK-OK-41-60 TO CORRECT-X
087100         MOVE    WRK-ER-41-60 TO COMPUTED-X
087200         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX
087300         MOVE    WRK-OK-61-80 TO CORRECT-X
087400         MOVE    WRK-ER-61-80 TO COMPUTED-X
087500         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX
087600         MOVE    WRK-OK-81-83 TO CORRECT-X
087700         MOVE    WRK-ER-81-83 TO COMPUTED-X
087800         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
087900 IND-INIT-GF-16.
088000     MOVE "IV-21 4.3.8.2.3/4" TO ANSI-REFERENCE.
088100     MOVE "IND-TEST-GF-16" TO PAR-NAME.
088200     MOVE "FOR LEADING" TO FEATURE.
088300     MOVE 1 TO REC-CT.
088400     PERFORM BUILD-TABLE1.
088500     MOVE ZERO TO TABLE2.
088600     SET INDEX1 TO 2.
088700     SET INDEX2 TO 2.
088800     SET INDEX4 TO 1.
088900     MOVE 0 TO WRK-DU-999 (INDEX2).
089000 IND-TEST-GF-16-0.
089100     INSPECT TABLE1-REC (INDEX1) TALLYING WRK-DU-999 (INDEX2)
089200        FOR LEADING TABLE4-LETTER (INDEX4) REPLACING
089300        LEADING TABLE4-LETTER (INDEX4) BY "O".
089400     GO TO IND-TEST-GF-16-1.
089500 IND-DELETE-GF-16.
089600     PERFORM DE-LETE.
089700     PERFORM PRINT-DETAIL.
089800     GO TO IND-INIT-GF-17.
089900 IND-TEST-GF-16-1.
090000     IF WRK-DU-999 (INDEX2) EQUAL TO 1
090100        PERFORM PASS
090200        PERFORM PRINT-DETAIL
090300        ELSE PERFORM FAIL
090400        MOVE WRK-DU-999 (INDEX2) TO COMPUTED-N
090500        MOVE 1 TO CORRECT-N
090600        PERFORM PRINT-DETAIL.
090700     ADD 1 TO REC-CT.
090800 IND-TEST-GF-16-2.
090900     IF TABLE1-REC (INDEX1) EQUAL TO ANS-XN-83-1
091000        PERFORM PASS
091100        PERFORM PRINT-DETAIL
091200        ELSE
091300         PERFORM FAIL
091400         MOVE    TABLE1-REC (INDEX1) TO WRK-ER
091500         MOVE    ANS-XN-83-1 TO WRK-OK
091600         MOVE    WRK-OK-1-20 TO CORRECT-X
091700         MOVE    WRK-ER-1-20 TO COMPUTED-X
091800         PERFORM PRINT-DETAIL
091900         MOVE    WRK-OK-21-40 TO CORRECT-X
092000         MOVE    WRK-ER-21-40 TO COMPUTED-X
092100         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX
092200         MOVE    WRK-OK-41-60 TO CORRECT-X
092300         MOVE    WRK-ER-41-60 TO COMPUTED-X
092400         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX
092500         MOVE    WRK-OK-61-80 TO CORRECT-X
092600         MOVE    WRK-ER-61-80 TO COMPUTED-X
092700         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX
092800         MOVE    WRK-OK-81-83 TO CORRECT-X
092900         MOVE    WRK-ER-81-83 TO COMPUTED-X
093000         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
093100 IND-INIT-GF-17.
093200     MOVE "IV-21 4.3.8.2.3/4" TO ANSI-REFERENCE.
093300     MOVE "IND-TEST-GF-17" TO PAR-NAME.
093400     MOVE "LIT. BY AFTER INIT." TO FEATURE.
093500     MOVE 1 TO REC-CT.
093600     PERFORM BUILD-TABLE1.
093700     MOVE ZERO TO TABLE2.
093800     SET INDEX1 TO 3.
093900     SET INDEX2 TO 3.
094000     SET INDEX4 TO 7.
094100     MOVE 0 TO WRK-DU-999 (INDEX2).
094200 IND-TEST-GF-17-0.
094300     INSPECT TABLE1-REC (INDEX1) TALLYING WRK-DU-999 (INDEX2)
094400        FOR ALL "A" REPLACING FIRST "A" BY "O"
094500        AFTER INITIAL TABLE4-LETTER (INDEX4).
094600     GO TO IND-TEST-GF-17-1.
094700 IND-DELETE-GF-17.
094800     PERFORM DE-LETE.
094900     PERFORM PRINT-DETAIL.
095000     GO TO IND-INIT-GF-18.
095100 IND-TEST-GF-17-1.
095200     IF WRK-DU-999 (INDEX2) EQUAL TO 8
095300        PERFORM PASS
095400        PERFORM PRINT-DETAIL
095500        ELSE PERFORM FAIL
095600        MOVE WRK-DU-999 (INDEX2) TO COMPUTED-N
095700        MOVE 8 TO CORRECT-N
095800        PERFORM PRINT-DETAIL.
095900     ADD 1 TO REC-CT.
096000 IND-TEST-GF-17-2.
096100     IF TABLE1-REC (INDEX1) EQUAL TO ANS-XN-83-5
096200        PERFORM PASS
096300        PERFORM PRINT-DETAIL
096400        ELSE
096500         PERFORM FAIL
096600         MOVE    TABLE1-REC (INDEX1) TO WRK-ER
096700         MOVE    ANS-XN-83-1 TO WRK-OK
096800         MOVE    WRK-OK-1-20 TO CORRECT-X
096900         MOVE    WRK-ER-1-20 TO COMPUTED-X
097000         PERFORM PRINT-DETAIL
097100         MOVE    WRK-OK-21-40 TO CORRECT-X
097200         MOVE    WRK-ER-21-40 TO COMPUTED-X
097300         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX
097400         MOVE    WRK-OK-41-60 TO CORRECT-X
097500         MOVE    WRK-ER-41-60 TO COMPUTED-X
097600         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX
097700         MOVE    WRK-OK-61-80 TO CORRECT-X
097800         MOVE    WRK-ER-61-80 TO COMPUTED-X
097900         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX
098000         MOVE    WRK-OK-81-83 TO CORRECT-X
098100         MOVE    WRK-ER-81-83 TO COMPUTED-X
098200         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
098300 IND-INIT-GF-18.
098400     MOVE "IV-21 4.3.8.2.3/4" TO ANSI-REFERENCE.
098500     MOVE "IND-TEST-GF-18" TO PAR-NAME.
098600     MOVE "CHARS AFTER ALL BEF." TO FEATURE.
098700     MOVE 1 TO REC-CT.
098800     PERFORM BUILD-TABLE1.
098900     MOVE ZERO TO TABLE2.
099000     SET INDEX1 TO 4.
099100     SET INDEX2 TO 4.
099200     SET INDEX4 TO 1.
099300     MOVE 0 TO WRK-DU-999 (INDEX2).
099400 IND-TEST-GF-18-0.
099500     INSPECT TABLE1-REC (INDEX1) TALLYING WRK-DU-999 (INDEX2)
099600        FOR CHARACTERS AFTER TABLE4-LETTER (INDEX4)
099700        REPLACING ALL "A" BY "O"
099800        BEFORE TABLE4-LETTER (INDEX4 + 3).
099900     GO TO IND-TEST-GF-18-1.
100000 IND-DELETE-GF-18.
100100     PERFORM DE-LETE.
100200     PERFORM PRINT-DETAIL.
100300     GO TO CCVS-999999.
100400 IND-TEST-GF-18-1.
100500     IF WRK-DU-999 (INDEX2) EQUAL TO 82
100600        PERFORM PASS
100700        PERFORM PRINT-DETAIL
100800        ELSE PERFORM FAIL
100900        MOVE WRK-DU-999 (INDEX2) TO COMPUTED-N
101000        MOVE 82 TO CORRECT-N
101100        PERFORM PRINT-DETAIL.
101200     ADD 1 TO REC-CT.
101300 IND-TEST-GF-18-2.
101400     IF TABLE1-REC (INDEX1) EQUAL TO ANS-XN-83-1
101500        PERFORM PASS
101600        PERFORM PRINT-DETAIL
101700        ELSE
101800         PERFORM FAIL
101900         MOVE    TABLE1-REC (INDEX1) TO WRK-ER
102000         MOVE    ANS-XN-83-1 TO WRK-OK
102100         MOVE    WRK-OK-1-20 TO CORRECT-X
102200         MOVE    WRK-ER-1-20 TO COMPUTED-X
102300         PERFORM PRINT-DETAIL
102400         MOVE    WRK-OK-21-40 TO CORRECT-X
102500         MOVE    WRK-ER-21-40 TO COMPUTED-X
102600         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX
102700         MOVE    WRK-OK-41-60 TO CORRECT-X
102800         MOVE    WRK-ER-41-60 TO COMPUTED-X
102900         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX
103000         MOVE    WRK-OK-61-80 TO CORRECT-X
103100         MOVE    WRK-ER-61-80 TO COMPUTED-X
103200         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX
103300         MOVE    WRK-OK-81-83 TO CORRECT-X
103400         MOVE    WRK-ER-81-83 TO COMPUTED-X
103500         PERFORM FAIL-ROUTINE-WRITE THRU FAIL-ROUTINE-EX.
103600 CCVS-EXIT SECTION.
103700 CCVS-999999.
103800     GO TO CLOSE-FILES.
