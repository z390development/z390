000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ147A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 3.0.                                 *
000900*                                                              *
001000*    CREATION DATE     /     VALIDATION DATE                   *
001100*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001200*                                                              *
001300****************************************************************
001400*                                                              *
001500*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001600*                                                              *
001700*            X-14   SEQUENTIAL MASS STORAGE FILE.              *
001800*            X-55   SYSTEM PRINTER                             *
001900*            X-82   SOURCE-COMPUTER                            *
002000*            X-83   OBJECT-COMPUTER                            *
002100*            X-84   LABEL RECORDS OPTION.                      *
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    THIS PROGRAM CHECKS FOR THE CORRECT RESPONSE TO READING   *
002600*    A CLOSED FILE.  THE TEST FOR CORRECT I-O STATUS CODE 47   *
002700*    IS IN THE DECLARATIVES.  AN ABNORMAL TERMINATION IS       *
002800*    POSSIBLE AFTER THE TEST OF THE I-O STATUS CODE IS         *
002900*    ACCOMPLISHED BUT BEFORE CONTROL IS RETURNED TO THE MAIN   *
003000*    LINE CODE.                                                *
003100*                                                              *
003200****************************************************************
003300*
003400 ENVIRONMENT DIVISION.
003500 CONFIGURATION SECTION.
003600 SOURCE-COMPUTER.
003700     XXXXX082.
003800 OBJECT-COMPUTER.
003900     XXXXX083.
004000*
004100 INPUT-OUTPUT SECTION.
004200 FILE-CONTROL.
004300     SELECT PRINT-FILE ASSIGN TO
004400     XXXXX055.
004500*
004600     SELECT SQ-FS1 ASSIGN TO
004700     XXXXX014
004800            FILE STATUS SQ-FS1-STATUS.
004900*
005000*
005100 DATA DIVISION.
005200 FILE SECTION.
005300 FD  PRINT-FILE
005400C    LABEL RECORDS
005500C    XXXXX084
005600C    DATA RECORD IS PRINT-REC DUMMY-RECORD
005700               .
005800 01  PRINT-REC    PICTURE X(120).
005900 01  DUMMY-RECORD PICTURE X(120).
006000*
006100 FD  SQ-FS1
006200C    LABEL RECORD IS STANDARD
006300                .
006400 01  SQ-FS1R1-F-G-120 PIC X(120).
006500*
006600 WORKING-STORAGE SECTION.
006700*
006800***************************************************************
006900*                                                             *
007000*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
007100*                                                             *
007200***************************************************************
007300*
007400 01  SQ-FS1-STATUS.
007500   03  SQ-FS1-KEY-1   PIC X.
007600   03  SQ-FS1-KEY-2   PIC X.
007700*
007800*
007900***************************************************************
008000*                                                             *
008100*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
008200*                                                             *
008300***************************************************************
008400*
008500 01  REC-SKEL-SUB   PIC 99.
008600*
008700 01  FILE-RECORD-INFORMATION-REC.
008800     03 FILE-RECORD-INFO-SKELETON.
008900        05 FILLER                 PICTURE X(48)       VALUE
009000             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
009100        05 FILLER                 PICTURE X(46)       VALUE
009200             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
009300        05 FILLER                 PICTURE X(26)       VALUE
009400             ",LFIL=000000,ORG=  ,LBLR= ".
009500        05 FILLER                 PICTURE X(37)       VALUE
009600             ",RECKEY=                             ".
009700        05 FILLER                 PICTURE X(38)       VALUE
009800             ",ALTKEY1=                             ".
009900        05 FILLER                 PICTURE X(38)       VALUE
010000             ",ALTKEY2=                             ".
010100        05 FILLER                 PICTURE X(7)        VALUE SPACE.
010200     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
010300        05 FILE-RECORD-INFO-P1-120.
010400           07 FILLER              PIC X(5).
010500           07 XFILE-NAME          PIC X(6).
010600           07 FILLER              PIC X(8).
010700           07 XRECORD-NAME        PIC X(6).
010800           07 FILLER              PIC X(1).
010900           07 REELUNIT-NUMBER     PIC 9(1).
011000           07 FILLER              PIC X(7).
011100           07 XRECORD-NUMBER      PIC 9(6).
011200           07 FILLER              PIC X(6).
011300           07 UPDATE-NUMBER       PIC 9(2).
011400           07 FILLER              PIC X(5).
011500           07 ODO-NUMBER          PIC 9(4).
011600           07 FILLER              PIC X(5).
011700           07 XPROGRAM-NAME       PIC X(5).
011800           07 FILLER              PIC X(7).
011900           07 XRECORD-LENGTH      PIC 9(6).
012000           07 FILLER              PIC X(7).
012100           07 CHARS-OR-RECORDS    PIC X(2).
012200           07 FILLER              PIC X(1).
012300           07 XBLOCK-SIZE         PIC 9(4).
012400           07 FILLER              PIC X(6).
012500           07 RECORDS-IN-FILE     PIC 9(6).
012600           07 FILLER              PIC X(5).
012700           07 XFILE-ORGANIZATION  PIC X(2).
012800           07 FILLER              PIC X(6).
012900           07 XLABEL-TYPE         PIC X(1).
013000        05 FILE-RECORD-INFO-P121-240.
013100           07 FILLER              PIC X(8).
013200           07 XRECORD-KEY         PIC X(29).
013300           07 FILLER              PIC X(9).
013400           07 ALTERNATE-KEY1      PIC X(29).
013500           07 FILLER              PIC X(9).
013600           07 ALTERNATE-KEY2      PIC X(29).
013700           07 FILLER              PIC X(7).
013800*
013900 01  TEST-RESULTS.
014000     02 FILLER              PIC X      VALUE SPACE.
014100     02  PAR-NAME.
014200       03 FILLER              PIC X(14)  VALUE SPACE.
014300       03 PARDOT-X            PIC X      VALUE SPACE.
014400       03 DOTVALUE            PIC 99     VALUE ZERO.
014500     02 FILLER              PIC X      VALUE SPACE.
014600     02 FEATURE             PIC X(24)  VALUE SPACE.
014700     02 FILLER              PIC X      VALUE SPACE.
014800     02 P-OR-F              PIC X(5)   VALUE SPACE.
014900     02 FILLER              PIC X(9)   VALUE SPACE.
015000     02 RE-MARK             PIC X(61).
015100 01  TEST-COMPUTED.
015200   02 FILLER  PIC X(30)  VALUE SPACE.
015300   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
015400   02 COMPUTED-X.
015500     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
015600     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
015700     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
015800     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
015900     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
016000     03       CM-18V0 REDEFINES COMPUTED-A.
016100        04 COMPUTED-18V0                   PIC -9(18).
016200        04 FILLER                          PIC X.
016300     03 FILLER PIC X(50) VALUE SPACE.
016400 01  TEST-CORRECT.
016500     02 FILLER PIC X(30) VALUE SPACE.
016600     02 FILLER PIC X(17) VALUE "       CORRECT =".
016700     02 CORRECT-X.
016800     03 CORRECT-A                  PIC X(20) VALUE SPACE.
016900     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
017000     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
017100     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
017200     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
017300     03      CR-18V0 REDEFINES CORRECT-A.
017400         04 CORRECT-18V0                     PIC -9(18).
017500         04 FILLER                           PIC X.
017600     03 FILLER PIC X(2) VALUE SPACE.
017700     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
017800*
017900 01  CCVS-C-1.
018000     02 FILLER  PIC IS X        VALUE  SPACE.
018100     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
018200     02 FILLER  PIC IS X        VALUE  SPACE.
018300     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
018400     02 FILLER  PIC IS X        VALUE  SPACE.
018500     02 FILLER  PIC IS X(5)     VALUE "PASS ".
018600     02 FILLER  PIC IS X(9)     VALUE  SPACE.
018700     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
018800 01  CCVS-C-2.
018900     02 FILLER  PIC X(19)  VALUE  SPACE.
019000     02 FILLER  PIC X(6)   VALUE "TESTED".
019100     02 FILLER  PIC X(19)  VALUE  SPACE.
019200     02 FILLER  PIC X(4)   VALUE "FAIL".
019300     02 FILLER  PIC X(72)  VALUE  SPACE.
019400*
019500 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
019600 01  REC-CT            PIC 99       VALUE ZERO.
019700 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
019800 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
019900 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
020000 01  PASS-COUNTER      PIC 999      VALUE ZERO.
020100 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
020200 01  ERROR-HOLD        PIC 999      VALUE ZERO.
020300 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
020400 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
020500 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
020600 01  CCVS-H-1.
020700     02  FILLER          PIC X(39)    VALUE SPACES.
020800     02  FILLER          PIC X(42)    VALUE
020900     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
021000     02  FILLER          PIC X(39)    VALUE SPACES.
021100 01  CCVS-H-2A.
021200   02  FILLER            PIC X(40)  VALUE SPACE.
021300   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
021400   02  FILLER            PIC XXXX   VALUE
021500     "4.2 ".
021600   02  FILLER            PIC X(28)  VALUE
021700            " COPY - NOT FOR DISTRIBUTION".
021800   02  FILLER            PIC X(41)  VALUE SPACE.
021900*
022000 01  CCVS-H-2B.
022100   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
022200   02  TEST-ID           PIC X(9).
022300   02  FILLER            PIC X(4)   VALUE " IN ".
022400   02  FILLER            PIC X(12)  VALUE
022500     " HIGH       ".
022600   02  FILLER            PIC X(22)  VALUE
022700            " LEVEL VALIDATION FOR ".
022800   02  FILLER            PIC X(58)  VALUE
022900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
023000 01  CCVS-H-3.
023100     02  FILLER          PIC X(34)  VALUE
023200            " FOR OFFICIAL USE ONLY    ".
023300     02  FILLER          PIC X(58)  VALUE
023400     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
023500     02  FILLER          PIC X(28)  VALUE
023600            "  COPYRIGHT   1985,1986 ".
023700 01  CCVS-E-1.
023800     02 FILLER           PIC X(52)  VALUE SPACE.
023900     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
024000     02 ID-AGAIN         PIC X(9).
024100     02 FILLER           PIC X(45)  VALUE SPACES.
024200 01  CCVS-E-2.
024300     02  FILLER          PIC X(31)  VALUE SPACE.
024400     02  FILLER          PIC X(21)  VALUE SPACE.
024500     02  CCVS-E-2-2.
024600         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
024700         03 FILLER         PIC X      VALUE SPACE.
024800         03 ENDER-DESC     PIC X(44)  VALUE
024900            "ERRORS ENCOUNTERED".
025000 01  CCVS-E-3.
025100     02  FILLER          PIC X(22)  VALUE
025200            " FOR OFFICIAL USE ONLY".
025300     02  FILLER          PIC X(12)  VALUE SPACE.
025400     02  FILLER          PIC X(58)  VALUE
025500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025600     02  FILLER          PIC X(8)   VALUE SPACE.
025700     02  FILLER          PIC X(20)  VALUE
025800             " COPYRIGHT 1985,1986".
025900 01  CCVS-E-4.
026000     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
026100     02 FILLER           PIC X(4)   VALUE " OF ".
026200     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
026300     02 FILLER           PIC X(40)  VALUE
026400      "  TESTS WERE EXECUTED SUCCESSFULLY".
026500 01  XXINFO.
026600     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
026700     02 INFO-TEXT.
026800       04 FILLER             PIC X(8)   VALUE SPACE.
026900       04 XXCOMPUTED         PIC X(20).
027000       04 FILLER             PIC X(5)   VALUE SPACE.
027100       04 XXCORRECT          PIC X(20).
027200     02 INF-ANSI-REFERENCE PIC X(48).
027300 01  HYPHEN-LINE.
027400     02 FILLER  PIC IS X VALUE IS SPACE.
027500     02 FILLER  PIC IS X(65)    VALUE IS "************************
027600-    "*****************************************".
027700     02 FILLER  PIC IS X(54)    VALUE IS "************************
027800-    "******************************".
027900 01  CCVS-PGM-ID  PIC X(9)   VALUE
028000     "SQ147A".
028100*
028200*
028300 PROCEDURE DIVISION.
028400 DECLARATIVES.
028500 SQ147A-DECLARATIVE-001-SECT SECTION.
028600     USE AFTER STANDARD ERROR PROCEDURE SQ-FS1.
028700 SQ-FS1-ERROR-PROCEDURE.
028800     IF  SQ-FS1-STATUS = "47"
028900             PERFORM DECL-PASS
029000             GO TO DECL-ABNORMAL-TERM
029100     ELSE
029200             MOVE "47" TO CORRECT-A
029300             MOVE SQ-FS1-STATUS TO COMPUTED-A
029400             MOVE "STATUS FOR READ OF CLOSED FILE INCORRECT"
029500                     TO RE-MARK
029600             MOVE "VII-5, 1.3.5(4)F" TO ANSI-REFERENCE
029700             PERFORM DECL-FAIL
029800             GO TO DECL-ABNORMAL-TERM
029900     END-IF.
030000*
030100 DECL-PASS.
030200     MOVE   "PASS " TO P-OR-F.
030300     ADD     1 TO PASS-COUNTER.
030400     PERFORM DECL-PRINT-DETAIL.
030500*
030600 DECL-FAIL.
030700     MOVE   "FAIL*" TO P-OR-F.
030800     ADD     1 TO ERROR-COUNTER.
030900     PERFORM DECL-PRINT-DETAIL.
031000*
031100 DECL-DE-LETE.
031200     MOVE   "****TEST DELETED****" TO RE-MARK.
031300     MOVE   "*****" TO P-OR-F.
031400     ADD     1 TO DELETE-COUNTER.
031500     PERFORM DECL-PRINT-DETAIL.
031600*
031700 DECL-PRINT-DETAIL.
031800     IF REC-CT NOT EQUAL TO ZERO
031900             MOVE "." TO PARDOT-X
032000             MOVE REC-CT TO DOTVALUE.
032100     MOVE    TEST-RESULTS TO PRINT-REC.
032200     PERFORM DECL-WRITE-LINE.
032300     IF P-OR-F EQUAL TO "FAIL*"
032400         PERFORM DECL-WRITE-LINE
032500         PERFORM DECL-FAIL-ROUTINE THRU DECL-FAIL-EX
032600     ELSE
032700         PERFORM DECL-BAIL THRU DECL-BAIL-EX.
032800     MOVE    SPACE TO P-OR-F.
032900     MOVE    SPACE TO COMPUTED-X.
033000     MOVE    SPACE TO CORRECT-X.
033100     IF REC-CT EQUAL TO ZERO
033200         MOVE    SPACE TO PAR-NAME.
033300     MOVE    SPACE TO RE-MARK.
033400*
033500 DECL-WRITE-LINE.
033600     ADD     1 TO RECORD-COUNT.
033700Y    IF RECORD-COUNT GREATER 50
033800Y        MOVE    DUMMY-RECORD TO DUMMY-HOLD
033900Y        MOVE    SPACE TO DUMMY-RECORD
034000Y        WRITE   DUMMY-RECORD AFTER ADVANCING PAGE
034100Y        MOVE    CCVS-C-1 TO DUMMY-RECORD PERFORM DECL-WRT-LN
034200Y        MOVE    CCVS-C-2 TO DUMMY-RECORD
034300Y        PERFORM DECL-WRT-LN 2 TIMES
034400Y        MOVE    HYPHEN-LINE TO DUMMY-RECORD
034500Y        PERFORM DECL-WRT-LN
034600Y        MOVE    DUMMY-HOLD TO DUMMY-RECORD
034700Y        MOVE    ZERO TO RECORD-COUNT.
034800     PERFORM DECL-WRT-LN.
034900*
035000 DECL-WRT-LN.
035100     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
035200     MOVE    SPACE TO DUMMY-RECORD.
035300*
035400 DECL-FAIL-ROUTINE.
035500     IF COMPUTED-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
035600     IF CORRECT-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
035700     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
035800     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
035900     MOVE    XXINFO TO DUMMY-RECORD.
036000     PERFORM DECL-WRITE-LINE 2 TIMES.
036100     MOVE    SPACES TO INF-ANSI-REFERENCE.
036200     GO TO   DECL-FAIL-EX.
036300 DECL-FAIL-WRITE.
036400     MOVE    TEST-COMPUTED TO PRINT-REC
036500     PERFORM DECL-WRITE-LINE
036600     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
036700     MOVE    TEST-CORRECT TO PRINT-REC
036800     PERFORM DECL-WRITE-LINE 2 TIMES.
036900     MOVE    SPACES TO COR-ANSI-REFERENCE.
037000 DECL-FAIL-EX.
037100     EXIT.
037200*
037300 DECL-BAIL.
037400     IF COMPUTED-A NOT EQUAL TO SPACE GO TO DECL-BAIL-WRITE.
037500     IF CORRECT-A EQUAL TO SPACE GO TO DECL-BAIL-EX.
037600 DECL-BAIL-WRITE.
037700     MOVE    CORRECT-A TO XXCORRECT.
037800     MOVE    COMPUTED-A TO XXCOMPUTED.
037900     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
038000     MOVE    XXINFO TO DUMMY-RECORD.
038100     PERFORM DECL-WRITE-LINE 2 TIMES.
038200     MOVE SPACE TO INF-ANSI-REFERENCE.
038300 DECL-BAIL-EX.
038400     EXIT.
038500*
038600 DECL-ABNORMAL-TERM.
038700     MOVE SPACE TO DUMMY-RECORD.
038800     PERFORM DECL-WRITE-LINE.
038900     MOVE "ABNORMAL TERMINATION AT THIS POINT IS ACCEPTABLE"
039000             TO DUMMY-RECORD.
039100     PERFORM DECL-WRITE-LINE 3 TIMES.
039200*
039300 END-DECLS.
039400     EXIT.
039500 END DECLARATIVES.
039600*
039700*
039800 CCVS1 SECTION.
039900 OPEN-FILES.
040000     OPEN    OUTPUT PRINT-FILE.
040100     MOVE    CCVS-PGM-ID TO TEST-ID.
040200     MOVE    CCVS-PGM-ID TO ID-AGAIN.
040300     MOVE    SPACE TO TEST-RESULTS.
040400     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
040500     MOVE    ZERO TO REC-SKEL-SUB.
040600     PERFORM CCVS-INIT-FILE 10 TIMES.
040700     GO TO CCVS1-EXIT.
040800*
040900 CCVS-INIT-FILE.
041000     ADD     1 TO REC-SKL-SUB.
041100     MOVE    FILE-RECORD-INFO-SKELETON TO
041200                  FILE-RECORD-INFO (REC-SKL-SUB).
041300*
041400 CLOSE-FILES.
041500     PERFORM END-ROUTINE THRU END-ROUTINE-13.
041600     CLOSE   PRINT-FILE.
041700 TERMINATE-CCVS.
041800     STOP    RUN.
041900*
042000 INSPT.
042100     MOVE   "INSPT" TO P-OR-F.
042200     ADD     1 TO INSPECT-COUNTER.
042300     PERFORM PRINT-DETAIL.
042400
042500 PASS.
042600     MOVE   "PASS " TO P-OR-F.
042700     ADD     1 TO PASS-COUNTER.
042800     PERFORM PRINT-DETAIL.
042900*
043000 FAIL.
043100     MOVE   "FAIL*" TO P-OR-F.
043200     ADD     1 TO ERROR-COUNTER.
043300     PERFORM PRINT-DETAIL.
043400*
043500 DE-LETE.
043600     MOVE   "****TEST DELETED****" TO RE-MARK.
043700     MOVE   "*****" TO P-OR-F.
043800     ADD     1 TO DELETE-COUNTER.
043900     PERFORM PRINT-DETAIL.
044000*
044100 PRINT-DETAIL.
044200     IF REC-CT NOT EQUAL TO ZERO
044300         MOVE   "." TO PARDOT-X
044400         MOVE    REC-CT TO DOTVALUE.
044500     MOVE    TEST-RESULTS TO PRINT-REC.
044600     PERFORM WRITE-LINE.
044700     IF P-OR-F EQUAL TO "FAIL*"
044800         PERFORM WRITE-LINE
044900         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
045000     ELSE
045100         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
045200     MOVE    SPACE TO P-OR-F.
045300     MOVE    SPACE TO COMPUTED-X.
045400     MOVE    SPACE TO CORRECT-X.
045500     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
045600     MOVE    SPACE TO RE-MARK.
045700*
045800 HEAD-ROUTINE.
045900     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
046000     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
046100     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
046200     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
046300 COLUMN-NAMES-ROUTINE.
046400     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
046500     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
046600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
046700 END-ROUTINE.
046800     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
046900     PERFORM WRITE-LINE 5 TIMES.
047000 END-RTN-EXIT.
047100     MOVE    CCVS-E-1 TO DUMMY-RECORD.
047200     PERFORM WRITE-LINE 2 TIMES.
047300*
047400 END-ROUTINE-1.
047500     ADD     ERROR-COUNTER   TO ERROR-HOLD
047600     ADD     INSPECT-COUNTER TO ERROR-HOLD.
047700     ADD     DELETE-COUNTER  TO ERROR-HOLD.
047800     ADD     PASS-COUNTER    TO ERROR-HOLD.
047900     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
048000     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
048100     MOVE    CCVS-E-4        TO CCVS-E-2-2.
048200     MOVE    CCVS-E-2        TO DUMMY-RECORD
048300     PERFORM WRITE-LINE.
048400     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
048500     IF ERROR-COUNTER IS EQUAL TO ZERO
048600         MOVE   "NO " TO ERROR-TOTAL
048700     ELSE
048800         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
048900     MOVE    CCVS-E-2 TO DUMMY-RECORD.
049000     PERFORM WRITE-LINE.
049100 END-ROUTINE-13.
049200     IF DELETE-COUNTER IS EQUAL TO ZERO
049300         MOVE   "NO " TO ERROR-TOTAL
049400     ELSE
049500         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
049600     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
049700     MOVE    CCVS-E-2 TO DUMMY-RECORD.
049800     PERFORM WRITE-LINE.
049900     IF INSPECT-COUNTER EQUAL TO ZERO
050000         MOVE   "NO " TO ERROR-TOTAL
050100     ELSE
050200         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
050300     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
050400     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
050500     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
050600*
050700 WRITE-LINE.
050800     ADD     1 TO RECORD-COUNT.
050900Y    IF RECORD-COUNT GREATER 50
051000Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
051100Y        MOVE  SPACE TO DUMMY-RECORD
051200Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
051300Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
051400Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
051500Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
051600Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
051700Y        MOVE  ZERO TO RECORD-COUNT.
051800     PERFORM WRT-LN.
051900*
052000 WRT-LN.
052100     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
052200     MOVE    SPACE TO DUMMY-RECORD.
052300 BLANK-LINE-PRINT.
052400     PERFORM WRT-LN.
052500 FAIL-ROUTINE.
052600     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
052700     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
052800     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
052900     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
053000     MOVE    XXINFO TO DUMMY-RECORD.
053100     PERFORM WRITE-LINE 2 TIMES.
053200     MOVE    SPACES TO INF-ANSI-REFERENCE.
053300     GO TO   FAIL-ROUTINE-EX.
053400 FAIL-ROUTINE-WRITE.
053500     MOVE    TEST-COMPUTED  TO PRINT-REC
053600     PERFORM WRITE-LINE
053700     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
053800     MOVE    TEST-CORRECT   TO PRINT-REC
053900     PERFORM WRITE-LINE 2 TIMES.
054000     MOVE    SPACES         TO COR-ANSI-REFERENCE.
054100 FAIL-ROUTINE-EX.
054200     EXIT.
054300 BAIL-OUT.
054400     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
054500     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
054600 BAIL-OUT-WRITE.
054700     MOVE    CORRECT-A      TO XXCORRECT.
054800     MOVE    COMPUTED-A     TO XXCOMPUTED.
054900     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
055000     MOVE    XXINFO TO DUMMY-RECORD.
055100     PERFORM WRITE-LINE 2 TIMES.
055200     MOVE    SPACES TO INF-ANSI-REFERENCE.
055300 BAIL-OUT-EX.
055400     EXIT.
055500 CCVS1-EXIT.
055600     EXIT.
055700*
055800****************************************************************
055900*                                                              *
056000*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
056100*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
056200*                                                              *
056300****************************************************************
056400*
056500 SECT-SQ147A-0001 SECTION.
056600 WRITE-INIT-FG-01.
056700*
056800*    THIS TEST CREATES FILE SQ-FS1 AND CLOSES IT.
056900*    FIRST IT SETS UP A SKELETON RECORD IN WORKING STORAGE.
057000*
057100     MOVE "SQ-FS1"     TO XFILE-NAME (1).
057200     MOVE "R1-F-G"     TO XRECORD-NAME (1).
057300     MOVE  CCVS-PGM-ID TO XPROGRAM-NAME (1).
057400     MOVE 120          TO XRECORD-LENGTH (1).
057500     MOVE "RC"         TO CHARS-OR-RECORDS (1).
057600     MOVE 1            TO XBLOCK-SIZE (1).
057700     MOVE 1            TO RECORDS-IN-FILE (1).
057800     MOVE "SQ"         TO XFILE-ORGANIZATION (1).
057900     MOVE "S"          TO XLABEL-TYPE (1).
058000     MOVE 1            TO XRECORD-NUMBER (1).
058100*
058200 WRITE-OPEN-01.
058300     OPEN    OUTPUT SQ-FS1.
058400*
058500*        WRITE A SINGLE RECORD TO THE FILE
058600*
058700 WRITE-INIT-01.
058800 WRITE-TEST-01-01.
058900     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-FS1R1-F-G-120.
059000     WRITE   SQ-FS1R1-F-G-120.
059100*
059200*        CLOSE THE FILE.
059300*
059400 CLOSE-INIT-01.
059500 CLOSE-TEST-01.
059600     CLOSE   SQ-FS1.
059700*
059800 READ-INIT-01.
059900*
060000*    WE WILL NOW ATTEMPT TO READ A RECORD FROM THE
060100*    CLOSED FILE.  I-O STATUS 47 SHOULD BE GENERATED.
060200*
060300     MOVE "READ CLOSED FILE" TO FEATURE.
060400     MOVE "**" TO SQ-FS1-STATUS.
060500     MOVE "READ-TEST-01" TO PAR-NAME.
060600     MOVE 1 TO REC-CT.
060700*
060800 READ-TEST-01.
060900     READ    SQ-FS1.
061000*
061100 CCVS-EXIT SECTION.
061200 CCVS-999999.
061300     GO TO   CLOSE-FILES.
