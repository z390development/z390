000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ110M.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300
001400*         THIS ROUTINE CREATES A 2 UNIT MASS-STORAGE
001500*    FILE WHICH HAS FIXED LENGTH RECORDS.  THE FILE IS THEN
001600*    CLOSED AND OPENED AS AN INPUT FILE.  THE FILE IS READ AND
001700*    FIELDS IN THE INPUT RECORDS ARE COMPARED TO THE VALUES
001800*    WRITTEN TO ENSURE THAT THE RECORDS WERE PROCESSED CORRECTLY.
001900*
002000*    THE FILE IS CLOSED AND OPENED AGAIN AS AN INPUT FILE.  FOUR
002100*    READ FORMAT OPTIONS ARE USED TO READ THE FILE AND FIELDS IN
002200*    THE RECORDS ARE VERIFIED.  THE OPEN, CLOSE, READ, AND WRITE
002300*    STATEMENTS ARE TESTED FOR LEVEL ONE FEATURES.
002400*
002500*    USED X-CARDS:
002600*         XXXXX019
002700*         XXXXX055
002800*     P   XXXXX062
002900*         XXXXX082
003000*         XXXXX083
003100*     C   XXXXX084
003200*
003300*
003400 ENVIRONMENT DIVISION.
003500 CONFIGURATION SECTION.
003600 SOURCE-COMPUTER.
003700     XXXXX082.
003800 OBJECT-COMPUTER.
003900     XXXXX083.
004000 INPUT-OUTPUT SECTION.
004100 FILE-CONTROL.
004200P    SELECT RAW-DATA   ASSIGN TO
004300P    XXXXX062
004400P           ORGANIZATION IS INDEXED
004500P           ACCESS MODE IS RANDOM
004600P           RECORD KEY IS RAW-DATA-KEY.
004700     SELECT PRINT-FILE ASSIGN TO
004800     XXXXX055.
004900     SELECT SQ-FS3 ASSIGN TO
005000     XXXXX019
005100     ORGANIZATION IS SEQUENTIAL
005200     ACCESS MODE IS SEQUENTIAL.
005300 DATA DIVISION.
005400 FILE SECTION.
005500P
005600PFD  RAW-DATA.
005700P
005800P01  RAW-DATA-SATZ.
005900P    05  RAW-DATA-KEY        PIC X(6).
006000P    05  C-DATE              PIC 9(6).
006100P    05  C-TIME              PIC 9(8).
006200P    05  C-NO-OF-TESTS       PIC 99.
006300P    05  C-OK                PIC 999.
006400P    05  C-ALL               PIC 999.
006500P    05  C-FAIL              PIC 999.
006600P    05  C-DELETED           PIC 999.
006700P    05  C-INSPECT           PIC 999.
006800P    05  C-NOTE              PIC X(13).
006900P    05  C-INDENT            PIC X.
007000P    05  C-ABORT             PIC X(8).
007100 FD  PRINT-FILE
007200C    LABEL RECORDS
007300C    XXXXX084
007400C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007500               .
007600 01  PRINT-REC PICTURE X(120).
007700 01  DUMMY-RECORD PICTURE X(120).
007800 FD  SQ-FS3
007900C    LABEL RECORDS ARE STANDARD
008000C    DATA RECORD SQ-FS3R1-F-G-120
008100     BLOCK CONTAINS 120 CHARACTERS
008200     RECORD CONTAINS 120 CHARACTERS.
008300 01  SQ-FS3R1-F-G-120.
008400     02  FILLER PIC X(120).
008500 WORKING-STORAGE SECTION.
008600 01  WRK-CS-09V00 PICTURE S9(9) USAGE COMP VALUE ZERO.
008700 01  RECORDS-IN-ERROR  PIC S9(5) USAGE COMP VALUE 0.
008800 01  ERROR-FLAG PICTURE 9 VALUE 0.
008900 01  EOF-FLAG PICTURE 9 VALUE 0.
009000 01  FILE-RECORD-INFORMATION-REC.
009100     03 FILE-RECORD-INFO-SKELETON.
009200        05 FILLER                 PICTURE X(48)       VALUE
009300             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
009400        05 FILLER                 PICTURE X(46)       VALUE
009500             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
009600        05 FILLER                 PICTURE X(26)       VALUE
009700             ",LFIL=000000,ORG=  ,LBLR= ".
009800        05 FILLER                 PICTURE X(37)       VALUE
009900             ",RECKEY=                             ".
010000        05 FILLER                 PICTURE X(38)       VALUE
010100             ",ALTKEY1=                             ".
010200        05 FILLER                 PICTURE X(38)       VALUE
010300             ",ALTKEY2=                             ".
010400        05 FILLER                 PICTURE X(7)        VALUE SPACE.
010500     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
010600        05 FILE-RECORD-INFO-P1-120.
010700           07 FILLER              PIC X(5).
010800           07 XFILE-NAME           PIC X(6).
010900           07 FILLER              PIC X(8).
011000           07 XRECORD-NAME         PIC X(6).
011100           07 FILLER              PIC X(1).
011200           07 REELUNIT-NUMBER     PIC 9(1).
011300           07 FILLER              PIC X(7).
011400           07 XRECORD-NUMBER       PIC 9(6).
011500           07 FILLER              PIC X(6).
011600           07 UPDATE-NUMBER       PIC 9(2).
011700           07 FILLER              PIC X(5).
011800           07 ODO-NUMBER          PIC 9(4).
011900           07 FILLER              PIC X(5).
012000           07 XPROGRAM-NAME        PIC X(5).
012100           07 FILLER              PIC X(7).
012200           07 XRECORD-LENGTH       PIC 9(6).
012300           07 FILLER              PIC X(7).
012400           07 CHARS-OR-RECORDS    PIC X(2).
012500           07 FILLER              PIC X(1).
012600           07 XBLOCK-SIZE          PIC 9(4).
012700           07 FILLER              PIC X(6).
012800           07 RECORDS-IN-FILE     PIC 9(6).
012900           07 FILLER              PIC X(5).
013000           07 XFILE-ORGANIZATION   PIC X(2).
013100           07 FILLER              PIC X(6).
013200           07 XLABEL-TYPE          PIC X(1).
013300        05 FILE-RECORD-INFO-P121-240.
013400           07 FILLER              PIC X(8).
013500           07 XRECORD-KEY          PIC X(29).
013600           07 FILLER              PIC X(9).
013700           07 ALTERNATE-KEY1      PIC X(29).
013800           07 FILLER              PIC X(9).
013900           07 ALTERNATE-KEY2      PIC X(29).
014000           07 FILLER              PIC X(7).
014100 01  TEST-RESULTS.
014200     02 FILLER                    PICTURE X VALUE SPACE.
014300     02 FEATURE                   PICTURE X(20) VALUE SPACE.
014400     02 FILLER                    PICTURE X VALUE SPACE.
014500     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
014600     02 FILLER                    PICTURE X  VALUE SPACE.
014700     02  PAR-NAME.
014800       03 FILLER PICTURE X(12) VALUE SPACE.
014900       03  PARDOT-X PICTURE X  VALUE SPACE.
015000       03 DOTVALUE PICTURE 99  VALUE ZERO.
015100       03 FILLER PIC X(5) VALUE SPACE.
015200     02 FILLER PIC X(10) VALUE SPACE.
015300     02 RE-MARK PIC X(61).
015400 01  TEST-COMPUTED.
015500     02 FILLER PIC X(30) VALUE SPACE.
015600     02 FILLER PIC X(17) VALUE "       COMPUTED=".
015700     02 COMPUTED-X.
015800     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
015900     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
016000     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
016100     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
016200     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
016300     03       CM-18V0 REDEFINES COMPUTED-A.
016400         04 COMPUTED-18V0                   PICTURE -9(18).
016500         04 FILLER                          PICTURE X.
016600     03 FILLER PIC X(50) VALUE SPACE.
016700 01  TEST-CORRECT.
016800     02 FILLER PIC X(30) VALUE SPACE.
016900     02 FILLER PIC X(17) VALUE "       CORRECT =".
017000     02 CORRECT-X.
017100     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
017200     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
017300     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
017400     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
017500     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
017600     03      CR-18V0 REDEFINES CORRECT-A.
017700         04 CORRECT-18V0                    PICTURE -9(18).
017800         04 FILLER                          PICTURE X.
017900     03 FILLER PIC X(50) VALUE SPACE.
018000 01  CCVS-C-1.
018100     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
018200-    "SS  PARAGRAPH-NAME
018300-    "        REMARKS".
018400     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
018500 01  CCVS-C-2.
018600     02 FILLER PICTURE IS X VALUE IS SPACE.
018700     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
018800     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
018900     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
019000     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
019100 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
019200 01  REC-CT PICTURE 99 VALUE ZERO.
019300 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
019400 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
019500 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
019600 01  PASS-COUNTER PIC 999 VALUE ZERO.
019700 01  TOTAL-ERROR PIC 999 VALUE ZERO.
019800 01  ERROR-HOLD PIC 999 VALUE ZERO.
019900 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
020000 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
020100 01  CCVS-H-1.
020200     02  FILLER   PICTURE X(27)  VALUE SPACE.
020300     02 FILLER PICTURE X(67) VALUE
020400     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
020500-    " SYSTEM".
020600     02  FILLER     PICTURE X(26)  VALUE SPACE.
020700 01  CCVS-H-2.
020800     02 FILLER PICTURE X(52) VALUE IS
020900     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
021000     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
021100     02 TEST-ID PICTURE IS X(9).
021200     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
021300 01  CCVS-H-3.
021400     02  FILLER PICTURE X(34) VALUE
021500     " FOR OFFICIAL USE ONLY    ".
021600     02  FILLER PICTURE X(58) VALUE
021700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
021800     02  FILLER PICTURE X(28) VALUE
021900     "  COPYRIGHT   1985 ".
022000 01  CCVS-E-1.
022100     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
022200     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
022300     02 ID-AGAIN PICTURE IS X(9).
022400     02 FILLER PICTURE X(45) VALUE IS
022500     " NTIS DISTRIBUTION COBOL 85".
022600 01  CCVS-E-2.
022700     02  FILLER                   PICTURE X(31)  VALUE
022800     SPACE.
022900     02  FILLER                   PICTURE X(21)  VALUE SPACE.
023000     02 CCVS-E-2-2.
023100         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
023200         03 FILLER PICTURE IS X VALUE IS SPACE.
023300         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
023400 01  CCVS-E-3.
023500     02  FILLER PICTURE X(22) VALUE
023600     " FOR OFFICIAL USE ONLY".
023700     02  FILLER PICTURE X(12) VALUE SPACE.
023800     02  FILLER PICTURE X(58) VALUE
023900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024000     02  FILLER PICTURE X(13) VALUE SPACE.
024100     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
024200 01  CCVS-E-4.
024300     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
024400     02 FILLER PIC XXXX VALUE " OF ".
024500     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
024600     02 FILLER PIC X(40) VALUE
024700      "  TESTS WERE EXECUTED SUCCESSFULLY".
024800 01  XXINFO.
024900     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
025000     02 INFO-TEXT.
025100     04 FILLER PIC X(20) VALUE SPACE.
025200     04 XXCOMPUTED PIC X(20).
025300     04 FILLER PIC X(5) VALUE SPACE.
025400     04 XXCORRECT PIC X(20).
025500 01  HYPHEN-LINE.
025600     02 FILLER PICTURE IS X VALUE IS SPACE.
025700     02 FILLER PICTURE IS X(65) VALUE IS "************************
025800-    "*****************************************".
025900     02 FILLER PICTURE IS X(54) VALUE IS "************************
026000-    "******************************".
026100 01  CCVS-PGM-ID PIC X(6) VALUE
026200     "SQ110M".
026300 PROCEDURE DIVISION.
026400 CCVS1 SECTION.
026500 OPEN-FILES.
026600P    OPEN I-O RAW-DATA.
026700P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
026800P    READ RAW-DATA INVALID KEY GO TO END-E-1.
026900P    MOVE "ABORTED " TO C-ABORT.
027000P    ADD 1 TO C-NO-OF-TESTS.
027100P    ACCEPT C-DATE  FROM DATE.
027200P    ACCEPT C-TIME  FROM TIME.
027300P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
027400PEND-E-1.
027500P    CLOSE RAW-DATA.
027600     OPEN     OUTPUT PRINT-FILE.
027700     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
027800     MOVE    SPACE TO TEST-RESULTS.
027900     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
028000     MOVE ZERO TO REC-SKL-SUB.
028100     PERFORM CCVS-INIT-FILE 9 TIMES.
028200 CCVS-INIT-FILE.
028300     ADD 1 TO REC-SKL-SUB.
028400     MOVE FILE-RECORD-INFO-SKELETON TO
028500                  FILE-RECORD-INFO (REC-SKL-SUB).
028600 CCVS-INIT-EXIT.
028700     GO TO CCVS1-EXIT.
028800 CLOSE-FILES.
028900     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
029000P    OPEN I-O RAW-DATA.
029100P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
029200P    READ RAW-DATA INVALID KEY GO TO END-E-2.
029300P    MOVE "OK.     " TO C-ABORT.
029400P    MOVE PASS-COUNTER TO C-OK.
029500P    MOVE ERROR-HOLD   TO C-ALL.
029600P    MOVE ERROR-COUNTER TO C-FAIL.
029700P    MOVE DELETE-CNT TO C-DELETED.
029800P    MOVE INSPECT-COUNTER TO C-INSPECT.
029900P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
030000PEND-E-2.
030100P    CLOSE RAW-DATA.
030200 TERMINATE-CCVS.
030300S    EXIT PROGRAM.
030400STERMINATE-CALL.
030500     STOP     RUN.
030600 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
030700 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
030800 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
030900 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
031000     MOVE "****TEST DELETED****" TO RE-MARK.
031100 PRINT-DETAIL.
031200     IF REC-CT NOT EQUAL TO ZERO
031300             MOVE "." TO PARDOT-X
031400             MOVE REC-CT TO DOTVALUE.
031500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
031600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
031700        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
031800          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
031900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
032000     MOVE SPACE TO CORRECT-X.
032100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
032200     MOVE     SPACE TO RE-MARK.
032300 HEAD-ROUTINE.
032400     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032500     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
032600     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
032700 COLUMN-NAMES-ROUTINE.
032800     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
032900     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
033100 END-ROUTINE.
033200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033300 END-RTN-EXIT.
033400     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033500 END-ROUTINE-1.
033600      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
033700      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
033800      ADD PASS-COUNTER TO ERROR-HOLD.
033900*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
034000      MOVE PASS-COUNTER TO CCVS-E-4-1.
034100      MOVE ERROR-HOLD TO CCVS-E-4-2.
034200      MOVE CCVS-E-4 TO CCVS-E-2-2.
034300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
034400  END-ROUTINE-12.
034500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
034600     IF       ERROR-COUNTER IS EQUAL TO ZERO
034700         MOVE "NO " TO ERROR-TOTAL
034800         ELSE
034900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
035000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
035100     PERFORM WRITE-LINE.
035200 END-ROUTINE-13.
035300     IF DELETE-CNT IS EQUAL TO ZERO
035400         MOVE "NO " TO ERROR-TOTAL  ELSE
035500         MOVE DELETE-CNT TO ERROR-TOTAL.
035600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
035700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035800      IF   INSPECT-COUNTER EQUAL TO ZERO
035900          MOVE "NO " TO ERROR-TOTAL
036000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
036100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
036200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036400 WRITE-LINE.
036500     ADD 1 TO RECORD-COUNT.
036600Y    IF RECORD-COUNT GREATER 50
036700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
036800Y        MOVE SPACE TO DUMMY-RECORD
036900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
037000Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
037100Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
037200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
037300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
037400Y        MOVE ZERO TO RECORD-COUNT.
037500     PERFORM WRT-LN.
037600 WRT-LN.
037700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
037800     MOVE SPACE TO DUMMY-RECORD.
037900 BLANK-LINE-PRINT.
038000     PERFORM WRT-LN.
038100 FAIL-ROUTINE.
038200     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
038300     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
038400     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
038500     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038600     GO TO FAIL-ROUTINE-EX.
038700 FAIL-ROUTINE-WRITE.
038800     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
038900     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
039000 FAIL-ROUTINE-EX. EXIT.
039100 BAIL-OUT.
039200     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
039300     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
039400 BAIL-OUT-WRITE.
039500     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
039600     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039700 BAIL-OUT-EX. EXIT.
039800 CCVS1-EXIT.
039900     EXIT.
040000 SECT-SQ110M-0001 SECTION.
040100 SEQ-INIT-007.
040200     MOVE "SQ-FS3" TO XFILE-NAME (1).
040300     MOVE "R1-F-G" TO XRECORD-NAME (1).
040400     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
040500     MOVE 120 TO XRECORD-LENGTH (1).
040600     MOVE "CH" TO CHARS-OR-RECORDS (1).
040700     MOVE 120 TO XBLOCK-SIZE (1).
040800     MOVE 000649 TO RECORDS-IN-FILE (1).
040900     MOVE "SQ" TO XFILE-ORGANIZATION (1).
041000     MOVE "S" TO XLABEL-TYPE (1).
041100     MOVE 000001 TO XRECORD-NUMBER (1).
041200     OPEN OUTPUT SQ-FS3.
041300 SEQ-TEST-007.
041400     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-FS3R1-F-G-120.
041500     WRITE SQ-FS3R1-F-G-120.
041600     IF      XRECORD-NUMBER (1) EQUAL TO 196
041700E             ADD 1 TO REELUNIT-NUMBER (1)
041800E             CLOSE SQ-FS3 UNIT.
041900F    MOVE "CLOSE UNIT DELETED" TO RE-MARK.
042000     IF XRECORD-NUMBER (1) EQUAL TO 649
042100        GO TO SEQ-WRITE-007.
042200     ADD 1 TO XRECORD-NUMBER (1).
042300     GO TO SEQ-TEST-007.
042400 SEQ-WRITE-007.
042500     MOVE "CREATE FILE SQ-FS3" TO FEATURE.
042600     MOVE "SEQ-TEST-007" TO PAR-NAME.
042700     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
042800     MOVE XRECORD-NUMBER (1) TO CORRECT-18V0.
042900     PERFORM PRINT-DETAIL.
043000     CLOSE SQ-FS3.
043100*        A MASS STORAGE SEQUENTIAL FILE WITH 120 CHARACTER
043200*    RECORDS HAS BEEN CREATED.  THE FILE CONTAINS 649 RECORDS.
043300 SEQ-INIT-008.
043400     MOVE ZERO TO WRK-CS-09V00.
043500*        THIS TEST READS AND CHECKS THE FILE CREATED IN
043600*    SEQ-TEST-007.
043700     OPEN INPUT SQ-FS3.
043800 SEQ-TEST-008.
043900     READ SQ-FS3 RECORD
044000         AT END GO TO SEQ-TEST-008-1.
044100     MOVE SQ-FS3R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
044200     ADD 1 TO WRK-CS-09V00.
044300     IF WRK-CS-09V00 GREATER THAN 649
044400         MOVE "MORE THAN 649 RECORDS" TO RE-MARK
044500         GO TO SEQ-FAIL-008.
044600     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
044700         ADD 1 TO RECORDS-IN-ERROR
044800         GO TO SEQ-TEST-008.
044900     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS3"
045000         ADD 1 TO RECORDS-IN-ERROR
045100         GO TO SEQ-TEST-008.
045200     IF XLABEL-TYPE (1) NOT EQUAL TO "S"
045300     ADD 1 TO RECORDS-IN-ERROR.
045400     GO TO SEQ-TEST-008.
045500 SEQ-TEST-008-1.
045600     IF RECORDS-IN-ERROR EQUAL TO ZERO
045700          GO TO SEQ-PASS-008.
045800     MOVE "ERRORS IN READING SQ-FS3" TO RE-MARK.
045900 SEQ-FAIL-008.
046000     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
046100     PERFORM FAIL.
046200     GO TO SEQ-WRITE-008.
046300 SEQ-PASS-008.
046400     PERFORM PASS.
046500     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
046600     MOVE WRK-CS-09V00 TO CORRECT-18V0.
046700 SEQ-WRITE-008.
046800     MOVE "SEQ-TEST-008" TO PAR-NAME.
046900     MOVE "VERIFY FILE SQ-FS3" TO FEATURE.
047000     PERFORM PRINT-DETAIL.
047100 SEQ-CLOSE-008.
047200     CLOSE SQ-FS3.
047300 READ-INIT-GF-01.
047400     MOVE ZERO TO WRK-CS-09V00.
047500     MOVE ZERO TO RECORDS-IN-ERROR.
047600     OPEN INPUT SQ-FS3.
047700*        FOUR OPTIONS FOR THE READ STATEMENT ARE CHECKED
047800*    IN THIS SERIES OF TESTS.
047900     MOVE "READ...RECORD AT END ..." TO FEATURE.
048000     MOVE "READ-TEST-GF-01" TO PAR-NAME.
048100     MOVE ZERO TO ERROR-FLAG.
048200 READ-TEST-GF-01.
048300     READ SQ-FS3 RECORD
048400          AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
048500          MOVE 1 TO EOF-FLAG
048600          GO TO READ-FAIL-GF-01.
048700     PERFORM RECORD-CHECK.
048800     IF WRK-CS-09V00 EQUAL TO 50
048900           GO TO READ-TEST-GF-01-1.
049000     GO TO READ-TEST-GF-01.
049100 RECORD-CHECK.
049200     MOVE SQ-FS3R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
049300     ADD 1 TO WRK-CS-09V00.
049400     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
049500         ADD 1 TO RECORDS-IN-ERROR
049600         MOVE 1 TO ERROR-FLAG.
049700 READ-TEST-GF-01-1.
049800     IF ERROR-FLAG EQUAL TO ZERO
049900         GO TO READ-PASS-GF-01.
050000     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
050100 READ-FAIL-GF-01.
050200     MOVE "VII-44; 4.4.2                            " TO  RE-MARK.
050300     PERFORM FAIL.
050400     GO TO READ-WRITE-GF-01.
050500 READ-PASS-GF-01.
050600     PERFORM PASS.
050700 READ-WRITE-GF-01.
050800     PERFORM PRINT-DETAIL.
050900 READ-INIT-GF-02.
051000     IF EOF-FLAG EQUAL TO 1
051100         GO TO SEQ-EOF-009.
051200     MOVE ZERO TO ERROR-FLAG.
051300     MOVE "READ...AT END..." TO FEATURE.
051400     MOVE "READ-TEST-GF-02" TO PAR-NAME.
051500 READ-TEST-GF-02.
051600     READ SQ-FS3  AT END
051700          MOVE "UNEXPECTED EOF" TO COMPUTED-A
051800          MOVE 1 TO EOF-FLAG
051900          GO TO READ-FAIL-GF-02.
052000     PERFORM RECORD-CHECK.
052100     IF WRK-CS-09V00 EQUAL TO 200
052200         GO TO READ-TEST-GF-02-1.
052300     GO TO READ-TEST-GF-02.
052400 READ-TEST-GF-02-1.
052500     IF ERROR-FLAG EQUAL TO ZERO
052600          GO TO READ-PASS-GF-02.
052700     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
052800 READ-FAIL-GF-02.
052900     MOVE "VII-44; 4.4.2                            " TO  RE-MARK.
053000     PERFORM FAIL.
053100     GO TO READ-WRITE-GF-02.
053200 READ-PASS-GF-02.
053300     PERFORM PASS.
053400 READ-WRITE-GF-02.
053500     PERFORM PRINT-DETAIL.
053600 READ-INIT-GF-03.
053700     IF EOF-FLAG EQUAL TO 1
053800         GO TO SEQ-EOF-009.
053900     MOVE ZERO TO ERROR-FLAG.
054000     MOVE "READ...RECORD END..." TO FEATURE.
054100     MOVE "READ-TEST-GF-03" TO PAR-NAME.
054200 READ-TEST-GF-03.
054300     READ SQ-FS3 RECORD END
054400          MOVE "UNEXPECTED EOF" TO COMPUTED-A
054500          MOVE 1 TO EOF-FLAG
054600          GO TO READ-FAIL-GF-03.
054700     PERFORM RECORD-CHECK.
054800     IF WRK-CS-09V00 EQUAL TO 499
054900          GO TO READ-TEST-GF-03-1.
055000     GO TO READ-TEST-GF-03.
055100 READ-TEST-GF-03-1.
055200     IF ERROR-FLAG EQUAL TO ZERO
055300           GO TO READ-PASS-GF-03.
055400     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
055500 READ-FAIL-GF-03.
055600     MOVE "VII-44; 4.4.2                            " TO  RE-MARK.
055700     PERFORM FAIL.
055800     GO TO READ-WRITE-GF-03.
055900 READ-PASS-GF-03.
056000     PERFORM PASS.
056100 READ-WRITE-GF-03.
056200     PERFORM PRINT-DETAIL.
056300 READ-INIT-GF-04.
056400     IF EOF-FLAG EQUAL TO 1
056500         GO TO SEQ-EOF-009.
056600     MOVE ZERO TO ERROR-FLAG.
056700     MOVE "READ...END..." TO FEATURE.
056800     MOVE "READ-TEST-GF-04" TO PAR-NAME.
056900 READ-TEST-GF-04.
057000     READ SQ-FS3 END
057100          GO TO READ-TEST-GF-04-1.
057200     PERFORM RECORD-CHECK.
057300     IF WRK-CS-09V00 GREATER THAN 649
057400          GO TO READ-TEST-GF-04-1.
057500     GO TO READ-TEST-GF-04.
057600 READ-TEST-GF-04-1.
057700     IF ERROR-FLAG EQUAL TO ZERO
057800         GO TO READ-PASS-GF-04.
057900 READ-FAIL-GF-04.
058000     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
058100     MOVE "VII-44; 4.4.2                            " TO  RE-MARK.
058200     PERFORM FAIL.
058300     GO TO READ-WRITE-GF-04.
058400 READ-PASS-GF-04.
058500     PERFORM PASS.
058600 READ-WRITE-GF-04.
058700     PERFORM PRINT-DETAIL.
058800 SEQ-TEST-009.
058900     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
059000          MOVE "RECORDS IN ERROR =" TO COMPUTED-A
059100          MOVE RECORDS-IN-ERROR TO CORRECT-18V0
059200          GO TO SEQ-FAIL-009.
059300     IF WRK-CS-09V00 GREATER THAN 649
059400          MOVE "MORE THAN 649 RECORDS" TO RE-MARK
059500          GO TO SEQ-FAIL-009.
059600 SEQ-PASS-009.
059700     PERFORM PASS
059800     GO TO SEQ-WRITE-009.
059900 SEQ-EOF-009.
060000     MOVE "LESS THAN 649 RECORDS" TO RE-MARK.
060100     MOVE "RECORDS READ =" TO COMPUTED-A.
060200     MOVE WRK-CS-09V00 TO CORRECT-18V0.
060300 SEQ-FAIL-009.
060400     PERFORM FAIL.
060500 SEQ-WRITE-009.
060600     MOVE "SEQ-TEST-009" TO PAR-NAME.
060700     MOVE "READ FILE SQ-FS3" TO FEATURE.
060800     PERFORM PRINT-DETAIL.
060900 SEQ-CLOSE-009.
061000     CLOSE SQ-FS3.
061100 TERMINATE-ROUTINE.
061200     EXIT.
061300 CCVS-EXIT SECTION.
061400 CCVS-999999.
061500     GO TO CLOSE-FILES.
