000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST109A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*    ST109 BUILDS A FILE WHICH IS SORTED IN ST110 AND CHECKED IN
002200*    ST111. THE CREATED FILE CONSISTS OF 40 RECORDS OF VARYING
002300*    LENGTH (50, 75, 100 CHARACTERS). THE THREE RECORDS SHOWN
002400*    BELOW REOCCUR UNTIL 40 IS REACHED.
002500*      NON-KEY KEY-1        KEY-2               FILLER
002600*      X(2)     X(10)       X(38)
002700*
002800*      "BB"    "LOWEST TWO" "MIDDLE TWO-FIRST"  X(25) VALUE ZERO
002900*      "CC"    "LOWEST TWO" "MIDDLE TWO-SECOND" X(50) VALUE QUOTE
003000*      "AA"    "LOWEST ONE" "MIDDLE ONE-ONLY"   (NONE)
003100*
003200*    *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  * *.
003300
003400 ENVIRONMENT DIVISION.
003500 CONFIGURATION SECTION.
003600 SOURCE-COMPUTER.
003700     XXXXX082.
003800 OBJECT-COMPUTER.
003900     XXXXX083.
004000 INPUT-OUTPUT SECTION.
004100 FILE-CONTROL.
004200     SELECT PRINT-FILE ASSIGN TO
004300     XXXXX055.
004400     SELECT   SORTOUT-1I ASSIGN TO
004500     XXXXP001.
004600 DATA DIVISION.
004700 FILE SECTION.
004800 FD  PRINT-FILE.
004900 01  PRINT-REC PICTURE X(120).
005000 01  DUMMY-RECORD PICTURE X(120).
005100 FD  SORTOUT-1I
005200     LABEL RECORDS STANDARD
005300C    VALUE OF
005400C    XXXXX074
005500C    IS
005600C    XXXXX075
005700G    XXXXX069
005800     RECORD CONTAINS 50 TO 100 CHARACTERS
005900     DATA RECORDS ARE SHORT-RECORD
006000                      MEDIUM-RECORD
006100                      LONG-RECORD.
006200 01  SHORT-RECORD       PICTURE X(50).
006300 01  MEDIUM-RECORD      PICTURE X(75).
006400 01  LONG-RECORD        PICTURE X(100).
006500 WORKING-STORAGE SECTION.
006600 77  COMMENT-SENTENCE  PICTURE X(116) VALUE " ST109 HAS CREATED A
006700-    "FILE OF 40 VARIABLE-LENGTH-RECORDS. THESE RECORDS WILL BE SO
006800-    "RTED IN ST110 AND CHECKED IN ST111.".
006900 77  UTIL-CTR           PICTURE S99999 VALUE ZERO.
007000 01  SHORT-WORK.
007100     02 FILLER          PICTURE XX    VALUE "AA".
007200     02 FILLER          PICTURE X(10) VALUE "LOWEST ONE".
007300     02 FILLER          PICTURE X(38) VALUE "MIDDLE ONE-ONLY".
007400 01  MEDIUM-WORK.
007500     02 FILLER          PICTURE XX    VALUE "BB".
007600     02 FILLER          PICTURE X(10) VALUE "LOWEST TWO".
007700     02 FILLER          PICTURE X(38) VALUE "MIDDLE TWO-FIRST".
007800     02 FILLER          PICTURE X(25) VALUE ZERO.
007900 01  LONG-WORK.
008000     02 FILLER          PICTURE XX    VALUE "CC".
008100     02 FILLER          PICTURE X(10) VALUE "LOWEST TWO".
008200     02 FILLER          PICTURE X(38) VALUE "MIDDLE TWO-SECOND".
008300     02 FILLER          PICTURE X(50) VALUE QUOTE.
008400 01  TEST-RESULTS.
008500     02 FILLER                   PIC X      VALUE SPACE.
008600     02 FEATURE                  PIC X(20)  VALUE SPACE.
008700     02 FILLER                   PIC X      VALUE SPACE.
008800     02 P-OR-F                   PIC X(5)   VALUE SPACE.
008900     02 FILLER                   PIC X      VALUE SPACE.
009000     02  PAR-NAME.
009100       03 FILLER                 PIC X(19)  VALUE SPACE.
009200       03  PARDOT-X              PIC X      VALUE SPACE.
009300       03 DOTVALUE               PIC 99     VALUE ZERO.
009400     02 FILLER                   PIC X(8)   VALUE SPACE.
009500     02 RE-MARK                  PIC X(61).
009600 01  TEST-COMPUTED.
009700     02 FILLER                   PIC X(30)  VALUE SPACE.
009800     02 FILLER                   PIC X(17)  VALUE
009900            "       COMPUTED=".
010000     02 COMPUTED-X.
010100     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
010200     03 COMPUTED-N               REDEFINES COMPUTED-A
010300                                 PIC -9(9).9(9).
010400     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
010500     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
010600     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
010700     03       CM-18V0 REDEFINES COMPUTED-A.
010800         04 COMPUTED-18V0                    PIC -9(18).
010900         04 FILLER                           PIC X.
011000     03 FILLER PIC X(50) VALUE SPACE.
011100 01  TEST-CORRECT.
011200     02 FILLER PIC X(30) VALUE SPACE.
011300     02 FILLER PIC X(17) VALUE "       CORRECT =".
011400     02 CORRECT-X.
011500     03 CORRECT-A                  PIC X(20) VALUE SPACE.
011600     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
011700     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
011800     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
011900     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
012000     03      CR-18V0 REDEFINES CORRECT-A.
012100         04 CORRECT-18V0                     PIC -9(18).
012200         04 FILLER                           PIC X.
012300     03 FILLER PIC X(2) VALUE SPACE.
012400     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
012500 01  CCVS-C-1.
012600     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
012700-    "SS  PARAGRAPH-NAME
012800-    "       REMARKS".
012900     02 FILLER                     PIC X(20)    VALUE SPACE.
013000 01  CCVS-C-2.
013100     02 FILLER                     PIC X        VALUE SPACE.
013200     02 FILLER                     PIC X(6)     VALUE "TESTED".
013300     02 FILLER                     PIC X(15)    VALUE SPACE.
013400     02 FILLER                     PIC X(4)     VALUE "FAIL".
013500     02 FILLER                     PIC X(94)    VALUE SPACE.
013600 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
013700 01  REC-CT                        PIC 99       VALUE ZERO.
013800 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
013900 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
014000 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
014100 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
014200 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
014300 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
014400 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
014500 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
014600 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
014700 01  CCVS-H-1.
014800     02  FILLER                    PIC X(39)    VALUE SPACES.
014900     02  FILLER                    PIC X(42)    VALUE
015000     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
015100     02  FILLER                    PIC X(39)    VALUE SPACES.
015200 01  CCVS-H-2A.
015300   02  FILLER                        PIC X(40)  VALUE SPACE.
015400   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
015500   02  FILLER                        PIC XXXX   VALUE
015600     "4.2 ".
015700   02  FILLER                        PIC X(28)  VALUE
015800            " COPY - NOT FOR DISTRIBUTION".
015900   02  FILLER                        PIC X(41)  VALUE SPACE.
016000
016100 01  CCVS-H-2B.
016200   02  FILLER                        PIC X(15)  VALUE
016300            "TEST RESULT OF ".
016400   02  TEST-ID                       PIC X(9).
016500   02  FILLER                        PIC X(4)   VALUE
016600            " IN ".
016700   02  FILLER                        PIC X(12)  VALUE
016800     " HIGH       ".
016900   02  FILLER                        PIC X(22)  VALUE
017000            " LEVEL VALIDATION FOR ".
017100   02  FILLER                        PIC X(58)  VALUE
017200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
017300 01  CCVS-H-3.
017400     02  FILLER                      PIC X(34)  VALUE
017500            " FOR OFFICIAL USE ONLY    ".
017600     02  FILLER                      PIC X(58)  VALUE
017700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
017800     02  FILLER                      PIC X(28)  VALUE
017900            "  COPYRIGHT   1985 ".
018000 01  CCVS-E-1.
018100     02 FILLER                       PIC X(52)  VALUE SPACE.
018200     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
018300     02 ID-AGAIN                     PIC X(9).
018400     02 FILLER                       PIC X(45)  VALUE SPACES.
018500 01  CCVS-E-2.
018600     02  FILLER                      PIC X(31)  VALUE SPACE.
018700     02  FILLER                      PIC X(21)  VALUE SPACE.
018800     02 CCVS-E-2-2.
018900         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
019000         03 FILLER                   PIC X      VALUE SPACE.
019100         03 ENDER-DESC               PIC X(44)  VALUE
019200            "ERRORS ENCOUNTERED".
019300 01  CCVS-E-3.
019400     02  FILLER                      PIC X(22)  VALUE
019500            " FOR OFFICIAL USE ONLY".
019600     02  FILLER                      PIC X(12)  VALUE SPACE.
019700     02  FILLER                      PIC X(58)  VALUE
019800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
019900     02  FILLER                      PIC X(13)  VALUE SPACE.
020000     02 FILLER                       PIC X(15)  VALUE
020100             " COPYRIGHT 1985".
020200 01  CCVS-E-4.
020300     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
020400     02 FILLER                       PIC X(4)   VALUE " OF ".
020500     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
020600     02 FILLER                       PIC X(40)  VALUE
020700      "  TESTS WERE EXECUTED SUCCESSFULLY".
020800 01  XXINFO.
020900     02 FILLER                       PIC X(19)  VALUE
021000            "*** INFORMATION ***".
021100     02 INFO-TEXT.
021200       04 FILLER                     PIC X(8)   VALUE SPACE.
021300       04 XXCOMPUTED                 PIC X(20).
021400       04 FILLER                     PIC X(5)   VALUE SPACE.
021500       04 XXCORRECT                  PIC X(20).
021600     02 INF-ANSI-REFERENCE           PIC X(48).
021700 01  HYPHEN-LINE.
021800     02 FILLER  PIC IS X VALUE IS SPACE.
021900     02 FILLER  PIC IS X(65)    VALUE IS "************************
022000-    "*****************************************".
022100     02 FILLER  PIC IS X(54)    VALUE IS "************************
022200-    "******************************".
022300 01  CCVS-PGM-ID                     PIC X(9)   VALUE
022400     "ST109A".
022500 PROCEDURE DIVISION.
022600 CCVS1 SECTION.
022700 OPEN-FILES.
022800     OPEN     OUTPUT PRINT-FILE.
022900     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
023000     MOVE    SPACE TO TEST-RESULTS.
023100     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
023200     GO TO CCVS1-EXIT.
023300 CLOSE-FILES.
023400     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
023500 TERMINATE-CCVS.
023600S    EXIT PROGRAM.
023700STERMINATE-CALL.
023800     STOP     RUN.
023900 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
024000 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
024100 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
024200 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
024300     MOVE "****TEST DELETED****" TO RE-MARK.
024400 PRINT-DETAIL.
024500     IF REC-CT NOT EQUAL TO ZERO
024600             MOVE "." TO PARDOT-X
024700             MOVE REC-CT TO DOTVALUE.
024800     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
024900     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
025000        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
025100          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
025200     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
025300     MOVE SPACE TO CORRECT-X.
025400     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
025500     MOVE     SPACE TO RE-MARK.
025600 HEAD-ROUTINE.
025700     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025800     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025900     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
026000     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
026100 COLUMN-NAMES-ROUTINE.
026200     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026300     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
026500 END-ROUTINE.
026600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
026700 END-RTN-EXIT.
026800     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026900 END-ROUTINE-1.
027000      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
027100      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
027200      ADD PASS-COUNTER TO ERROR-HOLD.
027300*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
027400      MOVE PASS-COUNTER TO CCVS-E-4-1.
027500      MOVE ERROR-HOLD TO CCVS-E-4-2.
027600      MOVE CCVS-E-4 TO CCVS-E-2-2.
027700      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
027800  END-ROUTINE-12.
027900      MOVE "TEST(S) FAILED" TO ENDER-DESC.
028000     IF       ERROR-COUNTER IS EQUAL TO ZERO
028100         MOVE "NO " TO ERROR-TOTAL
028200         ELSE
028300         MOVE ERROR-COUNTER TO ERROR-TOTAL.
028400     MOVE     CCVS-E-2 TO DUMMY-RECORD.
028500     PERFORM WRITE-LINE.
028600 END-ROUTINE-13.
028700     IF DELETE-COUNTER IS EQUAL TO ZERO
028800         MOVE "NO " TO ERROR-TOTAL  ELSE
028900         MOVE DELETE-COUNTER TO ERROR-TOTAL.
029000     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
029100     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029200      IF   INSPECT-COUNTER EQUAL TO ZERO
029300          MOVE "NO " TO ERROR-TOTAL
029400      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
029500      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
029600      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029700     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029800 WRITE-LINE.
029900     ADD 1 TO RECORD-COUNT.
030000Y    IF RECORD-COUNT GREATER 42
030100Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
030200Y        MOVE SPACE TO DUMMY-RECORD
030300Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
030400Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
030500Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
030600Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
030700Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
030800Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
030900Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
031000Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
031100Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
031200Y        MOVE ZERO TO RECORD-COUNT.
031300     PERFORM WRT-LN.
031400 WRT-LN.
031500     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
031600     MOVE SPACE TO DUMMY-RECORD.
031700 BLANK-LINE-PRINT.
031800     PERFORM WRT-LN.
031900 FAIL-ROUTINE.
032000     IF     COMPUTED-X NOT EQUAL TO SPACE
032100            GO TO   FAIL-ROUTINE-WRITE.
032200     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
032300     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
032400     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
032500     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032600     MOVE   SPACES TO INF-ANSI-REFERENCE.
032700     GO TO  FAIL-ROUTINE-EX.
032800 FAIL-ROUTINE-WRITE.
032900     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
033000     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
033100     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
033200     MOVE   SPACES TO COR-ANSI-REFERENCE.
033300 FAIL-ROUTINE-EX. EXIT.
033400 BAIL-OUT.
033500     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
033600     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
033700 BAIL-OUT-WRITE.
033800     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
033900     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
034000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034100     MOVE   SPACES TO INF-ANSI-REFERENCE.
034200 BAIL-OUT-EX. EXIT.
034300 CCVS1-EXIT.
034400     EXIT.
034500 ST109-0001-01.
034600     OPEN     OUTPUT   SORTOUT-1I.
034700 BUILD-LOOP.
034800     MOVE     MEDIUM-WORK TO MEDIUM-RECORD.
034900     WRITE    MEDIUM-RECORD.
035000     ADD      1 TO UTIL-CTR.
035100     IF       UTIL-CTR GREATER 39
035200              GO TO ST109-0002-01.
035300     MOVE     LONG-WORK TO LONG-RECORD.
035400     WRITE    LONG-RECORD.
035500     ADD      1 TO UTIL-CTR.
035600     MOVE     SHORT-WORK TO SHORT-RECORD.
035700     WRITE    SHORT-RECORD.
035800     ADD      1 TO UTIL-CTR.
035900     GO       TO BUILD-LOOP.
036000 ST109-0002-01.
036100     MOVE    SPACES TO TEST-RESULTS.
036200     MOVE    COMMENT-SENTENCE TO TEST-RESULTS.
036300     PERFORM PRINT-DETAIL.
036400     MOVE    SPACES TO TEST-RESULTS.
036500     CLOSE    SORTOUT-1I.
036600 CCVS-EXIT SECTION.
036700 CCVS-999999.
036800     GO TO CLOSE-FILES.
