000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ218A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200*       THIS ROUTINE CHECKS  THE
001300*               RECORD DELIMITER IS STANDARD-1    CLAUSE.
001400*
001500*            SEE  VII-13.
001600*
001700*
001800*       THIS ROUTINE BUILDS A SEQUENTIAL TAPE FILE WHICH CONTAINS
001900*    BOTH 120 CHARACTER AND 151 CHARACTER RECORDS.  THE TAPE
002000*    CONSISTS OF 1 SHORT, 1 LONG, 10 SHORT, 100 LONG, AND 338
002100*    SHORT RECORDS FOR A TOTAL OF 450 RECORDS IN THE FILE.
002200*    THE TAPE IS READ AND FIELDS IN THE RECORDS ARE CHECKED
002300*    AGAINST THE EXPECTED VALUES.
002400*
002500*       AN INFORMATION SECTION AT THE END OF THE ROUTINE CHECKS
002600*    THE FIELD WHICH CONTAINS THE XRECORD-NUMBER.  THIS FIELD IS
002700*    PART OF A LONG RECORD ONLY.  IF THE XRECORD-NUMBER IS THERE
002800*    FOR A SHORT RECORD, IT MEANS THE MAXIMUM SIZE RECORD IS
002900*    ALWAYS WRITTEN.
003000 ENVIRONMENT DIVISION.
003100 CONFIGURATION SECTION.
003200 SOURCE-COMPUTER.
003300     XXXXX082.
003400 OBJECT-COMPUTER.
003500     XXXXX083.
003600 INPUT-OUTPUT SECTION.
003700 FILE-CONTROL.
003800P    SELECT RAW-DATA   ASSIGN TO
003900P    XXXXX062
004000P           ORGANIZATION IS INDEXED
004100P           ACCESS MODE IS RANDOM
004200P           RECORD KEY IS RAW-DATA-KEY.
004300     SELECT PRINT-FILE ASSIGN TO
004400     XXXXX055.
004500     SELECT SQ-VS6 ASSIGN
004600     XXXXX001
004700     ORGANIZATION IS SEQUENTIAL
004800     RECORD DELIMITER IS STANDARD-1.
004900 DATA DIVISION.
005000 FILE SECTION.
005100P
005200PFD  RAW-DATA.
005300P
005400P01  RAW-DATA-SATZ.
005500P    05  RAW-DATA-KEY        PIC X(6).
005600P    05  C-DATE              PIC 9(6).
005700P    05  C-TIME              PIC 9(8).
005800P    05  C-NO-OF-TESTS       PIC 99.
005900P    05  C-OK                PIC 999.
006000P    05  C-ALL               PIC 999.
006100P    05  C-FAIL              PIC 999.
006200P    05  C-DELETED           PIC 999.
006300P    05  C-INSPECT           PIC 999.
006400P    05  C-NOTE              PIC X(13).
006500P    05  C-INDENT            PIC X.
006600P    05  C-ABORT             PIC X(8).
006700 FD  PRINT-FILE
006800C    LABEL RECORDS
006900C    XXXXX084
007000C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007100               .
007200 01  PRINT-REC PICTURE X(120).
007300 01  DUMMY-RECORD PICTURE X(120).
007400 FD  SQ-VS6
007500     RECORD CONTAINS 120 TO 151 CHARACTERS
007600C    LABEL RECORDS ARE STANDARD
007700C    DATA RECORDS ARE SQ-VS6R1-M-G-120  SQ-VS6R2-M-G-151
007800     .
007900 01  SQ-VS6R1-M-G-120.
008000     02  SQ-VS6R1-FIRST PIC X(120).
008100 01  SQ-VS6R2-M-G-151.
008200     02  SQ-VS6R2-FIRST  PIC X(120).
008300     02  LONG-OR-SHORT  PIC X(5).
008400     02  SQ-VS6-RECNO  PIC X(5).
008500     02  SQ-VS6-FILLER  PIC X(21).
008600 WORKING-STORAGE SECTION.
008700 01  SAVE-COUNT-OF-RECS  PIC X(5).
008800 01  COUNT-OF-RECS  PIC S9(5) COMP.
008900 01  RECORDS-IN-ERROR  PIC S9(5) COMP.
009000 01  ERROR-FLAG PIC 9.
009100 01  EOF-FLAG  PIC 9.
009200 01  DUMP-AREA.
009300     02  TYPE-OF-REC PICTURE X(5).
009400     02  RECNO  PIC 9(5).
009500     02  REC-FILLER  PIC X(21).
009600 01  FILE-RECORD-INFORMATION-REC.
009700     03 FILE-RECORD-INFO-SKELETON.
009800        05 FILLER                 PICTURE X(48)       VALUE
009900             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
010000        05 FILLER                 PICTURE X(46)       VALUE
010100             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
010200        05 FILLER                 PICTURE X(26)       VALUE
010300             ",LFIL=000000,ORG=  ,LBLR= ".
010400        05 FILLER                 PICTURE X(37)       VALUE
010500             ",RECKEY=                             ".
010600        05 FILLER                 PICTURE X(38)       VALUE
010700             ",ALTKEY1=                             ".
010800        05 FILLER                 PICTURE X(38)       VALUE
010900             ",ALTKEY2=                             ".
011000        05 FILLER                 PICTURE X(7)        VALUE SPACE.
011100     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
011200        05 FILE-RECORD-INFO-P1-120.
011300           07 FILLER              PIC X(5).
011400           07 XFILE-NAME           PIC X(6).
011500           07 FILLER              PIC X(8).
011600           07 XRECORD-NAME         PIC X(6).
011700           07 FILLER              PIC X(1).
011800           07 REELUNIT-NUMBER     PIC 9(1).
011900           07 FILLER              PIC X(7).
012000           07 XRECORD-NUMBER       PIC 9(6).
012100           07 FILLER              PIC X(6).
012200           07 UPDATE-NUMBER       PIC 9(2).
012300           07 FILLER              PIC X(5).
012400           07 ODO-NUMBER          PIC 9(4).
012500           07 FILLER              PIC X(5).
012600           07 XPROGRAM-NAME        PIC X(5).
012700           07 FILLER              PIC X(7).
012800           07 XRECORD-LENGTH       PIC 9(6).
012900           07 FILLER              PIC X(7).
013000           07 CHARS-OR-RECORDS    PIC X(2).
013100           07 FILLER              PIC X(1).
013200           07 XBLOCK-SIZE          PIC 9(4).
013300           07 FILLER              PIC X(6).
013400           07 RECORDS-IN-FILE     PIC 9(6).
013500           07 FILLER              PIC X(5).
013600           07 XFILE-ORGANIZATION   PIC X(2).
013700           07 FILLER              PIC X(6).
013800           07 XLABEL-TYPE          PIC X(1).
013900        05 FILE-RECORD-INFO-P121-240.
014000           07 FILLER              PIC X(8).
014100           07 XRECORD-KEY          PIC X(29).
014200           07 FILLER              PIC X(9).
014300           07 ALTERNATE-KEY1      PIC X(29).
014400           07 FILLER              PIC X(9).
014500           07 ALTERNATE-KEY2      PIC X(29).
014600           07 FILLER              PIC X(7).
014700 01  TEST-RESULTS.
014800     02 FILLER                    PICTURE X VALUE SPACE.
014900     02 FEATURE                   PICTURE X(20) VALUE SPACE.
015000     02 FILLER                    PICTURE X VALUE SPACE.
015100     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
015200     02 FILLER                    PICTURE X  VALUE SPACE.
015300     02  PAR-NAME.
015400       03 FILLER PICTURE X(12) VALUE SPACE.
015500       03  PARDOT-X PICTURE X  VALUE SPACE.
015600       03 DOTVALUE PICTURE 99  VALUE ZERO.
015700       03 FILLER PIC X(5) VALUE SPACE.
015800     02 FILLER PIC X(10) VALUE SPACE.
015900     02 RE-MARK PIC X(61).
016000 01  TEST-COMPUTED.
016100     02 FILLER PIC X(30) VALUE SPACE.
016200     02 FILLER PIC X(17) VALUE "       COMPUTED=".
016300     02 COMPUTED-X.
016400     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
016500     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
016600     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
016700     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
016800     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
016900     03       CM-18V0 REDEFINES COMPUTED-A.
017000         04 COMPUTED-18V0                   PICTURE -9(18).
017100         04 FILLER                          PICTURE X.
017200     03 FILLER PIC X(50) VALUE SPACE.
017300 01  TEST-CORRECT.
017400     02 FILLER PIC X(30) VALUE SPACE.
017500     02 FILLER PIC X(17) VALUE "       CORRECT =".
017600     02 CORRECT-X.
017700     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
017800     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
017900     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
018000     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
018100     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
018200     03      CR-18V0 REDEFINES CORRECT-A.
018300         04 CORRECT-18V0                    PICTURE -9(18).
018400         04 FILLER                          PICTURE X.
018500     03 FILLER PIC X(50) VALUE SPACE.
018600 01  CCVS-C-1.
018700     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
018800-    "SS  PARAGRAPH-NAME
018900-    "        REMARKS".
019000     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
019100 01  CCVS-C-2.
019200     02 FILLER PICTURE IS X VALUE IS SPACE.
019300     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
019400     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
019500     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
019600     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
019700 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
019800 01  REC-CT PICTURE 99 VALUE ZERO.
019900 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
020000 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
020100 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
020200 01  PASS-COUNTER PIC 999 VALUE ZERO.
020300 01  TOTAL-ERROR PIC 999 VALUE ZERO.
020400 01  ERROR-HOLD PIC 999 VALUE ZERO.
020500 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
020600 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
020700 01  CCVS-H-1.
020800     02  FILLER   PICTURE X(27)  VALUE SPACE.
020900     02 FILLER PICTURE X(67) VALUE
021000     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
021100-    " SYSTEM".
021200     02  FILLER     PICTURE X(26)  VALUE SPACE.
021300 01  CCVS-H-2.
021400     02 FILLER PICTURE X(52) VALUE IS
021500     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
021600     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
021700     02 TEST-ID PICTURE IS X(9).
021800     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
021900 01  CCVS-H-3.
022000     02  FILLER PICTURE X(34) VALUE
022100     " FOR OFFICIAL USE ONLY    ".
022200     02  FILLER PICTURE X(58) VALUE
022300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022400     02  FILLER PICTURE X(28) VALUE
022500     "  COPYRIGHT   1985 ".
022600 01  CCVS-E-1.
022700     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
022800     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
022900     02 ID-AGAIN PICTURE IS X(9).
023000     02 FILLER PICTURE X(45) VALUE IS
023100     " NTIS DISTRIBUTION COBOL 85".
023200 01  CCVS-E-2.
023300     02  FILLER                   PICTURE X(31)  VALUE
023400     SPACE.
023500     02  FILLER                   PICTURE X(21)  VALUE SPACE.
023600     02 CCVS-E-2-2.
023700         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
023800         03 FILLER PICTURE IS X VALUE IS SPACE.
023900         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
024000 01  CCVS-E-3.
024100     02  FILLER PICTURE X(22) VALUE
024200     " FOR OFFICIAL USE ONLY".
024300     02  FILLER PICTURE X(12) VALUE SPACE.
024400     02  FILLER PICTURE X(58) VALUE
024500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024600     02  FILLER PICTURE X(13) VALUE SPACE.
024700     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
024800 01  CCVS-E-4.
024900     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
025000     02 FILLER PIC XXXX VALUE " OF ".
025100     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
025200     02 FILLER PIC X(40) VALUE
025300      "  TESTS WERE EXECUTED SUCCESSFULLY".
025400 01  XXINFO.
025500     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
025600     02 INFO-TEXT.
025700     04 FILLER PIC X(20) VALUE SPACE.
025800     04 XXCOMPUTED PIC X(20).
025900     04 FILLER PIC X(5) VALUE SPACE.
026000     04 XXCORRECT PIC X(20).
026100 01  HYPHEN-LINE.
026200     02 FILLER PICTURE IS X VALUE IS SPACE.
026300     02 FILLER PICTURE IS X(65) VALUE IS "************************
026400-    "*****************************************".
026500     02 FILLER PICTURE IS X(54) VALUE IS "************************
026600-    "******************************".
026700 01  CCVS-PGM-ID PIC X(6) VALUE
026800     "SQ218A".
026900 PROCEDURE DIVISION.
027000 CCVS1 SECTION.
027100 OPEN-FILES.
027200P    OPEN I-O RAW-DATA.
027300P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
027400P    READ RAW-DATA INVALID KEY GO TO END-E-1.
027500P    MOVE "ABORTED " TO C-ABORT.
027600P    ADD 1 TO C-NO-OF-TESTS.
027700P    ACCEPT C-DATE  FROM DATE.
027800P    ACCEPT C-TIME  FROM TIME.
027900P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
028000PEND-E-1.
028100P    CLOSE RAW-DATA.
028200     OPEN     OUTPUT PRINT-FILE.
028300     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
028400     MOVE    SPACE TO TEST-RESULTS.
028500     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
028600     MOVE ZERO TO REC-SKL-SUB.
028700     PERFORM CCVS-INIT-FILE 9 TIMES.
028800 CCVS-INIT-FILE.
028900     ADD 1 TO REC-SKL-SUB.
029000     MOVE FILE-RECORD-INFO-SKELETON TO
029100                  FILE-RECORD-INFO (REC-SKL-SUB).
029200 CCVS-INIT-EXIT.
029300     GO TO CCVS1-EXIT.
029400 CLOSE-FILES.
029500     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
029600P    OPEN I-O RAW-DATA.
029700P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
029800P    READ RAW-DATA INVALID KEY GO TO END-E-2.
029900P    MOVE "OK.     " TO C-ABORT.
030000P    MOVE PASS-COUNTER TO C-OK.
030100P    MOVE ERROR-HOLD   TO C-ALL.
030200P    MOVE ERROR-COUNTER TO C-FAIL.
030300P    MOVE DELETE-CNT TO C-DELETED.
030400P    MOVE INSPECT-COUNTER TO C-INSPECT.
030500P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
030600PEND-E-2.
030700P    CLOSE RAW-DATA.
030800 TERMINATE-CCVS.
030900S    EXIT PROGRAM.
031000STERMINATE-CALL.
031100     STOP     RUN.
031200 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
031300 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
031400 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
031500 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
031600     MOVE "****TEST DELETED****" TO RE-MARK.
031700 PRINT-DETAIL.
031800     IF REC-CT NOT EQUAL TO ZERO
031900             MOVE "." TO PARDOT-X
032000             MOVE REC-CT TO DOTVALUE.
032100     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
032200     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
032300        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
032400          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
032500     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
032600     MOVE SPACE TO CORRECT-X.
032700     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
032800     MOVE     SPACE TO RE-MARK.
032900 HEAD-ROUTINE.
033000     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033100     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033200     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
033300 COLUMN-NAMES-ROUTINE.
033400     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033500     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
033700 END-ROUTINE.
033800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033900 END-RTN-EXIT.
034000     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034100 END-ROUTINE-1.
034200      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
034300      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
034400      ADD PASS-COUNTER TO ERROR-HOLD.
034500*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
034600      MOVE PASS-COUNTER TO CCVS-E-4-1.
034700      MOVE ERROR-HOLD TO CCVS-E-4-2.
034800      MOVE CCVS-E-4 TO CCVS-E-2-2.
034900      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
035000  END-ROUTINE-12.
035100      MOVE "TEST(S) FAILED" TO ENDER-DESC.
035200     IF       ERROR-COUNTER IS EQUAL TO ZERO
035300         MOVE "NO " TO ERROR-TOTAL
035400         ELSE
035500         MOVE ERROR-COUNTER TO ERROR-TOTAL.
035600     MOVE     CCVS-E-2 TO DUMMY-RECORD.
035700     PERFORM WRITE-LINE.
035800 END-ROUTINE-13.
035900     IF DELETE-CNT IS EQUAL TO ZERO
036000         MOVE "NO " TO ERROR-TOTAL  ELSE
036100         MOVE DELETE-CNT TO ERROR-TOTAL.
036200     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
036300     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036400      IF   INSPECT-COUNTER EQUAL TO ZERO
036500          MOVE "NO " TO ERROR-TOTAL
036600      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
036700      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
036800      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036900     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037000 WRITE-LINE.
037100     ADD 1 TO RECORD-COUNT.
037200Y    IF RECORD-COUNT GREATER 50
037300Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
037400Y        MOVE SPACE TO DUMMY-RECORD
037500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
037600Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
037700Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
037800Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
037900Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
038000Y        MOVE ZERO TO RECORD-COUNT.
038100     PERFORM WRT-LN.
038200 WRT-LN.
038300     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
038400     MOVE SPACE TO DUMMY-RECORD.
038500 BLANK-LINE-PRINT.
038600     PERFORM WRT-LN.
038700 FAIL-ROUTINE.
038800     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
038900     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
039000     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
039100     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039200     GO TO FAIL-ROUTINE-EX.
039300 FAIL-ROUTINE-WRITE.
039400     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
039500     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
039600 FAIL-ROUTINE-EX. EXIT.
039700 BAIL-OUT.
039800     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
039900     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
040000 BAIL-OUT-WRITE.
040100     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
040200     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040300 BAIL-OUT-EX. EXIT.
040400 CCVS1-EXIT.
040500     EXIT.
040600 SECT-SQ218A-0001 SECTION.
040700 WRITE-INIT-GF-01.
040800     MOVE "SQ-VS6" TO XFILE-NAME (1).
040900     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
041000     MOVE "RC" TO CHARS-OR-RECORDS (1).
041100     MOVE 0001 TO XBLOCK-SIZE (1).
041200     MOVE 000450 TO RECORDS-IN-FILE (1).
041300     MOVE "SQ" TO XFILE-ORGANIZATION (1).
041400     MOVE "S" TO XLABEL-TYPE (1).
041500     MOVE 000000 TO XRECORD-NUMBER (1).
041600     MOVE ZERO TO COUNT-OF-RECS.
041700     OPEN OUTPUT SQ-VS6.
041800     MOVE "MULTIPLE LENGTH RECS " TO SQ-VS6-FILLER.
041900 WRITE-TEST-GF-01.
042000     PERFORM WRITE-SHORT-REC.
042100     PERFORM WRITE-LONG-REC.
042200     PERFORM WRITE-SHORT-REC 10 TIMES.
042300     PERFORM WRITE-LONG-REC 100 TIMES.
042400     PERFORM WRITE-SHORT-REC 338 TIMES.
042500 WRITE-WRITE-GF-01.
042600     MOVE "CREATE FILE SQ-VS6" TO FEATURE.
042700     MOVE "WRITE-TEST-GF-01" TO PAR-NAME.
042800     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
042900     MOVE COUNT-OF-RECS TO CORRECT-18V0.
043000     MOVE "FILE HAS 120 AND 151 CHAR RECS" TO RE-MARK.
043100     PERFORM PRINT-DETAIL.
043200*         A SEQUENTIAL TAPE FILE CONTAINING 450 RECORDS HAS
043300*    BEEN CREATED.  THE FILE CONTAINS RECORDS OF 120 CHARACTERS
043400*    AND RECORDS OF 151 CHARACTERS.  THE SEQUENCE IN WHICH THE
043500*    RECORDS WERE WRITTEN IS S-L-10S-100L-338S.
043600 WRITE-CLOSE-GF-01.
043700     CLOSE SQ-VS6.
043800     GO TO READ-INIT-F1-01.
043900 WRITE-SHORT-REC.
044000     MOVE "R1-M-G" TO XRECORD-NAME (1).
044100     MOVE 000120 TO XRECORD-LENGTH (1).
044200     ADD 1 TO COUNT-OF-RECS.
044300     MOVE COUNT-OF-RECS TO XRECORD-NUMBER (1).
044400     MOVE "SHORT" TO LONG-OR-SHORT.
044500     MOVE COUNT-OF-RECS TO SQ-VS6-RECNO.
044600     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-VS6R1-FIRST.
044700     WRITE SQ-VS6R1-M-G-120.
044800 WRITE-LONG-REC.
044900     MOVE "R2-M-G" TO XRECORD-NAME (1).
045000     MOVE 000151 TO XRECORD-LENGTH (1).
045100     ADD 1 TO COUNT-OF-RECS.
045200     MOVE COUNT-OF-RECS TO XRECORD-NUMBER (1).
045300     MOVE "LONG" TO LONG-OR-SHORT.
045400     MOVE COUNT-OF-RECS TO SQ-VS6-RECNO.
045500     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-VS6R2-FIRST.
045600     WRITE SQ-VS6R2-M-G-151.
045700 READ-INIT-F1-01.
045800     MOVE ZERO TO COUNT-OF-RECS.
045900     MOVE ZERO TO EOF-FLAG.
046000     MOVE ZERO TO RECORDS-IN-ERROR.
046100     MOVE ZERO TO ERROR-FLAG.
046200     OPEN INPUT SQ-VS6.
046300 READ-TEST-F1-01.
046400     PERFORM READ-SHORT-REC THRU READ-SHORT-REC-EXIT.
046500     IF EOF-FLAG EQUAL TO 1
046600         MOVE "EOF ON FIRST READ" TO RE-MARK
046700         GO TO READ-EOF-F1-06.
046800     IF ERROR-FLAG EQUAL TO 1
046900         GO TO READ-FAIL-F1-01.
047000 READ-PASS-F1-01.
047100     PERFORM PASS.
047200     GO TO READ-WRITE-F1-01.
047300 READ-FAIL-F1-01.
047400     MOVE "ERROR ON FIRST READ;VII-13 SR (2), GR (1,2)" TO RE-MARK
047500     PERFORM FAIL.
047600 READ-WRITE-F1-01.
047700     MOVE "READ SHORT RECORD" TO FEATURE.
047800     MOVE "READ-TEST-F1-01" TO PAR-NAME.
047900     PERFORM PRINT-DETAIL.
048000     GO TO READ-INIT-F1-02.
048100 READ-SHORT-REC.
048200     IF EOF-FLAG EQUAL TO 1
048300          GO TO READ-SHORT-REC-EXIT.
048400     READ SQ-VS6 AT END
048500          MOVE 1 TO EOF-FLAG
048600          GO TO READ-SHORT-REC-EXIT.
048700     ADD 1 TO COUNT-OF-RECS.
048800     MOVE SQ-VS6R1-FIRST TO FILE-RECORD-INFO-P1-120 (1).
048900     IF XRECORD-NAME (1) NOT EQUAL TO "R1-M-G"
049000          GO TO READ-SHORT-REC-ERROR.
049100     IF XRECORD-LENGTH (1) NOT EQUAL TO 120
049200          GO TO READ-SHORT-REC-ERROR.
049300     IF COUNT-OF-RECS NOT EQUAL TO XRECORD-NUMBER (1)
049400          GO TO READ-SHORT-REC-ERROR.
049500     IF XLABEL-TYPE (1) EQUAL TO "S"
049600          GO TO READ-SHORT-REC-EXIT.
049700 READ-SHORT-REC-ERROR.
049800     ADD 1 TO RECORDS-IN-ERROR.
049900     MOVE 1 TO ERROR-FLAG.
050000 READ-SHORT-REC-EXIT.
050100     EXIT.
050200 READ-INIT-F1-02.
050300     MOVE ZERO TO ERROR-FLAG.
050400 READ-TEST-F1-02.
050500     PERFORM READ-LONG-REC THRU READ-LONG-REC-EXIT.
050600     IF EOF-FLAG EQUAL TO 1
050700          MOVE "EOF ON SECOND READ" TO RE-MARK
050800          GO TO READ-EOF-F1-06.
050900     IF ERROR-FLAG EQUAL TO 1
051000          GO TO READ-FAIL-F1-02.
051100 READ-PASS-F1-02.
051200     PERFORM PASS.
051300     GO TO READ-WRITE-F1-02.
051400 READ-FAIL-F1-02.
051500     MOVE "ERROR ON SEC READ; VII-13 SR (2), GR (1,2)" TO RE-MARK
051600     PERFORM FAIL.
051700 READ-WRITE-F1-02.
051800     MOVE "READ LONG RECORD" TO FEATURE.
051900     MOVE "READ-TEST-F1-02" TO PAR-NAME.
052000     PERFORM PRINT-DETAIL.
052100     GO TO READ-INIT-F1-03.
052200 READ-LONG-REC.
052300     IF EOF-FLAG EQUAL TO 1
052400         GO TO READ-LONG-REC-EXIT.
052500     READ SQ-VS6 END
052600         MOVE 1 TO EOF-FLAG
052700         GO TO READ-LONG-REC-EXIT.
052800     ADD 1 TO COUNT-OF-RECS.
052900     MOVE SQ-VS6R2-FIRST TO FILE-RECORD-INFO-P1-120 (1).
053000     IF XRECORD-NAME (1) NOT EQUAL TO "R2-M-G"
053100         GO TO READ-LONG-REC-ERROR.
053200     IF XRECORD-LENGTH (1) NOT EQUAL TO 151
053300         GO TO READ-LONG-REC-ERROR.
053400     MOVE COUNT-OF-RECS TO SAVE-COUNT-OF-RECS.
053500     IF SAVE-COUNT-OF-RECS NOT EQUAL TO SQ-VS6-RECNO
053600         GO TO READ-LONG-REC-ERROR.
053700     IF LONG-OR-SHORT EQUAL TO "LONG "
053800         GO TO READ-LONG-REC-EXIT.
053900 READ-LONG-REC-ERROR.
054000     ADD 1 TO RECORDS-IN-ERROR.
054100     MOVE 1 TO ERROR-FLAG.
054200 READ-LONG-REC-EXIT.
054300     EXIT.
054400 READ-INIT-F1-03.
054500     MOVE ZERO TO ERROR-FLAG.
054600 READ-TEST-F1-03.
054700     PERFORM READ-SHORT-REC THRU READ-SHORT-REC-EXIT 10 TIMES.
054800     IF EOF-FLAG EQUAL TO 1
054900          MOVE "UNEXPECTED EOF" TO RE-MARK
055000          GO TO READ-EOF-F1-06.
055100     IF ERROR-FLAG EQUAL TO 1
055200          GO TO READ-FAIL-F1-03.
055300 READ-PASS-F1-03.
055400     PERFORM PASS.
055500     GO TO READ-WRITE-F1-03.
055600 READ-FAIL-F1-03.
055700     MOVE "ERROR REA SHORT REC;VII-13 SR (2), GR (1,2)" TO RE-MARK
055800     PERFORM FAIL.
055900 READ-WRITE-F1-03.
056000     MOVE "READ SHORT RECORDS" TO FEATURE.
056100     MOVE "READ-TEST-F1-03" TO PAR-NAME.
056200     PERFORM PRINT-DETAIL.
056300 READ-INIT-F1-04.
056400     MOVE ZERO TO ERROR-FLAG.
056500 READ-TEST-F1-04.
056600     PERFORM READ-LONG-REC THRU READ-LONG-REC-EXIT 100 TIMES.
056700     IF EOF-FLAG EQUAL TO 1
056800         MOVE "UNEXPECTED EOF" TO RE-MARK
056900         GO TO READ-EOF-F1-06.
057000     IF ERROR-FLAG EQUAL TO 1
057100         GO TO READ-FAIL-F1-04.
057200 READ-PASS-F1-04.
057300     PERFORM PASS.
057400     GO TO READ-WRITE-F1-04.
057500 READ-FAIL-F1-04.
057600     PERFORM FAIL.
057700     MOVE "ERROR READING LONG RECORD" TO RE-MARK.
057800 READ-WRITE-F1-04.
057900     MOVE "READ LONG RECORDS" TO FEATURE.
058000     MOVE "READ-TEST-F1-04" TO PAR-NAME.
058100     PERFORM PRINT-DETAIL.
058200 READ-INIT-F1-05.
058300     MOVE ZERO TO ERROR-FLAG.
058400 READ-TEST-F1-05.
058500     PERFORM READ-SHORT-REC THRU READ-SHORT-REC-EXIT 338 TIMES.
058600     IF EOF-FLAG EQUAL TO 1
058700         MOVE "UNEXPECTED EOF" TO RE-MARK
058800         GO TO READ-EOF-F1-06.
058900     IF ERROR-FLAG EQUAL TO 1
059000         GO TO READ-FAIL-F1-05.
059100 READ-PASS-F1-05.
059200     PERFORM PASS.
059300     GO TO READ-WRITE-F1-05.
059400 READ-FAIL-F1-05.
059500     MOVE "ERROR READING SHORT;VII-13 SR (2), GR (1,2)" TO RE-MARK
059600     PERFORM FAIL.
059700 READ-WRITE-F1-05.
059800     MOVE "READ SHORT RECORDS" TO FEATURE.
059900     MOVE "READ-TEST-F1-05" TO PAR-NAME.
060000     PERFORM PRINT-DETAIL.
060100 READ-INIT-F1-06.
060200     READ SQ-VS6 RECORD END
060300         GO TO READ-TEST-F1-06.
060400     MOVE "MORE THAN 450 RECORDS" TO RE-MARK.
060500     GO TO READ-FAIL-F1-06.
060600 READ-EOF-F1-06.
060700     MOVE "RECORDS READ =" TO COMPUTED-A.
060800     MOVE COUNT-OF-RECS TO CORRECT-18V0.
060900     GO TO READ-FAIL-F1-06.
061000 READ-TEST-F1-06.
061100     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
061200         MOVE "RECORDS IN ERROR =" TO COMPUTED-A
061300         MOVE RECORDS-IN-ERROR TO CORRECT-18V0
061400         GO TO READ-FAIL-F1-06.
061500 READ-PASS-F1-06.
061600     PERFORM PASS.
061700     GO TO READ-WRITE-F1-06.
061800 READ-FAIL-F1-06.
061900     MOVE "VII-13 SR (2), GR (1,2)" TO RE-MARK.
062000     PERFORM FAIL.
062100 READ-WRITE-F1-06.
062200     MOVE "READ-TEST-F1-06" TO PAR-NAME.
062300     MOVE "VERIFY FILE SQ-VS6" TO FEATURE.
062400     PERFORM PRINT-DETAIL.
062500 READ-CLOSE-F1-06.
062600     CLOSE SQ-VS6.
062700 SECT-SQ218A-0002 SECTION.
062800*        THIS SECTION CHECKS IF THE ENTIRE RECORD AREA IS WRITTEN
062900*    ON THE OUTPUT DEVICE WHEN A SHORT RECORD IS WRITTEN.  THE
063000*    RECORD NUMBER IN CHARACTERS 126 THROUGH 130 IS UNIQUE
063100*    FOR EACH RECORD.
063200 INFO-INIT-001.
063300     OPEN INPUT SQ-VS6.
063400     MOVE ZERO TO COUNT-OF-RECS.
063500 INFO-TEST-001.
063600     READ SQ-VS6 AT END
063700          GO TO INFO-END.
063800     ADD 1 TO COUNT-OF-RECS.
063900     IF SQ-VS6-RECNO NOT EQUAL TO "00001"
064000          GO TO NO-INFO-001.
064100     MOVE "MAXIMUM RECORD SIZE WRITTEN" TO RE-MARK.
064200     MOVE "RECORD READ =" TO COMPUTED-A.
064300     MOVE 0001 TO CORRECT-18V0.
064400     GO TO INFO-WRITE-001.
064500 NO-INFO-001.
064600     MOVE "NO DEFINITE CONCLUSION POSSIBLE" TO RE-MARK.
064700 INFO-WRITE-001.
064800     MOVE "READ SHORT RECORD" TO FEATURE.
064900     MOVE "INFO-TEST-001" TO PAR-NAME.
065000     PERFORM PRINT-DETAIL.
065100 INFO-INIT-002.
065200     READ SQ-VS6 RECORD AT END
065300          GO TO INFO-END.
065400     READ SQ-VS6 END
065500          GO TO INFO-END.
065600 INFO-TEST-002.
065700     READ SQ-VS6 AT END
065800          GO TO INFO-END.
065900     IF SQ-VS6-RECNO NOT EQUAL TO "00004"
066000          GO TO NO-INFO-002.
066100     MOVE "MAXIMUM RECORD SIZE WRITTEN" TO RE-MARK.
066200     MOVE "RECORD READ =" TO COMPUTED-A.
066300     MOVE 0004 TO CORRECT-18V0.
066400     GO TO INFO-WRITE-002.
066500 NO-INFO-002.
066600     MOVE "NO DEFINITE CONCLUSION POSSIBLE" TO RE-MARK.
066700 INFO-WRITE-002.
066800     MOVE "READ SHORT RECORD" TO FEATURE.
066900     MOVE "INFO-TEST-002" TO PAR-NAME.
067000     PERFORM PRINT-DETAIL.
067100 INFO-INIT-003.
067200     ADD 3 TO COUNT-OF-RECS.
067300 INFO-INIT-003-1.
067400     READ SQ-VS6 RECORD
067500          END GO TO INFO-END.
067600     ADD 1 TO COUNT-OF-RECS.
067700     IF COUNT-OF-RECS EQUAL TO 450
067800         GO TO INFO-TEST-003.
067900     GO TO INFO-INIT-003-1.
068000 INFO-TEST-003.
068100     IF SQ-VS6-RECNO NOT EQUAL TO "00450"
068200          GO TO NO-INFO-003.
068300     MOVE "MAXIMUM RECORD SIZE WRITTEN" TO RE-MARK.
068400     MOVE "RECORD READ =" TO COMPUTED-A.
068500     MOVE 0450 TO CORRECT-18V0.
068600     GO TO INFO-WRITE-003.
068700 NO-INFO-003.
068800     MOVE "NO DEFINITE CONCLUSION POSSIBLE" TO RE-MARK.
068900 INFO-WRITE-003.
069000     MOVE "READ SHORT RECORD" TO FEATURE.
069100     MOVE "INFO-TEST-003" TO PAR-NAME.
069200     PERFORM PRINT-DETAIL.
069300 INFO-END.
069400     CLOSE SQ-VS6.
069500 TERMINATE-ROUTINE.
069600     EXIT.
069700 CCVS-EXIT SECTION.
069800 CCVS-999999.
069900     GO TO CLOSE-FILES.
