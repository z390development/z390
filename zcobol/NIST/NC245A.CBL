000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     NC245A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*                                                              *
002200*    PROGRAM NC245A TESTS THE USE OF THE COMMA, SEMI-COLON AND *
002300*    SPACE SEPARATORS WHEN SPECIFYING SUBSCRIPTS AND INDICES   *
002400*    TO ACCESS TWO AND THREE-DIMENSIONAL TABLES                *
002500*    RELATIVE INDEXING IS ALSO USED.                           *
002600*                                                              *
002700****************************************************************
002800 ENVIRONMENT DIVISION.
002900 CONFIGURATION SECTION.
003000 SOURCE-COMPUTER.
003100     XXXXX082.
003200 OBJECT-COMPUTER.
003300     XXXXX083.
003400 INPUT-OUTPUT SECTION.
003500 FILE-CONTROL.
003600     SELECT PRINT-FILE ASSIGN TO
003700     XXXXX055.
003800 DATA DIVISION.
003900 FILE SECTION.
004000 FD  PRINT-FILE.
004100 01  PRINT-REC PICTURE X(120).
004200 01  DUMMY-RECORD PICTURE X(120).
004300 WORKING-STORAGE SECTION.
004400 77  WRK1 PIC S999; COMPUTATIONAL, VALUE ZERO.
004500 77  EXPECTED-VALUE,   PIC    S999999.
004600 77  TEMP; PIC S999999.
004700*    TWO DIMENSIONAL TABLE; 15 X 10.
004800 01  GRP-TAB2.
004900     02  GRP-LEV2-0015F; OCCURS 15 TIMES;
005000         INDEXED BY IN1,  INDEX1,
005100         USAGE IS COMPUTATIONAL.
005200         03  ELEM2 PIC S999999; OCCURS 10 TIMES;
005300                INDEXED BY IN2; INDEX2.
005400*    THREE DIMENSIONAL TABLE; 10 X 5 X 3.
005500 01  GRP-TAB3.
005600     02  GRP-LEV2-0003F; OCCURS 3 TIMES;
005700         INDEXED BY INAME1, IN-NAME-1,
005800         USAGE IS COMPUTATIONAL.
005900         03  GRP-LEV3-0005F; OCCURS 5 TIMES;
006000             INDEXED BY INAME2; IN-NAME-2.
006100             04  ELEM3 PIC S999999; OCCURS 10 TIMES;
006200                 INDEXED BY INAME3; IN-NAME-3.
006300*    SUBSCRIPTS FOR REFERENCING TABLE ITEMS
006400 01  SUBSCRIPT-TABLE; USAGE COMPUTATIONAL.
006500     02  S21  PIC S999; VALUE IS 1.
006600     02  S22  PIC S999; VALUE IS 1.
006700     02  S31  PIC S999; VALUE IS 1.
006800     02  S32  PIC S999; VALUE IS 1.
006900     02  S33  PIC S999; VALUE IS 1.
007000 01  TEST-RESULTS.
007100     02 FILLER                   PIC X      VALUE SPACE.
007200     02 FEATURE                  PIC X(20)  VALUE SPACE.
007300     02 FILLER                   PIC X      VALUE SPACE.
007400     02 P-OR-F                   PIC X(5)   VALUE SPACE.
007500     02 FILLER                   PIC X      VALUE SPACE.
007600     02  PAR-NAME.
007700       03 FILLER                 PIC X(19)  VALUE SPACE.
007800       03  PARDOT-X              PIC X      VALUE SPACE.
007900       03 DOTVALUE               PIC 99     VALUE ZERO.
008000     02 FILLER                   PIC X(8)   VALUE SPACE.
008100     02 RE-MARK                  PIC X(61).
008200 01  TEST-COMPUTED.
008300     02 FILLER                   PIC X(30)  VALUE SPACE.
008400     02 FILLER                   PIC X(17)  VALUE
008500            "       COMPUTED=".
008600     02 COMPUTED-X.
008700     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
008800     03 COMPUTED-N               REDEFINES COMPUTED-A
008900                                 PIC -9(9).9(9).
009000     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
009100     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
009200     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
009300     03       CM-18V0 REDEFINES COMPUTED-A.
009400         04 COMPUTED-18V0                    PIC -9(18).
009500         04 FILLER                           PIC X.
009600     03 FILLER PIC X(50) VALUE SPACE.
009700 01  TEST-CORRECT.
009800     02 FILLER PIC X(30) VALUE SPACE.
009900     02 FILLER PIC X(17) VALUE "       CORRECT =".
010000     02 CORRECT-X.
010100     03 CORRECT-A                  PIC X(20) VALUE SPACE.
010200     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
010300     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
010400     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
010500     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
010600     03      CR-18V0 REDEFINES CORRECT-A.
010700         04 CORRECT-18V0                     PIC -9(18).
010800         04 FILLER                           PIC X.
010900     03 FILLER PIC X(2) VALUE SPACE.
011000     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
011100 01  CCVS-C-1.
011200     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
011300-    "SS  PARAGRAPH-NAME
011400-    "       REMARKS".
011500     02 FILLER                     PIC X(20)    VALUE SPACE.
011600 01  CCVS-C-2.
011700     02 FILLER                     PIC X        VALUE SPACE.
011800     02 FILLER                     PIC X(6)     VALUE "TESTED".
011900     02 FILLER                     PIC X(15)    VALUE SPACE.
012000     02 FILLER                     PIC X(4)     VALUE "FAIL".
012100     02 FILLER                     PIC X(94)    VALUE SPACE.
012200 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
012300 01  REC-CT                        PIC 99       VALUE ZERO.
012400 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
012500 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
012600 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
012700 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
012800 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
012900 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
013000 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
013100 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
013200 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
013300 01  CCVS-H-1.
013400     02  FILLER                    PIC X(39)    VALUE SPACES.
013500     02  FILLER                    PIC X(42)    VALUE
013600     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
013700     02  FILLER                    PIC X(39)    VALUE SPACES.
013800 01  CCVS-H-2A.
013900   02  FILLER                        PIC X(40)  VALUE SPACE.
014000   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
014100   02  FILLER                        PIC XXXX   VALUE
014200     "4.2 ".
014300   02  FILLER                        PIC X(28)  VALUE
014400            " COPY - NOT FOR DISTRIBUTION".
014500   02  FILLER                        PIC X(41)  VALUE SPACE.
014600
014700 01  CCVS-H-2B.
014800   02  FILLER                        PIC X(15)  VALUE
014900            "TEST RESULT OF ".
015000   02  TEST-ID                       PIC X(9).
015100   02  FILLER                        PIC X(4)   VALUE
015200            " IN ".
015300   02  FILLER                        PIC X(12)  VALUE
015400     " HIGH       ".
015500   02  FILLER                        PIC X(22)  VALUE
015600            " LEVEL VALIDATION FOR ".
015700   02  FILLER                        PIC X(58)  VALUE
015800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
015900 01  CCVS-H-3.
016000     02  FILLER                      PIC X(34)  VALUE
016100            " FOR OFFICIAL USE ONLY    ".
016200     02  FILLER                      PIC X(58)  VALUE
016300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
016400     02  FILLER                      PIC X(28)  VALUE
016500            "  COPYRIGHT   1985 ".
016600 01  CCVS-E-1.
016700     02 FILLER                       PIC X(52)  VALUE SPACE.
016800     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
016900     02 ID-AGAIN                     PIC X(9).
017000     02 FILLER                       PIC X(45)  VALUE SPACES.
017100 01  CCVS-E-2.
017200     02  FILLER                      PIC X(31)  VALUE SPACE.
017300     02  FILLER                      PIC X(21)  VALUE SPACE.
017400     02 CCVS-E-2-2.
017500         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
017600         03 FILLER                   PIC X      VALUE SPACE.
017700         03 ENDER-DESC               PIC X(44)  VALUE
017800            "ERRORS ENCOUNTERED".
017900 01  CCVS-E-3.
018000     02  FILLER                      PIC X(22)  VALUE
018100            " FOR OFFICIAL USE ONLY".
018200     02  FILLER                      PIC X(12)  VALUE SPACE.
018300     02  FILLER                      PIC X(58)  VALUE
018400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
018500     02  FILLER                      PIC X(13)  VALUE SPACE.
018600     02 FILLER                       PIC X(15)  VALUE
018700             " COPYRIGHT 1985".
018800 01  CCVS-E-4.
018900     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
019000     02 FILLER                       PIC X(4)   VALUE " OF ".
019100     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
019200     02 FILLER                       PIC X(40)  VALUE
019300      "  TESTS WERE EXECUTED SUCCESSFULLY".
019400 01  XXINFO.
019500     02 FILLER                       PIC X(19)  VALUE
019600            "*** INFORMATION ***".
019700     02 INFO-TEXT.
019800       04 FILLER                     PIC X(8)   VALUE SPACE.
019900       04 XXCOMPUTED                 PIC X(20).
020000       04 FILLER                     PIC X(5)   VALUE SPACE.
020100       04 XXCORRECT                  PIC X(20).
020200     02 INF-ANSI-REFERENCE           PIC X(48).
020300 01  HYPHEN-LINE.
020400     02 FILLER  PIC IS X VALUE IS SPACE.
020500     02 FILLER  PIC IS X(65)    VALUE IS "************************
020600-    "*****************************************".
020700     02 FILLER  PIC IS X(54)    VALUE IS "************************
020800-    "******************************".
020900 01  CCVS-PGM-ID                     PIC X(9)   VALUE
021000     "NC245A".
021100 PROCEDURE DIVISION.
021200 CCVS1 SECTION.
021300 OPEN-FILES.
021400     OPEN     OUTPUT PRINT-FILE.
021500     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
021600     MOVE    SPACE TO TEST-RESULTS.
021700     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
021800     GO TO CCVS1-EXIT.
021900 CLOSE-FILES.
022000     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
022100 TERMINATE-CCVS.
022200S    EXIT PROGRAM.
022300STERMINATE-CALL.
022400     STOP     RUN.
022500 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
022600 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
022700 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
022800 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
022900     MOVE "****TEST DELETED****" TO RE-MARK.
023000 PRINT-DETAIL.
023100     IF REC-CT NOT EQUAL TO ZERO
023200             MOVE "." TO PARDOT-X
023300             MOVE REC-CT TO DOTVALUE.
023400     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
023500     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
023600        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
023700          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
023800     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
023900     MOVE SPACE TO CORRECT-X.
024000     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
024100     MOVE     SPACE TO RE-MARK.
024200 HEAD-ROUTINE.
024300     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024400     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024500     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
024600     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
024700 COLUMN-NAMES-ROUTINE.
024800     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
024900     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
025100 END-ROUTINE.
025200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
025300 END-RTN-EXIT.
025400     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025500 END-ROUTINE-1.
025600      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
025700      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
025800      ADD PASS-COUNTER TO ERROR-HOLD.
025900*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
026000      MOVE PASS-COUNTER TO CCVS-E-4-1.
026100      MOVE ERROR-HOLD TO CCVS-E-4-2.
026200      MOVE CCVS-E-4 TO CCVS-E-2-2.
026300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
026400  END-ROUTINE-12.
026500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
026600     IF       ERROR-COUNTER IS EQUAL TO ZERO
026700         MOVE "NO " TO ERROR-TOTAL
026800         ELSE
026900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
027000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
027100     PERFORM WRITE-LINE.
027200 END-ROUTINE-13.
027300     IF DELETE-COUNTER IS EQUAL TO ZERO
027400         MOVE "NO " TO ERROR-TOTAL  ELSE
027500         MOVE DELETE-COUNTER TO ERROR-TOTAL.
027600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
027700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027800      IF   INSPECT-COUNTER EQUAL TO ZERO
027900          MOVE "NO " TO ERROR-TOTAL
028000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
028100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
028200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028400 WRITE-LINE.
028500     ADD 1 TO RECORD-COUNT.
028600Y    IF RECORD-COUNT GREATER 50
028700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
028800Y        MOVE SPACE TO DUMMY-RECORD
028900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
029000Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
029100Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
029200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
029300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
029400Y        MOVE ZERO TO RECORD-COUNT.
029500     PERFORM WRT-LN.
029600 WRT-LN.
029700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
029800     MOVE SPACE TO DUMMY-RECORD.
029900 BLANK-LINE-PRINT.
030000     PERFORM WRT-LN.
030100 FAIL-ROUTINE.
030200     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
030300     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
030400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
030500     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
030600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030700     MOVE   SPACES TO INF-ANSI-REFERENCE.
030800     GO TO  FAIL-ROUTINE-EX.
030900 FAIL-ROUTINE-WRITE.
031000     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
031100     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
031200     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
031300     MOVE   SPACES TO COR-ANSI-REFERENCE.
031400 FAIL-ROUTINE-EX. EXIT.
031500 BAIL-OUT.
031600     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
031700     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
031800 BAIL-OUT-WRITE.
031900     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
032000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
032100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032200     MOVE   SPACES TO INF-ANSI-REFERENCE.
032300 BAIL-OUT-EX. EXIT.
032400 CCVS1-EXIT.
032500     EXIT.
032600*        SECTION 2.1.6 ON PAGE IV-3 OF AMERICAN NATIONAL
032700*    STANDARD COBOL, X3.23 - 1985 STATES THAT COMMA AND
032800*    SEMICOLON ARE OPTIONAL WHERE SHOWN IN THE FORMATS AND
032900*    ARE INTERCHANGEABLE.  EITHER ONE MAY BE USED ANYWHERE
033000*    ONE OF THEM IS SHOWN IN THE LANGUAGE FORMATS.
033100*
033200*        THIS ROUTINE TESTS THE USE OF SEMICOLON IN PLACE OF
033300*    COMMA AS SEPARATORS FOR SUBSCRIPTS AND INDEXES IN
033400*    REFERENCING TABLE ITEMS.
033500****************************************
033600*STATEMENT DELETION INSTRUCTIONS
033700*        IF THE COMPILER REJECTS ANY TABLE REFERENCE IN THESE
033800*    TESTS, DELETE THAT LINE OF CODE BY PLACING AN * IN COLUMN 7.
033900*    LEAVE THE PERFORM ... THRU STATEMENT.  THE TEST DELETED
034000*    APPEARS AS A FAILURE ON THE OUTPUT REPORT.
034100****************************************
034200 SECT-NC245A-001 SECTION.
034300*        THIS SECTION STORES THE VALUES 1 THRU 150 IN THE
034400*    TWO TABLES USED IN THE TESTS OF SEMICOLON AS SUBSCRIPT
034500*    AND INDEX SEPARATOR.
034600 BUILD-TABLE.
034700     ADD 1 TO WRK1.
034800     MOVE WRK1 TO ELEM2 (S21, S22)
034900                  ELEM3 (S31, S32, S33).
035000     IF WRK1 EQUAL TO 150 GO TO SECT-TH219-0002.
035100 INCRE-SUBS.
035200     ADD 1 TO S22, S33.
035300     IF S22 LESS THAN 11 GO TO BUILD-TABLE.
035400     MOVE 1 TO S22, S33.
035500     ADD 1 TO S21, S32.
035600     IF S32 LESS THAN 6 GO TO BUILD-TABLE.
035700     MOVE 1 TO S32.
035800     ADD 1 TO S31.
035900     GO TO BUILD-TABLE.
036000 SECT-TH219-0002 SECTION.
036100*        THIS SECTION CONTAINS THE TESTS ON THE USE OF SEMICOLON
036200*    AS A SEPARATOR IN REFERENCING TABLE ITEMS.
036300 SEP-INIT-008.
036400     MOVE "SEP-TEST-008" TO PAR-NAME.
036500     MOVE "SEMICLN AS SEPARATOR" TO FEATURE.
036600     MOVE 0 TO REC-CT.
036700     MOVE 0 TO TEMP.
036800     MOVE 6 TO EXPECTED-VALUE.
036900     MOVE 1 TO S21.
037000     MOVE 6 TO S22.
037100*        THIS TEST USES SPACES AND SEMICOLONS IN REFERENCING
037200*    TWO DIMENSIONAL TABLE ELEMENTS WITH SUBSCRIPTS.
037300 SEP-TEST-008-01.
037400     MOVE ELEM2 (S21; S22) TO TEMP.
037500     PERFORM TEST-CHECK THRU TEST-WRITE.
037600 SEP-TEST-008-02.
037700     MOVE ELEM2(S21; S22) TO TEMP.
037800     PERFORM TEST-CHECK THRU TEST-WRITE.
037900 SEP-TEST-008-03.
038000     ADD ELEM2 (S21 ; S22) TO TEMP.
038100     PERFORM TEST-CHECK THRU TEST-WRITE.
038200 SEP-TEST-008-04.
038300     MOVE ELEM2( S21; S22 ) TO TEMP.
038400     PERFORM TEST-CHECK THRU TEST-WRITE.
038500 SEP-TEST-008-05.
038600     MOVE ELEM2 ( S21;  S22  ) TO TEMP.
038700     PERFORM TEST-CHECK THRU TEST-WRITE.
038800     GO TO SEP-INIT-009.
038900 SEP-DELETE-008.
039000     PERFORM DE-LETE.
039100     PERFORM TEST-WRITE.
039200 SEP-INIT-009.
039300     MOVE "SEP-TEST-009" TO PAR-NAME.
039400     MOVE 0 TO REC-CT.
039500     MOVE 0 TO TEMP.
039600     MOVE 150 TO EXPECTED-VALUE.
039700     MOVE 3 TO S31.
039800     MOVE 5 TO S32.
039900     MOVE 10 TO S33.
040000*        THIS TEST USES SEMICOLONS, COMMAS, AND SPACES IN
040100*    REFERENCING THREE DIMENSIONAL TABLE ELEMENTS WITH SUBSCRIPTS.
040200 SEP-TEST-009-01.
040300     MOVE ELEM3 (S31; S32; S33) TO TEMP.
040400     PERFORM TEST-CHECK THRU TEST-WRITE.
040500 SEP-TEST-009-02.
040600     MOVE ELEM3(S31; S32; S33) TO TEMP.
040700     PERFORM TEST-CHECK THRU TEST-WRITE.
040800 SEP-TEST-009-03.
040900     ADD ELEM3 (S31, S32; S33) TO TEMP.
041000     PERFORM TEST-CHECK THRU TEST-WRITE.
041100 SEP-TEST-009-04.
041200     MOVE     300 TO TEMP.
041300     SUBTRACT ELEM3 (S31; S32 S33) FROM TEMP.
041400     PERFORM TEST-CHECK THRU TEST-WRITE.
041500 SEP-TEST-009-05.
041600     MOVE ELEM3 (S31 ; S32 ; S33) TO TEMP.
041700     PERFORM TEST-CHECK THRU TEST-WRITE.
041800 SEP-TEST-009-06.
041900     MOVE ELEM3( S31   S32; S33) TO TEMP.
042000     PERFORM TEST-CHECK THRU TEST-WRITE.
042100     GO TO SEP-INIT-010.
042200 SEP-DELETE-009.
042300     PERFORM DE-LETE.
042400     PERFORM TEST-WRITE.
042500*
042600 SEP-INIT-010.
042700     MOVE "SEP-TEST-010" TO PAR-NAME.
042800     MOVE 0 TO REC-CT.
042900     MOVE 0 TO TEMP.
043000     MOVE 150 TO EXPECTED-VALUE.
043100*        THIS TEST USES SEMICOLONS, SPACES AND COMMAS IN
043200*    REFERENCING TABLE ELEMENTS WITH LITERAL SUBSCRIPTS.
043300 SEP-TEST-010-01.
043400     MOVE ELEM2 (15; 10) TO TEMP.
043500     PERFORM TEST-CHECK THRU TEST-WRITE.
043600 SEP-TEST-010-02.
043700     MOVE ELEM2 ( 15; 10 ) TO TEMP.
043800     PERFORM TEST-CHECK THRU TEST-WRITE.
043900 SEP-TEST-010-03.
044000     ADD ELEM2(15; 10) TO TEMP.
044100     PERFORM TEST-CHECK THRU TEST-WRITE.
044200 SEP-TEST-010-04.
044300     MOVE ELEM2 (+15; 10) TO TEMP.
044400     PERFORM TEST-CHECK THRU TEST-WRITE.
044500 SEP-TEST-010-05.
044600     ADD ELEM3 (3; 5; 10) TO TEMP.
044700     PERFORM TEST-CHECK THRU TEST-WRITE.
044800 SEP-TEST-010-06.
044900     MOVE ELEM3( +3; +5, +10) TO TEMP.
045000     PERFORM TEST-CHECK THRU TEST-WRITE.
045100 SEP-TEST-010-07.
045200     MOVE ELEM3 (+3, 5; 10) TO TEMP.
045300     PERFORM TEST-CHECK THRU TEST-WRITE.
045400     GO TO SEP-INIT-011.
045500 SEP-DELETE-010.
045600     PERFORM DE-LETE.
045700     PERFORM TEST-WRITE.
045800*
045900 SEP-INIT-011.
046000     MOVE "SEP-TEST-011" TO PAR-NAME.
046100     MOVE 0 TO TEMP; REC-CT.
046200     MOVE 135 TO EXPECTED-VALUE.
046300*        THIS TEST USES SEMICOLON, COMMA AND SPACE IN
046400*    REFERENCING 2 AND 3-DIM. TABLES WITH INDEXING.
046500 SEP-TEST-011-01.
046600     SET IN1 TO 14.
046700     SET IN2 TO  5.
046800     MOVE ELEM2 (IN1; IN2) TO TEMP.
046900     PERFORM TEST-CHECK THRU TEST-WRITE.
047000 SEP-TEST-011-02.
047100     SET INAME1 TO 3.
047200     SET INAME2 TO 4.
047300     SET INAME3 TO 5.
047400     MOVE ELEM3 (INAME1; INAME2; INAME3) TO TEMP.
047500     PERFORM TEST-CHECK THRU TEST-WRITE.
047600 SEP-TEST-011-03.
047700     MOVE ELEM3 (INAME1, INAME2; INAME3) TO TEMP.
047800     PERFORM TEST-CHECK THRU TEST-WRITE.
047900 SEP-TEST-011-04.
048000     MOVE ELEM3 (INAME1; INAME2 INAME3) TO TEMP.
048100     PERFORM TEST-CHECK THRU TEST-WRITE.
048200 SEP-TEST-011-05.
048300     MOVE ELEM3 (3; INAME2; 5) TO TEMP.
048400     PERFORM TEST-CHECK THRU TEST-WRITE.
048500 SEP-TEST-011-06.
048600     MOVE ELEM3 (3, INAME2; 5) TO TEMP.
048700     PERFORM TEST-CHECK THRU TEST-WRITE.
048800     GO TO SEP-INIT-012.
048900 SEP-DELETE-011.
049000     PERFORM DE-LETE.
049100     PERFORM TEST-WRITE.
049200*
049300 SEP-INIT-012.
049400     MOVE "SEP-TEST-012" TO PAR-NAME.
049500     MOVE ZERO TO TEMP; REC-CT.
049600     MOVE 123 TO EXPECTED-VALUE.
049700*        THIS TEST USES SEMICOLON, COMMA AND SPACE AS
049800*    SEPARATORS IN REFERENCING 3-DIMENSIONAL TABLE
049900*    ITEMS WITH RELATIVE INDEXING.
050000 SEP-TEST-012-01.
050100     SET INAME1; INAME2; INAME3 TO 3.
050200     SET IN-NAME-1; IN-NAME-2; IN-NAME-3 TO 1.
050300     MOVE ELEM3 (IN-NAME-1 + 2; INAME2; 3) TO TEMP.
050400     PERFORM TEST-CHECK THRU TEST-WRITE.
050500 SEP-TEST-012-02.
050600     MOVE ELEM3 (IN-NAME-1 + 2; IN-NAME-2 + 2;
050700         IN-NAME-3 + 2) TO TEMP.
050800     PERFORM TEST-CHECK THRU TEST-WRITE.
050900 SEP-TEST-012-03.
051000     MOVE ELEM3 (INAME1; IN-NAME-2 + 2; IN-NAME-3 + 2)
051100         TO TEMP.
051200     PERFORM TEST-CHECK THRU TEST-WRITE.
051300 SEP-TEST-012-04.
051400     MOVE ELEM3 (+3, INAME2; IN-NAME-3 + 2) TO TEMP.
051500     PERFORM TEST-CHECK THRU TEST-WRITE.
051600     GO TO CCVS-EXIT.
051700 SEP-DELETE-012.
051800     PERFORM DE-LETE.
051900     PERFORM TEST-WRITE.
052000*
052100 SECT-TH219-0003 SECTION.
052200*
052300 TEST-CHECK.
052400     ADD 1 TO REC-CT.
052500     IF TEMP IS EQUAL TO EXPECTED-VALUE
052600         PERFORM PASS
052700         GO TO TEST-WRITE.
052800 TEST-FAIL.
052900     PERFORM FAIL.
053000     MOVE TEMP TO COMPUTED-18V0.
053100     MOVE EXPECTED-VALUE TO CORRECT-18V0.
053200 TEST-WRITE.
053300     PERFORM PRINT-DETAIL.
053400     MOVE 0 TO TEMP.
053500 CCVS-EXIT SECTION.
053600 CCVS-999999.
053700     GO TO CLOSE-FILES.
