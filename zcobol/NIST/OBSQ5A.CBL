000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     OBSQ5A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    " HIGH       ".
000800*    USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
000900*                                                              *
001000*    CREATION DATE     /     VALIDATION DATE                   *
001100*    "4.2 ".
001200*                                                              *
001300*         THE ROUTINE OBSQ5A TESTS THE USE OF THE MULTIPLE FILE
001400*    CLAUSE BY READING AND VALIDATING THE TWO MULTIPLE FILE TAPES
001500*    CREATED IN OBSQ3A. TAPE ONE IS PROCESSED USING THE MULTIPLE
001600*    FILE CLAUSE WITH POSITION PHRASE.  ONLY FILE SQ-FS3 IS
001700*    SPECIFIED AND PROCESSED FROM THIS TAPE.  TAPE TWO IS
001800*    PROCESSED USING THE MULTIPLE FILE CLAUSE WITHOUT THE
001900*    POSITION PHRASE.  ALL FOUR FILES ON THIS TAPE ARE PROCESSED.
002000*    THESE FILES WERE CREATED USING A MULTIPLE FILE CLAUSE WITH
002100*    POSITION PHRASE.
002200 ENVIRONMENT DIVISION.
002300 CONFIGURATION SECTION.
002400 SOURCE-COMPUTER.
002500     XXXXX082.
002600 OBJECT-COMPUTER.
002700     XXXXX083.
002800 INPUT-OUTPUT SECTION.
002900 FILE-CONTROL.
003000P    SELECT RAW-DATA   ASSIGN TO
003100P    XXXXX062
003200P           ORGANIZATION IS INDEXED
003300P           ACCESS MODE IS RANDOM
003400P           RECORD KEY IS RAW-DATA-KEY.
003500     SELECT PRINT-FILE ASSIGN TO
003600     XXXXX055.
003700     SELECT SQ-FS3 ASSIGN TO
003800     XXXXD009.
003900     SELECT SQ-FS5 ASSIGN TO
004000     XXXXD005.
004100     SELECT SQ-FS6 ASSIGN TO
004200     XXXXD011.
004300     SELECT SQ-FS7 ASSIGN TO
004400     XXXXD012.
004500     SELECT SQ-FS8 ASSIGN TO
004600     XXXXD013.
004700 I-O-CONTROL.
004800     MULTIPLE FILE TAPE CONTAINS SQ-FS3 POSITION 3;
004900     MULTIPLE FILE TAPE SQ-FS5,
005000                        SQ-FS6,
005100                        SQ-FS7,
005200                        SQ-FS8.
005300 DATA DIVISION.
005400 FILE SECTION.
005500P
005600PFD  RAW-DATA.
005700P
005800P01  RAW-DATA-SATZ.
005900P    05  RAW-DATA-KEY        PIC X(6).
006000P    05  C-DATE              PIC 9(6).
006100P    05  C-TIME              PIC 9(8).
006200P    05  C-NO-OF-TESTS       PIC 99.
006300P    05  C-OK                PIC 999.
006400P    05  C-ALL               PIC 999.
006500P    05  C-FAIL              PIC 999.
006600P    05  C-DELETED           PIC 999.
006700P    05  C-INSPECT           PIC 999.
006800P    05  C-NOTE              PIC X(13).
006900P    05  C-INDENT            PIC X.
007000P    05  C-ABORT             PIC X(8).
007100 FD  PRINT-FILE.
007200 01  PRINT-REC PICTURE X(120).
007300 01  DUMMY-RECORD PICTURE X(120).
007400 FD  SQ-FS3
007500     LABEL RECORD IS STANDARD
007600     RECORD CONTAINS 120 CHARACTERS
007700     BLOCK CONTAINS 1200 CHARACTERS.
007800 01  SQ-FS3R1-F-G-120   PIC X(120).
007900 FD  SQ-FS5
008000     LABEL RECORD STANDARD
008100     BLOCK CONTAINS 5 RECORDS.
008200 01  SQ-FS5R1-F-G-120   PIC X(120).
008300 FD  SQ-FS6
008400     LABEL RECORD STANDARD
008500     BLOCK CONTAINS 10 RECORDS.
008600 01  SQ-FS6R1-F-G-120   PIC X(120).
008700 FD  SQ-FS7
008800     LABEL RECORD STANDARD
008900     BLOCK CONTAINS 2400 CHARACTERS.
009000 01  SQ-FS7R1-F-G-120   PIC X(120).
009100 FD  SQ-FS8
009200     LABEL RECORD STANDARD
009300     RECORD 120
009400     BLOCK CONTAINS 120 CHARACTERS.
009500 01  SQ-FS8R1-F-G-120   PIC X(120).
009600 WORKING-STORAGE SECTION.
009700 77  COUNT-OF-RECS  PICTURE 999 VALUE 0.
009800 77  RECORDS-IN-ERROR   PIC 999   VALUE 0.
009900 01  FILE-RECORD-INFORMATION-REC.
010000     03 FILE-RECORD-INFO-SKELETON.
010100        05 FILLER                 PICTURE X(48)       VALUE
010200             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
010300        05 FILLER                 PICTURE X(46)       VALUE
010400             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
010500        05 FILLER                 PICTURE X(26)       VALUE
010600             ",LFIL=000000,ORG=  ,LBLR= ".
010700        05 FILLER                 PICTURE X(37)       VALUE
010800             ",RECKEY=                             ".
010900        05 FILLER                 PICTURE X(38)       VALUE
011000             ",ALTKEY1=                             ".
011100        05 FILLER                 PICTURE X(38)       VALUE
011200             ",ALTKEY2=                             ".
011300        05 FILLER                 PICTURE X(7)        VALUE SPACE.
011400     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
011500        05 FILE-RECORD-INFO-P1-120.
011600           07 FILLER              PIC X(5).
011700           07 XFILE-NAME           PIC X(6).
011800           07 FILLER              PIC X(8).
011900           07 XRECORD-NAME         PIC X(6).
012000           07 FILLER              PIC X(1).
012100           07 REELUNIT-NUMBER     PIC 9(1).
012200           07 FILLER              PIC X(7).
012300           07 XRECORD-NUMBER       PIC 9(6).
012400           07 FILLER              PIC X(6).
012500           07 UPDATE-NUMBER       PIC 9(2).
012600           07 FILLER              PIC X(5).
012700           07 ODO-NUMBER          PIC 9(4).
012800           07 FILLER              PIC X(5).
012900           07 XPROGRAM-NAME        PIC X(5).
013000           07 FILLER              PIC X(7).
013100           07 XRECORD-LENGTH       PIC 9(6).
013200           07 FILLER              PIC X(7).
013300           07 CHARS-OR-RECORDS    PIC X(2).
013400           07 FILLER              PIC X(1).
013500           07 XBLOCK-SIZE          PIC 9(4).
013600           07 FILLER              PIC X(6).
013700           07 RECORDS-IN-FILE     PIC 9(6).
013800           07 FILLER              PIC X(5).
013900           07 XFILE-ORGANIZATION   PIC X(2).
014000           07 FILLER              PIC X(6).
014100           07 XLABEL-TYPE          PIC X(1).
014200        05 FILE-RECORD-INFO-P121-240.
014300           07 FILLER              PIC X(8).
014400           07 XRECORD-KEY          PIC X(29).
014500           07 FILLER              PIC X(9).
014600           07 ALTERNATE-KEY1      PIC X(29).
014700           07 FILLER              PIC X(9).
014800           07 ALTERNATE-KEY2      PIC X(29).
014900           07 FILLER              PIC X(7).
015000 01  TEST-RESULTS.
015100     02 FILLER                    PICTURE X VALUE SPACE.
015200     02 FEATURE                   PICTURE X(20) VALUE SPACE.
015300     02 FILLER                    PICTURE X VALUE SPACE.
015400     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
015500     02 FILLER                    PICTURE X  VALUE SPACE.
015600     02  PAR-NAME.
015700       03 FILLER PICTURE X(12) VALUE SPACE.
015800       03  PARDOT-X PICTURE X  VALUE SPACE.
015900       03 DOTVALUE PICTURE 99  VALUE ZERO.
016000       03 FILLER PIC X(5) VALUE SPACE.
016100     02 FILLER PIC X(10) VALUE SPACE.
016200     02 RE-MARK PIC X(61).
016300 01  TEST-COMPUTED.
016400     02 FILLER PIC X(30) VALUE SPACE.
016500     02 FILLER PIC X(17) VALUE "       COMPUTED=".
016600     02 COMPUTED-X.
016700     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
016800     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
016900     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
017000     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
017100     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
017200     03       CM-18V0 REDEFINES COMPUTED-A.
017300         04 COMPUTED-18V0                   PICTURE -9(18).
017400         04 FILLER                          PICTURE X.
017500     03 FILLER PIC X(50) VALUE SPACE.
017600 01  TEST-CORRECT.
017700     02 FILLER PIC X(30) VALUE SPACE.
017800     02 FILLER PIC X(17) VALUE "       CORRECT =".
017900     02 CORRECT-X.
018000     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
018100     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
018200     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
018300     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
018400     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
018500     03      CR-18V0 REDEFINES CORRECT-A.
018600         04 CORRECT-18V0                    PICTURE -9(18).
018700         04 FILLER                          PICTURE X.
018800     03 FILLER PIC X(50) VALUE SPACE.
018900 01  CCVS-C-1.
019000     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
019100-    "SS  PARAGRAPH-NAME
019200-    "        REMARKS".
019300     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
019400 01  CCVS-C-2.
019500     02 FILLER PICTURE IS X VALUE IS SPACE.
019600     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
019700     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
019800     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
019900     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
020000 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
020100 01  REC-CT PICTURE 99 VALUE ZERO.
020200 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
020300 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
020400 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
020500 01  PASS-COUNTER PIC 999 VALUE ZERO.
020600 01  TOTAL-ERROR PIC 999 VALUE ZERO.
020700 01  ERROR-HOLD PIC 999 VALUE ZERO.
020800 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
020900 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
021000 01  REC-COUNT    PIC 9(5) VALUE ZERO.
021100 01  CCVS-H-1.
021200     02  FILLER   PICTURE X(27)  VALUE SPACE.
021300     02 FILLER PICTURE X(67) VALUE
021400     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
021500-    " SYSTEM".
021600     02  FILLER     PICTURE X(26)  VALUE SPACE.
021700 01  CCVS-H-2.
021800     02 FILLER PICTURE X(52) VALUE IS
021900     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
022000     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
022100     02 TEST-ID PICTURE IS X(9).
022200     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
022300 01  CCVS-H-3.
022400     02  FILLER PICTURE X(34) VALUE
022500     " FOR OFFICIAL USE ONLY    ".
022600     02  FILLER PICTURE X(58) VALUE
022700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022800     02  FILLER PICTURE X(28) VALUE
022900     "  COPYRIGHT   1985 ".
023000 01  CCVS-E-1.
023100     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
023200     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
023300     02 ID-AGAIN PICTURE IS X(9).
023400     02 FILLER PICTURE X(45) VALUE IS
023500     " NTIS DISTRIBUTION COBOL 85".
023600 01  CCVS-E-2.
023700     02  FILLER                   PICTURE X(31)  VALUE
023800     SPACE.
023900     02  FILLER                   PICTURE X(21)  VALUE SPACE.
024000     02 CCVS-E-2-2.
024100         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
024200         03 FILLER PICTURE IS X VALUE IS SPACE.
024300         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
024400 01  CCVS-E-3.
024500     02  FILLER PICTURE X(22) VALUE
024600     " FOR OFFICIAL USE ONLY".
024700     02  FILLER PICTURE X(12) VALUE SPACE.
024800     02  FILLER PICTURE X(58) VALUE
024900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025000     02  FILLER PICTURE X(13) VALUE SPACE.
025100     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
025200 01  CCVS-E-4.
025300     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
025400     02 FILLER PIC XXXX VALUE " OF ".
025500     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
025600     02 FILLER PIC X(40) VALUE
025700      "  TESTS WERE EXECUTED SUCCESSFULLY".
025800 01  XXINFO.
025900     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
026000     02 INFO-TEXT.
026100     04 FILLER PIC X(20) VALUE SPACE.
026200     04 XXCOMPUTED PIC X(20).
026300     04 FILLER PIC X(5) VALUE SPACE.
026400     04 XXCORRECT PIC X(20).
026500 01  HYPHEN-LINE.
026600     02 FILLER PICTURE IS X VALUE IS SPACE.
026700     02 FILLER PICTURE IS X(65) VALUE IS "************************
026800-    "*****************************************".
026900     02 FILLER PICTURE IS X(54) VALUE IS "************************
027000-    "******************************".
027100 01  CCVS-PGM-ID PIC X(6) VALUE
027200     "OBSQ5A".
027300 PROCEDURE DIVISION.
027400 CCVS1 SECTION.
027500 OPEN-FILES.
027600P    OPEN I-O RAW-DATA.
027700P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
027800P    READ RAW-DATA INVALID KEY GO TO END-E-1.
027900P    MOVE "ABORTED " TO C-ABORT.
028000P    ADD 1 TO C-NO-OF-TESTS.
028100P    ACCEPT C-DATE  FROM DATE.
028200P    ACCEPT C-TIME  FROM TIME.
028300P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
028400PEND-E-1.
028500P    CLOSE RAW-DATA.
028600     OPEN     OUTPUT PRINT-FILE.
028700     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
028800     MOVE    SPACE TO TEST-RESULTS.
028900     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
029000     MOVE ZERO TO REC-SKL-SUB.
029100     PERFORM CCVS-INIT-FILE 9 TIMES.
029200 CCVS-INIT-FILE.
029300     ADD 1 TO REC-SKL-SUB.
029400     MOVE FILE-RECORD-INFO-SKELETON TO
029500                  FILE-RECORD-INFO (REC-SKL-SUB).
029600 CCVS-INIT-EXIT.
029700     GO TO CCVS1-EXIT.
029800 CLOSE-FILES.
029900     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
030000P    OPEN I-O RAW-DATA.
030100P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
030200P    READ RAW-DATA INVALID KEY GO TO END-E-2.
030300P    MOVE "OK.     " TO C-ABORT.
030400P    MOVE PASS-COUNTER TO C-OK.
030500P    MOVE ERROR-HOLD   TO C-ALL.
030600P    MOVE ERROR-COUNTER TO C-FAIL.
030700P    MOVE DELETE-CNT TO C-DELETED.
030800P    MOVE INSPECT-COUNTER TO C-INSPECT.
030900P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
031000PEND-E-2.
031100P    CLOSE RAW-DATA.
031200 TERMINATE-CCVS.
031300S    EXIT PROGRAM.
031400STERMINATE-CALL.
031500     STOP     RUN.
031600 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
031700 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
031800 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
031900 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
032000     MOVE "****TEST DELETED****" TO RE-MARK.
032100 PRINT-DETAIL.
032200     IF REC-CT NOT EQUAL TO ZERO
032300             MOVE "." TO PARDOT-X
032400             MOVE REC-CT TO DOTVALUE.
032500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
032600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
032700        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
032800          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
032900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
033000     MOVE SPACE TO CORRECT-X.
033100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
033200     MOVE     SPACE TO RE-MARK.
033300 HEAD-ROUTINE.
033400     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033500     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033600     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
033700 COLUMN-NAMES-ROUTINE.
033800     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033900     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
034100 END-ROUTINE.
034200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
034300 END-RTN-EXIT.
034400     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034500 END-ROUTINE-1.
034600      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
034700      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
034800      ADD PASS-COUNTER TO ERROR-HOLD.
034900*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
035000      MOVE PASS-COUNTER TO CCVS-E-4-1.
035100      MOVE ERROR-HOLD TO CCVS-E-4-2.
035200      MOVE CCVS-E-4 TO CCVS-E-2-2.
035300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
035400  END-ROUTINE-12.
035500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
035600     IF       ERROR-COUNTER IS EQUAL TO ZERO
035700         MOVE "NO " TO ERROR-TOTAL
035800         ELSE
035900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
036000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
036100     PERFORM WRITE-LINE.
036200 END-ROUTINE-13.
036300     IF DELETE-CNT IS EQUAL TO ZERO
036400         MOVE "NO " TO ERROR-TOTAL  ELSE
036500         MOVE DELETE-CNT TO ERROR-TOTAL.
036600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
036700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036800      IF   INSPECT-COUNTER EQUAL TO ZERO
036900          MOVE "NO " TO ERROR-TOTAL
037000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
037100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
037200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037400 WRITE-LINE.
037500     ADD 1 TO RECORD-COUNT.
037600Y    IF RECORD-COUNT GREATER 50
037700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
037800Y        MOVE SPACE TO DUMMY-RECORD
037900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
038000Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
038100Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
038200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
038300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
038400Y        MOVE ZERO TO RECORD-COUNT.
038500     PERFORM WRT-LN.
038600 WRT-LN.
038700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
038800     MOVE SPACE TO DUMMY-RECORD.
038900 BLANK-LINE-PRINT.
039000     PERFORM WRT-LN.
039100 FAIL-ROUTINE.
039200     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
039300     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
039400     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
039500     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039600     GO TO FAIL-ROUTINE-EX.
039700 FAIL-ROUTINE-WRITE.
039800     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
039900     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
040000 FAIL-ROUTINE-EX. EXIT.
040100 BAIL-OUT.
040200     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
040300     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
040400 BAIL-OUT-WRITE.
040500     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
040600     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040700 BAIL-OUT-EX. EXIT.
040800 CCVS1-EXIT.
040900     EXIT.
041000 SECT-OBSQ5A-0001 SECTION.
041100 SEQ-INIT-001.
041200     MOVE 0 TO REC-COUNT,    RECORDS-IN-ERROR.
041300     OPEN INPUT SQ-FS3.
041400 SEQ-TEST-001.
041500     READ SQ-FS3 AT END GO TO SEQ-TEST-001-01.
041600     MOVE SQ-FS3R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
041700     ADD 1 TO REC-COUNT.
041800     IF REC-COUNT    GREATER THAN 750
041900              MOVE "MORE THAN 750 RECORDS" TO RE-MARK
042000              GO TO SEQ-FAIL-001.
042100     IF REC-COUNT    NOT EQUAL TO XRECORD-NUMBER (1)
042200              ADD 1 TO RECORDS-IN-ERROR
042300              GO TO SEQ-TEST-001.
042400     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS3"
042500              ADD 1 TO RECORDS-IN-ERROR
042600              GO TO SEQ-TEST-001.
042700     IF CHARS-OR-RECORDS (1) NOT EQUAL TO "CH"
042800              ADD 1 TO RECORDS-IN-ERROR
042900              GO TO SEQ-TEST-001.
043000     IF XBLOCK-SIZE (1) NOT EQUAL TO 1200
043100              ADD 1 TO RECORDS-IN-ERROR.
043200     GO TO SEQ-TEST-001.
043300 SEQ-TEST-001-01.
043400     IF RECORDS-IN-ERROR EQUAL TO ZERO
043500              GO TO SEQ-PASS-001.
043600     MOVE "ERRORS IN READING SQ-FS3" TO RE-MARK.
043700 SEQ-FAIL-001.
043800     MOVE "RECORDS IN ERROR" TO COMPUTED-A.
043900     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
044000     PERFORM FAIL.
044100     GO TO SEQ-WRITE-001.
044200 SEQ-PASS-001.
044300     PERFORM PASS.
044400     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
044500     MOVE REC-COUNT    TO CORRECT-18V0.
044600 SEQ-WRITE-001.
044700     MOVE "SEQ-TEST-001" TO PAR-NAME.
044800     MOVE "VERIFY FILE SQ-FS3" TO FEATURE.
044900     PERFORM PRINT-DETAIL.
045000 SEQ-CLOSE-001.
045100     CLOSE SQ-FS3.
045200 SEQ-INIT-002.
045300*             THIS TEST READS AND VALIDATES FILE SQ-FS5.
045400     MOVE 0 TO REC-COUNT,    RECORDS-IN-ERROR.
045500     OPEN INPUT SQ-FS5.
045600 SEQ-TEST-002.
045700     READ SQ-FS5 AT END GO TO SEQ-TEST-002-01.
045800     MOVE SQ-FS5R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
045900     ADD 1 TO REC-COUNT.
046000     IF REC-COUNT    GREATER THAN 750
046100              MOVE "MORE THAN 750 RECORDS" TO RE-MARK
046200              GO TO SEQ-FAIL-002.
046300     IF REC-COUNT    NOT EQUAL TO XRECORD-NUMBER (1)
046400              ADD 1 TO RECORDS-IN-ERROR
046500              GO TO SEQ-TEST-002.
046600     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS5"
046700              ADD 1 TO RECORDS-IN-ERROR
046800              GO TO SEQ-TEST-002.
046900     IF CHARS-OR-RECORDS (1) NOT EQUAL TO "RC"
047000              ADD 1 TO RECORDS-IN-ERROR
047100              GO TO SEQ-TEST-002.
047200     IF XBLOCK-SIZE (1) NOT EQUAL TO 5
047300              ADD 1 TO RECORDS-IN-ERROR.
047400     GO TO SEQ-TEST-002.
047500 SEQ-TEST-002-01.
047600     IF RECORDS-IN-ERROR EQUAL TO ZERO
047700              GO TO SEQ-PASS-002.
047800     MOVE "ERRORS IN READINGS SQ-FS5" TO RE-MARK.
047900 SEQ-FAIL-002.
048000     MOVE "RECORDS IN ERROR" TO COMPUTED-A.
048100     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
048200     PERFORM FAIL.
048300     GO TO SEQ-WRITE-002.
048400 SEQ-PASS-002.
048500     PERFORM PASS.
048600     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
048700     MOVE REC-COUNT    TO CORRECT-18V0.
048800 SEQ-WRITE-002.
048900     MOVE "SEQ-TEST-002" TO PAR-NAME.
049000     MOVE "VERIFY FILE SQ-FS5" TO FEATURE
049100     PERFORM PRINT-DETAIL.
049200 SEQ-CLOSE-002.
049300     CLOSE SQ-FS5 WITH NO REWIND.
049400 SEQ-INIT-003.
049500*             THIS TEST READS AND VALIDATES FILE SQ-FS6.
049600     MOVE 0 TO REC-COUNT,    RECORDS-IN-ERROR.
049700     OPEN INPUT SQ-FS6 WITH NO REWIND.
049800 SEQ-TEST-003.
049900     READ SQ-FS6 AT END GO TO SEQ-TEST-003-01.
050000     MOVE SQ-FS6R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
050100     ADD 1 TO REC-COUNT.
050200     IF REC-COUNT    GREATER THAN 750
050300              MOVE "MORE THAN 750 RECORDS" TO RE-MARK
050400              GO TO SEQ-FAIL-003.
050500     IF REC-COUNT    NOT EQUAL TO XRECORD-NUMBER (1)
050600              ADD 1 TO RECORDS-IN-ERROR
050700              GO TO SEQ-TEST-003.
050800     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS6"
050900              ADD 1 TO RECORDS-IN-ERROR
051000              GO TO SEQ-TEST-003.
051100     IF CHARS-OR-RECORDS (1) NOT EQUAL TO "RC"
051200              ADD 1 TO RECORDS-IN-ERROR
051300              GO TO SEQ-TEST-003.
051400     IF XBLOCK-SIZE (1) NOT EQUAL TO 10
051500              ADD 1 TO RECORDS-IN-ERROR.
051600     GO TO SEQ-TEST-003.
051700 SEQ-TEST-003-01.
051800     IF RECORDS-IN-ERROR EQUAL TO ZERO
051900              GO TO SEQ-PASS-003.
052000     MOVE "ERRORS IN READING SQ-FS6" TO RE-MARK.
052100 SEQ-FAIL-003.
052200     MOVE "RECORDS IN ERROR" TO COMPUTED-A.
052300     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
052400     PERFORM FAIL.
052500     GO TO SEQ-WRITE-003.
052600 SEQ-PASS-003.
052700     PERFORM PASS.
052800     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
052900     MOVE REC-COUNT    TO CORRECT-18V0.
053000 SEQ-WRITE-003.
053100     MOVE "SEQ-TEST-003" TO PAR-NAME.
053200     MOVE "VERIFY FILE SQ-FS6" TO FEATURE.
053300     PERFORM PRINT-DETAIL.
053400 SEQ-CLOSE-003.
053500     CLOSE SQ-FS6 WITH NO REWIND.
053600 SEQ-INIT-004.
053700*             THIS TEST READS AND VALIDATES FILE SQ-FS7.
053800     MOVE 0 TO REC-COUNT,    RECORDS-IN-ERROR.
053900     OPEN INPUT SQ-FS7 WITH NO REWIND.
054000 SEQ-TEST-004.
054100     READ SQ-FS7 AT END GO TO SEQ-TEST-004-01.
054200     MOVE SQ-FS7R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
054300     ADD 1 TO REC-COUNT.
054400     IF REC-COUNT    GREATER THAN 750
054500              MOVE "MORE THAN 750 RECORDS" TO RE-MARK
054600              GO TO SEQ-FAIL-004.
054700     IF REC-COUNT    NOT EQUAL TO XRECORD-NUMBER (1)
054800              ADD 1 TO RECORDS-IN-ERROR
054900              GO TO SEQ-TEST-004.
055000     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS7"
055100              ADD 1 TO RECORDS-IN-ERROR
055200              GO TO SEQ-TEST-004.
055300     IF CHARS-OR-RECORDS (1) NOT EQUAL "CH"
055400              ADD 1 TO RECORDS-IN-ERROR
055500              GO TO SEQ-TEST-004.
055600     IF XBLOCK-SIZE (1) NOT EQUAL TO 2400
055700              ADD 1 TO RECORDS-IN-ERROR.
055800     GO TO SEQ-TEST-004.
055900 SEQ-TEST-004-01.
056000     IF RECORDS-IN-ERROR EQUAL TO ZERO
056100              GO TO SEQ-PASS-004.
056200     MOVE "ERRORS IN READING SQ-FS7" TO RE-MARK.
056300 SEQ-FAIL-004.
056400     MOVE "RECORDS IN ERROR" TO COMPUTED-A.
056500     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
056600     PERFORM FAIL.
056700     GO TO SEQ-WRITE-004.
056800 SEQ-PASS-004.
056900     PERFORM PASS.
057000     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
057100     MOVE REC-COUNT    TO CORRECT-18V0.
057200 SEQ-WRITE-004.
057300     MOVE "SEQ-TEST-004" TO PAR-NAME.
057400     MOVE "VERIFY FILE SQ-FS7" TO FEATURE.
057500     PERFORM PRINT-DETAIL.
057600 SEQ-CLOSE-004.
057700     CLOSE SQ-FS7 WITH NO REWIND.
057800 SEQ-INIT-005.
057900*             THIS TEST READS AND VALIDATES FILE SQ-FS8.
058000     MOVE 0 TO REC-COUNT,    RECORDS-IN-ERROR.
058100     OPEN INPUT SQ-FS8 WITH NO REWIND.
058200 SEQ-TEST-005.
058300     READ SQ-FS8 AT END GO TO SEQ-TEST-005-01.
058400     MOVE SQ-FS8R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
058500     ADD 1 TO REC-COUNT.
058600     IF REC-COUNT    GREATER THAN 750
058700              MOVE "MORE THAN 750 RECORDS" TO RE-MARK
058800              GO TO SEQ-FAIL-005.
058900     IF REC-COUNT    NOT EQUAL TO XRECORD-NUMBER (1)
059000              ADD 1 TO RECORDS-IN-ERROR
059100              GO TO SEQ-TEST-005.
059200     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS8"
059300              ADD 1 TO RECORDS-IN-ERROR
059400              GO TO SEQ-TEST-005.
059500     IF CHARS-OR-RECORDS (1) NOT EQUAL TO "CH"
059600              ADD 1 TO RECORDS-IN-ERROR
059700              GO TO SEQ-TEST-005.
059800     IF XBLOCK-SIZE (1) NOT EQUAL TO 120
059900              ADD 1 TO RECORDS-IN-ERROR.
060000     GO TO SEQ-TEST-005.
060100 SEQ-TEST-005-01.
060200     IF RECORDS-IN-ERROR EQUAL TO ZERO
060300              GO TO SEQ-PASS-005.
060400     MOVE "ERRORS IN READING SQ-FS8" TO RE-MARK.
060500 SEQ-FAIL-005.
060600     MOVE "RECORDS IN ERROR" TO COMPUTED-A.
060700     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
060800     PERFORM FAIL.
060900     GO TO SEQ-WRITE-005.
061000 SEQ-PASS-005.
061100     PERFORM PASS.
061200     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
061300     MOVE REC-COUNT    TO CORRECT-18V0.
061400 SEQ-WRITE-005.
061500     MOVE "SEQ-TEST-005" TO PAR-NAME.
061600     MOVE "VERIFY FILE SQ-FS8" TO FEATURE.
061700     PERFORM PRINT-DETAIL.
061800 SEQ-CLOSE-005.
061900     CLOSE SQ-FS8.
062000 OBSQ5A-END-ROUTINE.
062100     MOVE "END OF OBSQ5A VALIDATION TESTS" TO PRINT-REC.
062200     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
062300     GO TO CCVS-EXIT.
062400 CCVS-EXIT SECTION.
062500 CCVS-999999.
062600     GO TO CLOSE-FILES.
