000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IC209A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*    THIS IS MAIN PROGRAM IC209.
002200****************************************************************
002300 ENVIRONMENT DIVISION.
002400 CONFIGURATION SECTION.
002500 SOURCE-COMPUTER.
002600     XXXXX082.
002700 OBJECT-COMPUTER.
002800     XXXXX083.
002900 INPUT-OUTPUT SECTION.
003000 FILE-CONTROL.
003100     SELECT PRINT-FILE ASSIGN TO
003200     XXXXX055.
003300 DATA DIVISION.
003400 FILE SECTION.
003500 FD  PRINT-FILE.
003600 01  PRINT-REC PICTURE X(120).
003700 01  DUMMY-RECORD PICTURE X(120).
003800 WORKING-STORAGE SECTION.
003900 01  TEST-AREA.
004000     02  TEST1                   PICTURE X.
004100     02  TEST2                   PICTURE X.
004200     02  TEST3                   PICTURE X.
004300     02  TEST4                   PICTURE X.
004400 01  TEST-RESULTS.
004500     02 FILLER                   PIC X      VALUE SPACE.
004600     02 FEATURE                  PIC X(20)  VALUE SPACE.
004700     02 FILLER                   PIC X      VALUE SPACE.
004800     02 P-OR-F                   PIC X(5)   VALUE SPACE.
004900     02 FILLER                   PIC X      VALUE SPACE.
005000     02  PAR-NAME.
005100       03 FILLER                 PIC X(19)  VALUE SPACE.
005200       03  PARDOT-X              PIC X      VALUE SPACE.
005300       03 DOTVALUE               PIC 99     VALUE ZERO.
005400     02 FILLER                   PIC X(8)   VALUE SPACE.
005500     02 RE-MARK                  PIC X(61).
005600 01  TEST-COMPUTED.
005700     02 FILLER                   PIC X(30)  VALUE SPACE.
005800     02 FILLER                   PIC X(17)  VALUE
005900            "       COMPUTED=".
006000     02 COMPUTED-X.
006100     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
006200     03 COMPUTED-N               REDEFINES COMPUTED-A
006300                                 PIC -9(9).9(9).
006400     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
006500     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
006600     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
006700     03       CM-18V0 REDEFINES COMPUTED-A.
006800         04 COMPUTED-18V0                    PIC -9(18).
006900         04 FILLER                           PIC X.
007000     03 FILLER PIC X(50) VALUE SPACE.
007100 01  TEST-CORRECT.
007200     02 FILLER PIC X(30) VALUE SPACE.
007300     02 FILLER PIC X(17) VALUE "       CORRECT =".
007400     02 CORRECT-X.
007500     03 CORRECT-A                  PIC X(20) VALUE SPACE.
007600     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
007700     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
007800     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
007900     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
008000     03      CR-18V0 REDEFINES CORRECT-A.
008100         04 CORRECT-18V0                     PIC -9(18).
008200         04 FILLER                           PIC X.
008300     03 FILLER PIC X(2) VALUE SPACE.
008400     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
008500 01  CCVS-C-1.
008600     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
008700-    "SS  PARAGRAPH-NAME
008800-    "       REMARKS".
008900     02 FILLER                     PIC X(20)    VALUE SPACE.
009000 01  CCVS-C-2.
009100     02 FILLER                     PIC X        VALUE SPACE.
009200     02 FILLER                     PIC X(6)     VALUE "TESTED".
009300     02 FILLER                     PIC X(15)    VALUE SPACE.
009400     02 FILLER                     PIC X(4)     VALUE "FAIL".
009500     02 FILLER                     PIC X(94)    VALUE SPACE.
009600 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
009700 01  REC-CT                        PIC 99       VALUE ZERO.
009800 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
009900 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
010000 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
010100 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
010200 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
010300 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
010400 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
010500 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
010600 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
010700 01  CCVS-H-1.
010800     02  FILLER                    PIC X(39)    VALUE SPACES.
010900     02  FILLER                    PIC X(42)    VALUE
011000     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
011100     02  FILLER                    PIC X(39)    VALUE SPACES.
011200 01  CCVS-H-2A.
011300   02  FILLER                        PIC X(40)  VALUE SPACE.
011400   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
011500   02  FILLER                        PIC XXXX   VALUE
011600     "4.2 ".
011700   02  FILLER                        PIC X(28)  VALUE
011800            " COPY - NOT FOR DISTRIBUTION".
011900   02  FILLER                        PIC X(41)  VALUE SPACE.
012000
012100 01  CCVS-H-2B.
012200   02  FILLER                        PIC X(15)  VALUE
012300            "TEST RESULT OF ".
012400   02  TEST-ID                       PIC X(9).
012500   02  FILLER                        PIC X(4)   VALUE
012600            " IN ".
012700   02  FILLER                        PIC X(12)  VALUE
012800     " HIGH       ".
012900   02  FILLER                        PIC X(22)  VALUE
013000            " LEVEL VALIDATION FOR ".
013100   02  FILLER                        PIC X(58)  VALUE
013200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
013300 01  CCVS-H-3.
013400     02  FILLER                      PIC X(34)  VALUE
013500            " FOR OFFICIAL USE ONLY    ".
013600     02  FILLER                      PIC X(58)  VALUE
013700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
013800     02  FILLER                      PIC X(28)  VALUE
013900            "  COPYRIGHT   1985 ".
014000 01  CCVS-E-1.
014100     02 FILLER                       PIC X(52)  VALUE SPACE.
014200     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
014300     02 ID-AGAIN                     PIC X(9).
014400     02 FILLER                       PIC X(45)  VALUE SPACES.
014500 01  CCVS-E-2.
014600     02  FILLER                      PIC X(31)  VALUE SPACE.
014700     02  FILLER                      PIC X(21)  VALUE SPACE.
014800     02 CCVS-E-2-2.
014900         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
015000         03 FILLER                   PIC X      VALUE SPACE.
015100         03 ENDER-DESC               PIC X(44)  VALUE
015200            "ERRORS ENCOUNTERED".
015300 01  CCVS-E-3.
015400     02  FILLER                      PIC X(22)  VALUE
015500            " FOR OFFICIAL USE ONLY".
015600     02  FILLER                      PIC X(12)  VALUE SPACE.
015700     02  FILLER                      PIC X(58)  VALUE
015800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
015900     02  FILLER                      PIC X(13)  VALUE SPACE.
016000     02 FILLER                       PIC X(15)  VALUE
016100             " COPYRIGHT 1985".
016200 01  CCVS-E-4.
016300     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
016400     02 FILLER                       PIC X(4)   VALUE " OF ".
016500     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
016600     02 FILLER                       PIC X(40)  VALUE
016700      "  TESTS WERE EXECUTED SUCCESSFULLY".
016800 01  XXINFO.
016900     02 FILLER                       PIC X(19)  VALUE
017000            "*** INFORMATION ***".
017100     02 INFO-TEXT.
017200       04 FILLER                     PIC X(8)   VALUE SPACE.
017300       04 XXCOMPUTED                 PIC X(20).
017400       04 FILLER                     PIC X(5)   VALUE SPACE.
017500       04 XXCORRECT                  PIC X(20).
017600     02 INF-ANSI-REFERENCE           PIC X(48).
017700 01  HYPHEN-LINE.
017800     02 FILLER  PIC IS X VALUE IS SPACE.
017900     02 FILLER  PIC IS X(65)    VALUE IS "************************
018000-    "*****************************************".
018100     02 FILLER  PIC IS X(54)    VALUE IS "************************
018200-    "******************************".
018300 01  CCVS-PGM-ID                     PIC X(9)   VALUE
018400     "IC209A".
018500 PROCEDURE DIVISION.
018600 CCVS1 SECTION.
018700 OPEN-FILES.
018800     OPEN     OUTPUT PRINT-FILE.
018900     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
019000     MOVE    SPACE TO TEST-RESULTS.
019100     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
019200     GO TO CCVS1-EXIT.
019300 CLOSE-FILES.
019400     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
019500 TERMINATE-CCVS.
019600S    EXIT PROGRAM.
019700STERMINATE-CALL.
019800     STOP     RUN.
019900 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
020000 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
020100 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
020200 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
020300     MOVE "****TEST DELETED****" TO RE-MARK.
020400 PRINT-DETAIL.
020500     IF REC-CT NOT EQUAL TO ZERO
020600             MOVE "." TO PARDOT-X
020700             MOVE REC-CT TO DOTVALUE.
020800     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
020900     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
021000        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
021100          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
021200     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
021300     MOVE SPACE TO CORRECT-X.
021400     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
021500     MOVE     SPACE TO RE-MARK.
021600 HEAD-ROUTINE.
021700     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
021800     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
021900     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
022000     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
022100 COLUMN-NAMES-ROUTINE.
022200     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
022300     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
022400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
022500 END-ROUTINE.
022600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
022700 END-RTN-EXIT.
022800     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
022900 END-ROUTINE-1.
023000      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
023100      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
023200      ADD PASS-COUNTER TO ERROR-HOLD.
023300*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
023400      MOVE PASS-COUNTER TO CCVS-E-4-1.
023500      MOVE ERROR-HOLD TO CCVS-E-4-2.
023600      MOVE CCVS-E-4 TO CCVS-E-2-2.
023700      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
023800  END-ROUTINE-12.
023900      MOVE "TEST(S) FAILED" TO ENDER-DESC.
024000     IF       ERROR-COUNTER IS EQUAL TO ZERO
024100         MOVE "NO " TO ERROR-TOTAL
024200         ELSE
024300         MOVE ERROR-COUNTER TO ERROR-TOTAL.
024400     MOVE     CCVS-E-2 TO DUMMY-RECORD.
024500     PERFORM WRITE-LINE.
024600 END-ROUTINE-13.
024700     IF DELETE-COUNTER IS EQUAL TO ZERO
024800         MOVE "NO " TO ERROR-TOTAL  ELSE
024900         MOVE DELETE-COUNTER TO ERROR-TOTAL.
025000     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
025100     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025200      IF   INSPECT-COUNTER EQUAL TO ZERO
025300          MOVE "NO " TO ERROR-TOTAL
025400      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
025500      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
025600      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025700     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025800 WRITE-LINE.
025900     ADD 1 TO RECORD-COUNT.
026000Y    IF RECORD-COUNT GREATER 50
026100Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
026200Y        MOVE SPACE TO DUMMY-RECORD
026300Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
026400Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
026500Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
026600Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
026700Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
026800Y        MOVE ZERO TO RECORD-COUNT.
026900     PERFORM WRT-LN.
027000 WRT-LN.
027100     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
027200     MOVE SPACE TO DUMMY-RECORD.
027300 BLANK-LINE-PRINT.
027400     PERFORM WRT-LN.
027500 FAIL-ROUTINE.
027600     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
027700     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
027800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
027900     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
028000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028100     MOVE   SPACES TO INF-ANSI-REFERENCE.
028200     GO TO  FAIL-ROUTINE-EX.
028300 FAIL-ROUTINE-WRITE.
028400     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
028500     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
028600     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
028700     MOVE   SPACES TO COR-ANSI-REFERENCE.
028800 FAIL-ROUTINE-EX. EXIT.
028900 BAIL-OUT.
029000     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
029100     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
029200 BAIL-OUT-WRITE.
029300     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
029400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
029500     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029600     MOVE   SPACES TO INF-ANSI-REFERENCE.
029700 BAIL-OUT-EX. EXIT.
029800 CCVS1-EXIT.
029900     EXIT.
030000 CALL-TEST-1.
030100     MOVE SPACES TO TEST-AREA.
030200     CALL "IC210A" USING TEST-AREA.
030300     MOVE "CALL...USING DATA-NM" TO FEATURE.
030400     MOVE "CALL-TEST-1" TO PAR-NAME.
030500     MOVE "MAIN PROGRAM CALLS SUBPROGRAM1" TO RE-MARK.
030600     IF TEST1 = "Y" PERFORM PASS
030700        GO TO CALL-WRITE-1.
030800 CALL-FAIL-1.
030900     MOVE TEST1 TO COMPUTED-A.
031000     MOVE "Y" TO CORRECT-A.
031100     PERFORM FAIL.
031200 CALL-WRITE-1.
031300     PERFORM PRINT-DETAIL.
031400 CALL-TEST-2.
031500     MOVE "CALL...USING DATA-NM" TO FEATURE.
031600     MOVE "CALL-TEST-2" TO PAR-NAME.
031700     MOVE "SUBPROGRAM1 CALLS SUBPROGRAM2" TO RE-MARK.
031800     IF TEST2 = "Y" PERFORM PASS
031900        GO TO CALL-WRITE-2.
032000 CALL-FAIL-2.
032100     MOVE TEST2 TO COMPUTED-A.
032200     MOVE "Y" TO CORRECT-A.
032300     PERFORM FAIL.
032400 CALL-WRITE-2.
032500     PERFORM PRINT-DETAIL.
032600 CALL-TEST-3.
032700     MOVE "CALL...USING DATA-NM" TO FEATURE.
032800     MOVE "CALL-TEST-3" TO PAR-NAME.
032900     MOVE "SUBPROGRAM1 CALLS SUBPROGRAM3" TO RE-MARK.
033000     IF TEST3 = "Y" PERFORM PASS
033100        GO TO CALL-WRITE-3.
033200 CALL-FAIL-3.
033300     MOVE TEST3 TO COMPUTED-A.
033400     MOVE "Y" TO CORRECT-A.
033500     PERFORM FAIL.
033600 CALL-WRITE-3.
033700     PERFORM PRINT-DETAIL.
033800 CANCEL-TEST-1.
033900     MOVE "CANCEL" TO FEATURE.
034000     MOVE "CANCEL-TEST-1" TO PAR-NAME.
034100     MOVE "SUBPROGRAM1 CANCELS SUBPROGRAM2" TO RE-MARK.
034200     IF TEST4 = "Y" PERFORM PASS
034300        GO TO CANCEL-WRITE-1.
034400 CANCEL-FAIL-1.
034500     MOVE TEST4 TO COMPUTED-A.
034600     MOVE "Y" TO CORRECT-A.
034700     PERFORM FAIL.
034800 CANCEL-WRITE-1.
034900     PERFORM PRINT-DETAIL.
035000 CCVS-EXIT SECTION.
035100 CCVS-999999.
035200     GO TO CLOSE-FILES.
