000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ152A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 3.0.                                 *
000900*                                                              *
001000*    CREATION DATE     /     VALIDATION DATE                   *
001100*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001200*                                                              *
001300****************************************************************
001400*                                                              *
001500*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001600*                                                              *
001700*            X-14   SEQUENTIAL MASS STORAGE                    *
001800*            X-55   SYSTEM PRINTER                             *
001900*            X-82   SOURCE-COMPUTER                            *
002000*            X-83   OBJECT-COMPUTER.                           *
002100*            X-84   LABEL RECORDS OPTION
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*                                                              *
002600*    SPLIT FROM SQ215A, THIS PROGRAM REPEATS THE SEQUENCE OF   *
002700*    FILE HANDLING ROUTINES IN ORDER TO CARRY OUT THE ISOLATED *
002800*    SPLIT TEST THAT CHECKS FOR THE CORRECT RESPONSE TO AN     *
002900*    ATTEMPT TO WRITE TO A FILE NOT OPEN IN THE OUTPUT OR      *
003000*    EXTEND MODE.  I-O STATUS 48 IS EXPECTED AND TESTED IN     *
003100*    THE DECLARATIVES.                                         *
003200*                                                              *
003300****************************************************************
003400*
003500 ENVIRONMENT DIVISION.
003600 CONFIGURATION SECTION.
003700 SOURCE-COMPUTER.
003800     XXXXX082.
003900 OBJECT-COMPUTER.
004000     XXXXX083.
004100*
004200 INPUT-OUTPUT SECTION.
004300 FILE-CONTROL.
004400     SELECT PRINT-FILE ASSIGN TO
004500     XXXXX055.
004600*
004700     SELECT SQ-FS1 ASSIGN TO
004800     XXXXX014
004900            FILE STATUS IS SQ-FS1-STATUS.
005000*
005100*
005200 DATA DIVISION.
005300 FILE SECTION.
005400 FD  PRINT-FILE
005500C    LABEL RECORDS
005600C    XXXXX084
005700C    DATA RECORD IS PRINT-REC DUMMY-RECORD
005800               .
005900 01  PRINT-REC    PICTURE X(120).
006000 01  DUMMY-RECORD PICTURE X(120).
006100*
006200 FD  SQ-FS1
006300C    LABEL RECORD IS STANDARD
006400                .
006500 01  SQ-FS1R1-F-G-120 PIC X(120).
006600*
006700 WORKING-STORAGE SECTION.
006800*
006900***************************************************************
007000*                                                             *
007100*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
007200*                                                             *
007300***************************************************************
007400*
007500 01  SQ-FS1-STATUS.
007600   03  SQ-FS1-KEY-1   PIC X.
007700   03  SQ-FS1-KEY-2   PIC X.
007800*
007900***************************************************************
008000*                                                             *
008100*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
008200*                                                             *
008300***************************************************************
008400*
008500 01  REC-SKEL-SUB   PIC 99.
008600*
008700 01  FILE-RECORD-INFORMATION-REC.
008800     03 FILE-RECORD-INFO-SKELETON.
008900        05 FILLER                 PICTURE X(48)       VALUE
009000             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
009100        05 FILLER                 PICTURE X(46)       VALUE
009200             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
009300        05 FILLER                 PICTURE X(26)       VALUE
009400             ",LFIL=000000,ORG=  ,LBLR= ".
009500        05 FILLER                 PICTURE X(37)       VALUE
009600             ",RECKEY=                             ".
009700        05 FILLER                 PICTURE X(38)       VALUE
009800             ",ALTKEY1=                             ".
009900        05 FILLER                 PICTURE X(38)       VALUE
010000             ",ALTKEY2=                             ".
010100        05 FILLER                 PICTURE X(7)        VALUE SPACE.
010200     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
010300        05 FILE-RECORD-INFO-P1-120.
010400           07 FILLER              PIC X(5).
010500           07 XFILE-NAME          PIC X(6).
010600           07 FILLER              PIC X(8).
010700           07 XRECORD-NAME        PIC X(6).
010800           07 FILLER              PIC X(1).
010900           07 REELUNIT-NUMBER     PIC 9(1).
011000           07 FILLER              PIC X(7).
011100           07 XRECORD-NUMBER      PIC 9(6).
011200           07 FILLER              PIC X(6).
011300           07 UPDATE-NUMBER       PIC 9(2).
011400           07 FILLER              PIC X(5).
011500           07 ODO-NUMBER          PIC 9(4).
011600           07 FILLER              PIC X(5).
011700           07 XPROGRAM-NAME       PIC X(5).
011800           07 FILLER              PIC X(7).
011900           07 XRECORD-LENGTH      PIC 9(6).
012000           07 FILLER              PIC X(7).
012100           07 CHARS-OR-RECORDS    PIC X(2).
012200           07 FILLER              PIC X(1).
012300           07 XBLOCK-SIZE         PIC 9(4).
012400           07 FILLER              PIC X(6).
012500           07 RECORDS-IN-FILE     PIC 9(6).
012600           07 FILLER              PIC X(5).
012700           07 XFILE-ORGANIZATION  PIC X(2).
012800           07 FILLER              PIC X(6).
012900           07 XLABEL-TYPE         PIC X(1).
013000        05 FILE-RECORD-INFO-P121-240.
013100           07 FILLER              PIC X(8).
013200           07 XRECORD-KEY         PIC X(29).
013300           07 FILLER              PIC X(9).
013400           07 ALTERNATE-KEY1      PIC X(29).
013500           07 FILLER              PIC X(9).
013600           07 ALTERNATE-KEY2      PIC X(29).
013700           07 FILLER              PIC X(7).
013800*
013900 01  TEST-RESULTS.
014000     02 FILLER              PIC X      VALUE SPACE.
014100     02 FEATURE             PIC X(24)  VALUE SPACE.
014200     02 FILLER              PIC X      VALUE SPACE.
014300     02 P-OR-F              PIC X(5)   VALUE SPACE.
014400     02 FILLER              PIC X      VALUE SPACE.
014500     02  PAR-NAME.
014600       03 FILLER              PIC X(14)  VALUE SPACE.
014700       03 PARDOT-X            PIC X      VALUE SPACE.
014800       03 DOTVALUE            PIC 99     VALUE ZERO.
014900     02 FILLER              PIC X(9)   VALUE SPACE.
015000     02 RE-MARK             PIC X(61).
015100 01  TEST-COMPUTED.
015200   02 FILLER  PIC X(30)  VALUE SPACE.
015300   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
015400   02 COMPUTED-X.
015500     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
015600     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
015700     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
015800     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
015900     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
016000     03       CM-18V0 REDEFINES COMPUTED-A.
016100        04 COMPUTED-18V0                   PIC -9(18).
016200        04 FILLER                          PIC X.
016300     03 FILLER PIC X(50) VALUE SPACE.
016400 01  TEST-CORRECT.
016500     02 FILLER PIC X(30) VALUE SPACE.
016600     02 FILLER PIC X(17) VALUE "       CORRECT =".
016700     02 CORRECT-X.
016800     03 CORRECT-A                  PIC X(20) VALUE SPACE.
016900     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
017000     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
017100     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
017200     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
017300     03      CR-18V0 REDEFINES CORRECT-A.
017400         04 CORRECT-18V0                     PIC -9(18).
017500         04 FILLER                           PIC X.
017600     03 FILLER PIC X(2) VALUE SPACE.
017700     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
017800 01  CCVS-C-1.
017900     02 FILLER  PIC IS X(4)     VALUE SPACE.
018000     02 FILLER  PIC IS X(98)    VALUE IS "FEATURE               PA
018100-    "SS  PARAGRAPH-NAME
018200-    "       REMARKS".
018300     02 FILLER           PIC X(17)    VALUE SPACE.
018400 01  CCVS-C-2.
018500     02 FILLER           PIC XXXX     VALUE SPACE.
018600     02 FILLER           PIC X(6)     VALUE "TESTED".
018700     02 FILLER           PIC X(16)    VALUE SPACE.
018800     02 FILLER           PIC X(4)     VALUE "FAIL".
018900     02 FILLER           PIC X(90)    VALUE SPACE.
019000 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
019100 01  REC-CT            PIC 99       VALUE ZERO.
019200 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
019300 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
019400 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
019500 01  PASS-COUNTER      PIC 999      VALUE ZERO.
019600 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
019700 01  ERROR-HOLD        PIC 999      VALUE ZERO.
019800 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
019900 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
020000 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
020100 01  CCVS-H-1.
020200     02  FILLER          PIC X(39)    VALUE SPACES.
020300     02  FILLER          PIC X(42)    VALUE
020400     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
020500     02  FILLER          PIC X(39)    VALUE SPACES.
020600 01  CCVS-H-2A.
020700   02  FILLER            PIC X(40)  VALUE SPACE.
020800   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
020900   02  FILLER            PIC XXXX   VALUE
021000     "4.2 ".
021100   02  FILLER            PIC X(28)  VALUE
021200            " COPY - NOT FOR DISTRIBUTION".
021300   02  FILLER            PIC X(41)  VALUE SPACE.
021400*
021500 01  CCVS-H-2B.
021600   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
021700   02  TEST-ID           PIC X(9).
021800   02  FILLER            PIC X(4)   VALUE " IN ".
021900   02  FILLER            PIC X(12)  VALUE
022000     " HIGH       ".
022100   02  FILLER            PIC X(22)  VALUE
022200            " LEVEL VALIDATION FOR ".
022300   02  FILLER            PIC X(58)  VALUE
022400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
022500 01  CCVS-H-3.
022600     02  FILLER          PIC X(34)  VALUE
022700            " FOR OFFICIAL USE ONLY    ".
022800     02  FILLER          PIC X(58)  VALUE
022900     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
023000     02  FILLER          PIC X(28)  VALUE
023100            "  COPYRIGHT   1985,1986 ".
023200 01  CCVS-E-1.
023300     02 FILLER           PIC X(52)  VALUE SPACE.
023400     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
023500     02 ID-AGAIN         PIC X(9).
023600     02 FILLER           PIC X(45)  VALUE SPACES.
023700 01  CCVS-E-2.
023800     02  FILLER          PIC X(31)  VALUE SPACE.
023900     02  FILLER          PIC X(21)  VALUE SPACE.
024000     02  CCVS-E-2-2.
024100         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
024200         03 FILLER         PIC X      VALUE SPACE.
024300         03 ENDER-DESC     PIC X(44)  VALUE
024400            "ERRORS ENCOUNTERED".
024500 01  CCVS-E-3.
024600     02  FILLER          PIC X(22)  VALUE
024700            " FOR OFFICIAL USE ONLY".
024800     02  FILLER          PIC X(12)  VALUE SPACE.
024900     02  FILLER          PIC X(58)  VALUE
025000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025100     02  FILLER          PIC X(8)   VALUE SPACE.
025200     02  FILLER          PIC X(20)  VALUE
025300             " COPYRIGHT 1985,1986".
025400 01  CCVS-E-4.
025500     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
025600     02 FILLER           PIC X(4)   VALUE " OF ".
025700     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
025800     02 FILLER           PIC X(40)  VALUE
025900      "  TESTS WERE EXECUTED SUCCESSFULLY".
026000 01  XXINFO.
026100     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
026200     02 INFO-TEXT.
026300       04 FILLER             PIC X(8)   VALUE SPACE.
026400       04 XXCOMPUTED         PIC X(20).
026500       04 FILLER             PIC X(5)   VALUE SPACE.
026600       04 XXCORRECT          PIC X(20).
026700     02 INF-ANSI-REFERENCE PIC X(48).
026800 01  HYPHEN-LINE.
026900     02 FILLER  PIC IS X VALUE IS SPACE.
027000     02 FILLER  PIC IS X(65)    VALUE IS "************************
027100-    "*****************************************".
027200     02 FILLER  PIC IS X(54)    VALUE IS "************************
027300-    "******************************".
027400 01  CCVS-PGM-ID  PIC X(9)   VALUE
027500     "SQ152A".
027600*
027700 PROCEDURE DIVISION.
027800 DECLARATIVES.
027900 SQ-FS1-DECLARATIVE SECTION.
028000     USE AFTER STANDARD EXCEPTION PROCEDURE ON SQ-FS1.
028100 OUTPUT-ERROR-PROCESS.
028200     IF SQ-FS1-STATUS = "48"
028300             PERFORM PASS-DECL
028400             GO TO ABNORMAL-TERM-DECL
028500     ELSE
028600             MOVE "48" TO CORRECT-A
028700             MOVE SQ-FS1-STATUS TO COMPUTED-A
028800             MOVE "STATUS AFTER OPEN AFTER LOCK INCORRECT"
028900                     TO RE-MARK
029000             MOVE "VII-3, FILE STATUS" TO ANSI-REFERENCE
029100             PERFORM FAIL-DECL
029200             GO TO ABNORMAL-TERM-DECL
029300     END-IF.
029400*
029500 PASS-DECL.
029600     MOVE   "PASS " TO P-OR-F.
029700     ADD     1 TO PASS-COUNTER.
029800     PERFORM PRINT-DETAIL-DECL.
029900*
030000 FAIL-DECL.
030100     MOVE   "FAIL*" TO P-OR-F.
030200     ADD     1 TO ERROR-COUNTER.
030300     PERFORM PRINT-DETAIL-DECL.
030400*
030500 PRINT-DETAIL-DECL.
030600     IF REC-CT NOT EQUAL TO ZERO
030700         MOVE   "." TO PARDOT-X
030800         MOVE    REC-CT TO DOTVALUE.
030900     MOVE    TEST-RESULTS TO PRINT-REC.
031000     PERFORM WRITE-LINE-DECL.
031100     IF P-OR-F EQUAL TO "FAIL*"
031200         PERFORM WRITE-LINE-DECL
031300         PERFORM FAIL-ROUTINE-DECL THRU FAIL-ROUTINE-EX-DECL
031400     ELSE
031500         PERFORM BAIL-OUT-DECL THRU BAIL-OUT-EX-DECL.
031600     MOVE    SPACE TO P-OR-F.
031700     MOVE    SPACE TO COMPUTED-X.
031800     MOVE    SPACE TO CORRECT-X.
031900     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
032000     MOVE    SPACE TO RE-MARK.
032100*
032200 WRITE-LINE-DECL.
032300     ADD     1 TO RECORD-COUNT.
032400Y    IF RECORD-COUNT GREATER 50
032500Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
032600Y        MOVE  SPACE TO DUMMY-RECORD
032700Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
032800Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN-DECL
032900Y        MOVE  CCVS-C-2 TO DUMMY-RECORD
033000Y        PERFORM WRT-LN-DECL 2 TIMES
033100Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN-DECL
033200Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
033300Y        MOVE  ZERO TO RECORD-COUNT.
033400     PERFORM WRT-LN-DECL.
033500*
033600 WRT-LN-DECL.
033700     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
033800     MOVE    SPACE TO DUMMY-RECORD.
033900 BLANK-LINE-PRINT-DECL.
034000     PERFORM WRT-LN-DECL.
034100 FAIL-ROUTINE-DECL.
034200     IF COMPUTED-X NOT EQUAL TO SPACE
034300             GO TO FAIL-ROUTINE-WRITE-DECL.
034400     IF CORRECT-X NOT EQUAL TO SPACE
034500             GO TO FAIL-ROUTINE-WRITE-DECL.
034600     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
034700     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
034800     MOVE    XXINFO TO DUMMY-RECORD.
034900     PERFORM WRITE-LINE-DECL 2 TIMES.
035000     MOVE    SPACES TO INF-ANSI-REFERENCE.
035100     GO TO   FAIL-ROUTINE-EX-DECL.
035200 FAIL-ROUTINE-WRITE-DECL.
035300     MOVE    TEST-COMPUTED  TO PRINT-REC
035400     PERFORM WRITE-LINE-DECL
035500     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
035600     MOVE    TEST-CORRECT   TO PRINT-REC
035700     PERFORM WRITE-LINE-DECL 2 TIMES.
035800     MOVE    SPACES         TO COR-ANSI-REFERENCE.
035900 FAIL-ROUTINE-EX-DECL.
036000     EXIT.
036100 BAIL-OUT-DECL.
036200     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE-DECL.
036300     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX-DECL.
036400 BAIL-OUT-WRITE-DECL.
036500     MOVE    CORRECT-A      TO XXCORRECT.
036600     MOVE    COMPUTED-A     TO XXCOMPUTED.
036700     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
036800     MOVE    XXINFO TO DUMMY-RECORD.
036900     PERFORM WRITE-LINE-DECL 2 TIMES.
037000     MOVE    SPACES TO INF-ANSI-REFERENCE.
037100 BAIL-OUT-EX-DECL.
037200     EXIT.
037300*
037400 ABNORMAL-TERM-DECL.
037500     MOVE    SPACE TO DUMMY-RECORD.
037600     PERFORM WRITE-LINE-DECL.
037700     MOVE    "ABNORMAL TERMINATION AT THIS POINT IS ACCEPTABLE"
037800                     TO DUMMY-RECORD.
037900     PERFORM WRITE-LINE-DECL 3 TIMES.
038000*
038100 EXIT-DECL.
038200     EXIT.
038300 END DECLARATIVES.
038400*
038500 CCVS1 SECTION.
038600 OPEN-FILES.
038700     OPEN    OUTPUT PRINT-FILE.
038800     MOVE    CCVS-PGM-ID TO TEST-ID.
038900     MOVE    CCVS-PGM-ID TO ID-AGAIN.
039000     MOVE    SPACE TO TEST-RESULTS.
039100     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
039200     MOVE    ZERO TO REC-SKEL-SUB.
039300     PERFORM CCVS-INIT-FILE 10 TIMES.
039400     GO TO CCVS1-EXIT.
039500*
039600 CCVS-INIT-FILE.
039700     ADD     1 TO REC-SKL-SUB.
039800     MOVE    FILE-RECORD-INFO-SKELETON TO
039900                  FILE-RECORD-INFO (REC-SKL-SUB).
040000*
040100 CLOSE-FILES.
040200     PERFORM END-ROUTINE THRU END-ROUTINE-13.
040300     CLOSE   PRINT-FILE.
040400 TERMINATE-CCVS.
040500     STOP    RUN.
040600*
040700 INSPT.
040800     MOVE   "INSPT" TO P-OR-F.
040900     ADD     1 TO INSPECT-COUNTER.
041000     PERFORM PRINT-DETAIL.
041100
041200 PASS.
041300     MOVE   "PASS " TO P-OR-F.
041400     ADD     1 TO PASS-COUNTER.
041500     PERFORM PRINT-DETAIL.
041600*
041700 FAIL.
041800     MOVE   "FAIL*" TO P-OR-F.
041900     ADD     1 TO ERROR-COUNTER.
042000     PERFORM PRINT-DETAIL.
042100*
042200 DE-LETE.
042300     MOVE   "****TEST DELETED****" TO RE-MARK.
042400     MOVE   "*****" TO P-OR-F.
042500     ADD     1 TO DELETE-COUNTER.
042600     PERFORM PRINT-DETAIL.
042700*
042800 PRINT-DETAIL.
042900     IF REC-CT NOT EQUAL TO ZERO
043000         MOVE   "." TO PARDOT-X
043100         MOVE    REC-CT TO DOTVALUE.
043200     MOVE    TEST-RESULTS TO PRINT-REC.
043300     PERFORM WRITE-LINE.
043400     IF P-OR-F EQUAL TO "FAIL*"
043500         PERFORM WRITE-LINE
043600         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
043700     ELSE
043800         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
043900     MOVE    SPACE TO P-OR-F.
044000     MOVE    SPACE TO COMPUTED-X.
044100     MOVE    SPACE TO CORRECT-X.
044200     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
044300     MOVE    SPACE TO RE-MARK.
044400*
044500 HEAD-ROUTINE.
044600     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044700     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044800     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
044900     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
045000 COLUMN-NAMES-ROUTINE.
045100     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
045200     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
045400 END-ROUTINE.
045500     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
045600     PERFORM WRITE-LINE 5 TIMES.
045700 END-RTN-EXIT.
045800     MOVE    CCVS-E-1 TO DUMMY-RECORD.
045900     PERFORM WRITE-LINE 2 TIMES.
046000*
046100 END-ROUTINE-1.
046200     ADD     ERROR-COUNTER   TO ERROR-HOLD
046300     ADD     INSPECT-COUNTER TO ERROR-HOLD.
046400     ADD     DELETE-COUNTER  TO ERROR-HOLD.
046500     ADD     PASS-COUNTER    TO ERROR-HOLD.
046600     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
046700     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
046800     MOVE    CCVS-E-4        TO CCVS-E-2-2.
046900     MOVE    CCVS-E-2        TO DUMMY-RECORD
047000     PERFORM WRITE-LINE.
047100     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
047200     IF ERROR-COUNTER IS EQUAL TO ZERO
047300         MOVE   "NO " TO ERROR-TOTAL
047400     ELSE
047500         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
047600     MOVE    CCVS-E-2 TO DUMMY-RECORD.
047700     PERFORM WRITE-LINE.
047800 END-ROUTINE-13.
047900     IF DELETE-COUNTER IS EQUAL TO ZERO
048000         MOVE   "NO " TO ERROR-TOTAL
048100     ELSE
048200         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
048300     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
048400     MOVE    CCVS-E-2 TO DUMMY-RECORD.
048500     PERFORM WRITE-LINE.
048600     IF INSPECT-COUNTER EQUAL TO ZERO
048700         MOVE   "NO " TO ERROR-TOTAL
048800     ELSE
048900         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
049000     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
049100     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
049200     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
049300*
049400 WRITE-LINE.
049500     ADD     1 TO RECORD-COUNT.
049600Y    IF RECORD-COUNT GREATER 50
049700Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
049800Y        MOVE  SPACE TO DUMMY-RECORD
049900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
050000Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
050100Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
050200Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
050300Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
050400Y        MOVE  ZERO TO RECORD-COUNT.
050500     PERFORM WRT-LN.
050600*
050700 WRT-LN.
050800     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
050900     MOVE    SPACE TO DUMMY-RECORD.
051000 BLANK-LINE-PRINT.
051100     PERFORM WRT-LN.
051200 FAIL-ROUTINE.
051300     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
051400     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
051500     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
051600     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
051700     MOVE    XXINFO TO DUMMY-RECORD.
051800     PERFORM WRITE-LINE 2 TIMES.
051900     MOVE    SPACES TO INF-ANSI-REFERENCE.
052000     GO TO   FAIL-ROUTINE-EX.
052100 FAIL-ROUTINE-WRITE.
052200     MOVE    TEST-COMPUTED  TO PRINT-REC
052300     PERFORM WRITE-LINE
052400     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
052500     MOVE    TEST-CORRECT   TO PRINT-REC
052600     PERFORM WRITE-LINE 2 TIMES.
052700     MOVE    SPACES         TO COR-ANSI-REFERENCE.
052800 FAIL-ROUTINE-EX.
052900     EXIT.
053000 BAIL-OUT.
053100     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
053200     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
053300 BAIL-OUT-WRITE.
053400     MOVE    CORRECT-A      TO XXCORRECT.
053500     MOVE    COMPUTED-A     TO XXCOMPUTED.
053600     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
053700     MOVE    XXINFO TO DUMMY-RECORD.
053800     PERFORM WRITE-LINE 2 TIMES.
053900     MOVE    SPACES TO INF-ANSI-REFERENCE.
054000 BAIL-OUT-EX.
054100     EXIT.
054200 CCVS1-EXIT.
054300     EXIT.
054400*
054500****************************************************************
054600*                                                              *
054700*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
054800*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
054900*                                                              *
055000****************************************************************
055100*
055200 SECT-SQ152A-0001 SECTION.
055300 WRITE-INIT-GF-01.
055400*
055500*        THIS TEST CREATES FILE SQ-FS1 AND CLOSES IT.
055600*        FIRST IT SETS UP A SKELETON RECORD IN WORKING STORAGE.
055700*
055800     MOVE "SQ-FS1" TO XFILE-NAME (1).
055900     MOVE "R1-F-G" TO XRECORD-NAME (1).
056000     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
056100     MOVE 120      TO XRECORD-LENGTH (1).
056200     MOVE "RC"     TO CHARS-OR-RECORDS (1).
056300     MOVE 1        TO XBLOCK-SIZE (1).
056400     MOVE 1        TO RECORDS-IN-FILE (1).
056500     MOVE "SQ"     TO XFILE-ORGANIZATION (1).
056600     MOVE "S"      TO XLABEL-TYPE (1).
056700     MOVE 1        TO XRECORD-NUMBER (1).
056800*
056900 WRITE-OPEN-01.
057000     OPEN    OUTPUT SQ-FS1.
057100 WRITE-INIT-01.
057200 WRITE-TEST-01-01.
057300     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-FS1R1-F-G-120.
057400     WRITE   SQ-FS1R1-F-G-120.
057500 CLOSE-INIT-01.
057600 CLOSE-TEST-01.
057700     CLOSE   SQ-FS1.
057800 OPEN-INIT-01.
057900*
058000 OPEN-TEST-01.
058100     OPEN    INPUT  SQ-FS1.
058200*
058300*        THIS TEST OPENS THE FILE JUST CREATED IN THE INPUT
058400*        MODE.  WE ATTEMPT TO WRITE ANOTHER RECORD AND EXAMINE
058500*        IN A DECLARACTIVE THE I-O STATUS RETURNED.  IT IS
058600*        POSSIBLE THAT THE SYSTEM ACTION MAY BE ABNORMAL PROGRAM
058700*        TERMINATION AFTER THE DECLARATIVE IS EXECUTED.
058800*        THE RECORD NUMBER FIELD IN THE RECORD TO BE WRITTEN IS
058900*        CHANGED FROM THAT IN THE RECORD ORIGINALLY WRITTEN, TO
059000*        AID IN ESTABLISHING THE ORIGIN OF THE RECORD IN ANY
059100*        SUBSEQUENT EXAMINATION OF THE FILE.
059200*
059300 WRITE-INIT-02.
059400     MOVE    1 TO REC-CT.
059500     MOVE   "WRITE-TEST-02" TO PAR-NAME
059600     MOVE   "WRITE TO INPUT FILE"  TO FEATURE.
059700     MOVE    2 TO XRECORD-NUMBER (1).
059800 WRITE-TEST-02-01.
059900     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-FS1R1-F-G-120.
060000     WRITE   SQ-FS1R1-F-G-120.
060100 CLOSE-INIT-02.
060200 CLOSE-TEST-02.
060300     CLOSE   SQ-FS1.
060400*
060500 CCVS-EXIT SECTION.
060600 CCVS-999999.
060700     GO TO CLOSE-FILES.
