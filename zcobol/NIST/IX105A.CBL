000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IX105A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*GENERAL:    THIS PROGRAM PROCESSES THREE INDEXED I-O FILES
001400*            IDENTIFIED AS IX-FR1,IX-FR2 AND IX-FR3.  THE FUNCTION
001500*            OF THIS PROGRAM IS TO CREATE THREE INDEXED FILES
001600*            RANDOMLLY (ACCESS MODE RANDOM) AND VERIFY THAT THEY
001700*            WERE CREATED CORRECTLY.  THE FILES PROCESSED
001800*            CONTAIN VARIABLE LENGTH RECORDS.
001900*
002000*            X-CARD PARAMETERS WHICH MUST BE SUPPLIED FOR THIS
002100*            PROGRAM ARE:
002200*
002300*                 X-24   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
002400*                         INDEXED  I-O DATA FILE-1
002500*                 X-25   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
002600*                         INDEXED  I-O DATA FILE-2
002700*                 X-26   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
002800*                         INDEXED  I-O DATA FILE-3
002900*                 X-55   SYSTEM PRINTER
003000*                 X-62   FOR RAW-DATA
003100*                 X-82   SOURCE-COMPUTER
003200*                 X-83   OBJECT-COMPUTER.
003300*
003400*  THIS PROGRAM SHOULD BE RUN ONLY WHEN AN IMPLEMENTATION   *
003500*  PROVIDES VARIABLE-LENGTH RECORDS FOR THE RECORD CONTAINS *
003600*  INTEGER TO INTEGER CLAUSE.                               *
003700*                                                           *
003800***************************************************
003900 ENVIRONMENT DIVISION.
004000 CONFIGURATION SECTION.
004100 SOURCE-COMPUTER.
004200     XXXXX082.
004300 OBJECT-COMPUTER.
004400     XXXXX083.
004500 INPUT-OUTPUT SECTION.
004600 FILE-CONTROL.
004700     SELECT PRINT-FILE ASSIGN TO
004800     XXXXX055.
004900     SELECT IX-FR1 ASSIGN TO
005000     XXXXX024
005100             ORGANIZATION IS INDEXED
005200             ACCESS  MODE IS RANDOM
005300              RECORD KEY IS IX-FR1-KEY.
005400     SELECT IX-FR2 ASSIGN TO
005500     XXXXX025
005600             ORGANIZATION IS INDEXED
005700             ACCESS  MODE IS RANDOM
005800              RECORD KEY IS IX-FR2-KEY.
005900     SELECT IX-FR3 ASSIGN TO
006000     XXXXX026
006100             ORGANIZATION IS INDEXED
006200             ACCESS  MODE IS RANDOM
006300              RECORD KEY IS IX-FR3-KEY.
006400 I-O-CONTROL.
006500     SAME IX-FR2 IX-FR3.
006600 DATA DIVISION.
006700 FILE SECTION.
006800 FD  PRINT-FILE.
006900 01  PRINT-REC PICTURE X(120).
007000 01  DUMMY-RECORD PICTURE X(120).
007100 FD  IX-FR1
007200C    LABEL RECORDS ARE STANDARD
007300C    DATA RECORDS ARE GRP-1SEQ-RECORD-1A  GRP-1SEQ-RECORD-1B
007400     RECORD CONTAINS 56 TO 100 CHARACTERS.
007500 01  GRP-1SEQ-RECORD-1A.
007600     02  IX-FR1-KEY              PICTURE X(8).
007700     02  FILLER-1A               PICTURE X(48).
007800 01  GRP-1SEQ-RECORD-1B.
007900     02  FILLER-1B               PICTURE X(56).
008000     02  LONG-REC-1B.
008100         03  FILLER              PICTURE X(15).
008200         03  REC-NUMBER-1B       PICTURE XXX.
008300         03  FILLER              PICTURE X(26).
008400 FD  IX-FR2
008500C    DATA RECORDS  GRP-1SEQ-RECORD-2A  GRP-1SEQ-RECORD-2B
008600C    LABEL RECORDS ARE STANDARD
008700     RECORD CONTAINS 56 TO 101 CHARACTERS.
008800 01  GRP-1SEQ-RECORD-2A.
008900     02  IX-FR2-KEY              PICTURE X(8).
009000     02  FILLER-2A               PICTURE X(48).
009100 01  GRP-1SEQ-RECORD-2B.
009200     02  FILLER-2B               PICTURE X(56).
009300     02  LONG-REC-2B.
009400         03  FILLER              PICTURE X(15).
009500         03  REC-NUMBER-2B       PICTURE XXX.
009600         03  FILLER              PICTURE X(27).
009700 FD  IX-FR3
009800C    LABEL RECORD STANDARD
009900C    DATA RECORD  GRP-1SEQ-RECORD-3A  GRP-1SEQ-RECORD-3B
010000     BLOCK 3 RECORDS
010100     RECORD CONTAINS 56 TO 102 CHARACTERS.
010200 01  GRP-1SEQ-RECORD-3A.
010300     02  IX-FR3-KEY              PICTURE X(8).
010400     02  FILLER-3A               PICTURE X(48).
010500 01  GRP-1SEQ-RECORD-3B.
010600     02  FILLER-3B               PICTURE X(56).
010700     02  LONG-REC-3B.
010800         03  FILLER              PICTURE X(15).
010900         03  REC-NUMBER-3B       PICTURE XXX.
011000     02  FILLER                  PICTURE X(28).
011100 WORKING-STORAGE SECTION.
011200 01  SHORT-SW                    PICTURE 9 VALUE ZERO.
011300 01  RECORD-BUILD.
011400     02  KEY-BUILD.
011500         03  KEY-NAME            PICTURE X(3) VALUE "KEY".
011600         03  KEY-VALUE           PICTURE 9(5) VALUE ZERO.
011700     02  FILLER                  PICTURE X(6) VALUE " FILE ".
011800     02  FILE-NO                 PICTURE 99 VALUE ZERO.
011900     02  FILLER                  PICTURE X(14)  VALUE
012000     "  RECORD TYPE ".
012100     02  RECORD-LONG-OR-SHORT    PICTURE X(5) VALUE "SHORT".
012200     02  FILLER                  PICTURE X(21) VALUE SPACE.
012300     02  RECORD-LONG-ONLY.
012400         03  FILLER              PICTURE X(15)  VALUE
012500         " RECORD NUMBER ".
012600         03  THREE-POS-NUM       PICTURE 999 VALUE ZERO.
012700         03  FILLER-LONG         PICTURE X(28)  VALUE
012800         " AREA USED FOR LONG RECORD  ".
012900 01  FILE-RECORD-INFORMATION-REC.
013000     03 FILE-RECORD-INFO-SKELETON.
013100        05 FILLER                 PICTURE X(48)       VALUE
013200             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
013300        05 FILLER                 PICTURE X(46)       VALUE
013400             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
013500        05 FILLER                 PICTURE X(26)       VALUE
013600             ",LFIL=000000,ORG=  ,LBLR= ".
013700        05 FILLER                 PICTURE X(37)       VALUE
013800             ",RECKEY=                             ".
013900        05 FILLER                 PICTURE X(38)       VALUE
014000             ",ALTKEY1=                             ".
014100        05 FILLER                 PICTURE X(38)       VALUE
014200             ",ALTKEY2=                             ".
014300        05 FILLER                 PICTURE X(7)        VALUE SPACE.
014400     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
014500        05 FILE-RECORD-INFO-P1-120.
014600           07 FILLER              PIC X(5).
014700           07 XFILE-NAME           PIC X(6).
014800           07 FILLER              PIC X(8).
014900           07 XRECORD-NAME         PIC X(6).
015000           07 FILLER              PIC X(1).
015100           07 REELUNIT-NUMBER     PIC 9(1).
015200           07 FILLER              PIC X(7).
015300           07 XRECORD-NUMBER       PIC 9(6).
015400           07 FILLER              PIC X(6).
015500           07 UPDATE-NUMBER       PIC 9(2).
015600           07 FILLER              PIC X(5).
015700           07 ODO-NUMBER          PIC 9(4).
015800           07 FILLER              PIC X(5).
015900           07 XPROGRAM-NAME        PIC X(5).
016000           07 FILLER              PIC X(7).
016100           07 XRECORD-LENGTH       PIC 9(6).
016200           07 FILLER              PIC X(7).
016300           07 CHARS-OR-RECORDS    PIC X(2).
016400           07 FILLER              PIC X(1).
016500           07 XBLOCK-SIZE          PIC 9(4).
016600           07 FILLER              PIC X(6).
016700           07 RECORDS-IN-FILE     PIC 9(6).
016800           07 FILLER              PIC X(5).
016900           07 XFILE-ORGANIZATION   PIC X(2).
017000           07 FILLER              PIC X(6).
017100           07 XLABEL-TYPE          PIC X(1).
017200        05 FILE-RECORD-INFO-P121-240.
017300           07 FILLER              PIC X(8).
017400           07 XRECORD-KEY          PIC X(29).
017500           07 FILLER              PIC X(9).
017600           07 ALTERNATE-KEY1      PIC X(29).
017700           07 FILLER              PIC X(9).
017800           07 ALTERNATE-KEY2      PIC X(29).
017900           07 FILLER              PIC X(7).
018000 01  TEST-RESULTS.
018100     02 FILLER                   PIC X      VALUE SPACE.
018200     02 FEATURE                  PIC X(20)  VALUE SPACE.
018300     02 FILLER                   PIC X      VALUE SPACE.
018400     02 P-OR-F                   PIC X(5)   VALUE SPACE.
018500     02 FILLER                   PIC X      VALUE SPACE.
018600     02  PAR-NAME.
018700       03 FILLER                 PIC X(19)  VALUE SPACE.
018800       03  PARDOT-X              PIC X      VALUE SPACE.
018900       03 DOTVALUE               PIC 99     VALUE ZERO.
019000     02 FILLER                   PIC X(8)   VALUE SPACE.
019100     02 RE-MARK                  PIC X(61).
019200 01  TEST-COMPUTED.
019300     02 FILLER                   PIC X(30)  VALUE SPACE.
019400     02 FILLER                   PIC X(17)  VALUE
019500            "       COMPUTED=".
019600     02 COMPUTED-X.
019700     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
019800     03 COMPUTED-N               REDEFINES COMPUTED-A
019900                                 PIC -9(9).9(9).
020000     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
020100     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
020200     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
020300     03       CM-18V0 REDEFINES COMPUTED-A.
020400         04 COMPUTED-18V0                    PIC -9(18).
020500         04 FILLER                           PIC X.
020600     03 FILLER PIC X(50) VALUE SPACE.
020700 01  TEST-CORRECT.
020800     02 FILLER PIC X(30) VALUE SPACE.
020900     02 FILLER PIC X(17) VALUE "       CORRECT =".
021000     02 CORRECT-X.
021100     03 CORRECT-A                  PIC X(20) VALUE SPACE.
021200     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
021300     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
021400     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
021500     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
021600     03      CR-18V0 REDEFINES CORRECT-A.
021700         04 CORRECT-18V0                     PIC -9(18).
021800         04 FILLER                           PIC X.
021900     03 FILLER PIC X(2) VALUE SPACE.
022000     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
022100 01  CCVS-C-1.
022200     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
022300-    "SS  PARAGRAPH-NAME
022400-    "       REMARKS".
022500     02 FILLER                     PIC X(20)    VALUE SPACE.
022600 01  CCVS-C-2.
022700     02 FILLER                     PIC X        VALUE SPACE.
022800     02 FILLER                     PIC X(6)     VALUE "TESTED".
022900     02 FILLER                     PIC X(15)    VALUE SPACE.
023000     02 FILLER                     PIC X(4)     VALUE "FAIL".
023100     02 FILLER                     PIC X(94)    VALUE SPACE.
023200 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
023300 01  REC-CT                        PIC 99       VALUE ZERO.
023400 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
023500 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
023600 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
023700 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
023800 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
023900 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
024000 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
024100 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
024200 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
024300 01  CCVS-H-1.
024400     02  FILLER                    PIC X(39)    VALUE SPACES.
024500     02  FILLER                    PIC X(42)    VALUE
024600     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
024700     02  FILLER                    PIC X(39)    VALUE SPACES.
024800 01  CCVS-H-2A.
024900   02  FILLER                        PIC X(40)  VALUE SPACE.
025000   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
025100   02  FILLER                        PIC XXXX   VALUE
025200     "4.2 ".
025300   02  FILLER                        PIC X(28)  VALUE
025400            " COPY - NOT FOR DISTRIBUTION".
025500   02  FILLER                        PIC X(41)  VALUE SPACE.
025600
025700 01  CCVS-H-2B.
025800   02  FILLER                        PIC X(15)  VALUE
025900            "TEST RESULT OF ".
026000   02  TEST-ID                       PIC X(9).
026100   02  FILLER                        PIC X(4)   VALUE
026200            " IN ".
026300   02  FILLER                        PIC X(12)  VALUE
026400     " HIGH       ".
026500   02  FILLER                        PIC X(22)  VALUE
026600            " LEVEL VALIDATION FOR ".
026700   02  FILLER                        PIC X(58)  VALUE
026800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
026900 01  CCVS-H-3.
027000     02  FILLER                      PIC X(34)  VALUE
027100            " FOR OFFICIAL USE ONLY    ".
027200     02  FILLER                      PIC X(58)  VALUE
027300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
027400     02  FILLER                      PIC X(28)  VALUE
027500            "  COPYRIGHT   1985 ".
027600 01  CCVS-E-1.
027700     02 FILLER                       PIC X(52)  VALUE SPACE.
027800     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
027900     02 ID-AGAIN                     PIC X(9).
028000     02 FILLER                       PIC X(45)  VALUE SPACES.
028100 01  CCVS-E-2.
028200     02  FILLER                      PIC X(31)  VALUE SPACE.
028300     02  FILLER                      PIC X(21)  VALUE SPACE.
028400     02 CCVS-E-2-2.
028500         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
028600         03 FILLER                   PIC X      VALUE SPACE.
028700         03 ENDER-DESC               PIC X(44)  VALUE
028800            "ERRORS ENCOUNTERED".
028900 01  CCVS-E-3.
029000     02  FILLER                      PIC X(22)  VALUE
029100            " FOR OFFICIAL USE ONLY".
029200     02  FILLER                      PIC X(12)  VALUE SPACE.
029300     02  FILLER                      PIC X(58)  VALUE
029400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
029500     02  FILLER                      PIC X(13)  VALUE SPACE.
029600     02 FILLER                       PIC X(15)  VALUE
029700             " COPYRIGHT 1985".
029800 01  CCVS-E-4.
029900     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
030000     02 FILLER                       PIC X(4)   VALUE " OF ".
030100     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
030200     02 FILLER                       PIC X(40)  VALUE
030300      "  TESTS WERE EXECUTED SUCCESSFULLY".
030400 01  XXINFO.
030500     02 FILLER                       PIC X(19)  VALUE
030600            "*** INFORMATION ***".
030700     02 INFO-TEXT.
030800       04 FILLER                     PIC X(8)   VALUE SPACE.
030900       04 XXCOMPUTED                 PIC X(20).
031000       04 FILLER                     PIC X(5)   VALUE SPACE.
031100       04 XXCORRECT                  PIC X(20).
031200     02 INF-ANSI-REFERENCE           PIC X(48).
031300 01  HYPHEN-LINE.
031400     02 FILLER  PIC IS X VALUE IS SPACE.
031500     02 FILLER  PIC IS X(65)    VALUE IS "************************
031600-    "*****************************************".
031700     02 FILLER  PIC IS X(54)    VALUE IS "************************
031800-    "******************************".
031900 01  CCVS-PGM-ID                     PIC X(9)   VALUE
032000     "IX105A".
032100 PROCEDURE DIVISION.
032200 CCVS1 SECTION.
032300 OPEN-FILES.
032400     OPEN    OUTPUT PRINT-FILE.
032500     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
032600     MOVE    SPACE TO TEST-RESULTS.
032700     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
032800     MOVE    ZERO TO REC-SKL-SUB.
032900     PERFORM CCVS-INIT-FILE 9 TIMES.
033000 CCVS-INIT-FILE.
033100     ADD     1 TO REC-SKL-SUB.
033200     MOVE    FILE-RECORD-INFO-SKELETON
033300          TO FILE-RECORD-INFO (REC-SKL-SUB).
033400 CCVS-INIT-EXIT.
033500     GO TO CCVS1-EXIT.
033600 CLOSE-FILES.
033700     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
033800 TERMINATE-CCVS.
033900     STOP     RUN.
034000 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
034100 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
034200 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
034300 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
034400     MOVE "****TEST DELETED****" TO RE-MARK.
034500 PRINT-DETAIL.
034600     IF REC-CT NOT EQUAL TO ZERO
034700             MOVE "." TO PARDOT-X
034800             MOVE REC-CT TO DOTVALUE.
034900     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
035000     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
035100        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
035200          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
035300     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
035400     MOVE SPACE TO CORRECT-X.
035500     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
035600     MOVE     SPACE TO RE-MARK.
035700 HEAD-ROUTINE.
035800     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035900     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036000     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
036100     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
036200 COLUMN-NAMES-ROUTINE.
036300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
036600 END-ROUTINE.
036700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
036800 END-RTN-EXIT.
036900     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037000 END-ROUTINE-1.
037100      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
037200      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
037300      ADD PASS-COUNTER TO ERROR-HOLD.
037400*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
037500      MOVE PASS-COUNTER TO CCVS-E-4-1.
037600      MOVE ERROR-HOLD TO CCVS-E-4-2.
037700      MOVE CCVS-E-4 TO CCVS-E-2-2.
037800      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
037900  END-ROUTINE-12.
038000      MOVE "TEST(S) FAILED" TO ENDER-DESC.
038100     IF       ERROR-COUNTER IS EQUAL TO ZERO
038200         MOVE "NO " TO ERROR-TOTAL
038300         ELSE
038400         MOVE ERROR-COUNTER TO ERROR-TOTAL.
038500     MOVE     CCVS-E-2 TO DUMMY-RECORD.
038600     PERFORM WRITE-LINE.
038700 END-ROUTINE-13.
038800     IF DELETE-COUNTER IS EQUAL TO ZERO
038900         MOVE "NO " TO ERROR-TOTAL  ELSE
039000         MOVE DELETE-COUNTER TO ERROR-TOTAL.
039100     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
039200     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
039300      IF   INSPECT-COUNTER EQUAL TO ZERO
039400          MOVE "NO " TO ERROR-TOTAL
039500      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
039600      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
039700      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
039800     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
039900 WRITE-LINE.
040000     ADD 1 TO RECORD-COUNT.
040100Y    IF RECORD-COUNT GREATER 42
040200Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
040300Y        MOVE SPACE TO DUMMY-RECORD
040400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
040500Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
040600Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
040700Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
040800Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
040900Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
041000Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
041100Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
041200Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
041300Y        MOVE ZERO TO RECORD-COUNT.
041400     PERFORM WRT-LN.
041500 WRT-LN.
041600     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
041700     MOVE SPACE TO DUMMY-RECORD.
041800 BLANK-LINE-PRINT.
041900     PERFORM WRT-LN.
042000 FAIL-ROUTINE.
042100     IF     COMPUTED-X NOT EQUAL TO SPACE
042200            GO TO   FAIL-ROUTINE-WRITE.
042300     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
042400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
042500     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
042600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042700     MOVE   SPACES TO INF-ANSI-REFERENCE.
042800     GO TO  FAIL-ROUTINE-EX.
042900 FAIL-ROUTINE-WRITE.
043000     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
043100     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
043200     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
043300     MOVE   SPACES TO COR-ANSI-REFERENCE.
043400 FAIL-ROUTINE-EX. EXIT.
043500 BAIL-OUT.
043600     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
043700     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
043800 BAIL-OUT-WRITE.
043900     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
044000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
044100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044200     MOVE   SPACES TO INF-ANSI-REFERENCE.
044300 BAIL-OUT-EX. EXIT.
044400 CCVS1-EXIT.
044500     EXIT.
044600 SECT-RC-02-001 SECTION.
044700 WRITE-INIT-GF-01.
044800     MOVE "WRITE SHORT & LONG " TO FEATURE.
044900     MOVE "WRITE-TEST-GF-01" TO PAR-NAME.
045000 WRITE-TEST-GF-01.
045100*    CREATE AN INDEXED FILE OF 180 RECORDS.  THE RECORDS SIZE IS
045200*    VARIABLE LENGTH (056 TO 100 CHARACTERS).
045300     MOVE 1 TO FILE-NO.
045400     OPEN OUTPUT IX-FR1.
045500     PERFORM WRITE-TEST-GF-01-SHORT-REC 20 TIMES.
045600     PERFORM WRITE-TEST-GF-01-LONG-REC 45 TIMES.
045700     PERFORM WRITE-TEST-GF-01-SHORT-REC 50 TIMES.
045800     PERFORM WRITE-TEST-GF-01-LONG-REC 29 TIMES.
045900     PERFORM WRITE-TEST-GF-01-SHORT-REC 35 TIMES.
046000     PERFORM WRITE-TEST-GF-01-LONG-REC.
046100     IF THREE-POS-NUM EQUAL 180
046200        PERFORM PASS
046300        MOVE "FILE IX-FR1 CREATED (180 RECORDS)" TO RE-MARK
046400        GO TO WRITE-TEST-GF-01-WRITE.
046500     MOVE "WRONG NUMBER OF RECORDS WRITTEN" TO RE-MARK.
046600     GO TO WRITE-TEST-GF-01-FAIL.
046700 WRITE-DELETE-GF-01.
046800     PERFORM DE-LETE.
046900*    NOTE IX-FR1 IS NOT CREATED  SO SKIP TO WRITE-TEST-5.
047000     PERFORM PRINT-DETAIL.
047100     GO TO WRITE-INIT-GF-02.
047200 WRITE-TEST-GF-01-LONG-REC.
047300     ADD 1 TO KEY-VALUE  THREE-POS-NUM.
047400     MOVE "LONG " TO RECORD-LONG-OR-SHORT.
047500     MOVE RECORD-BUILD TO GRP-1SEQ-RECORD-1B.
047600     WRITE GRP-1SEQ-RECORD-1B INVALID KEY
047700        MOVE "INVALID KEY ON WRITE (LONG)" TO RE-MARK
047800        GO TO WRITE-TEST-GF-01-FAIL.
047900 WRITE-TEST-GF-01-SHORT-REC.
048000     ADD 1 TO KEY-VALUE  THREE-POS-NUM.
048100     MOVE "SHORT" TO RECORD-LONG-OR-SHORT.
048200     MOVE RECORD-BUILD TO GRP-1SEQ-RECORD-1B.
048300     WRITE GRP-1SEQ-RECORD-1A INVALID KEY
048400        MOVE "INVALID KEY ON WRITE (SHORT)" TO RE-MARK
048500        GO TO WRITE-TEST-GF-01-FAIL.
048600 WRITE-TEST-GF-01-FAIL.
048700     MOVE "IX-41 4.9.2 WRONG NUMBER OF RECORDS WRITTEN" TO RE-MARK
048800     PERFORM FAIL.
048900     MOVE 180 TO CORRECT-18V0.
049000     MOVE THREE-POS-NUM TO COMPUTED-18V0.
049100 WRITE-TEST-GF-01-WRITE.
049200     MOVE SPACE TO GRP-1SEQ-RECORD-1B.
049300     PERFORM PRINT-DETAIL.
049400     CLOSE IX-FR1.
049500 READ-INIT-F2-01.
049600     MOVE "READ TO VERIFY     " TO FEATURE.
049700     MOVE "READ-TEST-F2-01    " TO PAR-NAME.
049800*    VERIFY NUMBER OF RECORDS IN FILE.
049900     OPEN INPUT IX-FR1.
050000     MOVE 1 TO KEY-VALUE.
050100     MOVE KEY-BUILD TO IX-FR1-KEY.
050200 READ-TEST-F2-01.
050300     READ IX-FR1 INVALID KEY
050400        GO TO COMPARE-FOR-TEST-F2-01.
050500     ADD 1 TO KEY-VALUE.
050600     MOVE KEY-BUILD TO IX-FR1-KEY.
050700     IF KEY-VALUE GREATER THAN 181
050800        GO TO READ-FAIL-F2-01.
050900     GO TO READ-TEST-F2-01.
051000 COMPARE-FOR-TEST-F2-01.
051100     IF KEY-VALUE EQUAL 181
051200         PERFORM PASS
051300         MOVE "180 RECORDS VERIFIED" TO RE-MARK
051400         GO TO READ-WRITE-F2-01.
051500 READ-FAIL-F2-01.
051600     MOVE "IX-28 4.5.2                               " TO RE-MARK.
051700     PERFORM FAIL.
051800     MOVE 180 TO CORRECT-18V0.
051900     SUBTRACT 1 FROM KEY-VALUE.
052000     MOVE KEY-VALUE TO COMPUTED-18V0.
052100     MOVE "INCORRECT NUMBER OF RECORDS" TO RE-MARK.
052200 READ-WRITE-F2-01.
052300     MOVE "READ-TEST-F2-01" TO PAR-NAME.
052400     PERFORM PRINT-DETAIL.
052500     CLOSE IX-FR1.
052600 READ-INIT-F2-02.
052700     OPEN INPUT IX-FR1.
052800     MOVE 10 TO KEY-VALUE.
052900     MOVE KEY-BUILD TO IX-FR1-KEY.
053000     MOVE "READ  SHORT RECORDS" TO FEATURE.
053100     MOVE "READ-TEST-GF-02    " TO PAR-NAME.
053200 READ-TEST-F2-02.
053300*    VERIFY VARIABLE LENGTH RECORDS WERE CREATED BY TESTING
053400*    SHORT RECORD.
053500     READ IX-FR1 INVALID KEY
053600         PERFORM FAIL
053700         MOVE "KEY00010" TO CORRECT-A
053800         MOVE "***INVALID KEY***" TO COMPUTED-A
053900         MOVE "INVALID KEY IX-FR1 IX-28 4.5.2" TO RE-MARK
054000         GO TO READ-TEST-F2-02-WRITE.
054100*    NOTE  *** IF REC-NUMBER-1B CONTAINS THE RECORD NUMBER
054200*          THEN FIXED LENGTH RECORDS WERE WRITTEN INSTEAD
054300*          OF VARIABLE LENGTH RECORDS.
054400*    NOTE  CHECK LENGTH OF RECORD 10.
054500 COMPARE-FOR-TEST-F2-02.
054600     IF REC-NUMBER-1B EQUAL TO "010"
054700        MOVE "LONG RECORD CREATED" TO COMPUTED-A
054800     ELSE MOVE "SHORT RECORD CREATED" TO COMPUTED-A
054900          MOVE 1 TO SHORT-SW.
055000     MOVE "EXPECT SHORT RECORD" TO CORRECT-A.
055100     MOVE "INFO ONLY-SEE PROGRAM" TO RE-MARK.
055200 READ-TEST-F2-02-WRITE.
055300     PERFORM PRINT-DETAIL.
055400     CLOSE IX-FR1.
055500 READ-INIT-F2-03.
055600*    VERIFY VARIABLE LENGTH RECORDS WERE CREATED BY TESTING
055700*    LONG RECORD.
055800     OPEN INPUT IX-FR1.
055900     MOVE 144 TO KEY-VALUE.
056000     MOVE KEY-BUILD TO IX-FR1-KEY.
056100     MOVE "READ LONG   RECORDS" TO FEATURE.
056200     MOVE "READ-TEST-F2-03    " TO PAR-NAME.
056300 READ-TEST-F2-03.
056400     READ IX-FR1 INVALID KEY
056500         PERFORM FAIL
056600         MOVE "KEY00144" TO CORRECT-A
056700         MOVE "***INVALID KEY***" TO COMPUTED-A
056800         MOVE "INVAILD KEY IX-FR1" TO RE-MARK
056900         GO TO READ-WRITE-F2-03.
057000*    NOTE  *** IF REC-NUMBER-1B CONTAINS THE RECORD NUMBER
057100*              THEN LONG RECORDS WERE WRITTEN.
057200 COMPARE-FOR-TEST-F2-03.
057300     IF REC-NUMBER-1B NOT EQUAL TO "144" GO TO READ-FAIL-F2-03.
057400     PERFORM PASS.
057500     PERFORM READ-WRITE-F2-03.
057600     MOVE "EXPECT VARIABLE LTH" TO CORRECT-A.
057700     MOVE "INFO ONLY-SEE PROGRAM" TO RE-MARK.
057800     IF SHORT-SW EQUAL TO ZERO
057900        MOVE "FIXED RECORD CREATED" TO COMPUTED-A
058000        ELSE MOVE "VARIABLE LTH CREATED" TO COMPUTED-A.
058100     GO TO READ-WRITE-F2-03.
058200 READ-FAIL-F2-03.
058300     PERFORM FAIL.
058400     MOVE "KEY00144" TO CORRECT-A.
058500     MOVE IX-FR1-KEY TO COMPUTED-A.
058600     MOVE "WRONG LENGTH OR WRONG RECORD IX-28 4.5.2" TO RE-MARK.
058700 READ-WRITE-F2-03.
058800     PERFORM PRINT-DETAIL.
058900 READ-TEST-F2-03-EXIT.
059000     CLOSE  IX-FR1.
059100 WRITE-INIT-GF-02.
059200     MOVE "WRITE IX-FS2       " TO FEATURE.
059300     MOVE "WRITE-TEST-GF-02    " TO PAR-NAME.
059400*    CREATE AN INDEXED FILE OF 101 RECORDS.  THE RECORD SIZE IS
059500*    VARIABLE LENGTH (056 TO 101 CHARACTERS).
059600     MOVE ZERO TO KEY-VALUE  THREE-POS-NUM  SHORT-SW.
059700     MOVE 2 TO FILE-NO.
059800     OPEN OUTPUT IX-FR2.
059900 WRITE-TEST-GF-02.
060000     PERFORM WRITE-TEST-GF-02-SHORT-REC 11 TIMES.
060100     PERFORM WRITE-TEST-GF-02-LONG-REC 29 TIMES.
060200     PERFORM WRITE-TEST-GF-02-SHORT-REC 20 TIMES.
060300     PERFORM WRITE-TEST-GF-02-LONG-REC 20 TIMES.
060400     PERFORM WRITE-TEST-GF-02-SHORT-REC 20 TIMES.
060500     PERFORM WRITE-TEST-GF-02-LONG-REC.
060600     IF THREE-POS-NUM EQUAL 101
060700        PERFORM PASS
060800        MOVE "FILE IX-FR2 CREATED (101 RECORDS)" TO RE-MARK
060900        GO TO WRITE-TEST-GF-02-WRITE.
061000     MOVE "WRONG NUMBER OF RECORDS WRITTEN IX-41 4.9.2" TO RE-MARK
061100     GO TO WRITE-TEST-GF-02-FAIL.
061200 WRITE-DELETE-GF-02.
061300     PERFORM DE-LETE.
061400*    NOTE IX-FR2 IS NOT CREATED  SO SKIP TO WRITE-TEST-9.
061500     PERFORM PRINT-DETAIL.
061600     GO TO WRITE-INIT-GF-03.
061700 WRITE-TEST-GF-02-LONG-REC.
061800     ADD 1 TO KEY-VALUE  THREE-POS-NUM.
061900     MOVE "LONG " TO RECORD-LONG-OR-SHORT.
062000     MOVE RECORD-BUILD TO GRP-1SEQ-RECORD-2B.
062100     WRITE GRP-1SEQ-RECORD-2B INVALID KEY
062200        MOVE "INVALID KEY ON WRITE (LONG)" TO RE-MARK
062300        GO TO WRITE-TEST-GF-02-FAIL.
062400 WRITE-TEST-GF-02-SHORT-REC.
062500     ADD 1 TO KEY-VALUE  THREE-POS-NUM.
062600     MOVE "SHORT" TO RECORD-LONG-OR-SHORT.
062700     MOVE RECORD-BUILD TO GRP-1SEQ-RECORD-2B.
062800     WRITE GRP-1SEQ-RECORD-2A INVALID KEY
062900        MOVE "INVALID KEY ON WRITE (SHORT)" TO RE-MARK
063000        GO TO WRITE-TEST-GF-02-FAIL.
063100 WRITE-TEST-GF-02-FAIL.
063200     PERFORM FAIL.
063300     MOVE 101 TO CORRECT-18V0.
063400     MOVE THREE-POS-NUM TO COMPUTED-18V0.
063500 WRITE-TEST-GF-02-WRITE.
063600     MOVE SPACE TO GRP-1SEQ-RECORD-2B.
063700     PERFORM PRINT-DETAIL.
063800     CLOSE IX-FR2.
063900 READ-INIT-F2-05.
064000*    VERIFY NUMBER OF RECORDS IN FILE.
064100     MOVE "READ IX-FS2 VERIFY " TO FEATURE.
064200     MOVE "READ-TEST-F2-05    " TO PAR-NAME.
064300     OPEN INPUT IX-FR2.
064400     MOVE 1 TO KEY-VALUE.
064500     MOVE KEY-BUILD TO IX-FR2-KEY.
064600 READ-TEST-F2-05.
064700     READ IX-FR2 INVALID KEY
064800        GO TO COMPARE-FOR-TEST-F2-05.
064900     ADD 1 TO KEY-VALUE.
065000     MOVE KEY-BUILD TO IX-FR2-KEY.
065100     IF KEY-VALUE GREATER THAN 102
065200        GO TO READ-TEST-F2-05-FAIL.
065300     GO TO READ-TEST-F2-05.
065400 COMPARE-FOR-TEST-F2-05.
065500     IF KEY-VALUE EQUAL 102
065600         PERFORM PASS
065700         MOVE "101 RECORDS VERIFIED" TO RE-MARK
065800         GO TO READ-TEST-F2-05-WRITE.
065900 READ-TEST-F2-05-FAIL.
066000     PERFORM FAIL.
066100     MOVE 101 TO CORRECT-18V0.
066200     SUBTRACT 1 FROM KEY-VALUE.
066300     MOVE KEY-VALUE TO COMPUTED-18V0.
066400     MOVE "INCORRECT NUMBER OF RECORDS IX-28  4.5.2" TO RE-MARK.
066500 READ-TEST-F2-05-WRITE.
066600     PERFORM PRINT-DETAIL.
066700 READ-INIT-F2-06.
066800*    VERIFY VARIABLE LENGTH RECORDS WERE CREATED BY TESTING
066900*    SHORT RECORD.
067000     MOVE "READ               " TO FEATURE.
067100     MOVE "READ-TEST-F2-06    " TO PAR-NAME.
067200     MOVE 100 TO KEY-VALUE.
067300     MOVE KEY-BUILD TO IX-FR2-KEY.
067400 READ-TEST-F2-06.
067500     READ IX-FR2 INVALID KEY
067600         PERFORM FAIL
067700         MOVE "KEY00100" TO CORRECT-A
067800         MOVE "***INVALID KEY***" TO COMPUTED-A
067900         MOVE "INVAILD KEY IX-FR2 IX-28 4.5.2 " TO RE-MARK
068000         GO TO READ-TEST-F2-06-WRITE.
068100*    NOTE  *** IF REC-NUMBER-2B CONTAINS THE RECORD NUMBER
068200*          THEN FIXED LENGTH RECORDS WERE WRITTEN INSTEAD
068300*          OF VARIABLE LENGTH RECORDS.
068400*    NOTE  CHECK LENGTH OF RECORD 100.
068500 COMPARE-FOR-TEST-F2-06.
068600     IF REC-NUMBER-2B EQUAL TO "100"
068700        MOVE "LONG RECORD CREATED" TO COMPUTED-A
068800     ELSE MOVE "SHORT RECORD CREATED" TO COMPUTED-A
068900          MOVE 1 TO SHORT-SW.
069000     MOVE "EXPECT SHORT RECORD" TO CORRECT-A.
069100     MOVE "INFO ONLY-SEE PROGRAM" TO RE-MARK.
069200 READ-TEST-F2-06-WRITE.
069300     PERFORM PRINT-DETAIL.
069400 READ-INIT-F2-07.
069500*    VERIFY VARIABLE LENGTH RECORDS WERE CREATED BY TESTING
069600*    LONG RECORD.
069700     MOVE "READ               " TO FEATURE.
069800     MOVE "READ-TEST-F2-07    " TO PAR-NAME.
069900     MOVE 12 TO KEY-VALUE.
070000     MOVE KEY-BUILD TO IX-FR2-KEY.
070100 READ-TEST-F2-07.
070200     READ IX-FR2 INVALID KEY
070300         PERFORM FAIL
070400         MOVE "KEY00012" TO CORRECT-A
070500         MOVE "***INVALID KEY***" TO COMPUTED-A
070600         MOVE "INVALID KEY IX-FR2 IX-28 4.5.2" TO RE-MARK
070700         GO TO READ-TEST-F2-07-WRITE.
070800*    NOTE  ** IF REC-NUMBER-1B CONTAINS THE RECORD NUMBER
070900*             THEN LONG RECORDS WERE WRITTEN.
071000 COMPARE-FOR-TEST-F2-07.
071100     IF REC-NUMBER-2B EQUAL TO "012"
071200        PERFORM PASS
071300        PERFORM READ-TEST-F2-07-WRITE
071400        MOVE "EXPECT VARIABLE LTH" TO CORRECT-A
071500        MOVE "INFO ONLY-SEE PROGRAM" TO RE-MARK
071600        IF SHORT-SW EQUAL TO ZERO
071700           MOVE "FIXED RECORD CREATED" TO COMPUTED-A
071800           GO TO READ-TEST-F2-07-WRITE
071900        ELSE MOVE "VARIABLE LTH CREATED" TO COMPUTED-A
072000             GO TO READ-TEST-F2-07-WRITE.
072100     PERFORM FAIL.
072200     MOVE "KEY00012" TO CORRECT-A.
072300     MOVE IX-FR2-KEY TO COMPUTED-A.
072400     MOVE "WRONG LENGTH OR WRONG RECORD" TO RE-MARK.
072500 READ-TEST-F2-07-WRITE.
072600     PERFORM PRINT-DETAIL.
072700 READ-TEST-F2-07-EXIT.
072800     CLOSE IX-FR2.
072900 WRITE-INIT-GF-03.
073000*    CREATE AN INDEXED FILE OF 120 RECORDS.  THE RECORD SIZE IS
073100*    VARIABLE LENGTH (056-102 CHARACTERS).
073200     MOVE "WRITE IX-FS3       " TO FEATURE.
073300     MOVE "WRITE-TEST-GF-03   " TO PAR-NAME.
073400     MOVE ZERO TO KEY-VALUE  THREE-POS-NUM  SHORT-SW.
073500     MOVE 3 TO FILE-NO.
073600     OPEN OUTPUT IX-FR3.
073700 WRITE-TEST-GF-03.
073800     PERFORM WRITE-TEST-GF-03-SHORT-REC.
073900     PERFORM WRITE-TEST-GF-03-LONG-REC 15 TIMES.
074000     PERFORM WRITE-TEST-GF-03-SHORT-REC 20 TIMES.
074100     PERFORM WRITE-TEST-GF-03-LONG-REC 12 TIMES.
074200     PERFORM WRITE-TEST-GF-03-SHORT-REC 23 TIMES.
074300     PERFORM WRITE-TEST-GF-03-LONG-REC 23 TIMES.
074400     PERFORM WRITE-TEST-GF-03-SHORT-REC 25 TIMES.
074500     PERFORM WRITE-TEST-GF-03-LONG-REC.
074600     IF THREE-POS-NUM EQUAL 120
074700        PERFORM PASS
074800        MOVE "FILE IX-FR3 CREATED (120 RECORDS)" TO RE-MARK
074900        GO TO WRITE-TEST-GF-03-WRITE.
075000     MOVE "WRONG NUMBER OF RECORDS WRITTEN IX-41 4.9.2" TO RE-MARK
075100     GO TO WRITE-TEST-GF-03-FAIL.
075200 WRITE-DELETE-GF-03.
075300     PERFORM DE-LETE.
075400*    NOTE IX-FR3 IS NOT CREATED  SO SKIP TO END-PARAGRAPH.
075500     PERFORM PRINT-DETAIL.
075600     GO TO CCVS-EXIT.
075700 WRITE-TEST-GF-03-LONG-REC.
075800     ADD 1 TO KEY-VALUE  THREE-POS-NUM.
075900     MOVE "LONG " TO RECORD-LONG-OR-SHORT.
076000     MOVE RECORD-BUILD TO GRP-1SEQ-RECORD-3B.
076100     WRITE GRP-1SEQ-RECORD-3B INVALID KEY
076200        MOVE "INVALID KEY ON WRITE (LONG)" TO RE-MARK
076300        GO TO WRITE-TEST-GF-03-FAIL.
076400 WRITE-TEST-GF-03-SHORT-REC.
076500     ADD 1 TO KEY-VALUE  THREE-POS-NUM.
076600     MOVE "SHORT" TO RECORD-LONG-OR-SHORT.
076700     MOVE RECORD-BUILD TO GRP-1SEQ-RECORD-3B.
076800     WRITE GRP-1SEQ-RECORD-3A INVALID KEY
076900        MOVE "INVALID KEY ON WRITE (SHORT)" TO RE-MARK
077000        GO TO WRITE-TEST-GF-03-FAIL.
077100 WRITE-TEST-GF-03-FAIL.
077200     PERFORM FAIL.
077300     MOVE 120 TO CORRECT-18V0.
077400     MOVE THREE-POS-NUM TO COMPUTED-18V0.
077500 WRITE-TEST-GF-03-WRITE.
077600     MOVE SPACE TO GRP-1SEQ-RECORD-3B.
077700     PERFORM PRINT-DETAIL.
077800     CLOSE IX-FR3.
077900 READ-INIT-F2-08.
078000*    VERIFY VARIABLE LENGTH RECORDS WERE CREATED BY TESTING
078100*    LONG RECORD.
078200     MOVE "READ IX-FS3 VERIFY " TO FEATURE.
078300     MOVE "READ-TEST-F2-08    " TO PAR-NAME.
078400     OPEN INPUT IX-FR3.
078500     MOVE 1 TO KEY-VALUE.
078600     MOVE KEY-BUILD TO IX-FR3-KEY.
078700 READ-TEST-F2-08.
078800     READ IX-FR3 INVALID KEY
078900         PERFORM FAIL
079000         MOVE "KEY00016" TO CORRECT-A
079100         MOVE "***INVALID KEY***" TO COMPUTED-A
079200         MOVE "INVAILD KEY IX-FR3" TO RE-MARK
079300         GO TO READ-TEST-F2-08-WRITE.
079400     IF KEY-VALUE NOT EQUAL TO 16
079500        ADD 1 TO KEY-VALUE
079600        MOVE KEY-BUILD TO IX-FR3-KEY
079700        GO TO READ-TEST-F2-08.
079800*    NOTE  *** IF REC-NUMBER-3B CONTAINS THE RECORD NUMBER
079900*              THEN LONG RECORDS WERE WRITTEN.
080000 COMPARE-FOR-TEST-F2-08.
080100     IF REC-NUMBER-3B EQUAL TO "016"
080200        PERFORM PASS
080300        GO TO READ-TEST-F2-08-WRITE.
080400     PERFORM FAIL.
080500     MOVE "KEY00016" TO CORRECT-A.
080600     MOVE IX-FR3-KEY TO COMPUTED-A.
080700     MOVE "WRONG LENGTH OR WRONG RECORD IX-28 4.5.2" TO RE-MARK.
080800 READ-TEST-F2-08-WRITE.
080900     PERFORM PRINT-DETAIL.
081000 READ-INIT-09.
081100*    VERIFY VARIABLE LENGTH RECORDS WERE CREATED BY TESTING
081200*    SHORT RECORD.
081300     MOVE "READ  SHORT RECORDS" TO FEATURE.
081400     MOVE "READ-TEST-F2-09    " TO PAR-NAME.
081500     MOVE 71 TO KEY-VALUE.
081600     MOVE KEY-BUILD TO IX-FR3-KEY.
081700 READ-TEST-F2-09.
081800     READ IX-FR3 INVALID KEY
081900         PERFORM FAIL
082000         MOVE "KEY00071" TO CORRECT-A
082100         MOVE "***INVALID KEY***" TO COMPUTED-A
082200         MOVE "INVAILD KEY IX-FR3 IX-28 4.5.2" TO RE-MARK
082300         GO TO READ-TEST-F2-09-WRITE.
082400*    NOTE  *** IF REC-NUMBER-1B CONTAINS THE RECORD NUMBER
082500*          THEN FIXED LENGTH RECORDS WERE WRITTEN INSTEAD
082600*          OF VARIABLE LENGTH RECORDS.
082700*    NOTE  CHECK LENGTH OF RECORD 71.
082800 COMPARE-FOR-TEST-F2-09.
082900     IF REC-NUMBER-3B EQUAL TO "071"
083000        MOVE "LONG RECORD CREATED" TO COMPUTED-A
083100     ELSE MOVE "SHORT RECORD CREATED" TO COMPUTED-A
083200          MOVE 1 TO SHORT-SW.
083300     MOVE "EXPECT SHORT RECORD" TO CORRECT-A.
083400     MOVE "INFO ONLY-SEE PROGRAM" TO RE-MARK.
083500 READ-TEST-F2-09-WRITE.
083600     PERFORM PRINT-DETAIL.
083700 READ-INIT-F2-10.
083800*    VERIFY VARIABLE LENGTH RECORDS WERE CREATED BY TESTING
083900*    LONG RECORD.
084000     MOVE "READ LONG   RECORDS" TO FEATURE.
084100     MOVE "READ-TEST-F2-10    " TO PAR-NAME.
084200     MOVE 120 TO KEY-VALUE.
084300     MOVE KEY-BUILD TO IX-FR3-KEY.
084400 READ-TEST-F2-10.
084500     READ IX-FR3 INVALID KEY
084600         PERFORM FAIL
084700         MOVE "KEY00120" TO CORRECT-A
084800         MOVE "***INVALID KEY***" TO COMPUTED-A
084900         MOVE "INVAILD KEY IX-FR3 IX-28 4.5.2" TO RE-MARK
085000         GO TO READ-TEST-F2-10-WRITE.
085100*    NOTE  *** IF REC-NUMBER-3B CONTAINS THE RECORD NUMBER
085200*          THEN LONG RECORDS WERE WITTEN.
085300 COMPARE-FOR-TEST-F2-10.
085400     IF REC-NUMBER-3B EQUAL TO "120"
085500        PERFORM PASS
085600        PERFORM READ-TEST-F2-10-WRITE
085700        MOVE "EXPECT VARIABLE LTH" TO CORRECT-A
085800        MOVE "INFO ONLY-SEE PROGRAM" TO RE-MARK
085900        IF SHORT-SW EQUAL TO ZERO
086000           MOVE "FIXED RECORD CREATED" TO COMPUTED-A
086100           GO TO READ-TEST-F2-10-WRITE
086200        ELSE MOVE "VARIABLE LTH CREATED" TO COMPUTED-A
086300             GO TO READ-TEST-F2-10-WRITE.
086400     PERFORM FAIL.
086500     MOVE "KEY00120" TO CORRECT-A.
086600     MOVE IX-FR3-KEY TO COMPUTED-A.
086700     MOVE "WRONG LENGTH OR WRONG RECORD IX-28 4.5.2" TO RE-MARK.
086800 READ-TEST-F2-10-WRITE.
086900     MOVE "READ-TEST-012" TO PAR-NAME.
087000     PERFORM PRINT-DETAIL.
087100 READ-TEST-F2-10-EXIT.
087200     CLOSE IX-FR3.
087300 CCVS-EXIT SECTION.
087400 CCVS-999999.
087500     GO TO CLOSE-FILES.
