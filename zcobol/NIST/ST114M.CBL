000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST114M.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100 ENVIRONMENT DIVISION.
002200 CONFIGURATION SECTION.
002300 SOURCE-COMPUTER.
002400     XXXXX082.
002500 OBJECT-COMPUTER.
002600     XXXXX083.
002700 INPUT-OUTPUT SECTION.
002800 FILE-CONTROL.
002900     SELECT PRINT-FILE ASSIGN TO
003000     XXXXX055.
003100     SELECT   SORTIN-1N ASSIGN TO
003200     XXXXD001.
003300 DATA DIVISION.
003400 FILE SECTION.
003500 FD  PRINT-FILE.
003600 01  PRINT-REC PICTURE X(120).
003700 01  DUMMY-RECORD PICTURE X(120).
003800 FD  SORTIN-1N
003900     LABEL RECORDS STANDARD
004000C    VALUE OF
004100C    XXXXX074
004200C    IS
004300C    XXXXX075
004400G    XXXXX069
004500              DATA RECORDS ARE SORT-KEY.
004600 01  SORT-KEY           PICTURE X(33).
004700 WORKING-STORAGE SECTION.
004800 77  ALL-A              PICTURE X(33) VALUE
004900     ALL "A".
005000 77  ALL-N              PICTURE X(33) VALUE
005100     ALL "N".
005200 77  ALL-Z              PICTURE X(33) VALUE
005300     ALL "Z".
005400 77  UTIL-CTR           PICTURE S99999 VALUE ZERO.
005500 01  COMPUTED-BREAKDOWN.
005600     02 FIRST-20-CM     PICTURE X(20).
005700     02 SECOND-20-CM    PICTURE X(20).
005800 01  CORRECT-BREAKDOWN.
005900     02 FIRST-20-CR     PICTURE X(20).
006000     02 SECOND-20-CR    PICTURE X(20).
006100 01  TEST-RESULTS.
006200     02 FILLER                   PIC X      VALUE SPACE.
006300     02 FEATURE                  PIC X(20)  VALUE SPACE.
006400     02 FILLER                   PIC X      VALUE SPACE.
006500     02 P-OR-F                   PIC X(5)   VALUE SPACE.
006600     02 FILLER                   PIC X      VALUE SPACE.
006700     02  PAR-NAME.
006800       03 FILLER                 PIC X(19)  VALUE SPACE.
006900       03  PARDOT-X              PIC X      VALUE SPACE.
007000       03 DOTVALUE               PIC 99     VALUE ZERO.
007100     02 FILLER                   PIC X(8)   VALUE SPACE.
007200     02 RE-MARK                  PIC X(61).
007300 01  TEST-COMPUTED.
007400     02 FILLER                   PIC X(30)  VALUE SPACE.
007500     02 FILLER                   PIC X(17)  VALUE
007600            "       COMPUTED=".
007700     02 COMPUTED-X.
007800     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
007900     03 COMPUTED-N               REDEFINES COMPUTED-A
008000                                 PIC -9(9).9(9).
008100     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
008200     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
008300     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
008400     03       CM-18V0 REDEFINES COMPUTED-A.
008500         04 COMPUTED-18V0                    PIC -9(18).
008600         04 FILLER                           PIC X.
008700     03 FILLER PIC X(50) VALUE SPACE.
008800 01  TEST-CORRECT.
008900     02 FILLER PIC X(30) VALUE SPACE.
009000     02 FILLER PIC X(17) VALUE "       CORRECT =".
009100     02 CORRECT-X.
009200     03 CORRECT-A                  PIC X(20) VALUE SPACE.
009300     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
009400     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
009500     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
009600     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
009700     03      CR-18V0 REDEFINES CORRECT-A.
009800         04 CORRECT-18V0                     PIC -9(18).
009900         04 FILLER                           PIC X.
010000     03 FILLER PIC X(2) VALUE SPACE.
010100     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
010200 01  CCVS-C-1.
010300     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
010400-    "SS  PARAGRAPH-NAME
010500-    "       REMARKS".
010600     02 FILLER                     PIC X(20)    VALUE SPACE.
010700 01  CCVS-C-2.
010800     02 FILLER                     PIC X        VALUE SPACE.
010900     02 FILLER                     PIC X(6)     VALUE "TESTED".
011000     02 FILLER                     PIC X(15)    VALUE SPACE.
011100     02 FILLER                     PIC X(4)     VALUE "FAIL".
011200     02 FILLER                     PIC X(94)    VALUE SPACE.
011300 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
011400 01  REC-CT                        PIC 99       VALUE ZERO.
011500 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
011600 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
011700 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
011800 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
011900 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
012000 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
012100 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
012200 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
012300 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
012400 01  CCVS-H-1.
012500     02  FILLER                    PIC X(39)    VALUE SPACES.
012600     02  FILLER                    PIC X(42)    VALUE
012700     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
012800     02  FILLER                    PIC X(39)    VALUE SPACES.
012900 01  CCVS-H-2A.
013000   02  FILLER                        PIC X(40)  VALUE SPACE.
013100   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
013200   02  FILLER                        PIC XXXX   VALUE
013300     "4.2 ".
013400   02  FILLER                        PIC X(28)  VALUE
013500            " COPY - NOT FOR DISTRIBUTION".
013600   02  FILLER                        PIC X(41)  VALUE SPACE.
013700
013800 01  CCVS-H-2B.
013900   02  FILLER                        PIC X(15)  VALUE
014000            "TEST RESULT OF ".
014100   02  TEST-ID                       PIC X(9).
014200   02  FILLER                        PIC X(4)   VALUE
014300            " IN ".
014400   02  FILLER                        PIC X(12)  VALUE
014500     " HIGH       ".
014600   02  FILLER                        PIC X(22)  VALUE
014700            " LEVEL VALIDATION FOR ".
014800   02  FILLER                        PIC X(58)  VALUE
014900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
015000 01  CCVS-H-3.
015100     02  FILLER                      PIC X(34)  VALUE
015200            " FOR OFFICIAL USE ONLY    ".
015300     02  FILLER                      PIC X(58)  VALUE
015400     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
015500     02  FILLER                      PIC X(28)  VALUE
015600            "  COPYRIGHT   1985 ".
015700 01  CCVS-E-1.
015800     02 FILLER                       PIC X(52)  VALUE SPACE.
015900     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
016000     02 ID-AGAIN                     PIC X(9).
016100     02 FILLER                       PIC X(45)  VALUE SPACES.
016200 01  CCVS-E-2.
016300     02  FILLER                      PIC X(31)  VALUE SPACE.
016400     02  FILLER                      PIC X(21)  VALUE SPACE.
016500     02 CCVS-E-2-2.
016600         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
016700         03 FILLER                   PIC X      VALUE SPACE.
016800         03 ENDER-DESC               PIC X(44)  VALUE
016900            "ERRORS ENCOUNTERED".
017000 01  CCVS-E-3.
017100     02  FILLER                      PIC X(22)  VALUE
017200            " FOR OFFICIAL USE ONLY".
017300     02  FILLER                      PIC X(12)  VALUE SPACE.
017400     02  FILLER                      PIC X(58)  VALUE
017500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
017600     02  FILLER                      PIC X(13)  VALUE SPACE.
017700     02 FILLER                       PIC X(15)  VALUE
017800             " COPYRIGHT 1985".
017900 01  CCVS-E-4.
018000     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
018100     02 FILLER                       PIC X(4)   VALUE " OF ".
018200     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
018300     02 FILLER                       PIC X(40)  VALUE
018400      "  TESTS WERE EXECUTED SUCCESSFULLY".
018500 01  XXINFO.
018600     02 FILLER                       PIC X(19)  VALUE
018700            "*** INFORMATION ***".
018800     02 INFO-TEXT.
018900       04 FILLER                     PIC X(8)   VALUE SPACE.
019000       04 XXCOMPUTED                 PIC X(20).
019100       04 FILLER                     PIC X(5)   VALUE SPACE.
019200       04 XXCORRECT                  PIC X(20).
019300     02 INF-ANSI-REFERENCE           PIC X(48).
019400 01  HYPHEN-LINE.
019500     02 FILLER  PIC IS X VALUE IS SPACE.
019600     02 FILLER  PIC IS X(65)    VALUE IS "************************
019700-    "*****************************************".
019800     02 FILLER  PIC IS X(54)    VALUE IS "************************
019900-    "******************************".
020000 01  CCVS-PGM-ID                     PIC X(9)   VALUE
020100     "ST114M".
020200 PROCEDURE DIVISION.
020300 CCVS1 SECTION.
020400 OPEN-FILES.
020500     OPEN     OUTPUT PRINT-FILE.
020600     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
020700     MOVE    SPACE TO TEST-RESULTS.
020800     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
020900     GO TO CCVS1-EXIT.
021000 CLOSE-FILES.
021100     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
021200 TERMINATE-CCVS.
021300S    EXIT PROGRAM.
021400STERMINATE-CALL.
021500     STOP     RUN.
021600 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
021700 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
021800 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
021900 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
022000     MOVE "****TEST DELETED****" TO RE-MARK.
022100 PRINT-DETAIL.
022200     IF REC-CT NOT EQUAL TO ZERO
022300             MOVE "." TO PARDOT-X
022400             MOVE REC-CT TO DOTVALUE.
022500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
022600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
022700        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
022800          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
022900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
023000     MOVE SPACE TO CORRECT-X.
023100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
023200     MOVE     SPACE TO RE-MARK.
023300 HEAD-ROUTINE.
023400     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023500     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023600     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
023700     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
023800 COLUMN-NAMES-ROUTINE.
023900     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
024000     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
024200 END-ROUTINE.
024300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
024400 END-RTN-EXIT.
024500     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024600 END-ROUTINE-1.
024700      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
024800      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
024900      ADD PASS-COUNTER TO ERROR-HOLD.
025000*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
025100      MOVE PASS-COUNTER TO CCVS-E-4-1.
025200      MOVE ERROR-HOLD TO CCVS-E-4-2.
025300      MOVE CCVS-E-4 TO CCVS-E-2-2.
025400      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
025500  END-ROUTINE-12.
025600      MOVE "TEST(S) FAILED" TO ENDER-DESC.
025700     IF       ERROR-COUNTER IS EQUAL TO ZERO
025800         MOVE "NO " TO ERROR-TOTAL
025900         ELSE
026000         MOVE ERROR-COUNTER TO ERROR-TOTAL.
026100     MOVE     CCVS-E-2 TO DUMMY-RECORD.
026200     PERFORM WRITE-LINE.
026300 END-ROUTINE-13.
026400     IF DELETE-COUNTER IS EQUAL TO ZERO
026500         MOVE "NO " TO ERROR-TOTAL  ELSE
026600         MOVE DELETE-COUNTER TO ERROR-TOTAL.
026700     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
026800     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026900      IF   INSPECT-COUNTER EQUAL TO ZERO
027000          MOVE "NO " TO ERROR-TOTAL
027100      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
027200      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
027300      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027400     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027500 WRITE-LINE.
027600     ADD 1 TO RECORD-COUNT.
027700Y    IF RECORD-COUNT GREATER 42
027800Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
027900Y        MOVE SPACE TO DUMMY-RECORD
028000Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
028100Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
028200Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
028300Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
028400Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
028500Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
028600Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
028700Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
028800Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
028900Y        MOVE ZERO TO RECORD-COUNT.
029000     PERFORM WRT-LN.
029100 WRT-LN.
029200     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
029300     MOVE SPACE TO DUMMY-RECORD.
029400 BLANK-LINE-PRINT.
029500     PERFORM WRT-LN.
029600 FAIL-ROUTINE.
029700     IF     COMPUTED-X NOT EQUAL TO SPACE
029800            GO TO   FAIL-ROUTINE-WRITE.
029900     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
030000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
030100     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
030200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030300     MOVE   SPACES TO INF-ANSI-REFERENCE.
030400     GO TO  FAIL-ROUTINE-EX.
030500 FAIL-ROUTINE-WRITE.
030600     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
030700     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
030800     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
030900     MOVE   SPACES TO COR-ANSI-REFERENCE.
031000 FAIL-ROUTINE-EX. EXIT.
031100 BAIL-OUT.
031200     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
031300     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
031400 BAIL-OUT-WRITE.
031500     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
031600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
031700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031800     MOVE   SPACES TO INF-ANSI-REFERENCE.
031900 BAIL-OUT-EX. EXIT.
032000 CCVS1-EXIT.
032100     EXIT.
032200 SECT-ST114-0001 SECTION.
032300 ST114-0001-01.
032400     OPEN     INPUT   SORTIN-1N.
032500     MOVE    "        ************   ST113 WILL NOT PRODUCE ANY PR
032600-    "INTED REPORT   ************" TO TEST-RESULTS.
032700     PERFORM PRINT-DETAIL.
032800     MOVE    SPACE TO TEST-RESULTS.
032900     PERFORM END-ROUTINE.
033000     PERFORM BLANK-LINE-PRINT.
033100 SORT-INIT-A.
033200     MOVE     "SORT, MULTIPLE REEL" TO FEATURE.
033300 SORT-TEST-1.
033400     MOVE     "SORT-TEST-1" TO PAR-NAME.
033500     PERFORM  READ-SORTIN.
033600     IF       SORT-KEY EQUAL TO ALL-Z
033700              PERFORM PASS GO TO SORT-WRITE-1.
033800 SORT-FAIL-1.
033900     MOVE     SORT-KEY TO COMPUTED-BREAKDOWN.
034000     MOVE     ALL-Z TO CORRECT-BREAKDOWN.
034100     PERFORM  BREAKDOWN-PARA.
034200 SORT-WRITE-1.
034300     PERFORM  PRINT-DETAIL.
034400 SORT-TEST-2.
034500     MOVE     "SORT-TEST-2" TO PAR-NAME.
034600     PERFORM  READ-SORTIN.
034700     IF       SORT-KEY EQUAL TO ALL-Z
034800              PERFORM PASS GO TO SORT-WRITE-2.
034900 SORT-FAIL-2.
035000     MOVE     SORT-KEY TO COMPUTED-BREAKDOWN.
035100     MOVE     ALL-Z TO CORRECT-BREAKDOWN.
035200     PERFORM  BREAKDOWN-PARA.
035300 SORT-WRITE-2.
035400     PERFORM  PRINT-DETAIL.
035500 SORT-TEST-3.
035600     MOVE     "SORT-TEST-3" TO PAR-NAME.
035700     PERFORM  READ-SORTIN.
035800     IF       SORT-KEY EQUAL TO ALL-Z
035900              PERFORM PASS GO TO SORT-WRITE-3.
036000 SORT-FAIL-3.
036100     MOVE     SORT-KEY TO COMPUTED-BREAKDOWN.
036200     MOVE     ALL-Z TO CORRECT-BREAKDOWN.
036300     PERFORM  BREAKDOWN-PARA.
036400 SORT-WRITE-3.
036500     PERFORM  PRINT-DETAIL.
036600 SORT-TEST-4.
036700     MOVE     "SORT-TEST-4" TO PAR-NAME.
036800     PERFORM  READ-SORTIN 34 TIMES.
036900     IF       SORT-KEY EQUAL TO ALL-N
037000              PERFORM PASS GO TO SORT-WRITE-4.
037100 SORT-FAIL-4.
037200     MOVE     SORT-KEY TO COMPUTED-BREAKDOWN.
037300     MOVE     ALL-N TO CORRECT-BREAKDOWN.
037400     PERFORM  BREAKDOWN-PARA.
037500 SORT-WRITE-4.
037600     PERFORM  PRINT-DETAIL.
037700 SORT-TEST-5.
037800     MOVE     "SORT-TEST-5" TO PAR-NAME.
037900     PERFORM  READ-SORTIN.
038000     IF       SORT-KEY EQUAL TO ALL-N
038100              PERFORM PASS GO TO SORT-WRITE-5.
038200 SORT-FAIL-5.
038300     MOVE     SORT-KEY TO COMPUTED-BREAKDOWN.
038400     MOVE     ALL-N TO CORRECT-BREAKDOWN.
038500     PERFORM  BREAKDOWN-PARA.
038600 SORT-WRITE-5.
038700     PERFORM  PRINT-DETAIL.
038800 SORT-TEST-6.
038900     PERFORM  READ-SORTIN.
039000     MOVE     "SORT-TEST-6" TO PAR-NAME.
039100     IF       SORT-KEY EQUAL TO ALL-N
039200              PERFORM PASS GO TO SORT-WRITE-6.
039300 SORT-FAIL-6.
039400     MOVE     SORT-KEY TO COMPUTED-BREAKDOWN.
039500     MOVE     ALL-N TO CORRECT-BREAKDOWN.
039600     PERFORM  BREAKDOWN-PARA.
039700 SORT-WRITE-6.
039800     PERFORM  PRINT-DETAIL.
039900 SORT-TEST-7.
040000     MOVE     "SORT-TEST-7" TO PAR-NAME.
040100     PERFORM  READ-SORTIN 37 TIMES.
040200     IF       SORT-KEY EQUAL TO ALL-A
040300              PERFORM PASS GO TO SORT-WRITE-7.
040400 SORT-FAIL-7.
040500     MOVE     SORT-KEY TO COMPUTED-BREAKDOWN.
040600     MOVE     ALL-A TO CORRECT-BREAKDOWN.
040700     PERFORM  BREAKDOWN-PARA.
040800 SORT-WRITE-7.
040900     PERFORM  PRINT-DETAIL.
041000 SORT-TEST-8.
041100     MOVE     "SORT-TEST-8" TO PAR-NAME.
041200     PERFORM  READ-SORTIN.
041300     IF       SORT-KEY EQUAL TO ALL-A
041400              PERFORM PASS GO TO SORT-WRITE-8.
041500 SORT-FAIL-8.
041600     MOVE     SORT-KEY TO COMPUTED-BREAKDOWN.
041700     MOVE     ALL-A TO CORRECT-BREAKDOWN.
041800     PERFORM  BREAKDOWN-PARA.
041900 SORT-WRITE-8.
042000     PERFORM  PRINT-DETAIL.
042100 SORT-TEST-9.
042200     MOVE     "SORT-TEST-9" TO PAR-NAME.
042300     PERFORM  READ-SORTIN.
042400     IF       SORT-KEY EQUAL TO ALL-A
042500              PERFORM PASS GO TO SORT-WRITE-9.
042600 SORT-FAIL-9.
042700     MOVE     SORT-KEY TO COMPUTED-BREAKDOWN.
042800     MOVE     ALL-A TO CORRECT-BREAKDOWN.
042900     PERFORM  BREAKDOWN-PARA.
043000 SORT-WRITE-9.
043100     PERFORM  PRINT-DETAIL.
043200 SORT-TEST-10.
043300     MOVE     "SORT-TEST-10" TO PAR-NAME.
043400     READ     SORTIN-1N AT END
043500              PERFORM PASS GO TO SORT-WRITE-10.
043600 SORT-FAIL-10.
043700     MOVE     SORT-KEY TO COMPUTED-BREAKDOWN.
043800     MOVE     SPACE TO CORRECT-BREAKDOWN.
043900     PERFORM  BREAKDOWN-PARA.
044000     PERFORM  PRINT-DETAIL.
044100     MOVE     "END OF FILE NOT FOUND" TO RE-MARK.
044200 SORT-WRITE-10.
044300     PERFORM  PRINT-DETAIL.
044400     CLOSE    SORTIN-1N.
044500     GO TO    CCVS-EXIT.
044600 BREAKDOWN-PARA.
044700     PERFORM  FAIL.
044800     MOVE     FIRST-20-CM TO COMPUTED-A.
044900     MOVE     FIRST-20-CR TO CORRECT-A.
045000     MOVE     "FIRST 20 CHARACTERS" TO RE-MARK.
045100     PERFORM  PRINT-DETAIL.
045200     MOVE     SECOND-20-CM TO COMPUTED-A.
045300     MOVE     SECOND-20-CR TO CORRECT-A.
045400     MOVE     "LAST 13 CHARACTERS" TO RE-MARK.
045500 READ-SORTIN.
045600     READ     SORTIN-1N AT END GO TO READ-ERROR.
045700     ADD      1 TO UTIL-CTR.
045800 READ-ERROR.
045900     MOVE     "READ-SORTIN" TO PAR-NAME.
046000     PERFORM  FAIL.
046100     MOVE     UTIL-CTR TO COMPUTED-N.
046200     MOVE     78 TO CORRECT-N.
046300     MOVE     "TOO FEW RECORDS IN FILE" TO RE-MARK.
046400     PERFORM  PRINT-DETAIL.
046500 CCVS-EXIT SECTION.
046600 CCVS-999999.
046700     GO TO CLOSE-FILES.
