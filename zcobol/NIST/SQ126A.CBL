000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ126A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300
001400*
001500*
001600******************************************************************
001700*                                                                *
001800*    NEW TESTS:                                                  *
001900*                                                                *
002000*    READ ... AT END  ... NOT AT END ...                         *
002100*                                                                *
002200*    READ ... RECORD AT END ... NOT END                          *
002300*                                                                *
002400*    IF ... READ ... AT END ... NOT AT END ... END-READ          *
002500*                                                                *
002600*    IF ... READ ... RECORD END ... NOT END ... END-READ ...     *
002700*                                                                *
002800******************************************************************
002900*
003000*        THE ROUTINE SQ126A TESTS THE USE OF THE NOT AT END
003100*    PHRASE FOR THE READ STATEMENT AND ALSO THE END-READ PHRASE.
003200*
003300*
003400*    USED X-CARDS:
003500*         XXXXX001
003600*         XXXXX055
003700*     P   XXXXX062
003800*         XXXXX082
003900*         XXXXX083
004000*     C   XXXXX084
004100*
004200*
004300 ENVIRONMENT DIVISION.
004400 CONFIGURATION SECTION.
004500 SOURCE-COMPUTER.
004600     XXXXX082.
004700 OBJECT-COMPUTER.
004800     XXXXX083.
004900 INPUT-OUTPUT SECTION.
005000 FILE-CONTROL.
005100P    SELECT RAW-DATA   ASSIGN TO
005200P    XXXXX062
005300P           ORGANIZATION IS INDEXED
005400P           ACCESS MODE IS RANDOM
005500P           RECORD KEY IS RAW-DATA-KEY.
005600     SELECT PRINT-FILE ASSIGN TO
005700     XXXXX055.
005800     SELECT SQ-FS1 ASSIGN TO
005900     XXXXX001
006000     ORGANIZATION IS SEQUENTIAL
006100     ACCESS MODE IS SEQUENTIAL.
006200
006300 DATA DIVISION.
006400
006500 FILE SECTION.
006600P
006700PFD  RAW-DATA.
006800P
006900P01  RAW-DATA-SATZ.
007000P    05  RAW-DATA-KEY        PIC X(6).
007100P    05  C-DATE              PIC 9(6).
007200P    05  C-TIME              PIC 9(8).
007300P    05  C-NO-OF-TESTS       PIC 99.
007400P    05  C-OK                PIC 999.
007500P    05  C-ALL               PIC 999.
007600P    05  C-FAIL              PIC 999.
007700P    05  C-DELETED           PIC 999.
007800P    05  C-INSPECT           PIC 999.
007900P    05  C-NOTE              PIC X(13).
008000P    05  C-INDENT            PIC X.
008100P    05  C-ABORT             PIC X(8).
008200
008300 FD  PRINT-FILE
008400C    LABEL RECORDS
008500C    XXXXX084
008600C    DATA RECORD IS PRINT-REC DUMMY-RECORD
008700               .
008800
008900 01  PRINT-REC               PIC X(120).
009000
009100 01  DUMMY-RECORD            PIC X(120).
009200
009300 FD  SQ-FS1
009400C       LABEL RECORD STANDARD
009500               .
009600
009700 01  SQ-FS1R1-F-G-120.
009800     05  FILLER              PIC X(120).
009900
010000 WORKING-STORAGE SECTION.
010100
010200 01  SWITCH-READ1            PIC 9 VALUE ZERO.
010300 01  SWITCH-READ2            PIC 9 VALUE ZERO.
010400 01  SWITCH-READ3            PIC 9 VALUE ZERO.
010500 01  FILE-STATUS-SQ-FS1      PIC XX VALUE SPACE.
010600 01  WRK-CS-09V00            PIC S9(9) COMP VALUE ZERO.
010700 01  RECORDS-IN-ERROR        PIC S9(5) COMP VALUE ZERO.
010800 01  ERROR-FLAG              PIC 9 VALUE ZERO.
010900 01  EOF-FLAG                PIC 9 VALUE ZERO.
011000
011100 01  FILE-RECORD-INFORMATION-REC.
011200     05  FILE-RECORD-INFO-SKELETON.
011300         10  FILLER          PIC X(48) VALUE
011400              "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
011500         10  FILLER          PIC X(46) VALUE
011600                ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
011700         10  FILLER          PIC X(26) VALUE
011800                                    ",LFIL=000000,ORG=  ,LBLR= ".
011900         10  FILLER          PIC X(37) VALUE
012000                         ",RECKEY=                             ".
012100         10  FILLER          PIC X(38) VALUE
012200                        ",ALTKEY1=                             ".
012300         10  FILLER          PIC X(38) VALUE
012400                        ",ALTKEY2=                             ".
012500         10  FILLER          PIC X(7) VALUE SPACE.
012600     05  FILE-RECORD-INFO             OCCURS 10.
012700         10  FILE-RECORD-INFO-P1-120.
012800             15  FILLER      PIC X(5).
012900             15  XFILE-NAME  PIC X(6).
013000             15  FILLER      PIC X(8).
013100             15  XRECORD-NAME  PIC X(6).
013200             15  FILLER        PIC X(1).
013300             15  REELUNIT-NUMBER  PIC 9(1).
013400             15  FILLER           PIC X(7).
013500             15  XRECORD-NUMBER   PIC 9(6).
013600             15  FILLER           PIC X(6).
013700             15  UPDATE-NUMBER    PIC 9(2).
013800             15  FILLER           PIC X(5).
013900             15  ODO-NUMBER       PIC 9(4).
014000             15  FILLER           PIC X(5).
014100             15  XPROGRAM-NAME    PIC X(5).
014200             15  FILLER           PIC X(7).
014300             15  XRECORD-LENGTH   PIC 9(6).
014400             15  FILLER           PIC X(7).
014500             15  CHARS-OR-RECORDS  PIC X(2).
014600             15  FILLER            PIC X(1).
014700             15  XBLOCK-SIZE       PIC 9(4).
014800             15  FILLER            PIC X(6).
014900             15  RECORDS-IN-FILE   PIC 9(6).
015000             15  FILLER            PIC X(5).
015100             15  XFILE-ORGANIZATION  PIC X(2).
015200             15  FILLER              PIC X(6).
015300             15  XLABEL-TYPE         PIC X(1).
015400         10  FILE-RECORD-INFO-P121-240.
015500             15  FILLER              PIC X(8).
015600             15  XRECORD-KEY         PIC X(29).
015700             15  FILLER              PIC X(9).
015800             15  ALTERNATE-KEY1      PIC X(29).
015900             15  FILLER              PIC X(9).
016000             15  ALTERNATE-KEY2      PIC X(29).
016100             15  FILLER              PIC X(7).
016200
016300 01  TEST-RESULTS.
016400     05  FILLER              PIC X VALUE SPACE.
016500     05  FEATURE             PIC X(20) VALUE SPACE.
016600     05  FILLER              PIC X     VALUE SPACE.
016700     05  P-OR-F              PIC X(5)  VALUE SPACE.
016800     05  FILLER              PIC X     VALUE SPACE.
016900     05  PAR-NAME.
017000         10  FILLER          PIC X(12) VALUE SPACE.
017100         10  PARDOT-X        PIC X     VALUE SPACE.
017200         10  DOTVALUE        PIC 99    VALUE ZERO.
017300         10  FILLER          PIC X(5)  VALUE SPACE.
017400     05  FILLER              PIC X(10) VALUE SPACE.
017500     05  RE-MARK             PIC X(61).
017600
017700 01  TEST-COMPUTED.
017800     05  FILLER              PIC X(30) VALUE SPACE.
017900     05  FILLER              PIC X(17) VALUE "       COMPUTED=".
018000     05  COMPUTED-X.
018100         10  COMPUTED-A      PIC X(20) VALUE SPACE.
018200         10  COMPUTED-N REDEFINES COMPUTED-A  PIC -9(9).9(9).
018300         10  COMPUTED-0V18 REDEFINES COMPUTED-A  PIC -.9(18).
018400         10  COMPUTED-4V14 REDEFINES COMPUTED-A  PIC -9(4).9(14).
018500         10  COMPUTED-14V4 REDEFINES COMPUTED-A  PIC -9(14).9(4).
018600         10  CM-18V0 REDEFINES COMPUTED-A.
018700             15  COMPUTED-18V0                   PIC -9(18).
018800             15  FILLER                          PIC X.
018900         10  FILLER                              PIC X(50)
019000                                       VALUE SPACE.
019100
019200 01  TEST-CORRECT.
019300     05  FILLER              PIC X(30) VALUE SPACE.
019400     05  FILLER              PIC X(17) VALUE "       CORRECT =".
019500     05  CORRECT-X.
019600         10  CORRECT-A       PIC X(20) VALUE SPACE.
019700         10  CORRECT-N REDEFINES CORRECT-A  PIC -9(9).9(9).
019800         10  CORRECT-0V18 REDEFINES CORRECT-A  PIC -.9(18).
019900         10  CORRECT-4V14 REDEFINES CORRECT-A  PIC -9(4).9(14).
020000         10  CORRECT-14V4 REDEFINES CORRECT-A  PIC -9(14).9(4).
020100         10  CR-18V0 REDEFINES CORRECT-A.
020200             15  CORRECT-18V0                  PIC -9(18).
020300             15  FILLER                        PIC X.
020400         10  FILLER                            PIC X(50)
020500                                       VALUE SPACE.
020600
020700 01  CCVS-C-1.
020800     05  FILLER              PIC X(99) VALUE
020900     " FEATURE              PASS  PARAGRAPH-NAME
021000-    "                                REMARKS".
021100     05  FILLER              PIC X(20) VALUE SPACE.
021200
021300 01  CCVS-C-2.
021400     05  FILLER              PIC X VALUE SPACE.
021500     05  FILLER              PIC X(6) VALUE "TESTED".
021600     05  FILLER              PIC X(15) VALUE SPACE.
021700     05  FILLER              PIC X(4)  VALUE "FAIL".
021800     05  FILLER              PIC X(94) VALUE SPACE.
021900
022000 01  REC-SKL-SUB             PIC 9(2) VALUE ZERO.
022100 01  REC-CT                  PIC 99 VALUE ZERO.
022200 01  DELETE-CNT              PIC 999 VALUE ZERO.
022300 01  ERROR-COUNTER           PIC 999 VALUE ZERO.
022400 01  INSPECT-COUNTER         PIC 999 VALUE ZERO.
022500 01  PASS-COUNTER            PIC 999 VALUE ZERO.
022600 01  TOTAL-ERROR             PIC 999 VALUE ZERO.
022700 01  ERROR-HOLD              PIC 999 VALUE ZERO.
022800 01  DUMMY-HOLD              PIC X(120) VALUE SPACE.
022900 01  RECORD-COUNT            PIC 9(5) VALUE ZERO.
023000
023100 01  CCVS-H-1.
023200     05  FILLER              PIC X(27) VALUE SPACE.
023300     05  FILLER              PIC X(67) VALUE
023400     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
023500-    " SYSTEM".
023600     05  FILLER              PIC X(26) VALUE SPACE.
023700
023800 01  CCVS-H-2.
023900     05  FILLER              PIC X(52) VALUE
024000                       "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
024100     05  FILLER              PIC X(19) VALUE
024200                                           "TEST RESULTS SET-  ".
024300     05  TEST-ID             PIC X(9).
024400     05  FILLER              PIC X(40) VALUE SPACE.
024500
024600 01  CCVS-H-3.
024700     05  FILLER              PIC X(34) VALUE
024800                                    " FOR OFFICIAL USE ONLY    ".
024900     05  FILLER              PIC X(58) VALUE
025000     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
025100
025200     05  FILLER              PIC X(28) VALUE
025300                                           "  COPYRIGHT   1985 ".
025400
025500 01  CCVS-E-1.
025600     05  FILLER              PIC X(52) VALUE SPACE.
025700     05  FILLER              PIC X(14) VALUE "END OF TEST-  ".
025800     05  ID-AGAIN            PIC X(9).
025900     05  FILLER              PIC X(45) VALUE
026000                                   " NTIS DISTRIBUTION COBOL 85".
026100
026200 01  CCVS-E-2.
026300     05  FILLER              PIC X(31) VALUE SPACE.
026400     05  FILLER              PIC X(21) VALUE SPACE.
026500     05  CCVS-E-2-2.
026600         10  ERROR-TOTAL     PIC XXX   VALUE SPACE.
026700         10  FILLER          PIC X     VALUE SPACE.
026800         10  ENDER-DESC      PIC X(44) VALUE
026900                                            "ERRORS ENCOUNTERED".
027000
027100 01  CCVS-E-3.
027200     05  FILLER              PIC X(22) VALUE
027300                                        " FOR OFFICIAL USE ONLY".
027400     05  FILLER              PIC X(12) VALUE SPACE.
027500     05  FILLER              PIC X(58) VALUE
027600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
027700
027800     05  FILLER              PIC X(13) VALUE SPACE.
027900     05  FILLER              PIC X(15) VALUE " COPYRIGHT 1985".
028000
028100 01  CCVS-E-4.
028200     05  CCVS-E-4-1          PIC XXX VALUE SPACE.
028300     05  FILLER              PIC X(4) VALUE " OF ".
028400     05  CCVS-E-4-2          PIC XXX VALUE SPACE.
028500     05  FILLER              PIC X(40) VALUE
028600                            "  TESTS WERE EXECUTED SUCCESSFULLY".
028700
028800 01  XXINFO.
028900     05  FILLER              PIC X(30) VALUE
029000                                  "        *** INFORMATION  ***".
029100     05  INFO-TEXT.
029200         10  FILLER          PIC X(20) VALUE SPACE.
029300         10  XXCOMPUTED      PIC X(20).
029400         10  FILLER          PIC X(5)  VALUE SPACE.
029500         10  XXCORRECT       PIC X(20).
029600
029700 01  HYPHEN-LINE.
029800     05  FILLER              PIC X VALUE SPACE.
029900     05  FILLER              PIC X(65) VALUE
030000     "************************************************************
030100-    "*****".
030200     05  FILLER              PIC X(54) VALUE
030300        "******************************************************".
030400
030500 01  CCVS-PGM-ID             PIC X(6) VALUE "SQ126A".
030600
030700 PROCEDURE DIVISION.
030800
030900 CCVS1 SECTION.
031000 OPEN-FILES.
031100P    OPEN I-O RAW-DATA.
031200P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
031300P    READ RAW-DATA INVALID KEY GO TO END-E-1.
031400P    MOVE "ABORTED " TO C-ABORT.
031500P    ADD 1 TO C-NO-OF-TESTS.
031600P    ACCEPT C-DATE  FROM DATE.
031700P    ACCEPT C-TIME  FROM TIME.
031800P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
031900PEND-E-1.
032000P    CLOSE RAW-DATA.
032100     OPEN
032200        OUTPUT PRINT-FILE.
032300     MOVE CCVS-PGM-ID TO TEST-ID.
032400     MOVE CCVS-PGM-ID TO ID-AGAIN.
032500     MOVE SPACE TO TEST-RESULTS.
032600     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
032700     MOVE ZERO TO REC-SKL-SUB.
032800     PERFORM CCVS-INIT-FILE 9 TIMES.
032900 CCVS-INIT-FILE.
033000     ADD 1 TO REC-SKL-SUB.
033100     MOVE FILE-RECORD-INFO-SKELETON TO FILE-RECORD-INFO
033200          (REC-SKL-SUB).
033300 CCVS-INIT-EXIT.
033400     GO TO CCVS1-EXIT.
033500 CLOSE-FILES.
033600     PERFORM END-ROUTINE THRU END-ROUTINE-13.
033700     CLOSE PRINT-FILE.
033800P    OPEN I-O RAW-DATA.
033900P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
034000P    READ RAW-DATA INVALID KEY GO TO END-E-2.
034100P    MOVE "OK.     " TO C-ABORT.
034200P    MOVE PASS-COUNTER TO C-OK.
034300P    MOVE ERROR-HOLD   TO C-ALL.
034400P    MOVE ERROR-COUNTER TO C-FAIL.
034500P    MOVE DELETE-CNT TO C-DELETED.
034600P    MOVE INSPECT-COUNTER TO C-INSPECT.
034700P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
034800PEND-E-2.
034900P    CLOSE RAW-DATA.
035000 TERMINATE-CCVS.
035100S    EXIT PROGRAM.
035200STERMINATE-CALL.
035300     STOP RUN.
035400 INSPT.
035500     MOVE "INSPT" TO P-OR-F.
035600     ADD 1 TO INSPECT-COUNTER.
035700 PASS.
035800     MOVE "PASS " TO P-OR-F.
035900     ADD 1 TO PASS-COUNTER.
036000 FAIL.
036100     MOVE "FAIL*" TO P-OR-F.
036200     ADD 1 TO ERROR-COUNTER.
036300 DE-LETE.
036400     MOVE "*****" TO P-OR-F.
036500     ADD 1 TO DELETE-CNT.
036600     MOVE "****TEST DELETED****" TO RE-MARK.
036700 PRINT-DETAIL.
036800     IF REC-CT NOT EQUAL TO ZERO
036900         MOVE "." TO PARDOT-X
037000         MOVE REC-CT TO DOTVALUE.
037100     MOVE TEST-RESULTS TO PRINT-REC.
037200     PERFORM WRITE-LINE.
037300     IF P-OR-F EQUAL TO "FAIL*"
037400         PERFORM WRITE-LINE
037500         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
037600     ELSE
037700         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
037800     MOVE SPACE TO P-OR-F.
037900     MOVE SPACE TO COMPUTED-X.
038000     MOVE SPACE TO CORRECT-X.
038100     IF REC-CT EQUAL TO ZERO
038200         MOVE SPACE TO PAR-NAME.
038300     MOVE SPACE TO RE-MARK.
038400 HEAD-ROUTINE.
038500     MOVE CCVS-H-1 TO DUMMY-RECORD.
038600     PERFORM WRITE-LINE 2 TIMES.
038700     MOVE CCVS-H-2 TO DUMMY-RECORD.
038800     PERFORM WRITE-LINE 5 TIMES.
038900     MOVE CCVS-H-3 TO DUMMY-RECORD.
039000     PERFORM WRITE-LINE 3 TIMES.
039100 COLUMN-NAMES-ROUTINE.
039200     MOVE CCVS-C-1 TO DUMMY-RECORD.
039300     PERFORM WRITE-LINE.
039400     MOVE CCVS-C-2 TO DUMMY-RECORD.
039500     PERFORM WRITE-LINE 2 TIMES.
039600     MOVE HYPHEN-LINE TO DUMMY-RECORD.
039700     PERFORM WRITE-LINE.
039800 END-ROUTINE.
039900     MOVE HYPHEN-LINE TO DUMMY-RECORD.
040000     PERFORM WRITE-LINE 5 TIMES.
040100 END-RTN-EXIT.
040200     MOVE CCVS-E-1 TO DUMMY-RECORD.
040300     PERFORM WRITE-LINE 2 TIMES.
040400 END-ROUTINE-1.
040500     ADD ERROR-COUNTER TO ERROR-HOLD
040600     ADD INSPECT-COUNTER TO ERROR-HOLD.
040700     ADD DELETE-CNT TO ERROR-HOLD.
040800     ADD PASS-COUNTER TO ERROR-HOLD.
040900*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
041000     MOVE PASS-COUNTER TO CCVS-E-4-1.
041100     MOVE ERROR-HOLD TO CCVS-E-4-2.
041200     MOVE CCVS-E-4 TO CCVS-E-2-2.
041300     MOVE CCVS-E-2 TO DUMMY-RECORD
041400     PERFORM WRITE-LINE.
041500 END-ROUTINE-12.
041600     MOVE "TEST(S) FAILED" TO ENDER-DESC.
041700     IF ERROR-COUNTER IS EQUAL TO ZERO
041800         MOVE "NO " TO ERROR-TOTAL
041900     ELSE
042000         MOVE ERROR-COUNTER TO ERROR-TOTAL.
042100     MOVE CCVS-E-2 TO DUMMY-RECORD.
042200     PERFORM WRITE-LINE.
042300 END-ROUTINE-13.
042400     IF DELETE-CNT IS EQUAL TO ZERO
042500         MOVE "NO " TO ERROR-TOTAL
042600     ELSE
042700         MOVE DELETE-CNT TO ERROR-TOTAL.
042800     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
042900     MOVE CCVS-E-2 TO DUMMY-RECORD.
043000     PERFORM WRITE-LINE.
043100     IF INSPECT-COUNTER EQUAL TO ZERO
043200         MOVE "NO " TO ERROR-TOTAL
043300     ELSE
043400         MOVE INSPECT-COUNTER TO ERROR-TOTAL.
043500     MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
043600     MOVE CCVS-E-2 TO DUMMY-RECORD.
043700     PERFORM WRITE-LINE.
043800     MOVE CCVS-E-3 TO DUMMY-RECORD.
043900     PERFORM WRITE-LINE.
044000 WRITE-LINE.
044100     ADD 1 TO RECORD-COUNT.
044200Y    IF RECORD-COUNT GREATER 50
044300Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
044400Y        MOVE SPACE TO DUMMY-RECORD
044500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
044600Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
044700Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
044800Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
044900Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
045000Y        MOVE ZERO TO RECORD-COUNT.
045100     PERFORM WRT-LN.
045200 WRT-LN.
045300     WRITE DUMMY-RECORD AFTER ADVANCING 1 LINES.
045400     MOVE SPACE TO DUMMY-RECORD.
045500 BLANK-LINE-PRINT.
045600     PERFORM WRT-LN.
045700 FAIL-ROUTINE.
045800     IF COMPUTED-X NOT EQUAL TO SPACE
045900         GO TO FAIL-ROUTINE-WRITE.
046000     IF CORRECT-X NOT EQUAL TO SPACE
046100         GO TO FAIL-ROUTINE-WRITE.
046200     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
046300     MOVE XXINFO TO DUMMY-RECORD.
046400     PERFORM WRITE-LINE 2 TIMES.
046500     GO TO FAIL-ROUTINE-EX.
046600 FAIL-ROUTINE-WRITE.
046700     MOVE TEST-COMPUTED TO PRINT-REC
046800     PERFORM WRITE-LINE
046900     MOVE TEST-CORRECT TO PRINT-REC
047000     PERFORM WRITE-LINE 2 TIMES.
047100 FAIL-ROUTINE-EX.
047200     EXIT.
047300 BAIL-OUT.
047400     IF COMPUTED-A NOT EQUAL TO SPACE
047500         GO TO BAIL-OUT-WRITE.
047600     IF CORRECT-A EQUAL TO SPACE
047700         GO TO BAIL-OUT-EX.
047800 BAIL-OUT-WRITE.
047900     MOVE CORRECT-A TO XXCORRECT.
048000     MOVE COMPUTED-A TO XXCOMPUTED.
048100     MOVE XXINFO TO DUMMY-RECORD.
048200     PERFORM WRITE-LINE 2 TIMES.
048300 BAIL-OUT-EX.
048400     EXIT.
048500 CCVS1-EXIT.
048600     EXIT.
048700
048800 SECT-SQ126-0001 SECTION.
048900 SEQ-INIT-001.
049000     MOVE "SQ-FS1" TO XFILE-NAME (1).
049100     MOVE "R1-F-G" TO XRECORD-NAME (1).
049200     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
049300     MOVE 000120 TO XRECORD-LENGTH (1).
049400     MOVE "RC" TO CHARS-OR-RECORDS (1).
049500     MOVE 0001 TO XBLOCK-SIZE (1).
049600     MOVE 000750 TO RECORDS-IN-FILE (1).
049700     MOVE "SQ" TO XFILE-ORGANIZATION (1).
049800     MOVE "S" TO XLABEL-TYPE (1).
049900     MOVE 000001 TO XRECORD-NUMBER (1).
050000     OPEN
050100        OUTPUT SQ-FS1.
050200 SEQ-TEST-001.
050300     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-FS1R1-F-G-120.
050400     WRITE SQ-FS1R1-F-G-120.
050500     IF XRECORD-NUMBER (1) EQUAL TO 750
050600         GO TO SEQ-WRITE-001.
050700     ADD 1 TO XRECORD-NUMBER (1).
050800     GO TO SEQ-TEST-001.
050900 SEQ-WRITE-001.
051000     MOVE "CREATE FILE SQ-FS1" TO FEATURE.
051100     MOVE "SEQ-TEST-001" TO PAR-NAME.
051200     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
051300     MOVE XRECORD-NUMBER (1) TO CORRECT-18V0.
051400     PERFORM PRINT-DETAIL.
051500     CLOSE SQ-FS1.
051600*        A SEQUENTIAL TAPE FILE WITH 120 CHARACTER RECORDS
051700*    HAS BEEN CREATED. THE FILE CONTAINS 750 RECORDS.
051800 READ-INIT-GF-01.
051900     MOVE ZERO TO WRK-CS-09V00.
052000     MOVE ZERO TO SWITCH-READ1.
052100*        THIS TEST READS AND CHECKS THE FILE CREATED IN
052200*    READ-TEST-001 AND CHECKS THE NOT AT END CONDITION.
052300     OPEN
052400        INPUT SQ-FS1.
052500 READ-TEST-GF-01.
052600******************************************************************
052700*                                                                *
052800*    READ ... AT END  --- NOT AT END ...                         *
052900*                                                                *
053000******************************************************************
053100     READ SQ-FS1 AT END
053200         GO TO READ-TEST-GF-01-1
053300         NOT AT END
053400             MOVE 1 TO SWITCH-READ1.
053500     MOVE SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
053600     ADD 1 TO WRK-CS-09V00.
053700     IF WRK-CS-09V00 GREATER THAN 750
053800         MOVE "MORE THAN 750 RECORDS" TO RE-MARK
053900         GO TO READ-FAIL-GF-01.
054000     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
054100         ADD 1 TO RECORDS-IN-ERROR
054200         GO TO READ-TEST-GF-01.
054300     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS1"
054400         ADD 1 TO RECORDS-IN-ERROR
054500         GO TO READ-TEST-GF-01.
054600     IF XLABEL-TYPE (1) NOT EQUAL TO "S"
054700         ADD 1 TO RECORDS-IN-ERROR.
054800     GO TO READ-TEST-GF-01.
054900 READ-TEST-GF-01-1.
055000     IF RECORDS-IN-ERROR EQUAL TO ZERO
055100         GO TO READ-PASS-GF-01.
055200     MOVE "ERRORS IN READING SQ-FS1" TO RE-MARK.
055300 READ-FAIL-GF-01.
055400     MOVE "RECORDS IN ERROR =" TO COMPUTED-A.
055500     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
055600     PERFORM FAIL.
055700     GO TO READ-WRITE-GF-01.
055800 READ-PASS-GF-01.
055900     PERFORM PASS.
056000     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
056100     MOVE WRK-CS-09V00 TO CORRECT-18V0.
056200 READ-WRITE-GF-01.
056300     MOVE "READ-TEST-GF-01" TO PAR-NAME.
056400     MOVE "VERIFY FILE SQ-FS1" TO FEATURE.
056500     PERFORM PRINT-DETAIL.
056600 READ-TEST-GF-01-2.
056700     MOVE "READ...AT END...NOT AT END" TO RE-MARK.
056800     MOVE "NOT AT END" TO FEATURE.
056900     IF SWITCH-READ1 = 1
057000         GO TO READ-PASS-GF-01-2.
057100 READ-FAIL-GF-01-2.
057200     MOVE "VII-44 4.4.2, VII-46 4.4.4 (11) C  " TO RE-MARK.
057300     PERFORM FAIL.
057400     GO TO READ-WRITE-GF-01-2.
057500 READ-PASS-GF-01-2.
057600     PERFORM PASS.
057700 READ-WRITE-GF-01-2.
057800     MOVE "READ-TEST-GF-01-2" TO PAR-NAME.
057900     PERFORM PRINT-DETAIL.
058000 SEQ-CLOSE-GF-01.
058100     CLOSE SQ-FS1.
058200 READ-INIT-GF-02.
058300     MOVE ZERO TO SWITCH-READ1.
058400     MOVE ZERO TO WRK-CS-09V00.
058500     MOVE ZERO TO RECORDS-IN-ERROR.
058600     OPEN
058700        INPUT SQ-FS1.
058800     MOVE "NOT END             " TO FEATURE.
058900     MOVE "READ...RECORD AT END ... NOT END " TO RE-MARK.
059000     MOVE "READ-TEST-GF-02" TO PAR-NAME.
059100     MOVE ZERO TO ERROR-FLAG.
059200 READ-TEST-GF-02.
059300******************************************************************
059400*                                                                *
059500*   READ ... RECORD AT END ... NOT END                           *
059600*                                                                *
059700******************************************************************
059800     READ SQ-FS1 RECORD AT END
059900         MOVE "UNEXPECTED EOF" TO COMPUTED-A
060000         MOVE 1 TO EOF-FLAG
060100         GO TO READ-FAIL-GF-02
060200      NOT END
060300             MOVE 1 TO SWITCH-READ1.
060400     PERFORM RECORD-CHECK.
060500     IF WRK-CS-09V00 EQUAL TO 200
060600         GO TO READ-TEST-GF-02-1.
060700     GO TO READ-TEST-GF-02.
060800 RECORD-CHECK.
060900     MOVE SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
061000     ADD 1 TO WRK-CS-09V00.
061100     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
061200         ADD 1 TO RECORDS-IN-ERROR
061300         MOVE 1 TO ERROR-FLAG.
061400 READ-TEST-GF-02-1.
061500     IF SWITCH-READ1 = 1
061600         GO TO READ-PASS-GF-02.
061700     MOVE "NOT PASSED"               TO COMPUTED-A.
061800 READ-FAIL-GF-02.
061900     MOVE "VII-44 4.4.2, VII-46 4.4.4 (11) C  " TO RE-MARK.
062000     PERFORM FAIL.
062100     GO TO READ-WRITE-GF-02.
062200 READ-PASS-GF-02.
062300     PERFORM PASS.
062400 READ-WRITE-GF-02.
062500     PERFORM PRINT-DETAIL.
062600     PERFORM PRINT-DETAIL.
062700 READ-INIT-GF-03.
062800     MOVE ZERO TO ERROR-FLAG.
062900     MOVE ZERO TO SWITCH-READ1.
063000     MOVE 1 TO SWITCH-READ2.
063100     MOVE ZERO TO SWITCH-READ3.
063200     MOVE "IF...READ...AT END...NOT AT END..." TO RE-MARK.
063300     MOVE "READ-TEST-GF-03-1" TO PAR-NAME.
063400     MOVE "NOT AT END;END-READ" TO FEATURE.
063500 READ-TEST-GF-03.
063600******************************************************************
063700*                                                                *
063800*    IF ... READ ... AT END ... NOT AT END ... END-READ          *
063900*                                                                *
064000******************************************************************
064100     IF SWITCH-READ2 = 1
064200         READ SQ-FS1 AT END
064300             MOVE "UNEXPECTED EOF" TO COMPUTED-A
064400             MOVE 1 TO EOF-FLAG
064500             GO TO READ-FAIL-GF-03
064600             NOT AT END
064700                 MOVE 1 TO SWITCH-READ1
064800             END-READ
064900         MOVE 1 TO SWITCH-READ3.
065000     PERFORM RECORD-CHECK.
065100     IF WRK-CS-09V00 EQUAL TO 400
065200         GO TO READ-TEST-GF-03-1.
065300     GO TO READ-TEST-GF-03.
065400 READ-TEST-GF-03-1.
065500     IF SWITCH-READ1 = 1
065600         GO TO READ-PASS-GF-03.
065700 READ-FAIL-GF-03.
065800     MOVE "VII-44 4.4.2, VII-46 4.4.4 (11) C  " TO RE-MARK.
065900     PERFORM FAIL.
066000     GO TO READ-WRITE-GF-03.
066100 READ-PASS-GF-03.
066200     PERFORM PASS.
066300 READ-WRITE-GF-03.
066400     PERFORM PRINT-DETAIL.
066500 READ-TEST-GF-03-2.
066600     IF SWITCH-READ3 = 1
066700         GO TO READ-PASS-GF-03-2.
066800 READ-FAIL-GF-03-2.
066900     MOVE "VII-47 4.4.4 (14)  " TO RE-MARK.
067000     PERFORM FAIL.
067100     GO TO READ-WRITE-GF-03-2.
067200 READ-PASS-GF-03-2.
067300     PERFORM PASS.
067400 READ-WRITE-GF-03-2.
067500     MOVE "READ-TEST-GF-03-2" TO PAR-NAME.
067600     PERFORM PRINT-DETAIL.
067700 READ-INIT-GF-04.
067800     MOVE ZERO TO ERROR-FLAG.
067900     MOVE ZERO TO SWITCH-READ1.
068000     MOVE ZERO TO SWITCH-READ2.
068100     MOVE 1 TO SWITCH-READ3.
068200     MOVE "READ...RECORD END...NOT END;END-READ" TO RE-MARK.
068300     MOVE "READ-TEST-GF-04-1" TO PAR-NAME.
068400 READ-TEST-GF-04.
068500******************************************************************
068600*                                                                *
068700*   IF ... READ ... RECORD END ... NOT END ... END-READ ...      *
068800*                                                                *
068900******************************************************************
069000     IF SWITCH-READ3 = 1
069100         READ SQ-FS1 RECORD END
069200             MOVE "UNEXPECTED EOF" TO COMPUTED-A
069300             MOVE 1 TO EOF-FLAG
069400             GO TO READ-FAIL-GF-04-1
069500             NOT END
069600                 MOVE 1 TO SWITCH-READ1
069700             END-READ
069800         MOVE 1 TO SWITCH-READ2.
069900     PERFORM RECORD-CHECK.
070000     IF WRK-CS-09V00 EQUAL TO 600
070100         GO TO READ-TEST-GF-04-1.
070200     GO TO READ-TEST-GF-04.
070300 READ-TEST-GF-04-1.
070400     IF SWITCH-READ1 EQUAL TO 1
070500         GO TO READ-PASS-GF-04-1.
070600     MOVE "NOT PASSED"               TO COMPUTED-A.
070700 READ-FAIL-GF-04-1.
070800     MOVE "VII-44 4.4.2, VII-46 4.4.4 (11) C  " TO RE-MARK.
070900     PERFORM FAIL.
071000     GO TO READ-WRITE-GF-04-1.
071100 READ-PASS-GF-04-1.
071200     PERFORM PASS.
071300 READ-WRITE-GF-04-1.
071400     PERFORM PRINT-DETAIL.
071500 READ-TEST-GF-04-2.
071600     IF SWITCH-READ2 EQUAL TO 1
071700         GO TO READ-PASS-GF-04-2.
071800     MOVE "END-READ: NOT PASSED"      TO COMPUTED-A.
071900     MOVE "READ-TEST-GF-04-2" TO PAR-NAME.
072000 READ-FAIL-GF-04-2.
072100     MOVE "VII-47 4.4.4 (14)  " TO RE-MARK.
072200     PERFORM FAIL.
072300     GO TO READ-WRITE-GF-04-2.
072400 READ-PASS-GF-04-2.
072500     PERFORM PASS.
072600 READ-WRITE-GF-04-2.
072700     PERFORM PRINT-DETAIL.
072800 SEQ-CLOSE-003.
072900     CLOSE SQ-FS1.
073000 TERMINATE-ROUTINE.
073100     EXIT.
073200
073300 CCVS-EXIT SECTION.
073400 CCVS-999999.
073500     GO TO CLOSE-FILES.
