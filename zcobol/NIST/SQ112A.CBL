000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ112A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300
001400*        THE ROUTINE SQ112A CREATES A FILE WHICH HAS FIXED LENGTH
001500*    RECORDS.  THE FILE IS THEN CLOSED AND OPENED AS AN INPUT FILE
001600*    AND THE FILE IS READ AND FIELDS IN THE INPUT RECORDS ARE
001700*    COMPARED TO THE VALUES WRITTEN TO ENSURE THAT THE RECORDS
001800*    WERE PROCESSED CORRECTLY.  THE FILE IS CLOSED AND OPENED
001900*    AGAIN FOR OUTPUT.  THE DATA WRITTEN TO THE FILE PREVIOUSLY
002000*    SHOULD BE ELIMINATED.  ADDITIONAL  RECORDS ARE WRITTEN TO
002100*    THE FILE.  THE FILE IS CLOSED AND OPENED AS AN INPUT FILE.
002200*    THE CONTENT OF THE FILE IS VERIFIED TO ASCERTAIN THAT ONLY
002300*    DATA WRITTEN AFTER THE FILE HAD BEEN OPENED OUTPUT THE
002400*
002500*    SECOND TIME IS PRESENT.
002600*    THE OPEN, CLOSE, READ, AND WRITE STATEMENTS ARE TESTED FOR
002700*    LEVEL ONE FEATURES.
002800*
002900*    USED X-CARDS:
003000*         XXXXX001
003100*         XXXXX055
003200*     P   XXXXX062
003300*         XXXXX082
003400*         XXXXX083
003500*     C   XXXXX084
003600*
003700*
003800 ENVIRONMENT DIVISION.
003900 CONFIGURATION SECTION.
004000 SOURCE-COMPUTER.
004100     XXXXX082.
004200 OBJECT-COMPUTER.
004300     XXXXX083.
004400 INPUT-OUTPUT SECTION.
004500 FILE-CONTROL.
004600P    SELECT RAW-DATA   ASSIGN TO
004700P    XXXXX062
004800P           ORGANIZATION IS INDEXED
004900P           ACCESS MODE IS RANDOM
005000P           RECORD KEY IS RAW-DATA-KEY.
005100     SELECT PRINT-FILE ASSIGN TO
005200     XXXXX055.
005300     SELECT SQ-FS1 ASSIGN TO
005400     XXXXX001
005500     ORGANIZATION IS SEQUENTIAL
005600     ACCESS MODE IS SEQUENTIAL.
005700 DATA DIVISION.
005800 FILE SECTION.
005900P
006000PFD  RAW-DATA.
006100P
006200P01  RAW-DATA-SATZ.
006300P    05  RAW-DATA-KEY        PIC X(6).
006400P    05  C-DATE              PIC 9(6).
006500P    05  C-TIME              PIC 9(8).
006600P    05  C-NO-OF-TESTS       PIC 99.
006700P    05  C-OK                PIC 999.
006800P    05  C-ALL               PIC 999.
006900P    05  C-FAIL              PIC 999.
007000P    05  C-DELETED           PIC 999.
007100P    05  C-INSPECT           PIC 999.
007200P    05  C-NOTE              PIC X(13).
007300P    05  C-INDENT            PIC X.
007400P    05  C-ABORT             PIC X(8).
007500 FD  PRINT-FILE
007600C    LABEL RECORDS
007700C    XXXXX084
007800C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007900               .
008000 01  PRINT-REC PICTURE X(120).
008100 01  DUMMY-RECORD PICTURE X(120).
008200 FD  SQ-FS1
008300C    LABEL RECORD STANDARD
008400                   .
008500 01  SQ-FS1R1-F-G-120.
008600     02  FILLER PIC X(120).
008700 WORKING-STORAGE SECTION.
008800 01  WRK-CS-09V00 PIC S9(9) USAGE COMP VALUE ZERO.
008900 01  RECORDS-IN-ERROR PIC S9(5) USAGE COMP VALUE ZERO.
009000 01  ERROR-FLAG PIC 9 VALUE ZERO.
009100 01  EOF-FLAG   PICTURE 9 VALUE ZERO.
009200 01  FILE-RECORD-INFORMATION-REC.
009300     03 FILE-RECORD-INFO-SKELETON.
009400        05 FILLER                 PICTURE X(48)       VALUE
009500             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
009600        05 FILLER                 PICTURE X(46)       VALUE
009700             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
009800        05 FILLER                 PICTURE X(26)       VALUE
009900             ",LFIL=000000,ORG=  ,LBLR= ".
010000        05 FILLER                 PICTURE X(37)       VALUE
010100             ",RECKEY=                             ".
010200        05 FILLER                 PICTURE X(38)       VALUE
010300             ",ALTKEY1=                             ".
010400        05 FILLER                 PICTURE X(38)       VALUE
010500             ",ALTKEY2=                             ".
010600        05 FILLER                 PICTURE X(7)        VALUE SPACE.
010700     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
010800        05 FILE-RECORD-INFO-P1-120.
010900           07 FILLER              PIC X(5).
011000           07 XFILE-NAME           PIC X(6).
011100           07 FILLER              PIC X(8).
011200           07 XRECORD-NAME         PIC X(6).
011300           07 FILLER              PIC X(1).
011400           07 REELUNIT-NUMBER     PIC 9(1).
011500           07 FILLER              PIC X(7).
011600           07 XRECORD-NUMBER       PIC 9(6).
011700           07 FILLER              PIC X(6).
011800           07 UPDATE-NUMBER       PIC 9(2).
011900           07 FILLER              PIC X(5).
012000           07 ODO-NUMBER          PIC 9(4).
012100           07 FILLER              PIC X(5).
012200           07 XPROGRAM-NAME        PIC X(5).
012300           07 FILLER              PIC X(7).
012400           07 XRECORD-LENGTH       PIC 9(6).
012500           07 FILLER              PIC X(7).
012600           07 CHARS-OR-RECORDS    PIC X(2).
012700           07 FILLER              PIC X(1).
012800           07 XBLOCK-SIZE          PIC 9(4).
012900           07 FILLER              PIC X(6).
013000           07 RECORDS-IN-FILE     PIC 9(6).
013100           07 FILLER              PIC X(5).
013200           07 XFILE-ORGANIZATION   PIC X(2).
013300           07 FILLER              PIC X(6).
013400           07 XLABEL-TYPE          PIC X(1).
013500        05 FILE-RECORD-INFO-P121-240.
013600           07 FILLER              PIC X(8).
013700           07 XRECORD-KEY          PIC X(29).
013800           07 FILLER              PIC X(9).
013900           07 ALTERNATE-KEY1      PIC X(29).
014000           07 FILLER              PIC X(9).
014100           07 ALTERNATE-KEY2      PIC X(29).
014200           07 FILLER              PIC X(7).
014300 01  TEST-RESULTS.
014400     02 FILLER                    PICTURE X VALUE SPACE.
014500     02 FEATURE                   PICTURE X(20) VALUE SPACE.
014600     02 FILLER                    PICTURE X VALUE SPACE.
014700     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
014800     02 FILLER                    PICTURE X  VALUE SPACE.
014900     02  PAR-NAME.
015000       03 FILLER PICTURE X(12) VALUE SPACE.
015100       03  PARDOT-X PICTURE X  VALUE SPACE.
015200       03 DOTVALUE PICTURE 99  VALUE ZERO.
015300       03 FILLER PIC X(5) VALUE SPACE.
015400     02 FILLER PIC X(10) VALUE SPACE.
015500     02 RE-MARK PIC X(61).
015600 01  TEST-COMPUTED.
015700     02 FILLER PIC X(30) VALUE SPACE.
015800     02 FILLER PIC X(17) VALUE "       COMPUTED=".
015900     02 COMPUTED-X.
016000     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
016100     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
016200     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
016300     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
016400     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
016500     03       CM-18V0 REDEFINES COMPUTED-A.
016600         04 COMPUTED-18V0                   PICTURE -9(18).
016700         04 FILLER                          PICTURE X.
016800     03 FILLER PIC X(50) VALUE SPACE.
016900 01  TEST-CORRECT.
017000     02 FILLER PIC X(30) VALUE SPACE.
017100     02 FILLER PIC X(17) VALUE "       CORRECT =".
017200     02 CORRECT-X.
017300     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
017400     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
017500     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
017600     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
017700     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
017800     03      CR-18V0 REDEFINES CORRECT-A.
017900         04 CORRECT-18V0                    PICTURE -9(18).
018000         04 FILLER                          PICTURE X.
018100     03 FILLER PIC X(50) VALUE SPACE.
018200 01  CCVS-C-1.
018300     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
018400-    "SS  PARAGRAPH-NAME
018500-    "        REMARKS".
018600     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
018700 01  CCVS-C-2.
018800     02 FILLER PICTURE IS X VALUE IS SPACE.
018900     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
019000     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
019100     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
019200     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
019300 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
019400 01  REC-CT PICTURE 99 VALUE ZERO.
019500 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
019600 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
019700 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
019800 01  PASS-COUNTER PIC 999 VALUE ZERO.
019900 01  TOTAL-ERROR PIC 999 VALUE ZERO.
020000 01  ERROR-HOLD PIC 999 VALUE ZERO.
020100 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
020200 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
020300 01  CCVS-H-1.
020400     02  FILLER   PICTURE X(27)  VALUE SPACE.
020500     02 FILLER PICTURE X(67) VALUE
020600     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
020700-    " SYSTEM".
020800     02  FILLER     PICTURE X(26)  VALUE SPACE.
020900 01  CCVS-H-2.
021000     02 FILLER PICTURE X(52) VALUE IS
021100     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
021200     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
021300     02 TEST-ID PICTURE IS X(9).
021400     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
021500 01  CCVS-H-3.
021600     02  FILLER PICTURE X(34) VALUE
021700     " FOR OFFICIAL USE ONLY    ".
021800     02  FILLER PICTURE X(58) VALUE
021900     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022000     02  FILLER PICTURE X(28) VALUE
022100     "  COPYRIGHT   1985 ".
022200 01  CCVS-E-1.
022300     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
022400     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
022500     02 ID-AGAIN PICTURE IS X(9).
022600     02 FILLER PICTURE X(45) VALUE IS
022700     " NTIS DISTRIBUTION COBOL 85".
022800 01  CCVS-E-2.
022900     02  FILLER                   PICTURE X(31)  VALUE
023000     SPACE.
023100     02  FILLER                   PICTURE X(21)  VALUE SPACE.
023200     02 CCVS-E-2-2.
023300         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
023400         03 FILLER PICTURE IS X VALUE IS SPACE.
023500         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
023600 01  CCVS-E-3.
023700     02  FILLER PICTURE X(22) VALUE
023800     " FOR OFFICIAL USE ONLY".
023900     02  FILLER PICTURE X(12) VALUE SPACE.
024000     02  FILLER PICTURE X(58) VALUE
024100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024200     02  FILLER PICTURE X(13) VALUE SPACE.
024300     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
024400 01  CCVS-E-4.
024500     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
024600     02 FILLER PIC XXXX VALUE " OF ".
024700     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
024800     02 FILLER PIC X(40) VALUE
024900      "  TESTS WERE EXECUTED SUCCESSFULLY".
025000 01  XXINFO.
025100     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
025200     02 INFO-TEXT.
025300     04 FILLER PIC X(20) VALUE SPACE.
025400     04 XXCOMPUTED PIC X(20).
025500     04 FILLER PIC X(5) VALUE SPACE.
025600     04 XXCORRECT PIC X(20).
025700 01  HYPHEN-LINE.
025800     02 FILLER PICTURE IS X VALUE IS SPACE.
025900     02 FILLER PICTURE IS X(65) VALUE IS "************************
026000-    "*****************************************".
026100     02 FILLER PICTURE IS X(54) VALUE IS "************************
026200-    "******************************".
026300 01  CCVS-PGM-ID PIC X(6) VALUE
026400     "SQ112A".
026500 PROCEDURE DIVISION.
026600 CCVS1 SECTION.
026700 OPEN-FILES.
026800P    OPEN I-O RAW-DATA.
026900P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
027000P    READ RAW-DATA INVALID KEY GO TO END-E-1.
027100P    MOVE "ABORTED " TO C-ABORT.
027200P    ADD 1 TO C-NO-OF-TESTS.
027300P    ACCEPT C-DATE  FROM DATE.
027400P    ACCEPT C-TIME  FROM TIME.
027500P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
027600PEND-E-1.
027700P    CLOSE RAW-DATA.
027800     OPEN     OUTPUT PRINT-FILE.
027900     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
028000     MOVE    SPACE TO TEST-RESULTS.
028100     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
028200     MOVE ZERO TO REC-SKL-SUB.
028300     PERFORM CCVS-INIT-FILE 9 TIMES.
028400 CCVS-INIT-FILE.
028500     ADD 1 TO REC-SKL-SUB.
028600     MOVE FILE-RECORD-INFO-SKELETON TO
028700                  FILE-RECORD-INFO (REC-SKL-SUB).
028800 CCVS-INIT-EXIT.
028900     GO TO CCVS1-EXIT.
029000 CLOSE-FILES.
029100     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
029200P    OPEN I-O RAW-DATA.
029300P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
029400P    READ RAW-DATA INVALID KEY GO TO END-E-2.
029500P    MOVE "OK.     " TO C-ABORT.
029600P    MOVE PASS-COUNTER TO C-OK.
029700P    MOVE ERROR-HOLD   TO C-ALL.
029800P    MOVE ERROR-COUNTER TO C-FAIL.
029900P    MOVE DELETE-CNT TO C-DELETED.
030000P    MOVE INSPECT-COUNTER TO C-INSPECT.
030100P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
030200PEND-E-2.
030300P    CLOSE RAW-DATA.
030400 TERMINATE-CCVS.
030500S    EXIT PROGRAM.
030600STERMINATE-CALL.
030700     STOP     RUN.
030800 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
030900 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
031000 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
031100 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
031200     MOVE "****TEST DELETED****" TO RE-MARK.
031300 PRINT-DETAIL.
031400     IF REC-CT NOT EQUAL TO ZERO
031500             MOVE "." TO PARDOT-X
031600             MOVE REC-CT TO DOTVALUE.
031700     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
031800     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
031900        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
032000          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
032100     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
032200     MOVE SPACE TO CORRECT-X.
032300     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
032400     MOVE     SPACE TO RE-MARK.
032500 HEAD-ROUTINE.
032600     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032700     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
032800     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
032900 COLUMN-NAMES-ROUTINE.
033000     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033100     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
033300 END-ROUTINE.
033400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033500 END-RTN-EXIT.
033600     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033700 END-ROUTINE-1.
033800      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
033900      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
034000      ADD PASS-COUNTER TO ERROR-HOLD.
034100*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
034200      MOVE PASS-COUNTER TO CCVS-E-4-1.
034300      MOVE ERROR-HOLD TO CCVS-E-4-2.
034400      MOVE CCVS-E-4 TO CCVS-E-2-2.
034500      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
034600  END-ROUTINE-12.
034700      MOVE "TEST(S) FAILED" TO ENDER-DESC.
034800     IF       ERROR-COUNTER IS EQUAL TO ZERO
034900         MOVE "NO " TO ERROR-TOTAL
035000         ELSE
035100         MOVE ERROR-COUNTER TO ERROR-TOTAL.
035200     MOVE     CCVS-E-2 TO DUMMY-RECORD.
035300     PERFORM WRITE-LINE.
035400 END-ROUTINE-13.
035500     IF DELETE-CNT IS EQUAL TO ZERO
035600         MOVE "NO " TO ERROR-TOTAL  ELSE
035700         MOVE DELETE-CNT TO ERROR-TOTAL.
035800     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
035900     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036000      IF   INSPECT-COUNTER EQUAL TO ZERO
036100          MOVE "NO " TO ERROR-TOTAL
036200      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
036300      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
036400      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036500     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036600 WRITE-LINE.
036700     ADD 1 TO RECORD-COUNT.
036800Y    IF RECORD-COUNT GREATER 50
036900Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
037000Y        MOVE SPACE TO DUMMY-RECORD
037100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
037200Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
037300Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
037400Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
037500Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
037600Y        MOVE ZERO TO RECORD-COUNT.
037700     PERFORM WRT-LN.
037800 WRT-LN.
037900     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
038000     MOVE SPACE TO DUMMY-RECORD.
038100 BLANK-LINE-PRINT.
038200     PERFORM WRT-LN.
038300 FAIL-ROUTINE.
038400     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
038500     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
038600     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
038700     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038800     GO TO FAIL-ROUTINE-EX.
038900 FAIL-ROUTINE-WRITE.
039000     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
039100     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
039200 FAIL-ROUTINE-EX. EXIT.
039300 BAIL-OUT.
039400     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
039500     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
039600 BAIL-OUT-WRITE.
039700     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
039800     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039900 BAIL-OUT-EX. EXIT.
040000 CCVS1-EXIT.
040100     EXIT.
040200 SECT-SQ112A-0001 SECTION.
040300 WRITE-INIT-GF-01.
040400     MOVE "SQ112X" TO XFILE-NAME (1).
040500     MOVE "OUTPUT" TO XRECORD-NAME (1).
040600     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
040700     MOVE 000120 TO XRECORD-LENGTH (1).
040800     MOVE "RC"   TO CHARS-OR-RECORDS (1).
040900     MOVE 0001   TO XBLOCK-SIZE (1).
041000     MOVE 000150 TO RECORDS-IN-FILE (1).
041100     MOVE "SQ"   TO XFILE-ORGANIZATION (1).
041200     MOVE "S" TO XLABEL-TYPE (1).
041300     MOVE 000001 TO XRECORD-NUMBER (1).
041400     OPEN OUTPUT SQ-FS1.
041500 WRITE-TEST-GF-01.
041600     MOVE FILE-RECORD-INFO-P1-120 (1)  TO SQ-FS1R1-F-G-120.
041700     WRITE SQ-FS1R1-F-G-120.
041800     IF XRECORD-NUMBER (1) EQUAL TO 150
041900         GO TO WRITE-WRITE-GF-01.
042000     ADD 1 TO XRECORD-NUMBER (1).
042100     GO TO WRITE-TEST-GF-01.
042200 WRITE-WRITE-GF-01.
042300     MOVE "WRITE 150 RECORDS " TO FEATURE.
042400     MOVE "WRITE-TEST-GF-01" TO PAR-NAME.
042500     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
042600     MOVE  XRECORD-NUMBER (1) TO CORRECT-18V0.
042700     PERFORM PRINT-DETAIL.
042800     CLOSE SQ-FS1.
042900*        A SEQUENTIAL TAPE FILE WITH 120 CHARACTER RECORDS
043000*    HAS BEEN CREATED. THE FILE CONTAINS 150 RECORDS.
043100 READ-INIT-GF-01.
043200     MOVE ZERO TO WRK-CS-09V00.
043300*        THIS TEST READS AND CHECKS THE FILE CREATED IN
043400*    READ-TEST-001.
043500     OPEN INPUT SQ-FS1.
043600 READ-TEST-GF-01.
043700     READ SQ-FS1
043800          AT END GO TO READ-TEST-GF-01-1.
043900     MOVE   SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
044000     ADD 1 TO WRK-CS-09V00.
044100     IF WRK-CS-09V00 GREATER THAN 150
044200        MOVE "MORE THAN 150 RECORDS" TO RE-MARK
044300        GO TO READ-FAIL-GF-01.
044400     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
044500         ADD 1 TO RECORDS-IN-ERROR
044600         GO TO READ-TEST-GF-01.
044700     IF XFILE-NAME (1) NOT EQUAL TO "SQ112X"
044800        ADD 1 TO RECORDS-IN-ERROR
044900        GO TO READ-TEST-GF-01.
045000     IF XLABEL-TYPE (1) NOT EQUAL TO "S"
045100        ADD 1 TO RECORDS-IN-ERROR.
045200     GO TO READ-TEST-GF-01.
045300 READ-TEST-GF-01-1.
045400     IF RECORDS-IN-ERROR EQUAL TO ZERO
045500         GO TO READ-PASS-GF-01.
045600     MOVE "ERRORS IN READING SQ-FS1" TO RE-MARK.
045700 READ-FAIL-GF-01.
045800     MOVE "RECORDS IN ERROR =" TO COMPUTED-A.
045900     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
046000     PERFORM FAIL.
046100     GO TO READ-READ-GF-01.
046200 READ-PASS-GF-01.
046300     PERFORM PASS.
046400     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
046500     MOVE WRK-CS-09V00 TO CORRECT-18V0.
046600 READ-READ-GF-01.
046700     MOVE "READ-TEST-GF-01"  TO PAR-NAME.
046800     MOVE "VERIFY FILE SQ-FS1" TO FEATURE.
046900     PERFORM PRINT-DETAIL.
047000 READ-CLOSE-GF-01.
047100     CLOSE SQ-FS1.
047200 SECT-SQ112A-0002 SECTION.
047300 WRITE-INIT-GF-02.
047400     MOVE "SQ-FS1" TO XFILE-NAME (1).
047500     MOVE "R1-F-G" TO XRECORD-NAME (1).
047600     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
047700     MOVE 000120 TO XRECORD-LENGTH (1).
047800     MOVE "RC"   TO CHARS-OR-RECORDS (1).
047900     MOVE 0001   TO XBLOCK-SIZE (1).
048000     MOVE 000150 TO RECORDS-IN-FILE (1).
048100     MOVE "SQ"   TO XFILE-ORGANIZATION (1).
048200     MOVE "S" TO XLABEL-TYPE (1).
048300     MOVE 000001 TO XRECORD-NUMBER (1).
048400     OPEN OUTPUT SQ-FS1.
048500 WRITE-TEST-GF-02.
048600     MOVE FILE-RECORD-INFO-P1-120 (1)  TO SQ-FS1R1-F-G-120.
048700     WRITE SQ-FS1R1-F-G-120.
048800     IF XRECORD-NUMBER (1) EQUAL TO 150
048900         GO TO WRITE-WRITE-GF-02.
049000     ADD 1 TO XRECORD-NUMBER (1).
049100     GO TO WRITE-TEST-GF-02.
049200 WRITE-WRITE-GF-02.
049300     MOVE "WRITE 150 RECS 2ND" TO FEATURE.
049400     MOVE "WRITE-TEST-GF-02" TO PAR-NAME.
049500     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
049600     MOVE  XRECORD-NUMBER (1) TO CORRECT-18V0.
049700     PERFORM PRINT-DETAIL.
049800     CLOSE SQ-FS1.
049900*        A SEQUENTIAL TAPE FILE WITH 120 CHARACTER RECORDS
050000*    HAS BEEN CREATED. THE FILE CONTAINS 150 RECORDS.
050100 READ-INIT-GF-02.
050200     MOVE ZERO TO WRK-CS-09V00.
050300*        THIS TEST READS AND CHECKS THE FILE CREATED IN
050400*    READ-TEST-001.
050500     OPEN INPUT SQ-FS1.
050600 READ-TEST-GF-02.
050700     READ SQ-FS1
050800          AT END GO TO READ-TEST-GF-02-1.
050900     MOVE   SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
051000     ADD 1 TO WRK-CS-09V00.
051100*    IF WRK-CS-09V00 GREATER THAN 150
051200*       MOVE "MORE THAN 150 RECORDS" TO RE-MARK
051300*       GO TO READ-FAIL-GF-02.
051400     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
051500         ADD 1 TO RECORDS-IN-ERROR
051600         GO TO READ-TEST-GF-02.
051700     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS1"
051800        ADD 1 TO RECORDS-IN-ERROR
051900        GO TO READ-TEST-GF-02.
052000     IF XLABEL-TYPE (1) NOT EQUAL TO "S"
052100        ADD 1 TO RECORDS-IN-ERROR.
052200     GO TO READ-TEST-GF-02.
052300 READ-TEST-GF-02-1.
052400     IF RECORDS-IN-ERROR EQUAL TO ZERO
052500         GO TO READ-PASS-GF-02.
052600     MOVE "ERRORS IN READING SQ-FS1" TO RE-MARK.
052700 READ-FAIL-GF-02.
052800     MOVE "RECORDS IN ERROR =" TO COMPUTED-A.
052900     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
053000     MOVE "VII-43;4.3.4 (21)                        " TO  RE-MARK.
053100     PERFORM FAIL.
053200     GO TO READ-WRITE-GF-02.
053300 READ-PASS-GF-02.
053400     PERFORM PASS.
053500     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
053600     MOVE WRK-CS-09V00 TO CORRECT-18V0.
053700 READ-WRITE-GF-02.
053800     MOVE "READ-TEST-GF-02" TO PAR-NAME.
053900     MOVE "VERIFY FILE SQ-FS1" TO FEATURE.
054000     PERFORM PRINT-DETAIL.
054100 READ-CLOSE-GF-02.
054200     CLOSE SQ-FS1.
054300 SECT-SQ112A-0003 SECTION.
054400 READ-INIT-GF-03.
054500     MOVE ZERO TO WRK-CS-09V00.
054600     MOVE ZERO TO RECORDS-IN-ERROR.
054700     OPEN INPUT   SQ-FS1.
054800*            FOUR OPTIONS FOR THE READ STATEMENT ARE CHECKED
054900*    IN THIS SERIES OF TESTS.
055000     MOVE "READ...RECORD AT END ..." TO FEATURE.
055100     MOVE "READ-TEST-GF-03" TO PAR-NAME.
055200     MOVE ZERO TO ERROR-FLAG.
055300 READ-TEST-GF-03.
055400     READ SQ-FS1 RECORD AT END
055500              MOVE "UNEXPECTED EOF" TO COMPUTED-A
055600              MOVE 1 TO EOF-FLAG
055700              GO TO READ-FAIL-GF-03.
055800     PERFORM RECORD-CHECK.
055900     IF WRK-CS-09V00 EQUAL TO 40
056000              GO TO READ-TEST-GF-03-1.
056100             GO TO READ-TEST-GF-03.
056200 RECORD-CHECK.
056300     MOVE SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
056400     ADD 1 TO WRK-CS-09V00.
056500     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
056600         ADD 1 TO RECORDS-IN-ERROR
056700         MOVE 1 TO ERROR-FLAG.
056800 READ-TEST-GF-03-1.
056900     IF ERROR-FLAG EQUAL TO ZERO
057000         GO TO READ-PASS-GF-03.
057100     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
057200 READ-FAIL-GF-03.
057300     MOVE "VII-44; 4.4.2                            " TO  RE-MARK.
057400     PERFORM FAIL.
057500     GO TO READ-WRITE-GF-03.
057600 READ-PASS-GF-03.
057700     PERFORM PASS.
057800 READ-WRITE-GF-03.
057900     PERFORM PRINT-DETAIL.
058000 READ-INIT-GF-04.
058100     IF EOF-FLAG EQUAL TO 1
058200        GO TO SEQ-EOF-005.
058300     MOVE ZERO TO ERROR-FLAG.
058400     MOVE "READ...AT END..." TO FEATURE.
058500     MOVE "READ-TEST-GF-04" TO PAR-NAME.
058600 READ-TEST-GF-04.
058700     READ SQ-FS1 AT END
058800         MOVE "UNEXPECTED EOF" TO COMPUTED-A
058900         MOVE 1 TO EOF-FLAG
059000         GO TO READ-FAIL-GF-04.
059100     PERFORM RECORD-CHECK.
059200     IF WRK-CS-09V00 EQUAL TO 80
059300         GO TO READ-TEST-GF-04-1.
059400     GO TO READ-TEST-GF-04.
059500 READ-TEST-GF-04-1.
059600     IF ERROR-FLAG EQUAL TO ZERO
059700         GO TO READ-PASS-GF-04.
059800     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
059900 READ-FAIL-GF-04.
060000     MOVE "VII-44; 4.4.2                            " TO  RE-MARK.
060100     PERFORM FAIL.
060200     GO TO READ-WRITE-GF-04.
060300 READ-PASS-GF-04.
060400     PERFORM PASS.
060500 READ-WRITE-GF-04.
060600     PERFORM PRINT-DETAIL.
060700 READ-INIT-GF-05.
060800     IF EOF-FLAG EQUAL TO 1
060900        GO TO SEQ-EOF-005.
061000     MOVE ZERO TO ERROR-FLAG.
061100     MOVE "READ...RECORD END..." TO FEATURE.
061200     MOVE "READ-TEST-GF-05" TO PAR-NAME.
061300 READ-TEST-GF-05.
061400     READ SQ-FS1 RECORD END
061500          MOVE "UNEXPECTED EOF" TO COMPUTED-A
061600          MOVE 1 TO EOF-FLAG
061700          GO TO READ-FAIL-GF-05.
061800     PERFORM RECORD-CHECK.
061900     IF WRK-CS-09V00 EQUAL TO 120
062000         GO TO READ-TEST-GF-05-1.
062100     GO TO READ-TEST-GF-05.
062200 READ-TEST-GF-05-1.
062300     IF ERROR-FLAG EQUAL TO ZERO
062400         GO TO READ-PASS-GF-05.
062500     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
062600 READ-FAIL-GF-05.
062700     MOVE "VII-44; 4.4.2                            " TO  RE-MARK.
062800     PERFORM FAIL.
062900     GO TO READ-WRITE-GF-05.
063000 READ-PASS-GF-05.
063100     PERFORM PASS.
063200 READ-WRITE-GF-05.
063300     PERFORM PRINT-DETAIL.
063400 READ-INIT-GF-06.
063500     IF EOF-FLAG EQUAL TO 1
063600         GO TO SEQ-EOF-005.
063700     MOVE ZERO TO ERROR-FLAG.
063800     MOVE "READ...END..." TO FEATURE.
063900     MOVE  "READ-TEST-GF-06" TO PAR-NAME.
064000 READ-TEST-GF-06.
064100     READ SQ-FS1 END GO TO READ-TEST-GF-06-1.
064200     PERFORM RECORD-CHECK.
064300     IF WRK-CS-09V00 GREATER THAN 150
064400          GO TO READ-TEST-GF-06-1.
064500     GO TO READ-TEST-GF-06.
064600 READ-TEST-GF-06-1.
064700     IF ERROR-FLAG EQUAL TO ZERO
064800          GO TO READ-PASS-GF-06.
064900 READ-FAIL-GF-06.
065000     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
065100     MOVE "VII-44; 4.4.2                            " TO  RE-MARK.
065200     PERFORM FAIL.
065300     GO TO READ-WRITE-GF-06.
065400 READ-PASS-GF-06.
065500     PERFORM PASS.
065600 READ-WRITE-GF-06.
065700     PERFORM PRINT-DETAIL.
065800 SEQ-TEST-005.
065900     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
066000          MOVE "RECORDS IN ERROR =" TO COMPUTED-A
066100          MOVE RECORDS-IN-ERROR TO CORRECT-18V0
066200          GO TO SEQ-FAIL-005.
066300     IF WRK-CS-09V00 GREATER THAN 150
066400          MOVE "MORE THAN 150 RECORDS" TO RE-MARK
066500          GO TO SEQ-FAIL-005.
066600 SEQ-PASS-005.
066700     PERFORM PASS.
066800     GO TO SEQ-WRITE-005.
066900 SEQ-EOF-005.
067000     MOVE "LESS THAN 150 RECORDS" TO RE-MARK.
067100     MOVE "RECORDS READ =" TO COMPUTED-A.
067200     MOVE WRK-CS-09V00 TO CORRECT-18V0.
067300 SEQ-FAIL-005.
067400     MOVE "VII-43;4.3.4 (21)                        " TO  RE-MARK.
067500     PERFORM FAIL.
067600 SEQ-WRITE-005.
067700     MOVE "SEQ-TEST-005" TO PAR-NAME.
067800     MOVE "READ FILE SQ-FS1" TO FEATURE.
067900     PERFORM PRINT-DETAIL.
068000 SEQ-CLOSE-005.
068100     CLOSE SQ-FS1.
068200 TERMINATE-ROUTINE.
068300     EXIT.
068400 CCVS-EXIT SECTION.
068500 CCVS-999999.
068600     GO TO CLOSE-FILES.
