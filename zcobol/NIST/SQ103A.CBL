000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ103A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
000900*                             REVISED 1986, AUGUST             *
001000*                                                              *
001100*    CREATION DATE     /     VALIDATION DATE                   *
001200*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001300*                                                              *
001400****************************************************************
001500*                                                              *
001600*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001700*                                                              *
001800*            X-01   SEQUENTIAL MAGNETIC TAPE FILE
001900*            X-55   SYSTEM PRINTER                             *
002000*            X-82   SOURCE-COMPUTER                            *
002100*            X-83   OBJECT-COMPUTER.                           *
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    THIS PROGRAM CREATES A TAPE FILE OF 500 FIXED LENGTH      *
002600*    RECORDS, EACH 120 CHARACTERS LONG.  THE FILE IS CLOSED    *
002700*    AND OPENED AGAIN AS AN INPUT FILE.  THE FILE IS READ      *
002800*    USING A READ STATEMENT WITH THE AT END PHRASE.  RECORDS   *
002900*    ARE COUNTED AND COMPARED WITH THE VALUES WRITTEN TO       *
003000*    ENSURE THAT THEY WERE PROCESSED CORRECTLY.  THERE IS A    *
003100*    DECLARATIVE PROCEDURE FOR THE FILE AND TESTS ARE MADE     *
003200*    DURING THIS PASS TO CHECK THAT IT IS NOT ENTERED AFTER    *
003300*    I-O STATEMENT, INCLUDING THAT WHICH RAISES THE AT END     *
003400*    CONDITION.  THE FILE IS CLOSED AND OPENED IN THE INPUT    *
003500*    MODE AGAIN.  ON THIS PASS, THE FILE IS READ USING READ    *
003600*    STATEMENTS WITHOUT THE AT END PHRASE.  FIRST HUNDRED      *
003700*    RECORDS ARE READ USING A READ STATEMENT WITH THE OPTIONAL *
003800*    WORD "RECORD", THE REMAINDER WITHOUT IT.  ON THIS PASS,   *
003900*    THE AT END CONDITION SHOULD CAUSE EXECUTION OF THE        *
004000*    DECLARATIVE PROCEDURE.                                    *
004100*                                                              *
004200*    THE FILE-CONTROL ENTRY FOR THE FILE CONTAINS A FILE       *
004300*    STATUS CLAUSE, AND TESTS CHECK THAT EACH I-O OPERATION    *
004400*    RETURNS THE APPROPRIATE STATUS VALUE.                     *
004500*                                                              *
004600****************************************************************
004700*
004800*
004900 ENVIRONMENT DIVISION.
005000 CONFIGURATION SECTION.
005100 SOURCE-COMPUTER.
005200     XXXXX082.
005300 OBJECT-COMPUTER.
005400     XXXXX083.
005500*
005600 INPUT-OUTPUT SECTION.
005700 FILE-CONTROL.
005800     SELECT PRINT-FILE ASSIGN TO
005900     XXXXX055.
006000*
006100P    SELECT RAW-DATA   ASSIGN TO
006200P    XXXXX062
006300P          ORGANIZATION IS INDEXED
006400P          ACCESS MODE  IS RANDOM
006500P          RECORD-KEY   IS RAW-DATA-KEY.
006600P
006700     SELECT SQ-FS2 ASSIGN TO
006800     XXXXX001
006900            ACCESS MODE IS SEQUENTIAL
007000            FILE STATUS IS SQ-FS2-STATUS
007100            ORGANIZATION SEQUENTIAL
007200            .
007300*
007400*
007500 DATA DIVISION.
007600 FILE SECTION.
007700 FD  PRINT-FILE
007800C    LABEL RECORDS
007900C    XXXXX084
008000C    DATA RECORD IS PRINT-REC DUMMY-RECORD
008100               .
008200 01  PRINT-REC    PICTURE X(120).
008300 01  DUMMY-RECORD PICTURE X(120).
008400P
008500PFD  RAW-DATA.
008600P01  RAW-DATA-SATZ.
008700P    05  RAW-DATA-KEY        PIC X(6).
008800P    05  C-DATE              PIC 9(6).
008900P    05  C-TIME              PIC 9(8).
009000P    05  NO-OF-TESTS         PIC 99.
009100P    05  C-OK                PIC 999.
009200P    05  C-ALL               PIC 999.
009300P    05  C-FAIL              PIC 999.
009400P    05  C-DELETED           PIC 999.
009500P    05  C-INSPECT           PIC 999.
009600P    05  C-NOTE              PIC X(13).
009700P    05  C-INDENT            PIC X.
009800P    05  C-ABORT             PIC X(8).
009900*
010000 FD  SQ-FS2
010100C    LABEL RECORD IS STANDARD
010200                .
010300 01  SQ-FS2R1-F-G-120 PIC X(120).
010400*
010500 WORKING-STORAGE SECTION.
010600*
010700***************************************************************
010800*                                                             *
010900*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
011000*                                                             *
011100***************************************************************
011200*
011300 01  SQ-FS2-STATUS.
011400   03  SQ-FS2-KEY-1   PIC X.
011500   03  SQ-FS2-KEY-2   PIC X.
011600*
011700 01  SQ-FS2-STATUS-COPY PIC XX.
011800 01  DECL-EXEC-SW       PIC 9.
011900 01  DECL-EXEC-COUNT    PIC 99999.
012000 01  EOF-FLAG           PIC 9  VALUE 0.
012100 01  WRK-CS-09V00       PICTURE S9(9) USAGE COMPUTATIONAL.
012200 01  RECORDS-IN-ERROR   PIC S9(5) USAGE COMP.
012300 01  ERROR-FLAG         PICTURE 9.
012400*
012500***************************************************************
012600*                                                             *
012700*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
012800*                                                             *
012900***************************************************************
013000*
013100 01  REC-SKEL-SUB   PIC 99.
013200*
013300 01  FILE-RECORD-INFORMATION-REC.
013400     03 FILE-RECORD-INFO-SKELETON.
013500        05 FILLER                 PICTURE X(48)       VALUE
013600             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
013700        05 FILLER                 PICTURE X(46)       VALUE
013800             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
013900        05 FILLER                 PICTURE X(26)       VALUE
014000             ",LFIL=000000,ORG=  ,LBLR= ".
014100        05 FILLER                 PICTURE X(37)       VALUE
014200             ",RECKEY=                             ".
014300        05 FILLER                 PICTURE X(38)       VALUE
014400             ",ALTKEY1=                             ".
014500        05 FILLER                 PICTURE X(38)       VALUE
014600             ",ALTKEY2=                             ".
014700        05 FILLER                 PICTURE X(7)        VALUE SPACE.
014800     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
014900        05 FILE-RECORD-INFO-P1-120.
015000           07 FILLER              PIC X(5).
015100           07 XFILE-NAME          PIC X(6).
015200           07 FILLER              PIC X(8).
015300           07 XRECORD-NAME        PIC X(6).
015400           07 FILLER              PIC X(1).
015500           07 REELUNIT-NUMBER     PIC 9(1).
015600           07 FILLER              PIC X(7).
015700           07 XRECORD-NUMBER      PIC 9(6).
015800           07 FILLER              PIC X(6).
015900           07 UPDATE-NUMBER       PIC 9(2).
016000           07 FILLER              PIC X(5).
016100           07 ODO-NUMBER          PIC 9(4).
016200           07 FILLER              PIC X(5).
016300           07 XPROGRAM-NAME       PIC X(5).
016400           07 FILLER              PIC X(7).
016500           07 XRECORD-LENGTH      PIC 9(6).
016600           07 FILLER              PIC X(7).
016700           07 CHARS-OR-RECORDS    PIC X(2).
016800           07 FILLER              PIC X(1).
016900           07 XBLOCK-SIZE         PIC 9(4).
017000           07 FILLER              PIC X(6).
017100           07 RECORDS-IN-FILE     PIC 9(6).
017200           07 FILLER              PIC X(5).
017300           07 XFILE-ORGANIZATION  PIC X(2).
017400           07 FILLER              PIC X(6).
017500           07 XLABEL-TYPE         PIC X(1).
017600        05 FILE-RECORD-INFO-P121-240.
017700           07 FILLER              PIC X(8).
017800           07 XRECORD-KEY         PIC X(29).
017900           07 FILLER              PIC X(9).
018000           07 ALTERNATE-KEY1      PIC X(29).
018100           07 FILLER              PIC X(9).
018200           07 ALTERNATE-KEY2      PIC X(29).
018300           07 FILLER              PIC X(7).
018400*
018500 01  TEST-RESULTS.
018600     02 FILLER              PIC X      VALUE SPACE.
018700     02  PAR-NAME.
018800       03 FILLER              PIC X(14)  VALUE SPACE.
018900       03 PARDOT-X            PIC X      VALUE SPACE.
019000       03 DOTVALUE            PIC 99     VALUE ZERO.
019100     02 FILLER              PIC X      VALUE SPACE.
019200     02 FEATURE             PIC X(24)  VALUE SPACE.
019300     02 FILLER              PIC X      VALUE SPACE.
019400     02 P-OR-F              PIC X(5)   VALUE SPACE.
019500     02 FILLER              PIC X(9)   VALUE SPACE.
019600     02 RE-MARK             PIC X(61).
019700 01  TEST-COMPUTED.
019800   02 FILLER  PIC X(30)  VALUE SPACE.
019900   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
020000   02 COMPUTED-X.
020100     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
020200     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
020300     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
020400     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
020500     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
020600     03       CM-18V0 REDEFINES COMPUTED-A.
020700        04 COMPUTED-18V0                   PIC -9(18).
020800        04 FILLER                          PIC X.
020900     03 FILLER PIC X(50) VALUE SPACE.
021000 01  TEST-CORRECT.
021100     02 FILLER PIC X(30) VALUE SPACE.
021200     02 FILLER PIC X(17) VALUE "       CORRECT =".
021300     02 CORRECT-X.
021400     03 CORRECT-A                  PIC X(20) VALUE SPACE.
021500     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
021600     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
021700     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
021800     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
021900     03      CR-18V0 REDEFINES CORRECT-A.
022000         04 CORRECT-18V0                     PIC -9(18).
022100         04 FILLER                           PIC X.
022200     03 FILLER PIC X(2) VALUE SPACE.
022300     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
022400*
022500 01  CCVS-C-1.
022600     02 FILLER  PIC IS X        VALUE  SPACE.
022700     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
022800     02 FILLER  PIC IS X        VALUE  SPACE.
022900     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
023000     02 FILLER  PIC IS X        VALUE  SPACE.
023100     02 FILLER  PIC IS X(5)     VALUE "PASS ".
023200     02 FILLER  PIC IS X(9)     VALUE  SPACE.
023300     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
023400 01  CCVS-C-2.
023500     02 FILLER  PIC X(20)  VALUE  SPACE.
023600     02 FILLER  PIC X(6)   VALUE "TESTED".
023700     02 FILLER  PIC X(18)  VALUE  SPACE.
023800     02 FILLER  PIC X(4)   VALUE "FAIL".
023900     02 FILLER  PIC X(72)  VALUE  SPACE.
024000*
024100 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
024200 01  REC-CT            PIC 99       VALUE ZERO.
024300 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
024400 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
024500 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
024600 01  PASS-COUNTER      PIC 999      VALUE ZERO.
024700 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
024800 01  ERROR-HOLD        PIC 999      VALUE ZERO.
024900 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
025000 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
025100 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
025200 01  CCVS-H-1.
025300     02  FILLER          PIC X(39)    VALUE SPACES.
025400     02  FILLER          PIC X(42)    VALUE
025500     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
025600     02  FILLER          PIC X(39)    VALUE SPACES.
025700 01  CCVS-H-2A.
025800   02  FILLER            PIC X(40)  VALUE SPACE.
025900   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
026000   02  FILLER            PIC XXXX   VALUE
026100     "4.2 ".
026200   02  FILLER            PIC X(28)  VALUE
026300            " COPY - NOT FOR DISTRIBUTION".
026400   02  FILLER            PIC X(41)  VALUE SPACE.
026500*
026600 01  CCVS-H-2B.
026700   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
026800   02  TEST-ID           PIC X(9).
026900   02  FILLER            PIC X(4)   VALUE " IN ".
027000   02  FILLER            PIC X(12)  VALUE
027100     " HIGH       ".
027200   02  FILLER            PIC X(22)  VALUE
027300            " LEVEL VALIDATION FOR ".
027400   02  FILLER            PIC X(58)  VALUE
027500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
027600 01  CCVS-H-3.
027700     02  FILLER          PIC X(34)  VALUE
027800            " FOR OFFICIAL USE ONLY    ".
027900     02  FILLER          PIC X(58)  VALUE
028000     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
028100     02  FILLER          PIC X(28)  VALUE
028200            "  COPYRIGHT   1985,1986 ".
028300 01  CCVS-E-1.
028400     02 FILLER           PIC X(52)  VALUE SPACE.
028500     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
028600     02 ID-AGAIN         PIC X(9).
028700     02 FILLER           PIC X(45)  VALUE SPACES.
028800 01  CCVS-E-2.
028900     02  FILLER          PIC X(31)  VALUE SPACE.
029000     02  FILLER          PIC X(21)  VALUE SPACE.
029100     02  CCVS-E-2-2.
029200         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
029300         03 FILLER         PIC X      VALUE SPACE.
029400         03 ENDER-DESC     PIC X(44)  VALUE
029500            "ERRORS ENCOUNTERED".
029600 01  CCVS-E-3.
029700     02  FILLER          PIC X(22)  VALUE
029800            " FOR OFFICIAL USE ONLY".
029900     02  FILLER          PIC X(12)  VALUE SPACE.
030000     02  FILLER          PIC X(58)  VALUE
030100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
030200     02  FILLER          PIC X(8)   VALUE SPACE.
030300     02  FILLER          PIC X(20)  VALUE
030400             " COPYRIGHT 1985,1986".
030500 01  CCVS-E-4.
030600     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
030700     02 FILLER           PIC X(4)   VALUE " OF ".
030800     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
030900     02 FILLER           PIC X(40)  VALUE
031000      "  TESTS WERE EXECUTED SUCCESSFULLY".
031100 01  XXINFO.
031200     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
031300     02 INFO-TEXT.
031400       04 FILLER             PIC X(8)   VALUE SPACE.
031500       04 XXCOMPUTED         PIC X(20).
031600       04 FILLER             PIC X(5)   VALUE SPACE.
031700       04 XXCORRECT          PIC X(20).
031800     02 INF-ANSI-REFERENCE PIC X(48).
031900 01  HYPHEN-LINE.
032000     02 FILLER  PIC IS X VALUE IS SPACE.
032100     02 FILLER  PIC IS X(65)    VALUE IS "************************
032200-    "*****************************************".
032300     02 FILLER  PIC IS X(54)    VALUE IS "************************
032400-    "******************************".
032500 01  CCVS-PGM-ID  PIC X(9)   VALUE
032600     "SQ103A".
032700*
032800*
032900 PROCEDURE DIVISION.
033000 DECLARATIVES.
033100 SECT-SQ103-0001 SECTION.
033200     USE AFTER STANDARD EXCEPTION PROCEDURE ON SQ-FS2.
033300 TEST-STATUS.
033400     MOVE    ZERO TO DECL-EXEC-SW.
033500     ADD     1    TO DECL-EXEC-COUNT.
033600 END DECLARATIVES.
033700*
033800 CCVS1 SECTION.
033900 OPEN-FILES.
034000P    OPEN    I-O RAW-DATA.
034100P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
034200P    READ    RAW-DATA INVALID KEY GO TO END-E-1.
034300P    MOVE   "ABORTED "   TO C-ABORT.
034400P    ADD     1           TO C-NO-OF-TESTS.
034500P    ACCEPT  C-DATE      FROM DATE.
034600P    ACCEPT  C-TIME      FROM TIME.
034700P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
034800PEND-E-1.
034900P    CLOSE   RAW-DATA.
035000     OPEN    OUTPUT PRINT-FILE.
035100     MOVE    CCVS-PGM-ID TO TEST-ID.
035200     MOVE    CCVS-PGM-ID TO ID-AGAIN.
035300     MOVE    SPACE TO TEST-RESULTS.
035400     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
035500     MOVE    ZERO TO REC-SKEL-SUB.
035600     PERFORM CCVS-INIT-FILE 10 TIMES.
035700     GO TO CCVS1-EXIT.
035800*
035900 CCVS-INIT-FILE.
036000     ADD     1 TO REC-SKL-SUB.
036100     MOVE    FILE-RECORD-INFO-SKELETON TO
036200                  FILE-RECORD-INFO (REC-SKL-SUB).
036300*
036400 CLOSE-FILES.
036500     PERFORM END-ROUTINE THRU END-ROUTINE-13.
036600     CLOSE   PRINT-FILE.
036700P    OPEN    I-O RAW-DATA.
036800P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
036900P    READ    RAW-DATA INVALID KEY GO TO END-E-2.
037000P    MOVE   "OK.     " TO C-ABORT.
037100P    MOVE    PASS-COUNTER  TO C-OK.
037200P    MOVE    ERROR-HOLD    TO C-ALL.
037300P    MOVE    ERROR-COUNTER TO C-FAIL.
037400P    MOVE    DELETE-CNT    TO C-DELETED.
037500P    MOVE    INSPECT-COUNTER TO C-INSPECT.
037600P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
037700PEND-E-2.
037800P    CLOSE   RAW-DATA.
037900 TERMINATE-CCVS.
038000S    EXIT    PROGRAM.
038100     STOP    RUN.
038200*
038300 INSPT.
038400     MOVE   "INSPT" TO P-OR-F.
038500     ADD     1 TO INSPECT-COUNTER.
038600     PERFORM PRINT-DETAIL.
038700*
038800 PASS.
038900     MOVE   "PASS " TO P-OR-F.
039000     ADD     1 TO PASS-COUNTER.
039100     PERFORM PRINT-DETAIL.
039200*
039300 FAIL.
039400     MOVE   "FAIL*" TO P-OR-F.
039500     ADD     1 TO ERROR-COUNTER.
039600     PERFORM PRINT-DETAIL.
039700*
039800 DE-LETE.
039900     MOVE   "****TEST DELETED****" TO RE-MARK.
040000     MOVE   "*****" TO P-OR-F.
040100     ADD     1 TO DELETE-COUNTER.
040200     PERFORM PRINT-DETAIL.
040300*
040400 PRINT-DETAIL.
040500     IF REC-CT NOT EQUAL TO ZERO
040600         MOVE   "." TO PARDOT-X
040700         MOVE    REC-CT TO DOTVALUE.
040800     MOVE    TEST-RESULTS TO PRINT-REC.
040900     PERFORM WRITE-LINE.
041000     IF P-OR-F EQUAL TO "FAIL*"
041100         PERFORM WRITE-LINE
041200         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
041300     ELSE
041400         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
041500     MOVE    SPACE TO P-OR-F.
041600     MOVE    SPACE TO COMPUTED-X.
041700     MOVE    SPACE TO CORRECT-X.
041800     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
041900     MOVE    SPACE TO RE-MARK.
042000*
042100 HEAD-ROUTINE.
042200     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042300     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042400     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
042500     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
042600 COLUMN-NAMES-ROUTINE.
042700     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
042800     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
043000 END-ROUTINE.
043100     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
043200     PERFORM WRITE-LINE 5 TIMES.
043300 END-RTN-EXIT.
043400     MOVE    CCVS-E-1 TO DUMMY-RECORD.
043500     PERFORM WRITE-LINE 2 TIMES.
043600*
043700 END-ROUTINE-1.
043800     ADD     ERROR-COUNTER   TO ERROR-HOLD
043900     ADD     INSPECT-COUNTER TO ERROR-HOLD.
044000     ADD     DELETE-COUNTER  TO ERROR-HOLD.
044100     ADD     PASS-COUNTER    TO ERROR-HOLD.
044200     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
044300     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
044400     MOVE    CCVS-E-4        TO CCVS-E-2-2.
044500     MOVE    CCVS-E-2        TO DUMMY-RECORD
044600     PERFORM WRITE-LINE.
044700     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
044800     IF ERROR-COUNTER IS EQUAL TO ZERO
044900         MOVE   "NO " TO ERROR-TOTAL
045000     ELSE
045100         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
045200     MOVE    CCVS-E-2 TO DUMMY-RECORD.
045300     PERFORM WRITE-LINE.
045400 END-ROUTINE-13.
045500     IF DELETE-COUNTER IS EQUAL TO ZERO
045600         MOVE   "NO " TO ERROR-TOTAL
045700     ELSE
045800         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
045900     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
046000     MOVE    CCVS-E-2 TO DUMMY-RECORD.
046100     PERFORM WRITE-LINE.
046200     IF INSPECT-COUNTER EQUAL TO ZERO
046300         MOVE   "NO " TO ERROR-TOTAL
046400     ELSE
046500         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
046600     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
046700     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
046800     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
046900*
047000 WRITE-LINE.
047100     ADD     1 TO RECORD-COUNT.
047200Y    IF RECORD-COUNT GREATER 50
047300Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
047400Y        MOVE  SPACE TO DUMMY-RECORD
047500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
047600Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
047700Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
047800Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
047900Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
048000Y        MOVE  ZERO TO RECORD-COUNT.
048100     PERFORM WRT-LN.
048200*
048300 WRT-LN.
048400     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
048500     MOVE    SPACE TO DUMMY-RECORD.
048600 BLANK-LINE-PRINT.
048700     PERFORM WRT-LN.
048800 FAIL-ROUTINE.
048900     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
049000     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
049100     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
049200     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
049300     MOVE    XXINFO TO DUMMY-RECORD.
049400     PERFORM WRITE-LINE 2 TIMES.
049500     MOVE    SPACES TO INF-ANSI-REFERENCE.
049600     GO TO   FAIL-ROUTINE-EX.
049700 FAIL-ROUTINE-WRITE.
049800     MOVE    TEST-COMPUTED  TO PRINT-REC
049900     PERFORM WRITE-LINE
050000     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
050100     MOVE    TEST-CORRECT   TO PRINT-REC
050200     PERFORM WRITE-LINE 2 TIMES.
050300     MOVE    SPACES         TO COR-ANSI-REFERENCE.
050400 FAIL-ROUTINE-EX.
050500     EXIT.
050600 BAIL-OUT.
050700     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
050800     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
050900 BAIL-OUT-WRITE.
051000     MOVE    CORRECT-A      TO XXCORRECT.
051100     MOVE    COMPUTED-A     TO XXCOMPUTED.
051200     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
051300     MOVE    XXINFO TO DUMMY-RECORD.
051400     PERFORM WRITE-LINE 2 TIMES.
051500     MOVE    SPACES TO INF-ANSI-REFERENCE.
051600 BAIL-OUT-EX.
051700     EXIT.
051800 CCVS1-EXIT.
051900     EXIT.
052000*
052100****************************************************************
052200*                                                              *
052300*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
052400*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
052500*                                                              *
052600****************************************************************
052700*
052800 SECT-SQ103-0002 SECTION.
052900 INITIAL-PARA.
053000     MOVE   "SQ-FS2"     TO XFILE-NAME (1).
053100     MOVE   "R1-F-G"     TO XRECORD-NAME (1).
053200     MOVE    CCVS-PGM-ID TO XPROGRAM-NAME (1).
053300     MOVE    120         TO XRECORD-LENGTH (1).
053400     MOVE   "RC"         TO CHARS-OR-RECORDS (1).
053500     MOVE    0001        TO XBLOCK-SIZE (1).
053600     MOVE    500         TO RECORDS-IN-FILE (1).
053700     MOVE   "SQ"         TO XFILE-ORGANIZATION (1).
053800     MOVE   "S"          TO XLABEL-TYPE (1).
053900*
054000 SEQ-INIT-01.
054100     MOVE   "SEQ-TEST-GF-01" TO PAR-NAME.
054200     MOVE   "OPEN OUTPUT, TAPE FILE" TO FEATURE.
054300     MOVE    1      TO REC-CT.
054400     MOVE   "**"    TO SQ-FS2-STATUS.
054500     MOVE    1      TO DECL-EXEC-SW.
054600     MOVE    000001 TO XRECORD-NUMBER (1).
054700     MOVE    ZERO   TO DECL-EXEC-COUNT.
054800     GO TO   SEQ-TEST-GF-01.
054900 SEQ-DELETE-01.
055000     PERFORM DE-LETE.
055100     ADD     1 TO REC-CT
055200     PERFORM DE-LETE.
055300     GO TO   SEQ-DELETE-02.
055400 SEQ-TEST-GF-01.
055500     OPEN OUTPUT SQ-FS2.
055600     IF DECL-EXEC-SW = 1
055700         PERFORM PASS
055800     ELSE
055900         MOVE    1 TO CORRECT-18V0
056000         MOVE    DECL-EXEC-SW TO COMPUTED-18V0
056100         MOVE   "UNEXPECTED EXECUTION OF DECLARATIVE" TO RE-MARK
056200         PERFORM FAIL.
056300     ADD     1 TO REC-CT.
056400     IF SQ-FS2-STATUS EQUAL "00"
056500         PERFORM PASS
056600     ELSE
056700         MOVE    SQ-FS2-STATUS TO COMPUTED-A
056800         MOVE   "00" TO CORRECT-A
056900         MOVE   "UNEXPECTED I-O STATUS FROM OPEN" TO RE-MARK
057000         PERFORM FAIL.
057100*
057200 SEQ-INIT-02.
057300     MOVE    ZERO TO DECL-EXEC-COUNT.
057400     MOVE   "**"  TO SQ-FS2-STATUS.
057500     MOVE   "00"  TO SQ-FS2-STATUS-COPY.
057600     MOVE    ZERO TO XRECORD-NUMBER (1).
057700     GO TO   SEQ-TEST-GF-02.
057800 SEQ-DELETE-02.
057900     MOVE    1 TO REC-CT.
058000     MOVE   "SEQ-TEST-GF-02"    TO PAR-NAME.
058100     MOVE   "WRITE 500 RECORDS" TO FEATURE.
058200     PERFORM DE-LETE.
058300     ADD     1 TO REC-CT.
058400     PERFORM DE-LETE.
058500     GO TO   SEQ-TEST-02-END.
058600 SEQ-TEST-GF-02.
058700     MOVE    1 TO REC-CT.
058800     MOVE   "SEQ-TEST-GF-02"    TO PAR-NAME.
058900     MOVE   "WRITE 500 RECORDS" TO FEATURE.
059000 SEQ-TEST-GF-02-LOOP.
059100     ADD     1 TO XRECORD-NUMBER (1).
059200     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-FS2R1-F-G-120.
059300     WRITE SQ-FS2R1-F-G-120.
059400     IF SQ-FS2-STATUS NOT = "00"
059500         MOVE    SQ-FS2-STATUS TO SQ-FS2-STATUS-COPY.
059600     IF XRECORD-NUMBER (1) LESS THAN 500
059700           GO TO SEQ-TEST-GF-02-LOOP.
059800*
059900     IF DECL-EXEC-COUNT = ZERO
060000         PERFORM PASS
060100     ELSE
060200         MOVE    DECL-EXEC-COUNT TO COMPUTED-18V0
060300         MOVE    1 TO CORRECT-18V0
060400         MOVE   "DECLARATIVE ENTERED AT LEAST ONCE" TO RE-MARK
060500         PERFORM FAIL.
060600     ADD     1 TO REC-CT.
060700     IF SQ-FS2-STATUS-COPY EQUAL TO "00"
060800         PERFORM PASS
060900     ELSE
061000         MOVE    SQ-FS2-STATUS-COPY TO COMPUTED-A
061100         MOVE   "00" TO CORRECT-A
061200         MOVE   "AT LEAST ONE UNSUCCESSFUL WRITE" TO RE-MARK
061300         PERFORM FAIL.
061400 SEQ-TEST-02-END.
061500*
061600 SEQ-INIT-03.
061700     MOVE    1 TO REC-CT.
061800     MOVE   "SEQ-TEST-GF-03" TO PAR-NAME.
061900     MOVE   "CLOSE FILE FROM OUTPUT" TO FEATURE.
062000     MOVE    1 TO DECL-EXEC-SW.
062100     MOVE   "**" TO SQ-FS2-STATUS.
062200     GO TO   SEQ-TEST-GF-03.
062300 SEQ-DELETE-03.
062400     PERFORM DE-LETE.
062500     ADD     1 TO REC-CT.
062600     PERFORM DE-LETE.
062700     GO TO   SEQ-TEST-03-END.
062800 SEQ-TEST-GF-03.
062900     CLOSE SQ-FS2.
063000     IF DECL-EXEC-SW = 1
063100         PERFORM PASS
063200     ELSE
063300         MOVE    DECL-EXEC-SW TO COMPUTED-18V0
063400         MOVE    1 TO CORRECT-18V0
063500         MOVE   "UNEXPECTED EXECUTION OF DECLARATIVE ON CLOSE"
063600                    TO RE-MARK
063700         PERFORM FAIL.
063800     ADD     1 TO REC-CT.
063900     IF SQ-FS2-STATUS = "00"
064000         PERFORM PASS
064100     ELSE
064200         MOVE    SQ-FS2-STATUS TO COMPUTED-A
064300         MOVE   "00" TO CORRECT-A
064400         MOVE   "I-O STATUS AFTER CLOSE INDICATES FAILURE"
064500                    TO RE-MARK
064600         PERFORM FAIL.
064700 SEQ-TEST-03-END.
064800*
064900*    A SEQUENTIAL TAPE FILE HAS BEEN CREATED.  IT CONTAINS 500
065000*    FIXED-LENGTH RECORDS, EACH 120 CHARACTERS LONG.  THE NEXT
065100*    GROUP OF TESTS READS THIS FILE, COUNTING THE RECORDS AND
065200*    CHECKING THEIR CONTENT.
065300*
065400 SEQ-INIT-04.
065500     MOVE    1 TO REC-CT.
065600     MOVE   "SEQ-TEST-GF-04" TO PAR-NAME.
065700     MOVE   "OPEN NEWLY-WRITTEN FILE" TO FEATURE.
065800     MOVE    1 TO DECL-EXEC-SW.
065900     MOVE   "**" TO SQ-FS2-STATUS.
066000     GO TO   SEQ-TEST-GF-04.
066100 SEQ-DELETE-04.
066200     PERFORM DE-LETE.
066300     ADD     1 TO REC-CT.
066400     PERFORM DE-LETE.
066500     GO TO SEQ-TEST-04-END.
066600 SEQ-TEST-GF-04.
066700     OPEN INPUT SQ-FS2.
066800     IF SQ-FS2-STATUS = "00"
066900         PERFORM PASS
067000     ELSE
067100         MOVE    SQ-FS2-STATUS TO COMPUTED-A
067200         MOVE   "00" TO CORRECT-A
067300         MOVE   "I-O STATUS INDICATES ABNORMAL OPEN" TO RE-MARK
067400         PERFORM FAIL.
067500     ADD     1 TO REC-CT.
067600     IF DECL-EXEC-SW = 1
067700         PERFORM PASS
067800     ELSE
067900         MOVE    DECL-EXEC-SW TO COMPUTED-18V0
068000         MOVE    1 TO CORRECT-18V0
068100         MOVE   "UNEXPECTED EXECUTION OF DECLARATIVE" TO RE-MARK
068200         PERFORM FAIL.
068300 SEQ-TEST-04-END.
068400*
068500 SEQ-INIT-05.
068600     MOVE    1 TO REC-CT.
068700     MOVE    ZERO TO XRECORD-NUMBER (1).
068800     MOVE    ZERO TO DECL-EXEC-COUNT.
068900     MOVE    ZERO TO EOF-FLAG.
069000     MOVE    ZERO TO RECORDS-IN-ERROR.
069100     MOVE   "**"  TO SQ-FS2-STATUS.
069200     MOVE   "00"  TO SQ-FS2-STATUS-COPY.
069300     MOVE   "READ 500 RECORD FILE" TO FEATURE.
069400     MOVE   "SEQ-TEST-GF-05" TO PAR-NAME.
069500     GO TO   SEQ-TEST-GF-05.
069600 SEQ-DELETE-05.
069700     PERFORM DE-LETE.
069800     ADD     1 TO REC-CT.
069900     PERFORM DE-LETE.
070000     ADD     1 TO REC-CT.
070100     PERFORM DE-LETE.
070200     ADD     1 TO REC-CT.
070300     PERFORM DE-LETE.
070400     ADD     1 TO REC-CT.
070500     PERFORM DE-LETE.
070600     ADD     1 TO REC-CT.
070700     PERFORM DE-LETE.
070800     GO TO   SEQ-TEST-05-END.
070900 SEQ-TEST-GF-05.
071000 SEQ-TEST-GF-05-LOOP.
071100     READ    SQ-FS2 RECORD END
071200                 MOVE    1 TO EOF-FLAG
071300                 GO TO SEQ-TEST-GF-05-02.
071400     IF SQ-FS2-STATUS = "10"
071500         GO TO   SEQ-TEST-GF-05-02.
071600     IF SQ-FS2-STATUS NOT = "00"
071700         MOVE    SQ-FS2-STATUS TO SQ-FS2-STATUS-COPY.
071800     ADD     1 TO XRECORD-NUMBER (1).
071900     IF SQ-FS2R1-F-G-120 NOT EQUAL FILE-RECORD-INFO-P1-120 (1)
072000         ADD     1 TO RECORDS-IN-ERROR.
072100     IF XRECORD-NUMBER (1) LESS THAN OR EQUAL TO 500
072200         GO TO   SEQ-TEST-GF-05-LOOP.
072300*
072400 SEQ-TEST-GF-05-02.
072500     IF XRECORD-NUMBER (1) = 500
072600         PERFORM PASS
072700     ELSE
072800         MOVE    XRECORD-NUMBER (1) TO COMPUTED-18V0
072900         MOVE    500 TO CORRECT-18V0
073000         MOVE   "UNEXPECTED NUMBER OF RECORDS BEFORE EOF"
073100                    TO RE-MARK
073200         PERFORM FAIL.
073300     ADD     1 TO REC-CT.
073400     IF DECL-EXEC-COUNT = ZERO
073500         PERFORM PASS
073600     ELSE
073700         MOVE    DECL-EXEC-COUNT TO COMPUTED-18V0
073800         MOVE    1 TO CORRECT-18V0
073900         MOVE   "DECLARATIVE ENTERED AT LEAST ONCE" TO RE-MARK
074000         PERFORM FAIL.
074100     ADD     1 TO REC-CT.
074200     IF SQ-FS2-STATUS-COPY EQUAL TO "00"
074300         PERFORM PASS
074400     ELSE
074500         MOVE    SQ-FS2-STATUS-COPY TO COMPUTED-A
074600         MOVE   "00" TO CORRECT-A
074700         MOVE   "AT LEAST ONE UNSUCCESSFUL READ" TO RE-MARK
074800         PERFORM FAIL.
074900     ADD     1 TO REC-CT.
075000     IF EOF-FLAG = 1
075100         PERFORM PASS
075200     ELSE
075300         MOVE    EOF-FLAG TO COMPUTED-18V0
075400         MOVE    1 TO CORRECT-18V0
075500         MOVE   "AT END STATEMENT NOT EXECUTED" TO RE-MARK
075600         MOVE   "VII-46, 4.4.4(10)C" TO ANSI-REFERENCE
075700         PERFORM FAIL.
075800     ADD     1 TO REC-CT.
075900     IF SQ-FS2-STATUS EQUAL TO "10"
076000         PERFORM PASS
076100     ELSE
076200         MOVE    SQ-FS2-STATUS TO COMPUTED-A
076300         MOVE   "10" TO CORRECT-A
076400         MOVE   "UNEXPECTED I-O STATUS FROM FINAL READ"
076500                    TO RE-MARK
076600         MOVE   "VII-46, 4.4.4(10)A, VII-3" TO ANSI-REFERENCE
076700         PERFORM FAIL.
076800     ADD     1 TO REC-CT.
076900     IF RECORDS-IN-ERROR EQUAL TO ZERO
077000         PERFORM PASS
077100     ELSE
077200         MOVE    RECORDS-IN-ERROR TO COMPUTED-18V0
077300         MOVE    ZERO TO CORRECT-18V0
077400         MOVE   "INCORRECT RECORD CONTENTS FOUND" TO RE-MARK
077500         PERFORM FAIL.
077600 SEQ-TEST-05-END.
077700*
077800 SEQ-INIT-06.
077900     MOVE   "SEQ-TEST-GF-06" TO PAR-NAME.
078000     MOVE   "CLOSE FILE FROM INPUT" TO FEATURE.
078100     MOVE    1 TO REC-CT.
078200     MOVE    1 TO DECL-EXEC-SW.
078300     MOVE   "**" TO SQ-FS2-STATUS.
078400     GO TO   SEQ-TEST-GF-06.
078500 SEQ-DELETE-06.
078600     PERFORM DE-LETE.
078700     ADD     1 TO REC-CT.
078800     PERFORM DE-LETE.
078900     GO TO   SEQ-TEST-06-END.
079000 SEQ-TEST-GF-06.
079100     CLOSE SQ-FS2.
079200     IF DECL-EXEC-SW = 1
079300         PERFORM PASS
079400     ELSE
079500         MOVE    DECL-EXEC-SW TO COMPUTED-18V0
079600         MOVE    1 TO CORRECT-18V0
079700         MOVE   "UNEXPECTED EXECUTION OF DECLARATIVE ON CLOSE"
079800                    TO RE-MARK
079900         PERFORM FAIL.
080000     ADD     1 TO REC-CT.
080100     IF SQ-FS2-STATUS = "00"
080200         PERFORM PASS
080300     ELSE
080400         MOVE    SQ-FS2-STATUS TO COMPUTED-A
080500         MOVE   "00" TO CORRECT-A
080600         MOVE   "I-O STATUS AFTER CLOSE INDICATES FAILURE"
080700                    TO RE-MARK
080800         PERFORM FAIL.
080900 SEQ-TEST-06-END.
081000*
081100*
081200*    TWO OPTIONS FOR THE READ STATEMENT ARE CHECKED IN THIS
081300*    SERIES OF TESTS, THE ABSENCE OF ALL OPTIONAL PHRASES, AND
081400*    THE ABSENCE OF ALL EXCEPT THE OPTIONAL WORD "RECORD".
081500*
081600 SEQ-INIT-07.
081700     MOVE    1 TO REC-CT.
081800     MOVE   "SEQ-TEST-GF-07" TO PAR-NAME.
081900     MOVE   "OPEN FILE FOR INPUT" TO FEATURE.
082000     MOVE    1 TO DECL-EXEC-SW.
082100     MOVE   "**" TO SQ-FS2-STATUS.
082200     GO TO   SEQ-TEST-GF-07.
082300 SEQ-DELETE-07.
082400     PERFORM DE-LETE.
082500     ADD     1 TO REC-CT.
082600     PERFORM DE-LETE.
082700     GO TO SEQ-TEST-07-END.
082800 SEQ-TEST-GF-07.
082900     OPEN INPUT SQ-FS2.
083000     IF SQ-FS2-STATUS = "00"
083100         PERFORM PASS
083200     ELSE
083300         MOVE    SQ-FS2-STATUS TO COMPUTED-A
083400         MOVE   "00" TO CORRECT-A
083500         MOVE   "I-O STATUS INDICATES ABNORMAL OPEN" TO RE-MARK
083600         PERFORM FAIL.
083700     ADD     1 TO REC-CT.
083800     IF DECL-EXEC-SW = 1
083900         PERFORM PASS
084000     ELSE
084100         MOVE    DECL-EXEC-SW TO COMPUTED-18V0
084200         MOVE    1 TO CORRECT-18V0
084300         MOVE   "UNEXPECTED EXECUTION OF DECLARATIVE" TO RE-MARK
084400         PERFORM FAIL.
084500 SEQ-TEST-07-END.
084600*
084700 SEQ-INIT-08.
084800     MOVE    1 TO REC-CT.
084900     MOVE    ZERO TO RECORDS-IN-ERROR.
085000     MOVE    ZERO TO XRECORD-NUMBER (1).
085100     MOVE    ZERO TO DECL-EXEC-COUNT.
085200     MOVE    ZERO TO EOF-FLAG.
085300     MOVE   "**"  TO SQ-FS2-STATUS.
085400     MOVE   "00"  TO SQ-FS2-STATUS-COPY.
085500     MOVE   "READ ... RECORD" TO FEATURE.
085600     MOVE   "SEQ-TEST-GF-08" TO PAR-NAME.
085700     GO TO   SEQ-TEST-GF-08.
085800 SEQ-DELETE-08.
085900     PERFORM DE-LETE.
086000     ADD     1 TO REC-CT.
086100     PERFORM DE-LETE.
086200     ADD     1 TO REC-CT.
086300     PERFORM DE-LETE.
086400     ADD     1 TO REC-CT.
086500     PERFORM DE-LETE.
086600     GO TO   SEQ-TEST-08-END.
086700 SEQ-TEST-GF-08.
086800 SEQ-TEST-GF-08-LOOP.
086900     READ    SQ-FS2 RECORD.
087000     IF SQ-FS2-STATUS = "10"
087100         MOVE    1 TO EOF-FLAG
087200         GO TO   SEQ-TEST-GF-08-02.
087300     IF SQ-FS2-STATUS NOT = "00"
087400         MOVE    SQ-FS2-STATUS TO SQ-FS2-STATUS-COPY.
087500     ADD     1 TO XRECORD-NUMBER (1).
087600     IF SQ-FS2R1-F-G-120 NOT EQUAL FILE-RECORD-INFO-P1-120 (1)
087700         ADD     1 TO RECORDS-IN-ERROR.
087800     IF XRECORD-NUMBER (1) LESS THAN 100
087900         GO TO   SEQ-TEST-GF-08-LOOP.
088000*
088100 SEQ-TEST-GF-08-02.
088200     IF XRECORD-NUMBER (1) = 100
088300         PERFORM PASS
088400     ELSE
088500         MOVE    XRECORD-NUMBER (1) TO COMPUTED-18V0
088600         MOVE    100 TO CORRECT-18V0
088700         MOVE   "UNEXPECTED NUMBER OF RECORDS BEFORE EOF"
088800                    TO RE-MARK
088900         PERFORM FAIL.
089000     ADD     1 TO REC-CT.
089100     IF DECL-EXEC-COUNT = ZERO
089200         PERFORM PASS
089300     ELSE
089400         MOVE    DECL-EXEC-COUNT TO COMPUTED-18V0
089500         MOVE    1 TO CORRECT-18V0
089600         MOVE   "DECLARATIVE ENTERED AT LEAST ONCE" TO RE-MARK
089700         PERFORM FAIL.
089800     ADD     1 TO REC-CT.
089900     IF SQ-FS2-STATUS-COPY EQUAL TO "00"
090000         PERFORM PASS
090100     ELSE
090200         MOVE    SQ-FS2-STATUS-COPY TO COMPUTED-A
090300         MOVE   "00" TO CORRECT-A
090400         MOVE   "AT LEAST ONE UNSUCCESSFUL READ" TO RE-MARK
090500         PERFORM FAIL.
090600     ADD     1 TO REC-CT.
090700     IF RECORDS-IN-ERROR EQUAL TO ZERO
090800         PERFORM PASS
090900     ELSE
091000         MOVE    RECORDS-IN-ERROR TO COMPUTED-18V0
091100         MOVE    ZERO TO CORRECT-18V0
091200         MOVE   "INCORRECT RECORD CONTENTS FOUND" TO RE-MARK
091300         PERFORM FAIL.
091400 SEQ-TEST-08-END.
091500*
091600 SEQ-INIT-09.
091700     MOVE    1 TO REC-CT.
091800     MOVE    ZERO TO DECL-EXEC-COUNT.
091900     MOVE   "**"  TO SQ-FS2-STATUS.
092000     MOVE   "00"  TO SQ-FS2-STATUS-COPY.
092100     MOVE   "READ ..." TO FEATURE.
092200     MOVE   "SEQ-TEST-GF-09" TO PAR-NAME.
092300     GO TO   SEQ-TEST-GF-09.
092400 SEQ-DELETE-09.
092500     PERFORM DE-LETE.
092600     ADD     1 TO REC-CT.
092700     PERFORM DE-LETE.
092800     ADD     1 TO REC-CT.
092900     PERFORM DE-LETE.
093000     ADD     1 TO REC-CT.
093100     PERFORM DE-LETE.
093200     GO TO   SEQ-TEST-09-END.
093300 SEQ-TEST-GF-09.
093400     IF EOF-FLAG = 1
093500         GO TO   SEQ-TEST-GF-09-02.
093600 SEQ-TEST-GF-09-LOOP.
093700     READ    SQ-FS2.
093800     IF SQ-FS2-STATUS = "10"
093900         MOVE    1 TO EOF-FLAG
094000         GO TO   SEQ-TEST-GF-09-02.
094100     IF SQ-FS2-STATUS NOT = "00"
094200         MOVE    SQ-FS2-STATUS TO SQ-FS2-STATUS-COPY.
094300     ADD     1 TO XRECORD-NUMBER (1).
094400     IF SQ-FS2R1-F-G-120 NOT EQUAL FILE-RECORD-INFO-P1-120 (1)
094500         ADD     1 TO RECORDS-IN-ERROR.
094600     IF XRECORD-NUMBER (1) LESS THAN OR EQUAL TO 499
094700         GO TO   SEQ-TEST-GF-09-LOOP.
094800*
094900 SEQ-TEST-GF-09-02.
095000     IF XRECORD-NUMBER (1) = 500
095100         PERFORM PASS
095200     ELSE
095300         MOVE    XRECORD-NUMBER (1) TO COMPUTED-18V0
095400         MOVE    500 TO CORRECT-18V0
095500         MOVE   "UNEXPECTED NUMBER OF RECORDS BEFORE EOF"
095600                    TO RE-MARK
095700         PERFORM FAIL.
095800     ADD     1 TO REC-CT.
095900     IF DECL-EXEC-COUNT = ZERO
096000         PERFORM PASS
096100     ELSE
096200         MOVE    DECL-EXEC-COUNT TO COMPUTED-18V0
096300         MOVE    1 TO CORRECT-18V0
096400         MOVE   "DECLARATIVE ENTERED AT LEAST ONCE" TO RE-MARK
096500         PERFORM FAIL.
096600     ADD     1 TO REC-CT.
096700     IF SQ-FS2-STATUS-COPY EQUAL TO "00"
096800         PERFORM PASS
096900     ELSE
097000         MOVE    SQ-FS2-STATUS-COPY TO COMPUTED-A
097100         MOVE   "00" TO CORRECT-A
097200         MOVE   "AT LEAST ONE UNSUCCESSFUL READ" TO RE-MARK
097300         PERFORM FAIL.
097400     ADD     1 TO REC-CT.
097500     IF RECORDS-IN-ERROR EQUAL TO ZERO
097600         PERFORM PASS
097700     ELSE
097800         MOVE    RECORDS-IN-ERROR TO COMPUTED-18V0
097900         MOVE    ZERO TO CORRECT-18V0
098000         MOVE   "INCORRECT RECORD CONTENTS FOUND" TO RE-MARK
098100         PERFORM FAIL.
098200 SEQ-TEST-09-END.
098300*
098400 SEQ-INIT-10.
098500     MOVE    1 TO REC-CT.
098600     MOVE    1 TO DECL-EXEC-SW.
098700     MOVE   "**" TO SQ-FS2-STATUS.
098800     MOVE   "SEQ-TEST-GF-10" TO PAR-NAME.
098900     MOVE   "READ ... RAISING AT END" TO FEATURE.
099000     IF EOF-FLAG NOT EQUAL TO ZERO
099100         GO TO   SEQ-DELETE-10.
099200     GO TO   SEQ-TEST-GF-10.
099300 SEQ-DELETE-10.
099400     PERFORM DE-LETE.
099500     ADD     1 TO REC-CT.
099600     PERFORM DE-LETE.
099700     GO TO   SEQ-TEST-10-END.
099800 SEQ-TEST-GF-10.
099900     READ    SQ-FS2.
100000     IF DECL-EXEC-SW = 0
100100         PERFORM PASS
100200     ELSE
100300         MOVE    DECL-EXEC-SW TO COMPUTED-18V0
100400         MOVE    ZERO TO CORRECT-18V0
100500         MOVE   "DECLARATIVE NOT EXECUTED" TO RE-MARK
100600         MOVE   "VII-46, 4.4.4(10)C" TO ANSI-REFERENCE
100700         PERFORM FAIL.
100800     ADD     1 TO REC-CT.
100900     IF SQ-FS2-STATUS = "10"
101000         PERFORM PASS
101100     ELSE
101200         MOVE    SQ-FS2-STATUS TO COMPUTED-A
101300         MOVE   "10" TO CORRECT-A
101400         MOVE   "I-O STATUS FOR END OF FILE EXPECTED" TO RE-MARK
101500         PERFORM FAIL.
101600 SEQ-TEST-10-END.
101700*
101800 SEQ-INIT-11.
101900     MOVE   "SEQ-TEST-GF-11" TO PAR-NAME.
102000     MOVE   "CLOSE FILE FROM INPUT" TO FEATURE.
102100     MOVE    1 TO REC-CT.
102200     MOVE    1 TO DECL-EXEC-SW.
102300     MOVE   "**" TO SQ-FS2-STATUS.
102400     GO TO   SEQ-TEST-GF-11.
102500 SEQ-DELETE-11.
102600     PERFORM DE-LETE.
102700     ADD     1 TO REC-CT.
102800     PERFORM DE-LETE.
102900     GO TO   SEQ-TEST-11-END.
103000 SEQ-TEST-GF-11.
103100     CLOSE SQ-FS2.
103200     IF DECL-EXEC-SW = 1
103300         PERFORM PASS
103400     ELSE
103500         MOVE    DECL-EXEC-SW TO COMPUTED-18V0
103600         MOVE    1 TO CORRECT-18V0
103700         MOVE   "UNEXPECTED EXECUTION OF DECLARATIVE ON CLOSE"
103800                    TO RE-MARK
103900         PERFORM FAIL.
104000     ADD     1 TO REC-CT.
104100     IF SQ-FS2-STATUS = "00"
104200         PERFORM PASS
104300     ELSE
104400         MOVE    SQ-FS2-STATUS TO COMPUTED-A
104500         MOVE   "00" TO CORRECT-A
104600         MOVE   "I-O STATUS AFTER CLOSE INDICATES FAILURE"
104700                    TO RE-MARK
104800         PERFORM FAIL.
104900 SEQ-TEST-11-END.
105000*
105100 TERMINATE-ROUTINE.
105200     EXIT.
105300 CCVS-EXIT SECTION.
105400 CCVS-999999.
105500     GO TO CLOSE-FILES.
