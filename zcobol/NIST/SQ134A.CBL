000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ134A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
000900*                             REVISED 1986, AUGUST             *
001000*                                                              *
001100*    CREATION DATE     /     VALIDATION DATE                   *
001200*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001300*                                                              *
001400****************************************************************
001500*                                                              *
001600*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001700*                                                              *
001800*            X-14   SEQUENTIAL MASS STORAGE FILE               *
001900*            X-55   SYSTEM PRINTER                             *
002000*            X-82   SOURCE-COMPUTER                            *
002100*            X-83   OBJECT-COMPUTER.                           *
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    THIS PROGRAM OPENS FOR OUTPUT A FILE WHICH IS ASSIGNED    *
002600*    TO A MASS STORAGE MEDIUM, WRITES ONE RECORD AND CLOSES    *
002700*    THE FILE.  TWO RECORD SIZES ARE DEFINED FOR THE FILE, BY  *
002800*    MEANS OF THE RECORD CONTAINS CLAUSE.  THE FILE IS THEN    *
002900*    OPENED FOR I-O, AND A READ STATEMENT AND A REWRITE        *
003000*    STATEMENT ARE EXECUTED.  THE REWRITE STATEMENT REFERENCES *
003100*    A RECORD OF A DIFFERENT SIZE TO THAT REFERENCED IN THE    *
003200*    WRITE STATEMENT, AND SHOULD CAUSE AN EXCEPTION CONDITION  *
003300*    WITH I-O STATUS "44".  THIS LOGIC ERROR SHOULD CAUSE      *
003400*    ENTRY TO THE APPLICABLE ERROR DECLARATIVE.                *
003500*                                                              *
003600*    THIS PROGRAM SHOULD BE RUN ONLY WHEN AN IMPLEMENTATION    *
003700*    PROVIDES VARIABLE LENGTH RECORDS FOR THE RECORDS CONTAINS *
003800*    INTEGER TO INTEGER CLAUSE                                 *
003900*                                                              *
004000*    THIS PROGRAM HAS BEEN SPLIT FROM V2.0 ONWARDS.            *
004100*    THE NEW PROGRAM IS SQ145A.                                *
004200****************************************************************
004300*
004400 ENVIRONMENT DIVISION.
004500 CONFIGURATION SECTION.
004600 SOURCE-COMPUTER.
004700     XXXXX082.
004800 OBJECT-COMPUTER.
004900     XXXXX083.
005000*
005100 INPUT-OUTPUT SECTION.
005200 FILE-CONTROL.
005300     SELECT PRINT-FILE ASSIGN TO
005400     XXXXX055.
005500*
005600P    SELECT RAW-DATA   ASSIGN TO
005700P    XXXXX062
005800P          ORGANIZATION IS INDEXED
005900P          ACCESS MODE  IS RANDOM
006000P          RECORD-KEY   IS RAW-DATA-KEY.
006100P
006200     SELECT SQ-FS4
006300            ASSIGN
006400     XXXXX014
006500            STATUS SQ-FS4-STATUS OF STATUS-GROUP
006600            SEQUENTIAL
006700            .
006800*
006900*
007000 DATA DIVISION.
007100 FILE SECTION.
007200 FD  PRINT-FILE
007300C    LABEL RECORDS
007400C    XXXXX084
007500C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007600               .
007700 01  PRINT-REC    PICTURE X(120).
007800 01  DUMMY-RECORD PICTURE X(120).
007900P
008000PFD  RAW-DATA.
008100P01  RAW-DATA-SATZ.
008200P    05  RAW-DATA-KEY        PIC X(6).
008300P    05  C-DATE              PIC 9(6).
008400P    05  C-TIME              PIC 9(8).
008500P    05  NO-OF-TESTS         PIC 99.
008600P    05  C-OK                PIC 999.
008700P    05  C-ALL               PIC 999.
008800P    05  C-FAIL              PIC 999.
008900P    05  C-DELETED           PIC 999.
009000P    05  C-INSPECT           PIC 999.
009100P    05  C-NOTE              PIC X(13).
009200P    05  C-INDENT            PIC X.
009300P    05  C-ABORT             PIC X(8).
009400*
009500 FD  SQ-FS4
009600C    LABEL RECORD IS STANDARD
009700     BLOCK  120 CHARACTERS
009800     RECORD CONTAINS 120 TO 138 CHARACTERS
009900                .
010000 01  SQ-FS4R1-F-G-120.
010100        05 FFILE-RECORD-INFO-P1-120.
010200           07 FILLER              PIC X(5).
010300           07 FFILE-NAME          PIC X(6).
010400           07 FILLER              PIC X(8).
010500           07 FRECORD-NAME        PIC X(6).
010600           07 FILLER              PIC X(1).
010700           07 FREELUNIT-NUMBER    PIC 9(1).
010800           07 FILLER              PIC X(7).
010900           07 FRECORD-NUMBER      PIC 9(6).
011000           07 FILLER              PIC X(6).
011100           07 FUPDATE-NUMBER      PIC 9(2).
011200           07 FILLER              PIC X(5).
011300           07 FODO-NUMBER         PIC 9(4).
011400           07 FILLER              PIC X(5).
011500           07 FPROGRAM-NAME       PIC X(5).
011600           07 FILLER              PIC X(7).
011700           07 FRECORD-LENGTH      PIC 9(6).
011800           07 FILLER              PIC X(7).
011900           07 FCHARS-OR-RECORDS   PIC X(2).
012000           07 FILLER              PIC X(1).
012100           07 FBLOCK-SIZE         PIC 9(4).
012200           07 FILLER              PIC X(6).
012300           07 FRECORDS-IN-FILE    PIC 9(6).
012400           07 FILLER              PIC X(5).
012500           07 FFILE-ORGANIZATION  PIC X(2).
012600           07 FILLER              PIC X(6).
012700           07 FLABEL-TYPE         PIC X(1).
012800*
012900 01  SQ-FS4R2-F-G-138.
013000     03  FILLER PIC X(120).
013100     03  EXT-18 PIC X(18).
013200*
013300 WORKING-STORAGE SECTION.
013400*
013500***************************************************************
013600*                                                             *
013700*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
013800*                                                             *
013900***************************************************************
014000*
014100 01  STATUS-GROUP.
014200     04  SQ-FS4-STATUS.
014300         07  SQ-FS4-KEY-1   PIC X.
014400         07  SQ-FS4-KEY-2   PIC X.
014500*
014600 01  DELETE-SW.
014700     03  DELETE-SW-1 PIC X.
014800     03  DELETE-SW-1-GROUP.
014900         05  DELETE-SW-2 PIC X.
015000*
015100 01  DECL-EXEC-I-O PIC X(12).
015200*
015300 01  DECL-EXEC-SW PIC X.
015400*
015500***************************************************************
015600*                                                             *
015700*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
015800*                                                             *
015900***************************************************************
016000*
016100 01  REC-SKEL-SUB   PIC 99.
016200*
016300 01  FILE-RECORD-INFORMATION-REC.
016400     03 FILE-RECORD-INFO-SKELETON.
016500        05 FILLER                 PICTURE X(48)       VALUE
016600             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
016700        05 FILLER                 PICTURE X(46)       VALUE
016800             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
016900        05 FILLER                 PICTURE X(26)       VALUE
017000             ",LFIL=000000,ORG=  ,LBLR= ".
017100        05 FILLER                 PICTURE X(37)       VALUE
017200             ",RECKEY=                             ".
017300        05 FILLER                 PICTURE X(38)       VALUE
017400             ",ALTKEY1=                             ".
017500        05 FILLER                 PICTURE X(38)       VALUE
017600             ",ALTKEY2=                             ".
017700        05 FILLER                 PICTURE X(7)        VALUE SPACE.
017800     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
017900        05 FILE-RECORD-INFO-P1-120.
018000           07 FILLER              PIC X(5).
018100           07 XFILE-NAME          PIC X(6).
018200           07 FILLER              PIC X(8).
018300           07 XRECORD-NAME        PIC X(6).
018400           07 FILLER              PIC X(1).
018500           07 REELUNIT-NUMBER     PIC 9(1).
018600           07 FILLER              PIC X(7).
018700           07 XRECORD-NUMBER      PIC 9(6).
018800           07 FILLER              PIC X(6).
018900           07 UPDATE-NUMBER       PIC 9(2).
019000           07 FILLER              PIC X(5).
019100           07 ODO-NUMBER          PIC 9(4).
019200           07 FILLER              PIC X(5).
019300           07 XPROGRAM-NAME       PIC X(5).
019400           07 FILLER              PIC X(7).
019500           07 XRECORD-LENGTH      PIC 9(6).
019600           07 FILLER              PIC X(7).
019700           07 CHARS-OR-RECORDS    PIC X(2).
019800           07 FILLER              PIC X(1).
019900           07 XBLOCK-SIZE         PIC 9(4).
020000           07 FILLER              PIC X(6).
020100           07 RECORDS-IN-FILE     PIC 9(6).
020200           07 FILLER              PIC X(5).
020300           07 XFILE-ORGANIZATION  PIC X(2).
020400           07 FILLER              PIC X(6).
020500           07 XLABEL-TYPE         PIC X(1).
020600        05 FILE-RECORD-INFO-P121-240.
020700           07 FILLER              PIC X(8).
020800           07 XRECORD-KEY         PIC X(29).
020900           07 FILLER              PIC X(9).
021000           07 ALTERNATE-KEY1      PIC X(29).
021100           07 FILLER              PIC X(9).
021200           07 ALTERNATE-KEY2      PIC X(29).
021300           07 FILLER              PIC X(7).
021400*
021500 01  TEST-RESULTS.
021600     02 FILLER              PIC X      VALUE SPACE.
021700     02  PAR-NAME.
021800       03 FILLER              PIC X(14)  VALUE SPACE.
021900       03 PARDOT-X            PIC X      VALUE SPACE.
022000       03 DOTVALUE            PIC 99     VALUE ZERO.
022100     02 FILLER              PIC X      VALUE SPACE.
022200     02 FEATURE             PIC X(24)  VALUE SPACE.
022300     02 FILLER              PIC X      VALUE SPACE.
022400     02 P-OR-F              PIC X(5)   VALUE SPACE.
022500     02 FILLER              PIC X(9)   VALUE SPACE.
022600     02 RE-MARK             PIC X(61).
022700 01  TEST-COMPUTED.
022800   02 FILLER  PIC X(30)  VALUE SPACE.
022900   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
023000   02 COMPUTED-X.
023100     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
023200     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
023300     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
023400     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
023500     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
023600     03       CM-18V0 REDEFINES COMPUTED-A.
023700        04 COMPUTED-18V0                   PIC -9(18).
023800        04 FILLER                          PIC X.
023900     03 FILLER PIC X(50) VALUE SPACE.
024000 01  TEST-CORRECT.
024100     02 FILLER PIC X(30) VALUE SPACE.
024200     02 FILLER PIC X(17) VALUE "       CORRECT =".
024300     02 CORRECT-X.
024400     03 CORRECT-A                  PIC X(20) VALUE SPACE.
024500     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
024600     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
024700     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
024800     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
024900     03      CR-18V0 REDEFINES CORRECT-A.
025000         04 CORRECT-18V0                     PIC -9(18).
025100         04 FILLER                           PIC X.
025200     03 FILLER PIC X(2) VALUE SPACE.
025300     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
025400*
025500 01  CCVS-C-1.
025600     02 FILLER  PIC IS X        VALUE  SPACE.
025700     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
025800     02 FILLER  PIC IS X        VALUE  SPACE.
025900     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
026000     02 FILLER  PIC IS X        VALUE  SPACE.
026100     02 FILLER  PIC IS X(5)     VALUE "PASS ".
026200     02 FILLER  PIC IS X(9)     VALUE  SPACE.
026300     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
026400 01  CCVS-C-2.
026500     02 FILLER  PIC X(19)  VALUE  SPACE.
026600     02 FILLER  PIC X(6)   VALUE "TESTED".
026700     02 FILLER  PIC X(19)  VALUE  SPACE.
026800     02 FILLER  PIC X(4)   VALUE "FAIL".
026900     02 FILLER  PIC X(72)  VALUE  SPACE.
027000*
027100 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
027200 01  REC-CT            PIC 99       VALUE ZERO.
027300 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
027400 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
027500 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
027600 01  PASS-COUNTER      PIC 999      VALUE ZERO.
027700 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
027800 01  ERROR-HOLD        PIC 999      VALUE ZERO.
027900 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
028000 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
028100 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
028200 01  CCVS-H-1.
028300     02  FILLER          PIC X(39)    VALUE SPACES.
028400     02  FILLER          PIC X(42)    VALUE
028500     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
028600     02  FILLER          PIC X(39)    VALUE SPACES.
028700 01  CCVS-H-2A.
028800   02  FILLER            PIC X(40)  VALUE SPACE.
028900   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
029000   02  FILLER            PIC XXXX   VALUE
029100     "4.2 ".
029200   02  FILLER            PIC X(28)  VALUE
029300            " COPY - NOT FOR DISTRIBUTION".
029400   02  FILLER            PIC X(41)  VALUE SPACE.
029500*
029600 01  CCVS-H-2B.
029700   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
029800   02  TEST-ID           PIC X(9).
029900   02  FILLER            PIC X(4)   VALUE " IN ".
030000   02  FILLER            PIC X(12)  VALUE
030100     " HIGH       ".
030200   02  FILLER            PIC X(22)  VALUE
030300            " LEVEL VALIDATION FOR ".
030400   02  FILLER            PIC X(58)  VALUE
030500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
030600 01  CCVS-H-3.
030700     02  FILLER          PIC X(34)  VALUE
030800            " FOR OFFICIAL USE ONLY    ".
030900     02  FILLER          PIC X(58)  VALUE
031000     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
031100     02  FILLER          PIC X(28)  VALUE
031200            "  COPYRIGHT   1985,1986 ".
031300 01  CCVS-E-1.
031400     02 FILLER           PIC X(52)  VALUE SPACE.
031500     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
031600     02 ID-AGAIN         PIC X(9).
031700     02 FILLER           PIC X(45)  VALUE SPACES.
031800 01  CCVS-E-2.
031900     02  FILLER          PIC X(31)  VALUE SPACE.
032000     02  FILLER          PIC X(21)  VALUE SPACE.
032100     02  CCVS-E-2-2.
032200         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
032300         03 FILLER         PIC X      VALUE SPACE.
032400         03 ENDER-DESC     PIC X(44)  VALUE
032500            "ERRORS ENCOUNTERED".
032600 01  CCVS-E-3.
032700     02  FILLER          PIC X(22)  VALUE
032800            " FOR OFFICIAL USE ONLY".
032900     02  FILLER          PIC X(12)  VALUE SPACE.
033000     02  FILLER          PIC X(58)  VALUE
033100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
033200     02  FILLER          PIC X(8)   VALUE SPACE.
033300     02  FILLER          PIC X(20)  VALUE
033400             " COPYRIGHT 1985,1986".
033500 01  CCVS-E-4.
033600     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
033700     02 FILLER           PIC X(4)   VALUE " OF ".
033800     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
033900     02 FILLER           PIC X(40)  VALUE
034000      "  TESTS WERE EXECUTED SUCCESSFULLY".
034100 01  XXINFO.
034200     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
034300     02 INFO-TEXT.
034400       04 FILLER             PIC X(8)   VALUE SPACE.
034500       04 XXCOMPUTED         PIC X(20).
034600       04 FILLER             PIC X(5)   VALUE SPACE.
034700       04 XXCORRECT          PIC X(20).
034800     02 INF-ANSI-REFERENCE PIC X(48).
034900 01  HYPHEN-LINE.
035000     02 FILLER  PIC IS X VALUE IS SPACE.
035100     02 FILLER  PIC IS X(65)    VALUE IS "************************
035200-    "*****************************************".
035300     02 FILLER  PIC IS X(54)    VALUE IS "************************
035400-    "******************************".
035500 01  CCVS-PGM-ID  PIC X(9)   VALUE
035600     "SQ134A".
035700*
035800*
035900 PROCEDURE DIVISION.
036000 DECLARATIVES.
036100*
036200 SECT-SQ134A-0001 SECTION.
036300     USE AFTER EXCEPTION PROCEDURE I-O.
036400 I-O-ERROR-PROCESS.
036500     MOVE   "EXECUTED" TO DECL-EXEC-I-O.
036600     IF DECL-EXEC-SW NOT = SPACE
036700         GO TO   END-DECLS.
036800*
036900     MOVE    1 TO REC-CT.
037000     MOVE   "REWRITE SHORTER RECORD"  TO FEATURE.
037100     MOVE   "DCL-REWRITE-01" TO PAR-NAME.
037200     GO TO   DCL-REWRITE-01-01.
037300 DECL-DELETE-01-01.
037400     PERFORM DECL-DE-LETE.
037500     GO TO   DECL-TEST-01-01-END.
037600 DCL-REWRITE-01-01.
037700     IF SQ-FS4-STATUS = "44"
037800         PERFORM DECL-PASS
037900     ELSE
038000         MOVE    SQ-FS4-STATUS TO COMPUTED-A
038100         MOVE   "44" TO CORRECT-A
038200         MOVE   "UNEXPECTED I-O STATUS ON FAILED REWRITE"
038300                   TO RE-MARK
038400         MOVE   "VII-4, VII-48,4.5.4(2)" TO ANSI-REFERENCE
038500         PERFORM DECL-FAIL.
038600 DECL-TEST-01-01-END.
038700*
038800     ADD     1 TO REC-CT.
038900     GO TO   DCL-REWRITE-01-02.
039000 DECL-DELETE-01-02.
039100     PERFORM DECL-DE-LETE.
039200     GO TO   DECL-TEST-01-02-END.
039300 DCL-REWRITE-01-02.
039400     IF SQ-FS4R1-F-G-120 = FILE-RECORD-INFO-P1-120 (1)
039500         PERFORM DECL-PASS
039600     ELSE
039700         MOVE   "FIRST 120 CHARACTERS OF RECORD AREA CHANGED"
039800                   TO RE-MARK
039900         MOVE   "VII-4, VII-49,4.5.4(9)" TO ANSI-REFERENCE
040000         PERFORM DECL-FAIL.
040100 DECL-TEST-01-02-END.
040200*
040300     ADD     1 TO REC-CT.
040400     GO TO   DCL-REWRITE-01-03.
040500 DECL-DELETE-01-03.
040600     PERFORM DECL-DE-LETE.
040700     GO TO   DECL-TEST-01-03-END.
040800 DCL-REWRITE-01-03.
040900     IF EXT-18 = "ABCDEFGHIJKLMNOPQR"
041000         PERFORM DECL-PASS
041100     ELSE
041200         MOVE    EXT-18 TO COMPUTED-A
041300         MOVE   "ABCDEFGHIJKLMNOPQR" TO CORRECT-A
041400         MOVE   "LAST 18 CHARACTERS OF RECORD CHANGED"
041500                   TO RE-MARK
041600         MOVE   "VII-4, VII-49,4.5.4(9)" TO ANSI-REFERENCE
041700         PERFORM DECL-FAIL.
041800 DECL-TEST-01-03-END.
041900*
042000     PERFORM DECL-WRITE-LINE.
042100     MOVE   "ABNORMAL TERMINATION AT THIS POINT IS ACCEPTABLE"
042200               TO DUMMY-RECORD.
042300     PERFORM DECL-WRITE-LINE 3 TIMES.
042400     GO TO   END-DECLS.
042500*
042600*
042700 DECL-PASS.
042800     MOVE   "PASS " TO P-OR-F.
042900     ADD     1 TO PASS-COUNTER.
043000     PERFORM DECL-PRINT-DETAIL.
043100*
043200 DECL-FAIL.
043300     MOVE   "FAIL*" TO P-OR-F.
043400     ADD     1 TO ERROR-COUNTER.
043500     PERFORM DECL-PRINT-DETAIL.
043600*
043700 DECL-DE-LETE.
043800     MOVE   "****TEST DELETED****" TO RE-MARK.
043900     MOVE   "*****" TO P-OR-F.
044000     ADD     1 TO DELETE-COUNTER.
044100     PERFORM DECL-PRINT-DETAIL.
044200*
044300 DECL-PRINT-DETAIL.
044400     IF REC-CT NOT EQUAL TO ZERO
044500             MOVE "." TO PARDOT-X
044600             MOVE REC-CT TO DOTVALUE.
044700     MOVE    TEST-RESULTS TO PRINT-REC.
044800     PERFORM DECL-WRITE-LINE.
044900     IF P-OR-F EQUAL TO "FAIL*"
045000         PERFORM DECL-WRITE-LINE
045100         PERFORM DECL-FAIL-ROUTINE THRU DECL-FAIL-EX
045200     ELSE
045300         PERFORM DECL-BAIL THRU DECL-BAIL-EX.
045400     MOVE    SPACE TO P-OR-F.
045500     MOVE    SPACE TO COMPUTED-X.
045600     MOVE    SPACE TO CORRECT-X.
045700     IF REC-CT EQUAL TO ZERO
045800         MOVE    SPACE TO PAR-NAME.
045900     MOVE    SPACE TO RE-MARK.
046000*
046100 DECL-WRITE-LINE.
046200     ADD     1 TO RECORD-COUNT.
046300Y    IF RECORD-COUNT GREATER 50
046400Y        MOVE    DUMMY-RECORD TO DUMMY-HOLD
046500Y        MOVE    SPACE TO DUMMY-RECORD
046600Y        WRITE   DUMMY-RECORD AFTER ADVANCING PAGE
046700Y        MOVE    CCVS-C-1 TO DUMMY-RECORD PERFORM DECL-WRT-LN
046800Y        MOVE    CCVS-C-2 TO DUMMY-RECORD
046900Y        PERFORM DECL-WRT-LN 2 TIMES
047000Y        MOVE    HYPHEN-LINE TO DUMMY-RECORD
047100Y        PERFORM DECL-WRT-LN
047200Y        MOVE    DUMMY-HOLD TO DUMMY-RECORD
047300Y        MOVE    ZERO TO RECORD-COUNT.
047400     PERFORM DECL-WRT-LN.
047500*
047600 DECL-WRT-LN.
047700     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
047800     MOVE    SPACE TO DUMMY-RECORD.
047900*
048000 DECL-FAIL-ROUTINE.
048100     IF COMPUTED-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
048200     IF CORRECT-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
048300     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
048400     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
048500     MOVE    XXINFO TO DUMMY-RECORD.
048600     PERFORM DECL-WRITE-LINE 2 TIMES.
048700     MOVE    SPACES TO INF-ANSI-REFERENCE.
048800     GO TO   DECL-FAIL-EX.
048900 DECL-FAIL-WRITE.
049000     MOVE    TEST-COMPUTED TO PRINT-REC
049100     PERFORM DECL-WRITE-LINE
049200     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
049300     MOVE    TEST-CORRECT TO PRINT-REC
049400     PERFORM DECL-WRITE-LINE 2 TIMES.
049500     MOVE    SPACES TO COR-ANSI-REFERENCE.
049600 DECL-FAIL-EX.
049700     EXIT.
049800*
049900 DECL-BAIL.
050000     IF COMPUTED-A NOT EQUAL TO SPACE GO TO DECL-BAIL-WRITE.
050100     IF CORRECT-A EQUAL TO SPACE GO TO DECL-BAIL-EX.
050200 DECL-BAIL-WRITE.
050300     MOVE    CORRECT-A TO XXCORRECT.
050400     MOVE    COMPUTED-A TO XXCOMPUTED.
050500     MOVE    XXINFO TO DUMMY-RECORD.
050600     PERFORM DECL-WRITE-LINE 2 TIMES.
050700 DECL-BAIL-EX.
050800     EXIT.
050900*
051000 END-DECLS.
051100 END DECLARATIVES.
051200*
051300*
051400 CCVS1 SECTION.
051500 OPEN-FILES.
051600P    OPEN    I-O RAW-DATA.
051700P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
051800P    READ    RAW-DATA INVALID KEY GO TO END-E-1.
051900P    MOVE   "ABORTED "   TO C-ABORT.
052000P    ADD     1           TO C-NO-OF-TESTS.
052100P    ACCEPT  C-DATE      FROM DATE.
052200P    ACCEPT  C-TIME      FROM TIME.
052300P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
052400PEND-E-1.
052500P    CLOSE   RAW-DATA.
052600     OPEN    OUTPUT PRINT-FILE.
052700     MOVE    CCVS-PGM-ID TO TEST-ID.
052800     MOVE    CCVS-PGM-ID TO ID-AGAIN.
052900     MOVE    SPACE TO TEST-RESULTS.
053000     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
053100     MOVE    ZERO TO REC-SKEL-SUB.
053200     PERFORM CCVS-INIT-FILE 10 TIMES.
053300     GO TO CCVS1-EXIT.
053400*
053500 CCVS-INIT-FILE.
053600     ADD     1 TO REC-SKL-SUB.
053700     MOVE    FILE-RECORD-INFO-SKELETON TO
053800                  FILE-RECORD-INFO (REC-SKL-SUB).
053900*
054000 CLOSE-FILES.
054100     PERFORM END-ROUTINE THRU END-ROUTINE-13.
054200     CLOSE   PRINT-FILE.
054300P    OPEN    I-O RAW-DATA.
054400P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
054500P    READ    RAW-DATA INVALID KEY GO TO END-E-2.
054600P    MOVE   "OK.     " TO C-ABORT.
054700P    MOVE    PASS-COUNTER  TO C-OK.
054800P    MOVE    ERROR-HOLD    TO C-ALL.
054900P    MOVE    ERROR-COUNTER TO C-FAIL.
055000P    MOVE    DELETE-CNT    TO C-DELETED.
055100P    MOVE    INSPECT-COUNTER TO C-INSPECT.
055200P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
055300PEND-E-2.
055400P    CLOSE   RAW-DATA.
055500 TERMINATE-CCVS.
055600S    EXIT    PROGRAM.
055700     STOP    RUN.
055800*
055900 INSPT.
056000     MOVE   "INSPT" TO P-OR-F.
056100     ADD     1 TO INSPECT-COUNTER.
056200     PERFORM PRINT-DETAIL.
056300*
056400 PASS.
056500     MOVE   "PASS " TO P-OR-F.
056600     ADD     1 TO PASS-COUNTER.
056700     PERFORM PRINT-DETAIL.
056800*
056900 FAIL.
057000     MOVE   "FAIL*" TO P-OR-F.
057100     ADD     1 TO ERROR-COUNTER.
057200     PERFORM PRINT-DETAIL.
057300*
057400 DE-LETE.
057500     MOVE   "****TEST DELETED****" TO RE-MARK.
057600     MOVE   "*****" TO P-OR-F.
057700     ADD     1 TO DELETE-COUNTER.
057800     PERFORM PRINT-DETAIL.
057900*
058000 PRINT-DETAIL.
058100     IF REC-CT NOT EQUAL TO ZERO
058200         MOVE   "." TO PARDOT-X
058300         MOVE    REC-CT TO DOTVALUE.
058400     MOVE    TEST-RESULTS TO PRINT-REC.
058500     PERFORM WRITE-LINE.
058600     IF P-OR-F EQUAL TO "FAIL*"
058700         PERFORM WRITE-LINE
058800         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
058900     ELSE
059000         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
059100     MOVE    SPACE TO P-OR-F.
059200     MOVE    SPACE TO COMPUTED-X.
059300     MOVE    SPACE TO CORRECT-X.
059400     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
059500     MOVE    SPACE TO RE-MARK.
059600*
059700 HEAD-ROUTINE.
059800     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
059900     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
060000     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
060100     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
060200 COLUMN-NAMES-ROUTINE.
060300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
060400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
060500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
060600 END-ROUTINE.
060700     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
060800     PERFORM WRITE-LINE 5 TIMES.
060900 END-RTN-EXIT.
061000     MOVE    CCVS-E-1 TO DUMMY-RECORD.
061100     PERFORM WRITE-LINE 2 TIMES.
061200*
061300 END-ROUTINE-1.
061400     ADD     ERROR-COUNTER   TO ERROR-HOLD
061500     ADD     INSPECT-COUNTER TO ERROR-HOLD.
061600     ADD     DELETE-COUNTER  TO ERROR-HOLD.
061700     ADD     PASS-COUNTER    TO ERROR-HOLD.
061800     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
061900     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
062000     MOVE    CCVS-E-4        TO CCVS-E-2-2.
062100     MOVE    CCVS-E-2        TO DUMMY-RECORD
062200     PERFORM WRITE-LINE.
062300     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
062400     IF ERROR-COUNTER IS EQUAL TO ZERO
062500         MOVE   "NO " TO ERROR-TOTAL
062600     ELSE
062700         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
062800     MOVE    CCVS-E-2 TO DUMMY-RECORD.
062900     PERFORM WRITE-LINE.
063000 END-ROUTINE-13.
063100     IF DELETE-COUNTER IS EQUAL TO ZERO
063200         MOVE   "NO " TO ERROR-TOTAL
063300     ELSE
063400         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
063500     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
063600     MOVE    CCVS-E-2 TO DUMMY-RECORD.
063700     PERFORM WRITE-LINE.
063800     IF INSPECT-COUNTER EQUAL TO ZERO
063900         MOVE   "NO " TO ERROR-TOTAL
064000     ELSE
064100         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
064200     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
064300     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
064400     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
064500*
064600 WRITE-LINE.
064700     ADD     1 TO RECORD-COUNT.
064800Y    IF RECORD-COUNT GREATER 50
064900Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
065000Y        MOVE  SPACE TO DUMMY-RECORD
065100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
065200Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
065300Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
065400Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
065500Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
065600Y        MOVE  ZERO TO RECORD-COUNT.
065700     PERFORM WRT-LN.
065800*
065900 WRT-LN.
066000     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
066100     MOVE    SPACE TO DUMMY-RECORD.
066200 BLANK-LINE-PRINT.
066300     PERFORM WRT-LN.
066400 FAIL-ROUTINE.
066500     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
066600     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
066700     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
066800     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
066900     MOVE    XXINFO TO DUMMY-RECORD.
067000     PERFORM WRITE-LINE 2 TIMES.
067100     MOVE    SPACES TO INF-ANSI-REFERENCE.
067200     GO TO   FAIL-ROUTINE-EX.
067300 FAIL-ROUTINE-WRITE.
067400     MOVE    TEST-COMPUTED  TO PRINT-REC
067500     PERFORM WRITE-LINE
067600     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
067700     MOVE    TEST-CORRECT   TO PRINT-REC
067800     PERFORM WRITE-LINE 2 TIMES.
067900     MOVE    SPACES         TO COR-ANSI-REFERENCE.
068000 FAIL-ROUTINE-EX.
068100     EXIT.
068200 BAIL-OUT.
068300     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
068400     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
068500 BAIL-OUT-WRITE.
068600     MOVE    CORRECT-A      TO XXCORRECT.
068700     MOVE    COMPUTED-A     TO XXCOMPUTED.
068800     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
068900     MOVE    XXINFO TO DUMMY-RECORD.
069000     PERFORM WRITE-LINE 2 TIMES.
069100     MOVE    SPACES TO INF-ANSI-REFERENCE.
069200 BAIL-OUT-EX.
069300     EXIT.
069400 CCVS1-EXIT.
069500     EXIT.
069600*
069700****************************************************************
069800*                                                              *
069900*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
070000*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
070100*                                                              *
070200****************************************************************
070300*
070400 SECT-SQ134A-0002 SECTION.
070500 STA-INIT.
070600     MOVE    SPACE TO DELETE-SW.
070700*
070800     MOVE   "SQ-FS4" TO XFILE-NAME (1).
070900     MOVE   "R1-F-G" TO XRECORD-NAME (1).
071000     MOVE    CCVS-PGM-ID TO XPROGRAM-NAME (1).
071100     MOVE    120 TO XRECORD-LENGTH (1).
071200     MOVE   "CC" TO CHARS-OR-RECORDS (1).
071300     MOVE    1   TO XBLOCK-SIZE (1).
071400     MOVE    1   TO RECORDS-IN-FILE (1).
071500     MOVE   "SQ" TO XFILE-ORGANIZATION (1).
071600     MOVE   "S"  TO XLABEL-TYPE (1).
071700*
071800*    OPEN THE FILE IN THE OUTPUT MODE
071900*
072000 SEQ-INIT-01.
072100     MOVE    0 TO REC-CT.
072200     MOVE   "*" TO DECL-EXEC-SW.
072300     MOVE   "**" TO SQ-FS4-STATUS.
072400     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
072500     MOVE    ZERO TO XRECORD-NUMBER (1).
072600     MOVE   "OPEN, CREATE FILE"  TO FEATURE.
072700     MOVE   "SEQ-TEST-OP-01" TO PAR-NAME.
072800     GO TO   SEQ-TEST-OP-01.
072900 SEQ-DELETE-01.
073000     MOVE   "*" TO DELETE-SW-1.
073100     GO TO   SEQ-DELETE-01-01.
073200 SEQ-TEST-OP-01.
073300     OPEN    OUTPUT SQ-FS4.
073400*
073500*    CHECK I-O STATUS RETURNED FROM OPEN OUTPUT
073600*
073700     ADD    1 TO REC-CT.
073800     IF DELETE-SW NOT = SPACE
073900         GO TO   SEQ-DELETE-01-01.
074000     GO TO   SEQ-TEST-OP-01-01.
074100 SEQ-DELETE-01-01.
074200     PERFORM DE-LETE.
074300     GO TO   SEQ-TEST-01-01-END.
074400 SEQ-TEST-OP-01-01.
074500     IF SQ-FS4-STATUS = "00"
074600         PERFORM PASS
074700     ELSE
074800         MOVE    SQ-FS4-STATUS TO COMPUTED-A
074900         MOVE   "00" TO CORRECT-A
075000         MOVE   "UNEXPECTED ERROR CODE FROM OPEN OUTPUT"
075100                   TO RE-MARK
075200         MOVE   "VII-3, VII-43" TO ANSI-REFERENCE
075300         PERFORM FAIL.
075400 SEQ-TEST-01-01-END.
075500*
075600*    CHECK EXECUTION OF I-O DECLARATIVE
075700*
075800     ADD     1 TO REC-CT.
075900     IF DELETE-SW NOT = SPACE
076000         GO TO   SEQ-DELETE-01-02.
076100     GO TO   SEQ-TEST-OP-01-02.
076200 SEQ-DELETE-01-02.
076300     PERFORM DE-LETE.
076400     GO TO   SEQ-TEST-01-02-END.
076500 SEQ-TEST-OP-01-02.
076600     IF DECL-EXEC-I-O = "NOT EXECUTED"
076700         PERFORM PASS
076800     ELSE
076900         MOVE    DECL-EXEC-I-O TO COMPUTED-A
077000         MOVE   "NOT EXECUTED" TO CORRECT-A
077100         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
077200                   TO RE-MARK
077300         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
077400         PERFORM FAIL.
077500 SEQ-TEST-01-02-END.
077600*
077700*
077800*    A NEW FILE IS OPEN.  WE NOW WRITE ONE RECORD OF 138 CHARS.
077900*
078000 SEQ-INIT-02.
078100     MOVE    0 TO REC-CT.
078200     MOVE   "*" TO DECL-EXEC-SW.
078300     ADD     1 TO XRECORD-NUMBER (1).
078400     MOVE   "**" TO SQ-FS4-STATUS.
078500     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
078600     MOVE   "WRITE A RECORD"  TO FEATURE.
078700     MOVE   "SEQ-TEST-WR-02" TO PAR-NAME.
078800     IF DELETE-SW NOT EQUAL TO SPACE
078900         GO TO SEQ-DELETE-02.
079000     GO TO   SEQ-TEST-WR-02.
079100 SEQ-DELETE-02.
079200     MOVE   "*" TO DELETE-SW-2.
079300     GO TO   SEQ-DELETE-02-01.
079400 SEQ-TEST-WR-02.
079500     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-FS4R1-F-G-120.
079600     MOVE   "987654321123456789" TO EXT-18.
079700     WRITE   SQ-FS4R2-F-G-138.
079800*
079900*    CHECK I-O STATUS RETURNED FROM WRITE
080000*
080100     ADD    1 TO REC-CT.
080200     IF DELETE-SW NOT = SPACE
080300         GO TO   SEQ-DELETE-02-01.
080400     GO TO   SEQ-TEST-WR-02-01.
080500 SEQ-DELETE-02-01.
080600     PERFORM DE-LETE.
080700     GO TO   SEQ-TEST-02-01-END.
080800 SEQ-TEST-WR-02-01.
080900     IF SQ-FS4-STATUS = "00"
081000         PERFORM PASS
081100     ELSE
081200         MOVE    SQ-FS4-STATUS TO COMPUTED-A
081300         MOVE   "00" TO CORRECT-A
081400         MOVE   "UNEXPECTED ERROR CODE FROM WRITE"
081500                   TO RE-MARK
081600         MOVE   "VII-3, VII-53" TO ANSI-REFERENCE
081700         PERFORM FAIL.
081800 SEQ-TEST-02-01-END.
081900*
082000*    CHECK EXECUTION OF I-O DECLARATIVE
082100*
082200     ADD     1 TO REC-CT.
082300     IF DELETE-SW NOT = SPACE
082400         GO TO   SEQ-DELETE-02-02.
082500     GO TO   SEQ-TEST-WR-02-02.
082600 SEQ-DELETE-02-02.
082700     PERFORM DE-LETE.
082800     GO TO   SEQ-TEST-02-02-END.
082900 SEQ-TEST-WR-02-02.
083000     IF DECL-EXEC-I-O = "NOT EXECUTED"
083100         PERFORM PASS
083200     ELSE
083300         MOVE    DECL-EXEC-I-O TO COMPUTED-A
083400         MOVE   "NOT EXECUTED" TO CORRECT-A
083500         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
083600                   TO RE-MARK
083700         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
083800         PERFORM FAIL.
083900 SEQ-TEST-02-02-END.
084000*
084100*
084200*    NOW CLOSE THE FILE.
084300*
084400 SEQ-INIT-03.
084500     MOVE    0 TO REC-CT.
084600     MOVE   "*" TO DECL-EXEC-SW.
084700     MOVE   "**" TO SQ-FS4-STATUS.
084800     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
084900     MOVE   "CLOSE FILE" TO FEATURE.
085000     MOVE   "SEQ-TEST-CL-03" TO PAR-NAME.
085100     IF DELETE-SW NOT EQUAL TO SPACE
085200         GO TO SEQ-DELETE-03.
085300     GO TO   SEQ-TEST-CL-03.
085400 SEQ-DELETE-03.
085500     MOVE   "*" TO DELETE-SW-2.
085600     GO TO   SEQ-DELETE-03-01.
085700 SEQ-TEST-CL-03.
085800     CLOSE   SQ-FS4.
085900*
086000*    CHECK I-O STATUS RETURNED FROM CLOSE
086100*
086200     ADD    1 TO REC-CT.
086300     IF DELETE-SW NOT = SPACE
086400         GO TO   SEQ-DELETE-03-01.
086500     GO TO   SEQ-TEST-CL-03-01.
086600 SEQ-DELETE-03-01.
086700     PERFORM DE-LETE.
086800     GO TO   SEQ-TEST-03-01-END.
086900 SEQ-TEST-CL-03-01.
087000     IF SQ-FS4-STATUS = "00"
087100         PERFORM PASS
087200     ELSE
087300         MOVE    SQ-FS4-STATUS TO COMPUTED-A
087400         MOVE   "00" TO CORRECT-A
087500         MOVE   "UNEXPECTED ERROR CODE FROM CLOSE"
087600                   TO RE-MARK
087700         MOVE   "VII-3, VII-38,4.2.4(4)" TO ANSI-REFERENCE
087800         PERFORM FAIL.
087900 SEQ-TEST-03-01-END.
088000*
088100*    CHECK EXECUTION OF I-O DECLARATIVE
088200*
088300     ADD     1 TO REC-CT.
088400     IF DELETE-SW NOT = SPACE
088500         GO TO   SEQ-DELETE-03-02.
088600     GO TO   SEQ-TEST-CL-03-02.
088700 SEQ-DELETE-03-02.
088800     PERFORM DE-LETE.
088900     GO TO   SEQ-TEST-03-02-END.
089000 SEQ-TEST-CL-03-02.
089100     IF DECL-EXEC-I-O = "NOT EXECUTED"
089200         PERFORM PASS
089300     ELSE
089400         MOVE    DECL-EXEC-I-O TO COMPUTED-A
089500         MOVE   "NOT EXECUTED" TO CORRECT-A
089600         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
089700                   TO RE-MARK
089800         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
089900         PERFORM FAIL.
090000 SEQ-TEST-03-02-END.
090100     MOVE    SPACE TO DELETE-SW-2.
090200*
090300*
090400*    OPEN THE FILE IN THE I-O MODE
090500*
090600 SEQ-INIT-04.
090700     MOVE    0 TO REC-CT.
090800     MOVE   "*" TO DECL-EXEC-SW.
090900     MOVE   "**" TO SQ-FS4-STATUS.
091000     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
091100     MOVE    ZERO TO XRECORD-NUMBER (1).
091200     MOVE   "OPEN FILE FOR I-O" TO FEATURE.
091300     MOVE   "SEQ-TEST-OP-04" TO PAR-NAME.
091400     IF DELETE-SW NOT = SPACE
091500         GO TO SEQ-DELETE-04-01.
091600     GO TO   SEQ-TEST-OP-04.
091700 SEQ-DELETE-04.
091800     MOVE   "*" TO DELETE-SW-2.
091900     GO TO   SEQ-DELETE-04-01.
092000 SEQ-TEST-OP-04.
092100     OPEN    I-O SQ-FS4.
092200*
092300*    CHECK I-O STATUS RETURNED FROM OPEN I-O
092400*
092500     ADD    1 TO REC-CT.
092600     IF DELETE-SW NOT = SPACE
092700         GO TO   SEQ-DELETE-04-01.
092800     GO TO   SEQ-TEST-OP-04-01.
092900 SEQ-DELETE-04-01.
093000     PERFORM DE-LETE.
093100     GO TO   SEQ-TEST-04-01-END.
093200 SEQ-TEST-OP-04-01.
093300     IF SQ-FS4-STATUS = "00"
093400         PERFORM PASS
093500     ELSE
093600         MOVE    SQ-FS4-STATUS TO COMPUTED-A
093700         MOVE   "00" TO CORRECT-A
093800         MOVE   "UNEXPECTED I-O STATUS CODE FROM OPEN I-O"
093900                   TO RE-MARK
094000         MOVE   "VII-3, VII-40" TO ANSI-REFERENCE
094100         PERFORM FAIL.
094200 SEQ-TEST-04-01-END.
094300*
094400     ADD     1 TO REC-CT.
094500     IF DELETE-SW NOT = SPACE
094600         GO TO   SEQ-DELETE-04-02.
094700     GO TO   SEQ-TEST-OP-04-02.
094800 SEQ-DELETE-04-02.
094900     PERFORM DE-LETE.
095000     GO TO   SEQ-TEST-04-02-END.
095100 SEQ-TEST-OP-04-02.
095200     IF DECL-EXEC-I-O = "NOT EXECUTED"
095300         PERFORM PASS
095400     ELSE
095500         MOVE    DECL-EXEC-I-O TO COMPUTED-A
095600         MOVE   "NOT EXECUTED" TO CORRECT-A
095700         MOVE  "UNEXPECTED EXECUTION OF I-O DECLARATIVE ON OPEN"
095800                   TO RE-MARK
095900         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
096000         PERFORM FAIL.
096100 SEQ-TEST-04-02-END.
096200*
096300*
096400*    THE FILE IS OPEN FOR I-O.  WE READ THE ONLY RECORD.
096500*
096600 SEQ-INIT-05.
096700     MOVE    0 TO REC-CT.
096800     MOVE   "*" TO DECL-EXEC-SW.
096900     ADD     1 TO XRECORD-NUMBER (1).
097000     MOVE    SPACE TO SQ-FS4R2-F-G-138.
097100     MOVE   "**" TO SQ-FS4-STATUS.
097200     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
097300     MOVE   "READ FIRST RECORD" TO FEATURE.
097400     MOVE   "SEQ-TEST-RD-05" TO PAR-NAME.
097500     IF DELETE-SW NOT EQUAL TO SPACE
097600         GO TO SEQ-DELETE-05.
097700     GO TO   SEQ-TEST-RD-05.
097800 SEQ-DELETE-05.
097900     MOVE   "*" TO DELETE-SW-2.
098000     GO TO   SEQ-DELETE-05-01.
098100 SEQ-TEST-RD-05.
098200     READ    SQ-FS4.
098300*
098400*    CHECK I-O STATUS RETURNED FROM READ
098500*
098600     ADD    1 TO REC-CT.
098700     IF DELETE-SW NOT = SPACE
098800         GO TO   SEQ-DELETE-05-01.
098900     GO TO   SEQ-TEST-RD-05-01.
099000 SEQ-DELETE-05-01.
099100     PERFORM DE-LETE.
099200     GO TO   SEQ-TEST-05-01-END.
099300 SEQ-TEST-RD-05-01.
099400     IF SQ-FS4-STATUS = "00"
099500         PERFORM PASS
099600     ELSE
099700         MOVE    SQ-FS4-STATUS TO COMPUTED-A
099800         MOVE   "00" TO CORRECT-A
099900         MOVE   "UNEXPECTED STATUS CODE FROM READ"
100000                   TO RE-MARK
100100         MOVE   "VII-3, VII-44" TO ANSI-REFERENCE
100200         PERFORM FAIL.
100300 SEQ-TEST-05-01-END.
100400*
100500*    CHECK EXECUTION OF I-O DECLARATIVE
100600*
100700     ADD     1 TO REC-CT.
100800     IF DELETE-SW NOT = SPACE
100900         GO TO   SEQ-DELETE-05-02.
101000     GO TO   SEQ-TEST-RD-05-02.
101100 SEQ-DELETE-05-02.
101200     PERFORM DE-LETE.
101300     GO TO   SEQ-TEST-05-02-END.
101400 SEQ-TEST-RD-05-02.
101500     IF DECL-EXEC-I-O = "NOT EXECUTED"
101600         PERFORM PASS
101700     ELSE
101800         MOVE    DECL-EXEC-I-O TO COMPUTED-A
101900         MOVE   "NOT EXECUTED" TO CORRECT-A
102000         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
102100                   TO RE-MARK
102200         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
102300         PERFORM FAIL.
102400 SEQ-TEST-05-02-END.
102500*
102600*    CHECK THAT THE CORRECT RECORD HAS BEEN RETURNED, BY
102700*    CHECKING THE RECORD-NUMBER FIELD.
102800*
102900     ADD     1 TO REC-CT.
103000     IF DELETE-SW NOT = SPACE
103100         GO TO   SEQ-DELETE-05-03.
103200     GO TO   SEQ-TEST-RD-05-03.
103300 SEQ-DELETE-05-03.
103400     PERFORM DE-LETE.
103500     GO TO   SEQ-TEST-05-03-END.
103600 SEQ-TEST-RD-05-03.
103700     IF FRECORD-NUMBER = XRECORD-NUMBER (1)
103800         PERFORM PASS
103900     ELSE
104000         MOVE    FRECORD-NUMBER TO COMPUTED-18V0
104100         MOVE    XRECORD-NUMBER (1) TO CORRECT-18V0
104200         MOVE   "INCORRECT RECORD NUMBER FOUND" TO RE-MARK
104300         PERFORM FAIL.
104400 SEQ-TEST-05-03-END.
104500     MOVE    SPACE TO DELETE-SW-2.
104600*
104700*    FINALLY, TRY TO REWRITE A SMALLER RECORD
104800*
104900 SEQ-INIT-06.
105000     MOVE    0 TO REC-CT.
105100     MOVE    SPACE TO DECL-EXEC-SW.
105200     MOVE   "**" TO SQ-FS4-STATUS.
105300     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
105400     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-FS4R1-F-G-120.
105500     MOVE   "ABCDEFGHIJKLMNOPQR" TO EXT-18.
105600     MOVE   "REWRITE SMALLER RECORD" TO FEATURE.
105700     MOVE   "SEQ-TEST-RW-06" TO PAR-NAME.
105800     IF DELETE-SW NOT = SPACE
105900         GO TO SEQ-DELETE-06-01.
106000     GO TO   SEQ-TEST-RW-06.
106100 SEQ-DELETE-06.
106200     MOVE   "*" TO DELETE-SW-2.
106300     GO TO   SEQ-DELETE-06-01.
106400 SEQ-TEST-RW-06.
106500     REWRITE SQ-FS4R1-F-G-120.
106600     MOVE    0 TO REC-CT.
106700     MOVE   "REWRITE SMALLER RECORD" TO FEATURE.
106800     MOVE   "SEQ-TEST-RW-06" TO PAR-NAME.
106900*
107000*    CHECK I-O STATUS RETURNED FROM REWRITE
107100*
107200     ADD    1 TO REC-CT.
107300     IF DELETE-SW NOT = SPACE
107400         GO TO   SEQ-DELETE-06-01.
107500     GO TO   SEQ-TEST-RW-06-01.
107600 SEQ-DELETE-06-01.
107700     PERFORM DE-LETE.
107800 SEQ-TEST-RW-06-01.
107900     IF SQ-FS4-STATUS = "44"
108000         PERFORM PASS
108100     ELSE
108200         MOVE    SQ-FS4-STATUS TO COMPUTED-A
108300         MOVE   "44" TO CORRECT-A
108400         MOVE   "UNEXPECTED STATUS CODE FROM REWRITE SHORTER"
108500                   TO RE-MARK
108600         MOVE   "VII-4,1.5.3(4)D, VII-48" TO ANSI-REFERENCE
108700         PERFORM FAIL.
108800 CCVS-EXIT SECTION.
108900 CCVS-999999.
109000     GO TO   CLOSE-FILES.
