000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST125A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-01                                                  *
001700*        X-02                                                  *
001800*        X-03                                                  *
001900*        X-27                                                  *
002000*        X-55  - SYSTEM PRINTER NAME.                          *
002100*        X-69                                                  *
002200*        X-74                                                  *
002300*        X-75                                                  *
002400*        X-82  - SOURCE COMPUTER NAME.                         *
002500*        X-83  - OBJECT COMPUTER NAME.                         *
002600*                                                              *
002700****************************************************************
002800*
002900*    THIS PROGRAM TESTS THE FACILITY OF MULTIPLE FILES IN THE
003000*    "GIVING" PHRASE OF THE "SORT" STATEMENT.
003100*    THE CONTENT OF THE 3 OUTPUT FILES WILL BE VERIFIED IN
003200*    PROGRAM ST126A.
003300*    THIS PROGRAM BUILDS A FILE OF NINE RECORDS. EACH RECORD HAS
003400*    THREE KEYS, AND THE VALUES OF THE RECORDS ARE SHOWN BELOW-
003500*             S
003600*             O
003700*             R               SORT
003800*             T  SORT         KEY
003900*             K  KEY           -2
004000*             E   -1           ..
004100*             Y   ..         .    .
004200*             -  .  .      .        .
004300*             3 .    .   .            .
004400*             ..      ..                .
004500*              11111112888888888888888888
004600*              11111112999999999999999999
004700*              11111112999999999999999999
004800*              00000001999999999999999999
004900*             000000001999999999999999999
005000*             000000001999999999999999999
005100*             000000001999999999999999999
005200*             000000001999999999999999999
005300*             000000001999999999999999999
005400*    THERE IS AN ASSUMED DECIMAL POINT BETWEEN THE FIRST AND
005500*    SECOND COLUMNS OF SORTKEY-1.
005600*
005700 ENVIRONMENT DIVISION.
005800 CONFIGURATION SECTION.
005900 SOURCE-COMPUTER.
006000     XXXXX082.
006100 OBJECT-COMPUTER.
006200     XXXXX083.
006300 INPUT-OUTPUT SECTION.
006400 FILE-CONTROL.
006500     SELECT PRINT-FILE ASSIGN TO
006600     XXXXX055.
006700     SELECT SORTFILE-1F ASSIGN TO
006800     XXXXX027.
006900     SELECT SORTOUT-1F ASSIGN TO
007000     XXXXP001.
007100     SELECT SORTOUT-2F ASSIGN TO
007200     XXXXP002.
007300     SELECT SORTOUT-3F ASSIGN TO
007400     XXXXP003.
007500 DATA DIVISION.
007600 FILE SECTION.
007700 FD  PRINT-FILE.
007800 01  PRINT-REC PICTURE X(120).
007900 01  DUMMY-RECORD PICTURE X(120).
008000 FD  SORTOUT-1F
008100     LABEL RECORDS STANDARD
008200C    VALUE OF
008300C    XXXXX074
008400C    IS
008500C    XXXXX075
008600G    XXXXX069
008700     RECORD CONTAINS 27 CHARACTERS.
008800 01  SORTOUT-REC-1.
008900     02 FILLER          PICTURE X(27).
009000 FD  SORTOUT-2F
009100     LABEL RECORDS STANDARD
009200C    VALUE OF
009300C    XXXXX074
009400C    IS
009500C    XXXXX075
009600G    XXXXX069
009700     RECORD CONTAINS 27 CHARACTERS.
009800 01  SORTOUT-REC-2.
009900     02 FILLER          PICTURE X(27).
010000 FD  SORTOUT-3F
010100     LABEL RECORDS STANDARD
010200C    VALUE OF
010300C    XXXXX074
010400C    IS
010500C    XXXXX075
010600G    XXXXX069
010700     RECORD CONTAINS 27 CHARACTERS.
010800 01  SORTOUT-REC-3.
010900     02 FILLER          PICTURE X(27).
011000 SD  SORTFILE-1F
011100     RECORD  CONTAINS 27 CHARACTERS.
011200 01  SORT-GROUP.
011300     02 SORTKEY-3       PICTURE X.
011400     02 SORTKEY-1       PICTURE S9V9(7).
011500     02 SORTKEY-2       PICTURE 9(18).
011600 WORKING-STORAGE SECTION.
011700 77  UTIL-CTR           PICTURE S99999 VALUE ZERO.
011800 77  UTILITY-1          PICTURE S9V9(7) VALUE +1.1111112.
011900 77  UTILITY-2          PICTURE 9(018) VALUE 888888888888888888.
012000 77  UTILITY-3          PICTURE X VALUE SPACE.
012100 01  TEST-RESULTS.
012200     02 FILLER                   PIC X      VALUE SPACE.
012300     02 FEATURE                  PIC X(20)  VALUE SPACE.
012400     02 FILLER                   PIC X      VALUE SPACE.
012500     02 P-OR-F                   PIC X(5)   VALUE SPACE.
012600     02 FILLER                   PIC X      VALUE SPACE.
012700     02  PAR-NAME.
012800       03 FILLER                 PIC X(19)  VALUE SPACE.
012900       03  PARDOT-X              PIC X      VALUE SPACE.
013000       03 DOTVALUE               PIC 99     VALUE ZERO.
013100     02 FILLER                   PIC X(8)   VALUE SPACE.
013200     02 RE-MARK                  PIC X(61).
013300 01  TEST-COMPUTED.
013400     02 FILLER                   PIC X(30)  VALUE SPACE.
013500     02 FILLER                   PIC X(17)  VALUE
013600            "       COMPUTED=".
013700     02 COMPUTED-X.
013800     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
013900     03 COMPUTED-N               REDEFINES COMPUTED-A
014000                                 PIC -9(9).9(9).
014100     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
014200     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
014300     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
014400     03       CM-18V0 REDEFINES COMPUTED-A.
014500         04 COMPUTED-18V0                    PIC -9(18).
014600         04 FILLER                           PIC X.
014700     03 FILLER PIC X(50) VALUE SPACE.
014800 01  TEST-CORRECT.
014900     02 FILLER PIC X(30) VALUE SPACE.
015000     02 FILLER PIC X(17) VALUE "       CORRECT =".
015100     02 CORRECT-X.
015200     03 CORRECT-A                  PIC X(20) VALUE SPACE.
015300     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
015400     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
015500     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
015600     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
015700     03      CR-18V0 REDEFINES CORRECT-A.
015800         04 CORRECT-18V0                     PIC -9(18).
015900         04 FILLER                           PIC X.
016000     03 FILLER PIC X(2) VALUE SPACE.
016100     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
016200 01  CCVS-C-1.
016300     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
016400-    "SS  PARAGRAPH-NAME
016500-    "       REMARKS".
016600     02 FILLER                     PIC X(20)    VALUE SPACE.
016700 01  CCVS-C-2.
016800     02 FILLER                     PIC X        VALUE SPACE.
016900     02 FILLER                     PIC X(6)     VALUE "TESTED".
017000     02 FILLER                     PIC X(15)    VALUE SPACE.
017100     02 FILLER                     PIC X(4)     VALUE "FAIL".
017200     02 FILLER                     PIC X(94)    VALUE SPACE.
017300 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
017400 01  REC-CT                        PIC 99       VALUE ZERO.
017500 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
017600 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
017700 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
017800 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
017900 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
018000 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
018100 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
018200 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
018300 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
018400 01  CCVS-H-1.
018500     02  FILLER                    PIC X(39)    VALUE SPACES.
018600     02  FILLER                    PIC X(42)    VALUE
018700     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
018800     02  FILLER                    PIC X(39)    VALUE SPACES.
018900 01  CCVS-H-2A.
019000   02  FILLER                        PIC X(40)  VALUE SPACE.
019100   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
019200   02  FILLER                        PIC XXXX   VALUE
019300     "4.2 ".
019400   02  FILLER                        PIC X(28)  VALUE
019500            " COPY - NOT FOR DISTRIBUTION".
019600   02  FILLER                        PIC X(41)  VALUE SPACE.
019700
019800 01  CCVS-H-2B.
019900   02  FILLER                        PIC X(15)  VALUE
020000            "TEST RESULT OF ".
020100   02  TEST-ID                       PIC X(9).
020200   02  FILLER                        PIC X(4)   VALUE
020300            " IN ".
020400   02  FILLER                        PIC X(12)  VALUE
020500     " HIGH       ".
020600   02  FILLER                        PIC X(22)  VALUE
020700            " LEVEL VALIDATION FOR ".
020800   02  FILLER                        PIC X(58)  VALUE
020900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
021000 01  CCVS-H-3.
021100     02  FILLER                      PIC X(34)  VALUE
021200            " FOR OFFICIAL USE ONLY    ".
021300     02  FILLER                      PIC X(58)  VALUE
021400     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
021500     02  FILLER                      PIC X(28)  VALUE
021600            "  COPYRIGHT   1985 ".
021700 01  CCVS-E-1.
021800     02 FILLER                       PIC X(52)  VALUE SPACE.
021900     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
022000     02 ID-AGAIN                     PIC X(9).
022100     02 FILLER                       PIC X(45)  VALUE SPACES.
022200 01  CCVS-E-2.
022300     02  FILLER                      PIC X(31)  VALUE SPACE.
022400     02  FILLER                      PIC X(21)  VALUE SPACE.
022500     02 CCVS-E-2-2.
022600         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
022700         03 FILLER                   PIC X      VALUE SPACE.
022800         03 ENDER-DESC               PIC X(44)  VALUE
022900            "ERRORS ENCOUNTERED".
023000 01  CCVS-E-3.
023100     02  FILLER                      PIC X(22)  VALUE
023200            " FOR OFFICIAL USE ONLY".
023300     02  FILLER                      PIC X(12)  VALUE SPACE.
023400     02  FILLER                      PIC X(58)  VALUE
023500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
023600     02  FILLER                      PIC X(13)  VALUE SPACE.
023700     02 FILLER                       PIC X(15)  VALUE
023800             " COPYRIGHT 1985".
023900 01  CCVS-E-4.
024000     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
024100     02 FILLER                       PIC X(4)   VALUE " OF ".
024200     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
024300     02 FILLER                       PIC X(40)  VALUE
024400      "  TESTS WERE EXECUTED SUCCESSFULLY".
024500 01  XXINFO.
024600     02 FILLER                       PIC X(19)  VALUE
024700            "*** INFORMATION ***".
024800     02 INFO-TEXT.
024900       04 FILLER                     PIC X(8)   VALUE SPACE.
025000       04 XXCOMPUTED                 PIC X(20).
025100       04 FILLER                     PIC X(5)   VALUE SPACE.
025200       04 XXCORRECT                  PIC X(20).
025300     02 INF-ANSI-REFERENCE           PIC X(48).
025400 01  HYPHEN-LINE.
025500     02 FILLER  PIC IS X VALUE IS SPACE.
025600     02 FILLER  PIC IS X(65)    VALUE IS "************************
025700-    "*****************************************".
025800     02 FILLER  PIC IS X(54)    VALUE IS "************************
025900-    "******************************".
026000 01  CCVS-PGM-ID                     PIC X(9)   VALUE
026100     "ST125A".
026200 PROCEDURE DIVISION.
026300 SORTPARA SECTION.
026400 SORT-PARAGRAPH.
026500     SORT     SORTFILE-1F ON
026600              ASCENDING SORTKEY-1
026700              DESCENDING SORTKEY-2
026800              ASCENDING SORTKEY-3
026900              INPUT PROCEDURE INPROC THRU INPROC-EXIT
027000              GIVING SORTOUT-1F
027100                     SORTOUT-2F
027200                     SORTOUT-3F.
027300     STOP     RUN.
027400 INPROC SECTION.
027500 OPEN-FILES.
027600     OPEN     OUTPUT PRINT-FILE.
027700     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
027800     MOVE    SPACE TO TEST-RESULTS.
027900     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
028000     GO TO CCVS1-EXIT.
028100 CLOSE-FILES.
028200     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
028300 TERMINATE-CCVS.
028400S    EXIT PROGRAM.
028500STERMINATE-CALL.
028600     STOP     RUN.
028700 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
028800 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
028900 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
029000 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
029100     MOVE "****TEST DELETED****" TO RE-MARK.
029200 PRINT-DETAIL.
029300     IF REC-CT NOT EQUAL TO ZERO
029400             MOVE "." TO PARDOT-X
029500             MOVE REC-CT TO DOTVALUE.
029600     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
029700     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
029800        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
029900          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
030000     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
030100     MOVE SPACE TO CORRECT-X.
030200     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
030300     MOVE     SPACE TO RE-MARK.
030400 HEAD-ROUTINE.
030500     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030600     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030700     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030800     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030900 COLUMN-NAMES-ROUTINE.
031000     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031100     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
031300 END-ROUTINE.
031400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
031500 END-RTN-EXIT.
031600     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031700 END-ROUTINE-1.
031800      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
031900      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
032000      ADD PASS-COUNTER TO ERROR-HOLD.
032100*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
032200      MOVE PASS-COUNTER TO CCVS-E-4-1.
032300      MOVE ERROR-HOLD TO CCVS-E-4-2.
032400      MOVE CCVS-E-4 TO CCVS-E-2-2.
032500      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
032600  END-ROUTINE-12.
032700      MOVE "TEST(S) FAILED" TO ENDER-DESC.
032800     IF       ERROR-COUNTER IS EQUAL TO ZERO
032900         MOVE "NO " TO ERROR-TOTAL
033000         ELSE
033100         MOVE ERROR-COUNTER TO ERROR-TOTAL.
033200     MOVE     CCVS-E-2 TO DUMMY-RECORD.
033300     PERFORM WRITE-LINE.
033400 END-ROUTINE-13.
033500     IF DELETE-COUNTER IS EQUAL TO ZERO
033600         MOVE "NO " TO ERROR-TOTAL  ELSE
033700         MOVE DELETE-COUNTER TO ERROR-TOTAL.
033800     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
033900     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034000      IF   INSPECT-COUNTER EQUAL TO ZERO
034100          MOVE "NO " TO ERROR-TOTAL
034200      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
034300      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
034400      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034500     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034600 WRITE-LINE.
034700     ADD 1 TO RECORD-COUNT.
034800Y    IF RECORD-COUNT GREATER 42
034900Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
035000Y        MOVE SPACE TO DUMMY-RECORD
035100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
035200Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
035300Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
035400Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
035500Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
035600Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
035700Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
035800Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
035900Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
036000Y        MOVE ZERO TO RECORD-COUNT.
036100     PERFORM WRT-LN.
036200 WRT-LN.
036300     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
036400     MOVE SPACE TO DUMMY-RECORD.
036500 BLANK-LINE-PRINT.
036600     PERFORM WRT-LN.
036700 FAIL-ROUTINE.
036800     IF     COMPUTED-X NOT EQUAL TO SPACE
036900            GO TO   FAIL-ROUTINE-WRITE.
037000     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
037100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
037200     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
037300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037400     MOVE   SPACES TO INF-ANSI-REFERENCE.
037500     GO TO  FAIL-ROUTINE-EX.
037600 FAIL-ROUTINE-WRITE.
037700     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
037800     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
037900     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
038000     MOVE   SPACES TO COR-ANSI-REFERENCE.
038100 FAIL-ROUTINE-EX. EXIT.
038200 BAIL-OUT.
038300     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
038400     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
038500 BAIL-OUT-WRITE.
038600     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
038700     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
038800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038900     MOVE   SPACES TO INF-ANSI-REFERENCE.
039000 BAIL-OUT-EX. EXIT.
039100 CCVS1-EXIT.
039200     EXIT.
039300 ST125A-001-01.
039400     MOVE   "XI-20 4.4.4 GR(12)" TO ANSI-REFERENCE.
039500     OPEN     OUTPUT   SORTOUT-1F.
039600     OPEN     OUTPUT   SORTOUT-2F.
039700     OPEN     OUTPUT   SORTOUT-3F.
039800     MOVE     "THIS PROGRAM BUILDS AND" TO RE-MARK.
039900     PERFORM  PRINT-DETAIL.
040000     MOVE     "SORTS 3 FILES AND PASSES" TO RE-MARK.
040100     PERFORM  PRINT-DETAIL.
040200     MOVE      "THE OUTPUT TO ST126A." TO RE-MARK.
040300     PERFORM  PRINT-DETAIL.
040400 BUILD-FILE.
040500     ADD      1 TO UTIL-CTR
040600     IF       UTIL-CTR EQUAL TO 2
040700              MOVE 999999999999999999 TO UTILITY-2.
040800     IF       UTIL-CTR EQUAL TO 4
040900              ADD -1.1111111 TO UTILITY-1.
041000     IF       UTIL-CTR EQUAL TO 5
041100              MOVE ZERO TO UTILITY-3.
041200     MOVE     UTILITY-1 TO SORTKEY-1.
041300     MOVE     UTILITY-3 TO SORTKEY-3.
041400     MOVE     UTILITY-2 TO SORTKEY-2.
041500     RELEASE  SORT-GROUP.
041600     IF       UTIL-CTR LESS THAN 9 GO TO BUILD-FILE.
041700 BUILD-FILE-TEST.
041800     IF       UTIL-CTR EQUAL TO 9
041900              PERFORM PASS GO TO BUILD-FILE-WRITE.
042000 BUILD-FILE-FAIL.
042100     MOVE     UTIL-CTR TO COMPUTED-N.
042200     MOVE     9 TO CORRECT-N.
042300     PERFORM  FAIL.
042400 BUILD-FILE-WRITE.
042500     MOVE     "CREATE A FILE" TO FEATURE.
042600     MOVE     "BUILD-FILE-TEST" TO PAR-NAME.
042700     PERFORM  PRINT-DETAIL.
042800     CLOSE    SORTOUT-1F.
042900     CLOSE    SORTOUT-2F.
043000     CLOSE    SORTOUT-3F.
043100
043200 INPROC-EXIT SECTION.
043300 EXITPARA.
043400     PERFORM CLOSE-FILES.
