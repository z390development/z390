000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     NC241A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*
002200*    PROGRAM NC241A TESTS THE CONSTRUCTION AND ACCESS OF A     *
002300*    THREE-DIMENSIONAL TABLE USING INDICES.  THE CONTENT OF    *
002400*    TABLE ELEMENTS IS VERIFIED BY USE OF THE FORMAT 4         *
002500*    "PERFORM" STATEMENT.                                      *
002600*                                                              *
002700****************************************************************
002800
002900 ENVIRONMENT DIVISION.
003000 CONFIGURATION SECTION.
003100 SOURCE-COMPUTER.
003200     XXXXX082.
003300 OBJECT-COMPUTER.
003400     XXXXX083.
003500 INPUT-OUTPUT SECTION.
003600 FILE-CONTROL.
003700     SELECT PRINT-FILE ASSIGN TO
003800     XXXXX055.
003900 DATA DIVISION.
004000 FILE SECTION.
004100 FD  PRINT-FILE.
004200 01  PRINT-REC PICTURE X(120).
004300 01  DUMMY-RECORD PICTURE X(120).
004400 WORKING-STORAGE SECTION.
004500 77  SUB-1              PICTURE S99   VALUE ZERO.
004600 77  SUB-2              PICTURE 99    VALUE ZERO.
004700 77  SUB-3              PICTURE 99    VALUE ZERO.
004800 77   TEST-CHECK PIC X(4) VALUE SPACE.
004900 77  CON-7              PICTURE 99  VALUE 07.
005000 77  CON-10             PICTURE 99  VALUE 10.
005100 77  GRP-HOLD-AREA                PICTURE X(5)  VALUE SPACES.
005200 77  CON-5              PICTURE 99  VALUE 05.
005300 77  SEC-HOLD-AREA                PICTURE X(11)  VALUE SPACES.
005400 77  CON-6              PICTURE 99  VALUE 06.
005500 77  ELEM-HOLD-AREA               PICTURE X(15)  VALUE SPACES.
005600 01  GRP-NAME.
005700     02  FILLER              PICTURE XXX    VALUE "GRP".
005800     02  ADD-GRP             PICTURE 99     VALUE 01.
005900
006000 01  SEC-NAME.
006100     02  FILLER              PICTURE X(5)   VALUE "SEC (".
006200     02  SEC-GRP             PICTURE 99     VALUE 00.
006300     02  FILLER              PICTURE X      VALUE ",".
006400     02  ADD-SEC             PICTURE 99     VALUE 01.
006500     02  FILLER              PICTURE X      VALUE ")".
006600
006700 01  ELEM-NAME.
006800     02  FILLER              PICTURE X(6)   VALUE "ELEM (".
006900     02  ELEM-GRP            PICTURE 99     VALUE 00.
007000     02  FILLER              PICTURE X      VALUE ",".
007100     02  ELEM-SEC            PICTURE 99     VALUE 00.
007200     02  FILLER              PICTURE X      VALUE ",".
007300     02  ADD-ELEM            PICTURE 99     VALUE 01.
007400     02  FILLER              PICTURE X      VALUE ")".
007500
007600 01  3-DIMENSION-TBL.
007700     02  GRP-ENTRY OCCURS 10 TIMES INDEXED BY IDX-1.
007800         03  ENTRY-1         PICTURE X(5).
007900         03  GRP2-ENTRY OCCURS 10 TIMES INDEXED BY IDX-2.
008000             04  ENTRY-2     PICTURE X(11).
008100             04  GRP3-ENTRY OCCURS 10 TIMES INDEXED BY IDX-3.
008200                 05  ENTRY-3 PICTURE X(15).
008300
008400 01  TEST-RESULTS.
008500     02 FILLER                   PIC X      VALUE SPACE.
008600     02 FEATURE                  PIC X(20)  VALUE SPACE.
008700     02 FILLER                   PIC X      VALUE SPACE.
008800     02 P-OR-F                   PIC X(5)   VALUE SPACE.
008900     02 FILLER                   PIC X      VALUE SPACE.
009000     02  PAR-NAME.
009100       03 FILLER                 PIC X(19)  VALUE SPACE.
009200       03  PARDOT-X              PIC X      VALUE SPACE.
009300       03 DOTVALUE               PIC 99     VALUE ZERO.
009400     02 FILLER                   PIC X(8)   VALUE SPACE.
009500     02 RE-MARK                  PIC X(61).
009600 01  TEST-COMPUTED.
009700     02 FILLER                   PIC X(30)  VALUE SPACE.
009800     02 FILLER                   PIC X(17)  VALUE
009900            "       COMPUTED=".
010000     02 COMPUTED-X.
010100     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
010200     03 COMPUTED-N               REDEFINES COMPUTED-A
010300                                 PIC -9(9).9(9).
010400     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
010500     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
010600     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
010700     03       CM-18V0 REDEFINES COMPUTED-A.
010800         04 COMPUTED-18V0                    PIC -9(18).
010900         04 FILLER                           PIC X.
011000     03 FILLER PIC X(50) VALUE SPACE.
011100 01  TEST-CORRECT.
011200     02 FILLER PIC X(30) VALUE SPACE.
011300     02 FILLER PIC X(17) VALUE "       CORRECT =".
011400     02 CORRECT-X.
011500     03 CORRECT-A                  PIC X(20) VALUE SPACE.
011600     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
011700     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
011800     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
011900     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
012000     03      CR-18V0 REDEFINES CORRECT-A.
012100         04 CORRECT-18V0                     PIC -9(18).
012200         04 FILLER                           PIC X.
012300     03 FILLER PIC X(2) VALUE SPACE.
012400     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
012500 01  CCVS-C-1.
012600     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
012700-    "SS  PARAGRAPH-NAME
012800-    "       REMARKS".
012900     02 FILLER                     PIC X(20)    VALUE SPACE.
013000 01  CCVS-C-2.
013100     02 FILLER                     PIC X        VALUE SPACE.
013200     02 FILLER                     PIC X(6)     VALUE "TESTED".
013300     02 FILLER                     PIC X(15)    VALUE SPACE.
013400     02 FILLER                     PIC X(4)     VALUE "FAIL".
013500     02 FILLER                     PIC X(94)    VALUE SPACE.
013600 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
013700 01  REC-CT                        PIC 99       VALUE ZERO.
013800 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
013900 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
014000 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
014100 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
014200 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
014300 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
014400 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
014500 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
014600 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
014700 01  CCVS-H-1.
014800     02  FILLER                    PIC X(39)    VALUE SPACES.
014900     02  FILLER                    PIC X(42)    VALUE
015000     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
015100     02  FILLER                    PIC X(39)    VALUE SPACES.
015200 01  CCVS-H-2A.
015300   02  FILLER                        PIC X(40)  VALUE SPACE.
015400   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
015500   02  FILLER                        PIC XXXX   VALUE
015600     "4.2 ".
015700   02  FILLER                        PIC X(28)  VALUE
015800            " COPY - NOT FOR DISTRIBUTION".
015900   02  FILLER                        PIC X(41)  VALUE SPACE.
016000
016100 01  CCVS-H-2B.
016200   02  FILLER                        PIC X(15)  VALUE
016300            "TEST RESULT OF ".
016400   02  TEST-ID                       PIC X(9).
016500   02  FILLER                        PIC X(4)   VALUE
016600            " IN ".
016700   02  FILLER                        PIC X(12)  VALUE
016800     " HIGH       ".
016900   02  FILLER                        PIC X(22)  VALUE
017000            " LEVEL VALIDATION FOR ".
017100   02  FILLER                        PIC X(58)  VALUE
017200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
017300 01  CCVS-H-3.
017400     02  FILLER                      PIC X(34)  VALUE
017500            " FOR OFFICIAL USE ONLY    ".
017600     02  FILLER                      PIC X(58)  VALUE
017700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
017800     02  FILLER                      PIC X(28)  VALUE
017900            "  COPYRIGHT   1985 ".
018000 01  CCVS-E-1.
018100     02 FILLER                       PIC X(52)  VALUE SPACE.
018200     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
018300     02 ID-AGAIN                     PIC X(9).
018400     02 FILLER                       PIC X(45)  VALUE SPACES.
018500 01  CCVS-E-2.
018600     02  FILLER                      PIC X(31)  VALUE SPACE.
018700     02  FILLER                      PIC X(21)  VALUE SPACE.
018800     02 CCVS-E-2-2.
018900         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
019000         03 FILLER                   PIC X      VALUE SPACE.
019100         03 ENDER-DESC               PIC X(44)  VALUE
019200            "ERRORS ENCOUNTERED".
019300 01  CCVS-E-3.
019400     02  FILLER                      PIC X(22)  VALUE
019500            " FOR OFFICIAL USE ONLY".
019600     02  FILLER                      PIC X(12)  VALUE SPACE.
019700     02  FILLER                      PIC X(58)  VALUE
019800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
019900     02  FILLER                      PIC X(13)  VALUE SPACE.
020000     02 FILLER                       PIC X(15)  VALUE
020100             " COPYRIGHT 1985".
020200 01  CCVS-E-4.
020300     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
020400     02 FILLER                       PIC X(4)   VALUE " OF ".
020500     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
020600     02 FILLER                       PIC X(40)  VALUE
020700      "  TESTS WERE EXECUTED SUCCESSFULLY".
020800 01  XXINFO.
020900     02 FILLER                       PIC X(19)  VALUE
021000            "*** INFORMATION ***".
021100     02 INFO-TEXT.
021200       04 FILLER                     PIC X(8)   VALUE SPACE.
021300       04 XXCOMPUTED                 PIC X(20).
021400       04 FILLER                     PIC X(5)   VALUE SPACE.
021500       04 XXCORRECT                  PIC X(20).
021600     02 INF-ANSI-REFERENCE           PIC X(48).
021700 01  HYPHEN-LINE.
021800     02 FILLER  PIC IS X VALUE IS SPACE.
021900     02 FILLER  PIC IS X(65)    VALUE IS "************************
022000-    "*****************************************".
022100     02 FILLER  PIC IS X(54)    VALUE IS "************************
022200-    "******************************".
022300 01  CCVS-PGM-ID                     PIC X(9)   VALUE
022400     "NC241A".
022500 PROCEDURE DIVISION.
022600 CCVS1 SECTION.
022700 OPEN-FILES.
022800     OPEN     OUTPUT PRINT-FILE.
022900     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
023000     MOVE    SPACE TO TEST-RESULTS.
023100     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
023200     GO TO CCVS1-EXIT.
023300 CLOSE-FILES.
023400     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
023500 TERMINATE-CCVS.
023600S    EXIT PROGRAM.
023700STERMINATE-CALL.
023800     STOP     RUN.
023900 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
024000 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
024100 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
024200 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
024300     MOVE "****TEST DELETED****" TO RE-MARK.
024400 PRINT-DETAIL.
024500     IF REC-CT NOT EQUAL TO ZERO
024600             MOVE "." TO PARDOT-X
024700             MOVE REC-CT TO DOTVALUE.
024800     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
024900     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
025000        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
025100          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
025200     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
025300     MOVE SPACE TO CORRECT-X.
025400     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
025500     MOVE     SPACE TO RE-MARK.
025600 HEAD-ROUTINE.
025700     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025800     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025900     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
026000     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
026100 COLUMN-NAMES-ROUTINE.
026200     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026300     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
026500 END-ROUTINE.
026600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
026700 END-RTN-EXIT.
026800     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026900 END-ROUTINE-1.
027000      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
027100      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
027200      ADD PASS-COUNTER TO ERROR-HOLD.
027300*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
027400      MOVE PASS-COUNTER TO CCVS-E-4-1.
027500      MOVE ERROR-HOLD TO CCVS-E-4-2.
027600      MOVE CCVS-E-4 TO CCVS-E-2-2.
027700      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
027800  END-ROUTINE-12.
027900      MOVE "TEST(S) FAILED" TO ENDER-DESC.
028000     IF       ERROR-COUNTER IS EQUAL TO ZERO
028100         MOVE "NO " TO ERROR-TOTAL
028200         ELSE
028300         MOVE ERROR-COUNTER TO ERROR-TOTAL.
028400     MOVE     CCVS-E-2 TO DUMMY-RECORD.
028500     PERFORM WRITE-LINE.
028600 END-ROUTINE-13.
028700     IF DELETE-COUNTER IS EQUAL TO ZERO
028800         MOVE "NO " TO ERROR-TOTAL  ELSE
028900         MOVE DELETE-COUNTER TO ERROR-TOTAL.
029000     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
029100     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029200      IF   INSPECT-COUNTER EQUAL TO ZERO
029300          MOVE "NO " TO ERROR-TOTAL
029400      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
029500      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
029600      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029700     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029800 WRITE-LINE.
029900     ADD 1 TO RECORD-COUNT.
030000Y    IF RECORD-COUNT GREATER 50
030100Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
030200Y        MOVE SPACE TO DUMMY-RECORD
030300Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
030400Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
030500Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
030600Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
030700Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
030800Y        MOVE ZERO TO RECORD-COUNT.
030900     PERFORM WRT-LN.
031000 WRT-LN.
031100     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
031200     MOVE SPACE TO DUMMY-RECORD.
031300 BLANK-LINE-PRINT.
031400     PERFORM WRT-LN.
031500 FAIL-ROUTINE.
031600     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
031700     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
031800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
031900     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
032000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032100     MOVE   SPACES TO INF-ANSI-REFERENCE.
032200     GO TO  FAIL-ROUTINE-EX.
032300 FAIL-ROUTINE-WRITE.
032400     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
032500     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
032600     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
032700     MOVE   SPACES TO COR-ANSI-REFERENCE.
032800 FAIL-ROUTINE-EX. EXIT.
032900 BAIL-OUT.
033000     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
033100     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
033200 BAIL-OUT-WRITE.
033300     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
033400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
033500     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033600     MOVE   SPACES TO INF-ANSI-REFERENCE.
033700 BAIL-OUT-EX. EXIT.
033800 CCVS1-EXIT.
033900     EXIT.
034000 SECT-NC241A-001 SECTION.
034100 TH-15-001.
034200     PERFORM PARA-1 VARYING SUB-1 FROM 1 BY 1
034300         UNTIL SUB-1 EQUAL TO 11
034400         AFTER SUB-2 FROM 1 BY 1 UNTIL SUB-2 EQUAL TO 11
034500         AFTER SUB-3 FROM 1 BY 1 UNTIL SUB-3 EQUAL TO 11
034600     GO TO CHECK-ENTRIES.
034700
034800 PARA-1.
034900     SET IDX-1 TO SUB-1.
035000     SET IDX-2 TO SUB-2.
035100     SET IDX-3 TO SUB-3.
035200     SET ADD-GRP, SEC-GRP, ELEM-GRP TO IDX-1.
035300     MOVE GRP-NAME TO ENTRY-1 (IDX-1).
035400     SET ADD-SEC, ELEM-SEC TO IDX-2.
035500     MOVE SEC-NAME TO ENTRY-2 (IDX-1, IDX-2).
035600     SET ADD-ELEM TO IDX-3.
035700     MOVE ELEM-NAME TO ENTRY-3 (IDX-1, IDX-2, IDX-3).
035800
035900 CHECK-ENTRIES.
036000     MOVE "PERFORM VARYING LEV1" TO FEATURE.
036100     MOVE "CHECK-ENTRIES       " TO PAR-NAME.
036200     MOVE SPACES TO TEST-CHECK.
036300     MOVE "GRP05" TO GRP-HOLD-AREA.
036400     PERFORM FIND-LEVEL-1-ENTRY VARYING IDX-1 FROM 1 BY 1
036500         UNTIL IDX-1 = 11.
036600     IF TEST-CHECK = "PASS" GO TO TH1-INIT-GF-2.
036700     MOVE GRP-HOLD-AREA TO CORRECT-A.
036800     MOVE ENTRY-1 (05) TO COMPUTED-A.
036900
037000     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
037100     PERFORM FAIL.
037200     PERFORM PRINT-DETAIL.
037300*
037400 TH1-INIT-GF-2.
037500     MOVE "GRP10" TO GRP-HOLD-AREA.
037600     MOVE "TH1-TEST-GF-2      " TO PAR-NAME.
037700     MOVE SPACES TO TEST-CHECK.
037800 TH1-TEST-GF-2.
037900     PERFORM FIND-LEVEL-1-ENTRY
038000             VARYING IDX-1 FROM 1 BY 1 UNTIL IDX-1 = 11.
038100     IF TEST-CHECK = "PASS"
038200         PERFORM PASS
038300         GO TO TH1-WRITE-GF-2
038400     ELSE
038500         GO TO TH1-FAIL-GF-2.
038600 TH1-DELETE-GF-2.
038700     PERFORM DE-LETE.
038800     GO TO TH1-WRITE-GF-2.
038900 TH1-FAIL-GF-2.
039000     MOVE GRP-HOLD-AREA TO CORRECT-A.
039100     MOVE ENTRY-1 (10) TO COMPUTED-A.
039200
039300     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
039400     PERFORM FAIL.
039500 TH1-WRITE-GF-2.
039600     PERFORM PRINT-DETAIL.
039700*
039800 TH1-INIT-GF-3.
039900     MOVE "GRP07" TO GRP-HOLD-AREA.
040000     MOVE "TH1-TEST-GF-3      " TO PAR-NAME.
040100     MOVE SPACES TO TEST-CHECK.
040200 TH1-TEST-GF-3.
040300     PERFORM FIND-LEVEL-1-ENTRY
040400             VARYING IDX-1 FROM 1 BY 1 UNTIL IDX-1 = 11.
040500     IF TEST-CHECK = "PASS"
040600         PERFORM PASS
040700         GO TO TH1-WRITE-GF-3
040800     ELSE
040900         GO TO TH1-FAIL-GF-3.
041000 TH1-DELETE-GF-3.
041100     PERFORM DE-LETE.
041200     GO TO TH1-WRITE-GF-3.
041300 TH1-FAIL-GF-3.
041400     MOVE GRP-HOLD-AREA TO CORRECT-A.
041500     MOVE ENTRY-1 (07) TO COMPUTED-A.
041600
041700     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
041800     PERFORM FAIL.
041900 TH1-WRITE-GF-3.
042000     PERFORM PRINT-DETAIL.
042100*
042200 TH1-INIT-GF-4.
042300     MOVE "TH1-TEST-GF-4      " TO PAR-NAME.
042400     MOVE "GRP01" TO GRP-HOLD-AREA.
042500 TH1-TEST-GF-4.
042600     PERFORM FIND-LEVEL-1-ENTRY
042700             VARYING IDX-1 FROM 1 BY 1 UNTIL IDX-1 = 11.
042800     IF TEST-CHECK = "PASS"
042900         PERFORM PASS
043000         GO TO TH1-WRITE-GF-4
043100     ELSE
043200         GO TO TH1-FAIL-GF-4.
043300 TH1-DELETE-GF-4.
043400     PERFORM DE-LETE.
043500     GO TO TH1-WRITE-GF-4.
043600 TH1-FAIL-GF-4.
043700     MOVE GRP-HOLD-AREA TO CORRECT-A.
043800     MOVE ENTRY-1 (01) TO COMPUTED-A.
043900
044000     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
044100     PERFORM FAIL.
044200 TH1-WRITE-GF-4.
044300     PERFORM PRINT-DETAIL.
044400     GO TO TH2-INIT-GF-1.
044500*
044600 FIND-LEVEL-1-ENTRY.
044700     IF ENTRY-1 (IDX-1) = GRP-HOLD-AREA
044800         MOVE "PASS" TO TEST-CHECK.
044900*
045000 TH2-INIT-GF-1.
045100     MOVE "TH2-TEST-GF-1      " TO PAR-NAME.
045200     MOVE "PERFORM VARYING LEV2" TO FEATURE.
045300     MOVE "SEC (03,05)" TO SEC-HOLD-AREA.
045400     MOVE SPACES TO TEST-CHECK.
045500 TH2-TEST-GF-1.
045600     PERFORM FIND-LEVEL-2-ENTRY
045700             VARYING IDX-1 FROM 1 BY 1 UNTIL IDX-1 GREATER 10
045800             AFTER   IDX-2 FROM 1 BY 1 UNTIL IDX-2 = 10.
045900     IF TEST-CHECK = "PASS"
046000         PERFORM PASS
046100         GO TO TH2-WRITE-GF-1
046200     ELSE
046300         GO TO TH2-FAIL-GF-1.
046400 TH2-DELETE-GF-1.
046500     PERFORM DE-LETE.
046600     GO TO TH2-WRITE-GF-1.
046700 TH2-FAIL-GF-1.
046800     MOVE SEC-HOLD-AREA TO CORRECT-A.
046900     MOVE ENTRY-2 (03, 05) TO COMPUTED-A.
047000
047100     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
047200     PERFORM FAIL.
047300 TH2-WRITE-GF-1.
047400     PERFORM PRINT-DETAIL.
047500*
047600 TH2-INIT-GF-2.
047700     MOVE "TH2-TEST-GF-2      " TO PAR-NAME.
047800     MOVE SPACES TO TEST-CHECK.
047900     MOVE "SEC (01,01)" TO SEC-HOLD-AREA.
048000 TH2-TEST-GF-2.
048100     PERFORM FIND-LEVEL-2-ENTRY
048200             VARYING IDX-1 FROM 1 BY 1 UNTIL IDX-1 GREATER 10
048300             AFTER IDX-2 FROM 1 BY 1 UNTIL IDX-2 = 10.
048400     IF TEST-CHECK = "PASS"
048500         PERFORM PASS
048600         GO TO TH2-WRITE-GF-2
048700     ELSE
048800         GO TO TH2-FAIL-GF-2.
048900 TH2-DELETE-GF-2.
049000     PERFORM DE-LETE.
049100     GO TO TH2-WRITE-GF-2.
049200 TH2-FAIL-GF-2.
049300     MOVE SEC-HOLD-AREA TO CORRECT-A.
049400     MOVE ENTRY-2 (01, 01) TO COMPUTED-A.
049500
049600     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
049700     PERFORM FAIL.
049800 TH2-WRITE-GF-2.
049900     PERFORM PRINT-DETAIL.
050000*
050100 TH2-INIT-GF-3.
050200     MOVE "TH2-TEST-GF-3      " TO PAR-NAME.
050300     MOVE SPACES TO TEST-CHECK.
050400     MOVE "SEC (10,01)" TO SEC-HOLD-AREA.
050500 TH2-TEST-GF-3.
050600     PERFORM FIND-LEVEL-2-ENTRY
050700             VARYING IDX-1 FROM 1 BY 1 UNTIL IDX-1 GREATER 10
050800             AFTER   IDX-2 FROM 1 BY 1 UNTIL IDX-2 = 10.
050900     IF TEST-CHECK = "PASS"
051000         PERFORM PASS
051100         GO TO TH2-WRITE-GF-3
051200     ELSE
051300         GO TO TH2-FAIL-GF-3.
051400 TH2-DELETE-GF-3.
051500     PERFORM DE-LETE.
051600     GO TO TH2-WRITE-GF-3.
051700 TH2-FAIL-GF-3.
051800     MOVE SEC-HOLD-AREA TO CORRECT-A.
051900     MOVE ENTRY-2 (10, 01) TO COMPUTED-A.
052000
052100     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
052200     PERFORM FAIL.
052300 TH2-WRITE-GF-3.
052400     PERFORM PRINT-DETAIL.
052500*
052600 TH2-INIT-GF-4.
052700     MOVE "TH2-TEST-GF-4      " TO PAR-NAME.
052800     MOVE SPACES TO TEST-CHECK.
052900     MOVE SPACES TO TEST-CHECK.
053000     MOVE "SEC (10,10)" TO SEC-HOLD-AREA.
053100 TH2-TEST-GF-4.
053200     PERFORM FIND-LEVEL-2-ENTRY
053300             VARYING IDX-1 FROM 2 BY 2 UNTIL IDX-1 GREATER 10
053400             AFTER   IDX-2 FROM 2 BY 2 UNTIL IDX-2 GREATER 10.
053500     IF TEST-CHECK = "PASS"
053600         PERFORM PASS
053700         GO TO TH2-WRITE-GF-4
053800     ELSE
053900         GO TO TH2-FAIL-GF-4.
054000 TH2-DELETE-GF-4.
054100     PERFORM DE-LETE.
054200     GO TO TH2-WRITE-GF-4.
054300 TH2-FAIL-GF-4.
054400     MOVE SEC-HOLD-AREA TO CORRECT-A.
054500     MOVE ENTRY-2 (10, 10) TO COMPUTED-A.
054600
054700     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
054800     PERFORM FAIL.
054900 TH2-WRITE-GF-4.
055000     PERFORM PRINT-DETAIL.
055100     GO TO TH3-INIT-GF-1.
055200*
055300 FIND-LEVEL-2-ENTRY.
055400     IF ENTRY-2 (IDX-1, IDX-2) = SEC-HOLD-AREA
055500         MOVE "PASS" TO TEST-CHECK.
055600*
055700 TH3-INIT-GF-1.
055800     MOVE "PERFORM VARYING LEV3" TO FEATURE.
055900     MOVE SPACES TO TEST-CHECK.
056000     MOVE "TH3-TEST-GF-1      " TO PAR-NAME.
056100     MOVE "ELEM (01,02,03)" TO ELEM-HOLD-AREA.
056200 TH3-TEST-GF-1.
056300     PERFORM FIND-LEVEL-3-ENTRY
056400             VARYING IDX-1 FROM 1 BY 1 UNTIL IDX-1 GREATER 10
056500             AFTER IDX-2 FROM 1 BY 1 UNTIL IDX-2 = 10
056600             AFTER IDX-3 FROM 1 BY 1 UNTIL IDX-3 = 10.
056700     IF TEST-CHECK = "PASS"
056800         PERFORM PASS
056900         GO TO TH3-WRITE-GF-1
057000     ELSE
057100         GO TO TH3-FAIL-GF-1.
057200 TH3-DELETE-GF-1.
057300     PERFORM DE-LETE.
057400     GO TO TH3-WRITE-GF-1.
057500 TH3-FAIL-GF-1.
057600     MOVE ELEM-HOLD-AREA TO CORRECT-A.
057700     MOVE ENTRY-3 (01, 02, 03) TO COMPUTED-A.
057800
057900     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
058000     PERFORM FAIL.
058100 TH3-WRITE-GF-1.
058200     PERFORM PRINT-DETAIL.
058300*
058400 TH3-INIT-GF-2.
058500     MOVE "TH3-TEST-GF-2      " TO PAR-NAME.
058600     MOVE "ELEM (10,10,10)" TO ELEM-HOLD-AREA.
058700     MOVE SPACES TO TEST-CHECK.
058800 TH3-TEST-GF-2.
058900     PERFORM FIND-LEVEL-3-ENTRY
059000             VARYING IDX-1 FROM 1 BY 1 UNTIL IDX-1 GREATER 10
059100             AFTER   IDX-2 FROM 1 BY 1 UNTIL IDX-2 GREATER 10
059200             AFTER   IDX-3 FROM 1 BY 1 UNTIL IDX-3 GREATER 10.
059300     IF TEST-CHECK = "PASS"
059400         PERFORM PASS
059500         GO TO TH3-WRITE-GF-2
059600     ELSE
059700         GO TO TH3-FAIL-GF-2.
059800 TH3-DELETE-GF-2.
059900     PERFORM DE-LETE.
060000     GO TO TH3-WRITE-GF-2.
060100 TH3-FAIL-GF-2.
060200     MOVE ELEM-HOLD-AREA TO CORRECT-A.
060300     MOVE ENTRY-3 (10, 10, 10) TO COMPUTED-A.
060400
060500     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
060600     PERFORM FAIL.
060700 TH3-WRITE-GF-2.
060800     PERFORM PRINT-DETAIL.
060900*
061000 TH3-INIT-GF-3.
061100     MOVE "TH3-TEST-GF-3      " TO PAR-NAME.
061200     MOVE "ELEM (08,07,06)" TO ELEM-HOLD-AREA.
061300     MOVE SPACES TO TEST-CHECK.
061400 TH3-TEST-GF-3.
061500     PERFORM FIND-LEVEL-3-ENTRY
061600             VARYING IDX-1 FROM 1 BY 1 UNTIL IDX-1 GREATER 10
061700             AFTER   IDX-2 FROM 1 BY 1 UNTIL IDX-2 = 10
061800             AFTER   IDX-3 FROM 1 BY 1 UNTIL IDX-3 = 10.
061900     IF TEST-CHECK = "PASS"
062000         PERFORM PASS
062100         GO TO TH3-WRITE-GF-3
062200     ELSE
062300         GO TO TH3-FAIL-GF-3.
062400 TH3-DELETE-GF-3.
062500     PERFORM DE-LETE.
062600     GO TO TH3-WRITE-GF-3.
062700 TH3-FAIL-GF-3.
062800     MOVE ELEM-HOLD-AREA TO CORRECT-A.
062900     MOVE ENTRY-3 (08, 07, 06) TO COMPUTED-A.
063000
063100     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
063200     PERFORM FAIL.
063300 TH3-WRITE-GF-3.
063400     PERFORM PRINT-DETAIL.
063500*
063600 TH3-INIT-GF-4.
063700     MOVE "TH3-TEST-GF-4      " TO PAR-NAME.
063800     MOVE SPACES TO TEST-CHECK.
063900     MOVE "ELEM (06,04,08)" TO ELEM-HOLD-AREA.
064000 TH3-TEST-GF-4.
064100     PERFORM FIND-LEVEL-3-ENTRY
064200             VARYING IDX-1 FROM 3 BY 3 UNTIL IDX-1 GREATER 10
064300             AFTER   IDX-2 FROM 2 BY 2 UNTIL IDX-2 GREATER 10
064400             AFTER   IDX-3 FROM 8 BY 8 UNTIL IDX-3 GREATER 10.
064500     IF TEST-CHECK = "PASS"
064600         PERFORM PASS
064700         GO TO TH3-WRITE-GF-4
064800     ELSE
064900         GO TO TH3-FAIL-GF-4.
065000 TH3-DELETE-GF-4.
065100     PERFORM DE-LETE.
065200     GO TO TH3-WRITE-GF-4.
065300 TH3-FAIL-GF-4.
065400     MOVE ELEM-HOLD-AREA TO CORRECT-A.
065500     MOVE ENTRY-3 (06, 04, 08) TO COMPUTED-A.
065600
065700     MOVE "PERFORM VARYING USING INDEX" TO RE-MARK.
065800     PERFORM FAIL.
065900 TH3-WRITE-GF-4.
066000     PERFORM PRINT-DETAIL.
066100     GO TO END-3LEVEL-TEST.
066200*
066300 FIND-LEVEL-3-ENTRY.
066400     IF ENTRY-3 (IDX-1, IDX-2, IDX-3) = ELEM-HOLD-AREA
066500         MOVE "PASS" TO TEST-CHECK.
066600*
066700 END-3LEVEL-TEST.
066800     EXIT.
066900 CCVS-EXIT SECTION.
067000 CCVS-999999.
067100     GO TO CLOSE-FILES.
