000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RW102A.
000400 AUTHOR.
000500     FEDERAL COMPILER TESTING CENTER.
000600 INSTALLATION.
000700     GENERAL SERVICES ADMINISTRATION
000800     AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
000900     SOFTWARE DEVELOPMENT OFFICE.
001000     5203 LEESBURG PIKE  SUITE 1100
001100     FALLS CHURCH VIRGINIA 22041.
001200
001300     PHONE   (703) 756-6153
001400
001500     " HIGH       ".
001600 DATE-WRITTEN.
001700     CCVS-74 VERSION 4.0 - 1980 JULY 1.
001800     CREATION DATE     /    VALIDATION DATE
001900     "4.2 ".
002000 SECURITY.
002100     NONE.
002200******************************************************************
002300*
002400*        THE ROUTINE RW102A TESTS BASIC REPORT WRITER MODULE
002500*    FUNCTIONS.  A SINGLE OUTPUT REPORT IS PRODUCED BY THE RWCS.
002600*    THE REPORT DESCRIPTION IN THIS ROUTINE CONTAINS
002700*            PAGE LIMIT 20
002800*            FIRST DETAIL 1, LAST DETAIL 20
002900*    WITHOUT THE OPTIONAL HEADING OR FOOTING PHRASES.  THE
003000*    ASSUMED VALUES FOR THESE PHRASES ARE
003100*            HEADING - VALUE OF 1,
003200*            FOOTING - VALUE OF 20.
003300*    A SINGLE DETAIL REPORT GROUP WITH 5 FORMAT 3 ENTRIES
003400*    SUBORDINATE TO THE FORMAT 1 ENTRY IS DEFINED FOR THE REPORT.
003500*
003600*        THE PRODECURE DIVISION FOR RW102 IS ESSENTIALLY THE SAME
003700*    AS THE PROCEDURE DIVISION FOR RW101.  THE STATEMENTS WHICH
003800*    MOVE LINE-COUNTER TO THE WORKING-STORAGE RECORD AREA ARE
003900*    NOT INCLUDED SINCE LINE-COUNTER IS REFERENCED IN A SOURCE
004000*    CLAUSE.
004100*
004200*        THE OUTPUT OF THIS ROUTINE CONSISTS OF AN OUTPUT REPORT
004300*    IN THE USUAL AUDIT ROUTINE FORMAT PRODUCED USING WRITE
004400*    STATEMENTS AND A REPORT PRODUCED BY THE RWCS.  BOTH REPORTS
004500*    MUST BE CAREFULLY EXAMINED TO VERIFY THAT THE TESTS IN
004600*    RW102 WERE EXECUTED CORRECTLY.
004700*
004800*        THE OUTPUT REPORT GENERATED BY THE RWCS CONSISTS OF
004900*    20 LINES.  ON THE OUTPUT REPORT, THE WORKING-STORAGE LINE
005000*    COUNT AND LINE-COUNTER ARE EQUAL TO THE LINE NUMBER ON
005100*    WHICH THE LINE IS DISPLAYED.
005200*
005300******************************************************************
005400*
005500*    REFERENCE   AMERICAN NATIONAL STANDARD PROGRAMMING
005600*                    LANGUAGE COBOL, X3.23-1974
005700*        SECTION VIII - REPORT WRITER MODULE
005800*
005900******************************************************************
006000 ENVIRONMENT DIVISION.
006100 CONFIGURATION SECTION.
006200 SOURCE-COMPUTER.
006300     XXXXX082.
006400 OBJECT-COMPUTER.
006500     XXXXX083.
006600 INPUT-OUTPUT SECTION.
006700 FILE-CONTROL.
006800     SELECT PRINT-FILE ASSIGN TO
006900     XXXXX055.
007000     SELECT RW-FS2 ASSIGN TO
007100     XXXXX049.
007200 DATA DIVISION.
007300 FILE SECTION.
007400 FD  PRINT-FILE
007500     LABEL RECORDS
007600     XXXXX084
007700     DATA RECORD IS PRINT-REC DUMMY-RECORD.
007800 01  PRINT-REC PICTURE X(120).
007900 01  DUMMY-RECORD PICTURE X(120).
008000 FD  RW-FS2
008100     LABEL RECORDS ARE STANDARD
008200C    VALUE OF
008300C    XXXXX074
008400C        IS
008500C    XXXXX075
008600G    XXXXX069
008700     REPORT RW-FS2-REPORT-1.
008800 WORKING-STORAGE SECTION.
008900 01  LC-ERRORS  PIC 99  VALUE 0.
009000 01  PC-ERRORS  PIC 99  VALUE 0.
009100 01  WS-COUNTER  PIC 9(6)  VALUE ZERO.
009200 01  TEST-RESULTS.
009300     02 FILLER                    PICTURE X VALUE SPACE.
009400     02 FEATURE                   PICTURE X(20) VALUE SPACE.
009500     02 FILLER                    PICTURE X VALUE SPACE.
009600     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
009700     02 FILLER                    PICTURE X  VALUE SPACE.
009800     02  PAR-NAME.
009900       03 FILLER PICTURE X(12) VALUE SPACE.
010000       03  PARDOT-X PICTURE X  VALUE SPACE.
010100       03 DOTVALUE PICTURE 99  VALUE ZERO.
010200       03 FILLER PIC X(5) VALUE SPACE.
010300     02 FILLER PIC X(10) VALUE SPACE.
010400     02 RE-MARK PIC X(61).
010500 01  TEST-COMPUTED.
010600     02 FILLER PIC X(30) VALUE SPACE.
010700     02 FILLER PIC X(17) VALUE "       COMPUTED=".
010800     02 COMPUTED-X.
010900     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
011000     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
011100     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
011200     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
011300     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
011400     03       CM-18V0 REDEFINES COMPUTED-A.
011500         04 COMPUTED-18V0                   PICTURE -9(18).
011600         04 FILLER                          PICTURE X.
011700     03 FILLER PIC X(50) VALUE SPACE.
011800 01  TEST-CORRECT.
011900     02 FILLER PIC X(30) VALUE SPACE.
012000     02 FILLER PIC X(17) VALUE "       CORRECT =".
012100     02 CORRECT-X.
012200     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
012300     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
012400     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
012500     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
012600     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
012700     03      CR-18V0 REDEFINES CORRECT-A.
012800         04 CORRECT-18V0                    PICTURE -9(18).
012900         04 FILLER                          PICTURE X.
013000     03 FILLER PIC X(50) VALUE SPACE.
013100 01  CCVS-C-1.
013200     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
013300-    "SS  PARAGRAPH-NAME
013400-    "        REMARKS".
013500     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
013600 01  CCVS-C-2.
013700     02 FILLER PICTURE IS X VALUE IS SPACE.
013800     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
013900     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
014000     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
014100     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
014200 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
014300 01  REC-CT PICTURE 99 VALUE ZERO.
014400 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
014500 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
014600 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
014700 01  PASS-COUNTER PIC 999 VALUE ZERO.
014800 01  TOTAL-ERROR PIC 999 VALUE ZERO.
014900 01  ERROR-HOLD PIC 999 VALUE ZERO.
015000 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
015100 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
015200 01  CCVS-H-1.
015300     02  FILLER   PICTURE X(27)  VALUE SPACE.
015400     02 FILLER PICTURE X(67) VALUE
015500     " FEDERAL COMPILER TESTING CENTER COBOL COMPILER VALIDATION
015600-    " SYSTEM".
015700     02  FILLER     PICTURE X(26)  VALUE SPACE.
015800 01  CCVS-H-2.
015900     02 FILLER PICTURE X(52) VALUE IS
016000     "CCVS74 NCC  COPY, NOT FOR DISTRIBUTION.".
016100     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
016200     02 TEST-ID PICTURE IS X(9).
016300     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
016400 01  CCVS-H-3.
016500     02  FILLER PICTURE X(34) VALUE
016600     " FOR OFFICIAL USE ONLY    ".
016700     02  FILLER PICTURE X(58) VALUE
016800     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
016900     02  FILLER PICTURE X(28) VALUE
017000     "  COPYRIGHT   1974 ".
017100 01  CCVS-E-1.
017200     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
017300     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
017400     02 ID-AGAIN PICTURE IS X(9).
017500     02 FILLER PICTURE X(45) VALUE IS
017600     " NTIS DISTRIBUTION COBOL 74".
017700 01  CCVS-E-2.
017800     02  FILLER                   PICTURE X(31)  VALUE
017900     SPACE.
018000     02  FILLER                   PICTURE X(21)  VALUE SPACE.
018100     02 CCVS-E-2-2.
018200         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
018300         03 FILLER PICTURE IS X VALUE IS SPACE.
018400         03 ENDER-DESC PIC X(44) VALUE "ERRORS ENCOUNTERED".
018500 01  CCVS-E-3.
018600     02  FILLER PICTURE X(22) VALUE
018700     " FOR OFFICIAL USE ONLY".
018800     02  FILLER PICTURE X(12) VALUE SPACE.
018900     02  FILLER PICTURE X(58) VALUE
019000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
019100     02  FILLER PICTURE X(13) VALUE SPACE.
019200     02 FILLER PIC X(15) VALUE " COPYRIGHT 1974".
019300 01  CCVS-E-4.
019400     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
019500     02 FILLER PIC XXXX VALUE " OF ".
019600     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
019700     02 FILLER PIC X(40) VALUE
019800      "  TESTS WERE EXECUTED SUCCESSFULLY".
019900 01  XXINFO.
020000     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
020100     02 INFO-TEXT.
020200     04 FILLER PIC X(20) VALUE SPACE.
020300     04 XXCOMPUTED PIC X(20).
020400     04 FILLER PIC X(5) VALUE SPACE.
020500     04 XXCORRECT PIC X(20).
020600 01  HYPHEN-LINE.
020700     02 FILLER PICTURE IS X VALUE IS SPACE.
020800     02 FILLER PICTURE IS X(65) VALUE IS "************************
020900-    "*****************************************".
021000     02 FILLER PICTURE IS X(54) VALUE IS "************************
021100-    "******************************".
021200 01  CCVS-PGM-ID PIC X(6) VALUE
021300     "RW102A".
021400 REPORT SECTION.
021500 RD  RW-FS2-REPORT-1
021600     PAGE LIMIT 20
021700     FIRST DETAIL 1
021800     LAST DETAIL 20.
021900 01  RW-FS2-GROUP
022000     LINE NUMBER IS PLUS 1
022100     TYPE IS DETAIL.
022200     03  COLUMN 5  PIC X(18)
022300             VALUE IS "RW-FS2 DETAIL LINE".
022400     03  COLUMN 26  PIC  X(31)
022500             VALUE "WORKING-STORAGE LINE COUNTER = ".
022600     03  COLUMN 57  PIC 9(3)  SOURCE IS WS-COUNTER.
022700     03  COLUMN 62  PIC X(20)
022800             VALUE "RWCS LINE-COUNTER = ".
022900     03  COLUMN NUMBER IS 83  PIC 9(4)
023000         SOURCE IS LINE-COUNTER.
023100 PROCEDURE DIVISION.
023200 CCVS1 SECTION.
023300 OPEN-FILES.
023400     OPEN     OUTPUT PRINT-FILE.
023500     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
023600     MOVE    SPACE TO TEST-RESULTS.
023700     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
023800     GO TO CCVS1-EXIT.
023900 CLOSE-FILES.
024000     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
024100 TERMINATE-CCVS.
024200S    EXIT PROGRAM.
024300STERMINATE-CALL.
024400     STOP     RUN.
024500 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
024600 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
024700 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
024800 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
024900     MOVE "****TEST DELETED****" TO RE-MARK.
025000 PRINT-DETAIL.
025100     IF REC-CT NOT EQUAL TO ZERO
025200             MOVE "." TO PARDOT-X
025300             MOVE REC-CT TO DOTVALUE.
025400     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
025500     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
025600        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
025700          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
025800     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
025900     MOVE SPACE TO CORRECT-X.
026000     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
026100     MOVE     SPACE TO RE-MARK.
026200 HEAD-ROUTINE.
026300     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026400     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
026500     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
026600 COLUMN-NAMES-ROUTINE.
026700     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026800     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
027000 END-ROUTINE.
027100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
027200 END-RTN-EXIT.
027300     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027400 END-ROUTINE-1.
027500      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
027600      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
027700      ADD PASS-COUNTER TO ERROR-HOLD.
027800*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
027900      MOVE PASS-COUNTER TO CCVS-E-4-1.
028000      MOVE ERROR-HOLD TO CCVS-E-4-2.
028100      MOVE CCVS-E-4 TO CCVS-E-2-2.
028200      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
028300  END-ROUTINE-12.
028400      MOVE "TEST(S) FAILED" TO ENDER-DESC.
028500     IF       ERROR-COUNTER IS EQUAL TO ZERO
028600         MOVE "NO " TO ERROR-TOTAL
028700         ELSE
028800         MOVE ERROR-COUNTER TO ERROR-TOTAL.
028900     MOVE     CCVS-E-2 TO DUMMY-RECORD.
029000     PERFORM WRITE-LINE.
029100 END-ROUTINE-13.
029200     IF DELETE-CNT IS EQUAL TO ZERO
029300         MOVE "NO " TO ERROR-TOTAL  ELSE
029400         MOVE DELETE-CNT TO ERROR-TOTAL.
029500     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
029600     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029700      IF   INSPECT-COUNTER EQUAL TO ZERO
029800          MOVE "NO " TO ERROR-TOTAL
029900      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
030000      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
030100      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030200     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030300 WRITE-LINE.
030400     ADD 1 TO RECORD-COUNT.
030500Y    IF RECORD-COUNT GREATER 50
030600Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
030700Y        MOVE SPACE TO DUMMY-RECORD
030800Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
030900Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
031000Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
031100Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
031200Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
031300Y        MOVE ZERO TO RECORD-COUNT.
031400     PERFORM WRT-LN.
031500 WRT-LN.
031600     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
031700     MOVE SPACE TO DUMMY-RECORD.
031800 BLANK-LINE-PRINT.
031900     PERFORM WRT-LN.
032000 FAIL-ROUTINE.
032100     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
032200     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
032300     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
032400     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032500     GO TO FAIL-ROUTINE-EX.
032600 FAIL-ROUTINE-WRITE.
032700     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
032800     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
032900 FAIL-ROUTINE-EX. EXIT.
033000 BAIL-OUT.
033100     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
033200     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
033300 BAIL-OUT-WRITE.
033400     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
033500     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033600 BAIL-OUT-EX. EXIT.
033700 CCVS1-EXIT.
033800     EXIT.
033900 SECT-RW102-0001 SECTION.
034000 RW102-INIT.
034100     OPEN OUTPUT RW-FS2.
034200 INIT-TEST-03.
034300     INITIATE RW-FS2-REPORT-1.
034400*
034500*         AFTER EXECUTION OF THE INITIATE STATEMENT FOR A REPORT,
034600*    THE REPORT LINE-COUNTER SHOULD BE ZERO AND PAGE-COUNTER
034700*    SHOULD BE ONE.
034800*    REFERENCE   PAGE VIII-53, 3.2.4(1)B AND C, INITIATE STATEMENT
034900*
035000 INIT-TEST-03-01.
035100     IF LINE-COUNTER EQUAL TO ZERO
035200         PERFORM PASS
035300         GO TO INIT-WRITE-03-01.
035400 INIT-FAIL-03-01.
035500     PERFORM FAIL.
035600     MOVE ZERO TO CORRECT-18V0.
035700     MOVE LINE-COUNTER TO COMPUTED-18V0.
035800     MOVE "LINE-COUNTER AFTER INITIATE" TO RE-MARK.
035900 INIT-WRITE-03-01.
036000     MOVE "INIT-TEST-03" TO PAR-NAME.
036100     MOVE 1 TO REC-CT.
036200     MOVE "INITIATE REPORT" TO FEATURE.
036300     PERFORM PRINT-DETAIL.
036400 INIT-TEST-03-02.
036500     IF PAGE-COUNTER EQUAL TO 1
036600         PERFORM PASS
036700             GO TO INIT-WRITE-03-02.
036800 INIT-FAIL-03-02.
036900     PERFORM FAIL.
037000     MOVE 1 TO CORRECT-18V0.
037100     MOVE PAGE-COUNTER TO COMPUTED-18V0.
037200     MOVE "PAGE-COUNTER AFTER INITIATE" TO RE-MARK.
037300 INIT-WRITE-03-02.
037400     MOVE 2 TO REC-CT.
037500     PERFORM PRINT-DETAIL.
037600 GENER-TEST-07.
037700*
037800*        THIS TEST EXECUTES A GENERATE STATEMENT FOR THE DETAIL
037900*    REPORT GROUP 20 TIMES.
038000*    REFERENCE  PAGE VIII-51, 3.1.4(2), (6)B, GENERATE STATEMENT
038100*
038200     PERFORM GENER-DETAIL-LINE 20 TIMES.
038300*
038400*    OUTPUT REPORT INFO
038500*        TWENTY DETAIL LINES SINGLE SPACED SHOULD BE PRESENTED
038600*    ON LINES 1 THROUGH 20 OF THE FIRST REPORT PAGE.
038700*    REFERENCE  PAGE VIII-18, 2.5.5.8.1(4)B, BODY GROUP PRE RULES
038800*
038900 GENER-TEST-07-01.
039000     IF LC-ERRORS EQUAL TO ZERO
039100         PERFORM PASS
039200         GO TO GENER-WRITE-07-01.
039300 GENER-FAIL-07-01.
039400     PERFORM FAIL.
039500     MOVE LC-ERRORS TO COMPUTED-18V0.
039600     MOVE ZERO TO CORRECT-18V0.
039700     MOVE "NUMBER OF LINE-COUNTER ERRORS" TO RE-MARK.
039800 GENER-WRITE-07-01.
039900     MOVE "GENER-TEST-7" TO PAR-NAME.
040000     MOVE "GENERATE 20 LINES" TO FEATURE.
040100     MOVE 1 TO REC-CT.
040200     PERFORM PRINT-DETAIL.
040300     GO TO GENER-TEST-07-02.
040400 GENER-DETAIL-LINE.
040500     ADD 1 TO WS-COUNTER.
040600     GENERATE RW-FS2-GROUP.
040700     IF LINE-COUNTER NOT EQUAL TO WS-COUNTER
040800         ADD 1 TO LC-ERRORS.
040900*
041000*        THE LINE-COUNTER SETTING AFTER THE GENERATE STATEMENT
041100*    IS EQUAL TO THE LINE NUMBER ON WHICH THE PRINT LINE WAS
041200*    PRESENTED.
041300*    REFERENCE  PAGE VIII-19, 2.5.5.8.1(6)D, FINAL L-C SETTING
041400*
041500     IF PAGE-COUNTER NOT EQUAL TO 1
041600         ADD 1 TO PC-ERRORS.
041700*
041800*        EXECUTION OF THE GENERATE STATEMENT SHOULD NOT CHANGE
041900*    THE VALUE OF PAGE-COUNTER.  IT SHOULD STILL BE EQUAL TO ONE.
042000*    REFERENCE  PAGE VIII-4, 2.4.4, PAGE-COUNTER RULES.
042100*
042200 GENER-TEST-07-02.
042300     IF PC-ERRORS EQUAL TO ZERO
042400         PERFORM PASS
042500         GO TO GENER-WRITE-07-02.
042600 GENER-FAIL-07-02.
042700     PERFORM FAIL.
042800     MOVE PC-ERRORS TO COMPUTED-18V0.
042900     MOVE ZERO TO CORRECT-18V0.
043000     MOVE "NUMBER OF PAGE-COUNTER ERRORS" TO RE-MARK.
043100 GENER-WRITE-07-02.
043200     MOVE 2 TO REC-CT.
043300     PERFORM PRINT-DETAIL.
043400 TERM-TEST-STATE.
043500     TERMINATE RW-FS2-REPORT-1.
043600 CLOSE-RW-FS2.
043700     CLOSE RW-FS2.
043800 TERM-WRITE-02.
043900     MOVE ZERO TO REC-CT.
044000     MOVE "TERMINATE REPORT" TO FEATURE.
044100     MOVE "TERM-TEST-02" TO PAR-NAME.
044200     MOVE "1 PAGE REPORT" TO COMPUTED-A.
044300     MOVE "20 LINES PER PAGE" TO CORRECT-A.
044400     MOVE "CHECK RWCS OUTPUT REPORT" TO RE-MARK.
044500     PERFORM PRINT-DETAIL.
044600 EXIT-RW102.
044700     EXIT.
044800 CCVS-EXIT SECTION.
044900 CCVS-999999.
045000     GO TO CLOSE-FILES.
