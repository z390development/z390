000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RL111A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*                                                              *
002200*     THIS PROGRAM WILL TEST THE SYNTACTICAL CONSTRUCTS AND    *
002300*     SEMANTIC ACTIONS ASSOCIATED WITH THE FOLLOWING CLAUSES:  *
002400*                                                              *
002500*            - ACCESS                                          *
002600*            - READ                                            *
002700*            - WRITE                                           *
002800*            - REWRITE                                         *
002900*                                                              *
003000*     1) THE PROGRAM WILL CREATE A RELATIVE I-O FILE           *
003100*     2) THEN IT WILL UPDATE SELECTIVE RECORDS OF THE FILE     *
003200*     3) THE FILE STATUS CONTENTS ARE CAPTURED AND TESTED FOR  *
003300*        ACCURACY FOR EACH "OPEN", "CLOSE", "READ" AND         *
003400*        "REWRITE" STATEMENT USED.                             *
003500*     4) THE "READ", "WRITE" AND "REWRITE" STATEMENT WILL BE   *
003600*        USED WITH THE APPROPRIATE "AT END", "NOT AT END"      *
003700*        "INVALID KEY" AND "NOT INVALID KEY" PHRASES.          *
003800*                                                              *
003900****************************************************************
004000 ENVIRONMENT DIVISION.
004100 CONFIGURATION SECTION.
004200 SOURCE-COMPUTER.
004300     XXXXX082.
004400 OBJECT-COMPUTER.
004500     XXXXX083.
004600 INPUT-OUTPUT SECTION.
004700 FILE-CONTROL.
004800     SELECT PRINT-FILE ASSIGN TO
004900     XXXXX055.
005000     SELECT   RL-FS2 ASSIGN
005100     XXXXX022
005200              ORGANIZATION RELATIVE
005300              ACCESS IS SEQUENTIAL
005400              RELATIVE KEY IS RL-FS2-KEY
005500              STATUS RL-FS2-STATUS.
005600     SELECT   RL-FS3 ASSIGN
005700     XXXXX022
005800              ORGANIZATION RELATIVE
005900              ACCESS IS RANDOM
006000              RELATIVE KEY IS RL-FS3-KEY
006100              STATUS RL-FS3-STATUS.
006200 DATA DIVISION.
006300 FILE SECTION.
006400 FD  PRINT-FILE.
006500 01  PRINT-REC PICTURE X(120).
006600 01  DUMMY-RECORD PICTURE X(120).
006700 FD  RL-FS2
006800C    VALUE OF
006900C    XXXXX074
007000C    IS
007100C    XXXXX076
007200G    XXXXX069
007300     LABEL RECORDS ARE STANDARD
007400     BLOCK CONTAINS 1 RECORDS
007500     DATA RECORD RL-FS2R1-F-G-240.
007600 01  RL-FS2R1-F-G-240.
007700     05 RL-FS2-WRK-120 PIC X(120).
007800     05 RL-FS2-GRP-120.
007900        10 RL-FS2-WRK-XN-0001-O120F
008000                        PICTURE X OCCURS 120 TIMES.
008100 FD  RL-FS3
008200C    VALUE OF
008300C    XXXXX074
008400C    IS
008500C    XXXXX076
008600G    XXXXX069
008700     LABEL RECORDS ARE STANDARD
008800     BLOCK CONTAINS 1 RECORDS
008900     DATA RECORD RL-FS3R1-F-G-240.
009000 01  RL-FS3R1-F-G-240.
009100     05 RL-FS3-WRK-120 PIC X(120).
009200     05 RL-FS3-GRP-120.
009300        10 RL-FS3-WRK-XN-0001-O120F
009400                        PICTURE X OCCURS 120 TIMES.
009500 WORKING-STORAGE SECTION.
009600 01  GRP-0001.
009700     05 RL-FS2-KEY   PIC 9(8)  VALUE ZERO.
009800     05 RL-FS3-KEY   PIC 9(8)  VALUE ZERO.
009900     05 WRK-CS-09V00-012  PIC S9(9) USAGE COMP  VALUE ZERO.
010000     05 WRK-CS-09V00-013  PIC S9(9) USAGE COMP  VALUE ZERO.
010100     05 WRK-CS-09V00-014  PIC S9(9) USAGE COMP  VALUE ZERO.
010200     05 WRK-CS-09V00-015  PIC S9(9) USAGE COMP  VALUE ZERO.
010300     05 WRK-CS-09V00-016  PIC S9(9) USAGE COMP  VALUE ZERO.
010400     05 WRK-CS-09V00-017  PIC S9(9) USAGE COMP  VALUE ZERO.
010500     05 WRK-CS-09V00-018  PIC S9(9) USAGE COMP  VALUE ZERO.
010600     05 RL-FS2-STATUS     PIC  XX  VALUE  SPACE.
010700     05 RL-FS3-STATUS     PIC  XX  VALUE SPACE.
010800     05 WRK-XN-0002-001   PIC  X(2) VALUE  SPACE.
010900     05 WRK-XN-0002-002   PIC  X(2) VALUE  SPACE.
011000     05 WRK-XN-0002-003   PIC  X(2) VALUE  SPACE.
011100     05 WRK-XN-0002-004   PIC  X(2) VALUE  SPACE.
011200     05 WRK-XN-0002-005   PIC  X(2) VALUE  SPACE.
011300     05 WRK-XN-0002-006   PIC  X(2) VALUE  SPACE.
011400     05 WRK-XN-0002-007   PIC  X(2) VALUE  SPACE.
011500     05 WRK-XN-0002-008   PIC  X(2) VALUE  SPACE.
011600     05 WRK-XN-0002-009   PIC  X(2) VALUE  SPACE.
011700 01  FILE-RECORD-INFORMATION-REC.
011800     03 FILE-RECORD-INFO-SKELETON.
011900        05 FILLER                 PICTURE X(48)       VALUE
012000             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
012100        05 FILLER                 PICTURE X(46)       VALUE
012200             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
012300        05 FILLER                 PICTURE X(26)       VALUE
012400             ",LFIL=000000,ORG=  ,LBLR= ".
012500        05 FILLER                 PICTURE X(37)       VALUE
012600             ",RECKEY=                             ".
012700        05 FILLER                 PICTURE X(38)       VALUE
012800             ",ALTKEY1=                             ".
012900        05 FILLER                 PICTURE X(38)       VALUE
013000             ",ALTKEY2=                             ".
013100        05 FILLER                 PICTURE X(7)        VALUE SPACE.
013200     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
013300        05 FILE-RECORD-INFO-P1-120.
013400           07 FILLER              PIC X(5).
013500           07 XFILE-NAME           PIC X(6).
013600           07 FILLER              PIC X(8).
013700           07 XRECORD-NAME         PIC X(6).
013800           07 FILLER              PIC X(1).
013900           07 REELUNIT-NUMBER     PIC 9(1).
014000           07 FILLER              PIC X(7).
014100           07 XRECORD-NUMBER       PIC 9(6).
014200           07 FILLER              PIC X(6).
014300           07 UPDATE-NUMBER       PIC 9(2).
014400           07 FILLER              PIC X(5).
014500           07 ODO-NUMBER          PIC 9(4).
014600           07 FILLER              PIC X(5).
014700           07 XPROGRAM-NAME        PIC X(5).
014800           07 FILLER              PIC X(7).
014900           07 XRECORD-LENGTH       PIC 9(6).
015000           07 FILLER              PIC X(7).
015100           07 CHARS-OR-RECORDS    PIC X(2).
015200           07 FILLER              PIC X(1).
015300           07 XBLOCK-SIZE          PIC 9(4).
015400           07 FILLER              PIC X(6).
015500           07 RECORDS-IN-FILE     PIC 9(6).
015600           07 FILLER              PIC X(5).
015700           07 XFILE-ORGANIZATION   PIC X(2).
015800           07 FILLER              PIC X(6).
015900           07 XLABEL-TYPE          PIC X(1).
016000        05 FILE-RECORD-INFO-P121-240.
016100           07 FILLER              PIC X(8).
016200           07 XRECORD-KEY          PIC X(29).
016300           07 FILLER              PIC X(9).
016400           07 ALTERNATE-KEY1      PIC X(29).
016500           07 FILLER              PIC X(9).
016600           07 ALTERNATE-KEY2      PIC X(29).
016700           07 FILLER              PIC X(7).
016800 01  WRK-XN-00001-1              PIC X.
016900 01  WRK-XN-00001-2              PIC X.
017000 01  TEST-RESULTS.
017100     02 FILLER                   PIC X      VALUE SPACE.
017200     02 FEATURE                  PIC X(20)  VALUE SPACE.
017300     02 FILLER                   PIC X      VALUE SPACE.
017400     02 P-OR-F                   PIC X(5)   VALUE SPACE.
017500     02 FILLER                   PIC X      VALUE SPACE.
017600     02  PAR-NAME.
017700       03 FILLER                 PIC X(19)  VALUE SPACE.
017800       03  PARDOT-X              PIC X      VALUE SPACE.
017900       03 DOTVALUE               PIC 99     VALUE ZERO.
018000     02 FILLER                   PIC X(8)   VALUE SPACE.
018100     02 RE-MARK                  PIC X(61).
018200 01  TEST-COMPUTED.
018300     02 FILLER                   PIC X(30)  VALUE SPACE.
018400     02 FILLER                   PIC X(17)  VALUE
018500            "       COMPUTED=".
018600     02 COMPUTED-X.
018700     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
018800     03 COMPUTED-N               REDEFINES COMPUTED-A
018900                                 PIC -9(9).9(9).
019000     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
019100     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
019200     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
019300     03       CM-18V0 REDEFINES COMPUTED-A.
019400         04 COMPUTED-18V0                    PIC -9(18).
019500         04 FILLER                           PIC X.
019600     03 FILLER PIC X(50) VALUE SPACE.
019700 01  TEST-CORRECT.
019800     02 FILLER PIC X(30) VALUE SPACE.
019900     02 FILLER PIC X(17) VALUE "       CORRECT =".
020000     02 CORRECT-X.
020100     03 CORRECT-A                  PIC X(20) VALUE SPACE.
020200     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
020300     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
020400     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
020500     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
020600     03      CR-18V0 REDEFINES CORRECT-A.
020700         04 CORRECT-18V0                     PIC -9(18).
020800         04 FILLER                           PIC X.
020900     03 FILLER PIC X(2) VALUE SPACE.
021000     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
021100 01  CCVS-C-1.
021200     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
021300-    "SS  PARAGRAPH-NAME
021400-    "       REMARKS".
021500     02 FILLER                     PIC X(20)    VALUE SPACE.
021600 01  CCVS-C-2.
021700     02 FILLER                     PIC X        VALUE SPACE.
021800     02 FILLER                     PIC X(6)     VALUE "TESTED".
021900     02 FILLER                     PIC X(15)    VALUE SPACE.
022000     02 FILLER                     PIC X(4)     VALUE "FAIL".
022100     02 FILLER                     PIC X(94)    VALUE SPACE.
022200 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
022300 01  REC-CT                        PIC 99       VALUE ZERO.
022400 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
022500 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
022600 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
022700 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
022800 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
022900 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
023000 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
023100 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
023200 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
023300 01  CCVS-H-1.
023400     02  FILLER                    PIC X(39)    VALUE SPACES.
023500     02  FILLER                    PIC X(42)    VALUE
023600     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
023700     02  FILLER                    PIC X(39)    VALUE SPACES.
023800 01  CCVS-H-2A.
023900   02  FILLER                        PIC X(40)  VALUE SPACE.
024000   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
024100   02  FILLER                        PIC XXXX   VALUE
024200     "4.2 ".
024300   02  FILLER                        PIC X(28)  VALUE
024400            " COPY - NOT FOR DISTRIBUTION".
024500   02  FILLER                        PIC X(41)  VALUE SPACE.
024600
024700 01  CCVS-H-2B.
024800   02  FILLER                        PIC X(15)  VALUE
024900            "TEST RESULT OF ".
025000   02  TEST-ID                       PIC X(9).
025100   02  FILLER                        PIC X(4)   VALUE
025200            " IN ".
025300   02  FILLER                        PIC X(12)  VALUE
025400     " HIGH       ".
025500   02  FILLER                        PIC X(22)  VALUE
025600            " LEVEL VALIDATION FOR ".
025700   02  FILLER                        PIC X(58)  VALUE
025800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025900 01  CCVS-H-3.
026000     02  FILLER                      PIC X(34)  VALUE
026100            " FOR OFFICIAL USE ONLY    ".
026200     02  FILLER                      PIC X(58)  VALUE
026300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
026400     02  FILLER                      PIC X(28)  VALUE
026500            "  COPYRIGHT   1985 ".
026600 01  CCVS-E-1.
026700     02 FILLER                       PIC X(52)  VALUE SPACE.
026800     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
026900     02 ID-AGAIN                     PIC X(9).
027000     02 FILLER                       PIC X(45)  VALUE SPACES.
027100 01  CCVS-E-2.
027200     02  FILLER                      PIC X(31)  VALUE SPACE.
027300     02  FILLER                      PIC X(21)  VALUE SPACE.
027400     02 CCVS-E-2-2.
027500         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
027600         03 FILLER                   PIC X      VALUE SPACE.
027700         03 ENDER-DESC               PIC X(44)  VALUE
027800            "ERRORS ENCOUNTERED".
027900 01  CCVS-E-3.
028000     02  FILLER                      PIC X(22)  VALUE
028100            " FOR OFFICIAL USE ONLY".
028200     02  FILLER                      PIC X(12)  VALUE SPACE.
028300     02  FILLER                      PIC X(58)  VALUE
028400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
028500     02  FILLER                      PIC X(13)  VALUE SPACE.
028600     02 FILLER                       PIC X(15)  VALUE
028700             " COPYRIGHT 1985".
028800 01  CCVS-E-4.
028900     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
029000     02 FILLER                       PIC X(4)   VALUE " OF ".
029100     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
029200     02 FILLER                       PIC X(40)  VALUE
029300      "  TESTS WERE EXECUTED SUCCESSFULLY".
029400 01  XXINFO.
029500     02 FILLER                       PIC X(19)  VALUE
029600            "*** INFORMATION ***".
029700     02 INFO-TEXT.
029800       04 FILLER                     PIC X(8)   VALUE SPACE.
029900       04 XXCOMPUTED                 PIC X(20).
030000       04 FILLER                     PIC X(5)   VALUE SPACE.
030100       04 XXCORRECT                  PIC X(20).
030200     02 INF-ANSI-REFERENCE           PIC X(48).
030300 01  HYPHEN-LINE.
030400     02 FILLER  PIC IS X VALUE IS SPACE.
030500     02 FILLER  PIC IS X(65)    VALUE IS "************************
030600-    "*****************************************".
030700     02 FILLER  PIC IS X(54)    VALUE IS "************************
030800-    "******************************".
030900 01  CCVS-PGM-ID                     PIC X(9)   VALUE
031000     "RL111A".
031100 PROCEDURE DIVISION.
031200 DECLARATIVES.
031300 RL-FS2-01 SECTION.
031400     USE AFTER STANDARD EXCEPTION PROCEDURE ON RL-FS2.
031500 RL-FS2-01-01.
031600     ADD     1 TO  WRK-CS-09V00-013.
031700     GO TO   RL-FS2-01-03
031800             RL-FS2-01-05
031900             DEPENDING ON  WRK-CS-09V00-012.
032000     GO TO   RL-FS2-01-EXIT.
032100 RL-FS2-01-03.
032200*ENTRY FROM SEGMENT REL-TEST-009.
032300*    SHOULD NOT ENTER HERE UNLESS SPACE ALLOCATION TOO SMALL.
032400     ADD    1   TO WRK-CS-09V00-014.
032500 RL-FS2-01-05.
032600     ADD     1 TO WRK-CS-09V00-017.
032700     IF      XRECORD-NUMBER (2) EQUAL TO 500
032800              MOVE   RL-FS2-STATUS TO WRK-XN-0002-002
032900              MOVE  "10" TO WRK-XN-0002-003.
033000 RL-FS2-01-EXIT.
033100     EXIT.
033200 RL-FS2-02 SECTION.
033300     USE AFTER STANDARD EXCEPTION PROCEDURE ON RL-FS3.
033400 RL-FS2-02-01.
033500     IF      PAR-NAME = "REL-TEST-060-1"
033600             GO TO RL-FS2-02-STAT.
033700     ADD     1 TO  WRK-CS-09V00-013.
033800*    GO TO   RL-FS2-02-03
033900*            RL-FS2-02-05
034000*            DEPENDING ON  WRK-CS-09V00-012.
034100     GO TO D-CLOSE-FILES.
034200 RL-FS2-02-STAT.
034300     IF RL-FS3-STATUS = "48"
034400          PERFORM D-PASS
034500     ELSE
034600          MOVE   "WRITE TO FILE OPENED INPUT NOT ALLOWED"
034700               TO RE-MARK
034800         PERFORM D-FAIL.
034900     PERFORM D-PRINT-DETAIL.
035000 D-CLOSE-FILES.
035100     CLOSE RL-FS3.
035200     PERFORM D-END-ROUTINE THRU D-END-ROUTINE-13.
035300     CLOSE PRINT-FILE.
035400 D-TERMINATE-CCVS.
035500S    EXIT PROGRAM.
035600SD-TERMINATE-CALL.
035700     STOP     RUN.
035800 D-PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
035900 D-FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
036000 D-PRINT-DETAIL.
036100     IF REC-CT NOT EQUAL TO ZERO
036200             MOVE "." TO PARDOT-X
036300             MOVE REC-CT TO DOTVALUE.
036400     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM D-WRITE-LINE.
036500     IF P-OR-F EQUAL TO "FAIL*"  PERFORM D-WRITE-LINE
036600        PERFORM D-FAIL-ROUTINE THRU D-FAIL-ROUTINE-EX
036700          ELSE PERFORM D-BAIL-OUT THRU D-BAIL-OUT-EX.
036800     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
036900     MOVE SPACE TO CORRECT-X.
037000     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
037100     MOVE     SPACE TO RE-MARK.
037200 D-END-ROUTINE.
037300     MOVE HYPHEN-LINE TO DUMMY-RECORD.
037400     PERFORM D-WRITE-LINE 5 TIMES.
037500 D-END-RTN-EXIT.
037600     MOVE CCVS-E-1 TO DUMMY-RECORD.
037700     PERFORM D-WRITE-LINE 2 TIMES.
037800 D-END-ROUTINE-1.
037900      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
038000      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
038100      ADD PASS-COUNTER TO ERROR-HOLD.
038200      MOVE PASS-COUNTER TO CCVS-E-4-1.
038300      MOVE ERROR-HOLD TO CCVS-E-4-2.
038400      MOVE CCVS-E-4 TO CCVS-E-2-2.
038500      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM D-WRITE-LINE.
038600 D-END-ROUTINE-12.
038700      MOVE "TEST(S) FAILED" TO ENDER-DESC.
038800     IF       ERROR-COUNTER IS EQUAL TO ZERO
038900         MOVE "NO " TO ERROR-TOTAL
039000         ELSE
039100         MOVE ERROR-COUNTER TO ERROR-TOTAL.
039200     MOVE     CCVS-E-2 TO DUMMY-RECORD.
039300     PERFORM D-WRITE-LINE.
039400 D-END-ROUTINE-13.
039500     IF DELETE-COUNTER IS EQUAL TO ZERO
039600         MOVE "NO " TO ERROR-TOTAL  ELSE
039700         MOVE DELETE-COUNTER TO ERROR-TOTAL.
039800     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
039900     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM D-WRITE-LINE.
040000      IF   INSPECT-COUNTER EQUAL TO ZERO
040100          MOVE "NO " TO ERROR-TOTAL
040200      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
040300      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
040400      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM D-WRITE-LINE.
040500     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM D-WRITE-LINE.
040600 D-WRITE-LINE.
040700     ADD 1 TO RECORD-COUNT.
040800Y    IF RECORD-COUNT GREATER 50
040900Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
041000Y        MOVE SPACE TO DUMMY-RECORD
041100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
041200Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM D-WRT-LN
041300Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM D-WRT-LN 2 TIMES
041400Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM D-WRT-LN
041500Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
041600Y        MOVE ZERO TO RECORD-COUNT.
041700     PERFORM D-WRT-LN.
041800 D-WRT-LN.
041900     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
042000     MOVE SPACE TO DUMMY-RECORD.
042100 D-FAIL-ROUTINE.
042200     IF     COMPUTED-X NOT EQUAL TO SPACE
042300            GO TO  D-FAIL-ROUTINE-WRITE.
042400     IF     CORRECT-X NOT EQUAL TO SPACE
042500            GO TO D-FAIL-ROUTINE-WRITE.
042600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
042700     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
042800     MOVE   XXINFO TO DUMMY-RECORD.
042900     PERFORM D-WRITE-LINE 2 TIMES.
043000     MOVE   SPACES TO INF-ANSI-REFERENCE.
043100     GO TO  D-FAIL-ROUTINE-EX.
043200 D-FAIL-ROUTINE-WRITE.
043300     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM D-WRITE-LINE
043400     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
043500     MOVE   TEST-CORRECT TO PRINT-REC
043600     PERFORM D-WRITE-LINE 2 TIMES.
043700     MOVE   SPACES TO COR-ANSI-REFERENCE.
043800 D-FAIL-ROUTINE-EX. EXIT.
043900 D-BAIL-OUT.
044000     IF   COMPUTED-A NOT EQUAL TO SPACE GO TO D-BAIL-OUT-WRITE.
044100     IF     CORRECT-A EQUAL TO SPACE GO TO D-BAIL-OUT-EX.
044200 D-BAIL-OUT-WRITE.
044300     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
044400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
044500     MOVE   XXINFO TO DUMMY-RECORD. PERFORM D-WRITE-LINE 2 TIMES.
044600     MOVE   SPACES TO INF-ANSI-REFERENCE.
044700 D-BAIL-OUT-EX. EXIT.
044800 RL-FS2-02-03.
044900*ENTRY FROM SEGMENT REL-TEST-009.
045000*    SHOULD NOT ENTER HERE UNLESS SPACE ALLOCATION TOO SMALL.
045100     ADD    1   TO WRK-CS-09V00-014.
045200 RL-FS2-02-05.
045300     ADD     1 TO WRK-CS-09V00-017.
045400     IF      XRECORD-NUMBER (2) EQUAL TO 500
045500              MOVE   RL-FS2-STATUS TO WRK-XN-0002-002
045600              MOVE  "10" TO WRK-XN-0002-003.
045700 RL-FS2-02-EXIT.
045800     EXIT.
045900 END DECLARATIVES.
046000 CCVS1 SECTION.
046100 OPEN-FILES.
046200     OPEN    OUTPUT PRINT-FILE.
046300     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
046400     MOVE    SPACE TO TEST-RESULTS.
046500     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
046600     MOVE    ZERO TO REC-SKL-SUB.
046700     PERFORM CCVS-INIT-FILE 9 TIMES.
046800 CCVS-INIT-FILE.
046900     ADD     1 TO REC-SKL-SUB.
047000     MOVE    FILE-RECORD-INFO-SKELETON
047100          TO FILE-RECORD-INFO (REC-SKL-SUB).
047200 CCVS-INIT-EXIT.
047300     GO TO CCVS1-EXIT.
047400 CLOSE-FILES.
047500     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
047600 TERMINATE-CCVS.
047700S    EXIT PROGRAM.
047800STERMINATE-CALL.
047900     STOP     RUN.
048000 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
048100 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
048200 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
048300 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
048400     MOVE "****TEST DELETED****" TO RE-MARK.
048500 PRINT-DETAIL.
048600     IF REC-CT NOT EQUAL TO ZERO
048700             MOVE "." TO PARDOT-X
048800             MOVE REC-CT TO DOTVALUE.
048900     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
049000     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
049100        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
049200          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
049300     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
049400     MOVE SPACE TO CORRECT-X.
049500     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
049600     MOVE     SPACE TO RE-MARK.
049700 HEAD-ROUTINE.
049800     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
049900     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
050000     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
050100     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
050200 COLUMN-NAMES-ROUTINE.
050300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
050400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
050500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
050600 END-ROUTINE.
050700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
050800 END-RTN-EXIT.
050900     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
051000 END-ROUTINE-1.
051100      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
051200      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
051300      ADD PASS-COUNTER TO ERROR-HOLD.
051400*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
051500      MOVE PASS-COUNTER TO CCVS-E-4-1.
051600      MOVE ERROR-HOLD TO CCVS-E-4-2.
051700      MOVE CCVS-E-4 TO CCVS-E-2-2.
051800      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
051900  END-ROUTINE-12.
052000      MOVE "TEST(S) FAILED" TO ENDER-DESC.
052100     IF       ERROR-COUNTER IS EQUAL TO ZERO
052200         MOVE "NO " TO ERROR-TOTAL
052300         ELSE
052400         MOVE ERROR-COUNTER TO ERROR-TOTAL.
052500     MOVE     CCVS-E-2 TO DUMMY-RECORD.
052600     PERFORM WRITE-LINE.
052700 END-ROUTINE-13.
052800     IF DELETE-COUNTER IS EQUAL TO ZERO
052900         MOVE "NO " TO ERROR-TOTAL  ELSE
053000         MOVE DELETE-COUNTER TO ERROR-TOTAL.
053100     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
053200     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
053300      IF   INSPECT-COUNTER EQUAL TO ZERO
053400          MOVE "NO " TO ERROR-TOTAL
053500      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
053600      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
053700      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
053800     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
053900 WRITE-LINE.
054000     ADD 1 TO RECORD-COUNT.
054100Y    IF RECORD-COUNT GREATER 50
054200Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
054300Y        MOVE SPACE TO DUMMY-RECORD
054400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
054500Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
054600Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
054700Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
054800Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
054900Y        MOVE ZERO TO RECORD-COUNT.
055000     PERFORM WRT-LN.
055100 WRT-LN.
055200     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
055300     MOVE SPACE TO DUMMY-RECORD.
055400 BLANK-LINE-PRINT.
055500     PERFORM WRT-LN.
055600 FAIL-ROUTINE.
055700     IF     COMPUTED-X NOT EQUAL TO SPACE
055800            GO TO   FAIL-ROUTINE-WRITE.
055900     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
056000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
056100     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
056200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
056300     MOVE   SPACES TO INF-ANSI-REFERENCE.
056400     GO TO  FAIL-ROUTINE-EX.
056500 FAIL-ROUTINE-WRITE.
056600     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
056700     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
056800     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
056900     MOVE   SPACES TO COR-ANSI-REFERENCE.
057000 FAIL-ROUTINE-EX. EXIT.
057100 BAIL-OUT.
057200     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
057300     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
057400 BAIL-OUT-WRITE.
057500     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
057600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
057700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
057800     MOVE   SPACES TO INF-ANSI-REFERENCE.
057900 BAIL-OUT-EX. EXIT.
058000 CCVS1-EXIT.
058100     EXIT.
058200 SECT-RL-04-001 SECTION.
058300 REL-INIT-009.
058400     MOVE    "REL-TEST-009"   TO  PAR-NAME.
058500     MOVE     "CREATE RL-FS2" TO  FEATURE
058600     MOVE     "RL-FS2"        TO  XFILE-NAME (2).
058700     MOVE     "R1-F-G"        TO  XRECORD-NAME (2).
058800     MOVE CCVS-PGM-ID         TO  XPROGRAM-NAME (2).
058900     MOVE     000240          TO  XRECORD-LENGTH (2).
059000     MOVE     "RC"            TO  CHARS-OR-RECORDS (2).
059100     MOVE     0001            TO  XBLOCK-SIZE       (2).
059200     MOVE     000500          TO  RECORDS-IN-FILE  (2).
059300     MOVE     "RL"            TO  XFILE-ORGANIZATION (2).
059400     MOVE     "S"             TO  XLABEL-TYPE        (2).
059500     MOVE     000001          TO  XRECORD-NUMBER     (2).
059600*INITIALIZE  RECORD WORK AREA NUMBER 2.
059700     MOVE     1         TO  WRK-CS-09V00-012.
059800     MOVE     ZERO      TO  WRK-CS-09V00-013 WRK-CS-09V00-014
059900                            WRK-CS-09V00-015 WRK-CS-09V00-016
060000                            WRK-CS-09V00-017 WRK-CS-09V00-018.
060100     MOVE     SPACE     TO  RL-FS2-STATUS.
060200     MOVE     01 TO REC-CT.
060300     OPEN     OUTPUT    RL-FS2.
060400     MOVE     RL-FS2-STATUS TO WRK-XN-0002-001.
060500*CAPTURE STATUS KEY AFTER  OPEN STATEMENT IS EXECUTED.
060600 REL-TEST-009-R.
060700     MOVE    "99"  TO RL-FS2-STATUS.
060800     MOVE     FILE-RECORD-INFO-P1-120 (2) TO RL-FS2-WRK-120.
060900     MOVE     FILE-RECORD-INFO-P1-120 (2) TO
061000               RL-FS2-GRP-120.
061100     WRITE    RL-FS2R1-F-G-240.
061200     IF        RL-FS2-STATUS NOT EQUAL TO "00"
061300              GO TO  REL-TEST-009-2.
061400     IF       XRECORD-NUMBER (2) EQUAL TO 500
061500             GO TO REL-TEST-009-2.
061600     ADD      01 TO  XRECORD-NUMBER (2).
061700     GO TO    REL-TEST-009-R.
061800 REL-TEST-009-2.
061900     IF       WRK-CS-09V00-014 NOT EQUAL TO ZERO
062000              MOVE "EXCEPTIONS/ERRORS" TO RE-MARK
062100              MOVE ZERO TO CORRECT-18V0
062200              MOVE WRK-CS-09V00-014 TO COMPUTED-18V0
062300              PERFORM   FAIL
062400     ELSE
062500              PERFORM   PASS.
062600     PERFORM  PRINT-DETAIL.
062700     ADD      01 TO REC-CT.
062800*    .01
062900     IF       XRECORD-NUMBER (2) NOT EQUAL TO 500
063000              MOVE "INCORRECT COUNT" TO RE-MARK
063100              MOVE  500 TO CORRECT-18V0
063200             MOVE    XRECORD-NUMBER (2)  TO COMPUTED-18V0
063300              PERFORM  FAIL
063400              ELSE
063500              PERFORM PASS.
063600     PERFORM  PRINT-DETAIL.
063700     ADD      01 TO REC-CT.
063800*    .02
063900     IF       WRK-XN-0002-001 NOT EQUAL TO  "00"
064000              MOVE "STATUS/OPEN" TO RE-MARK
064100              MOVE WRK-XN-0002-001 TO COMPUTED-A
064200              MOVE "00" TO CORRECT-A
064300              PERFORM  FAIL
064400              ELSE
064500              PERFORM  PASS.
064600     PERFORM  PRINT-DETAIL.
064700     ADD      01 TO REC-CT.
064800*    .03
064900     IF        RL-FS2-STATUS NOT EQUAL TO "00"
065000              MOVE "STATUS/WRITE" TO RE-MARK
065100              MOVE RL-FS2-STATUS TO COMPUTED-A
065200              MOVE "00" TO CORRECT-A
065300              PERFORM   FAIL
065400              ELSE
065500              PERFORM   PASS.
065600     PERFORM  PRINT-DETAIL.
065700     ADD      01 TO REC-CT.
065800*    .04
065900     MOVE     SPACE  TO  RL-FS2-STATUS.
066000     CLOSE    RL-FS2.
066100     IF        RL-FS2-STATUS NOT EQUAL TO "00"
066200              MOVE "CLOSE/STATUS" TO RE-MARK
066300              MOVE   RL-FS2-STATUS TO COMPUTED-A
066400              MOVE "00" TO CORRECT-A
066500              PERFORM FAIL
066600              ELSE
066700              PERFORM PASS.
066800     PERFORM  PRINT-DETAIL.
066900     ADD      01 TO REC-CT.
067000*    .05
067100 REL-INIT-010.
067200     MOVE    "REL-TEST-010" TO PAR-NAME.
067300     MOVE     2     TO  WRK-CS-09V00-012.
067400     MOVE     ZERO  TO  WRK-CS-09V00-013.
067500     MOVE     ZERO  TO  WRK-CS-09V00-014.
067600     MOVE     ZERO  TO  WRK-CS-09V00-015.
067700     MOVE     ZERO  TO  WRK-CS-09V00-016.
067800     MOVE     ZERO  TO  WRK-CS-09V00-017.
067900     MOVE     ZERO  TO  WRK-CS-09V00-018.
068000     MOVE     01 TO REC-CT.
068100     OPEN     I-O  RL-FS2.
068200     MOVE     SPACE     TO  WRK-XN-0002-002
068300     MOVE     SPACE     TO  WRK-XN-0002-003
068400     MOVE     SPACE     TO  WRK-XN-0002-004
068500     MOVE      RL-FS2-STATUS TO WRK-XN-0002-001
068600     MOVE     SPACE TO RL-FS2-STATUS.
068700*CAPTURE THE CONTENTS OF STATUS KEY AFTER OPEN IS EXECUTED.
068800     MOVE    "USE/FILE STATUS"  TO FEATURE.
068900 REL-TEST-010-R.
069000     MOVE    "REL-TEST-010-R" TO PAR-NAME.
069100     MOVE    "VIII-26 4.5.2" TO ANSI-REFERENCE.
069200     ADD      1 TO WRK-CS-09V00-014.
069300     ADD      1 TO WRK-CS-09V00-015.
069400     READ     RL-FS2.
069500     IF        RL-FS2-STATUS EQUAL TO "10"
069600              GO TO  REL-TEST-010-3.
069700     MOVE     RL-FS2-WRK-120 TO FILE-RECORD-INFO-P1-120 (2).
069800     IF       WRK-CS-09V00-015 EQUAL TO 5
069900              ADD 01 TO UPDATE-NUMBER (2)
070000              MOVE FILE-RECORD-INFO-P1-120 (2) TO RL-FS2-WRK-120
070100              REWRITE RL-FS2R1-F-G-240
070200           MOVE ZERO TO WRK-CS-09V00-015
070300              GO TO  REL-TEST-010-2.
070400     IF       WRK-CS-09V00-014 GREATER 500
070500              GO TO  REL-TEST-010-3.
070600     GO TO    REL-TEST-010-R.
070700 REL-TEST-010-2.
070800     IF        RL-FS2-STATUS NOT EQUAL TO "00"
070900              ADD 1 TO WRK-CS-09V00-016.
071000     MOVE    SPACE TO RL-FS2-STATUS.
071100     GO TO    REL-TEST-010-R.
071200 REL-TEST-010-3.
071300     IF       WRK-CS-09V00-013 NOT EQUAL TO 1
071400              MOVE  "EXCEPTIONS/ERRORS" TO RE-MARK
071500              MOVE WRK-CS-09V00-013 TO COMPUTED-18V0
071600              MOVE  1 TO CORRECT-18V0
071700              PERFORM FAIL
071800              ELSE
071900              PERFORM PASS.
072000     PERFORM  PRINT-DETAIL.
072100     ADD      01 TO REC-CT.
072200*    .01
072300     IF       WRK-CS-09V00-014 NOT EQUAL TO 501
072400              MOVE "INCORRECT COUNT" TO RE-MARK
072500              MOVE WRK-CS-09V00-014 TO COMPUTED-18V0
072600              MOVE 501 TO CORRECT-18V0
072700              PERFORM FAIL
072800              ELSE
072900             PERFORM PASS.
073000     PERFORM  PRINT-DETAIL.
073100     ADD      01 TO REC-CT.
073200*    .02
073300     IF       WRK-XN-0002-001 NOT EQUAL TO "00"
073400              MOVE "OPEN/STATUS"  TO  RE-MARK
073500              MOVE WRK-XN-0002-001 TO COMPUTED-A
073600              MOVE  "00" TO CORRECT-A
073700              PERFORM FAIL
073800              ELSE
073900              PERFORM PASS.
074000     PERFORM  PRINT-DETAIL.
074100     ADD      01 TO REC-CT.
074200*    .03
074300     IF        RL-FS2-STATUS NOT EQUAL  TO "10"
074400              MOVE "AT END/STATUS" TO RE-MARK
074500              MOVE  RL-FS2-STATUS TO COMPUTED-A
074600              MOVE "10" TO CORRECT-A
074700              PERFORM FAIL
074800              ELSE
074900              PERFORM PASS.
075000     PERFORM  PRINT-DETAIL.
075100     ADD      01 TO REC-CT.
075200*    .04
075300     IF       WRK-XN-0002-002 NOT EQUAL TO "10"
075400              MOVE  "EXCEPTION/STATUS" TO RE-MARK
075500              MOVE  WRK-XN-0002-002 TO COMPUTED-A
075600              MOVE  "10" TO CORRECT-A
075700              PERFORM FAIL
075800              ELSE
075900              PERFORM PASS.
076000     PERFORM  PRINT-DETAIL.
076100     ADD      01 TO REC-CT.
076200*    .05
076300     IF       WRK-XN-0002-003 NOT EQUAL TO "10"
076400              MOVE "NO/EXCEPTION" TO  RE-MARK
076500              MOVE WRK-XN-0002-003 TO COMPUTED-A
076600              MOVE "10" TO CORRECT-A
076700              PERFORM FAIL
076800              ELSE
076900              PERFORM PASS.
077000     PERFORM  PRINT-DETAIL
077100     ADD      01 TO REC-CT.
077200*    .06
077300     MOVE     SPACE TO RL-FS2-STATUS.
077400     CLOSE    RL-FS2
077500     IF        RL-FS2-STATUS NOT EQUAL TO "00"
077600              MOVE "CLOSE/STATUS" TO RE-MARK
077700              MOVE  RL-FS2-STATUS TO  COMPUTED-A
077800              MOVE "00" TO CORRECT-A
077900              PERFORM FAIL
078000              ELSE
078100              PERFORM PASS.
078200     PERFORM  PRINT-DETAIL.
078300     ADD      01 TO REC-CT.
078400*    .07
078500*
078600*
078700 SECT-RL111-003-COBOL8X SECTION.
078800*==============================
078900*
079000****************************************************************
079100*                                                              *
079200*    THIS SECTION CONTAINS THE ADDITIONAL CODING/TESTS FOR     *
079300*    THE NEW COBOL '85 FEATURES.                               *
079400*                                                              *
079500****************************************************************
079600 REL-INIT-020.
079700     MOVE   "VIII-26 4.5.2"  TO ANSI-REFERENCE.
079800     MOVE   "NEW COBOL85 TESTS" TO FEATURE.
079900     MOVE    SPACES TO WRK-XN-00001-1.
080000     MOVE    0 TO REC-CT.
080100     MOVE    SPACES TO RL-FS2-STATUS.
080200     MOVE    SPACES TO FILE-RECORD-INFO-P1-120 (2).
080300     OPEN    I-O RL-FS2.
080400 REL-TEST-020-1.
080500     MOVE   "REL-TEST-020-1" TO PAR-NAME.
080600     IF      RL-FS2-STATUS = "00"
080700             PERFORM PASS
080800             PERFORM PRINT-DETAIL
080900     ELSE
081000             MOVE   "INVALID OPEN" TO RE-MARK
081100             MOVE   "00"           TO CORRECT-X
081200             MOVE    RL-FS2-STATUS TO COMPUTED-X
081300             PERFORM FAIL
081400             PERFORM PRINT-DETAIL.
081500 REL-TEST-020-2.
081600     MOVE   "REL-TEST-020-2" TO PAR-NAME.
081700     READ    RL-FS2  INTO FILE-RECORD-INFO-P1-120 (2)
081800             END
081900             MOVE   "END ENCOUNTERED ON FIRST READ" TO RE-MARK
082000             PERFORM FAIL
082100             PERFORM PRINT-DETAIL
082200             NOT AT END
082300             PERFORM PASS
082400             PERFORM PRINT-DETAIL
082500     END-READ
082600     MOVE   "X" TO WRK-XN-00001-1.
082700 REL-TEST-020-3.
082800     MOVE   "REL-TEST-020-3" TO PAR-NAME.
082900     IF      XRECORD-NUMBER (2) = 1
083000             PERFORM PASS
083100             PERFORM PRINT-DETAIL
083200     ELSE
083300             MOVE   "FIRST RECORD NOT READ ON FIRST READ"
083400                  TO RE-MARK
083500             MOVE    1             TO CORRECT-N
083600             MOVE    XRECORD-NUMBER (2) TO COMPUTED-N
083700             PERFORM FAIL
083800             PERFORM PRINT-DETAIL.
083900 REL-TEST-020-4.
084000     MOVE   "REL-TEST-020-4" TO PAR-NAME.
084100     IF      WRK-XN-00001-1 = "X"
084200             PERFORM PASS
084300             PERFORM PRINT-DETAIL
084400     ELSE
084500             MOVE   "SCOPE TERMINATOR IGNORED" TO RE-MARK
084600             MOVE   "X"             TO CORRECT-X
084700             MOVE    WRK-XN-00001-1 TO COMPUTED-X
084800             PERFORM FAIL
084900             PERFORM PRINT-DETAIL.
085000*
085100 REL-INIT-030.
085200     MOVE   "VIII-29 4.5.4"  TO ANSI-REFERENCE.
085300     MOVE    0 TO REC-CT.
085400     MOVE    SPACES TO WRK-XN-00001-1.
085500     MOVE    SPACES TO RL-FS2-STATUS.
085600     MOVE    SPACES TO FILE-RECORD-INFO-P1-120 (2).
085700 REL-TEST-030-1.
085800     MOVE   "REL-TEST-030-1" TO PAR-NAME.
085900     READ    RL-FS2
086000             END
086100             MOVE   "END ENCOUNTERED ON SECOND READ" TO RE-MARK
086200             PERFORM FAIL
086300             PERFORM PRINT-DETAIL
086400             NOT AT END
086500             PERFORM PASS
086600             PERFORM PRINT-DETAIL
086700     END-READ
086800     MOVE   "X" TO WRK-XN-00001-1.
086900 REL-TEST-030-2.
087000     MOVE   "REL-TEST-030-2" TO PAR-NAME.
087100     MOVE    RL-FS2-WRK-120  TO FILE-RECORD-INFO-P1-120 (2).
087200     IF      XRECORD-NUMBER (2) = 2
087300             PERFORM PASS
087400             PERFORM PRINT-DETAIL
087500     ELSE
087600             MOVE   "SECOND RECORD NOT READ ON SECOND READ"
087700                  TO RE-MARK
087800             MOVE    2             TO CORRECT-N
087900             MOVE    XRECORD-NUMBER (2) TO COMPUTED-N
088000             PERFORM FAIL
088100             PERFORM PRINT-DETAIL.
088200 REL-TEST-030-3.
088300     MOVE   "REL-TEST-030-3" TO PAR-NAME.
088400     IF      WRK-XN-00001-1 = "X"
088500             PERFORM PASS
088600             PERFORM PRINT-DETAIL
088700     ELSE
088800             MOVE   "SCOPE TERMINATOR IGNORED" TO RE-MARK
088900             MOVE   "X"             TO CORRECT-X
089000             MOVE    WRK-XN-00001-1 TO COMPUTED-X
089100             PERFORM FAIL
089200             PERFORM PRINT-DETAIL.
089300*
089400 REL-INIT-040.
089500     CLOSE   RL-FS2.
089600     OPEN    I-O RL-FS3.
089700     MOVE   "VIII-29 4.5.4"  TO ANSI-REFERENCE.
089800     MOVE    0 TO REC-CT.
089900     MOVE    2 TO RL-FS3-KEY.
090000     MOVE    SPACES TO WRK-XN-00001-1.
090100     MOVE    SPACES TO RL-FS3-STATUS.
090200     MOVE    SPACES TO FILE-RECORD-INFO-P1-120 (2).
090300 REL-TEST-040-1.
090400     MOVE   "REL-TEST-040-1" TO PAR-NAME.
090500     WRITE   RL-FS3R1-F-G-240
090600             INVALID
090700             PERFORM PASS
090800             PERFORM PRINT-DETAIL
090900             NOT INVALID
091000             MOVE   "DUPLICATE KEY SHOULD NOT HAVE BEEN WRITTEN"
091100                  TO RE-MARK
091200             PERFORM FAIL
091300             PERFORM PRINT-DETAIL
091400     END-WRITE
091500     MOVE   "X" TO WRK-XN-00001-1.
091600 REL-TEST-040-2.
091700     MOVE   "REL-TEST-040-2" TO PAR-NAME.
091800     IF      WRK-XN-00001-1 = "X"
091900             PERFORM PASS
092000             PERFORM PRINT-DETAIL
092100     ELSE
092200             MOVE   "SCOPE TERMINATOR IGNORED" TO RE-MARK
092300             MOVE   "X"             TO CORRECT-X
092400             MOVE    WRK-XN-00001-1 TO COMPUTED-X
092500             PERFORM FAIL
092600             PERFORM PRINT-DETAIL.
092700*
092800 REL-INIT-050.
092900     MOVE   "VIII-38 4.9.4 GR9(A)"  TO ANSI-REFERENCE.
093000     MOVE    0 TO REC-CT.
093100     MOVE    600  TO RL-FS3-KEY.
093200     MOVE    SPACES TO WRK-XN-00001-1.
093300     MOVE    SPACES TO RL-FS3-STATUS.
093400     MOVE    SPACES TO FILE-RECORD-INFO-P1-120 (2).
093500 REL-TEST-050-1.
093600     MOVE   "REL-TEST-050-1" TO PAR-NAME.
093700     WRITE   RL-FS3R1-F-G-240
093800             INVALID
093900             MOVE   "NEW KEY, RECORD SHOULD HAVE BEEN WRITTEN OK"
094000                  TO RE-MARK
094100             PERFORM FAIL
094200             PERFORM PRINT-DETAIL
094300             NOT INVALID
094400             PERFORM PASS
094500             PERFORM PRINT-DETAIL
094600     END-WRITE
094700     MOVE   "X" TO WRK-XN-00001-1.
094800 REL-TEST-050-2.
094900     MOVE   "REL-TEST-050-2" TO PAR-NAME.
095000     IF      WRK-XN-00001-1 = "X"
095100             PERFORM PASS
095200             PERFORM PRINT-DETAIL
095300     ELSE
095400             MOVE   "SCOPE TERMINATOR IGNORED" TO RE-MARK
095500             MOVE   "X"             TO CORRECT-X
095600             MOVE    WRK-XN-00001-1 TO COMPUTED-X
095700             PERFORM FAIL
095800             PERFORM PRINT-DETAIL.
095900*
096000 REL-INIT-060.
096100     MOVE   "VIII-38 4.5.4 GR9(B)"  TO ANSI-REFERENCE.
096200     CLOSE   RL-FS3.
096300     OPEN    INPUT RL-FS3.
096400     MOVE    0 TO REC-CT.
096500     MOVE    99999998 TO RL-FS3-KEY.
096600     MOVE    SPACES TO WRK-XN-00001-1.
096700     MOVE    SPACES TO RL-FS3-STATUS.
096800     MOVE    SPACES TO FILE-RECORD-INFO-P1-120 (2).
096900 REL-TEST-060-1.
097000     MOVE   "REL-TEST-060-1" TO PAR-NAME.
097100     WRITE   RL-FS3R1-F-G-240.
097200     IF RL-FS3-STATUS NOT = "48"
097300          MOVE   "WRITE TO FILE OPENED INPUT NOT ALLOWED"
097400               TO RE-MARK
097500     ELSE
097600          MOVE "SHOULD HAVE ACTIONED DECLARATIVES" TO RE-MARK.
097700     PERFORM FAIL
097800     PERFORM PRINT-DETAIL.
097900* ENTRY TO THE DECLARATIVES CLOSES ALL FILES AND
098000* TERMINATES THE PROGRAM.
098100* EXECUTION SHOULD REACH THIS POINT ONLY AS RESULT OF AN ERROR
098200     CLOSE RL-FS3.
098300*
098400 REL-INIT-070.
098500*    MOVE   "VIII-30 4.6.2"  TO ANSI-REFERENCE.
098600*    OPEN    I-O RL-FS3.
098700*    MOVE    0 TO REC-CT.
098800*    MOVE    SPACES TO WRK-XN-00001-1.
098900*    MOVE    SPACES TO RL-FS3-STATUS.
099000*    MOVE    SPACES TO FILE-RECORD-INFO-P1-120 (2).
099100*REL-TEST-070-1.
099200*    MOVE   "REL-TEST-070-1" TO PAR-NAME.
099300*    READ    RL-FS3
099400*            INVALID
099500*            MOVE   "INVALID KEY ON FIRST READ" TO RE-MARK
099600*            PERFORM FAIL
099700*            PERFORM PRINT-DETAIL
099800*            NOT INVALID KEY
099900*            PERFORM PASS
100000*            PERFORM PRINT-DETAIL
100100*    END-READ
100200*    MOVE   "X" TO WRK-XN-00001-1.
100300*REL-TEST-070-2.
100400*    MOVE   "REL-TEST-070-2" TO PAR-NAME.
100500*    IF      WRK-XN-00001-1 = "X"
100600*            PERFORM PASS
100700*            PERFORM PRINT-DETAIL
100800*    ELSE
100900*            MOVE   "SCOPE TERMINATOR IGNORED" TO RE-MARK
101000*            MOVE   "X"             TO CORRECT-X
101100*            MOVE    WRK-XN-00001-1 TO COMPUTED-X
101200*            PERFORM FAIL
101300*            PERFORM PRINT-DETAIL.
101400*REL-TEST-070-3.
101500*    MOVE   "REL-TEST-070-3" TO PAR-NAME.
101600*
101700*    IF      WRK-XN-00001-2 = "@"
101800*            PERFORM PASS
101900*            PERFORM PRINT-DETAIL
102000*    ELSE
102100*            MOVE   "'USE AFTER' PROCEDURE NOT ACTIONED"
102200*                 TO RE-MARK
102300*            MOVE   "@"             TO CORRECT-X
102400*            MOVE    WRK-XN-00001-2 TO COMPUTED-X
102500*            PERFORM FAIL
102600*            PERFORM PRINT-DETAIL.
102700*
102800*
102900*REL-INIT-080.
103000*    MOVE   "VIII-30 4.6.2"  TO ANSI-REFERENCE.
103100*    CLOSE   RL-FS3.
103200*    OPEN    I-O RL-FS3.
103300*    MOVE    0 TO REC-CT.
103400*    MOVE    900000002 TO RL-FS3-KEY.
103500*    MOVE    SPACES TO WRK-XN-00001-1.
103600*    MOVE    SPACES TO RL-FS3-STATUS.
103700*    MOVE    SPACES TO FILE-RECORD-INFO-P1-120 (2).
103800*REL-TEST-080-1.
103900*    MOVE   "REL-TEST-080-1" TO PAR-NAME.
104000*    READ    RL-FS3
104100*            INVALID
104200*            MOVE   "INVALID KEY ON FIRST READ" TO RE-MARK
104300*            PERFORM FAIL
104400*            PERFORM PRINT-DETAIL
104500*            NOT INVALID KEY
104600*            PERFORM PASS
104700*            PERFORM PRINT-DETAIL
104800*    END-READ
104900*    MOVE   "X" TO WRK-XN-00001-1.
105000*REL-TEST-080-2.
105100*    MOVE   "REL-TEST-080-2" TO PAR-NAME.
105200*    IF      WRK-XN-00001-1 = "X"
105300*            PERFORM PASS
105400*            PERFORM PRINT-DETAIL
105500*    ELSE
105600*            MOVE   "SCOPE TERMINATOR IGNORED" TO RE-MARK
105700*            MOVE   "X"             TO CORRECT-X
105800*            MOVE    WRK-XN-00001-1 TO COMPUTED-X
105900*            PERFORM FAIL
106000*            PERFORM PRINT-DETAIL.
106100*
106200*
106300*REL-INIT-090.
106400*    MOVE   "VIII-30 4.6.2"  TO ANSI-REFERENCE.
106500*    MOVE    SPACES TO WRK-XN-00001-1.
106600*    MOVE    SPACES TO RL-FS2-STATUS.
106700*    MOVE    SPACES TO FILE-RECORD-INFO-P1-120 (2).
106800*REL-TEST-090-1.
106900*    MOVE   "REL-TEST-090-1" TO PAR-NAME.
107000*    REWRITE RL-FS2R1-F-G-240
107100*            INVALID KEY
107200*            MOVE   "INVALID KEY ON REWRITE" TO RE-MARK
107300*            PERFORM FAIL
107400*            PERFORM PRINT-DETAIL
107500*            NOT INVALID KEY
107600*            PERFORM PASS
107700*            PERFORM PRINT-DETAIL
107800*    END-REWRITE
107900*    MOVE   "X" TO WRK-XN-00001-1.
108000*REL-TEST-090-2.
108100*    MOVE   "REL-TEST-090-2" TO PAR-NAME.
108200*    IF      WRK-XN-00001-1 = "X"
108300*            PERFORM PASS
108400*            PERFORM PRINT-DETAIL
108500*    ELSE
108600*            MOVE   "SCOPE TERMINATOR IGNORED" TO RE-MARK
108700*            MOVE   "X"             TO CORRECT-X
108800*            MOVE    WRK-XN-00001-1 TO COMPUTED-X
108900*            PERFORM FAIL
109000*            PERFORM PRINT-DETAIL.
109100*
109200 CCVS-EXIT SECTION.
109300 CCVS-999999.
109400     GO TO CLOSE-FILES.
