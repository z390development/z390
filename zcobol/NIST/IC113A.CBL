000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IC113A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*
002200*         THE SUBPROGRAM IC113 IS CALLED BY THE MAIN PROGRAM IC112
002300*    WHICH HAS A FILE DESCRIPTION RECORD IN THE USING PHRASE OF
002400*    THE CALL STATEMENT REFERENCING THIS SUBPROGRAM.  IC113 CHECKS
002500*    THE VALUES IN THE FILE RECORD DESCRIBED IN THE LINKAGE
002600*    SECTION OF THE SUBPROGRAM.  IF ANY ERRORS ARE ENCOUNTERED
002700*    THE ERROR-FLAG IS SET TO 1 AND THE RECORDS-IN-ERROR COUNTER
002800*    IS INCREMENTED BY 1.
002900*
003000********************************************
003100 ENVIRONMENT DIVISION.
003200 CONFIGURATION SECTION.
003300 SOURCE-COMPUTER.
003400     XXXXX082.
003500 OBJECT-COMPUTER.
003600     XXXXX083.
003700 DATA DIVISION.
003800 WORKING-STORAGE SECTION.
003900 01  DUMMY-WS-ENTRY   PIC 99  VALUE 0.
004000 LINKAGE SECTION.
004100 01  COUNT-OF-RECORDS   PIC S9(9)   USAGE COMP.
004200 01  RECORDS-IN-ERROR   PIC S9(5)   USAGE COMP.
004300 01  ERROR-FLAG   PICTURE 9.
004400 01  SQ-FS3-R1-G-120.
004500     02  XFILE-NAME-GROUP.
004600         03  FILLER   PIC X(5).
004700         03  XFILE-NAME   PIC X(6).
004800     02  XRECORD-NAME-GROUP.
004900         03  FILLER   PIC X(8).
005000         03  XRECORD-NAME   PIC X(6).
005100     02  REELUNIT-NUMBER-GROUP.
005200         03  FILLER   PIC X(1).
005300         03  REELUNIT-NUMBER   PIC 9(1).
005400     02  FILLER   PIC X(7).
005500     02  XRECORD-NUMBER   PIC 9(6).
005600     02  FILLER   PIC X(79).
005700     02  XLABEL-TYPE   PIC X(1).
005800 PROCEDURE DIVISION USING RECORDS-IN-ERROR  SQ-FS3-R1-G-120
005900             ERROR-FLAG  COUNT-OF-RECORDS.
006000 SECT-IC113-0001 SECTION.
006100 LINK-TEST-08.
006200     ADD 1 TO COUNT-OF-RECORDS.
006300     IF COUNT-OF-RECORDS NOT EQUAL TO XRECORD-NUMBER
006400         GO TO LINK-FAIL-08.
006500     IF REELUNIT-NUMBER-GROUP NOT EQUAL TO "/0"
006600         GO TO LINK-FAIL-08.
006700     IF XFILE-NAME NOT EQUAL TO "SQ-FS3"
006800         GO TO LINK-FAIL-08.
006900     IF XRECORD-NAME NOT EQUAL TO "R1-F-G"
007000         GO TO LINK-FAIL-08.
007100     IF XLABEL-TYPE NOT EQUAL TO "S"
007200         GO TO LINK-FAIL-08.
007300 LINK-EXIT-08.
007400     EXIT PROGRAM.
007500 LINK-FAIL-08.
007600     ADD 1 TO RECORDS-IN-ERROR.
007700     MOVE 1 TO ERROR-FLAG.
007800     GO TO LINK-EXIT-08.
