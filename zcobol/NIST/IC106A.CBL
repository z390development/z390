000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IC106A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*        THIS PROGRAM CALLS A SUBPROGRAM WITH TWO TABLES
002200*    AND AN INDEX DATA ITEM REFERENCED IN THE USING PHRASE
002300*    OF THE CALL STATEMENT.  BOTH OF THE TABLES CONTAIN AN
002400*    INDEXED BY CLAUSE.
002500*        THE TESTS IN THIS PROGRAM VERIFY THAT
002600*           (1)  THE INDICES IN THE MAIN PROGRAM AND THE
002700*                SUBPROGRAM ARE SEPARATE,
002800*           (2)  AN INDEX DATA ITEM SET IN A MAIN PROGRAM
002900*                CAN BE USED TO SET AN INDEX IN A SUBPROGRAM,
003000*           (3)  TABLES CAN BE SHARED BETWEEN A MAIN PROGRAM
003100*                AND A SUBPROGRAM.
003200*        THE SUBPROGRAM IC107 IS CALLED BY THIS PROGRAM.
003300 ENVIRONMENT DIVISION.
003400 CONFIGURATION SECTION.
003500 SOURCE-COMPUTER.
003600     XXXXX082.
003700 OBJECT-COMPUTER.
003800     XXXXX083.
003900 INPUT-OUTPUT SECTION.
004000 FILE-CONTROL.
004100     SELECT PRINT-FILE ASSIGN TO
004200     XXXXX055.
004300 DATA DIVISION.
004400 FILE SECTION.
004500 FD  PRINT-FILE.
004600 01  PRINT-REC PICTURE X(120).
004700 01  DUMMY-RECORD PICTURE X(120).
004800 WORKING-STORAGE SECTION.
004900 77  IDN1  USAGE IS INDEX.
005000 77  INDEX-VALUE PIC 999.
005100 01  TABLE-1.
005200     02  DN1 PICTURE X
005300             OCCURS 10 TIMES
005400             INDEXED BY IN1.
005500 01  TABLE-2.
005600     02  DN2 PICTURE X
005700             OCCURS 10 TIMES
005800             INDEXED BY IN2.
005900 01  TEST-RESULTS.
006000     02 FILLER                   PIC X      VALUE SPACE.
006100     02 FEATURE                  PIC X(20)  VALUE SPACE.
006200     02 FILLER                   PIC X      VALUE SPACE.
006300     02 P-OR-F                   PIC X(5)   VALUE SPACE.
006400     02 FILLER                   PIC X      VALUE SPACE.
006500     02  PAR-NAME.
006600       03 FILLER                 PIC X(19)  VALUE SPACE.
006700       03  PARDOT-X              PIC X      VALUE SPACE.
006800       03 DOTVALUE               PIC 99     VALUE ZERO.
006900     02 FILLER                   PIC X(8)   VALUE SPACE.
007000     02 RE-MARK                  PIC X(61).
007100 01  TEST-COMPUTED.
007200     02 FILLER                   PIC X(30)  VALUE SPACE.
007300     02 FILLER                   PIC X(17)  VALUE
007400            "       COMPUTED=".
007500     02 COMPUTED-X.
007600     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
007700     03 COMPUTED-N               REDEFINES COMPUTED-A
007800                                 PIC -9(9).9(9).
007900     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
008000     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
008100     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
008200     03       CM-18V0 REDEFINES COMPUTED-A.
008300         04 COMPUTED-18V0                    PIC -9(18).
008400         04 FILLER                           PIC X.
008500     03 FILLER PIC X(50) VALUE SPACE.
008600 01  TEST-CORRECT.
008700     02 FILLER PIC X(30) VALUE SPACE.
008800     02 FILLER PIC X(17) VALUE "       CORRECT =".
008900     02 CORRECT-X.
009000     03 CORRECT-A                  PIC X(20) VALUE SPACE.
009100     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
009200     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
009300     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
009400     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
009500     03      CR-18V0 REDEFINES CORRECT-A.
009600         04 CORRECT-18V0                     PIC -9(18).
009700         04 FILLER                           PIC X.
009800     03 FILLER PIC X(2) VALUE SPACE.
009900     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
010000 01  CCVS-C-1.
010100     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
010200-    "SS  PARAGRAPH-NAME
010300-    "       REMARKS".
010400     02 FILLER                     PIC X(20)    VALUE SPACE.
010500 01  CCVS-C-2.
010600     02 FILLER                     PIC X        VALUE SPACE.
010700     02 FILLER                     PIC X(6)     VALUE "TESTED".
010800     02 FILLER                     PIC X(15)    VALUE SPACE.
010900     02 FILLER                     PIC X(4)     VALUE "FAIL".
011000     02 FILLER                     PIC X(94)    VALUE SPACE.
011100 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
011200 01  REC-CT                        PIC 99       VALUE ZERO.
011300 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
011400 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
011500 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
011600 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
011700 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
011800 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
011900 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
012000 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
012100 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
012200 01  CCVS-H-1.
012300     02  FILLER                    PIC X(39)    VALUE SPACES.
012400     02  FILLER                    PIC X(42)    VALUE
012500     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
012600     02  FILLER                    PIC X(39)    VALUE SPACES.
012700 01  CCVS-H-2A.
012800   02  FILLER                        PIC X(40)  VALUE SPACE.
012900   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
013000   02  FILLER                        PIC XXXX   VALUE
013100     "4.2 ".
013200   02  FILLER                        PIC X(28)  VALUE
013300            " COPY - NOT FOR DISTRIBUTION".
013400   02  FILLER                        PIC X(41)  VALUE SPACE.
013500
013600 01  CCVS-H-2B.
013700   02  FILLER                        PIC X(15)  VALUE
013800            "TEST RESULT OF ".
013900   02  TEST-ID                       PIC X(9).
014000   02  FILLER                        PIC X(4)   VALUE
014100            " IN ".
014200   02  FILLER                        PIC X(12)  VALUE
014300     " HIGH       ".
014400   02  FILLER                        PIC X(22)  VALUE
014500            " LEVEL VALIDATION FOR ".
014600   02  FILLER                        PIC X(58)  VALUE
014700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
014800 01  CCVS-H-3.
014900     02  FILLER                      PIC X(34)  VALUE
015000            " FOR OFFICIAL USE ONLY    ".
015100     02  FILLER                      PIC X(58)  VALUE
015200     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
015300     02  FILLER                      PIC X(28)  VALUE
015400            "  COPYRIGHT   1985 ".
015500 01  CCVS-E-1.
015600     02 FILLER                       PIC X(52)  VALUE SPACE.
015700     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
015800     02 ID-AGAIN                     PIC X(9).
015900     02 FILLER                       PIC X(45)  VALUE SPACES.
016000 01  CCVS-E-2.
016100     02  FILLER                      PIC X(31)  VALUE SPACE.
016200     02  FILLER                      PIC X(21)  VALUE SPACE.
016300     02 CCVS-E-2-2.
016400         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
016500         03 FILLER                   PIC X      VALUE SPACE.
016600         03 ENDER-DESC               PIC X(44)  VALUE
016700            "ERRORS ENCOUNTERED".
016800 01  CCVS-E-3.
016900     02  FILLER                      PIC X(22)  VALUE
017000            " FOR OFFICIAL USE ONLY".
017100     02  FILLER                      PIC X(12)  VALUE SPACE.
017200     02  FILLER                      PIC X(58)  VALUE
017300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
017400     02  FILLER                      PIC X(13)  VALUE SPACE.
017500     02 FILLER                       PIC X(15)  VALUE
017600             " COPYRIGHT 1985".
017700 01  CCVS-E-4.
017800     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
017900     02 FILLER                       PIC X(4)   VALUE " OF ".
018000     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
018100     02 FILLER                       PIC X(40)  VALUE
018200      "  TESTS WERE EXECUTED SUCCESSFULLY".
018300 01  XXINFO.
018400     02 FILLER                       PIC X(19)  VALUE
018500            "*** INFORMATION ***".
018600     02 INFO-TEXT.
018700       04 FILLER                     PIC X(8)   VALUE SPACE.
018800       04 XXCOMPUTED                 PIC X(20).
018900       04 FILLER                     PIC X(5)   VALUE SPACE.
019000       04 XXCORRECT                  PIC X(20).
019100     02 INF-ANSI-REFERENCE           PIC X(48).
019200 01  HYPHEN-LINE.
019300     02 FILLER  PIC IS X VALUE IS SPACE.
019400     02 FILLER  PIC IS X(65)    VALUE IS "************************
019500-    "*****************************************".
019600     02 FILLER  PIC IS X(54)    VALUE IS "************************
019700-    "******************************".
019800 01  CCVS-PGM-ID                     PIC X(9)   VALUE
019900     "IC106A".
020000 PROCEDURE DIVISION.
020100 CCVS1 SECTION.
020200 OPEN-FILES.
020300     OPEN     OUTPUT PRINT-FILE.
020400     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
020500     MOVE    SPACE TO TEST-RESULTS.
020600     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
020700     GO TO CCVS1-EXIT.
020800 CLOSE-FILES.
020900     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
021000 TERMINATE-CCVS.
021100S    EXIT PROGRAM.
021200STERMINATE-CALL.
021300     STOP     RUN.
021400 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
021500 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
021600 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
021700 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
021800     MOVE "****TEST DELETED****" TO RE-MARK.
021900 PRINT-DETAIL.
022000     IF REC-CT NOT EQUAL TO ZERO
022100             MOVE "." TO PARDOT-X
022200             MOVE REC-CT TO DOTVALUE.
022300     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
022400     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
022500        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
022600          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
022700     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
022800     MOVE SPACE TO CORRECT-X.
022900     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
023000     MOVE     SPACE TO RE-MARK.
023100 HEAD-ROUTINE.
023200     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023300     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023400     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
023500     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
023600 COLUMN-NAMES-ROUTINE.
023700     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
023800     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
024000 END-ROUTINE.
024100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
024200 END-RTN-EXIT.
024300     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024400 END-ROUTINE-1.
024500      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
024600      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
024700      ADD PASS-COUNTER TO ERROR-HOLD.
024800*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
024900      MOVE PASS-COUNTER TO CCVS-E-4-1.
025000      MOVE ERROR-HOLD TO CCVS-E-4-2.
025100      MOVE CCVS-E-4 TO CCVS-E-2-2.
025200      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
025300  END-ROUTINE-12.
025400      MOVE "TEST(S) FAILED" TO ENDER-DESC.
025500     IF       ERROR-COUNTER IS EQUAL TO ZERO
025600         MOVE "NO " TO ERROR-TOTAL
025700         ELSE
025800         MOVE ERROR-COUNTER TO ERROR-TOTAL.
025900     MOVE     CCVS-E-2 TO DUMMY-RECORD.
026000     PERFORM WRITE-LINE.
026100 END-ROUTINE-13.
026200     IF DELETE-COUNTER IS EQUAL TO ZERO
026300         MOVE "NO " TO ERROR-TOTAL  ELSE
026400         MOVE DELETE-COUNTER TO ERROR-TOTAL.
026500     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
026600     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026700      IF   INSPECT-COUNTER EQUAL TO ZERO
026800          MOVE "NO " TO ERROR-TOTAL
026900      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
027000      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
027100      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027200     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027300 WRITE-LINE.
027400     ADD 1 TO RECORD-COUNT.
027500Y    IF RECORD-COUNT GREATER 50
027600Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
027700Y        MOVE SPACE TO DUMMY-RECORD
027800Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
027900Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
028000Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
028100Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
028200Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
028300Y        MOVE ZERO TO RECORD-COUNT.
028400     PERFORM WRT-LN.
028500 WRT-LN.
028600     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
028700     MOVE SPACE TO DUMMY-RECORD.
028800 BLANK-LINE-PRINT.
028900     PERFORM WRT-LN.
029000 FAIL-ROUTINE.
029100     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
029200     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
029300     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
029400     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
029500     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029600     MOVE   SPACES TO INF-ANSI-REFERENCE.
029700     GO TO  FAIL-ROUTINE-EX.
029800 FAIL-ROUTINE-WRITE.
029900     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
030000     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
030100     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
030200     MOVE   SPACES TO COR-ANSI-REFERENCE.
030300 FAIL-ROUTINE-EX. EXIT.
030400 BAIL-OUT.
030500     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
030600     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
030700 BAIL-OUT-WRITE.
030800     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
030900     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
031000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031100     MOVE   SPACES TO INF-ANSI-REFERENCE.
031200 BAIL-OUT-EX. EXIT.
031300 CCVS1-EXIT.
031400     EXIT.
031500 SEC-IC106-0001 SECTION.
031600 LINK-TEST-INITIALIZE.
031700     MOVE "ABCDEFGHIJ" TO TABLE-1.
031800     MOVE SPACE TO TABLE-2.
031900     SET IN1 TO 6.
032000     SET IDN1 TO IN1.
032100     CALL "IC107A" USING IDN1 TABLE-1 TABLE-2.
032200 LINK-TEST-01.
032300     MOVE "SEPARATE INDEXES" TO FEATURE.
032400     MOVE "LINK-TEST-01" TO PAR-NAME.
032500*        THIS TEST VERIFIES THAT IN1 HAS NOT BEEN AFFECTED
032600*    BY THE USE OF AN INDEX FOR TABLE-1 IN THE SUBPROGRAM.
032700 LINK-TEST-01-01.
032800     MOVE 1 TO REC-CT.
032900     IF DN1 (IN1) EQUAL TO "F"
033000         PERFORM PASS
033100         GO TO LINK-WRITE-01-01.
033200 LINK-FAIL-01-01.
033300     PERFORM FAIL.
033400     MOVE DN1 (IN1) TO COMPUTED-A.
033500     MOVE "F" TO CORRECT-A.
033600     MOVE "TABLE INDEX DESTROYED" TO RE-MARK.
033700 LINK-WRITE-01-01.
033800     PERFORM PRINT-DETAIL.
033900 LINK-TEST-01-02.
034000     ADD 1 TO REC-CT.
034100     IF IN1 EQUAL TO 6
034200         PERFORM PASS
034300         GO TO LINK-WRITE-01-02.
034400 LINK-FAIL-01-02.
034500     PERFORM FAIL.
034600     MOVE 6 TO CORRECT-18V0.
034700     SET      INDEX-VALUE TO IN1.
034800     MOVE     INDEX-VALUE TO COMPUTED-18V0.
034900     MOVE "TABLE INDEX DESTROYED" TO RE-MARK.
035000 LINK-WRITE-01-02.
035100     PERFORM PRINT-DETAIL.
035200 LINK-TEST-02.
035300     MOVE "INDEX DATA ITEM" TO FEATURE.
035400     MOVE "LINK-TEST-02" TO PAR-NAME.
035500*        THIS TEST VERIFIES THAT THE INDEX DATA ITEM WAS
035600*    USED IN THE SUBPROGRAM TO SET AN INDEX AND AN INDEX
035700*    DATA ITEM.
035800 LINK-TEST-02-01.
035900     MOVE 1 TO REC-CT.
036000     IF DN2 (7) IS EQUAL TO "G"
036100         PERFORM PASS
036200         GO TO LINK-WRITE-02-01.
036300 LINK-FAIL-02-01.
036400     PERFORM FAIL.
036500     MOVE DN2 (7) TO COMPUTED-A.
036600     MOVE "G" TO CORRECT-A.
036700     MOVE "INDEX DATA ITEM IN LINKAGE SEC" TO RE-MARK.
036800 LINK-WRITE-02-01.
036900     PERFORM PRINT-DETAIL.
037000 LINK-TEST-02-02.
037100     ADD 1 TO REC-CT.
037200     IF DN2 (6) EQUAL TO "F"
037300         PERFORM PASS
037400         GO TO LINK-WRITE-02-02.
037500 LINK-FAIL-02-02.
037600     PERFORM FAIL.
037700     MOVE DN2 (6) TO COMPUTED-A.
037800     MOVE "F" TO CORRECT-A.
037900     MOVE "INDEX DATA ITEM IN LINKAGE SEC" TO RE-MARK.
038000 LINK-WRITE-02-02.
038100     PERFORM PRINT-DETAIL.
038200 LINK-TEST-03.
038300     MOVE "SUBPROGRAM INDEX" TO FEATURE.
038400     MOVE "LINK-TEST-03" TO PAR-NAME.
038500*        THIS TEST  VERIFIES THAT A SUBPROGRAM INDEX FOR
038600*    A TABLE DEFINED IN THE LINKAGE SECTION OF IC107 CAN BE
038700*    USED TO REFERENCE THE TABLE.
038800 LINK-TEST-03-01.
038900     MOVE 1 TO REC-CT.
039000     IF DN2 (1) EQUAL TO "A"
039100         PERFORM PASS
039200         GO TO LINK-WRITE-03-01.
039300 LINK-FAIL-03-01.
039400     PERFORM FAIL.
039500     MOVE DN2 (1) TO COMPUTED-A.
039600     MOVE "A" TO CORRECT-A.
039700     MOVE "INDEX IN LINKAGE SECTION" TO RE-MARK.
039800 LINK-WRITE-03-01.
039900     PERFORM PRINT-DETAIL.
040000 LINK-TEST-03-02.
040100     ADD 1 TO REC-CT.
040200     IF DN2 (2) EQUAL TO "B"
040300         PERFORM PASS
040400         GO TO LINK-WRITE-03-02.
040500 LINK-FAIL-03-02.
040600     PERFORM FAIL.
040700     MOVE DN2 (2) TO COMPUTED-A.
040800     MOVE "B" TO CORRECT-A.
040900     MOVE "INDEX IN LINKAGE SECTION" TO RE-MARK.
041000 LINK-WRITE-03-02.
041100     PERFORM PRINT-DETAIL.
041200 LINK-TEST-04.
041300     MOVE "INDEX DATA ITEM" TO FEATURE.
041400     MOVE "LINK-TEST-04" TO PAR-NAME.
041500*        THIS TEST VERIFIES THAT AN INDEX DATA ITEM
041600*    SET IN THE SUBPROGRAM CAN BE USED IN THE MAIN PROGRAM.
041700 LINK-TEST-04-01.
041800     MOVE 1 TO REC-CT.
041900     SET IN1 TO IDN1.
042000     IF IN1 EQUAL TO 3
042100         PERFORM PASS
042200         GO TO LINK-WRITE-04-01.
042300 LINK-FAIL-04-01.
042400     MOVE  3  TO CORRECT-18V0.
042500     SET      INDEX-VALUE TO IN1.
042600     MOVE     INDEX-VALUE TO COMPUTED-18V0.
042700     PERFORM FAIL.
042800     MOVE "INDEX DATA ITEM SET IN SUBPROG" TO RE-MARK.
042900 LINK-WRITE-04-01.
043000     PERFORM PRINT-DETAIL.
043100 LINK-TEST-04-02.
043200     ADD 1 TO REC-CT.
043300     IF DN1 (IN1) EQUAL TO "C"
043400         PERFORM PASS
043500         GO TO LINK-WRITE-04-02.
043600 LINK-FAIL-04-02.
043700     MOVE "C" TO CORRECT-A.
043800     MOVE DN1 (IN1) TO COMPUTED-A.
043900     MOVE "INDEX DATA ITEM SET IN SUBPROG" TO RE-MARK.
044000     PERFORM FAIL.
044100 LINK-WRITE-04-02.
044200     PERFORM PRINT-DETAIL.
044300 LINK-TEST-04-03.
044400     ADD 1 TO REC-CT.
044500     IF DN2 (3) EQUAL TO "C"
044600         PERFORM PASS
044700         GO TO LINK-WRITE-04-03.
044800 LINK-FAIL-04-03.
044900     PERFORM FAIL.
045000     MOVE "C" TO CORRECT-A.
045100     MOVE DN2 (3) TO COMPUTED-A.
045200     MOVE "INDEX DATA ITEM SET IN SUBPROG" TO RE-MARK.
045300 LINK-WRITE-04-03.
045400     PERFORM PRINT-DETAIL.
045500 LINK-TEST-05.
045600     MOVE "TABLE REFERENCES" TO FEATURE.
045700     MOVE "LINK-TEST-05" TO PAR-NAME.
045800*        THIS TEST VERIFIES THAT DATA WAS MOVED FROM THE
045900*    FIRST TABLE IN USING PHRASE TO SECOND TABLE IN USING PHRASE.
046000*    DATA WAS MOVED IN SUBPROGRAM IC107.
046100 LINK-TEST-05-01.
046200     MOVE 1 TO REC-CT.
046300     IF DN2 (4) EQUAL TO "D"
046400         PERFORM PASS
046500         GO TO LINK-WRITE-05-01.
046600 LINK-FAIL-05-01.
046700     PERFORM FAIL.
046800     MOVE DN2 (4) TO COMPUTED-A.
046900     MOVE "D" TO CORRECT-A.
047000     MOVE "TABLES DEFINED IN LINKAGE SEC" TO RE-MARK.
047100 LINK-WRITE-05-01.
047200     PERFORM PRINT-DETAIL.
047300 LINK-TEST-05-02.
047400     ADD 1 TO REC-CT.
047500     IF DN2 (5) EQUAL TO "E"
047600         PERFORM PASS
047700         GO TO LINK-WRITE-05-02.
047800 LINK-FAIL-05-02.
047900     PERFORM FAIL.
048000     MOVE DN2 (5) TO COMPUTED-A.
048100     MOVE "E" TO CORRECT-A.
048200     MOVE "TABLES DEFINED IN LINKAGE SEC" TO RE-MARK.
048300 LINK-WRITE-05-02.
048400     PERFORM PRINT-DETAIL.
048500 LINK-TEST-06.
048600     MOVE "REDEFINED ITEM" TO FEATURE.
048700     MOVE "LINK-TEST-06" TO PAR-NAME.
048800*        THIS TEST VERIFIES THAT DATA WAS MOVED TO
048900*    A REDEFINED ITEM IN THE LINKAGE SECTION OF IC107.
049000 LINK-TEST-06-01.
049100     MOVE 1 TO REC-CT.
049200     IF DN2 (8) EQUAL TO "X"
049300         PERFORM PASS
049400         GO TO LINK-WRITE-06-01.
049500 LINK-FAIL-06-01.
049600     PERFORM FAIL.
049700     MOVE DN2 (8) TO COMPUTED-A.
049800     MOVE "X" TO CORRECT-A.
049900     MOVE "REDEFINED ITEM IN LINKAGE SEC" TO RE-MARK.
050000 LINK-WRITE-06-01.
050100     PERFORM PRINT-DETAIL.
050200 LINK-TEST-06-02.
050300     ADD 1 TO REC-CT.
050400     IF DN2 (9) EQUAL TO "Y"
050500         PERFORM PASS
050600         GO TO LINK-WRITE-06-02.
050700 LINK-FAIL-06-02.
050800     PERFORM FAIL.
050900     MOVE DN2 (9) TO COMPUTED-A.
051000     MOVE "Y" TO CORRECT-A.
051100     MOVE "REDEFINED ITEM IN LINKAGE SEC" TO RE-MARK.
051200 LINK-WRITE-06-02.
051300     PERFORM PRINT-DETAIL.
051400 LINK-TEST-06-03.
051500     ADD 1 TO REC-CT.
051600     IF DN2 (10) EQUAL TO "Z"
051700         PERFORM PASS
051800         GO TO LINK-WRITE-06-03.
051900 LINK-FAIL-06-03.
052000     PERFORM FAIL.
052100     MOVE DN2 (10) TO COMPUTED-A.
052200     MOVE "Z" TO CORRECT-A.
052300     MOVE "REDEFINED ITEM IN LINKAGE SEC" TO RE-MARK.
052400 LINK-WRITE-06-03.
052500     PERFORM PRINT-DETAIL.
052600 LINK-END-ROUTINE.
052700     GO TO CCVS-EXIT.
052800 CCVS-EXIT SECTION.
052900 CCVS-999999.
053000     GO TO CLOSE-FILES.
