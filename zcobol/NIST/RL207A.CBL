000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RL207A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*GENERAL:    THE FUNCTION OF THIS PROGRAM IS TO PROCESS A RELATIVE
001400*            I-O FILE RANDOMLY (ACCESS MODE IS DYNAMIC). THE FILE
001500*            USED AS INPUT IS THAT FILE CREATED BY RL206A.
001600*
001700*            FIRST THE FILE IS VERIFED AS TO THE EXISTANCE AND
001800*            ACCURACY OF THE 500  RECORDS CREATED IN THE FIRST
001900*            PROGRAM.  SECONDLY, RECORDS OF THE FILE ARE SEL-
002000*            ECTIVELY UPDATED; AND THIRDLY, THE ACCURACY OF EACH
002100*            RECORD IN THE FILE IS AGAIN VERIFIED.
002200*
002300*            X-CARD PARAMETERS WHICH MUST BE SUPPLIED FOR THIS
002400*            PROGRAM ARE:
002500*
002600*                 X-21   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
002700*                         RELATIVE  I-O DATA FILE
002800*                 X-55   SYSTEM PRINTER
002900*                 X-69   ADDITIONAL VALUE OF CLAUSES
003000*                 X-74   VALUE OF IMPLEMENTOR-NAME
003100*                 X-75   OBJECT OF VALUE OF CLAUSE
003200*                 X-82   SOURCE-COMPUTER
003300*                 X-83   OBJECT-COMPUTER.
003400*
003500****************************************************************
003600 ENVIRONMENT DIVISION.
003700 CONFIGURATION SECTION.
003800 SOURCE-COMPUTER.
003900     XXXXX082.
004000 OBJECT-COMPUTER.
004100     XXXXX083.
004200 INPUT-OUTPUT SECTION.
004300 FILE-CONTROL.
004400     SELECT PRINT-FILE ASSIGN TO
004500     XXXXX055.
004600     SELECT  RL-FD1 ASSIGN TO
004700     XXXXP021
004800             ORGANIZATION IS RELATIVE
004900             ACCESS  MODE IS DYNAMIC
005000             RELATIVE KEY RL-FD1-KEY
005100             STATUS WS-STATUS.
005200 DATA DIVISION.
005300 FILE SECTION.
005400 FD  PRINT-FILE.
005500 01  PRINT-REC PICTURE X(120).
005600 01  DUMMY-RECORD PICTURE X(120).
005700 FD  RL-FD1
005800     LABEL RECORDS STANDARD
005900C    VALUE OF
006000C    XXXXX074
006100C    IS
006200C    XXXXX075
006300G    XXXXX069
006400     BLOCK  CONTAINS 1 RECORDS
006500     RECORD VARYING 120 TO 140 DEPENDING WRK-SIZE.
006600 01  RL-FD1R1-F-G-140.
006700     02 FILLER PICTURE X(140).
006800 WORKING-STORAGE SECTION.
006900 01  WS-STATUS    PIC XX.
007000 01  WRK-SIZE     PIC 999.
007100 01  WRK-CS-09V00 PIC S9(09)      USAGE COMP VALUE ZERO.
007200 01  RL-FD1-KEY        PIC 9(09)  USAGE COMP VALUE ZERO.
007300 01  WRK-DS-09V00-002 PIC S9(9) VALUE ZERO.
007400 01  WRK-CS-09V00-002 PIC S9(09)       USAGE COMP VALUE ZERO.
007500 01  WRK-CS-09V00-003 PIC S9(09)       USAGE COMP VALUE ZERO.
007600 01  I-O-ERROR-RL-FD1 PIC X(3) VALUE "NO ".
007700 01  WRK-CS-09V00-001 PIC S9(09)       USAGE COMP VALUE ZERO.
007800 01  WRK-CS-09V00-004 PIC S9(09)       USAGE COMP VALUE ZERO.
007900 01  WRK-CS-09V00-005 PIC S9(09)       USAGE COMP VALUE ZERO.
008000 01  WRK-DS-09V00-001 PIC S9(09)      VALUE ZERO.
008100 01  FILE-RECORD-INFORMATION-REC.
008200     03 FILE-RECORD-INFO-SKELETON.
008300        05 FILLER                 PICTURE X(48)       VALUE
008400             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
008500        05 FILLER                 PICTURE X(46)       VALUE
008600             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
008700        05 FILLER                 PICTURE X(26)       VALUE
008800             ",LFIL=000000,ORG=  ,LBLR= ".
008900        05 FILLER                 PICTURE X(37)       VALUE
009000             ",RECKEY=                             ".
009100        05 FILLER                 PICTURE X(38)       VALUE
009200             ",ALTKEY1=                             ".
009300        05 FILLER                 PICTURE X(38)       VALUE
009400             ",ALTKEY2=                             ".
009500        05 FILLER                 PICTURE X(7)        VALUE SPACE.
009600     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
009700        05 FILE-RECORD-INFO-P1-120.
009800           07 FILLER              PIC X(5).
009900           07 XFILE-NAME           PIC X(6).
010000           07 FILLER              PIC X(8).
010100           07 XRECORD-NAME         PIC X(6).
010200           07 FILLER              PIC X(1).
010300           07 REELUNIT-NUMBER     PIC 9(1).
010400           07 FILLER              PIC X(7).
010500           07 XRECORD-NUMBER       PIC 9(6).
010600           07 FILLER              PIC X(6).
010700           07 UPDATE-NUMBER       PIC 9(2).
010800           07 FILLER              PIC X(5).
010900           07 ODO-NUMBER          PIC 9(4).
011000           07 FILLER              PIC X(5).
011100           07 XPROGRAM-NAME        PIC X(5).
011200           07 FILLER              PIC X(7).
011300           07 XRECORD-LENGTH       PIC 9(6).
011400           07 FILLER              PIC X(7).
011500           07 CHARS-OR-RECORDS    PIC X(2).
011600           07 FILLER              PIC X(1).
011700           07 XBLOCK-SIZE          PIC 9(4).
011800           07 FILLER              PIC X(6).
011900           07 RECORDS-IN-FILE     PIC 9(6).
012000           07 FILLER              PIC X(5).
012100           07 XFILE-ORGANIZATION   PIC X(2).
012200           07 FILLER              PIC X(6).
012300           07 XLABEL-TYPE          PIC X(1).
012400        05 FILE-RECORD-INFO-P121-240.
012500           07 FILLER              PIC X(8).
012600           07 XRECORD-KEY          PIC X(29).
012700           07 FILLER              PIC X(9).
012800           07 ALTERNATE-KEY1      PIC X(29).
012900           07 FILLER              PIC X(9).
013000           07 ALTERNATE-KEY2      PIC X(29).
013100           07 FILLER              PIC X(7).
013200 01  NEW-115-CHAR-AREA.
013300   03         NEW-115-120         PIC X(115).
013400 01  NEW-125-CHAR-AREA.
013500   03         NEW-125-120         PIC X(120).
013600   03         EXTRA-5-CHARS       PIC X(5).
013700 01  NEW-128-CHAR-AREA.
013800   03         NEW-128-120         PIC X(120).
013900   03         EXTRA-8-CHARS       PIC X(8).
014000 01  NEW-130-CHAR-AREA.
014100   03         NEW-130-120         PIC X(120).
014200   03         EXTRA-10-CHARS      PIC X(10).
014300 01  NEW-132-CHAR-AREA.
014400   03         NEW-132-120         PIC X(120).
014500   03         EXTRA-12-CHARS      PIC X(12).
014600 01  NEW-135-CHAR-AREA.
014700   03         NEW-135-120         PIC X(120).
014800   03         EXTRA-15-CHARS      PIC X(15).
014900 01  NEW-140-CHAR-AREA.
015000   03         NEW-140-120         PIC X(120).
015100   03         EXTRA-20-CHARS      PIC X(20).
015200 01  NEW-145-CHAR-AREA.
015300   03         NEW-145-120         PIC X(120).
015400   03         EXTRA-25-CHARS      PIC X(25).
015500
015600 01  TEST-RESULTS.
015700     02 FILLER                   PIC X      VALUE SPACE.
015800     02 FEATURE                  PIC X(20)  VALUE SPACE.
015900     02 FILLER                   PIC X      VALUE SPACE.
016000     02 P-OR-F                   PIC X(5)   VALUE SPACE.
016100     02 FILLER                   PIC X      VALUE SPACE.
016200     02  PAR-NAME.
016300       03 FILLER                 PIC X(19)  VALUE SPACE.
016400       03  PARDOT-X              PIC X      VALUE SPACE.
016500       03 DOTVALUE               PIC 99     VALUE ZERO.
016600     02 FILLER                   PIC X(8)   VALUE SPACE.
016700     02 RE-MARK                  PIC X(61).
016800 01  TEST-COMPUTED.
016900     02 FILLER                   PIC X(30)  VALUE SPACE.
017000     02 FILLER                   PIC X(17)  VALUE
017100            "       COMPUTED=".
017200     02 COMPUTED-X.
017300     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
017400     03 COMPUTED-N               REDEFINES COMPUTED-A
017500                                 PIC -9(9).9(9).
017600     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
017700     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
017800     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
017900     03       CM-18V0 REDEFINES COMPUTED-A.
018000         04 COMPUTED-18V0                    PIC -9(18).
018100         04 FILLER                           PIC X.
018200     03 FILLER PIC X(50) VALUE SPACE.
018300 01  TEST-CORRECT.
018400     02 FILLER PIC X(30) VALUE SPACE.
018500     02 FILLER PIC X(17) VALUE "       CORRECT =".
018600     02 CORRECT-X.
018700     03 CORRECT-A                  PIC X(20) VALUE SPACE.
018800     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
018900     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
019000     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
019100     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
019200     03      CR-18V0 REDEFINES CORRECT-A.
019300         04 CORRECT-18V0                     PIC -9(18).
019400         04 FILLER                           PIC X.
019500     03 FILLER PIC X(2) VALUE SPACE.
019600     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
019700 01  CCVS-C-1.
019800     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
019900-    "SS  PARAGRAPH-NAME
020000-    "       REMARKS".
020100     02 FILLER                     PIC X(20)    VALUE SPACE.
020200 01  CCVS-C-2.
020300     02 FILLER                     PIC X        VALUE SPACE.
020400     02 FILLER                     PIC X(6)     VALUE "TESTED".
020500     02 FILLER                     PIC X(15)    VALUE SPACE.
020600     02 FILLER                     PIC X(4)     VALUE "FAIL".
020700     02 FILLER                     PIC X(94)    VALUE SPACE.
020800 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
020900 01  REC-CT                        PIC 99       VALUE ZERO.
021000 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
021100 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
021200 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
021300 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
021400 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
021500 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
021600 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
021700 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
021800 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
021900 01  CCVS-H-1.
022000     02  FILLER                    PIC X(39)    VALUE SPACES.
022100     02  FILLER                    PIC X(42)    VALUE
022200     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
022300     02  FILLER                    PIC X(39)    VALUE SPACES.
022400 01  CCVS-H-2A.
022500   02  FILLER                        PIC X(40)  VALUE SPACE.
022600   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
022700   02  FILLER                        PIC XXXX   VALUE
022800     "4.2 ".
022900   02  FILLER                        PIC X(28)  VALUE
023000            " COPY - NOT FOR DISTRIBUTION".
023100   02  FILLER                        PIC X(41)  VALUE SPACE.
023200
023300 01  CCVS-H-2B.
023400   02  FILLER                        PIC X(15)  VALUE
023500            "TEST RESULT OF ".
023600   02  TEST-ID                       PIC X(9).
023700   02  FILLER                        PIC X(4)   VALUE
023800            " IN ".
023900   02  FILLER                        PIC X(12)  VALUE
024000     " HIGH       ".
024100   02  FILLER                        PIC X(22)  VALUE
024200            " LEVEL VALIDATION FOR ".
024300   02  FILLER                        PIC X(58)  VALUE
024400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024500 01  CCVS-H-3.
024600     02  FILLER                      PIC X(34)  VALUE
024700            " FOR OFFICIAL USE ONLY    ".
024800     02  FILLER                      PIC X(58)  VALUE
024900     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
025000     02  FILLER                      PIC X(28)  VALUE
025100            "  COPYRIGHT   1985 ".
025200 01  CCVS-E-1.
025300     02 FILLER                       PIC X(52)  VALUE SPACE.
025400     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
025500     02 ID-AGAIN                     PIC X(9).
025600     02 FILLER                       PIC X(45)  VALUE SPACES.
025700 01  CCVS-E-2.
025800     02  FILLER                      PIC X(31)  VALUE SPACE.
025900     02  FILLER                      PIC X(21)  VALUE SPACE.
026000     02 CCVS-E-2-2.
026100         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
026200         03 FILLER                   PIC X      VALUE SPACE.
026300         03 ENDER-DESC               PIC X(44)  VALUE
026400            "ERRORS ENCOUNTERED".
026500 01  CCVS-E-3.
026600     02  FILLER                      PIC X(22)  VALUE
026700            " FOR OFFICIAL USE ONLY".
026800     02  FILLER                      PIC X(12)  VALUE SPACE.
026900     02  FILLER                      PIC X(58)  VALUE
027000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
027100     02  FILLER                      PIC X(13)  VALUE SPACE.
027200     02 FILLER                       PIC X(15)  VALUE
027300             " COPYRIGHT 1985".
027400 01  CCVS-E-4.
027500     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
027600     02 FILLER                       PIC X(4)   VALUE " OF ".
027700     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
027800     02 FILLER                       PIC X(40)  VALUE
027900      "  TESTS WERE EXECUTED SUCCESSFULLY".
028000 01  XXINFO.
028100     02 FILLER                       PIC X(19)  VALUE
028200            "*** INFORMATION ***".
028300     02 INFO-TEXT.
028400       04 FILLER                     PIC X(8)   VALUE SPACE.
028500       04 XXCOMPUTED                 PIC X(20).
028600       04 FILLER                     PIC X(5)   VALUE SPACE.
028700       04 XXCORRECT                  PIC X(20).
028800     02 INF-ANSI-REFERENCE           PIC X(48).
028900 01  HYPHEN-LINE.
029000     02 FILLER  PIC IS X VALUE IS SPACE.
029100     02 FILLER  PIC IS X(65)    VALUE IS "************************
029200-    "*****************************************".
029300     02 FILLER  PIC IS X(54)    VALUE IS "************************
029400-    "******************************".
029500 01  CCVS-PGM-ID                     PIC X(9)   VALUE
029600     "RL207A".
029700 PROCEDURE DIVISION.
029800 CCVS1 SECTION.
029900 OPEN-FILES.
030000     OPEN    OUTPUT PRINT-FILE.
030100     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
030200     MOVE    SPACE TO TEST-RESULTS.
030300     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
030400     MOVE    ZERO TO REC-SKL-SUB.
030500     PERFORM CCVS-INIT-FILE 9 TIMES.
030600 CCVS-INIT-FILE.
030700     ADD     1 TO REC-SKL-SUB.
030800     MOVE    FILE-RECORD-INFO-SKELETON
030900          TO FILE-RECORD-INFO (REC-SKL-SUB).
031000 CCVS-INIT-EXIT.
031100     GO TO CCVS1-EXIT.
031200 CLOSE-FILES.
031300     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
031400 TERMINATE-CCVS.
031500S    EXIT PROGRAM.
031600STERMINATE-CALL.
031700     STOP     RUN.
031800 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
031900 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
032000 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
032100 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
032200     MOVE "****TEST DELETED****" TO RE-MARK.
032300 PRINT-DETAIL.
032400     IF REC-CT NOT EQUAL TO ZERO
032500             MOVE "." TO PARDOT-X
032600             MOVE REC-CT TO DOTVALUE.
032700     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
032800     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
032900        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
033000          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
033100     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
033200     MOVE SPACE TO CORRECT-X.
033300     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
033400     MOVE     SPACE TO RE-MARK.
033500 HEAD-ROUTINE.
033600     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033700     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033800     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
033900     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
034000 COLUMN-NAMES-ROUTINE.
034100     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034200     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
034400 END-ROUTINE.
034500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
034600 END-RTN-EXIT.
034700     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034800 END-ROUTINE-1.
034900      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
035000      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
035100      ADD PASS-COUNTER TO ERROR-HOLD.
035200*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
035300      MOVE PASS-COUNTER TO CCVS-E-4-1.
035400      MOVE ERROR-HOLD TO CCVS-E-4-2.
035500      MOVE CCVS-E-4 TO CCVS-E-2-2.
035600      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
035700  END-ROUTINE-12.
035800      MOVE "TEST(S) FAILED" TO ENDER-DESC.
035900     IF       ERROR-COUNTER IS EQUAL TO ZERO
036000         MOVE "NO " TO ERROR-TOTAL
036100         ELSE
036200         MOVE ERROR-COUNTER TO ERROR-TOTAL.
036300     MOVE     CCVS-E-2 TO DUMMY-RECORD.
036400     PERFORM WRITE-LINE.
036500 END-ROUTINE-13.
036600     IF DELETE-COUNTER IS EQUAL TO ZERO
036700         MOVE "NO " TO ERROR-TOTAL  ELSE
036800         MOVE DELETE-COUNTER TO ERROR-TOTAL.
036900     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
037000     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037100      IF   INSPECT-COUNTER EQUAL TO ZERO
037200          MOVE "NO " TO ERROR-TOTAL
037300      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
037400      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
037500      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037600     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037700 WRITE-LINE.
037800     ADD 1 TO RECORD-COUNT.
037900Y    IF RECORD-COUNT GREATER 50
038000Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
038100Y        MOVE SPACE TO DUMMY-RECORD
038200Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
038300Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
038400Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
038500Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
038600Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
038700Y        MOVE ZERO TO RECORD-COUNT.
038800     PERFORM WRT-LN.
038900 WRT-LN.
039000     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
039100     MOVE SPACE TO DUMMY-RECORD.
039200 BLANK-LINE-PRINT.
039300     PERFORM WRT-LN.
039400 FAIL-ROUTINE.
039500     IF     COMPUTED-X NOT EQUAL TO SPACE
039600            GO TO FAIL-ROUTINE-WRITE.
039700     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
039800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
039900     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
040000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040100     MOVE   SPACES TO INF-ANSI-REFERENCE.
040200     GO TO  FAIL-ROUTINE-EX.
040300 FAIL-ROUTINE-WRITE.
040400     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
040500     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
040600     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
040700     MOVE   SPACES TO COR-ANSI-REFERENCE.
040800 FAIL-ROUTINE-EX. EXIT.
040900 BAIL-OUT.
041000     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
041100     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
041200 BAIL-OUT-WRITE.
041300     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
041400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
041500     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041600     MOVE   SPACES TO INF-ANSI-REFERENCE.
041700 BAIL-OUT-EX. EXIT.
041800 CCVS1-EXIT.
041900     EXIT.
042000 SECT-RL207A-001 SECTION.
042100 REL-INIT-003.
042200     MOVE   "VIII-26 4.5.4" TO ANSI-REFERENCE.
042300     OPEN    INPUT  RL-FD1.
042400     MOVE   "REL-TEST-003"   TO PAR-NAME.
042500     MOVE    ZERO TO   RL-FD1-KEY.
042600     MOVE    ZERO TO   WRK-CS-09V00-002.
042700     MOVE    ZERO  TO  WRK-CS-09V00-003.
042800*
042900     MOVE    01 TO REC-CT.
043000     MOVE   "READ RANDOM"  TO FEATURE.
043100 REL-TEST-003-R.
043200     ADD     1 TO WRK-CS-09V00-003.
043300     MOVE    WRK-CS-09V00-003 TO RL-FD1-KEY.
043400     IF      RL-FD1-KEY GREATER +501
043500             MOVE "INVALID KEY NOT TAKEN" TO COMPUTED-A
043600             MOVE RL-FD1-KEY TO CORRECT-18V0
043700             PERFORM FAIL
043800             PERFORM PRINT-DETAIL
043900             ADD 1 TO REC-CT
044000             GO TO REL-WRITE-003.
044100     READ    RL-FD1
044200             INVALID KEY GO TO REL-WRITE-003.
044300     MOVE    RL-FD1R1-F-G-140 TO FILE-RECORD-INFO-P1-120 (1).
044400     IF      XRECORD-NUMBER (1) EQUAL TO RL-FD1-KEY
044500             GO TO REL-TEST-003-R.
044600     MOVE    "YES" TO I-O-ERROR-RL-FD1.
044700     ADD      1 TO WRK-CS-09V00-002.
044800     GO TO    REL-TEST-003-R.
044900 REL-WRITE-003.
045000     IF      RL-FD1-KEY NOT EQUAL TO 501
045100              MOVE "WRONG KEY/NOT 500" TO CORRECT-A
045200              MOVE  RL-FD1-KEY TO COMPUTED-18V0
045300              PERFORM FAIL
045400              ELSE
045500              PERFORM PASS.
045600     PERFORM PRINT-DETAIL.
045700*
045800*01
045900*
046000     ADD      1 TO REC-CT.
046100     IF       XRECORD-NUMBER (1) NOT EQUAL TO 500
046200              MOVE "WRONG RECORD/NOT 500" TO CORRECT-A
046300              MOVE  XRECORD-NUMBER (1) TO COMPUTED-18V0
046400              PERFORM FAIL
046500              ELSE
046600              PERFORM PASS.
046700     PERFORM PRINT-DETAIL.
046800*
046900*02
047000*
047100     ADD      1 TO REC-CT.
047200     IF      WRK-CS-09V00-003 NOT EQUAL TO 501
047300              MOVE "INCORRECT RECORD COUNT" TO RE-MARK
047400              MOVE  WRK-CS-09V00-003 TO COMPUTED-18V0
047500             MOVE 501  TO CORRECT-18V0
047600              PERFORM FAIL
047700              ELSE
047800              PERFORM PASS.
047900     PERFORM PRINT-DETAIL.
048000*
048100*03
048200*
048300     ADD      1 TO REC-CT.
048400     IF       I-O-ERROR-RL-FD1 EQUAL TO "YES"
048500              MOVE WRK-CS-09V00-002 TO COMPUTED-18V0
048600              MOVE "RECORDS DID NOT COMPARE" TO RE-MARK
048700              PERFORM FAIL
048800              ELSE
048900              PERFORM PASS.
049000     PERFORM PRINT-DETAIL.
049100*
049200*04
049300*
049400     ADD      1 TO REC-CT.
049500     CLOSE    RL-FD1.
049600 REL-INIT-004-R .
049700     MOVE     "REL-TEST-004" TO PAR-NAME.
049800     OPEN I-O RL-FD1.
049900     MOVE     ZERO TO RL-FD1-KEY.
050000     MOVE     ZERO TO WRK-CS-09V00-002.
050100     MOVE     ZERO TO WRK-CS-09V00-003.
050200      MOVE    ZERO TO WRK-CS-09V00-004.
050300      MOVE    ZERO TO WRK-CS-09V00-005.
050400*
050500     MOVE     01 TO REC-CT.
050600     MOVE     SPACE TO  FILE-RECORD-INFO-P1-120 (1).
050700     MOVE    "REWRITE"  TO FEATURE.
050800 REL-TEST-004-R.
050900     ADD      5 TO  WRK-CS-09V00-003.
051000     MOVE     WRK-CS-09V00-003 TO RL-FD1-KEY.
051100      IF     RL-FD1-KEY GREATER 505
051200              MOVE "INVALID KEY/NOT TAKEN" TO COMPUTED-A
051300              MOVE  RL-FD1-KEY TO CORRECT-18V0
051400              PERFORM FAIL
051500              PERFORM PRINT-DETAIL
051600              ADD 1 TO REC-CT
051700              GO TO REL-TEST-004-3.
051800     READ     RL-FD1
051900              INVALID KEY GO TO REL-TEST-004-1.
052000     MOVE    RL-FD1R1-F-G-140 TO FILE-RECORD-INFO-P1-120 (1)
052100     ADD      01 TO UPDATE-NUMBER (1).
052200     MOVE CCVS-PGM-ID       TO XPROGRAM-NAME (1).
052300     MOVE     FILE-RECORD-INFO-P1-120 (1) TO RL-FD1R1-F-G-140.
052400     REWRITE    RL-FD1R1-F-G-140
052500              INVALID KEY GO TO REL-TEST-004-2.
052600     GO TO    REL-TEST-004-R.
052700 REL-TEST-004-1.
052800     IF       RL-FD1-KEY LESS THAN 501
052900              ADD 1 TO  WRK-CS-09V00-004
053000              GO TO REL-TEST-004-R.
053100     PERFORM   PASS.
053200     PERFORM   PRINT-DETAIL.
053300*
053400*01
053500*
053600     ADD     1  TO REC-CT.
053700     GO TO    REL-TEST-004-3.
053800 REL-TEST-004-2.
053900     ADD      1 TO WRK-CS-09V00-005.
054000     IF       RL-FD1-KEY LESS 501
054100              GO TO REL-TEST-004-R.
054200 REL-TEST-004-3.
054300     IF       WRK-CS-09V00-004 NOT EQUAL TO ZERO
054400              MOVE "INVALID KEY ON READ" TO COMPUTED-A
054500              MOVE WRK-CS-09V00-004 TO CORRECT-18V0
054600              PERFORM FAIL
054700              ELSE
054800              PERFORM PASS.
054900     PERFORM PRINT-DETAIL.
055000*
055100*02
055200*
055300     ADD      1 TO REC-CT.
055400     IF      WRK-CS-09V00-005 NOT EQUAL TO ZERO
055500             MOVE "INVALID KEY ON REWRITE" TO COMPUTED-A
055600             MOVE  WRK-CS-09V00-005 TO CORRECT-18V0
055700             PERFORM FAIL
055800     ELSE
055900             PERFORM PASS.
056000     PERFORM PRINT-DETAIL.
056100*
056200*03
056300*
056400     ADD     1 TO REC-CT.
056500     CLOSE   RL-FD1.
056600 REL-INIT-005.
056700     MOVE   "REL-TEST-005" TO PAR-NAME.
056800     OPEN    INPUT  RL-FD1.
056900     MOVE    501  TO WRK-CS-09V00-003.
057000     MOVE    ZERO TO WRK-CS-09V00-004.
057100     MOVE    ZERO TO WRK-CS-09V00-005.
057200     MOVE    ZERO TO WRK-CS-09V00-002.
057300     MOVE     SPACE TO  FILE-RECORD-INFO-P1-120 (1).
057400     MOVE     01 TO REC-CT.
057500*
057600     MOVE    "READ RANDOM"  TO FEATURE.
057700 REL-TEST-005-R.
057800     SUBTRACT 1 FROM    WRK-CS-09V00-003.
057900     MOVE     WRK-CS-09V00-003 TO RL-FD1-KEY.
058000     IF      WRK-CS-09V00-003 LESS THAN ZERO
058100             MOVE    "INVALID KEY/NOT TAKEN"  TO RE-MARK
058200             MOVE   WRK-CS-09V00-003  TO COMPUTED-18V0
058300             MOVE   ZERO TO CORRECT-18V0
058400              PERFORM FAIL
058500              PERFORM PRINT-DETAIL
058600              ADD 1 TO REC-CT
058700              GO TO REL-TEST-005-3.
058800     READ     RL-FD1
058900              INVALID KEY  GO TO REL-TEST-005-1.
059000     MOVE     RL-FD1R1-F-G-140 TO FILE-RECORD-INFO-P1-120 (1).
059100     IF     UPDATE-NUMBER (1) EQUAL TO 00
059200              ADD 1 TO WRK-CS-09V00-004.
059300     IF     UPDATE-NUMBER (1) EQUAL TO 01
059400              ADD 1 TO WRK-CS-09V00-005.
059500     GO TO    REL-TEST-005-R.
059600 REL-TEST-005-1.
059700     IF       RL-FD1-KEY GREATER ZERO
059800             ADD 1 TO WRK-CS-09V00-002
059900              GO TO REL-TEST-005-R.
060000     PERFORM   PASS.
060100     PERFORM   PRINT-DETAIL.
060200     ADD      1  TO REC-CT.
060300*01
060400     GO TO    REL-TEST-005-3.
060500 REL-TEST-005-3.
060600     IF       WRK-CS-09V00-004 NOT EQUAL TO 400
060700              MOVE "NON-UPDATED RECORDS" TO COMPUTED-A
060800             MOVE WRK-CS-09V00-004 TO CORRECT-18V0
060900             MOVE "SHOULD BE 400" TO RE-MARK
061000             PERFORM FAIL
061100     ELSE
061200             PERFORM PASS.
061300     PERFORM PRINT-DETAIL.
061400*
061500*
061600*02
061700*
061800     ADD     1 TO REC-CT.
061900     IF      WRK-CS-09V00-005 NOT EQUAL TO 100
062000             MOVE "UPDATED RECORDS" TO COMPUTED-A
062100             MOVE WRK-CS-09V00-005 TO CORRECT-18V0
062200             MOVE "SHOULD BE 100" TO RE-MARK
062300             PERFORM FAIL
062400     ELSE
062500             PERFORM PASS.
062600     PERFORM PRINT-DETAIL.
062700*
062800*03
062900*
063000     ADD     1 TO REC-CT.
063100     IF      WRK-CS-09V00-002 GREATER 1
063200             MOVE WRK-CS-09V00-002 TO COMPUTED-N
063300             MOVE  "INVALID KEY/READS" TO CORRECT-A
063400             PERFORM FAIL
063500     ELSE
063600             PERFORM PASS.
063700     PERFORM PRINT-DETAIL.
063800*
063900*04
064000*
064100     ADD     1 TO REC-CT.
064200     CLOSE   RL-FD1.
064300 REL-INIT-006.
064400     MOVE   "REL-TEST-006" TO PAR-NAME.
064500     OPEN    I-O  RL-FD1.
064600     MOVE   "VAR. SIZE REC UPDATE" TO FEATURE.
064700     MOVE    1    TO WRK-CS-09V00-003.
064800     MOVE    WRK-CS-09V00-003 TO RL-FD1-KEY.
064900     READ    RL-FD1
065000             INVALID KEY  MOVE "REL-INIT-006 READ1" TO PAR-NAME
065100                          MOVE "INVALID KEY ON 1ST RECORD READ"
065200                             TO RE-MARK
065300                          PERFORM FAIL
065400                          PERFORM PRINT-DETAIL
065500                          GO TO   REL-INIT-007.
065600     MOVE    RL-FD1R1-F-G-140 TO FILE-RECORD-INFO-P1-120 (1).
065700     MOVE    98 TO UPDATE-NUMBER (1).
065800     MOVE    FILE-RECORD-INFO-P1-120 (1) TO RL-FD1R1-F-G-140.
065900     MOVE    120 TO WRK-SIZE.
066000     REWRITE RL-FD1R1-F-G-140
066100             INVALID KEY MOVE "REL-INIT-006 REWRITE" TO PAR-NAME
066200                         MOVE "INVALID KEY ON 1ST RECORD REWRITE"
066300                            TO RE-MARK
066400                         PERFORM FAIL
066500                         PERFORM PRINT-DETAIL
066600                         GO TO   REL-INIT-007.
066700     MOVE    SPACES   TO RL-FD1R1-F-G-140.
066800     READ    RL-FD1
066900             INVALID KEY  MOVE "REL-INIT-006 READ2" TO PAR-NAME
067000                          MOVE "INVALID KEY ON 1ST RECORD READ"
067100                             TO RE-MARK
067200                          PERFORM FAIL
067300                          PERFORM PRINT-DETAIL
067400                          GO TO   REL-INIT-007.
067500 REL-TEST-006.
067600     MOVE   "REL-TEST-006" TO PAR-NAME.
067700     MOVE    RL-FD1R1-F-G-140 TO FILE-RECORD-INFO-P1-120 (1).
067800     IF      UPDATE-NUMBER (1) = 98
067900             PERFORM PASS
068000             PERFORM PRINT-DETAIL
068100     ELSE
068200             MOVE   "INVALID UPDATE OF UPDATE NUMBER FIELD"
068300                  TO RE-MARK
068400             MOVE    UPDATE-NUMBER (1) TO COMPUTED-X
068500             MOVE    98 TO CORRECT-N
068600             PERFORM FAIL
068700             PERFORM PRINT-DETAIL.
068800*
068900 REL-INIT-007.
069000     MOVE   "REL-TEST-007" TO PAR-NAME.
069100     MOVE    11   TO WRK-CS-09V00-003.
069200     MOVE    WRK-CS-09V00-003 TO RL-FD1-KEY.
069300     READ    RL-FD1
069400             INVALID KEY  MOVE "REL-INIT-007 READ1" TO PAR-NAME
069500                          MOVE "INVALID KEY ON 11TH RECORD READ"
069600                             TO RE-MARK
069700                          PERFORM FAIL
069800                          PERFORM PRINT-DETAIL
069900                          GO TO   REL-INIT-008.
070000     MOVE    RL-FD1R1-F-G-140 TO NEW-130-CHAR-AREA.
070100     MOVE    NEW-130-120      TO FILE-RECORD-INFO-P1-120 (1).
070200     MOVE    98 TO UPDATE-NUMBER (1).
070300     MOVE    FILE-RECORD-INFO-P1-120 (1) TO NEW-130-120.
070400     MOVE    NEW-130-CHAR-AREA           TO RL-FD1R1-F-G-140.
070500     MOVE    130 TO WRK-SIZE.
070600     REWRITE RL-FD1R1-F-G-140
070700             INVALID KEY MOVE "REL-INIT-007 REWRITE" TO PAR-NAME
070800                         MOVE "INVALID KEY ON 11TH RECORD REWRITE"
070900                            TO RE-MARK
071000                         PERFORM FAIL
071100                         PERFORM PRINT-DETAIL
071200                         GO TO   REL-INIT-008.
071300     MOVE    SPACES   TO RL-FD1R1-F-G-140.
071400     READ    RL-FD1
071500             INVALID KEY  MOVE "REL-INIT-007 READ2" TO PAR-NAME
071600                          MOVE "INVALID KEY ON 11TH RECORD READ"
071700                             TO RE-MARK
071800                          PERFORM FAIL
071900                          PERFORM PRINT-DETAIL
072000                          GO TO   REL-INIT-008.
072100 REL-TEST-007.
072200     MOVE   "REL-TEST-007" TO PAR-NAME.
072300     MOVE    RL-FD1R1-F-G-140 TO FILE-RECORD-INFO-P1-120 (1).
072400     IF      UPDATE-NUMBER (1) = 98
072500             PERFORM PASS
072600             PERFORM PRINT-DETAIL
072700     ELSE
072800             MOVE   "INVALID UPDATE OF UPDATE NUMBER FIELD"
072900                  TO RE-MARK
073000             MOVE    UPDATE-NUMBER (1) TO COMPUTED-X
073100             MOVE    98 TO CORRECT-N
073200             PERFORM FAIL
073300             PERFORM PRINT-DETAIL.
073400*
073500 REL-INIT-008.
073600     MOVE   "REL-TEST-008" TO PAR-NAME.
073700     MOVE    21   TO WRK-CS-09V00-003.
073800     MOVE    WRK-CS-09V00-003 TO RL-FD1-KEY.
073900     READ    RL-FD1
074000             INVALID KEY  MOVE "REL-INIT-008 READ1" TO PAR-NAME
074100                          MOVE "INVALID KEY ON 21ST RECORD READ"
074200                             TO RE-MARK
074300                          PERFORM FAIL
074400                          PERFORM PRINT-DETAIL
074500                          GO TO   REL-INIT-009.
074600     MOVE    RL-FD1R1-F-G-140 TO NEW-140-CHAR-AREA.
074700     MOVE    NEW-140-120      TO FILE-RECORD-INFO-P1-120 (1).
074800     MOVE    98 TO UPDATE-NUMBER (1).
074900     MOVE    FILE-RECORD-INFO-P1-120 (1) TO NEW-140-120.
075000     MOVE    NEW-140-CHAR-AREA           TO RL-FD1R1-F-G-140.
075100     MOVE    140 TO WRK-SIZE.
075200     REWRITE RL-FD1R1-F-G-140
075300             INVALID KEY MOVE "REL-INIT-008 REWRITE" TO PAR-NAME
075400                         MOVE "INVALID KEY ON 21ST RECORD REWRITE"
075500                            TO RE-MARK
075600                         PERFORM FAIL
075700                         PERFORM PRINT-DETAIL
075800                         GO TO   REL-INIT-009.
075900     MOVE    SPACES   TO RL-FD1R1-F-G-140.
076000     READ    RL-FD1
076100             INVALID KEY  MOVE "REL-INIT-008 READ2" TO PAR-NAME
076200                          MOVE "INVALID KEY ON 21ST RECORD READ"
076300                             TO RE-MARK
076400                          PERFORM FAIL
076500                          PERFORM PRINT-DETAIL
076600                          GO TO   REL-INIT-009.
076700 REL-TEST-008.
076800     MOVE   "REL-TEST-008" TO PAR-NAME.
076900     MOVE    RL-FD1R1-F-G-140 TO FILE-RECORD-INFO-P1-120 (1).
077000     IF      UPDATE-NUMBER (1) = 98
077100             PERFORM PASS
077200             PERFORM PRINT-DETAIL
077300     ELSE
077400             MOVE   "INVALID UPDATE OF UPDATE NUMBER FIELD"
077500                  TO RE-MARK
077600             MOVE    UPDATE-NUMBER (1) TO COMPUTED-X
077700             MOVE    98 TO CORRECT-N
077800             PERFORM FAIL
077900             PERFORM PRINT-DETAIL.
078000*
078100 REL-INIT-009.
078200     MOVE   "REL-TEST-009" TO PAR-NAME.
078300     MOVE    31   TO WRK-CS-09V00-003.
078400     MOVE    WRK-CS-09V00-003 TO RL-FD1-KEY.
078500     READ    RL-FD1
078600             INVALID KEY  MOVE "REL-INIT-009 READ1" TO PAR-NAME
078700                          MOVE "INVALID KEY ON 31ST RECORD READ"
078800                             TO RE-MARK
078900                          PERFORM FAIL
079000                          PERFORM PRINT-DETAIL
079100                          GO TO   REL-INIT-010.
079200     MOVE    RL-FD1R1-F-G-140 TO NEW-125-CHAR-AREA.
079300     MOVE    NEW-125-120      TO FILE-RECORD-INFO-P1-120 (1).
079400     MOVE    98 TO UPDATE-NUMBER (1).
079500     MOVE    FILE-RECORD-INFO-P1-120 (1) TO NEW-128-120.
079600     MOVE   "ABCDEFGH" TO EXTRA-8-CHARS.
079700     MOVE    NEW-128-CHAR-AREA           TO RL-FD1R1-F-G-140.
079800     MOVE    128 TO WRK-SIZE.
079900 REL-TEST-009-1.
080000     MOVE   "REL-TEST-009-1" TO PAR-NAME.
080100     REWRITE RL-FD1R1-F-G-140
080200             INVALID KEY MOVE "INVALID KEY - 31ST RECORD REWRITE"
080300                            TO RE-MARK
080400                         PERFORM FAIL
080500                         PERFORM PRINT-DETAIL
080600                         GO TO   REL-INIT-010.
080700     PERFORM PASS.
080800     PERFORM PRINT-DETAIL.
080900     MOVE    SPACES   TO RL-FD1R1-F-G-140.
081000     READ    RL-FD1
081100             INVALID KEY  MOVE "REL-INIT-009 READ2" TO PAR-NAME
081200                          MOVE "INVALID KEY ON 31ST RECORD READ"
081300                             TO RE-MARK
081400                          PERFORM FAIL
081500                          PERFORM PRINT-DETAIL
081600                          GO TO   REL-INIT-010.
081700 REL-TEST-009-2.
081800     MOVE   "REL-TEST-009-2" TO PAR-NAME.
081900     MOVE    RL-FD1R1-F-G-140 TO NEW-128-CHAR-AREA.
082000     MOVE    NEW-128-120      TO FILE-RECORD-INFO-P1-120 (1).
082100     IF      UPDATE-NUMBER (1) = 98
082200             PERFORM PASS
082300             PERFORM PRINT-DETAIL
082400     ELSE
082500             MOVE   "INVALID UPDATE OF UPDATE NUMBER FIELD"
082600                  TO RE-MARK
082700             MOVE    UPDATE-NUMBER (1) TO COMPUTED-X
082800             MOVE    98 TO CORRECT-N
082900             PERFORM FAIL
083000             PERFORM PRINT-DETAIL.
083100 REL-TEST-009-3.
083200     MOVE   "REL-TEST-009-3" TO PAR-NAME.
083300     IF      EXTRA-8-CHARS = "ABCDEFGH"
083400             PERFORM PASS
083500             PERFORM PRINT-DETAIL
083600     ELSE
083700             MOVE   "INVALID UPDATE OF DIFFERENT LENGTH. RECS"
083800                  TO RE-MARK
083900             MOVE   "ABCDEFGH" TO CORRECT-X
084000             MOVE    EXTRA-8-CHARS TO COMPUTED-X
084100             PERFORM FAIL
084200             PERFORM PRINT-DETAIL.
084300*
084400 REL-INIT-010.
084500     MOVE   "REL-TEST-010" TO PAR-NAME.
084600     MOVE    32   TO WRK-CS-09V00-003.
084700     MOVE    WRK-CS-09V00-003 TO RL-FD1-KEY.
084800     READ    RL-FD1
084900             INVALID KEY  MOVE "REL-INIT-010 READ1" TO PAR-NAME
085000                          MOVE "INVALID KEY ON 32ND RECORD READ"
085100                             TO RE-MARK
085200                          PERFORM FAIL
085300                          PERFORM PRINT-DETAIL
085400                          GO TO   REL-INIT-011.
085500     MOVE    RL-FD1R1-F-G-140 TO NEW-135-CHAR-AREA.
085600     MOVE    NEW-135-120      TO FILE-RECORD-INFO-P1-120 (1).
085700     MOVE    98 TO UPDATE-NUMBER (1).
085800     MOVE    FILE-RECORD-INFO-P1-120 (1) TO NEW-132-120.
085900     MOVE   "ABCDEFGHIJKL" TO EXTRA-12-CHARS.
086000     MOVE    NEW-132-CHAR-AREA           TO RL-FD1R1-F-G-140.
086100     MOVE    132 TO WRK-SIZE.
086200 REL-TEST-010-1.
086300     MOVE   "REL-TEST-010-1" TO PAR-NAME.
086400     REWRITE RL-FD1R1-F-G-140
086500             INVALID KEY MOVE "INVALID KEY - 32ND RECORD REWRITE"
086600                            TO RE-MARK
086700                         PERFORM FAIL
086800                         PERFORM PRINT-DETAIL
086900                         GO TO   REL-INIT-011.
087000     PERFORM PASS.
087100     PERFORM PRINT-DETAIL.
087200     MOVE    SPACES   TO RL-FD1R1-F-G-140.
087300     READ    RL-FD1
087400             INVALID KEY
087500                          MOVE "INVALID KEY ON 32ND RECORD READ"
087600                             TO RE-MARK
087700                          PERFORM FAIL
087800                          PERFORM PRINT-DETAIL
087900                          GO TO   REL-INIT-011.
088000 REL-TEST-010-2.
088100     MOVE   "REL-TEST-010-2" TO PAR-NAME.
088200     MOVE    RL-FD1R1-F-G-140 TO NEW-132-CHAR-AREA.
088300     MOVE    NEW-132-120      TO FILE-RECORD-INFO-P1-120 (1).
088400     IF      UPDATE-NUMBER (1) = 98
088500             PERFORM PASS
088600             PERFORM PRINT-DETAIL
088700     ELSE
088800             MOVE   "INVALID UPDATE OF UPDATE NUMBER FIELD"
088900                  TO RE-MARK
089000             MOVE    UPDATE-NUMBER (1) TO COMPUTED-X
089100             MOVE    98 TO CORRECT-N
089200             PERFORM FAIL
089300             PERFORM PRINT-DETAIL.
089400 REL-TEST-010-3.
089500     MOVE   "REL-TEST-010-3" TO PAR-NAME.
089600     IF      EXTRA-12-CHARS = "ABCDEFGHIJKL"
089700             PERFORM PASS
089800             PERFORM PRINT-DETAIL
089900     ELSE
090000             MOVE   "INVALID UPDATE OF DIFFERENT LENGTH. RECS"
090100                  TO RE-MARK
090200             MOVE   "ABCDEFGHIJKL" TO CORRECT-X
090300             MOVE    EXTRA-12-CHARS TO COMPUTED-X
090400             PERFORM FAIL
090500             PERFORM PRINT-DETAIL.
090600*
090700 REL-INIT-011.
090800     MOVE   "REL-TEST-011" TO PAR-NAME.
090900     MOVE    33   TO WRK-CS-09V00-003.
091000     MOVE    WRK-CS-09V00-003 TO RL-FD1-KEY.
091100     READ    RL-FD1
091200             INVALID KEY  MOVE "REL-INIT-011 READ1" TO PAR-NAME
091300                          MOVE "INVALID KEY ON 33RD RECORD READ"
091400                             TO RE-MARK
091500                          PERFORM FAIL
091600                          PERFORM PRINT-DETAIL
091700                          GO TO   REL-INIT-012.
091800     MOVE    RL-FD1R1-F-G-140 TO NEW-145-CHAR-AREA.
091900     MOVE    NEW-145-120      TO FILE-RECORD-INFO-P1-120 (1).
092000     MOVE    98 TO UPDATE-NUMBER (1).
092100     MOVE    FILE-RECORD-INFO-P1-120 (1) TO NEW-145-120.
092200     MOVE   "ABCDEFGHIJKLMNOPQRSTUVWXY"  TO EXTRA-25-CHARS.
092300     MOVE    145 TO WRK-SIZE.
092400 REL-TEST-011-1.
092500     MOVE   "REL-TEST-011-1" TO PAR-NAME.
092600*    REWRITE RL-FD1R1-F-G-140 FROM NEW-145-CHAR-AREA
092700*            INVALID GO TO REL-TEST-011-1-A.
092800*REL-TEST-011-1-A.
092900*    IF      WS-STATUS = "44"
093000*            PERFORM PASS
093100*            PERFORM PRINT-DETAIL
093200*    ELSE
093300*            MOVE  "INCORRECT FILE STATUS HAS OCCURED"
093400*                TO RE-MARK
093500*            MOVE   "44"       TO CORRECT-X
093600*            MOVE    WS-STATUS TO COMPUTED-X
093700*            PERFORM FAIL
093800*            PERFORM PRINT-DETAIL.
093900*    MOVE    SPACES   TO RL-FD1R1-F-G-140.
094000*    READ    RL-FD1  INTO NEW-140-CHAR-AREA
094100*            INVALID KEY
094200*                         MOVE "INVALID KEY ON 33RD RECORD READ"
094300*                            TO RE-MARK
094400*                         PERFORM FAIL
094500*                         PERFORM PRINT-DETAIL
094600                          GO TO   CCVS-EXIT.
094700 REL-TEST-011-2.
094800     MOVE   "REL-TEST-011-2" TO PAR-NAME.
094900     MOVE    NEW-140-120      TO FILE-RECORD-INFO-P1-120 (1).
095000     IF      UPDATE-NUMBER (1) = ZERO
095100             PERFORM PASS
095200             PERFORM PRINT-DETAIL
095300     ELSE
095400             MOVE   "INVALID UPDATE OF UPDATE NUMBER FIELD"
095500                  TO RE-MARK
095600             MOVE    UPDATE-NUMBER (1) TO COMPUTED-X
095700             MOVE    00 TO CORRECT-N
095800             PERFORM FAIL
095900             PERFORM PRINT-DETAIL.
096000 REL-TEST-011-3.
096100     MOVE   "REL-TEST-011-3" TO PAR-NAME.
096200     IF      EXTRA-20-CHARS = "ABCDEFGHIJKLMNOPQRST"
096300             PERFORM PASS
096400             PERFORM PRINT-DETAIL
096500     ELSE
096600             MOVE   "INVALID UPDATE OF DIFFERENT LENGTH. RECS"
096700                  TO RE-MARK
096800             MOVE "ABCDEFGHIJKLMNOPQRST" TO CORRECT-X
096900             MOVE    EXTRA-20-CHARS TO COMPUTED-X
097000             PERFORM FAIL
097100             PERFORM PRINT-DETAIL.
097200 REL-TEST-011-4.
097300     MOVE   "REL-TEST-011-4" TO PAR-NAME.
097400     IF      WRK-SIZE = 140
097500             PERFORM PASS
097600             PERFORM PRINT-DETAIL
097700     ELSE
097800             MOVE   "INCORRECT RECORD LENGTH READ"
097900                  TO RE-MARK
098000             MOVE    140      TO CORRECT-18V0
098100             MOVE    WRK-SIZE TO COMPUTED-18V0
098200             PERFORM FAIL
098300             PERFORM PRINT-DETAIL.
098400*
098500 REL-INIT-012.
098600     MOVE   "REL-TEST-012" TO PAR-NAME.
098700     MOVE    34   TO WRK-CS-09V00-003.
098800     MOVE    WRK-CS-09V00-003 TO RL-FD1-KEY.
098900     READ    RL-FD1
099000             INVALID KEY  MOVE "REL-INIT-012 READ1" TO PAR-NAME
099100                          MOVE "INVALID KEY ON 34TH RECORD READ"
099200                             TO RE-MARK
099300                          PERFORM FAIL
099400                          PERFORM PRINT-DETAIL
099500                          GO TO   CCVS-EXIT.
099600     MOVE    LOW-VALUES TO FILE-RECORD-INFO-P1-120 (1).
099700     MOVE    98 TO UPDATE-NUMBER (1).
099800     MOVE    FILE-RECORD-INFO-P1-120 (1) TO NEW-115-120.
099900     MOVE    115 TO WRK-SIZE.
100000 REL-TEST-012-1.
100100     MOVE   "REL-TEST-012-1" TO PAR-NAME.
100200
100300     REWRITE RL-FD1R1-F-G-140 FROM NEW-115-CHAR-AREA
100400             INVALID GO TO REL-TEST-012-2.
100500*REL-TEST-012-1-A.
100600*    IF      WS-STATUS = "44"
100700*            PERFORM PASS
100800*            PERFORM PRINT-DETAIL
100900*    ELSE
101000*            MOVE  "INCORRECT FILE STATUS HAS OCCURED"
101100*                TO RE-MARK
101200*            MOVE   "44"       TO CORRECT-X
101300*            MOVE    WS-STATUS TO COMPUTED-X
101400*            PERFORM FAIL
101500*            PERFORM PRINT-DETAIL.
101600*    MOVE    SPACES   TO RL-FD1R1-F-G-140.
101700*    READ    RL-FD1  INTO NEW-140-CHAR-AREA
101800*            INVALID KEY  MOVE "REL-INIT-012 READ2" TO PAR-NAME
101900*                         MOVE "INVALID KEY ON 34TH RECORD READ"
102000*                            TO RE-MARK
102100*                         PERFORM FAIL
102200*                         PERFORM PRINT-DETAIL
102300*                         GO TO   REL-INIT-012.
102400 REL-TEST-012-2.
102500     MOVE   "REL-TEST-012-2" TO PAR-NAME.
102600     MOVE    NEW-140-120      TO FILE-RECORD-INFO-P1-120 (1).
102700     IF      UPDATE-NUMBER (1) = ZERO
102800             PERFORM PASS
102900             PERFORM PRINT-DETAIL
103000     ELSE
103100             MOVE   "INVALID UPDATE OF UPDATE NUMBER FIELD"
103200                  TO RE-MARK
103300             MOVE    UPDATE-NUMBER (1) TO COMPUTED-X
103400             MOVE    00 TO CORRECT-N
103500             PERFORM FAIL
103600             PERFORM PRINT-DETAIL.
103700 REL-TEST-012-3.
103800     MOVE   "REL-TEST-012-3" TO PAR-NAME.
103900     IF      EXTRA-20-CHARS = "ABCDEFGHIJKLMNOPQRST"
104000             PERFORM PASS
104100             PERFORM PRINT-DETAIL
104200     ELSE
104300             MOVE   "INVALID UPDATE OF DIFFERENT LENGTH. RECS"
104400                  TO RE-MARK
104500             MOVE "ABCDEFGHIJKLMNOPQRST" TO CORRECT-X
104600             MOVE    EXTRA-20-CHARS TO COMPUTED-X
104700             PERFORM FAIL
104800             PERFORM PRINT-DETAIL.
104900 REL-TEST-012-4.
105000     MOVE   "REL-TEST-012-4" TO PAR-NAME.
105100     IF      WRK-SIZE = 140
105200             PERFORM PASS
105300             PERFORM PRINT-DETAIL
105400     ELSE
105500             MOVE   "INCORRECT RECORD LENGTH READ"
105600                  TO RE-MARK
105700             MOVE    140      TO CORRECT-18V0
105800             MOVE    WRK-SIZE TO COMPUTED-18V0
105900             PERFORM FAIL
106000             PERFORM PRINT-DETAIL.
106100*
106200 CCVS-EXIT SECTION.
106300 CCVS-999999.
106400     GO TO CLOSE-FILES.
