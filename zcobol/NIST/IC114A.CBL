000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IC114A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*
002200*         THE ROUTINE IC114 IS A MAIN PROGRAM WHICH CALLS THE
002300*    SUBPROGRAM IC115.  THE PURPOSE OF THESE PROGRAMS IS TO
002400*    VERIFY THAT A FILE SECTION, A WORKING-STORAGE SECTION, AND
002500*    A LINKAGE SECTION CAN APPEAR IN A SUBPROGRAM, AND A FILE
002600*    CAN BE WRITTEN AND READ WITHIN A SUBPROGRAM.
002700*
002800*         THE PROGRAM IC114 CALLS IC115 TO CREATE AND VERIFY THE
002900*    FILE.  SUBSEQUENT CALLS TO THE SUBPROGRAM ARE MADE TO READ
003000*    THE FILE AND RETURN A RECORD TO THE MAIN PROGRAM WHICH CHECKS
003100*    THE RECORD CONTENTS.
003200*
003300*         THE SUBPROGRAM IC115 IS ADAPTED FROM THE SEQUENTIAL I-O
003400*    ROUTINE SQ104.  IF SQ104 DOES NOT EXECUTE CORRECTLY THEN
003500*    THE RESULTS OF THESE TESTS ARE INCONCLUSIVE.
003600*
003700****************************************************************
003800 ENVIRONMENT DIVISION.
003900 CONFIGURATION SECTION.
004000 SOURCE-COMPUTER.
004100     XXXXX082.
004200 OBJECT-COMPUTER.
004300     XXXXX083.
004400 INPUT-OUTPUT SECTION.
004500 FILE-CONTROL.
004600     SELECT PRINT-FILE ASSIGN TO
004700     XXXXX055.
004800 DATA DIVISION.
004900 FILE SECTION.
005000 FD  PRINT-FILE.
005100 01  PRINT-REC PICTURE X(120).
005200 01  DUMMY-RECORD PICTURE X(120).
005300 WORKING-STORAGE SECTION.
005400 01  GROUP-LINKAGE-VARIABLES.
005500         02  COUNT-OF-RECORDS  PICTURE 9(6).
005600     02  RECORDS-IN-ERROR  PICTURE 9(6).
005700     02  ERROR-FLAG  PICTURE 9.
005800     02  EOF-FLAG  PICTURE 9.
005900     02  CALL-FLAG  PICTURE 9.
006000 01  FILE-REC-SQ-FS3.
006100     02  XFILE-NAME-GROUP.
006200         03  FILLER   PIC X(5).
006300         03  XFILE-NAME   PIC X(6).
006400     02  XRECORD-NAME-GROUP.
006500         03  FILLER   PIC X(8).
006600         03  XRECORD-NAME   PIC X(6).
006700     02  REELUNIT-NUMBER-GROUP.
006800         03  FILLER   PIC X(1).
006900         03  REELUNIT-NUMBER   PIC 9(1).
007000     02  FILLER   PIC X(7).
007100     02  XRECORD-NUMBER   PIC 9(6).
007200     02  FILLER   PIC X(79).
007300     02  XLABEL-TYPE   PIC X(1).
007400 01  TEST-RESULTS.
007500     02 FILLER                   PIC X      VALUE SPACE.
007600     02 FEATURE                  PIC X(20)  VALUE SPACE.
007700     02 FILLER                   PIC X      VALUE SPACE.
007800     02 P-OR-F                   PIC X(5)   VALUE SPACE.
007900     02 FILLER                   PIC X      VALUE SPACE.
008000     02  PAR-NAME.
008100       03 FILLER                 PIC X(19)  VALUE SPACE.
008200       03  PARDOT-X              PIC X      VALUE SPACE.
008300       03 DOTVALUE               PIC 99     VALUE ZERO.
008400     02 FILLER                   PIC X(8)   VALUE SPACE.
008500     02 RE-MARK                  PIC X(61).
008600 01  TEST-COMPUTED.
008700     02 FILLER                   PIC X(30)  VALUE SPACE.
008800     02 FILLER                   PIC X(17)  VALUE
008900            "       COMPUTED=".
009000     02 COMPUTED-X.
009100     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
009200     03 COMPUTED-N               REDEFINES COMPUTED-A
009300                                 PIC -9(9).9(9).
009400     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
009500     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
009600     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
009700     03       CM-18V0 REDEFINES COMPUTED-A.
009800         04 COMPUTED-18V0                    PIC -9(18).
009900         04 FILLER                           PIC X.
010000     03 FILLER PIC X(50) VALUE SPACE.
010100 01  TEST-CORRECT.
010200     02 FILLER PIC X(30) VALUE SPACE.
010300     02 FILLER PIC X(17) VALUE "       CORRECT =".
010400     02 CORRECT-X.
010500     03 CORRECT-A                  PIC X(20) VALUE SPACE.
010600     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
010700     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
010800     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
010900     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
011000     03      CR-18V0 REDEFINES CORRECT-A.
011100         04 CORRECT-18V0                     PIC -9(18).
011200         04 FILLER                           PIC X.
011300     03 FILLER PIC X(2) VALUE SPACE.
011400     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
011500 01  CCVS-C-1.
011600     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
011700-    "SS  PARAGRAPH-NAME
011800-    "       REMARKS".
011900     02 FILLER                     PIC X(20)    VALUE SPACE.
012000 01  CCVS-C-2.
012100     02 FILLER                     PIC X        VALUE SPACE.
012200     02 FILLER                     PIC X(6)     VALUE "TESTED".
012300     02 FILLER                     PIC X(15)    VALUE SPACE.
012400     02 FILLER                     PIC X(4)     VALUE "FAIL".
012500     02 FILLER                     PIC X(94)    VALUE SPACE.
012600 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
012700 01  REC-CT                        PIC 99       VALUE ZERO.
012800 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
012900 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
013000 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
013100 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
013200 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
013300 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
013400 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
013500 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
013600 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
013700 01  CCVS-H-1.
013800     02  FILLER                    PIC X(39)    VALUE SPACES.
013900     02  FILLER                    PIC X(42)    VALUE
014000     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
014100     02  FILLER                    PIC X(39)    VALUE SPACES.
014200 01  CCVS-H-2A.
014300   02  FILLER                        PIC X(40)  VALUE SPACE.
014400   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
014500   02  FILLER                        PIC XXXX   VALUE
014600     "4.2 ".
014700   02  FILLER                        PIC X(28)  VALUE
014800            " COPY - NOT FOR DISTRIBUTION".
014900   02  FILLER                        PIC X(41)  VALUE SPACE.
015000
015100 01  CCVS-H-2B.
015200   02  FILLER                        PIC X(15)  VALUE
015300            "TEST RESULT OF ".
015400   02  TEST-ID                       PIC X(9).
015500   02  FILLER                        PIC X(4)   VALUE
015600            " IN ".
015700   02  FILLER                        PIC X(12)  VALUE
015800     " HIGH       ".
015900   02  FILLER                        PIC X(22)  VALUE
016000            " LEVEL VALIDATION FOR ".
016100   02  FILLER                        PIC X(58)  VALUE
016200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
016300 01  CCVS-H-3.
016400     02  FILLER                      PIC X(34)  VALUE
016500            " FOR OFFICIAL USE ONLY    ".
016600     02  FILLER                      PIC X(58)  VALUE
016700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
016800     02  FILLER                      PIC X(28)  VALUE
016900            "  COPYRIGHT   1985 ".
017000 01  CCVS-E-1.
017100     02 FILLER                       PIC X(52)  VALUE SPACE.
017200     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
017300     02 ID-AGAIN                     PIC X(9).
017400     02 FILLER                       PIC X(45)  VALUE SPACES.
017500 01  CCVS-E-2.
017600     02  FILLER                      PIC X(31)  VALUE SPACE.
017700     02  FILLER                      PIC X(21)  VALUE SPACE.
017800     02 CCVS-E-2-2.
017900         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
018000         03 FILLER                   PIC X      VALUE SPACE.
018100         03 ENDER-DESC               PIC X(44)  VALUE
018200            "ERRORS ENCOUNTERED".
018300 01  CCVS-E-3.
018400     02  FILLER                      PIC X(22)  VALUE
018500            " FOR OFFICIAL USE ONLY".
018600     02  FILLER                      PIC X(12)  VALUE SPACE.
018700     02  FILLER                      PIC X(58)  VALUE
018800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
018900     02  FILLER                      PIC X(13)  VALUE SPACE.
019000     02 FILLER                       PIC X(15)  VALUE
019100             " COPYRIGHT 1985".
019200 01  CCVS-E-4.
019300     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
019400     02 FILLER                       PIC X(4)   VALUE " OF ".
019500     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
019600     02 FILLER                       PIC X(40)  VALUE
019700      "  TESTS WERE EXECUTED SUCCESSFULLY".
019800 01  XXINFO.
019900     02 FILLER                       PIC X(19)  VALUE
020000            "*** INFORMATION ***".
020100     02 INFO-TEXT.
020200       04 FILLER                     PIC X(8)   VALUE SPACE.
020300       04 XXCOMPUTED                 PIC X(20).
020400       04 FILLER                     PIC X(5)   VALUE SPACE.
020500       04 XXCORRECT                  PIC X(20).
020600     02 INF-ANSI-REFERENCE           PIC X(48).
020700 01  HYPHEN-LINE.
020800     02 FILLER  PIC IS X VALUE IS SPACE.
020900     02 FILLER  PIC IS X(65)    VALUE IS "************************
021000-    "*****************************************".
021100     02 FILLER  PIC IS X(54)    VALUE IS "************************
021200-    "******************************".
021300 01  CCVS-PGM-ID                     PIC X(9)   VALUE
021400     "IC114A".
021500 PROCEDURE DIVISION.
021600 CCVS1 SECTION.
021700 OPEN-FILES.
021800     OPEN     OUTPUT PRINT-FILE.
021900     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
022000     MOVE    SPACE TO TEST-RESULTS.
022100     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
022200     GO TO CCVS1-EXIT.
022300 CLOSE-FILES.
022400     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
022500 TERMINATE-CCVS.
022600S    EXIT PROGRAM.
022700STERMINATE-CALL.
022800     STOP     RUN.
022900 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
023000 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
023100 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
023200 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
023300     MOVE "****TEST DELETED****" TO RE-MARK.
023400 PRINT-DETAIL.
023500     IF REC-CT NOT EQUAL TO ZERO
023600             MOVE "." TO PARDOT-X
023700             MOVE REC-CT TO DOTVALUE.
023800     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
023900     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
024000        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
024100          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
024200     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
024300     MOVE SPACE TO CORRECT-X.
024400     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
024500     MOVE     SPACE TO RE-MARK.
024600 HEAD-ROUTINE.
024700     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024800     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024900     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
025000     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
025100 COLUMN-NAMES-ROUTINE.
025200     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025300     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
025500 END-ROUTINE.
025600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
025700 END-RTN-EXIT.
025800     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025900 END-ROUTINE-1.
026000      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
026100      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
026200      ADD PASS-COUNTER TO ERROR-HOLD.
026300*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
026400      MOVE PASS-COUNTER TO CCVS-E-4-1.
026500      MOVE ERROR-HOLD TO CCVS-E-4-2.
026600      MOVE CCVS-E-4 TO CCVS-E-2-2.
026700      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
026800  END-ROUTINE-12.
026900      MOVE "TEST(S) FAILED" TO ENDER-DESC.
027000     IF       ERROR-COUNTER IS EQUAL TO ZERO
027100         MOVE "NO " TO ERROR-TOTAL
027200         ELSE
027300         MOVE ERROR-COUNTER TO ERROR-TOTAL.
027400     MOVE     CCVS-E-2 TO DUMMY-RECORD.
027500     PERFORM WRITE-LINE.
027600 END-ROUTINE-13.
027700     IF DELETE-COUNTER IS EQUAL TO ZERO
027800         MOVE "NO " TO ERROR-TOTAL  ELSE
027900         MOVE DELETE-COUNTER TO ERROR-TOTAL.
028000     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
028100     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028200      IF   INSPECT-COUNTER EQUAL TO ZERO
028300          MOVE "NO " TO ERROR-TOTAL
028400      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
028500      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
028600      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028700     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028800 WRITE-LINE.
028900     ADD 1 TO RECORD-COUNT.
029000Y    IF RECORD-COUNT GREATER 50
029100Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
029200Y        MOVE SPACE TO DUMMY-RECORD
029300Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
029400Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
029500Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
029600Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
029700Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
029800Y        MOVE ZERO TO RECORD-COUNT.
029900     PERFORM WRT-LN.
030000 WRT-LN.
030100     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
030200     MOVE SPACE TO DUMMY-RECORD.
030300 BLANK-LINE-PRINT.
030400     PERFORM WRT-LN.
030500 FAIL-ROUTINE.
030600     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
030700     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
030800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
030900     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
031000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031100     MOVE   SPACES TO INF-ANSI-REFERENCE.
031200     GO TO  FAIL-ROUTINE-EX.
031300 FAIL-ROUTINE-WRITE.
031400     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
031500     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
031600     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
031700     MOVE   SPACES TO COR-ANSI-REFERENCE.
031800 FAIL-ROUTINE-EX. EXIT.
031900 BAIL-OUT.
032000     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
032100     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
032200 BAIL-OUT-WRITE.
032300     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
032400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
032500     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032600     MOVE   SPACES TO INF-ANSI-REFERENCE.
032700 BAIL-OUT-EX. EXIT.
032800 CCVS1-EXIT.
032900     EXIT.
033000 LINK-TEST-10.
033100     MOVE 1 TO CALL-FLAG.
033200*
033300*         THIS TEST CALLS IC115 WHICH CREATES THE FILE SQ-FS3.
033400*    THIS FILE IS A MASS STORAGE SEQUENTIAL FILE WITH 120
033500*    CHARACTER RECORDS.  THERE ARE 649 RECORDS IN THE FILE.
033600*
033700     CALL "IC115A" USING GROUP-LINKAGE-VARIABLES
033800                        FILE-REC-SQ-FS3.
033900     IF COUNT-OF-RECORDS EQUAL TO 649
034000              GO TO LINK-PASS-10.
034100 LINK-FAIL-10.
034200     PERFORM FAIL.
034300     MOVE "FILE NOT CREATED IN IC115" TO RE-MARK.
034400     MOVE "RECS WRITTEN =" TO COMPUTED-A.
034500     GO TO LINK-WRITE-10.
034600 LINK-PASS-10.
034700     PERFORM PASS.
034800     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
034900 LINK-WRITE-10.
035000     MOVE "LINK-TEST-10" TO PAR-NAME.
035100     MOVE "CREATE FILE SQ-FS3" TO FEATURE.
035200     MOVE COUNT-OF-RECORDS TO CORRECT-18V0.
035300     PERFORM PRINT-DETAIL.
035400 LINK-TEST-11.
035500     MOVE 2 TO CALL-FLAG.
035600     MOVE ZERO TO COUNT-OF-RECORDS RECORDS-IN-ERROR
035700                  ERROR-FLAG EOF-FLAG.
035800     CALL "IC115A" USING GROUP-LINKAGE-VARIABLES
035900                        FILE-REC-SQ-FS3.
036000     IF ERROR-FLAG EQUAL TO ZERO
036100              GO TO LINK-PASS-11.
036200     IF COUNT-OF-RECORDS GREATER THAN 649
036300              MOVE "MORE THAN 649 RECORDS" TO RE-MARK
036400              GO TO LINK-FAIL-11.
036500     MOVE "ERRORS IN READING SQ-FS3" TO RE-MARK.
036600 LINK-FAIL-11.
036700     MOVE "RECORDS-IN-ERROR =" TO COMPUTED-A.
036800     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
036900     GO TO LINK-WRITE-11.
037000 LINK-PASS-11.
037100     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
037200     MOVE COUNT-OF-RECORDS TO CORRECT-18V0.
037300     PERFORM PASS.
037400 LINK-WRITE-11.
037500     MOVE "LINK-TEST-11" TO PAR-NAME.
037600     MOVE "VERIFY FILE SQ-FS3" TO FEATURE.
037700     PERFORM PRINT-DETAIL.
037800 LINK-INIT-12.
037900     MOVE 3 TO CALL-FLAG.
038000     MOVE ZERO TO COUNT-OF-RECORDS RECORDS-IN-ERROR
038100                  ERROR-FLAG EOF-FLAG.
038200     CALL "IC115A" USING GROUP-LINKAGE-VARIABLES
038300                        FILE-REC-SQ-FS3.
038400*         CALL IC115 TO OPEN FILE SQ-FS3.
038500     MOVE 4 TO CALL-FLAG.
038600 LINK-TEST-12.
038700     CALL "IC115A" USING GROUP-LINKAGE-VARIABLES
038800                        FILE-REC-SQ-FS3.
038900*
039000*        THIS TEST REPEATEDLY CALLS IC115 TO READ THE FILE SQ-FS3.
039100*    THE CONTENTS OF EACH DATA RECORD IS CHECKED FOR VALID DATA.
039200*
039300     IF EOF-FLAG EQUAL TO 1
039400              GO TO LINK-TEST-12-01.
039500     ADD 1 TO COUNT-OF-RECORDS.
039600     IF COUNT-OF-RECORDS GREATER THAN 649
039700              GO TO LINK-FAIL-12-02.
039800     IF COUNT-OF-RECORDS NOT EQUAL TO XRECORD-NUMBER
039900              GO TO LINK-FAIL-12-01.
040000     IF REELUNIT-NUMBER-GROUP NOT EQUAL TO "/0"
040100              GO TO LINK-FAIL-12-01.
040200     IF XFILE-NAME NOT EQUAL TO "SQ-FS3"
040300              GO TO LINK-FAIL-12-01.
040400     IF XRECORD-NAME NOT EQUAL TO "R1-F-G"
040500              GO TO LINK-FAIL-12-01.
040600     IF XLABEL-TYPE NOT EQUAL TO "S"
040700              GO TO LINK-FAIL-12-01.
040800     GO TO LINK-TEST-12.
040900 LINK-FAIL-12-01.
041000     ADD 1 TO RECORDS-IN-ERROR.
041100     MOVE 1 TO ERROR-FLAG.
041200     GO TO LINK-TEST-12.
041300 LINK-FAIL-12-02.
041400     MOVE "MORE THAN 649 RECORDS" TO RE-MARK.
041500     GO TO LINK-FAIL-12.
041600 LINK-TEST-12-01.
041700     IF COUNT-OF-RECORDS LESS THAN 649
041800              GO TO LINK-FAIL-12-04.
041900     IF ERROR-FLAG EQUAL TO ZERO
042000              GO TO LINK-PASS-12.
042100 LINK-FAIL-12-03.
042200     MOVE "RECORDS-IN-ERROR =" TO COMPUTED-A.
042300     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
042400 LINK-FAIL-12.
042500     PERFORM FAIL.
042600     GO TO LINK-WRITE-12.
042700 LINK-FAIL-12-04.
042800     MOVE "UNEXPECTED EOF" TO RE-MARK.
042900     MOVE "RECORDS READ =" TO COMPUTED-A.
043000     MOVE COUNT-OF-RECORDS TO CORRECT-18V0.
043100     GO TO LINK-FAIL-12.
043200 LINK-PASS-12.
043300     PERFORM PASS.
043400 LINK-WRITE-12.
043500     MOVE "LINK-TEST-12" TO PAR-NAME.
043600     MOVE "READ IN SUBPRGM" TO FEATURE.
043700     PERFORM PRINT-DETAIL.
043800 LINK-CLOSE-12.
043900     MOVE 5 TO CALL-FLAG.
044000     CALL "IC115A" USING GROUP-LINKAGE-VARIABLES
044100                        FILE-REC-SQ-FS3.
044200 TERMINATE-ROUTINE.
044300     EXIT.
044400XFILE-DUMP SECTION.
044500XFILE-DUMP-INIT.
044600X    MOVE 3 TO CALL-FLAG.
044700X    MOVE ZERO TO EOF-FLAG COUNT-OF-RECORDS.
044800X    CALL "IC115A" USING GROUP-LINKAGE-VARIABLES
044900X                       FILE-REC-SQ-FS3.
045000X    MOVE 4 TO CALL-FLAG.
045100XFILE-3-DUMP.
045200X    CALL "IC115A" USING GROUP-LINKAGE-VARIABLES
045300X                       FILE-REC-SQ-FS3.
045400X    IF EOF-FLAG EQUAL TO 1
045500X             GO TO FILE-3-DUMP-END.
045600X    ADD 1 TO COUNT-OF-RECORDS.
045700X    IF COUNT-OF-RECORDS EQUAL TO 650
045800X             PERFORM BLANK-LINE-PRINT 5 TIMES.
045900X    MOVE FILE-REC-SQ-FS3 TO DUMMY-RECORD.
046000X    PERFORM WRITE-LINE.
046100X    IF COUNT-OF-RECORDS LESS THAN 669
046200X             GO TO FILE-3-DUMP.
046300XFILE-3-DUMP-END.
046400X    MOVE 5 TO CALL-FLAG.
046500X    CALL "IC115A" USING GROUP-LINKAGE-VARIABLES
046600X                       FILE-REC-SQ-FS3.
046700XFILE-3-DUMP-EXIT.
046800X    EXIT.
046900 CCVS-EXIT SECTION.
047000 CCVS-999999.
047100     GO TO CLOSE-FILES.
