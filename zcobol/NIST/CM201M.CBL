000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     CM201M.
000400 AUTHOR.
000500     FEDERAL COMPILER TESTING CENTER.
000600 INSTALLATION.
000700     GENERAL SERVICES ADMINISTRATION
000800     AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
000900     SOFTWARE DEVELOPMENT OFFICE.
001000     5203 LEESBURG PIKE  SUITE 1100
001100     FALLS CHURCH VIRGINIA 22041.
001200
001300     PHONE   (703) 756-6153
001400
001500     " HIGH       ".
001600 DATE-WRITTEN.
001700     CCVS-74 VERSION 4.0 - 1980 JULY 1.
001800     CREATION DATE     /    VALIDATION DATE
001900     "4.2 ".
002000 SECURITY.
002100     NONE.
002200 ENVIRONMENT DIVISION.
002300 CONFIGURATION SECTION.
002400 SOURCE-COMPUTER.
002500     XXXXX082.
002600 OBJECT-COMPUTER.
002700     XXXXX083.
002800 DATA DIVISION.
002900 WORKING-STORAGE SECTION.
003000 77  MSG-72 PIC X(72).
003100 01  RECOGNITION-MSG-1.
003200     02  FILLER PIC X(32) VALUE
003300         "RECEIPT OF MESSAGE FROM DEVICE """.
003400     02 DEVICE-NAME PIC X(12).
003500     02  FILLER PIC X(18) VALUE
003600         """ IS ACKNOWLEDGED.".
003700 01  RECOGNITION-MSG-2.
003800     02  FILLER PIC X(20) VALUE
003900         "QUEUE INVOLVED WAS """.
004000     02  QUEUE-INVOLVED PIC X(48).
004100     02  FILLER PIC XX VALUE """.".
004200 01  RECOGNITION-MSG-3 PIC X(41) VALUE
004300     "CM201M INVOKED BUT NO DATA WAS AVAILABLE.".
004400 COMMUNICATION SECTION.
004500 CD  CM-INQUE-1 FOR INITIAL INPUT.
004600 01  INQUE-1-RECORD.
004700     02  QUEUE-SET PIC X(48).
004800     02  FILLER PIC X(14).
004900     02  SYM-SOURCE PIC X(12).
005000     02  IN-LENGTH PIC 9(4).
005100     02  FILLER PIC XXX.
005200     02  MSG-COUNT PIC 9(6).
005300 CD  CM-OUTQUE-1 FOR OUTPUT.
005400 01  OUTQUE-1-RECORD.
005500     02  FILLER PIC 9999 VALUE 1.
005600     02  OUT-LENGTH PIC 9999.
005700     02  FILLER PIC XXX.
005800     02  SYM-DEST PIC X(12) VALUE
005900     XXXXX032.
006000 PROCEDURE    DIVISION.
006100 SECT-CM201M-0001 SECTION.
006200 CM201M-INIT.
006300     ENABLE OUTPUT CM-OUTQUE-1 WITH KEY
006400     XXXXX033.
006500 TAKE-NEXT-MSG.
006600     RECEIVE CM-INQUE-1 MESSAGE INTO MSG-72
006700         NO DATA GO TO SOMETHING-IS-WRONG-HERE.
006800     MOVE QUEUE-SET TO QUEUE-INVOLVED.
006900     MOVE SYM-SOURCE TO DEVICE-NAME.
007000     MOVE 62 TO OUT-LENGTH.
007100     SEND CM-OUTQUE-1 FROM RECOGNITION-MSG-1 WITH EMI.
007200     MOVE 70 TO OUT-LENGTH.
007300     SEND CM-OUTQUE-1 FROM RECOGNITION-MSG-2 WITH EMI.
007400     MOVE IN-LENGTH TO OUT-LENGTH.
007500     SEND CM-OUTQUE-1 FROM MSG-72 WITH EGI.
007600     ACCEPT CM-INQUE-1 MESSAGE COUNT.
007700     IF MSG-COUNT IS EQUAL TO 0 STOP RUN
007800         ELSE GO TO TAKE-NEXT-MSG.
007900 SOMETHING-IS-WRONG-HERE.
008000     MOVE 40 TO OUT-LENGTH.
008100     SEND CM-OUTQUE-1 FROM RECOGNITION-MSG-3 WITH EMI.
008200     MOVE QUEUE-SET TO QUEUE-INVOLVED.
008300     MOVE 70 TO OUT-LENGTH.
008400     SEND CM-OUTQUE-1 FROM RECOGNITION-MSG-2 WITH EGI.
008500     STOP RUN.
