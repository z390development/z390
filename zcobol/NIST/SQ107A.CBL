000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ107A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    " HIGH       ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "4.2 ".
001100*                                                              *
001200****************************************************************
001300
001400*        THIS ROUTINE BUILDS A SEQUENTIAL MASS STORAGE FILE
001500*    WHICH CONTAINS BOTH 120 CHARACTER AND 151 CHARACTER
001600*    RECORDS.  THE MASS STORAGE FILE CONSISTS OF 1 SHORT,
001700*    1 LONG, 10 SHORT, 100 LONG, AND 338 SHORT RECORDS FOR
001800*    A TOTAL OF 450 RECORDS IN THE FILE.  THE MASS STORAGE
001900*    FILE IS READ AND FIELDS IN THE RECORDS ARE CHECKED
002000*    AGAINST THE EXPECTED VALUES.
002100*
002200*        AN INFORMATION SECTION AT THE END OF THE ROUTINE
002300*    CHECKS THE FIELD WHICH CONTAINS THE XRECORD-NUMBER.
002400*    THIS FIELD IS PART OF A LONG RECORD ONLY.  IF THE
002500*    XRECORD-NUMBER IS THERE FOR A SHORT RECORD, IT MEANS
002600*    THE MAXIMUM SIZE RECORD IS ALWAYS WRITTEN.
002700*
002800*    NEW FEATURE: THE LOGICAL RECORD EXTEND ACROSS THE PHYSICAL
002900*                 RECORD.  (VII-23; 3.3.3 (2) A)
003000*
003100*
003200*    USED X-CARDS:
003300*         XXXXX014
003400*         XXXXX055
003500*     P   XXXXX062
003600*         XXXXX082
003700*         XXXXX083
003800*     C   XXXXX084
003900*
004000*
004100 ENVIRONMENT DIVISION.
004200 CONFIGURATION SECTION.
004300 SOURCE-COMPUTER.
004400     XXXXX082.
004500 OBJECT-COMPUTER.
004600     XXXXX083.
004700 INPUT-OUTPUT SECTION.
004800 FILE-CONTROL.
004900P    SELECT RAW-DATA   ASSIGN TO
005000P    XXXXX062
005100P           ORGANIZATION IS INDEXED
005200P           ACCESS MODE IS RANDOM
005300P           RECORD KEY IS RAW-DATA-KEY.
005400     SELECT PRINT-FILE ASSIGN TO
005500     XXXXX055.
005600     SELECT SQ-VS7 ASSIGN TO
005700     XXXXX014
005800     ORGANIZATION SEQUENTIAL
005900     ACCESS SEQUENTIAL.
006000 DATA DIVISION.
006100 FILE SECTION.
006200P
006300PFD  RAW-DATA.
006400P
006500P01  RAW-DATA-SATZ.
006600P    05  RAW-DATA-KEY        PIC X(6).
006700P    05  C-DATE              PIC 9(6).
006800P    05  C-TIME              PIC 9(8).
006900P    05  C-NO-OF-TESTS       PIC 99.
007000P    05  C-OK                PIC 999.
007100P    05  C-ALL               PIC 999.
007200P    05  C-FAIL              PIC 999.
007300P    05  C-DELETED           PIC 999.
007400P    05  C-INSPECT           PIC 999.
007500P    05  C-NOTE              PIC X(13).
007600P    05  C-INDENT            PIC X.
007700P    05  C-ABORT             PIC X(8).
007800 FD  PRINT-FILE
007900C    LABEL RECORDS
008000C    XXXXX084
008100C    DATA RECORD IS PRINT-REC DUMMY-RECORD
008200               .
008300 01  PRINT-REC PICTURE X(120).
008400 01  DUMMY-RECORD PICTURE X(120).
008500 FD  SQ-VS7
008600C    LABEL RECORDS ARE STANDARD
008700     BLOCK CONTAINS 100 CHARACTERS.
008800 01  SQ-VS7R1-M-G-120.
008900     02  SQ-VS7R1-FIRST PICTURE X(120).
009000 01  SQ-VS7R2-M-G-151.
009100     02  SQ-VS7R2-FIRST PICTURE X(120).
009200     02  LONG-OR-SHORT  PICTURE X(5).
009300     02  SQ-VS7-RECNO  PICTURE X(5).
009400 02  SQ-VS7-FILLER  PICTURE X(21).
009500 WORKING-STORAGE SECTION.
009600 01  SAVE-COUNT-OF-RECS  PICTURE X(5) VALUE SPACE.
009700 01  COUNT-OF-RECS  PICTURE S9(5) COMPUTATIONAL.
009800 01  RECORDS-IN-ERROR  PICTURE S9(5) COMPUTATIONAL.
009900 01  ERROR-FLAG PICTURE 9.
010000 01  EOF-FLAG  PICTURE 9.
010100 01  DUMP-AREA.
010200     02  TYPE-OF-REC PICTURE X(5).
010300     02  RECNO  PICTURE 9(5).
010400     02  REC-FILLER PICTURE X(21).
010500 01  FILE-RECORD-INFORMATION-REC.
010600     03 FILE-RECORD-INFO-SKELETON.
010700        05 FILLER                 PICTURE X(48)       VALUE
010800             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
010900        05 FILLER                 PICTURE X(46)       VALUE
011000             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
011100        05 FILLER                 PICTURE X(26)       VALUE
011200             ",LFIL=000000,ORG=  ,LBLR= ".
011300        05 FILLER                 PICTURE X(37)       VALUE
011400             ",RECKEY=                             ".
011500        05 FILLER                 PICTURE X(38)       VALUE
011600             ",ALTKEY1=                             ".
011700        05 FILLER                 PICTURE X(38)       VALUE
011800             ",ALTKEY2=                             ".
011900        05 FILLER                 PICTURE X(7)        VALUE SPACE.
012000     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
012100        05 FILE-RECORD-INFO-P1-120.
012200           07 FILLER              PIC X(5).
012300           07 XFILE-NAME           PIC X(6).
012400           07 FILLER              PIC X(8).
012500           07 XRECORD-NAME         PIC X(6).
012600           07 FILLER              PIC X(1).
012700           07 REELUNIT-NUMBER     PIC 9(1).
012800           07 FILLER              PIC X(7).
012900           07 XRECORD-NUMBER       PIC 9(6).
013000           07 FILLER              PIC X(6).
013100           07 UPDATE-NUMBER       PIC 9(2).
013200           07 FILLER              PIC X(5).
013300           07 ODO-NUMBER          PIC 9(4).
013400           07 FILLER              PIC X(5).
013500           07 XPROGRAM-NAME        PIC X(5).
013600           07 FILLER              PIC X(7).
013700           07 XRECORD-LENGTH       PIC 9(6).
013800           07 FILLER              PIC X(7).
013900           07 CHARS-OR-RECORDS    PIC X(2).
014000           07 FILLER              PIC X(1).
014100           07 XBLOCK-SIZE          PIC 9(4).
014200           07 FILLER              PIC X(6).
014300           07 RECORDS-IN-FILE     PIC 9(6).
014400           07 FILLER              PIC X(5).
014500           07 XFILE-ORGANIZATION   PIC X(2).
014600           07 FILLER              PIC X(6).
014700           07 XLABEL-TYPE          PIC X(1).
014800        05 FILE-RECORD-INFO-P121-240.
014900           07 FILLER              PIC X(8).
015000           07 XRECORD-KEY          PIC X(29).
015100           07 FILLER              PIC X(9).
015200           07 ALTERNATE-KEY1      PIC X(29).
015300           07 FILLER              PIC X(9).
015400           07 ALTERNATE-KEY2      PIC X(29).
015500           07 FILLER              PIC X(7).
015600 01  TEST-RESULTS.
015700     02 FILLER                    PICTURE X VALUE SPACE.
015800     02 FEATURE                   PICTURE X(20) VALUE SPACE.
015900     02 FILLER                    PICTURE X VALUE SPACE.
016000     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
016100     02 FILLER                    PICTURE X  VALUE SPACE.
016200     02  PAR-NAME.
016300       03 FILLER PICTURE X(12) VALUE SPACE.
016400       03  PARDOT-X PICTURE X  VALUE SPACE.
016500       03 DOTVALUE PICTURE 99  VALUE ZERO.
016600       03 FILLER PIC X(5) VALUE SPACE.
016700     02 FILLER PIC X(10) VALUE SPACE.
016800     02 RE-MARK PIC X(61).
016900 01  TEST-COMPUTED.
017000     02 FILLER PIC X(30) VALUE SPACE.
017100     02 FILLER PIC X(17) VALUE "       COMPUTED=".
017200     02 COMPUTED-X.
017300     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
017400     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
017500     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
017600     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
017700     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
017800     03       CM-18V0 REDEFINES COMPUTED-A.
017900         04 COMPUTED-18V0                   PICTURE -9(18).
018000         04 FILLER                          PICTURE X.
018100     03 FILLER PIC X(50) VALUE SPACE.
018200 01  TEST-CORRECT.
018300     02 FILLER PIC X(30) VALUE SPACE.
018400     02 FILLER PIC X(17) VALUE "       CORRECT =".
018500     02 CORRECT-X.
018600     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
018700     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
018800     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
018900     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
019000     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
019100     03      CR-18V0 REDEFINES CORRECT-A.
019200         04 CORRECT-18V0                    PICTURE -9(18).
019300         04 FILLER                          PICTURE X.
019400     03 FILLER PIC X(50) VALUE SPACE.
019500 01  CCVS-C-1.
019600     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
019700-    "SS  PARAGRAPH-NAME
019800-    "        REMARKS".
019900     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
020000 01  CCVS-C-2.
020100     02 FILLER PICTURE IS X VALUE IS SPACE.
020200     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
020300     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
020400     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
020500     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
020600 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
020700 01  REC-CT PICTURE 99 VALUE ZERO.
020800 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
020900 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
021000 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
021100 01  PASS-COUNTER PIC 999 VALUE ZERO.
021200 01  TOTAL-ERROR PIC 999 VALUE ZERO.
021300 01  ERROR-HOLD PIC 999 VALUE ZERO.
021400 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
021500 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
021600 01  CCVS-H-1.
021700     02  FILLER   PICTURE X(27)  VALUE SPACE.
021800     02 FILLER PICTURE X(67) VALUE
021900     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
022000-    " SYSTEM".
022100     02  FILLER     PICTURE X(26)  VALUE SPACE.
022200 01  CCVS-H-2.
022300     02 FILLER PICTURE X(52) VALUE IS
022400     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
022500     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
022600     02 TEST-ID PICTURE IS X(9).
022700     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
022800 01  CCVS-H-3.
022900     02  FILLER PICTURE X(34) VALUE
023000     " FOR OFFICIAL USE ONLY    ".
023100     02  FILLER PICTURE X(58) VALUE
023200     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
023300     02  FILLER PICTURE X(28) VALUE
023400     "  COPYRIGHT   1985 ".
023500 01  CCVS-E-1.
023600     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
023700     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
023800     02 ID-AGAIN PICTURE IS X(9).
023900     02 FILLER PICTURE X(45) VALUE IS
024000     " NTIS DISTRIBUTION COBOL 85".
024100 01  CCVS-E-2.
024200     02  FILLER                   PICTURE X(31)  VALUE
024300     SPACE.
024400     02  FILLER                   PICTURE X(21)  VALUE SPACE.
024500     02 CCVS-E-2-2.
024600         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
024700         03 FILLER PICTURE IS X VALUE IS SPACE.
024800         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
024900 01  CCVS-E-3.
025000     02  FILLER PICTURE X(22) VALUE
025100     " FOR OFFICIAL USE ONLY".
025200     02  FILLER PICTURE X(12) VALUE SPACE.
025300     02  FILLER PICTURE X(58) VALUE
025400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025500     02  FILLER PICTURE X(13) VALUE SPACE.
025600     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
025700 01  CCVS-E-4.
025800     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
025900     02 FILLER PIC XXXX VALUE " OF ".
026000     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
026100     02 FILLER PIC X(40) VALUE
026200      "  TESTS WERE EXECUTED SUCCESSFULLY".
026300 01  XXINFO.
026400     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
026500     02 INFO-TEXT.
026600     04 FILLER PIC X(20) VALUE SPACE.
026700     04 XXCOMPUTED PIC X(20).
026800     04 FILLER PIC X(5) VALUE SPACE.
026900     04 XXCORRECT PIC X(20).
027000 01  HYPHEN-LINE.
027100     02 FILLER PICTURE IS X VALUE IS SPACE.
027200     02 FILLER PICTURE IS X(65) VALUE IS "************************
027300-    "*****************************************".
027400     02 FILLER PICTURE IS X(54) VALUE IS "************************
027500-    "******************************".
027600 01  CCVS-PGM-ID PIC X(6) VALUE
027700     "SQ107A".
027800 PROCEDURE DIVISION.
027900 CCVS1 SECTION.
028000 OPEN-FILES.
028100P    OPEN I-O RAW-DATA.
028200P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
028300P    READ RAW-DATA INVALID KEY GO TO END-E-1.
028400P    MOVE "ABORTED " TO C-ABORT.
028500P    ADD 1 TO C-NO-OF-TESTS.
028600P    ACCEPT C-DATE  FROM DATE.
028700P    ACCEPT C-TIME  FROM TIME.
028800P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
028900PEND-E-1.
029000P    CLOSE RAW-DATA.
029100     OPEN     OUTPUT PRINT-FILE.
029200     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
029300     MOVE    SPACE TO TEST-RESULTS.
029400     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
029500     MOVE ZERO TO REC-SKL-SUB.
029600     PERFORM CCVS-INIT-FILE 9 TIMES.
029700 CCVS-INIT-FILE.
029800     ADD 1 TO REC-SKL-SUB.
029900     MOVE FILE-RECORD-INFO-SKELETON TO
030000                  FILE-RECORD-INFO (REC-SKL-SUB).
030100 CCVS-INIT-EXIT.
030200     GO TO CCVS1-EXIT.
030300 CLOSE-FILES.
030400     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
030500P    OPEN I-O RAW-DATA.
030600P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
030700P    READ RAW-DATA INVALID KEY GO TO END-E-2.
030800P    MOVE "OK.     " TO C-ABORT.
030900P    MOVE PASS-COUNTER TO C-OK.
031000P    MOVE ERROR-HOLD   TO C-ALL.
031100P    MOVE ERROR-COUNTER TO C-FAIL.
031200P    MOVE DELETE-CNT TO C-DELETED.
031300P    MOVE INSPECT-COUNTER TO C-INSPECT.
031400P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
031500PEND-E-2.
031600P    CLOSE RAW-DATA.
031700 TERMINATE-CCVS.
031800S    EXIT PROGRAM.
031900STERMINATE-CALL.
032000     STOP     RUN.
032100 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
032200 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
032300 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
032400 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
032500     MOVE "****TEST DELETED****" TO RE-MARK.
032600 PRINT-DETAIL.
032700     IF REC-CT NOT EQUAL TO ZERO
032800             MOVE "." TO PARDOT-X
032900             MOVE REC-CT TO DOTVALUE.
033000     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
033100     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
033200        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
033300          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
033400     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
033500     MOVE SPACE TO CORRECT-X.
033600     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
033700     MOVE     SPACE TO RE-MARK.
033800 HEAD-ROUTINE.
033900     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034000     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
034100     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
034200 COLUMN-NAMES-ROUTINE.
034300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
034600 END-ROUTINE.
034700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
034800 END-RTN-EXIT.
034900     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035000 END-ROUTINE-1.
035100      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
035200      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
035300      ADD PASS-COUNTER TO ERROR-HOLD.
035400*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
035500      MOVE PASS-COUNTER TO CCVS-E-4-1.
035600      MOVE ERROR-HOLD TO CCVS-E-4-2.
035700      MOVE CCVS-E-4 TO CCVS-E-2-2.
035800      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
035900  END-ROUTINE-12.
036000      MOVE "TEST(S) FAILED" TO ENDER-DESC.
036100     IF       ERROR-COUNTER IS EQUAL TO ZERO
036200         MOVE "NO " TO ERROR-TOTAL
036300         ELSE
036400         MOVE ERROR-COUNTER TO ERROR-TOTAL.
036500     MOVE     CCVS-E-2 TO DUMMY-RECORD.
036600     PERFORM WRITE-LINE.
036700 END-ROUTINE-13.
036800     IF DELETE-CNT IS EQUAL TO ZERO
036900         MOVE "NO " TO ERROR-TOTAL  ELSE
037000         MOVE DELETE-CNT TO ERROR-TOTAL.
037100     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
037200     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037300      IF   INSPECT-COUNTER EQUAL TO ZERO
037400          MOVE "NO " TO ERROR-TOTAL
037500      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
037600      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
037700      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037800     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037900 WRITE-LINE.
038000     ADD 1 TO RECORD-COUNT.
038100Y    IF RECORD-COUNT GREATER 50
038200Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
038300Y        MOVE SPACE TO DUMMY-RECORD
038400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
038500Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
038600Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
038700Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
038800Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
038900Y        MOVE ZERO TO RECORD-COUNT.
039000     PERFORM WRT-LN.
039100 WRT-LN.
039200     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
039300     MOVE SPACE TO DUMMY-RECORD.
039400 BLANK-LINE-PRINT.
039500     PERFORM WRT-LN.
039600 FAIL-ROUTINE.
039700     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
039800     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
039900     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
040000     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040100     GO TO FAIL-ROUTINE-EX.
040200 FAIL-ROUTINE-WRITE.
040300     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
040400     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
040500 FAIL-ROUTINE-EX. EXIT.
040600 BAIL-OUT.
040700     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
040800     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
040900 BAIL-OUT-WRITE.
041000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
041100     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041200 BAIL-OUT-EX. EXIT.
041300 CCVS1-EXIT.
041400     EXIT.
041500 SECT-SQ107A-0001 SECTION.
041600 SEQ-INIT-017.
041700     MOVE "SQ-VS7" TO XFILE-NAME (1).
041800     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
041900     MOVE "RC" TO CHARS-OR-RECORDS (1).
042000     MOVE 0001 TO XBLOCK-SIZE (1).
042100     MOVE 000450 TO RECORDS-IN-FILE (1).
042200     MOVE "SQ" TO XFILE-ORGANIZATION (1).
042300     MOVE "S" TO XLABEL-TYPE (1).
042400     MOVE 000000 TO XRECORD-NUMBER (1).
042500     MOVE ZERO TO COUNT-OF-RECS.
042600     OPEN OUTPUT SQ-VS7.
042700     MOVE "MULTIPLE LENGTH RECS" TO SQ-VS7-FILLER.
042800 SEQ-TEST-017.
042900     PERFORM WRITE-SHORT-REC.
043000     PERFORM WRITE-LONG-REC.
043100     PERFORM WRITE-SHORT-REC 10 TIMES.
043200     PERFORM WRITE-LONG-REC 100 TIMES.
043300     PERFORM WRITE-SHORT-REC 338 TIMES.
043400 SEQ-WRITE-017.
043500     MOVE "CREATE FILE SQ-VS7" TO FEATURE.
043600     MOVE "SEQ-TEST-017" TO PAR-NAME.
043700     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
043800     MOVE COUNT-OF-RECS TO CORRECT-18V0.
043900     MOVE "FILE HAS 120 AND 151 CHAR RECS" TO RE-MARK.
044000     PERFORM PRINT-DETAIL.
044100*        A SEQUENTIAL MASS STORAGE FILE CONTAINING 450
044200*    RECORDS HAS BEEN CREATED.  THE FILE CONTAINS RECORDS
044300*    OF 120 CHARACTERS AND RECORDS OF 151 CHARACTERS.  THE
044400*    SEQUENCE IN WHICH THE RECORDS WERE WRITTEN IS S-L-10S-
044500*    100L-338S.
044600 SEQ-CLOSE-017.
044700     CLOSE SQ-VS7.
044800     GO TO READ-INIT-GF-01.
044900 WRITE-SHORT-REC.
045000     MOVE "R1-M-G" TO XRECORD-NAME (1).
045100     MOVE 000120 TO XRECORD-LENGTH (1).
045200     ADD 1 TO COUNT-OF-RECS.
045300     MOVE COUNT-OF-RECS TO XRECORD-NUMBER (1).
045400     MOVE "SHORT" TO LONG-OR-SHORT.
045500     MOVE COUNT-OF-RECS TO SQ-VS7-RECNO.
045600     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-VS7R1-FIRST.
045700     WRITE SQ-VS7R1-M-G-120.
045800 WRITE-LONG-REC.
045900     MOVE "R2-M-G" TO XRECORD-NAME (1).
046000     MOVE 000151 TO XRECORD-LENGTH (1).
046100     ADD 1 TO COUNT-OF-RECS.
046200     MOVE COUNT-OF-RECS TO XRECORD-NUMBER (1).
046300     MOVE "LONG" TO LONG-OR-SHORT.
046400     MOVE COUNT-OF-RECS TO SQ-VS7-RECNO.
046500     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-VS7R2-FIRST.
046600     WRITE SQ-VS7R2-M-G-151.
046700 READ-INIT-GF-01.
046800     MOVE ZERO TO COUNT-OF-RECS.
046900     MOVE ZERO TO EOF-FLAG.
047000     MOVE ZERO TO RECORDS-IN-ERROR.
047100     MOVE ZERO TO ERROR-FLAG.
047200     OPEN INPUT SQ-VS7.
047300 READ-TEST-GF-01.
047400     PERFORM READ-SHORT-REC THRU READ-SHORT-REC-EXIT.
047500     IF EOF-FLAG EQUAL TO 1
047600         MOVE "EOF ON FIRST READ" TO RE-MARK
047700         GO TO SEQ-EOF-018.
047800     IF ERROR-FLAG EQUAL TO 1
047900         GO TO READ-FAIL-GF-01.
048000 READ-PASS-GF-01.
048100     PERFORM PASS.
048200     GO TO READ-WRITE-GF-01.
048300 READ-FAIL-GF-01.
048400     PERFORM FAIL.
048500     MOVE "ERROR ON FIRST READ" TO RE-MARK.
048600 READ-WRITE-GF-01.
048700     MOVE "READ SHORT RECORD" TO FEATURE.
048800     MOVE "READ-TEST-GF-01" TO PAR-NAME.
048900     PERFORM PRINT-DETAIL.
049000     GO TO READ-INIT-GF-02.
049100 READ-SHORT-REC.
049200     IF EOF-FLAG EQUAL TO 1
049300         GO TO READ-SHORT-REC-EXIT.
049400     READ SQ-VS7 AT END
049500         MOVE 1 TO EOF-FLAG
049600         GO TO READ-SHORT-REC-EXIT.
049700     ADD 1 TO COUNT-OF-RECS.
049800     MOVE SQ-VS7R1-FIRST TO FILE-RECORD-INFO-P1-120 (1).
049900     IF XRECORD-NAME (1) NOT EQUAL TO "R1-M-G"
050000         GO TO READ-SHORT-REC-ERROR.
050100     IF XRECORD-LENGTH (1) NOT EQUAL TO 120
050200         GO TO READ-SHORT-REC-ERROR.
050300     IF COUNT-OF-RECS NOT EQUAL TO XRECORD-NUMBER (1)
050400         GO TO READ-SHORT-REC-ERROR.
050500     IF XLABEL-TYPE (1) EQUAL TO "S"
050600         GO TO READ-SHORT-REC-EXIT.
050700 READ-SHORT-REC-ERROR.
050800     ADD 1 TO RECORDS-IN-ERROR.
050900     MOVE 1 TO ERROR-FLAG.
051000 READ-SHORT-REC-EXIT.
051100     EXIT.
051200 READ-INIT-GF-02.
051300     MOVE ZERO TO ERROR-FLAG.
051400 READ-TEST-GF-02.
051500     PERFORM READ-LONG-REC THRU READ-LONG-REC-EXIT.
051600     IF EOF-FLAG EQUAL TO 1
051700         MOVE "EOF ON SECOND READ" TO RE-MARK
051800         GO TO SEQ-EOF-018.
051900     IF ERROR-FLAG EQUAL TO 1
052000         GO TO READ-FAIL-GF-02.
052100 READ-PASS-GF-02.
052200     PERFORM PASS.
052300     GO TO READ-WRITE-GF-02.
052400 READ-FAIL-GF-02.
052500     PERFORM FAIL.
052600     MOVE "VII-23; ERROR ON SECOND READ" TO RE-MARK.
052700 READ-WRITE-GF-02.
052800     MOVE "READ LONG RECORD" TO FEATURE.
052900     MOVE "READ-TEST-GF-02" TO PAR-NAME.
053000     PERFORM PRINT-DETAIL.
053100     GO TO READ-INIT-GF-03.
053200 READ-LONG-REC.
053300     IF EOF-FLAG EQUAL TO 1
053400         GO TO READ-LONG-REC-EXIT.
053500     READ SQ-VS7 END
053600         MOVE 1 TO EOF-FLAG
053700         GO TO READ-LONG-REC-EXIT.
053800     ADD 1 TO COUNT-OF-RECS.
053900     MOVE SQ-VS7R2-FIRST TO FILE-RECORD-INFO-P1-120 (1).
054000     IF XRECORD-NAME (1) NOT EQUAL TO "R2-M-G"
054100         GO TO READ-LONG-REC-ERROR.
054200     IF XRECORD-LENGTH (1) NOT EQUAL TO 151
054300         GO TO READ-LONG-REC-ERROR.
054400     MOVE COUNT-OF-RECS TO SAVE-COUNT-OF-RECS.
054500     IF SAVE-COUNT-OF-RECS NOT EQUAL TO SQ-VS7-RECNO
054600         GO TO READ-LONG-REC-ERROR.
054700     IF LONG-OR-SHORT EQUAL TO "LONG "
054800         GO TO READ-LONG-REC-EXIT.
054900 READ-LONG-REC-ERROR.
055000     ADD 1 TO RECORDS-IN-ERROR.
055100     MOVE 1 TO ERROR-FLAG.
055200 READ-LONG-REC-EXIT.
055300     EXIT.
055400 READ-INIT-GF-03.
055500     MOVE ZERO TO ERROR-FLAG.
055600 READ-TEST-GF-03.
055700     PERFORM READ-SHORT-REC THRU READ-SHORT-REC-EXIT 10 TIMES.
055800     IF EOF-FLAG EQUAL TO 1
055900         MOVE "UNEXPECTED EOF" TO RE-MARK
056000         GO TO SEQ-EOF-018.
056100     IF ERROR-FLAG EQUAL TO 1
056200         GO TO READ-FAIL-GF-03.
056300 READ-PASS-GF-03.
056400     PERFORM PASS.
056500     GO TO READ-WRITE-GF-03.
056600 READ-FAIL-GF-03.
056700     MOVE "VII-23; ERROR READING SHORT RECORD" TO RE-MARK.
056800     PERFORM FAIL.
056900 READ-WRITE-GF-03.
057000     MOVE "READ SHORT RECORDS" TO FEATURE.
057100     MOVE "READ-TEST-GF-03" TO PAR-NAME.
057200     PERFORM PRINT-DETAIL.
057300 READ-INIT-GF-04.
057400     MOVE ZERO TO ERROR-FLAG.
057500 READ-TEST-GF-04.
057600     PERFORM READ-LONG-REC THRU READ-LONG-REC-EXIT 100 TIMES.
057700     IF EOF-FLAG EQUAL TO 1
057800         MOVE "UNEXPECTED EOF" TO RE-MARK
057900         GO TO SEQ-EOF-018.
058000     IF ERROR-FLAG EQUAL TO 1
058100         GO TO READ-FAIL-GF-04.
058200 READ-PASS-GF-04.
058300     PERFORM PASS.
058400     GO TO READ-WRITE-GF-04.
058500 READ-FAIL-GF-04.
058600     PERFORM FAIL.
058700     MOVE "VII-23; ERROR READING LONG RECORD" TO RE-MARK.
058800 READ-WRITE-GF-04.
058900     MOVE "READ LONG RECORDS" TO FEATURE.
059000     MOVE "READ-TEST-GF-04" TO PAR-NAME.
059100     PERFORM PRINT-DETAIL.
059200 READ-INIT-GF-06.
059300     MOVE ZERO TO ERROR-FLAG.
059400 READ-TEST-GF-05.
059500     PERFORM READ-SHORT-REC THRU READ-SHORT-REC-EXIT 338 TIMES.
059600     IF EOF-FLAG EQUAL TO 1
059700         MOVE "UNEXPECTED EOF" TO RE-MARK
059800         GO TO SEQ-EOF-018.
059900     IF ERROR-FLAG EQUAL TO 1
060000         GO TO READ-FAIL-GF-05.
060100 READ-PASS-GF-05.
060200     PERFORM PASS.
060300     GO TO READ-WRITE-GF-05.
060400 READ-FAIL-GF-05.
060500     PERFORM FAIL.
060600     MOVE "VII-23; ERROR READING SHORT RECORD" TO RE-MARK.
060700 READ-WRITE-GF-05.
060800     MOVE "READ SHORT RECORDS" TO FEATURE.
060900     MOVE "READ-TEST-GF-05" TO PAR-NAME.
061000     PERFORM PRINT-DETAIL.
061100 SEQ-INIT-018.
061200     READ SQ-VS7 RECORD END
061300         GO TO SEQ-TEST-018.
061400     MOVE "MORE THAN 450 RECORDS" TO RE-MARK.
061500     GO TO SEQ-FAIL-018.
061600 SEQ-EOF-018.
061700     MOVE "RECORDS READ =" TO COMPUTED-A.
061800     MOVE COUNT-OF-RECS TO CORRECT-18V0.
061900     GO TO SEQ-FAIL-018.
062000 SEQ-TEST-018.
062100     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
062200         MOVE "RECORDS IN ERROR =" TO COMPUTED-A
062300     MOVE RECORDS-IN-ERROR TO CORRECT-18V0
062400         GO TO SEQ-FAIL-018.
062500 SEQ-PASS-018.
062600     PERFORM PASS.
062700     GO TO SEQ-WRITE-018.
062800 SEQ-FAIL-018.
062900     PERFORM FAIL.
063000 SEQ-WRITE-018.
063100     MOVE "SEQ-TEST-018" TO PAR-NAME.
063200     MOVE "VERIFY FILE SQ-VS7" TO FEATURE.
063300     PERFORM PRINT-DETAIL.
063400 SEQ-CLOSE-018.
063500     CLOSE SQ-VS7.
063600 SECT-SQ107A-0002 SECTION.
063700*        THIS SECTION CHECKS IF THE ENTIRE RECORD AREA IS
063800*    WRITTEN ON THE MASS STORAGE DEVICE WHEN A SHORT RECORD
063900*    IS WRITTEN.  THE RECORD NUMBER IN CHARACTERS 126 THROUGH
064000*    130 IS UNIQUE FOR EACH RECORD.
064100 INFO-INIT-004.
064200     OPEN INPUT SQ-VS7.
064300     MOVE ZERO TO COUNT-OF-RECS.
064400 INFO-TEST-004.
064500     READ SQ-VS7 AT END
064600         GO TO INFO-END.
064700     ADD 1 TO COUNT-OF-RECS.
064800     IF SQ-VS7-RECNO NOT EQUAL TO "00001"
064900         GO TO NO-INFO-004.
065000     MOVE "MAXIMUM RECORD SIZE WRITTEN" TO RE-MARK.
065100     MOVE "RECORD READ =" TO COMPUTED-A.
065200     MOVE 0001 TO CORRECT-18V0.
065300     GO TO INFO-WRITE-004.
065400 NO-INFO-004.
065500     MOVE "NO DEFINITE CONCLUSION POSSIBLE" TO RE-MARK.
065600 INFO-WRITE-004.
065700     MOVE "READ SHORT RECORD" TO FEATURE.
065800     MOVE "SEQ-INFO-004" TO PAR-NAME.
065900     PERFORM PRINT-DETAIL.
066000 INFO-INIT-005.
066100     READ SQ-VS7 RECORD AT END
066200         GO TO INFO-END.
066300     READ SQ-VS7 END
066400         GO TO INFO-END.
066500 INFO-TEST-005.
066600     READ SQ-VS7 AT END
066700         GO TO INFO-END.
066800     IF SQ-VS7-RECNO NOT EQUAL TO "00004"
066900         GO TO NO-INFO-005.
067000     MOVE "MAXIMUM RECORD SIZE WRITTEN" TO RE-MARK.
067100     MOVE "RECORD READ =" TO COMPUTED-A.
067200     MOVE 0004 TO CORRECT-18V0.
067300     GO TO INFO-WRITE-005.
067400 NO-INFO-005.
067500     MOVE "NO DEFINITE CONCLUSION POSSIBLE" TO RE-MARK.
067600 INFO-WRITE-005.
067700     MOVE "READ SHORT RECORD" TO FEATURE.
067800     MOVE "SEQ-INFO-005" TO PAR-NAME.
067900     PERFORM PRINT-DETAIL.
068000 INFO-INIT-006.
068100     ADD 3 TO COUNT-OF-RECS.
068200 INFO-INIT-006-1.
068300     READ SQ-VS7 RECORD
068400         END GO TO INFO-END.
068500     ADD 1 TO COUNT-OF-RECS.
068600     IF COUNT-OF-RECS EQUAL TO 450
068700         GO TO INFO-TEST-006.
068800     GO TO INFO-INIT-006-1.
068900 INFO-TEST-006.
069000     IF SQ-VS7-RECNO NOT EQUAL TO "00450"
069100         GO TO NO-INFO-006.
069200     MOVE "MAXIMUM RECORD SIZE WRITTEN" TO RE-MARK.
069300     MOVE "RECORD READ =" TO COMPUTED-A.
069400     MOVE 0450 TO CORRECT-18V0.
069500     GO TO INFO-WRITE-006.
069600 NO-INFO-006.
069700     MOVE "NO DEFINITE CONCLUSION POSSIBLE" TO RE-MARK.
069800 INFO-WRITE-006.
069900     MOVE "READ SHORT RECORD" TO FEATURE.
070000     MOVE "SEQ-INFO-006" TO PAR-NAME.
070100     PERFORM PRINT-DETAIL.
070200 INFO-END.
070300     CLOSE SQ-VS7.
070400 TERMINATE-ROUTINE.
070500     EXIT.
070600 CCVS-EXIT SECTION.
070700 CCVS-999999.
070800     GO TO CLOSE-FILES.
