000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ131A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
000900*                             REVISED 1986, AUGUST             *
001000*                                                              *
001100*    CREATION DATE     /     VALIDATION DATE                   *
001200*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001300*                                                              *
001400****************************************************************
001500*                                                              *
001600*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001700*                                                              *
001800*            X-14   SEQUENTIAL MASS STORAGE FILE.              *
001900*            X-55   SYSTEM PRINTER                             *
002000*            X-82   SOURCE-COMPUTER                            *
002100*            X-83   OBJECT-COMPUTER.                           *
002200*                                                              *
002300*                                                              *
002400****************************************************************
002500*                                                              *
002600*    SQ131A ATTEMPTS TO OPEN IN THE I-O MODE A MASS STORAGE    *
002700*    FILE WHICH IS ALREADY OPEN IN THE OUTPUT MODE.  THIS      *
002800*    SHOULD RESULT IN RECOGNITION OF A LOGIC ERROR CONDITION   *
002900*    AND RETURN OF I-O STATUS OF "41".  THE PROGRAM DOES NOT   *
003000*    CONTAIN DECLARATIVE PROCEDURES, AND IN THIS CASE THE      *
003100*    STANDARD ALLOWS THE IMPLEMENTOR TO TERMINATE EXECUTION OF *
003200*    THE PROGRAM AS PART OF THE EXECUTION OF THE OPEN          *
003300*    STATEMENT.  HOWEVER, THE STANDARD ALSO ALLOWS EXECUTION   *
003400*    OF THE PROGRAM TO CONTINUE, AND THERE ARE TESTS TO COVER  *
003500*    THIS CASE.                                                *
003600*                                                              *
003700*    THE PROGRAM CONTAINS NO PROVISION FOR DELETION OF         *
003800*    OPERATIONS ON THE FILES, BUT INDIVIDUAL SUBORDINATE TESTS *
003900*    MAY BE DELETED.                                           *
004000*                                                              *
004100****************************************************************
004200*
004300 ENVIRONMENT DIVISION.
004400 CONFIGURATION SECTION.
004500 SOURCE-COMPUTER.
004600     XXXXX082.
004700 OBJECT-COMPUTER.
004800     XXXXX083.
004900*
005000 INPUT-OUTPUT SECTION.
005100 FILE-CONTROL.
005200     SELECT PRINT-FILE ASSIGN TO
005300     XXXXX055.
005400*
005500P    SELECT RAW-DATA   ASSIGN TO
005600P    XXXXX062
005700P          ORGANIZATION IS INDEXED
005800P          ACCESS MODE  IS RANDOM
005900P          RECORD-KEY   IS RAW-DATA-KEY.
006000P
006100     SELECT SQ-FS1 ASSIGN TO
006200     XXXXX014
006300            FILE STATUS IS SQ-FS1-STATUS.
006400*
006500*
006600 DATA DIVISION.
006700 FILE SECTION.
006800 FD  PRINT-FILE
006900C    LABEL RECORDS
007000C    XXXXX084
007100C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007200               .
007300 01  PRINT-REC    PICTURE X(120).
007400 01  DUMMY-RECORD PICTURE X(120).
007500P
007600PFD  RAW-DATA.
007700P01  RAW-DATA-SATZ.
007800P    05  RAW-DATA-KEY        PIC X(6).
007900P    05  C-DATE              PIC 9(6).
008000P    05  C-TIME              PIC 9(8).
008100P    05  NO-OF-TESTS         PIC 99.
008200P    05  C-OK                PIC 999.
008300P    05  C-ALL               PIC 999.
008400P    05  C-FAIL              PIC 999.
008500P    05  C-DELETED           PIC 999.
008600P    05  C-INSPECT           PIC 999.
008700P    05  C-NOTE              PIC X(13).
008800P    05  C-INDENT            PIC X.
008900P    05  C-ABORT             PIC X(8).
009000*
009100 FD  SQ-FS1
009200C    LABEL RECORD IS STANDARD
009300                .
009400 01  SQ-FS1R1-F-G-120 PIC X(120).
009500*
009600 WORKING-STORAGE SECTION.
009700*
009800***************************************************************
009900*                                                             *
010000*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
010100*                                                             *
010200***************************************************************
010300*
010400 01  SQ-FS1-STATUS.
010500   03  SQ-FS1-KEY-1   PIC X.
010600   03  SQ-FS1-KEY-2   PIC X.
010700*
010800*
010900***************************************************************
011000*                                                             *
011100*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
011200*                                                             *
011300***************************************************************
011400*
011500 01  REC-SKEL-SUB   PIC 99.
011600*
011700 01  FILE-RECORD-INFORMATION-REC.
011800     03 FILE-RECORD-INFO-SKELETON.
011900        05 FILLER                 PICTURE X(48)       VALUE
012000             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
012100        05 FILLER                 PICTURE X(46)       VALUE
012200             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
012300        05 FILLER                 PICTURE X(26)       VALUE
012400             ",LFIL=000000,ORG=  ,LBLR= ".
012500        05 FILLER                 PICTURE X(37)       VALUE
012600             ",RECKEY=                             ".
012700        05 FILLER                 PICTURE X(38)       VALUE
012800             ",ALTKEY1=                             ".
012900        05 FILLER                 PICTURE X(38)       VALUE
013000             ",ALTKEY2=                             ".
013100        05 FILLER                 PICTURE X(7)        VALUE SPACE.
013200     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
013300        05 FILE-RECORD-INFO-P1-120.
013400           07 FILLER              PIC X(5).
013500           07 XFILE-NAME          PIC X(6).
013600           07 FILLER              PIC X(8).
013700           07 XRECORD-NAME        PIC X(6).
013800           07 FILLER              PIC X(1).
013900           07 REELUNIT-NUMBER     PIC 9(1).
014000           07 FILLER              PIC X(7).
014100           07 XRECORD-NUMBER      PIC 9(6).
014200           07 FILLER              PIC X(6).
014300           07 UPDATE-NUMBER       PIC 9(2).
014400           07 FILLER              PIC X(5).
014500           07 ODO-NUMBER          PIC 9(4).
014600           07 FILLER              PIC X(5).
014700           07 XPROGRAM-NAME       PIC X(5).
014800           07 FILLER              PIC X(7).
014900           07 XRECORD-LENGTH      PIC 9(6).
015000           07 FILLER              PIC X(7).
015100           07 CHARS-OR-RECORDS    PIC X(2).
015200           07 FILLER              PIC X(1).
015300           07 XBLOCK-SIZE         PIC 9(4).
015400           07 FILLER              PIC X(6).
015500           07 RECORDS-IN-FILE     PIC 9(6).
015600           07 FILLER              PIC X(5).
015700           07 XFILE-ORGANIZATION  PIC X(2).
015800           07 FILLER              PIC X(6).
015900           07 XLABEL-TYPE         PIC X(1).
016000        05 FILE-RECORD-INFO-P121-240.
016100           07 FILLER              PIC X(8).
016200           07 XRECORD-KEY         PIC X(29).
016300           07 FILLER              PIC X(9).
016400           07 ALTERNATE-KEY1      PIC X(29).
016500           07 FILLER              PIC X(9).
016600           07 ALTERNATE-KEY2      PIC X(29).
016700           07 FILLER              PIC X(7).
016800*
016900 01  TEST-RESULTS.
017000     02 FILLER              PIC X      VALUE SPACE.
017100     02  PAR-NAME.
017200       03 FILLER              PIC X(14)  VALUE SPACE.
017300       03 PARDOT-X            PIC X      VALUE SPACE.
017400       03 DOTVALUE            PIC 99     VALUE ZERO.
017500     02 FILLER              PIC X      VALUE SPACE.
017600     02 FEATURE             PIC X(24)  VALUE SPACE.
017700     02 FILLER              PIC X      VALUE SPACE.
017800     02 P-OR-F              PIC X(5)   VALUE SPACE.
017900     02 FILLER              PIC X(9)   VALUE SPACE.
018000     02 RE-MARK             PIC X(61).
018100 01  TEST-COMPUTED.
018200   02 FILLER  PIC X(30)  VALUE SPACE.
018300   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
018400   02 COMPUTED-X.
018500     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
018600     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
018700     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
018800     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
018900     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
019000     03       CM-18V0 REDEFINES COMPUTED-A.
019100        04 COMPUTED-18V0                   PIC -9(18).
019200        04 FILLER                          PIC X.
019300     03 FILLER PIC X(50) VALUE SPACE.
019400 01  TEST-CORRECT.
019500     02 FILLER PIC X(30) VALUE SPACE.
019600     02 FILLER PIC X(17) VALUE "       CORRECT =".
019700     02 CORRECT-X.
019800     03 CORRECT-A                  PIC X(20) VALUE SPACE.
019900     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
020000     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
020100     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
020200     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
020300     03      CR-18V0 REDEFINES CORRECT-A.
020400         04 CORRECT-18V0                     PIC -9(18).
020500         04 FILLER                           PIC X.
020600     03 FILLER PIC X(2) VALUE SPACE.
020700     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
020800*
020900 01  CCVS-C-1.
021000     02 FILLER  PIC IS X        VALUE  SPACE.
021100     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
021200     02 FILLER  PIC IS X        VALUE  SPACE.
021300     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
021400     02 FILLER  PIC IS X        VALUE  SPACE.
021500     02 FILLER  PIC IS X(5)     VALUE "PASS ".
021600     02 FILLER  PIC IS X(9)     VALUE  SPACE.
021700     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
021800 01  CCVS-C-2.
021900     02 FILLER  PIC X(19)  VALUE  SPACE.
022000     02 FILLER  PIC X(6)   VALUE "TESTED".
022100     02 FILLER  PIC X(19)  VALUE  SPACE.
022200     02 FILLER  PIC X(4)   VALUE "FAIL".
022300     02 FILLER  PIC X(72)  VALUE  SPACE.
022400*
022500 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
022600 01  REC-CT            PIC 99       VALUE ZERO.
022700 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
022800 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
022900 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
023000 01  PASS-COUNTER      PIC 999      VALUE ZERO.
023100 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
023200 01  ERROR-HOLD        PIC 999      VALUE ZERO.
023300 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
023400 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
023500 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
023600 01  CCVS-H-1.
023700     02  FILLER          PIC X(39)    VALUE SPACES.
023800     02  FILLER          PIC X(42)    VALUE
023900     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
024000     02  FILLER          PIC X(39)    VALUE SPACES.
024100 01  CCVS-H-2A.
024200   02  FILLER            PIC X(40)  VALUE SPACE.
024300   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
024400   02  FILLER            PIC XXXX   VALUE
024500     "4.2 ".
024600   02  FILLER            PIC X(28)  VALUE
024700            " COPY - NOT FOR DISTRIBUTION".
024800   02  FILLER            PIC X(41)  VALUE SPACE.
024900*
025000 01  CCVS-H-2B.
025100   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
025200   02  TEST-ID           PIC X(9).
025300   02  FILLER            PIC X(4)   VALUE " IN ".
025400   02  FILLER            PIC X(12)  VALUE
025500     " HIGH       ".
025600   02  FILLER            PIC X(22)  VALUE
025700            " LEVEL VALIDATION FOR ".
025800   02  FILLER            PIC X(58)  VALUE
025900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
026000 01  CCVS-H-3.
026100     02  FILLER          PIC X(34)  VALUE
026200            " FOR OFFICIAL USE ONLY    ".
026300     02  FILLER          PIC X(58)  VALUE
026400     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
026500     02  FILLER          PIC X(28)  VALUE
026600            "  COPYRIGHT   1985,1986 ".
026700 01  CCVS-E-1.
026800     02 FILLER           PIC X(52)  VALUE SPACE.
026900     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
027000     02 ID-AGAIN         PIC X(9).
027100     02 FILLER           PIC X(45)  VALUE SPACES.
027200 01  CCVS-E-2.
027300     02  FILLER          PIC X(31)  VALUE SPACE.
027400     02  FILLER          PIC X(21)  VALUE SPACE.
027500     02  CCVS-E-2-2.
027600         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
027700         03 FILLER         PIC X      VALUE SPACE.
027800         03 ENDER-DESC     PIC X(44)  VALUE
027900            "ERRORS ENCOUNTERED".
028000 01  CCVS-E-3.
028100     02  FILLER          PIC X(22)  VALUE
028200            " FOR OFFICIAL USE ONLY".
028300     02  FILLER          PIC X(12)  VALUE SPACE.
028400     02  FILLER          PIC X(58)  VALUE
028500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
028600     02  FILLER          PIC X(8)   VALUE SPACE.
028700     02  FILLER          PIC X(20)  VALUE
028800             " COPYRIGHT 1985,1986".
028900 01  CCVS-E-4.
029000     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
029100     02 FILLER           PIC X(4)   VALUE " OF ".
029200     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
029300     02 FILLER           PIC X(40)  VALUE
029400      "  TESTS WERE EXECUTED SUCCESSFULLY".
029500 01  XXINFO.
029600     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
029700     02 INFO-TEXT.
029800       04 FILLER             PIC X(8)   VALUE SPACE.
029900       04 XXCOMPUTED         PIC X(20).
030000       04 FILLER             PIC X(5)   VALUE SPACE.
030100       04 XXCORRECT          PIC X(20).
030200     02 INF-ANSI-REFERENCE PIC X(48).
030300 01  HYPHEN-LINE.
030400     02 FILLER  PIC IS X VALUE IS SPACE.
030500     02 FILLER  PIC IS X(65)    VALUE IS "************************
030600-    "*****************************************".
030700     02 FILLER  PIC IS X(54)    VALUE IS "************************
030800-    "******************************".
030900 01  CCVS-PGM-ID  PIC X(9)   VALUE
031000     "SQ131A".
031100*
031200*
031300 PROCEDURE DIVISION.
031400 CCVS1 SECTION.
031500 OPEN-FILES.
031600P    OPEN    I-O RAW-DATA.
031700P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
031800P    READ    RAW-DATA INVALID KEY GO TO END-E-1.
031900P    MOVE   "ABORTED "   TO C-ABORT.
032000P    ADD     1           TO C-NO-OF-TESTS.
032100P    ACCEPT  C-DATE      FROM DATE.
032200P    ACCEPT  C-TIME      FROM TIME.
032300P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
032400PEND-E-1.
032500P    CLOSE   RAW-DATA.
032600     OPEN    OUTPUT PRINT-FILE.
032700     MOVE    CCVS-PGM-ID TO TEST-ID.
032800     MOVE    CCVS-PGM-ID TO ID-AGAIN.
032900     MOVE    SPACE TO TEST-RESULTS.
033000     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
033100     MOVE    ZERO TO REC-SKEL-SUB.
033200     PERFORM CCVS-INIT-FILE 10 TIMES.
033300     GO TO CCVS1-EXIT.
033400*
033500 CCVS-INIT-FILE.
033600     ADD     1 TO REC-SKL-SUB.
033700     MOVE    FILE-RECORD-INFO-SKELETON TO
033800                  FILE-RECORD-INFO (REC-SKL-SUB).
033900*
034000 CLOSE-FILES.
034100     PERFORM END-ROUTINE THRU END-ROUTINE-13.
034200     CLOSE   PRINT-FILE.
034300P    OPEN    I-O RAW-DATA.
034400P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
034500P    READ    RAW-DATA INVALID KEY GO TO END-E-2.
034600P    MOVE   "OK.     " TO C-ABORT.
034700P    MOVE    PASS-COUNTER  TO C-OK.
034800P    MOVE    ERROR-HOLD    TO C-ALL.
034900P    MOVE    ERROR-COUNTER TO C-FAIL.
035000P    MOVE    DELETE-CNT    TO C-DELETED.
035100P    MOVE    INSPECT-COUNTER TO C-INSPECT.
035200P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
035300PEND-E-2.
035400P    CLOSE   RAW-DATA.
035500 TERMINATE-CCVS.
035600S    EXIT    PROGRAM.
035700     STOP    RUN.
035800*
035900 INSPT.
036000     MOVE   "INSPT" TO P-OR-F.
036100     ADD     1 TO INSPECT-COUNTER.
036200     PERFORM PRINT-DETAIL.
036300
036400 PASS.
036500     MOVE   "PASS " TO P-OR-F.
036600     ADD     1 TO PASS-COUNTER.
036700     PERFORM PRINT-DETAIL.
036800*
036900 FAIL.
037000     MOVE   "FAIL*" TO P-OR-F.
037100     ADD     1 TO ERROR-COUNTER.
037200     PERFORM PRINT-DETAIL.
037300*
037400 DE-LETE.
037500     MOVE   "****TEST DELETED****" TO RE-MARK.
037600     MOVE   "*****" TO P-OR-F.
037700     ADD     1 TO DELETE-COUNTER.
037800     PERFORM PRINT-DETAIL.
037900*
038000 PRINT-DETAIL.
038100     IF REC-CT NOT EQUAL TO ZERO
038200         MOVE   "." TO PARDOT-X
038300         MOVE    REC-CT TO DOTVALUE.
038400     MOVE    TEST-RESULTS TO PRINT-REC.
038500     PERFORM WRITE-LINE.
038600     IF P-OR-F EQUAL TO "FAIL*"
038700         PERFORM WRITE-LINE
038800         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
038900     ELSE
039000         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
039100     MOVE    SPACE TO P-OR-F.
039200     MOVE    SPACE TO COMPUTED-X.
039300     MOVE    SPACE TO CORRECT-X.
039400     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
039500     MOVE    SPACE TO RE-MARK.
039600*
039700 HEAD-ROUTINE.
039800     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039900     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040000     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
040100     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
040200 COLUMN-NAMES-ROUTINE.
040300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
040400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
040600 END-ROUTINE.
040700     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
040800     PERFORM WRITE-LINE 5 TIMES.
040900 END-RTN-EXIT.
041000     MOVE    CCVS-E-1 TO DUMMY-RECORD.
041100     PERFORM WRITE-LINE 2 TIMES.
041200*
041300 END-ROUTINE-1.
041400     ADD     ERROR-COUNTER   TO ERROR-HOLD
041500     ADD     INSPECT-COUNTER TO ERROR-HOLD.
041600     ADD     DELETE-COUNTER  TO ERROR-HOLD.
041700     ADD     PASS-COUNTER    TO ERROR-HOLD.
041800     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
041900     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
042000     MOVE    CCVS-E-4        TO CCVS-E-2-2.
042100     MOVE    CCVS-E-2        TO DUMMY-RECORD
042200     PERFORM WRITE-LINE.
042300     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
042400     IF ERROR-COUNTER IS EQUAL TO ZERO
042500         MOVE   "NO " TO ERROR-TOTAL
042600     ELSE
042700         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
042800     MOVE    CCVS-E-2 TO DUMMY-RECORD.
042900     PERFORM WRITE-LINE.
043000 END-ROUTINE-13.
043100     IF DELETE-COUNTER IS EQUAL TO ZERO
043200         MOVE   "NO " TO ERROR-TOTAL
043300     ELSE
043400         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
043500     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
043600     MOVE    CCVS-E-2 TO DUMMY-RECORD.
043700     PERFORM WRITE-LINE.
043800     IF INSPECT-COUNTER EQUAL TO ZERO
043900         MOVE   "NO " TO ERROR-TOTAL
044000     ELSE
044100         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
044200     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
044300     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
044400     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
044500*
044600 WRITE-LINE.
044700     ADD     1 TO RECORD-COUNT.
044800Y    IF RECORD-COUNT GREATER 50
044900Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
045000Y        MOVE  SPACE TO DUMMY-RECORD
045100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
045200Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
045300Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
045400Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
045500Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
045600Y        MOVE  ZERO TO RECORD-COUNT.
045700     PERFORM WRT-LN.
045800*
045900 WRT-LN.
046000     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
046100     MOVE    SPACE TO DUMMY-RECORD.
046200 BLANK-LINE-PRINT.
046300     PERFORM WRT-LN.
046400 FAIL-ROUTINE.
046500     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
046600     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
046700     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
046800     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
046900     MOVE    XXINFO TO DUMMY-RECORD.
047000     PERFORM WRITE-LINE 2 TIMES.
047100     MOVE    SPACES TO INF-ANSI-REFERENCE.
047200     GO TO   FAIL-ROUTINE-EX.
047300 FAIL-ROUTINE-WRITE.
047400     MOVE    TEST-COMPUTED  TO PRINT-REC
047500     PERFORM WRITE-LINE
047600     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
047700     MOVE    TEST-CORRECT   TO PRINT-REC
047800     PERFORM WRITE-LINE 2 TIMES.
047900     MOVE    SPACES         TO COR-ANSI-REFERENCE.
048000 FAIL-ROUTINE-EX.
048100     EXIT.
048200 BAIL-OUT.
048300     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
048400     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
048500 BAIL-OUT-WRITE.
048600     MOVE    CORRECT-A      TO XXCORRECT.
048700     MOVE    COMPUTED-A     TO XXCOMPUTED.
048800     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
048900     MOVE    XXINFO TO DUMMY-RECORD.
049000     PERFORM WRITE-LINE 2 TIMES.
049100     MOVE    SPACES TO INF-ANSI-REFERENCE.
049200 BAIL-OUT-EX.
049300     EXIT.
049400 CCVS1-EXIT.
049500     EXIT.
049600*
049700****************************************************************
049800*                                                              *
049900*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
050000*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
050100*                                                              *
050200****************************************************************
050300*
050400 SECT-SQ131A-MAIN SECTION.
050500*
050600*    THE FIRST ACTION IS TO CREATE THE FILE BY MEANS OF AN
050700*    OPEN OUTPUT STATEMENT.
050800*
050900 SEQ-INIT-01.
051000*
051100     MOVE    0 TO REC-CT
051200     MOVE   "CREATE FILE, OPEN OUTPUT" TO FEATURE
051300     MOVE   "SEQ-TEST-OP-01" TO PAR-NAME
051400     MOVE   "**" TO SQ-FS1-STATUS.
051500 SEQ-TEST-OP-01.
051600     OPEN    OUTPUT SQ-FS1.
051700*
051800*    CHECK THE I-O STATUS VALUE RETURNED BY THE FIRST OPEN.
051900*
052000     ADD     1 TO REC-CT.
052100     GO TO   SEQ-TEST-OP-01-01.
052200 SEQ-DELETE-01-01.
052300     PERFORM DE-LETE.
052400     GO TO   SEQ-TEST-01-01-END.
052500 SEQ-TEST-OP-01-01.
052600     IF  SQ-FS1-STATUS = "00"
052700         PERFORM PASS
052800     ELSE
052900         MOVE    SQ-FS1-STATUS TO COMPUTED-A
053000         MOVE   "00" TO CORRECT-A
053100         MOVE   "UNEXPECTED I-O STATUS CODE FROM OPEN OUTPUT"
053200                    TO RE-MARK
053300         MOVE   "VII-3, 1.5.3(1)A" TO ANSI-REFERENCE
053400         PERFORM FAIL.
053500 SEQ-TEST-01-01-END.
053600*
053700*
053800*    HAVING OPENED THE FILE FOR OUTPUT, THE NEXT ACTION IS TO
053900*    ATTEMPT TO OPEN IT FOR I-O.  THE STANDARD PERMITS THE
054000*    TERMINATION OF PROGRAM EXECUTION ON SUCH AN ATTEMPT TO
054100*    OPEN A FILE WHICH IS ALREADY OPEN, BUT ALSO ALLOWS
054200*    EXECUTION TO CONTINUE.
054300*
054400     MOVE    SPACE TO DUMMY-RECORD
054500     PERFORM WRITE-LINE.
054600     MOVE   "ABOUT TO ATTEMPT TO OPEN AN OPEN FILE"
054700               TO DUMMY-RECORD
054800     PERFORM WRITE-LINE.
054900     MOVE   "ABNORMAL TERMINATION AT THIS POINT IS ACCEPTABLE"
055000               TO DUMMY-RECORD
055100     PERFORM WRITE-LINE 3 TIMES.
055200*
055300 SEQ-INIT-02.
055400     MOVE    0 TO REC-CT
055500     MOVE   "OPEN I-O ON AN OPEN FILE" TO FEATURE
055600     MOVE   "SEQ-TEST-OP-02" TO PAR-NAME
055700     MOVE   "**" TO SQ-FS1-STATUS.
055800 SEQ-TEST-OP-02.
055900     OPEN    I-O SQ-FS1.
056000*
056100*    CHECK THE I-O STATUS VALUE RETURNED BY THE SECOND OPEN.
056200*
056300     ADD     1 TO REC-CT.
056400     GO TO   SEQ-TEST-OP-02-01.
056500 SEQ-DELETE-02-01.
056600     PERFORM DE-LETE.
056700     GO TO   SEQ-TEST-02-01-END.
056800 SEQ-TEST-OP-02-01.
056900     IF  SQ-FS1-STATUS = "41"
057000         PERFORM PASS
057100     ELSE
057200         MOVE    SQ-FS1-STATUS TO COMPUTED-A
057300         MOVE   "41" TO CORRECT-A
057400         MOVE   "UNEXPECTED I-O STATUS CODE FROM OPEN I-O"
057500                    TO RE-MARK
057600         MOVE   "VII-4, 1.5.3(4)A" TO ANSI-REFERENCE
057700         PERFORM FAIL.
057800 SEQ-TEST-02-01-END.
057900*
058000*
058100 CCVS-EXIT SECTION.
058200 CCVS-999999.
058300     GO TO   CLOSE-FILES.
