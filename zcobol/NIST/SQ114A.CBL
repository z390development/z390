000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ114A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300
001400*
001500*
001600*         NEW TEST:
001700*                         OPEN OUTPUT  FILE-1, FILE-2.
001800*                         OPEN  INPUT  FILE-1, FILE-2.
001900*                         CLOSE FILE-1, FILE-2.
002000*
002100*        THE ROUTINE SQ114A TESTS THE USE OF THE SAME AREA
002200*    CLAUSE FOR TWO FILES, ONE A TAPE FILE AND THE OTHER A
002300*    MASS STORAGE FILE.  THIS ROUTINE IS A COMBINATION OF THE
002400*    ROUTINES SQ102 AND SQ104.
002500*
002600*    USED X-CARDS:
002700*         XXXXX001
002800*         XXXXX014
002900*         XXXXX055
003000*     P   XXXXX062
003100*         XXXXX082
003200*         XXXXX083
003300*     C   XXXXX084
003400*
003500*
003600 ENVIRONMENT DIVISION.
003700 CONFIGURATION SECTION.
003800 SOURCE-COMPUTER.
003900     XXXXX082.
004000 OBJECT-COMPUTER.
004100     XXXXX083.
004200 INPUT-OUTPUT SECTION.
004300 FILE-CONTROL.
004400P    SELECT RAW-DATA   ASSIGN TO
004500P    XXXXX062
004600P           ORGANIZATION IS INDEXED
004700P           ACCESS MODE IS RANDOM
004800P           RECORD KEY IS RAW-DATA-KEY.
004900     SELECT PRINT-FILE ASSIGN TO
005000     XXXXX055.
005100     SELECT SQ-FS1 ASSIGN TO
005200     XXXXX001
005300     ORGANIZATION IS SEQUENTIAL
005400     ACCESS MODE IS SEQUENTIAL
005500     FILE STATUS IS FILE-STATUS-SQ-FS1.
005600     SELECT SQ-FS2 ASSIGN TO
005700     XXXXX014
005800     ORGANIZATION IS SEQUENTIAL
005900     ACCESS MODE IS SEQUENTIAL
006000     FILE STATUS IS FILE-STATUS-SQ-FS2.
006100     SELECT SQ-FS3 ASSIGN TO
006200     XXXXX014
006300     ORGANIZATION IS SEQUENTIAL
006400     ACCESS MODE IS SEQUENTIAL
006500     FILE STATUS IS FILE-STATUS-SQ-FS3.
006600 I-O-CONTROL.
006700     SAME AREA SQ-FS1 SQ-FS3.
006800 DATA DIVISION.
006900 FILE SECTION.
007000P
007100PFD  RAW-DATA.
007200P
007300P01  RAW-DATA-SATZ.
007400P    05  RAW-DATA-KEY        PIC X(6).
007500P    05  C-DATE              PIC 9(6).
007600P    05  C-TIME              PIC 9(8).
007700P    05  C-NO-OF-TESTS       PIC 99.
007800P    05  C-OK                PIC 999.
007900P    05  C-ALL               PIC 999.
008000P    05  C-FAIL              PIC 999.
008100P    05  C-DELETED           PIC 999.
008200P    05  C-INSPECT           PIC 999.
008300P    05  C-NOTE              PIC X(13).
008400P    05  C-INDENT            PIC X.
008500P    05  C-ABORT             PIC X(8).
008600 FD  PRINT-FILE
008700C    LABEL RECORDS
008800C    XXXXX084
008900C    DATA RECORD IS PRINT-REC DUMMY-RECORD
009000               .
009100 01  PRINT-REC PICTURE X(120).
009200 01  DUMMY-RECORD PICTURE X(120).
009300 FD  SQ-FS1
009400C    LABEL RECORD STANDARD
009500               .
009600 01  SQ-FS1R1-F-G-120.
009700     02  FILLER PIC X(120).
009800 FD  SQ-FS2
009900C    LABEL RECORDS ARE STANDARD
010000C    DATA RECORD SQ-FS2R1-F-G-120
010100     BLOCK CONTAINS 120 CHARACTERS
010200     RECORD CONTAINS 120 CHARACTERS.
010300 01  SQ-FS2R1-F-G-120.
010400     02  FILLER PIC X(120).
010500 FD  SQ-FS3
010600C    LABEL RECORDS ARE STANDARD
010700C    DATA RECORD SQ-FS3R1-F-G-120
010800     BLOCK CONTAINS 120 CHARACTERS
010900     RECORD CONTAINS 120 CHARACTERS.
011000 01  SQ-FS3R1-F-G-120.
011100     02  FILLER PIC X(120).
011200 WORKING-STORAGE SECTION.
011300 01  FILE-STATUS-SQ-FS1    PIC XX VALUE SPACE.
011400 01  FILE-STATUS-SQ-FS3    PIC XX VALUE SPACE.
011500 01  FILE-STATUS-SQ-FS2    PIC XX VALUE SPACE.
011600 01  WRK-CS-09V00 PIC S9(9) USAGE COMP VALUE ZERO.
011700 01  RECORDS-IN-ERROR PIC S9(5) USAGE COMP VALUE ZERO.
011800 01  ERROR-FLAG PIC 9 VALUE ZERO.
011900 01  EOF-FLAG   PICTURE 9 VALUE ZERO.
012000 01  FILE-RECORD-INFORMATION-REC.
012100     03 FILE-RECORD-INFO-SKELETON.
012200        05 FILLER                 PICTURE X(48)       VALUE
012300             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
012400        05 FILLER                 PICTURE X(46)       VALUE
012500             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
012600        05 FILLER                 PICTURE X(26)       VALUE
012700             ",LFIL=000000,ORG=  ,LBLR= ".
012800        05 FILLER                 PICTURE X(37)       VALUE
012900             ",RECKEY=                             ".
013000        05 FILLER                 PICTURE X(38)       VALUE
013100             ",ALTKEY1=                             ".
013200        05 FILLER                 PICTURE X(38)       VALUE
013300             ",ALTKEY2=                             ".
013400        05 FILLER                 PICTURE X(7)        VALUE SPACE.
013500     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
013600        05 FILE-RECORD-INFO-P1-120.
013700           07 FILLER              PIC X(5).
013800           07 XFILE-NAME           PIC X(6).
013900           07 FILLER              PIC X(8).
014000           07 XRECORD-NAME         PIC X(6).
014100           07 FILLER              PIC X(1).
014200           07 REELUNIT-NUMBER     PIC 9(1).
014300           07 FILLER              PIC X(7).
014400           07 XRECORD-NUMBER       PIC 9(6).
014500           07 FILLER              PIC X(6).
014600           07 UPDATE-NUMBER       PIC 9(2).
014700           07 FILLER              PIC X(5).
014800           07 ODO-NUMBER          PIC 9(4).
014900           07 FILLER              PIC X(5).
015000           07 XPROGRAM-NAME        PIC X(5).
015100           07 FILLER              PIC X(7).
015200           07 XRECORD-LENGTH       PIC 9(6).
015300           07 FILLER              PIC X(7).
015400           07 CHARS-OR-RECORDS    PIC X(2).
015500           07 FILLER              PIC X(1).
015600           07 XBLOCK-SIZE          PIC 9(4).
015700           07 FILLER              PIC X(6).
015800           07 RECORDS-IN-FILE     PIC 9(6).
015900           07 FILLER              PIC X(5).
016000           07 XFILE-ORGANIZATION   PIC X(2).
016100           07 FILLER              PIC X(6).
016200           07 XLABEL-TYPE          PIC X(1).
016300        05 FILE-RECORD-INFO-P121-240.
016400           07 FILLER              PIC X(8).
016500           07 XRECORD-KEY          PIC X(29).
016600           07 FILLER              PIC X(9).
016700           07 ALTERNATE-KEY1      PIC X(29).
016800           07 FILLER              PIC X(9).
016900           07 ALTERNATE-KEY2      PIC X(29).
017000           07 FILLER              PIC X(7).
017100 01  TEST-RESULTS.
017200     02 FILLER                    PICTURE X VALUE SPACE.
017300     02 FEATURE                   PICTURE X(20) VALUE SPACE.
017400     02 FILLER                    PICTURE X VALUE SPACE.
017500     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
017600     02 FILLER                    PICTURE X  VALUE SPACE.
017700     02  PAR-NAME.
017800       03 FILLER PICTURE X(12) VALUE SPACE.
017900       03  PARDOT-X PICTURE X  VALUE SPACE.
018000       03 DOTVALUE PICTURE 99  VALUE ZERO.
018100       03 FILLER PIC X(5) VALUE SPACE.
018200     02 FILLER PIC X(10) VALUE SPACE.
018300     02 RE-MARK PIC X(61).
018400 01  TEST-COMPUTED.
018500     02 FILLER PIC X(30) VALUE SPACE.
018600     02 FILLER PIC X(17) VALUE "       COMPUTED=".
018700     02 COMPUTED-X.
018800     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
018900     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
019000     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
019100     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
019200     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
019300     03       CM-18V0 REDEFINES COMPUTED-A.
019400         04 COMPUTED-18V0                   PICTURE -9(18).
019500         04 FILLER                          PICTURE X.
019600     03 FILLER PIC X(50) VALUE SPACE.
019700 01  TEST-CORRECT.
019800     02 FILLER PIC X(30) VALUE SPACE.
019900     02 FILLER PIC X(17) VALUE "       CORRECT =".
020000     02 CORRECT-X.
020100     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
020200     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
020300     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
020400     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
020500     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
020600     03      CR-18V0 REDEFINES CORRECT-A.
020700         04 CORRECT-18V0                    PICTURE -9(18).
020800         04 FILLER                          PICTURE X.
020900     03 FILLER PIC X(50) VALUE SPACE.
021000 01  CCVS-C-1.
021100     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
021200-    "SS  PARAGRAPH-NAME
021300-    "        REMARKS".
021400     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
021500 01  CCVS-C-2.
021600     02 FILLER PICTURE IS X VALUE IS SPACE.
021700     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
021800     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
021900     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
022000     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
022100 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
022200 01  REC-CT PICTURE 99 VALUE ZERO.
022300 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
022400 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
022500 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
022600 01  PASS-COUNTER PIC 999 VALUE ZERO.
022700 01  TOTAL-ERROR PIC 999 VALUE ZERO.
022800 01  ERROR-HOLD PIC 999 VALUE ZERO.
022900 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
023000 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
023100 01  CCVS-H-1.
023200     02  FILLER   PICTURE X(27)  VALUE SPACE.
023300     02 FILLER PICTURE X(67) VALUE
023400     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
023500-    " SYSTEM".
023600     02  FILLER     PICTURE X(26)  VALUE SPACE.
023700 01  CCVS-H-2.
023800     02 FILLER PICTURE X(52) VALUE IS
023900     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
024000     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
024100     02 TEST-ID PICTURE IS X(9).
024200     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
024300 01  CCVS-H-3.
024400     02  FILLER PICTURE X(34) VALUE
024500     " FOR OFFICIAL USE ONLY    ".
024600     02  FILLER PICTURE X(58) VALUE
024700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
024800     02  FILLER PICTURE X(28) VALUE
024900     "  COPYRIGHT   1985 ".
025000 01  CCVS-E-1.
025100     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
025200     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
025300     02 ID-AGAIN PICTURE IS X(9).
025400     02 FILLER PICTURE X(45) VALUE IS
025500     " NTIS DISTRIBUTION COBOL 85".
025600 01  CCVS-E-2.
025700     02  FILLER                   PICTURE X(31)  VALUE
025800     SPACE.
025900     02  FILLER                   PICTURE X(21)  VALUE SPACE.
026000     02 CCVS-E-2-2.
026100         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
026200         03 FILLER PICTURE IS X VALUE IS SPACE.
026300         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
026400 01  CCVS-E-3.
026500     02  FILLER PICTURE X(22) VALUE
026600     " FOR OFFICIAL USE ONLY".
026700     02  FILLER PICTURE X(12) VALUE SPACE.
026800     02  FILLER PICTURE X(58) VALUE
026900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
027000     02  FILLER PICTURE X(13) VALUE SPACE.
027100     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
027200 01  CCVS-E-4.
027300     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
027400     02 FILLER PIC XXXX VALUE " OF ".
027500     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
027600     02 FILLER PIC X(40) VALUE
027700      "  TESTS WERE EXECUTED SUCCESSFULLY".
027800 01  XXINFO.
027900     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
028000     02 INFO-TEXT.
028100     04 FILLER PIC X(20) VALUE SPACE.
028200     04 XXCOMPUTED PIC X(20).
028300     04 FILLER PIC X(5) VALUE SPACE.
028400     04 XXCORRECT PIC X(20).
028500 01  HYPHEN-LINE.
028600     02 FILLER PICTURE IS X VALUE IS SPACE.
028700     02 FILLER PICTURE IS X(65) VALUE IS "************************
028800-    "*****************************************".
028900     02 FILLER PICTURE IS X(54) VALUE IS "************************
029000-    "******************************".
029100 01  CCVS-PGM-ID PIC X(6) VALUE
029200     "SQ114A".
029300 PROCEDURE DIVISION.
029400 CCVS1 SECTION.
029500 OPEN-FILES.
029600P    OPEN I-O RAW-DATA.
029700P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
029800P    READ RAW-DATA INVALID KEY GO TO END-E-1.
029900P    MOVE "ABORTED " TO C-ABORT.
030000P    ADD 1 TO C-NO-OF-TESTS.
030100P    ACCEPT C-DATE  FROM DATE.
030200P    ACCEPT C-TIME  FROM TIME.
030300P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
030400PEND-E-1.
030500P    CLOSE RAW-DATA.
030600     OPEN     OUTPUT PRINT-FILE.
030700     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
030800     MOVE    SPACE TO TEST-RESULTS.
030900     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
031000     MOVE ZERO TO REC-SKL-SUB.
031100     PERFORM CCVS-INIT-FILE 9 TIMES.
031200 CCVS-INIT-FILE.
031300     ADD 1 TO REC-SKL-SUB.
031400     MOVE FILE-RECORD-INFO-SKELETON TO
031500                  FILE-RECORD-INFO (REC-SKL-SUB).
031600 CCVS-INIT-EXIT.
031700     GO TO CCVS1-EXIT.
031800 CLOSE-FILES.
031900     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
032000P    OPEN I-O RAW-DATA.
032100P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
032200P    READ RAW-DATA INVALID KEY GO TO END-E-2.
032300P    MOVE "OK.     " TO C-ABORT.
032400P    MOVE PASS-COUNTER TO C-OK.
032500P    MOVE ERROR-HOLD   TO C-ALL.
032600P    MOVE ERROR-COUNTER TO C-FAIL.
032700P    MOVE DELETE-CNT TO C-DELETED.
032800P    MOVE INSPECT-COUNTER TO C-INSPECT.
032900P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
033000PEND-E-2.
033100P    CLOSE RAW-DATA.
033200 TERMINATE-CCVS.
033300S    EXIT PROGRAM.
033400STERMINATE-CALL.
033500     STOP     RUN.
033600 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
033700 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
033800 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
033900 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
034000     MOVE "****TEST DELETED****" TO RE-MARK.
034100 PRINT-DETAIL.
034200     IF REC-CT NOT EQUAL TO ZERO
034300             MOVE "." TO PARDOT-X
034400             MOVE REC-CT TO DOTVALUE.
034500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
034600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
034700        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
034800          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
034900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
035000     MOVE SPACE TO CORRECT-X.
035100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
035200     MOVE     SPACE TO RE-MARK.
035300 HEAD-ROUTINE.
035400     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035500     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
035600     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
035700 COLUMN-NAMES-ROUTINE.
035800     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035900     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
036100 END-ROUTINE.
036200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
036300 END-RTN-EXIT.
036400     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036500 END-ROUTINE-1.
036600      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
036700      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
036800      ADD PASS-COUNTER TO ERROR-HOLD.
036900*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
037000      MOVE PASS-COUNTER TO CCVS-E-4-1.
037100      MOVE ERROR-HOLD TO CCVS-E-4-2.
037200      MOVE CCVS-E-4 TO CCVS-E-2-2.
037300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
037400  END-ROUTINE-12.
037500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
037600     IF       ERROR-COUNTER IS EQUAL TO ZERO
037700         MOVE "NO " TO ERROR-TOTAL
037800         ELSE
037900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
038000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
038100     PERFORM WRITE-LINE.
038200 END-ROUTINE-13.
038300     IF DELETE-CNT IS EQUAL TO ZERO
038400         MOVE "NO " TO ERROR-TOTAL  ELSE
038500         MOVE DELETE-CNT TO ERROR-TOTAL.
038600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
038700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038800      IF   INSPECT-COUNTER EQUAL TO ZERO
038900          MOVE "NO " TO ERROR-TOTAL
039000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
039100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
039200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
039300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
039400 WRITE-LINE.
039500     ADD 1 TO RECORD-COUNT.
039600Y    IF RECORD-COUNT GREATER 50
039700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
039800Y        MOVE SPACE TO DUMMY-RECORD
039900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
040000Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
040100Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
040200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
040300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
040400Y        MOVE ZERO TO RECORD-COUNT.
040500     PERFORM WRT-LN.
040600 WRT-LN.
040700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
040800     MOVE SPACE TO DUMMY-RECORD.
040900 BLANK-LINE-PRINT.
041000     PERFORM WRT-LN.
041100 FAIL-ROUTINE.
041200     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
041300     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
041400     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
041500     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041600     GO TO FAIL-ROUTINE-EX.
041700 FAIL-ROUTINE-WRITE.
041800     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
041900     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
042000 FAIL-ROUTINE-EX. EXIT.
042100 BAIL-OUT.
042200     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
042300     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
042400 BAIL-OUT-WRITE.
042500     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
042600     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042700 BAIL-OUT-EX. EXIT.
042800 CCVS1-EXIT.
042900     EXIT.
043000 SECT-SQ102-0001 SECTION.
043100 SEQ-INIT-001.
043200     MOVE "SQ-FS1" TO XFILE-NAME (1).
043300     MOVE "R1-F-G" TO XRECORD-NAME (1).
043400     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
043500     MOVE 000120 TO XRECORD-LENGTH (1).
043600     MOVE "RC"   TO CHARS-OR-RECORDS (1).
043700     MOVE 0001   TO XBLOCK-SIZE (1).
043800     MOVE 000750 TO RECORDS-IN-FILE (1).
043900     MOVE "SQ"   TO XFILE-ORGANIZATION (1).
044000     MOVE "S" TO XLABEL-TYPE (1).
044100     MOVE 000001 TO XRECORD-NUMBER (1).
044200 OPEN-TEST-GF-01.
044300**************************************************************
044400*  OPEN OUTPUT FILE-1, FILE-2.   WILL BE TESTED IN THIS TEST.*
044500*  VII; 4.3.2 (PAGE VII-39)                                  *
044600**************************************************************
044700
044800     MOVE SPACE TO FILE-STATUS-SQ-FS1.
044900     MOVE SPACE TO FILE-STATUS-SQ-FS2.
045000     OPEN OUTPUT SQ-FS1 SQ-FS2.
045100     IF FILE-STATUS-SQ-FS1 NOT = "00"
045200         OR FILE-STATUS-SQ-FS2 NOT = "00"
045300             GO TO  OPEN-FAIL-GF-01.
045400 OPEN-PASS-GF-01.
045500     PERFORM PASS
045600     GO TO OPEN-WRITE-GF-01.
045700 OPEN-FAIL-GF-01.
045800     IF FILE-STATUS-SQ-FS1 NOT = "00"
045900         MOVE "STATUS 1: 00" TO CORRECT-A
046000         MOVE FILE-STATUS-SQ-FS1 TO COMPUTED-A
046100         MOVE "VII-39; 4.3.2        " TO  RE-MARK
046200         PERFORM FAIL
046300         PERFORM OPEN-WRITE-GF-01.
046400     IF FILE-STATUS-SQ-FS2 NOT = "00"
046500         MOVE "STATUS 2: 00" TO CORRECT-A
046600         MOVE FILE-STATUS-SQ-FS2 TO COMPUTED-A
046700         MOVE "VII-39; 4.3.2        " TO  RE-MARK
046800         PERFORM FAIL.
046900 OPEN-WRITE-GF-01.
047000     MOVE "OPEN-TEST-GF-01" TO PAR-NAME.
047100     MOVE "OPEN OUTPUT FIL1 FIL2" TO FEATURE.
047200     PERFORM PRINT-DETAIL.
047300 WRITE-TEST-GF-01.
047400     MOVE FILE-RECORD-INFO-P1-120 (1)  TO SQ-FS1R1-F-G-120.
047500     WRITE SQ-FS1R1-F-G-120.
047600     IF XRECORD-NUMBER (1) EQUAL TO 750
047700         GO TO WRITE-WRITE-GF-01.
047800     ADD 1 TO XRECORD-NUMBER (1).
047900     GO TO WRITE-TEST-GF-01.
048000 WRITE-WRITE-GF-01.
048100     MOVE "WRITE  FILE SQ-FS1" TO FEATURE.
048200     MOVE "WRITE-TEST-GF-01" TO PAR-NAME.
048300     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
048400     MOVE  XRECORD-NUMBER (1) TO CORRECT-18V0.
048500     PERFORM PRINT-DETAIL.
048600     CLOSE SQ-FS1.
048700*        A SEQUENTIAL TAPE FILE WITH 120 CHARACTER RECORDS
048800*    HAS BEEN CREATED. THE FILE CONTAINS 750 RECORDS.
048900 SEQ-INIT-002.
049000     MOVE ZERO TO WRK-CS-09V00.
049100*        THIS TEST READS AND CHECKS THE FILE CREATED IN
049200*    SEQ-TEST-001.
049300     OPEN INPUT SQ-FS1.
049400 SEQ-TEST-002.
049500     READ SQ-FS1
049600          AT END GO TO SEQ-TEST-002-1.
049700     MOVE   SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
049800     ADD 1 TO WRK-CS-09V00.
049900     IF WRK-CS-09V00 GREATER THAN 750
050000        MOVE "MORE THAN 750 RECORDS" TO RE-MARK
050100        GO TO SEQ-FAIL-002.
050200     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
050300         ADD 1 TO RECORDS-IN-ERROR
050400         GO TO SEQ-TEST-002.
050500     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS1"
050600        ADD 1 TO RECORDS-IN-ERROR
050700        GO TO SEQ-TEST-002.
050800     IF XLABEL-TYPE (1) NOT EQUAL TO "S"
050900        ADD 1 TO RECORDS-IN-ERROR.
051000     GO TO SEQ-TEST-002.
051100 SEQ-TEST-002-1.
051200     IF RECORDS-IN-ERROR EQUAL TO ZERO
051300         GO TO SEQ-PASS-002.
051400     MOVE "ERRORS IN READING SQ-FS1" TO RE-MARK.
051500 SEQ-FAIL-002.
051600     MOVE "RECORDS IN ERROR =" TO COMPUTED-A.
051700     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
051800     PERFORM FAIL.
051900     GO TO SEQ-WRITE-002.
052000 SEQ-PASS-002.
052100     PERFORM PASS.
052200     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
052300     MOVE WRK-CS-09V00 TO CORRECT-18V0.
052400 SEQ-WRITE-002.
052500     MOVE "SEQ-TEST-002" TO PAR-NAME.
052600     MOVE "VERIFY FILE SQ-FS1" TO FEATURE.
052700     PERFORM PRINT-DETAIL.
052800 SEQ-CLOSE-002.
052900     CLOSE SQ-FS1.
053000 READ-INIT-GF-01.
053100     MOVE ZERO TO WRK-CS-09V00.
053200     MOVE ZERO TO RECORDS-IN-ERROR.
053300     OPEN INPUT   SQ-FS1.
053400*            FOUR OPTIONS FOR THE READ STATEMENT ARE CHECKED
053500*    IN THIS SERIES OF TESTS.
053600     MOVE "READ...RECORD AT END ..." TO FEATURE.
053700     MOVE "READ-TEST-GF-01" TO PAR-NAME.
053800     MOVE ZERO TO ERROR-FLAG.
053900 READ-TEST-GF-01.
054000     READ SQ-FS1 RECORD AT END
054100              MOVE "UNEXPECTED EOF" TO COMPUTED-A
054200              MOVE 1 TO EOF-FLAG
054300              GO TO READ-FAIL-GF-01.
054400     PERFORM RECORD-CHECK.
054500     IF WRK-CS-09V00 EQUAL TO 200
054600              GO TO READ-TEST-GF-01-1.
054700             GO TO READ-TEST-GF-01.
054800 RECORD-CHECK.
054900     MOVE SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
055000     ADD 1 TO WRK-CS-09V00.
055100     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
055200         ADD 1 TO RECORDS-IN-ERROR
055300         MOVE 1 TO ERROR-FLAG.
055400 READ-TEST-GF-01-1.
055500     IF ERROR-FLAG EQUAL TO ZERO
055600         GO TO READ-PASS-GF-01.
055700     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
055800 READ-FAIL-GF-01.
055900     MOVE "VII-15; 2.10.2; VII-44; 4.4.2            " TO  RE-MARK.
056000     PERFORM FAIL.
056100     GO TO READ-WRITE-GF-01.
056200 READ-PASS-GF-01.
056300     PERFORM PASS.
056400 READ-WRITE-GF-01.
056500     PERFORM PRINT-DETAIL.
056600 READ-INIT-GF-02.
056700     IF EOF-FLAG EQUAL TO 1
056800        GO TO READ-EOF-GF-05.
056900     MOVE ZERO TO ERROR-FLAG.
057000     MOVE "READ...AT END..." TO FEATURE.
057100     MOVE "READ-TEST-GF-02" TO PAR-NAME.
057200 READ-TEST-GF-02.
057300     READ SQ-FS1 AT END
057400         MOVE "UNEXPECTED EOF" TO COMPUTED-A
057500         MOVE 1 TO EOF-FLAG
057600         GO TO READ-FAIL-GF-02.
057700     PERFORM RECORD-CHECK.
057800     IF WRK-CS-09V00 EQUAL TO 400
057900         GO TO READ-TEST-GF-02-1.
058000     GO TO READ-TEST-GF-02.
058100 READ-TEST-GF-02-1.
058200     IF ERROR-FLAG EQUAL TO ZERO
058300         GO TO READ-PASS-GF-02.
058400     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
058500 READ-FAIL-GF-02.
058600     MOVE "VII-15; 2.10.2; VII-44; 4.4.2            " TO  RE-MARK.
058700     PERFORM FAIL.
058800     GO TO READ-WRITE-GF-02.
058900 READ-PASS-GF-02.
059000     PERFORM PASS.
059100 READ-WRITE-GF-02.
059200     PERFORM PRINT-DETAIL.
059300 READ-INIT-GF-03.
059400     IF EOF-FLAG EQUAL TO 1
059500        GO TO READ-EOF-GF-05.
059600     MOVE ZERO TO ERROR-FLAG.
059700     MOVE "READ...RECORD END..." TO RE-MARK.
059800     MOVE "READ-TEST-GF-03" TO PAR-NAME.
059900 READ-TEST-GF-03.
060000     READ SQ-FS1 RECORD END
060100          MOVE "UNEXPECTED EOF" TO COMPUTED-A
060200          MOVE 1 TO EOF-FLAG
060300          GO TO READ-FAIL-GF-03.
060400     PERFORM RECORD-CHECK.
060500     IF WRK-CS-09V00 EQUAL TO 600
060600         GO TO READ-TEST-GF-03-1.
060700     GO TO READ-TEST-GF-03.
060800 READ-TEST-GF-03-1.
060900     IF ERROR-FLAG EQUAL TO ZERO
061000         GO TO READ-PASS-GF-03.
061100     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
061200 READ-FAIL-GF-03.
061300     MOVE "VII-15; 2.10.2; VII-44; 4.4.2            " TO  RE-MARK.
061400     PERFORM FAIL.
061500     GO TO READ-WRITE-GF-03.
061600 READ-PASS-GF-03.
061700     PERFORM PASS.
061800 READ-WRITE-GF-03.
061900     PERFORM PRINT-DETAIL.
062000 READ-INIT-GF-04.
062100     IF EOF-FLAG EQUAL TO 1
062200        GO TO READ-EOF-GF-05.
062300     MOVE ZERO TO ERROR-FLAG.
062400     MOVE "READ...END..." TO FEATURE.
062500     MOVE  "READ-TEST-GF-04" TO PAR-NAME.
062600 READ-TEST-GF-04.
062700     READ SQ-FS1 END GO TO READ-TEST-GF-04-1.
062800     PERFORM RECORD-CHECK.
062900     IF WRK-CS-09V00 GREATER THAN 750
063000          GO TO READ-TEST-GF-04-1.
063100     GO TO READ-TEST-GF-04.
063200 READ-TEST-GF-04-1.
063300     IF ERROR-FLAG EQUAL TO ZERO
063400          GO TO READ-PASS-GF-04.
063500 READ-FAIL-GF-04.
063600     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
063700     MOVE "VII-15; 2.10.2; VII-44; 4.4.2            " TO  RE-MARK.
063800     PERFORM FAIL.
063900     GO TO READ-WRITE-GF-04.
064000 READ-PASS-GF-04.
064100     PERFORM PASS.
064200 READ-WRITE-GF-04.
064300     PERFORM PRINT-DETAIL.
064400 READ-TEST-GF-05.
064500     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
064600          MOVE "RECORDS IN ERROR =" TO COMPUTED-A
064700          MOVE RECORDS-IN-ERROR TO CORRECT-18V0
064800          GO TO READ-FAIL-GF-05.
064900     IF WRK-CS-09V00 GREATER THAN 750
065000          MOVE "MORE THAN 750 RECORDS" TO RE-MARK
065100          GO TO READ-FAIL-GF-05.
065200 READ-PASS-GF-05.
065300     PERFORM PASS.
065400     GO TO READ-WRITE-GF-05.
065500 READ-EOF-GF-05.
065600     MOVE "LESS THAN 750 RECORDS" TO RE-MARK.
065700     MOVE "RECORDS READ =" TO COMPUTED-A.
065800     MOVE WRK-CS-09V00 TO CORRECT-18V0.
065900 READ-FAIL-GF-05.
066000     MOVE "VII-15; 2.10.2; VII-44; 4.4.2            " TO  RE-MARK.
066100     PERFORM FAIL.
066200 READ-WRITE-GF-05.
066300     MOVE "READ-TEST-GF-05" TO PAR-NAME.
066400     MOVE "READ FILE SQ-FS1" TO FEATURE.
066500     PERFORM PRINT-DETAIL.
066600 READ-CLOSE-GF-05.
066700     CLOSE SQ-FS1.
066800     CLOSE SQ-FS2.
066900 SECT-SQ104-0001 SECTION.
067000 OPEN-TEST-GF-02.
067100     OPEN OUTPUT SQ-FS3.
067200     IF   FILE-STATUS-SQ-FS3 NOT = "00"
067300          GO TO OPEN-FAIL-GF-03.
067400 OPEN-PASS-GF-01.
067500     PERFORM PASS
067600     GO TO OPEN-WRITE-GF-02.
067700 OPEN-FAIL-GF-02.
067800     IF FILE-STATUS-SQ-FS3 NOT = "00"
067900         MOVE "STATUS 3: 00" TO CORRECT-A
068000         MOVE FILE-STATUS-SQ-FS3 TO COMPUTED-A
068100         MOVE "VII-39; 4.3.2        " TO  RE-MARK
068200         PERFORM FAIL.
068300 OPEN-WRITE-GF-02.
068400     MOVE "OPEN-TEST-GF-02" TO PAR-NAME.
068500     MOVE "OPEN OUTPUT FIL3" TO FEATURE.
068600     PERFORM PRINT-DETAIL.
068700 WRITE-INIT-GF-02.
068800     MOVE "SQ-FS3" TO XFILE-NAME (2).
068900     MOVE "R1-F-G" TO XRECORD-NAME (2).
069000     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (2).
069100     MOVE 120 TO XRECORD-LENGTH (2).
069200     MOVE "CH" TO CHARS-OR-RECORDS (2).
069300     MOVE 120 TO XBLOCK-SIZE (2).
069400     MOVE 000649 TO RECORDS-IN-FILE (2).
069500     MOVE "SQ" TO XFILE-ORGANIZATION (2).
069600     MOVE "S" TO XLABEL-TYPE (2).
069700     MOVE 000001 TO XRECORD-NUMBER (2).
069800 WRITE-TEST-GF-02.
069900     MOVE FILE-RECORD-INFO-P1-120 (2) TO SQ-FS3R1-F-G-120.
070000     WRITE SQ-FS3R1-F-G-120.
070100     IF XRECORD-NUMBER (2) EQUAL TO 649
070200        GO TO WRITE-WRITE-GF-02.
070300     ADD 1 TO XRECORD-NUMBER (2).
070400     GO TO WRITE-TEST-GF-02.
070500 WRITE-WRITE-GF-02.
070600     MOVE "WRITE SQ-FS3 649RE" TO FEATURE.
070700     MOVE "WRITE-TEST-GF-02" TO PAR-NAME.
070800     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
070900     MOVE XRECORD-NUMBER (2) TO CORRECT-18V0.
071000     PERFORM PRINT-DETAIL.
071100     CLOSE SQ-FS3.
071200*        A MASS STORAGE SEQUENTIAL FILE WITH 120 CHARACTER
071300*    RECORDS HAS BEEN CREATED.  THE FILE CONTAINS 649 RECORDS.
071400 READ-INIT-GF-06.
071500     MOVE ZERO TO WRK-CS-09V00.
071600     MOVE    ZERO TO RECORDS-IN-ERROR.
071700*        THIS TEST READS AND CHECKS THE FILE CREATED IN
071800*    READ-TEST-007.
071900     OPEN INPUT SQ-FS3.
072000 READ-TEST-GF-06.
072100     READ SQ-FS3 RECORD
072200         AT END GO TO READ-TEST-GF-06-1.
072300     MOVE SQ-FS3R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (2).
072400     ADD 1 TO WRK-CS-09V00.
072500     IF WRK-CS-09V00 GREATER THAN 649
072600         MOVE "MORE THAN 649 RECORDS" TO RE-MARK
072700         GO TO READ-FAIL-GF-06.
072800     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (2)
072900         ADD 1 TO RECORDS-IN-ERROR
073000         GO TO READ-TEST-GF-06.
073100     IF XFILE-NAME (2) NOT EQUAL TO "SQ-FS3"
073200         ADD 1 TO RECORDS-IN-ERROR
073300         GO TO READ-TEST-GF-06.
073400     IF XLABEL-TYPE (2) NOT EQUAL TO "S"
073500     ADD 1 TO RECORDS-IN-ERROR.
073600     GO TO READ-TEST-GF-06.
073700 READ-TEST-GF-06-1.
073800     IF RECORDS-IN-ERROR EQUAL TO ZERO
073900          GO TO READ-PASS-GF-06.
074000     MOVE "ERRORS IN READING SQ-FS3" TO RE-MARK.
074100 READ-FAIL-GF-06.
074200     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
074300     PERFORM FAIL.
074400     GO TO READ-WRITE-GF-06.
074500 READ-PASS-GF-06.
074600     PERFORM PASS.
074700     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
074800     MOVE WRK-CS-09V00 TO CORRECT-18V0.
074900 READ-WRITE-GF-06.
075000     MOVE "READ-TEST-GF-06" TO PAR-NAME.
075100     MOVE "VERIFY FILE SQ-FS3" TO FEATURE.
075200     PERFORM PRINT-DETAIL.
075300 READ-CLOSE-GF-06.
075400     CLOSE SQ-FS3.
075500 READ-INIT-GF-07.
075600     MOVE ZERO TO WRK-CS-09V00.
075700     MOVE ZERO TO RECORDS-IN-ERROR.
075800     OPEN INPUT SQ-FS3.
075900*        FOUR OPTIONS FOR THE READ STATEMENT ARE CHECKED
076000*    IN THIS SERIES OF TESTS.
076100     MOVE "LEV 1 READ STATEMENT" TO FEATURE.
076200     MOVE     ZERO TO EOF-FLAG.
076300     MOVE "READ...RECORD AT END ..." TO FEATURE.
076400     MOVE "READ-TEST-GF-07" TO PAR-NAME.
076500     MOVE ZERO TO ERROR-FLAG.
076600 READ-TEST-GF-07.
076700     READ SQ-FS3 RECORD
076800          AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
076900          MOVE 1 TO EOF-FLAG
077000          GO TO READ-FAIL-GF-07.
077100     PERFORM RECORD-CHECK-1.
077200     IF WRK-CS-09V00 EQUAL TO 50
077300           GO TO READ-TEST-GF-07-1.
077400     GO TO READ-TEST-GF-07.
077500 RECORD-CHECK-1.
077600     MOVE SQ-FS3R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (2).
077700     ADD 1 TO WRK-CS-09V00.
077800     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (2)
077900         ADD 1 TO RECORDS-IN-ERROR
078000         MOVE 1 TO ERROR-FLAG.
078100 READ-TEST-GF-07-1.
078200     IF ERROR-FLAG EQUAL TO ZERO
078300         GO TO READ-PASS-GF-07.
078400     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
078500 READ-FAIL-GF-07.
078600     MOVE "VII-15; 2.10.2; VII-44; 4.4.2            " TO  RE-MARK.
078700     PERFORM FAIL.
078800     GO TO READ-WRITE-GF-07.
078900 READ-PASS-GF-07.
079000     PERFORM PASS.
079100 READ-WRITE-GF-07.
079200     PERFORM PRINT-DETAIL.
079300 READ-INIT-GF-08.
079400     IF EOF-FLAG EQUAL TO 1
079500         GO TO READ-EOF-GF-11.
079600     MOVE ZERO TO ERROR-FLAG.
079700     MOVE "READ...AT END..." TO FEATURE.
079800     MOVE "READ-TEST-GF-08" TO PAR-NAME.
079900 READ-TEST-GF-08.
080000     READ SQ-FS3  AT END
080100          MOVE "UNEXPECTED EOF" TO COMPUTED-A
080200          MOVE 1 TO EOF-FLAG
080300          GO TO READ-FAIL-GF-08.
080400     PERFORM RECORD-CHECK-1.
080500     IF WRK-CS-09V00 EQUAL TO 200
080600         GO TO READ-TEST-GF-08-1.
080700     GO TO READ-TEST-GF-08.
080800 READ-TEST-GF-08-1.
080900     IF ERROR-FLAG EQUAL TO ZERO
081000          GO TO READ-PASS-GF-08.
081100     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
081200 READ-FAIL-GF-08.
081300     MOVE "VII-15; 2.10.2; VII-44; 4.4.2            " TO  RE-MARK.
081400     PERFORM FAIL.
081500     GO TO READ-WRITE-GF-08.
081600 READ-PASS-GF-08.
081700     PERFORM PASS.
081800 READ-WRITE-GF-08.
081900     PERFORM PRINT-DETAIL.
082000 READ-INIT-GF-09.
082100     IF EOF-FLAG EQUAL TO 1
082200         GO TO READ-EOF-GF-11.
082300     MOVE ZERO TO ERROR-FLAG.
082400     MOVE "READ...RECORD END..." TO FEATURE.
082500     MOVE "READ-TEST-GF-09" TO PAR-NAME.
082600 READ-TEST-GF-09.
082700     READ SQ-FS3 RECORD END
082800          MOVE "UNEXPECTED EOF" TO COMPUTED-A
082900          MOVE 1 TO EOF-FLAG
083000          GO TO READ-FAIL-GF-09.
083100     PERFORM RECORD-CHECK-1.
083200     IF WRK-CS-09V00 EQUAL TO 499
083300          GO TO READ-TEST-GF-09-1.
083400     GO TO READ-TEST-GF-09.
083500 READ-TEST-GF-09-1.
083600     IF ERROR-FLAG EQUAL TO ZERO
083700           GO TO READ-PASS-GF-09.
083800     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
083900 READ-FAIL-GF-09.
084000     MOVE "VII-15; 2.10.2; VII-44; 4.4.2            " TO  RE-MARK.
084100     PERFORM FAIL.
084200     GO TO READ-WRITE-GF-09.
084300 READ-PASS-GF-09.
084400     PERFORM PASS.
084500 READ-WRITE-GF-09.
084600     PERFORM PRINT-DETAIL.
084700 READ-INIT-GF-10.
084800     IF EOF-FLAG EQUAL TO 1
084900         GO TO READ-EOF-GF-11.
085000     MOVE ZERO TO ERROR-FLAG.
085100     MOVE "READ...END..." TO FEATURE.
085200     MOVE "READ-TEST-GF-10" TO PAR-NAME.
085300 READ-TEST-GF-10.
085400     READ SQ-FS3 END
085500          GO TO READ-TEST-GF-10-1.
085600     PERFORM RECORD-CHECK-1.
085700     IF WRK-CS-09V00 GREATER THAN 649
085800          GO TO READ-TEST-GF-10-1.
085900     GO TO READ-TEST-GF-10.
086000 READ-TEST-GF-10-1.
086100     IF ERROR-FLAG EQUAL TO ZERO
086200         GO TO READ-PASS-GF-10.
086300 READ-FAIL-GF-10.
086400     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
086500     MOVE "VII-15; 2.10.2; VII-44; 4.4.2            " TO  RE-MARK.
086600     PERFORM FAIL.
086700     GO TO READ-WRITE-GF-10.
086800 READ-PASS-GF-10.
086900     PERFORM PASS.
087000 READ-WRITE-GF-10.
087100     PERFORM PRINT-DETAIL.
087200 READ-TEST-GF-11.
087300     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
087400          MOVE "RECORDS IN ERROR =" TO COMPUTED-A
087500          MOVE RECORDS-IN-ERROR TO CORRECT-18V0
087600          GO TO READ-FAIL-GF-11.
087700     IF WRK-CS-09V00 GREATER THAN 649
087800          MOVE "MORE THAN 649 RECORDS" TO RE-MARK
087900          GO TO READ-FAIL-GF-11.
088000 READ-PASS-GF-11.
088100     PERFORM PASS
088200     GO TO READ-WRITE-GF-11.
088300 READ-EOF-GF-11.
088400     MOVE "LESS THAN 649 RECORDS" TO RE-MARK.
088500     MOVE "RECORDS READ =" TO COMPUTED-A.
088600     MOVE WRK-CS-09V00 TO CORRECT-18V0.
088700 READ-FAIL-GF-11.
088800     PERFORM FAIL.
088900 READ-WRITE-GF-11.
089000     MOVE "READ-TEST-GF-11" TO PAR-NAME.
089100     MOVE "READ FILE SQ-FS3" TO FEATURE.
089200     PERFORM PRINT-DETAIL.
089300 READ-CLOSE-GF-11.
089400     CLOSE SQ-FS3.
089500 OPEN-TEST-GF-03.
089600**************************************************************
089700*  OPEN OUTPUT FILE-1, FILE-2.   WILL BE TESTED IN THIS TEST.*
089800*  VII; 4.3.2 (PAGE VII-39)                                  *
089900**************************************************************
090000
090100     MOVE SPACE TO FILE-STATUS-SQ-FS1.
090200     MOVE SPACE TO FILE-STATUS-SQ-FS2.
090300     OPEN INPUT SQ-FS1 SQ-FS2.
090400     IF FILE-STATUS-SQ-FS1 NOT = "00"
090500         OR FILE-STATUS-SQ-FS2 NOT = "00"
090600             GO TO  OPEN-FAIL-GF-02.
090700 OPEN-PASS-GF-03.
090800     PERFORM PASS
090900     GO TO OPEN-WRITE-GF-03.
091000 OPEN-FAIL-GF-03.
091100     IF FILE-STATUS-SQ-FS1 NOT = "00"
091200         MOVE "STATUS 1: 00" TO CORRECT-A
091300         MOVE FILE-STATUS-SQ-FS1 TO COMPUTED-A
091400         MOVE "VII-15; 2.10.2; VII-44; 4.4.2   " TO  RE-MARK
091500         PERFORM FAIL
091600         PERFORM OPEN-WRITE-GF-03.
091700     IF FILE-STATUS-SQ-FS2 NOT = "00"
091800         MOVE "STATUS 2: 00" TO CORRECT-A
091900         MOVE FILE-STATUS-SQ-FS2 TO COMPUTED-A
092000         MOVE "VII-15; 2.10.2; VII-44; 4.4.2   " TO  RE-MARK
092100         PERFORM FAIL.
092200 OPEN-WRITE-GF-03.
092300     MOVE "OPEN-TEST-GF-03" TO PAR-NAME.
092400     MOVE "OPEN INPUT FILE1, FILE2" TO FEATURE.
092500     PERFORM PRINT-DETAIL.
092600
092700*CLOSE-TEST-GF-01.
092800******************************************************************
092900*  CLOSE FILE-1, FILE-2 WITH LOCK.  WILL BE TESTED IN THIS TEST. *
093000*  VII; 4.2 (PAGE VII-35)                                        *
093100******************************************************************
093200
093300*    MOVE SPACE TO FILE-STATUS-SQ-FS1.
093400*    MOVE SPACE TO FILE-STATUS-SQ-FS2.
093500*    CLOSE SQ-FS1 WITH LOCK, SQ-FS2 WITH LOCK.
093600*    IF FILE-STATUS-SQ-FS1 NOT = "00"
093700*        OR FILE-STATUS-SQ-FS2 NOT = "00"
093800*            GO TO CLOSE-FAIL-GF-01.
093900*CLOSE-PASS-GF-01.
094000*    PERFORM PASS
094100*    GO TO CLOSE-WRITE-GF-01.
094200*CLOSE-FAIL-GF-01.
094300*    IF FILE-STATUS-SQ-FS1 NOT = "00"
094400*        MOVE "STATUS 1: 00" TO CORRECT-A
094500*        MOVE FILE-STATUS-SQ-FS1 TO COMPUTED-A
094600*        MOVE "VII-35; 4.2.2      " TO  RE-MARK
094700*        PERFORM FAIL
094800*        PERFORM CLOSE-WRITE-GF-01.
094900*    IF FILE-STATUS-SQ-FS2 NOT = "00"
095000*        MOVE "STATUS 2: 00" TO CORRECT-A
095100*        MOVE FILE-STATUS-SQ-FS2 TO COMPUTED-A
095200*        MOVE "VII-35; 4.2.2      " TO  RE-MARK
095300*        PERFORM FAIL.
095400*CLOSE-WRITE-GF-01.
095500*    MOVE "CLOSE-TEST-GF-01" TO PAR-NAME.
095600*    MOVE "CLOSE FILE1, FILE2" TO FEATURE.
095700*    PERFORM PRINT-DETAIL.
095800 TERMINATE-ROUTINE.
095900     EXIT.
096000 CCVS-EXIT SECTION.
096100 CCVS-999999.
096200     GO TO CLOSE-FILES.
