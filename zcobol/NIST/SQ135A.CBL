000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ135A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 3.0.                                 *
000900*                                                              *
001000*    CREATION DATE     /     VALIDATION DATE                   *
001100*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001200*                                                              *
001300****************************************************************
001400*                                                              *
001500*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001600*                                                              *
001700*            X-14   SEQUENTIAL MASS STORAGE                    *
001800*            X-55   SYSTEM PRINTER                             *
001900*            X-82   SOURCE-COMPUTER                            *
002000*            X-83   OBJECT-COMPUTER.                           *
002100*            X-84   LABEL RECORDS OPTION
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    SPLIT FROM SQ215A, THE PROGRAM REPEATS THE SEQUENCE OF    *
002600*    FILE HANDLING ROUTINES IN ORDER TO CARRY OUT THE ISOLATED *
002700*    SPLIT TEST THAT CHECKS FOR THE CORRECT RESPONSE TO CLOSE  *
002800*    AN ALREADY CLOSED FILE.  I-O STATUS 42 IS EXPECTED AND    *
002900*    TESTED IN THE DECLARATIVES.                               *
003000****************************************************************
003100*
003200 ENVIRONMENT DIVISION.
003300 CONFIGURATION SECTION.
003400 SOURCE-COMPUTER.
003500     XXXXX082.
003600 OBJECT-COMPUTER.
003700     XXXXX083.
003800*
003900 INPUT-OUTPUT SECTION.
004000 FILE-CONTROL.
004100     SELECT PRINT-FILE ASSIGN TO
004200     XXXXX055.
004300*
004400     SELECT SQ-FS1 ASSIGN TO
004500     XXXXX014
004600            FILE STATUS IS SQ-FS1-STATUS.
004700*
004800*
004900 DATA DIVISION.
005000 FILE SECTION.
005100 FD  PRINT-FILE
005200C    LABEL RECORDS
005300C    XXXXX084
005400C    DATA RECORD IS PRINT-REC DUMMY-RECORD
005500               .
005600 01  PRINT-REC    PICTURE X(120).
005700 01  DUMMY-RECORD PICTURE X(120).
005800*
005900 FD  SQ-FS1
006000C    LABEL RECORD IS STANDARD
006100                .
006200 01  SQ-FS1R1-F-G-120 PIC X(120).
006300*
006400 WORKING-STORAGE SECTION.
006500*
006600***************************************************************
006700*                                                             *
006800*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
006900*                                                             *
007000***************************************************************
007100*
007200 01  SQ-FS1-STATUS.
007300   03  SQ-FS1-KEY-1   PIC X.
007400   03  SQ-FS1-KEY-2   PIC X.
007500*
007600***************************************************************
007700*                                                             *
007800*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
007900*                                                             *
008000***************************************************************
008100*
008200 01  REC-SKEL-SUB   PIC 99.
008300*
008400 01  FILE-RECORD-INFORMATION-REC.
008500     03 FILE-RECORD-INFO-SKELETON.
008600        05 FILLER                 PICTURE X(48)       VALUE
008700             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
008800        05 FILLER                 PICTURE X(46)       VALUE
008900             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
009000        05 FILLER                 PICTURE X(26)       VALUE
009100             ",LFIL=000000,ORG=  ,LBLR= ".
009200        05 FILLER                 PICTURE X(37)       VALUE
009300             ",RECKEY=                             ".
009400        05 FILLER                 PICTURE X(38)       VALUE
009500             ",ALTKEY1=                             ".
009600        05 FILLER                 PICTURE X(38)       VALUE
009700             ",ALTKEY2=                             ".
009800        05 FILLER                 PICTURE X(7)        VALUE SPACE.
009900     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
010000        05 FILE-RECORD-INFO-P1-120.
010100           07 FILLER              PIC X(5).
010200           07 XFILE-NAME          PIC X(6).
010300           07 FILLER              PIC X(8).
010400           07 XRECORD-NAME        PIC X(6).
010500           07 FILLER              PIC X(1).
010600           07 REELUNIT-NUMBER     PIC 9(1).
010700           07 FILLER              PIC X(7).
010800           07 XRECORD-NUMBER      PIC 9(6).
010900           07 FILLER              PIC X(6).
011000           07 UPDATE-NUMBER       PIC 9(2).
011100           07 FILLER              PIC X(5).
011200           07 ODO-NUMBER          PIC 9(4).
011300           07 FILLER              PIC X(5).
011400           07 XPROGRAM-NAME       PIC X(5).
011500           07 FILLER              PIC X(7).
011600           07 XRECORD-LENGTH      PIC 9(6).
011700           07 FILLER              PIC X(7).
011800           07 CHARS-OR-RECORDS    PIC X(2).
011900           07 FILLER              PIC X(1).
012000           07 XBLOCK-SIZE         PIC 9(4).
012100           07 FILLER              PIC X(6).
012200           07 RECORDS-IN-FILE     PIC 9(6).
012300           07 FILLER              PIC X(5).
012400           07 XFILE-ORGANIZATION  PIC X(2).
012500           07 FILLER              PIC X(6).
012600           07 XLABEL-TYPE         PIC X(1).
012700        05 FILE-RECORD-INFO-P121-240.
012800           07 FILLER              PIC X(8).
012900           07 XRECORD-KEY         PIC X(29).
013000           07 FILLER              PIC X(9).
013100           07 ALTERNATE-KEY1      PIC X(29).
013200           07 FILLER              PIC X(9).
013300           07 ALTERNATE-KEY2      PIC X(29).
013400           07 FILLER              PIC X(7).
013500*
013600 01  TEST-RESULTS.
013700     02 FILLER              PIC X      VALUE SPACE.
013800     02 FEATURE             PIC X(24)  VALUE SPACE.
013900     02 FILLER              PIC X      VALUE SPACE.
014000     02 P-OR-F              PIC X(5)   VALUE SPACE.
014100     02 FILLER              PIC X      VALUE SPACE.
014200     02  PAR-NAME.
014300       03 FILLER              PIC X(14)  VALUE SPACE.
014400       03 PARDOT-X            PIC X      VALUE SPACE.
014500       03 DOTVALUE            PIC 99     VALUE ZERO.
014600     02 FILLER              PIC X(9)   VALUE SPACE.
014700     02 RE-MARK             PIC X(61).
014800 01  TEST-COMPUTED.
014900   02 FILLER  PIC X(30)  VALUE SPACE.
015000   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
015100   02 COMPUTED-X.
015200     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
015300     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
015400     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
015500     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
015600     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
015700     03       CM-18V0 REDEFINES COMPUTED-A.
015800        04 COMPUTED-18V0                   PIC -9(18).
015900        04 FILLER                          PIC X.
016000     03 FILLER PIC X(50) VALUE SPACE.
016100 01  TEST-CORRECT.
016200     02 FILLER PIC X(30) VALUE SPACE.
016300     02 FILLER PIC X(17) VALUE "       CORRECT =".
016400     02 CORRECT-X.
016500     03 CORRECT-A                  PIC X(20) VALUE SPACE.
016600     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
016700     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
016800     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
016900     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
017000     03      CR-18V0 REDEFINES CORRECT-A.
017100         04 CORRECT-18V0                     PIC -9(18).
017200         04 FILLER                           PIC X.
017300     03 FILLER PIC X(2) VALUE SPACE.
017400     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
017500 01  CCVS-C-1.
017600     02 FILLER  PIC IS X(4)     VALUE SPACE.
017700     02 FILLER  PIC IS X(98)    VALUE IS "FEATURE               PA
017800-    "SS  PARAGRAPH-NAME
017900-    "       REMARKS".
018000     02 FILLER           PIC X(17)    VALUE SPACE.
018100 01  CCVS-C-2.
018200     02 FILLER           PIC XXXX     VALUE SPACE.
018300     02 FILLER           PIC X(6)     VALUE "TESTED".
018400     02 FILLER           PIC X(16)    VALUE SPACE.
018500     02 FILLER           PIC X(4)     VALUE "FAIL".
018600     02 FILLER           PIC X(90)    VALUE SPACE.
018700 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
018800 01  REC-CT            PIC 99       VALUE ZERO.
018900 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
019000 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
019100 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
019200 01  PASS-COUNTER      PIC 999      VALUE ZERO.
019300 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
019400 01  ERROR-HOLD        PIC 999      VALUE ZERO.
019500 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
019600 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
019700 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
019800 01  CCVS-H-1.
019900     02  FILLER          PIC X(39)    VALUE SPACES.
020000     02  FILLER          PIC X(42)    VALUE
020100     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
020200     02  FILLER          PIC X(39)    VALUE SPACES.
020300 01  CCVS-H-2A.
020400   02  FILLER            PIC X(40)  VALUE SPACE.
020500   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
020600   02  FILLER            PIC XXXX   VALUE
020700     "4.2 ".
020800   02  FILLER            PIC X(28)  VALUE
020900            " COPY - NOT FOR DISTRIBUTION".
021000   02  FILLER            PIC X(41)  VALUE SPACE.
021100*
021200 01  CCVS-H-2B.
021300   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
021400   02  TEST-ID           PIC X(9).
021500   02  FILLER            PIC X(4)   VALUE " IN ".
021600   02  FILLER            PIC X(12)  VALUE
021700     " HIGH       ".
021800   02  FILLER            PIC X(22)  VALUE
021900            " LEVEL VALIDATION FOR ".
022000   02  FILLER            PIC X(58)  VALUE
022100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
022200 01  CCVS-H-3.
022300     02  FILLER          PIC X(34)  VALUE
022400            " FOR OFFICIAL USE ONLY    ".
022500     02  FILLER          PIC X(58)  VALUE
022600     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022700     02  FILLER          PIC X(28)  VALUE
022800            "  COPYRIGHT   1985,1986 ".
022900 01  CCVS-E-1.
023000     02 FILLER           PIC X(52)  VALUE SPACE.
023100     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
023200     02 ID-AGAIN         PIC X(9).
023300     02 FILLER           PIC X(45)  VALUE SPACES.
023400 01  CCVS-E-2.
023500     02  FILLER          PIC X(31)  VALUE SPACE.
023600     02  FILLER          PIC X(21)  VALUE SPACE.
023700     02  CCVS-E-2-2.
023800         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
023900         03 FILLER         PIC X      VALUE SPACE.
024000         03 ENDER-DESC     PIC X(44)  VALUE
024100            "ERRORS ENCOUNTERED".
024200 01  CCVS-E-3.
024300     02  FILLER          PIC X(22)  VALUE
024400            " FOR OFFICIAL USE ONLY".
024500     02  FILLER          PIC X(12)  VALUE SPACE.
024600     02  FILLER          PIC X(58)  VALUE
024700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024800     02  FILLER          PIC X(8)   VALUE SPACE.
024900     02  FILLER          PIC X(20)  VALUE
025000             " COPYRIGHT 1985,1986".
025100 01  CCVS-E-4.
025200     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
025300     02 FILLER           PIC X(4)   VALUE " OF ".
025400     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
025500     02 FILLER           PIC X(40)  VALUE
025600      "  TESTS WERE EXECUTED SUCCESSFULLY".
025700 01  XXINFO.
025800     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
025900     02 INFO-TEXT.
026000       04 FILLER             PIC X(8)   VALUE SPACE.
026100       04 XXCOMPUTED         PIC X(20).
026200       04 FILLER             PIC X(5)   VALUE SPACE.
026300       04 XXCORRECT          PIC X(20).
026400     02 INF-ANSI-REFERENCE PIC X(48).
026500 01  HYPHEN-LINE.
026600     02 FILLER  PIC IS X VALUE IS SPACE.
026700     02 FILLER  PIC IS X(65)    VALUE IS "************************
026800-    "*****************************************".
026900     02 FILLER  PIC IS X(54)    VALUE IS "************************
027000-    "******************************".
027100 01  CCVS-PGM-ID  PIC X(9)   VALUE
027200     "SQ135A".
027300*
027400 PROCEDURE DIVISION.
027500 DECLARATIVES.
027600 SQ-FS1-DECLARATIVE SECTION.
027700     USE AFTER STANDARD EXCEPTION PROCEDURE ON SQ-FS1.
027800 OUTPUT-ERROR-PROCESS.
027900     IF SQ-FS1-STATUS = "42"
028000             PERFORM PASS-DECL
028100             GO TO ABNORMAL-TERM-DECL
028200     ELSE
028300             MOVE "42" TO CORRECT-A
028400             MOVE SQ-FS1-STATUS TO COMPUTED-A
028500             MOVE "STATUS AFTER OPEN OF A CLOSED FILE INCORRECT"
028600                     TO RE-MARK
028700             MOVE "VII-3, FILE STATUS" TO ANSI-REFERENCE
028800             PERFORM FAIL-DECL
028900             GO TO ABNORMAL-TERM-DECL
029000     END-IF.
029100*
029200 PASS-DECL.
029300     MOVE   "PASS " TO P-OR-F.
029400     ADD     1 TO PASS-COUNTER.
029500     PERFORM PRINT-DETAIL-DECL.
029600*
029700 FAIL-DECL.
029800     MOVE   "FAIL*" TO P-OR-F.
029900     ADD     1 TO ERROR-COUNTER.
030000     PERFORM PRINT-DETAIL-DECL.
030100*
030200 PRINT-DETAIL-DECL.
030300     IF REC-CT NOT EQUAL TO ZERO
030400         MOVE   "." TO PARDOT-X
030500         MOVE    REC-CT TO DOTVALUE.
030600     MOVE    TEST-RESULTS TO PRINT-REC.
030700     PERFORM WRITE-LINE-DECL.
030800     IF P-OR-F EQUAL TO "FAIL*"
030900         PERFORM WRITE-LINE-DECL
031000         PERFORM FAIL-ROUTINE-DECL THRU FAIL-ROUTINE-EX-DECL
031100     ELSE
031200         PERFORM BAIL-OUT-DECL THRU BAIL-OUT-EX-DECL.
031300     MOVE    SPACE TO P-OR-F.
031400     MOVE    SPACE TO COMPUTED-X.
031500     MOVE    SPACE TO CORRECT-X.
031600     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
031700     MOVE    SPACE TO RE-MARK.
031800*
031900 WRITE-LINE-DECL.
032000     ADD     1 TO RECORD-COUNT.
032100Y    IF RECORD-COUNT GREATER 50
032200Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
032300Y        MOVE  SPACE TO DUMMY-RECORD
032400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
032500Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN-DECL
032600Y        MOVE  CCVS-C-2 TO DUMMY-RECORD
032700Y        PERFORM WRT-LN-DECL 2 TIMES
032800Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN-DECL
032900Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
033000Y        MOVE  ZERO TO RECORD-COUNT.
033100     PERFORM WRT-LN-DECL.
033200*
033300 WRT-LN-DECL.
033400     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
033500     MOVE    SPACE TO DUMMY-RECORD.
033600 BLANK-LINE-PRINT-DECL.
033700     PERFORM WRT-LN-DECL.
033800 FAIL-ROUTINE-DECL.
033900     IF COMPUTED-X NOT EQUAL TO SPACE
034000             GO TO FAIL-ROUTINE-WRITE-DECL.
034100     IF CORRECT-X NOT EQUAL TO SPACE
034200             GO TO FAIL-ROUTINE-WRITE-DECL.
034300     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
034400     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
034500     MOVE    XXINFO TO DUMMY-RECORD.
034600     PERFORM WRITE-LINE-DECL 2 TIMES.
034700     MOVE    SPACES TO INF-ANSI-REFERENCE.
034800     GO TO   FAIL-ROUTINE-EX-DECL.
034900 FAIL-ROUTINE-WRITE-DECL.
035000     MOVE    TEST-COMPUTED  TO PRINT-REC
035100     PERFORM WRITE-LINE-DECL
035200     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
035300     MOVE    TEST-CORRECT   TO PRINT-REC
035400     PERFORM WRITE-LINE-DECL 2 TIMES.
035500     MOVE    SPACES         TO COR-ANSI-REFERENCE.
035600 FAIL-ROUTINE-EX-DECL.
035700     EXIT.
035800 BAIL-OUT-DECL.
035900     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE-DECL.
036000     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX-DECL.
036100 BAIL-OUT-WRITE-DECL.
036200     MOVE    CORRECT-A      TO XXCORRECT.
036300     MOVE    COMPUTED-A     TO XXCOMPUTED.
036400     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
036500     MOVE    XXINFO TO DUMMY-RECORD.
036600     PERFORM WRITE-LINE-DECL 2 TIMES.
036700     MOVE    SPACES TO INF-ANSI-REFERENCE.
036800 BAIL-OUT-EX-DECL.
036900     EXIT.
037000*
037100 ABNORMAL-TERM-DECL.
037200     MOVE    SPACE TO DUMMY-RECORD.
037300     PERFORM WRITE-LINE-DECL.
037400     MOVE    "ABNORMAL TERMINATION AT THIS POINT IS ACCEPTABLE"
037500                     TO DUMMY-RECORD.
037600     PERFORM WRITE-LINE-DECL 3 TIMES.
037700*
037800 EXIT-DECL.
037900     EXIT.
038000 END DECLARATIVES.
038100*
038200 CCVS1 SECTION.
038300 OPEN-FILES.
038400     OPEN    OUTPUT PRINT-FILE.
038500     MOVE    CCVS-PGM-ID TO TEST-ID.
038600     MOVE    CCVS-PGM-ID TO ID-AGAIN.
038700     MOVE    SPACE TO TEST-RESULTS.
038800     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
038900     MOVE    ZERO TO REC-SKEL-SUB.
039000     PERFORM CCVS-INIT-FILE 10 TIMES.
039100     GO TO CCVS1-EXIT.
039200*
039300 CCVS-INIT-FILE.
039400     ADD     1 TO REC-SKL-SUB.
039500     MOVE    FILE-RECORD-INFO-SKELETON TO
039600                  FILE-RECORD-INFO (REC-SKL-SUB).
039700*
039800 CLOSE-FILES.
039900     PERFORM END-ROUTINE THRU END-ROUTINE-13.
040000     CLOSE   PRINT-FILE.
040100 TERMINATE-CCVS.
040200S    EXIT    PROGRAM.
040300     STOP    RUN.
040400*
040500 INSPT.
040600     MOVE   "INSPT" TO P-OR-F.
040700     ADD     1 TO INSPECT-COUNTER.
040800     PERFORM PRINT-DETAIL.
040900
041000 PASS.
041100     MOVE   "PASS " TO P-OR-F.
041200     ADD     1 TO PASS-COUNTER.
041300     PERFORM PRINT-DETAIL.
041400*
041500 FAIL.
041600     MOVE   "FAIL*" TO P-OR-F.
041700     ADD     1 TO ERROR-COUNTER.
041800     PERFORM PRINT-DETAIL.
041900*
042000 DE-LETE.
042100     MOVE   "****TEST DELETED****" TO RE-MARK.
042200     MOVE   "*****" TO P-OR-F.
042300     ADD     1 TO DELETE-COUNTER.
042400     PERFORM PRINT-DETAIL.
042500*
042600 PRINT-DETAIL.
042700     IF REC-CT NOT EQUAL TO ZERO
042800         MOVE   "." TO PARDOT-X
042900         MOVE    REC-CT TO DOTVALUE.
043000     MOVE    TEST-RESULTS TO PRINT-REC.
043100     PERFORM WRITE-LINE.
043200     IF P-OR-F EQUAL TO "FAIL*"
043300         PERFORM WRITE-LINE
043400         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
043500     ELSE
043600         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
043700     MOVE    SPACE TO P-OR-F.
043800     MOVE    SPACE TO COMPUTED-X.
043900     MOVE    SPACE TO CORRECT-X.
044000     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
044100     MOVE    SPACE TO RE-MARK.
044200*
044300 HEAD-ROUTINE.
044400     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044500     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044600     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
044700     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
044800 COLUMN-NAMES-ROUTINE.
044900     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
045000     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
045200 END-ROUTINE.
045300     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
045400     PERFORM WRITE-LINE 5 TIMES.
045500 END-RTN-EXIT.
045600     MOVE    CCVS-E-1 TO DUMMY-RECORD.
045700     PERFORM WRITE-LINE 2 TIMES.
045800*
045900 END-ROUTINE-1.
046000     ADD     ERROR-COUNTER   TO ERROR-HOLD
046100     ADD     INSPECT-COUNTER TO ERROR-HOLD.
046200     ADD     DELETE-COUNTER  TO ERROR-HOLD.
046300     ADD     PASS-COUNTER    TO ERROR-HOLD.
046400     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
046500     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
046600     MOVE    CCVS-E-4        TO CCVS-E-2-2.
046700     MOVE    CCVS-E-2        TO DUMMY-RECORD
046800     PERFORM WRITE-LINE.
046900     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
047000     IF ERROR-COUNTER IS EQUAL TO ZERO
047100         MOVE   "NO " TO ERROR-TOTAL
047200     ELSE
047300         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
047400     MOVE    CCVS-E-2 TO DUMMY-RECORD.
047500     PERFORM WRITE-LINE.
047600 END-ROUTINE-13.
047700     IF DELETE-COUNTER IS EQUAL TO ZERO
047800         MOVE   "NO " TO ERROR-TOTAL
047900     ELSE
048000         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
048100     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
048200     MOVE    CCVS-E-2 TO DUMMY-RECORD.
048300     PERFORM WRITE-LINE.
048400     IF INSPECT-COUNTER EQUAL TO ZERO
048500         MOVE   "NO " TO ERROR-TOTAL
048600     ELSE
048700         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
048800     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
048900     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
049000     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
049100*
049200 WRITE-LINE.
049300     ADD     1 TO RECORD-COUNT.
049400Y    IF RECORD-COUNT GREATER 50
049500Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
049600Y        MOVE  SPACE TO DUMMY-RECORD
049700Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
049800Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
049900Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
050000Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
050100Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
050200Y        MOVE  ZERO TO RECORD-COUNT.
050300     PERFORM WRT-LN.
050400*
050500 WRT-LN.
050600     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
050700     MOVE    SPACE TO DUMMY-RECORD.
050800 BLANK-LINE-PRINT.
050900     PERFORM WRT-LN.
051000 FAIL-ROUTINE.
051100     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
051200     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
051300     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
051400     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
051500     MOVE    XXINFO TO DUMMY-RECORD.
051600     PERFORM WRITE-LINE 2 TIMES.
051700     MOVE    SPACES TO INF-ANSI-REFERENCE.
051800     GO TO   FAIL-ROUTINE-EX.
051900 FAIL-ROUTINE-WRITE.
052000     MOVE    TEST-COMPUTED  TO PRINT-REC
052100     PERFORM WRITE-LINE
052200     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
052300     MOVE    TEST-CORRECT   TO PRINT-REC
052400     PERFORM WRITE-LINE 2 TIMES.
052500     MOVE    SPACES         TO COR-ANSI-REFERENCE.
052600 FAIL-ROUTINE-EX.
052700     EXIT.
052800 BAIL-OUT.
052900     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
053000     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
053100 BAIL-OUT-WRITE.
053200     MOVE    CORRECT-A      TO XXCORRECT.
053300     MOVE    COMPUTED-A     TO XXCOMPUTED.
053400     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
053500     MOVE    XXINFO TO DUMMY-RECORD.
053600     PERFORM WRITE-LINE 2 TIMES.
053700     MOVE    SPACES TO INF-ANSI-REFERENCE.
053800 BAIL-OUT-EX.
053900     EXIT.
054000 CCVS1-EXIT.
054100     EXIT.
054200*
054300****************************************************************
054400*                                                              *
054500*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
054600*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
054700*                                                              *
054800****************************************************************
054900*
055000 SECT-SQ135A-0001 SECTION.
055100 WRITE-INIT-GF-01.
055200*
055300*        THIS TEST CREATES FILE SQ-FS1 AND CLOSES IT.
055400*        FIRST IT SETS UP A SKELETON RECORD IN WORKING STORAGE.
055500*
055600     MOVE "SQ-FS1" TO XFILE-NAME (1).
055700     MOVE "R1-F-G" TO XRECORD-NAME (1).
055800     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
055900     MOVE 120      TO XRECORD-LENGTH (1).
056000     MOVE "RC"     TO CHARS-OR-RECORDS (1).
056100     MOVE 1        TO XBLOCK-SIZE (1).
056200     MOVE 1        TO RECORDS-IN-FILE (1).
056300     MOVE "SQ"     TO XFILE-ORGANIZATION (1).
056400     MOVE "S"      TO XLABEL-TYPE (1).
056500     MOVE 1        TO XRECORD-NUMBER (1).
056600*
056700 WRITE-OPEN-01.
056800     OPEN    OUTPUT SQ-FS1.
056900*
057000*        WRITE A SINGLE RECORD TO THE FILE
057100*
057200 WRITE-INIT-01.
057300 WRITE-TEST-01-01.
057400     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-FS1R1-F-G-120.
057500     WRITE   SQ-FS1R1-F-G-120.
057600*
057700 CLOSE-INIT-01.
057800 CLOSE-TEST-01.
057900     CLOSE   SQ-FS1.
058000*
058100*        HAVING CLOSED THE FILE, WE NOW TRY TO CLOSE IT AGAIN.
058200*        THE TEST PASSES IF THE FILE CANNOT BE RECLOSED AND
058300*        THE APPROPRIATE I-O STATUS VALUE IS RETURNED.
058400*        AN IMPLEMENTATION MAY TERMINATE EXECUTION OF A
058500*        PROGRAM WHICH ATTEMPTS TO RECLOSE AN ALREADY CLOSED FILE.
058600 CLOSE-INIT-02.
058700*
058800     MOVE    1 TO REC-CT.
058900     MOVE   "CLOSE-TEST-02" TO PAR-NAME
059000     MOVE   "CLOSE OF CLOSED FILE" TO FEATURE.
059100 CLOSE-TEST-02.
059200     CLOSE   SQ-FS1.
059300*
059400 CCVS-EXIT SECTION.
059500 CCVS-999999.
059600     GO TO CLOSE-FILES.
