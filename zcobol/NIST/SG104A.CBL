000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SG104A.
000400 AUTHOR.
000500     FEDERAL COMPILER TESTING CENTER.
000600 INSTALLATION.
000700     GENERAL SERVICES ADMINISTRATION
000800     AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
000900     SOFTWARE DEVELOPMENT OFFICE.
001000     5203 LEESBURG PIKE  SUITE 1100
001100     FALLS CHURCH VIRGINIA 22041.
001200
001300     PHONE   (703) 756-6153
001400
001500     " HIGH       ".
001600 DATE-WRITTEN.
001700     CCVS-74 VERSION 4.0 - 1980 JULY 1.
001800     CREATION DATE     /    VALIDATION DATE
001900     "4.2 ".
002000 SECURITY.
002100     NONE.
002200     SG104A IS A COMPLETELY SELF-CONTAINED PROGRAM.  THE INPUT
002300     PROCEDURE BUILDS THE EIGHT-RECORD FILE SHOWN BELOW. THE
002400     OUTPUT PROCEDURE CHECKS THE SORTED FILE AND GENERATES THE
002500     REPORT.
002600     SORT    SORT    SORT    SORT    SORT   SORT     SORT    SORT
002700     KEY-1   KEY-2   KEY-3   KEY-4   KEY-5  KEY-6    KEY-7   KEY-8
002800     S9(6)   A(5)    SV9(16) X(10)   A(20)  X(10)    999     S99
002900     USAGE   JUST            JUST                            USAGE
003000     COMP    RIGHT           RIGHT                           COMP
003100
003200     +123456     BBB -.1234   BBBBBB A      AAAAAAAA 501     +99
003300     -054321       X -.1234   BBBBBB A      AAAAAAAA 501     +99
003400     -054321     BBB +.6      BBBBBB A      AAAAAAAA 501     +99
003500     -054321     BBB -.1234        X A      AAAAAAAA 501     +99
003600     -054321     BBB -.1234   BBBBBB Z      AAAAAAAA 501     +99
003700     -054321     BBB -.1234   BBBBBB A      Z        501     +99
003800     -054321     BBB -.1234   BBBBBB A      AAAAAAAA 418     +99
003900     -054321     BBB -.1234   BBBBBB A      AAAAAAAA 501     -14
004000
004100     THIS PROGRAM CHECKS THE COMPILER"S ABILITY TO HANDLE EIGHT
004200     ASCENDING KEYS IN ONE FILE.
004300
004400 ENVIRONMENT DIVISION.
004500 CONFIGURATION SECTION.
004600 SOURCE-COMPUTER.
004700     XXXXX082.
004800 OBJECT-COMPUTER.
004900     XXXXX083.
005000 INPUT-OUTPUT SECTION.
005100 FILE-CONTROL.
005200     SELECT PRINT-FILE ASSIGN TO
005300     XXXXX055.
005400     SELECT   SORTFILE-1H ASSIGN TO
005500     XXXXX027.
005600 DATA DIVISION.
005700 FILE SECTION.
005800 FD  PRINT-FILE
005900     LABEL RECORDS
006000     XXXXX084
006100     DATA RECORD IS PRINT-REC DUMMY-RECORD.
006200 01  PRINT-REC PICTURE X(120).
006300 01  DUMMY-RECORD PICTURE X(120).
006400 SD  SORTFILE-1H
006500     DATA RECORD IS SORTFILE-REC.
006600 01  SORTFILE-REC.
006700     02 SORTKEY-8       PICTURE S99 COMPUTATIONAL.
006800     02 SORTKEY-1       PICTURE S9(6) COMPUTATIONAL.
006900     02 SORTKEY-7       PICTURE 999.
007000     02 SORTKEY-3       PICTURE SV9(16).
007100     02 FILLER          PICTURE XX.
007200     02 SORTKEY-4       PICTURE X(10) JUSTIFIED RIGHT.
007300     02 SORTKEY-6       PICTURE X(10).
007400     02 SORTKEY-2       PICTURE A(05) JUSTIFIED RIGHT.
007500     02 SORTKEY-5       PICTURE A(20).
007600     02 FILLER          PICTURE XXX.
007700 WORKING-STORAGE SECTION.
007800 77  UTIL-CTR           PICTURE S99999.
007900 77  SPAC-E             PICTURE X VALUE " ".
008000 01  TEST-RESULTS.
008100     02 FILLER                    PICTURE X VALUE SPACE.
008200     02 FEATURE                   PICTURE X(20) VALUE SPACE.
008300     02 FILLER                    PICTURE X VALUE SPACE.
008400     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
008500     02 FILLER                    PICTURE X  VALUE SPACE.
008600     02  PAR-NAME.
008700       03 FILLER PICTURE X(12) VALUE SPACE.
008800       03  PARDOT-X PICTURE X  VALUE SPACE.
008900       03 DOTVALUE PICTURE 99  VALUE ZERO.
009000       03 FILLER PIC X(5) VALUE SPACE.
009100     02 FILLER PIC X(10) VALUE SPACE.
009200     02 RE-MARK PIC X(61).
009300 01  TEST-COMPUTED.
009400     02 FILLER PIC X(30) VALUE SPACE.
009500     02 FILLER PIC X(17) VALUE "       COMPUTED=".
009600     02 COMPUTED-X.
009700     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
009800     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
009900     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
010000     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
010100     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
010200     03       CM-18V0 REDEFINES COMPUTED-A.
010300         04 COMPUTED-18V0                   PICTURE -9(18).
010400         04 FILLER                          PICTURE X.
010500     03 FILLER PIC X(50) VALUE SPACE.
010600 01  TEST-CORRECT.
010700     02 FILLER PIC X(30) VALUE SPACE.
010800     02 FILLER PIC X(17) VALUE "       CORRECT =".
010900     02 CORRECT-X.
011000     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
011100     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
011200     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
011300     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
011400     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
011500     03      CR-18V0 REDEFINES CORRECT-A.
011600         04 CORRECT-18V0                    PICTURE -9(18).
011700         04 FILLER                          PICTURE X.
011800     03 FILLER PIC X(50) VALUE SPACE.
011900 01  CCVS-C-1.
012000     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
012100-    "SS  PARAGRAPH-NAME
012200-    "        REMARKS".
012300     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
012400 01  CCVS-C-2.
012500     02 FILLER PICTURE IS X VALUE IS SPACE.
012600     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
012700     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
012800     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
012900     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
013000 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
013100 01  REC-CT PICTURE 99 VALUE ZERO.
013200 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
013300 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
013400 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
013500 01  PASS-COUNTER PIC 999 VALUE ZERO.
013600 01  TOTAL-ERROR PIC 999 VALUE ZERO.
013700 01  ERROR-HOLD PIC 999 VALUE ZERO.
013800 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
013900 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
014000 01  CCVS-H-1.
014100     02  FILLER   PICTURE X(27)  VALUE SPACE.
014200     02 FILLER PICTURE X(67) VALUE
014300     " FEDERAL COMPILER TESTING CENTER COBOL COMPILER VALIDATION
014400-    " SYSTEM".
014500     02  FILLER     PICTURE X(26)  VALUE SPACE.
014600 01  CCVS-H-2.
014700     02 FILLER PICTURE X(52) VALUE IS
014800     "CCVS74 NCC  COPY, NOT FOR DISTRIBUTION.".
014900     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
015000     02 TEST-ID PICTURE IS X(9).
015100     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
015200 01  CCVS-H-3.
015300     02  FILLER PICTURE X(34) VALUE
015400     " FOR OFFICIAL USE ONLY    ".
015500     02  FILLER PICTURE X(58) VALUE
015600     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
015700     02  FILLER PICTURE X(28) VALUE
015800     "  COPYRIGHT   1974 ".
015900 01  CCVS-E-1.
016000     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
016100     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
016200     02 ID-AGAIN PICTURE IS X(9).
016300     02 FILLER PICTURE X(45) VALUE IS
016400     " NTIS DISTRIBUTION COBOL 74".
016500 01  CCVS-E-2.
016600     02  FILLER                   PICTURE X(31)  VALUE
016700     SPACE.
016800     02  FILLER                   PICTURE X(21)  VALUE SPACE.
016900     02 CCVS-E-2-2.
017000         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
017100         03 FILLER PICTURE IS X VALUE IS SPACE.
017200         03 ENDER-DESC PIC X(44) VALUE "ERRORS ENCOUNTERED".
017300 01  CCVS-E-3.
017400     02  FILLER PICTURE X(22) VALUE
017500     " FOR OFFICIAL USE ONLY".
017600     02  FILLER PICTURE X(12) VALUE SPACE.
017700     02  FILLER PICTURE X(58) VALUE
017800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
017900     02  FILLER PICTURE X(13) VALUE SPACE.
018000     02 FILLER PIC X(15) VALUE " COPYRIGHT 1974".
018100 01  CCVS-E-4.
018200     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
018300     02 FILLER PIC XXXX VALUE " OF ".
018400     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
018500     02 FILLER PIC X(40) VALUE
018600      "  TESTS WERE EXECUTED SUCCESSFULLY".
018700 01  XXINFO.
018800     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
018900     02 INFO-TEXT.
019000     04 FILLER PIC X(20) VALUE SPACE.
019100     04 XXCOMPUTED PIC X(20).
019200     04 FILLER PIC X(5) VALUE SPACE.
019300     04 XXCORRECT PIC X(20).
019400 01  HYPHEN-LINE.
019500     02 FILLER PICTURE IS X VALUE IS SPACE.
019600     02 FILLER PICTURE IS X(65) VALUE IS "************************
019700-    "*****************************************".
019800     02 FILLER PICTURE IS X(54) VALUE IS "************************
019900-    "******************************".
020000 01  CCVS-PGM-ID PIC X(6) VALUE
020100     "SG104A".
020200 PROCEDURE DIVISION.
020300 SORT-PARA SECTION 69.
020400 SORT-PARAGRAPH.
020500     SORT     SORTFILE-1H ON
020600              ASCENDING KEY SORTKEY-1
020700              ASCENDING SORTKEY-2
020800              ASCENDING SORTKEY-3
020900              ASCENDING SORTKEY-4
021000              ASCENDING SORTKEY-5
021100              ASCENDING SORTKEY-6
021200              ASCENDING SORTKEY-7
021300              ASCENDING SORTKEY-8
021400              INPUT PROCEDURE INPROC
021500              OUTPUT PROCEDURE OUTPROC THRU OUTPROC-EXIT.
021600     STOP     RUN.
021700 INPROC SECTION 69.
021800 BUILD-FILE.
021900     PERFORM  BUILD-RECORD.
022000     MOVE     +123456             TO SORTKEY-1.
022100     PERFORM  RELEASE-RECORD.
022200     PERFORM  BUILD-RECORD.
022300     MOVE     "X"                 TO SORTKEY-2.
022400     PERFORM  RELEASE-RECORD.
022500     PERFORM  BUILD-RECORD.
022600     MOVE     +.6                 TO SORTKEY-3.
022700     PERFORM  RELEASE-RECORD.
022800     PERFORM  BUILD-RECORD.
022900     MOVE     "X"                 TO SORTKEY-4.
023000     PERFORM  RELEASE-RECORD.
023100     PERFORM  BUILD-RECORD.
023200     MOVE     "Z"                 TO SORTKEY-5.
023300     PERFORM  RELEASE-RECORD.
023400     PERFORM  BUILD-RECORD.
023500     MOVE     "Z"                 TO SORTKEY-6.
023600     PERFORM  RELEASE-RECORD.
023700     PERFORM  BUILD-RECORD.
023800     MOVE     +418                TO SORTKEY-7.
023900     PERFORM  RELEASE-RECORD.
024000     PERFORM  BUILD-RECORD.
024100     MOVE     -14                 TO SORTKEY-8.
024200     PERFORM  RELEASE-RECORD.
024300     GO       TO BUILD-EXIT.
024400 BUILD-RECORD.
024500     MOVE     -054321             TO SORTKEY-1.
024600     MOVE     "BBB"               TO SORTKEY-2.
024700     MOVE     -.1234567890123456  TO SORTKEY-3.
024800     MOVE     "BBBBBB"            TO SORTKEY-4.
024900     MOVE     "A"                 TO SORTKEY-5.
025000     MOVE     "AAAAAAAA"          TO SORTKEY-6.
025100     MOVE     -501                TO SORTKEY-7.
025200*       NOTE THIS ITEM IS INTENTIONALLY MOVED TO AN UNSIGNED
025300*             FIELD.
025400     MOVE     +99                 TO SORTKEY-8.
025500 RELEASE-RECORD.
025600     RELEASE  SORTFILE-REC.
025700 BUILD-EXIT.
025800     EXIT.
025900 OUTPROC SECTION 69.
026000 OPEN-FILES.
026100     OPEN     OUTPUT PRINT-FILE.
026200     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
026300     MOVE    SPACE TO TEST-RESULTS.
026400     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
026500     IF       SPAC-E IS LESS THAN "B"
026600              GO TO SPACE-IS-LESS-THAN-B.
026700 B-IS-LESS-THAN-SPACE SECTION 69.
026800 SORT-INIT-A.
026900     MOVE     "SORT - 8 ASC. KEYS" TO FEATURE.
027000*        NOTE THE RECORDS SHOULD BE SORTED INTO THE FOLLOWING
027100*             ORDER --- 8 7 6 5 4 3 1 2 --- THAT IS,
027200*             THE 8TH RECORD SORTS UP TO THE 1ST POSITION,
027300*             THE 7TH RECORD SORTS UP TO THE 2ND POSITION, ETC.
027400 SORT-TEST-1.
027500     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
027600     IF       SORTKEY-7 EQUAL TO 418
027700              PERFORM PASS GO TO SORT-WRITE-1.
027800 SORT-FAIL-1.
027900     PERFORM  FAIL.
028000     MOVE     SORTKEY-7 TO COMPUTED-N.
028100     MOVE     418 TO CORRECT-N.
028200 SORT-WRITE-1.
028300     MOVE     "SORT-TEST-1 " TO PAR-NAME.
028400     PERFORM  PRINT-DETAIL.
028500 SORT-TEST-2.
028600     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
028700     IF       SORTKEY-8 EQUAL TO -14
028800              PERFORM PASS GO TO SORT-WRITE-2.
028900 SORT-FAIL-2.
029000     PERFORM  FAIL.
029100     MOVE     SORTKEY-8 TO COMPUTED-N.
029200     MOVE     -14 TO CORRECT-N.
029300 SORT-WRITE-2.
029400     MOVE     "SORT-TEST-2 " TO PAR-NAME.
029500     PERFORM  PRINT-DETAIL.
029600 SORT-TEST-3.
029700     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
029800     IF       SORTKEY-6 EQUAL TO "Z         "
029900              PERFORM PASS GO TO SORT-WRITE-3.
030000 SORT-FAIL-3.
030100     PERFORM  FAIL.
030200     MOVE     SORTKEY-6 TO COMPUTED-A.
030300     MOVE     "Z         "           TO CORRECT-A.
030400 SORT-WRITE-3.
030500     MOVE     "SORT-TEST-3 " TO PAR-NAME.
030600     PERFORM  PRINT-DETAIL.
030700 SORT-TEST-4.
030800     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
030900     IF       SORTKEY-5 EQUAL TO "Z                   "
031000              PERFORM PASS GO TO SORT-WRITE-4.
031100 SORT-FAIL-4.
031200     PERFORM  FAIL.
031300     MOVE     SORTKEY-5 TO COMPUTED-A.
031400     MOVE     "Z                   " TO CORRECT-A.
031500 SORT-WRITE-4.
031600     MOVE     "SORT-TEST-4 " TO PAR-NAME.
031700     PERFORM  PRINT-DETAIL.
031800 SORT-TEST-5.
031900     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
032000     IF       SORTKEY-4 EQUAL TO "         X"
032100              PERFORM PASS GO TO SORT-WRITE-5.
032200 SORT-FAIL-5.
032300     PERFORM  FAIL.
032400     MOVE     SORTKEY-4 TO COMPUTED-A.
032500     MOVE     "         X"           TO CORRECT-A.
032600 SORT-WRITE-5.
032700     MOVE     "SORT-TEST-5 " TO PAR-NAME.
032800     PERFORM  PRINT-DETAIL.
032900 SORT-TEST-6.
033000     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
033100     IF       SORTKEY-3 EQUAL TO +.6000000000000000
033200              PERFORM PASS GO TO SORT-WRITE-6.
033300 SORT-FAIL-6.
033400     PERFORM  FAIL.
033500     MOVE     SORTKEY-3 TO COMPUTED-0V18.
033600     MOVE     +.6000000000000000     TO CORRECT-0V18.
033700 SORT-WRITE-6.
033800     MOVE     "SORT-TEST-6 " TO PAR-NAME.
033900     PERFORM  PRINT-DETAIL.
034000 SORT-TEST-7.
034100     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
034200     IF       SORTKEY-2 EQUAL TO "    X"
034300              PERFORM PASS GO TO SORT-WRITE-7.
034400 SORT-FAIL-7.
034500     PERFORM  FAIL.
034600     MOVE     SORTKEY-2 TO COMPUTED-A.
034700     MOVE     "    X" TO CORRECT-A.
034800 SORT-WRITE-7.
034900     MOVE     "SORT-TEST-7 " TO PAR-NAME.
035000     PERFORM  PRINT-DETAIL.
035100 SORT-TEST-8.
035200     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
035300     IF       SORTKEY-1 EQUAL TO +123456
035400              PERFORM PASS GO TO SORT-WRITE-8.
035500 SORT-FAIL-8.
035600     PERFORM  FAIL.
035700     MOVE     SORTKEY-1 TO COMPUTED-N.
035800     MOVE     +123456 TO CORRECT-N.
035900 SORT-WRITE-8.
036000     MOVE     "SORT-TEST-8 " TO PAR-NAME.
036100     PERFORM  PRINT-DETAIL.
036200 SORT-REMARK-A.
036300     MOVE     SPACE TO FEATURE.
036400     MOVE     "THE COLLATING SEQUENCE" TO RE-MARK.
036500     PERFORM  PRINT-DETAIL.
036600     MOVE     "RENDERS TESTS 9 THRU 16" TO RE-MARK.
036700     PERFORM  PRINT-DETAIL.
036800     MOVE     "UNNECESSARY." TO RE-MARK.
036900     PERFORM  PRINT-DETAIL.
037000     MOVE     "SORT - 8 ASC. KEYS" TO FEATURE.
037100     GO       TO CONTINUE-TESTING.
037200 SPACE-IS-LESS-THAN-B SECTION 69.
037300 SORT-REMARK-B.
037400     MOVE     "THE COLLATING SEQUENCE" TO RE-MARK.
037500     PERFORM  PRINT-DETAIL.
037600     MOVE     "RENDERS TESTS 1 THRU 8" TO RE-MARK.
037700     PERFORM  PRINT-DETAIL.
037800     MOVE     "UNNECESSARY." TO RE-MARK.
037900     PERFORM  PRINT-DETAIL.
038000     MOVE     "SORT - 8 ASC. KEYS" TO FEATURE.
038100*        NOTE THE RECORDS SHOULD BE SORTED INTO THE FOLLOWING
038200*             ORDER --- 8 1 7 2 6 5 3 4 --- THAT IS,
038300*             THE 1ST RECORD IS SORTED DOWN TO THE 8TH POSITION,
038400*             THE 2ND RECORD SORTS UP TO THE 1ST POSITION, ETC.
038500 SORT-TEST-9.
038600     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
038700     IF       SORTKEY-2 EQUAL TO "    X"
038800              PERFORM PASS GO TO SORT-WRITE-9.
038900 SORT-FAIL-9.
039000     PERFORM  FAIL.
039100     MOVE     SORTKEY-2 TO COMPUTED-A.
039200     MOVE     "    X" TO CORRECT-A.
039300 SORT-WRITE-9.
039400     MOVE     "SORT-TEST-9 " TO PAR-NAME.
039500     PERFORM  PRINT-DETAIL.
039600 SORT-TEST-10.
039700     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
039800     IF       SORTKEY-4 EQUAL TO "         X"
039900              PERFORM PASS GO TO SORT-WRITE-10.
040000 SORT-FAIL-10.
040100     PERFORM  FAIL.
040200     MOVE     SORTKEY-4 TO COMPUTED-A.
040300     MOVE     "         X" TO CORRECT-A.
040400 SORT-WRITE-10.
040500     MOVE     "SORT-TEST-10" TO PAR-NAME.
040600     PERFORM  PRINT-DETAIL.
040700 SORT-TEST-11.
040800     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
040900     IF       SORTKEY-7 EQUAL TO 418
041000              PERFORM PASS GO TO SORT-WRITE-11.
041100 SORT-FAIL-11.
041200     PERFORM  FAIL.
041300     MOVE     SORTKEY-7 TO COMPUTED-N
041400     MOVE     418 TO CORRECT-N.
041500 SORT-WRITE-11.
041600     MOVE     "SORT-TEST-11" TO PAR-NAME.
041700     PERFORM  PRINT-DETAIL.
041800 SORT-TEST-12.
041900     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
042000     IF       SORTKEY-8 EQUAL TO -14
042100              PERFORM PASS GO TO SORT-WRITE-12.
042200 SORT-FAIL-12.
042300     PERFORM  FAIL.
042400     MOVE     SORTKEY-8 TO COMPUTED-N.
042500     MOVE     -14 TO CORRECT-N.
042600 SORT-WRITE-12.
042700     MOVE     "SORT-TEST-12" TO PAR-NAME.
042800     PERFORM  PRINT-DETAIL.
042900 SORT-TEST-13.
043000     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
043100     IF       SORTKEY-6 EQUAL TO "Z         "
043200              PERFORM PASS GO TO SORT-WRITE-13.
043300 SORT-FAIL-13.
043400     PERFORM  FAIL.
043500     MOVE     SORTKEY-6 TO COMPUTED-A.
043600     MOVE     "Z         "           TO CORRECT-A.
043700 SORT-WRITE-13.
043800     MOVE     "SORT-TEST-13" TO PAR-NAME.
043900     PERFORM  PRINT-DETAIL.
044000 SORT-TEST-14.
044100     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
044200     IF       SORTKEY-5 EQUAL TO "Z                   "
044300              PERFORM PASS GO TO SORT-WRITE-14.
044400 SORT-FAIL-14.
044500     PERFORM  FAIL.
044600     MOVE     SORTKEY-5 TO COMPUTED-A.
044700     MOVE     "Z                   " TO CORRECT-A.
044800 SORT-WRITE-14.
044900     MOVE     "SORT-TEST-14" TO PAR-NAME.
045000     PERFORM  PRINT-DETAIL.
045100 SORT-TEST-15.
045200     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
045300     IF       SORTKEY-3 EQUAL TO +.6000000000000000
045400              PERFORM PASS GO TO SORT-WRITE-15.
045500 SORT-FAIL-15.
045600     PERFORM  FAIL.
045700     MOVE     SORTKEY-3 TO COMPUTED-0V18.
045800     MOVE     +.6000000000000000     TO CORRECT-0V18.
045900 SORT-WRITE-15.
046000     MOVE     "SORT-TEST-15" TO PAR-NAME.
046100     PERFORM  PRINT-DETAIL.
046200 SORT-TEST-16.
046300     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
046400     IF       SORTKEY-1 EQUAL TO +123456
046500              PERFORM PASS GO TO SORT-WRITE-16.
046600 SORT-FAIL-16.
046700     PERFORM  FAIL.
046800     MOVE     SORTKEY-1 TO COMPUTED-N.
046900     MOVE     +123456 TO CORRECT-N.
047000 SORT-WRITE-16.
047100     MOVE     "SORT-TEST-16" TO PAR-NAME.
047200     PERFORM  PRINT-DETAIL.
047300 CONTINUE-TESTING SECTION 69.
047400 SORT-TEST-17.
047500     RETURN   SORTFILE-1H AT END
047600              PERFORM PASS GO TO SORT-WRITE-17.
047700 SORT-FAIL-17.
047800     MOVE     "END OF FILE NOT FOUND" TO RE-MARK.
047900     PERFORM  FAIL.
048000 SORT-WRITE-17.
048100     MOVE     "SORT-TEST-17" TO PAR-NAME.
048200     PERFORM  PRINT-DETAIL.
048300     GO       TO OUTPROC-EXIT.
048400 RETURN-ERROR.
048500     MOVE     "RETURN-ERROR" TO PAR-NAME.
048600     PERFORM  FAIL.
048700     MOVE     "EOF PREMATURELY FOUND" TO RE-MARK.
048800     PERFORM  PRINT-DETAIL.
048900     GO TO CCVS1-EXIT.
049000 CLOSE-FILES.
049100     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
049200 TERMINATE-CCVS.
049300S    EXIT PROGRAM.
049400STERMINATE-CALL.
049500     STOP     RUN.
049600 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
049700 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
049800 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
049900 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
050000     MOVE "****TEST DELETED****" TO RE-MARK.
050100 PRINT-DETAIL.
050200     IF REC-CT NOT EQUAL TO ZERO
050300             MOVE "." TO PARDOT-X
050400             MOVE REC-CT TO DOTVALUE.
050500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
050600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
050700        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
050800          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
050900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
051000     MOVE SPACE TO CORRECT-X.
051100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
051200     MOVE     SPACE TO RE-MARK.
051300 HEAD-ROUTINE.
051400     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
051500     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
051600     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
051700 COLUMN-NAMES-ROUTINE.
051800     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
051900     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
052000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
052100 END-ROUTINE.
052200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
052300 END-RTN-EXIT.
052400     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
052500 END-ROUTINE-1.
052600      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
052700      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
052800      ADD PASS-COUNTER TO ERROR-HOLD.
052900*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
053000      MOVE PASS-COUNTER TO CCVS-E-4-1.
053100      MOVE ERROR-HOLD TO CCVS-E-4-2.
053200      MOVE CCVS-E-4 TO CCVS-E-2-2.
053300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
053400  END-ROUTINE-12.
053500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
053600     IF       ERROR-COUNTER IS EQUAL TO ZERO
053700         MOVE "NO " TO ERROR-TOTAL
053800         ELSE
053900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
054000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
054100     PERFORM WRITE-LINE.
054200 END-ROUTINE-13.
054300     IF DELETE-CNT IS EQUAL TO ZERO
054400         MOVE "NO " TO ERROR-TOTAL  ELSE
054500         MOVE DELETE-CNT TO ERROR-TOTAL.
054600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
054700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
054800      IF   INSPECT-COUNTER EQUAL TO ZERO
054900          MOVE "NO " TO ERROR-TOTAL
055000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
055100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
055200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
055300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
055400 WRITE-LINE.
055500     ADD 1 TO RECORD-COUNT.
055600Y    IF RECORD-COUNT GREATER 50
055700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
055800Y        MOVE SPACE TO DUMMY-RECORD
055900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
056000Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
056100Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
056200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
056300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
056400Y        MOVE ZERO TO RECORD-COUNT.
056500     PERFORM WRT-LN.
056600 WRT-LN.
056700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
056800     MOVE SPACE TO DUMMY-RECORD.
056900 BLANK-LINE-PRINT.
057000     PERFORM WRT-LN.
057100 FAIL-ROUTINE.
057200     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
057300     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
057400     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
057500     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
057600     GO TO FAIL-ROUTINE-EX.
057700 FAIL-ROUTINE-WRITE.
057800     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
057900     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
058000 FAIL-ROUTINE-EX. EXIT.
058100 BAIL-OUT.
058200     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
058300     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
058400 BAIL-OUT-WRITE.
058500     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
058600     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
058700 BAIL-OUT-EX. EXIT.
058800 CCVS1-EXIT.
058900     EXIT.
059000 OUTPROC-EXIT SECTION 69.
059100 EXIT-ONLY.
059200     PERFORM  CLOSE-FILES.
