000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     DB203A.
000400 AUTHOR.
000500     FEDERAL COMPILER TESTING CENTER.
000600 INSTALLATION.
000700     GENERAL SERVICES ADMINISTRATION
000800     AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
000900     SOFTWARE DEVELOPMENT OFFICE.
001000     5203 LEESBURG PIKE  SUITE 1100
001100     FALLS CHURCH VIRGINIA 22041.
001200
001300     PHONE   (703) 756-6153
001400
001500     " HIGH       ".
001600 DATE-WRITTEN.
001700     CCVS-74 VERSION 4.0 - 1980 JULY 1.
001800     CREATION DATE     /    VALIDATION DATE
001900     "4.2 ".
002000 SECURITY.
002100     NONE.
002200*
002300*    *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
002400*
002500*                       PROGRAM ABSTRACT
002600*
002700*    DB203A TESTS THE CAPABILITY OF THE DEBUG MODULE TO HANDLE
002800*    DEBUGGING PROCEDURES WHICH ARE MONITORING I-O FUNCTIONS
002900*    OF THE RELATIVE I-O OR INDEXED I-O MODULES.  THIS PROGRAM
003000*    IS TO BE COMPILED AND EXECUTED WITH BOTH COMPILE AND OBJECT
003100*    TIME DEBUGGING SWITCHES ON.  THE DEBUGGING PROCEDURES
003200*    SHOULD BE INCLUDED IN COMPILATION AND GENERATE CODE.
003300*    DURING EXECUTION, A FILE IS ASSIGNED IN DYNAMIC MODE,
003400*    CREATED SEQUENTIALLY, AND ACCESSED BOTH SEQUENTIALLY
003500*    AND RANDOMLY.  ITS RECORDS ARE 80 CHARACTERS IN LENGTH.
003600*    EXECUTION OF "OPEN", "READ", "WRITE", "REWRITE", "START",
003700*    AND "DELETE" FUNCTIONS SHOULD TRIGGER THE APPROPRIATE
003800*    DEBUGGING PROCEDURES.
003900*
004000*
004100*
004200 ENVIRONMENT DIVISION.
004300 CONFIGURATION SECTION.
004400 SOURCE-COMPUTER.
004500     XXXXX082
004600         WITH DEBUGGING MODE.
004700 OBJECT-COMPUTER.
004800     XXXXX083.
004900 SPECIAL-NAMES.
005000     XXXXX056
005100*      XXXXX056  REPLACE WITH DISPLAY IMPLEMENTOR NAME
005200         IS THE-SYSTEM-PRINTER.
005300 INPUT-OUTPUT SECTION.
005400 FILE-CONTROL.
005500     SELECT PRINT-FILE ASSIGN TO
005600     XXXXX055.
005700     SELECT IND-FILE ASSIGN TO
005800     XXXXX024
005900J    XXXXX044
006000*      XXXXX044  REPLACE WITH INDEX-FILE-NAME (*OPT J ONLY)
006100     ORGANIZATION IS INDEXED
006200     ACCESS MODE IS DYNAMIC
006300     RECORD KEY IS IND-KEY.
006400 DATA DIVISION.
006500 FILE SECTION.
006600 FD  PRINT-FILE
006700     LABEL RECORDS
006800     XXXXX084
006900     DATA RECORD IS PRINT-REC DUMMY-RECORD.
007000 01  PRINT-REC PICTURE X(120).
007100 01  DUMMY-RECORD PICTURE X(120).
007200 FD  IND-FILE
007300C    VALUE OF
007400C    XXXXX074
007500*      XXXXX074  REPLACE WITH IMPLEMENTOR NAME (*OPT C ONLY)
007600C    IS
007700C    XXXXX075
007800*      XXXXX075  REPLACE WITH VALUE CLAUSE OBJECT (*OPT C ONLY)
007900G    XXXXX069
008000*      XXXXX069  REPLACE WITH ADDITIONAL INFO (*OPT G ONLY)
008100     LABEL RECORDS ARE STANDARD.
008200 01  IND-REC-1.
008300     02  FILLER PIC X(128).
008400     02  IND-KEY PIC XX.
008500     02  FILLER PIC X(110).
008600 01  IND-REC-2.
008700     02  IND-REC-1H PIC X(120).
008800     02  IND-REC-2H PIC X(120).
008900 WORKING-STORAGE SECTION.
009000 01  ITEM-1.
009100     02  KEY-1 PIC 99.
009200     02  LINE-1 PIC X(6).
009300     02  NAME-1 PIC X(30).
009400     02  UNQUAL-NAME-1 PIC X(30).
009500     02  CONTENTS-1.
009600         03  CONTENTS-1-1H PIC X(120).
009700         03  CONTENTS-1-2H PIC X(120).
009800     02  CONTENTS-REC.
009900         03  CONTENTS-REC-1H PIC X(120).
010000         03  CONTENTS-REC-2H PIC X(120).
010100 01  FILE-RECORD-INFORMATION-REC.
010200     03 FILE-RECORD-INFO-SKELETON.
010300        05 FILLER                 PICTURE X(48)       VALUE
010400             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
010500        05 FILLER                 PICTURE X(46)       VALUE
010600             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
010700        05 FILLER                 PICTURE X(26)       VALUE
010800             ",LFIL=000000,ORG=  ,LBLR= ".
010900        05 FILLER                 PICTURE X(37)       VALUE
011000             ",RECKEY=                             ".
011100        05 FILLER                 PICTURE X(38)       VALUE
011200             ",ALTKEY1=                             ".
011300        05 FILLER                 PICTURE X(38)       VALUE
011400             ",ALTKEY2=                             ".
011500        05 FILLER                 PICTURE X(7)        VALUE SPACE.
011600     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
011700        05 FILE-RECORD-INFO-P1-120.
011800           07 FILLER              PIC X(5).
011900           07 XFILE-NAME           PIC X(6).
012000           07 FILLER              PIC X(8).
012100           07 XRECORD-NAME         PIC X(6).
012200           07 FILLER              PIC X(1).
012300           07 REELUNIT-NUMBER     PIC 9(1).
012400           07 FILLER              PIC X(7).
012500           07 XRECORD-NUMBER       PIC 9(6).
012600           07 FILLER              PIC X(6).
012700           07 UPDATE-NUMBER       PIC 9(2).
012800           07 FILLER              PIC X(5).
012900           07 ODO-NUMBER          PIC 9(4).
013000           07 FILLER              PIC X(5).
013100           07 XPROGRAM-NAME        PIC X(5).
013200           07 FILLER              PIC X(7).
013300           07 XRECORD-LENGTH       PIC 9(6).
013400           07 FILLER              PIC X(7).
013500           07 CHARS-OR-RECORDS    PIC X(2).
013600           07 FILLER              PIC X(1).
013700           07 XBLOCK-SIZE          PIC 9(4).
013800           07 FILLER              PIC X(6).
013900           07 RECORDS-IN-FILE     PIC 9(6).
014000           07 FILLER              PIC X(5).
014100           07 XFILE-ORGANIZATION   PIC X(2).
014200           07 FILLER              PIC X(6).
014300           07 XLABEL-TYPE          PIC X(1).
014400        05 FILE-RECORD-INFO-P121-240.
014500           07 FILLER              PIC X(8).
014600           07 XRECORD-KEY          PIC X(29).
014700           07 FILLER              PIC X(9).
014800           07 ALTERNATE-KEY1      PIC X(29).
014900           07 FILLER              PIC X(9).
015000           07 ALTERNATE-KEY2      PIC X(29).
015100           07 FILLER              PIC X(7).
015200 01  TEST-RESULTS.
015300     02 FILLER                    PICTURE X VALUE SPACE.
015400     02 FEATURE                   PICTURE X(20) VALUE SPACE.
015500     02 FILLER                    PICTURE X VALUE SPACE.
015600     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
015700     02 FILLER                    PICTURE X  VALUE SPACE.
015800     02  PAR-NAME.
015900       03 FILLER PICTURE X(12) VALUE SPACE.
016000       03  PARDOT-X PICTURE X  VALUE SPACE.
016100       03 DOTVALUE PICTURE 99  VALUE ZERO.
016200       03 FILLER PIC X(5) VALUE SPACE.
016300     02 FILLER PIC X(10) VALUE SPACE.
016400     02 RE-MARK PIC X(61).
016500 01  TEST-COMPUTED.
016600     02 FILLER PIC X(30) VALUE SPACE.
016700     02 FILLER PIC X(17) VALUE "       COMPUTED=".
016800     02 COMPUTED-X.
016900     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
017000     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
017100     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
017200     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
017300     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
017400     03       CM-18V0 REDEFINES COMPUTED-A.
017500         04 COMPUTED-18V0                   PICTURE -9(18).
017600         04 FILLER                          PICTURE X.
017700     03 FILLER PIC X(50) VALUE SPACE.
017800 01  TEST-CORRECT.
017900     02 FILLER PIC X(30) VALUE SPACE.
018000     02 FILLER PIC X(17) VALUE "       CORRECT =".
018100     02 CORRECT-X.
018200     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
018300     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
018400     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
018500     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
018600     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
018700     03      CR-18V0 REDEFINES CORRECT-A.
018800         04 CORRECT-18V0                    PICTURE -9(18).
018900         04 FILLER                          PICTURE X.
019000     03 FILLER PIC X(50) VALUE SPACE.
019100 01  CCVS-C-1.
019200     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
019300-    "SS  PARAGRAPH-NAME
019400-    "        REMARKS".
019500     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
019600 01  CCVS-C-2.
019700     02 FILLER PICTURE IS X VALUE IS SPACE.
019800     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
019900     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
020000     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
020100     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
020200 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
020300 01  REC-CT PICTURE 99 VALUE ZERO.
020400 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
020500 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
020600 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
020700 01  PASS-COUNTER PIC 999 VALUE ZERO.
020800 01  TOTAL-ERROR PIC 999 VALUE ZERO.
020900 01  ERROR-HOLD PIC 999 VALUE ZERO.
021000 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
021100 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
021200 01  CCVS-H-1.
021300     02  FILLER   PICTURE X(27)  VALUE SPACE.
021400     02 FILLER PICTURE X(67) VALUE
021500     " FEDERAL COMPILER TESTING CENTER COBOL COMPILER VALIDATION
021600-    " SYSTEM".
021700     02  FILLER     PICTURE X(26)  VALUE SPACE.
021800 01  CCVS-H-2.
021900     02 FILLER PICTURE X(52) VALUE IS
022000     "CCVS74 NCC  COPY, NOT FOR DISTRIBUTION.".
022100     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
022200     02 TEST-ID PICTURE IS X(9).
022300     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
022400 01  CCVS-H-3.
022500     02  FILLER PICTURE X(34) VALUE
022600     " FOR OFFICIAL USE ONLY    ".
022700     02  FILLER PICTURE X(58) VALUE
022800     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022900     02  FILLER PICTURE X(28) VALUE
023000     "  COPYRIGHT   1974 ".
023100 01  CCVS-E-1.
023200     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
023300     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
023400     02 ID-AGAIN PICTURE IS X(9).
023500     02 FILLER PICTURE X(45) VALUE IS
023600     " NTIS DISTRIBUTION COBOL 74".
023700 01  CCVS-E-2.
023800     02  FILLER                   PICTURE X(31)  VALUE
023900     SPACE.
024000     02  FILLER                   PICTURE X(21)  VALUE SPACE.
024100     02 CCVS-E-2-2.
024200         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
024300         03 FILLER PICTURE IS X VALUE IS SPACE.
024400         03 ENDER-DESC PIC X(44) VALUE "ERRORS ENCOUNTERED".
024500 01  CCVS-E-3.
024600     02  FILLER PICTURE X(22) VALUE
024700     " FOR OFFICIAL USE ONLY".
024800     02  FILLER PICTURE X(12) VALUE SPACE.
024900     02  FILLER PICTURE X(58) VALUE
025000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025100     02  FILLER PICTURE X(13) VALUE SPACE.
025200     02 FILLER PIC X(15) VALUE " COPYRIGHT 1974".
025300 01  CCVS-E-4.
025400     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
025500     02 FILLER PIC XXXX VALUE " OF ".
025600     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
025700     02 FILLER PIC X(40) VALUE
025800      "  TESTS WERE EXECUTED SUCCESSFULLY".
025900 01  XXINFO.
026000     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
026100     02 INFO-TEXT.
026200     04 FILLER PIC X(20) VALUE SPACE.
026300     04 XXCOMPUTED PIC X(20).
026400     04 FILLER PIC X(5) VALUE SPACE.
026500     04 XXCORRECT PIC X(20).
026600 01  HYPHEN-LINE.
026700     02 FILLER PICTURE IS X VALUE IS SPACE.
026800     02 FILLER PICTURE IS X(65) VALUE IS "************************
026900-    "*****************************************".
027000     02 FILLER PICTURE IS X(54) VALUE IS "************************
027100-    "******************************".
027200 01  CCVS-PGM-ID PIC X(6) VALUE
027300     "DB203A".
027400 PROCEDURE DIVISION.
027500 DECLARATIVES.
027600 FILENAME-PROC SECTION.
027700     USE FOR DEBUGGING ON IND-FILE  IND-REC-1.
027800 FILENAME-1.
027900     MOVE 1 TO KEY-1.
028000     MOVE DEBUG-LINE TO LINE-1.
028100     MOVE DEBUG-NAME TO  NAME-1  UNQUAL-NAME-1.
028200     MOVE DEBUG-CONTENTS TO CONTENTS-1.
028300     INSPECT UNQUAL-NAME-1  REPLACING CHARACTERS
028400         BY SPACES AFTER INITIAL SPACE.
028500 END DECLARATIVES.
028600 CCVS1 SECTION.
028700 OPEN-FILES.
028800     OPEN     OUTPUT PRINT-FILE.
028900     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
029000     MOVE    SPACE TO TEST-RESULTS.
029100     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
029200     GO TO CCVS1-EXIT.
029300 CLOSE-FILES.
029400     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
029500 TERMINATE-CCVS.
029600S    EXIT PROGRAM.
029700STERMINATE-CALL.
029800     STOP     RUN.
029900 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
030000 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
030100 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
030200 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
030300     MOVE "****TEST DELETED****" TO RE-MARK.
030400 PRINT-DETAIL.
030500     IF REC-CT NOT EQUAL TO ZERO
030600             MOVE "." TO PARDOT-X
030700             MOVE REC-CT TO DOTVALUE.
030800     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
030900     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
031000        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
031100          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
031200     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
031300     MOVE SPACE TO CORRECT-X.
031400     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
031500     MOVE     SPACE TO RE-MARK.
031600 HEAD-ROUTINE.
031700     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031800     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
031900     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
032000 COLUMN-NAMES-ROUTINE.
032100     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
032200     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
032400 END-ROUTINE.
032500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
032600 END-RTN-EXIT.
032700     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032800 END-ROUTINE-1.
032900      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
033000      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
033100      ADD PASS-COUNTER TO ERROR-HOLD.
033200*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
033300      MOVE PASS-COUNTER TO CCVS-E-4-1.
033400      MOVE ERROR-HOLD TO CCVS-E-4-2.
033500      MOVE CCVS-E-4 TO CCVS-E-2-2.
033600      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
033700  END-ROUTINE-12.
033800      MOVE "TEST(S) FAILED" TO ENDER-DESC.
033900     IF       ERROR-COUNTER IS EQUAL TO ZERO
034000         MOVE "NO " TO ERROR-TOTAL
034100         ELSE
034200         MOVE ERROR-COUNTER TO ERROR-TOTAL.
034300     MOVE     CCVS-E-2 TO DUMMY-RECORD.
034400     PERFORM WRITE-LINE.
034500 END-ROUTINE-13.
034600     IF DELETE-CNT IS EQUAL TO ZERO
034700         MOVE "NO " TO ERROR-TOTAL  ELSE
034800         MOVE DELETE-CNT TO ERROR-TOTAL.
034900     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
035000     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035100      IF   INSPECT-COUNTER EQUAL TO ZERO
035200          MOVE "NO " TO ERROR-TOTAL
035300      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
035400      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
035500      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035600     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035700 WRITE-LINE.
035800     ADD 1 TO RECORD-COUNT.
035900Y    IF RECORD-COUNT GREATER 50
036000Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
036100Y        MOVE SPACE TO DUMMY-RECORD
036200Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
036300Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
036400Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
036500Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
036600Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
036700Y        MOVE ZERO TO RECORD-COUNT.
036800     PERFORM WRT-LN.
036900 WRT-LN.
037000     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
037100     MOVE SPACE TO DUMMY-RECORD.
037200 BLANK-LINE-PRINT.
037300     PERFORM WRT-LN.
037400 FAIL-ROUTINE.
037500     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
037600     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
037700     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
037800     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037900     GO TO FAIL-ROUTINE-EX.
038000 FAIL-ROUTINE-WRITE.
038100     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
038200     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
038300 FAIL-ROUTINE-EX. EXIT.
038400 BAIL-OUT.
038500     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
038600     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
038700 BAIL-OUT-WRITE.
038800     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
038900     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039000 BAIL-OUT-EX. EXIT.
039100 CCVS1-EXIT.
039200     EXIT.
039300 BEGIN-DB203A-TESTS SECTION.
039400 SET-UP-REC-AREA.
039500     MOVE FILE-RECORD-INFO-SKELETON TO FILE-RECORD-INFO (1).
039600     MOVE "IX-FD1" TO XFILE-NAME (1).
039700     MOVE "REC-1" TO XRECORD-NAME (1).
039800     MOVE ".XXX." TO XPROGRAM-NAME (1).
039900     MOVE 240 TO XRECORD-LENGTH (1).
040000     MOVE "RC" TO CHARS-OR-RECORDS (1).
040100     MOVE 1 TO XBLOCK-SIZE (1).
040200     MOVE 5 TO RECORDS-IN-FILE (1).
040300     MOVE "IX" TO XFILE-ORGANIZATION (1).
040400     MOVE "S" TO XLABEL-TYPE (1).
040500 OPEN-TEST-1-INIT.
040600     MOVE 0 TO KEY-1.
040700     MOVE "OPEN-TEST-1" TO PAR-NAME.
040800     MOVE "DEBUG OPEN OUTPUT" TO FEATURE.
040900 OPEN-TEST-1.
041000     OPEN OUTPUT IND-FILE.
041100     IF KEY-1 IS EQUAL TO 1
041200         PERFORM PASS
041300         MOVE "DEBUG PROC WAS EXECUTED" TO RE-MARK
041400     ELSE PERFORM FAIL
041500         MOVE "DEBUG PROC NOT EXECUTED" TO RE-MARK.
041600     PERFORM GEN-WRITE.
041700     GO TO WRITE-TEST-1-INIT.
041800 OPEN-TEST-1-DELETE.
041900     PERFORM DE-LETE.
042000     PERFORM GEN-WRITE.
042100 WRITE-TEST-1-INIT.
042200     MOVE 0 TO KEY-1.
042300     MOVE "WRITE-TEST-1" TO PAR-NAME.
042400     MOVE "DEBUG WRITE RECORD" TO FEATURE.
042500 WRITE-TEST-1.
042600     MOVE 1 TO XRECORD-NUMBER (1).
042700     MOVE FILE-RECORD-INFO (1) TO IND-REC-2.
042800     MOVE "02" TO IND-KEY.
042900     WRITE IND-REC-2 INVALID KEY GO TO ABORT-PGM.
043000     MOVE 2 TO XRECORD-NUMBER (1).
043100     MOVE FILE-RECORD-INFO (1) TO IND-REC-2.
043200     MOVE "04" TO IND-KEY.
043300     WRITE IND-REC-2 INVALID KEY GO TO ABORT-PGM.
043400     MOVE 3 TO XRECORD-NUMBER (1).
043500     MOVE FILE-RECORD-INFO (1) TO IND-REC-2.
043600     MOVE "06" TO IND-KEY.
043700     WRITE IND-REC-2 INVALID KEY GO TO ABORT-PGM.
043800     MOVE 4 TO XRECORD-NUMBER (1).
043900     MOVE FILE-RECORD-INFO (1) TO IND-REC-2.
044000     MOVE "08" TO IND-KEY.
044100     WRITE IND-REC-2 INVALID KEY GO TO ABORT-PGM.
044200     MOVE 5 TO XRECORD-NUMBER (1).
044300     MOVE FILE-RECORD-INFO (1) TO IND-REC-2.
044400     MOVE "10" TO IND-KEY.
044500     WRITE IND-REC-1 INVALID KEY GO TO ABORT-PGM.
044600     IF KEY-1 IS EQUAL TO 1
044700         PERFORM PASS
044800         MOVE "DEBUG PROC WAS EXECUTED" TO RE-MARK
044900     ELSE PERFORM FAIL
045000         MOVE "DEBUG PROC NOT EXECUTED" TO RE-MARK.
045100     PERFORM GEN-WRITE.
045200     GO TO CLOSE-TEST-1-INIT.
045300 WRITE-TEST-1-DELETE.
045400     PERFORM DE-LETE.
045500     PERFORM GEN-WRITE.
045600 CLOSE-TEST-1-INIT.
045700     MOVE 0 TO KEY-1.
045800     MOVE "CLOSE-TEST-1" TO PAR-NAME.
045900     MOVE "DEBUG CLOSE FILE" TO FEATURE.
046000 CLOSE-TEST-1.
046100     CLOSE IND-FILE.
046200     IF KEY-1 IS EQUAL TO 1
046300         PERFORM PASS
046400         MOVE "DEBUG PROC WAS EXECUTED" TO RE-MARK
046500     ELSE PERFORM FAIL
046600         MOVE "DEBUG PROC NOT EXECUTED" TO RE-MARK.
046700     PERFORM GEN-WRITE.
046800     GO TO OPEN-TEST-2-INIT.
046900 CLOSE-TEST-1-DELETE.
047000     PERFORM DE-LETE.
047100     PERFORM GEN-WRITE.
047200 OPEN-TEST-2-INIT.
047300     MOVE 0 TO KEY-1.
047400     MOVE "OPEN-TEST-2" TO PAR-NAME.
047500     MOVE "DEBUG OPEN I-O" TO FEATURE.
047600 OPEN-TEST-2.
047700     OPEN I-O IND-FILE.
047800     IF KEY-1 IS EQUAL TO 1
047900         PERFORM PASS
048000         MOVE "DEBUG PROC WAS EXECUTED" TO RE-MARK
048100     ELSE  PERFORM FAIL
048200         MOVE "DEBUG PROC NOT EXECUTED" TO RE-MARK.
048300     PERFORM GEN-WRITE.
048400     GO TO READ-TEST-1-INIT.
048500 OPEN-TEST-2-DELETE.
048600     PERFORM DE-LETE.
048700     PERFORM GEN-WRITE.
048800 READ-TEST-1-INIT.
048900     MOVE SPACES TO ITEM-1.
049000     MOVE 0 TO KEY-1.
049100     MOVE "READ-TEST-1" TO PAR-NAME.
049200     MOVE "DEBUG READ RANDOM" TO FEATURE.
049300 READ-TEST-1.
049400     MOVE "04" TO IND-KEY.
049500******************************************************************
049600*    THE DEBUG-LINE (INSPT) TEST NAMED IN THE OUTPUT REPORT AS   *
049700*    "READ-TEST-1A" SHOULD POINT TO THE EXECUTABLE STATEMENT     *
049800*    WHICH FOLLOWS THIS COMMENT SET AND WHICH READS, "READ       *
049900*    IND-FILE KEY IS IND-KEY INVALID KEY GO TO ABORT-PGM.".      *
050000******************************************************************
050100     READ IND-FILE  KEY IS IND-KEY
050200         INVALID KEY GO TO ABORT-PGM.
050300     IF KEY-1 IS EQUAL TO 1
050400         PERFORM PASS
050500         MOVE "DEBUG PROC WAS EXECUTED" TO RE-MARK
050600         PERFORM GEN-WRITE
050700         GO TO READ-TEST-1A
050800     ELSE  PERFORM FAIL
050900         MOVE "DEBUG PROC NOT EXECUTED" TO RE-MARK
051000         PERFORM GEN-WRITE
051100         PERFORM DELETE-READ-TEST-1-SUBTESTS
051200         GO TO REWRITE-TEST-1-INIT.
051300 READ-TEST-1-DELETE.
051400     PERFORM DE-LETE.
051500     PERFORM GEN-WRITE.
051600     PERFORM DELETE-READ-TEST-1-SUBTESTS.
051700     GO TO READ-TEST-2-INIT.
051800 DELETE-READ-TEST-1-SUBTESTS.
051900     MOVE "READ-TEST-1A" TO PAR-NAME.
052000     PERFORM DE-LETE.
052100     PERFORM GEN-WRITE.
052200     MOVE "READ-TEST-1B" TO PAR-NAME.
052300     PERFORM DE-LETE.
052400     PERFORM GEN-WRITE.
052500     MOVE "READ-TEST-1C" TO PAR-NAME.
052600     PERFORM DE-LETE.
052700     PERFORM GEN-WRITE.
052800 READ-TEST-1A.
052900     MOVE "READ-TEST-1A" TO PAR-NAME.
053000     MOVE "DEBUG-LINE; SEE NEXT LINE" TO RE-MARK.
053100     MOVE "<===  DEBUG-LINE" TO CORRECT-A.
053200     MOVE LINE-1 TO COMPUTED-A.
053300     PERFORM INSPT.
053400     PERFORM GEN-WRITE.
053500 READ-TEST-1B.
053600     MOVE "READ-TEST-1B" TO PAR-NAME.
053700     IF UNQUAL-NAME-1 IS EQUAL TO "IND-FILE"
053800         PERFORM PASS
053900     ELSE  PERFORM FAIL
054000         MOVE "IND-FILE" TO CORRECT-A
054100         MOVE NAME-1 TO COMPUTED-A.
054200     MOVE "DEBUG-NAME" TO RE-MARK.
054300     PERFORM GEN-WRITE.
054400 READ-TEST-1C.
054500     MOVE "READ-TEST-1C" TO PAR-NAME.
054600     MOVE "DEBUG-CONTENTS" TO RE-MARK.
054700     IF CONTENTS-1 IS EQUAL TO IND-REC-2
054800         PERFORM PASS
054900         PERFORM GEN-WRITE
055000         GO TO READ-TEST-2-INIT
055100     ELSE  PERFORM FAIL
055200         MOVE "LINES 1 AND 3 BELOW" TO COMPUTED-A
055300         MOVE "LINES 2 AND 4 BELOW" TO CORRECT-A.
055400     PERFORM GEN-WRITE.
055500     MOVE CONTENTS-1-1H TO PRINT-REC.
055600     PERFORM WRITE-LINE.
055700     MOVE IND-REC-1H TO PRINT-REC.
055800     PERFORM WRITE-LINE.
055900     MOVE CONTENTS-1-2H TO PRINT-REC.
056000     PERFORM WRITE-LINE.
056100     MOVE IND-REC-2H TO PRINT-REC.
056200     PERFORM WRITE-LINE.
056300 READ-TEST-2-INIT.
056400     MOVE SPACES TO ITEM-1.
056500     MOVE 0 TO KEY-1.
056600     MOVE "READ-TEST-2" TO PAR-NAME.
056700     MOVE "DEBUG READ INV KEY" TO FEATURE.
056800 READ-TEST-2.
056900     MOVE "05" TO IND-KEY.
057000     READ IND-FILE  KEY IS IND-KEY
057100         INVALID KEY  GO TO READ-TEST-2-CONT.
057200 READ-TEST-2-DELETE.
057300     PERFORM DE-LETE.
057400     PERFORM GEN-WRITE.
057500     GO TO REWRITE-TEST-1-INIT.
057600 READ-TEST-2-CONT.
057700     IF KEY-1 IS EQUAL TO 0
057800         PERFORM PASS
057900         MOVE "DEBUG PROC NOT EXECUTED" TO RE-MARK
058000     ELSE  PERFORM FAIL
058100         MOVE "DEBUG PROC WAS EXECUTED" TO RE-MARK.
058200     PERFORM GEN-WRITE.
058300 REWRITE-TEST-1-INIT.
058400     MOVE SPACES TO ITEM-1.
058500     MOVE 0 TO KEY-1.
058600     MOVE "REWRITE-TEST-1" TO PAR-NAME.
058700     MOVE "DEBUG REWRITE RECORD" TO FEATURE.
058800 REWRITE-TEST-1.
058900     MOVE 2 TO XRECORD-NUMBER (1).
059000     MOVE 1 TO UPDATE-NUMBER (1).
059100     MOVE FILE-RECORD-INFO (1) TO IND-REC-2.
059200     MOVE "04" TO IND-KEY.
059300     MOVE IND-REC-2 TO CONTENTS-REC.
059400******************************************************************
059500*    THE DEBUG-LINE (INSPT) TEST NAMED IN THE OUTPUT REPORT AS   *
059600*    "REWRITE-TEST-1A" SHOULD POINT TO THE EXECUTABLE STATEMENT  *
059700*    WHICH FOLLOWS THIS COMMENT SET AND WHICH READS,             *
059800*    "REWRITE IND-REC-1  INVALID KEY  GO TO ABORT-PGM.".         *
059900******************************************************************
060000     REWRITE IND-REC-1  INVALID KEY  GO TO ABORT-PGM.
060100     IF KEY-1 IS EQUAL TO 1
060200         PERFORM PASS
060300         MOVE "DEBUG PROC WAS EXECUTED" TO RE-MARK
060400         PERFORM GEN-WRITE
060500         GO TO REWRITE-TEST-1A
060600     ELSE  PERFORM FAIL
060700         MOVE "DEBUG PROC NOT EXECUTED" TO RE-MARK
060800         PERFORM GEN-WRITE
060900         PERFORM DELETE-REWRITE-TEST-1-SUBTESTS
061000         GO TO REWRITE-TEST-2-INIT.
061100 REWRITE-TEST-1-DELETE.
061200     PERFORM DE-LETE.
061300     PERFORM GEN-WRITE.
061400     PERFORM DELETE-REWRITE-TEST-1-SUBTESTS.
061500     GO TO REWRITE-TEST-2-INIT.
061600 DELETE-REWRITE-TEST-1-SUBTESTS.
061700     MOVE "REWRITE-TEST-1A" TO PAR-NAME.
061800     PERFORM DE-LETE.
061900     PERFORM GEN-WRITE.
062000     MOVE "REWRITE-TEST-1B" TO PAR-NAME.
062100     PERFORM DE-LETE.
062200     PERFORM GEN-WRITE.
062300     MOVE "REWRITE-TEST-1C" TO PAR-NAME.
062400     PERFORM DE-LETE.
062500     PERFORM GEN-WRITE.
062600 REWRITE-TEST-1A.
062700     MOVE "REWRITE-TEST-1A" TO PAR-NAME.
062800     MOVE "DEBUG-LINE; SEE NEXT LINE" TO RE-MARK.
062900     MOVE "<===  DEBUG-LINE" TO CORRECT-A.
063000     MOVE LINE-1 TO COMPUTED-A.
063100     PERFORM INSPT.
063200     PERFORM GEN-WRITE.
063300 REWRITE-TEST-1B.
063400     MOVE "REWRITE-TEST-1B" TO PAR-NAME.
063500     IF UNQUAL-NAME-1 IS EQUAL TO "IND-REC-1"
063600         PERFORM PASS
063700     ELSE  PERFORM FAIL
063800         MOVE "IND-REC-1" TO CORRECT-A
063900         MOVE NAME-1 TO COMPUTED-A.
064000     MOVE "DEBUG-NAME" TO RE-MARK.
064100     PERFORM GEN-WRITE.
064200 REWRITE-TEST-1C.
064300     MOVE "DEBUG-CONTENTS" TO RE-MARK.
064400     MOVE "REWRITE-TEST-1C" TO PAR-NAME.
064500     IF CONTENTS-1 IS EQUAL TO CONTENTS-REC
064600         PERFORM PASS
064700         PERFORM GEN-WRITE
064800         GO TO REWRITE-TEST-2-INIT
064900     ELSE  PERFORM FAIL
065000         MOVE "LINES 1 AND 3 BELOW" TO COMPUTED-A
065100         MOVE "LINES 2 AND 4 BELOW" TO CORRECT-A
065200         PERFORM GEN-WRITE.
065300     MOVE CONTENTS-1-1H TO PRINT-REC.
065400     PERFORM WRITE-LINE.
065500     MOVE CONTENTS-REC-1H TO PRINT-REC.
065600     PERFORM WRITE-LINE.
065700     MOVE CONTENTS-1-2H TO PRINT-REC.
065800     PERFORM WRITE-LINE.
065900     MOVE CONTENTS-REC-2H TO PRINT-REC.
066000     PERFORM WRITE-LINE.
066100 REWRITE-TEST-2-INIT.
066200     MOVE SPACES TO ITEM-1.
066300     MOVE 0 TO KEY-1.
066400     MOVE "REWRITE-TEST-2" TO PAR-NAME.
066500     MOVE "DEBUG REWRITE INVLID" TO FEATURE.
066600 REWRITE-TEST-2.
066700     MOVE 6 TO XRECORD-NUMBER (1).
066800     MOVE 1 TO UPDATE-NUMBER (1).
066900     MOVE FILE-RECORD-INFO (1) TO IND-REC-2.
067000     MOVE "03" TO IND-KEY.
067100     REWRITE IND-REC-1  INVALID KEY  GO TO REWRITE-TEST-2-CONT.
067200 REWRITE-TEST-2-DELETE.
067300     PERFORM DE-LETE.
067400     PERFORM GEN-WRITE.
067500     GO TO START-TEST-1-INIT.
067600 REWRITE-TEST-2-CONT.
067700     IF KEY-1 IS EQUAL TO 1
067800         PERFORM PASS
067900         MOVE "DEBUG PROC WAS EXECUTED" TO RE-MARK
068000     ELSE  PERFORM FAIL
068100         MOVE "DEBUG PROC NOT EXECUTED" TO RE-MARK.
068200     PERFORM GEN-WRITE.
068300 START-TEST-1-INIT.
068400     MOVE SPACES TO ITEM-1.
068500     MOVE 0 TO KEY-1.
068600     MOVE "START-TEST-1" TO PAR-NAME.
068700     MOVE "DEBUG START FILENAME" TO FEATURE.
068800 START-TEST-1.
068900     MOVE "05" TO IND-KEY.
069000     START IND-FILE  KEY IS GREATER THAN IND-KEY
069100         INVALID KEY  GO TO ABORT-PGM.
069200     IF KEY-1 IS EQUAL TO 1
069300         PERFORM PASS
069400         MOVE "DEBUG PROC WAS EXECUTED" TO RE-MARK
069500         PERFORM GEN-WRITE
069600         GO TO START-TEST-1A
069700     ELSE  PERFORM FAIL
069800         MOVE "DEBUG PROC NOT EXECUTED" TO RE-MARK
069900         PERFORM GEN-WRITE
070000         PERFORM DELETE-START-TEST-1-SUBTEST
070100         GO TO START-TEST-2-INIT.
070200 START-TEST-1-DELETE.
070300     PERFORM DE-LETE.
070400     PERFORM GEN-WRITE.
070500     PERFORM DELETE-START-TEST-1-SUBTEST.
070600     GO TO START-TEST-2-INIT.
070700 DELETE-START-TEST-1-SUBTEST.
070800     MOVE "START-TEST-1A" TO PAR-NAME.
070900     PERFORM DE-LETE.
071000     PERFORM GEN-WRITE.
071100 START-TEST-1A.
071200     MOVE "START-TEST-1A" TO PAR-NAME.
071300     IF CONTENTS-1 IS EQUAL TO SPACES
071400         PERFORM PASS
071500     ELSE  PERFORM FAIL
071600         MOVE CONTENTS-1 TO COMPUTED-A
071700         MOVE "(SPACES)" TO CORRECT-A.
071800     MOVE "DEBUG-CONTENTS" TO RE-MARK.
071900     PERFORM GEN-WRITE.
072000 START-TEST-2-INIT.
072100     MOVE 0 TO KEY-1.
072200     MOVE "START-TEST-2" TO PAR-NAME.
072300     MOVE "DEBUG START INV KEY" TO FEATURE.
072400 START-TEST-2.
072500     MOVE "12" TO IND-KEY.
072600     START IND-FILE  KEY IS GREATER THAN IND-KEY
072700         INVALID KEY  GO TO START-TEST-2-CONT.
072800 START-TEST-2-DELETE.
072900     PERFORM DE-LETE.
073000     PERFORM GEN-WRITE.
073100     GO TO DELETE-TEST-1-INIT.
073200 START-TEST-2-CONT.
073300     IF KEY-1 IS EQUAL TO 1
073400         PERFORM PASS
073500         MOVE "DEBUG PROC WAS EXECUTED" TO RE-MARK
073600     ELSE  PERFORM FAIL
073700         MOVE "DEBUG PROC NOT EXECUTED" TO RE-MARK.
073800     PERFORM GEN-WRITE.
073900 DELETE-TEST-1-INIT.
074000     MOVE SPACES TO ITEM-1.
074100     MOVE 0 TO KEY-1.
074200     MOVE "DELETE-TEST-1" TO PAR-NAME.
074300     MOVE "DEBUG DELETE FILE" TO FEATURE.
074400 DELETE-TEST-1.
074500     MOVE "06" TO IND-KEY.
074600     DELETE IND-FILE INVALID KEY GO TO ABORT-PGM.
074700     IF KEY-1 IS EQUAL TO 1
074800         PERFORM PASS
074900         MOVE "DEBUG PROC WAS EXECUTED" TO RE-MARK
075000         PERFORM GEN-WRITE
075100         GO TO DELETE-TEST-1A
075200     ELSE  PERFORM FAIL
075300         MOVE "DEBUG PROC NOT EXECUTED" TO RE-MARK
075400         PERFORM GEN-WRITE
075500         PERFORM DELETE-DELETE-TEST-1-SUBTEST
075600         GO TO DELETE-TEST-2-INIT.
075700 DELETE-TEST-1-DELETE.
075800     PERFORM DE-LETE.
075900     PERFORM GEN-WRITE.
076000     PERFORM DELETE-DELETE-TEST-1-SUBTEST.
076100     GO TO DELETE-TEST-2-INIT.
076200 DELETE-DELETE-TEST-1-SUBTEST.
076300     MOVE "DELETE-TEST-1A" TO PAR-NAME.
076400     PERFORM DE-LETE.
076500     PERFORM GEN-WRITE.
076600 DELETE-TEST-1A.
076700     MOVE "DELETE-TEST-1A" TO PAR-NAME.
076800     IF CONTENTS-1 IS EQUAL TO SPACES
076900         PERFORM PASS
077000     ELSE  PERFORM FAIL
077100         MOVE "(SPACES)" TO CORRECT-A
077200         MOVE CONTENTS-1 TO COMPUTED-A.
077300     MOVE "DEBUG-CONTENTS" TO RE-MARK.
077400     PERFORM GEN-WRITE.
077500 DELETE-TEST-2-INIT.
077600     MOVE "DELETE-TEST-2" TO PAR-NAME.
077700     MOVE "DEBUG DELETE INV KEY" TO FEATURE.
077800     MOVE 0 TO KEY-1.
077900 DELETE-TEST-2.
078000     MOVE "07" TO IND-KEY.
078100     DELETE IND-FILE INVALID KEY GO TO DELETE-TEST-2-CONT.
078200 DELETE-TEST-2-DELETE.
078300     PERFORM DE-LETE.
078400     PERFORM GEN-WRITE.
078500     GO TO CLOSE-IND-FILE.
078600 DELETE-TEST-2-CONT.
078700     IF KEY-1 IS EQUAL TO 1
078800         PERFORM PASS
078900         MOVE "DEBUG PROC WAS EXECUTED" TO RE-MARK
079000     ELSE  PERFORM FAIL
079100         MOVE "DEBUG PROC NOT EXECUTED" TO RE-MARK.
079200     PERFORM GEN-WRITE.
079300     GO TO CLOSE-IND-FILE.
079400 GEN-WRITE.
079500     PERFORM PRINT-DETAIL.
079600 ABORT-PGM.
079700     DISPLAY "INDEXED I-O MODULE - FILE HANDLING ERROR - PROGRAM A
079800-            "BORTED."  UPON THE-SYSTEM-PRINTER.
079900 CLOSE-IND-FILE.
080000     CLOSE IND-FILE.
080100XOPEN-IND-FILE.
080200X    OPEN INPUT IND-FILE.
080300X    MOVE SPACES TO PRINT-REC.
080400X    PERFORM WRITE-LINE.
080500X    MOVE " DUMP OF IND-FILE FOLLOWS" TO PRINT-REC.
080600X    PERFORM WRITE-LINE.
080700XREAD-IND-FILE.
080800X    READ IND-FILE NEXT RECORD  AT END GO TO CLOSE-FILE-DUMP.
080900X    MOVE IND-REC-1H TO PRINT-REC.
081000X    PERFORM WRITE-LINE.
081100X    MOVE IND-REC-2H TO PRINT-REC.
081200X    PERFORM WRITE-LINE.
081300X    GO TO READ-IND-FILE.
081400XCLOSE-FILE-DUMP.
081500X    CLOSE IND-FILE.
081600 CCVS-EXIT SECTION.
081700 CCVS-999999.
081800     GO TO CLOSE-FILES.
