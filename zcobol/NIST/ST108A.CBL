000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST108A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*    ST108 IS A COMPLETELY SELF-CONTAINED PROGRAM.  THE INPUT
002200*    PROCEDURE BUILDS THE EIGHT-RECORD FILE SHOWN BELOW. THE
002300*    OUTPUT PROCEDURE CHECKS THE SORTED FILE AND GENERATES THE
002400*    REPORT.
002500*    SORT    SORT    SORT    SORT    SORT   SORT     SORT    SORT
002600*    KEY-1   KEY-2   KEY-3   KEY-4   KEY-5  KEY-6    KEY-7   KEY-8
002700*    S9(6)   A(5)    SV9(16) X(10)   A(20)  X(10)    999     S99
002800*    USAGE   JUST            JUST                            USAGE
002900*    COMP    RIGHT           RIGHT                           COMP
003000*
003100*    +123456     BBB -.1234   BBBBBB A      AAAAAAAA 501     +99
003200*    -054321       X -.1234   BBBBBB A      AAAAAAAA 501     +99
003300*    -054321     BBB +.6      BBBBBB A      AAAAAAAA 501     +99
003400*    -054321     BBB -.1234        X A      AAAAAAAA 501     +99
003500*    -054321     BBB -.1234   BBBBBB Z      AAAAAAAA 501     +99
003600*    -054321     BBB -.1234   BBBBBB A      Z        501     +99
003700*    -054321     BBB -.1234   BBBBBB A      AAAAAAAA 418     +99
003800*    -054321     BBB -.1234   BBBBBB A      AAAAAAAA 501     -14
003900*
004000*    THIS PROGRAM CHECKS THE COMPILER"S ABILITY TO HANDLE EIGHT
004100*    ASCENDING KEYS IN ONE FILE.
004200
004300 ENVIRONMENT DIVISION.
004400 CONFIGURATION SECTION.
004500 SOURCE-COMPUTER.
004600     XXXXX082.
004700 OBJECT-COMPUTER.
004800     XXXXX083.
004900 INPUT-OUTPUT SECTION.
005000 FILE-CONTROL.
005100     SELECT PRINT-FILE ASSIGN TO
005200     XXXXX055.
005300     SELECT   SORTFILE-1H ASSIGN TO
005400     XXXXX027.
005500 DATA DIVISION.
005600 FILE SECTION.
005700 FD  PRINT-FILE.
005800 01  PRINT-REC PICTURE X(120).
005900 01  DUMMY-RECORD PICTURE X(120).
006000 SD  SORTFILE-1H
006100     DATA RECORD IS SORTFILE-REC.
006200 01  SORTFILE-REC.
006300     02 SORTKEY-8       PICTURE S99 COMPUTATIONAL.
006400     02 SORTKEY-1       PICTURE S9(6) COMPUTATIONAL.
006500     02 SORTKEY-7       PICTURE 999.
006600     02 SORTKEY-3       PICTURE SV9(16).
006700     02 FILLER          PICTURE XX.
006800     02 SORTKEY-4       PICTURE X(10) JUSTIFIED RIGHT.
006900     02 SORTKEY-6       PICTURE X(10).
007000     02 SORTKEY-2       PICTURE A(05) JUSTIFIED RIGHT.
007100     02 SORTKEY-5       PICTURE A(20).
007200     02 FILLER          PICTURE XXX.
007300 WORKING-STORAGE SECTION.
007400 77  UTIL-CTR           PICTURE S99999.
007500 77  SPAC-E             PICTURE X VALUE " ".
007600 01  TEST-RESULTS.
007700     02 FILLER                   PIC X      VALUE SPACE.
007800     02 FEATURE                  PIC X(20)  VALUE SPACE.
007900     02 FILLER                   PIC X      VALUE SPACE.
008000     02 P-OR-F                   PIC X(5)   VALUE SPACE.
008100     02 FILLER                   PIC X      VALUE SPACE.
008200     02  PAR-NAME.
008300       03 FILLER                 PIC X(19)  VALUE SPACE.
008400       03  PARDOT-X              PIC X      VALUE SPACE.
008500       03 DOTVALUE               PIC 99     VALUE ZERO.
008600     02 FILLER                   PIC X(8)   VALUE SPACE.
008700     02 RE-MARK                  PIC X(61).
008800 01  TEST-COMPUTED.
008900     02 FILLER                   PIC X(30)  VALUE SPACE.
009000     02 FILLER                   PIC X(17)  VALUE
009100            "       COMPUTED=".
009200     02 COMPUTED-X.
009300     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
009400     03 COMPUTED-N               REDEFINES COMPUTED-A
009500                                 PIC -9(9).9(9).
009600     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
009700     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
009800     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
009900     03       CM-18V0 REDEFINES COMPUTED-A.
010000         04 COMPUTED-18V0                    PIC -9(18).
010100         04 FILLER                           PIC X.
010200     03 FILLER PIC X(50) VALUE SPACE.
010300 01  TEST-CORRECT.
010400     02 FILLER PIC X(30) VALUE SPACE.
010500     02 FILLER PIC X(17) VALUE "       CORRECT =".
010600     02 CORRECT-X.
010700     03 CORRECT-A                  PIC X(20) VALUE SPACE.
010800     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
010900     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
011000     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
011100     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
011200     03      CR-18V0 REDEFINES CORRECT-A.
011300         04 CORRECT-18V0                     PIC -9(18).
011400         04 FILLER                           PIC X.
011500     03 FILLER PIC X(2) VALUE SPACE.
011600     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
011700 01  CCVS-C-1.
011800     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
011900-    "SS  PARAGRAPH-NAME
012000-    "       REMARKS".
012100     02 FILLER                     PIC X(20)    VALUE SPACE.
012200 01  CCVS-C-2.
012300     02 FILLER                     PIC X        VALUE SPACE.
012400     02 FILLER                     PIC X(6)     VALUE "TESTED".
012500     02 FILLER                     PIC X(15)    VALUE SPACE.
012600     02 FILLER                     PIC X(4)     VALUE "FAIL".
012700     02 FILLER                     PIC X(94)    VALUE SPACE.
012800 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
012900 01  REC-CT                        PIC 99       VALUE ZERO.
013000 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
013100 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
013200 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
013300 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
013400 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
013500 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
013600 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
013700 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
013800 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
013900 01  CCVS-H-1.
014000     02  FILLER                    PIC X(39)    VALUE SPACES.
014100     02  FILLER                    PIC X(42)    VALUE
014200     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
014300     02  FILLER                    PIC X(39)    VALUE SPACES.
014400 01  CCVS-H-2A.
014500   02  FILLER                        PIC X(40)  VALUE SPACE.
014600   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
014700   02  FILLER                        PIC XXXX   VALUE
014800     "4.2 ".
014900   02  FILLER                        PIC X(28)  VALUE
015000            " COPY - NOT FOR DISTRIBUTION".
015100   02  FILLER                        PIC X(41)  VALUE SPACE.
015200
015300 01  CCVS-H-2B.
015400   02  FILLER                        PIC X(15)  VALUE
015500            "TEST RESULT OF ".
015600   02  TEST-ID                       PIC X(9).
015700   02  FILLER                        PIC X(4)   VALUE
015800            " IN ".
015900   02  FILLER                        PIC X(12)  VALUE
016000     " HIGH       ".
016100   02  FILLER                        PIC X(22)  VALUE
016200            " LEVEL VALIDATION FOR ".
016300   02  FILLER                        PIC X(58)  VALUE
016400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
016500 01  CCVS-H-3.
016600     02  FILLER                      PIC X(34)  VALUE
016700            " FOR OFFICIAL USE ONLY    ".
016800     02  FILLER                      PIC X(58)  VALUE
016900     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
017000     02  FILLER                      PIC X(28)  VALUE
017100            "  COPYRIGHT   1985 ".
017200 01  CCVS-E-1.
017300     02 FILLER                       PIC X(52)  VALUE SPACE.
017400     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
017500     02 ID-AGAIN                     PIC X(9).
017600     02 FILLER                       PIC X(45)  VALUE SPACES.
017700 01  CCVS-E-2.
017800     02  FILLER                      PIC X(31)  VALUE SPACE.
017900     02  FILLER                      PIC X(21)  VALUE SPACE.
018000     02 CCVS-E-2-2.
018100         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
018200         03 FILLER                   PIC X      VALUE SPACE.
018300         03 ENDER-DESC               PIC X(44)  VALUE
018400            "ERRORS ENCOUNTERED".
018500 01  CCVS-E-3.
018600     02  FILLER                      PIC X(22)  VALUE
018700            " FOR OFFICIAL USE ONLY".
018800     02  FILLER                      PIC X(12)  VALUE SPACE.
018900     02  FILLER                      PIC X(58)  VALUE
019000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
019100     02  FILLER                      PIC X(13)  VALUE SPACE.
019200     02 FILLER                       PIC X(15)  VALUE
019300             " COPYRIGHT 1985".
019400 01  CCVS-E-4.
019500     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
019600     02 FILLER                       PIC X(4)   VALUE " OF ".
019700     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
019800     02 FILLER                       PIC X(40)  VALUE
019900      "  TESTS WERE EXECUTED SUCCESSFULLY".
020000 01  XXINFO.
020100     02 FILLER                       PIC X(19)  VALUE
020200            "*** INFORMATION ***".
020300     02 INFO-TEXT.
020400       04 FILLER                     PIC X(8)   VALUE SPACE.
020500       04 XXCOMPUTED                 PIC X(20).
020600       04 FILLER                     PIC X(5)   VALUE SPACE.
020700       04 XXCORRECT                  PIC X(20).
020800     02 INF-ANSI-REFERENCE           PIC X(48).
020900 01  HYPHEN-LINE.
021000     02 FILLER  PIC IS X VALUE IS SPACE.
021100     02 FILLER  PIC IS X(65)    VALUE IS "************************
021200-    "*****************************************".
021300     02 FILLER  PIC IS X(54)    VALUE IS "************************
021400-    "******************************".
021500 01  CCVS-PGM-ID                     PIC X(9)   VALUE
021600     "ST108A".
021700 PROCEDURE DIVISION.
021800 SORT-PARA SECTION.
021900 SORT-PARAGRAPH.
022000     SORT     SORTFILE-1H ON
022100              ASCENDING KEY SORTKEY-1
022200              ASCENDING SORTKEY-2
022300              ASCENDING SORTKEY-3
022400              ASCENDING SORTKEY-4
022500              ASCENDING SORTKEY-5
022600              ASCENDING SORTKEY-6
022700              ASCENDING SORTKEY-7
022800              ASCENDING SORTKEY-8
022900              INPUT PROCEDURE INPROC
023000              OUTPUT PROCEDURE OUTPROC THRU OUTPROC-EXIT.
023100     STOP     RUN.
023200 INPROC SECTION.
023300 BUILD-FILE.
023400     PERFORM  BUILD-RECORD.
023500     MOVE     +123456             TO SORTKEY-1.
023600     PERFORM  RELEASE-RECORD.
023700     PERFORM  BUILD-RECORD.
023800     MOVE     "X"                 TO SORTKEY-2.
023900     PERFORM  RELEASE-RECORD.
024000     PERFORM  BUILD-RECORD.
024100     MOVE     +.6                 TO SORTKEY-3.
024200     PERFORM  RELEASE-RECORD.
024300     PERFORM  BUILD-RECORD.
024400     MOVE     "X"                 TO SORTKEY-4.
024500     PERFORM  RELEASE-RECORD.
024600     PERFORM  BUILD-RECORD.
024700     MOVE     "Z"                 TO SORTKEY-5.
024800     PERFORM  RELEASE-RECORD.
024900     PERFORM  BUILD-RECORD.
025000     MOVE     "Z"                 TO SORTKEY-6.
025100     PERFORM  RELEASE-RECORD.
025200     PERFORM  BUILD-RECORD.
025300     MOVE     +418                TO SORTKEY-7.
025400     PERFORM  RELEASE-RECORD.
025500     PERFORM  BUILD-RECORD.
025600     MOVE     -14                 TO SORTKEY-8.
025700     PERFORM  RELEASE-RECORD.
025800     GO       TO BUILD-EXIT.
025900 BUILD-RECORD.
026000     MOVE     -054321             TO SORTKEY-1.
026100     MOVE     "BBB"               TO SORTKEY-2.
026200     MOVE     -.1234567890123456  TO SORTKEY-3.
026300     MOVE     "BBBBBB"            TO SORTKEY-4.
026400     MOVE     "A"                 TO SORTKEY-5.
026500     MOVE     "AAAAAAAA"          TO SORTKEY-6.
026600     MOVE     -501                TO SORTKEY-7.
026700*       NOTE THIS ITEM IS INTENTIONALLY MOVED TO AN UNSIGNED
026800*             FIELD.
026900     MOVE     +99                 TO SORTKEY-8.
027000 RELEASE-RECORD.
027100     RELEASE  SORTFILE-REC.
027200 BUILD-EXIT.
027300     EXIT.
027400 OUTPROC SECTION.
027500 OPEN-FILES.
027600     OPEN     OUTPUT PRINT-FILE.
027700     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
027800     MOVE    SPACE TO TEST-RESULTS.
027900     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
028000     IF       SPAC-E IS LESS THAN "B"
028100              GO TO SPACE-IS-LESS-THAN-B.
028200 B-IS-LESS-THAN-SPACE SECTION.
028300 SORT-INIT-A.
028400     MOVE     "SORT - 8 ASC. KEYS" TO FEATURE.
028500*        NOTE THE RECORDS SHOULD BE SORTED INTO THE FOLLOWING
028600*             ORDER --- 8 7 6 5 4 3 1 2 --- THAT IS,
028700*             THE 8TH RECORD SORTS UP TO THE 1ST POSITION,
028800*             THE 7TH RECORD SORTS UP TO THE 2ND POSITION, ETC.
028900 SORT-TEST-1.
029000     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
029100     IF       SORTKEY-7 EQUAL TO 418
029200              PERFORM PASS GO TO SORT-WRITE-1.
029300 SORT-FAIL-1.
029400     PERFORM  FAIL.
029500     MOVE     SORTKEY-7 TO COMPUTED-N.
029600     MOVE     418 TO CORRECT-N.
029700 SORT-WRITE-1.
029800     MOVE     "SORT-TEST-1 " TO PAR-NAME.
029900     PERFORM  PRINT-DETAIL.
030000 SORT-TEST-2.
030100     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
030200     IF       SORTKEY-8 EQUAL TO -14
030300              PERFORM PASS GO TO SORT-WRITE-2.
030400 SORT-FAIL-2.
030500     PERFORM  FAIL.
030600     MOVE     SORTKEY-8 TO COMPUTED-N.
030700     MOVE     -14 TO CORRECT-N.
030800 SORT-WRITE-2.
030900     MOVE     "SORT-TEST-2 " TO PAR-NAME.
031000     PERFORM  PRINT-DETAIL.
031100 SORT-TEST-3.
031200     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
031300     IF       SORTKEY-6 EQUAL TO "Z         "
031400              PERFORM PASS GO TO SORT-WRITE-3.
031500 SORT-FAIL-3.
031600     PERFORM  FAIL.
031700     MOVE     SORTKEY-6 TO COMPUTED-A.
031800     MOVE     "Z         "           TO CORRECT-A.
031900 SORT-WRITE-3.
032000     MOVE     "SORT-TEST-3 " TO PAR-NAME.
032100     PERFORM  PRINT-DETAIL.
032200 SORT-TEST-4.
032300     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
032400     IF       SORTKEY-5 EQUAL TO "Z                   "
032500              PERFORM PASS GO TO SORT-WRITE-4.
032600 SORT-FAIL-4.
032700     PERFORM  FAIL.
032800     MOVE     SORTKEY-5 TO COMPUTED-A.
032900     MOVE     "Z                   " TO CORRECT-A.
033000 SORT-WRITE-4.
033100     MOVE     "SORT-TEST-4 " TO PAR-NAME.
033200     PERFORM  PRINT-DETAIL.
033300 SORT-TEST-5.
033400     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
033500     IF       SORTKEY-4 EQUAL TO "         X"
033600              PERFORM PASS GO TO SORT-WRITE-5.
033700 SORT-FAIL-5.
033800     PERFORM  FAIL.
033900     MOVE     SORTKEY-4 TO COMPUTED-A.
034000     MOVE     "         X"           TO CORRECT-A.
034100 SORT-WRITE-5.
034200     MOVE     "SORT-TEST-5 " TO PAR-NAME.
034300     PERFORM  PRINT-DETAIL.
034400 SORT-TEST-6.
034500     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
034600     IF       SORTKEY-3 EQUAL TO +.6000000000000000
034700              PERFORM PASS GO TO SORT-WRITE-6.
034800 SORT-FAIL-6.
034900     PERFORM  FAIL.
035000     MOVE     SORTKEY-3 TO COMPUTED-0V18.
035100     MOVE     +.6000000000000000     TO CORRECT-0V18.
035200 SORT-WRITE-6.
035300     MOVE     "SORT-TEST-6 " TO PAR-NAME.
035400     PERFORM  PRINT-DETAIL.
035500 SORT-TEST-7.
035600     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
035700     IF       SORTKEY-2 EQUAL TO "    X"
035800              PERFORM PASS GO TO SORT-WRITE-7.
035900 SORT-FAIL-7.
036000     PERFORM  FAIL.
036100     MOVE     SORTKEY-2 TO COMPUTED-A.
036200     MOVE     "    X" TO CORRECT-A.
036300 SORT-WRITE-7.
036400     MOVE     "SORT-TEST-7 " TO PAR-NAME.
036500     PERFORM  PRINT-DETAIL.
036600 SORT-TEST-8.
036700     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
036800     IF       SORTKEY-1 EQUAL TO +123456
036900              PERFORM PASS GO TO SORT-WRITE-8.
037000 SORT-FAIL-8.
037100     PERFORM  FAIL.
037200     MOVE     SORTKEY-1 TO COMPUTED-N.
037300     MOVE     +123456 TO CORRECT-N.
037400 SORT-WRITE-8.
037500     MOVE     "SORT-TEST-8 " TO PAR-NAME.
037600     PERFORM  PRINT-DETAIL.
037700 SORT-REMARK-A.
037800     MOVE     SPACE TO FEATURE.
037900     MOVE     "THE COLLATING SEQUENCE" TO RE-MARK.
038000     PERFORM  PRINT-DETAIL.
038100     MOVE     "RENDERS TESTS 9 THRU 16" TO RE-MARK.
038200     PERFORM  PRINT-DETAIL.
038300     MOVE     "UNNECESSARY." TO RE-MARK.
038400     PERFORM  PRINT-DETAIL.
038500     MOVE     "SORT - 8 ASC. KEYS" TO FEATURE.
038600     GO       TO CONTINUE-TESTING.
038700 SPACE-IS-LESS-THAN-B SECTION.
038800 SORT-REMARK-B.
038900     MOVE     "THE COLLATING SEQUENCE" TO RE-MARK.
039000     PERFORM  PRINT-DETAIL.
039100     MOVE     "RENDERS TESTS 1 THRU 8" TO RE-MARK.
039200     PERFORM  PRINT-DETAIL.
039300     MOVE     "UNNECESSARY." TO RE-MARK.
039400     PERFORM  PRINT-DETAIL.
039500     MOVE     "SORT - 8 ASC. KEYS" TO FEATURE.
039600*        NOTE THE RECORDS SHOULD BE SORTED INTO THE FOLLOWING
039700*             ORDER --- 8 1 7 2 6 5 3 4 --- THAT IS,
039800*             THE 1ST RECORD IS SORTED DOWN TO THE 8TH POSITION,
039900*             THE 2ND RECORD SORTS UP TO THE 1ST POSITION, ETC.
040000 SORT-TEST-9.
040100     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
040200     IF       SORTKEY-2 EQUAL TO "    X"
040300              PERFORM PASS GO TO SORT-WRITE-9.
040400 SORT-FAIL-9.
040500     PERFORM  FAIL.
040600     MOVE     SORTKEY-2 TO COMPUTED-A.
040700     MOVE     "    X" TO CORRECT-A.
040800 SORT-WRITE-9.
040900     MOVE     "SORT-TEST-9 " TO PAR-NAME.
041000     PERFORM  PRINT-DETAIL.
041100 SORT-TEST-10.
041200     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
041300     IF       SORTKEY-4 EQUAL TO "         X"
041400              PERFORM PASS GO TO SORT-WRITE-10.
041500 SORT-FAIL-10.
041600     PERFORM  FAIL.
041700     MOVE     SORTKEY-4 TO COMPUTED-A.
041800     MOVE     "         X" TO CORRECT-A.
041900 SORT-WRITE-10.
042000     MOVE     "SORT-TEST-10" TO PAR-NAME.
042100     PERFORM  PRINT-DETAIL.
042200 SORT-TEST-11.
042300     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
042400     IF       SORTKEY-7 EQUAL TO 418
042500              PERFORM PASS GO TO SORT-WRITE-11.
042600 SORT-FAIL-11.
042700     PERFORM  FAIL.
042800     MOVE     SORTKEY-7 TO COMPUTED-N
042900     MOVE     418 TO CORRECT-N.
043000 SORT-WRITE-11.
043100     MOVE     "SORT-TEST-11" TO PAR-NAME.
043200     PERFORM  PRINT-DETAIL.
043300 SORT-TEST-12.
043400     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
043500     IF       SORTKEY-8 EQUAL TO -14
043600              PERFORM PASS GO TO SORT-WRITE-12.
043700 SORT-FAIL-12.
043800     PERFORM  FAIL.
043900     MOVE     SORTKEY-8 TO COMPUTED-N.
044000     MOVE     -14 TO CORRECT-N.
044100 SORT-WRITE-12.
044200     MOVE     "SORT-TEST-12" TO PAR-NAME.
044300     PERFORM  PRINT-DETAIL.
044400 SORT-TEST-13.
044500     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
044600     IF       SORTKEY-6 EQUAL TO "Z         "
044700              PERFORM PASS GO TO SORT-WRITE-13.
044800 SORT-FAIL-13.
044900     PERFORM  FAIL.
045000     MOVE     SORTKEY-6 TO COMPUTED-A.
045100     MOVE     "Z         "           TO CORRECT-A.
045200 SORT-WRITE-13.
045300     MOVE     "SORT-TEST-13" TO PAR-NAME.
045400     PERFORM  PRINT-DETAIL.
045500 SORT-TEST-14.
045600     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
045700     IF       SORTKEY-5 EQUAL TO "Z                   "
045800              PERFORM PASS GO TO SORT-WRITE-14.
045900 SORT-FAIL-14.
046000     PERFORM  FAIL.
046100     MOVE     SORTKEY-5 TO COMPUTED-A.
046200     MOVE     "Z                   " TO CORRECT-A.
046300 SORT-WRITE-14.
046400     MOVE     "SORT-TEST-14" TO PAR-NAME.
046500     PERFORM  PRINT-DETAIL.
046600 SORT-TEST-15.
046700     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
046800     IF       SORTKEY-3 EQUAL TO +.6000000000000000
046900              PERFORM PASS GO TO SORT-WRITE-15.
047000 SORT-FAIL-15.
047100     PERFORM  FAIL.
047200     MOVE     SORTKEY-3 TO COMPUTED-0V18.
047300     MOVE     +.6000000000000000     TO CORRECT-0V18.
047400 SORT-WRITE-15.
047500     MOVE     "SORT-TEST-15" TO PAR-NAME.
047600     PERFORM  PRINT-DETAIL.
047700 SORT-TEST-16.
047800     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
047900     IF       SORTKEY-1 EQUAL TO +123456
048000              PERFORM PASS GO TO SORT-WRITE-16.
048100 SORT-FAIL-16.
048200     PERFORM  FAIL.
048300     MOVE     SORTKEY-1 TO COMPUTED-N.
048400     MOVE     +123456 TO CORRECT-N.
048500 SORT-WRITE-16.
048600     MOVE     "SORT-TEST-16" TO PAR-NAME.
048700     PERFORM  PRINT-DETAIL.
048800 CONTINUE-TESTING SECTION.
048900 SORT-TEST-17.
049000     RETURN   SORTFILE-1H AT END
049100              PERFORM PASS GO TO SORT-WRITE-17.
049200 SORT-FAIL-17.
049300     MOVE     "END OF FILE NOT FOUND" TO RE-MARK.
049400     PERFORM  FAIL.
049500 SORT-WRITE-17.
049600     MOVE     "SORT-TEST-17" TO PAR-NAME.
049700     PERFORM  PRINT-DETAIL.
049800     GO       TO OUTPROC-EXIT.
049900 RETURN-ERROR.
050000     MOVE     "RETURN-ERROR" TO PAR-NAME.
050100     PERFORM  FAIL.
050200     MOVE     "EOF PREMATURELY FOUND" TO RE-MARK.
050300     PERFORM  PRINT-DETAIL.
050400     GO TO CCVS1-EXIT.
050500 CLOSE-FILES.
050600     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
050700 TERMINATE-CCVS.
050800S    EXIT PROGRAM.
050900STERMINATE-CALL.
051000     STOP     RUN.
051100 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
051200 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
051300 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
051400 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
051500     MOVE "****TEST DELETED****" TO RE-MARK.
051600 PRINT-DETAIL.
051700     IF REC-CT NOT EQUAL TO ZERO
051800             MOVE "." TO PARDOT-X
051900             MOVE REC-CT TO DOTVALUE.
052000     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
052100     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
052200        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
052300          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
052400     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
052500     MOVE SPACE TO CORRECT-X.
052600     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
052700     MOVE     SPACE TO RE-MARK.
052800 HEAD-ROUTINE.
052900     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
053000     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
053100     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
053200     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
053300 COLUMN-NAMES-ROUTINE.
053400     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
053500     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
053600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
053700 END-ROUTINE.
053800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
053900 END-RTN-EXIT.
054000     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
054100 END-ROUTINE-1.
054200      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
054300      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
054400      ADD PASS-COUNTER TO ERROR-HOLD.
054500*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
054600      MOVE PASS-COUNTER TO CCVS-E-4-1.
054700      MOVE ERROR-HOLD TO CCVS-E-4-2.
054800      MOVE CCVS-E-4 TO CCVS-E-2-2.
054900      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
055000  END-ROUTINE-12.
055100      MOVE "TEST(S) FAILED" TO ENDER-DESC.
055200     IF       ERROR-COUNTER IS EQUAL TO ZERO
055300         MOVE "NO " TO ERROR-TOTAL
055400         ELSE
055500         MOVE ERROR-COUNTER TO ERROR-TOTAL.
055600     MOVE     CCVS-E-2 TO DUMMY-RECORD.
055700     PERFORM WRITE-LINE.
055800 END-ROUTINE-13.
055900     IF DELETE-COUNTER IS EQUAL TO ZERO
056000         MOVE "NO " TO ERROR-TOTAL  ELSE
056100         MOVE DELETE-COUNTER TO ERROR-TOTAL.
056200     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
056300     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
056400      IF   INSPECT-COUNTER EQUAL TO ZERO
056500          MOVE "NO " TO ERROR-TOTAL
056600      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
056700      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
056800      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
056900     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
057000 WRITE-LINE.
057100     ADD 1 TO RECORD-COUNT.
057200Y    IF RECORD-COUNT GREATER 42
057300Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
057400Y        MOVE SPACE TO DUMMY-RECORD
057500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
057600Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
057700Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
057800Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
057900Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
058000Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
058100Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
058200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
058300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
058400Y        MOVE ZERO TO RECORD-COUNT.
058500     PERFORM WRT-LN.
058600 WRT-LN.
058700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
058800     MOVE SPACE TO DUMMY-RECORD.
058900 BLANK-LINE-PRINT.
059000     PERFORM WRT-LN.
059100 FAIL-ROUTINE.
059200     IF     COMPUTED-X NOT EQUAL TO SPACE
059300            GO TO   FAIL-ROUTINE-WRITE.
059400     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
059500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
059600     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
059700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
059800     MOVE   SPACES TO INF-ANSI-REFERENCE.
059900     GO TO  FAIL-ROUTINE-EX.
060000 FAIL-ROUTINE-WRITE.
060100     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
060200     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
060300     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
060400     MOVE   SPACES TO COR-ANSI-REFERENCE.
060500 FAIL-ROUTINE-EX. EXIT.
060600 BAIL-OUT.
060700     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
060800     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
060900 BAIL-OUT-WRITE.
061000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
061100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
061200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
061300     MOVE   SPACES TO INF-ANSI-REFERENCE.
061400 BAIL-OUT-EX. EXIT.
061500 CCVS1-EXIT.
061600     EXIT.
061700 OUTPROC-EXIT SECTION.
061800 EXIT-ONLY.
061900     PERFORM  CLOSE-FILES.
