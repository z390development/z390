000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ205A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    " HIGH       ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "4.2 ".
001100*                                                              *
001200* THIS ROUTINE (OLD: SQ210)  TESTS THE USE STATEMENT WITH XFILE-NA
001300*    SERIES.  A MASS STORAGE AND TAPE FILE ARE CREATED AND THEN
001400*    READ.  AN AT END CONDITION IS USED TO CAUSE THE USE PROCEDURE
001500*    TO BE EXECUTED.  BOTH FILES HAVE A FILE STATUS CLAUSE IN THE
001600*    SELECT CLAUSE IN THE FILE-CONTROL PARAGRAPH.
001700 ENVIRONMENT DIVISION.
001800 CONFIGURATION SECTION.
001900 SOURCE-COMPUTER.
002000     XXXXX082.
002100 OBJECT-COMPUTER.
002200     XXXXX083.
002300 INPUT-OUTPUT SECTION.
002400 FILE-CONTROL.
002500P    SELECT RAW-DATA   ASSIGN TO
002600P    XXXXX062
002700P           ORGANIZATION IS INDEXED
002800P           ACCESS MODE IS RANDOM
002900P           RECORD KEY IS RAW-DATA-KEY.
003000     SELECT PRINT-FILE ASSIGN TO
003100     XXXXX055.
003200     SELECT SQ-FS1 ASSIGN TO
003300     XXXXX001
003400     ORGANIZATION SEQUENTIAL
003500     ACCESS SEQUENTIAL
003600     STATUS GRP-STATUS-KEY-1.
003700     SELECT SQ-FS2 ASSIGN TO
003800     XXXXX014
003900     ORGANIZATION IS SEQUENTIAL
004000     FILE STATUS GRP-STATUS-KEY-2.
004100 DATA DIVISION.
004200 FILE SECTION.
004300P
004400PFD  RAW-DATA.
004500P
004600P01  RAW-DATA-SATZ.
004700P    05  RAW-DATA-KEY        PIC X(6).
004800P    05  C-DATE              PIC 9(6).
004900P    05  C-TIME              PIC 9(8).
005000P    05  C-NO-OF-TESTS       PIC 99.
005100P    05  C-OK                PIC 999.
005200P    05  C-ALL               PIC 999.
005300P    05  C-FAIL              PIC 999.
005400P    05  C-DELETED           PIC 999.
005500P    05  C-INSPECT           PIC 999.
005600P    05  C-NOTE              PIC X(13).
005700P    05  C-INDENT            PIC X.
005800P    05  C-ABORT             PIC X(8).
005900 FD  PRINT-FILE
006000C    LABEL RECORDS
006100C    XXXXX084
006200C    DATA RECORD IS PRINT-REC DUMMY-RECORD
006300               .
006400 01  PRINT-REC PICTURE X(120).
006500 01  DUMMY-RECORD PICTURE X(120).
006600 FD  SQ-FS1
006700C    LABEL RECORD IS STANDARD
006800     BLOCK CONTAINS 5 RECORDS.
006900 01  SQ-FS1R1-F-G-120 PIC X(120).
007000 FD  SQ-FS2
007100C    LABEL RECORD IS STANDARD
007200     BLOCK CONTAINS 5 RECORDS.
007300 01  SQ-FS2R1-F-G-120 PIC X(120).
007400 WORKING-STORAGE SECTION.
007500 77  SQ-FS1-ERRORS      PIC 999      VALUE ZERO.
007600 77  SQ-FS2-ERRORS      PIC 999      VALUE ZERO.
007700 77  SQ-FS1-EOF-STATUS  PIC 9        VALUE ZERO.
007800 77  SQ-FS2-EOF-STATUS  PIC 9        VALUE ZERO.
007900 77  WRK-RECORD-COUNT   PIC 999      VALUE ZERO.
008000 77  RECORDS-IN-ERROR   PIC 999      VALUE ZERO.
008100 01  COUNT-OF-RECS PIC 9999  VALUE 0.
008200 01  GRP-STATUS-KEY-1.
008300     02 WRK-XN-00001-KEY-1   PIC XX.
008400*    02 FILLER               PIC X.
008500 01  GRP-STATUS-KEY-2.
008600     02 WRK-XN-00001-KEY-2   PIC XX.
008700*    02 FILLER               PIC X.
008800 01  FILE-RECORD-INFORMATION-REC.
008900     03 FILE-RECORD-INFO-SKELETON.
009000        05 FILLER                 PICTURE X(48)       VALUE
009100             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
009200        05 FILLER                 PICTURE X(46)       VALUE
009300             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
009400        05 FILLER                 PICTURE X(26)       VALUE
009500             ",LFIL=000000,ORG=  ,LBLR= ".
009600        05 FILLER                 PICTURE X(37)       VALUE
009700             ",RECKEY=                             ".
009800        05 FILLER                 PICTURE X(38)       VALUE
009900             ",ALTKEY1=                             ".
010000        05 FILLER                 PICTURE X(38)       VALUE
010100             ",ALTKEY2=                             ".
010200        05 FILLER                 PICTURE X(7)        VALUE SPACE.
010300     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
010400        05 FILE-RECORD-INFO-P1-120.
010500           07 FILLER              PIC X(5).
010600           07 XFILE-NAME           PIC X(6).
010700           07 FILLER              PIC X(8).
010800           07 XRECORD-NAME         PIC X(6).
010900           07 FILLER              PIC X(1).
011000           07 REELUNIT-NUMBER     PIC 9(1).
011100           07 FILLER              PIC X(7).
011200           07 XRECORD-NUMBER       PIC 9(6).
011300           07 FILLER              PIC X(6).
011400           07 UPDATE-NUMBER       PIC 9(2).
011500           07 FILLER              PIC X(5).
011600           07 ODO-NUMBER          PIC 9(4).
011700           07 FILLER              PIC X(5).
011800           07 XPROGRAM-NAME        PIC X(5).
011900           07 FILLER              PIC X(7).
012000           07 XRECORD-LENGTH       PIC 9(6).
012100           07 FILLER              PIC X(7).
012200           07 CHARS-OR-RECORDS    PIC X(2).
012300           07 FILLER              PIC X(1).
012400           07 XBLOCK-SIZE          PIC 9(4).
012500           07 FILLER              PIC X(6).
012600           07 RECORDS-IN-FILE     PIC 9(6).
012700           07 FILLER              PIC X(5).
012800           07 XFILE-ORGANIZATION   PIC X(2).
012900           07 FILLER              PIC X(6).
013000           07 XLABEL-TYPE          PIC X(1).
013100        05 FILE-RECORD-INFO-P121-240.
013200           07 FILLER              PIC X(8).
013300           07 XRECORD-KEY          PIC X(29).
013400           07 FILLER              PIC X(9).
013500           07 ALTERNATE-KEY1      PIC X(29).
013600           07 FILLER              PIC X(9).
013700           07 ALTERNATE-KEY2      PIC X(29).
013800           07 FILLER              PIC X(7).
013900 01  TEST-RESULTS.
014000     02 FILLER                    PICTURE X VALUE SPACE.
014100     02 FEATURE                   PICTURE X(20) VALUE SPACE.
014200     02 FILLER                    PICTURE X VALUE SPACE.
014300     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
014400     02 FILLER                    PICTURE X  VALUE SPACE.
014500     02  PAR-NAME.
014600       03 FILLER PICTURE X(12) VALUE SPACE.
014700       03  PARDOT-X PICTURE X  VALUE SPACE.
014800       03 DOTVALUE PICTURE 99  VALUE ZERO.
014900       03 FILLER PIC X(5) VALUE SPACE.
015000     02 FILLER PIC X(10) VALUE SPACE.
015100     02 RE-MARK PIC X(61).
015200 01  TEST-COMPUTED.
015300     02 FILLER PIC X(30) VALUE SPACE.
015400     02 FILLER PIC X(17) VALUE "       COMPUTED=".
015500     02 COMPUTED-X.
015600     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
015700     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
015800     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
015900     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
016000     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
016100     03       CM-18V0 REDEFINES COMPUTED-A.
016200         04 COMPUTED-18V0                   PICTURE -9(18).
016300         04 FILLER                          PICTURE X.
016400     03 FILLER PIC X(50) VALUE SPACE.
016500 01  TEST-CORRECT.
016600     02 FILLER PIC X(30) VALUE SPACE.
016700     02 FILLER PIC X(17) VALUE "       CORRECT =".
016800     02 CORRECT-X.
016900     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
017000     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
017100     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
017200     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
017300     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
017400     03      CR-18V0 REDEFINES CORRECT-A.
017500         04 CORRECT-18V0                    PICTURE -9(18).
017600         04 FILLER                          PICTURE X.
017700     03 FILLER PIC X(50) VALUE SPACE.
017800 01  CCVS-C-1.
017900     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
018000-    "SS  PARAGRAPH-NAME
018100-    "        REMARKS".
018200     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
018300 01  CCVS-C-2.
018400     02 FILLER PICTURE IS X VALUE IS SPACE.
018500     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
018600     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
018700     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
018800     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
018900 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
019000 01  REC-CT PICTURE 99 VALUE ZERO.
019100 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
019200 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
019300 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
019400 01  PASS-COUNTER PIC 999 VALUE ZERO.
019500 01  TOTAL-ERROR PIC 999 VALUE ZERO.
019600 01  ERROR-HOLD PIC 999 VALUE ZERO.
019700 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
019800 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
019900 01  CCVS-H-1.
020000     02  FILLER   PICTURE X(27)  VALUE SPACE.
020100     02 FILLER PICTURE X(67) VALUE
020200     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
020300-    " SYSTEM".
020400     02  FILLER     PICTURE X(26)  VALUE SPACE.
020500 01  CCVS-H-2.
020600     02 FILLER PICTURE X(52) VALUE IS
020700     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
020800     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
020900     02 TEST-ID PICTURE IS X(9).
021000     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
021100 01  CCVS-H-3.
021200     02  FILLER PICTURE X(34) VALUE
021300     " FOR OFFICIAL USE ONLY    ".
021400     02  FILLER PICTURE X(58) VALUE
021500     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
021600     02  FILLER PICTURE X(28) VALUE
021700     "  COPYRIGHT   1985 ".
021800 01  CCVS-E-1.
021900     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
022000     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
022100     02 ID-AGAIN PICTURE IS X(9).
022200     02 FILLER PICTURE X(45) VALUE IS
022300     " NTIS DISTRIBUTION COBOL 85".
022400 01  CCVS-E-2.
022500     02  FILLER                   PICTURE X(31)  VALUE
022600     SPACE.
022700     02  FILLER                   PICTURE X(21)  VALUE SPACE.
022800     02 CCVS-E-2-2.
022900         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
023000         03 FILLER PICTURE IS X VALUE IS SPACE.
023100         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
023200 01  CCVS-E-3.
023300     02  FILLER PICTURE X(22) VALUE
023400     " FOR OFFICIAL USE ONLY".
023500     02  FILLER PICTURE X(12) VALUE SPACE.
023600     02  FILLER PICTURE X(58) VALUE
023700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
023800     02  FILLER PICTURE X(13) VALUE SPACE.
023900     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
024000 01  CCVS-E-4.
024100     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
024200     02 FILLER PIC XXXX VALUE " OF ".
024300     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
024400     02 FILLER PIC X(40) VALUE
024500      "  TESTS WERE EXECUTED SUCCESSFULLY".
024600 01  XXINFO.
024700     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
024800     02 INFO-TEXT.
024900     04 FILLER PIC X(20) VALUE SPACE.
025000     04 XXCOMPUTED PIC X(20).
025100     04 FILLER PIC X(5) VALUE SPACE.
025200     04 XXCORRECT PIC X(20).
025300 01  HYPHEN-LINE.
025400     02 FILLER PICTURE IS X VALUE IS SPACE.
025500     02 FILLER PICTURE IS X(65) VALUE IS "************************
025600-    "*****************************************".
025700     02 FILLER PICTURE IS X(54) VALUE IS "************************
025800-    "******************************".
025900 01  CCVS-PGM-ID PIC X(6) VALUE
026000     "SQ205A".
026100 PROCEDURE DIVISION.
026200 DECLARATIVES.
026300 SEQ-USE SECTION.
026400     USE AFTER EXCEPTION PROCEDURE ON SQ-FS1, SQ-FS2.
026500 SEQ-USE-001.
026600     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS1" GO TO SEQ-USE-002.
026700     IF WRK-XN-00001-KEY-1 EQUAL TO "10"
026800              MOVE 1 TO SQ-FS1-EOF-STATUS
026900              GO TO SEQ-USE-EXIT.
027000     ADD 1 TO SQ-FS1-ERRORS.
027100     GO TO SEQ-USE-EXIT.
027200 SEQ-USE-002.
027300     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS2" GO TO SEQ-USE-EXIT.
027400     IF WRK-XN-00001-KEY-2 EQUAL TO "10"
027500              MOVE 1 TO SQ-FS2-EOF-STATUS
027600              GO TO SEQ-USE-EXIT.
027700     ADD 1 TO SQ-FS2-ERRORS.
027800 SEQ-USE-EXIT.
027900     EXIT.
028000 END DECLARATIVES.
028100 CCVS1 SECTION.
028200 OPEN-FILES.
028300P    OPEN I-O RAW-DATA.
028400P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
028500P    READ RAW-DATA INVALID KEY GO TO END-E-1.
028600P    MOVE "ABORTED " TO C-ABORT.
028700P    ADD 1 TO C-NO-OF-TESTS.
028800P    ACCEPT C-DATE  FROM DATE.
028900P    ACCEPT C-TIME  FROM TIME.
029000P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
029100PEND-E-1.
029200P    CLOSE RAW-DATA.
029300     OPEN     OUTPUT PRINT-FILE.
029400     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
029500     MOVE    SPACE TO TEST-RESULTS.
029600     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
029700     MOVE ZERO TO REC-SKL-SUB.
029800     PERFORM CCVS-INIT-FILE 9 TIMES.
029900 CCVS-INIT-FILE.
030000     ADD 1 TO REC-SKL-SUB.
030100     MOVE FILE-RECORD-INFO-SKELETON TO
030200                  FILE-RECORD-INFO (REC-SKL-SUB).
030300 CCVS-INIT-EXIT.
030400     GO TO CCVS1-EXIT.
030500 CLOSE-FILES.
030600     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
030700P    OPEN I-O RAW-DATA.
030800P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
030900P    READ RAW-DATA INVALID KEY GO TO END-E-2.
031000P    MOVE "OK.     " TO C-ABORT.
031100P    MOVE PASS-COUNTER TO C-OK.
031200P    MOVE ERROR-HOLD   TO C-ALL.
031300P    MOVE ERROR-COUNTER TO C-FAIL.
031400P    MOVE DELETE-CNT TO C-DELETED.
031500P    MOVE INSPECT-COUNTER TO C-INSPECT.
031600P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
031700PEND-E-2.
031800P    CLOSE RAW-DATA.
031900 TERMINATE-CCVS.
032000S    EXIT PROGRAM.
032100STERMINATE-CALL.
032200     STOP     RUN.
032300 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
032400 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
032500 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
032600 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
032700     MOVE "****TEST DELETED****" TO RE-MARK.
032800 PRINT-DETAIL.
032900     IF REC-CT NOT EQUAL TO ZERO
033000             MOVE "." TO PARDOT-X
033100             MOVE REC-CT TO DOTVALUE.
033200     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
033300     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
033400        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
033500          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
033600     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
033700     MOVE SPACE TO CORRECT-X.
033800     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
033900     MOVE     SPACE TO RE-MARK.
034000 HEAD-ROUTINE.
034100     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034200     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
034300     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
034400 COLUMN-NAMES-ROUTINE.
034500     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034600     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
034800 END-ROUTINE.
034900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
035000 END-RTN-EXIT.
035100     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035200 END-ROUTINE-1.
035300      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
035400      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
035500      ADD PASS-COUNTER TO ERROR-HOLD.
035600*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
035700      MOVE PASS-COUNTER TO CCVS-E-4-1.
035800      MOVE ERROR-HOLD TO CCVS-E-4-2.
035900      MOVE CCVS-E-4 TO CCVS-E-2-2.
036000      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
036100  END-ROUTINE-12.
036200      MOVE "TEST(S) FAILED" TO ENDER-DESC.
036300     IF       ERROR-COUNTER IS EQUAL TO ZERO
036400         MOVE "NO " TO ERROR-TOTAL
036500         ELSE
036600         MOVE ERROR-COUNTER TO ERROR-TOTAL.
036700     MOVE     CCVS-E-2 TO DUMMY-RECORD.
036800     PERFORM WRITE-LINE.
036900 END-ROUTINE-13.
037000     IF DELETE-CNT IS EQUAL TO ZERO
037100         MOVE "NO " TO ERROR-TOTAL  ELSE
037200         MOVE DELETE-CNT TO ERROR-TOTAL.
037300     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
037400     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037500      IF   INSPECT-COUNTER EQUAL TO ZERO
037600          MOVE "NO " TO ERROR-TOTAL
037700      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
037800      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
037900      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038000     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038100 WRITE-LINE.
038200     ADD 1 TO RECORD-COUNT.
038300Y    IF RECORD-COUNT GREATER 50
038400Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
038500Y        MOVE SPACE TO DUMMY-RECORD
038600Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
038700Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
038800Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
038900Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
039000Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
039100Y        MOVE ZERO TO RECORD-COUNT.
039200     PERFORM WRT-LN.
039300 WRT-LN.
039400     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
039500     MOVE SPACE TO DUMMY-RECORD.
039600 BLANK-LINE-PRINT.
039700     PERFORM WRT-LN.
039800 FAIL-ROUTINE.
039900     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
040000     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
040100     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
040200     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040300     GO TO FAIL-ROUTINE-EX.
040400 FAIL-ROUTINE-WRITE.
040500     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
040600     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
040700 FAIL-ROUTINE-EX. EXIT.
040800 BAIL-OUT.
040900     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
041000     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
041100 BAIL-OUT-WRITE.
041200     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
041300     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041400 BAIL-OUT-EX. EXIT.
041500 CCVS1-EXIT.
041600     EXIT.
041700 SECT-SQ205A-0001 SECTION.
041800 WRITE-INIT-GF-01.
041900     MOVE "R1-F-G" TO XRECORD-NAME (1).
042000     MOVE "SQ205"  TO XPROGRAM-NAME (1).
042100     MOVE 0120     TO XRECORD-LENGTH (1).
042200     MOVE "RC"     TO CHARS-OR-RECORDS (1).
042300     MOVE 5        TO XBLOCK-SIZE (1).
042400     MOVE 500      TO RECORDS-IN-FILE (1).
042500     MOVE "SQ"     TO XFILE-ORGANIZATION (1).
042600     MOVE "S"      TO XLABEL-TYPE (1).
042700     MOVE 1        TO XRECORD-NUMBER (1).
042800     OPEN OUTPUT SQ-FS1 , SQ-FS2.
042900 WRITE-TEST-GF-01-01.
043000     MOVE "SQ-FS1" TO XFILE-NAME (1).
043100     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-FS1R1-F-G-120.
043200     WRITE SQ-FS1R1-F-G-120.
043300     MOVE "SQ-FS2" TO XFILE-NAME (1).
043400     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-FS2R1-F-G-120.
043500     WRITE SQ-FS2R1-F-G-120.
043600     IF XRECORD-NUMBER (1) EQUAL TO 500
043700              GO TO WRITE-TEST-GF-01-02.
043800     ADD 1 TO XRECORD-NUMBER (1).
043900     GO TO WRITE-TEST-GF-01-01.
044000 WRITE-TEST-GF-01-02.
044100     MOVE "CREATE FILE SQ-FS1,2" TO FEATURE.
044200     MOVE "WRITE-TEST-GF-01" TO PAR-NAME.
044300     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
044400     MOVE XRECORD-NUMBER (1) TO CORRECT-18V0.
044500     PERFORM PRINT-DETAIL.
044600     CLOSE SQ-FS1 , SQ-FS2.
044700 READ-INIT-GF-01.
044800     OPEN INPUT SQ-FS1.
044900 READ-TEST-GF-01-01.
045000     READ SQ-FS1.
045100     IF SQ-FS1-EOF-STATUS EQUAL TO 1
045200              GO TO READ-TEST-GF-01-02.
045300     MOVE SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
045400     ADD 1 TO WRK-RECORD-COUNT.
045500     IF WRK-RECORD-COUNT GREATER THAN 500
045600              MOVE "MORE THAN 500 RECORDS" TO RE-MARK
045700              MOVE "RECORDS READ=" TO COMPUTED-A
045800              MOVE WRK-RECORD-COUNT TO CORRECT-18V0
045900              GO TO READ-FAIL-GF-01.
046000     IF WRK-RECORD-COUNT NOT EQUAL TO XRECORD-NUMBER (1)
046100              ADD 1 TO RECORDS-IN-ERROR
046200              GO TO READ-TEST-GF-01-01.
046300     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS1"
046400              ADD 1 TO RECORDS-IN-ERROR
046500              GO TO READ-TEST-GF-01-01.
046600     IF XLABEL-TYPE (1) NOT EQUAL TO "S"
046700              ADD 1 TO RECORDS-IN-ERROR.
046800     GO TO READ-TEST-GF-01-01.
046900 READ-TEST-GF-01-02.
047000     IF WRK-RECORD-COUNT LESS THAN 500
047100              MOVE "LESS THAN 500 RECORDS;VII-52 OR VII-44"
047200                  TO RE-MARK
047300              MOVE "RECORDS READ=" TO COMPUTED-A
047400              MOVE WRK-RECORD-COUNT TO CORRECT-18V0
047500              GO TO READ-FAIL-GF-01.
047600     IF SQ-FS1-ERRORS NOT EQUAL TO ZERO
047700              MOVE "PERM/IMPL ERRORS ENCOUNTERED;VII-44 OR VII-52"
047800                  TO RE-MARK
047900              MOVE "RECORDS IN ERROR=" TO COMPUTED-A
048000              MOVE SQ-FS1-ERRORS TO CORRECT-18V0
048100              GO TO READ-FAIL-GF-01.
048200     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
048300              MOVE "ERRORS IN READING SQ-FS1; VII-44 OR VII-52"
048400                  TO RE-MARK
048500              MOVE "RECORDS IN ERROR=" TO COMPUTED-A
048600              MOVE RECORDS-IN-ERROR TO CORRECT-18V0
048700              GO TO READ-FAIL-GF-01.
048800     GO TO READ-PASS-GF-01.
048900 READ-DELETE-GF-01.
049000     PERFORM DE-LETE.
049100     GO TO READ-WRITE-GF-01.
049200 READ-FAIL-GF-01.
049300     PERFORM FAIL.
049400     GO TO READ-WRITE-GF-01.
049500 READ-PASS-GF-01.
049600     PERFORM PASS.
049700     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
049800     MOVE WRK-RECORD-COUNT TO CORRECT-18V0.
049900 READ-WRITE-GF-01.
050000     MOVE "READ-TEST-GF-01" TO PAR-NAME.
050100     MOVE "VERIFY SQ-FS1;F-S:10" TO FEATURE.
050200     PERFORM PRINT-DETAIL.
050300 READ-CLOSE-GF-01.
050400     CLOSE SQ-FS1.
050500 READ-INIT-GF-02.
050600     MOVE ZERO TO WRK-RECORD-COUNT.
050700     OPEN INPUT SQ-FS2.
050800 READ-TEST-GF-02-01.
050900     READ SQ-FS2 RECORD.
051000     IF SQ-FS2-EOF-STATUS EQUAL 1
051100              GO TO READ-TEST-GF-02-02.
051200     MOVE SQ-FS2R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
051300     ADD 1 TO WRK-RECORD-COUNT.
051400     IF WRK-RECORD-COUNT GREATER THAN 500
051500              MOVE "MORE THAN 500 RECORDS" TO RE-MARK
051600              MOVE "RECORDS READ =" TO COMPUTED-A
051700              MOVE WRK-RECORD-COUNT TO CORRECT-18V0
051800              GO TO READ-FAIL-GF-02.
051900     IF WRK-RECORD-COUNT NOT EQUAL TO XRECORD-NUMBER (1)
052000              ADD 1 TO RECORDS-IN-ERROR
052100              GO TO READ-TEST-GF-02-01.
052200     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS2"
052300              ADD 1 TO RECORDS-IN-ERROR
052400              GO TO READ-TEST-GF-02-01.
052500     IF XLABEL-TYPE (1) NOT EQUAL TO "S"
052600              ADD 1 TO RECORDS-IN-ERROR.
052700     GO TO READ-TEST-GF-02-01.
052800 READ-TEST-GF-02-02.
052900     IF WRK-RECORD-COUNT LESS THAN 500
053000              MOVE "LESS THAN 500 RECORDS; VII-44 OR VII-52"
053100                  TO RE-MARK
053200              MOVE "RECORDS READ =" TO COMPUTED-A
053300              MOVE WRK-RECORD-COUNT TO CORRECT-18V0
053400              GO TO READ-FAIL-GF-02.
053500     IF SQ-FS2-ERRORS NOT EQUAL TO ZERO
053600              MOVE "PERM/IMPL ERRORS ENCOUNTERED;VII-44 OR -52"
053700                  TO RE-MARK
053800              MOVE "RECORDS IN ERROR =" TO COMPUTED-A
053900              MOVE SQ-FS2-ERRORS TO CORRECT-18V0
054000              GO TO READ-FAIL-GF-02.
054100     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
054200              MOVE "ERRORS IN READING SQ-FS2; VII-44 OR VII-52"
054300                  TO RE-MARK
054400              MOVE "RECORDS IN ERROR =" TO COMPUTED-A
054500              MOVE RECORDS-IN-ERROR TO CORRECT-18V0
054600              GO TO READ-FAIL-GF-02.
054700     GO TO READ-PASS-GF-02.
054800 READ-DELETE-GF-02.
054900     PERFORM DE-LETE.
055000     GO TO READ-WRITE-GF-02.
055100 READ-FAIL-GF-02.
055200     PERFORM FAIL.
055300     GO TO READ-WRITE-GF-02.
055400 READ-PASS-GF-02.
055500     PERFORM PASS.
055600     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
055700     MOVE WRK-RECORD-COUNT TO CORRECT-18V0.
055800 READ-WRITE-GF-02.
055900     MOVE "READ-TEST-GF-02" TO PAR-NAME.
056000     MOVE "VERIFY SQ-FS2;F-S:10" TO FEATURE.
056100     PERFORM PRINT-DETAIL.
056200 READ-CLOSE-GF-02.
056300     CLOSE SQ-FS2.
056400 SQ205A-END-ROUTINE.
056500     MOVE "END OF SQ205A VALIDATION TESTS" TO PRINT-REC.
056600     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
056700 TERMINATE-SQ205A.
056800     EXIT.
056900 CCVS-EXIT SECTION.
057000 CCVS-999999.
057100     GO TO CLOSE-FILES.
