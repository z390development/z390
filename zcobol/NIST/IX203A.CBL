000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IX203A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*    THIS PROGRAM IS THE THIRD OF A SERIES.  ITS FUNCTION
001400*    IS TO PROCESS THE FILE SEQUENTIALLY USING THE ACCESS MODE IS
001500*    DYNAMIC CLAUSE.  THE FILE USED IS THAT RESULTING FROM IX202.
001600*
001700*    FIRST, THE FILE IS VERIFIED FOR ACCURACY OF ITS 500 RECORDS.
001800*    SECONDLY, RECORDS OF THE FILE ARE SELECTIVELY DELETED AND
001900*    THIRDLY THE ACCURACY OF EACH RECORD IN THE FILE IS AGAIN
002000*    VERIFIED.
002100*
002200*
002300*
002400*       X-CARDS  WHICH MUST BE REPLACED FOR THIS PROGRAM ARE
002500*
002600*             X-24   INDEXED FILE IMPLEMENTOR-NAME IN ASSGN TO
002700*                    CLAUSE FOR DATA FILE IX-FS1
002800*             X-44   INDEXED FILE IMPLEMENTOR-NAME IN ASSGN TO
002900*                    CLAUSE FOR INDEX FILE IX-FS1
003000*             X-55   IMPLEMENTOR-NAME FOR SYSTEM PRINTER
003100*             X-62   FOR RAW-DATA
003200*             X-82   IMPLEMENTOR-NAME FOR SOURCE-COMPUTER
003300*             X-83   IMPLEMENTOR-NAME FOR OBJECT-COMPUTER
003400*
003500*         NOTE:  X-CARDS 44 AND 62       ARE OPTIONAL
003600*               AND NEED ONLY TO BE PRESENT IF THE COMPILER RE-
003700*               QUIRES THIS CODE BE AVAILABLE FOR PROPER PROGRAM
003800*               COMPILATION AND EXECUTION. IF THE VP-ROUTINE IS
003900*               USED THE  X-CARDS MAY BE AUTOMATICALLY SELECTED
004000*               FOR INCLUSION IN THE PROGRAM BY SPECIFYING THE
004100*               APPROPRIATE LETTER IN THE "*OPT" VP-ROUTINE
004200*               CONTROL CARD. THE LETTER  CORRESPONDS TO A
004300*               CHARACTER IN POSITION 7 OF THE SOURCE LINE AND
004400*               THEY ARE AS FOLLOWS
004500*
004600*                  P  SELECTS X-CARDS 62
004700*                  J  SELECTS X-CARD 44
004800*
004900 ENVIRONMENT DIVISION.
005000 CONFIGURATION SECTION.
005100 SOURCE-COMPUTER.
005200     XXXXX082.
005300 OBJECT-COMPUTER.
005400     XXXXX083.
005500 INPUT-OUTPUT SECTION.
005600 FILE-CONTROL.
005700P    SELECT RAW-DATA   ASSIGN TO
005800P    XXXXX062
005900P           ORGANIZATION IS INDEXED
006000P           ACCESS MODE IS RANDOM
006100P           RECORD KEY IS RAW-DATA-KEY.
006200     SELECT PRINT-FILE ASSIGN TO
006300     XXXXX055.
006400     SELECT   IX-FD1 ASSIGN TO
006500     XXXXD024
006600J    XXXXD044
006700        ACCESS MODE IS DYNAMIC
006800        ORGANIZATION IS INDEXED
006900        RECORD    IX-FD1-KEY.
007000 DATA DIVISION.
007100 FILE SECTION.
007200P
007300PFD  RAW-DATA.
007400P
007500P01  RAW-DATA-SATZ.
007600P    05  RAW-DATA-KEY        PIC X(6).
007700P    05  C-DATE              PIC 9(6).
007800P    05  C-TIME              PIC 9(8).
007900P    05  C-NO-OF-TESTS       PIC 99.
008000P    05  C-OK                PIC 999.
008100P    05  C-ALL               PIC 999.
008200P    05  C-FAIL              PIC 999.
008300P    05  C-DELETED           PIC 999.
008400P    05  C-INSPECT           PIC 999.
008500P    05  C-NOTE              PIC X(13).
008600P    05  C-INDENT            PIC X.
008700P    05  C-ABORT             PIC X(8).
008800 FD  PRINT-FILE.
008900 01  PRINT-REC PICTURE X(120).
009000 01  DUMMY-RECORD PICTURE X(120).
009100 FD  IX-FD1
009200C    LABEL RECORD STANDARD
009300C    DATA RECORDS ARE  IX-FD1R1-F-G-240
009400     BLOCK CONTAINS 01 RECORDS
009500     RECORD CONTAINS  240.
009600 01  IX-FD1R1-F-G-240.
009700     05 IX-FD1-REC-120   PIC  X(120).
009800     05 IX-FD1-REC-120-240.
009900        10 FILLER   PIC X(8).
010000        10 IX-FD1-KEY   PIC X(29).
010100        10 FILLER        PIC X(83).
010200 WORKING-STORAGE SECTION.
010300 01  WRK-CS-09V00-006 PIC S9(09) USAGE COMP VALUE ZERO.
010400 01  WRK-CS-09V00-007 PIC S9(09) USAGE COMP VALUE ZERO.
010500 01  WRK-CS-09V00-008 PIC S9(09) USAGE COMP VALUE ZERO.
010600 01  WRK-CS-09V00-009 PIC S9(09) USAGE COMP VALUE ZERO.
010700 01  WRK-CS-09V00-010 PIC S9(09) USAGE COMP VALUE ZERO.
010800 01  WRK-CS-09V00-011 PIC S9(09) USAGE COMP VALUE ZERO.
010900 01  I-O-ERROR-IX-FD1 PIC X(3) VALUE "NO ".
011000 01  IX-WRK-KEY.
011100     03 FILLER         PIC X(10).
011200     03 WRK-DU-09V00-001  PIC 9(9).
011300     03 FILLER         PIC X(10).
011400 01  DUMMY-WRK-REC.
011500     02 DUMMY-WRK1       PIC X(120).
011600     02 DUMMY-WRK2  REDEFINES  DUMMY-WRK1.
011700        03 FILLER   PIC X(5).
011800        03 DUMMY-WRK-INDENT-5  PIC X(115).
011900 01  FILE-RECORD-INFORMATION-REC.
012000     03 FILE-RECORD-INFO-SKELETON.
012100        05 FILLER                 PICTURE X(48)       VALUE
012200             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
012300        05 FILLER                 PICTURE X(46)       VALUE
012400             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
012500        05 FILLER                 PICTURE X(26)       VALUE
012600             ",LFIL=000000,ORG=  ,LBLR= ".
012700        05 FILLER                 PICTURE X(37)       VALUE
012800             ",RECKEY=                             ".
012900        05 FILLER                 PICTURE X(38)       VALUE
013000             ",ALTKEY1=                             ".
013100        05 FILLER                 PICTURE X(38)       VALUE
013200             ",ALTKEY2=                             ".
013300        05 FILLER                 PICTURE X(7)        VALUE SPACE.
013400     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
013500        05 FILE-RECORD-INFO-P1-120.
013600           07 FILLER              PIC X(5).
013700           07 XFILE-NAME           PIC X(6).
013800           07 FILLER              PIC X(8).
013900           07 XRECORD-NAME         PIC X(6).
014000           07 FILLER              PIC X(1).
014100           07 REELUNIT-NUMBER     PIC 9(1).
014200           07 FILLER              PIC X(7).
014300           07 XRECORD-NUMBER       PIC 9(6).
014400           07 FILLER              PIC X(6).
014500           07 UPDATE-NUMBER       PIC 9(2).
014600           07 FILLER              PIC X(5).
014700           07 ODO-NUMBER          PIC 9(4).
014800           07 FILLER              PIC X(5).
014900           07 XPROGRAM-NAME        PIC X(5).
015000           07 FILLER              PIC X(7).
015100           07 XRECORD-LENGTH       PIC 9(6).
015200           07 FILLER              PIC X(7).
015300           07 CHARS-OR-RECORDS    PIC X(2).
015400           07 FILLER              PIC X(1).
015500           07 XBLOCK-SIZE          PIC 9(4).
015600           07 FILLER              PIC X(6).
015700           07 RECORDS-IN-FILE     PIC 9(6).
015800           07 FILLER              PIC X(5).
015900           07 XFILE-ORGANIZATION   PIC X(2).
016000           07 FILLER              PIC X(6).
016100           07 XLABEL-TYPE          PIC X(1).
016200        05 FILE-RECORD-INFO-P121-240.
016300           07 FILLER              PIC X(8).
016400           07 XRECORD-KEY          PIC X(29).
016500           07 FILLER              PIC X(9).
016600           07 ALTERNATE-KEY1      PIC X(29).
016700           07 FILLER              PIC X(9).
016800           07 ALTERNATE-KEY2      PIC X(29).
016900           07 FILLER              PIC X(7).
017000 01  TEST-RESULTS.
017100     02 FILLER                   PIC X      VALUE SPACE.
017200     02 FEATURE                  PIC X(20)  VALUE SPACE.
017300     02 FILLER                   PIC X      VALUE SPACE.
017400     02 P-OR-F                   PIC X(5)   VALUE SPACE.
017500     02 FILLER                   PIC X      VALUE SPACE.
017600     02  PAR-NAME.
017700       03 FILLER                 PIC X(19)  VALUE SPACE.
017800       03  PARDOT-X              PIC X      VALUE SPACE.
017900       03 DOTVALUE               PIC 99     VALUE ZERO.
018000     02 FILLER                   PIC X(8)   VALUE SPACE.
018100     02 RE-MARK                  PIC X(61).
018200 01  TEST-COMPUTED.
018300     02 FILLER                   PIC X(30)  VALUE SPACE.
018400     02 FILLER                   PIC X(17)  VALUE
018500            "       COMPUTED=".
018600     02 COMPUTED-X.
018700     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
018800     03 COMPUTED-N               REDEFINES COMPUTED-A
018900                                 PIC -9(9).9(9).
019000     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
019100     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
019200     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
019300     03       CM-18V0 REDEFINES COMPUTED-A.
019400         04 COMPUTED-18V0                    PIC -9(18).
019500         04 FILLER                           PIC X.
019600     03 FILLER PIC X(50) VALUE SPACE.
019700 01  TEST-CORRECT.
019800     02 FILLER PIC X(30) VALUE SPACE.
019900     02 FILLER PIC X(17) VALUE "       CORRECT =".
020000     02 CORRECT-X.
020100     03 CORRECT-A                  PIC X(20) VALUE SPACE.
020200     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
020300     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
020400     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
020500     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
020600     03      CR-18V0 REDEFINES CORRECT-A.
020700         04 CORRECT-18V0                     PIC -9(18).
020800         04 FILLER                           PIC X.
020900     03 FILLER PIC X(2) VALUE SPACE.
021000     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
021100 01  CCVS-C-1.
021200     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
021300-    "SS  PARAGRAPH-NAME
021400-    "       REMARKS".
021500     02 FILLER                     PIC X(20)    VALUE SPACE.
021600 01  CCVS-C-2.
021700     02 FILLER                     PIC X        VALUE SPACE.
021800     02 FILLER                     PIC X(6)     VALUE "TESTED".
021900     02 FILLER                     PIC X(15)    VALUE SPACE.
022000     02 FILLER                     PIC X(4)     VALUE "FAIL".
022100     02 FILLER                     PIC X(94)    VALUE SPACE.
022200 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
022300 01  REC-CT                        PIC 99       VALUE ZERO.
022400 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
022500 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
022600 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
022700 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
022800 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
022900 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
023000 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
023100 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
023200 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
023300 01  CCVS-H-1.
023400     02  FILLER                    PIC X(39)    VALUE SPACES.
023500     02  FILLER                    PIC X(42)    VALUE
023600     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
023700     02  FILLER                    PIC X(39)    VALUE SPACES.
023800 01  CCVS-H-2A.
023900   02  FILLER                        PIC X(40)  VALUE SPACE.
024000   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
024100   02  FILLER                        PIC XXXX   VALUE
024200     "4.2 ".
024300   02  FILLER                        PIC X(28)  VALUE
024400            " COPY - NOT FOR DISTRIBUTION".
024500   02  FILLER                        PIC X(41)  VALUE SPACE.
024600
024700 01  CCVS-H-2B.
024800   02  FILLER                        PIC X(15)  VALUE
024900            "TEST RESULT OF ".
025000   02  TEST-ID                       PIC X(9).
025100   02  FILLER                        PIC X(4)   VALUE
025200            " IN ".
025300   02  FILLER                        PIC X(12)  VALUE
025400     " HIGH       ".
025500   02  FILLER                        PIC X(22)  VALUE
025600            " LEVEL VALIDATION FOR ".
025700   02  FILLER                        PIC X(58)  VALUE
025800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025900 01  CCVS-H-3.
026000     02  FILLER                      PIC X(34)  VALUE
026100            " FOR OFFICIAL USE ONLY    ".
026200     02  FILLER                      PIC X(58)  VALUE
026300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
026400     02  FILLER                      PIC X(28)  VALUE
026500            "  COPYRIGHT   1985 ".
026600 01  CCVS-E-1.
026700     02 FILLER                       PIC X(52)  VALUE SPACE.
026800     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
026900     02 ID-AGAIN                     PIC X(9).
027000     02 FILLER                       PIC X(45)  VALUE SPACES.
027100 01  CCVS-E-2.
027200     02  FILLER                      PIC X(31)  VALUE SPACE.
027300     02  FILLER                      PIC X(21)  VALUE SPACE.
027400     02 CCVS-E-2-2.
027500         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
027600         03 FILLER                   PIC X      VALUE SPACE.
027700         03 ENDER-DESC               PIC X(44)  VALUE
027800            "ERRORS ENCOUNTERED".
027900 01  CCVS-E-3.
028000     02  FILLER                      PIC X(22)  VALUE
028100            " FOR OFFICIAL USE ONLY".
028200     02  FILLER                      PIC X(12)  VALUE SPACE.
028300     02  FILLER                      PIC X(58)  VALUE
028400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
028500     02  FILLER                      PIC X(13)  VALUE SPACE.
028600     02 FILLER                       PIC X(15)  VALUE
028700             " COPYRIGHT 1985".
028800 01  CCVS-E-4.
028900     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
029000     02 FILLER                       PIC X(4)   VALUE " OF ".
029100     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
029200     02 FILLER                       PIC X(40)  VALUE
029300      "  TESTS WERE EXECUTED SUCCESSFULLY".
029400 01  XXINFO.
029500     02 FILLER                       PIC X(19)  VALUE
029600            "*** INFORMATION ***".
029700     02 INFO-TEXT.
029800       04 FILLER                     PIC X(8)   VALUE SPACE.
029900       04 XXCOMPUTED                 PIC X(20).
030000       04 FILLER                     PIC X(5)   VALUE SPACE.
030100       04 XXCORRECT                  PIC X(20).
030200     02 INF-ANSI-REFERENCE           PIC X(48).
030300 01  HYPHEN-LINE.
030400     02 FILLER  PIC IS X VALUE IS SPACE.
030500     02 FILLER  PIC IS X(65)    VALUE IS "************************
030600-    "*****************************************".
030700     02 FILLER  PIC IS X(54)    VALUE IS "************************
030800-    "******************************".
030900 01  CCVS-PGM-ID                     PIC X(9)   VALUE
031000     "IX203A".
031100 PROCEDURE DIVISION.
031200 CCVS1 SECTION.
031300 OPEN-FILES.
031400P    OPEN I-O RAW-DATA.
031500P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
031600P    READ RAW-DATA INVALID KEY GO TO END-E-1.
031700P    MOVE "ABORTED " TO C-ABORT.
031800P    ADD 1 TO C-NO-OF-TESTS.
031900P    ACCEPT C-DATE  FROM DATE.
032000P    ACCEPT C-TIME  FROM TIME.
032100P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
032200PEND-E-1.
032300P    CLOSE RAW-DATA.
032400     OPEN    OUTPUT PRINT-FILE.
032500     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
032600     MOVE    SPACE TO TEST-RESULTS.
032700     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
032800     MOVE    ZERO TO REC-SKL-SUB.
032900     PERFORM CCVS-INIT-FILE 9 TIMES.
033000 CCVS-INIT-FILE.
033100     ADD     1 TO REC-SKL-SUB.
033200     MOVE    FILE-RECORD-INFO-SKELETON
033300          TO FILE-RECORD-INFO (REC-SKL-SUB).
033400 CCVS-INIT-EXIT.
033500     GO TO CCVS1-EXIT.
033600 CLOSE-FILES.
033700P    OPEN I-O RAW-DATA.
033800P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
033900P    READ RAW-DATA INVALID KEY GO TO END-E-2.
034000P    MOVE "OK.     " TO C-ABORT.
034100P    MOVE PASS-COUNTER TO C-OK.
034200P    MOVE ERROR-HOLD   TO C-ALL.
034300P    MOVE ERROR-COUNTER TO C-FAIL.
034400P    MOVE DELETE-COUNTER TO C-DELETED.
034500P    MOVE INSPECT-COUNTER TO C-INSPECT.
034600P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
034700PEND-E-2.
034800P    CLOSE RAW-DATA.
034900     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
035000 TERMINATE-CCVS.
035100S    EXIT PROGRAM.
035200STERMINATE-CALL.
035300     STOP     RUN.
035400 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
035500 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
035600 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
035700 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
035800     MOVE "****TEST DELETED****" TO RE-MARK.
035900 PRINT-DETAIL.
036000     IF REC-CT NOT EQUAL TO ZERO
036100             MOVE "." TO PARDOT-X
036200             MOVE REC-CT TO DOTVALUE.
036300     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
036400     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
036500        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
036600          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
036700     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
036800     MOVE SPACE TO CORRECT-X.
036900     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
037000     MOVE     SPACE TO RE-MARK.
037100 HEAD-ROUTINE.
037200     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037300     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037400     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
037500     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
037600 COLUMN-NAMES-ROUTINE.
037700     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037800     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
038000 END-ROUTINE.
038100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
038200 END-RTN-EXIT.
038300     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038400 END-ROUTINE-1.
038500      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
038600      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
038700      ADD PASS-COUNTER TO ERROR-HOLD.
038800*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
038900      MOVE PASS-COUNTER TO CCVS-E-4-1.
039000      MOVE ERROR-HOLD TO CCVS-E-4-2.
039100      MOVE CCVS-E-4 TO CCVS-E-2-2.
039200      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
039300  END-ROUTINE-12.
039400      MOVE "TEST(S) FAILED" TO ENDER-DESC.
039500     IF       ERROR-COUNTER IS EQUAL TO ZERO
039600         MOVE "NO " TO ERROR-TOTAL
039700         ELSE
039800         MOVE ERROR-COUNTER TO ERROR-TOTAL.
039900     MOVE     CCVS-E-2 TO DUMMY-RECORD.
040000     PERFORM WRITE-LINE.
040100 END-ROUTINE-13.
040200     IF DELETE-COUNTER IS EQUAL TO ZERO
040300         MOVE "NO " TO ERROR-TOTAL  ELSE
040400         MOVE DELETE-COUNTER TO ERROR-TOTAL.
040500     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
040600     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
040700      IF   INSPECT-COUNTER EQUAL TO ZERO
040800          MOVE "NO " TO ERROR-TOTAL
040900      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
041000      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
041100      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
041200     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
041300 WRITE-LINE.
041400     ADD 1 TO RECORD-COUNT.
041500Y    IF RECORD-COUNT GREATER 42
041600Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
041700Y        MOVE SPACE TO DUMMY-RECORD
041800Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
041900Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
042000Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
042100Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
042200Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
042300Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
042400Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
042500Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
042600Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
042700Y        MOVE ZERO TO RECORD-COUNT.
042800     PERFORM WRT-LN.
042900 WRT-LN.
043000     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
043100     MOVE SPACE TO DUMMY-RECORD.
043200 BLANK-LINE-PRINT.
043300     PERFORM WRT-LN.
043400 FAIL-ROUTINE.
043500     IF     COMPUTED-X NOT EQUAL TO SPACE
043600            GO TO   FAIL-ROUTINE-WRITE.
043700     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
043800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
043900     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
044000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044100     MOVE   SPACES TO INF-ANSI-REFERENCE.
044200     GO TO  FAIL-ROUTINE-EX.
044300 FAIL-ROUTINE-WRITE.
044400     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
044500     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
044600     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
044700     MOVE   SPACES TO COR-ANSI-REFERENCE.
044800 FAIL-ROUTINE-EX. EXIT.
044900 BAIL-OUT.
045000     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
045100     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
045200 BAIL-OUT-WRITE.
045300     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
045400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
045500     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045600     MOVE   SPACES TO INF-ANSI-REFERENCE.
045700 BAIL-OUT-EX. EXIT.
045800 CCVS1-EXIT.
045900     EXIT.
046000 SECT-IX-03-001 SECTION.
046100 READ-INIT-F1-01.
046200*    THIS FILE "IX-FD1" IS ACCESSED SEQUENTIALLY AND HAS
046300*    ASSOCIATED WITH IT A RECORD KEY WHICH AT ALL TIMES SHOULD
046400*    CONTAIN THE INDEX OF THE RECORD PREVIOUSLY READ.
046500     OPEN INPUT IX-FD1.
046600     MOVE     ZERO TO             WRK-CS-09V00-006.
046700     MOVE     ZERO TO             WRK-CS-09V00-007.
046800     MOVE     ZERO TO             WRK-CS-09V00-008.
046900     MOVE     ZERO TO             WRK-CS-09V00-009.
047000     MOVE     ZERO TO             WRK-CS-09V00-010.
047100     MOVE     ZERO TO             WRK-CS-09V00-011.
047200     MOVE     SPACE TO  FILE-RECORD-INFO (1).
047300     MOVE    ZERO TO WRK-DU-09V00-001.
047400     MOVE    IX-FD1-KEY TO COMPUTED-A.
047500     MOVE    SPACE TO P-OR-F.
047600     MOVE    "INFORMATION" TO CORRECT-A.
047700     MOVE    "KEY AFTER OPEN" TO RE-MARK.
047800     MOVE    "RECORD KEY ON OPEN"  TO FEATURE.
047900     MOVE     "READ-INIT-F1-01" TO PAR-NAME.
048000     PERFORM PRINT-DETAIL.
048100*
048200*
048300*
048400 READ-INIT-F1-01-0.
048500     MOVE    "READ-TEST-F1-01" TO PAR-NAME.
048600     MOVE    "READ  NEXT RECORD"  TO FEATURE.
048700 READ-TEST-F1-01-R.
048800     ADD      1 TO WRK-CS-09V00-006.
048900     READ     IX-FD1  NEXT RECORD
049000              AT END GO TO READ-TEST-F1-01.
049100     MOVE     IX-FD1R1-F-G-240    TO FILE-RECORD-INFO (1).
049200     IF       UPDATE-NUMBER (1) EQUAL TO 00
049300             ADD 1 TO WRK-CS-09V00-007
049400              GO TO READ-TEST-F1-01-2.
049500     IF       UPDATE-NUMBER (1) EQUAL TO 01
049600              ADD 1 TO WRK-CS-09V00-008
049700              GO TO READ-TEST-F1-01-2.
049800     ADD      1 TO WRK-CS-09V00-009.
049900 READ-TEST-F1-01-2.
050000     MOVE    XRECORD-KEY (1)  TO  IX-WRK-KEY.
050100     IF      WRK-DU-09V00-001  NOT EQUAL TO XRECORD-NUMBER (1)
050200              ADD 1 TO  WRK-CS-09V00-010.
050300     IF       WRK-CS-09V00-006  GREATER 501
050400              GO TO READ-TEST-F1-01.
050500     GO TO    READ-TEST-F1-01-R.
050600 READ-TEST-F1-01.
050700     IF       WRK-CS-09V00-006 NOT EQUAL TO 501
050800              MOVE "INCORRECT RECORD COUNT"  TO RE-MARK
050900              MOVE  WRK-CS-09V00-006 TO COMPUTED-18V0
051000              MOVE  500  TO             CORRECT-18V0
051100              MOVE "IX-28; 4.5.2 FORMAT 1    " TO RE-MARK
051200              PERFORM FAIL
051300              ELSE
051400              PERFORM PASS.
051500     PERFORM  PRINT-DETAIL.
051600*
051700*
051800*
051900 READ-TEST-F1-02.
052000     MOVE    "READ-TEST-F1-02" TO PAR-NAME.
052100     MOVE    "READ  NEXT RECORD"  TO FEATURE.
052200     IF       WRK-CS-09V00-007 EQUAL TO 400
052300              PERFORM PASS
052400              ELSE
052500              MOVE "NON-UPDATED RECORDS" TO COMPUTED-A
052600              MOVE  WRK-CS-09V00-007 TO CORRECT-18V0
052700              MOVE "SHOULD BE 400; IX-28; 4.5.2 FORMAT 1    "
052800                                   TO RE-MARK
052900              PERFORM FAIL.
053000     PERFORM  PRINT-DETAIL.
053100*
053200*
053300*
053400 READ-TEST-F1-03.
053500     MOVE    "READ-TEST-F1-03" TO PAR-NAME.
053600     MOVE    "READ  NEXT RECORD"  TO FEATURE.
053700     IF      WRK-CS-09V00-008 EQUAL TO 100
053800              PERFORM PASS
053900              ELSE
054000             MOVE WRK-CS-09V00-008 TO COMPUTED-18V0
054100             MOVE 100             TO  CORRECT-18V0
054200              MOVE "IX-28; 4.5.2 FORMAT 1    " TO RE-MARK
054300              PERFORM FAIL.
054400     PERFORM  PRINT-DETAIL.
054500*
054600 READ-TEST-F1-04.
054700     MOVE    "READ-TEST-F1-04" TO PAR-NAME.
054800     MOVE    "READ  NEXT RECORD"  TO FEATURE.
054900     IF      WRK-CS-09V00-009 EQUAL TO ZERO
055000             PERFORM PASS
055100             ELSE
055200             MOVE WRK-CS-09V00-009 TO COMPUTED-18V0
055300             MOVE  ZERO            TO CORRECT-18V0
055400             MOVE "BAD UPDATES; IX-28; 4.5.2 FORMAT 1    "
055500                                TO RE-MARK
055600             PERFORM FAIL.
055700     PERFORM PRINT-DETAIL.
055800*
055900 READ-TEST-F1-05.
056000     MOVE    "READ-TEST-F1-05" TO PAR-NAME.
056100     MOVE    "READ  NEXT RECORD"  TO FEATURE.
056200     IF      WRK-CS-09V00-010 EQUAL TO ZERO
056300             PERFORM PASS
056400             ELSE
056500             MOVE WRK-CS-09V00-010 TO COMPUTED-18V0
056600             MOVE ZERO             TO CORRECT-18V0
056700             MOVE "IX-28; 4.5.2 FORMAT 1; KEY VS RECORD"
056800                                  TO RE-MARK
056900             PERFORM FAIL.
057000     PERFORM PRINT-DETAIL.
057100     CLOSE    IX-FD1.
057200*
057300*     R E A D     NEXT RECORD
057400*
057500 DELETE-INIT-GF-01.
057600     OPEN     I-O IX-FD1.
057700     MOVE     ZERO TO WRK-CS-09V00-006
057800     MOVE     ZERO TO WRK-CS-09V00-007
057900     MOVE     ZERO TO WRK-CS-09V00-008
058000     MOVE     ZERO TO WRK-CS-09V00-009
058100     MOVE     ZERO TO WRK-CS-09V00-010
058200     MOVE     ZERO TO WRK-CS-09V00-011
058300
058400     MOVE     SPACE TO  FILE-RECORD-INFO (1).
058500     MOVE    "DELETE   "   TO FEATURE.
058600     MOVE     "DELETE-TEST-GF-01" TO PAR-NAME.
058700 DELETE-TEST-GF-01-R.
058800     ADD      1 TO WRK-CS-09V00-006
058900     ADD      1 TO WRK-CS-09V00-007.
059000     READ     IX-FD1  NEXT RECORD
059100              AT END
059200              MOVE "AT END PATH TAKEN " TO RE-MARK
059300              GO TO  DELETE-TEST-GF-01.
059400     MOVE     IX-FD1R1-F-G-240 TO FILE-RECORD-INFO (1).
059500     IF       WRK-CS-09V00-007  EQUAL TO 4
059600              GO TO DELETE-TEST-GF-01-2.
059700     IF       WRK-CS-09V00-006 GREATER 501
059800              MOVE  "AT END NOT TAKEN"  TO RE-MARK
059900              GO TO DELETE-TEST-GF-01.
060000     GO TO    DELETE-TEST-GF-01-R.
060100 DELETE-TEST-GF-01-2.
060200     MOVE     CCVS-PGM-ID TO  XPROGRAM-NAME (1).
060300     MOVE     99 TO UPDATE-NUMBER (1).
060400     MOVE     FILE-RECORD-INFO (1) TO IX-FD1R1-F-G-240.
060500     DELETE IX-FD1 INVALID KEY
060600                    ADD 1 TO WRK-CS-09V00-009
060700                    MOVE ZERO TO WRK-CS-09V00-007
060800                    GO TO DELETE-TEST-GF-01-R.
060900     MOVE     ZERO TO  WRK-CS-09V00-007.
061000     ADD      1 TO  WRK-CS-09V00-008
061100     GO TO    DELETE-TEST-GF-01-R.
061200 DELETE-TEST-GF-01.
061300     IF       WRK-CS-09V00-006 NOT EQUAL TO 501
061400              MOVE WRK-CS-09V00-006 TO COMPUTED-18V0
061500              MOVE              501 TO CORRECT-18V0
061600              MOVE "IX-21; 4.3.2             " TO RE-MARK
061700              PERFORM FAIL
061800              ELSE
061900              PERFORM PASS.
062000     PERFORM  PRINT-DETAIL.
062100*
062200*
062300*
062400 DELETE-TEST-GF-02.
062500     MOVE    "DELETE   "   TO FEATURE.
062600     MOVE     "DELETE-TEST-GF-02" TO PAR-NAME
062700     IF       WRK-CS-09V00-008 NOT EQUAL TO 125
062800              MOVE WRK-CS-09V00-008 TO COMPUTED-18V0
062900              MOVE 125              TO CORRECT-18V0
063000              MOVE "DELETED RECORDS; IX-21; 4.3.2    " TO RE-MARK
063100              PERFORM FAIL
063200              ELSE
063300              PERFORM PASS.
063400     PERFORM  PRINT-DETAIL.
063500*
063600*
063700*
063800 DELETE-TEST-GF-03.
063900     MOVE    "DELETE   "   TO FEATURE.
064000     MOVE     "DELETE-TEST-GF-03" TO PAR-NAME.
064100     IF WRK-CS-09V00-009 EQUAL TO ZERO
064200         PERFORM PASS
064300         ELSE
064400         PERFORM FAIL
064500         MOVE WRK-CS-09V00-009 TO COMPUTED-18V0
064600         MOVE ZERO TO CORRECT-18V0
064700         MOVE "INVALID KEY; IX-21; 4.3.2           " TO RE-MARK.
064800     PERFORM PRINT-DETAIL.
064900     CLOSE    IX-FD1.
065000*
065100*
065200*
065300 DELETE-INIT-GF-04.
065400     MOVE     "DELETE-TEST-GF-04" TO PAR-NAME.
065500     MOVE     ZERO TO   WRK-CS-09V00-006
065600     MOVE     ZERO TO   WRK-CS-09V00-007
065700     MOVE     ZERO TO   WRK-CS-09V00-008
065800     MOVE     ZERO TO   WRK-CS-09V00-009
065900     MOVE     ZERO TO   WRK-CS-09V00-010
066000     MOVE     ZERO TO   WRK-CS-09V00-011
066100     MOVE     SPACE  TO  FILE-RECORD-INFO (1).
066200     MOVE    ZERO TO WRK-DU-09V00-001.
066300     OPEN     INPUT  IX-FD1.
066400 DELETE-TEST-GF-04-R.
066500     ADD      1 TO WRK-CS-09V00-006.
066600     ADD      1 TO WRK-CS-09V00-007.
066700     ADD      1 TO WRK-CS-09V00-008.
066800     READ   IX-FD1 NEXT RECORD  AT END  GO TO DELETE-TEST-GF-04.
066900     MOVE     IX-FD1R1-F-G-240 TO FILE-RECORD-INFO (1).
067000     IF       UPDATE-NUMBER (1) EQUAL TO 99
067100              ADD  1 TO WRK-CS-09V00-009.
067200     IF       WRK-CS-09V00-007  EQUAL TO 4
067300              MOVE 01 TO WRK-CS-09V00-007
067400              ADD 1 TO WRK-CS-09V00-008.
067500     MOVE     XRECORD-KEY (1)  TO  IX-WRK-KEY.
067600     MOVE     WRK-CS-09V00-008  TO WRK-DU-09V00-001.
067700     IF       IX-WRK-KEY  EQUAL TO IX-FD1-KEY
067800              ADD 1 TO  WRK-CS-09V00-010.
067900     IF       XRECORD-NUMBER (1) EQUAL TO  WRK-CS-09V00-008
068000              ADD 1 TO  WRK-CS-09V00-011.
068100     IF       WRK-CS-09V00-006 GREATER  501
068200              GO TO DELETE-TEST-GF-04.
068300     GO TO    DELETE-TEST-GF-04-R.
068400 DELETE-TEST-GF-04.
068500     IF       WRK-CS-09V00-006 NOT EQUAL TO 376
068600              MOVE "IX-21; 4.3.2; INCORRECT RECORD COUNT"
068700                                             TO RE-MARK
068800              MOVE WRK-CS-09V00-006 TO COMPUTED-18V0
068900              MOVE 376 TO CORRECT-18V0
069000              PERFORM  FAIL
069100              ELSE
069200              PERFORM  PASS.
069300     PERFORM  PRINT-DETAIL.
069400*
069500 DELETE-TEST-GF-05.
069600     MOVE    "DELETE   "   TO FEATURE.
069700     MOVE     "DELETE-TEST-GF-05" TO PAR-NAME
069800     IF       WRK-CS-09V00-009 NOT EQUAL TO ZERO
069900              MOVE    ZERO TO CORRECT-18V0
070000              MOVE WRK-CS-09V00-009 TO COMPUTED-18V0
070100              MOVE "IX-21; 4.3.2; DELETED RECORDDS" TO RE-MARK
070200              PERFORM FAIL
070300              ELSE
070400              PERFORM PASS.
070500     PERFORM  PRINT-DETAIL.
070600*
070700 DELETE-TEST-GF-06.
070800     MOVE    "DELETE   "   TO FEATURE.
070900     MOVE     "DELETE-TEST-GF-06" TO PAR-NAME
071000     IF       WRK-CS-09V00-010 NOT EQUAL TO 375
071100              MOVE    375  TO CORRECT-18V0
071200              MOVE "IX-21; 4.3.2; KEY MISMATCH" TO RE-MARK
071300              MOVE WRK-CS-09V00-010 TO COMPUTED-18V0
071400              PERFORM FAIL
071500              ELSE
071600              PERFORM PASS.
071700     PERFORM  PRINT-DETAIL.
071800*
071900 DELETE-TEST-GF-07.
072000     MOVE    "DELETE   "   TO FEATURE.
072100     MOVE     "DELETE-TEST-GF-07" TO PAR-NAME
072200     IF      WRK-CS-09V00-011  NOT EQUAL TO  375
072300             MOVE   375  TO CORRECT-18V0
072400             MOVE   "INCORRECT RECORD FOUND; IX-21, 4.3.2"
072500                   TO RE-MARK
072600             MOVE   WRK-CS-09V00-011  TO COMPUTED-18V0
072700             PERFORM   FAIL
072800             ELSE
072900             PERFORM   PASS.
073000     PERFORM   PRINT-DETAIL.
073100     CLOSE    IX-FD1.
073200
073300
073400 CCVS-999999.
073500     GO TO CLOSE-FILES.
