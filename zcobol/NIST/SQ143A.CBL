000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ143A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 3.0.                                 *
000900*                                                              *
001000*    CREATION DATE     /     VALIDATION DATE                   *
001100*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001200*                                                              *
001300****************************************************************
001400*                                                              *
001500*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001600*                                                              *
001700*            X-01   SEQUENTIAL TAPE                            *
001800*            X-55   SYSTEM PRINTER                             *
001900*            X-82   SOURCE-COMPUTER                            *
002000*            X-83   OBJECT-COMPUTER.                           *
002100*            X-84   LABEL RECORDS OPTION                       *
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    THIS PROGRAM CHECKS FOR THE CORRECT RESPONSE TO CLOSING   *
002600*    AN UNOPENED FILE.  THE TEST FOR CORRECT I-O STATUS CODE   *
002700*    42 IS IN THE MAIN LINE CODE, THEREFORE AN ABNORMAL        *
002800*    TERMINATION IS POSSIBLE BEFORE THE TEST OF THE I-O STATUS *
002900*    CODE IS ACCOMPLISHED.                                     *
003000*                                                              *
003100****************************************************************
003200*
003300 ENVIRONMENT DIVISION.
003400 CONFIGURATION SECTION.
003500 SOURCE-COMPUTER.
003600     XXXXX082.
003700 OBJECT-COMPUTER.
003800     XXXXX083.
003900*
004000 INPUT-OUTPUT SECTION.
004100 FILE-CONTROL.
004200     SELECT PRINT-FILE ASSIGN TO
004300     XXXXX055.
004400*
004500     SELECT SQ-FS1 ASSIGN TO
004600     XXXXX001
004700            FILE STATUS IS SQ-FS1-STATUS.
004800*
004900*
005000 DATA DIVISION.
005100 FILE SECTION.
005200 FD  PRINT-FILE
005300C    LABEL RECORDS
005400C    XXXXX084
005500C    DATA RECORD IS PRINT-REC DUMMY-RECORD
005600               .
005700 01  PRINT-REC    PICTURE X(120).
005800 01  DUMMY-RECORD PICTURE X(120).
005900*
006000 FD  SQ-FS1
006100C    LABEL RECORD IS STANDARD
006200                .
006300 01  SQ-FS1R1-F-G-120 PIC X(120).
006400*
006500 WORKING-STORAGE SECTION.
006600*
006700***************************************************************
006800*                                                             *
006900*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
007000*                                                             *
007100***************************************************************
007200*
007300 01  SQ-FS1-STATUS.
007400   03  SQ-FS1-KEY-1   PIC X.
007500   03  SQ-FS1-KEY-2   PIC X.
007600*
007700***************************************************************
007800*                                                             *
007900*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
008000*                                                             *
008100***************************************************************
008200*
008300 01  REC-SKEL-SUB   PIC 99.
008400*
008500 01  FILE-RECORD-INFORMATION-REC.
008600     03 FILE-RECORD-INFO-SKELETON.
008700        05 FILLER                 PICTURE X(48)       VALUE
008800             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
008900        05 FILLER                 PICTURE X(46)       VALUE
009000             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
009100        05 FILLER                 PICTURE X(26)       VALUE
009200             ",LFIL=000000,ORG=  ,LBLR= ".
009300        05 FILLER                 PICTURE X(37)       VALUE
009400             ",RECKEY=                             ".
009500        05 FILLER                 PICTURE X(38)       VALUE
009600             ",ALTKEY1=                             ".
009700        05 FILLER                 PICTURE X(38)       VALUE
009800             ",ALTKEY2=                             ".
009900        05 FILLER                 PICTURE X(7)        VALUE SPACE.
010000     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
010100        05 FILE-RECORD-INFO-P1-120.
010200           07 FILLER              PIC X(5).
010300           07 XFILE-NAME          PIC X(6).
010400           07 FILLER              PIC X(8).
010500           07 XRECORD-NAME        PIC X(6).
010600           07 FILLER              PIC X(1).
010700           07 REELUNIT-NUMBER     PIC 9(1).
010800           07 FILLER              PIC X(7).
010900           07 XRECORD-NUMBER      PIC 9(6).
011000           07 FILLER              PIC X(6).
011100           07 UPDATE-NUMBER       PIC 9(2).
011200           07 FILLER              PIC X(5).
011300           07 ODO-NUMBER          PIC 9(4).
011400           07 FILLER              PIC X(5).
011500           07 XPROGRAM-NAME       PIC X(5).
011600           07 FILLER              PIC X(7).
011700           07 XRECORD-LENGTH      PIC 9(6).
011800           07 FILLER              PIC X(7).
011900           07 CHARS-OR-RECORDS    PIC X(2).
012000           07 FILLER              PIC X(1).
012100           07 XBLOCK-SIZE         PIC 9(4).
012200           07 FILLER              PIC X(6).
012300           07 RECORDS-IN-FILE     PIC 9(6).
012400           07 FILLER              PIC X(5).
012500           07 XFILE-ORGANIZATION  PIC X(2).
012600           07 FILLER              PIC X(6).
012700           07 XLABEL-TYPE         PIC X(1).
012800        05 FILE-RECORD-INFO-P121-240.
012900           07 FILLER              PIC X(8).
013000           07 XRECORD-KEY         PIC X(29).
013100           07 FILLER              PIC X(9).
013200           07 ALTERNATE-KEY1      PIC X(29).
013300           07 FILLER              PIC X(9).
013400           07 ALTERNATE-KEY2      PIC X(29).
013500           07 FILLER              PIC X(7).
013600*
013700 01  TEST-RESULTS.
013800     02 FILLER              PIC X      VALUE SPACE.
013900     02 FEATURE             PIC X(24)  VALUE SPACE.
014000     02 FILLER              PIC X      VALUE SPACE.
014100     02 P-OR-F              PIC X(5)   VALUE SPACE.
014200     02 FILLER              PIC X      VALUE SPACE.
014300     02  PAR-NAME.
014400       03 FILLER              PIC X(14)  VALUE SPACE.
014500       03 PARDOT-X            PIC X      VALUE SPACE.
014600       03 DOTVALUE            PIC 99     VALUE ZERO.
014700     02 FILLER              PIC X(9)   VALUE SPACE.
014800     02 RE-MARK             PIC X(61).
014900 01  TEST-COMPUTED.
015000   02 FILLER  PIC X(30)  VALUE SPACE.
015100   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
015200   02 COMPUTED-X.
015300     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
015400     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
015500     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
015600     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
015700     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
015800     03       CM-18V0 REDEFINES COMPUTED-A.
015900        04 COMPUTED-18V0                   PIC -9(18).
016000        04 FILLER                          PIC X.
016100     03 FILLER PIC X(50) VALUE SPACE.
016200 01  TEST-CORRECT.
016300     02 FILLER PIC X(30) VALUE SPACE.
016400     02 FILLER PIC X(17) VALUE "       CORRECT =".
016500     02 CORRECT-X.
016600     03 CORRECT-A                  PIC X(20) VALUE SPACE.
016700     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
016800     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
016900     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
017000     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
017100     03      CR-18V0 REDEFINES CORRECT-A.
017200         04 CORRECT-18V0                     PIC -9(18).
017300         04 FILLER                           PIC X.
017400     03 FILLER PIC X(2) VALUE SPACE.
017500     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
017600 01  CCVS-C-1.
017700     02 FILLER  PIC IS X(4)     VALUE SPACE.
017800     02 FILLER  PIC IS X(98)    VALUE IS "FEATURE               PA
017900-    "SS  PARAGRAPH-NAME
018000-    "       REMARKS".
018100     02 FILLER           PIC X(17)    VALUE SPACE.
018200 01  CCVS-C-2.
018300     02 FILLER           PIC XXXX     VALUE SPACE.
018400     02 FILLER           PIC X(6)     VALUE "TESTED".
018500     02 FILLER           PIC X(16)    VALUE SPACE.
018600     02 FILLER           PIC X(4)     VALUE "FAIL".
018700     02 FILLER           PIC X(90)    VALUE SPACE.
018800 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
018900 01  REC-CT            PIC 99       VALUE ZERO.
019000 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
019100 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
019200 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
019300 01  PASS-COUNTER      PIC 999      VALUE ZERO.
019400 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
019500 01  ERROR-HOLD        PIC 999      VALUE ZERO.
019600 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
019700 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
019800 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
019900 01  CCVS-H-1.
020000     02  FILLER          PIC X(39)    VALUE SPACES.
020100     02  FILLER          PIC X(42)    VALUE
020200     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
020300     02  FILLER          PIC X(39)    VALUE SPACES.
020400 01  CCVS-H-2A.
020500   02  FILLER            PIC X(40)  VALUE SPACE.
020600   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
020700   02  FILLER            PIC XXXX   VALUE
020800     "4.2 ".
020900   02  FILLER            PIC X(28)  VALUE
021000            " COPY - NOT FOR DISTRIBUTION".
021100   02  FILLER            PIC X(41)  VALUE SPACE.
021200*
021300 01  CCVS-H-2B.
021400   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
021500   02  TEST-ID           PIC X(9).
021600   02  FILLER            PIC X(4)   VALUE " IN ".
021700   02  FILLER            PIC X(12)  VALUE
021800     " HIGH       ".
021900   02  FILLER            PIC X(22)  VALUE
022000            " LEVEL VALIDATION FOR ".
022100   02  FILLER            PIC X(58)  VALUE
022200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
022300 01  CCVS-H-3.
022400     02  FILLER          PIC X(34)  VALUE
022500            " FOR OFFICIAL USE ONLY    ".
022600     02  FILLER          PIC X(58)  VALUE
022700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022800     02  FILLER          PIC X(28)  VALUE
022900            "  COPYRIGHT   1985,1986 ".
023000 01  CCVS-E-1.
023100     02 FILLER           PIC X(52)  VALUE SPACE.
023200     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
023300     02 ID-AGAIN         PIC X(9).
023400     02 FILLER           PIC X(45)  VALUE SPACES.
023500 01  CCVS-E-2.
023600     02  FILLER          PIC X(31)  VALUE SPACE.
023700     02  FILLER          PIC X(21)  VALUE SPACE.
023800     02  CCVS-E-2-2.
023900         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
024000         03 FILLER         PIC X      VALUE SPACE.
024100         03 ENDER-DESC     PIC X(44)  VALUE
024200            "ERRORS ENCOUNTERED".
024300 01  CCVS-E-3.
024400     02  FILLER          PIC X(22)  VALUE
024500            " FOR OFFICIAL USE ONLY".
024600     02  FILLER          PIC X(12)  VALUE SPACE.
024700     02  FILLER          PIC X(58)  VALUE
024800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024900     02  FILLER          PIC X(8)   VALUE SPACE.
025000     02  FILLER          PIC X(20)  VALUE
025100             " COPYRIGHT 1985,1986".
025200 01  CCVS-E-4.
025300     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
025400     02 FILLER           PIC X(4)   VALUE " OF ".
025500     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
025600     02 FILLER           PIC X(40)  VALUE
025700      "  TESTS WERE EXECUTED SUCCESSFULLY".
025800 01  XXINFO.
025900     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
026000     02 INFO-TEXT.
026100       04 FILLER             PIC X(8)   VALUE SPACE.
026200       04 XXCOMPUTED         PIC X(20).
026300       04 FILLER             PIC X(5)   VALUE SPACE.
026400       04 XXCORRECT          PIC X(20).
026500     02 INF-ANSI-REFERENCE PIC X(48).
026600 01  HYPHEN-LINE.
026700     02 FILLER  PIC IS X VALUE IS SPACE.
026800     02 FILLER  PIC IS X(65)    VALUE IS "************************
026900-    "*****************************************".
027000     02 FILLER  PIC IS X(54)    VALUE IS "************************
027100-    "******************************".
027200 01  CCVS-PGM-ID  PIC X(9)   VALUE
027300     "SQ143A".
027400*
027500 PROCEDURE DIVISION.
027600 CCVS1 SECTION.
027700 OPEN-FILES.
027800     OPEN    OUTPUT PRINT-FILE.
027900     MOVE    CCVS-PGM-ID TO TEST-ID.
028000     MOVE    CCVS-PGM-ID TO ID-AGAIN.
028100     MOVE    SPACE TO TEST-RESULTS.
028200     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
028300     MOVE    ZERO TO REC-SKEL-SUB.
028400     PERFORM CCVS-INIT-FILE 10 TIMES.
028500     GO TO CCVS1-EXIT.
028600*
028700 CCVS-INIT-FILE.
028800     ADD     1 TO REC-SKL-SUB.
028900     MOVE    FILE-RECORD-INFO-SKELETON TO
029000                  FILE-RECORD-INFO (REC-SKL-SUB).
029100*
029200 CLOSE-FILES.
029300     PERFORM END-ROUTINE THRU END-ROUTINE-13.
029400     CLOSE   PRINT-FILE.
029500 TERMINATE-CCVS.
029600     STOP    RUN.
029700*
029800 INSPT.
029900     MOVE   "INSPT" TO P-OR-F.
030000     ADD     1 TO INSPECT-COUNTER.
030100     PERFORM PRINT-DETAIL.
030200
030300 PASS.
030400     MOVE   "PASS " TO P-OR-F.
030500     ADD     1 TO PASS-COUNTER.
030600     PERFORM PRINT-DETAIL.
030700*
030800 FAIL.
030900     MOVE   "FAIL*" TO P-OR-F.
031000     ADD     1 TO ERROR-COUNTER.
031100     PERFORM PRINT-DETAIL.
031200*
031300 DE-LETE.
031400     MOVE   "****TEST DELETED****" TO RE-MARK.
031500     MOVE   "*****" TO P-OR-F.
031600     ADD     1 TO DELETE-COUNTER.
031700     PERFORM PRINT-DETAIL.
031800*
031900 PRINT-DETAIL.
032000     IF REC-CT NOT EQUAL TO ZERO
032100         MOVE   "." TO PARDOT-X
032200         MOVE    REC-CT TO DOTVALUE.
032300     MOVE    TEST-RESULTS TO PRINT-REC.
032400     PERFORM WRITE-LINE.
032500     IF P-OR-F EQUAL TO "FAIL*"
032600         PERFORM WRITE-LINE
032700         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
032800     ELSE
032900         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
033000     MOVE    SPACE TO P-OR-F.
033100     MOVE    SPACE TO COMPUTED-X.
033200     MOVE    SPACE TO CORRECT-X.
033300     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
033400     MOVE    SPACE TO RE-MARK.
033500*
033600 HEAD-ROUTINE.
033700     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033800     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033900     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
034000     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
034100 COLUMN-NAMES-ROUTINE.
034200     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034300     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
034500 END-ROUTINE.
034600     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
034700     PERFORM WRITE-LINE 5 TIMES.
034800 END-RTN-EXIT.
034900     MOVE    CCVS-E-1 TO DUMMY-RECORD.
035000     PERFORM WRITE-LINE 2 TIMES.
035100*
035200 END-ROUTINE-1.
035300     ADD     ERROR-COUNTER   TO ERROR-HOLD
035400     ADD     INSPECT-COUNTER TO ERROR-HOLD.
035500     ADD     DELETE-COUNTER  TO ERROR-HOLD.
035600     ADD     PASS-COUNTER    TO ERROR-HOLD.
035700     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
035800     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
035900     MOVE    CCVS-E-4        TO CCVS-E-2-2.
036000     MOVE    CCVS-E-2        TO DUMMY-RECORD
036100     PERFORM WRITE-LINE.
036200     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
036300     IF ERROR-COUNTER IS EQUAL TO ZERO
036400         MOVE   "NO " TO ERROR-TOTAL
036500     ELSE
036600         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
036700     MOVE    CCVS-E-2 TO DUMMY-RECORD.
036800     PERFORM WRITE-LINE.
036900 END-ROUTINE-13.
037000     IF DELETE-COUNTER IS EQUAL TO ZERO
037100         MOVE   "NO " TO ERROR-TOTAL
037200     ELSE
037300         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
037400     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
037500     MOVE    CCVS-E-2 TO DUMMY-RECORD.
037600     PERFORM WRITE-LINE.
037700     IF INSPECT-COUNTER EQUAL TO ZERO
037800         MOVE   "NO " TO ERROR-TOTAL
037900     ELSE
038000         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
038100     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
038200     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038300     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038400*
038500 WRITE-LINE.
038600     ADD     1 TO RECORD-COUNT.
038700Y    IF RECORD-COUNT GREATER 50
038800Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
038900Y        MOVE  SPACE TO DUMMY-RECORD
039000Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
039100Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
039200Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
039300Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
039400Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
039500Y        MOVE  ZERO TO RECORD-COUNT.
039600     PERFORM WRT-LN.
039700*
039800 WRT-LN.
039900     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
040000     MOVE    SPACE TO DUMMY-RECORD.
040100 BLANK-LINE-PRINT.
040200     PERFORM WRT-LN.
040300 FAIL-ROUTINE.
040400     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
040500     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
040600     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
040700     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
040800     MOVE    XXINFO TO DUMMY-RECORD.
040900     PERFORM WRITE-LINE 2 TIMES.
041000     MOVE    SPACES TO INF-ANSI-REFERENCE.
041100     GO TO   FAIL-ROUTINE-EX.
041200 FAIL-ROUTINE-WRITE.
041300     MOVE    TEST-COMPUTED  TO PRINT-REC
041400     PERFORM WRITE-LINE
041500     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
041600     MOVE    TEST-CORRECT   TO PRINT-REC
041700     PERFORM WRITE-LINE 2 TIMES.
041800     MOVE    SPACES         TO COR-ANSI-REFERENCE.
041900 FAIL-ROUTINE-EX.
042000     EXIT.
042100 BAIL-OUT.
042200     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
042300     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
042400 BAIL-OUT-WRITE.
042500     MOVE    CORRECT-A      TO XXCORRECT.
042600     MOVE    COMPUTED-A     TO XXCOMPUTED.
042700     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
042800     MOVE    XXINFO TO DUMMY-RECORD.
042900     PERFORM WRITE-LINE 2 TIMES.
043000     MOVE    SPACES TO INF-ANSI-REFERENCE.
043100 BAIL-OUT-EX.
043200     EXIT.
043300 CCVS1-EXIT.
043400     EXIT.
043500*
043600****************************************************************
043700*                                                              *
043800*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
043900*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
044000*                                                              *
044100****************************************************************
044200*
044300 SECT-SQ143A-0001 SECTION.
044400 CLOSE-INIT-01.
044500*
044600*        THIS TEST CLOSES A FILE THAT HAS NEVER BEEN OPENED.
044700*        I-O STATUS CODE 42 SHOULD BE GENERATED.
044800*
044900     MOVE "CLOSE UNOPENED FILE" TO FEATURE.
045000     MOVE "**" TO SQ-FS1-STATUS.
045100     MOVE  "CLOSE-TEST-01" TO PAR-NAME.
045200     MOVE 1 TO REC-CT.
045300     MOVE "ABNORMAL TERMINATION AT THIS POINT IS ACCEPTABLE"
045400                 TO DUMMY-RECORD.
045500     PERFORM WRITE-LINE 3 TIMES.
045600 CLOSE-TEST-01.
045700     IF REC-CT = 0
045800         OPEN INPUT SQ-FS1.
045900*    THIS IF STATEMENT SHOULD NEVER BE TRUE.  IT IS INCLUDED IN
046000*    AN ATTEMPT TO AVOID A COMPILER DETECTING THE CLOSE OF AN
046100*    UNOPENED FILE WITHOUT EXECUTING THE PROGRAM.  HOWEVER, IF
046200*    THE DETECTION IS MADE AT COMPILE TIME, THE TEST SHOULD BE
046300*    CONSIDERED PASSED.
046400*
046500     CLOSE SQ-FS1.
046600     IF SQ-FS1-STATUS = "42"
046700             PERFORM PASS
046800     ELSE
046900             MOVE "42" TO CORRECT-A
047000             MOVE SQ-FS1-STATUS TO COMPUTED-A
047100             MOVE "STATUS FOR CLOSE OF UNOPENED FILE INCORRECT"
047200                 TO RE-MARK
047300             MOVE "VII-3, FILE STATUS" TO ANSI-REFERENCE
047400             PERFORM FAIL
047500     END-IF.
047600*
047700 CCVS-EXIT SECTION.
047800 CCVS-999999.
047900     GO TO CLOSE-FILES.
