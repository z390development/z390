000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ116A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300
001400*        THIS PROGRAM CREATES A SEQUENTIAL MASS STORAGE FILE
001500*    OF 550 RECORDS.  THE FILE IS THEN OPENED IN THE I-O MODE AND
001600*    RECORDS ARE UPDATED USING REWRITE...FROM STATEMENTS.  THE
001700*    FILE IS THEN READ AGAIN CHECKING EACH RECORD TO ENSURE
001800*    THE REWRITES WERE EXECUTED CORRECTLY.
001900*
002000*    USED X-CARDS:
002100*         XXXXX014
002200*         XXXXX055
002300*     P   XXXXX062
002400*         XXXXX082
002500*         XXXXX083
002600*     C   XXXXX084
002700*
002800*
002900 ENVIRONMENT DIVISION.
003000 CONFIGURATION SECTION.
003100 SOURCE-COMPUTER.
003200     XXXXX082.
003300 OBJECT-COMPUTER.
003400     XXXXX083.
003500 INPUT-OUTPUT SECTION.
003600 FILE-CONTROL.
003700P    SELECT RAW-DATA   ASSIGN TO
003800P    XXXXX062
003900P           ORGANIZATION IS INDEXED
004000P           ACCESS MODE IS RANDOM
004100P           RECORD KEY IS RAW-DATA-KEY.
004200     SELECT PRINT-FILE ASSIGN TO
004300     XXXXX055.
004400     SELECT SQ-FS6 ASSIGN
004500     XXXXX014
004600     ORGANIZATION SEQUENTIAL
004700     ACCESS MODE SEQUENTIAL.
004800 DATA DIVISION.
004900 FILE SECTION.
005000P
005100PFD  RAW-DATA.
005200P
005300P01  RAW-DATA-SATZ.
005400P    05  RAW-DATA-KEY        PIC X(6).
005500P    05  C-DATE              PIC 9(6).
005600P    05  C-TIME              PIC 9(8).
005700P    05  C-NO-OF-TESTS       PIC 99.
005800P    05  C-OK                PIC 999.
005900P    05  C-ALL               PIC 999.
006000P    05  C-FAIL              PIC 999.
006100P    05  C-DELETED           PIC 999.
006200P    05  C-INSPECT           PIC 999.
006300P    05  C-NOTE              PIC X(13).
006400P    05  C-INDENT            PIC X.
006500P    05  C-ABORT             PIC X(8).
006600 FD  PRINT-FILE
006700C    LABEL RECORDS
006800C    XXXXX084
006900C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007000               .
007100 01  PRINT-REC PICTURE X(120).
007200 01  DUMMY-RECORD PICTURE X(120).
007300 FD  SQ-FS6
007400C    LABEL RECORD STANDARD
007500               .
007600 01  SQ-FS6R1-F-G-130.
007700     02  SQ-FS6R1-PART1  PICTURE X(120).
007800     02  SQ-FS6R1-PART2  PICTURE X(10).
007900 WORKING-STORAGE SECTION.
008000 01  COUNT-OF-RECS PICTURE S9(5) COMPUTATIONAL.
008100 01  RECORDS-IN-ERROR PIC S9(5) COMP VALUE ZERO.
008200 01  ERROR-FLAG PIC 9.
008300 01  EOF-FLAG PIC 9.
008400 01  END-OF-RECORD-AREA.
008500     02  UPDATE-AREA-ONLY  PIC X(6).
008600     02  NUMBER-AREA   PIC 9999.
008700 01  REWRT-FROM-AREA1.
008800     02  AREA1-1 PICTURE X(120).
008900     02  AREA1-2.
009000         03  AREA1-21 PIC X(6).
009100         03  AREA1-22 PIC 9999.
009200 01  REWRT-FROM-AREA2.
009300     02  AREA2-1.
009400         03  AREA2-11 PIC X(120).
009500         03  AREA2-12 PIC X(6).
009600         03  AREA2-13 PIC 9999.
009700     02  AREA2-2  PIC X(9).
009800 01  RWRT-FROM-AREA3.
009900     02  AREA3-1  PICTURE X(87).
010000 01  FOLLOWS-AREA3 PICTURE X(9).
010100 01  FILE-RECORD-INFORMATION-REC.
010200     03 FILE-RECORD-INFO-SKELETON.
010300        05 FILLER                 PICTURE X(48)       VALUE
010400             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
010500        05 FILLER                 PICTURE X(46)       VALUE
010600             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
010700        05 FILLER                 PICTURE X(26)       VALUE
010800             ",LFIL=000000,ORG=  ,LBLR= ".
010900        05 FILLER                 PICTURE X(37)       VALUE
011000             ",RECKEY=                             ".
011100        05 FILLER                 PICTURE X(38)       VALUE
011200             ",ALTKEY1=                             ".
011300        05 FILLER                 PICTURE X(38)       VALUE
011400             ",ALTKEY2=                             ".
011500        05 FILLER                 PICTURE X(7)        VALUE SPACE.
011600     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
011700        05 FILE-RECORD-INFO-P1-120.
011800           07 FILLER              PIC X(5).
011900           07 XFILE-NAME           PIC X(6).
012000           07 FILLER              PIC X(8).
012100           07 XRECORD-NAME         PIC X(6).
012200           07 FILLER              PIC X(1).
012300           07 REELUNIT-NUMBER     PIC 9(1).
012400           07 FILLER              PIC X(7).
012500           07 XRECORD-NUMBER       PIC 9(6).
012600           07 FILLER              PIC X(6).
012700           07 UPDATE-NUMBER       PIC 9(2).
012800           07 FILLER              PIC X(5).
012900           07 ODO-NUMBER          PIC 9(4).
013000           07 FILLER              PIC X(5).
013100           07 XPROGRAM-NAME        PIC X(5).
013200           07 FILLER              PIC X(7).
013300           07 XRECORD-LENGTH       PIC 9(6).
013400           07 FILLER              PIC X(7).
013500           07 CHARS-OR-RECORDS    PIC X(2).
013600           07 FILLER              PIC X(1).
013700           07 XBLOCK-SIZE          PIC 9(4).
013800           07 FILLER              PIC X(6).
013900           07 RECORDS-IN-FILE     PIC 9(6).
014000           07 FILLER              PIC X(5).
014100           07 XFILE-ORGANIZATION   PIC X(2).
014200           07 FILLER              PIC X(6).
014300           07 XLABEL-TYPE          PIC X(1).
014400        05 FILE-RECORD-INFO-P121-240.
014500           07 FILLER              PIC X(8).
014600           07 XRECORD-KEY          PIC X(29).
014700           07 FILLER              PIC X(9).
014800           07 ALTERNATE-KEY1      PIC X(29).
014900           07 FILLER              PIC X(9).
015000           07 ALTERNATE-KEY2      PIC X(29).
015100           07 FILLER              PIC X(7).
015200 01  TEST-RESULTS.
015300     02 FILLER                    PICTURE X VALUE SPACE.
015400     02 FEATURE                   PICTURE X(20) VALUE SPACE.
015500     02 FILLER                    PICTURE X VALUE SPACE.
015600     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
015700     02 FILLER                    PICTURE X  VALUE SPACE.
015800     02  PAR-NAME.
015900       03 FILLER PICTURE X(12) VALUE SPACE.
016000       03  PARDOT-X PICTURE X  VALUE SPACE.
016100       03 DOTVALUE PICTURE 99  VALUE ZERO.
016200       03 FILLER PIC X(5) VALUE SPACE.
016300     02 FILLER PIC X(10) VALUE SPACE.
016400     02 RE-MARK PIC X(61).
016500 01  TEST-COMPUTED.
016600     02 FILLER PIC X(30) VALUE SPACE.
016700     02 FILLER PIC X(17) VALUE "       COMPUTED=".
016800     02 COMPUTED-X.
016900     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
017000     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
017100     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
017200     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
017300     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
017400     03       CM-18V0 REDEFINES COMPUTED-A.
017500         04 COMPUTED-18V0                   PICTURE -9(18).
017600         04 FILLER                          PICTURE X.
017700     03 FILLER PIC X(50) VALUE SPACE.
017800 01  TEST-CORRECT.
017900     02 FILLER PIC X(30) VALUE SPACE.
018000     02 FILLER PIC X(17) VALUE "       CORRECT =".
018100     02 CORRECT-X.
018200     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
018300     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
018400     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
018500     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
018600     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
018700     03      CR-18V0 REDEFINES CORRECT-A.
018800         04 CORRECT-18V0                    PICTURE -9(18).
018900         04 FILLER                          PICTURE X.
019000     03 FILLER PIC X(50) VALUE SPACE.
019100 01  CCVS-C-1.
019200     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
019300-    "SS  PARAGRAPH-NAME
019400-    "        REMARKS".
019500     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
019600 01  CCVS-C-2.
019700     02 FILLER PICTURE IS X VALUE IS SPACE.
019800     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
019900     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
020000     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
020100     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
020200 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
020300 01  REC-CT PICTURE 99 VALUE ZERO.
020400 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
020500 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
020600 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
020700 01  PASS-COUNTER PIC 999 VALUE ZERO.
020800 01  TOTAL-ERROR PIC 999 VALUE ZERO.
020900 01  ERROR-HOLD PIC 999 VALUE ZERO.
021000 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
021100 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
021200 01  CCVS-H-1.
021300     02  FILLER   PICTURE X(27)  VALUE SPACE.
021400     02 FILLER PICTURE X(67) VALUE
021500     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
021600-    " SYSTEM".
021700     02  FILLER     PICTURE X(26)  VALUE SPACE.
021800 01  CCVS-H-2.
021900     02 FILLER PICTURE X(52) VALUE IS
022000     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
022100     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
022200     02 TEST-ID PICTURE IS X(9).
022300     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
022400 01  CCVS-H-3.
022500     02  FILLER PICTURE X(34) VALUE
022600     " FOR OFFICIAL USE ONLY    ".
022700     02  FILLER PICTURE X(58) VALUE
022800     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022900     02  FILLER PICTURE X(28) VALUE
023000     "  COPYRIGHT   1985 ".
023100 01  CCVS-E-1.
023200     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
023300     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
023400     02 ID-AGAIN PICTURE IS X(9).
023500     02 FILLER PICTURE X(45) VALUE IS
023600     " NTIS DISTRIBUTION COBOL 85".
023700 01  CCVS-E-2.
023800     02  FILLER                   PICTURE X(31)  VALUE
023900     SPACE.
024000     02  FILLER                   PICTURE X(21)  VALUE SPACE.
024100     02 CCVS-E-2-2.
024200         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
024300         03 FILLER PICTURE IS X VALUE IS SPACE.
024400         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
024500 01  CCVS-E-3.
024600     02  FILLER PICTURE X(22) VALUE
024700     " FOR OFFICIAL USE ONLY".
024800     02  FILLER PICTURE X(12) VALUE SPACE.
024900     02  FILLER PICTURE X(58) VALUE
025000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025100     02  FILLER PICTURE X(13) VALUE SPACE.
025200     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
025300 01  CCVS-E-4.
025400     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
025500     02 FILLER PIC XXXX VALUE " OF ".
025600     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
025700     02 FILLER PIC X(40) VALUE
025800      "  TESTS WERE EXECUTED SUCCESSFULLY".
025900 01  XXINFO.
026000     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
026100     02 INFO-TEXT.
026200     04 FILLER PIC X(20) VALUE SPACE.
026300     04 XXCOMPUTED PIC X(20).
026400     04 FILLER PIC X(5) VALUE SPACE.
026500     04 XXCORRECT PIC X(20).
026600 01  HYPHEN-LINE.
026700     02 FILLER PICTURE IS X VALUE IS SPACE.
026800     02 FILLER PICTURE IS X(65) VALUE IS "************************
026900-    "*****************************************".
027000     02 FILLER PICTURE IS X(54) VALUE IS "************************
027100-    "******************************".
027200 01  CCVS-PGM-ID PIC X(6) VALUE
027300     "SQ116A".
027400 PROCEDURE DIVISION.
027500 CCVS1 SECTION.
027600 OPEN-FILES.
027700P    OPEN I-O RAW-DATA.
027800P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
027900P    READ RAW-DATA INVALID KEY GO TO END-E-1.
028000P    MOVE "ABORTED " TO C-ABORT.
028100P    ADD 1 TO C-NO-OF-TESTS.
028200P    ACCEPT C-DATE  FROM DATE.
028300P    ACCEPT C-TIME  FROM TIME.
028400P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
028500PEND-E-1.
028600P    CLOSE RAW-DATA.
028700     OPEN     OUTPUT PRINT-FILE.
028800     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
028900     MOVE    SPACE TO TEST-RESULTS.
029000     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
029100     MOVE ZERO TO REC-SKL-SUB.
029200     PERFORM CCVS-INIT-FILE 9 TIMES.
029300 CCVS-INIT-FILE.
029400     ADD 1 TO REC-SKL-SUB.
029500     MOVE FILE-RECORD-INFO-SKELETON TO
029600                  FILE-RECORD-INFO (REC-SKL-SUB).
029700 CCVS-INIT-EXIT.
029800     GO TO CCVS1-EXIT.
029900 CLOSE-FILES.
030000     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
030100P    OPEN I-O RAW-DATA.
030200P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
030300P    READ RAW-DATA INVALID KEY GO TO END-E-2.
030400P    MOVE "OK.     " TO C-ABORT.
030500P    MOVE PASS-COUNTER TO C-OK.
030600P    MOVE ERROR-HOLD   TO C-ALL.
030700P    MOVE ERROR-COUNTER TO C-FAIL.
030800P    MOVE DELETE-CNT TO C-DELETED.
030900P    MOVE INSPECT-COUNTER TO C-INSPECT.
031000P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
031100PEND-E-2.
031200P    CLOSE RAW-DATA.
031300 TERMINATE-CCVS.
031400S    EXIT PROGRAM.
031500STERMINATE-CALL.
031600     STOP     RUN.
031700 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
031800 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
031900 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
032000 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
032100     MOVE "****TEST DELETED****" TO RE-MARK.
032200 PRINT-DETAIL.
032300     IF REC-CT NOT EQUAL TO ZERO
032400             MOVE "." TO PARDOT-X
032500             MOVE REC-CT TO DOTVALUE.
032600     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
032700     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
032800        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
032900          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
033000     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
033100     MOVE SPACE TO CORRECT-X.
033200     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
033300     MOVE     SPACE TO RE-MARK.
033400 HEAD-ROUTINE.
033500     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033600     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033700     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
033800 COLUMN-NAMES-ROUTINE.
033900     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034000     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
034200 END-ROUTINE.
034300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
034400 END-RTN-EXIT.
034500     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034600 END-ROUTINE-1.
034700      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
034800      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
034900      ADD PASS-COUNTER TO ERROR-HOLD.
035000*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
035100      MOVE PASS-COUNTER TO CCVS-E-4-1.
035200      MOVE ERROR-HOLD TO CCVS-E-4-2.
035300      MOVE CCVS-E-4 TO CCVS-E-2-2.
035400      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
035500  END-ROUTINE-12.
035600      MOVE "TEST(S) FAILED" TO ENDER-DESC.
035700     IF       ERROR-COUNTER IS EQUAL TO ZERO
035800         MOVE "NO " TO ERROR-TOTAL
035900         ELSE
036000         MOVE ERROR-COUNTER TO ERROR-TOTAL.
036100     MOVE     CCVS-E-2 TO DUMMY-RECORD.
036200     PERFORM WRITE-LINE.
036300 END-ROUTINE-13.
036400     IF DELETE-CNT IS EQUAL TO ZERO
036500         MOVE "NO " TO ERROR-TOTAL  ELSE
036600         MOVE DELETE-CNT TO ERROR-TOTAL.
036700     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
036800     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036900      IF   INSPECT-COUNTER EQUAL TO ZERO
037000          MOVE "NO " TO ERROR-TOTAL
037100      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
037200      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
037300      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037400     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037500 WRITE-LINE.
037600     ADD 1 TO RECORD-COUNT.
037700Y    IF RECORD-COUNT GREATER 50
037800Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
037900Y        MOVE SPACE TO DUMMY-RECORD
038000Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
038100Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
038200Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
038300Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
038400Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
038500Y        MOVE ZERO TO RECORD-COUNT.
038600     PERFORM WRT-LN.
038700 WRT-LN.
038800     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
038900     MOVE SPACE TO DUMMY-RECORD.
039000 BLANK-LINE-PRINT.
039100     PERFORM WRT-LN.
039200 FAIL-ROUTINE.
039300     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
039400     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
039500     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
039600     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039700     GO TO FAIL-ROUTINE-EX.
039800 FAIL-ROUTINE-WRITE.
039900     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
040000     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
040100 FAIL-ROUTINE-EX. EXIT.
040200 BAIL-OUT.
040300     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
040400     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
040500 BAIL-OUT-WRITE.
040600     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
040700     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040800 BAIL-OUT-EX. EXIT.
040900 CCVS1-EXIT.
041000     EXIT.
041100 SECT-SQ116A-0001 SECTION.
041200 SEQ-INIT-023.
041300     MOVE "SQ-FS6" TO XFILE-NAME (1).
041400     MOVE "R1-F-G" TO XRECORD-NAME (1).
041500     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
041600     MOVE 130 TO XRECORD-LENGTH (1).
041700     MOVE "RC" TO CHARS-OR-RECORDS (1).
041800     MOVE 0001 TO XBLOCK-SIZE (1).
041900     MOVE 000550 TO RECORDS-IN-FILE (1).
042000     MOVE "SQ" TO XFILE-ORGANIZATION (1).
042100     MOVE "O" TO XLABEL-TYPE (1).
042200     MOVE "FIRST " TO UPDATE-AREA-ONLY.
042300     MOVE ZERO TO COUNT-OF-RECS.
042400     OPEN OUTPUT SQ-FS6.
042500 SEQ-TEST-023.
042600     ADD 1 TO COUNT-OF-RECS.
042700     MOVE COUNT-OF-RECS TO XRECORD-NUMBER (1).
042800     MOVE COUNT-OF-RECS TO NUMBER-AREA.
042900     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-FS6R1-PART1.
043000     MOVE END-OF-RECORD-AREA TO SQ-FS6R1-PART2.
043100     WRITE SQ-FS6R1-F-G-130.
043200     IF COUNT-OF-RECS EQUAL TO 550
043300          GO TO SEQ-WRITE-023.
043400     GO TO SEQ-TEST-023.
043500 SEQ-WRITE-023.
043600     MOVE "CREATE FILE SQ-FS6" TO FEATURE.
043700     MOVE "SEQ-WRITE-023" TO PAR-NAME.
043800     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
043900     MOVE COUNT-OF-RECS TO CORRECT-18V0.
044000     PERFORM PRINT-DETAIL.
044100     CLOSE SQ-FS6.
044200*        A SEQUENTIAL MASS STORAGE FILE WITH 130 CHARACTER
044300*    RECORDS HAS BEEN CREATED.  THE FILE CONTAINS 550 RECORDS.
044400 SEQ-INIT-024.
044500     MOVE ZERO TO COUNT-OF-RECS.
044600*        THIS TEST VERIFIES THE FILE CREATED IN SEQ-TEST-023.
044700     OPEN INPUT SQ-FS6.
044800 SEQ-TEST-024.
044900     READ SQ-FS6 AT END GO TO SEQ-TEST-024-1.
045000     ADD 1 TO COUNT-OF-RECS.
045100     IF COUNT-OF-RECS GREATER THAN 550
045200         MOVE "MORE THAN 550 RECORDS" TO RE-MARK
045300         GO TO SEQ-FAIL-024.
045400     MOVE SQ-FS6R1-PART1 TO FILE-RECORD-INFO-P1-120 (1).
045500     MOVE SQ-FS6R1-PART2 TO END-OF-RECORD-AREA.
045600     IF UPDATE-AREA-ONLY NOT EQUAL TO "FIRST "
045700        GO TO SEQ-FAIL-024-1.
045800     IF NUMBER-AREA NOT EQUAL TO COUNT-OF-RECS
045900        GO TO SEQ-FAIL-024-1.
046000     IF XRECORD-NUMBER (1) NOT EQUAL TO COUNT-OF-RECS
046100        GO TO SEQ-FAIL-024-1.
046200     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS6"
046300        GO TO SEQ-FAIL-024-1.
046400     IF UPDATE-NUMBER (1) NOT EQUAL TO ZERO
046500        GO TO SEQ-FAIL-024-1.
046600     IF XLABEL-TYPE (1) NOT EQUAL TO "O"
046700        GO TO SEQ-FAIL-024-1.
046800     GO TO SEQ-TEST-024.
046900 SEQ-FAIL-024-1.
047000     ADD 1 TO RECORDS-IN-ERROR.
047100     GO TO SEQ-TEST-024.
047200 SEQ-TEST-024-1.
047300     IF RECORDS-IN-ERROR EQUAL TO 0
047400          GO TO SEQ-PASS-024.
047500     MOVE "ERRORS IN READING SQ-FS6" TO RE-MARK.
047600 SEQ-FAIL-024.
047700     MOVE "RECORDS IN ERROR =" TO COMPUTED-A.
047800     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
047900     PERFORM FAIL.
048000     GO TO SEQ-WRITE-024.
048100 SEQ-PASS-024.
048200     PERFORM PASS.
048300     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
048400     MOVE COUNT-OF-RECS TO CORRECT-18V0.
048500 SEQ-WRITE-024.
048600     MOVE "SEQ-TEST-024" TO PAR-NAME.
048700     MOVE "VERIFY FILE SQ-FS6" TO FEATURE.
048800     PERFORM PRINT-DETAIL.
048900 SEQ-CLOSE-024.
049000     CLOSE SQ-FS6.
049100 REWRITE-INIT-GF-01.
049200     OPEN I-O SQ-FS6.
049300     MOVE 0 TO COUNT-OF-RECS.
049400     MOVE 0 TO EOF-FLAG.
049500     MOVE 0 TO ERROR-FLAG.
049600*       SKIP THE FIRST 30 RECORDS.
049700     PERFORM READ-SQ-FS6 THRU READ-SQ-FS6-EXIT 30 TIMES.
049800     IF EOF-FLAG EQUAL TO 1
049900         GO TO CANT-TEST.
050000     GO TO REWRITE-TEST-GF-01.
050100 READ-SQ-FS6.
050200     IF EOF-FLAG EQUAL TO 1
050300         GO TO READ-SQ-FS6-EXIT.
050400     READ SQ-FS6 AT END
050500          MOVE 1 TO EOF-FLAG.
050600     ADD 1 TO COUNT-OF-RECS.
050700 READ-SQ-FS6-EXIT.
050800     EXIT.
050900 REWRITE-TEST-GF-01.
051000*        THIS TEST REWRITES RECORDS FROM A WORKING-STORAGE AREA
051100*    THE SAME SIZE AS THE FD 01 RECORD AREA.  A CHECK IS MADE TO
051200*    ENSURE THAT THE FROM AREA WAS NOT DESTROYED BY THE REWRITE...
051300*    FROM STATEMENT.
051400     IF COUNT-OF-RECS EQUAL TO 80
051500         GO TO REWRITE-TEST-GF-01-1.
051600     READ SQ-FS6 RECORD
051700           AT END GO TO CANT-TEST.
051800     ADD 1 TO COUNT-OF-RECS.
051900     MOVE SQ-FS6R1-PART1 TO FILE-RECORD-INFO-P1-120 (1).
052000     ADD 1 TO UPDATE-NUMBER (1).
052100     MOVE FILE-RECORD-INFO-P1-120 (1) TO AREA1-1.
052200     MOVE SQ-FS6R1-PART2 TO AREA1-2.
052300     MOVE "SECOND" TO AREA1-21.
052400     REWRITE SQ-FS6R1-F-G-130 FROM REWRT-FROM-AREA1.
052500     IF AREA1-1 NOT EQUAL TO FILE-RECORD-INFO-P1-120 (1)
052600         GO TO REWRITE-FAIL-GF-01-1.
052700     IF AREA1-21 NOT EQUAL TO "SECOND"
052800         GO TO REWRITE-FAIL-GF-01-1.
052900     IF AREA1-22 EQUAL TO COUNT-OF-RECS
053000         GO TO REWRITE-TEST-GF-01.
053100 REWRITE-FAIL-GF-01-1.
053200     MOVE 1 TO ERROR-FLAG.
053300     GO TO REWRITE-TEST-GF-01.
053400 REWRITE-TEST-GF-01-1.
053500     IF ERROR-FLAG EQUAL TO ZERO
053600         GO TO REWRITE-PASS-GF-01.
053700 REWRITE-FAIL-GF-01.
053800     MOVE "FROM AREA CLOBBERED" TO COMPUTED-A.
053900     MOVE "VII-48; 4.5.2                            " TO  RE-MARK.
054000     PERFORM FAIL.
054100     GO TO REWRITE-WRITE-GF-01.
054200 REWRITE-PASS-GF-01.
054300     PERFORM PASS.
054400 REWRITE-WRITE-GF-01.
054500     MOVE "RWRT-TEST-GF-01" TO PAR-NAME.
054600     MOVE "REWRITE...FROM 01 L" TO FEATURE.
054700     PERFORM PRINT-DETAIL.
054800 REWRITE-INIT-GF-02-A.
054900*        THIS TEST REWRITES A RECORD FROM A WORKING-STORAGE AREA
055000*    LARGER THAN THE FD 01 RECORD AREA.  TRUNCATION SHOULD
055100*    OCCUR ON THE RIGHTMOST CHARACTERS.
055200     READ SQ-FS6 RECORD
055300         AT END GO TO CANT-TEST.
055400     ADD 1 TO COUNT-OF-RECS.
055500     MOVE SQ-FS6R1-PART1 TO FILE-RECORD-INFO-P1-120 (1).
055600     ADD 1 TO UPDATE-NUMBER (1).
055700     MOVE FILE-RECORD-INFO-P1-120 (1) TO AREA2-11.
055800     MOVE "SECOND" TO AREA2-12.
055900     MOVE COUNT-OF-RECS TO AREA2-13.
056000     MOVE "JUNK-AREA" TO AREA2-2.
056100     REWRITE SQ-FS6R1-F-G-130 FROM REWRT-FROM-AREA2.
056200     IF COUNT-OF-RECS EQUAL TO 120
056300         GO TO REWRITE-INIT-GF-03-A.
056400     GO TO REWRITE-INIT-GF-02-A.
056500 REWRITE-INIT-GF-03-A.
056600*        THIS TEST REWRITES A RECORD FROM AN 87 CHARACTER
056700*    WORKING-STORAGE ITEM.  THE REST OF THE 130 CHARACTERS
056800*    SHOULD BE SPACE FILLED DURING THE REWRITE STATEMENT.
056900     READ SQ-FS6 RECORD
057000         AT END GO TO CANT-TEST.
057100     ADD 1 TO COUNT-OF-RECS.
057200     MOVE SQ-FS6R1-PART1 TO FILE-RECORD-INFO-P1-120 (1).
057300     ADD 1 TO UPDATE-NUMBER (1).
057400     MOVE FILE-RECORD-INFO-P1-120 (1) TO AREA3-1.
057500     MOVE "JUNK-AREA" TO FOLLOWS-AREA3.
057600     REWRITE SQ-FS6R1-F-G-130 FROM RWRT-FROM-AREA3.
057700     IF COUNT-OF-RECS EQUAL TO 160
057800         GO TO REWRITE-INIT-GF-04-A.
057900     GO TO REWRITE-INIT-GF-03-A.
058000 REWRITE-INIT-GF-04-A.
058100*        THIS TEST REWRITES A RECORD FROM AN 02 LEVEL DATA ITEM.
058200     READ SQ-FS6 RECORD
058300          AT END GO TO CANT-TEST.
058400     ADD 1 TO COUNT-OF-RECS.
058500     MOVE SQ-FS6R1-PART1 TO FILE-RECORD-INFO-P1-120 (1).
058600     ADD 1 TO UPDATE-NUMBER (1).
058700     MOVE FILE-RECORD-INFO-P1-120 (1) TO AREA2-11.
058800     MOVE "SECOND" TO AREA2-12.
058900     MOVE COUNT-OF-RECS TO AREA2-13.
059000     MOVE "JUNK-AREA" TO AREA2-2.
059100     REWRITE SQ-FS6R1-F-G-130 FROM AREA2-1.
059200     IF COUNT-OF-RECS EQUAL TO 200
059300         GO TO REWRITE-INIT-GF-05-A.
059400     GO TO REWRITE-INIT-GF-04-A.
059500 REWRITE-INIT-GF-05-A.
059600*        THIS TEST REWRITES A RECORD FROM A SUBSCRIPTED DATA
059700*    ITEM OF 120 CHARACTERS.  THE DATA ITEM IS LEVEL 05.
059800     READ SQ-FS6 RECORD
059900         AT END GO TO CANT-TEST.
060000     ADD 1 TO COUNT-OF-RECS.
060100     MOVE SQ-FS6R1-PART1 TO FILE-RECORD-INFO-P1-120 (2).
060200     ADD 1 TO UPDATE-NUMBER (2).
060300     MOVE SPACE TO SQ-FS6R1-PART2.
060400     REWRITE SQ-FS6R1-F-G-130 FROM FILE-RECORD-INFO-P1-120 (2).
060500     IF COUNT-OF-RECS EQUAL TO 240
060600         GO TO REWRITE-CLOSE-SQ-FS6.
060700     GO TO REWRITE-INIT-GF-05-A.
060800 REWRITE-CLOSE-SQ-FS6.
060900     CLOSE SQ-FS6.
061000     GO TO REWRITE-READ-INIT-GF-02.
061100 CANT-TEST.
061200*        THIS PARAGRAPH IS EXECUTED ONLY WHEN AN AT END
061300*    CONDITION OCCURRED WHEN TRYING TO READ AND REWRITE
061400*    THE FILE SQ-FS6.
061500     MOVE "UNEXPECTED EOF" TO COMPUTED-A.
061600     MOVE "UNABLE TO UPDATE FILE" TO RE-MARK.
061700     PERFORM PRINT-DETAIL.
061800     PERFORM BLANK-LINE-PRINT 5 TIMES.
061900     MOVE "**** REWRITE TESTS DELETED ****" TO DUMMY-RECORD.
062000     PERFORM WRITE-LINE.
062100     GO TO SEQ-CLOSE-025.
062200 REWRITE-READ-INIT-GF-02.
062300     MOVE 0 TO COUNT-OF-RECS.
062400     MOVE 0 TO EOF-FLAG.
062500     MOVE 0 TO ERROR-FLAG.
062600     MOVE 0 TO RECORDS-IN-ERROR.
062700     OPEN INPUT SQ-FS6.
062800 REWRITE-TEST-GF-02.
062900*        CHECK THE FIRST 30 RECORDS OF THE FILE.
063000*    THESE RECORDS WERE NOT REWRITTEN.
063100     IF COUNT-OF-RECS EQUAL TO 30
063200         GO TO REWRITE-TEST-GF-02-1.
063300     READ SQ-FS6 RECORD
063400         AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
063500                MOVE 1 TO EOF-FLAG
063600                GO TO REWRITE-FAIL-GF-02.
063700     ADD 1 TO COUNT-OF-RECS.
063800     PERFORM CHECK-RECORD THRU CHECK-RECORD-EXIT.
063900     IF ERROR-FLAG EQUAL TO 1
064000         GO TO REWRITE-TEST-GF-02.
064100     IF UPDATE-NUMBER (1) NOT EQUAL TO 0
064200         PERFORM CHECK-RECORD-FAIL
064300         GO TO REWRITE-TEST-GF-02.
064400     IF UPDATE-AREA-ONLY NOT EQUAL TO "FIRST "
064500         PERFORM CHECK-RECORD-FAIL.
064600     GO TO REWRITE-TEST-GF-02.
064700 REWRITE-TEST-GF-02-1.
064800     IF ERROR-FLAG EQUAL TO 0
064900         GO TO REWRITE-PASS-GF-02.
065000     MOVE "ERRORS IN RECORD(S)" TO COMPUTED-A.
065100 REWRITE-FAIL-GF-02.
065200     MOVE "VII-48; 4.5.2 RWRT LARGER RECORDS: TRUNC." TO  RE-MARK.
065300     PERFORM FAIL.
065400     MOVE "CHECK RECORDS NOT REWRITTEN" TO RE-MARK.
065500     GO TO REWRITE-WRITE-GF-02.
065600 REWRITE-PASS-GF-02.
065700     PERFORM PASS.
065800 REWRITE-WRITE-GF-02.
065900     MOVE "RWRT; LARGER RECORDS  "  TO  FEATURE.
066000     MOVE "RWRT-TEST-GF-02" TO PAR-NAME.
066100     PERFORM PRINT-DETAIL.
066200     GO TO REWRITE-INIT-GF-03.
066300 CHECK-RECORD.
066400     MOVE SQ-FS6R1-PART1 TO FILE-RECORD-INFO-P1-120 (1).
066500     MOVE SQ-FS6R1-PART2 TO END-OF-RECORD-AREA.
066600     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS6"
066700         GO TO CHECK-RECORD-FAIL.
066800     IF COUNT-OF-RECS NOT EQUAL TO XRECORD-NUMBER (1)
066900         GO TO CHECK-RECORD-FAIL.
067000     IF XLABEL-TYPE (1) NOT EQUAL TO "O"
067100         GO TO CHECK-RECORD-FAIL.
067200     IF NUMBER-AREA EQUAL TO COUNT-OF-RECS
067300         GO TO CHECK-RECORD-EXIT.
067400 CHECK-RECORD-FAIL.
067500     ADD 1 TO RECORDS-IN-ERROR.
067600     MOVE 1 TO ERROR-FLAG.
067700 CHECK-RECORD-EXIT.
067800     EXIT.
067900 REWRITE-INIT-GF-03.
068000     MOVE 0 TO ERROR-FLAG.
068100     IF EOF-FLAG EQUAL TO 1
068200         GO TO SEQ-EOF-025.
068300*    THIS TEST CHECKS RECORDS 31 THRU 80 WHICH WERE REWRITTEN.
068400 REWRITE-TEST-GF-03.
068500     IF COUNT-OF-RECS EQUAL TO 80
068600         GO TO REWRITE-TEST-GF-03-1.
068700     READ SQ-FS6 RECORD
068800         AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
068900                MOVE 1 TO EOF-FLAG
069000                GO TO REWRITE-FAIL-GF-03.
069100     ADD 1 TO COUNT-OF-RECS.
069200     PERFORM CHECK-RECORD THRU CHECK-RECORD-EXIT.
069300     IF ERROR-FLAG EQUAL TO 1
069400         GO TO REWRITE-TEST-GF-03.
069500     IF UPDATE-NUMBER (1) NOT EQUAL TO 1
069600         PERFORM CHECK-RECORD-FAIL
069700         GO TO REWRITE-TEST-GF-03.
069800     IF UPDATE-AREA-ONLY NOT EQUAL TO "SECOND"
069900         PERFORM CHECK-RECORD-FAIL.
070000     GO TO REWRITE-TEST-GF-03.
070100 REWRITE-TEST-GF-03-1.
070200     IF ERROR-FLAG EQUAL TO 0
070300         GO TO REWRITE-PASS-GF-03.
070400     MOVE "ERRORS IN RECORD(S)" TO COMPUTED-A.
070500 REWRITE-FAIL-GF-03.
070600     MOVE "VII-48; 4.5.2  REWRITE OF 130 CHAR RECS  " TO  RE-MARK.
070700     PERFORM FAIL.
070800     GO TO REWRITE-WRITE-GF-03.
070900 REWRITE-PASS-GF-03.
071000     PERFORM PASS.
071100 REWRITE-WRITE-GF-03.
071200     MOVE "RWRT; SHORTER RECORDS  "  TO FEATURE.
071300     MOVE "RWRT-TEST-GF-03"     TO PAR-NAME.
071400     PERFORM PRINT-DETAIL.
071500 REWRITE-INIT-GF-04.
071600     MOVE 0 TO REC-CT.
071700     MOVE 0 TO ERROR-FLAG.
071800     IF EOF-FLAG EQUAL TO 1
071900         GO TO SEQ-EOF-025.
072000*    THIS TEST CHECKS THE RECORDS WHICH WERE REWRITTEN
072100*    FROM AN 139 CHARACTER RECORD.
072200 REWRITE-TEST-GF-04.
072300     IF COUNT-OF-RECS EQUAL TO 120
072400         GO TO REWRITE-TEST-GF-04-1.
072500     READ SQ-FS6 RECORD
072600         AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
072700                MOVE 1 TO EOF-FLAG
072800                GO TO REWRITE-FAIL-GF-04.
072900     ADD 1 TO COUNT-OF-RECS.
073000     PERFORM CHECK-RECORD THRU CHECK-RECORD-EXIT.
073100     IF ERROR-FLAG EQUAL TO 1
073200         GO TO REWRITE-TEST-GF-04.
073300     IF UPDATE-NUMBER (1) NOT EQUAL TO 1
073400         PERFORM CHECK-RECORD-FAIL
073500         GO TO REWRITE-TEST-GF-04.
073600     IF UPDATE-AREA-ONLY NOT EQUAL TO "SECOND"
073700         PERFORM CHECK-RECORD-FAIL
073800         GO TO REWRITE-TEST-GF-04.
073900     MOVE SPACE TO AREA2-2.
074000     MOVE SQ-FS6R1-F-G-130 TO REWRT-FROM-AREA2.
074100     IF AREA2-2 NOT EQUAL TO SPACE
074200         MOVE "NO RECORD TRUNCATION" TO RE-MARK
074300         PERFORM CHECK-RECORD-FAIL.
074400     GO TO REWRITE-TEST-GF-04.
074500 REWRITE-TEST-GF-04-1.
074600     IF ERROR-FLAG EQUAL TO 0
074700         GO TO REWRITE-PASS-GF-04.
074800     MOVE "ERRORS IN RECORD(S)" TO COMPUTED-A.
074900 REWRITE-FAIL-GF-04.
075000     MOVE "VII-48; 4.5.2  RWRT FROM 139 CHAR REC    " TO  RE-MARK.
075100     PERFORM FAIL.
075200     GO TO REWRITE-WRITE-GF-04.
075300 REWRITE-PASS-GF-04.
075400     PERFORM PASS.
075500 REWRITE-WRITE-GF-04.
075600     MOVE "RWRT FROM 139"              TO FEATURE.
075700     MOVE "RWRT-TEST-GF-04" TO PAR-NAME.
075800     PERFORM PRINT-DETAIL.
075900 REWRITE-INIT-GF-05.
076000     IF EOF-FLAG EQUAL TO 1
076100         GO TO SEQ-EOF-025.
076200     MOVE 0 TO ERROR-FLAG.
076300*        THIS TEST CHECKS THE 87 CHARACTER RECORDS WHICH
076400*    WERE REWRITTEN.  CHARACTERS 88 THRU 130 SHOULD BE SPACES.
076500 REWRITE-TEST-GF-05.
076600     IF COUNT-OF-RECS EQUAL TO 160
076700         GO TO REWRITE-TEST-GF-05-1.
076800     READ SQ-FS6 RECORD
076900         AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
077000                MOVE 1 TO EOF-FLAG
077100                GO TO REWRITE-FAIL-GF-05.
077200     ADD 1 TO COUNT-OF-RECS.
077300     MOVE SQ-FS6R1-PART1 TO FILE-RECORD-INFO-P1-120 (1).
077400     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS6"
077500         GO TO REWRITE-FAIL-GF-05-1.
077600     IF COUNT-OF-RECS NOT EQUAL TO XRECORD-NUMBER (1)
077700         GO TO REWRITE-FAIL-GF-05-1.
077800     IF UPDATE-NUMBER (1) NOT EQUAL TO 1
077900         GO TO REWRITE-FAIL-GF-05-1.
078000     IF CHARS-OR-RECORDS (1) NOT EQUAL TO SPACE
078100         MOVE "NO SPACE FILL" TO RE-MARK
078200         GO TO REWRITE-FAIL-GF-05-1.
078300     IF SQ-FS6R1-PART2 NOT EQUAL TO SPACE
078400         MOVE "NO SPACE FILL" TO RE-MARK
078500         GO TO REWRITE-FAIL-GF-05-1.
078600     GO TO REWRITE-TEST-GF-05.
078700 REWRITE-FAIL-GF-05-1.
078800     PERFORM CHECK-RECORD-FAIL.
078900     GO TO REWRITE-TEST-GF-05.
079000 REWRITE-TEST-GF-05-1.
079100     IF ERROR-FLAG EQUAL TO 0
079200         GO TO REWRITE-PASS-GF-05.
079300     MOVE "ERRORS IN RECORD(S)" TO COMPUTED-A.
079400 REWRITE-FAIL-GF-05.
079500     MOVE "VII-48; 4.5.2  CHARS 88 THRU 139: SPACE} " TO  RE-MARK.
079600     PERFORM FAIL.
079700     GO TO REWRITE-WRITE-GF-05.
079800 REWRITE-PASS-GF-05.
079900     PERFORM PASS.
080000 REWRITE-WRITE-GF-05.
080100     MOVE "RWRT SHORTER RECORDS" TO FEATURE.
080200     MOVE "RWRT-TEST-GF-05" TO PAR-NAME.
080300     PERFORM PRINT-DETAIL.
080400 REWRITE-INIT-GF-06.
080500     IF EOF-FLAG EQUAL TO 1
080600         GO TO SEQ-EOF-025.
080700     MOVE 0 TO ERROR-FLAG.
080800*        THIS TEST CHECKS THE RECORDS REWRITTEN FROM AN 02
080900*    LEVEL ITEM OF 130 CHARACTERS.
081000 REWRITE-TEST-GF-06.
081100     IF COUNT-OF-RECS EQUAL TO 200
081200         GO TO REWRITE-TEST-GF-06-1.
081300     READ SQ-FS6 RECORD
081400         AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
081500                MOVE 1 TO EOF-FLAG
081600                GO TO REWRITE-FAIL-GF-06.
081700     ADD 1 TO COUNT-OF-RECS.
081800     PERFORM CHECK-RECORD THRU CHECK-RECORD-EXIT.
081900     IF ERROR-FLAG EQUAL TO 1
082000         GO TO REWRITE-TEST-GF-06.
082100     IF UPDATE-NUMBER (1) NOT EQUAL TO 1
082200         PERFORM CHECK-RECORD-FAIL
082300         GO TO REWRITE-TEST-GF-06.
082400     IF UPDATE-AREA-ONLY NOT EQUAL TO "SECOND"
082500         PERFORM CHECK-RECORD-FAIL.
082600     GO TO REWRITE-TEST-GF-06.
082700 REWRITE-TEST-GF-06-1.
082800     IF ERROR-FLAG EQUAL TO ZERO
082900         GO TO REWRITE-PASS-GF-06.
083000     MOVE "ERRORS IN RECORD(S)" TO COMPUTED-A.
083100 REWRITE-FAIL-GF-06.
083200     MOVE "VII-48; 4.5.2                            " TO  RE-MARK.
083300     PERFORM FAIL.
083400     GO TO REWRITE-WRITE-GF-06.
083500 REWRITE-PASS-GF-06.
083600     PERFORM PASS.
083700 REWRITE-WRITE-GF-06.
083800     MOVE "RWRT FROM 02 LEVEL" TO FEATURE.
083900     MOVE "RWRT-TEST-GF-06" TO PAR-NAME.
084000     PERFORM PRINT-DETAIL.
084100 REWRITE-INIT-GF-07.
084200     IF EOF-FLAG EQUAL TO 1
084300         GO TO SEQ-EOF-025.
084400     MOVE 0 TO ERROR-FLAG.
084500*    THIS TEST CHECKS THE RECORDS REWRITTEN FROM AN 05 LEVEL
084600*    SUBSCRIPTED ITEM.
084700 REWRITE-TEST-GF-07.
084800     IF COUNT-OF-RECS EQUAL TO 240
084900         GO TO REWRITE-TEST-GF-07-1.
085000     READ SQ-FS6 RECORD
085100         AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
085200         MOVE 1 TO EOF-FLAG
085300         GO TO REWRITE-FAIL-GF-07.
085400     ADD 1 TO COUNT-OF-RECS.
085500     MOVE SQ-FS6R1-PART1 TO FILE-RECORD-INFO-P1-120 (1).
085600     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS6"
085700         GO TO REWRITE-FAIL-GF-07-1.
085800     IF XRECORD-NUMBER (1) NOT EQUAL TO COUNT-OF-RECS
085900         GO TO REWRITE-FAIL-GF-07-1.
086000     IF UPDATE-NUMBER (1) NOT EQUAL TO 1
086100         GO TO REWRITE-FAIL-GF-07-1.
086200     IF XLABEL-TYPE (1) NOT EQUAL TO "O"
086300         GO TO REWRITE-FAIL-GF-07-1.
086400     IF SQ-FS6R1-PART2 NOT EQUAL TO SPACE
086500         MOVE "NO SPACE FILL" TO RE-MARK
086600         GO TO REWRITE-FAIL-GF-07-1.
086700     GO TO REWRITE-TEST-GF-07.
086800 REWRITE-FAIL-GF-07-1.
086900     PERFORM CHECK-RECORD-FAIL.
087000     GO TO REWRITE-TEST-GF-07.
087100 REWRITE-TEST-GF-07-1.
087200     IF ERROR-FLAG EQUAL TO ZERO
087300         GO TO REWRITE-PASS-GF-07.
087400     MOVE "ERRORS IN RECORD(S)" TO COMPUTED-A.
087500 REWRITE-FAIL-GF-07.
087600     MOVE "VII-48; 4.5.2                            " TO  RE-MARK.
087700     PERFORM FAIL.
087800     GO TO REWRITE-WRITE-GF-07.
087900 REWRITE-PASS-GF-07.
088000     PERFORM PASS.
088100 REWRITE-WRITE-GF-07.
088200     MOVE "RWRT FROM 05 LEVEL" TO FEATURE.
088300     MOVE "RWRT-TEST-GF-07" TO PAR-NAME.
088400     PERFORM PRINT-DETAIL.
088500 REWRITE-INIT-GF-08.
088600     IF EOF-FLAG EQUAL TO 1
088700         GO TO SEQ-EOF-025.
088800     MOVE 0 TO ERROR-FLAG.
088900*    THIS TEST CHECKS RECORDS 241 THRU 550 WHICH WERE NOT
089000*    REWRITTEN.
089100 REWRITE-TEST-GF-08.
089200     IF COUNT-OF-RECS EQUAL TO 550
089300         GO TO REWRITE-TEST-GF-08-1.
089400     READ SQ-FS6 RECORD
089500         AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
089600                MOVE 1 TO EOF-FLAG
089700                GO TO REWRITE-FAIL-GF-08.
089800     ADD 1 TO COUNT-OF-RECS.
089900     PERFORM CHECK-RECORD THRU CHECK-RECORD-EXIT.
090000     IF ERROR-FLAG EQUAL TO 1
090100         GO TO REWRITE-TEST-GF-08.
090200     IF UPDATE-NUMBER (1) NOT EQUAL TO 0
090300         PERFORM CHECK-RECORD-FAIL
090400         GO TO REWRITE-TEST-GF-08.
090500     IF UPDATE-AREA-ONLY NOT EQUAL TO "FIRST "
090600         PERFORM CHECK-RECORD-FAIL.
090700     GO TO REWRITE-TEST-GF-08.
090800 REWRITE-TEST-GF-08-1.
090900     IF ERROR-FLAG EQUAL TO 0
091000         GO TO REWRITE-PASS-GF-08.
091100     MOVE "ERRORS IN RECORD(S)" TO COMPUTED-A.
091200 REWRITE-FAIL-GF-08.
091300     MOVE "VII-48; 4.5.2                            " TO  RE-MARK.
091400     PERFORM FAIL.
091500     GO TO REWRITE-WRITE-GF-08.
091600 REWRITE-PASS-GF-08.
091700     PERFORM PASS.
091800 REWRITE-WRITE-GF-08.
091900     MOVE "RWRT-TEST-GF-08" TO PAR-NAME.
092000     MOVE "RECORD NOT REWRITTEN" TO FEATURE.
092100     PERFORM PRINT-DETAIL.
092200 SEQ-INIT-025.
092300*        THIS TEST CHECKS IF THERE WERE ANY ERRORS IN THE
092400*    UPDATED FILE AND READS THE FILE ONCE MORE EXPECTING
092500*    THE AT END CONDITION TO OCCUR.
092600     IF EOF-FLAG EQUAL TO 1
092700         GO TO SEQ-EOF-025.
092800 SEQ-TEST-025.
092900     READ SQ-FS6 RECORD
093000         AT END GO TO SEQ-TEST-25-1.
093100     MOVE "MORE THAN 550 RECORDS" TO RE-MARK.
093200     GO TO SEQ-FAIL-025.
093300 SEQ-TEST-25-1.
093400     IF RECORDS-IN-ERROR NOT EQUAL TO 0
093500         MOVE "RECORDS IN ERROR =" TO COMPUTED-A
093600         MOVE RECORDS-IN-ERROR TO CORRECT-18V0
093700         GO TO SEQ-FAIL-025.
093800 SEQ-PASS-025.
093900     PERFORM PASS.
094000     GO TO SEQ-WRITE-025.
094100 SEQ-EOF-025.
094200     MOVE "LESS THAN 550 RECORDS" TO RE-MARK.
094300     MOVE "RECORDS READ =" TO COMPUTED-A.
094400     MOVE COUNT-OF-RECS TO CORRECT-18V0.
094500 SEQ-FAIL-025.
094600     PERFORM FAIL.
094700 SEQ-WRITE-025.
094800     MOVE "SEQ-TEST-025" TO PAR-NAME.
094900     MOVE "READ LAST RECORD" TO FEATURE.
095000     PERFORM PRINT-DETAIL.
095100 SEQ-CLOSE-025.
095200     CLOSE SQ-FS6.
095300 TERMINATE-ROUTINE.
095400     EXIT.
095500 CCVS-EXIT SECTION.
095600 CCVS-999999.
095700     GO TO CLOSE-FILES.
