000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RL105A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*GENERAL:    THIS PROGRAM PROCESSED THREE RELATIVE FILES
001400*            IDENTIFIED AS RL-FR1, RL-FR2 AND RL-FR3.  THE
001500*            FUNCTION OF THIS PROGRAM IS TO CREATE THREE RELATIVE
001600*            I-O FILES RANDOMLLY (ACCESS MODE RANDOM)  AND VERIFY
001700*            THAT THEY WERE CREATED CORRECTLY.  THE FILES
001800*            PROCESSED CONTAIN FIXED LENGTH RECORDS.
001900*
002000*            X-CARD PARAMETERS WHICH MUST BE SUPPLIED FOR THIS
002100*            PROGRAM ARE:
002200*
002300*                 X-21   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
002400*                         RELATIVE  I-O DATA FILE-1
002500*                 X-22   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
002600*                         RELATIVE  I-O DATA FILE-2
002700*                 X-23   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
002800*                         RELATIVE  I-O DATA FILE-3
002900*                 X-55   SYSTEM PRINTER
003000*                 X-69   ADDITIONAL VALUE OF CLAUSES
003100*                 X-74   VALUE OF IMPLEMENTOR-NAME
003200*                 X-75   OBJECT OF VALUE OF CLAUSE FOR FILE-1
003300*                 X-76   OBJECT OF VALUE OF CLAUSE FOR FILE-2
003400*                 X-77   OBJECT OF VALUE OF CLAUSE FOR FILE-3
003500*                 X-82   SOURCE-COMPUTER
003600*                 X-83   OBJECT-COMPUTER.
003700*
003800****************************************************************
003900 ENVIRONMENT DIVISION.
004000 CONFIGURATION SECTION.
004100 SOURCE-COMPUTER.
004200     XXXXX082.
004300 OBJECT-COMPUTER.
004400     XXXXX083.
004500 INPUT-OUTPUT SECTION.
004600 FILE-CONTROL.
004700     SELECT PRINT-FILE ASSIGN TO
004800     XXXXX055.
004900     SELECT   RL-FR1 ASSIGN TO
005000     XXXXX021
005100             ORGANIZATION IS RELATIVE
005200             ACCESS  MODE IS RANDOM
005300              RELATIVE KEY IS KEY-1.
005400     SELECT RL-FR2 ASSIGN
005500     XXXXX022
005600             ORGANIZATION IS RELATIVE
005700             ACCESS  MODE IS RANDOM
005800              RELATIVE KEY IS KEY-2.
005900     SELECT RL-FR3 ASSIGN TO
006000     XXXXX023
006100             ORGANIZATION IS RELATIVE
006200             ACCESS  MODE IS RANDOM
006300              RELATIVE KEY IS KEY-3.
006400 DATA DIVISION.
006500 FILE SECTION.
006600 FD  PRINT-FILE.
006700 01  PRINT-REC PICTURE X(120).
006800 01  DUMMY-RECORD PICTURE X(120).
006900 FD  RL-FR1
007000C    VALUE OF
007100C    XXXXX074
007200C    IS
007300C    XXXXX075
007400G    XXXXX069
007500     LABEL RECORDS ARE STANDARD
007600     DATA RECORD IS GRP-1SEQ-RECORD-1.
007700 01  GRP-1SEQ-RECORD-1.
007800     02  EXPRESSION              PICTURE X(51).
007900     02  FILLER                  PICTURE X(49).
008000 FD  RL-FR2
008100C    VALUE OF
008200C    XXXXX074
008300C    IS
008400C    XXXXX076
008500G    XXXXX069
008600     LABEL RECORDS ARE STANDARD
008700     DATA RECORD IS GRP-1SEQ-RECORD-2.
008800 01  GRP-1SEQ-RECORD-2.
008900     02  FILLER                  PICTURE X(100).
009000 FD  RL-FR3
009100C    VALUE OF
009200C    XXXXX074
009300C    IS
009400C    XXXXX077
009500G    XXXXX069
009600     LABEL RECORDS ARE STANDARD
009700     DATA RECORD IS GRP-1SEQ-RECORD-3.
009800 01  GRP-1SEQ-RECORD-3.
009900     02  FILLER                  PICTURE X(100).
010000 WORKING-STORAGE SECTION.
010100 77  SUB-1             PICTURE 99  VALUE ZERO.
010200 77  KEY-1
010300         PICTURE   9(5).
010400 77  KEY-2
010500         PICTURE   9(5).
010600 77  KEY-3
010700         PICTURE   9(5).
010800 01  RECORD-MESSAGE.
010900     02  FILLER                   PICTURE X(8)  VALUE "RECORD  ".
011000     02  2POS-NUM                 PICTURE 99.
011100     02  FILLER                   PICTURE X(40)  VALUE
011200     "  OF THIS FILE CONTAINS THIS INFORMATION".
011300     02  FILLER                   PICTURE X(50)  VALUE SPACE.
011400 01  GRP-SEQ-TEST-RECORD         PICTURE X(100) VALUE SPACE.
011500 01  GRP-HOLD-RECORD             PICTURE X(100) VALUE SPACE.
011600 01  READ-WRITE-COUNTER.
011700     02  ENTRY-RW OCCURS 20 TIMES PICTURE X.
011800 01  FILE-RECORD-INFORMATION-REC.
011900     03 FILE-RECORD-INFO-SKELETON.
012000        05 FILLER                 PICTURE X(48)       VALUE
012100             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
012200        05 FILLER                 PICTURE X(46)       VALUE
012300             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
012400        05 FILLER                 PICTURE X(26)       VALUE
012500             ",LFIL=000000,ORG=  ,LBLR= ".
012600        05 FILLER                 PICTURE X(37)       VALUE
012700             ",RECKEY=                             ".
012800        05 FILLER                 PICTURE X(38)       VALUE
012900             ",ALTKEY1=                             ".
013000        05 FILLER                 PICTURE X(38)       VALUE
013100             ",ALTKEY2=                             ".
013200        05 FILLER                 PICTURE X(7)        VALUE SPACE.
013300     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
013400        05 FILE-RECORD-INFO-P1-120.
013500           07 FILLER              PIC X(5).
013600           07 XFILE-NAME           PIC X(6).
013700           07 FILLER              PIC X(8).
013800           07 XRECORD-NAME         PIC X(6).
013900           07 FILLER              PIC X(1).
014000           07 REELUNIT-NUMBER     PIC 9(1).
014100           07 FILLER              PIC X(7).
014200           07 XRECORD-NUMBER       PIC 9(6).
014300           07 FILLER              PIC X(6).
014400           07 UPDATE-NUMBER       PIC 9(2).
014500           07 FILLER              PIC X(5).
014600           07 ODO-NUMBER          PIC 9(4).
014700           07 FILLER              PIC X(5).
014800           07 XPROGRAM-NAME        PIC X(5).
014900           07 FILLER              PIC X(7).
015000           07 XRECORD-LENGTH       PIC 9(6).
015100           07 FILLER              PIC X(7).
015200           07 CHARS-OR-RECORDS    PIC X(2).
015300           07 FILLER              PIC X(1).
015400           07 XBLOCK-SIZE          PIC 9(4).
015500           07 FILLER              PIC X(6).
015600           07 RECORDS-IN-FILE     PIC 9(6).
015700           07 FILLER              PIC X(5).
015800           07 XFILE-ORGANIZATION   PIC X(2).
015900           07 FILLER              PIC X(6).
016000           07 XLABEL-TYPE          PIC X(1).
016100        05 FILE-RECORD-INFO-P121-240.
016200           07 FILLER              PIC X(8).
016300           07 XRECORD-KEY          PIC X(29).
016400           07 FILLER              PIC X(9).
016500           07 ALTERNATE-KEY1      PIC X(29).
016600           07 FILLER              PIC X(9).
016700           07 ALTERNATE-KEY2      PIC X(29).
016800           07 FILLER              PIC X(7).
016900 01  TEST-RESULTS.
017000     02 FILLER                   PIC X      VALUE SPACE.
017100     02 FEATURE                  PIC X(20)  VALUE SPACE.
017200     02 FILLER                   PIC X      VALUE SPACE.
017300     02 P-OR-F                   PIC X(5)   VALUE SPACE.
017400     02 FILLER                   PIC X      VALUE SPACE.
017500     02  PAR-NAME.
017600       03 FILLER                 PIC X(19)  VALUE SPACE.
017700       03  PARDOT-X              PIC X      VALUE SPACE.
017800       03 DOTVALUE               PIC 99     VALUE ZERO.
017900     02 FILLER                   PIC X(8)   VALUE SPACE.
018000     02 RE-MARK                  PIC X(61).
018100 01  TEST-COMPUTED.
018200     02 FILLER                   PIC X(30)  VALUE SPACE.
018300     02 FILLER                   PIC X(17)  VALUE
018400            "       COMPUTED=".
018500     02 COMPUTED-X.
018600     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
018700     03 COMPUTED-N               REDEFINES COMPUTED-A
018800                                 PIC -9(9).9(9).
018900     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
019000     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
019100     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
019200     03       CM-18V0 REDEFINES COMPUTED-A.
019300         04 COMPUTED-18V0                    PIC -9(18).
019400         04 FILLER                           PIC X.
019500     03 FILLER PIC X(50) VALUE SPACE.
019600 01  TEST-CORRECT.
019700     02 FILLER PIC X(30) VALUE SPACE.
019800     02 FILLER PIC X(17) VALUE "       CORRECT =".
019900     02 CORRECT-X.
020000     03 CORRECT-A                  PIC X(20) VALUE SPACE.
020100     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
020200     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
020300     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
020400     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
020500     03      CR-18V0 REDEFINES CORRECT-A.
020600         04 CORRECT-18V0                     PIC -9(18).
020700         04 FILLER                           PIC X.
020800     03 FILLER PIC X(2) VALUE SPACE.
020900     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
021000 01  CCVS-C-1.
021100     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
021200-    "SS  PARAGRAPH-NAME
021300-    "       REMARKS".
021400     02 FILLER                     PIC X(20)    VALUE SPACE.
021500 01  CCVS-C-2.
021600     02 FILLER                     PIC X        VALUE SPACE.
021700     02 FILLER                     PIC X(6)     VALUE "TESTED".
021800     02 FILLER                     PIC X(15)    VALUE SPACE.
021900     02 FILLER                     PIC X(4)     VALUE "FAIL".
022000     02 FILLER                     PIC X(94)    VALUE SPACE.
022100 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
022200 01  REC-CT                        PIC 99       VALUE ZERO.
022300 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
022400 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
022500 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
022600 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
022700 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
022800 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
022900 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
023000 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
023100 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
023200 01  CCVS-H-1.
023300     02  FILLER                    PIC X(39)    VALUE SPACES.
023400     02  FILLER                    PIC X(42)    VALUE
023500     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
023600     02  FILLER                    PIC X(39)    VALUE SPACES.
023700 01  CCVS-H-2A.
023800   02  FILLER                        PIC X(40)  VALUE SPACE.
023900   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
024000   02  FILLER                        PIC XXXX   VALUE
024100     "4.2 ".
024200   02  FILLER                        PIC X(28)  VALUE
024300            " COPY - NOT FOR DISTRIBUTION".
024400   02  FILLER                        PIC X(41)  VALUE SPACE.
024500
024600 01  CCVS-H-2B.
024700   02  FILLER                        PIC X(15)  VALUE
024800            "TEST RESULT OF ".
024900   02  TEST-ID                       PIC X(9).
025000   02  FILLER                        PIC X(4)   VALUE
025100            " IN ".
025200   02  FILLER                        PIC X(12)  VALUE
025300     " HIGH       ".
025400   02  FILLER                        PIC X(22)  VALUE
025500            " LEVEL VALIDATION FOR ".
025600   02  FILLER                        PIC X(58)  VALUE
025700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025800 01  CCVS-H-3.
025900     02  FILLER                      PIC X(34)  VALUE
026000            " FOR OFFICIAL USE ONLY    ".
026100     02  FILLER                      PIC X(58)  VALUE
026200     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
026300     02  FILLER                      PIC X(28)  VALUE
026400            "  COPYRIGHT   1985 ".
026500 01  CCVS-E-1.
026600     02 FILLER                       PIC X(52)  VALUE SPACE.
026700     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
026800     02 ID-AGAIN                     PIC X(9).
026900     02 FILLER                       PIC X(45)  VALUE SPACES.
027000 01  CCVS-E-2.
027100     02  FILLER                      PIC X(31)  VALUE SPACE.
027200     02  FILLER                      PIC X(21)  VALUE SPACE.
027300     02 CCVS-E-2-2.
027400         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
027500         03 FILLER                   PIC X      VALUE SPACE.
027600         03 ENDER-DESC               PIC X(44)  VALUE
027700            "ERRORS ENCOUNTERED".
027800 01  CCVS-E-3.
027900     02  FILLER                      PIC X(22)  VALUE
028000            " FOR OFFICIAL USE ONLY".
028100     02  FILLER                      PIC X(12)  VALUE SPACE.
028200     02  FILLER                      PIC X(58)  VALUE
028300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
028400     02  FILLER                      PIC X(13)  VALUE SPACE.
028500     02 FILLER                       PIC X(15)  VALUE
028600             " COPYRIGHT 1985".
028700 01  CCVS-E-4.
028800     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
028900     02 FILLER                       PIC X(4)   VALUE " OF ".
029000     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
029100     02 FILLER                       PIC X(40)  VALUE
029200      "  TESTS WERE EXECUTED SUCCESSFULLY".
029300 01  XXINFO.
029400     02 FILLER                       PIC X(19)  VALUE
029500            "*** INFORMATION ***".
029600     02 INFO-TEXT.
029700       04 FILLER                     PIC X(8)   VALUE SPACE.
029800       04 XXCOMPUTED                 PIC X(20).
029900       04 FILLER                     PIC X(5)   VALUE SPACE.
030000       04 XXCORRECT                  PIC X(20).
030100     02 INF-ANSI-REFERENCE           PIC X(48).
030200 01  HYPHEN-LINE.
030300     02 FILLER  PIC IS X VALUE IS SPACE.
030400     02 FILLER  PIC IS X(65)    VALUE IS "************************
030500-    "*****************************************".
030600     02 FILLER  PIC IS X(54)    VALUE IS "************************
030700-    "******************************".
030800 01  CCVS-PGM-ID                     PIC X(9)   VALUE
030900     "RL105A".
031000 PROCEDURE DIVISION.
031100 CCVS1 SECTION.
031200 OPEN-FILES.
031300     OPEN    OUTPUT PRINT-FILE.
031400     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
031500     MOVE    SPACE TO TEST-RESULTS.
031600     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
031700     MOVE    ZERO TO REC-SKL-SUB.
031800     PERFORM CCVS-INIT-FILE 9 TIMES.
031900 CCVS-INIT-FILE.
032000     ADD     1 TO REC-SKL-SUB.
032100     MOVE    FILE-RECORD-INFO-SKELETON
032200          TO FILE-RECORD-INFO (REC-SKL-SUB).
032300 CCVS-INIT-EXIT.
032400     GO TO CCVS1-EXIT.
032500 CLOSE-FILES.
032600     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
032700 TERMINATE-CCVS.
032800S    EXIT PROGRAM.
032900STERMINATE-CALL.
033000     STOP     RUN.
033100 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
033200 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
033300 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
033400 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
033500     MOVE "****TEST DELETED****" TO RE-MARK.
033600 PRINT-DETAIL.
033700     IF REC-CT NOT EQUAL TO ZERO
033800             MOVE "." TO PARDOT-X
033900             MOVE REC-CT TO DOTVALUE.
034000     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
034100     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
034200        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
034300          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
034400     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
034500     MOVE SPACE TO CORRECT-X.
034600     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
034700     MOVE     SPACE TO RE-MARK.
034800 HEAD-ROUTINE.
034900     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035000     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035100     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
035200     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
035300 COLUMN-NAMES-ROUTINE.
035400     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035500     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
035700 END-ROUTINE.
035800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
035900 END-RTN-EXIT.
036000     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036100 END-ROUTINE-1.
036200      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
036300      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
036400      ADD PASS-COUNTER TO ERROR-HOLD.
036500*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
036600      MOVE PASS-COUNTER TO CCVS-E-4-1.
036700      MOVE ERROR-HOLD TO CCVS-E-4-2.
036800      MOVE CCVS-E-4 TO CCVS-E-2-2.
036900      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
037000  END-ROUTINE-12.
037100      MOVE "TEST(S) FAILED" TO ENDER-DESC.
037200     IF       ERROR-COUNTER IS EQUAL TO ZERO
037300         MOVE "NO " TO ERROR-TOTAL
037400         ELSE
037500         MOVE ERROR-COUNTER TO ERROR-TOTAL.
037600     MOVE     CCVS-E-2 TO DUMMY-RECORD.
037700     PERFORM WRITE-LINE.
037800 END-ROUTINE-13.
037900     IF DELETE-COUNTER IS EQUAL TO ZERO
038000         MOVE "NO " TO ERROR-TOTAL  ELSE
038100         MOVE DELETE-COUNTER TO ERROR-TOTAL.
038200     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
038300     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038400      IF   INSPECT-COUNTER EQUAL TO ZERO
038500          MOVE "NO " TO ERROR-TOTAL
038600      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
038700      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
038800      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038900     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
039000 WRITE-LINE.
039100     ADD 1 TO RECORD-COUNT.
039200Y    IF RECORD-COUNT GREATER 50
039300Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
039400Y        MOVE SPACE TO DUMMY-RECORD
039500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
039600Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
039700Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
039800Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
039900Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
040000Y        MOVE ZERO TO RECORD-COUNT.
040100     PERFORM WRT-LN.
040200 WRT-LN.
040300     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
040400     MOVE SPACE TO DUMMY-RECORD.
040500 BLANK-LINE-PRINT.
040600     PERFORM WRT-LN.
040700 FAIL-ROUTINE.
040800     IF     COMPUTED-X NOT EQUAL TO SPACE
040900            GO TO   FAIL-ROUTINE-WRITE.
041000     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
041100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
041200     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
041300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041400     MOVE   SPACES TO INF-ANSI-REFERENCE.
041500     GO TO  FAIL-ROUTINE-EX.
041600 FAIL-ROUTINE-WRITE.
041700     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
041800     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
041900     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
042000     MOVE   SPACES TO COR-ANSI-REFERENCE.
042100 FAIL-ROUTINE-EX. EXIT.
042200 BAIL-OUT.
042300     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
042400     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
042500 BAIL-OUT-WRITE.
042600     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
042700     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
042800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042900     MOVE   SPACES TO INF-ANSI-REFERENCE.
043000 BAIL-OUT-EX. EXIT.
043100 CCVS1-EXIT.
043200     EXIT.
043300 SECT-RL105-001 SECTION.
043400 SECT-RC-01-001-INIT.
043500     MOVE 1 TO KEY-1  KEY-2  KEY-3  2POS-NUM.
043600     MOVE "READ/WRITE INVAL KEY" TO FEATURE.
043700 WRITE-REL-RECORDS SECTION.
043800 REL-INIT-1.
043900     MOVE ZERO TO 2POS-NUM.
044000     MOVE SPACE TO READ-WRITE-COUNTER.
044100     OPEN OUTPUT RL-FR1.
044200 REL-TEST-1.
044300     PERFORM REL-WRITE-FOR-TEST-1 THRU 1-EXIT 19 TIMES.
044400     IF READ-WRITE-COUNTER EQUAL TO "WWWWWWWWWWWWWWWWWWW "
044500         MOVE "19 RECORDS PASSED TO TEST-2" TO RE-MARK
044600         GO TO REL-TEST-1-WRITE.
044700     MOVE "WWWWWWWWWWWWWWWWWWW " TO CORRECT-A.
044800     MOVE READ-WRITE-COUNTER TO COMPUTED-A.
044900     PERFORM FAIL.
045000     GO TO REL-TEST-1-WRITE.
045100 REL-DELETE-TEST-1.
045200     MOVE "***TESTS-DELETED ***" TO COMPUTED-A  CORRECT-A.
045300     MOVE "WRITE-REL-RECORDS SECTION " TO RE-MARK.
045400     PERFORM REL-TEST-1-WRITE.
045500     GO TO EXIT-SECTION-1.
045600 REL-WRITE-FOR-TEST-1.
045700     ADD 1 TO SUB-1.
045800     MOVE "W" TO ENTRY-RW (SUB-1).
045900     MOVE SUB-1 TO KEY-1.
046000     ADD 1 TO 2POS-NUM.
046100     MOVE RECORD-MESSAGE TO GRP-1SEQ-RECORD-1.
046200     WRITE GRP-1SEQ-RECORD-1 INVALID KEY GO TO I-KEY-1.
046300     GO TO 1-EXIT.
046400 I-KEY-1.
046500     MOVE "I" TO ENTRY-RW (SUB-1).
046600 1-EXIT.
046700     EXIT.
046800 REL-TEST-1-WRITE.
046900     MOVE "REL-TEST-1         " TO PAR-NAME.
047000     PERFORM PRINT-DETAIL.
047100     CLOSE RL-FR1.
047200 REL-INIT-2.
047300     MOVE 01 TO SUB-1  KEY-1.
047400     MOVE SPACE TO READ-WRITE-COUNTER.
047500     OPEN INPUT RL-FR1.
047600 REL-TEST-2.
047700     READ RL-FR1 RECORD INVALID
047800         MOVE "E" TO ENTRY-RW (SUB-1)
047900         GO TO COMPARE-FOR-TEST-2.
048000     IF SUB-1 EQUAL TO 20
048100         GO TO COMPARE-FOR-TEST-2.
048200     MOVE "R" TO ENTRY-RW (SUB-1).
048300     ADD 1 TO SUB-1.
048400     MOVE SUB-1 TO KEY-1.
048500     GO TO REL-TEST-2.
048600 COMPARE-FOR-TEST-2.
048700     IF READ-WRITE-COUNTER EQUAL TO "RRRRRRRRRRRRRRRRRRRE"
048800         PERFORM PASS
048900         GO TO REL-TEST-2-WRITE.
049000     MOVE "RRRRRRRRRRRRRRRRRRRE" TO CORRECT-A.
049100     MOVE READ-WRITE-COUNTER TO COMPUTED-A.
049200     MOVE "INCORRECT RECORD COUNT     " TO RE-MARK.
049300     PERFORM FAIL.
049400 REL-TEST-2-WRITE.
049500     MOVE "REL-TEST-2         " TO PAR-NAME.
049600     PERFORM PRINT-DETAIL.
049700 EXIT-SECTION-1.
049800     CLOSE RL-FR1.
049900 BLOCKED-UNBLOCKED SECTION.
050000 REL-INIT-3.
050100     MOVE 0 TO SUB-1.
050200     MOVE SPACE TO READ-WRITE-COUNTER.
050300     OPEN OUTPUT RL-FR2.
050400     MOVE 1 TO KEY-2  2POS-NUM.
050500 REL-TEST-3.
050600     PERFORM REL-WRITE-FOR-TEST-3 THRU 3-EXIT 8 TIMES.
050700     PERFORM REL-WRITE-FOR-TEST-3 THRU 3-EXIT 8 TIMES.
050800     CLOSE RL-FR2.
050900     MOVE "REL-TEST-3         " TO PAR-NAME.
051000     IF READ-WRITE-COUNTER NOT EQUAL TO "WWWWWWWWWWWWWWWW    "
051100         MOVE "INVALID KEYS ON WRITE " TO RE-MARK ELSE
051200     MOVE "16 RECORDS PASSED TO TEST-4" TO RE-MARK.
051300     MOVE SPACE TO CORRECT-A  COMPUTED-A.
051400     PERFORM PRINT-DETAIL.
051500     GO TO REL-TEST-4.
051600 REL-DELETE-TEST-3.
051700     MOVE "***TESTS-DELETED ***" TO CORRECT-A COMPUTED-A.
051800     MOVE "BLOCKED-UNBLOCKED SECTION  " TO RE-MARK.
051900     MOVE "REL-TEST-3         " TO PAR-NAME.
052000     PERFORM PRINT-DETAIL.
052100     GO TO REL-TEST-4.
052200 REL-WRITE-FOR-TEST-3.
052300     MOVE RECORD-MESSAGE TO GRP-1SEQ-RECORD-2.
052400     WRITE GRP-1SEQ-RECORD-2 INVALID KEY GO TO I-KEY-3.
052500     MOVE "W" TO ENTRY-RW (2POS-NUM).
052600     ADD 1 TO 2POS-NUM.
052700     MOVE 2POS-NUM TO KEY-2.
052800     GO TO 3-EXIT.
052900 I-KEY-3.
053000     MOVE "I" TO ENTRY-RW (2POS-NUM).
053100     ADD 1 TO 2POS-NUM.
053200     MOVE 2POS-NUM TO KEY-2.
053300 3-EXIT.
053400     EXIT.
053500 REL-TEST-4.
053600     OPEN INPUT RL-FR2.
053700     MOVE 01 TO 2POS-NUM.
053800     MOVE 01 TO SUB-1  KEY-2.
053900     MOVE SPACE TO READ-WRITE-COUNTER.
054000 READ-FOR-TEST-4.
054100     READ RL-FR2 INVALID
054200         MOVE "INVALID KEY FILE-2  " TO COMPUTED-A
054300         MOVE SPACE TO CORRECT-A
054400         MOVE "INVALID KEY ON FIRST READ  " TO RE-MARK
054500         PERFORM FAIL
054600         MOVE "I" TO ENTRY-RW (SUB-1)
054700         GO TO REL-TEST-4-WRITE.
054800     IF GRP-1SEQ-RECORD-2 NOT EQUAL TO RECORD-MESSAGE
054900         MOVE "INCORRECT 1ST RECORD" TO COMPUTED-A
055000         MOVE SPACE TO CORRECT-A
055100         MOVE "RECORD NO. 1 INVALID" TO RE-MARK
055200         PERFORM FAIL
055300         MOVE "R" TO ENTRY-RW (SUB-1)
055400         GO TO REL-TEST-4-WRITE.
055500     MOVE "R" TO ENTRY-RW (SUB-1).
055600     PERFORM PASS.
055700 REL-TEST-4-WRITE.
055800     MOVE "REL-TEST-4         " TO PAR-NAME.
055900     PERFORM PRINT-DETAIL.
056000 REL-TEST-5.
056100     ADD 1 TO SUB-1.
056200*    NOTE  THIS TEST DEPENDS ON TEST-4.
056300     MOVE SUB-1 TO KEY-2.
056400     READ RL-FR2 INVALID KEY
056500         MOVE "E" TO ENTRY-RW (SUB-1)
056600         GO TO COMPARE-FOR-TEST-5.
056700     IF SUB-1 EQUAL TO 17
056800         GO TO COMPARE-FOR-TEST-5.
056900     MOVE "R" TO ENTRY-RW (SUB-1).
057000     GO TO REL-TEST-5.
057100 COMPARE-FOR-TEST-5.
057200     IF READ-WRITE-COUNTER EQUAL TO "RRRRRRRRRRRRRRRRE   "
057300         PERFORM PASS
057400         GO TO REL-TEST-5-WRITE.
057500     MOVE "RRRRRRRRRRRRRRRRE   " TO CORRECT-A.
057600     MOVE READ-WRITE-COUNTER TO COMPUTED-A.
057700     MOVE "INCORRECT RECORD COUNT     " TO RE-MARK.
057800     PERFORM FAIL.
057900 REL-TEST-5-WRITE.
058000     MOVE "REL-TEST-5         " TO PAR-NAME.
058100     PERFORM PRINT-DETAIL.
058200     CLOSE RL-FR2.
058300     OPEN OUTPUT RL-FR3.
058400     MOVE SPACE TO READ-WRITE-COUNTER.
058500     MOVE 1 TO KEY-3  2POS-NUM.
058600 REL-TEST-6.
058700     PERFORM REL-WRITE-FOR-TEST-6 THRU 6-EXIT 7 TIMES.
058800     PERFORM REL-WRITE-FOR-TEST-6 THRU 6-EXIT 9 TIMES.
058900     IF READ-WRITE-COUNTER NOT EQUAL TO "WWWWWWWWWWWWWWWW    "
059000         MOVE "INVALID KEYS ON WRITE " TO RE-MARK ELSE
059100     MOVE "16 RECORDS PASSED TO TEST-7" TO RE-MARK.
059200     MOVE SPACE TO CORRECT-A  COMPUTED-A.
059300     MOVE "REL-TEST-6         " TO PAR-NAME.
059400     PERFORM PRINT-DETAIL.
059500     CLOSE RL-FR3.
059600     GO TO REL-TEST-7.
059700 REL-WRITE-FOR-TEST-6.
059800     MOVE RECORD-MESSAGE TO GRP-1SEQ-RECORD-3.
059900     WRITE GRP-1SEQ-RECORD-3 INVALID KEY GO TO I-KEY-6.
060000     MOVE "W" TO ENTRY-RW (2POS-NUM).
060100     ADD 1 TO 2POS-NUM.
060200     MOVE 2POS-NUM TO KEY-3.
060300     GO TO 6-EXIT.
060400 I-KEY-6.
060500     MOVE "I" TO ENTRY-RW (2POS-NUM).
060600     ADD 1 TO 2POS-NUM.
060700     MOVE 2POS-NUM TO KEY-3.
060800 6-EXIT.
060900     EXIT.
061000 REL-TEST-7.
061100     OPEN INPUT RL-FR3.
061200     MOVE 08 TO SUB-1  KEY-3  2POS-NUM.
061300     MOVE SPACE TO READ-WRITE-COUNTER.
061400 READ-FOR-TEST-7.
061500     READ RL-FR3 INVALID KEY
061600         MOVE "INVALID KEY ON FILE3" TO COMPUTED-A
061700         MOVE SPACE TO CORRECT-A
061800         PERFORM FAIL
061900         GO TO REL-TEST-7-WRITE.
062000     IF GRP-1SEQ-RECORD-3 NOT EQUAL TO RECORD-MESSAGE
062100         MOVE GRP-1SEQ-RECORD-3 TO COMPUTED-A
062200         MOVE "8TH RECORD MESSAGE" TO CORRECT-A
062300         MOVE "COMPUTED-A SHOWS 1ST 20 POS" TO RE-MARK
062400         PERFORM FAIL
062500         GO TO REL-TEST-7-WRITE.
062600     PERFORM PASS.
062700 REL-TEST-7-WRITE.
062800     MOVE "REL-TEST-7         " TO PAR-NAME.
062900     PERFORM PRINT-DETAIL.
063000     CLOSE RL-FR3.
063100 CCVS-EXIT SECTION.
063200 CCVS-999999.
063300     GO TO CLOSE-FILES.
