000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST118A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*    ST118 IS A COMPLETELY SELF-CONTAINED PROGRAM.  THE INPUT
002200*    PROCEDURE BUILDS THE EIGHT-RECORD FILE SHOWN BELOW. THE
002300*    OUTPUT PROCEDURE CHECKS THE SORTED FILE AND GENERATES THE
002400*    REPORT.
002500*    SORT    SORT    SORT    SORT    SORT   SORT     SORT    SORT
002600*    KEY-1   KEY-2   KEY-3   KEY-4   KEY-5  KEY-6    KEY-7   KEY-8
002700*    S9(6)   A(5)    SV9(16) X(10)   A(20)  X(10)    999     S99
002800*    SIGN    JUST    SIGN    JUST                           SIGN
002900*    LEADING RIGHT   TRAILIN RIGHT                          TRAIL
003000*    SEPARAT         SEPARAT
003100*
003200*    +123456     BBB -.1234   BBBBBB A      AAAAAAAA 501     +99
003300*    -054321       X -.1234   BBBBBB A      AAAAAAAA 501     +99
003400*    -054321     BBB +.6      BBBBBB A      AAAAAAAA 501     +99
003500*    -054321     BBB -.1234        X A      AAAAAAAA 501     +99
003600*    -054321     BBB -.1234   BBBBBB Z      AAAAAAAA 501     +99
003700*    -054321     BBB -.1234   BBBBBB A      Z        501     +99
003800*    -054321     BBB -.1234   BBBBBB A      AAAAAAAA 418     +99
003900*    -054321     BBB -.1234   BBBBBB A      AAAAAAAA 501     -14
004000*
004100*    THIS PROGRAM CHECKS THE COMPILER"S ABILITY TO HANDLE EIGHT
004200*    ASCENDING KEYS IN ONE FILE.
004300*
004400*    ASCENDING KEYS IN ONE FILE.  EACH OF THE KEYS IDENTIFIED
004500*    IN THE SORT STATEMENT ARE ELEMENTARY DATA ITEMS AND USE
004600*    VARIOUS COMBINATIONS OF PICTURE CHARACTER-STRING SYMBOLS AND
004700*    CLAUSES FOR DESCRIBING THE GENERAL CHARACTERISTICS OF THE
004800*    DATA ITEM.
004900*    THIS PROGRAM IS A REWRITE OF ST108.  THE PURPOSE OF THIS
005000*    PROGRAM IS TO VERIFY THAT RECORDS ARE PROPERLY SORTED WHEN
005100*    THE SORT KEYS OF THE SORT STATEMENT USE DATA DEFINITIONS
005200*    WHICH INCLUDE THE SIGN CLAUSE.
005300 ENVIRONMENT DIVISION.
005400 CONFIGURATION SECTION.
005500 SOURCE-COMPUTER.
005600     XXXXX082.
005700 OBJECT-COMPUTER.
005800     XXXXX083.
005900 INPUT-OUTPUT SECTION.
006000 FILE-CONTROL.
006100     SELECT PRINT-FILE ASSIGN TO
006200     XXXXX055.
006300     SELECT   SORTFILE-1H ASSIGN TO
006400     XXXXX027.
006500 DATA DIVISION.
006600 FILE SECTION.
006700 FD  PRINT-FILE.
006800 01  PRINT-REC PICTURE X(120).
006900 01  DUMMY-RECORD PICTURE X(120).
007000 SD  SORTFILE-1H
007100     DATA RECORD IS SORTFILE-REC.
007200 01  SORTFILE-REC.
007300     02 SORTKEY-8       PICTURE S99 SIGN IS TRAILING.
007400     02 SORTKEY-1       PICTURE S9(6)  SIGN IS LEADING SEPARATE.
007500     02 SORTKEY-7       PICTURE 999.
007600     02 SORTKEY-3   PICTURE SV9(16)  SIGN IS TRAILING SEPARATE.
007700     02 FILLER          PICTURE XX.
007800     02 SORTKEY-4       PICTURE X(10) JUSTIFIED RIGHT.
007900     02 SORTKEY-6       PICTURE X(10).
008000     02 SORTKEY-2       PICTURE A(05) JUSTIFIED RIGHT.
008100     02 SORTKEY-5       PICTURE A(20).
008200     02 FILLER          PICTURE XXX.
008300 WORKING-STORAGE SECTION.
008400 77  UTIL-CTR           PICTURE S99999.
008500 77  SPAC-E             PICTURE X VALUE " ".
008600 01  TEST-RESULTS.
008700     02 FILLER                   PIC X      VALUE SPACE.
008800     02 FEATURE                  PIC X(20)  VALUE SPACE.
008900     02 FILLER                   PIC X      VALUE SPACE.
009000     02 P-OR-F                   PIC X(5)   VALUE SPACE.
009100     02 FILLER                   PIC X      VALUE SPACE.
009200     02  PAR-NAME.
009300       03 FILLER                 PIC X(19)  VALUE SPACE.
009400       03  PARDOT-X              PIC X      VALUE SPACE.
009500       03 DOTVALUE               PIC 99     VALUE ZERO.
009600     02 FILLER                   PIC X(8)   VALUE SPACE.
009700     02 RE-MARK                  PIC X(61).
009800 01  TEST-COMPUTED.
009900     02 FILLER                   PIC X(30)  VALUE SPACE.
010000     02 FILLER                   PIC X(17)  VALUE
010100            "       COMPUTED=".
010200     02 COMPUTED-X.
010300     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
010400     03 COMPUTED-N               REDEFINES COMPUTED-A
010500                                 PIC -9(9).9(9).
010600     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
010700     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
010800     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
010900     03       CM-18V0 REDEFINES COMPUTED-A.
011000         04 COMPUTED-18V0                    PIC -9(18).
011100         04 FILLER                           PIC X.
011200     03 FILLER PIC X(50) VALUE SPACE.
011300 01  TEST-CORRECT.
011400     02 FILLER PIC X(30) VALUE SPACE.
011500     02 FILLER PIC X(17) VALUE "       CORRECT =".
011600     02 CORRECT-X.
011700     03 CORRECT-A                  PIC X(20) VALUE SPACE.
011800     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
011900     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
012000     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
012100     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
012200     03      CR-18V0 REDEFINES CORRECT-A.
012300         04 CORRECT-18V0                     PIC -9(18).
012400         04 FILLER                           PIC X.
012500     03 FILLER PIC X(2) VALUE SPACE.
012600     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
012700 01  CCVS-C-1.
012800     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
012900-    "SS  PARAGRAPH-NAME
013000-    "       REMARKS".
013100     02 FILLER                     PIC X(20)    VALUE SPACE.
013200 01  CCVS-C-2.
013300     02 FILLER                     PIC X        VALUE SPACE.
013400     02 FILLER                     PIC X(6)     VALUE "TESTED".
013500     02 FILLER                     PIC X(15)    VALUE SPACE.
013600     02 FILLER                     PIC X(4)     VALUE "FAIL".
013700     02 FILLER                     PIC X(94)    VALUE SPACE.
013800 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
013900 01  REC-CT                        PIC 99       VALUE ZERO.
014000 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
014100 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
014200 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
014300 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
014400 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
014500 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
014600 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
014700 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
014800 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
014900 01  CCVS-H-1.
015000     02  FILLER                    PIC X(39)    VALUE SPACES.
015100     02  FILLER                    PIC X(42)    VALUE
015200     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
015300     02  FILLER                    PIC X(39)    VALUE SPACES.
015400 01  CCVS-H-2A.
015500   02  FILLER                        PIC X(40)  VALUE SPACE.
015600   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
015700   02  FILLER                        PIC XXXX   VALUE
015800     "4.2 ".
015900   02  FILLER                        PIC X(28)  VALUE
016000            " COPY - NOT FOR DISTRIBUTION".
016100   02  FILLER                        PIC X(41)  VALUE SPACE.
016200
016300 01  CCVS-H-2B.
016400   02  FILLER                        PIC X(15)  VALUE
016500            "TEST RESULT OF ".
016600   02  TEST-ID                       PIC X(9).
016700   02  FILLER                        PIC X(4)   VALUE
016800            " IN ".
016900   02  FILLER                        PIC X(12)  VALUE
017000     " HIGH       ".
017100   02  FILLER                        PIC X(22)  VALUE
017200            " LEVEL VALIDATION FOR ".
017300   02  FILLER                        PIC X(58)  VALUE
017400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
017500 01  CCVS-H-3.
017600     02  FILLER                      PIC X(34)  VALUE
017700            " FOR OFFICIAL USE ONLY    ".
017800     02  FILLER                      PIC X(58)  VALUE
017900     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
018000     02  FILLER                      PIC X(28)  VALUE
018100            "  COPYRIGHT   1985 ".
018200 01  CCVS-E-1.
018300     02 FILLER                       PIC X(52)  VALUE SPACE.
018400     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
018500     02 ID-AGAIN                     PIC X(9).
018600     02 FILLER                       PIC X(45)  VALUE SPACES.
018700 01  CCVS-E-2.
018800     02  FILLER                      PIC X(31)  VALUE SPACE.
018900     02  FILLER                      PIC X(21)  VALUE SPACE.
019000     02 CCVS-E-2-2.
019100         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
019200         03 FILLER                   PIC X      VALUE SPACE.
019300         03 ENDER-DESC               PIC X(44)  VALUE
019400            "ERRORS ENCOUNTERED".
019500 01  CCVS-E-3.
019600     02  FILLER                      PIC X(22)  VALUE
019700            " FOR OFFICIAL USE ONLY".
019800     02  FILLER                      PIC X(12)  VALUE SPACE.
019900     02  FILLER                      PIC X(58)  VALUE
020000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
020100     02  FILLER                      PIC X(13)  VALUE SPACE.
020200     02 FILLER                       PIC X(15)  VALUE
020300             " COPYRIGHT 1985".
020400 01  CCVS-E-4.
020500     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
020600     02 FILLER                       PIC X(4)   VALUE " OF ".
020700     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
020800     02 FILLER                       PIC X(40)  VALUE
020900      "  TESTS WERE EXECUTED SUCCESSFULLY".
021000 01  XXINFO.
021100     02 FILLER                       PIC X(19)  VALUE
021200            "*** INFORMATION ***".
021300     02 INFO-TEXT.
021400       04 FILLER                     PIC X(8)   VALUE SPACE.
021500       04 XXCOMPUTED                 PIC X(20).
021600       04 FILLER                     PIC X(5)   VALUE SPACE.
021700       04 XXCORRECT                  PIC X(20).
021800     02 INF-ANSI-REFERENCE           PIC X(48).
021900 01  HYPHEN-LINE.
022000     02 FILLER  PIC IS X VALUE IS SPACE.
022100     02 FILLER  PIC IS X(65)    VALUE IS "************************
022200-    "*****************************************".
022300     02 FILLER  PIC IS X(54)    VALUE IS "************************
022400-    "******************************".
022500 01  CCVS-PGM-ID                     PIC X(9)   VALUE
022600     "ST118A".
022700 PROCEDURE DIVISION.
022800 SORT-PARA SECTION.
022900 SORT-PARAGRAPH.
023000     SORT     SORTFILE-1H ON
023100              ASCENDING KEY SORTKEY-1
023200              ASCENDING SORTKEY-2
023300              ASCENDING SORTKEY-3
023400              ASCENDING SORTKEY-4
023500              ASCENDING SORTKEY-5
023600              ASCENDING SORTKEY-6
023700              ASCENDING SORTKEY-7
023800              ASCENDING SORTKEY-8
023900              INPUT PROCEDURE INPROC
024000              OUTPUT PROCEDURE OUTPROC THRU OUTPROC-EXIT.
024100     STOP     RUN.
024200 INPROC SECTION.
024300 BUILD-FILE.
024400     PERFORM  BUILD-RECORD.
024500     MOVE     +123456             TO SORTKEY-1.
024600     PERFORM  RELEASE-RECORD.
024700     PERFORM  BUILD-RECORD.
024800     MOVE     "X"                 TO SORTKEY-2.
024900     PERFORM  RELEASE-RECORD.
025000     PERFORM  BUILD-RECORD.
025100     MOVE     +.6                 TO SORTKEY-3.
025200     PERFORM  RELEASE-RECORD.
025300     PERFORM  BUILD-RECORD.
025400     MOVE     "X"                 TO SORTKEY-4.
025500     PERFORM  RELEASE-RECORD.
025600     PERFORM  BUILD-RECORD.
025700     MOVE     "Z"                 TO SORTKEY-5.
025800     PERFORM  RELEASE-RECORD.
025900     PERFORM  BUILD-RECORD.
026000     MOVE     "Z"                 TO SORTKEY-6.
026100     PERFORM  RELEASE-RECORD.
026200     PERFORM  BUILD-RECORD.
026300     MOVE     +418                TO SORTKEY-7.
026400     PERFORM  RELEASE-RECORD.
026500     PERFORM  BUILD-RECORD.
026600     MOVE     -14                 TO SORTKEY-8.
026700     PERFORM  RELEASE-RECORD.
026800     GO       TO BUILD-EXIT.
026900 BUILD-RECORD.
027000     MOVE     -054321             TO SORTKEY-1.
027100     MOVE     "BBB"               TO SORTKEY-2.
027200     MOVE     -.1234567890123456  TO SORTKEY-3.
027300     MOVE     "BBBBBB"            TO SORTKEY-4.
027400     MOVE     "A"                 TO SORTKEY-5.
027500     MOVE     "AAAAAAAA"          TO SORTKEY-6.
027600     MOVE     -501                TO SORTKEY-7.
027700*       NOTE THIS ITEM IS INTENTIONALLY MOVED TO AN UNSIGNED
027800*             FIELD.
027900     MOVE     +99                 TO SORTKEY-8.
028000 RELEASE-RECORD.
028100     RELEASE  SORTFILE-REC.
028200 BUILD-EXIT.
028300     EXIT.
028400 OUTPROC SECTION.
028500 OPEN-FILES.
028600     OPEN     OUTPUT PRINT-FILE.
028700     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
028800     MOVE    SPACE TO TEST-RESULTS.
028900     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
029000     IF       SPAC-E IS LESS THAN "B"
029100              GO TO SPACE-IS-LESS-THAN-B.
029200 B-IS-LESS-THAN-SPACE SECTION.
029300 SORT-INIT-A.
029400     MOVE     "SORT - 8 ASC. KEYS" TO FEATURE.
029500*        NOTE THE RECORDS SHOULD BE SORTED INTO THE FOLLOWING
029600*             ORDER --- 8 7 6 5 4 3 1 2 --- THAT IS,
029700*             THE 8TH RECORD SORTS UP TO THE 1ST POSITION,
029800*             THE 7TH RECORD SORTS UP TO THE 2ND POSITION, ETC.
029900 SORT-TEST-1.
030000     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
030100     IF       SORTKEY-7 EQUAL TO 418
030200              PERFORM PASS GO TO SORT-WRITE-1.
030300 SORT-FAIL-1.
030400     PERFORM  FAIL.
030500     MOVE     SORTKEY-7 TO COMPUTED-N.
030600     MOVE     418 TO CORRECT-N.
030700 SORT-WRITE-1.
030800     MOVE     "SORT-TEST-1 " TO PAR-NAME.
030900     PERFORM  PRINT-DETAIL.
031000 SORT-TEST-2.
031100     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
031200     IF       SORTKEY-8 EQUAL TO -14
031300              PERFORM PASS GO TO SORT-WRITE-2.
031400 SORT-FAIL-2.
031500     PERFORM  FAIL.
031600     MOVE     SORTKEY-8 TO COMPUTED-N.
031700     MOVE     -14 TO CORRECT-N.
031800 SORT-WRITE-2.
031900     MOVE     "SORT-TEST-2 " TO PAR-NAME.
032000     PERFORM  PRINT-DETAIL.
032100 SORT-TEST-3.
032200     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
032300     IF       SORTKEY-6 EQUAL TO "Z         "
032400              PERFORM PASS GO TO SORT-WRITE-3.
032500 SORT-FAIL-3.
032600     PERFORM  FAIL.
032700     MOVE     SORTKEY-6 TO COMPUTED-A.
032800     MOVE     "Z         "           TO CORRECT-A.
032900 SORT-WRITE-3.
033000     MOVE     "SORT-TEST-3 " TO PAR-NAME.
033100     PERFORM  PRINT-DETAIL.
033200 SORT-TEST-4.
033300     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
033400     IF       SORTKEY-5 EQUAL TO "Z                   "
033500              PERFORM PASS GO TO SORT-WRITE-4.
033600 SORT-FAIL-4.
033700     PERFORM  FAIL.
033800     MOVE     SORTKEY-5 TO COMPUTED-A.
033900     MOVE     "Z                   " TO CORRECT-A.
034000 SORT-WRITE-4.
034100     MOVE     "SORT-TEST-4 " TO PAR-NAME.
034200     PERFORM  PRINT-DETAIL.
034300 SORT-TEST-5.
034400     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
034500     IF       SORTKEY-4 EQUAL TO "         X"
034600              PERFORM PASS GO TO SORT-WRITE-5.
034700 SORT-FAIL-5.
034800     PERFORM  FAIL.
034900     MOVE     SORTKEY-4 TO COMPUTED-A.
035000     MOVE     "         X"           TO CORRECT-A.
035100 SORT-WRITE-5.
035200     MOVE     "SORT-TEST-5 " TO PAR-NAME.
035300     PERFORM  PRINT-DETAIL.
035400 SORT-TEST-6.
035500     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
035600     IF       SORTKEY-3 EQUAL TO +.6000000000000000
035700              PERFORM PASS GO TO SORT-WRITE-6.
035800 SORT-FAIL-6.
035900     PERFORM  FAIL.
036000     MOVE     SORTKEY-3 TO COMPUTED-0V18.
036100     MOVE     +.6000000000000000     TO CORRECT-0V18.
036200 SORT-WRITE-6.
036300     MOVE     "SORT-TEST-6 " TO PAR-NAME.
036400     PERFORM  PRINT-DETAIL.
036500 SORT-TEST-7.
036600     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
036700     IF       SORTKEY-2 EQUAL TO "    X"
036800              PERFORM PASS GO TO SORT-WRITE-7.
036900 SORT-FAIL-7.
037000     PERFORM  FAIL.
037100     MOVE     SORTKEY-2 TO COMPUTED-A.
037200     MOVE     "    X" TO CORRECT-A.
037300 SORT-WRITE-7.
037400     MOVE     "SORT-TEST-7 " TO PAR-NAME.
037500     PERFORM  PRINT-DETAIL.
037600 SORT-TEST-8.
037700     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
037800     IF       SORTKEY-1 EQUAL TO +123456
037900              PERFORM PASS GO TO SORT-WRITE-8.
038000 SORT-FAIL-8.
038100     PERFORM  FAIL.
038200     MOVE     SORTKEY-1 TO COMPUTED-N.
038300     MOVE     +123456 TO CORRECT-N.
038400 SORT-WRITE-8.
038500     MOVE     "SORT-TEST-8 " TO PAR-NAME.
038600     PERFORM  PRINT-DETAIL.
038700 SORT-REMARK-A.
038800     MOVE     SPACE TO FEATURE.
038900     MOVE     "THE COLLATING SEQUENCE" TO RE-MARK.
039000     PERFORM  PRINT-DETAIL.
039100     MOVE     "RENDERS TESTS 9 THRU 16" TO RE-MARK.
039200     PERFORM  PRINT-DETAIL.
039300     MOVE     "UNNECESSARY." TO RE-MARK.
039400     PERFORM  PRINT-DETAIL.
039500     MOVE     "SORT - 8 ASC. KEYS" TO FEATURE.
039600     GO       TO CONTINUE-TESTING.
039700 SPACE-IS-LESS-THAN-B SECTION.
039800 SORT-REMARK-B.
039900     MOVE     "THE COLLATING SEQUENCE" TO RE-MARK.
040000     PERFORM  PRINT-DETAIL.
040100     MOVE     "RENDERS TESTS 1 THRU 8" TO RE-MARK.
040200     PERFORM  PRINT-DETAIL.
040300     MOVE     "UNNECESSARY." TO RE-MARK.
040400     PERFORM  PRINT-DETAIL.
040500     MOVE     "SORT - 8 ASC. KEYS" TO FEATURE.
040600*        NOTE THE RECORDS SHOULD BE SORTED INTO THE FOLLOWING
040700*             ORDER --- 8 1 7 2 6 5 3 4 --- THAT IS,
040800*             THE 1ST RECORD IS SORTED DOWN TO THE 8TH POSITION,
040900*             THE 2ND RECORD SORTS UP TO THE 1ST POSITION, ETC.
041000 SORT-TEST-9.
041100     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
041200     IF       SORTKEY-2 EQUAL TO "    X"
041300              PERFORM PASS GO TO SORT-WRITE-9.
041400 SORT-FAIL-9.
041500     PERFORM  FAIL.
041600     MOVE     SORTKEY-2 TO COMPUTED-A.
041700     MOVE     "    X" TO CORRECT-A.
041800 SORT-WRITE-9.
041900     MOVE     "SORT-TEST-9 " TO PAR-NAME.
042000     PERFORM  PRINT-DETAIL.
042100 SORT-TEST-10.
042200     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
042300     IF       SORTKEY-4 EQUAL TO "         X"
042400              PERFORM PASS GO TO SORT-WRITE-10.
042500 SORT-FAIL-10.
042600     PERFORM  FAIL.
042700     MOVE     SORTKEY-4 TO COMPUTED-A.
042800     MOVE     "         X" TO CORRECT-A.
042900 SORT-WRITE-10.
043000     MOVE     "SORT-TEST-10" TO PAR-NAME.
043100     PERFORM  PRINT-DETAIL.
043200 SORT-TEST-11.
043300     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
043400     IF       SORTKEY-7 EQUAL TO 418
043500              PERFORM PASS GO TO SORT-WRITE-11.
043600 SORT-FAIL-11.
043700     PERFORM  FAIL.
043800     MOVE     SORTKEY-7 TO COMPUTED-N
043900     MOVE     418 TO CORRECT-N.
044000 SORT-WRITE-11.
044100     MOVE     "SORT-TEST-11" TO PAR-NAME.
044200     PERFORM  PRINT-DETAIL.
044300 SORT-TEST-12.
044400     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
044500     IF       SORTKEY-8 EQUAL TO -14
044600              PERFORM PASS GO TO SORT-WRITE-12.
044700 SORT-FAIL-12.
044800     PERFORM  FAIL.
044900     MOVE     SORTKEY-8 TO COMPUTED-N.
045000     MOVE     -14 TO CORRECT-N.
045100 SORT-WRITE-12.
045200     MOVE     "SORT-TEST-12" TO PAR-NAME.
045300     PERFORM  PRINT-DETAIL.
045400 SORT-TEST-13.
045500     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
045600     IF       SORTKEY-6 EQUAL TO "Z         "
045700              PERFORM PASS GO TO SORT-WRITE-13.
045800 SORT-FAIL-13.
045900     PERFORM  FAIL.
046000     MOVE     SORTKEY-6 TO COMPUTED-A.
046100     MOVE     "Z         "           TO CORRECT-A.
046200 SORT-WRITE-13.
046300     MOVE     "SORT-TEST-13" TO PAR-NAME.
046400     PERFORM  PRINT-DETAIL.
046500 SORT-TEST-14.
046600     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
046700     IF       SORTKEY-5 EQUAL TO "Z                   "
046800              PERFORM PASS GO TO SORT-WRITE-14.
046900 SORT-FAIL-14.
047000     PERFORM  FAIL.
047100     MOVE     SORTKEY-5 TO COMPUTED-A.
047200     MOVE     "Z                   " TO CORRECT-A.
047300 SORT-WRITE-14.
047400     MOVE     "SORT-TEST-14" TO PAR-NAME.
047500     PERFORM  PRINT-DETAIL.
047600 SORT-TEST-15.
047700     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
047800     IF       SORTKEY-3 EQUAL TO +.6000000000000000
047900              PERFORM PASS GO TO SORT-WRITE-15.
048000 SORT-FAIL-15.
048100     PERFORM  FAIL.
048200     MOVE     SORTKEY-3 TO COMPUTED-0V18.
048300     MOVE     +.6000000000000000     TO CORRECT-0V18.
048400 SORT-WRITE-15.
048500     MOVE     "SORT-TEST-15" TO PAR-NAME.
048600     PERFORM  PRINT-DETAIL.
048700 SORT-TEST-16.
048800     RETURN   SORTFILE-1H AT END GO TO RETURN-ERROR.
048900     IF       SORTKEY-1 EQUAL TO +123456
049000              PERFORM PASS GO TO SORT-WRITE-16.
049100 SORT-FAIL-16.
049200     PERFORM  FAIL.
049300     MOVE     SORTKEY-1 TO COMPUTED-N.
049400     MOVE     +123456 TO CORRECT-N.
049500 SORT-WRITE-16.
049600     MOVE     "SORT-TEST-16" TO PAR-NAME.
049700     PERFORM  PRINT-DETAIL.
049800 CONTINUE-TESTING SECTION.
049900 SORT-TEST-17.
050000     RETURN   SORTFILE-1H AT END
050100              PERFORM PASS GO TO SORT-WRITE-17.
050200 SORT-FAIL-17.
050300     MOVE     "END OF FILE NOT FOUND" TO RE-MARK.
050400     PERFORM  FAIL.
050500 SORT-WRITE-17.
050600     MOVE     "SORT-TEST-17" TO PAR-NAME.
050700     PERFORM  PRINT-DETAIL.
050800     GO       TO OUTPROC-EXIT.
050900 RETURN-ERROR.
051000     MOVE     "RETURN-ERROR" TO PAR-NAME.
051100     PERFORM  FAIL.
051200     MOVE     "EOF PREMATURELY FOUND" TO RE-MARK.
051300     PERFORM  PRINT-DETAIL.
051400     GO TO CCVS1-EXIT.
051500 CLOSE-FILES.
051600     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
051700 TERMINATE-CCVS.
051800S    EXIT PROGRAM.
051900STERMINATE-CALL.
052000     STOP     RUN.
052100 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
052200 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
052300 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
052400 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
052500     MOVE "****TEST DELETED****" TO RE-MARK.
052600 PRINT-DETAIL.
052700     IF REC-CT NOT EQUAL TO ZERO
052800             MOVE "." TO PARDOT-X
052900             MOVE REC-CT TO DOTVALUE.
053000     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
053100     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
053200        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
053300          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
053400     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
053500     MOVE SPACE TO CORRECT-X.
053600     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
053700     MOVE     SPACE TO RE-MARK.
053800 HEAD-ROUTINE.
053900     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
054000     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
054100     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
054200     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
054300 COLUMN-NAMES-ROUTINE.
054400     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
054500     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
054600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
054700 END-ROUTINE.
054800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
054900 END-RTN-EXIT.
055000     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
055100 END-ROUTINE-1.
055200      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
055300      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
055400      ADD PASS-COUNTER TO ERROR-HOLD.
055500*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
055600      MOVE PASS-COUNTER TO CCVS-E-4-1.
055700      MOVE ERROR-HOLD TO CCVS-E-4-2.
055800      MOVE CCVS-E-4 TO CCVS-E-2-2.
055900      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
056000  END-ROUTINE-12.
056100      MOVE "TEST(S) FAILED" TO ENDER-DESC.
056200     IF       ERROR-COUNTER IS EQUAL TO ZERO
056300         MOVE "NO " TO ERROR-TOTAL
056400         ELSE
056500         MOVE ERROR-COUNTER TO ERROR-TOTAL.
056600     MOVE     CCVS-E-2 TO DUMMY-RECORD.
056700     PERFORM WRITE-LINE.
056800 END-ROUTINE-13.
056900     IF DELETE-COUNTER IS EQUAL TO ZERO
057000         MOVE "NO " TO ERROR-TOTAL  ELSE
057100         MOVE DELETE-COUNTER TO ERROR-TOTAL.
057200     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
057300     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
057400      IF   INSPECT-COUNTER EQUAL TO ZERO
057500          MOVE "NO " TO ERROR-TOTAL
057600      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
057700      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
057800      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
057900     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
058000 WRITE-LINE.
058100     ADD 1 TO RECORD-COUNT.
058200Y    IF RECORD-COUNT GREATER 42
058300Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
058400Y        MOVE SPACE TO DUMMY-RECORD
058500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
058600Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
058700Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
058800Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
058900Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
059000Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
059100Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
059200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
059300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
059400Y        MOVE ZERO TO RECORD-COUNT.
059500     PERFORM WRT-LN.
059600 WRT-LN.
059700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
059800     MOVE SPACE TO DUMMY-RECORD.
059900 BLANK-LINE-PRINT.
060000     PERFORM WRT-LN.
060100 FAIL-ROUTINE.
060200     IF     COMPUTED-X NOT EQUAL TO SPACE
060300            GO TO   FAIL-ROUTINE-WRITE.
060400     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
060500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
060600     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
060700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
060800     MOVE   SPACES TO INF-ANSI-REFERENCE.
060900     GO TO  FAIL-ROUTINE-EX.
061000 FAIL-ROUTINE-WRITE.
061100     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
061200     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
061300     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
061400     MOVE   SPACES TO COR-ANSI-REFERENCE.
061500 FAIL-ROUTINE-EX. EXIT.
061600 BAIL-OUT.
061700     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
061800     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
061900 BAIL-OUT-WRITE.
062000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
062100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
062200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
062300     MOVE   SPACES TO INF-ANSI-REFERENCE.
062400 BAIL-OUT-EX. EXIT.
062500 CCVS1-EXIT.
062600     EXIT.
062700 OUTPROC-EXIT SECTION.
062800 EXIT-ONLY.
062900     PERFORM  CLOSE-FILES.
