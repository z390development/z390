000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ124A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
000900*                             REVISED 1986, AUGUST             *
001000*                                                              *
001100*    CREATION DATE     /     VALIDATION DATE                   *
001200*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001300*                                                              *
001400****************************************************************
001500*                                                              *
001600*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001700*                                                              *
001800*            X-14   SEQUENTIAL NON-UNIT MASS STORAGE FILE      *
001900*            X-55   SYSTEM PRINTER                             *
002000*            X-82   SOURCE-COMPUTER                            *
002100*            X-83   OBJECT-COMPUTER.                           *
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    THIS PROGRAM OPENS FOR OUTPUT A FILE WHICH IS ASSIGNED    *
002600*    TO A MEDIUM WHICH IS NOT A REEL/UNIT MEDIUM.  ONE RECORD  *
002700*    IS WRITTEN TO THE FILE AND A CLOSE UNIT STATEMENT IS      *
002800*    EXECUTED.  THIS SHOULD HAVE NO EFFECT ON THE FILE, EXCEPT *
002900*    TO CAUSE I-O STATUS 07.  THE FILE SHOULD REMAIN OPEN.  A  *
003000*    SECOND RECORD IS THEN WRITTEN AND A  NORMAL, UNQUALIFIED, *
003100*    CLOSE STATEMENT IS EXECUTED. THIS SHOULD BE SUCCESSFUL    *
003200*    AND CLOSE THE FILE.  THE FILE IS THEN REOPENED FOR INPUT  *
003300*    AND THE TWO RECORDS CHECKED.  A CLOSE UNIT STATEMENT IS   *
003400*    EXECUTED BEFORE THE FIRST RECORD IS READ, AND AGAIN THIS  *
003500*    SHOULD HAVE NO EFFECT ON SUBSEQUENT OPERATIONS ON THE     *
003600*    FILE.  AFTER THE TWO RECORDS HAVE BEEN READ, A FURTHER    *
003700*    READ STATEMENT IS EXECUTED TO RAISE THE AT END CONDITION, *
003800*    WHICH IS CHECKED, AND THE FILE IS CLOSED.                 *
003900*                                                              *
004000****************************************************************
004100*
004200 ENVIRONMENT DIVISION.
004300 CONFIGURATION SECTION.
004400 SOURCE-COMPUTER.
004500     XXXXX082.
004600 OBJECT-COMPUTER.
004700     XXXXX083.
004800*
004900 INPUT-OUTPUT SECTION.
005000 FILE-CONTROL.
005100     SELECT PRINT-FILE ASSIGN TO
005200     XXXXX055.
005300*
005400P    SELECT RAW-DATA   ASSIGN TO
005500P    XXXXX062
005600P          ORGANIZATION IS INDEXED
005700P          ACCESS MODE  IS RANDOM
005800P          RECORD-KEY   IS RAW-DATA-KEY.
005900P
006000     SELECT SQ-FS4 ASSIGN
006100     XXXXX014
006200            ORGANIZATION IS SEQUENTIAL
006300            ACCESS SEQUENTIAL
006400            FILE STATUS SQ-FS4-STATUS
006500                          IN STATUS-GROUP
006600            .
006700*
006800*
006900 DATA DIVISION.
007000 FILE SECTION.
007100 FD  PRINT-FILE
007200C    LABEL RECORDS
007300C    XXXXX084
007400C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007500               .
007600 01  PRINT-REC    PICTURE X(120).
007700 01  DUMMY-RECORD PICTURE X(120).
007800P
007900PFD  RAW-DATA.
008000P01  RAW-DATA-SATZ.
008100P    05  RAW-DATA-KEY        PIC X(6).
008200P    05  C-DATE              PIC 9(6).
008300P    05  C-TIME              PIC 9(8).
008400P    05  NO-OF-TESTS         PIC 99.
008500P    05  C-OK                PIC 999.
008600P    05  C-ALL               PIC 999.
008700P    05  C-FAIL              PIC 999.
008800P    05  C-DELETED           PIC 999.
008900P    05  C-INSPECT           PIC 999.
009000P    05  C-NOTE              PIC X(13).
009100P    05  C-INDENT            PIC X.
009200P    05  C-ABORT             PIC X(8).
009300*
009400 FD  SQ-FS4
009500C    LABEL RECORD IS STANDARD
009600                .
009700 01  SQ-FS4R1-F-G-120.
009800        05 SQ-FS4R1-RECORD-INFO-P1-120.
009900           07 FILLER              PIC X(5).
010000           07 FFILE-NAME          PIC X(6).
010100           07 FILLER              PIC X(8).
010200           07 FRECORD-NAME        PIC X(6).
010300           07 FILLER              PIC X(1).
010400           07 FREELUNIT-NUMBER    PIC 9(1).
010500           07 FILLER              PIC X(7).
010600           07 FRECORD-NUMBER      PIC 9(6).
010700           07 FILLER              PIC X(6).
010800           07 FUPDATE-NUMBER      PIC 9(2).
010900           07 FILLER              PIC X(5).
011000           07 FODO-NUMBER         PIC 9(4).
011100           07 FILLER              PIC X(5).
011200           07 FPROGRAM-NAME       PIC X(5).
011300           07 FILLER              PIC X(7).
011400           07 FRECORD-LENGTH      PIC 9(6).
011500           07 FILLER              PIC X(7).
011600           07 FCHARS-OR-RECORDS   PIC X(2).
011700           07 FILLER              PIC X(1).
011800           07 FBLOCK-SIZE         PIC 9(4).
011900           07 FILLER              PIC X(6).
012000           07 FRECORDS-IN-FILE    PIC 9(6).
012100           07 FILLER              PIC X(5).
012200           07 FFILE-ORGANIZATION  PIC X(2).
012300           07 FILLER              PIC X(6).
012400           07 FLABEL-TYPE         PIC X(1).
012500*
012600 WORKING-STORAGE SECTION.
012700*
012800***************************************************************
012900*                                                             *
013000*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
013100*                                                             *
013200***************************************************************
013300*
013400 01  STATUS-GROUP.
013500     03  SQ-FS4-STATUS.
013600       05  SQ-FS4-KEY-1   PIC X.
013700       05  SQ-FS4-KEY-2   PIC X.
013800*
013900 01  DELETE-SW.
014000     03  DELETE-SW-1 PIC X.
014100     03  DELETE-SW-1-GROUP.
014200         05  DELETE-SW-2 PIC X.
014300         05  DELETE-SW-2-GROUP.
014400             07  DELETE-SW-3 PIC X.
014500*
014600 01  AT-END-SW  PIC X(12).
014700 01  NOT-END-SW PIC X(12).
014800*
014900***************************************************************
015000*                                                             *
015100*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
015200*                                                             *
015300***************************************************************
015400*
015500 01  REC-SKEL-SUB   PIC 99.
015600*
015700 01  FILE-RECORD-INFORMATION-REC.
015800     03 FILE-RECORD-INFO-SKELETON.
015900        05 FILLER                 PICTURE X(48)       VALUE
016000             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
016100        05 FILLER                 PICTURE X(46)       VALUE
016200             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
016300        05 FILLER                 PICTURE X(26)       VALUE
016400             ",LFIL=000000,ORG=  ,LBLR= ".
016500        05 FILLER                 PICTURE X(37)       VALUE
016600             ",RECKEY=                             ".
016700        05 FILLER                 PICTURE X(38)       VALUE
016800             ",ALTKEY1=                             ".
016900        05 FILLER                 PICTURE X(38)       VALUE
017000             ",ALTKEY2=                             ".
017100        05 FILLER                 PICTURE X(7)        VALUE SPACE.
017200     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
017300        05 FILE-RECORD-INFO-P1-120.
017400           07 FILLER              PIC X(5).
017500           07 XFILE-NAME          PIC X(6).
017600           07 FILLER              PIC X(8).
017700           07 XRECORD-NAME        PIC X(6).
017800           07 FILLER              PIC X(1).
017900           07 REELUNIT-NUMBER     PIC 9(1).
018000           07 FILLER              PIC X(7).
018100           07 XRECORD-NUMBER      PIC 9(6).
018200           07 FILLER              PIC X(6).
018300           07 UPDATE-NUMBER       PIC 9(2).
018400           07 FILLER              PIC X(5).
018500           07 ODO-NUMBER          PIC 9(4).
018600           07 FILLER              PIC X(5).
018700           07 XPROGRAM-NAME       PIC X(5).
018800           07 FILLER              PIC X(7).
018900           07 XRECORD-LENGTH      PIC 9(6).
019000           07 FILLER              PIC X(7).
019100           07 CHARS-OR-RECORDS    PIC X(2).
019200           07 FILLER              PIC X(1).
019300           07 XBLOCK-SIZE         PIC 9(4).
019400           07 FILLER              PIC X(6).
019500           07 RECORDS-IN-FILE     PIC 9(6).
019600           07 FILLER              PIC X(5).
019700           07 XFILE-ORGANIZATION  PIC X(2).
019800           07 FILLER              PIC X(6).
019900           07 XLABEL-TYPE         PIC X(1).
020000        05 FILE-RECORD-INFO-P121-240.
020100           07 FILLER              PIC X(8).
020200           07 XRECORD-KEY         PIC X(29).
020300           07 FILLER              PIC X(9).
020400           07 ALTERNATE-KEY1      PIC X(29).
020500           07 FILLER              PIC X(9).
020600           07 ALTERNATE-KEY2      PIC X(29).
020700           07 FILLER              PIC X(7).
020800*
020900 01  TEST-RESULTS.
021000     02 FILLER              PIC X      VALUE SPACE.
021100     02  PAR-NAME.
021200       03 FILLER              PIC X(14)  VALUE SPACE.
021300       03 PARDOT-X            PIC X      VALUE SPACE.
021400       03 DOTVALUE            PIC 99     VALUE ZERO.
021500     02 FILLER              PIC X      VALUE SPACE.
021600     02 FEATURE             PIC X(24)  VALUE SPACE.
021700     02 FILLER              PIC X      VALUE SPACE.
021800     02 P-OR-F              PIC X(5)   VALUE SPACE.
021900     02 FILLER              PIC X(9)   VALUE SPACE.
022000     02 RE-MARK             PIC X(61).
022100 01  TEST-COMPUTED.
022200   02 FILLER  PIC X(30)  VALUE SPACE.
022300   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
022400   02 COMPUTED-X.
022500     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
022600     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
022700     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
022800     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
022900     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
023000     03       CM-18V0 REDEFINES COMPUTED-A.
023100        04 COMPUTED-18V0                   PIC -9(18).
023200        04 FILLER                          PIC X.
023300     03 FILLER PIC X(50) VALUE SPACE.
023400 01  TEST-CORRECT.
023500     02 FILLER PIC X(30) VALUE SPACE.
023600     02 FILLER PIC X(17) VALUE "       CORRECT =".
023700     02 CORRECT-X.
023800     03 CORRECT-A                  PIC X(20) VALUE SPACE.
023900     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
024000     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
024100     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
024200     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
024300     03      CR-18V0 REDEFINES CORRECT-A.
024400         04 CORRECT-18V0                     PIC -9(18).
024500         04 FILLER                           PIC X.
024600     03 FILLER PIC X(2) VALUE SPACE.
024700     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
024800*
024900 01  CCVS-C-1.
025000     02 FILLER  PIC IS X        VALUE  SPACE.
025100     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
025200     02 FILLER  PIC IS X        VALUE  SPACE.
025300     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
025400     02 FILLER  PIC IS X        VALUE  SPACE.
025500     02 FILLER  PIC IS X(5)     VALUE "PASS ".
025600     02 FILLER  PIC IS X(9)     VALUE  SPACE.
025700     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
025800 01  CCVS-C-2.
025900     02 FILLER  PIC X(19)  VALUE  SPACE.
026000     02 FILLER  PIC X(6)   VALUE "TESTED".
026100     02 FILLER  PIC X(19)  VALUE  SPACE.
026200     02 FILLER  PIC X(4)   VALUE "FAIL".
026300     02 FILLER  PIC X(72)  VALUE  SPACE.
026400*
026500 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
026600 01  REC-CT            PIC 99       VALUE ZERO.
026700 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
026800 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
026900 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
027000 01  PASS-COUNTER      PIC 999      VALUE ZERO.
027100 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
027200 01  ERROR-HOLD        PIC 999      VALUE ZERO.
027300 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
027400 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
027500 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
027600 01  CCVS-H-1.
027700     02  FILLER          PIC X(39)    VALUE SPACES.
027800     02  FILLER          PIC X(42)    VALUE
027900     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
028000     02  FILLER          PIC X(39)    VALUE SPACES.
028100 01  CCVS-H-2A.
028200   02  FILLER            PIC X(40)  VALUE SPACE.
028300   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
028400   02  FILLER            PIC XXXX   VALUE
028500     "4.2 ".
028600   02  FILLER            PIC X(28)  VALUE
028700            " COPY - NOT FOR DISTRIBUTION".
028800   02  FILLER            PIC X(41)  VALUE SPACE.
028900*
029000 01  CCVS-H-2B.
029100   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
029200   02  TEST-ID           PIC X(9).
029300   02  FILLER            PIC X(4)   VALUE " IN ".
029400   02  FILLER            PIC X(12)  VALUE
029500     " HIGH       ".
029600   02  FILLER            PIC X(22)  VALUE
029700            " LEVEL VALIDATION FOR ".
029800   02  FILLER            PIC X(58)  VALUE
029900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
030000 01  CCVS-H-3.
030100     02  FILLER          PIC X(34)  VALUE
030200            " FOR OFFICIAL USE ONLY    ".
030300     02  FILLER          PIC X(58)  VALUE
030400     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
030500     02  FILLER          PIC X(28)  VALUE
030600            "  COPYRIGHT   1985,1986 ".
030700 01  CCVS-E-1.
030800     02 FILLER           PIC X(52)  VALUE SPACE.
030900     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
031000     02 ID-AGAIN         PIC X(9).
031100     02 FILLER           PIC X(45)  VALUE SPACES.
031200 01  CCVS-E-2.
031300     02  FILLER          PIC X(31)  VALUE SPACE.
031400     02  FILLER          PIC X(21)  VALUE SPACE.
031500     02  CCVS-E-2-2.
031600         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
031700         03 FILLER         PIC X      VALUE SPACE.
031800         03 ENDER-DESC     PIC X(44)  VALUE
031900            "ERRORS ENCOUNTERED".
032000 01  CCVS-E-3.
032100     02  FILLER          PIC X(22)  VALUE
032200            " FOR OFFICIAL USE ONLY".
032300     02  FILLER          PIC X(12)  VALUE SPACE.
032400     02  FILLER          PIC X(58)  VALUE
032500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
032600     02  FILLER          PIC X(8)   VALUE SPACE.
032700     02  FILLER          PIC X(20)  VALUE
032800             " COPYRIGHT 1985,1986".
032900 01  CCVS-E-4.
033000     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
033100     02 FILLER           PIC X(4)   VALUE " OF ".
033200     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
033300     02 FILLER           PIC X(40)  VALUE
033400      "  TESTS WERE EXECUTED SUCCESSFULLY".
033500 01  XXINFO.
033600     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
033700     02 INFO-TEXT.
033800       04 FILLER             PIC X(8)   VALUE SPACE.
033900       04 XXCOMPUTED         PIC X(20).
034000       04 FILLER             PIC X(5)   VALUE SPACE.
034100       04 XXCORRECT          PIC X(20).
034200     02 INF-ANSI-REFERENCE PIC X(48).
034300 01  HYPHEN-LINE.
034400     02 FILLER  PIC IS X VALUE IS SPACE.
034500     02 FILLER  PIC IS X(65)    VALUE IS "************************
034600-    "*****************************************".
034700     02 FILLER  PIC IS X(54)    VALUE IS "************************
034800-    "******************************".
034900 01  CCVS-PGM-ID  PIC X(9)   VALUE
035000     "SQ124A".
035100*
035200*
035300 PROCEDURE DIVISION.
035400 CCVS1 SECTION.
035500 OPEN-FILES.
035600P    OPEN    I-O RAW-DATA.
035700P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
035800P    READ    RAW-DATA INVALID KEY GO TO END-E-1.
035900P    MOVE   "ABORTED "   TO C-ABORT.
036000P    ADD     1           TO C-NO-OF-TESTS.
036100P    ACCEPT  C-DATE      FROM DATE.
036200P    ACCEPT  C-TIME      FROM TIME.
036300P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
036400PEND-E-1.
036500P    CLOSE   RAW-DATA.
036600     OPEN    OUTPUT PRINT-FILE.
036700     MOVE    CCVS-PGM-ID TO TEST-ID.
036800     MOVE    CCVS-PGM-ID TO ID-AGAIN.
036900     MOVE    SPACE TO TEST-RESULTS.
037000     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
037100     MOVE    ZERO TO REC-SKEL-SUB.
037200     PERFORM CCVS-INIT-FILE 10 TIMES.
037300     GO TO CCVS1-EXIT.
037400*
037500 CCVS-INIT-FILE.
037600     ADD     1 TO REC-SKL-SUB.
037700     MOVE    FILE-RECORD-INFO-SKELETON TO
037800                  FILE-RECORD-INFO (REC-SKL-SUB).
037900*
038000 CLOSE-FILES.
038100     PERFORM END-ROUTINE THRU END-ROUTINE-13.
038200     CLOSE   PRINT-FILE.
038300P    OPEN    I-O RAW-DATA.
038400P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
038500P    READ    RAW-DATA INVALID KEY GO TO END-E-2.
038600P    MOVE   "OK.     " TO C-ABORT.
038700P    MOVE    PASS-COUNTER  TO C-OK.
038800P    MOVE    ERROR-HOLD    TO C-ALL.
038900P    MOVE    ERROR-COUNTER TO C-FAIL.
039000P    MOVE    DELETE-CNT    TO C-DELETED.
039100P    MOVE    INSPECT-COUNTER TO C-INSPECT.
039200P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
039300PEND-E-2.
039400P    CLOSE   RAW-DATA.
039500 TERMINATE-CCVS.
039600S    EXIT    PROGRAM.
039700     STOP    RUN.
039800*
039900 INSPT.
040000     MOVE   "INSPT" TO P-OR-F.
040100     ADD     1 TO INSPECT-COUNTER.
040200     PERFORM PRINT-DETAIL.
040300*
040400 PASS.
040500     MOVE   "PASS " TO P-OR-F.
040600     ADD     1 TO PASS-COUNTER.
040700     PERFORM PRINT-DETAIL.
040800*
040900 FAIL.
041000     MOVE   "FAIL*" TO P-OR-F.
041100     ADD     1 TO ERROR-COUNTER.
041200     PERFORM PRINT-DETAIL.
041300*
041400 DE-LETE.
041500     MOVE   "****TEST DELETED****" TO RE-MARK.
041600     MOVE   "*****" TO P-OR-F.
041700     ADD     1 TO DELETE-COUNTER.
041800     PERFORM PRINT-DETAIL.
041900*
042000 PRINT-DETAIL.
042100     IF REC-CT NOT EQUAL TO ZERO
042200         MOVE   "." TO PARDOT-X
042300         MOVE    REC-CT TO DOTVALUE.
042400     MOVE    TEST-RESULTS TO PRINT-REC.
042500     PERFORM WRITE-LINE.
042600     IF P-OR-F EQUAL TO "FAIL*"
042700         PERFORM WRITE-LINE
042800         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
042900     ELSE
043000         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
043100     MOVE    SPACE TO P-OR-F.
043200     MOVE    SPACE TO COMPUTED-X.
043300     MOVE    SPACE TO CORRECT-X.
043400     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
043500     MOVE    SPACE TO RE-MARK.
043600*
043700 HEAD-ROUTINE.
043800     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043900     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044000     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
044100     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
044200 COLUMN-NAMES-ROUTINE.
044300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
044400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
044600 END-ROUTINE.
044700     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
044800     PERFORM WRITE-LINE 5 TIMES.
044900 END-RTN-EXIT.
045000     MOVE    CCVS-E-1 TO DUMMY-RECORD.
045100     PERFORM WRITE-LINE 2 TIMES.
045200*
045300 END-ROUTINE-1.
045400     ADD     ERROR-COUNTER   TO ERROR-HOLD
045500     ADD     INSPECT-COUNTER TO ERROR-HOLD.
045600     ADD     DELETE-COUNTER  TO ERROR-HOLD.
045700     ADD     PASS-COUNTER    TO ERROR-HOLD.
045800     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
045900     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
046000     MOVE    CCVS-E-4        TO CCVS-E-2-2.
046100     MOVE    CCVS-E-2        TO DUMMY-RECORD
046200     PERFORM WRITE-LINE.
046300     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
046400     IF ERROR-COUNTER IS EQUAL TO ZERO
046500         MOVE   "NO " TO ERROR-TOTAL
046600     ELSE
046700         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
046800     MOVE    CCVS-E-2 TO DUMMY-RECORD.
046900     PERFORM WRITE-LINE.
047000 END-ROUTINE-13.
047100     IF DELETE-COUNTER IS EQUAL TO ZERO
047200         MOVE   "NO " TO ERROR-TOTAL
047300     ELSE
047400         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
047500     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
047600     MOVE    CCVS-E-2 TO DUMMY-RECORD.
047700     PERFORM WRITE-LINE.
047800     IF INSPECT-COUNTER EQUAL TO ZERO
047900         MOVE   "NO " TO ERROR-TOTAL
048000     ELSE
048100         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
048200     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
048300     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
048400     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
048500*
048600 WRITE-LINE.
048700     ADD     1 TO RECORD-COUNT.
048800Y    IF RECORD-COUNT GREATER 50
048900Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
049000Y        MOVE  SPACE TO DUMMY-RECORD
049100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
049200Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
049300Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
049400Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
049500Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
049600Y        MOVE  ZERO TO RECORD-COUNT.
049700     PERFORM WRT-LN.
049800*
049900 WRT-LN.
050000     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
050100     MOVE    SPACE TO DUMMY-RECORD.
050200 BLANK-LINE-PRINT.
050300     PERFORM WRT-LN.
050400 FAIL-ROUTINE.
050500     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
050600     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
050700     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
050800     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
050900     MOVE    XXINFO TO DUMMY-RECORD.
051000     PERFORM WRITE-LINE 2 TIMES.
051100     MOVE    SPACES TO INF-ANSI-REFERENCE.
051200     GO TO   FAIL-ROUTINE-EX.
051300 FAIL-ROUTINE-WRITE.
051400     MOVE    TEST-COMPUTED  TO PRINT-REC
051500     PERFORM WRITE-LINE
051600     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
051700     MOVE    TEST-CORRECT   TO PRINT-REC
051800     PERFORM WRITE-LINE 2 TIMES.
051900     MOVE    SPACES         TO COR-ANSI-REFERENCE.
052000 FAIL-ROUTINE-EX.
052100     EXIT.
052200 BAIL-OUT.
052300     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
052400     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
052500 BAIL-OUT-WRITE.
052600     MOVE    CORRECT-A      TO XXCORRECT.
052700     MOVE    COMPUTED-A     TO XXCOMPUTED.
052800     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
052900     MOVE    XXINFO TO DUMMY-RECORD.
053000     PERFORM WRITE-LINE 2 TIMES.
053100     MOVE    SPACES TO INF-ANSI-REFERENCE.
053200 BAIL-OUT-EX.
053300     EXIT.
053400 CCVS1-EXIT.
053500     EXIT.
053600*
053700****************************************************************
053800*                                                              *
053900*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
054000*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
054100*                                                              *
054200****************************************************************
054300*
054400 SECT-SQ124A-0004 SECTION.
054500 STA-INIT.
054600     MOVE    SPACE TO DELETE-SW.
054700*
054800     MOVE   "SQ-FS4" TO XFILE-NAME (1).
054900     MOVE   "R1-F-G" TO XRECORD-NAME (1).
055000     MOVE    CCVS-PGM-ID TO XPROGRAM-NAME (1).
055100     MOVE    125 TO XRECORD-LENGTH (1).
055200     MOVE   "RC" TO CHARS-OR-RECORDS (1).
055300     MOVE    1   TO XBLOCK-SIZE (1).
055400     MOVE    2   TO RECORDS-IN-FILE (1).
055500     MOVE   "SQ" TO XFILE-ORGANIZATION (1).
055600     MOVE   "S"  TO XLABEL-TYPE (1).
055700     MOVE    ZERO TO XRECORD-NUMBER (1).
055800*
055900*    OPEN THE FILE IN THE OUTPUT MODE
056000*    DELETION OF THE OPEN OPERATION DELETES EVERY TEST
056100*    IN THE PROGRAM
056200*
056300 SEQ-INIT-01.
056400     MOVE    0 TO REC-CT.
056500     MOVE   "**" TO SQ-FS4-STATUS.
056600     MOVE   "OPEN, CREATE FILE"  TO FEATURE.
056700     MOVE   "SEQ-TEST-OP-01" TO PAR-NAME.
056800     GO TO   SEQ-TEST-OP-01.
056900 SEQ-DELETE-01.
057000     MOVE   "*" TO DELETE-SW-1.
057100     GO TO   SEQ-DELETE-01-01.
057200 SEQ-TEST-OP-01.
057300     OPEN    OUTPUT SQ-FS4.
057400*
057500*    CHECK I-O STATUS RETURNED FROM OPEN OUTPUT
057600*
057700     ADD    1 TO REC-CT.
057800     IF DELETE-SW NOT = SPACE
057900         GO TO   SEQ-DELETE-01-01.
058000     GO TO   SEQ-TEST-OP-01-01.
058100 SEQ-DELETE-01-01.
058200     PERFORM DE-LETE.
058300     GO TO   SEQ-TEST-01-01-END.
058400 SEQ-TEST-OP-01-01.
058500     IF SQ-FS4-STATUS = "00"
058600         PERFORM PASS
058700     ELSE
058800         MOVE    SQ-FS4-STATUS TO COMPUTED-A
058900         MOVE   "00" TO CORRECT-A
059000         MOVE   "UNEXPECTED ERROR CODE FROM OPEN OUTPUT"
059100                   TO RE-MARK
059200         MOVE   "VII-3, VII-23" TO ANSI-REFERENCE
059300         PERFORM FAIL.
059400 SEQ-TEST-01-01-END.
059500*
059600*
059700*    THE FILE HAS BEEN CREATED.  WE NOW WRITE ONE RECORD
059800*    DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS
059900*    BUT DOES NOT AFFECT SUBSEQUENT OPERATIONS.
060000*
060100 SEQ-INIT-02.
060200     MOVE    0 TO REC-CT.
060300     MOVE   "**" TO SQ-FS4-STATUS.
060400     ADD     1 TO XRECORD-NUMBER (1).
060500     MOVE   "WRITE FIRST RECORD" TO FEATURE.
060600     MOVE   "SEQ-TEST-WR-02" TO PAR-NAME.
060700     IF DELETE-SW NOT EQUAL TO SPACE
060800         GO TO SEQ-DELETE-02.
060900     GO TO   SEQ-TEST-WR-02.
061000 SEQ-DELETE-02.
061100     MOVE   "*" TO DELETE-SW-2.
061200     GO TO   SEQ-DELETE-02-01.
061300 SEQ-TEST-WR-02.
061400     MOVE    FILE-RECORD-INFO (1) TO SQ-FS4R1-F-G-120.
061500     WRITE   SQ-FS4R1-F-G-120.
061600*
061700*    CHECK I-O STATUS RETURNED FROM WRITE
061800*
061900     ADD    1 TO REC-CT.
062000     IF DELETE-SW NOT = SPACE
062100         GO TO   SEQ-DELETE-02-01.
062200     GO TO   SEQ-TEST-WR-02-01.
062300 SEQ-DELETE-02-01.
062400     PERFORM DE-LETE.
062500     GO TO   SEQ-TEST-02-01-END.
062600 SEQ-TEST-WR-02-01.
062700     IF SQ-FS4-STATUS = "00"
062800         PERFORM PASS
062900     ELSE
063000         MOVE    SQ-FS4-STATUS TO COMPUTED-A
063100         MOVE   "00" TO CORRECT-A
063200         MOVE   "UNEXPECTED I-O STATUS FROM WRITE" TO RE-MARK
063300         MOVE   "VII-3, VII-53,4.7.4(5)" TO ANSI-REFERENCE
063400         PERFORM FAIL.
063500 SEQ-TEST-02-01-END.
063600     MOVE    SPACE TO DELETE-SW-2.
063700*
063800*
063900*    ONE RECORD HAS BEEN WRITTEN.  WE NOW EXECUTE CLOSE REEL
064000*    DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS
064100*    BUT DOES NOT AFFECT SUBSEQUENT OPERATIONS.
064200*
064300 SEQ-INIT-03.
064400     MOVE    0 TO REC-CT.
064500     MOVE   "**" TO SQ-FS4-STATUS.
064600     MOVE   "CLOSE UNIT, NON-UNIT" TO FEATURE.
064700     MOVE   "SEQ-TEST-CR-03" TO PAR-NAME.
064800     IF DELETE-SW NOT EQUAL TO SPACE
064900         GO TO SEQ-DELETE-03.
065000     GO TO   SEQ-TEST-CR-03.
065100 SEQ-DELETE-03.
065200     MOVE   "*" TO DELETE-SW-2.
065300     GO TO   SEQ-DELETE-03-01.
065400 SEQ-TEST-CR-03.
065500     CLOSE   SQ-FS4 UNIT.
065600*
065700*    CHECK I-O STATUS RETURNED FROM CLOSE REEL
065800*
065900     ADD    1 TO REC-CT.
066000     IF DELETE-SW NOT = SPACE
066100         GO TO   SEQ-DELETE-03-01.
066200     GO TO   SEQ-TEST-CR-03-01.
066300 SEQ-DELETE-03-01.
066400     PERFORM DE-LETE.
066500     GO TO   SEQ-TEST-03-01-END.
066600 SEQ-TEST-CR-03-01.
066700     IF SQ-FS4-STATUS = "07"
066800         PERFORM PASS
066900     ELSE
067000         MOVE    SQ-FS4-STATUS TO COMPUTED-A
067100         MOVE   "07" TO CORRECT-A
067200         MOVE   "UNEXPECTED I-O STATUS FROM CLOSE REEL"
067300                   TO RE-MARK
067400         MOVE   "VII-3, VII-38,4.2.4(3)F" TO ANSI-REFERENCE
067500         PERFORM FAIL.
067600 SEQ-TEST-03-01-END.
067700     MOVE    SPACE TO DELETE-SW-2.
067800*
067900*    THE FILE SHOULD STILL BE OPEN. WE NOW WRITE ONE MORE RECORD
068000*    DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS
068100*    BUT DOES NOT AFFECT SUBSEQUENT OPERATIONS.
068200*
068300 SEQ-INIT-04.
068400     MOVE    0 TO REC-CT.
068500     MOVE   "**" TO SQ-FS4-STATUS.
068600     ADD     1 TO XRECORD-NUMBER (1).
068700     MOVE   "WRITE SECOND RECORD" TO FEATURE.
068800     MOVE   "SEQ-TEST-WR-04" TO PAR-NAME.
068900     IF DELETE-SW NOT EQUAL TO SPACE
069000         GO TO SEQ-DELETE-04.
069100     GO TO   SEQ-TEST-WR-04.
069200 SEQ-DELETE-04.
069300     MOVE   "*" TO DELETE-SW-2.
069400     GO TO   SEQ-DELETE-04-01.
069500 SEQ-TEST-WR-04.
069600     MOVE    FILE-RECORD-INFO (1) TO SQ-FS4R1-F-G-120.
069700     WRITE   SQ-FS4R1-F-G-120.
069800*
069900*    CHECK I-O STATUS RETURNED FROM WRITE
070000*
070100     ADD    1 TO REC-CT.
070200     IF DELETE-SW NOT = SPACE
070300         GO TO   SEQ-DELETE-04-01.
070400     GO TO   SEQ-TEST-WR-04-01.
070500 SEQ-DELETE-04-01.
070600     PERFORM DE-LETE.
070700     GO TO   SEQ-TEST-04-01-END.
070800 SEQ-TEST-WR-04-01.
070900     IF SQ-FS4-STATUS = "00"
071000         PERFORM PASS
071100     ELSE
071200         MOVE    SQ-FS4-STATUS TO COMPUTED-A
071300         MOVE   "00" TO CORRECT-A
071400         MOVE   "UNEXPECTED I-O STATUS FROM WRITE" TO RE-MARK
071500         MOVE   "VII-3, VII-53,4.7.4(5)" TO ANSI-REFERENCE
071600         PERFORM FAIL.
071700 SEQ-TEST-04-01-END.
071800     MOVE    SPACE TO DELETE-SW-2.
071900*
072000*
072100*    NOW EXECUTE A NORMAL CLOSE ON THE FILE.
072200*    DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS
072300*    BUT DOES NOT AFFECT SUBSEQUENT OPERATIONS.
072400*
072500 SEQ-INIT-05.
072600     MOVE    0 TO REC-CT.
072700     MOVE   "**" TO SQ-FS4-STATUS.
072800     MOVE   "CLOSE AFTER CLOSE REEL"  TO FEATURE.
072900     MOVE   "SEQ-TEST-CL-05" TO PAR-NAME.
073000     IF DELETE-SW NOT EQUAL TO SPACE
073100         GO TO SEQ-DELETE-05.
073200     GO TO   SEQ-TEST-CL-05.
073300 SEQ-DELETE-05.
073400     MOVE   "*" TO DELETE-SW-2.
073500     GO TO   SEQ-DELETE-05-01.
073600 SEQ-TEST-CL-05.
073700     CLOSE   SQ-FS4.
073800*
073900*    CHECK I-O STATUS RETURNED FROM CLOSE
074000*
074100     ADD    1 TO REC-CT.
074200     IF DELETE-SW NOT = SPACE
074300         GO TO   SEQ-DELETE-05-01.
074400     GO TO   SEQ-TEST-CL-05-01.
074500 SEQ-DELETE-05-01.
074600     PERFORM DE-LETE.
074700     GO TO   SEQ-TEST-05-01-END.
074800 SEQ-TEST-CL-05-01.
074900     IF SQ-FS4-STATUS = "00"
075000         PERFORM PASS
075100     ELSE
075200         MOVE    SQ-FS4-STATUS TO COMPUTED-A
075300         MOVE   "00" TO CORRECT-A
075400         MOVE   "UNEXPECTED ERROR CODE FROM CLOSE"
075500                   TO RE-MARK
075600         MOVE   "VII-3, VII-38,4.2.4(4)" TO ANSI-REFERENCE
075700         PERFORM FAIL.
075800 SEQ-TEST-05-01-END.
075900     MOVE    SPACE TO DELETE-SW-2.
076000*
076100*
076200*    NOW OPEN THE FILE FOR INPUT.
076300*    DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS
076400*    AND ALSO DELETES THE SUBSEQUENT OPERATIONS.
076500*
076600 SEQ-INIT-06.
076700     MOVE    0 TO REC-CT.
076800     MOVE    ZERO TO XRECORD-NUMBER (1).
076900     MOVE   "**" TO SQ-FS4-STATUS.
077000     MOVE   "OPEN FILE FOR INPUT"  TO FEATURE.
077100     MOVE   "SEQ-TEST-OP-06" TO PAR-NAME.
077200     IF DELETE-SW NOT EQUAL TO SPACE
077300         GO TO SEQ-DELETE-06.
077400     GO TO   SEQ-TEST-OP-06.
077500 SEQ-DELETE-06.
077600     MOVE   "*" TO DELETE-SW-2.
077700     GO TO   SEQ-DELETE-06-01.
077800 SEQ-TEST-OP-06.
077900     OPEN    INPUT SQ-FS4.
078000     MOVE    SPACE TO SQ-FS4R1-F-G-120.
078100*
078200*    CHECK I-O STATUS RETURNED FROM OPEN
078300*
078400     ADD    1 TO REC-CT.
078500     IF DELETE-SW NOT = SPACE
078600         GO TO   SEQ-DELETE-06-01.
078700     GO TO   SEQ-TEST-OP-06-01.
078800 SEQ-DELETE-06-01.
078900     PERFORM DE-LETE.
079000     GO TO   SEQ-TEST-06-01-END.
079100 SEQ-TEST-OP-06-01.
079200     IF SQ-FS4-STATUS = "00"
079300         PERFORM PASS
079400     ELSE
079500         MOVE    SQ-FS4-STATUS TO COMPUTED-A
079600         MOVE   "00" TO CORRECT-A
079700         MOVE   "UNEXPECTED ERROR CODE FROM OPEN INPUT"
079800                   TO RE-MARK
079900         MOVE   "VII-3, VII-43,4.3.4(23)" TO ANSI-REFERENCE
080000         PERFORM FAIL.
080100 SEQ-TEST-06-01-END.
080200*
080300*
080400*    WE NOW EXECUTE CLOSE REEL BEFORE ANY RECORD HAS BEEN READ.
080500*    APART FROM SETTING I-O STATUS 07 THIS SHOULD HAVE NO EFFECT
080600*    ON THE FILE OR THE SUBSEQUENT RETRIEVAL OF RECORDS.
080700*    DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS
080800*    BUT DOES NOT AFFECT SUBSEQUENT OPERATIONS.
080900*
081000 SEQ-INIT-07.
081100     MOVE    0 TO REC-CT.
081200     MOVE   "**" TO SQ-FS4-STATUS.
081300     MOVE   "CLOSE UNIT, NON-UNIT" TO FEATURE.
081400     MOVE   "SEQ-TEST-CU-07" TO PAR-NAME.
081500     IF DELETE-SW NOT EQUAL TO SPACE
081600         GO TO SEQ-DELETE-07.
081700     GO TO   SEQ-TEST-CU-07.
081800 SEQ-DELETE-07.
081900     MOVE   "*" TO DELETE-SW-3.
082000     GO TO   SEQ-DELETE-07-01.
082100 SEQ-TEST-CU-07.
082200     CLOSE   SQ-FS4 UNIT.
082300*
082400*    CHECK I-O STATUS RETURNED FROM CLOSE REEL
082500*
082600     ADD    1 TO REC-CT.
082700     IF DELETE-SW NOT = SPACE
082800         GO TO   SEQ-DELETE-07-01.
082900     GO TO   SEQ-TEST-CU-07-01.
083000 SEQ-DELETE-07-01.
083100     PERFORM DE-LETE.
083200     GO TO   SEQ-TEST-07-01-END.
083300 SEQ-TEST-CU-07-01.
083400     IF SQ-FS4-STATUS = "07"
083500         PERFORM PASS
083600     ELSE
083700         MOVE    SQ-FS4-STATUS TO COMPUTED-A
083800         MOVE   "07" TO CORRECT-A
083900         MOVE   "UNEXPECTED I-O STATUS FROM CLOSE UNIT"
084000                   TO RE-MARK
084100         MOVE   "VII-3, VII-38,4.2.4(3)F" TO ANSI-REFERENCE
084200         PERFORM FAIL.
084300 SEQ-TEST-07-01-END.
084400     MOVE    SPACE TO DELETE-SW-3.
084500*
084600*    THE FILE SHOULD STILL BE OPEN. WE NOW READ A RECORD.
084700*    DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS
084800*    BUT DOES NOT AFFECT SUBSEQUENT OPERATIONS.
084900*
085000 SEQ-INIT-08.
085100     MOVE    0 TO REC-CT.
085200     MOVE   "**" TO SQ-FS4-STATUS.
085300     MOVE   "NOT EXECUTED" TO AT-END-SW.
085400     MOVE   "NOT EXECUTED" TO NOT-END-SW.
085500     ADD     1 TO XRECORD-NUMBER (1).
085600     MOVE   "READ FIRST RECORD" TO FEATURE.
085700     MOVE   "SEQ-TEST-RD-08" TO PAR-NAME.
085800     IF DELETE-SW NOT EQUAL TO SPACE
085900         GO TO SEQ-DELETE-08.
086000     GO TO   SEQ-TEST-RD-08.
086100 SEQ-DELETE-08.
086200     MOVE   "*" TO DELETE-SW-3.
086300     GO TO   SEQ-DELETE-08-01.
086400 SEQ-TEST-RD-08.
086500     MOVE    SPACE TO SQ-FS4R1-F-G-120.
086600     READ    SQ-FS4
086700     AT END
086800         MOVE   "EXECUTED" TO AT-END-SW
086900     NOT END
087000         MOVE   "EXECUTED" TO NOT-END-SW.
087100*
087200*    CHECK I-O STATUS RETURNED FROM READ
087300*
087400     ADD    1 TO REC-CT.
087500     IF DELETE-SW NOT = SPACE
087600         GO TO   SEQ-DELETE-08-01.
087700     GO TO   SEQ-TEST-RD-08-01.
087800 SEQ-DELETE-08-01.
087900     PERFORM DE-LETE.
088000     GO TO   SEQ-TEST-08-01-END.
088100 SEQ-TEST-RD-08-01.
088200     IF SQ-FS4-STATUS = "00"
088300         PERFORM PASS
088400     ELSE
088500         MOVE    SQ-FS4-STATUS TO COMPUTED-A
088600         MOVE   "00" TO CORRECT-A
088700         MOVE   "UNEXPECTED I-O STATUS FROM READ" TO RE-MARK
088800         MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
088900         PERFORM FAIL.
089000 SEQ-TEST-08-01-END.
089100*
089200*    CHECK EXECUTION OF THE AT END PATH
089300*
089400     ADD     1 TO REC-CT.
089500     IF DELETE-SW NOT = SPACE
089600         GO TO   SEQ-DELETE-08-02.
089700     GO TO   SEQ-TEST-RD-08-02.
089800 SEQ-DELETE-08-02.
089900     PERFORM DE-LETE.
090000     GO TO   SEQ-TEST-08-02-END.
090100 SEQ-TEST-RD-08-02.
090200     IF AT-END-SW = "NOT EXECUTED"
090300         PERFORM PASS
090400     ELSE
090500         MOVE    AT-END-SW TO COMPUTED-A
090600         MOVE   "NOT EXECUTED" TO CORRECT-A
090700         MOVE   "UNEXPECTED EXECUTION OF AT END PATH" TO RE-MARK
090800         MOVE   "VII-46, 4.4.4(11)" TO ANSI-REFERENCE
090900         PERFORM FAIL.
091000 SEQ-TEST-08-02-END.
091100*
091200*    CHECK EXECUTION OF THE NOT AT END PATH
091300*
091400     ADD     1 TO REC-CT.
091500     IF DELETE-SW NOT = SPACE
091600         GO TO   SEQ-DELETE-08-03.
091700     GO TO   SEQ-TEST-RD-08-03.
091800 SEQ-DELETE-08-03.
091900     PERFORM DE-LETE.
092000     GO TO   SEQ-TEST-08-03-END.
092100 SEQ-TEST-RD-08-03.
092200     IF NOT-END-SW = "EXECUTED"
092300         PERFORM PASS
092400     ELSE
092500         MOVE    NOT-END-SW TO COMPUTED-A
092600         MOVE   "EXECUTED" TO CORRECT-A
092700         MOVE   "UNEXPECTED NON-EXECUTION OF AT END PATH"
092800                   TO RE-MARK
092900         MOVE   "VII-46, 4.4.4(11)" TO ANSI-REFERENCE
093000         PERFORM FAIL.
093100 SEQ-TEST-08-03-END.
093200*
093300*    CHECK THE RECORD NUMBER OF THE RECORD JUST READ.
093400*
093500     ADD     1 TO REC-CT.
093600     IF DELETE-SW NOT = SPACE
093700         GO TO   SEQ-DELETE-08-04.
093800     GO TO   SEQ-TEST-RD-08-04.
093900 SEQ-DELETE-08-04.
094000     PERFORM DE-LETE.
094100     GO TO   SEQ-TEST-08-04-END.
094200 SEQ-TEST-RD-08-04.
094300     IF FRECORD-NUMBER = XRECORD-NUMBER (1)
094400         PERFORM PASS
094500     ELSE
094600         MOVE    FRECORD-NUMBER TO COMPUTED-A
094700         MOVE    XRECORD-NUMBER (1) TO CORRECT-A
094800         MOVE   "INCORRECT RECORD NUMBER FOUND" TO RE-MARK
094900         PERFORM FAIL.
095000 SEQ-TEST-08-04-END.
095100     MOVE    SPACE TO DELETE-SW-3.
095200*
095300*
095400*    WE NOW READ THE SECOND AND FINAL RECORD.
095500*    DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS
095600*    BUT DOES NOT AFFECT SUBSEQUENT OPERATIONS.
095700*
095800 SEQ-INIT-09.
095900     MOVE    0 TO REC-CT.
096000     MOVE   "**" TO SQ-FS4-STATUS.
096100     MOVE   "NOT EXECUTED" TO AT-END-SW.
096200     MOVE   "NOT EXECUTED" TO NOT-END-SW.
096300     ADD     1 TO XRECORD-NUMBER (1).
096400     MOVE   "READ SECOND RECORD" TO FEATURE.
096500     MOVE   "SEQ-TEST-RD-09" TO PAR-NAME.
096600     IF DELETE-SW NOT EQUAL TO SPACE
096700         GO TO SEQ-DELETE-09.
096800     GO TO   SEQ-TEST-RD-09.
096900 SEQ-DELETE-09.
097000     MOVE   "*" TO DELETE-SW-3.
097100     GO TO   SEQ-DELETE-09-01.
097200 SEQ-TEST-RD-09.
097300     MOVE    SPACE TO SQ-FS4R1-F-G-120.
097400     READ    SQ-FS4
097500     END
097600          MOVE   "EXECUTED" TO AT-END-SW
097700     NOT AT END
097800          MOVE   "EXECUTED" TO NOT-END-SW.
097900*
098000*    CHECK I-O STATUS RETURNED FROM READ
098100*
098200     ADD    1 TO REC-CT.
098300     IF DELETE-SW NOT = SPACE
098400         GO TO   SEQ-DELETE-09-01.
098500     GO TO   SEQ-TEST-RD-09-01.
098600 SEQ-DELETE-09-01.
098700     PERFORM DE-LETE.
098800     GO TO   SEQ-TEST-09-01-END.
098900 SEQ-TEST-RD-09-01.
099000     IF SQ-FS4-STATUS = "00"
099100         PERFORM PASS
099200     ELSE
099300         MOVE    SQ-FS4-STATUS TO COMPUTED-A
099400         MOVE   "00" TO CORRECT-A
099500         MOVE   "UNEXPECTED I-O STATUS FROM READ" TO RE-MARK
099600         MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
099700         PERFORM FAIL.
099800 SEQ-TEST-09-01-END.
099900*
100000*    CHECK EXECUTION OF THE AT END PATH
100100*
100200     ADD     1 TO REC-CT.
100300     IF DELETE-SW NOT = SPACE
100400         GO TO   SEQ-DELETE-09-02.
100500     GO TO   SEQ-TEST-RD-09-02.
100600 SEQ-DELETE-09-02.
100700     PERFORM DE-LETE.
100800     GO TO   SEQ-TEST-09-02-END.
100900 SEQ-TEST-RD-09-02.
101000     IF AT-END-SW = "NOT EXECUTED"
101100         PERFORM PASS
101200     ELSE
101300         MOVE    AT-END-SW TO COMPUTED-A
101400         MOVE   "NOT EXECUTED" TO CORRECT-A
101500         MOVE   "UNEXPECTED EXECUTION OF AT END PATH" TO RE-MARK
101600         MOVE   "VII-46, 4.4.4(11)" TO ANSI-REFERENCE
101700         PERFORM FAIL.
101800 SEQ-TEST-09-02-END.
101900*
102000*    CHECK EXECUTION OF THE NOT AT END PATH
102100*
102200     ADD     1 TO REC-CT.
102300     IF DELETE-SW NOT = SPACE
102400         GO TO   SEQ-DELETE-09-03.
102500     GO TO   SEQ-TEST-RD-09-03.
102600 SEQ-DELETE-09-03.
102700     PERFORM DE-LETE.
102800     GO TO   SEQ-TEST-09-03-END.
102900 SEQ-TEST-RD-09-03.
103000     IF NOT-END-SW = "EXECUTED"
103100         PERFORM PASS
103200     ELSE
103300         MOVE    NOT-END-SW TO COMPUTED-A
103400         MOVE   "EXECUTED" TO CORRECT-A
103500         MOVE   "UNEXPECTED NON-EXECUTION OF AT END PATH"
103600                   TO RE-MARK
103700         MOVE   "VII-46, 4.4.4(11)" TO ANSI-REFERENCE
103800         PERFORM FAIL.
103900 SEQ-TEST-09-03-END.
104000*
104100*    CHECK THE RECORD NUMBER OF THE RECORD JUST READ.
104200*
104300     ADD     1 TO REC-CT.
104400     IF DELETE-SW NOT = SPACE
104500         GO TO   SEQ-DELETE-09-04.
104600     GO TO   SEQ-TEST-RD-09-04.
104700 SEQ-DELETE-09-04.
104800     PERFORM DE-LETE.
104900     GO TO   SEQ-TEST-09-04-END.
105000 SEQ-TEST-RD-09-04.
105100     IF FRECORD-NUMBER = XRECORD-NUMBER (1)
105200         PERFORM PASS
105300     ELSE
105400         MOVE    FRECORD-NUMBER TO COMPUTED-A
105500         MOVE    XRECORD-NUMBER (1) TO CORRECT-A
105600         MOVE   "INCORRECT RECORD NUMBER FOUND" TO RE-MARK
105700         PERFORM FAIL.
105800 SEQ-TEST-09-04-END.
105900     MOVE    SPACE TO DELETE-SW-3.
106000*
106100*
106200*    WE NOW ATTEMPT ANOTHER READ, WHICH SHOULD RAISE AT END.
106300*    DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS
106400*    BUT DOES NOT AFFECT SUBSEQUENT OPERATIONS.
106500*
106600 SEQ-INIT-10.
106700     MOVE    0 TO REC-CT.
106800     MOVE   "**" TO SQ-FS4-STATUS.
106900     MOVE   "NOT EXECUTED" TO AT-END-SW.
107000     MOVE   "NOT EXECUTED" TO NOT-END-SW.
107100     ADD     1 TO XRECORD-NUMBER (1).
107200     MOVE   "READ TO GIVE AT END" TO FEATURE.
107300     MOVE   "SEQ-TEST-RD-10" TO PAR-NAME.
107400     IF DELETE-SW NOT EQUAL TO SPACE
107500         GO TO SEQ-DELETE-10.
107600     GO TO   SEQ-TEST-RD-10.
107700 SEQ-DELETE-10.
107800     MOVE   "*" TO DELETE-SW-3.
107900     GO TO   SEQ-DELETE-10-01.
108000 SEQ-TEST-RD-10.
108100     MOVE    SPACE TO SQ-FS4R1-F-G-120.
108200     READ    SQ-FS4
108300     END
108400          MOVE   "EXECUTED" TO AT-END-SW
108500     NOT AT END
108600          MOVE   "EXECUTED" TO NOT-END-SW.
108700*
108800*    CHECK I-O STATUS RETURNED FROM READ
108900*
109000     ADD    1 TO REC-CT.
109100     IF DELETE-SW NOT = SPACE
109200         GO TO   SEQ-DELETE-10-01.
109300     GO TO   SEQ-TEST-RD-10-01.
109400 SEQ-DELETE-10-01.
109500     PERFORM DE-LETE.
109600     GO TO   SEQ-TEST-10-01-END.
109700 SEQ-TEST-RD-10-01.
109800     IF SQ-FS4-STATUS = "10"
109900         PERFORM PASS
110000     ELSE
110100         MOVE    SQ-FS4-STATUS TO COMPUTED-A
110200         MOVE   "10" TO CORRECT-A
110300         MOVE   "UNEXPECTED I-O STATUS AFTER LAST RECORD"
110400                    TO RE-MARK
110500         MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
110600         PERFORM FAIL.
110700 SEQ-TEST-10-01-END.
110800*
110900*    CHECK EXECUTION OF THE AT END PATH
111000*
111100     ADD     1 TO REC-CT.
111200     IF DELETE-SW NOT = SPACE
111300         GO TO   SEQ-DELETE-10-02.
111400     GO TO   SEQ-TEST-RD-10-02.
111500 SEQ-DELETE-10-02.
111600     PERFORM DE-LETE.
111700     GO TO   SEQ-TEST-10-02-END.
111800 SEQ-TEST-RD-10-02.
111900     IF AT-END-SW = "EXECUTED"
112000         PERFORM PASS
112100     ELSE
112200         MOVE    AT-END-SW TO COMPUTED-A
112300         MOVE   "EXECUTED" TO CORRECT-A
112400         MOVE   "UNEXPECTED NON-EXECUTION OF AT END PATH"
112500                    TO RE-MARK
112600         MOVE   "VII-46, 4.4.4(10)" TO ANSI-REFERENCE
112700         PERFORM FAIL.
112800 SEQ-TEST-10-02-END.
112900*
113000*    CHECK EXECUTION OF THE NOT AT END PATH
113100*
113200     ADD     1 TO REC-CT.
113300     IF DELETE-SW NOT = SPACE
113400         GO TO   SEQ-DELETE-10-03.
113500     GO TO   SEQ-TEST-RD-10-03.
113600 SEQ-DELETE-10-03.
113700     PERFORM DE-LETE.
113800     GO TO   SEQ-TEST-10-03-END.
113900 SEQ-TEST-RD-10-03.
114000     IF NOT-END-SW = "NOT EXECUTED"
114100         PERFORM PASS
114200     ELSE
114300         MOVE    NOT-END-SW TO COMPUTED-A
114400         MOVE   "NOT EXECUTED" TO CORRECT-A
114500         MOVE   "UNEXPECTED EXECUTION OF AT END PATH" TO RE-MARK
114600         MOVE   "VII-46, 4.4.4(10)" TO ANSI-REFERENCE
114700         PERFORM FAIL.
114800 SEQ-TEST-10-03-END.
114900     MOVE    SPACE TO DELETE-SW-3.
115000*
115100*
115200*    NOW EXECUTE A NORMAL CLOSE ON THE FILE.
115300*    DELETION OF THE OPERATION DELETES ITS SUBORDINATE TESTS.
115400*
115500 SEQ-INIT-11.
115600     MOVE    0 TO REC-CT.
115700     MOVE   "**" TO SQ-FS4-STATUS.
115800     MOVE   "CLOSE AFTER READING" TO FEATURE.
115900     MOVE   "SEQ-TEST-CL-11" TO PAR-NAME.
116000     IF DELETE-SW NOT EQUAL TO SPACE
116100         GO TO SEQ-DELETE-11.
116200     GO TO   SEQ-TEST-CL-11.
116300 SEQ-DELETE-11.
116400     MOVE   "*" TO DELETE-SW-3.
116500     GO TO   SEQ-DELETE-11-01.
116600 SEQ-TEST-CL-11.
116700     CLOSE   SQ-FS4.
116800*
116900*    CHECK I-O STATUS RETURNED FROM CLOSE
117000*
117100     ADD    1 TO REC-CT.
117200     IF DELETE-SW NOT = SPACE
117300         GO TO   SEQ-DELETE-11-01.
117400     GO TO   SEQ-TEST-CL-11-01.
117500 SEQ-DELETE-11-01.
117600     PERFORM DE-LETE.
117700     GO TO   SEQ-TEST-11-01-END.
117800 SEQ-TEST-CL-11-01.
117900     IF SQ-FS4-STATUS = "00"
118000         PERFORM PASS
118100     ELSE
118200         MOVE    SQ-FS4-STATUS TO COMPUTED-A
118300         MOVE   "00" TO CORRECT-A
118400         MOVE   "UNEXPECTED ERROR CODE FROM CLOSE"
118500                   TO RE-MARK
118600         MOVE   "VII-3, VII-38,4.2.4(4)" TO ANSI-REFERENCE
118700         PERFORM FAIL.
118800 SEQ-TEST-11-01-END.
118900*
119000 CCVS-EXIT SECTION.
119100 CCVS-999999.
119200     GO TO   CLOSE-FILES.
