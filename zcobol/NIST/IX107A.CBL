000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IX107A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*
001400*       THIS ROUTINE TESTS THE FOLLOWING COBOL ELEMENTS FOR PROPER
001500*    SYNTAX WHEN USING AN INDEXED SEQUENTIAL I-O FILE.
001600*
001700*             SAME AREA FILE-NAME-1 FILE-NAME-2
001800*             READ .... RECORD AT END ....
001900*             READ .... RECORD END ...
002000*             READ .... AT END ....
002100*             READ .... END ....
002200*             READ .... RECORD INVALID KEY ...
002300*             READ .... INVALID KEY ...
002400*             READ .... RECORD INVALID ...
002500*             READ .... INVALID ...
002600*
002700*       THERE ARE TWO FILES USED IN THIS ROUTINE. FOLLOWING
002800*    CREATION OF EACH FILE THE ROUTINE READS AND VERIFIES THE FILE
002900*    BEFORE ANY OF THE ABOVE TESTS ARE MADE.  ONE FILE SPECIFIES
003000*    AN ACCESS MODE AS RANDOM AND THE OTHER FILE SPECIFIES AN
003100*    ACCESS MODE AS SEQUENTIAL.  THE FILES REFERENCED IN THE SAME
003200*    CLAUSE NEED NOT HAVE THE SAME ACCESS MODE.
003300*
003400*        REFERENCES: SECTION IX-15, SEE VII-19 2.13.3 (4) SAME
003500*                    AREA
003600*
003700*       X-CARDS  WHICH MUST BE REPLACED FOR THIS PROGRAM ARE
003800*
003900*             X-24   INDEXED FILE IMPLEMENTOR-NAME IN ASSGN TO
004000*                    CLAUSE FOR DATA FILE IX-FS1
004100*             X-25   INDEXED FILE IMPLEMENTOR-NAME IN ASSIGN TO
004200*                    CLAUSE FOR DATA FILE IX-FD2
004300*             X-44   INDEXED FILE IMPLEMENTOR-NAME IN ASSGN TO
004400*                    CLAUSE FOR INDEX FILE IX-FS1
004500*             X-45   INDEXED FILE IMPLEMENTOR-NAME IN ASSIGN TO
004600*                    CLAUSE FOR INDEX FILE IX-FD2
004700*             X-55   IMPLEMENTOR-NAME FOR SYSTEM PRINTER
004800*             X-62   FOR RAW-DATA
004900*             X-82   IMPLEMENTOR-NAME FOR SOURCE-COMPUTER
005000*             X-83   IMPLEMENTOR-NAME FOR OBJECT-COMPUTER
005100*             X-84   PRINTER-FILE LABELS (OPTIONAL)  C
005200*
005300*        NOTE:  X-CARDS 44,45, 62 AND 84      ARE OPTIONAL
005400*               AND NEED ONLY TO BE PRESENT IF THE COMPILER RE-
005500*               QUIRES THIS CODE BE AVAILABLE FOR PROPER PROGRAM
005600*               COMPILATION AND EXECUTION. IF THE VP-ROUTINE IS
005700*               USED THE  X-CARDS MAY BE AUTOMATICALLY SELECTED
005800*               FOR INCLUSION IN THE PROGRAM BY SPECIFYING THE
005900*               APPROPRIATE LETTER IN THE "*OPT" VP-ROUTINE
006000*               CONTROL CARD. THE LETTER  CORRESPONDS TO A
006100*               CHARACTER IN POSITION 7 OF THE SOURCE LINE AND
006200*               THEY ARE AS FOLLOWS
006300*
006400*                  C  SELECTS OBSOLETE FEATURES (E.G. LABEL ..)
006500*                  J  SELECTS X-CARDS 44 AND 45
006600*
006700*        NOTE:  THERE IS OPTIONAL SOURCE CODE IN THIS PROGRAM
006800*               FOR THE CONVENIENCE OF THE USER.  THIS OPTIONAL
006900*               CODE IS IDENTIFIED BY THE LETTER T   OR U IN
007000*               POSITION 7  OF THE SOURCE LINE. FOR CODE
007100*               WITH LETTERS T OR U ONLY ONE SHOULD BE SELECTED.
007200*               EITHER THE T"S OR THE U"S SHOULD BE USED EXCLU-
007300*               SIVELY, NOT BOTH.  THE T"S PROVIDE A 29 CHARACTER
007400*               INDEXED KEY SIZE FOR THE FILE AND THE U"S PROVIDE
007500*               AN INDEXED KEY NOT GREATER THAN 8 CHARACTERS.
007600*               IF THE VP-ROUTINE IS USED THE APPROPRIATE
007700*               SOURCE CODE MAY BE SELECTED BY SPECIFYING THE
007800*               RESPECTIVE LETTER IN THE "*OPT" VP-ROUTINE CONTROL
007900*               CARD.
008000*
008100******************************************************
008200 ENVIRONMENT DIVISION.
008300 CONFIGURATION SECTION.
008400 SOURCE-COMPUTER.
008500     XXXXX082.
008600 OBJECT-COMPUTER.
008700     XXXXX083.
008800 INPUT-OUTPUT SECTION.
008900 FILE-CONTROL.
009000P    SELECT RAW-DATA   ASSIGN TO
009100P    XXXXX062
009200P           ORGANIZATION IS INDEXED
009300P           ACCESS MODE IS RANDOM
009400P           RECORD KEY IS RAW-DATA-KEY.
009500     SELECT PRINT-FILE ASSIGN TO
009600     XXXXX055.
009700     SELECT IX-FS1 ASSIGN TO
009800     XXXXX024
009900J    XXXXX044
010000     RECORD  KEY IS IX-FS1-KEY
010100     ORGANIZATION IS INDEXED
010200     ACCESS MODE IS SEQUENTIAL.
010300     SELECT IX-FD2 ASSIGN TO
010400     XXXXX025
010500J    XXXXX045
010600     RECORD KEY IS IX-FD2-KEY
010700     ORGANIZATION IS INDEXED
010800     ACCESS MODE IS RANDOM.
010900 I-O-CONTROL.
011000     SAME AREA IX-FS1 IX-FD2.
011100 DATA DIVISION.
011200 FILE SECTION.
011300P
011400PFD  RAW-DATA.
011500P
011600P01  RAW-DATA-SATZ.
011700P    05  RAW-DATA-KEY        PIC X(6).
011800P    05  C-DATE              PIC 9(6).
011900P    05  C-TIME              PIC 9(8).
012000P    05  C-NO-OF-TESTS       PIC 99.
012100P    05  C-OK                PIC 999.
012200P    05  C-ALL               PIC 999.
012300P    05  C-FAIL              PIC 999.
012400P    05  C-DELETED           PIC 999.
012500P    05  C-INSPECT           PIC 999.
012600P    05  C-NOTE              PIC X(13).
012700P    05  C-INDENT            PIC X.
012800P    05  C-ABORT             PIC X(8).
012900 FD  PRINT-FILE.
013000 01  PRINT-REC PICTURE X(120).
013100 01  DUMMY-RECORD PICTURE X(120).
013200 FD   IX-FS1
013300C    LABEL RECORD IS STANDARD
013400C    DATA RECORD IS IX-FS1R1-F-G-240
013500     BLOCK  CONTAINS 1 RECORDS
013600     RECORD CONTAINS 240 CHARACTERS.
013700 01  IX-FS1R1-F-G-240.
013800     03 IX-FS1-REC-120   PIC X(120).
013900     03 IX-FS1-REC-121-240.
014000     05 FILLER           PIC X(8).
014100     05 IX-FS1-KEY.
014200         10 IX-FS1-KEYNUM  PIC 9(5).
014300T        10 FILLER         PIC X(24).
014400U    05 FILLER             PIC X(24).
014500     05 FILLER           PIC X(83).
014600 FD  IX-FD2
014700C    LABEL RECORD IS STANDARD
014800C    DATA RECORD IS IX-FD2R1-F-G-240
014900     BLOCK  CONTAINS 5 RECORDS
015000     RECORD CONTAINS 240 CHARACTERS.
015100 01  IX-FD2R1-F-G-240.
015200     03 IX-FD2-REC-120   PIC X(120).
015300     03 IX-FD2-REC-121-240.
015400     05 FILLER           PIC X(8).
015500     05 IX-FD2-KEY.
015600         10 IX-FD2-KEYNUM  PIC 9(5).
015700T        10 FILLER         PIC X(24).
015800U    05 FILLER             PIC X(24).
015900     05 FILLER           PIC X(83).
016000 WORKING-STORAGE SECTION.
016100 01  WRK-FS1-RECKEY.
016200     03 WRK-DU-05V00-001 PIC 9(5)   VALUE ZERO.
016300T    03 WRK-XN-24V00-001 PIC X(24)  VALUE
016400T        "123456789012345678901234".
016500 01  WRK-FD2-RECKEY.
016600     03 WRK-DU-05V00-002 PIC 9(5)   VALUE ZERO.
016700T    03 WRK-XN-24V00-002 PIC X(24)  VALUE
016800T        "123456789012345678901234".
016900 01  WRK-CS-09V00-001    PIC S9(9)  COMP VALUE ZERO.
017000 01  FS1-FILE-SIZE       PIC 9(6)   VALUE 750.
017100 01  FD2-FILE-SIZE       PIC 9(6)   VALUE 649.
017200 01  WRK-CS-09V00 PIC S9(9) USAGE COMP VALUE ZERO.
017300 01  RECORDS-IN-ERROR PIC S9(5) USAGE COMP VALUE ZERO.
017400 01  ERROR-FLAG PIC 9 VALUE ZERO.
017500 01  EOF-FLAG   PICTURE 9 VALUE ZERO.
017600 01  FILE-RECORD-INFORMATION-REC.
017700     03 FILE-RECORD-INFO-SKELETON.
017800        05 FILLER                 PICTURE X(48)       VALUE
017900             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
018000        05 FILLER                 PICTURE X(46)       VALUE
018100             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
018200        05 FILLER                 PICTURE X(26)       VALUE
018300             ",LFIL=000000,ORG=  ,LBLR= ".
018400        05 FILLER                 PICTURE X(37)       VALUE
018500             ",RECKEY=                             ".
018600        05 FILLER                 PICTURE X(38)       VALUE
018700             ",ALTKEY1=                             ".
018800        05 FILLER                 PICTURE X(38)       VALUE
018900             ",ALTKEY2=                             ".
019000        05 FILLER                 PICTURE X(7)        VALUE SPACE.
019100     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
019200        05 FILE-RECORD-INFO-P1-120.
019300           07 FILLER              PIC X(5).
019400           07 XFILE-NAME           PIC X(6).
019500           07 FILLER              PIC X(8).
019600           07 XRECORD-NAME         PIC X(6).
019700           07 FILLER              PIC X(1).
019800           07 REELUNIT-NUMBER     PIC 9(1).
019900           07 FILLER              PIC X(7).
020000           07 XRECORD-NUMBER       PIC 9(6).
020100           07 FILLER              PIC X(6).
020200           07 UPDATE-NUMBER       PIC 9(2).
020300           07 FILLER              PIC X(5).
020400           07 ODO-NUMBER          PIC 9(4).
020500           07 FILLER              PIC X(5).
020600           07 XPROGRAM-NAME        PIC X(5).
020700           07 FILLER              PIC X(7).
020800           07 XRECORD-LENGTH       PIC 9(6).
020900           07 FILLER              PIC X(7).
021000           07 CHARS-OR-RECORDS    PIC X(2).
021100           07 FILLER              PIC X(1).
021200           07 XBLOCK-SIZE          PIC 9(4).
021300           07 FILLER              PIC X(6).
021400           07 RECORDS-IN-FILE     PIC 9(6).
021500           07 FILLER              PIC X(5).
021600           07 XFILE-ORGANIZATION   PIC X(2).
021700           07 FILLER              PIC X(6).
021800           07 XLABEL-TYPE          PIC X(1).
021900        05 FILE-RECORD-INFO-P121-240.
022000           07 FILLER              PIC X(8).
022100           07 XRECORD-KEY          PIC X(29).
022200           07 FILLER              PIC X(9).
022300           07 ALTERNATE-KEY1      PIC X(29).
022400           07 FILLER              PIC X(9).
022500           07 ALTERNATE-KEY2      PIC X(29).
022600           07 FILLER              PIC X(7).
022700 01  TEST-RESULTS.
022800     02 FILLER                   PIC X      VALUE SPACE.
022900     02 FEATURE                  PIC X(20)  VALUE SPACE.
023000     02 FILLER                   PIC X      VALUE SPACE.
023100     02 P-OR-F                   PIC X(5)   VALUE SPACE.
023200     02 FILLER                   PIC X      VALUE SPACE.
023300     02  PAR-NAME.
023400       03 FILLER                 PIC X(19)  VALUE SPACE.
023500       03  PARDOT-X              PIC X      VALUE SPACE.
023600       03 DOTVALUE               PIC 99     VALUE ZERO.
023700     02 FILLER                   PIC X(8)   VALUE SPACE.
023800     02 RE-MARK                  PIC X(61).
023900 01  TEST-COMPUTED.
024000     02 FILLER                   PIC X(30)  VALUE SPACE.
024100     02 FILLER                   PIC X(17)  VALUE
024200            "       COMPUTED=".
024300     02 COMPUTED-X.
024400     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
024500     03 COMPUTED-N               REDEFINES COMPUTED-A
024600                                 PIC -9(9).9(9).
024700     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
024800     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
024900     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
025000     03       CM-18V0 REDEFINES COMPUTED-A.
025100         04 COMPUTED-18V0                    PIC -9(18).
025200         04 FILLER                           PIC X.
025300     03 FILLER PIC X(50) VALUE SPACE.
025400 01  TEST-CORRECT.
025500     02 FILLER PIC X(30) VALUE SPACE.
025600     02 FILLER PIC X(17) VALUE "       CORRECT =".
025700     02 CORRECT-X.
025800     03 CORRECT-A                  PIC X(20) VALUE SPACE.
025900     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
026000     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
026100     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
026200     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
026300     03      CR-18V0 REDEFINES CORRECT-A.
026400         04 CORRECT-18V0                     PIC -9(18).
026500         04 FILLER                           PIC X.
026600     03 FILLER PIC X(2) VALUE SPACE.
026700     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
026800 01  CCVS-C-1.
026900     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
027000-    "SS  PARAGRAPH-NAME
027100-    "       REMARKS".
027200     02 FILLER                     PIC X(20)    VALUE SPACE.
027300 01  CCVS-C-2.
027400     02 FILLER                     PIC X        VALUE SPACE.
027500     02 FILLER                     PIC X(6)     VALUE "TESTED".
027600     02 FILLER                     PIC X(15)    VALUE SPACE.
027700     02 FILLER                     PIC X(4)     VALUE "FAIL".
027800     02 FILLER                     PIC X(94)    VALUE SPACE.
027900 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
028000 01  REC-CT                        PIC 99       VALUE ZERO.
028100 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
028200 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
028300 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
028400 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
028500 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
028600 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
028700 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
028800 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
028900 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
029000 01  CCVS-H-1.
029100     02  FILLER                    PIC X(39)    VALUE SPACES.
029200     02  FILLER                    PIC X(42)    VALUE
029300     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
029400     02  FILLER                    PIC X(39)    VALUE SPACES.
029500 01  CCVS-H-2A.
029600   02  FILLER                        PIC X(40)  VALUE SPACE.
029700   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
029800   02  FILLER                        PIC XXXX   VALUE
029900     "4.2 ".
030000   02  FILLER                        PIC X(28)  VALUE
030100            " COPY - NOT FOR DISTRIBUTION".
030200   02  FILLER                        PIC X(41)  VALUE SPACE.
030300
030400 01  CCVS-H-2B.
030500   02  FILLER                        PIC X(15)  VALUE
030600            "TEST RESULT OF ".
030700   02  TEST-ID                       PIC X(9).
030800   02  FILLER                        PIC X(4)   VALUE
030900            " IN ".
031000   02  FILLER                        PIC X(12)  VALUE
031100     " HIGH       ".
031200   02  FILLER                        PIC X(22)  VALUE
031300            " LEVEL VALIDATION FOR ".
031400   02  FILLER                        PIC X(58)  VALUE
031500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
031600 01  CCVS-H-3.
031700     02  FILLER                      PIC X(34)  VALUE
031800            " FOR OFFICIAL USE ONLY    ".
031900     02  FILLER                      PIC X(58)  VALUE
032000     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
032100     02  FILLER                      PIC X(28)  VALUE
032200            "  COPYRIGHT   1985 ".
032300 01  CCVS-E-1.
032400     02 FILLER                       PIC X(52)  VALUE SPACE.
032500     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
032600     02 ID-AGAIN                     PIC X(9).
032700     02 FILLER                       PIC X(45)  VALUE SPACES.
032800 01  CCVS-E-2.
032900     02  FILLER                      PIC X(31)  VALUE SPACE.
033000     02  FILLER                      PIC X(21)  VALUE SPACE.
033100     02 CCVS-E-2-2.
033200         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
033300         03 FILLER                   PIC X      VALUE SPACE.
033400         03 ENDER-DESC               PIC X(44)  VALUE
033500            "ERRORS ENCOUNTERED".
033600 01  CCVS-E-3.
033700     02  FILLER                      PIC X(22)  VALUE
033800            " FOR OFFICIAL USE ONLY".
033900     02  FILLER                      PIC X(12)  VALUE SPACE.
034000     02  FILLER                      PIC X(58)  VALUE
034100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
034200     02  FILLER                      PIC X(13)  VALUE SPACE.
034300     02 FILLER                       PIC X(15)  VALUE
034400             " COPYRIGHT 1985".
034500 01  CCVS-E-4.
034600     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
034700     02 FILLER                       PIC X(4)   VALUE " OF ".
034800     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
034900     02 FILLER                       PIC X(40)  VALUE
035000      "  TESTS WERE EXECUTED SUCCESSFULLY".
035100 01  XXINFO.
035200     02 FILLER                       PIC X(19)  VALUE
035300            "*** INFORMATION ***".
035400     02 INFO-TEXT.
035500       04 FILLER                     PIC X(8)   VALUE SPACE.
035600       04 XXCOMPUTED                 PIC X(20).
035700       04 FILLER                     PIC X(5)   VALUE SPACE.
035800       04 XXCORRECT                  PIC X(20).
035900     02 INF-ANSI-REFERENCE           PIC X(48).
036000 01  HYPHEN-LINE.
036100     02 FILLER  PIC IS X VALUE IS SPACE.
036200     02 FILLER  PIC IS X(65)    VALUE IS "************************
036300-    "*****************************************".
036400     02 FILLER  PIC IS X(54)    VALUE IS "************************
036500-    "******************************".
036600 01  CCVS-PGM-ID                     PIC X(9)   VALUE
036700     "IX107A".
036800 PROCEDURE DIVISION.
036900 CCVS1 SECTION.
037000 OPEN-FILES.
037100P    OPEN I-O RAW-DATA.
037200P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
037300P    READ RAW-DATA INVALID KEY GO TO END-E-1.
037400P    MOVE "ABORTED " TO C-ABORT.
037500P    ADD 1 TO C-NO-OF-TESTS.
037600P    ACCEPT C-DATE  FROM DATE.
037700P    ACCEPT C-TIME  FROM TIME.
037800P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
037900PEND-E-1.
038000P    CLOSE RAW-DATA.
038100     OPEN    OUTPUT PRINT-FILE.
038200     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
038300     MOVE    SPACE TO TEST-RESULTS.
038400     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
038500     MOVE    ZERO TO REC-SKL-SUB.
038600     PERFORM CCVS-INIT-FILE 9 TIMES.
038700 CCVS-INIT-FILE.
038800     ADD     1 TO REC-SKL-SUB.
038900     MOVE    FILE-RECORD-INFO-SKELETON
039000          TO FILE-RECORD-INFO (REC-SKL-SUB).
039100 CCVS-INIT-EXIT.
039200     GO TO CCVS1-EXIT.
039300 CLOSE-FILES.
039400P    OPEN I-O RAW-DATA.
039500P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
039600P    READ RAW-DATA INVALID KEY GO TO END-E-2.
039700P    MOVE "OK.     " TO C-ABORT.
039800P    MOVE PASS-COUNTER TO C-OK.
039900P    MOVE ERROR-HOLD   TO C-ALL.
040000P    MOVE ERROR-COUNTER TO C-FAIL.
040100P    MOVE DELETE-COUNTER TO C-DELETED.
040200P    MOVE INSPECT-COUNTER TO C-INSPECT.
040300P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
040400PEND-E-2.
040500P    CLOSE RAW-DATA.
040600     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
040700 TERMINATE-CCVS.
040800S    EXIT PROGRAM.
040900STERMINATE-CALL.
041000     STOP     RUN.
041100 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
041200 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
041300 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
041400 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
041500     MOVE "****TEST DELETED****" TO RE-MARK.
041600 PRINT-DETAIL.
041700     IF REC-CT NOT EQUAL TO ZERO
041800             MOVE "." TO PARDOT-X
041900             MOVE REC-CT TO DOTVALUE.
042000     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
042100     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
042200        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
042300          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
042400     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
042500     MOVE SPACE TO CORRECT-X.
042600     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
042700     MOVE     SPACE TO RE-MARK.
042800 HEAD-ROUTINE.
042900     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043000     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043100     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
043200     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
043300 COLUMN-NAMES-ROUTINE.
043400     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
043500     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
043700 END-ROUTINE.
043800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
043900 END-RTN-EXIT.
044000     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044100 END-ROUTINE-1.
044200      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
044300      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
044400      ADD PASS-COUNTER TO ERROR-HOLD.
044500*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
044600      MOVE PASS-COUNTER TO CCVS-E-4-1.
044700      MOVE ERROR-HOLD TO CCVS-E-4-2.
044800      MOVE CCVS-E-4 TO CCVS-E-2-2.
044900      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
045000  END-ROUTINE-12.
045100      MOVE "TEST(S) FAILED" TO ENDER-DESC.
045200     IF       ERROR-COUNTER IS EQUAL TO ZERO
045300         MOVE "NO " TO ERROR-TOTAL
045400         ELSE
045500         MOVE ERROR-COUNTER TO ERROR-TOTAL.
045600     MOVE     CCVS-E-2 TO DUMMY-RECORD.
045700     PERFORM WRITE-LINE.
045800 END-ROUTINE-13.
045900     IF DELETE-COUNTER IS EQUAL TO ZERO
046000         MOVE "NO " TO ERROR-TOTAL  ELSE
046100         MOVE DELETE-COUNTER TO ERROR-TOTAL.
046200     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
046300     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
046400      IF   INSPECT-COUNTER EQUAL TO ZERO
046500          MOVE "NO " TO ERROR-TOTAL
046600      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
046700      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
046800      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
046900     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
047000 WRITE-LINE.
047100     ADD 1 TO RECORD-COUNT.
047200Y    IF RECORD-COUNT GREATER 42
047300Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
047400Y        MOVE SPACE TO DUMMY-RECORD
047500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
047600Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
047700Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
047800Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
047900Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
048000Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
048100Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
048200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
048300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
048400Y        MOVE ZERO TO RECORD-COUNT.
048500     PERFORM WRT-LN.
048600 WRT-LN.
048700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
048800     MOVE SPACE TO DUMMY-RECORD.
048900 BLANK-LINE-PRINT.
049000     PERFORM WRT-LN.
049100 FAIL-ROUTINE.
049200     IF     COMPUTED-X NOT EQUAL TO SPACE
049300            GO TO   FAIL-ROUTINE-WRITE.
049400     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
049500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
049600     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
049700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
049800     MOVE   SPACES TO INF-ANSI-REFERENCE.
049900     GO TO  FAIL-ROUTINE-EX.
050000 FAIL-ROUTINE-WRITE.
050100     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
050200     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
050300     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
050400     MOVE   SPACES TO COR-ANSI-REFERENCE.
050500 FAIL-ROUTINE-EX. EXIT.
050600 BAIL-OUT.
050700     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
050800     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
050900 BAIL-OUT-WRITE.
051000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
051100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
051200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
051300     MOVE   SPACES TO INF-ANSI-REFERENCE.
051400 BAIL-OUT-EX. EXIT.
051500 CCVS1-EXIT.
051600     EXIT.
051700 SECT-IX107A-001 SECTION.
051800 WRITE-INIT-GF-01.
051900     OPEN     OUTPUT  IX-FS1.
052000     MOVE     ZERO TO WRK-CS-09V00-001.
052100     MOVE     ZERO TO WRK-DU-05V00-001.
052200     MOVE     "IX-FS1"  TO XFILE-NAME (1).
052300     MOVE     "R1-F-G"  TO XRECORD-NAME (1).
052400     MOVE     00001   TO XRECORD-NUMBER (1).
052500     MOVE     CCVS-PGM-ID TO XPROGRAM-NAME (1).
052600     MOVE     750     TO RECORDS-IN-FILE (1).
052700     MOVE     240     TO XRECORD-LENGTH (1).
052800     MOVE     0001    TO XBLOCK-SIZE (1).
052900     MOVE     "RC"    TO  CHARS-OR-RECORDS (1).
053000     MOVE     "IX"    TO XFILE-ORGANIZATION (1).
053100     MOVE     "S"     TO XLABEL-TYPE (1).
053200     MOVE     "FILE CREATED"  TO RE-MARK.
053300     MOVE     "WRITE-TEST-GF-01" TO PAR-NAME.
053400     MOVE    "WRITE  SEQUENTIAL"  TO FEATURE.
053500     MOVE     ZERO    TO REC-CT.
053600 WRITE-TEST-GF-01-R.
053700     MOVE     XRECORD-NUMBER (1)  TO WRK-DU-05V00-001.
053800     MOVE     WRK-FS1-RECKEY TO XRECORD-KEY (1).
053900     MOVE     FILE-RECORD-INFO (1)  TO IX-FS1R1-F-G-240.
054000     WRITE    IX-FS1R1-F-G-240
054100                      INVALID KEY GO TO WRITE-TEST-GF-01-1.
054200     IF       XRECORD-NUMBER (1)  NOT LESS THAN FS1-FILE-SIZE
054300              GO TO WRITE-TEST-GF-01-1.
054400     ADD      0001  TO XRECORD-NUMBER (1).
054500     GO TO    WRITE-TEST-GF-01-R.
054600 WRITE-TEST-GF-01-1.
054700     MOVE     XRECORD-NUMBER (1)  TO COMPUTED-18V0.
054800     MOVE     FS1-FILE-SIZE TO CORRECT-18V0.
054900     IF       XRECORD-NUMBER (1) EQUAL TO FS1-FILE-SIZE
055000              PERFORM  PASS
055100          ELSE
055200              MOVE "IX-41 4.9.2        " TO RE-MARK
055300                   PERFORM FAIL.
055400     PERFORM  PRINT-DETAIL.
055500     CLOSE    IX-FS1.
055600 READ-INIT-F1-01.
055700     MOVE ZERO TO WRK-CS-09V00.
055800*        THIS TEST READS AND CHECKS THE FILE CREATED IN
055900*    READ-TEST-001.
056000     OPEN INPUT IX-FS1.
056100 READ-TEST-F1-01.
056200     READ IX-FS1
056300          AT END GO TO READ-TEST-F1-01-1.
056400     MOVE   IX-FS1R1-F-G-240 TO FILE-RECORD-INFO (1).
056500     ADD 1 TO WRK-CS-09V00.
056600     IF WRK-CS-09V00 GREATER THAN 750
056700        MOVE "MORE THAN 750 RECORDS" TO RE-MARK
056800        GO TO READ-FAIL-F1-01.
056900     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
057000         ADD 1 TO RECORDS-IN-ERROR
057100         GO TO READ-TEST-F1-01.
057200     IF XFILE-NAME (1) NOT EQUAL TO "IX-FS1"
057300        ADD 1 TO RECORDS-IN-ERROR
057400        GO TO READ-TEST-F1-01.
057500     IF XLABEL-TYPE (1) NOT EQUAL TO "S"
057600        ADD 1 TO RECORDS-IN-ERROR.
057700     GO TO READ-TEST-F1-01.
057800 READ-TEST-F1-01-1.
057900     IF RECORDS-IN-ERROR EQUAL TO ZERO
058000         GO TO READ-PASS-F1-01.
058100     MOVE "ERRORS IN READING IX-FS1" TO RE-MARK.
058200 READ-FAIL-F1-01.
058300     MOVE "RECORDS IN ERROR =" TO COMPUTED-A.
058400     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
058500     MOVE "IX-28 4.5.2                               " TO RE-MARK.
058600     PERFORM FAIL.
058700     GO TO READ-WRITE-F1-01.
058800 READ-PASS-F1-01.
058900     PERFORM PASS.
059000     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
059100     MOVE WRK-CS-09V00 TO CORRECT-18V0.
059200 READ-WRITE-F1-01.
059300     MOVE "READ-TEST-F1-01" TO PAR-NAME.
059400     MOVE "READ  TO VERIFY   " TO FEATURE.
059500     PERFORM PRINT-DETAIL.
059600 READ-CLOSE-F1-01.
059700     CLOSE IX-FS1.
059800 READ-INIT-F1-02.
059900     MOVE ZERO TO WRK-CS-09V00.
060000     MOVE ZERO TO RECORDS-IN-ERROR.
060100     OPEN INPUT   IX-FS1.
060200*            FOUR OPTIONS FOR THE READ STATEMENT ARE CHECKED
060300*    IN THIS SERIES OF TESTS.
060400     MOVE "READ...RECORD AT END ..." TO FEATURE.
060500     MOVE "READ-TEST-F1-02" TO PAR-NAME.
060600     MOVE ZERO TO ERROR-FLAG.
060700 READ-TEST-F1-02.
060800     READ IX-FS1 RECORD AT END
060900              MOVE "UNEXPECTED EOF" TO COMPUTED-A
061000              MOVE 1 TO EOF-FLAG
061100              GO TO READ-FAIL-F1-02.
061200     PERFORM RECORD-CHECK.
061300     IF WRK-CS-09V00 EQUAL TO 200
061400              GO TO READ-TEST-F1-02-1.
061500             GO TO READ-TEST-F1-02.
061600 RECORD-CHECK.
061700     MOVE IX-FS1R1-F-G-240 TO FILE-RECORD-INFO (1).
061800     ADD 1 TO WRK-CS-09V00.
061900     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
062000         ADD 1 TO RECORDS-IN-ERROR
062100         MOVE 1 TO ERROR-FLAG.
062200 READ-TEST-F1-02-1.
062300     IF ERROR-FLAG EQUAL TO ZERO
062400         GO TO READ-PASS-F1-02.
062500     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
062600 READ-FAIL-F1-02.
062700     MOVE "IX-28 4.5.2                               " TO RE-MARK.
062800     PERFORM FAIL.
062900     GO TO READ-WRITE-F1-02.
063000 READ-PASS-F1-02.
063100     PERFORM PASS.
063200 READ-WRITE-F1-02.
063300     PERFORM PRINT-DETAIL.
063400 READ-INIT-F1-03.
063500     IF EOF-FLAG EQUAL TO 1
063600        GO TO READ-EOF-F1-06.
063700     MOVE ZERO TO ERROR-FLAG.
063800     MOVE "READ...AT END..." TO FEATURE.
063900     MOVE "READ-TEST-F1-03" TO PAR-NAME.
064000 READ-TEST-F1-03.
064100     READ IX-FS1 AT END
064200         MOVE "UNEXPECTED EOF" TO COMPUTED-A
064300         MOVE 1 TO EOF-FLAG
064400         GO TO READ-FAIL-F1-03.
064500     PERFORM RECORD-CHECK.
064600     IF WRK-CS-09V00 EQUAL TO 400
064700         GO TO READ-TEST-F1-03-1.
064800     GO TO READ-TEST-F1-03.
064900 READ-TEST-F1-03-1.
065000     IF ERROR-FLAG EQUAL TO ZERO
065100         GO TO READ-PASS-F1-03.
065200     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
065300 READ-FAIL-F1-03.
065400     MOVE "IX-28 4.5.2                               " TO RE-MARK.
065500     PERFORM FAIL.
065600     GO TO READ-WRITE-F1-03.
065700 READ-PASS-F1-03.
065800     PERFORM PASS.
065900 READ-WRITE-F1-03.
066000     PERFORM PRINT-DETAIL.
066100 READ-INIT-F1-04.
066200     IF EOF-FLAG EQUAL TO 1
066300        GO TO READ-EOF-F1-06.
066400     MOVE ZERO TO ERROR-FLAG.
066500     MOVE "READ...RECORD END..." TO FEATURE.
066600     MOVE "READ-TEST-F1-04" TO PAR-NAME.
066700 READ-TEST-F1-04.
066800     READ IX-FS1 RECORD END
066900          MOVE "UNEXPECTED EOF" TO COMPUTED-A
067000          MOVE 1 TO EOF-FLAG
067100          GO TO READ-FAIL-F1-04.
067200     PERFORM RECORD-CHECK.
067300     IF WRK-CS-09V00 EQUAL TO 600
067400         GO TO READ-TEST-F1-04-1.
067500     GO TO READ-TEST-F1-04.
067600 READ-TEST-F1-04-1.
067700     IF ERROR-FLAG EQUAL TO ZERO
067800         GO TO READ-PASS-F1-04.
067900     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
068000 READ-FAIL-F1-04.
068100     MOVE "IX-28 4.5.2                               " TO RE-MARK.
068200     PERFORM FAIL.
068300     GO TO READ-WRITE-F1-04.
068400 READ-PASS-F1-04.
068500     PERFORM PASS.
068600 READ-WRITE-F1-04.
068700     PERFORM PRINT-DETAIL.
068800 READ-INIT-F1-05.
068900     IF EOF-FLAG EQUAL TO 1
069000         GO TO READ-EOF-F1-06.
069100     MOVE ZERO TO ERROR-FLAG.
069200     MOVE "READ...END..." TO RE-MARK.
069300     MOVE  "READ-TEST-F1-05" TO PAR-NAME.
069400 READ-TEST-F1-05.
069500     READ IX-FS1 END GO TO READ-TEST-F1-05-1.
069600     PERFORM RECORD-CHECK.
069700     IF WRK-CS-09V00 GREATER THAN 750
069800          GO TO READ-TEST-F1-05-1.
069900     GO TO READ-TEST-F1-05.
070000 READ-TEST-F1-05-1.
070100     IF ERROR-FLAG EQUAL TO ZERO
070200          GO TO READ-PASS-F1-05.
070300 READ-FAIL-F1-05.
070400     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
070500     MOVE "IX-28 4.5.2                               " TO RE-MARK.
070600     PERFORM FAIL.
070700     GO TO READ-WRITE-F1-05.
070800 READ-PASS-F1-05.
070900     PERFORM PASS.
071000 READ-WRITE-F1-05.
071100     PERFORM PRINT-DETAIL.
071200 READ-TEST-F1-06.
071300     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
071400          MOVE "RECORDS IN ERROR =" TO COMPUTED-A
071500          MOVE RECORDS-IN-ERROR TO CORRECT-18V0
071600          GO TO READ-FAIL-F1-06.
071700     IF WRK-CS-09V00 GREATER THAN 750
071800          MOVE "MORE THAN 750 RECORDS" TO RE-MARK
071900          GO TO READ-FAIL-F1-06.
072000 READ-PASS-F1-06.
072100     PERFORM PASS.
072200     GO TO READ-WRITE-F1-06.
072300 READ-EOF-F1-06.
072400     MOVE "LESS THAN 750 RECORDS" TO RE-MARK.
072500     MOVE "RECORDS READ =" TO COMPUTED-A.
072600     MOVE WRK-CS-09V00 TO CORRECT-18V0.
072700 READ-FAIL-F1-06.
072800     MOVE "IX-28 4.5.2                               " TO RE-MARK.
072900     PERFORM FAIL.
073000 READ-WRITE-F1-06.
073100     MOVE "READ-TEST-F1-06" TO PAR-NAME.
073200     MOVE "READ IX-FS1 750R" TO FEATURE.
073300     PERFORM PRINT-DETAIL.
073400 READ-CLOSE-F1-06.
073500     CLOSE IX-FS1.
073600 SECT-IX107A-002 SECTION.
073700 WRITE-INIT-GF-02.
073800     OPEN     OUTPUT  IX-FD2.
073900     MOVE     ZERO TO WRK-CS-09V00-001.
074000     MOVE     ZERO TO WRK-DU-05V00-002.
074100     MOVE     "IX-FD2"  TO XFILE-NAME (2).
074200     MOVE     "R1-F-G"  TO XRECORD-NAME (2).
074300     MOVE     00001   TO XRECORD-NUMBER (2).
074400     MOVE     CCVS-PGM-ID TO XPROGRAM-NAME (2).
074500     MOVE     649     TO RECORDS-IN-FILE (2).
074600     MOVE     240     TO XRECORD-LENGTH (2).
074700     MOVE     0005    TO XBLOCK-SIZE (2).
074800     MOVE     "RC"    TO  CHARS-OR-RECORDS (2).
074900     MOVE     "IX"    TO XFILE-ORGANIZATION (2).
075000     MOVE     "S"     TO XLABEL-TYPE (2).
075100     MOVE     "FILE CREATED"  TO RE-MARK.
075200     MOVE     "WRITE-TEST-GF-02" TO PAR-NAME.
075300     MOVE     "WRITE RANDOM MODE"  TO FEATURE.
075400     MOVE     ZERO    TO REC-CT.
075500 WRITE-TEST-GF-02-R.
075600     MOVE     XRECORD-NUMBER (2)  TO WRK-DU-05V00-002.
075700     MOVE     WRK-FD2-RECKEY TO XRECORD-KEY (2).
075800     MOVE     FILE-RECORD-INFO (2)  TO IX-FD2R1-F-G-240.
075900     WRITE    IX-FD2R1-F-G-240
076000                      INVALID KEY GO TO WRITE-TEST-GF-02-1.
076100     IF       XRECORD-NUMBER (2)  NOT LESS THAN FD2-FILE-SIZE
076200              GO TO WRITE-TEST-GF-02-1.
076300     ADD      0001  TO XRECORD-NUMBER (2).
076400     GO TO    WRITE-TEST-GF-02-R.
076500 WRITE-TEST-GF-02-1.
076600     MOVE     XRECORD-NUMBER (2)  TO COMPUTED-18V0.
076700     MOVE     FD2-FILE-SIZE TO CORRECT-18V0.
076800     IF       XRECORD-NUMBER (2) EQUAL TO FD2-FILE-SIZE
076900              PERFORM  PASS
077000              ELSE
077100              MOVE "IX-41 4.9.2                     " TO RE-MARK
077200                   PERFORM FAIL.
077300     PERFORM  PRINT-DETAIL.
077400     CLOSE    IX-FD2.
077500 READ-INIT-F2-07.
077600     MOVE   ZERO TO WRK-DU-05V00-002.
077700     MOVE ZERO TO WRK-CS-09V00.
077800     MOVE    ZERO TO RECORDS-IN-ERROR.
077900*        THIS TEST READS AND CHECKS THE FILE CREATED IN
078000*    READ-TEST-GF-02.
078100     OPEN INPUT IX-FD2.
078200 READ-TEST-F2-07.
078300     ADD    00001 TO WRK-DU-05V00-002.
078400     MOVE   WRK-FD2-RECKEY TO IX-FD2-KEY.
078500     READ IX-FD2 RECORD
078600         INVALID KEY GO TO READ-TEST-F2-07-1.
078700     MOVE IX-FD2R1-F-G-240 TO FILE-RECORD-INFO (2).
078800     ADD 1 TO WRK-CS-09V00.
078900     IF WRK-CS-09V00 GREATER THAN 649
079000         MOVE "MORE THAN 649 RECORDS" TO RE-MARK
079100         GO TO READ-FAIL-F2-07.
079200     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (2)
079300         ADD 1 TO RECORDS-IN-ERROR
079400         GO TO READ-TEST-F2-07.
079500     IF XFILE-NAME (2) NOT EQUAL TO "IX-FD2"
079600         ADD 1 TO RECORDS-IN-ERROR
079700         GO TO READ-TEST-F2-07.
079800     IF XLABEL-TYPE (2) NOT EQUAL TO "S"
079900     ADD 1 TO RECORDS-IN-ERROR.
080000     GO TO READ-TEST-F2-07.
080100 READ-TEST-F2-07-1.
080200     IF RECORDS-IN-ERROR EQUAL TO ZERO
080300          GO TO READ-PASS-F2-07.
080400     MOVE "ERRORS IN READING IX-FD2" TO RE-MARK.
080500 READ-FAIL-F2-07.
080600     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
080700     MOVE "IX-28 4.5.2                               " TO RE-MARK.
080800     PERFORM FAIL.
080900     GO TO READ-READ-F2-07.
081000 READ-PASS-F2-07.
081100     PERFORM PASS.
081200     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
081300     MOVE WRK-CS-09V00 TO CORRECT-18V0.
081400 READ-READ-F2-07.
081500     MOVE "READ-TEST-F2-07"  TO PAR-NAME.
081600     MOVE "VERIFY FILE IX-FD2" TO FEATURE.
081700     PERFORM PRINT-DETAIL.
081800 READ-CLOSE-F2-07.
081900     CLOSE IX-FD2.
082000 READ-INIT-F2-08.
082100     MOVE   ZERO TO WRK-DU-05V00-002.
082200     MOVE ZERO TO WRK-CS-09V00.
082300     MOVE ZERO TO RECORDS-IN-ERROR.
082400     OPEN INPUT IX-FD2.
082500*        FOUR OPTIONS FOR THE READ STATEMENT ARE CHECKED
082600*    IN THIS SERIES OF TESTS.
082700     MOVE "LEV 1 READ STATEMENT" TO FEATURE.
082800     MOVE     ZERO TO EOF-FLAG.
082900     MOVE "READ...RECORD INVALID KEY ..." TO FEATURE.
083000     MOVE "READ-TEST-F2-08" TO PAR-NAME.
083100     MOVE ZERO TO ERROR-FLAG.
083200 READ-TEST-F2-08.
083300     ADD    0001 TO WRK-DU-05V00-002.
083400     MOVE   WRK-FD2-RECKEY TO IX-FD2-KEY.
083500     READ IX-FD2 RECORD
083600          INVALID KEY MOVE "INVALID KEY" TO COMPUTED-A
083700          MOVE 1 TO EOF-FLAG
083800          GO TO READ-FAIL-F2-08.
083900     PERFORM RECORD-CHECK-1.
084000     IF WRK-CS-09V00 EQUAL TO 50
084100           GO TO READ-TEST-F2-08-1.
084200     GO TO READ-TEST-F2-08.
084300 RECORD-CHECK-1.
084400     MOVE IX-FD2R1-F-G-240 TO FILE-RECORD-INFO (2).
084500     ADD 1 TO WRK-CS-09V00.
084600     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (2)
084700         ADD 1 TO RECORDS-IN-ERROR
084800         MOVE 1 TO ERROR-FLAG.
084900 READ-TEST-F2-08-1.
085000     IF ERROR-FLAG EQUAL TO ZERO
085100         GO TO READ-PASS-F2-08.
085200     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
085300 READ-FAIL-F2-08.
085400     MOVE "IX-28 4.5.2                               " TO RE-MARK.
085500     PERFORM FAIL.
085600     GO TO READ-WRITE-F2-08.
085700 READ-PASS-F2-08.
085800     PERFORM PASS.
085900 READ-WRITE-F2-08.
086000     PERFORM PRINT-DETAIL.
086100 READ-INIT-F2-09.
086200     MOVE   ZERO TO WRK-DU-05V00-002.
086300     MOVE      ZERO TO WRK-CS-09V00.
086400     MOVE     ZERO TO RECORDS-IN-ERROR.
086500     IF EOF-FLAG EQUAL TO 1
086600         GO TO READ-EOF-F2-12.
086700     MOVE ZERO TO ERROR-FLAG.
086800     MOVE "READ...INVALID KEY..." TO FEATURE.
086900     MOVE "READ-TEST-F2-09" TO PAR-NAME.
087000 READ-TEST-F2-09.
087100     ADD    00001 TO WRK-DU-05V00-002.
087200     MOVE   WRK-FD2-RECKEY TO IX-FD2-KEY.
087300     READ IX-FD2  INVALID KEY
087400          MOVE "INVALID KEY" TO COMPUTED-A
087500          MOVE 1 TO EOF-FLAG
087600          GO TO READ-FAIL-F2-09.
087700     PERFORM RECORD-CHECK-1.
087800     IF WRK-CS-09V00 EQUAL TO 200
087900         GO TO READ-TEST-F2-09-1.
088000     GO TO READ-TEST-F2-09.
088100 READ-TEST-F2-09-1.
088200     IF ERROR-FLAG EQUAL TO ZERO
088300          GO TO READ-PASS-F2-09.
088400     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
088500 READ-FAIL-F2-09.
088600     MOVE "IX-28 4.5.2                               " TO RE-MARK.
088700     PERFORM FAIL.
088800     GO TO READ-WRITE-F2-09.
088900 READ-PASS-F2-09.
089000     PERFORM PASS.
089100 READ-WRITE-F2-09.
089200     PERFORM PRINT-DETAIL.
089300 READ-INIT-F2-10.
089400     MOVE   ZERO TO WRK-DU-05V00-002.
089500     MOVE      ZERO TO WRK-CS-09V00.
089600     MOVE     ZERO TO RECORDS-IN-ERROR.
089700     IF EOF-FLAG EQUAL TO 1
089800         GO TO READ-EOF-F2-12.
089900     MOVE ZERO TO ERROR-FLAG.
090000     MOVE "READ...RECORD INVALID..." TO FEATURE.
090100     MOVE "READ-TEST-F2-10" TO PAR-NAME.
090200 READ-TEST-F2-10.
090300     ADD    0001 TO WRK-DU-05V00-002.
090400     MOVE   WRK-FD2-RECKEY TO IX-FD2-KEY.
090500     READ IX-FD2 RECORD INVALID
090600          MOVE "INVALID KEY" TO COMPUTED-A
090700          MOVE 1 TO EOF-FLAG
090800          GO TO READ-FAIL-F2-10.
090900     PERFORM RECORD-CHECK-1.
091000     IF WRK-CS-09V00 EQUAL TO 499
091100          GO TO READ-TEST-F2-10-1.
091200     GO TO READ-TEST-F2-10.
091300 READ-TEST-F2-10-1.
091400     IF ERROR-FLAG EQUAL TO ZERO
091500           GO TO READ-PASS-F2-10.
091600     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
091700 READ-FAIL-F2-10.
091800     MOVE "IX-28 4.5.2                               " TO RE-MARK.
091900     PERFORM FAIL.
092000     GO TO READ-WRITE-F2-10.
092100 READ-PASS-F2-10.
092200     PERFORM PASS.
092300 READ-WRITE-F2-10.
092400     PERFORM PRINT-DETAIL.
092500 READ-INIT-F2-11.
092600     MOVE   ZERO TO WRK-DU-05V00-002.
092700     MOVE      ZERO TO WRK-CS-09V00.
092800     MOVE     ZERO TO RECORDS-IN-ERROR.
092900     IF EOF-FLAG EQUAL TO 1
093000         GO TO READ-EOF-F2-12.
093100     MOVE ZERO TO ERROR-FLAG.
093200     MOVE "READ...INVALID..." TO FEATURE.
093300     MOVE "READ-TEST-F2-11" TO PAR-NAME.
093400 READ-TEST-F2-11.
093500     ADD    0001 TO WRK-DU-05V00-002.
093600     MOVE   WRK-FD2-RECKEY TO  IX-FD2-KEY.
093700     READ IX-FD2 INVALID
093800          GO TO READ-TEST-F2-11-1.
093900     PERFORM RECORD-CHECK-1.
094000     IF WRK-CS-09V00 GREATER THAN 649
094100          GO TO READ-TEST-F2-11-1.
094200     GO TO READ-TEST-F2-11.
094300 READ-TEST-F2-11-1.
094400     IF ERROR-FLAG EQUAL TO ZERO
094500         GO TO READ-PASS-F2-11.
094600 READ-FAIL-F2-11.
094700     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
094800     MOVE "IX-28 4.5.2                               " TO RE-MARK.
094900     PERFORM FAIL.
095000     GO TO READ-WRITE-F2-11.
095100 READ-PASS-F2-11.
095200     PERFORM PASS.
095300 READ-WRITE-F2-11.
095400     PERFORM PRINT-DETAIL.
095500 READ-TEST-F2-12.
095600     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
095700          MOVE "RECORDS IN ERROR =" TO COMPUTED-A
095800          MOVE RECORDS-IN-ERROR TO CORRECT-18V0
095900          GO TO READ-FAIL-F2-12.
096000     IF WRK-CS-09V00 GREATER THAN 649
096100          MOVE "MORE THAN 649 RECORDS" TO RE-MARK
096200          GO TO READ-FAIL-F2-12.
096300 READ-PASS-F2-12.
096400     PERFORM PASS
096500     GO TO READ-WRITE-F2-12.
096600 READ-EOF-F2-12.
096700     MOVE "LESS THAN 649 RECORDS" TO RE-MARK.
096800     MOVE "RECORDS READ =" TO COMPUTED-A.
096900     MOVE WRK-CS-09V00 TO CORRECT-18V0.
097000 READ-FAIL-F2-12.
097100     PERFORM FAIL.
097200 READ-WRITE-F2-12.
097300     MOVE "READ-TEST-F2-12" TO PAR-NAME.
097400     MOVE "READ IX-FS2 VERIFY" TO FEATURE.
097500     PERFORM PRINT-DETAIL.
097600 READ-CLOSE-F2-12.
097700     CLOSE IX-FD2.
097800 TERMINATE-ROUTINE.
097900     EXIT.
098000 CCVS-EXIT SECTION.
098100 CCVS-999999.
098200     GO TO CLOSE-FILES.
