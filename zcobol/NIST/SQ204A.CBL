000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ204A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    " HIGH       ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "4.2 ".
001100*                                                              *
001200*        THIS ROUTINE       TESTS THE USE OF THE OPEN EXTEND
001300*    STATEMENT FOR BOTH MAGNETIC TAPE AND MASS STORAGE.  FILES
001400*    ARE FIRST CREATED USING THE NORMAL OPEN OUTPUT STATEMENT
001500*
001600 ENVIRONMENT DIVISION.
001700 CONFIGURATION SECTION.
001800 SOURCE-COMPUTER.
001900     XXXXX082.
002000 OBJECT-COMPUTER.
002100     XXXXX083.
002200 INPUT-OUTPUT SECTION.
002300 FILE-CONTROL.
002400P    SELECT RAW-DATA   ASSIGN TO
002500P    XXXXX062
002600P           ORGANIZATION IS INDEXED
002700P           ACCESS MODE IS RANDOM
002800P           RECORD KEY IS RAW-DATA-KEY.
002900     SELECT PRINT-FILE ASSIGN TO
003000     XXXXX055.
003100     SELECT SQ-FS1 ASSIGN TO
003200     XXXXX001
003300     ORGANIZATION IS SEQUENTIAL
003400     ACCESS MODE IS SEQUENTIAL.
003500     SELECT SQ-FS2 ASSIGN TO
003600     XXXXX014
003700     ORGANIZATION IS SEQUENTIAL
003800     ACCESS MODE IS SEQUENTIAL.
003900 DATA DIVISION.
004000 FILE SECTION.
004100P
004200PFD  RAW-DATA.
004300P
004400P01  RAW-DATA-SATZ.
004500P    05  RAW-DATA-KEY        PIC X(6).
004600P    05  C-DATE              PIC 9(6).
004700P    05  C-TIME              PIC 9(8).
004800P    05  C-NO-OF-TESTS       PIC 99.
004900P    05  C-OK                PIC 999.
005000P    05  C-ALL               PIC 999.
005100P    05  C-FAIL              PIC 999.
005200P    05  C-DELETED           PIC 999.
005300P    05  C-INSPECT           PIC 999.
005400P    05  C-NOTE              PIC X(13).
005500P    05  C-INDENT            PIC X.
005600P    05  C-ABORT             PIC X(8).
005700 FD  PRINT-FILE
005800C    LABEL RECORDS
005900C    XXXXX084
006000C    DATA RECORD IS PRINT-REC DUMMY-RECORD
006100               .
006200 01  PRINT-REC PICTURE X(120).
006300 01  DUMMY-RECORD PICTURE X(120).
006400 FD  SQ-FS1
006500C    LABEL RECORDS ARE STANDARD
006600     BLOCK CONTAINS 126 CHARACTERS.
006700 01  SQ-FS1R1-F-G-126.
006800     02 SQ-FS1R1-F-G-120 PIC X(120).
006900     02 SQ-FS1R1-F-G-006 PIC X(6).
007000 FD  SQ-FS2
007100C    LABEL RECORDS ARE STANDARD
007200     BLOCK CONTAINS 126 CHARACTERS.
007300 01  SQ-FS2R1-F-G-126.
007400     02 SQ-FS2R1-F-G-120 PIC X(120).
007500     02 SQ-FS2R1-F-G-006 PIC X(6).
007600 WORKING-STORAGE SECTION.
007700 77  RECORDS-IN-ERROR   PIC  9(4) VALUE 0.
007800 77  WRK-RECORD-COUNT   PIC  9(4) VALUE 0.
007900 01  COUNT-OF-RECS PIC 9999.
008000 01  FILE-RECORD-INFORMATION-REC.
008100     03 FILE-RECORD-INFO-SKELETON.
008200        05 FILLER                 PICTURE X(48)       VALUE
008300             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
008400        05 FILLER                 PICTURE X(46)       VALUE
008500             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
008600        05 FILLER                 PICTURE X(26)       VALUE
008700             ",LFIL=000000,ORG=  ,LBLR= ".
008800        05 FILLER                 PICTURE X(37)       VALUE
008900             ",RECKEY=                             ".
009000        05 FILLER                 PICTURE X(38)       VALUE
009100             ",ALTKEY1=                             ".
009200        05 FILLER                 PICTURE X(38)       VALUE
009300             ",ALTKEY2=                             ".
009400        05 FILLER                 PICTURE X(7)        VALUE SPACE.
009500     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
009600        05 FILE-RECORD-INFO-P1-120.
009700           07 FILLER              PIC X(5).
009800           07 XFILE-NAME           PIC X(6).
009900           07 FILLER              PIC X(8).
010000           07 XRECORD-NAME         PIC X(6).
010100           07 FILLER              PIC X(1).
010200           07 REELUNIT-NUMBER     PIC 9(1).
010300           07 FILLER              PIC X(7).
010400           07 XRECORD-NUMBER       PIC 9(6).
010500           07 FILLER              PIC X(6).
010600           07 UPDATE-NUMBER       PIC 9(2).
010700           07 FILLER              PIC X(5).
010800           07 ODO-NUMBER          PIC 9(4).
010900           07 FILLER              PIC X(5).
011000           07 XPROGRAM-NAME        PIC X(5).
011100           07 FILLER              PIC X(7).
011200           07 XRECORD-LENGTH       PIC 9(6).
011300           07 FILLER              PIC X(7).
011400           07 CHARS-OR-RECORDS    PIC X(2).
011500           07 FILLER              PIC X(1).
011600           07 XBLOCK-SIZE          PIC 9(4).
011700           07 FILLER              PIC X(6).
011800           07 RECORDS-IN-FILE     PIC 9(6).
011900           07 FILLER              PIC X(5).
012000           07 XFILE-ORGANIZATION   PIC X(2).
012100           07 FILLER              PIC X(6).
012200           07 XLABEL-TYPE          PIC X(1).
012300        05 FILE-RECORD-INFO-P121-240.
012400           07 FILLER              PIC X(8).
012500           07 XRECORD-KEY          PIC X(29).
012600           07 FILLER              PIC X(9).
012700           07 ALTERNATE-KEY1      PIC X(29).
012800           07 FILLER              PIC X(9).
012900           07 ALTERNATE-KEY2      PIC X(29).
013000           07 FILLER              PIC X(7).
013100 01  TEST-RESULTS.
013200     02 FILLER                    PICTURE X VALUE SPACE.
013300     02 FEATURE                   PICTURE X(20) VALUE SPACE.
013400     02 FILLER                    PICTURE X VALUE SPACE.
013500     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
013600     02 FILLER                    PICTURE X  VALUE SPACE.
013700     02  PAR-NAME.
013800       03 FILLER PICTURE X(12) VALUE SPACE.
013900       03  PARDOT-X PICTURE X  VALUE SPACE.
014000       03 DOTVALUE PICTURE 99  VALUE ZERO.
014100       03 FILLER PIC X(5) VALUE SPACE.
014200     02 FILLER PIC X(10) VALUE SPACE.
014300     02 RE-MARK PIC X(61).
014400 01  TEST-COMPUTED.
014500     02 FILLER PIC X(30) VALUE SPACE.
014600     02 FILLER PIC X(17) VALUE "       COMPUTED=".
014700     02 COMPUTED-X.
014800     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
014900     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
015000     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
015100     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
015200     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
015300     03       CM-18V0 REDEFINES COMPUTED-A.
015400         04 COMPUTED-18V0                   PICTURE -9(18).
015500         04 FILLER                          PICTURE X.
015600     03 FILLER PIC X(50) VALUE SPACE.
015700 01  TEST-CORRECT.
015800     02 FILLER PIC X(30) VALUE SPACE.
015900     02 FILLER PIC X(17) VALUE "       CORRECT =".
016000     02 CORRECT-X.
016100     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
016200     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
016300     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
016400     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
016500     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
016600     03      CR-18V0 REDEFINES CORRECT-A.
016700         04 CORRECT-18V0                    PICTURE -9(18).
016800         04 FILLER                          PICTURE X.
016900     03 FILLER PIC X(50) VALUE SPACE.
017000 01  CCVS-C-1.
017100     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
017200-    "SS  PARAGRAPH-NAME
017300-    "        REMARKS".
017400     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
017500 01  CCVS-C-2.
017600     02 FILLER PICTURE IS X VALUE IS SPACE.
017700     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
017800     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
017900     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
018000     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
018100 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
018200 01  REC-CT PICTURE 99 VALUE ZERO.
018300 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
018400 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
018500 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
018600 01  PASS-COUNTER PIC 999 VALUE ZERO.
018700 01  TOTAL-ERROR PIC 999 VALUE ZERO.
018800 01  ERROR-HOLD PIC 999 VALUE ZERO.
018900 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
019000 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
019100 01  CCVS-H-1.
019200     02  FILLER   PICTURE X(27)  VALUE SPACE.
019300     02 FILLER PICTURE X(67) VALUE
019400     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
019500-    " SYSTEM".
019600     02  FILLER     PICTURE X(26)  VALUE SPACE.
019700 01  CCVS-H-2.
019800     02 FILLER PICTURE X(52) VALUE IS
019900     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
020000     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
020100     02 TEST-ID PICTURE IS X(9).
020200     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
020300 01  CCVS-H-3.
020400     02  FILLER PICTURE X(34) VALUE
020500     " FOR OFFICIAL USE ONLY    ".
020600     02  FILLER PICTURE X(58) VALUE
020700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
020800     02  FILLER PICTURE X(28) VALUE
020900     "  COPYRIGHT   1985 ".
021000 01  CCVS-E-1.
021100     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
021200     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
021300     02 ID-AGAIN PICTURE IS X(9).
021400     02 FILLER PICTURE X(45) VALUE IS
021500     " NTIS DISTRIBUTION COBOL 85".
021600 01  CCVS-E-2.
021700     02  FILLER                   PICTURE X(31)  VALUE
021800     SPACE.
021900     02  FILLER                   PICTURE X(21)  VALUE SPACE.
022000     02 CCVS-E-2-2.
022100         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
022200         03 FILLER PICTURE IS X VALUE IS SPACE.
022300         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
022400 01  CCVS-E-3.
022500     02  FILLER PICTURE X(22) VALUE
022600     " FOR OFFICIAL USE ONLY".
022700     02  FILLER PICTURE X(12) VALUE SPACE.
022800     02  FILLER PICTURE X(58) VALUE
022900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
023000     02  FILLER PICTURE X(13) VALUE SPACE.
023100     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
023200 01  CCVS-E-4.
023300     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
023400     02 FILLER PIC XXXX VALUE " OF ".
023500     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
023600     02 FILLER PIC X(40) VALUE
023700      "  TESTS WERE EXECUTED SUCCESSFULLY".
023800 01  XXINFO.
023900     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
024000     02 INFO-TEXT.
024100     04 FILLER PIC X(20) VALUE SPACE.
024200     04 XXCOMPUTED PIC X(20).
024300     04 FILLER PIC X(5) VALUE SPACE.
024400     04 XXCORRECT PIC X(20).
024500 01  HYPHEN-LINE.
024600     02 FILLER PICTURE IS X VALUE IS SPACE.
024700     02 FILLER PICTURE IS X(65) VALUE IS "************************
024800-    "*****************************************".
024900     02 FILLER PICTURE IS X(54) VALUE IS "************************
025000-    "******************************".
025100 01  CCVS-PGM-ID PIC X(6) VALUE
025200     "SQ204A".
025300 PROCEDURE DIVISION.
025400 CCVS1 SECTION.
025500 OPEN-FILES.
025600P    OPEN I-O RAW-DATA.
025700P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
025800P    READ RAW-DATA INVALID KEY GO TO END-E-1.
025900P    MOVE "ABORTED " TO C-ABORT.
026000P    ADD 1 TO C-NO-OF-TESTS.
026100P    ACCEPT C-DATE  FROM DATE.
026200P    ACCEPT C-TIME  FROM TIME.
026300P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
026400PEND-E-1.
026500P    CLOSE RAW-DATA.
026600     OPEN     OUTPUT PRINT-FILE.
026700     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
026800     MOVE    SPACE TO TEST-RESULTS.
026900     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
027000     MOVE ZERO TO REC-SKL-SUB.
027100     PERFORM CCVS-INIT-FILE 9 TIMES.
027200 CCVS-INIT-FILE.
027300     ADD 1 TO REC-SKL-SUB.
027400     MOVE FILE-RECORD-INFO-SKELETON TO
027500                  FILE-RECORD-INFO (REC-SKL-SUB).
027600 CCVS-INIT-EXIT.
027700     GO TO CCVS1-EXIT.
027800 CLOSE-FILES.
027900     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
028000P    OPEN I-O RAW-DATA.
028100P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
028200P    READ RAW-DATA INVALID KEY GO TO END-E-2.
028300P    MOVE "OK.     " TO C-ABORT.
028400P    MOVE PASS-COUNTER TO C-OK.
028500P    MOVE ERROR-HOLD   TO C-ALL.
028600P    MOVE ERROR-COUNTER TO C-FAIL.
028700P    MOVE DELETE-CNT TO C-DELETED.
028800P    MOVE INSPECT-COUNTER TO C-INSPECT.
028900P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
029000PEND-E-2.
029100P    CLOSE RAW-DATA.
029200 TERMINATE-CCVS.
029300S    EXIT PROGRAM.
029400STERMINATE-CALL.
029500     STOP     RUN.
029600 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
029700 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
029800 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
029900 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
030000     MOVE "****TEST DELETED****" TO RE-MARK.
030100 PRINT-DETAIL.
030200     IF REC-CT NOT EQUAL TO ZERO
030300             MOVE "." TO PARDOT-X
030400             MOVE REC-CT TO DOTVALUE.
030500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
030600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
030700        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
030800          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
030900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
031000     MOVE SPACE TO CORRECT-X.
031100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
031200     MOVE     SPACE TO RE-MARK.
031300 HEAD-ROUTINE.
031400     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031500     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
031600     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
031700 COLUMN-NAMES-ROUTINE.
031800     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031900     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
032100 END-ROUTINE.
032200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
032300 END-RTN-EXIT.
032400     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032500 END-ROUTINE-1.
032600      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
032700      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
032800      ADD PASS-COUNTER TO ERROR-HOLD.
032900*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
033000      MOVE PASS-COUNTER TO CCVS-E-4-1.
033100      MOVE ERROR-HOLD TO CCVS-E-4-2.
033200      MOVE CCVS-E-4 TO CCVS-E-2-2.
033300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
033400  END-ROUTINE-12.
033500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
033600     IF       ERROR-COUNTER IS EQUAL TO ZERO
033700         MOVE "NO " TO ERROR-TOTAL
033800         ELSE
033900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
034000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
034100     PERFORM WRITE-LINE.
034200 END-ROUTINE-13.
034300     IF DELETE-CNT IS EQUAL TO ZERO
034400         MOVE "NO " TO ERROR-TOTAL  ELSE
034500         MOVE DELETE-CNT TO ERROR-TOTAL.
034600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
034700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034800      IF   INSPECT-COUNTER EQUAL TO ZERO
034900          MOVE "NO " TO ERROR-TOTAL
035000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
035100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
035200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035400 WRITE-LINE.
035500     ADD 1 TO RECORD-COUNT.
035600Y    IF RECORD-COUNT GREATER 50
035700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
035800Y        MOVE SPACE TO DUMMY-RECORD
035900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
036000Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
036100Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
036200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
036300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
036400Y        MOVE ZERO TO RECORD-COUNT.
036500     PERFORM WRT-LN.
036600 WRT-LN.
036700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
036800     MOVE SPACE TO DUMMY-RECORD.
036900 BLANK-LINE-PRINT.
037000     PERFORM WRT-LN.
037100 FAIL-ROUTINE.
037200     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
037300     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
037400     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
037500     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037600     GO TO FAIL-ROUTINE-EX.
037700 FAIL-ROUTINE-WRITE.
037800     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
037900     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
038000 FAIL-ROUTINE-EX. EXIT.
038100 BAIL-OUT.
038200     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
038300     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
038400 BAIL-OUT-WRITE.
038500     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
038600     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038700 BAIL-OUT-EX. EXIT.
038800 CCVS1-EXIT.
038900     EXIT.
039000 SECT-SQ204A-0001 SECTION.
039100 WRITE-INIT-GF-01.
039200*             THIS IS A TEST FOR OPEN EXTEND FOR MAGNETIC TAPE.
039300*             A FILE OF 750 RECORDS IS CREATED THEN RE-OPENED
039400*             WITH EXTEND.  250 RECORDS ARE ADDED TO THE FILE.
039500*             THE FILE IS THEN READ AND VALIDATED.
039600     MOVE "SQ-FS1" TO XFILE-NAME (1).
039700     MOVE "R1-F-G" TO XRECORD-NAME (1).
039800     MOVE "SQ204A" TO XPROGRAM-NAME (1).
039900     MOVE 000126  TO XRECORD-LENGTH (1).
040000     MOVE "RC"    TO CHARS-OR-RECORDS (1).
040100     MOVE 0001    TO XBLOCK-SIZE (1).
040200     MOVE 001000  TO RECORDS-IN-FILE (1).
040300     MOVE "SQ"    TO XFILE-ORGANIZATION (1).
040400     MOVE "S"     TO XLABEL-TYPE (1).
040500     MOVE 000001  TO XRECORD-NUMBER (1).
040600     OPEN OUTPUT SQ-FS1.
040700 WRITE-TEST-001-01.
040800     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-FS1R1-F-G-120.
040900     MOVE SPACES TO SQ-FS1R1-F-G-006.
041000     WRITE SQ-FS1R1-F-G-126.
041100     IF XRECORD-NUMBER (1) EQUAL TO 750
041200              GO TO WRITE-TEST-GF-01-1.
041300     ADD 1 TO XRECORD-NUMBER (1).
041400     GO TO WRITE-TEST-001-01.
041500 WRITE-TEST-GF-01-1.
041600     MOVE "CREATE FILE SQ-FS1" TO FEATURE.
041700     MOVE "WRITE-TEST-GF-01-1" TO PAR-NAME.
041800     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
041900     MOVE XRECORD-NUMBER (1) TO CORRECT-18V0.
042000     PERFORM PRINT-DETAIL.
042100     CLOSE SQ-FS1.
042200 WRITE-TEST-001-03.
042300     OPEN EXTEND SQ-FS1.
042400     ADD 1 TO XRECORD-NUMBER (1).
042500 WRITE-TEST-001-04.
042600     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-FS1R1-F-G-120.
042700     MOVE "EXTEND" TO SQ-FS1R1-F-G-006.
042800     WRITE SQ-FS1R1-F-G-126.
042900     IF XRECORD-NUMBER (1) EQUAL 1000
043000              GO TO WRITE-TEST-GF-01-2.
043100     ADD 1 TO XRECORD-NUMBER (1).
043200     GO TO WRITE-TEST-001-04.
043300 WRITE-TEST-GF-01-2.
043400     MOVE "CREATE FILE SQ-FS1" TO FEATURE.
043500     MOVE "WRITE-TEST-GF-01-2" TO PAR-NAME.
043600     MOVE "FILE EXTENDED, RECS =" TO COMPUTED-A.
043700     MOVE XRECORD-NUMBER (1) TO CORRECT-18V0.
043800     PERFORM PRINT-DETAIL.
043900     CLOSE SQ-FS1.
044000 READ-TEST-001-06.
044100     OPEN INPUT SQ-FS1.
044200     MOVE ZERO TO WRK-RECORD-COUNT.
044300 READ-TEST-GF-01-07.
044400     READ SQ-FS1
044500              ; AT END  MOVE "PREMATURE EOF" TO RE-MARK
044600                        PERFORM FAIL
044700                        GO TO READ-WRITE-GF-01.
044800     MOVE SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
044900     ADD 1 TO WRK-RECORD-COUNT.
045000     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS1"
045100              ADD 1 TO RECORDS-IN-ERROR
045200              GO TO READ-TEST-GF-01-08.
045300     IF WRK-RECORD-COUNT NOT EQUAL TO XRECORD-NUMBER (1)
045400              ADD 1 TO RECORDS-IN-ERROR
045500              GO TO READ-TEST-GF-01-08.
045600     IF SQ-FS1R1-F-G-006 NOT EQUAL TO SPACES
045700              ADD 1 TO RECORDS-IN-ERROR.
045800 READ-TEST-GF-01-08.
045900     IF WRK-RECORD-COUNT NOT EQUAL TO 750
046000              GO TO READ-TEST-GF-01-07.
046100 READ-TEST-GF-01-09.
046200     READ SQ-FS1 RECORD
046300              ; END GO TO READ-TEST-GF-01.
046400     MOVE SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
046500     ADD 1 TO WRK-RECORD-COUNT.
046600     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS1"
046700              ADD 1 TO RECORDS-IN-ERROR
046800              GO TO READ-TEST-GF-01-09.
046900     IF WRK-RECORD-COUNT NOT EQUAL TO XRECORD-NUMBER (1)
047000              ADD 1 TO RECORDS-IN-ERROR
047100              GO TO READ-TEST-GF-01-09.
047200     IF SQ-FS1R1-F-G-006 NOT EQUAL TO "EXTEND"
047300              ADD 1 TO RECORDS-IN-ERROR.
047400     GO TO READ-TEST-GF-01-09.
047500 READ-TEST-GF-01.
047600     IF RECORDS-IN-ERROR EQUAL ZERO
047700              GO TO READ-PASS-GF-01.
047800     MOVE "ERRORS IN READING SQ-FS1" TO RE-MARK.
047900     GO TO READ-FAIL-GF-01.
048000 READ-DELETE-GF-01.
048100     PERFORM DE-LETE.
048200     GO TO READ-WRITE-GF-01.
048300 READ-FAIL-GF-01.
048400     MOVE "VII-44 READ OR VII-52 WRITE INCORRECTLY EXECUTED"
048500        TO RE-MARK.
048600     MOVE "RECORDS IN ERROR =" TO COMPUTED-A.
048700     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
048800     PERFORM FAIL.
048900     GO TO READ-WRITE-GF-01.
049000 READ-PASS-GF-01.
049100     PERFORM PASS.
049200     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
049300     MOVE WRK-RECORD-COUNT TO CORRECT-18V0.
049400 READ-WRITE-GF-01.
049500     MOVE "READ-TEST-GF-01" TO PAR-NAME.
049600     MOVE "VERIFY FILE SQ-FS1" TO FEATURE.
049700     PERFORM PRINT-DETAIL.
049800 READ-CLOSE-GF-01.
049900     CLOSE SQ-FS1.
050000 WRITE-INIT-GF-02.
050100*             THIS IS A TEST FOR OPEN EXTEND FOR MASS STORAGE.
050200*             A FILE OF 750 RECORDS IS CREATED THEN RE-OPENED
050300*             WITH EXTEND.  250 RECORDS ARE ADDED TO THE FILE.
050400*             THE FILE IS THEN READ AND VALIDATED.
050500     MOVE "SQ-FS2" TO XFILE-NAME (2).
050600     MOVE "R1-F-G" TO XRECORD-NAME (2).
050700     MOVE "SQ204A" TO XPROGRAM-NAME (2).
050800     MOVE 000126  TO XRECORD-LENGTH (2).
050900     MOVE "RC"    TO CHARS-OR-RECORDS (2).
051000     MOVE 0001    TO XBLOCK-SIZE (2).
051100     MOVE 001000  TO RECORDS-IN-FILE (2).
051200     MOVE "SQ"    TO XFILE-ORGANIZATION (2).
051300     MOVE "S"     TO XLABEL-TYPE (2).
051400     MOVE 000001  TO XRECORD-NUMBER (2).
051500     OPEN OUTPUT SQ-FS2.
051600 WRITE-TEST-GF-02-01.
051700     MOVE FILE-RECORD-INFO-P1-120 (2) TO SQ-FS2R1-F-G-120.
051800     MOVE SPACES TO SQ-FS2R1-F-G-006.
051900     WRITE SQ-FS2R1-F-G-126.
052000     IF XRECORD-NUMBER (2) EQUAL TO 750
052100              GO TO WRITE-TEST-GF-02-1.
052200     ADD 1 TO XRECORD-NUMBER (2).
052300     GO TO WRITE-TEST-GF-02-01.
052400 WRITE-TEST-GF-02-1.
052500     MOVE "CREATE FILE SQ-FS2" TO FEATURE.
052600     MOVE "WRITE-TEST-GF-02-1" TO PAR-NAME.
052700     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
052800     MOVE XRECORD-NUMBER (2) TO CORRECT-18V0.
052900     PERFORM PRINT-DETAIL.
053000     CLOSE SQ-FS2.
053100 WRITE-TEST-GF-02-03.
053200     OPEN EXTEND SQ-FS2.
053300     ADD 1 TO XRECORD-NUMBER (2).
053400 WRITE-TEST-GF-02-04.
053500     MOVE FILE-RECORD-INFO-P1-120 (2) TO SQ-FS2R1-F-G-120.
053600     MOVE "EXTEND" TO SQ-FS2R1-F-G-006.
053700     WRITE SQ-FS2R1-F-G-126.
053800     IF XRECORD-NUMBER (2) EQUAL 1000
053900              GO TO WRITE-TEST-GF-02-2.
054000     ADD 1 TO XRECORD-NUMBER (2).
054100     GO TO WRITE-TEST-GF-02-04.
054200 WRITE-TEST-GF-02-2.
054300     MOVE "CREATE FILE SQ-FS2" TO FEATURE.
054400     MOVE "WRITE-TEST-GF-02-2" TO PAR-NAME.
054500     MOVE "FILE EXTENDED, RECS =" TO COMPUTED-A.
054600     MOVE XRECORD-NUMBER (2) TO CORRECT-18V0.
054700     PERFORM PRINT-DETAIL.
054800     CLOSE SQ-FS2.
054900 READ-TEST-GF-02-06.
055000     OPEN INPUT SQ-FS2.
055100     MOVE ZERO TO WRK-RECORD-COUNT.
055200     MOVE ZERO TO RECORDS-IN-ERROR.
055300 READ-TEST-GF-02-07.
055400     READ SQ-FS2
055500              AT END MOVE "PREMATURE EOF" TO RE-MARK
055600                     PERFORM FAIL
055700                     GO TO READ-WRITE-GF-02.
055800     MOVE SQ-FS2R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (2).
055900     ADD 1 TO WRK-RECORD-COUNT.
056000     IF XFILE-NAME (2) NOT EQUAL TO "SQ-FS2"
056100              ADD 1 TO RECORDS-IN-ERROR
056200              GO TO READ-TEST-GF-02-08.
056300     IF WRK-RECORD-COUNT NOT EQUAL TO XRECORD-NUMBER (2)
056400              ADD 1 TO RECORDS-IN-ERROR
056500              GO TO READ-TEST-GF-02-08.
056600     IF SQ-FS2R1-F-G-006 NOT EQUAL TO SPACES
056700              ADD 1 TO RECORDS-IN-ERROR.
056800 READ-TEST-GF-02-08.
056900     IF WRK-RECORD-COUNT NOT EQUAL TO 750
057000              GO TO READ-TEST-GF-02-07.
057100 READ-TEST-GF-02-09.
057200     READ SQ-FS2 RECORD
057300              AT END GO TO READ-TEST-GF-02.
057400     MOVE SQ-FS2R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (2)
057500     ADD 1 TO WRK-RECORD-COUNT.
057600     IF XFILE-NAME (2) NOT EQUAL TO "SQ-FS2"
057700              ADD 1 TO RECORDS-IN-ERROR
057800              GO TO READ-TEST-GF-02-09.
057900     IF WRK-RECORD-COUNT NOT EQUAL TO XRECORD-NUMBER (2)
058000              ADD 1 TO RECORDS-IN-ERROR
058100              GO TO READ-TEST-GF-02-09.
058200     IF SQ-FS2R1-F-G-006 NOT EQUAL TO "EXTEND"
058300              ADD 1 TO RECORDS-IN-ERROR.
058400     GO TO READ-TEST-GF-02-09.
058500 READ-TEST-GF-02.
058600     IF RECORDS-IN-ERROR EQUAL ZERO
058700              GO TO READ-PASS-GF-02.
058800     MOVE "ERRORS IN READING SQ-FS2" TO RE-MARK.
058900     GO TO READ-FAIL-GF-02.
059000 READ-DELETE-GF-02.
059100     PERFORM DE-LETE.
059200     GO TO READ-WRITE-GF-02.
059300 READ-FAIL-GF-02.
059400     MOVE "VII-44 READ OR VII-52 WRITE INCORRECTLY EXECUTED"
059500        TO RE-MARK.
059600     MOVE "RECORDS IN ERROR =" TO COMPUTED-A.
059700     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
059800     PERFORM FAIL.
059900     GO TO READ-WRITE-GF-02.
060000 READ-PASS-GF-02.
060100     PERFORM PASS.
060200     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
060300     MOVE WRK-RECORD-COUNT TO CORRECT-18V0.
060400 READ-WRITE-GF-02.
060500     MOVE "READ-TEST-GF-02" TO PAR-NAME.
060600     MOVE "VERIFY FILE SQ-FS2" TO FEATURE.
060700     PERFORM PRINT-DETAIL.
060800 READ-CLOSE-GF-02.
060900     CLOSE SQ-FS2.
061000 SQ204A-END-ROUTINE.
061100     MOVE "END OF SQ204A VALIDATION TESTS" TO PRINT-REC.
061200     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
061300 TERMINATE-SQ204A.
061400     EXIT.
061500 CCVS-EXIT SECTION.
061600 CCVS-999999.
061700     GO TO CLOSE-FILES.
