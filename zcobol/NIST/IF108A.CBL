000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IF108A.
000400
000500***********************************************************
000600*                                                         *
000700* This program forms part of the CCVS85 COBOL Test Suite. *
000800* It contains tests for the Intrinsic Function            *
000900* DATE-OF-INTEGER.                                        *
001000*                                                         *
001100***********************************************************
001200 ENVIRONMENT DIVISION.
001300 CONFIGURATION SECTION.
001400 SOURCE-COMPUTER.
001500     XXXXX082.
001600 OBJECT-COMPUTER.
001700     XXXXX083.
001800 INPUT-OUTPUT SECTION.
001900 FILE-CONTROL.
002000     SELECT PRINT-FILE ASSIGN TO
002100     XXXXX055.
002200 DATA DIVISION.
002300 FILE SECTION.
002400 FD  PRINT-FILE.
002500 01  PRINT-REC PICTURE X(120).
002600 01  DUMMY-RECORD PICTURE X(120).
002700 WORKING-STORAGE SECTION.
002800***********************************************************
002900* Variables specific to the Intrinsic Function Test IF108A*
003000***********************************************************
003100 01  A                   PIC S9(10)     VALUE 400.
003200 01  C                   PIC S9(10)     VALUE 300.
003300 01  D                   PIC S9(10)     VALUE 1.
003400 01  ARG1                PIC S9(10)     VALUE 1.
003500 01  ARR                                VALUE "40537".
003600     02 IND OCCURS 5 TIMES PIC 9.
003700 01  TEMP                PIC S9(5)V9(5).
003800 01  WS-DATE             PIC 9(8).
003900*
004000**********************************************************
004100*
004200 01  TEST-RESULTS.
004300     02 FILLER                   PIC X      VALUE SPACE.
004400     02 FEATURE                  PIC X(20)  VALUE SPACE.
004500     02 FILLER                   PIC X      VALUE SPACE.
004600     02 P-OR-F                   PIC X(5)   VALUE SPACE.
004700     02 FILLER                   PIC X      VALUE SPACE.
004800     02  PAR-NAME.
004900       03 FILLER                 PIC X(19)  VALUE SPACE.
005000       03  PARDOT-X              PIC X      VALUE SPACE.
005100       03 DOTVALUE               PIC 99     VALUE ZERO.
005200     02 FILLER                   PIC X(8)   VALUE SPACE.
005300     02 RE-MARK                  PIC X(61).
005400 01  TEST-COMPUTED.
005500     02 FILLER                   PIC X(30)  VALUE SPACE.
005600     02 FILLER                   PIC X(17)  VALUE
005700            "       COMPUTED=".
005800     02 COMPUTED-X.
005900     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
006000     03 COMPUTED-N               REDEFINES COMPUTED-A
006100                                 PIC -9(9).9(9).
006200     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
006300     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
006400     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
006500     03       CM-18V0 REDEFINES COMPUTED-A.
006600         04 COMPUTED-18V0                    PIC -9(18).
006700         04 FILLER                           PIC X.
006800     03 FILLER PIC X(50) VALUE SPACE.
006900 01  TEST-CORRECT.
007000     02 FILLER PIC X(30) VALUE SPACE.
007100     02 FILLER PIC X(17) VALUE "       CORRECT =".
007200     02 CORRECT-X.
007300     03 CORRECT-A                  PIC X(20) VALUE SPACE.
007400     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
007500     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
007600     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
007700     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
007800     03      CR-18V0 REDEFINES CORRECT-A.
007900         04 CORRECT-18V0                     PIC -9(18).
008000         04 FILLER                           PIC X.
008100     03 FILLER PIC X(2) VALUE SPACE.
008200     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
008300 01  CCVS-C-1.
008400     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
008500-    "SS  PARAGRAPH-NAME
008600-    "       REMARKS".
008700     02 FILLER                     PIC X(20)    VALUE SPACE.
008800 01  CCVS-C-2.
008900     02 FILLER                     PIC X        VALUE SPACE.
009000     02 FILLER                     PIC X(6)     VALUE "TESTED".
009100     02 FILLER                     PIC X(15)    VALUE SPACE.
009200     02 FILLER                     PIC X(4)     VALUE "FAIL".
009300     02 FILLER                     PIC X(94)    VALUE SPACE.
009400 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
009500 01  REC-CT                        PIC 99       VALUE ZERO.
009600 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
009700 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
009800 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
009900 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
010000 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
010100 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
010200 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
010300 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
010400 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
010500 01  CCVS-H-1.
010600     02  FILLER                    PIC X(39)    VALUE SPACES.
010700     02  FILLER                    PIC X(42)    VALUE
010800     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
010900     02  FILLER                    PIC X(39)    VALUE SPACES.
011000 01  CCVS-H-2A.
011100   02  FILLER                        PIC X(40)  VALUE SPACE.
011200   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
011300   02  FILLER                        PIC XXXX   VALUE
011400     "4.2 ".
011500   02  FILLER                        PIC X(28)  VALUE
011600            " COPY - NOT FOR DISTRIBUTION".
011700   02  FILLER                        PIC X(41)  VALUE SPACE.
011800
011900 01  CCVS-H-2B.
012000   02  FILLER                        PIC X(15)  VALUE
012100            "TEST RESULT OF ".
012200   02  TEST-ID                       PIC X(9).
012300   02  FILLER                        PIC X(4)   VALUE
012400            " IN ".
012500   02  FILLER                        PIC X(12)  VALUE
012600     " HIGH       ".
012700   02  FILLER                        PIC X(22)  VALUE
012800            " LEVEL VALIDATION FOR ".
012900   02  FILLER                        PIC X(58)  VALUE
013000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
013100 01  CCVS-H-3.
013200     02  FILLER                      PIC X(34)  VALUE
013300            " FOR OFFICIAL USE ONLY    ".
013400     02  FILLER                      PIC X(58)  VALUE
013500     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
013600     02  FILLER                      PIC X(28)  VALUE
013700            "  COPYRIGHT   1985 ".
013800 01  CCVS-E-1.
013900     02 FILLER                       PIC X(52)  VALUE SPACE.
014000     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
014100     02 ID-AGAIN                     PIC X(9).
014200     02 FILLER                       PIC X(45)  VALUE SPACES.
014300 01  CCVS-E-2.
014400     02  FILLER                      PIC X(31)  VALUE SPACE.
014500     02  FILLER                      PIC X(21)  VALUE SPACE.
014600     02 CCVS-E-2-2.
014700         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
014800         03 FILLER                   PIC X      VALUE SPACE.
014900         03 ENDER-DESC               PIC X(44)  VALUE
015000            "ERRORS ENCOUNTERED".
015100 01  CCVS-E-3.
015200     02  FILLER                      PIC X(22)  VALUE
015300            " FOR OFFICIAL USE ONLY".
015400     02  FILLER                      PIC X(12)  VALUE SPACE.
015500     02  FILLER                      PIC X(58)  VALUE
015600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
015700     02  FILLER                      PIC X(13)  VALUE SPACE.
015800     02 FILLER                       PIC X(15)  VALUE
015900             " COPYRIGHT 1985".
016000 01  CCVS-E-4.
016100     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
016200     02 FILLER                       PIC X(4)   VALUE " OF ".
016300     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
016400     02 FILLER                       PIC X(40)  VALUE
016500      "  TESTS WERE EXECUTED SUCCESSFULLY".
016600 01  XXINFO.
016700     02 FILLER                       PIC X(19)  VALUE
016800            "*** INFORMATION ***".
016900     02 INFO-TEXT.
017000       04 FILLER                     PIC X(8)   VALUE SPACE.
017100       04 XXCOMPUTED                 PIC X(20).
017200       04 FILLER                     PIC X(5)   VALUE SPACE.
017300       04 XXCORRECT                  PIC X(20).
017400     02 INF-ANSI-REFERENCE           PIC X(48).
017500 01  HYPHEN-LINE.
017600     02 FILLER  PIC IS X VALUE IS SPACE.
017700     02 FILLER  PIC IS X(65)    VALUE IS "************************
017800-    "*****************************************".
017900     02 FILLER  PIC IS X(54)    VALUE IS "************************
018000-    "******************************".
018100 01  CCVS-PGM-ID                     PIC X(9)   VALUE
018200     "IF108A".
018300 PROCEDURE DIVISION.
018400 CCVS1 SECTION.
018500 OPEN-FILES.
018600     OPEN     OUTPUT PRINT-FILE.
018700     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
018800     MOVE    SPACE TO TEST-RESULTS.
018900     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
019000     GO TO CCVS1-EXIT.
019100 CLOSE-FILES.
019200     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
019300 TERMINATE-CCVS.
019400     STOP     RUN.
019500 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
019600 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
019700 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
019800 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
019900     MOVE "****TEST DELETED****" TO RE-MARK.
020000 PRINT-DETAIL.
020100     IF REC-CT NOT EQUAL TO ZERO
020200             MOVE "." TO PARDOT-X
020300             MOVE REC-CT TO DOTVALUE.
020400     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
020500     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
020600        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
020700          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
020800     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
020900     MOVE SPACE TO CORRECT-X.
021000     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
021100     MOVE     SPACE TO RE-MARK.
021200 HEAD-ROUTINE.
021300     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
021400     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
021500     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
021600     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
021700 COLUMN-NAMES-ROUTINE.
021800     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
021900     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
022000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
022100 END-ROUTINE.
022200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
022300 END-RTN-EXIT.
022400     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
022500 END-ROUTINE-1.
022600      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
022700      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
022800      ADD PASS-COUNTER TO ERROR-HOLD.
022900      MOVE PASS-COUNTER TO CCVS-E-4-1.
023000      MOVE ERROR-HOLD TO CCVS-E-4-2.
023100      MOVE CCVS-E-4 TO CCVS-E-2-2.
023200      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
023300  END-ROUTINE-12.
023400      MOVE "TEST(S) FAILED" TO ENDER-DESC.
023500     IF       ERROR-COUNTER IS EQUAL TO ZERO
023600         MOVE "NO " TO ERROR-TOTAL
023700         ELSE
023800         MOVE ERROR-COUNTER TO ERROR-TOTAL.
023900     MOVE     CCVS-E-2 TO DUMMY-RECORD.
024000     PERFORM WRITE-LINE.
024100 END-ROUTINE-13.
024200     IF DELETE-COUNTER IS EQUAL TO ZERO
024300         MOVE "NO " TO ERROR-TOTAL  ELSE
024400         MOVE DELETE-COUNTER TO ERROR-TOTAL.
024500     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
024600     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
024700      IF   INSPECT-COUNTER EQUAL TO ZERO
024800          MOVE "NO " TO ERROR-TOTAL
024900      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
025000      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
025100      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025200     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025300 WRITE-LINE.
025400     ADD 1 TO RECORD-COUNT.
025500Y    IF RECORD-COUNT GREATER 42
025600Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
025700Y        MOVE SPACE TO DUMMY-RECORD
025800Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
025900Y        MOVE CCVS-H-1  TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
026000Y        MOVE CCVS-H-2A TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
026100Y        MOVE CCVS-H-2B TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
026200Y        MOVE CCVS-H-3  TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
026300Y        MOVE CCVS-C-1  TO DUMMY-RECORD  PERFORM WRT-LN
026400Y        MOVE CCVS-C-2  TO DUMMY-RECORD  PERFORM WRT-LN
026500Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
026600Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
026700Y        MOVE ZERO TO RECORD-COUNT.
026800     PERFORM WRT-LN.
026900 WRT-LN.
027000     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
027100     MOVE SPACE TO DUMMY-RECORD.
027200 BLANK-LINE-PRINT.
027300     PERFORM WRT-LN.
027400 FAIL-ROUTINE.
027500     IF     COMPUTED-X NOT EQUAL TO SPACE
027600            GO TO FAIL-ROUTINE-WRITE.
027700     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
027800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
027900     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
028000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028100     MOVE   SPACES TO INF-ANSI-REFERENCE.
028200     GO TO  FAIL-ROUTINE-EX.
028300 FAIL-ROUTINE-WRITE.
028400     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
028500     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
028600     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
028700     MOVE   SPACES TO COR-ANSI-REFERENCE.
028800 FAIL-ROUTINE-EX. EXIT.
028900 BAIL-OUT.
029000     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
029100     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
029200 BAIL-OUT-WRITE.
029300     MOVE CORRECT-A TO XXCORRECT.
029400     MOVE COMPUTED-A TO XXCOMPUTED.
029500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
029600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029700     MOVE   SPACES TO INF-ANSI-REFERENCE.
029800 BAIL-OUT-EX. EXIT.
029900 CCVS1-EXIT.
030000     EXIT.
030100********************************************************
030200*                                                      *
030300*    Intrinsic Function Test  IF108A - DATE-OF-INTEGER *
030400*                                                      *
030500********************************************************
030600 SECT-IF108A SECTION.
030700 F-DATEOFINT-INFO.
030800     MOVE     "See ref. A-41 2.12" TO ANSI-REFERENCE.
030900     MOVE     "DATE-OF-INTEGER"     TO FEATURE.
031000*****************TEST (a) ******************************
031100 F-DATEOFINT-01.
031200     MOVE ZERO TO WS-DATE.
031300 F-DATEOFINT-TEST-01.
031400     COMPUTE WS-DATE = FUNCTION DATE-OF-INTEGER(1).
031500     IF WS-DATE = 16010101 THEN
031600                        PERFORM PASS
031700     ELSE
031800                        MOVE  16010101  TO CORRECT-N
031900                        MOVE WS-DATE TO COMPUTED-N
032000                        PERFORM FAIL.
032100     GO TO F-DATEOFINT-WRITE-01.
032200 F-DATEOFINT-DELETE-01.
032300     PERFORM  DE-LETE.
032400     GO TO    F-DATEOFINT-WRITE-01.
032500 F-DATEOFINT-WRITE-01.
032600     MOVE "F-DATEOFINT-01" TO PAR-NAME.
032700     PERFORM  PRINT-DETAIL.
032800*****************TEST (b) ******************************
032900 F-DATEOFINT-TEST-02.
033000     EVALUATE FUNCTION DATE-OF-INTEGER(A)
033100     WHEN     16020204
033200                    PERFORM PASS
033300                    GO TO F-DATEOFINT-WRITE-02.
033400     PERFORM FAIL.
033500     GO TO F-DATEOFINT-WRITE-02.
033600 F-DATEOFINT-DELETE-02.
033700     PERFORM  DE-LETE.
033800     GO TO    F-DATEOFINT-WRITE-02.
033900 F-DATEOFINT-WRITE-02.
034000     MOVE "F-DATEOFINT-02" TO PAR-NAME.
034100     PERFORM  PRINT-DETAIL.
034200*****************TEST (c) ******************************
034300 F-DATEOFINT-TEST-03.
034400     IF FUNCTION DATE-OF-INTEGER(IND(1)) = 16010104 THEN
034500                        PERFORM PASS
034600     ELSE
034700                        PERFORM FAIL.
034800     GO TO F-DATEOFINT-WRITE-03.
034900 F-DATEOFINT-DELETE-03.
035000     PERFORM  DE-LETE.
035100     GO TO    F-DATEOFINT-WRITE-03.
035200 F-DATEOFINT-WRITE-03.
035300     MOVE "F-DATEOFINT-03" TO PAR-NAME.
035400     PERFORM  PRINT-DETAIL.
035500*****************TEST (d) ******************************
035600 F-DATEOFINT-04.
035700     MOVE ZERO TO WS-DATE.
035800 F-DATEOFINT-TEST-04.
035900     COMPUTE WS-DATE = FUNCTION DATE-OF-INTEGER(IND(D)).
036000     IF WS-DATE = 16010104 THEN
036100                        PERFORM PASS
036200     ELSE
036300                        MOVE  16010104  TO CORRECT-N
036400                        MOVE WS-DATE TO COMPUTED-N
036500                        PERFORM FAIL.
036600     GO TO F-DATEOFINT-WRITE-04.
036700 F-DATEOFINT-DELETE-04.
036800     PERFORM  DE-LETE.
036900     GO TO    F-DATEOFINT-WRITE-04.
037000 F-DATEOFINT-WRITE-04.
037100     MOVE "F-DATEOFINT-04" TO PAR-NAME.
037200     PERFORM  PRINT-DETAIL.
037300*****************TEST (e) ******************************
037400 F-DATEOFINT-05.
037500     MOVE ZERO TO WS-DATE.
037600 F-DATEOFINT-TEST-05.
037700     COMPUTE WS-DATE = FUNCTION DATE-OF-INTEGER(730).
037800     IF WS-DATE = 16021231 THEN
037900                        PERFORM PASS
038000     ELSE
038100                        MOVE  16021231  TO CORRECT-N
038200                        MOVE WS-DATE TO COMPUTED-N
038300                        PERFORM FAIL.
038400     GO TO F-DATEOFINT-WRITE-05.
038500 F-DATEOFINT-DELETE-05.
038600     PERFORM  DE-LETE.
038700     GO TO    F-DATEOFINT-WRITE-05.
038800 F-DATEOFINT-WRITE-05.
038900     MOVE "F-DATEOFINT-05" TO PAR-NAME.
039000     PERFORM  PRINT-DETAIL.
039100*****************TEST (f) ******************************
039200 F-DATEOFINT-06.
039300     MOVE ZERO TO WS-DATE.
039400 F-DATEOFINT-TEST-06.
039500     COMPUTE WS-DATE = FUNCTION DATE-OF-INTEGER(C).
039600     IF WS-DATE = 16011027 THEN
039700                        PERFORM PASS
039800     ELSE
039900                        MOVE  16011027  TO CORRECT-N
040000                        MOVE WS-DATE TO COMPUTED-N
040100                        PERFORM FAIL.
040200     GO TO F-DATEOFINT-WRITE-06.
040300 F-DATEOFINT-DELETE-06.
040400     PERFORM  DE-LETE.
040500     GO TO    F-DATEOFINT-WRITE-06.
040600 F-DATEOFINT-WRITE-06.
040700     MOVE "F-DATEOFINT-06" TO PAR-NAME.
040800     PERFORM  PRINT-DETAIL.
040900*****************TEST (g) ******************************
041000 F-DATEOFINT-07.
041100     MOVE ZERO TO WS-DATE.
041200 F-DATEOFINT-TEST-07.
041300     COMPUTE WS-DATE = FUNCTION DATE-OF-INTEGER(365).
041400     IF WS-DATE = 16011231 THEN
041500                        PERFORM PASS
041600     ELSE
041700                        MOVE  16011231  TO CORRECT-N
041800                        MOVE WS-DATE TO COMPUTED-N
041900                        PERFORM FAIL.
042000     GO TO F-DATEOFINT-WRITE-07.
042100 F-DATEOFINT-DELETE-07.
042200     PERFORM  DE-LETE.
042300     GO TO    F-DATEOFINT-WRITE-07.
042400 F-DATEOFINT-WRITE-07.
042500     MOVE "F-DATEOFINT-07" TO PAR-NAME.
042600     PERFORM  PRINT-DETAIL.
042700*****************TEST (h) ******************************
042800 F-DATEOFINT-08.
042900     MOVE ZERO TO WS-DATE.
043000 F-DATEOFINT-TEST-08.
043100     COMPUTE WS-DATE = FUNCTION DATE-OF-INTEGER(D) + 10.
043200     IF WS-DATE = 16010111 THEN
043300                        PERFORM PASS
043400     ELSE
043500                        MOVE  16010111  TO CORRECT-N
043600                        MOVE WS-DATE TO COMPUTED-N
043700                        PERFORM FAIL.
043800     GO TO F-DATEOFINT-WRITE-08.
043900 F-DATEOFINT-DELETE-08.
044000     PERFORM  DE-LETE.
044100     GO TO    F-DATEOFINT-WRITE-08.
044200 F-DATEOFINT-WRITE-08.
044300     MOVE "F-DATEOFINT-08" TO PAR-NAME.
044400     PERFORM  PRINT-DETAIL.
044500*****************TEST (i) ******************************
044600 F-DATEOFINT-09.
044700     MOVE ZERO TO WS-DATE.
044800 F-DATEOFINT-TEST-09.
044900     COMPUTE WS-DATE = FUNCTION DATE-OF-INTEGER(D) +
045000                    FUNCTION DATE-OF-INTEGER(D).
045100     IF WS-DATE = 32020202 THEN
045200                        PERFORM PASS
045300     ELSE
045400                        MOVE  32020202  TO CORRECT-N
045500                        MOVE WS-DATE TO COMPUTED-N
045600                        PERFORM FAIL.
045700     GO TO F-DATEOFINT-WRITE-09.
045800 F-DATEOFINT-DELETE-09.
045900     PERFORM  DE-LETE.
046000     GO TO    F-DATEOFINT-WRITE-09.
046100 F-DATEOFINT-WRITE-09.
046200     MOVE "F-DATEOFINT-09" TO PAR-NAME.
046300     PERFORM  PRINT-DETAIL.
046400
046500***************** SPECIAL TEST 1 ***********************
046600
046700 F-DATEOFINT-10.
046800     MOVE 1 TO ARG1.
046900     PERFORM F-DATEOFINT-TEST-10
047000             UNTIL FUNCTION DATE-OF-INTEGER(ARG1) > 16010110.
047100     IF ARG1 = 11 THEN
047200                            PERFORM PASS
047300     ELSE
047400                            PERFORM FAIL.
047500     GO TO F-DATEOFINT-WRITE-10.
047600*
047700 F-DATEOFINT-TEST-10.
047800     COMPUTE ARG1 = ARG1 + 1.
047900*
048000 F-DATEOFINT-DELETE-10.
048100     PERFORM  DE-LETE.
048200     GO TO    F-DATEOFINT-WRITE-10.
048300 F-DATEOFINT-WRITE-10.
048400     MOVE "F-DATEOFINT-10" TO PAR-NAME.
048500     PERFORM  PRINT-DETAIL.
048600*******************END OF TESTS**************************
048700 CCVS-EXIT SECTION.
048800 CCVS-999999.
048900     GO TO CLOSE-FILES.
