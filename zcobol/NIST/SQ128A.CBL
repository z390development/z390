000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ128A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200*         THE ROUTINE SQ128A TESTS THE USE OF THE LEVEL 1 OPEN
001300*    SERIES AND CLOSE SERIES STATEMENTS.  INPUT AND OUTPUT CLAUSES
001400*    ARE USED IN SERIES TOGETHER AND SEPARATELY.  SEVERAL FILES
001500*    ARE CREATED AND PROCESSED ON BOTH TAPE AND MASS STORAGE.
001600 ENVIRONMENT DIVISION.
001700 CONFIGURATION SECTION.
001800 SOURCE-COMPUTER.
001900     XXXXX082.
002000 OBJECT-COMPUTER.
002100     XXXXX083.
002200 INPUT-OUTPUT SECTION.
002300 FILE-CONTROL.
002400P    SELECT RAW-DATA   ASSIGN TO
002500P    XXXXX062
002600P           ORGANIZATION IS INDEXED
002700P           ACCESS MODE IS RANDOM
002800P           RECORD KEY IS RAW-DATA-KEY.
002900     SELECT PRINT-FILE ASSIGN TO
003000     XXXXX055.
003100     SELECT SQ-FS1 ASSIGN TO
003200     XXXXX001.
003300     SELECT SQ-FS2 ASSIGN TO
003400     XXXXX014.
003500     SELECT SQ-FS3 ASSIGN TO
003600     XXXXX015.
003700 DATA DIVISION.
003800 FILE SECTION.
003900P
004000PFD  RAW-DATA.
004100P
004200P01  RAW-DATA-SATZ.
004300P    05  RAW-DATA-KEY        PIC X(6).
004400P    05  C-DATE              PIC 9(6).
004500P    05  C-TIME              PIC 9(8).
004600P    05  C-NO-OF-TESTS       PIC 99.
004700P    05  C-OK                PIC 999.
004800P    05  C-ALL               PIC 999.
004900P    05  C-FAIL              PIC 999.
005000P    05  C-DELETED           PIC 999.
005100P    05  C-INSPECT           PIC 999.
005200P    05  C-NOTE              PIC X(13).
005300P    05  C-INDENT            PIC X.
005400P    05  C-ABORT             PIC X(8).
005500 FD  PRINT-FILE
005600C    LABEL RECORDS
005700C    XXXXX084
005800C    DATA RECORD IS PRINT-REC DUMMY-RECORD
005900               .
006000 01  PRINT-REC PICTURE X(120).
006100 01  DUMMY-RECORD PICTURE X(120).
006200 FD  SQ-FS1
006300C    LABEL RECORD STANDARD
006400     DATA RECORD IS SQ-FS1R1-F-G-120.
006500 01  SQ-FS1R1-F-G-120 PIC X(120).
006600 FD  SQ-FS2
006700C    LABEL RECORD STANDARD
006800     BLOCK CONTAINS 10 RECORDS
006900     DATA RECORD IS SQ-FS2R1-F-G-120.
007000 01  SQ-FS2R1-F-G-120 PIC X(120).
007100 FD  SQ-FS3
007200     LABEL RECORD STANDARD
007300     BLOCK 120 CHARACTERS
007400     DATA RECORD IS SQ-FS3R1-F-G-120.
007500 01  SQ-FS3R1-F-G-120 PIC X(120).
007600 WORKING-STORAGE SECTION.
007700 01  COUNT-OF-RECS PIC 9999.
007800 01  FILE-RECORD-INFORMATION-REC.
007900     03 FILE-RECORD-INFO-SKELETON.
008000        05 FILLER                 PICTURE X(48)       VALUE
008100             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
008200        05 FILLER                 PICTURE X(46)       VALUE
008300             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
008400        05 FILLER                 PICTURE X(26)       VALUE
008500             ",LFIL=000000,ORG=  ,LBLR= ".
008600        05 FILLER                 PICTURE X(37)       VALUE
008700             ",RECKEY=                             ".
008800        05 FILLER                 PICTURE X(38)       VALUE
008900             ",ALTKEY1=                             ".
009000        05 FILLER                 PICTURE X(38)       VALUE
009100             ",ALTKEY2=                             ".
009200        05 FILLER                 PICTURE X(7)        VALUE SPACE.
009300     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
009400        05 FILE-RECORD-INFO-P1-120.
009500           07 FILLER              PIC X(5).
009600           07 XFILE-NAME           PIC X(6).
009700           07 FILLER              PIC X(8).
009800           07 XRECORD-NAME         PIC X(6).
009900           07 FILLER              PIC X(1).
010000           07 REELUNIT-NUMBER     PIC 9(1).
010100           07 FILLER              PIC X(7).
010200           07 XRECORD-NUMBER       PIC 9(6).
010300           07 FILLER              PIC X(6).
010400           07 UPDATE-NUMBER       PIC 9(2).
010500           07 FILLER              PIC X(5).
010600           07 ODO-NUMBER          PIC 9(4).
010700           07 FILLER              PIC X(5).
010800           07 XPROGRAM-NAME        PIC X(5).
010900           07 FILLER              PIC X(7).
011000           07 XRECORD-LENGTH       PIC 9(6).
011100           07 FILLER              PIC X(7).
011200           07 CHARS-OR-RECORDS    PIC X(2).
011300           07 FILLER              PIC X(1).
011400           07 XBLOCK-SIZE          PIC 9(4).
011500           07 FILLER              PIC X(6).
011600           07 RECORDS-IN-FILE     PIC 9(6).
011700           07 FILLER              PIC X(5).
011800           07 XFILE-ORGANIZATION   PIC X(2).
011900           07 FILLER              PIC X(6).
012000           07 XLABEL-TYPE          PIC X(1).
012100        05 FILE-RECORD-INFO-P121-240.
012200           07 FILLER              PIC X(8).
012300           07 XRECORD-KEY          PIC X(29).
012400           07 FILLER              PIC X(9).
012500           07 ALTERNATE-KEY1      PIC X(29).
012600           07 FILLER              PIC X(9).
012700           07 ALTERNATE-KEY2      PIC X(29).
012800           07 FILLER              PIC X(7).
012900 01  TEST-RESULTS.
013000     02 FILLER                    PICTURE X VALUE SPACE.
013100     02 FEATURE                   PICTURE X(20) VALUE SPACE.
013200     02 FILLER                    PICTURE X VALUE SPACE.
013300     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
013400     02 FILLER                    PICTURE X  VALUE SPACE.
013500     02  PAR-NAME.
013600       03 FILLER PICTURE X(12) VALUE SPACE.
013700       03  PARDOT-X PICTURE X  VALUE SPACE.
013800       03 DOTVALUE PICTURE 99  VALUE ZERO.
013900       03 FILLER PIC X(5) VALUE SPACE.
014000     02 FILLER PIC X(10) VALUE SPACE.
014100     02 RE-MARK PIC X(61).
014200 01  TEST-COMPUTED.
014300     02 FILLER PIC X(30) VALUE SPACE.
014400     02 FILLER PIC X(17) VALUE "       COMPUTED=".
014500     02 COMPUTED-X.
014600     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
014700     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
014800     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
014900     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
015000     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
015100     03       CM-18V0 REDEFINES COMPUTED-A.
015200         04 COMPUTED-18V0                   PICTURE -9(18).
015300         04 FILLER                          PICTURE X.
015400     03 FILLER PIC X(50) VALUE SPACE.
015500 01  TEST-CORRECT.
015600     02 FILLER PIC X(30) VALUE SPACE.
015700     02 FILLER PIC X(17) VALUE "       CORRECT =".
015800     02 CORRECT-X.
015900     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
016000     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
016100     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
016200     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
016300     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
016400     03      CR-18V0 REDEFINES CORRECT-A.
016500         04 CORRECT-18V0                    PICTURE -9(18).
016600         04 FILLER                          PICTURE X.
016700     03 FILLER PIC X(50) VALUE SPACE.
016800 01  CCVS-C-1.
016900     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
017000-    "SS  PARAGRAPH-NAME
017100-    "        REMARKS".
017200     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
017300 01  CCVS-C-2.
017400     02 FILLER PICTURE IS X VALUE IS SPACE.
017500     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
017600     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
017700     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
017800     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
017900 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
018000 01  REC-CT PICTURE 99 VALUE ZERO.
018100 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
018200 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
018300 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
018400 01  PASS-COUNTER PIC 999 VALUE ZERO.
018500 01  TOTAL-ERROR PIC 999 VALUE ZERO.
018600 01  ERROR-HOLD PIC 999 VALUE ZERO.
018700 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
018800 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
018900 01  CCVS-H-1.
019000     02  FILLER   PICTURE X(27)  VALUE SPACE.
019100     02 FILLER PICTURE X(67) VALUE
019200     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
019300-    " SYSTEM".
019400     02  FILLER     PICTURE X(26)  VALUE SPACE.
019500 01  CCVS-H-2.
019600     02 FILLER PICTURE X(52) VALUE IS
019700     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
019800     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
019900     02 TEST-ID PICTURE IS X(9).
020000     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
020100 01  CCVS-H-3.
020200     02  FILLER PICTURE X(34) VALUE
020300     " FOR OFFICIAL USE ONLY    ".
020400     02  FILLER PICTURE X(58) VALUE
020500     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
020600     02  FILLER PICTURE X(28) VALUE
020700     "  COPYRIGHT   1985 ".
020800 01  CCVS-E-1.
020900     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
021000     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
021100     02 ID-AGAIN PICTURE IS X(9).
021200     02 FILLER PICTURE X(45) VALUE IS
021300     " NTIS DISTRIBUTION COBOL 85".
021400 01  CCVS-E-2.
021500     02  FILLER                   PICTURE X(31)  VALUE
021600     SPACE.
021700     02  FILLER                   PICTURE X(21)  VALUE SPACE.
021800     02 CCVS-E-2-2.
021900         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
022000         03 FILLER PICTURE IS X VALUE IS SPACE.
022100         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
022200 01  CCVS-E-3.
022300     02  FILLER PICTURE X(22) VALUE
022400     " FOR OFFICIAL USE ONLY".
022500     02  FILLER PICTURE X(12) VALUE SPACE.
022600     02  FILLER PICTURE X(58) VALUE
022700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
022800     02  FILLER PICTURE X(13) VALUE SPACE.
022900     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
023000 01  CCVS-E-4.
023100     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
023200     02 FILLER PIC XXXX VALUE " OF ".
023300     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
023400     02 FILLER PIC X(40) VALUE
023500      "  TESTS WERE EXECUTED SUCCESSFULLY".
023600 01  XXINFO.
023700     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
023800     02 INFO-TEXT.
023900     04 FILLER PIC X(20) VALUE SPACE.
024000     04 XXCOMPUTED PIC X(20).
024100     04 FILLER PIC X(5) VALUE SPACE.
024200     04 XXCORRECT PIC X(20).
024300 01  HYPHEN-LINE.
024400     02 FILLER PICTURE IS X VALUE IS SPACE.
024500     02 FILLER PICTURE IS X(65) VALUE IS "************************
024600-    "*****************************************".
024700     02 FILLER PICTURE IS X(54) VALUE IS "************************
024800-    "******************************".
024900 01  CCVS-PGM-ID PIC X(6) VALUE
025000     "SQ128A".
025100 PROCEDURE DIVISION.
025200 CCVS1 SECTION.
025300 OPEN-FILES.
025400P    OPEN I-O RAW-DATA.
025500P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
025600P    READ RAW-DATA INVALID KEY GO TO END-E-1.
025700P    MOVE "ABORTED " TO C-ABORT.
025800P    ADD 1 TO C-NO-OF-TESTS.
025900P    ACCEPT C-DATE  FROM DATE.
026000P    ACCEPT C-TIME  FROM TIME.
026100P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
026200PEND-E-1.
026300P    CLOSE RAW-DATA.
026400     OPEN     OUTPUT PRINT-FILE.
026500     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
026600     MOVE    SPACE TO TEST-RESULTS.
026700     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
026800     MOVE ZERO TO REC-SKL-SUB.
026900     PERFORM CCVS-INIT-FILE 9 TIMES.
027000 CCVS-INIT-FILE.
027100     ADD 1 TO REC-SKL-SUB.
027200     MOVE FILE-RECORD-INFO-SKELETON TO
027300                  FILE-RECORD-INFO (REC-SKL-SUB).
027400 CCVS-INIT-EXIT.
027500     GO TO CCVS1-EXIT.
027600 CLOSE-FILES.
027700     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
027800P    OPEN I-O RAW-DATA.
027900P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
028000P    READ RAW-DATA INVALID KEY GO TO END-E-2.
028100P    MOVE "OK.     " TO C-ABORT.
028200P    MOVE PASS-COUNTER TO C-OK.
028300P    MOVE ERROR-HOLD   TO C-ALL.
028400P    MOVE ERROR-COUNTER TO C-FAIL.
028500P    MOVE DELETE-CNT TO C-DELETED.
028600P    MOVE INSPECT-COUNTER TO C-INSPECT.
028700P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
028800PEND-E-2.
028900P    CLOSE RAW-DATA.
029000 TERMINATE-CCVS.
029100S    EXIT PROGRAM.
029200STERMINATE-CALL.
029300     STOP     RUN.
029400 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
029500 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
029600 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
029700 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
029800     MOVE "****TEST DELETED****" TO RE-MARK.
029900 PRINT-DETAIL.
030000     IF REC-CT NOT EQUAL TO ZERO
030100             MOVE "." TO PARDOT-X
030200             MOVE REC-CT TO DOTVALUE.
030300     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
030400     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
030500        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
030600          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
030700     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
030800     MOVE SPACE TO CORRECT-X.
030900     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
031000     MOVE     SPACE TO RE-MARK.
031100 HEAD-ROUTINE.
031200     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031300     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
031400     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
031500 COLUMN-NAMES-ROUTINE.
031600     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031700     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
031900 END-ROUTINE.
032000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
032100 END-RTN-EXIT.
032200     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032300 END-ROUTINE-1.
032400      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
032500      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
032600      ADD PASS-COUNTER TO ERROR-HOLD.
032700*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
032800      MOVE PASS-COUNTER TO CCVS-E-4-1.
032900      MOVE ERROR-HOLD TO CCVS-E-4-2.
033000      MOVE CCVS-E-4 TO CCVS-E-2-2.
033100      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
033200  END-ROUTINE-12.
033300      MOVE "TEST(S) FAILED" TO ENDER-DESC.
033400     IF       ERROR-COUNTER IS EQUAL TO ZERO
033500         MOVE "NO " TO ERROR-TOTAL
033600         ELSE
033700         MOVE ERROR-COUNTER TO ERROR-TOTAL.
033800     MOVE     CCVS-E-2 TO DUMMY-RECORD.
033900     PERFORM WRITE-LINE.
034000 END-ROUTINE-13.
034100     IF DELETE-CNT IS EQUAL TO ZERO
034200         MOVE "NO " TO ERROR-TOTAL  ELSE
034300         MOVE DELETE-CNT TO ERROR-TOTAL.
034400     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
034500     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034600      IF   INSPECT-COUNTER EQUAL TO ZERO
034700          MOVE "NO " TO ERROR-TOTAL
034800      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
034900      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
035000      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035100     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035200 WRITE-LINE.
035300     ADD 1 TO RECORD-COUNT.
035400Y    IF RECORD-COUNT GREATER 50
035500Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
035600Y        MOVE SPACE TO DUMMY-RECORD
035700Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
035800Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
035900Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
036000Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
036100Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
036200Y        MOVE ZERO TO RECORD-COUNT.
036300     PERFORM WRT-LN.
036400 WRT-LN.
036500     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
036600     MOVE SPACE TO DUMMY-RECORD.
036700 BLANK-LINE-PRINT.
036800     PERFORM WRT-LN.
036900 FAIL-ROUTINE.
037000     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
037100     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
037200     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
037300     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037400     GO TO FAIL-ROUTINE-EX.
037500 FAIL-ROUTINE-WRITE.
037600     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
037700     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
037800 FAIL-ROUTINE-EX. EXIT.
037900 BAIL-OUT.
038000     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
038100     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
038200 BAIL-OUT-WRITE.
038300     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
038400     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038500 BAIL-OUT-EX. EXIT.
038600 CCVS1-EXIT.
038700     EXIT.
038800 SECT-SQ128A-0001 SECTION.
038900 OPEN-INIT-GF-01.
039000     MOVE "SQ-FS1" TO XFILE-NAME (1).
039100     MOVE "SQ-FS2" TO XFILE-NAME (2).
039200     MOVE "SQ-FS3" TO XFILE-NAME (3).
039300     MOVE "R1-F-G" TO XRECORD-NAME (1)
039400                      XRECORD-NAME (2)
039500                      XRECORD-NAME (3).
039600     MOVE "SQ128A" TO XPROGRAM-NAME (1)
039700                     XPROGRAM-NAME (2)
039800                     XPROGRAM-NAME (3).
039900     MOVE 000120 TO XRECORD-LENGTH (1)
040000                    XRECORD-LENGTH (2)
040100                    XRECORD-LENGTH (3).
040200     MOVE "RC" TO CHARS-OR-RECORDS (1)
040300                  CHARS-OR-RECORDS (2).
040400     MOVE "CH" TO CHARS-OR-RECORDS (3).
040500     MOVE 0001 TO XBLOCK-SIZE (1).
040600     MOVE 0010 TO XBLOCK-SIZE (2).
040700     MOVE 0120 TO XBLOCK-SIZE (3).
040800     MOVE 0750 TO RECORDS-IN-FILE (1)
040900                  RECORDS-IN-FILE (2)
041000                  RECORDS-IN-FILE (3).
041100     MOVE "SQ" TO XFILE-ORGANIZATION (1)
041200                  XFILE-ORGANIZATION (2)
041300                  XFILE-ORGANIZATION (3).
041400     MOVE "S"  TO XLABEL-TYPE (1)
041500                  XLABEL-TYPE (2)
041600                  XLABEL-TYPE (3).
041700 OPN-TEST-GF-01.
041800     OPEN OUTPUT SQ-FS1
041900                 SQ-FS2.
042000     MOVE 00001 TO XRECORD-NUMBER (1)
042100                   XRECORD-NUMBER (2).
042200 OPN-TEST-GF-01-1.
042300     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-FS1R1-F-G-120.
042400     MOVE FILE-RECORD-INFO-P1-120 (2) TO SQ-FS2R1-F-G-120.
042500     WRITE SQ-FS1R1-F-G-120.
042600     WRITE SQ-FS2R1-F-G-120.
042700     IF XRECORD-NUMBER (1) EQUAL TO 750
042800              GO TO OPN-WRITE-GF-01.
042900     ADD 1 TO XRECORD-NUMBER (1).
043000     ADD 1 TO XRECORD-NUMBER (2).
043100     GO TO OPN-TEST-GF-01-1.
043200 OPN-WRITE-GF-01.
043300     MOVE "OPEN OUT  1 & 2 " TO FEATURE.
043400     MOVE "OPN-TEST-GF-01" TO PAR-NAME.
043500     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
043600     MOVE XRECORD-NUMBER (1) TO CORRECT-18V0.
043700     PERFORM PRINT-DETAIL.
043800     PERFORM PASS.
043900     MOVE "OPN-TEST-GF-02" TO PAR-NAME.
044000     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
044100     MOVE XRECORD-NUMBER (2) TO CORRECT-18V0.
044200     PERFORM PRINT-DETAIL.
044300 CLOSE-INIT-GF-01.
044400*             THIS TEST CLOSES THE TWO OUTPUT FILES FROM
044500*             SEQ-TEST-001 WITH ONE CLOSE STATEMENT.
044600     CLOSE SQ-FS1,
044700           SQ-FS2.
044800 CLOSE-WRITE-GF-01.
044900     MOVE "CLOSE FILE 1 & 2 " TO FEATURE.
045000     MOVE "CLOSE-TEST-GF-01" TO PAR-NAME.
045100     MOVE SPACES TO CORRECT-A.
045200     PERFORM PASS.
045300     PERFORM PRINT-DETAIL.
045400 OPEN-TEST-GF-02.
045500*             THIS TEST OPENS FOR INPUT THE TWO FILES CREATED IN
045600*             SEQ-TEST-001.
045700     OPEN INPUT SQ-FS1,
045800                SQ-FS2.
045900     MOVE "OPEN INPUT 1 & 2" TO FEATURE.
046000     MOVE "OPEN-TEST-GF-02" TO PAR-NAME.
046100     PERFORM PASS.
046200     PERFORM PRINT-DETAIL.
046300 READ-TEST-F1-01.
046400*             THIS PART OF THE TEST READS AND VALIDATES ONE
046500*             RECORD FROM FILES SQ-FS1 AND SQ-FS2.
046600     READ SQ-FS1 AT END GO TO READ-FAIL-F1-01.
046700     MOVE SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
046800     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS1"
046900              GO TO READ-FAIL-F1-01.
047000     IF XRECORD-NUMBER (1) NOT EQUAL TO 1
047100              GO TO READ-FAIL-F1-01.
047200     GO TO READ-PASS-F1-01.
047300 READ-FAIL-F1-01.
047400     MOVE "ERRORS IN READING SQ-FS1; VII-44, 4.4.2   " TO RE-MARK.
047500     PERFORM FAIL.
047600     GO TO READ-WRITE-F1-01.
047700 READ-PASS-F1-01.
047800     PERFORM PASS.
047900     MOVE "FIRST RECORD IS VALID" TO RE-MARK.
048000 READ-WRITE-F1-01.
048100     MOVE "READ-TEST-F1-01" TO PAR-NAME.
048200     MOVE "VERIFY FILE SQ-FS1" TO FEATURE.
048300     PERFORM PRINT-DETAIL.
048400 READ-TEST-F1-02.
048500     READ SQ-FS2 AT END GO TO READ-FAIL-F1-02.
048600     MOVE SQ-FS2R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (2).
048700     IF XFILE-NAME (2) NOT EQUAL TO "SQ-FS2"
048800              GO TO READ-FAIL-F1-02.
048900     IF XRECORD-NUMBER (2) NOT EQUAL TO 1
049000              GO TO READ-FAIL-F1-02.
049100     GO TO READ-PASS-F1-02.
049200 READ-FAIL-F1-02.
049300     MOVE "ERRORS IN READING SQ-FS2; VII-44, 4.4.2   " TO RE-MARK.
049400     PERFORM FAIL.
049500     GO TO READ-WRITE-F1-02.
049600 READ-PASS-F1-02.
049700     PERFORM PASS.
049800     MOVE "FIRST RECORD IS VALID" TO RE-MARK.
049900 READ-WRITE-F1-02.
050000     MOVE "READ-TEST-F1"  TO PAR-NAME.
050100     MOVE "VERIFY FILE SQ-FS2" TO FEATURE.
050200     PERFORM PRINT-DETAIL.
050300 OPEN-INIT-03.
050400     CLOSE SQ-FS1.
050500 OPEN-TEST-GF-03.
050600*             THIS TEST OPENS A FILE FOR INPUT AND A FILE FOR
050700*             OUTPUT WITH THE SAME OPEN STATEMENT.
050800     OPEN INPUT SQ-FS1
050900          OUTPUT SQ-FS3.
051000     MOVE 00001 TO XRECORD-NUMBER (3).
051100 OPEN-TEST-GF-03-1.
051200     MOVE FILE-RECORD-INFO-P1-120 (3) TO SQ-FS3R1-F-G-120.
051300     WRITE SQ-FS3R1-F-G-120.
051400     IF XRECORD-NUMBER (3) EQUAL TO 750
051500              GO TO OPEN-WRITE-GF-03.
051600     ADD 1 TO XRECORD-NUMBER (3).
051700     GO TO OPEN-TEST-GF-03-1.
051800 OPEN-WRITE-GF-03.
051900     MOVE "OPEN FILE SQ-FS3" TO FEATURE.
052000     MOVE "OPEN-TEST-GF-03" TO PAR-NAME.
052100     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
052200     MOVE XRECORD-NUMBER (3) TO CORRECT-18V0.
052300     PERFORM PASS.
052400     PERFORM PRINT-DETAIL.
052500 CLOSE-TEST-02.
052600*             THIS TEST CLOSES ONE OUTPUT FILE AND TWO INPUT FILES
052700*             WITH ONE CLOSE STATEMENT.
052800     CLOSE SQ-FS1,
052900           SQ-FS2,
053000           SQ-FS3.
053100 CLOSE-WRITE-02.
053200     MOVE "CLOSE FILE SQ-FS1" TO FEATURE.
053300     MOVE "CLOSE-TEST-02 " TO PAR-NAME.
053400     MOVE SPACES TO CORRECT-A.
053500     PERFORM PASS.
053600     PERFORM PRINT-DETAIL.
053700     MOVE "CLOSE FILE SQ-FS2" TO FEATURE.
053800     MOVE "CLOSE-TEST-02 " TO PAR-NAME.
053900     PERFORM PASS.
054000     PERFORM PRINT-DETAIL.
054100     MOVE "CLOSE FILE SQ-FS3" TO FEATURE.
054200     MOVE "CLOSE-TEST-02 " TO PAR-NAME.
054300     PERFORM PASS.
054400     PERFORM PRINT-DETAIL.
054500 SQ128A-END-ROUTINE.
054600     MOVE " END OF SQ128A VALIDATION TESTS" TO PRINT-REC.
054700     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
054800 TERMINATE-SQ128A.
054900     EXIT.
055000 CCVS-EXIT SECTION.
055100 CCVS-999999.
055200     GO TO CLOSE-FILES.
