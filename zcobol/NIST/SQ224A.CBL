000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ224A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200*        THIS ROUTINE CHECKS:
001300*
001400*           RECORD IS VARYING IN SIZE FROM 18 TO 2048 CHARACTERS
001500*             DEPENDING ON DATA-NAME-1.
001600*
001700*    THE WRITE STATEMENT IS USED WITH AND WITHOUT THE INTO CLAUSE.
001800*
001900*    THE READ STATEMENT IS USED WITH AND WITHOUT THE INTO CLAUSE.
002000*
002100*    THIS  ROUTINE  BUILDS  A  SEQUENTIAL MASS STORAGE FILE WHICH
002200*    CONTAINS  2031 RECORDS OF A LENGTH OF 18 TO 2048 CHARACTERS.
002300*    THE  MASS STORAGE FILE IS READ AND FIELDS IN THE RECORDS ARE
002400*    CHECKED AGAINST THE EXPECTED VALUES.
002500*
002600 ENVIRONMENT DIVISION.
002700 CONFIGURATION SECTION.
002800 SOURCE-COMPUTER.
002900     XXXXX082.
003000 OBJECT-COMPUTER.
003100     XXXXX083.
003200 INPUT-OUTPUT SECTION.
003300 FILE-CONTROL.
003400P    SELECT RAW-DATA   ASSIGN TO
003500P    XXXXX062
003600P           ORGANIZATION IS INDEXED
003700P           ACCESS MODE IS RANDOM
003800P           RECORD KEY IS RAW-DATA-KEY.
003900     SELECT PRINT-FILE ASSIGN TO
004000     XXXXX055.
004100     SELECT SQ-VS7 ASSIGN TO
004200     XXXXX014
004300     ORGANIZATION SEQUENTIAL
004400     ACCESS SEQUENTIAL.
004500 DATA DIVISION.
004600 FILE SECTION.
004700PFD  RAW-DATA.
004800P
004900P01  RAW-DATA-SATZ.
005000P    05  RAW-DATA-KEY        PIC X(6).
005100P    05  C-DATE              PIC 9(6).
005200P    05  C-TIME              PIC 9(8).
005300P    05  C-NO-OF-TESTS       PIC 99.
005400P    05  C-OK                PIC 999.
005500P    05  C-ALL               PIC 999.
005600P    05  C-FAIL              PIC 999.
005700P    05  C-DELETED           PIC 999.
005800P    05  C-INSPECT           PIC 999.
005900P    05  C-NOTE              PIC X(13).
006000P    05  C-INDENT            PIC X.
006100P    05  C-ABORT             PIC X(8).
006200 FD  PRINT-FILE
006300C    LABEL RECORDS
006400C    XXXXX084
006500C    DATA RECORD IS PRINT-REC DUMMY-RECORD
006600               .
006700 01  PRINT-REC PICTURE X(120).
006800 01  DUMMY-RECORD PICTURE X(120).
006900 FD  SQ-VS7
007000C    LABEL RECORDS ARE STANDARD
007100     RECORD IS VARYING IN SIZE FROM 18 TO 2048 CHARACTERS
007200       DEPENDING ON RECORD-LENGTH.
007300 01  SQ-VSR7R1-M-G-2048.
007400     02  SQ-VS7R1-FIRST PICTURE X(2048).
007500 WORKING-STORAGE SECTION.
007600 01  RECORD-LENGTH       PICTURE 9999 VALUE ZERO.
007700 01  SAVE-COUNT-OF-RECS  PICTURE X(5) VALUE SPACE.
007800 01  COUNT-OF-RECS  PICTURE S9(4) COMPUTATIONAL.
007900 01  RECORDS-IN-ERROR  PICTURE S9(4) COMPUTATIONAL.
008000 01  ERROR-FLAG PICTURE 9.
008100 01  EOF-FLAG  PICTURE 9.
008200 01  DUMP-AREA.
008300     02  TYPE-OF-REC PICTURE X(5).
008400     02  RECNO  PICTURE 9(5).
008500     02  REC-FILLER PICTURE X(21).
008600 01  VAR-RECORD-18-2048.
008700     05  FILLER PIC X(13) VALUE "SQ-VS7LENGTH=".
008800     05  RECORD-NUMBER PIC 9999 VALUE ZERO.
008900     05  FILLER      PIC X(100) VALUE
009000     "........10........20........30........40........50........60
009100-    "........70........80........90.......100".
009200     05  FILLER      PIC X(100) VALUE
009300     ".......110.......120.......130.......140.......150.......160
009400-    ".......170.......180.......190.......200".
009500     05  FILLER      PIC X(100) VALUE
009600     ".......210.......220.......230.......240.......250.......260
009700-    ".......270.......280.......290.......300".
009800     05  FILLER      PIC X(100) VALUE
009900     ".......310.......320.......330.......340.......350.......360
010000-    ".......370.......380.......390.......400".
010100     05  FILLER      PIC X(100) VALUE
010200     ".......410.......420.......430.......440.......450.......460
010300-    ".......470.......480.......490.......500".
010400     05  FILLER      PIC X(100) VALUE
010500     ".......510.......520.......530.......540.......550.......560
010600-    ".......570.......580.......590.......600".
010700     05  FILLER      PIC X(100) VALUE
010800     ".......610.......620.......630.......640.......650.......660
010900-    ".......670.......680.......690.......700".
011000     05  FILLER      PIC X(100) VALUE
011100     ".......710.......720.......730.......740.......750.......760
011200-    ".......770.......780.......790.......800".
011300     05  FILLER      PIC X(100) VALUE
011400     ".......810.......820.......830.......840.......850.......860
011500-    ".......870.......880.......890.......900".
011600     05  FILLER      PIC X(100) VALUE
011700     ".......910.......920.......930.......940.......950.......960
011800-    ".......970.......980.......990......1000".
011900     05  FILLER      PIC X(100) VALUE
012000     "......1010......1020......1030......1040......1050......1060
012100-    "......1070......1080......1090......1100".
012200     05  FILLER      PIC X(100) VALUE
012300     "......1110......1120......1130......1140......1150......1160
012400-    "......1170......1180......1190......1200".
012500     05  FILLER      PIC X(100) VALUE
012600     "......1210......1220......1230......1240......1250......1260
012700-    ".......270.......280.......290.......300".
012800     05  FILLER      PIC X(100) VALUE
012900     "......1310......1320......1330......1340......1350......1360
013000-    "......1370......1380......1390......1400".
013100     05  FILLER      PIC X(100) VALUE
013200     "......1410......1420......1430......1440......1450......1460
013300-    "......1470......1480......1490......1500".
013400     05  FILLER      PIC X(100) VALUE
013500     "......1510......1520......1530......1540......1550......1560
013600-    "......1570......1580......1590......1600".
013700     05  FILLER      PIC X(100) VALUE
013800     "......1610......1620......1630......1640......1650......1660
013900-    "......1670......1680......1690......1700".
014000     05  FILLER      PIC X(100) VALUE
014100     "......1710......1720......1730......1740......1750......1760
014200-    "......1770......1780......1790......1800".
014300     05  FILLER      PIC X(100) VALUE
014400     "......1810......1820......1830......1840......1850......1860
014500-    "......1870......1880......1890......1900".
014600     05  FILLER      PIC X(100) VALUE
014700     "......1910......1920......1930......1940......1950......1960
014800-    "......1970......1980......1990......2000".
014900     05  FILLER      PIC X(048) VALUE
015000     "......2010......2020......2030......2040....,...".
015100 01  TEST-RESULTS.
015200     02 FILLER                    PICTURE X VALUE SPACE.
015300     02 FEATURE                   PICTURE X(20) VALUE SPACE.
015400     02 FILLER                    PICTURE X VALUE SPACE.
015500     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
015600     02 FILLER                    PICTURE X  VALUE SPACE.
015700     02  PAR-NAME.
015800       03 FILLER PICTURE X(12) VALUE SPACE.
015900       03  PARDOT-X PICTURE X  VALUE SPACE.
016000       03 DOTVALUE PICTURE 99  VALUE ZERO.
016100       03 FILLER PIC X(5) VALUE SPACE.
016200     02 FILLER PIC X(10) VALUE SPACE.
016300     02 RE-MARK PIC X(61).
016400 01  TEST-COMPUTED.
016500     02 FILLER PIC X(30) VALUE SPACE.
016600     02 FILLER PIC X(17) VALUE "       COMPUTED=".
016700     02 COMPUTED-X.
016800     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
016900     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
017000     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
017100     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
017200     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
017300     03       CM-18V0 REDEFINES COMPUTED-A.
017400         04 COMPUTED-18V0                   PICTURE -9(18).
017500         04 FILLER                          PICTURE X.
017600     03 FILLER PIC X(50) VALUE SPACE.
017700 01  TEST-CORRECT.
017800     02 FILLER PIC X(30) VALUE SPACE.
017900     02 FILLER PIC X(17) VALUE "       CORRECT =".
018000     02 CORRECT-X.
018100     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
018200     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
018300     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
018400     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
018500     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
018600     03      CR-18V0 REDEFINES CORRECT-A.
018700         04 CORRECT-18V0                    PICTURE -9(18).
018800         04 FILLER                          PICTURE X.
018900     03 FILLER PIC X(50) VALUE SPACE.
019000 01  CCVS-C-1.
019100     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
019200-    "SS  PARAGRAPH-NAME
019300-    "        REMARKS".
019400     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
019500 01  CCVS-C-2.
019600     02 FILLER PICTURE IS X VALUE IS SPACE.
019700     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
019800     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
019900     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
020000     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
020100 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
020200 01  REC-CT PICTURE 99 VALUE ZERO.
020300 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
020400 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
020500 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
020600 01  PASS-COUNTER PIC 999 VALUE ZERO.
020700 01  TOTAL-ERROR PIC 999 VALUE ZERO.
020800 01  ERROR-HOLD PIC 999 VALUE ZERO.
020900 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
021000 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
021100 01  CCVS-H-1.
021200     02  FILLER   PICTURE X(27)  VALUE SPACE.
021300     02 FILLER PICTURE X(67) VALUE
021400     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
021500-    " SYSTEM".
021600     02  FILLER     PICTURE X(26)  VALUE SPACE.
021700 01  CCVS-H-2.
021800     02 FILLER PICTURE X(52) VALUE IS
021900     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
022000     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
022100     02 TEST-ID PICTURE IS X(9).
022200     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
022300 01  CCVS-H-3.
022400     02  FILLER PICTURE X(34) VALUE
022500     " FOR OFFICIAL USE ONLY    ".
022600     02  FILLER PICTURE X(58) VALUE
022700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022800     02  FILLER PICTURE X(28) VALUE
022900     "  COPYRIGHT   1985 ".
023000 01  CCVS-E-1.
023100     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
023200     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
023300     02 ID-AGAIN PICTURE IS X(9).
023400     02 FILLER PICTURE X(45) VALUE IS
023500     " NTIS DISTRIBUTION COBOL 85".
023600 01  CCVS-E-2.
023700     02  FILLER                   PICTURE X(31)  VALUE
023800     SPACE.
023900     02  FILLER                   PICTURE X(21)  VALUE SPACE.
024000     02 CCVS-E-2-2.
024100         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
024200         03 FILLER PICTURE IS X VALUE IS SPACE.
024300         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
024400 01  CCVS-E-3.
024500     02  FILLER PICTURE X(22) VALUE
024600     " FOR OFFICIAL USE ONLY".
024700     02  FILLER PICTURE X(12) VALUE SPACE.
024800     02  FILLER PICTURE X(58) VALUE
024900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025000     02  FILLER PICTURE X(13) VALUE SPACE.
025100     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
025200 01  CCVS-E-4.
025300     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
025400     02 FILLER PIC XXXX VALUE " OF ".
025500     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
025600     02 FILLER PIC X(40) VALUE
025700      "  TESTS WERE EXECUTED SUCCESSFULLY".
025800 01  XXINFO.
025900     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
026000     02 INFO-TEXT.
026100     04 FILLER PIC X(20) VALUE SPACE.
026200     04 XXCOMPUTED PIC X(20).
026300     04 FILLER PIC X(5) VALUE SPACE.
026400     04 XXCORRECT PIC X(20).
026500 01  HYPHEN-LINE.
026600     02 FILLER PICTURE IS X VALUE IS SPACE.
026700     02 FILLER PICTURE IS X(65) VALUE IS "************************
026800-    "*****************************************".
026900     02 FILLER PICTURE IS X(54) VALUE IS "************************
027000-    "******************************".
027100 01  CCVS-PGM-ID PIC X(6) VALUE
027200     "SQ224A".
027300 PROCEDURE DIVISION.
027400 CCVS1 SECTION.
027500 OPEN-FILES.
027600P    OPEN I-O RAW-DATA.
027700P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
027800P    READ RAW-DATA INVALID KEY GO TO END-E-1.
027900P    MOVE "ABORTED " TO C-ABORT.
028000P    ADD 1 TO C-NO-OF-TESTS.
028100P    ACCEPT C-DATE  FROM DATE.
028200P    ACCEPT C-TIME  FROM TIME.
028300P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
028400PEND-E-1.
028500P    CLOSE RAW-DATA.
028600     OPEN     OUTPUT PRINT-FILE.
028700     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
028800     MOVE    SPACE TO TEST-RESULTS.
028900     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
029000     MOVE ZERO TO REC-SKL-SUB.
029100 CCVS-INIT-EXIT.
029200     GO TO CCVS1-EXIT.
029300 CLOSE-FILES.
029400     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
029500P    OPEN I-O RAW-DATA.
029600P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
029700P    READ RAW-DATA INVALID KEY GO TO END-E-2.
029800P    MOVE "OK.     " TO C-ABORT.
029900P    MOVE PASS-COUNTER TO C-OK.
030000P    MOVE ERROR-HOLD   TO C-ALL.
030100P    MOVE ERROR-COUNTER TO C-FAIL.
030200P    MOVE DELETE-CNT TO C-DELETED.
030300P    MOVE INSPECT-COUNTER TO C-INSPECT.
030400P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
030500PEND-E-2.
030600P    CLOSE RAW-DATA.
030700 TERMINATE-CCVS.
030800S    EXIT PROGRAM.
030900STERMINATE-CALL.
031000     STOP     RUN.
031100 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
031200 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
031300 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
031400 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
031500     MOVE "****TEST DELETED****" TO RE-MARK.
031600 PRINT-DETAIL.
031700     IF REC-CT NOT EQUAL TO ZERO
031800             MOVE "." TO PARDOT-X
031900             MOVE REC-CT TO DOTVALUE.
032000     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
032100     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
032200        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
032300          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
032400     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
032500     MOVE SPACE TO CORRECT-X.
032600     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
032700     MOVE     SPACE TO RE-MARK.
032800 HEAD-ROUTINE.
032900     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033000     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033100     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
033200 COLUMN-NAMES-ROUTINE.
033300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
033600 END-ROUTINE.
033700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033800 END-RTN-EXIT.
033900     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034000 END-ROUTINE-1.
034100      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
034200      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
034300      ADD PASS-COUNTER TO ERROR-HOLD.
034400*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
034500      MOVE PASS-COUNTER TO CCVS-E-4-1.
034600      MOVE ERROR-HOLD TO CCVS-E-4-2.
034700      MOVE CCVS-E-4 TO CCVS-E-2-2.
034800      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
034900  END-ROUTINE-12.
035000      MOVE "TEST(S) FAILED" TO ENDER-DESC.
035100     IF       ERROR-COUNTER IS EQUAL TO ZERO
035200         MOVE "NO " TO ERROR-TOTAL
035300         ELSE
035400         MOVE ERROR-COUNTER TO ERROR-TOTAL.
035500     MOVE     CCVS-E-2 TO DUMMY-RECORD.
035600     PERFORM WRITE-LINE.
035700 END-ROUTINE-13.
035800     IF DELETE-CNT IS EQUAL TO ZERO
035900         MOVE "NO " TO ERROR-TOTAL  ELSE
036000         MOVE DELETE-CNT TO ERROR-TOTAL.
036100     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
036200     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036300      IF   INSPECT-COUNTER EQUAL TO ZERO
036400          MOVE "NO " TO ERROR-TOTAL
036500      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
036600      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
036700      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036800     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036900 WRITE-LINE.
037000     ADD 1 TO RECORD-COUNT.
037100Y    IF RECORD-COUNT GREATER 50
037200Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
037300Y        MOVE SPACE TO DUMMY-RECORD
037400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
037500Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
037600Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
037700Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
037800Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
037900Y        MOVE ZERO TO RECORD-COUNT.
038000     PERFORM WRT-LN.
038100 WRT-LN.
038200     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
038300     MOVE SPACE TO DUMMY-RECORD.
038400 BLANK-LINE-PRINT.
038500     PERFORM WRT-LN.
038600 FAIL-ROUTINE.
038700     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
038800     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
038900     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
039000     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039100     GO TO FAIL-ROUTINE-EX.
039200 FAIL-ROUTINE-WRITE.
039300     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
039400     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
039500 FAIL-ROUTINE-EX. EXIT.
039600 BAIL-OUT.
039700     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
039800     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
039900 BAIL-OUT-WRITE.
040000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
040100     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040200 BAIL-OUT-EX. EXIT.
040300 CCVS1-EXIT.
040400     EXIT.
040500 SECT-SQ224A-0001 SECTION.
040600 WRITE-INIT-GF-01.
040700     MOVE ZERO TO COUNT-OF-RECS.
040800     MOVE 17   TO RECORD-LENGTH.
040900     OPEN OUTPUT SQ-VS7.
041000 WRITE-TEST-GF-01.
041100     PERFORM WRITE-RECORDS-1 1030 TIMES.
041200     PERFORM WRITE-RECORDS-2 1001 TIMES.
041300 WRITE-WRITE-GF-01.
041400     MOVE "CREATE FILE SQ-VS7" TO FEATURE.
041500     MOVE "WRITE-TEST-GF-01" TO PAR-NAME.
041600     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
041700     MOVE COUNT-OF-RECS TO CORRECT-18V0.
041800     MOVE "FILE HAS 18 THRU 2048 CHAR RECS" TO RE-MARK.
041900     PERFORM PRINT-DETAIL.
042000*        A SEQUENTIAL MASS STORAGE FILE CONTAINING 2031
042100*    RECORDS HAS BEEN CREATED.  THE FILE CONTAINS RECORDS
042200*    OF 18  THROUGH 2048 CHARACTERS BEGINNING WITH THE 18 CHAR REC
042300*    AND ENDING WITH THE 2048 CHAR REC.
042400*
042500 WRITE-CLOSE-GF-01.
042600     CLOSE SQ-VS7.
042700     GO TO READ-INIT-F1-01.
042800 WRITE-RECORDS-1.
042900******************************************************************
043000*   MOVE  ...  TO  OUTPUT-RECORD          1030 RECORDS           *
043100*   WRITE   OUTPUT-RECORD.                                       *
043200******************************************************************
043300     ADD 1 TO COUNT-OF-RECS.
043400     ADD 1 TO RECORD-LENGTH.
043500     MOVE COUNT-OF-RECS TO RECORD-NUMBER.
043600     MOVE VAR-RECORD-18-2048 TO SQ-VS7R1-FIRST.
043700     WRITE SQ-VSR7R1-M-G-2048.
043800 WRITE-RECORDS-2.
043900******************************************************************
044000*WRITE ...  FROM  ....  .                 1001 RECORDS           *
044100******************************************************************
044200     ADD 1 TO COUNT-OF-RECS.
044300     ADD 1 TO RECORD-LENGTH.
044400     MOVE COUNT-OF-RECS TO RECORD-NUMBER.
044500     WRITE SQ-VSR7R1-M-G-2048 FROM VAR-RECORD-18-2048.
044600 READ-INIT-F1-01.
044700     MOVE 17   TO RECORD-LENGTH.
044800     MOVE ZERO TO COUNT-OF-RECS.
044900     MOVE ZERO TO EOF-FLAG.
045000     MOVE ZERO TO RECORDS-IN-ERROR.
045100     MOVE ZERO TO ERROR-FLAG.
045200     OPEN INPUT SQ-VS7.
045300 READ-TEST-F1-01.
045400     PERFORM READ-REC-1 THRU READ-REC-1-EXIT 1030 TIMES.
045500     IF EOF-FLAG EQUAL TO 1
045600         MOVE "EOF ON FIRST READ" TO RE-MARK
045700         GO TO READ-EOF-F1-03.
045800     IF ERROR-FLAG EQUAL TO 1
045900         GO TO READ-FAIL-F1-01.
046000 READ-PASS-F1-01.
046100     PERFORM PASS.
046200     GO TO READ-WRITE-F1-01.
046300 READ-FAIL-F1-01.
046400     MOVE "ERROR:SEE VII-52 WRITE  OR VII-44 READ; VII-30 FORMAT
046500-         "RECORD VARYING . DEPENDING "           TO RE-MARK.
046600     PERFORM FAIL.
046700 READ-WRITE-F1-01.
046800     MOVE "READ 1030 RECORDS" TO FEATURE.
046900     MOVE "READ-TEST-F1-01" TO PAR-NAME.
047000     MOVE "EXPECTED RECORD LENGTH: 18 TO 1047" TO RE-MARK.
047100     MOVE RECORD-LENGTH TO COMPUTED-N.
047200     ADD 17 TO COUNT-OF-RECS.
047300     MOVE COUNT-OF-RECS  TO CORRECT-N.
047400     SUBTRACT 17 FROM COUNT-OF-RECS.
047500     PERFORM PRINT-DETAIL.
047600     GO TO READ-INIT-F1-02.
047700 READ-REC-1.
047800******************************************************************
047900*   READ      <FILE>     AT END ...                              *
048000******************************************************************
048100     IF EOF-FLAG EQUAL TO 1
048200         GO TO READ-REC-1-EXIT.
048300     READ SQ-VS7 AT END
048400         MOVE 1 TO EOF-FLAG
048500         GO TO READ-REC-1-EXIT.
048600     ADD 1 TO COUNT-OF-RECS.
048700     MOVE SQ-VS7R1-FIRST TO  VAR-RECORD-18-2048.
048800     ADD 17 TO COUNT-OF-RECS.
048900     IF  RECORD-LENGTH     NOT EQUAL TO COUNT-OF-RECS
049000         GO TO READ-REC-1-ERROR.
049100     SUBTRACT 17 FROM COUNT-OF-RECS.
049200     GO TO READ-REC-1-EXIT.
049300 READ-REC-1-ERROR.
049400     SUBTRACT 17 FROM COUNT-OF-RECS.
049500     ADD 1 TO RECORDS-IN-ERROR.
049600     MOVE 1 TO ERROR-FLAG.
049700 READ-REC-1-EXIT.
049800     EXIT.
049900 READ-REC-2.
050000******************************************************************
050100*   READ  <FILE> INTO ....  AT END                               *
050200******************************************************************
050300     READ SQ-VS7 INTO  VAR-RECORD-18-2048 AT END
050400         MOVE 1 TO EOF-FLAG
050500         GO TO READ-REC-2-EXIT.
050600     ADD 1 TO COUNT-OF-RECS.
050700     ADD 17 TO COUNT-OF-RECS.
050800     IF  RECORD-LENGTH     NOT EQUAL TO COUNT-OF-RECS
050900         GO TO READ-REC-2-ERROR.
051000     SUBTRACT 17 FROM COUNT-OF-RECS.
051100     GO TO READ-REC-2-EXIT.
051200 READ-REC-2-ERROR.
051300     SUBTRACT 17 FROM COUNT-OF-RECS.
051400     MOVE 1 TO ERROR-FLAG.
051500 READ-REC-2-EXIT.
051600     EXIT.
051700 READ-INIT-F1-02.
051800     MOVE ZERO TO ERROR-FLAG.
051900 READ-TEST-F1-02.
052000     PERFORM READ-REC-2 THRU READ-REC-2-EXIT 1001 TIMES.
052100     IF EOF-FLAG EQUAL TO 1
052200         MOVE "EOF ON SECOND READ" TO RE-MARK
052300         GO TO READ-EOF-F1-03.
052400     IF ERROR-FLAG EQUAL TO 1
052500         GO TO READ-FAIL-F1-02.
052600 READ-PASS-F1-02.
052700     PERFORM PASS.
052800     GO TO READ-WRITE-F1-02.
052900 READ-FAIL-F1-02.
053000     MOVE "ERROR:SEE VII-52 WRITE  OR VII-44 READ; VII-30 FORMAT
053100-         "RECORD VARYING . DEPENDING "           TO RE-MARK.
053200     MOVE RECORD-LENGTH TO COMPUTED-N.
053300     ADD 17 TO COUNT-OF-RECS.
053400     MOVE COUNT-OF-RECS TO CORRECT-N.
053500     SUBTRACT 17 FROM COUNT-OF-RECS.
053600     PERFORM FAIL.
053700 READ-WRITE-F1-02.
053800     MOVE "READ 1000 RECORD" TO FEATURE.
053900     MOVE "READ-TEST-F1-02" TO PAR-NAME.
054000     MOVE "EXPECTED RECORD LENGTH: 1049 TO 2048" TO RE-MARK.
054100     PERFORM PRINT-DETAIL.
054200 READ-INIT-F1-03.
054300     READ SQ-VS7 RECORD END
054400         GO TO READ-TEST-F1-03.
054500     MOVE "MORE THAN 2031 RECORDS" TO RE-MARK.
054600     GO TO READ-FAIL-F1-03.
054700 READ-EOF-F1-03.
054800     MOVE "RECORDS READ =" TO COMPUTED-A.
054900     MOVE COUNT-OF-RECS TO CORRECT-18V0.
055000     GO TO READ-FAIL-F1-03.
055100 READ-TEST-F1-03.
055200     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
055300         MOVE "RECORDS IN ERROR =" TO COMPUTED-A
055400     MOVE RECORDS-IN-ERROR TO CORRECT-18V0
055500         GO TO READ-FAIL-F1-03.
055600 READ-PASS-F1-03.
055700     PERFORM PASS.
055800     GO TO READ-WRITE-F1-03.
055900 READ-FAIL-F1-03.
056000     PERFORM FAIL.
056100 READ-WRITE-F1-03.
056200     MOVE "READ-TEST-F1-03" TO PAR-NAME.
056300     MOVE "VERIFY FILE SQ-VS7" TO FEATURE.
056400     PERFORM PRINT-DETAIL.
056500 READ-CLOSE-F1-03.
056600     CLOSE SQ-VS7.
056700 TERMINATE-ROUTINE.
056800     EXIT.
056900 CCVS-EXIT SECTION.
057000 CCVS-999999.
057100     GO TO CLOSE-FILES.
