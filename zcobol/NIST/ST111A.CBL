000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST111A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*    ST111 CHECKS THE OUTPUT FROM ST110. WHICH IN TURN USED INPUT
002200*    FROM ST109. 40 VARIABLE-LENGTH RECORDS HAVE BEEN SORTED AND
002300*    SHOULD APPEAR AS SHOWN
002400*        NON-KEY KEY-1       KEY-2               FILLER
002500*           X(2) X(10)       X(38)
002600*
002700*    FIRST 13 RECORDS ---
002800*            "CC""LOWEST TWO""MIDDLE TWO-SECOND" X(50) VALUE QUOTE
002900*    NEXT 14 RECORDS ---
003000*            "BB""LOWEST TWO""MIDDLE TWO-FIRST"  X(25) VALUE ZERO
003100*    LAST 13 RECORDS ---
003200*            "AA""LOWEST ONE""MIDDLE ONE-ONLY"         (NONE)
003300
003400 ENVIRONMENT DIVISION.
003500 CONFIGURATION SECTION.
003600 SOURCE-COMPUTER.
003700     XXXXX082.
003800 OBJECT-COMPUTER.
003900     XXXXX083.
004000 INPUT-OUTPUT SECTION.
004100 FILE-CONTROL.
004200     SELECT PRINT-FILE ASSIGN TO
004300     XXXXX055.
004400     SELECT   SORTIN-1K ASSIGN TO
004500     XXXXP002.
004600 DATA DIVISION.
004700 FILE SECTION.
004800 FD  PRINT-FILE.
004900 01  PRINT-REC PICTURE X(120).
005000 01  DUMMY-RECORD PICTURE X(120).
005100 FD  SORTIN-1K
005200     LABEL RECORDS STANDARD
005300C    VALUE OF
005400C    XXXXX074
005500C    IS
005600C    XXXXX076
005700G    XXXXX069
005800     RECORD CONTAINS 50 TO 100 CHARACTERS
005900     DATA RECORDS ARE SHORT-RECORD
006000                      MEDIUM-RECORD
006100                      LONG-RECORD.
006200 01  SHORT-RECORD       PICTURE X(50).
006300 01  MEDIUM-RECORD      PICTURE X(75).
006400 01  LONG-RECORD        PICTURE X(100).
006500 WORKING-STORAGE SECTION.
006600 77  UTIL-CTR           PICTURE S99999 VALUE ZERO.
006700 01  SHORT-WORK.
006800     02 FILLER          PICTURE XX VALUE "AA".
006900     02 FILLER          PICTURE X(10) VALUE "LOWEST ONE".
007000     02 FILLER          PICTURE X(38)
007100     VALUE "MIDDLE ONE-ONLY                       ".
007200 01  MEDIUM-WORK.
007300     02 FILLER          PICTURE XX VALUE "BB".
007400     02 FILLER          PICTURE X(10) VALUE "LOWEST TWO".
007500     02 FILLER          PICTURE X(38)
007600     VALUE "MIDDLE TWO-FIRST                      ".
007700     02 FILLER          PICTURE X(25) VALUE ZERO.
007800 01  LONG-WORK.
007900     02 FILLER         PICTURE XX VALUE "CC".
008000     02 FILLER         PICTURE X(10) VALUE "LOWEST TWO".
008100     02 FILLER          PICTURE X(38)
008200     VALUE "MIDDLE TWO-SECOND                     ".
008300     02  FILLER        PICTURE X(50) VALUE QUOTE.
008400 01  BREAKDOWN-LIMIT    PICTURE 999.
008500 01  COMPUTED-BREAKDOWN.
008600     02 FIRST-20-CM     PICTURE X(20).
008700     02 SECOND-20-CM    PICTURE X(20).
008800     02 THIRD-20-CM     PICTURE X(20).
008900     02 FOURTH-20-CM    PICTURE X(20).
009000     02 FIFTH-20-CM     PICTURE X(20).
009100 01  CORRECT-BREAKDOWN.
009200     02 FIRST-20-CR     PICTURE X(20).
009300     02 SECOND-20-CR    PICTURE X(20).
009400     02 THIRD-20-CR     PICTURE X(20).
009500     02 FOURTH-20-CR    PICTURE X(20).
009600     02 FIFTH-20-CR     PICTURE X(20).
009700 01  TEST-RESULTS.
009800     02 FILLER                   PIC X      VALUE SPACE.
009900     02 FEATURE                  PIC X(20)  VALUE SPACE.
010000     02 FILLER                   PIC X      VALUE SPACE.
010100     02 P-OR-F                   PIC X(5)   VALUE SPACE.
010200     02 FILLER                   PIC X      VALUE SPACE.
010300     02  PAR-NAME.
010400       03 FILLER                 PIC X(19)  VALUE SPACE.
010500       03  PARDOT-X              PIC X      VALUE SPACE.
010600       03 DOTVALUE               PIC 99     VALUE ZERO.
010700     02 FILLER                   PIC X(8)   VALUE SPACE.
010800     02 RE-MARK                  PIC X(61).
010900 01  TEST-COMPUTED.
011000     02 FILLER                   PIC X(30)  VALUE SPACE.
011100     02 FILLER                   PIC X(17)  VALUE
011200            "       COMPUTED=".
011300     02 COMPUTED-X.
011400     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
011500     03 COMPUTED-N               REDEFINES COMPUTED-A
011600                                 PIC -9(9).9(9).
011700     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
011800     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
011900     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
012000     03       CM-18V0 REDEFINES COMPUTED-A.
012100         04 COMPUTED-18V0                    PIC -9(18).
012200         04 FILLER                           PIC X.
012300     03 FILLER PIC X(50) VALUE SPACE.
012400 01  TEST-CORRECT.
012500     02 FILLER PIC X(30) VALUE SPACE.
012600     02 FILLER PIC X(17) VALUE "       CORRECT =".
012700     02 CORRECT-X.
012800     03 CORRECT-A                  PIC X(20) VALUE SPACE.
012900     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
013000     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
013100     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
013200     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
013300     03      CR-18V0 REDEFINES CORRECT-A.
013400         04 CORRECT-18V0                     PIC -9(18).
013500         04 FILLER                           PIC X.
013600     03 FILLER PIC X(2) VALUE SPACE.
013700     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
013800 01  CCVS-C-1.
013900     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
014000-    "SS  PARAGRAPH-NAME
014100-    "       REMARKS".
014200     02 FILLER                     PIC X(20)    VALUE SPACE.
014300 01  CCVS-C-2.
014400     02 FILLER                     PIC X        VALUE SPACE.
014500     02 FILLER                     PIC X(6)     VALUE "TESTED".
014600     02 FILLER                     PIC X(15)    VALUE SPACE.
014700     02 FILLER                     PIC X(4)     VALUE "FAIL".
014800     02 FILLER                     PIC X(94)    VALUE SPACE.
014900 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
015000 01  REC-CT                        PIC 99       VALUE ZERO.
015100 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
015200 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
015300 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
015400 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
015500 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
015600 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
015700 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
015800 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
015900 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
016000 01  CCVS-H-1.
016100     02  FILLER                    PIC X(39)    VALUE SPACES.
016200     02  FILLER                    PIC X(42)    VALUE
016300     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
016400     02  FILLER                    PIC X(39)    VALUE SPACES.
016500 01  CCVS-H-2A.
016600   02  FILLER                        PIC X(40)  VALUE SPACE.
016700   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
016800   02  FILLER                        PIC XXXX   VALUE
016900     "4.2 ".
017000   02  FILLER                        PIC X(28)  VALUE
017100            " COPY - NOT FOR DISTRIBUTION".
017200   02  FILLER                        PIC X(41)  VALUE SPACE.
017300
017400 01  CCVS-H-2B.
017500   02  FILLER                        PIC X(15)  VALUE
017600            "TEST RESULT OF ".
017700   02  TEST-ID                       PIC X(9).
017800   02  FILLER                        PIC X(4)   VALUE
017900            " IN ".
018000   02  FILLER                        PIC X(12)  VALUE
018100     " HIGH       ".
018200   02  FILLER                        PIC X(22)  VALUE
018300            " LEVEL VALIDATION FOR ".
018400   02  FILLER                        PIC X(58)  VALUE
018500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
018600 01  CCVS-H-3.
018700     02  FILLER                      PIC X(34)  VALUE
018800            " FOR OFFICIAL USE ONLY    ".
018900     02  FILLER                      PIC X(58)  VALUE
019000     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
019100     02  FILLER                      PIC X(28)  VALUE
019200            "  COPYRIGHT   1985 ".
019300 01  CCVS-E-1.
019400     02 FILLER                       PIC X(52)  VALUE SPACE.
019500     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
019600     02 ID-AGAIN                     PIC X(9).
019700     02 FILLER                       PIC X(45)  VALUE SPACES.
019800 01  CCVS-E-2.
019900     02  FILLER                      PIC X(31)  VALUE SPACE.
020000     02  FILLER                      PIC X(21)  VALUE SPACE.
020100     02 CCVS-E-2-2.
020200         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
020300         03 FILLER                   PIC X      VALUE SPACE.
020400         03 ENDER-DESC               PIC X(44)  VALUE
020500            "ERRORS ENCOUNTERED".
020600 01  CCVS-E-3.
020700     02  FILLER                      PIC X(22)  VALUE
020800            " FOR OFFICIAL USE ONLY".
020900     02  FILLER                      PIC X(12)  VALUE SPACE.
021000     02  FILLER                      PIC X(58)  VALUE
021100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
021200     02  FILLER                      PIC X(13)  VALUE SPACE.
021300     02 FILLER                       PIC X(15)  VALUE
021400             " COPYRIGHT 1985".
021500 01  CCVS-E-4.
021600     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
021700     02 FILLER                       PIC X(4)   VALUE " OF ".
021800     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
021900     02 FILLER                       PIC X(40)  VALUE
022000      "  TESTS WERE EXECUTED SUCCESSFULLY".
022100 01  XXINFO.
022200     02 FILLER                       PIC X(19)  VALUE
022300            "*** INFORMATION ***".
022400     02 INFO-TEXT.
022500       04 FILLER                     PIC X(8)   VALUE SPACE.
022600       04 XXCOMPUTED                 PIC X(20).
022700       04 FILLER                     PIC X(5)   VALUE SPACE.
022800       04 XXCORRECT                  PIC X(20).
022900     02 INF-ANSI-REFERENCE           PIC X(48).
023000 01  HYPHEN-LINE.
023100     02 FILLER  PIC IS X VALUE IS SPACE.
023200     02 FILLER  PIC IS X(65)    VALUE IS "************************
023300-    "*****************************************".
023400     02 FILLER  PIC IS X(54)    VALUE IS "************************
023500-    "******************************".
023600 01  CCVS-PGM-ID                     PIC X(9)   VALUE
023700     "ST111A".
023800 PROCEDURE DIVISION.
023900 CCVS1 SECTION.
024000 OPEN-FILES.
024100     OPEN     OUTPUT PRINT-FILE.
024200     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
024300     MOVE    SPACE TO TEST-RESULTS.
024400     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
024500     GO TO CCVS1-EXIT.
024600 CLOSE-FILES.
024700     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
024800 TERMINATE-CCVS.
024900S    EXIT PROGRAM.
025000STERMINATE-CALL.
025100     STOP     RUN.
025200 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
025300 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
025400 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
025500 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
025600     MOVE "****TEST DELETED****" TO RE-MARK.
025700 PRINT-DETAIL.
025800     IF REC-CT NOT EQUAL TO ZERO
025900             MOVE "." TO PARDOT-X
026000             MOVE REC-CT TO DOTVALUE.
026100     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
026200     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
026300        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
026400          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
026500     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
026600     MOVE SPACE TO CORRECT-X.
026700     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
026800     MOVE     SPACE TO RE-MARK.
026900 HEAD-ROUTINE.
027000     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027100     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027200     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
027300     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
027400 COLUMN-NAMES-ROUTINE.
027500     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027600     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
027800 END-ROUTINE.
027900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
028000 END-RTN-EXIT.
028100     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028200 END-ROUTINE-1.
028300      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
028400      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
028500      ADD PASS-COUNTER TO ERROR-HOLD.
028600*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
028700      MOVE PASS-COUNTER TO CCVS-E-4-1.
028800      MOVE ERROR-HOLD TO CCVS-E-4-2.
028900      MOVE CCVS-E-4 TO CCVS-E-2-2.
029000      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
029100  END-ROUTINE-12.
029200      MOVE "TEST(S) FAILED" TO ENDER-DESC.
029300     IF       ERROR-COUNTER IS EQUAL TO ZERO
029400         MOVE "NO " TO ERROR-TOTAL
029500         ELSE
029600         MOVE ERROR-COUNTER TO ERROR-TOTAL.
029700     MOVE     CCVS-E-2 TO DUMMY-RECORD.
029800     PERFORM WRITE-LINE.
029900 END-ROUTINE-13.
030000     IF DELETE-COUNTER IS EQUAL TO ZERO
030100         MOVE "NO " TO ERROR-TOTAL  ELSE
030200         MOVE DELETE-COUNTER TO ERROR-TOTAL.
030300     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
030400     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030500      IF   INSPECT-COUNTER EQUAL TO ZERO
030600          MOVE "NO " TO ERROR-TOTAL
030700      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
030800      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
030900      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031000     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031100 WRITE-LINE.
031200     ADD 1 TO RECORD-COUNT.
031300Y    IF RECORD-COUNT GREATER 42
031400Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
031500Y        MOVE SPACE TO DUMMY-RECORD
031600Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
031700Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
031800Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
031900Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
032000Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
032100Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
032200Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
032300Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
032400Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
032500Y        MOVE ZERO TO RECORD-COUNT.
032600     PERFORM WRT-LN.
032700 WRT-LN.
032800     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
032900     MOVE SPACE TO DUMMY-RECORD.
033000 BLANK-LINE-PRINT.
033100     PERFORM WRT-LN.
033200 FAIL-ROUTINE.
033300     IF     COMPUTED-X NOT EQUAL TO SPACE
033400            GO TO   FAIL-ROUTINE-WRITE.
033500     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
033600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
033700     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
033800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033900     MOVE   SPACES TO INF-ANSI-REFERENCE.
034000     GO TO  FAIL-ROUTINE-EX.
034100 FAIL-ROUTINE-WRITE.
034200     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
034300     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
034400     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
034500     MOVE   SPACES TO COR-ANSI-REFERENCE.
034600 FAIL-ROUTINE-EX. EXIT.
034700 BAIL-OUT.
034800     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
034900     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
035000 BAIL-OUT-WRITE.
035100     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
035200     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
035300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035400     MOVE   SPACES TO INF-ANSI-REFERENCE.
035500 BAIL-OUT-EX. EXIT.
035600 CCVS1-EXIT.
035700     EXIT.
035800 SECT-ST111-0001 SECTION.
035900 ST111-0001-01.
036000     OPEN     INPUT  SORTIN-1K.
036100     MOVE    " *****  ST110 DOES NOT PRODUCE A PRINTED REPORT  ***
036200-    "**" TO TEST-RESULTS.
036300     PERFORM PRINT-DETAIL.
036400     MOVE    SPACE TO TEST-RESULTS.
036500     PERFORM END-ROUTINE.
036600     MOVE     "SORT VARIABLE RECORD" TO FEATURE.
036700 SORT-TEST-1.
036800     MOVE     "SORT-TEST-1" TO PAR-NAME.
036900     PERFORM  READ-SORTIN.
037000     IF       LONG-RECORD EQUAL TO LONG-WORK
037100              PERFORM PASS GO TO SORT-WRITE-1.
037200*        NOTE FIRST RECORD.
037300 SORT-FAIL-1.
037400     MOVE     100 TO BREAKDOWN-LIMIT.
037500     MOVE     LONG-RECORD TO COMPUTED-BREAKDOWN.
037600     MOVE     LONG-WORK TO CORRECT-BREAKDOWN.
037700     PERFORM  BREAKDOWN-PARA THRU BREAKDOWN-EXIT.
037800 SORT-WRITE-1.
037900     PERFORM  PRINT-DETAIL.
038000 SORT-TEST-2.
038100     MOVE     "SORT-TEST-2" TO PAR-NAME.
038200     PERFORM  READ-SORTIN 12 TIMES.
038300     IF       LONG-RECORD EQUAL TO LONG-WORK
038400              PERFORM PASS GO TO SORT-WRITE-2.
038500*        NOTE THIRTEENTH RECORD.
038600 SORT-FAIL-2.
038700     MOVE     100 TO BREAKDOWN-LIMIT.
038800     MOVE     LONG-RECORD TO COMPUTED-BREAKDOWN.
038900     MOVE     LONG-WORK TO CORRECT-BREAKDOWN.
039000     PERFORM  BREAKDOWN-PARA THRU BREAKDOWN-EXIT.
039100 SORT-WRITE-2.
039200     PERFORM  PRINT-DETAIL.
039300 SORT-TEST-3.
039400     MOVE     "SORT-TEST-3" TO PAR-NAME.
039500     PERFORM  READ-SORTIN.
039600     IF       MEDIUM-RECORD EQUAL TO MEDIUM-WORK
039700              PERFORM PASS GO TO SORT-WRITE-3.
039800*        NOTE FOURTEENTH RECORD.
039900 SORT-FAIL-3.
040000     MOVE     75 TO BREAKDOWN-LIMIT.
040100     MOVE     MEDIUM-RECORD TO COMPUTED-BREAKDOWN.
040200     MOVE     MEDIUM-WORK TO CORRECT-BREAKDOWN.
040300     PERFORM  BREAKDOWN-PARA THRU BREAKDOWN-EXIT.
040400 SORT-WRITE-3.
040500     PERFORM  PRINT-DETAIL.
040600 SORT-TEST-4.
040700     MOVE     "SORT-TEST-4" TO PAR-NAME.
040800     PERFORM  READ-SORTIN 13 TIMES.
040900     IF       MEDIUM-RECORD EQUAL TO MEDIUM-WORK
041000              PERFORM PASS GO TO SORT-WRITE-4.
041100*        NOTE TWENTY-SEVENTH RECORD.
041200 SORT-FAIL-4.
041300     MOVE     75 TO BREAKDOWN-LIMIT.
041400     MOVE     MEDIUM-RECORD TO COMPUTED-BREAKDOWN.
041500     MOVE     MEDIUM-WORK TO CORRECT-BREAKDOWN.
041600     PERFORM  BREAKDOWN-PARA THRU BREAKDOWN-EXIT.
041700 SORT-WRITE-4.
041800     PERFORM  PRINT-DETAIL.
041900 SORT-TEST-5.
042000     MOVE     "SORT-TEST-5" TO PAR-NAME.
042100     PERFORM  READ-SORTIN.
042200     IF       SHORT-RECORD EQUAL TO SHORT-WORK
042300              PERFORM PASS GO TO SORT-WRITE-5.
042400*        NOTE TWENTY-EIGHTH RECORD.
042500 SORT-FAIL-5.
042600     MOVE     50 TO BREAKDOWN-LIMIT.
042700     MOVE     SHORT-RECORD TO COMPUTED-BREAKDOWN.
042800     MOVE     SHORT-WORK TO CORRECT-BREAKDOWN.
042900     PERFORM  BREAKDOWN-PARA THRU BREAKDOWN-EXIT.
043000 SORT-WRITE-5.
043100     PERFORM  PRINT-DETAIL.
043200 SORT-TEST-6.
043300     MOVE     "SORT-TEST-6" TO PAR-NAME.
043400     PERFORM  READ-SORTIN 12 TIMES.
043500     IF       SHORT-RECORD EQUAL TO SHORT-WORK
043600              PERFORM PASS GO TO SORT-WRITE-6.
043700*        NOTE FORTIETH RECORD.
043800 SORT-FAIL-6.
043900     MOVE     50 TO BREAKDOWN-LIMIT.
044000     MOVE     SHORT-RECORD TO COMPUTED-BREAKDOWN.
044100     MOVE     SHORT-WORK TO CORRECT-BREAKDOWN.
044200     PERFORM  BREAKDOWN-PARA THRU BREAKDOWN-EXIT.
044300 SORT-WRITE-6.
044400     PERFORM  PRINT-DETAIL.
044500 SORT-TEST-7.
044600     MOVE     "SORT-TEST-7" TO PAR-NAME.
044700     READ     SORTIN-1K AT END
044800              PERFORM PASS GO TO SORT-WRITE-7.
044900 SORT-FAIL-7.
045000     MOVE     100 TO BREAKDOWN-LIMIT.
045100     MOVE     LONG-RECORD TO COMPUTED-BREAKDOWN.
045200     MOVE     SPACE TO CORRECT-BREAKDOWN.
045300     PERFORM  BREAKDOWN-PARA THRU BREAKDOWN-EXIT.
045400     PERFORM  PRINT-DETAIL.
045500     MOVE     "END OF FILE NOT FOUND" TO RE-MARK.
045600 SORT-WRITE-7.
045700     PERFORM  PRINT-DETAIL.
045800     CLOSE    SORTIN-1K.
045900     GO TO    CCVS-EXIT.
046000 BREAKDOWN-PARA.
046100     PERFORM  FAIL.
046200     MOVE     FIRST-20-CM TO COMPUTED-A.
046300     MOVE     FIRST-20-CR TO CORRECT-A.
046400     MOVE     "FIRST TWENTY CHARACTERS" TO RE-MARK.
046500     PERFORM  PRINT-DETAIL.
046600     MOVE     SECOND-20-CM TO COMPUTED-A.
046700     MOVE     SECOND-20-CR TO CORRECT-A.
046800     MOVE     "SECOND TWENTY CHARACTERS" TO RE-MARK.
046900     PERFORM  PRINT-DETAIL.
047000     MOVE     THIRD-20-CM TO COMPUTED-A.
047100     MOVE     THIRD-20-CR TO CORRECT-A.
047200     MOVE     "THIRD TWENTY CHARACTERS" TO RE-MARK.
047300     PERFORM  PRINT-DETAIL.
047400     IF       BREAKDOWN-LIMIT LESS THAN 61 GO TO BREAKDOWN-EXIT.
047500     MOVE     FOURTH-20-CM TO COMPUTED-A.
047600     MOVE     FOURTH-20-CR TO CORRECT-A.
047700     MOVE     "FOURTH TWENTY CHARACTERS" TO RE-MARK.
047800     PERFORM  PRINT-DETAIL.
047900     IF       BREAKDOWN-LIMIT LESS THAN 81 GO TO BREAKDOWN-EXIT.
048000     MOVE     FIFTH-20-CM TO COMPUTED-A.
048100     MOVE     FIFTH-20-CR TO CORRECT-A.
048200     MOVE     "FIFTH TWENTY CHARACTERS" TO RE-MARK.
048300 BREAKDOWN-EXIT.
048400     EXIT.
048500 READ-SORTIN.
048600     READ     SORTIN-1K AT END GO TO READ-ERROR.
048700     ADD      1 TO UTIL-CTR.
048800 READ-ERROR.
048900     MOVE     UTIL-CTR TO COMPUTED-N.
049000     MOVE     40 TO CORRECT-N.
049100     MOVE     "TOO FEW INPUT RECORDS" TO RE-MARK.
049200     MOVE     "READ-SORTIN" TO PAR-NAME.
049300     PERFORM  FAIL.
049400     PERFORM  PRINT-DETAIL.
049500 CCVS-EXIT SECTION.
049600 CCVS-999999.
049700     GO TO CLOSE-FILES.
