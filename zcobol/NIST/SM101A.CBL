000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SM101A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200*                                                              *
001300*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001400*                                                              *
001500*        X-55  - SYSTEM PRINTER NAME.                          *
001600*        X-82  - SOURCE COMPUTER NAME.                         *
001700*        X-83  - OBJECT COMPUTER NAME.                         *
001800*                                                              *
001900****************************************************************
002000*                                                              *
002100*    PROGRAM SM101A TESTS THE USE OF THE "COPY" STATEMENT      *
002200*    IN A FILE DESCRIPTION WITH ITS RELATED 01 ENTRIES IN THE  *
002300*    WORKING-STORAGE SECTION AND IN THE PROCEDURE DIVISION.    *
002400*    IT CREATES A SEQUENTIAL FILE WHICH IS INPUT TO SM102A TO  *
002500*    CHECK THE PROPER EXECUTION OF THE "COPY" STATEMENT IN     *
002600*    SM101A.  IT ALSO TESTS THE EFFECT OF A "COPY" STATEMENT   *
002700*    APPEARING ON A DEBUGGING LINE.                            *
002800*                                                              *
002900****************************************************************
003000 ENVIRONMENT DIVISION.
003100 CONFIGURATION SECTION.
003200 SOURCE-COMPUTER.
003300     XXXXX082.
003400 OBJECT-COMPUTER.
003500     XXXXX083.
003600 INPUT-OUTPUT SECTION.
003700 FILE-CONTROL.
003800     SELECT PRINT-FILE ASSIGN TO
003900     XXXXX055.
004000     SELECT TEST-FILE ASSIGN TO
004100     XXXXP001.
004200 DATA DIVISION.
004300 FILE SECTION.
004400 FD  PRINT-FILE.
004500 01  PRINT-REC PICTURE X(120).
004600 01  DUMMY-RECORD PICTURE X(120).
004700
004800
004900
005000
005100
005200*
005300*********************** COPY STATEMENT USED **********************
005400*
005500*FD  TEST-FILE                                        COPY K1FDA.
005600*
005700******************** COPIED TEXT BEGINS BELOW ********************
005800 FD  TEST-FILE                                         COPY K1FDA.
005900*********************** END OF COPIED TEXT ***********************
006000
006100
006200
006300
006400
006500*
006600*********************** COPY STATEMENT USED **********************
006700*
006800*01  TST-TEST                                         COPY K101A.
006900*
007000******************** COPIED TEXT BEGINS BELOW ********************
007100 01  TST-TEST                                          COPY K101A.
007200*********************** END OF COPIED TEXT ***********************
007300 WORKING-STORAGE SECTION.
007400*
007500*********************** COPY STATEMENT USED **********************
007600*
007700*77  RCD-1                                            COPY K1W01.
007800*
007900******************** COPIED TEXT BEGINS BELOW ********************
008000 77  RCD-1                                             COPY K1W01.
008100*********************** END OF COPIED TEXT ***********************
008200 77  RCD-3 PICTURE 9(5) VALUE 10901.
008300*
008400*********************** COPY STATEMENT USED **********************
008500*
008600*77  COPY K1W02.
008700*
008800******************** COPIED TEXT BEGINS BELOW ********************
008900 77  COPY K1W02.
009000*********************** END OF COPIED TEXT ***********************
009100                       14003.
009200 77  RCD-6 PICTURE 9(5) VALUE 19922.
009300*
009400*********************** COPY STATEMENT USED **********************
009500*
009600*77  COPY K1W03.   VALUE 3543.
009700*
009800******************** COPIED TEXT BEGINS BELOW ********************
009900 77  COPY K1W03.   VALUE 3543.
010000*********************** END OF COPIED TEXT ***********************
010100 77  COPYSECT-1 PICTURE 9(5) VALUE 72459.
010200 77  COPYSECT-2 PICTURE 9(5) VALUE 12132.
010300 77  COPYSECT-3 PICTURE X(5) VALUE "TSTLI".
010400 77  COPYSECT-4 PICTURE X(5) VALUE "BCOPY".
010500*
010600*********************** COPY STATEMENT USED **********************
010700*
010800*COPY  K1W04.
010900*
011000******************** COPIED TEXT BEGINS BELOW ********************
011100 COPY  K1W04.
011200*********************** END OF COPIED TEXT ***********************
011300 77  PROC-1 PICTURE 999 VALUE 123.
011400 77  PROC-2 PICTURE 999 VALUE 456.
011500 77  WSTR-1  PICTURE X(3) VALUE "ABC".
011600
011700
011800
011900
012000
012100 01  WSTR-2.
012200*
012300*********************** COPY STATEMENT USED **********************
012400*
012500*                                            COPY K1WKA.
012600*
012700******************** COPIED TEXT BEGINS BELOW ********************
012800                                             COPY K1WKA.
012900*********************** END OF COPIED TEXT ***********************
013000 01  TEST-RESULTS.
013100     02 FILLER                   PIC X      VALUE SPACE.
013200     02 FEATURE                  PIC X(20)  VALUE SPACE.
013300     02 FILLER                   PIC X      VALUE SPACE.
013400     02 P-OR-F                   PIC X(5)   VALUE SPACE.
013500     02 FILLER                   PIC X      VALUE SPACE.
013600     02  PAR-NAME.
013700       03 FILLER                 PIC X(19)  VALUE SPACE.
013800       03  PARDOT-X              PIC X      VALUE SPACE.
013900       03 DOTVALUE               PIC 99     VALUE ZERO.
014000     02 FILLER                   PIC X(8)   VALUE SPACE.
014100     02 RE-MARK                  PIC X(61).
014200 01  TEST-COMPUTED.
014300     02 FILLER                   PIC X(30)  VALUE SPACE.
014400     02 FILLER                   PIC X(17)  VALUE
014500            "       COMPUTED=".
014600     02 COMPUTED-X.
014700     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
014800     03 COMPUTED-N               REDEFINES COMPUTED-A
014900                                 PIC -9(9).9(9).
015000     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
015100     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
015200     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
015300     03       CM-18V0 REDEFINES COMPUTED-A.
015400         04 COMPUTED-18V0                    PIC -9(18).
015500         04 FILLER                           PIC X.
015600     03 FILLER PIC X(50) VALUE SPACE.
015700 01  TEST-CORRECT.
015800     02 FILLER PIC X(30) VALUE SPACE.
015900     02 FILLER PIC X(17) VALUE "       CORRECT =".
016000     02 CORRECT-X.
016100     03 CORRECT-A                  PIC X(20) VALUE SPACE.
016200     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
016300     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
016400     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
016500     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
016600     03      CR-18V0 REDEFINES CORRECT-A.
016700         04 CORRECT-18V0                     PIC -9(18).
016800         04 FILLER                           PIC X.
016900     03 FILLER PIC X(2) VALUE SPACE.
017000     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
017100 01  CCVS-C-1.
017200     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
017300-    "SS  PARAGRAPH-NAME
017400-    "       REMARKS".
017500     02 FILLER                     PIC X(20)    VALUE SPACE.
017600 01  CCVS-C-2.
017700     02 FILLER                     PIC X        VALUE SPACE.
017800     02 FILLER                     PIC X(6)     VALUE "TESTED".
017900     02 FILLER                     PIC X(15)    VALUE SPACE.
018000     02 FILLER                     PIC X(4)     VALUE "FAIL".
018100     02 FILLER                     PIC X(94)    VALUE SPACE.
018200 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
018300 01  REC-CT                        PIC 99       VALUE ZERO.
018400 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
018500 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
018600 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
018700 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
018800 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
018900 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
019000 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
019100 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
019200 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
019300 01  CCVS-H-1.
019400     02  FILLER                    PIC X(39)    VALUE SPACES.
019500     02  FILLER                    PIC X(42)    VALUE
019600     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
019700     02  FILLER                    PIC X(39)    VALUE SPACES.
019800 01  CCVS-H-2A.
019900   02  FILLER                        PIC X(40)  VALUE SPACE.
020000   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
020100   02  FILLER                        PIC XXXX   VALUE
020200     "4.2 ".
020300   02  FILLER                        PIC X(28)  VALUE
020400            " COPY - NOT FOR DISTRIBUTION".
020500   02  FILLER                        PIC X(41)  VALUE SPACE.
020600
020700 01  CCVS-H-2B.
020800   02  FILLER                        PIC X(15)  VALUE
020900            "TEST RESULT OF ".
021000   02  TEST-ID                       PIC X(9).
021100   02  FILLER                        PIC X(4)   VALUE
021200            " IN ".
021300   02  FILLER                        PIC X(12)  VALUE
021400     " HIGH       ".
021500   02  FILLER                        PIC X(22)  VALUE
021600            " LEVEL VALIDATION FOR ".
021700   02  FILLER                        PIC X(58)  VALUE
021800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
021900 01  CCVS-H-3.
022000     02  FILLER                      PIC X(34)  VALUE
022100            " FOR OFFICIAL USE ONLY    ".
022200     02  FILLER                      PIC X(58)  VALUE
022300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022400     02  FILLER                      PIC X(28)  VALUE
022500            "  COPYRIGHT   1985 ".
022600 01  CCVS-E-1.
022700     02 FILLER                       PIC X(52)  VALUE SPACE.
022800     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
022900     02 ID-AGAIN                     PIC X(9).
023000     02 FILLER                       PIC X(45)  VALUE SPACES.
023100 01  CCVS-E-2.
023200     02  FILLER                      PIC X(31)  VALUE SPACE.
023300     02  FILLER                      PIC X(21)  VALUE SPACE.
023400     02 CCVS-E-2-2.
023500         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
023600         03 FILLER                   PIC X      VALUE SPACE.
023700         03 ENDER-DESC               PIC X(44)  VALUE
023800            "ERRORS ENCOUNTERED".
023900 01  CCVS-E-3.
024000     02  FILLER                      PIC X(22)  VALUE
024100            " FOR OFFICIAL USE ONLY".
024200     02  FILLER                      PIC X(12)  VALUE SPACE.
024300     02  FILLER                      PIC X(58)  VALUE
024400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024500     02  FILLER                      PIC X(13)  VALUE SPACE.
024600     02 FILLER                       PIC X(15)  VALUE
024700             " COPYRIGHT 1985".
024800 01  CCVS-E-4.
024900     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
025000     02 FILLER                       PIC X(4)   VALUE " OF ".
025100     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
025200     02 FILLER                       PIC X(40)  VALUE
025300      "  TESTS WERE EXECUTED SUCCESSFULLY".
025400 01  XXINFO.
025500     02 FILLER                       PIC X(19)  VALUE
025600            "*** INFORMATION ***".
025700     02 INFO-TEXT.
025800       04 FILLER                     PIC X(8)   VALUE SPACE.
025900       04 XXCOMPUTED                 PIC X(20).
026000       04 FILLER                     PIC X(5)   VALUE SPACE.
026100       04 XXCORRECT                  PIC X(20).
026200     02 INF-ANSI-REFERENCE           PIC X(48).
026300 01  HYPHEN-LINE.
026400     02 FILLER  PIC IS X VALUE IS SPACE.
026500     02 FILLER  PIC IS X(65)    VALUE IS "************************
026600-    "*****************************************".
026700     02 FILLER  PIC IS X(54)    VALUE IS "************************
026800-    "******************************".
026900 01  CCVS-PGM-ID                     PIC X(9)   VALUE
027000     "SM101A".
027100 PROCEDURE DIVISION.
027200 CCVS1 SECTION.
027300 OPEN-FILES.
027400     OPEN     OUTPUT PRINT-FILE.
027500     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
027600     MOVE    SPACE TO TEST-RESULTS.
027700     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
027800     GO TO CCVS1-EXIT.
027900 CLOSE-FILES.
028000     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
028100 TERMINATE-CCVS.
028200S    EXIT PROGRAM.
028300STERMINATE-CALL.
028400     STOP     RUN.
028500 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
028600 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
028700 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
028800 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
028900     MOVE "****TEST DELETED****" TO RE-MARK.
029000 PRINT-DETAIL.
029100     IF REC-CT NOT EQUAL TO ZERO
029200             MOVE "." TO PARDOT-X
029300             MOVE REC-CT TO DOTVALUE.
029400     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
029500     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
029600        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
029700          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
029800     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
029900     MOVE SPACE TO CORRECT-X.
030000     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
030100     MOVE     SPACE TO RE-MARK.
030200 HEAD-ROUTINE.
030300     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030400     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030500     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030600     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030700 COLUMN-NAMES-ROUTINE.
030800     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030900     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
031100 END-ROUTINE.
031200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
031300 END-RTN-EXIT.
031400     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031500 END-ROUTINE-1.
031600      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
031700      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
031800      ADD PASS-COUNTER TO ERROR-HOLD.
031900*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
032000      MOVE PASS-COUNTER TO CCVS-E-4-1.
032100      MOVE ERROR-HOLD TO CCVS-E-4-2.
032200      MOVE CCVS-E-4 TO CCVS-E-2-2.
032300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
032400  END-ROUTINE-12.
032500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
032600     IF       ERROR-COUNTER IS EQUAL TO ZERO
032700         MOVE "NO " TO ERROR-TOTAL
032800         ELSE
032900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
033000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
033100     PERFORM WRITE-LINE.
033200 END-ROUTINE-13.
033300     IF DELETE-COUNTER IS EQUAL TO ZERO
033400         MOVE "NO " TO ERROR-TOTAL  ELSE
033500         MOVE DELETE-COUNTER TO ERROR-TOTAL.
033600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
033700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033800      IF   INSPECT-COUNTER EQUAL TO ZERO
033900          MOVE "NO " TO ERROR-TOTAL
034000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
034100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
034200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034400 WRITE-LINE.
034500     ADD 1 TO RECORD-COUNT.
034600Y    IF RECORD-COUNT GREATER 50
034700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
034800Y        MOVE SPACE TO DUMMY-RECORD
034900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
035000Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
035100Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
035200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
035300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
035400Y        MOVE ZERO TO RECORD-COUNT.
035500     PERFORM WRT-LN.
035600 WRT-LN.
035700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
035800     MOVE SPACE TO DUMMY-RECORD.
035900 BLANK-LINE-PRINT.
036000     PERFORM WRT-LN.
036100 FAIL-ROUTINE.
036200     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
036300     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
036400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
036500     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
036600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036700     MOVE   SPACES TO INF-ANSI-REFERENCE.
036800     GO TO  FAIL-ROUTINE-EX.
036900 FAIL-ROUTINE-WRITE.
037000     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
037100     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
037200     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
037300     MOVE   SPACES TO COR-ANSI-REFERENCE.
037400 FAIL-ROUTINE-EX. EXIT.
037500 BAIL-OUT.
037600     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
037700     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
037800 BAIL-OUT-WRITE.
037900     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
038000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
038100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038200     MOVE   SPACES TO INF-ANSI-REFERENCE.
038300 BAIL-OUT-EX. EXIT.
038400 CCVS1-EXIT.
038500     EXIT.
038600 INITIALIZATION SECTION.
038700 SM101A-INIT.
038800     OPEN     OUTPUT TEST-FILE.
038900     MOVE     "OUTPUT OF SM101A IS USED AS" TO RE-MARK.
039000     PERFORM  PRINT-DETAIL.
039100     MOVE     "INPUT FOR SM102A."           TO RE-MARK.
039200     PERFORM  PRINT-DETAIL.
039300     MOVE     "COPY ---" TO FEATURE.
039400     PERFORM  PRINT-DETAIL.
039500 WORKING-STORAGE-TEST SECTION.
039600 COPY-TEST-1.
039700     IF       WSTR-1 EQUAL TO WSTR-2
039800              PERFORM PASS GO TO COPY-WRITE-1.
039900*        NOTE TESTS COPYING OF WORKING-STORAGE ENTRIES.
040000     GO       TO COPY-FAIL-1.
040100 COPY-DELETE-1.
040200     PERFORM  DE-LETE.
040300     GO       TO COPY-WRITE-1.
040400 COPY-FAIL-1.
040500     MOVE     WSTR-2 TO COMPUTED-A.
040600     MOVE     "ABC" TO CORRECT-A
040700     PERFORM  FAIL.
040800 COPY-WRITE-1.
040900     MOVE     "  WKNG-STORAGE ENTRY" TO FEATURE
041000     MOVE     "COPY-TEST-1 " TO PAR-NAME.
041100     PERFORM  PRINT-DETAIL.
041200 PARAGRAPH-TEST SECTION.
041300 COPY-TEST-2.
041400
041500
041600
041700
041800
041900*
042000*********************** COPY STATEMENT USED **********************
042100*
042200*                                                     COPY K1PRA.
042300*
042400******************** COPIED TEXT BEGINS BELOW ********************
042500                                                       COPY K1PRA.
042600*********************** END OF COPIED TEXT ***********************
042700 COPY-TESTT-2.
042800     IF       PROC-1 EQUAL TO PROC-2
042900              PERFORM PASS GO TO COPY-WRITE-2.
043000*        NOTE TESTS COPYING OF A PROCEDURE DIVISION STATEMENT.
043100     GO       TO COPY-FAIL-2.
043200 COPY-DELETE-2.
043300     PERFORM  DE-LETE.
043400     GO       TO COPY-WRITE-2.
043500 COPY-FAIL-2.
043600     MOVE     PROC-2 TO COMPUTED-N.
043700     MOVE     123 TO CORRECT-N.
043800     PERFORM  FAIL.
043900 COPY-WRITE-2.
044000     MOVE     "  PROCEDURE" TO FEATURE
044100     MOVE     "COPY-TEST-2 " TO PAR-NAME.
044200     PERFORM  PRINT-DETAIL.
044300 SECTION-TEST SECTION.
044400
044500
044600
044700
044800
044900*
045000*********************** COPY STATEMENT USED **********************
045100*
045200*                                                     COPY K1SEA.
045300*
045400******************** COPIED TEXT BEGINS BELOW ********************
045500                                                       COPY K1SEA.
045600D                                                      COPY K1SEA.
045700*********************** END OF COPIED TEXT ***********************
045800 COPY-INIT-A.
045900     MOVE     "  SECTION" TO FEATURE.
046000 COPY-TEST-3.
046100     IF       COPYSECT-1 EQUAL TO 95427
046200              PERFORM PASS GO TO COPY-WRITE-3.
046300*        NOTE COPY-TEST-3, 4, 5, 6 TEST THE COPYING OF AN
046400*             ENTIRE SECTION.
046500     GO       TO COPY-FAIL-3.
046600 COPY-DELETE-3.
046700     PERFORM  DE-LETE.
046800     GO       TO COPY-WRITE-3.
046900 COPY-FAIL-3.
047000     MOVE     COPYSECT-1 TO COMPUTED-N.
047100     MOVE     95427   TO CORRECT-N.
047200     PERFORM  FAIL.
047300 COPY-WRITE-3.
047400     MOVE     "COPY-TEST-3 " TO PAR-NAME.
047500     PERFORM  PRINT-DETAIL.
047600 COPY-TEST-4.
047700     IF       COPYSECT-2 EQUAL TO 23121
047800              PERFORM PASS GO TO COPY-WRITE-4.
047900     GO       TO COPY-FAIL-4.
048000 COPY-DELETE-4.
048100     PERFORM  DE-LETE.
048200     GO       TO COPY-WRITE-4.
048300 COPY-FAIL-4.
048400     MOVE     COPYSECT-2 TO COMPUTED-N.
048500     MOVE     23121   TO CORRECT-N.
048600     PERFORM  FAIL.
048700 COPY-WRITE-4.
048800     MOVE     "COPY-TEST-4 " TO PAR-NAME.
048900     PERFORM  PRINT-DETAIL.
049000 COPY-TEST-5.
049100     IF       COPYSECT-3 EQUAL TO "LIBCO"
049200              PERFORM PASS GO TO COPY-WRITE-5.
049300     GO       TO COPY-FAIL-5.
049400 COPY-DELETE-5.
049500     PERFORM  DE-LETE.
049600     GO       TO COPY-WRITE-5.
049700 COPY-FAIL-5.
049800     MOVE     COPYSECT-3 TO COMPUTED-A.
049900     MOVE     "LIBCO" TO CORRECT-A.
050000     PERFORM  FAIL.
050100 COPY-WRITE-5.
050200     MOVE     "COPY-TEST-5 " TO PAR-NAME.
050300     PERFORM  PRINT-DETAIL.
050400 COPY-TEST-6.
050500     IF       COPYSECT-4 EQUAL TO "PYTST"
050600              PERFORM PASS GO TO COPY-WRITE-6.
050700     GO       TO COPY-FAIL-6.
050800 COPY-DELETE-6.
050900     PERFORM  DE-LETE.
051000     GO       TO COPY-WRITE-6.
051100 COPY-FAIL-6.
051200     MOVE     COPYSECT-4 TO COMPUTED-A.
051300     MOVE     "PYTST" TO CORRECT-A.
051400     PERFORM  FAIL.
051500 COPY-WRITE-6.
051600     MOVE     "COPY-TEST-6 " TO PAR-NAME.
051700     PERFORM  PRINT-DETAIL.
051800 BUILD SECTION.
051900 COPY-TEST-7.
052000     MOVE     RCD-1 TO TST-FLD-1.
052100     WRITE    TST-TEST.
052200     MOVE     RCD-2 TO TST-FLD-1.
052300     WRITE    TST-TEST.
052400     MOVE     RCD-3 TO TST-FLD-1.
052500     WRITE    TST-TEST.
052600     MOVE     RCD-4 TO TST-FLD-1.
052700     WRITE    TST-TEST.
052800     MOVE     RCD-5 TO TST-FLD-1.
052900     WRITE    TST-TEST.
053000     MOVE     RCD-6 TO TST-FLD-1.
053100     WRITE    TST-TEST.
053200     MOVE     RCD-7 TO TST-FLD-1.
053300     WRITE    TST-TEST.
053400     PERFORM  PASS.
053500     GO       TO COPY-WRITE-7.
053600 COPY-DELETE-7.
053700     PERFORM  DE-LETE.
053800 COPY-WRITE-7.
053900     MOVE     "  FILE DESCRIPTION" TO FEATURE.
054000     MOVE     "COPY-TEST-7" TO PAR-NAME.
054100     MOVE     "OUTPUT CHECKED IN SM102A" TO RE-MARK.
054200     PERFORM  PRINT-DETAIL.
054300 COPY-TEST-8.
054400*
054500*********************** COPY STATEMENT USED **********************
054600*
054700*    ADD     COPY K1P01. TO WRK-DS-05V00.
054800*
054900******************** COPIED TEXT BEGINS BELOW ********************
055000     ADD     COPY K1P01. TO WRK-DS-05V00.
055100*********************** END OF COPIED TEXT ***********************
055200     IF       WRK-DS-05V00 EQUAL TO 97523
055300             PERFORM PASS
055400             GO TO COPY-WRITE-8.
055500     GO TO    COPY-FAIL-8.
055600 COPY-DELETE-8.
055700     PERFORM DE-LETE.
055800     GO TO    COPY-WRITE-8.
055900 COPY-FAIL-8.
056000     MOVE    WRK-DS-05V00 TO COMPUTED-N.
056100     MOVE    97523        TO CORRECT-N.
056200     PERFORM FAIL.
056300 COPY-WRITE-8.
056400     MOVE     "COPY-TEST-8" TO PAR-NAME.
056500     PERFORM PRINT-DETAIL.
056600     CLOSE    TEST-FILE.
056700 CCVS-EXIT SECTION.
056800 CCVS-999999.
056900     GO TO CLOSE-FILES.
