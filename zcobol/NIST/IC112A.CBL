000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IC112A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100****************************************************************
002200*
002300*         THE ROUTINE IC112 IS A MAIN PROGRAM WHICH HAS A FILE
002400*    DESCRIPTION FOR A SEQUENTIAL MASS STORAGE FILE WITH FIXED
002500*    LENGTH RECORDS.  THE FILE IS CREATED, CLOSED AND OPENED AS
002600*    AN INPUT FILE.  THE MAIN ROUTINE READS THE FILE AND VERIFIES
002700*    THAT THE FILE IS CORRECT.  THE FILE IS CLOSED AND OPENED
002800*    AGAIN AS AN INPUT FILE.  A RECORD IS READ AND A CALL IS MADE
002900*    TO THE SUBPROGRAM IC113 WITH THE FILE DESCRIPTION 01 RECORD
003000*    LISTED AS ONE OF THE OPERANDS OF THE USING PHRASE.  THE
003100*    SUBPROGRAM IC113 COMPARES THE FIELDS IN THE INPUT RECORD TO
003200*    THE VALUES WRITTEN WHEN THE FILE WAS CREATED.
003300*
003400*         THIS PROGRAM WAS ADAPTED FROM THE SEQUENTIAL I-O TEST
003500*    CONTAINED IN ROUTINE SQ104.  IF ANY ERRORS OCCUR IN RUNNING
003600*    THE ROUTINE SQ104, THE RESULTS OF THE TESTS IN THE ROUTINES
003700*    IC112 AND IC113 ARE INCONCLUSIVE.
003800*
003900*******************************************
004000 ENVIRONMENT DIVISION.
004100 CONFIGURATION SECTION.
004200 SOURCE-COMPUTER.
004300     XXXXX082.
004400 OBJECT-COMPUTER.
004500     XXXXX083.
004600 INPUT-OUTPUT SECTION.
004700 FILE-CONTROL.
004800     SELECT PRINT-FILE ASSIGN TO
004900     XXXXX055.
005000     SELECT SQ-FS3 ASSIGN TO
005100     XXXXX014
005200     ORGANIZATION IS SEQUENTIAL
005300     ACCESS MODE IS SEQUENTIAL.
005400 DATA DIVISION.
005500 FILE SECTION.
005600 FD  PRINT-FILE.
005700 01  PRINT-REC PICTURE X(120).
005800 01  DUMMY-RECORD PICTURE X(120).
005900 FD  SQ-FS3
006000     BLOCK CONTAINS 120 CHARACTERS
006100     RECORD CONTAINS 120 CHARACTERS
006200     LABEL RECORDS ARE STANDARD
006300C    VALUE OF
006400C    XXXXX074
006500C    IS
006600C    XXXXX075
006700G    XXXXX069
006800     DATA RECORD SQ-FS3R1-F-G-120.
006900 01  SQ-FS3R1-F-G-120.
007000     02  FILLER PIC X(120).
007100 WORKING-STORAGE SECTION.
007200 01  WRK-CS-09V00 PICTURE S9(9) USAGE COMP VALUE ZERO.
007300 01  RECORDS-IN-ERROR  PIC S9(5) USAGE COMP VALUE 0.
007400 01  ERROR-FLAG PICTURE 9 VALUE 0.
007500 01  EOF-FLAG PICTURE 9 VALUE 0.
007600 01  FILE-RECORD-INFORMATION-REC.
007700     03 FILE-RECORD-INFO-SKELETON.
007800        05 FILLER                 PICTURE X(48)       VALUE
007900             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
008000        05 FILLER                 PICTURE X(46)       VALUE
008100             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
008200        05 FILLER                 PICTURE X(26)       VALUE
008300             ",LFIL=000000,ORG=  ,LBLR= ".
008400        05 FILLER                 PICTURE X(37)       VALUE
008500             ",RECKEY=                             ".
008600        05 FILLER                 PICTURE X(38)       VALUE
008700             ",ALTKEY1=                             ".
008800        05 FILLER                 PICTURE X(38)       VALUE
008900             ",ALTKEY2=                             ".
009000        05 FILLER                 PICTURE X(7)        VALUE SPACE.
009100     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
009200        05 FILE-RECORD-INFO-P1-120.
009300           07 FILLER              PIC X(5).
009400           07 XFILE-NAME           PIC X(6).
009500           07 FILLER              PIC X(8).
009600           07 XRECORD-NAME         PIC X(6).
009700           07 FILLER              PIC X(1).
009800           07 REELUNIT-NUMBER     PIC 9(1).
009900           07 FILLER              PIC X(7).
010000           07 XRECORD-NUMBER       PIC 9(6).
010100           07 FILLER              PIC X(6).
010200           07 UPDATE-NUMBER       PIC 9(2).
010300           07 FILLER              PIC X(5).
010400           07 ODO-NUMBER          PIC 9(4).
010500           07 FILLER              PIC X(5).
010600           07 XPROGRAM-NAME        PIC X(5).
010700           07 FILLER              PIC X(7).
010800           07 XRECORD-LENGTH       PIC 9(6).
010900           07 FILLER              PIC X(7).
011000           07 CHARS-OR-RECORDS    PIC X(2).
011100           07 FILLER              PIC X(1).
011200           07 XBLOCK-SIZE          PIC 9(4).
011300           07 FILLER              PIC X(6).
011400           07 RECORDS-IN-FILE     PIC 9(6).
011500           07 FILLER              PIC X(5).
011600           07 XFILE-ORGANIZATION   PIC X(2).
011700           07 FILLER              PIC X(6).
011800           07 XLABEL-TYPE          PIC X(1).
011900        05 FILE-RECORD-INFO-P121-240.
012000           07 FILLER              PIC X(8).
012100           07 XRECORD-KEY          PIC X(29).
012200           07 FILLER              PIC X(9).
012300           07 ALTERNATE-KEY1      PIC X(29).
012400           07 FILLER              PIC X(9).
012500           07 ALTERNATE-KEY2      PIC X(29).
012600           07 FILLER              PIC X(7).
012700 01  TEST-RESULTS.
012800     02 FILLER                   PIC X      VALUE SPACE.
012900     02 FEATURE                  PIC X(20)  VALUE SPACE.
013000     02 FILLER                   PIC X      VALUE SPACE.
013100     02 P-OR-F                   PIC X(5)   VALUE SPACE.
013200     02 FILLER                   PIC X      VALUE SPACE.
013300     02  PAR-NAME.
013400       03 FILLER                 PIC X(19)  VALUE SPACE.
013500       03  PARDOT-X              PIC X      VALUE SPACE.
013600       03 DOTVALUE               PIC 99     VALUE ZERO.
013700     02 FILLER                   PIC X(8)   VALUE SPACE.
013800     02 RE-MARK                  PIC X(61).
013900 01  TEST-COMPUTED.
014000     02 FILLER                   PIC X(30)  VALUE SPACE.
014100     02 FILLER                   PIC X(17)  VALUE
014200            "       COMPUTED=".
014300     02 COMPUTED-X.
014400     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
014500     03 COMPUTED-N               REDEFINES COMPUTED-A
014600                                 PIC -9(9).9(9).
014700     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
014800     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
014900     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
015000     03       CM-18V0 REDEFINES COMPUTED-A.
015100         04 COMPUTED-18V0                    PIC -9(18).
015200         04 FILLER                           PIC X.
015300     03 FILLER PIC X(50) VALUE SPACE.
015400 01  TEST-CORRECT.
015500     02 FILLER PIC X(30) VALUE SPACE.
015600     02 FILLER PIC X(17) VALUE "       CORRECT =".
015700     02 CORRECT-X.
015800     03 CORRECT-A                  PIC X(20) VALUE SPACE.
015900     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
016000     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
016100     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
016200     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
016300     03      CR-18V0 REDEFINES CORRECT-A.
016400         04 CORRECT-18V0                     PIC -9(18).
016500         04 FILLER                           PIC X.
016600     03 FILLER PIC X(2) VALUE SPACE.
016700     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
016800 01  CCVS-C-1.
016900     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
017000-    "SS  PARAGRAPH-NAME
017100-    "       REMARKS".
017200     02 FILLER                     PIC X(20)    VALUE SPACE.
017300 01  CCVS-C-2.
017400     02 FILLER                     PIC X        VALUE SPACE.
017500     02 FILLER                     PIC X(6)     VALUE "TESTED".
017600     02 FILLER                     PIC X(15)    VALUE SPACE.
017700     02 FILLER                     PIC X(4)     VALUE "FAIL".
017800     02 FILLER                     PIC X(94)    VALUE SPACE.
017900 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
018000 01  REC-CT                        PIC 99       VALUE ZERO.
018100 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
018200 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
018300 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
018400 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
018500 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
018600 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
018700 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
018800 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
018900 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
019000 01  CCVS-H-1.
019100     02  FILLER                    PIC X(39)    VALUE SPACES.
019200     02  FILLER                    PIC X(42)    VALUE
019300     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
019400     02  FILLER                    PIC X(39)    VALUE SPACES.
019500 01  CCVS-H-2A.
019600   02  FILLER                        PIC X(40)  VALUE SPACE.
019700   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
019800   02  FILLER                        PIC XXXX   VALUE
019900     "4.2 ".
020000   02  FILLER                        PIC X(28)  VALUE
020100            " COPY - NOT FOR DISTRIBUTION".
020200   02  FILLER                        PIC X(41)  VALUE SPACE.
020300
020400 01  CCVS-H-2B.
020500   02  FILLER                        PIC X(15)  VALUE
020600            "TEST RESULT OF ".
020700   02  TEST-ID                       PIC X(9).
020800   02  FILLER                        PIC X(4)   VALUE
020900            " IN ".
021000   02  FILLER                        PIC X(12)  VALUE
021100     " HIGH       ".
021200   02  FILLER                        PIC X(22)  VALUE
021300            " LEVEL VALIDATION FOR ".
021400   02  FILLER                        PIC X(58)  VALUE
021500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
021600 01  CCVS-H-3.
021700     02  FILLER                      PIC X(34)  VALUE
021800            " FOR OFFICIAL USE ONLY    ".
021900     02  FILLER                      PIC X(58)  VALUE
022000     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022100     02  FILLER                      PIC X(28)  VALUE
022200            "  COPYRIGHT   1985 ".
022300 01  CCVS-E-1.
022400     02 FILLER                       PIC X(52)  VALUE SPACE.
022500     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
022600     02 ID-AGAIN                     PIC X(9).
022700     02 FILLER                       PIC X(45)  VALUE SPACES.
022800 01  CCVS-E-2.
022900     02  FILLER                      PIC X(31)  VALUE SPACE.
023000     02  FILLER                      PIC X(21)  VALUE SPACE.
023100     02 CCVS-E-2-2.
023200         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
023300         03 FILLER                   PIC X      VALUE SPACE.
023400         03 ENDER-DESC               PIC X(44)  VALUE
023500            "ERRORS ENCOUNTERED".
023600 01  CCVS-E-3.
023700     02  FILLER                      PIC X(22)  VALUE
023800            " FOR OFFICIAL USE ONLY".
023900     02  FILLER                      PIC X(12)  VALUE SPACE.
024000     02  FILLER                      PIC X(58)  VALUE
024100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024200     02  FILLER                      PIC X(13)  VALUE SPACE.
024300     02 FILLER                       PIC X(15)  VALUE
024400             " COPYRIGHT 1985".
024500 01  CCVS-E-4.
024600     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
024700     02 FILLER                       PIC X(4)   VALUE " OF ".
024800     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
024900     02 FILLER                       PIC X(40)  VALUE
025000      "  TESTS WERE EXECUTED SUCCESSFULLY".
025100 01  XXINFO.
025200     02 FILLER                       PIC X(19)  VALUE
025300            "*** INFORMATION ***".
025400     02 INFO-TEXT.
025500       04 FILLER                     PIC X(8)   VALUE SPACE.
025600       04 XXCOMPUTED                 PIC X(20).
025700       04 FILLER                     PIC X(5)   VALUE SPACE.
025800       04 XXCORRECT                  PIC X(20).
025900     02 INF-ANSI-REFERENCE           PIC X(48).
026000 01  HYPHEN-LINE.
026100     02 FILLER  PIC IS X VALUE IS SPACE.
026200     02 FILLER  PIC IS X(65)    VALUE IS "************************
026300-    "*****************************************".
026400     02 FILLER  PIC IS X(54)    VALUE IS "************************
026500-    "******************************".
026600 01  CCVS-PGM-ID                     PIC X(9)   VALUE
026700     "IC112A".
026800 PROCEDURE DIVISION.
026900 CCVS1 SECTION.
027000 OPEN-FILES.
027100     OPEN     OUTPUT PRINT-FILE.
027200     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
027300     MOVE    SPACE TO TEST-RESULTS.
027400     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
027500     GO TO CCVS1-EXIT.
027600 CLOSE-FILES.
027700     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
027800 TERMINATE-CCVS.
027900S    EXIT PROGRAM.
028000STERMINATE-CALL.
028100     STOP     RUN.
028200 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
028300 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
028400 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
028500 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
028600     MOVE "****TEST DELETED****" TO RE-MARK.
028700 PRINT-DETAIL.
028800     IF REC-CT NOT EQUAL TO ZERO
028900             MOVE "." TO PARDOT-X
029000             MOVE REC-CT TO DOTVALUE.
029100     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
029200     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
029300        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
029400          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
029500     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
029600     MOVE SPACE TO CORRECT-X.
029700     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
029800     MOVE     SPACE TO RE-MARK.
029900 HEAD-ROUTINE.
030000     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030100     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030200     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030300     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030400 COLUMN-NAMES-ROUTINE.
030500     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030600     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
030800 END-ROUTINE.
030900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
031000 END-RTN-EXIT.
031100     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031200 END-ROUTINE-1.
031300      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
031400      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
031500      ADD PASS-COUNTER TO ERROR-HOLD.
031600*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
031700      MOVE PASS-COUNTER TO CCVS-E-4-1.
031800      MOVE ERROR-HOLD TO CCVS-E-4-2.
031900      MOVE CCVS-E-4 TO CCVS-E-2-2.
032000      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
032100  END-ROUTINE-12.
032200      MOVE "TEST(S) FAILED" TO ENDER-DESC.
032300     IF       ERROR-COUNTER IS EQUAL TO ZERO
032400         MOVE "NO " TO ERROR-TOTAL
032500         ELSE
032600         MOVE ERROR-COUNTER TO ERROR-TOTAL.
032700     MOVE     CCVS-E-2 TO DUMMY-RECORD.
032800     PERFORM WRITE-LINE.
032900 END-ROUTINE-13.
033000     IF DELETE-COUNTER IS EQUAL TO ZERO
033100         MOVE "NO " TO ERROR-TOTAL  ELSE
033200         MOVE DELETE-COUNTER TO ERROR-TOTAL.
033300     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
033400     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033500      IF   INSPECT-COUNTER EQUAL TO ZERO
033600          MOVE "NO " TO ERROR-TOTAL
033700      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
033800      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
033900      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034000     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034100 WRITE-LINE.
034200     ADD 1 TO RECORD-COUNT.
034300Y    IF RECORD-COUNT GREATER 50
034400Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
034500Y        MOVE SPACE TO DUMMY-RECORD
034600Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
034700Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
034800Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
034900Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
035000Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
035100Y        MOVE ZERO TO RECORD-COUNT.
035200     PERFORM WRT-LN.
035300 WRT-LN.
035400     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
035500     MOVE SPACE TO DUMMY-RECORD.
035600 BLANK-LINE-PRINT.
035700     PERFORM WRT-LN.
035800 FAIL-ROUTINE.
035900     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
036000     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
036100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
036200     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
036300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036400     MOVE   SPACES TO INF-ANSI-REFERENCE.
036500     GO TO  FAIL-ROUTINE-EX.
036600 FAIL-ROUTINE-WRITE.
036700     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
036800     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
036900     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
037000     MOVE   SPACES TO COR-ANSI-REFERENCE.
037100 FAIL-ROUTINE-EX. EXIT.
037200 BAIL-OUT.
037300     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
037400     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
037500 BAIL-OUT-WRITE.
037600     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
037700     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
037800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037900     MOVE   SPACES TO INF-ANSI-REFERENCE.
038000 BAIL-OUT-EX. EXIT.
038100 CCVS1-EXIT.
038200     EXIT.
038300 SECT-IC112-0001 SECTION.
038400 SEQ-INIT-007.
038500     MOVE FILE-RECORD-INFO-SKELETON
038600          TO FILE-RECORD-INFO-P1-120 (1).
038700     MOVE "SQ-FS3" TO XFILE-NAME (1).
038800     MOVE "R1-F-G" TO XRECORD-NAME (1).
038900     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
039000     MOVE 120 TO XRECORD-LENGTH (1).
039100     MOVE "CH" TO CHARS-OR-RECORDS (1).
039200     MOVE 120 TO XBLOCK-SIZE (1).
039300     MOVE 000649 TO RECORDS-IN-FILE (1).
039400     MOVE "SQ" TO XFILE-ORGANIZATION (1).
039500     MOVE "S" TO XLABEL-TYPE (1).
039600     MOVE 000001 TO XRECORD-NUMBER (1).
039700     OPEN OUTPUT SQ-FS3.
039800 SEQ-TEST-007.
039900     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-FS3R1-F-G-120.
040000     WRITE SQ-FS3R1-F-G-120.
040100     IF XRECORD-NUMBER (1) EQUAL TO 649
040200        GO TO SEQ-WRITE-007.
040300     ADD 1 TO XRECORD-NUMBER (1).
040400     GO TO SEQ-TEST-007.
040500 SEQ-WRITE-007.
040600     MOVE "CREATE FILE SQ-FS3" TO FEATURE.
040700     MOVE "SEQ-TEST-007" TO PAR-NAME.
040800     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
040900     MOVE XRECORD-NUMBER (1) TO CORRECT-18V0.
041000     PERFORM PRINT-DETAIL.
041100     CLOSE SQ-FS3.
041200*        A MASS STORAGE SEQUENTIAL FILE WITH 120 CHARACTER
041300*    RECORDS HAS BEEN CREATED.  THE FILE CONTAINS 649 RECORDS.
041400 SEQ-INIT-008.
041500     MOVE ZERO TO WRK-CS-09V00.
041600*        THIS TEST READS AND CHECKS THE FILE CREATED IN
041700*    SEQ-TEST-007.
041800     OPEN INPUT SQ-FS3.
041900 SEQ-TEST-008.
042000     READ SQ-FS3 RECORD
042100         AT END GO TO SEQ-TEST-008-1.
042200     MOVE SQ-FS3R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
042300     ADD 1 TO WRK-CS-09V00.
042400     IF WRK-CS-09V00 GREATER THAN 649
042500         MOVE "MORE THAN 649 RECORDS" TO RE-MARK
042600         GO TO SEQ-FAIL-008.
042700     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
042800         ADD 1 TO RECORDS-IN-ERROR
042900         GO TO SEQ-TEST-008.
043000     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS3"
043100         ADD 1 TO RECORDS-IN-ERROR
043200         GO TO SEQ-TEST-008.
043300     IF XLABEL-TYPE (1) NOT EQUAL TO "S"
043400     ADD 1 TO RECORDS-IN-ERROR.
043500     GO TO SEQ-TEST-008.
043600 SEQ-TEST-008-1.
043700     IF RECORDS-IN-ERROR EQUAL TO ZERO
043800          GO TO SEQ-PASS-008.
043900     MOVE "ERRORS IN READING SQ-FS3" TO RE-MARK.
044000 SEQ-FAIL-008.
044100     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
044200     PERFORM FAIL.
044300     GO TO SEQ-WRITE-008.
044400 SEQ-PASS-008.
044500     PERFORM PASS.
044600     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
044700     MOVE WRK-CS-09V00 TO CORRECT-18V0.
044800 SEQ-WRITE-008.
044900     MOVE "SEQ-TEST-008" TO PAR-NAME.
045000     MOVE "VERIFY FILE SQ-FS3" TO FEATURE.
045100     PERFORM PRINT-DETAIL.
045200 SEQ-CLOSE-008.
045300     CLOSE SQ-FS3.
045400 LINK-INIT-08.
045500     MOVE ZERO TO WRK-CS-09V00.
045600     MOVE ZERO TO RECORDS-IN-ERROR.
045700     OPEN INPUT SQ-FS3.
045800*
045900*         LINK-TEST-08 READS THE FILE SQ-FS3 AND CALLS THE SUB-
046000*    PROGRAM IC113 TO CHECK THE FIELDS IN THE RECORD.  THE FILE
046100*    DESCRIPTION RECORD IS ONE OF THE OPERANDS IN THE USING
046200*    PHRASE OF THE CALL STATEMENT.
046300*
046400     MOVE ZERO TO ERROR-FLAG.
046500 LINK-TEST-08.
046600     READ SQ-FS3 RECORD
046700          AT END    MOVE "UNEXPECTED EOF" TO COMPUTED-A
046800                    MOVE 1 TO EOF-FLAG
046900                    GO TO LINK-FAIL-08.
047000     CALL "IC113A" USING RECORDS-IN-ERROR   SQ-FS3R1-F-G-120
047100             ERROR-FLAG  WRK-CS-09V00.
047200     IF WRK-CS-09V00 LESS THAN 649
047300          GO TO LINK-TEST-08.
047400 LINK-TEST-08-01.
047500     IF ERROR-FLAG EQUAL TO ZERO
047600          GO TO LINK-PASS-08.
047700     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
047800 LINK-FAIL-08.
047900     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
048000     MOVE "CORRECT COL. = RECORDS-IN-ERROR" TO RE-MARK.
048100     PERFORM FAIL.
048200     GO TO LINK-WRITE-08.
048300 LINK-PASS-08.
048400     PERFORM PASS.
048500 LINK-WRITE-08.
048600     MOVE "LINK-TEST-08" TO PAR-NAME.
048700     MOVE "USING FD 01 RECORD" TO FEATURE.
048800     PERFORM PRINT-DETAIL.
048900 LINK-INIT-09.
049000     MOVE ZERO TO RECORDS-IN-ERROR  ERROR-FLAG.
049100*
049200*         LINK-TEST-09 READS THE FILE SQ-FS3.  THE AT END PHRASE
049300*    OF THE READ STATEMENT SHOULD BE EXECUTED.  A CALL TO THE
049400*    SUBPROGRAM IC113 IS CONTAINED IN THE AT END PHRASE WITH
049500*    THE FD 01 RECORD AS ONE OF THE USING OPERANDS.
049600*
049700 LINK-TEST-09-01.
049800     IF EOF-FLAG EQUAL TO 1
049900           CALL "IC113A" USING RECORDS-IN-ERROR   SQ-FS3R1-F-G-120
050000                              ERROR-FLAG  WRK-CS-09V00
050100           GO TO LINK-TEST-09-02.
050200 LINK-TEST-09.
050300     READ SQ-FS3
050400          AT END CALL "IC113A" USING RECORDS-IN-ERROR
050500                      SQ-FS3R1-F-G-120  ERROR-FLAG WRK-CS-09V00
050600                 GO TO LINK-TEST-09-02.
050700     MOVE "MORE THAN 649 RECORDS" TO RE-MARK.
050800     GO TO LINK-FAIL-09.
050900 LINK-TEST-09-02.
051000     IF ERROR-FLAG EQUAL TO 1
051100          GO TO LINK-PASS-09.
051200     MOVE "ERROR FLAG NOT SET IN SUBPRGRM" TO RE-MARK.
051300 LINK-FAIL-09.
051400     PERFORM FAIL.
051500     GO TO LINK-WRITE-09.
051600 LINK-PASS-09.
051700     PERFORM PASS.
051800 LINK-WRITE-09.
051900     MOVE "LINK-TEST-09" TO PAR-NAME.
052000     MOVE "CALL AFTER AT END" TO FEATURE.
052100     PERFORM PRINT-DETAIL.
052200     CLOSE   SQ-FS3.
052300 EXIT-IC112.
052400     EXIT.
052500XFILE-DUMP SECTION.
052600XFILE-3-DUMP-INIT.
052700X    OPEN INPUT SQ-FS3.
052800X    MOVE ZERO TO WRK-CS-09V00.
052900XFILE-3-DUMP.
053000X    ADD 1 TO WRK-CS-09V00.
053100X    IF WRK-CS-09V00 GREATER THAN 649
053200X         GO TO FILE-3-DUMP-EXTRA.
053300X    READ SQ-FS3 RECORD AT END
053400X         GO TO FILE-3-DUMP-END.
053500X    PERFORM FILE-3-DUMP-WRITE.
053600X    GO TO FILE-3-DUMP.
053700XFILE-3-DUMP-WRITE.
053800X    MOVE SQ-FS3R1-F-G-120 TO DUMMY-RECORD.
053900X    PERFORM WRITE-LINE.
054000XFILE-3-DUMP-EXTRA.
054100X    PERFORM BLANK-LINE-PRINT 5 TIMES.
054200XFILE-3-DUMP-MORE.
054300X    READ SQ-FS3 RECORD AT END
054400X         GO TO FILE-3-DUMP-END.
054500X    PERFORM FILE-3-DUMP-WRITE.
054600X    ADD 1 TO WRK-CS-09V00.
054700X    IF WRK-CS-09V00 LESS THAN 669
054800X         GO TO FILE-3-DUMP-MORE.
054900XFILE-3-DUMP-END.
055000X    CLOSE SQ-FS3.
055100XFILE-3-DUMP-EXIT.
055200X    EXIT.
055300 CCVS-EXIT SECTION.
055400 CCVS-999999.
055500     GO TO CLOSE-FILES.
