000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RL114A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*            X-21   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR   *
001700*                    RELATIVE  I-O DATA FILE                   *
001800*            X-55   SYSTEM PRINTER                             *
001900*            X-69   ADDITIONAL VALUE OF CLAUSES                *
002000*            X-74   VALUE OF IMPLEMENTOR-NAME                  *
002100*            X-75   OBJECT OF VALUE OF CLAUSE                  *
002200*            X-82   SOURCE-COMPUTER                            *
002300*            X-83   OBJECT-COMPUTER.                           *
002400*                                                              *
002500****************************************************************
002600*    RL114A                                                    *
002700****************************************************************
002800*            THIS PROGRAM TESTS THE SYNTACTICAL CONSTRUCTS AND
002900*            SEMANTIC ACTIONS ASSOCIATED WITH THE "USE"
003000*            STATEMENT.
003100*
003200*
003300*            THIS PROGRAM CREATES A RELATIVE I-O FILE CONTAINING
003400*            500 RECORDS (ACCESS MODE RANDOM).  IT THEN CLOSES THE
003500*            FILE AND RE-OPENS IT IS I-O AND READS ALL THE RECORDS
003600*            AND ATTEMPTS TO READ THE 501ST RECORD TO GIVE STATUS
003700*            CODE 23.    SEE STANDARD REF VIII-4 1.3.4 (3) B, 1).
003800*            THE READ, WRITE AND REWRITE STATEMENTS ARE USED
003900*            WITHOUT THE APPROPRIATE AT END ON INVALID KEY PHRASES
004000*            WHICH IS PERMITTED IF AN APPLICABLE USE PROCEDURE
004100*            HAS BEEN SPECIFIED.
004200*
004300***************************************************
004400 ENVIRONMENT DIVISION.
004500 CONFIGURATION SECTION.
004600 SOURCE-COMPUTER.
004700     XXXXX082.
004800 OBJECT-COMPUTER.
004900     XXXXX083.
005000 INPUT-OUTPUT SECTION.
005100 FILE-CONTROL.
005200     SELECT PRINT-FILE ASSIGN TO
005300     XXXXX055.
005400     SELECT   RL-FD2 ASSIGN
005500     XXXXX022
005600              ORGANIZATION RELATIVE
005700              ACCESS  RANDOM
005800              RELATIVE  RL-FD2-KEY
005900         FILE STATUS IS RL-FD2-STATUS.
006000 DATA DIVISION.
006100 FILE SECTION.
006200 FD  PRINT-FILE.
006300 01  PRINT-REC PICTURE X(120).
006400 01  DUMMY-RECORD PICTURE X(120).
006500 FD  RL-FD2
006600C    VALUE OF
006700C    XXXXX074
006800C    IS
006900C    XXXXX076
007000G    XXXXX069
007100     LABEL RECORDS ARE STANDARD
007200     BLOCK CONTAINS 1 RECORDS
007300     DATA RECORD RL-FD2R1-F-G-240.
007400 01  RL-FD2R1-F-G-240.
007500     05 RL-FD2-WRK-120 PIC X(120).
007600     05 RL-FD2-GRP-120.
007700        10 RL-FD2-WRK-XN-0001-O120F
007800                        PICTURE X OCCURS 120 TIMES.
007900 WORKING-STORAGE SECTION.
008000 01  GRP-0001.
008100     05 RL-FD2-KEY   PIC 9(8)  VALUE ZERO.
008200     05 WRK-CS-09V00-012  PIC S9(9) USAGE COMP  VALUE ZERO.
008300     05 WRK-CS-09V00-013  PIC S9(9) USAGE COMP  VALUE ZERO.
008400     05 WRK-CS-09V00-014  PIC S9(9) USAGE COMP  VALUE ZERO.
008500     05 WRK-CS-09V00-015  PIC S9(9) USAGE COMP  VALUE ZERO.
008600     05 WRK-CS-09V00-016  PIC S9(9) USAGE COMP  VALUE ZERO.
008700     05 WRK-CS-09V00-017  PIC S9(9) USAGE COMP  VALUE ZERO.
008800     05 WRK-CS-09V00-018  PIC S9(9) USAGE COMP  VALUE ZERO.
008900     05 RL-FD2-STATUS     PIC  XX  VALUE  SPACE.
009000     05 WRK-XN-0002-001   PIC  X(2) VALUE  SPACE.
009100     05 WRK-XN-0002-002   PIC  X(2) VALUE  SPACE.
009200     05 WRK-XN-0002-003   PIC  X(2) VALUE  SPACE.
009300     05 WRK-XN-0002-004   PIC  X(2) VALUE  SPACE.
009400     05 WRK-XN-0002-005   PIC  X(2) VALUE  SPACE.
009500     05 WRK-XN-0002-006   PIC  X(2) VALUE  SPACE.
009600     05 WRK-XN-0002-007   PIC  X(2) VALUE  SPACE.
009700     05 WRK-XN-0002-008   PIC  X(2) VALUE  SPACE.
009800     05 WRK-XN-0002-009   PIC  X(2) VALUE  SPACE.
009900 01  FILE-RECORD-INFORMATION-REC.
010000     03 FILE-RECORD-INFO-SKELETON.
010100        05 FILLER                 PICTURE X(48)       VALUE
010200             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
010300        05 FILLER                 PICTURE X(46)       VALUE
010400             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
010500        05 FILLER                 PICTURE X(26)       VALUE
010600             ",LFIL=000000,ORG=  ,LBLR= ".
010700        05 FILLER                 PICTURE X(37)       VALUE
010800             ",RECKEY=                             ".
010900        05 FILLER                 PICTURE X(38)       VALUE
011000             ",ALTKEY1=                             ".
011100        05 FILLER                 PICTURE X(38)       VALUE
011200             ",ALTKEY2=                             ".
011300        05 FILLER                 PICTURE X(7)        VALUE SPACE.
011400     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
011500        05 FILE-RECORD-INFO-P1-120.
011600           07 FILLER              PIC X(5).
011700           07 XFILE-NAME           PIC X(6).
011800           07 FILLER              PIC X(8).
011900           07 XRECORD-NAME         PIC X(6).
012000           07 FILLER              PIC X(1).
012100           07 REELUNIT-NUMBER     PIC 9(1).
012200           07 FILLER              PIC X(7).
012300           07 XRECORD-NUMBER       PIC 9(6).
012400           07 FILLER              PIC X(6).
012500           07 UPDATE-NUMBER       PIC 9(2).
012600           07 FILLER              PIC X(5).
012700           07 ODO-NUMBER          PIC 9(4).
012800           07 FILLER              PIC X(5).
012900           07 XPROGRAM-NAME        PIC X(5).
013000           07 FILLER              PIC X(7).
013100           07 XRECORD-LENGTH       PIC 9(6).
013200           07 FILLER              PIC X(7).
013300           07 CHARS-OR-RECORDS    PIC X(2).
013400           07 FILLER              PIC X(1).
013500           07 XBLOCK-SIZE          PIC 9(4).
013600           07 FILLER              PIC X(6).
013700           07 RECORDS-IN-FILE     PIC 9(6).
013800           07 FILLER              PIC X(5).
013900           07 XFILE-ORGANIZATION   PIC X(2).
014000           07 FILLER              PIC X(6).
014100           07 XLABEL-TYPE          PIC X(1).
014200        05 FILE-RECORD-INFO-P121-240.
014300           07 FILLER              PIC X(8).
014400           07 XRECORD-KEY          PIC X(29).
014500           07 FILLER              PIC X(9).
014600           07 ALTERNATE-KEY1      PIC X(29).
014700           07 FILLER              PIC X(9).
014800           07 ALTERNATE-KEY2      PIC X(29).
014900           07 FILLER              PIC X(7).
015000 01  TEST-RESULTS.
015100     02 FILLER                   PIC X      VALUE SPACE.
015200     02 FEATURE                  PIC X(20)  VALUE SPACE.
015300     02 FILLER                   PIC X      VALUE SPACE.
015400     02 P-OR-F                   PIC X(5)   VALUE SPACE.
015500     02 FILLER                   PIC X      VALUE SPACE.
015600     02  PAR-NAME.
015700       03 FILLER                 PIC X(19)  VALUE SPACE.
015800       03  PARDOT-X              PIC X      VALUE SPACE.
015900       03 DOTVALUE               PIC 99     VALUE ZERO.
016000     02 FILLER                   PIC X(8)   VALUE SPACE.
016100     02 RE-MARK                  PIC X(61).
016200 01  TEST-COMPUTED.
016300     02 FILLER                   PIC X(30)  VALUE SPACE.
016400     02 FILLER                   PIC X(17)  VALUE
016500            "       COMPUTED=".
016600     02 COMPUTED-X.
016700     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
016800     03 COMPUTED-N               REDEFINES COMPUTED-A
016900                                 PIC -9(9).9(9).
017000     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
017100     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
017200     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
017300     03       CM-18V0 REDEFINES COMPUTED-A.
017400         04 COMPUTED-18V0                    PIC -9(18).
017500         04 FILLER                           PIC X.
017600     03 FILLER PIC X(50) VALUE SPACE.
017700 01  TEST-CORRECT.
017800     02 FILLER PIC X(30) VALUE SPACE.
017900     02 FILLER PIC X(17) VALUE "       CORRECT =".
018000     02 CORRECT-X.
018100     03 CORRECT-A                  PIC X(20) VALUE SPACE.
018200     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
018300     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
018400     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
018500     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
018600     03      CR-18V0 REDEFINES CORRECT-A.
018700         04 CORRECT-18V0                     PIC -9(18).
018800         04 FILLER                           PIC X.
018900     03 FILLER PIC X(2) VALUE SPACE.
019000     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
019100 01  CCVS-C-1.
019200     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
019300-    "SS  PARAGRAPH-NAME
019400-    "       REMARKS".
019500     02 FILLER                     PIC X(20)    VALUE SPACE.
019600 01  CCVS-C-2.
019700     02 FILLER                     PIC X        VALUE SPACE.
019800     02 FILLER                     PIC X(6)     VALUE "TESTED".
019900     02 FILLER                     PIC X(15)    VALUE SPACE.
020000     02 FILLER                     PIC X(4)     VALUE "FAIL".
020100     02 FILLER                     PIC X(94)    VALUE SPACE.
020200 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
020300 01  REC-CT                        PIC 99       VALUE ZERO.
020400 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
020500 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
020600 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
020700 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
020800 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
020900 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
021000 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
021100 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
021200 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
021300 01  CCVS-H-1.
021400     02  FILLER                    PIC X(39)    VALUE SPACES.
021500     02  FILLER                    PIC X(42)    VALUE
021600     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
021700     02  FILLER                    PIC X(39)    VALUE SPACES.
021800 01  CCVS-H-2A.
021900   02  FILLER                        PIC X(40)  VALUE SPACE.
022000   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
022100   02  FILLER                        PIC XXXX   VALUE
022200     "4.2 ".
022300   02  FILLER                        PIC X(28)  VALUE
022400            " COPY - NOT FOR DISTRIBUTION".
022500   02  FILLER                        PIC X(41)  VALUE SPACE.
022600
022700 01  CCVS-H-2B.
022800   02  FILLER                        PIC X(15)  VALUE
022900            "TEST RESULT OF ".
023000   02  TEST-ID                       PIC X(9).
023100   02  FILLER                        PIC X(4)   VALUE
023200            " IN ".
023300   02  FILLER                        PIC X(12)  VALUE
023400     " HIGH       ".
023500   02  FILLER                        PIC X(22)  VALUE
023600            " LEVEL VALIDATION FOR ".
023700   02  FILLER                        PIC X(58)  VALUE
023800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
023900 01  CCVS-H-3.
024000     02  FILLER                      PIC X(34)  VALUE
024100            " FOR OFFICIAL USE ONLY    ".
024200     02  FILLER                      PIC X(58)  VALUE
024300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
024400     02  FILLER                      PIC X(28)  VALUE
024500            "  COPYRIGHT   1985 ".
024600 01  CCVS-E-1.
024700     02 FILLER                       PIC X(52)  VALUE SPACE.
024800     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
024900     02 ID-AGAIN                     PIC X(9).
025000     02 FILLER                       PIC X(45)  VALUE SPACES.
025100 01  CCVS-E-2.
025200     02  FILLER                      PIC X(31)  VALUE SPACE.
025300     02  FILLER                      PIC X(21)  VALUE SPACE.
025400     02 CCVS-E-2-2.
025500         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
025600         03 FILLER                   PIC X      VALUE SPACE.
025700         03 ENDER-DESC               PIC X(44)  VALUE
025800            "ERRORS ENCOUNTERED".
025900 01  CCVS-E-3.
026000     02  FILLER                      PIC X(22)  VALUE
026100            " FOR OFFICIAL USE ONLY".
026200     02  FILLER                      PIC X(12)  VALUE SPACE.
026300     02  FILLER                      PIC X(58)  VALUE
026400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
026500     02  FILLER                      PIC X(13)  VALUE SPACE.
026600     02 FILLER                       PIC X(15)  VALUE
026700             " COPYRIGHT 1985".
026800 01  CCVS-E-4.
026900     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
027000     02 FILLER                       PIC X(4)   VALUE " OF ".
027100     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
027200     02 FILLER                       PIC X(40)  VALUE
027300      "  TESTS WERE EXECUTED SUCCESSFULLY".
027400 01  XXINFO.
027500     02 FILLER                       PIC X(19)  VALUE
027600            "*** INFORMATION ***".
027700     02 INFO-TEXT.
027800       04 FILLER                     PIC X(8)   VALUE SPACE.
027900       04 XXCOMPUTED                 PIC X(20).
028000       04 FILLER                     PIC X(5)   VALUE SPACE.
028100       04 XXCORRECT                  PIC X(20).
028200     02 INF-ANSI-REFERENCE           PIC X(48).
028300 01  HYPHEN-LINE.
028400     02 FILLER  PIC IS X VALUE IS SPACE.
028500     02 FILLER  PIC IS X(65)    VALUE IS "************************
028600-    "*****************************************".
028700     02 FILLER  PIC IS X(54)    VALUE IS "************************
028800-    "******************************".
028900 01  CCVS-PGM-ID                     PIC X(9)   VALUE
029000     "RL114A".
029100 PROCEDURE DIVISION.
029200 DECLARATIVES.
029300 RL-FD2-01 SECTION.
029400     USE     AFTER ERROR PROCEDURE RL-FD2.
029500 RL-FD2-01-01.
029600     MOVE   "PASS " TO P-OR-F.
029700     ADD     1 TO PASS-COUNTER.
029800*
029900     IF      REC-CT NOT EQUAL TO ZERO
030000             MOVE "." TO PARDOT-X
030100             MOVE REC-CT TO DOTVALUE.
030200     MOVE    TEST-RESULTS TO PRINT-REC.
030300     PERFORM D1-WRITE-LINE THRU D1-WRITE-LINE-EXIT.
030400     IF      P-OR-F EQUAL TO "FAIL*"
030500             PERFORM D1-WRITE-LINE THRU D1-WRITE-LINE-EXIT
030600             PERFORM D1-FAIL-ROUTINE THRU D1-FAIL-ROUTINE-EX
030700      ELSE
030800             PERFORM D1-BAIL-OUT THRU D1-BAIL-OUT-EX.
030900     MOVE    SPACE TO P-OR-F.
031000     MOVE    SPACE TO COMPUTED-X.
031100     MOVE    SPACE TO CORRECT-X.
031200     IF      REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
031300     MOVE    SPACE TO RE-MARK.
031400     ADD     1 TO WRK-CS-09V00-013.
031500     MOVE    RL-FD2-STATUS TO WRK-XN-0002-002.
031600     MOVE    "23" TO WRK-XN-0002-003.
031700     GO TO   RL-FD2-01-EXIT.
031800 D1-FAIL-ROUTINE.
031900     IF      COMPUTED-X NOT EQUAL TO SPACE
032000             GO TO   D1-FAIL-ROUTINE-WRITE.
032100     IF      CORRECT-X NOT EQUAL TO SPACE
032200             GO TO   D1-FAIL-ROUTINE-WRITE.
032300     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
032400     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
032500     MOVE    XXINFO TO DUMMY-RECORD.
032600     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
032700     MOVE    SPACE TO DUMMY-RECORD.
032800     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
032900     MOVE    SPACE TO DUMMY-RECORD.
033000     MOVE    SPACES TO INF-ANSI-REFERENCE.
033100     GO TO   D1-FAIL-ROUTINE-EX.
033200 D1-FAIL-ROUTINE-WRITE.
033300     MOVE    TEST-COMPUTED TO PRINT-REC.
033400     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
033500     MOVE    SPACE TO DUMMY-RECORD.
033600     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
033700     MOVE    TEST-CORRECT TO PRINT-REC.
033800     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
033900     MOVE    SPACE TO DUMMY-RECORD.
034000     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
034100     MOVE    SPACE TO DUMMY-RECORD.
034200     MOVE    SPACES TO COR-ANSI-REFERENCE.
034300 D1-FAIL-ROUTINE-EX.
034400     EXIT.
034500 D1-BAIL-OUT.
034600     IF      COMPUTED-A NOT EQUAL TO SPACE
034700             GO TO    D1-BAIL-OUT-WRITE.
034800     IF      CORRECT-A EQUAL TO SPACE
034900             GO TO    D1-BAIL-OUT-EX.
035000 D1-BAIL-OUT-WRITE.
035100     MOVE    CORRECT-A  TO XXCORRECT.
035200     MOVE    COMPUTED-A TO XXCOMPUTED.
035300     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
035400     MOVE    XXINFO TO DUMMY-RECORD.
035500     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
035600     MOVE    SPACE TO DUMMY-RECORD.
035700     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
035800     MOVE    SPACE TO DUMMY-RECORD.
035900     MOVE    SPACES TO INF-ANSI-REFERENCE.
036000 D1-BAIL-OUT-EX.
036100     EXIT.
036200 D1-WRITE-LINE.
036300     ADD     1 TO RECORD-COUNT.
036400Y    IF      RECORD-COUNT GREATER 50
036500Y            MOVE    DUMMY-RECORD TO DUMMY-HOLD
036600Y            MOVE    SPACE TO DUMMY-RECORD
036700Y            WRITE   DUMMY-RECORD AFTER ADVANCING PAGE
036800Y            MOVE    CCVS-C-1 TO DUMMY-RECORD
036900Y            WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES
037000Y            MOVE    SPACE TO DUMMY-RECORD
037100Y            MOVE    CCVS-C-2 TO DUMMY-RECORD
037200Y            WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES
037300Y            MOVE    SPACE TO DUMMY-RECORD
037400Y            WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES
037500Y            MOVE    SPACE TO DUMMY-RECORD
037600Y            MOVE    HYPHEN-LINE TO DUMMY-RECORD
037700Y            WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES
037800Y            MOVE    SPACE TO DUMMY-RECORD
037900Y            MOVE    DUMMY-HOLD TO DUMMY-RECORD
038000Y            MOVE    ZERO TO RECORD-COUNT.
038100     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
038200     MOVE    SPACE TO DUMMY-RECORD.
038300 D1-WRITE-LINE-EXIT.
038400     EXIT.
038500 RL-FD2-01-EXIT.
038600     EXIT.
038700 RL-FD2-01-03 SECTION.
038800     USE     AFTER EXCEPTION PROCEDURE OUTPUT.
038900 RL-FD2-01-03-01.
039000     MOVE   "RL-FD2-01-03" TO PAR-NAME.
039100     MOVE   "USE AFTER EXCEPTION PROCEDURE SHOULD NOT BE OBEYED"
039200          TO RE-MARK.
039300     MOVE   "FAIL*" TO P-OR-F.
039400     ADD     1 TO ERROR-COUNTER.
039500*
039600     IF      REC-CT NOT EQUAL TO ZERO
039700             MOVE "." TO PARDOT-X
039800             MOVE REC-CT TO DOTVALUE.
039900     MOVE    TEST-RESULTS TO PRINT-REC.
040000     PERFORM D2-WRITE-LINE THRU D2-WRITE-LINE-EXIT.
040100     IF      P-OR-F EQUAL TO "FAIL*"
040200             PERFORM D2-WRITE-LINE THRU D2-WRITE-LINE-EXIT
040300             PERFORM D2-FAIL-ROUTINE THRU D2-FAIL-ROUTINE-EX
040400      ELSE
040500             PERFORM D2-BAIL-OUT THRU D2-BAIL-OUT-EX.
040600     MOVE    SPACE TO P-OR-F.
040700     MOVE    SPACE TO COMPUTED-X.
040800     MOVE    SPACE TO CORRECT-X.
040900     IF      REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
041000     MOVE    SPACE TO RE-MARK.
041100     GO TO   RL-FD2-01-03-EXIT.
041200 D2-FAIL-ROUTINE.
041300     IF      COMPUTED-X NOT EQUAL TO SPACE
041400             GO TO   D2-FAIL-ROUTINE-WRITE.
041500     IF      CORRECT-X NOT EQUAL TO SPACE
041600             GO TO   D2-FAIL-ROUTINE-WRITE.
041700     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
041800     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
041900     MOVE    XXINFO TO DUMMY-RECORD.
042000     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
042100     MOVE    SPACE TO DUMMY-RECORD.
042200     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
042300     MOVE    SPACE TO DUMMY-RECORD.
042400     MOVE    SPACES TO INF-ANSI-REFERENCE.
042500     GO TO   D2-FAIL-ROUTINE-EX.
042600 D2-FAIL-ROUTINE-WRITE.
042700     MOVE    TEST-COMPUTED TO PRINT-REC.
042800     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
042900     MOVE    SPACE TO DUMMY-RECORD.
043000     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
043100     MOVE    TEST-CORRECT TO PRINT-REC.
043200     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
043300     MOVE    SPACE TO DUMMY-RECORD.
043400     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
043500     MOVE    SPACE TO DUMMY-RECORD.
043600     MOVE    SPACES TO COR-ANSI-REFERENCE.
043700 D2-FAIL-ROUTINE-EX.
043800     EXIT.
043900 D2-BAIL-OUT.
044000     IF      COMPUTED-A NOT EQUAL TO SPACE
044100             GO TO    D2-BAIL-OUT-WRITE.
044200     IF      CORRECT-A EQUAL TO SPACE
044300             GO TO    D2-BAIL-OUT-EX.
044400 D2-BAIL-OUT-WRITE.
044500     MOVE    CORRECT-A  TO XXCORRECT.
044600     MOVE    COMPUTED-A TO XXCOMPUTED.
044700     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
044800     MOVE    XXINFO TO DUMMY-RECORD.
044900     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
045000     MOVE    SPACE TO DUMMY-RECORD.
045100     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
045200     MOVE    SPACE TO DUMMY-RECORD.
045300     MOVE    SPACES TO INF-ANSI-REFERENCE.
045400 D2-BAIL-OUT-EX.
045500     EXIT.
045600 D2-WRITE-LINE.
045700     ADD     1 TO RECORD-COUNT.
045800Y    IF      RECORD-COUNT GREATER 50
045900Y            MOVE    DUMMY-RECORD TO DUMMY-HOLD
046000Y            MOVE    SPACE TO DUMMY-RECORD
046100Y            WRITE   DUMMY-RECORD AFTER ADVANCING PAGE
046200Y            MOVE    CCVS-C-1 TO DUMMY-RECORD
046300Y            WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES
046400Y            MOVE    SPACE TO DUMMY-RECORD
046500Y            MOVE    CCVS-C-2 TO DUMMY-RECORD
046600Y            WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES
046700Y            MOVE    SPACE TO DUMMY-RECORD
046800Y            WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES
046900Y            MOVE    SPACE TO DUMMY-RECORD
047000Y            MOVE    HYPHEN-LINE TO DUMMY-RECORD
047100Y            WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES
047200Y            MOVE    SPACE TO DUMMY-RECORD
047300Y            MOVE    DUMMY-HOLD TO DUMMY-RECORD
047400Y            MOVE    ZERO TO RECORD-COUNT.
047500     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
047600     MOVE    SPACE TO DUMMY-RECORD.
047700 D2-WRITE-LINE-EXIT.
047800*    EXIT.
047900************ PRINT-DETAIL COPIED HERE **************
048000     IF REC-CT NOT EQUAL TO ZERO
048100             MOVE "." TO PARDOT-X
048200             MOVE REC-CT TO DOTVALUE.
048300     MOVE  TEST-RESULTS TO PRINT-REC. PERFORM D2-WRITE-LINE.
048400     IF P-OR-F EQUAL TO "FAIL*"  PERFORM D2-WRITE-LINE
048500        PERFORM D2-FAIL-ROUTINE THRU D2-FAIL-ROUTINE-EX
048600          ELSE PERFORM D2-BAIL-OUT THRU D2-BAIL-OUT-EX.
048700     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
048800     MOVE SPACE TO CORRECT-X.
048900     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
049000     MOVE     SPACE TO RE-MARK.
049100 RL-FD2-01-03-EXIT.
049200     EXIT.
049300 END DECLARATIVES.
049400 CCVS1 SECTION.
049500 OPEN-FILES.
049600     OPEN    OUTPUT PRINT-FILE.
049700     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
049800     MOVE    SPACE TO TEST-RESULTS.
049900     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
050000     MOVE    ZERO TO REC-SKL-SUB.
050100     PERFORM CCVS-INIT-FILE 9 TIMES.
050200 CCVS-INIT-FILE.
050300     ADD     1 TO REC-SKL-SUB.
050400     MOVE    FILE-RECORD-INFO-SKELETON
050500          TO FILE-RECORD-INFO (REC-SKL-SUB).
050600 CCVS-INIT-EXIT.
050700     GO TO CCVS1-EXIT.
050800 CLOSE-FILES.
050900     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
051000 TERMINATE-CCVS.
051100S    EXIT PROGRAM.
051200STERMINATE-CALL.
051300     STOP     RUN.
051400 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
051500 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
051600 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
051700 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
051800     MOVE "****TEST DELETED****" TO RE-MARK.
051900 PRINT-DETAIL.
052000     IF REC-CT NOT EQUAL TO ZERO
052100             MOVE "." TO PARDOT-X
052200             MOVE REC-CT TO DOTVALUE.
052300     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
052400     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
052500        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
052600          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
052700     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
052800     MOVE SPACE TO CORRECT-X.
052900     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
053000     MOVE     SPACE TO RE-MARK.
053100 HEAD-ROUTINE.
053200     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
053300     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
053400     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
053500     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
053600 COLUMN-NAMES-ROUTINE.
053700     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
053800     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
053900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
054000 END-ROUTINE.
054100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
054200 END-RTN-EXIT.
054300     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
054400 END-ROUTINE-1.
054500      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
054600      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
054700      ADD PASS-COUNTER TO ERROR-HOLD.
054800*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
054900      MOVE PASS-COUNTER TO CCVS-E-4-1.
055000      MOVE ERROR-HOLD TO CCVS-E-4-2.
055100      MOVE CCVS-E-4 TO CCVS-E-2-2.
055200      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
055300  END-ROUTINE-12.
055400      MOVE "TEST(S) FAILED" TO ENDER-DESC.
055500     IF       ERROR-COUNTER IS EQUAL TO ZERO
055600         MOVE "NO " TO ERROR-TOTAL
055700         ELSE
055800         MOVE ERROR-COUNTER TO ERROR-TOTAL.
055900     MOVE     CCVS-E-2 TO DUMMY-RECORD.
056000     PERFORM WRITE-LINE.
056100 END-ROUTINE-13.
056200     IF DELETE-COUNTER IS EQUAL TO ZERO
056300         MOVE "NO " TO ERROR-TOTAL  ELSE
056400         MOVE DELETE-COUNTER TO ERROR-TOTAL.
056500     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
056600     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
056700      IF   INSPECT-COUNTER EQUAL TO ZERO
056800          MOVE "NO " TO ERROR-TOTAL
056900      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
057000      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
057100      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
057200     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
057300 WRITE-LINE.
057400     ADD 1 TO RECORD-COUNT.
057500Y    IF RECORD-COUNT GREATER 50
057600Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
057700Y        MOVE SPACE TO DUMMY-RECORD
057800Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
057900Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
058000Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
058100Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
058200Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
058300Y        MOVE ZERO TO RECORD-COUNT.
058400     PERFORM WRT-LN.
058500 WRT-LN.
058600     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
058700     MOVE SPACE TO DUMMY-RECORD.
058800 BLANK-LINE-PRINT.
058900     PERFORM WRT-LN.
059000 FAIL-ROUTINE.
059100     IF     COMPUTED-X NOT EQUAL TO SPACE
059200            GO TO   FAIL-ROUTINE-WRITE.
059300     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
059400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
059500     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
059600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
059700     MOVE   SPACES TO INF-ANSI-REFERENCE.
059800     GO TO  FAIL-ROUTINE-EX.
059900 FAIL-ROUTINE-WRITE.
060000     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
060100     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
060200     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
060300     MOVE   SPACES TO COR-ANSI-REFERENCE.
060400 FAIL-ROUTINE-EX. EXIT.
060500 BAIL-OUT.
060600     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
060700     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
060800 BAIL-OUT-WRITE.
060900     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
061000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
061100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
061200     MOVE   SPACES TO INF-ANSI-REFERENCE.
061300 BAIL-OUT-EX. EXIT.
061400 CCVS1-EXIT.
061500     EXIT.
061600 SECT-RL114A-001 SECTION.
061700 REL-INIT-009.
061800     MOVE    "VIII-36 4.8.4 GR4" TO ANSI-REFERENCE.
061900     MOVE    "REL-TEST-009" TO PAR-NAME.
062000     MOVE     "CREATE RL-FD2" TO  FEATURE
062100     MOVE     "RL-FD2"        TO  XFILE-NAME (2).
062200     MOVE     "R1-F-G"        TO  XRECORD-NAME (2).
062300     MOVE CCVS-PGM-ID             TO  XPROGRAM-NAME (2).
062400     MOVE     000240          TO  XRECORD-LENGTH (2).
062500     MOVE     "RC"            TO  CHARS-OR-RECORDS (2).
062600     MOVE     0001            TO  XBLOCK-SIZE       (2).
062700     MOVE     000500          TO  RECORDS-IN-FILE  (2).
062800     MOVE     "RL"            TO  XFILE-ORGANIZATION (2).
062900     MOVE     "S"             TO  XLABEL-TYPE        (2).
063000     MOVE     000001          TO  XRECORD-NUMBER     (2).
063100*INITIALIZE  RECORD WORK AREA NUMBER 2.
063200     MOVE     1         TO  WRK-CS-09V00-012.
063300     MOVE     ZERO      TO  WRK-CS-09V00-013 WRK-CS-09V00-014
063400                            WRK-CS-09V00-015 WRK-CS-09V00-016
063500                            WRK-CS-09V00-017 WRK-CS-09V00-018.
063600     MOVE     SPACE     TO  RL-FD2-STATUS.
063700     MOVE     90000002  TO  RL-FD2-KEY.
063800     MOVE     01 TO REC-CT.
063900     OPEN     OUTPUT    RL-FD2.
064000     MOVE     RL-FD2-STATUS TO WRK-XN-0002-001.
064100*CAPTURE STATUS KEY AFTER  OPEN STATEMENT IS EXECUTED.
064200 REL-TEST-009-R.
064300     MOVE XRECORD-NUMBER (2) TO RL-FD2-KEY.
064400     MOVE    "99"  TO RL-FD2-STATUS.
064500     MOVE     FILE-RECORD-INFO-P1-120 (2) TO RL-FD2-WRK-120.
064600     MOVE     FILE-RECORD-INFO-P1-120 (2) TO
064700               RL-FD2-GRP-120.
064800     WRITE    RL-FD2R1-F-G-240.
064900     IF        RL-FD2-STATUS NOT EQUAL TO "00"
065000              GO TO  REL-TEST-009-2.
065100     IF       XRECORD-NUMBER (2) EQUAL TO 500
065200             GO TO REL-TEST-009-2.
065300     ADD      01 TO  XRECORD-NUMBER (2).
065400     GO TO    REL-TEST-009-R.
065500 REL-TEST-009-2.
065600     IF       WRK-CS-09V00-014 NOT EQUAL TO ZERO
065700              MOVE "EXCEPTIONS/ERRORS" TO RE-MARK
065800              MOVE ZERO TO CORRECT-18V0
065900              MOVE WRK-CS-09V00-014 TO COMPUTED-18V0
066000              PERFORM   FAIL
066100              ELSE
066200              PERFORM   PASS.
066300     PERFORM  PRINT-DETAIL.
066400     ADD      01 TO REC-CT.
066500*    .01
066600     IF       XRECORD-NUMBER (2) NOT EQUAL TO 500
066700              MOVE "INCORRECT COUNT" TO RE-MARK
066800              MOVE  500 TO CORRECT-18V0
066900             MOVE    XRECORD-NUMBER (2)  TO COMPUTED-18V0
067000              PERFORM  FAIL
067100              ELSE
067200              PERFORM PASS.
067300     PERFORM  PRINT-DETAIL.
067400     ADD      01 TO REC-CT.
067500*    .02
067600     IF       WRK-XN-0002-001 NOT EQUAL TO  "00"
067700              MOVE "STATUS/OPEN" TO RE-MARK
067800              MOVE WRK-XN-0002-001 TO COMPUTED-A
067900              MOVE "00" TO CORRECT-A
068000              PERFORM  FAIL
068100              ELSE
068200              PERFORM  PASS.
068300     PERFORM  PRINT-DETAIL.
068400     ADD      01 TO REC-CT.
068500*    .03
068600     IF        RL-FD2-STATUS NOT EQUAL TO "00"
068700              MOVE "STATUS/WRITE" TO RE-MARK
068800              MOVE RL-FD2-STATUS TO COMPUTED-A
068900              MOVE "00" TO CORRECT-A
069000              PERFORM   FAIL
069100              ELSE
069200              PERFORM   PASS.
069300     PERFORM  PRINT-DETAIL.
069400     ADD      01 TO REC-CT.
069500*    .04
069600     MOVE     SPACE  TO  RL-FD2-STATUS.
069700     CLOSE    RL-FD2.
069800     IF        RL-FD2-STATUS NOT EQUAL TO "00"
069900              MOVE "CLOSE/STATUS" TO RE-MARK
070000              MOVE   RL-FD2-STATUS TO COMPUTED-A
070100              MOVE "00" TO CORRECT-A
070200              PERFORM FAIL
070300              ELSE
070400              PERFORM PASS.
070500     PERFORM  PRINT-DETAIL.
070600     ADD      01 TO REC-CT.
070700*    .05
070800 REL-INIT-010.
070900     MOVE    "REL-TEST-010" TO PAR-NAME.
071000     MOVE     2     TO  WRK-CS-09V00-012.
071100     MOVE     ZERO  TO  RL-FD2-KEY.
071200     MOVE     ZERO  TO  WRK-CS-09V00-013.
071300     MOVE     ZERO  TO  WRK-CS-09V00-014.
071400     MOVE     ZERO  TO  WRK-CS-09V00-015.
071500     MOVE     ZERO  TO  WRK-CS-09V00-016.
071600     MOVE     ZERO  TO  WRK-CS-09V00-017.
071700     MOVE     ZERO  TO  WRK-CS-09V00-018.
071800     MOVE     01 TO REC-CT.
071900     OPEN     I-O   RL-FD2.
072000     MOVE     SPACE     TO  WRK-XN-0002-002
072100     MOVE     SPACE     TO  WRK-XN-0002-003
072200     MOVE     SPACE     TO  WRK-XN-0002-004
072300     MOVE      RL-FD2-STATUS TO WRK-XN-0002-001
072400     MOVE     SPACE TO RL-FD2-STATUS.
072500*CAPTURE THE CONTENTS OF STATUS KEY AFTER OPEN IS EXECUTED.
072600     MOVE    "USE/FILE STATUS"  TO FEATURE.
072700 REL-TEST-010-R.
072800     ADD      1 TO RL-FD2-KEY.
072900     ADD      1 TO WRK-CS-09V00-014.
073000     ADD      1 TO WRK-CS-09V00-015.
073100     READ     RL-FD2.
073200     IF       RL-FD2-STATUS EQUAL TO "23"
073300              GO TO  REL-TEST-010-3.
073400     MOVE     RL-FD2-WRK-120 TO FILE-RECORD-INFO-P1-120 (2).
073500     IF       WRK-CS-09V00-015 EQUAL TO 5
073600              ADD 01 TO UPDATE-NUMBER (2)
073700              MOVE FILE-RECORD-INFO-P1-120 (2) TO RL-FD2-WRK-120
073800              REWRITE RL-FD2R1-F-G-240
073900           MOVE ZERO TO WRK-CS-09V00-015
074000              GO TO  REL-TEST-010-2.
074100     IF       WRK-CS-09V00-014 GREATER 500
074200              GO TO  REL-TEST-010-3.
074300     GO TO    REL-TEST-010-R.
074400 REL-TEST-010-2.
074500     IF        RL-FD2-STATUS NOT EQUAL TO "00"
074600              ADD 1 TO WRK-CS-09V00-016.
074700     MOVE    SPACE TO RL-FD2-STATUS.
074800     GO TO    REL-TEST-010-R.
074900 REL-TEST-010-3.
075000     IF       WRK-CS-09V00-013 NOT EQUAL TO 1
075100              MOVE  "EXCEPTIONS/ERRORS" TO RE-MARK
075200              MOVE WRK-CS-09V00-013 TO COMPUTED-18V0
075300              MOVE  1 TO CORRECT-18V0
075400              PERFORM FAIL
075500              ELSE
075600              PERFORM PASS.
075700     PERFORM  PRINT-DETAIL.
075800     ADD      01 TO REC-CT.
075900*    .01
076000     IF       WRK-CS-09V00-014 NOT EQUAL TO 501
076100              MOVE "INCORRECT COUNT" TO RE-MARK
076200              MOVE WRK-CS-09V00-014 TO COMPUTED-18V0
076300              MOVE 501 TO CORRECT-18V0
076400              PERFORM FAIL
076500              ELSE
076600             PERFORM PASS.
076700     PERFORM  PRINT-DETAIL.
076800     ADD      01 TO REC-CT.
076900*    .02
077000     IF       WRK-XN-0002-001 NOT EQUAL TO "00"
077100              MOVE "OPEN/STATUS"  TO  RE-MARK
077200              MOVE WRK-XN-0002-001 TO COMPUTED-A
077300              MOVE  "00" TO CORRECT-A
077400              PERFORM FAIL
077500              ELSE
077600              PERFORM PASS.
077700     PERFORM  PRINT-DETAIL.
077800     ADD      01 TO REC-CT.
077900*    .03
078000     IF        RL-FD2-STATUS NOT EQUAL  TO "23"
078100              MOVE "ATEND/STATUS" TO RE-MARK
078200              MOVE  RL-FD2-STATUS TO COMPUTED-A
078300              MOVE "23" TO CORRECT-A
078400              PERFORM FAIL
078500              ELSE
078600              PERFORM PASS.
078700     PERFORM  PRINT-DETAIL.
078800     ADD      01 TO REC-CT.
078900*    .04
079000     IF       WRK-XN-0002-002 NOT EQUAL TO "23"
079100              MOVE  "EXCEPTIN/STATUS" TO RE-MARK
079200              MOVE  WRK-XN-0002-002 TO COMPUTED-A
079300              MOVE  "23" TO CORRECT-A
079400              PERFORM FAIL
079500              ELSE
079600              PERFORM PASS.
079700     PERFORM  PRINT-DETAIL.
079800     ADD      01 TO REC-CT.
079900*    .05
080000     IF       WRK-XN-0002-003 NOT EQUAL TO "23"
080100              MOVE "NO/EXCEPTION" TO  RE-MARK
080200              MOVE WRK-XN-0002-003 TO COMPUTED-A
080300              MOVE "23" TO CORRECT-A
080400              PERFORM FAIL
080500              ELSE
080600              PERFORM PASS.
080700     PERFORM  PRINT-DETAIL
080800     ADD      01 TO REC-CT.
080900*    .06
081000     MOVE     SPACE TO RL-FD2-STATUS.
081100     CLOSE    RL-FD2
081200     IF        RL-FD2-STATUS NOT EQUAL TO "00"
081300              MOVE "CLOSE/STATUS" TO RE-MARK
081400              MOVE  RL-FD2-STATUS TO  COMPUTED-A
081500              MOVE "00" TO CORRECT-A
081600              PERFORM FAIL
081700              ELSE
081800              PERFORM PASS.
081900     PERFORM  PRINT-DETAIL.
082000     ADD      01 TO REC-CT.
082100*    .07
082200 CCVS-EXIT SECTION.
082300 CCVS-999999.
082400     GO TO CLOSE-FILES.
