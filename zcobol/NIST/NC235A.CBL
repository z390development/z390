000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     NC235A.
000400*
000500****************************************************************
000600*                                                              *
000700*    VALIDATION FOR:-                                          *
000800*                                                              *
000900*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
001000*                                                              *
001100*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001200*                                                              *
001300****************************************************************
001400*                                                              *
001500*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001600*                                                              *
001700*        X-55  - SYSTEM PRINTER NAME.                          *
001800*        X-82  - SOURCE COMPUTER NAME.                         *
001900*        X-83  - OBJECT COMPUTER NAME.                         *
002000*                                                              *
002100****************************************************************
002200*    PROGRAM NC235A TESTS THE USE OF FORMATS 1 AND 2 OF THE    *
002300*    "SEARCH" STATEMENT ON A ONE DIMENSIONAL TABLE WITH A      *
002400*    VARIABLE NUMBER OF OCCURRENCES.   THE TABLE IS DEFINED    *
002500*    USING FORMAT 2 OF THE "OCCURS" CLAUSE.                    *
002600*                                                              *
002700****************************************************************
002800 ENVIRONMENT DIVISION.
002900 CONFIGURATION SECTION.
003000 SOURCE-COMPUTER.
003100     XXXXX082.
003200 OBJECT-COMPUTER.
003300     XXXXX083.
003400 INPUT-OUTPUT SECTION.
003500 FILE-CONTROL.
003600     SELECT PRINT-FILE ASSIGN TO
003700     XXXXX055.
003800 DATA DIVISION.
003900 FILE SECTION.
004000 FD  PRINT-FILE.
004100 01  PRINT-REC PICTURE X(120).
004200 01  DUMMY-RECORD PICTURE X(120).
004300 WORKING-STORAGE SECTION.
004400 77  TBL-LENGTH                  PIC 99  VALUE 26.
004500 77  SUB-1                       PIC 99  VALUE ZERO.
004600 01  TBL-TH309.
004700     02  TH309-ENTRY OCCURS 1 TO 26 DEPENDING TBL-LENGTH
004800         DESCENDING KEY IS DEC-KEY INDEXED BY IDX-1, IDX-2, IDX-3.
004900         03  DEC-KEY             PIC XX.
005000             88  FIRSTZ VALUE "ZZ".
005100             88  LASTA  VALUE "AA".
005200             88  MIDDLE-PP VALUE "PP".
005300 01  NOTE-1.
005400     02  FILLER                  PIC X(74) VALUE
005500     "NOTE 1 - CORRECT AND COMPUTED DATA ARE EQUAL BUT THE AT END
005600-    "PATH WAS TAKEN".
005700     02  FILLER                  PIC X(46) VALUE SPACE.
005800 01  NOTE-2.
005900     02  FILLER                  PIC X(112) VALUE
006000     "NOTE 2 - CORRECT AND COMPUTED DATA ARE NOT EQUAL. THE COMPUT
006100-    "ED ENTRY WAS EXTRACTED FROM THE TABLE BY SUBSCRIPTS.".
006200     02  FILLER                  PIC X(8)  VALUE SPACE.
006300 01  TEST-RESULTS.
006400     02 FILLER                   PIC X      VALUE SPACE.
006500     02 FEATURE                  PIC X(20)  VALUE SPACE.
006600     02 FILLER                   PIC X      VALUE SPACE.
006700     02 P-OR-F                   PIC X(5)   VALUE SPACE.
006800     02 FILLER                   PIC X      VALUE SPACE.
006900     02  PAR-NAME.
007000       03 FILLER                 PIC X(19)  VALUE SPACE.
007100       03  PARDOT-X              PIC X      VALUE SPACE.
007200       03 DOTVALUE               PIC 99     VALUE ZERO.
007300     02 FILLER                   PIC X(8)   VALUE SPACE.
007400     02 RE-MARK                  PIC X(61).
007500 01  TEST-COMPUTED.
007600     02 FILLER                   PIC X(30)  VALUE SPACE.
007700     02 FILLER                   PIC X(17)  VALUE
007800            "       COMPUTED=".
007900     02 COMPUTED-X.
008000     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
008100     03 COMPUTED-N               REDEFINES COMPUTED-A
008200                                 PIC -9(9).9(9).
008300     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
008400     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
008500     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
008600     03       CM-18V0 REDEFINES COMPUTED-A.
008700         04 COMPUTED-18V0                    PIC -9(18).
008800         04 FILLER                           PIC X.
008900     03 FILLER PIC X(50) VALUE SPACE.
009000 01  TEST-CORRECT.
009100     02 FILLER PIC X(30) VALUE SPACE.
009200     02 FILLER PIC X(17) VALUE "       CORRECT =".
009300     02 CORRECT-X.
009400     03 CORRECT-A                  PIC X(20) VALUE SPACE.
009500     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
009600     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
009700     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
009800     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
009900     03      CR-18V0 REDEFINES CORRECT-A.
010000         04 CORRECT-18V0                     PIC -9(18).
010100         04 FILLER                           PIC X.
010200     03 FILLER PIC X(2) VALUE SPACE.
010300     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
010400 01  CCVS-C-1.
010500     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
010600-    "SS  PARAGRAPH-NAME
010700-    "       REMARKS".
010800     02 FILLER                     PIC X(20)    VALUE SPACE.
010900 01  CCVS-C-2.
011000     02 FILLER                     PIC X        VALUE SPACE.
011100     02 FILLER                     PIC X(6)     VALUE "TESTED".
011200     02 FILLER                     PIC X(15)    VALUE SPACE.
011300     02 FILLER                     PIC X(4)     VALUE "FAIL".
011400     02 FILLER                     PIC X(94)    VALUE SPACE.
011500 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
011600 01  REC-CT                        PIC 99       VALUE ZERO.
011700 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
011800 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
011900 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
012000 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
012100 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
012200 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
012300 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
012400 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
012500 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
012600 01  CCVS-H-1.
012700     02  FILLER                    PIC X(39)    VALUE SPACES.
012800     02  FILLER                    PIC X(42)    VALUE
012900     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
013000     02  FILLER                    PIC X(39)    VALUE SPACES.
013100 01  CCVS-H-2A.
013200   02  FILLER                        PIC X(40)  VALUE SPACE.
013300   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
013400   02  FILLER                        PIC XXXX   VALUE
013500     "4.2 ".
013600   02  FILLER                        PIC X(28)  VALUE
013700            " COPY - NOT FOR DISTRIBUTION".
013800   02  FILLER                        PIC X(41)  VALUE SPACE.
013900
014000 01  CCVS-H-2B.
014100   02  FILLER                        PIC X(15)  VALUE
014200            "TEST RESULT OF ".
014300   02  TEST-ID                       PIC X(9).
014400   02  FILLER                        PIC X(4)   VALUE
014500            " IN ".
014600   02  FILLER                        PIC X(12)  VALUE
014700     " HIGH       ".
014800   02  FILLER                        PIC X(22)  VALUE
014900            " LEVEL VALIDATION FOR ".
015000   02  FILLER                        PIC X(58)  VALUE
015100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
015200 01  CCVS-H-3.
015300     02  FILLER                      PIC X(34)  VALUE
015400            " FOR OFFICIAL USE ONLY    ".
015500     02  FILLER                      PIC X(58)  VALUE
015600     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
015700     02  FILLER                      PIC X(28)  VALUE
015800            "  COPYRIGHT   1985 ".
015900 01  CCVS-E-1.
016000     02 FILLER                       PIC X(52)  VALUE SPACE.
016100     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
016200     02 ID-AGAIN                     PIC X(9).
016300     02 FILLER                       PIC X(45)  VALUE SPACES.
016400 01  CCVS-E-2.
016500     02  FILLER                      PIC X(31)  VALUE SPACE.
016600     02  FILLER                      PIC X(21)  VALUE SPACE.
016700     02 CCVS-E-2-2.
016800         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
016900         03 FILLER                   PIC X      VALUE SPACE.
017000         03 ENDER-DESC               PIC X(44)  VALUE
017100            "ERRORS ENCOUNTERED".
017200 01  CCVS-E-3.
017300     02  FILLER                      PIC X(22)  VALUE
017400            " FOR OFFICIAL USE ONLY".
017500     02  FILLER                      PIC X(12)  VALUE SPACE.
017600     02  FILLER                      PIC X(58)  VALUE
017700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
017800     02  FILLER                      PIC X(13)  VALUE SPACE.
017900     02 FILLER                       PIC X(15)  VALUE
018000             " COPYRIGHT 1985".
018100 01  CCVS-E-4.
018200     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
018300     02 FILLER                       PIC X(4)   VALUE " OF ".
018400     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
018500     02 FILLER                       PIC X(40)  VALUE
018600      "  TESTS WERE EXECUTED SUCCESSFULLY".
018700 01  XXINFO.
018800     02 FILLER                       PIC X(19)  VALUE
018900            "*** INFORMATION ***".
019000     02 INFO-TEXT.
019100       04 FILLER                     PIC X(8)   VALUE SPACE.
019200       04 XXCOMPUTED                 PIC X(20).
019300       04 FILLER                     PIC X(5)   VALUE SPACE.
019400       04 XXCORRECT                  PIC X(20).
019500     02 INF-ANSI-REFERENCE           PIC X(48).
019600 01  HYPHEN-LINE.
019700     02 FILLER  PIC IS X VALUE IS SPACE.
019800     02 FILLER  PIC IS X(65)    VALUE IS "************************
019900-    "*****************************************".
020000     02 FILLER  PIC IS X(54)    VALUE IS "************************
020100-    "******************************".
020200 01  CCVS-PGM-ID                     PIC X(9)   VALUE
020300     "NC235A".
020400 PROCEDURE DIVISION.
020500 CCVS1 SECTION.
020600 OPEN-FILES.
020700     OPEN     OUTPUT PRINT-FILE.
020800     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
020900     MOVE    SPACE TO TEST-RESULTS.
021000     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
021100     GO TO CCVS1-EXIT.
021200 CLOSE-FILES.
021300     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
021400 TERMINATE-CCVS.
021500S    EXIT PROGRAM.
021600STERMINATE-CALL.
021700     STOP     RUN.
021800 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
021900 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
022000 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
022100 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
022200     MOVE "****TEST DELETED****" TO RE-MARK.
022300 PRINT-DETAIL.
022400     IF REC-CT NOT EQUAL TO ZERO
022500             MOVE "." TO PARDOT-X
022600             MOVE REC-CT TO DOTVALUE.
022700     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
022800     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
022900        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
023000          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
023100     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
023200     MOVE SPACE TO CORRECT-X.
023300     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
023400     MOVE     SPACE TO RE-MARK.
023500 HEAD-ROUTINE.
023600     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023700     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023800     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
023900     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
024000 COLUMN-NAMES-ROUTINE.
024100     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
024200     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
024400 END-ROUTINE.
024500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
024600 END-RTN-EXIT.
024700     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024800 END-ROUTINE-1.
024900      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
025000      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
025100      ADD PASS-COUNTER TO ERROR-HOLD.
025200*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
025300      MOVE PASS-COUNTER TO CCVS-E-4-1.
025400      MOVE ERROR-HOLD TO CCVS-E-4-2.
025500      MOVE CCVS-E-4 TO CCVS-E-2-2.
025600      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
025700  END-ROUTINE-12.
025800      MOVE "TEST(S) FAILED" TO ENDER-DESC.
025900     IF       ERROR-COUNTER IS EQUAL TO ZERO
026000         MOVE "NO " TO ERROR-TOTAL
026100         ELSE
026200         MOVE ERROR-COUNTER TO ERROR-TOTAL.
026300     MOVE     CCVS-E-2 TO DUMMY-RECORD.
026400     PERFORM WRITE-LINE.
026500 END-ROUTINE-13.
026600     IF DELETE-COUNTER IS EQUAL TO ZERO
026700         MOVE "NO " TO ERROR-TOTAL  ELSE
026800         MOVE DELETE-COUNTER TO ERROR-TOTAL.
026900     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
027000     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027100      IF   INSPECT-COUNTER EQUAL TO ZERO
027200          MOVE "NO " TO ERROR-TOTAL
027300      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
027400      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
027500      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027600     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027700 WRITE-LINE.
027800     ADD 1 TO RECORD-COUNT.
027900Y    IF RECORD-COUNT GREATER 50
028000Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
028100Y        MOVE SPACE TO DUMMY-RECORD
028200Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
028300Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
028400Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
028500Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
028600Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
028700Y        MOVE ZERO TO RECORD-COUNT.
028800     PERFORM WRT-LN.
028900 WRT-LN.
029000     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
029100     MOVE SPACE TO DUMMY-RECORD.
029200 BLANK-LINE-PRINT.
029300     PERFORM WRT-LN.
029400 FAIL-ROUTINE.
029500     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
029600     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
029700     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
029800     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
029900     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030000     MOVE   SPACES TO INF-ANSI-REFERENCE.
030100     GO TO  FAIL-ROUTINE-EX.
030200 FAIL-ROUTINE-WRITE.
030300     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
030400     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
030500     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
030600     MOVE   SPACES TO COR-ANSI-REFERENCE.
030700 FAIL-ROUTINE-EX. EXIT.
030800 BAIL-OUT.
030900     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
031000     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
031100 BAIL-OUT-WRITE.
031200     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
031300     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
031400     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031500     MOVE   SPACES TO INF-ANSI-REFERENCE.
031600 BAIL-OUT-EX. EXIT.
031700 CCVS1-EXIT.
031800     EXIT.
031900 SECT-NC235A-001 SECTION.
032000 TH-08-001.
032100 INIT-TBL-TH309.
032200     MOVE "ZZYYXXWWVVUUTTSSRRQQPPOONNMMLLKKJJIIHHGGFFEEDDCCBBAA"
032300         TO TBL-TH309.
032400     IF FIRSTZ (1)               AND LASTA (26)
032500         MOVE "26 ENTRY TABLE CONSTRUCTED " TO RE-MARK
032600         GO TO INIT-WRITE.
032700     MOVE "TBL ENTRIES BUILT INCORRECT" TO RE-MARK.
032800     MOVE "*****" TO CORRECT-A  COMPUTED-A.
032900 INIT-WRITE.
033000     MOVE "INIT-TBL-TH309" TO PAR-NAME.
033100     MOVE "LEVEL 3 TBL HANDLING" TO FEATURE.
033200     PERFORM PRINT-DETAIL.
033300*
033400 IDX-INIT-F2-1.
033500     MOVE "IDX-TEST-F2-1 " TO PAR-NAME.
033600     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
033700     MOVE "LEVEL 3 TBL HANDLING" TO FEATURE.
033800     SET IDX-2 TO 26.
033900 IDX-TEST-F2-1.
034000     SEARCH ALL TH309-ENTRY AT END
034100          GO TO IDX-FAIL-F2-1
034200      WHEN DEC-KEY (IDX-1) EQUAL TO "BB" NEXT SENTENCE.
034300     PERFORM PASS.
034400     GO TO IDX-WRITE-F2-1.
034500 IDX-DELETE-F2-1.
034600     PERFORM DE-LETE
034700     GO TO IDX-WRITE-F2-1.
034800 IDX-FAIL-F2-1.
034900     MOVE 25 TO SUB-1
035000     MOVE "BB" TO CORRECT-A
035100     PERFORM PUTOUT-COMPUTED-A.
035200     PERFORM FAIL.
035300 IDX-WRITE-F2-1.
035400     PERFORM PRINT-DETAIL.
035500*
035600 IDX-INIT-F2-2.
035700     MOVE "IDX-TEST-F2-2 " TO PAR-NAME.
035800     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
035900     MOVE "LEVEL 3 TBL HANDLING" TO FEATURE.
036000     SET IDX-3 TO 01.
036100 IDX-TEST-F2-2.
036200     SEARCH ALL TH309-ENTRY AT END
036300         GO TO IDX-FAIL-F2-2
036400      WHEN DEC-KEY (IDX-1) EQUAL TO "XX"
036500         PERFORM PASS
036600         GO TO IDX-WRITE-F2-2.
036700 IDX-DELETE-F2-2.
036800     PERFORM DE-LETE.
036900     GO TO IDX-WRITE-F2-2.
037000 IDX-FAIL-F2-2.
037100     MOVE 03 TO SUB-1
037200     MOVE "XX" TO CORRECT-A
037300     PERFORM PUTOUT-COMPUTED-A.
037400     PERFORM FAIL.
037500 IDX-WRITE-F2-2.
037600     PERFORM PRINT-DETAIL.
037700*
037800 IDX-INIT-F2-3.
037900     MOVE "IDX-TEST-F2-3 " TO PAR-NAME.
038000     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
038100     MOVE "LEVEL 3 TBL HANDLING" TO FEATURE.
038200     MOVE 25 TO TBL-LENGTH.
038300 IDX-TEST-F2-3.
038400     SEARCH ALL TH309-ENTRY AT END
038500         PERFORM PASS
038600         GO TO IDX-WRITE-F2-3
038700      WHEN DEC-KEY (IDX-1) EQUAL TO "AA"
038800         GO TO IDX-FAIL-F2-3.
038900 IDX-DELETE-F2-3.
039000     PERFORM DE-LETE.
039100     GO TO IDX-WRITE-F2-3.
039200 IDX-FAIL-F2-3.
039300     MOVE "ENTRY SHOULD NOT BE FOUND  " TO RE-MARK
039400     MOVE "AA" TO COMPUTED-A
039500     PERFORM FAIL.
039600 IDX-WRITE-F2-3.
039700     PERFORM PRINT-DETAIL.
039800*
039900 IDX-INIT-F1-4.
040000     MOVE "IDX-TEST-F1-4" TO PAR-NAME.
040100     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
040200     MOVE "LEVEL 3 TBL HANDLING" TO FEATURE.
040300     MOVE 24 TO TBL-LENGTH.
040400     SET IDX-3 TO 01.
040500 IDX-TEST-F1-4.
040600     SEARCH TH309-ENTRY VARYING IDX-3 AT END
040700         PERFORM PASS
040800         GO TO IDX-WRITE-F1-4
040900      WHEN DEC-KEY (IDX-3) EQUAL TO "BB"
041000         GO TO IDX-FAIL-F1-4.
041100 IDX-DELETE-F1-4.
041200     PERFORM DE-LETE.
041300     GO TO IDX-WRITE-F1-4.
041400 IDX-FAIL-F1-4.
041500     MOVE "ENTRY SHOULD NOT BE FOUND  " TO RE-MARK
041600     MOVE "BB" TO COMPUTED-A
041700     PERFORM FAIL.
041800 IDX-WRITE-F1-4.
041900     PERFORM PRINT-DETAIL.
042000*
042100 IDX-INIT-F1-5.
042200     MOVE "IDX-TEST-F1-5 " TO PAR-NAME.
042300     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
042400     MOVE "LEVEL 3 TBL HANDLING" TO FEATURE.
042500     SET IDX-2 TO 01.
042600 IDX-TEST-F1-5.
042700     SEARCH TH309-ENTRY VARYING IDX-2 AT END
042800         GO TO IDX-FAIL-F1-5
042900     WHEN DEC-KEY (IDX-2) EQUAL TO "KK"
043000         PERFORM PASS
043100         GO TO IDX-WRITE-F1-5.
043200 IDX-DELETE-F1-5.
043300     PERFORM DE-LETE.
043400     GO TO IDX-WRITE-F1-5.
043500 IDX-FAIL-F1-5.
043600     MOVE 16 TO SUB-1
043700     MOVE "KK" TO CORRECT-A
043800     PERFORM PUTOUT-COMPUTED-A.
043900     PERFORM FAIL.
044000 IDX-WRITE-F1-5.
044100     PERFORM PRINT-DETAIL.
044200*
044300 IDX-INIT-F1-6.
044400     MOVE "IDX-TEST-F1-6 " TO PAR-NAME.
044500     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
044600     MOVE "LEVEL 3 TBL HANDLING" TO FEATURE.
044700     MOVE 22 TO TBL-LENGTH.
044800     SET IDX-1 TO 09.
044900 IDX-TEST-F1-6.
045000     SEARCH TH309-ENTRY VARYING IDX-1 AT END
045100         PERFORM PASS
045200         GO TO IDX-WRITE-F1-6
045300     WHEN TH309-ENTRY (IDX-1) EQUAL TO "DD"
045400         GO TO IDX-FAIL-F1-6.
045500 IDX-DELETE-F1-6.
045600     PERFORM DE-LETE.
045700     GO TO IDX-WRITE-F1-6.
045800 IDX-FAIL-F1-6.
045900     MOVE "ENTRY SHOULD NOT BE FOUND  " TO RE-MARK
046000     MOVE "DD" TO COMPUTED-A
046100     PERFORM FAIL.
046200 IDX-WRITE-F1-6.
046300     PERFORM PRINT-DETAIL.
046400*
046500 IDX-INIT-F1-7.
046600     MOVE "IDX-TEST-F1-7 " TO PAR-NAME.
046700     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
046800     MOVE "LEVEL 3 TBL HANDLING" TO FEATURE.
046900     MOVE 22 TO TBL-LENGTH.
047000     SET IDX-3 TO 23.
047100 IDX-TEST-F1-7.
047200     SEARCH TH309-ENTRY VARYING IDX-3 AT END
047300         PERFORM PASS
047400         GO TO IDX-WRITE-F1-7
047500     WHEN TH309-ENTRY (IDX-3) EQUAL TO "DD"
047600         GO TO IDX-FAIL-F1-7.
047700 IDX-DELETE-F1-7.
047800     PERFORM DE-LETE.
047900     GO TO IDX-WRITE-F1-7.
048000 IDX-FAIL-F1-7.
048100     MOVE "ENTRY SHOULD NOT BE FOUND  " TO RE-MARK
048200     MOVE "DD" TO COMPUTED-A
048300     PERFORM FAIL.
048400 IDX-WRITE-F1-7.
048500     PERFORM PRINT-DETAIL.
048600*
048700 IDX-INIT-F2-8.
048800     MOVE "IDX-TEST-F2-8 " TO PAR-NAME.
048900     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
049000     MOVE "LEVEL 3 TBL HANDLING" TO FEATURE.
049100     MOVE 20 TO TBL-LENGTH.
049200     SET IDX-2 TO 21.
049300 IDX-TEST-F2-8.
049400     SEARCH ALL TH309-ENTRY AT END
049500         GO TO IDX-FAIL-F2-8
049600     WHEN DEC-KEY (IDX-1) EQUAL TO "GG"
049700         PERFORM PASS
049800         GO TO IDX-WRITE-F2-8.
049900 IDX-DELETE-F2-8.
050000     PERFORM DE-LETE.
050100     GO TO IDX-WRITE-F2-8.
050200 IDX-FAIL-F2-8.
050300     MOVE 20 TO SUB-1
050400     MOVE "GG" TO CORRECT-A
050500     PERFORM PUTOUT-COMPUTED-A.
050600     PERFORM FAIL.
050700 IDX-WRITE-F2-8.
050800     PERFORM PRINT-DETAIL.
050900*
051000 IDX-INIT-F2-9.
051100     MOVE "IDX-TEST-F2-9 " TO PAR-NAME.
051200     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
051300     MOVE "LEVEL 3 TBL HANDLING" TO FEATURE.
051400     MOVE 20 TO TBL-LENGTH.
051500 IDX-TEST-F2-9.
051600     SEARCH ALL TH309-ENTRY AT END
051700         PERFORM PASS
051800         GO TO IDX-WRITE-F2-9
051900     WHEN   LASTA (IDX-1)
052000         GO TO IDX-FAIL-F2-9.
052100 IDX-DELETE-F2-9.
052200     PERFORM DE-LETE.
052300     GO TO IDX-WRITE-F2-9.
052400 IDX-FAIL-F2-9.
052500     MOVE "CONDITION-NAME TEST" TO RE-MARK
052600     PERFORM FAIL
052700     MOVE "AA" TO COMPUTED-A.
052800 IDX-WRITE-F2-9.
052900     PERFORM PRINT-DETAIL.
053000*
053100 IDX-INIT-F2-10.
053200     MOVE "IDX-TEST-F2-10 " TO PAR-NAME.
053300     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
053400     MOVE "LEVEL 3 TBL HANDLING" TO FEATURE.
053500     SET IDX-1, IDX-2, IDX-3 TO 10.
053600 IDX-TEST-F2-10.
053700     SEARCH ALL TH309-ENTRY AT END
053800         GO TO IDX-FAIL-F2-10
053900     WHEN DEC-KEY (IDX-1) EQUAL TO "RR"
054000         PERFORM PASS
054100         GO TO IDX-WRITE-F2-10.
054200 IDX-DELETE-F2-10.
054300     PERFORM DE-LETE.
054400     GO TO IDX-WRITE-F2-10.
054500 IDX-FAIL-F2-10.
054600     MOVE 9 TO SUB-1
054700     MOVE "RR" TO CORRECT-A
054800     PERFORM PUTOUT-COMPUTED-A.
054900     PERFORM FAIL.
055000 IDX-WRITE-F2-10.
055100     PERFORM PRINT-DETAIL.
055200*
055300 IDX-INIT-F2-11.
055400     MOVE "IDX-TEST-F2-11 " TO PAR-NAME.
055500     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
055600     MOVE "LEVEL 3 TBL HANDLING" TO FEATURE.
055700     MOVE 1 TO TBL-LENGTH.
055800 IDX-TEST-F2-11.
055900     SEARCH ALL TH309-ENTRY AT END
056000         PERFORM PASS
056100         GO TO IDX-WRITE-F2-11
056200     WHEN DEC-KEY (IDX-1) EQUAL TO "YY"
056300         GO TO IDX-FAIL-F2-11.
056400 IDX-DELETE-F2-11.
056500     PERFORM DE-LETE.
056600     GO TO IDX-WRITE-F2-11.
056700 IDX-FAIL-F2-11.
056800     MOVE 2 TO SUB-1
056900     MOVE "YY" TO COMPUTED-A
057000     MOVE "ENTRY SHOULD NOT BE FOUND" TO RE-MARK
057100     PERFORM FAIL.
057200 IDX-WRITE-F2-11.
057300     PERFORM PRINT-DETAIL.
057400*
057500 IDX-INIT-F2-12.
057600     MOVE "IDX-TEST-F2-12 " TO PAR-NAME.
057700     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
057800     MOVE "LEVEL 3 TBL HANDLING" TO FEATURE.
057900     MOVE 10 TO TBL-LENGTH.
058000 IDX-TEST-F2-12.
058100     SEARCH ALL TH309-ENTRY AT END
058200         PERFORM PASS
058300         GO TO IDX-WRITE-F2-12
058400     WHEN MIDDLE-PP (IDX-1)
058500         GO TO IDX-FAIL-F2-12.
058600 IDX-DELETE-F2-12.
058700     PERFORM DE-LETE.
058800     GO TO IDX-WRITE-F2-12.
058900 IDX-FAIL-F2-12.
059000     MOVE 10 TO SUB-1
059100     MOVE "ENTRY SHOULD NOT BE FOUND " TO RE-MARK
059200     MOVE "PP" TO COMPUTED-A
059300     PERFORM FAIL.
059400 IDX-WRITE-F2-12.
059500     PERFORM PRINT-DETAIL.
059600*
059700 IDX-INIT-F2-13.
059800     MOVE "IDX-TEST-F2-13 " TO PAR-NAME.
059900     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
060000     MOVE "LEVEL 3 TBL HANDLING" TO FEATURE.
060100     MOVE 2 TO TBL-LENGTH.
060200 IDX-TEST-F2-13.
060300     SEARCH ALL TH309-ENTRY AT END
060400         PERFORM PASS
060500         GO TO IDX-WRITE-F2-13
060600     WHEN DEC-KEY (IDX-1) EQUAL TO "XX"
060700         GO TO IDX-FAIL-F2-13.
060800 IDX-DELETE-F2-13.
060900     PERFORM DE-LETE.
061000     GO TO IDX-WRITE-F2-13.
061100 IDX-FAIL-F2-13.
061200     MOVE "XX" TO COMPUTED-A
061300     MOVE "ENTRY SHOULD NOT BE FOUND " TO RE-MARK
061400     PERFORM FAIL.
061500 IDX-WRITE-F2-13.
061600     PERFORM PRINT-DETAIL.
061700     GO TO CCVS-EXIT.
061800*
061900 PUTOUT-COMPUTED-A.
062000     IF TH309-ENTRY (SUB-1) EQUAL TO CORRECT-A
062100         MOVE "SEE NOTE 1 FOR DIAGNOSTIC" TO RE-MARK ELSE
062200     MOVE "SEE NOTE 2 FOR DIAGNOSTIC" TO RE-MARK.
062300     MOVE TH309-ENTRY (SUB-1) TO COMPUTED-A.
062400 CCVS-EXIT SECTION.
062500 CCVS-999999.
062600     GO TO CLOSE-FILES.
