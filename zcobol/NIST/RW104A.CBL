000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RW104A.
000400 AUTHOR.
000500     FEDERAL COMPILER TESTING CENTER.
000600 INSTALLATION.
000700     GENERAL SERVICES ADMINISTRATION
000800     AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
000900     SOFTWARE DEVELOPMENT OFFICE.
001000     5203 LEESBURG PIKE  SUITE 1100
001100     FALLS CHURCH VIRGINIA 22041.
001200
001300     PHONE   (703) 756-6153
001400
001500     " HIGH       ".
001600 DATE-WRITTEN.
001700     CCVS-74 VERSION 4.0 - 1980 JULY 1.
001800     CREATION DATE     /    VALIDATION DATE
001900     "4.2 ".
002000 SECURITY.
002100     NONE.
002200******************************************************************
002300*
002400*        THE ROUTINE RW104A TESTS BASIC REPORT WRITER MODULE
002500*    FUNCTIONS.  ONE OUTPUT REPORT IS PRODUCED BY THE RWCS.
002600*    THE REPORT DESCRIPTION IN THIS ROUTINE CONTAINS
002700*                PAGE LIMITS ARE 30 LINES
002800*                HEADING 1
002900*                FIRST DETAIL 6
003000*                LAST DETAIL 25
003100*                FOOTING 29.
003200*
003300*        THE PROCEDURE DIVISION FOR RW104A
003400*            OPENS THE SEQUENTIAL FILE RW-FS4,
003500*            INITIATES THE REPORT RW-FS4-REPORT-1,
003600*            CHECKS THE VALUES IN LINE-COUNTER AND PAGE-COUNTER
003700*    AFTER EXECUTING THE INITIATE STATEMENT,
003800*            GENERATES A THREE PAGE REPORT WITH GENERATE DATA-
003900*    NAME STATEMENTS,
004000*            CHECKS THE VALUES IN LINE-COUNTER AND PAGE-COUNTER
004100*    AFTER EACH GENERATE STATEMENT,
004200*            CHECKS THAT LINE-COUNTER AND PAGE-COUNTER ARE RESET
004300*    WHEN PAGE ADVANCING PROCESSING HAS OCCURRED,
004400*            TERMINATES THE REPORT RW-FS4-REPORT-1,
004500*            CLOSES THE FILE RW-FS4.
004600*
004700*        THE OUTPUT OF THIS ROUTINE CONSISTS OF AN OUTPUT REPORT
004800*    IN THE USUAL AUDIT ROUTINE FORMAT PRODUCED USING WRITE
004900*    STATEMENTS AND A REPORT PRODUCED BY THE RWCS.  BOTH REPORTS
005000*    MUST BE CAREFULLY EXAMINED TO VERIFY THAT THE TESTS IN
005100*    RW104 WERE EXECUTED CORRECTLY.
005200*
005300*        THE OUTPUT REPORT GENERATED BY THE RWCS CONSISTS OF
005400*    THREE PAGES WITH EACH PAGE CONTAINING A PAGE HEADING ON
005500*    LINE 1, TWENTY DETAIL LINES ON LINES 6 THROUGH 25, AND A
005600*    PAGE FOOTING ON LINE 30.  LINES 2 THROUGH 5 AND 26 THROUGH 29
005700*    SHOULD BE BLANK.
005800*
005900*        THE VALUE OF LINE-COUNTER IN THE DETAIL LINE IS FIVE
006000*    GREATER THAN THE DETAIL LINE NUMBER, AND PAGE-COUNTER IS
006100*    EQUAL TO THE PAGE ON WHICH THE DETAIL LINE IS PRESENTED.
006200*
006300******************************************************************
006400*
006500*    REFERENCE  AMERICAN NATIONAL STANDARD PROGRAMMING
006600*                    LANGUAGE COBOL, X3.23-1974
006700*        SECTION VIII - REPORT WRITER MODULE
006800*
006900******************************************************************
007000 ENVIRONMENT DIVISION.
007100 CONFIGURATION SECTION.
007200 SOURCE-COMPUTER.
007300     XXXXX082.
007400 OBJECT-COMPUTER.
007500     XXXXX083.
007600 INPUT-OUTPUT SECTION.
007700 FILE-CONTROL.
007800     SELECT PRINT-FILE ASSIGN TO
007900     XXXXX055.
008000     SELECT RW-FS4 ASSIGN TO
008100     XXXXX049.
008200 DATA DIVISION.
008300 FILE SECTION.
008400 FD  PRINT-FILE
008500     LABEL RECORDS
008600     XXXXX084
008700     DATA RECORD IS PRINT-REC DUMMY-RECORD.
008800 01  PRINT-REC PICTURE X(120).
008900 01  DUMMY-RECORD PICTURE X(120).
009000 FD  RW-FS4
009100     LABEL RECORDS ARE STANDARD
009200C    VALUE OF
009300C    XXXXX074
009400C       IS
009500C    XXXXX075
009600G    XXXXX069
009700     REPORT IS RW-FS4-REPORT-1.
009800 WORKING-STORAGE SECTION.
009900 01  LC-ERRORS  PIC 99   VALUE 0.
010000 01  PC-ERRORS  PIC 99   VALUE 0.
010100 01  WS-COUNTER PIC 99   VALUE 0.
010200 01  PAGENO   PIC 99   VALUE 1.
010300 01  TEMP-COMP    PIC 99.
010400 01  TEST-RESULTS.
010500     02 FILLER                    PICTURE X VALUE SPACE.
010600     02 FEATURE                   PICTURE X(20) VALUE SPACE.
010700     02 FILLER                    PICTURE X VALUE SPACE.
010800     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
010900     02 FILLER                    PICTURE X  VALUE SPACE.
011000     02  PAR-NAME.
011100       03 FILLER PICTURE X(12) VALUE SPACE.
011200       03  PARDOT-X PICTURE X  VALUE SPACE.
011300       03 DOTVALUE PICTURE 99  VALUE ZERO.
011400       03 FILLER PIC X(5) VALUE SPACE.
011500     02 FILLER PIC X(10) VALUE SPACE.
011600     02 RE-MARK PIC X(61).
011700 01  TEST-COMPUTED.
011800     02 FILLER PIC X(30) VALUE SPACE.
011900     02 FILLER PIC X(17) VALUE "       COMPUTED=".
012000     02 COMPUTED-X.
012100     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
012200     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
012300     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
012400     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
012500     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
012600     03       CM-18V0 REDEFINES COMPUTED-A.
012700         04 COMPUTED-18V0                   PICTURE -9(18).
012800         04 FILLER                          PICTURE X.
012900     03 FILLER PIC X(50) VALUE SPACE.
013000 01  TEST-CORRECT.
013100     02 FILLER PIC X(30) VALUE SPACE.
013200     02 FILLER PIC X(17) VALUE "       CORRECT =".
013300     02 CORRECT-X.
013400     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
013500     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
013600     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
013700     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
013800     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
013900     03      CR-18V0 REDEFINES CORRECT-A.
014000         04 CORRECT-18V0                    PICTURE -9(18).
014100         04 FILLER                          PICTURE X.
014200     03 FILLER PIC X(50) VALUE SPACE.
014300 01  CCVS-C-1.
014400     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
014500-    "SS  PARAGRAPH-NAME
014600-    "        REMARKS".
014700     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
014800 01  CCVS-C-2.
014900     02 FILLER PICTURE IS X VALUE IS SPACE.
015000     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
015100     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
015200     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
015300     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
015400 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
015500 01  REC-CT PICTURE 99 VALUE ZERO.
015600 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
015700 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
015800 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
015900 01  PASS-COUNTER PIC 999 VALUE ZERO.
016000 01  TOTAL-ERROR PIC 999 VALUE ZERO.
016100 01  ERROR-HOLD PIC 999 VALUE ZERO.
016200 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
016300 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
016400 01  CCVS-H-1.
016500     02  FILLER   PICTURE X(27)  VALUE SPACE.
016600     02 FILLER PICTURE X(67) VALUE
016700     " FEDERAL COMPILER TESTING CENTER COBOL COMPILER VALIDATION
016800-    " SYSTEM".
016900     02  FILLER     PICTURE X(26)  VALUE SPACE.
017000 01  CCVS-H-2.
017100     02 FILLER PICTURE X(52) VALUE IS
017200     "CCVS74 NCC  COPY, NOT FOR DISTRIBUTION.".
017300     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
017400     02 TEST-ID PICTURE IS X(9).
017500     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
017600 01  CCVS-H-3.
017700     02  FILLER PICTURE X(34) VALUE
017800     " FOR OFFICIAL USE ONLY    ".
017900     02  FILLER PICTURE X(58) VALUE
018000     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
018100     02  FILLER PICTURE X(28) VALUE
018200     "  COPYRIGHT   1974 ".
018300 01  CCVS-E-1.
018400     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
018500     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
018600     02 ID-AGAIN PICTURE IS X(9).
018700     02 FILLER PICTURE X(45) VALUE IS
018800     " NTIS DISTRIBUTION COBOL 74".
018900 01  CCVS-E-2.
019000     02  FILLER                   PICTURE X(31)  VALUE
019100     SPACE.
019200     02  FILLER                   PICTURE X(21)  VALUE SPACE.
019300     02 CCVS-E-2-2.
019400         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
019500         03 FILLER PICTURE IS X VALUE IS SPACE.
019600         03 ENDER-DESC PIC X(44) VALUE "ERRORS ENCOUNTERED".
019700 01  CCVS-E-3.
019800     02  FILLER PICTURE X(22) VALUE
019900     " FOR OFFICIAL USE ONLY".
020000     02  FILLER PICTURE X(12) VALUE SPACE.
020100     02  FILLER PICTURE X(58) VALUE
020200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
020300     02  FILLER PICTURE X(13) VALUE SPACE.
020400     02 FILLER PIC X(15) VALUE " COPYRIGHT 1974".
020500 01  CCVS-E-4.
020600     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
020700     02 FILLER PIC XXXX VALUE " OF ".
020800     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
020900     02 FILLER PIC X(40) VALUE
021000      "  TESTS WERE EXECUTED SUCCESSFULLY".
021100 01  XXINFO.
021200     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
021300     02 INFO-TEXT.
021400     04 FILLER PIC X(20) VALUE SPACE.
021500     04 XXCOMPUTED PIC X(20).
021600     04 FILLER PIC X(5) VALUE SPACE.
021700     04 XXCORRECT PIC X(20).
021800 01  HYPHEN-LINE.
021900     02 FILLER PICTURE IS X VALUE IS SPACE.
022000     02 FILLER PICTURE IS X(65) VALUE IS "************************
022100-    "*****************************************".
022200     02 FILLER PICTURE IS X(54) VALUE IS "************************
022300-    "******************************".
022400 01  CCVS-PGM-ID PIC X(6) VALUE
022500     "RW104A".
022600 REPORT SECTION.
022700 RD  RW-FS4-REPORT-1
022800     PAGE LIMITS ARE 30 LINES
022900     HEADING 1
023000     FIRST DETAIL 6
023100     LAST DETAIL 25
023200     FOOTING 29.
023300 01  RW-FS4-HEADING
023400     LINE NUMBER 1
023500     TYPE PH.
023600     03  PIC X(36)   COLUMN 20
023700         VALUE "U.S. NAVY COBOL AUDIT ROUTINE RW104A".
023800     03  PIC X(5)  COLUMN NUMBER 60  VALUE "LINE ".
023900     03  PIC 9  COLUMN NUMBER IS 65  SOURCE LINE-COUNTER.
024000     03  COLUMN NUMBER 70  PIC X(5)  VALUE "PAGE ".
024100     03  SOURCE PAGE-COUNTER PIC 9 COLUMN NUMBER IS 75.
024200 01  RW-FS4-DETAIL
024300     LINE NUMBER PLUS 1
024400     TYPE DE.
024500     03  VALUE "DETAIL LINE "  COLUMN 20    PIC X(12).
024600     03  PIC 99  COLUMN 32  SOURCE IS WS-COUNTER.
024700     03  PIC X(13)    COLUMN 36   VALUE "PAGE-COUNTER ".
024800     03  PIC 9   COLUMN 49  SOURCE PAGE-COUNTER.
024900     03  PIC X(13)   COLUMN 55   VALUE "LINE-COUNTER ".
025000     03  PIC 99   COLUMN 68   SOURCE LINE-COUNTER.
025100 01  RW-FS4-FOOTING
025200     LINE NUMBER 30
025300     TYPE IS PAGE FOOTING.
025400     05  PICTURE X(36)   COLUMN 20
025500         VALUE "PAGE FOOTING ROUTINE RW104     LINE ".
025600     05  PIC 99 COLUMN 56 SOURCE LINE-COUNTER.
025700     05  PIC X(5)  COLUMN 70   VALUE "PAGE ".
025800     05  PIC 9   COLUMN 75    SOURCE PAGE-COUNTER.
025900*
026000*        EXCEPT FOR THE DATA-NAME CLAUSE, THE CLAUSES IN A REPORT
026100*    GROUP DESCRIPTION ENTRY MAY BE WRITTEN IN ANY SEQUENCE.
026200*    REFERENCE  VIII-7, 2.5.3(2), REPORT GROUP DESCRIPTION ENTRY
026300*
026400 PROCEDURE DIVISION.
026500 CCVS1 SECTION.
026600 OPEN-FILES.
026700     OPEN     OUTPUT PRINT-FILE.
026800     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
026900     MOVE    SPACE TO TEST-RESULTS.
027000     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
027100     GO TO CCVS1-EXIT.
027200 CLOSE-FILES.
027300     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
027400 TERMINATE-CCVS.
027500S    EXIT PROGRAM.
027600STERMINATE-CALL.
027700     STOP     RUN.
027800 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
027900 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
028000 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
028100 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
028200     MOVE "****TEST DELETED****" TO RE-MARK.
028300 PRINT-DETAIL.
028400     IF REC-CT NOT EQUAL TO ZERO
028500             MOVE "." TO PARDOT-X
028600             MOVE REC-CT TO DOTVALUE.
028700     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
028800     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
028900        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
029000          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
029100     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
029200     MOVE SPACE TO CORRECT-X.
029300     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
029400     MOVE     SPACE TO RE-MARK.
029500 HEAD-ROUTINE.
029600     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029700     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
029800     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
029900 COLUMN-NAMES-ROUTINE.
030000     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030100     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
030300 END-ROUTINE.
030400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
030500 END-RTN-EXIT.
030600     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030700 END-ROUTINE-1.
030800      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
030900      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
031000      ADD PASS-COUNTER TO ERROR-HOLD.
031100*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
031200      MOVE PASS-COUNTER TO CCVS-E-4-1.
031300      MOVE ERROR-HOLD TO CCVS-E-4-2.
031400      MOVE CCVS-E-4 TO CCVS-E-2-2.
031500      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
031600  END-ROUTINE-12.
031700      MOVE "TEST(S) FAILED" TO ENDER-DESC.
031800     IF       ERROR-COUNTER IS EQUAL TO ZERO
031900         MOVE "NO " TO ERROR-TOTAL
032000         ELSE
032100         MOVE ERROR-COUNTER TO ERROR-TOTAL.
032200     MOVE     CCVS-E-2 TO DUMMY-RECORD.
032300     PERFORM WRITE-LINE.
032400 END-ROUTINE-13.
032500     IF DELETE-CNT IS EQUAL TO ZERO
032600         MOVE "NO " TO ERROR-TOTAL  ELSE
032700         MOVE DELETE-CNT TO ERROR-TOTAL.
032800     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
032900     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033000      IF   INSPECT-COUNTER EQUAL TO ZERO
033100          MOVE "NO " TO ERROR-TOTAL
033200      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
033300      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
033400      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033500     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033600 WRITE-LINE.
033700     ADD 1 TO RECORD-COUNT.
033800Y    IF RECORD-COUNT GREATER 50
033900Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
034000Y        MOVE SPACE TO DUMMY-RECORD
034100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
034200Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
034300Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
034400Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
034500Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
034600Y        MOVE ZERO TO RECORD-COUNT.
034700     PERFORM WRT-LN.
034800 WRT-LN.
034900     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
035000     MOVE SPACE TO DUMMY-RECORD.
035100 BLANK-LINE-PRINT.
035200     PERFORM WRT-LN.
035300 FAIL-ROUTINE.
035400     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
035500     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
035600     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
035700     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035800     GO TO FAIL-ROUTINE-EX.
035900 FAIL-ROUTINE-WRITE.
036000     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
036100     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
036200 FAIL-ROUTINE-EX. EXIT.
036300 BAIL-OUT.
036400     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
036500     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
036600 BAIL-OUT-WRITE.
036700     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
036800     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036900 BAIL-OUT-EX. EXIT.
037000 CCVS1-EXIT.
037100     EXIT.
037200 SECT-RW104-0001 SECTION.
037300 RW104-INIT.
037400     OPEN OUTPUT RW-FS4.
037500 INIT-TEST-05.
037600     INITIATE RW-FS4-REPORT-1.
037700*
037800*        AFTER EXECUTION OF THE INITIATE STATEMENT FOR A REPORT,
037900*    THE REPORT LINE-COUNTER SHOULD BE ZERO AND PAGE-COUNTER
038000*    SHOULD BE ONE.
038100*    REFERENCE  PAGE VIII-53, 3.2.4(1)B AND C, INITIATE STATEMENT
038200*
038300 INIT-TEST-05-01.
038400     IF LINE-COUNTER IS EQUAL TO ZERO
038500         PERFORM PASS
038600         GO TO INIT-WRITE-05-01.
038700 INIT-FAIL-05-01.
038800     PERFORM FAIL.
038900     MOVE ZERO TO CORRECT-18V0.
039000     MOVE LINE-COUNTER TO COMPUTED-18V0.
039100     MOVE "LINE-COUNTER AFTER INITIATE" TO RE-MARK.
039200 INIT-WRITE-05-01.
039300     MOVE "INIT-TEST-05" TO PAR-NAME.
039400     MOVE 1 TO REC-CT.
039500     MOVE "INITIATE REPORT" TO FEATURE.
039600     PERFORM PRINT-DETAIL.
039700 INIT-TEST-05-02.
039800     IF PAGE-COUNTER IS EQUAL TO 1
039900         PERFORM PASS
040000         GO TO INIT-WRITE-05-02.
040100 INIT-FAIL-05-02.
040200     PERFORM FAIL.
040300     MOVE 1 TO CORRECT-18V0.
040400     MOVE PAGE-COUNTER TO COMPUTED-18V0.
040500     MOVE "PAGE-COUNTER AFTER INITIATE" TO RE-MARK.
040600 INIT-WRITE-05-02.
040700     MOVE 2 TO REC-CT.
040800     PERFORM PRINT-DETAIL.
040900 GENER-TEST-14.
041000*        THIS TEST EXECUTES THE CHRONOLOGICALLY FIRST GENERATE
041100*    STATEMENT FOR THE REPORT RW-FS4-REPORT-1.
041200*    REFERENCE  PAGE VIII-52, 3.1.4(5)B AND D, GENERATE STATEMENT
041300*
041400     ADD 1 TO WS-COUNTER.
041500     GENERATE RW-FS4-DETAIL.
041600*
041700*    OUTPUT REPORT INFORMATION
041800*
041900*        THE PAGE HEADING REPORT GROUP IS PRESENTED ON LINE 1
042000*    OF PAGE 1.
042100*    REFERENCE  PAGE VIII-14, 2.5.5.7, PAGE HEADING PRE. RULES
042200*
042300*        THE LINE-COUNTER VALUE PRINTED ON THE PH LINE SHOULD
042400*    EQUAL ONE.
042500*    REFERENCE  PAGE VIII-5, 2.4.5(6), LINE-COUNTER RULES
042600*
042700*        THE FIRST DETAIL LINE IS PRESENTED ON LINE 6 OF PAGE 1.
042800*    REFERENCE  PAGE VIII-18, 2.5.5.8.1(4)B, BODY GROUP PRE RULES
042900*
043000 GENER-TEST-14-01.
043100     IF LINE-COUNTER IS EQUAL TO 6
043200         PERFORM PASS
043300         GO TO GENER-WRITE-14-01.
043400*
043500*        THE LINE-COUNTER SETTING AFTER THE GENERATE STATEMENT
043600*    IS EQUAL TO THE LINE NUMBER ON WHICH THE PRINT LINE WAS
043700*    PRESENTED, IN THIS CASE 6.
043800*    REFERENCE  PAGE VIII-19, 2.5.5.8.1(6)D, FINAL L-C SETTING
043900*
044000 GENER-FAIL-14-01.
044100     PERFORM FAIL.
044200     MOVE 6 TO CORRECT-18V0.
044300     MOVE LINE-COUNTER TO COMPUTED-18V0.
044400     MOVE "LINE-COUNTER AFTER FIRST GENER" TO RE-MARK.
044500 GENER-WRITE-14-01.
044600     MOVE "GENR-WRITE-14" TO PAR-NAME.
044700     MOVE "FIRST GENERATE" TO FEATURE.
044800     MOVE 1 TO REC-CT.
044900     PERFORM PRINT-DETAIL.
045000 GENER-TEST-14-02.
045100     IF PAGE-COUNTER EQUAL TO 1
045200         PERFORM PASS
045300         GO TO GENER-WRITE-14-02.
045400*
045500*        EXECUTION OF THE FIRST GENERATE STATEMENT SHOULD NOT
045600*    CHANGE THE VALUE OF PAGE-COUNTER.  IT SHOULD STILL BE
045700*    EQUAL TO ONE.
045800*    REFERENCE  PAGE VIII-4, 2.4.4, PAGE-COUNTER RULES
045900*
046000 GENER-FAIL-14-02.
046100     PERFORM FAIL.
046200     MOVE 1 TO CORRECT-18V0.
046300     MOVE PAGE-COUNTER TO COMPUTED-18V0.
046400     MOVE "PAGE-COUNTER AFTER FIRST GENER" TO RE-MARK.
046500 GENER-WRITE-14-02.
046600     MOVE 2 TO REC-CT.
046700     PERFORM PRINT-DETAIL.
046800 GENER-TEST-15.
046900*        THIS TEST EXECUTES A GENERATE STATEMENT FOR THE DETAIL
047000*    REPORT GROUP 19 TIMES.
047100*    REFERENCE  PAGE VIII-51, 3.1.4(2), (6)B, GENERATE STATEMENT
047200*
047300     PERFORM GENER-DETAIL-LINE 19 TIMES.
047400*
047500*    OUTPUT REPORT INFORMATION
047600*        NINETEEN DETAIL LINES SINGLE SPACED ARE PRESENTED ON
047700*    LINES 7 THROUGH 25 OF THE FIRST PAGE.
047800*    REFERENCE  PAGE VIII-18, 2.5.5.8.1(4)B, BODY GROUP PRE. RULES
047900*
048000     GO TO GENER-TEST-15-01.
048100 GENER-DETAIL-LINE.
048200     ADD 1 TO WS-COUNTER.
048300     GENERATE RW-FS4-DETAIL.
048400     MOVE WS-COUNTER TO TEMP-COMP.
048500     ADD 5 TO TEMP-COMP.
048600     IF LINE-COUNTER NOT EQUAL TO TEMP-COMP
048700         ADD 1 TO LC-ERRORS.
048800*
048900*        THE LINE-COUNTER SETTING AFTER THE GENERATE STATEMENT
049000*    IS EQUAL TO THE LINE NUMBER ON WHICH THE PRINT LINE WAS
049100*    PRESENTED.  THIS NUMBER IS FIVE GREATER THAN THE DETAIL
049200*    LINE NUMBER.
049300*    REFERENCE  PAGE VIII-19, 2.5.5.8.1(6)D, FINAL L-C SETTING
049400*
049500     IF PAGE-COUNTER NOT EQUAL TO PAGENO
049600         ADD 1 TO PC-ERRORS.
049700*
049800*        EXECUTION OF A GENERATE STATEMENT WHICH DOES NOT CAUSE
049900*    PAGE ADVANCING SHOULD NOT CHANGE THE VALUE OF PAGE-COUNTER.
050000*    REFERENCE  PAGE VIII-4, 2.4.4, PAGE-COUNTER RULES
050100*
050200 GENER-TEST-15-01.
050300     IF LC-ERRORS EQUAL TO ZERO
050400         PERFORM PASS
050500        GO TO GENER-WRITE-15-01.
050600 GENER-FAIL-15-01.
050700     PERFORM FAIL.
050800     MOVE LC-ERRORS TO COMPUTED-18V0.
050900     MOVE ZERO TO CORRECT-18V0.
051000     MOVE  "NUMBER OF LINE-COUNTER ERRORS" TO RE-MARK.
051100 GENER-WRITE-15-01.
051200     MOVE "GENR-TEST-15" TO PAR-NAME.
051300     MOVE "GENERATE 19 LINES" TO FEATURE.
051400     MOVE 1 TO REC-CT.
051500     PERFORM PRINT-DETAIL.
051600 GENER-TEST-15-02.
051700     IF PC-ERRORS EQUAL TO ZERO
051800         PERFORM PASS
051900        GO TO GENER-WRITE-15-02.
052000 GENER-FAIL-15-02.
052100     PERFORM FAIL.
052200     MOVE PC-ERRORS TO COMPUTED-18V0.
052300     MOVE ZERO TO CORRECT-18V0.
052400     MOVE "NUMBER OF PAGE-COUNTER ERRORS" TO RE-MARK.
052500 GENER-WRITE-15-02.
052600     MOVE 2 TO REC-CT.
052700     PERFORM PRINT-DETAIL.
052800 GENER-TEST-16.
052900*
053000*        THIS TEST EXECUTES A GENERATE STATEMENT WHICH CAUSES
053100*    PAGE ADVANCING FROM PAGE 1 TO PAGE 2.  THE PAGE FOOTING
053200*    REPORT GROUP SHOULD BE PRESENTED ON LINE 30 OF PAGE 1, THE
053300*    PAGE HEADINNG REPORT GROUP SHOULD BE PRESENTED ON LINE 1
053400*    OF PAGE 2 AND THE DETAIL REPORT GROUP SHOULD BE PRESENTED
053500*    ON LINE 6 OF PAGE 2.
053600*    REFERENCES  PAGE VIII-51, 3.1.4(4), GENERATE STATEMENT
053700*                PAGE VIII-14, 2.5.5.7, PH PRESENTATION RULES
053800*                PAGE VIII-17, 2.5.5.8, BODY GROUP PRE. RULES
053900*                PAGE VIII-20, 2.5.5.9, PF PRESENTATION RULES
054000*
054100     MOVE 1 TO WS-COUNTER.
054200     GENERATE RW-FS4-DETAIL.
054300 GENER-TEST-16-01.
054400     IF LINE-COUNTER EQUAL TO 6
054500         PERFORM PASS
054600         GO TO GENER-WRITE-16-01.
054700*
054800*        LINE-COUNTER SHOULD BE RESET TO ZERO WHEN THE PAGE
054900*    ADVANCE FROM PAGE 1 TO PAGE 2 IS EXECUTED, AND LINE-COUNTER
055000*    IS SET TO 6 WHEN THE DETAIL REPORT GROUP IS PRESENTED.
055100*    REFERENCES  PAGE VIII-5, 2.4.5(4), LINE-COUNTER RULES
055200*                PAGE VIII-19, 2.5.5.8.1(6)D, FINAL L-C SETTING
055300*
055400 GENER-FAIL-16-01.
055500     PERFORM FAIL.
055600     MOVE 6 TO CORRECT-18V0.
055700     MOVE LINE-COUNTER TO COMPUTED-18V0.
055800     MOVE "LINE-COUNTER AFTER PAGE ADVANCE" TO RE-MARK.
055900 GENER-WRITE-16-01.
056000     MOVE "GENR-TEST-16" TO PAR-NAME.
056100     MOVE "PAGE ADVANCE" TO FEATURE.
056200     MOVE 1 TO REC-CT.
056300     PERFORM PRINT-DETAIL.
056400 GENER-TEST-16-02.
056500     IF PAGE-COUNTER EQUAL TO 2
056600         PERFORM PASS
056700         GO TO GENER-WRITE-16-02.
056800*
056900*        PAGE-COUNTER SHOULD BE INCREMENTED TO 2 WHEN THE PAGE
057000*    ADVANCE FROM PAGE 1 TO PAGE 2 IS EXECUTED.
057100*    REFERENCE  PAGE VIII-5, 2.4.4(5), PAGE-COUNTER RULES
057200*
057300 GENER-FAIL-16-02.
057400     PERFORM FAIL.
057500     MOVE 2 TO CORRECT-18V0.
057600     MOVE PAGE-COUNTER TO COMPUTED-18V0.
057700     MOVE "PAGE-COUNTER AFTER PAGE ADVANCE" TO RE-MARK.
057800 GENER-WRITE-16-02.
057900     MOVE 2 TO REC-CT.
058000     PERFORM PRINT-DETAIL.
058100 GENER-TEST-17.
058200*        THIS TEST EXECUTES A GENERATE STATEMENT FOR THE DETAIL
058300*    REPORT GROUP 19 TIMES.  NINETEEN DETAIL LINES SINGLE SPACED
058400*    ARE PRESENTED ON LINES 7 THROUGH 25 OF THE SECOND REPORT
058500*    PAGE.
058600*    REFERENCES  PAGE VIII-51, 3.1.4(2), (6)B, GENERATE STATEMENT
058700*                PAGE VIII-18, 2.5.5.8.1(4)B, BODY GROUP PRE RULES
058800*
058900     MOVE 2 TO PAGENO.
059000     MOVE ZERO TO LC-ERRORS  PC-ERRORS.
059100     PERFORM GENER-DETAIL-LINE 19 TIMES.
059200 GENER-TEST-17-01.
059300     IF LC-ERRORS EQUAL TO ZERO
059400         PERFORM PASS
059500         GO TO GENER-WRITE-17-01.
059600 GENER-FAIL-17-01.
059700     PERFORM FAIL.
059800     MOVE LC-ERRORS TO COMPUTED-18V0.
059900     MOVE ZERO TO CORRECT-18V0.
060000     MOVE "NUMBER OF LINE-COUNTER ERRORS" TO RE-MARK.
060100 GENER-WRITE-17-01.
060200     MOVE "GENR-TEST-17" TO PAR-NAME.
060300     MOVE 1 TO REC-CT.
060400     MOVE "GENERATE 19 LINES" TO FEATURE.
060500     PERFORM PRINT-DETAIL.
060600 GENER-TEST-17-02.
060700     IF PC-ERRORS EQUAL TO ZERO
060800         PERFORM PASS
060900         GO TO GENER-WRITE-17-02.
061000 GENER-FAIL-17-02.
061100     PERFORM FAIL.
061200     MOVE PC-ERRORS TO COMPUTED-18V0.
061300     MOVE ZERO TO CORRECT-18V0.
061400     MOVE "NUMBER OF PAGE-COUNTER ERRORS" TO RE-MARK.
061500 GENER-WRITE-17-02.
061600     MOVE 2 TO REC-CT.
061700     PERFORM PRINT-DETAIL.
061800 GENER-TEST-18.
061900*        THIS TEST EXECUTES A GENERATE STATEMENT WHICH CAUSES
062000*    PAGE ADVANCING FROM PAGE 2 TO PAGE 3.  THE PAGE FOOTING
062100*    REPORT GROUP SHOULD BE PRESENTED ON LINE 30 OF PAGE 2, THE
062200*    PAGE HEADING REPORT GROUP SHOULD BE PRESENTED ON LINE 1
062300*    OF PAGE 3 AND THE DETAIL REPORT GROUP SHOULD BE PRESENTED
062400*    ON LINE 6 OF PAGE 3.
062500*    REFERENCES  PAGE VIII-51, 3.1.4(4), GENERATE STATEMENT
062600*                PAGE VIII-14, 2.5.5.7, PH PRESENTATION RULES
062700*                PAGE VIII-17, 2.5.5.8, BODY GROUP PRE. RULES
062800*                PAGE VIII-20, 2.5.5.9, PF PRESENTATION RULES
062900*
063000     MOVE 1 TO WS-COUNTER.
063100     GENERATE RW-FS4-DETAIL.
063200 GENER-TEST-18-01.
063300     IF LINE-COUNTER EQUAL TO 6
063400         PERFORM PASS
063500         GO TO GENER-WRITE-18-01.
063600*
063700*        LINE-COUNTER SHOULD BE RESET TO ZERO WHEN THE PAGE
063800*    ADVANCE FROM PAGE 2 TO PAGE 3 IS EXECUTED, AND LINE-COUNTER
063900*    IS SET TO 6 WHEN THE DETAIL REPORT GROUP IS PRESENTED.
064000*    REFERENCES  PAGE VIII-5, 2.4.5(4), LINE-COUNTER RULES
064100*                PAGE VIII-19, 2.5.5.8.1(6)D, FINAL L-C SETTING
064200*
064300 GENER-FAIL-18-01.
064400     PERFORM FAIL.
064500     MOVE 6 TO CORRECT-18V0.
064600     MOVE LINE-COUNTER TO COMPUTED-18V0.
064700     MOVE "LINE-COUNTER AFTER PAGE ADVANCE" TO RE-MARK.
064800 GENER-WRITE-18-01.
064900     MOVE "GENR-TEST-18" TO PAR-NAME.
065000     MOVE "PAGE ADVANCE" TO FEATURE.
065100     MOVE 1 TO REC-CT.
065200     PERFORM PRINT-DETAIL.
065300 GENER-TEST-18-02.
065400         IF PAGE-COUNTER EQUAL TO 3
065500         PERFORM PASS
065600         GO TO GENER-WRITE-18-02.
065700*
065800*        PAGE-COUNTER SHOULD BE INCREMENTED TO 3 WHEN THE PAGE
065900*    ADVANCE FROM PAGE 2 TO PAGE 3 IS EXECUTED.
066000*    REFERENCES  PAGE VIII-5, 2.4.4(5), PAGE-COUNTER RULES
066100*
066200 GENER-FAIL-18-02.
066300     PERFORM FAIL.
066400     MOVE 3 TO CORRECT-18V0.
066500     MOVE PAGE-COUNTER TO COMPUTED-18V0.
066600     MOVE "PAGE-COUNTER AFTER PAGE ADVANCE" TO RE-MARK.
066700 GENER-WRITE-18-02.
066800     MOVE 2 TO REC-CT.
066900     PERFORM PRINT-DETAIL.
067000 GENER-TEST-19.
067100*        THIS TEST EXECUTES A GENERATE STATEMENT FOR THE DETAIL
067200*    REPORT GROUP 19 TIMES.  NINETEEN DETAIL LINES SINGLE SPACED
067300*    ARE PRESENTED ON LINES 7 THROUGH 25 OF THE THIRD REPORT
067400*    PAGE.
067500*    REFERENCES  PAGE VIII-51, 3.1.4(2),(6), GENERATE STATEMENT
067600*                PAGE VIII-18, 2.5.5.8.1(4)B, BODY GROUP PRE RULES
067700*
067800     MOVE 3 TO PAGENO.
067900     MOVE ZERO TO LC-ERRORS.
068000     MOVE ZERO TO PC-ERRORS.
068100     PERFORM GENER-DETAIL-LINE 19 TIMES.
068200 GENER-TEST-19-01.
068300     IF LC-ERRORS EQUAL TO ZERO
068400         PERFORM PASS
068500         GO TO GENER-WRITE-19-01.
068600 GENER-FAIL-19-01.
068700     PERFORM FAIL.
068800     MOVE LC-ERRORS TO COMPUTED-18V0.
068900     MOVE ZERO TO CORRECT-18V0.
069000     MOVE "NUMBER OF LINE-COUNTER ERRORS" TO RE-MARK.
069100 GENER-WRITE-19-01.
069200     MOVE "GENR-TEST-19" TO PAR-NAME.
069300     MOVE 1 TO REC-CT.
069400     MOVE "GENERATE 19 LINES" TO FEATURE.
069500     PERFORM PRINT-DETAIL.
069600 GENER-TEST-19-02.
069700     IF PC-ERRORS EQUAL TO ZERO
069800         PERFORM PASS
069900         GO TO GENER-WRITE-19-02.
070000 GENER-FAIL-19-02.
070100     PERFORM FAIL.
070200     MOVE PC-ERRORS TO COMPUTED-18V0.
070300     MOVE ZERO TO CORRECT-18V0.
070400     MOVE "NUMBER OF PAGE-COUNTER ERRORS" TO RE-MARK.
070500 GENER-WRITE-19-02.
070600     MOVE 2 TO REC-CT.
070700     PERFORM PRINT-DETAIL.
070800 TERM-TEST-04.
070900*        THE TERMINATE STATEMENT SHOULD PRODUCE THE PAGE FOOTING
071000*    REPORT GROUP ON LINE 30 OF PAGE 3.
071100*    REFERENCES PAGE VIII-55, 3.4, TERMINATE STATEMENT
071200*                PAGE VIII-47, 2.21.4(7), TYPE CLAUSE GEN. RULES
071300*
071400     TERMINATE RW-FS4-REPORT-1.
071500     MOVE ZERO TO REC-CT.
071600 TERM-WRITE-04.
071700     MOVE "TERMINATE REPORT" TO FEATURE.
071800     MOVE "TERM-TEST-04" TO PAR-NAME.
071900     MOVE "3 PAGE REPORT" TO COMPUTED-A.
072000     MOVE "20 DE LINES PER PAGE" TO CORRECT-A.
072100     MOVE "CHECK RWCS OUTPUT REPORT" TO RE-MARK.
072200     PERFORM PRINT-DETAIL.
072300 CLOSE-RW-FS4.
072400         CLOSE RW-FS4.
072500 EXIT-RW104.
072600     EXIT.
072700 CCVS-EXIT SECTION.
072800 CCVS-999999.
072900     GO TO CLOSE-FILES.
