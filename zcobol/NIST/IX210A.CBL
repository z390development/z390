000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IX210A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*    THE PURPOSE OF THE  PROGRAM IS TO TEST USE OF THE
002200*    START --- GREATER THAN --- STATEMENT USING FIRST THE PRIME
002300*    RECORD KEY AND THEN WITH AN ALTERNATE RECORD KEY
002400*    AS THE KEY OF REFERENCE.   THE START STATEMENT NAMES,
002500*    IN ITS CONSTRUCT , EITHER THE DATA NAME SPECIFIED IN THE
002600*    KEY CLAUSE OR A DATA ITEM THAT IS SUBORDINATE TO THE
002700*    KEY NAME.   DIFFERENT KEY VALUES ARE USED FOR TESTING.
002800*    IF A KEY VALUE IS PROVIDED WHICH MATCHES A RECORD IN THE FILE
002900*    WHEN THE START IS EXECUTED THEN THE RECORD IS EXPECTED TO
003000*    MADE AVAILABLE BY THE SUBSEQUENT READ STATEMENT.  IF A KEY
003100*    VALUE IS PROVIDED WHICH DOES NOT  MATCH ANY RECORD IN THE
003200*    FILE THEN THE INVALID KEY PATH IS EXPECTED TO BE TAKEN.
003300*    THE FILE STATUS CONTENTS RESULTING FROM EXECUTION OF THE
003400*    START TESTS ARE SAVED AND CHECKED IN LATER TESTS.
003500*
003600*            REFERENCE   AMERICAN NATIONAL STANDARD
003700*                        PROGRAMMING LANGUAGE COBOL, X3.23-1985.
003800*                        SECTION IX, INDEX I-O, THE START
003900*                        STATEMENT. PARAGRAPHS 4.7.3 (3);
004000*                                              4.7.4 (1), (4), (4)
004100*                                                        AND
004200*                        THE FILE STATUS PARAGRAPH 1.3.4
004300*
004400*    BEFORE EXECUTION OF THE START IN EACH TEST, A RECORD IS MADE
004500*    AVAILABLE FROM THE FILE THAT IS DIFFERENT THAN WILL RESULT
004600*    FROM THE TEST, AND THE RECORD KEY IS LOADED WITH A KEY VALUE.
004700*    DEPENDING ON THE NATURE OF THE TEST THE KEY VALUE MAY OR
004800*    MAY NOT BE A VALID KEY FOR THE FILE.
004900*
005000*    THIS PROGRAM FIRST CREATES AN  INDEXED SEQUENTIAL FILE
005100*    CONTAINING TWO ALTERNATE KEYS AND  THE ONE REQUIRED RECORD
005200*    KEY FOR THE FILE.  IMMEDIATELY FOLLOWING FILE CREATION THE
005300*    FILE IS READ AND THE RECORDS OF THE FILE VERIFIED FOR
005400*    ACCURACY.  NEXT THE TESTS ARE EXECUTED USING THE START ---
005500*    GREATER THAN ---STATEMENT.
005600*    THE RECORDS IN THE FILE ARE CREATED IN SEQUENTIAL ORDER BY
005700*    RECORD KEY VALUE.  FOLLOWING  IS A SAMPLE OF THE DATA
005800*    CONTENTS FOR THE RECORD KEY AND TWO ALTERNATE RECORD KEYS IN
005900*    THE FILE.
006000*
006100*   REC-NO  RECORD-KEY      ALTERNATE-KEY-1     ALTERNATE-KEY-2
006200*   ------  ----------      ---------------     ---------------
006300*    001   BBBBBBBBBC002 EEEEEEEEEF000ALTKEY1 WWWWWWWWWV398ALTKEY2
006400*    002   BBBBBBBBCC004 EEEEEEEEFF004ALTKEY1 WWWWWWWWVV396ALTKEY2
006500*    003   BBBBBBBCCC006 EEEEEEEFFF006ALTKEY1 WWWWWWWVVV394ALTKEY2
006600*     .          .                 .                    .
006700*     .          .                 .                    .
006800*     .          .                 .                    .
006900*    010   CCCCCCCCCC020 FFFFFFFFFF020ALTKEY1 VVVVVVVVVV380ALTKEY2
007000*    011   CCCCCCCCCD022 FFFFFFFFFG022ALTKEY1 VVVVVVVVVV380ALTKEY2
007100*    012   CCCCCCCCDD024 FFFFFFFFGG024ALTKEY1 VVVVVVVVUU376ALTKEY2
007200*     .          .                 .                    .
007300*     .          .                 .                    .
007400*     .          .                 .                    .
007500*    200   UUUUUUUUUU400 YYYYYYYYYY400ALTKEY1 DDDDDDDDDD000ALTKEY2
007600*
007700*     NOTE 1 - ALTERNATE KEY NUMBER 2 CONTAINS DUPLICATE KEYS
007800*              EVERY 10TH AND 11TH RECORDS.
007900*
008000*     NOTE 2 - THE FIRST 50 RECORDS AND LAST 25 RECORDS OF THE
008100*    FILE FOLLOW THE ABOVE SEQUENTIAL KEY PATTERN.  FOR THE MIDDLE
008200*    125 RECORDS ONLY THE NUMBER PART OF THE KEYS ARE VARIED
008300*    AND VARIED IN THE SEQUENCE SHOWN ABOVE.  THAT IS, RECORD-KEY
008400*    AND ALTERNATE-KEY-1 ARE INCREMENTED BY 2 AND THE ALTERNATE-
008500*    KEY-2 IS DECREMENTED BY 2 EACH TIME A RECORD IS WRITTEN TO
008600*    THE FILE.  THE FILE IS DESIGNED TO BE LARGE ENOUGH SO THAT
008700*    AN I-O OPERATION IS REQUIRED FOR EACH RECORD ACCESSED FROM
008800*    THE FILE.
008900*
009000*    FILE CHARACTERISTICS ARE: FILE SIZE            = 200 RECORDS
009100*                              RECORD SIZE          = 240 CHARS.
009200*                              RECORD KEY SIZE      = 13  CHARS.
009300*                              ALTERNATE KEY 1 SIZE = 20  CHARS.
009400*                              ALTERNATE KEY 2 SIZE = 20  CHARS.
009500*                              ACCESS MODE          = SEQUENTIAL
009600*
009700*    A LIST OF COBOL ELEMENTS WITH THE PARAGRAPH NAME IN PARENTH-
009800*    ESIS THAT TESTS THE ELEMENT AND A SHORT DESCRIPTION OF THE
009900*    TEST FOLLOWS.
010000*
010100*      PROGRAM COLLATING SEQUENCE CLAUSE. (ALL START TESTS) -
010200*            THE PROGRAM COLLATING SEQUENCE CLAUSE SHOULD HAVE NO
010300*            EFFECT ON THE COMARAISIONS ASSOCIATED WITH THE START
010400*            STATEMENT.  THIS PROGRAM ASSUMES THAT THE PROGRAM
010500*            COLLATING SEQUENCE CLAUSE ALSO DOES NOT IN ANY WAY
010600*            EFFECT THE SEQUENTIAL ORDER OF RECORDS ACCESSED
010700*            FROM OR WRITTEN TO THE FILE.
010800*      WRITE --- INVALID KEY---. (INX-TEST-001) - THIS TEST CREATE
010900*            A FILE OF 200 RECORDS CONTAINING ONE RECORD KEY AND
011000*            TWO ALTERNATE KEYS.
011100*      READ ---AT END ---. (INX-TEST-002) - THIS TEST READS THE
011200*            FILE CREATED IN INX-TEST-001 AND VERIFIES THAT   THE
011300*            FILE WAS CREATED CORRECTLY.
011400*      START ---KEY GREATER THAN RECORD-KEY INVALID KEY ---. (INX-
011500*            TEST-003.01 THRU INX-TEST-003.04) - THE START
011600*            STATEMENT IS EXECUTED USING THE RECORD-KEY FOR THE
011700*            FILE CONTAINING KEY VALUES WHICH RESPECTIVELY EQUAL A
011800*            RECORD IN THE FILE (.01), BETWEEN TWO EXISTING KEY
011900*            VALUES (02), LESS THAN THE FIRST RECORD IN THE FILE
012000*            (.03) AND GREATER THAN THAN THE LAST RECORD IN THE
012100*            FILE (.04).
012200*      START ---KEY GREATER THAN DATA-ITEM  INVALID KEY ---. (INX-
012300*            TEST-003.05 THRU INX-TEST-003.09) - THE START
012400*            STATEMENT IS EXECUTED USING A DATA ITEM WHICH IS
012500*            SUBORDINATE TO  THE RECORD-KEY NAME OF THE FILE
012600*            AND  CONTAINING KEY VALUES WHICH RESPECTIVELY EQUAL A
012700*            RECORD IN THE FILE (.05), EQUAL A VALUE PRESENT IN
012800*            IN MORE THAN ONE RECORD IN THE FILE (.06),
012900*            NOT EQUAL TO ANY RECORD IN THE FILE (.07, LESS THAN
013000*            THE FIRST RECORD IN THE FILE (.08) AND GREATER THAN
013100*            THE LAST RECORD IN THE FILE (.09.
013200*
013300*            NOTE -- IN SOME OF THE TESTS THE DATA ITEM SPECIFIED
013400*                    IS AN ENTRY SUBORDINATE TO A REDEFINES
013500*                    ENTRY WHICH USES AS ITS OBJECT THE KEY
013600*                   NAMED BY THE RECORD KEY CLAUSE.
013700*
013800*      FILE STATUS. (INX-TEST-004.01 THRU INX-TEST-004.09) - THESE
013900*            TESTS CHECK THE CONTENTS OF THE FILE STATUS RESULTING
014000*            FROM THE START IN INX-TEST-003.01 THRU
014100*            INX-TEST-003.09.
014200*      START ---KEY GREATER THAN ALTNATE-KEY INVALID KEY --. (INX-
014300*            TEST-005.01 THRU INX-TEST-005.04) - THE START
014400*            STATEMENT IS EXECUTED USING THE ALTERNATE-KEY FOR THE
014500*            FILE CONTAINING KEY VALUES WHICH RESPECTIVELY EQUAL A
014600*            RECORD IN THE FILE (.01), BETWEEN TWO EXISTING KEY
014700*            VALUES (02), LESS THAN THE FIRST RECORD IN THE FILE
014800*            (.03) AND GREATER THAN THAN THE LAST RECORD IN THE
014900*            FILE (.04).
015000*      START ---KEY GREATER THAN DATA-ITEM   INVALID KEY --. (INX-
015100*            TEST-005.05 THRU INX-TEST-005.09) - THE START
015200*            STATEMENT IS EXECUTED USING A DATA ITEM WHICH IS
015300*            SUBORDINATE TO THE ALTERNATE-KEY NAME OF THE FILE
015400*            AND  CONTAINING KEY VALUES WHICH RESPECTIVELY EQUAL A
015500*            RECORD IN THE FILE (.05), EQUAL A VALUE PRESENT IN
015600*            IN MORE THAN ONE RECORD IN THE FILE (.06),
015700*            NOT EQUAL TO ANY RECORD IN THE FILE (.07, LESS THAN
015800*            THE FIRST RECORD IN THE FILE (.08) AND GREATER THAN
015900*            THE LAST RECORD IN THE FILE (.09.
016000*
016100*            NOTE -- IN SOME OF THE TESTS THE DATA ITEM SPECIFIED
016200*                    IS AN ENTRY SUBORDINATE TO A REDEFINES
016300*                    ENTRY WHICH USES AS ITS OBJECT THE KEY
016400*                   NAMED BY THE RECORD KEY CLAUSE.
016500*
016600*      FILE STATUS. (INX-TEST-006.01 THRU INX-TEST-006.09) - THESE
016700*            TESTS CHECK THE CONTENTS OF THE FILE STATUS RESULTING
016800*            FROM THE START IN INX-TEST-005.01 THRU
016900*            INX-TEST-005.09.
017000*      MULTIPLE STARTS. (INX-TEST-007) -  THIS TEST EXECUTES
017100*            SEVERAL START STATEMENTS FOLLOWED BY A READ STATEMENT
017200*            AND EXPECTS THE RECORD  DESIGNATED BY THE LAST
017300*            START BE MADE AVAILABLE.
017400*
017500******************************************************************
017600*
017700 ENVIRONMENT DIVISION.
017800 CONFIGURATION SECTION.
017900 SOURCE-COMPUTER.
018000     XXXXX082.
018100 OBJECT-COMPUTER.
018200     XXXXX083
018300          PROGRAM COLLATING SEQUENCE IS FOR-INX-START-TEST.
018400 SPECIAL-NAMES.
018500     ALPHABET
018600     FOR-INX-START-TEST IS "WVUTSRJIHGFEDCB".
018700 INPUT-OUTPUT SECTION.
018800 FILE-CONTROL.
018900P    SELECT RAW-DATA   ASSIGN TO
019000P    XXXXX062
019100P           ORGANIZATION IS INDEXED
019200P           ACCESS MODE IS RANDOM
019300P           RECORD KEY IS RAW-DATA-KEY.
019400     SELECT PRINT-FILE ASSIGN TO
019500     XXXXX055.
019600     SELECT  IX-FS1
019700     ASSIGN TO
019800     XXXXX024
019900J    XXXXX044
020000        ACCESS MODE IS SEQUENTIAL
020100        ORGANIZATION IS INDEXED
020200        RECORD KEY IS IX-FS1-KEY
020300        ALTERNATE RECORD KEY IS IX-FS1-ALTKEY1
020400        ALTERNATE RECORD KEY IS IX-FS1-ALTKEY2 WITH DUPLICATES
020500        FILE STATUS IS FS1-STATUS.
020600 DATA DIVISION.
020700 FILE SECTION.
020800P
020900PFD  RAW-DATA.
021000P
021100P01  RAW-DATA-SATZ.
021200P    05  RAW-DATA-KEY        PIC X(6).
021300P    05  C-DATE              PIC 9(6).
021400P    05  C-TIME              PIC 9(8).
021500P    05  C-NO-OF-TESTS       PIC 99.
021600P    05  C-OK                PIC 999.
021700P    05  C-ALL               PIC 999.
021800P    05  C-FAIL              PIC 999.
021900P    05  C-DELETED           PIC 999.
022000P    05  C-INSPECT           PIC 999.
022100P    05  C-NOTE              PIC X(13).
022200P    05  C-INDENT            PIC X.
022300P    05  C-ABORT             PIC X(8).
022400 FD  PRINT-FILE.
022500 01  PRINT-REC PICTURE X(120).
022600 01  DUMMY-RECORD PICTURE X(120).
022700 FD  IX-FS1
022800C    LABEL RECORDS ARE STANDARD
022900C    DATA RECORD IS IX-FS1R1-F-G-240
023000     RECORD CONTAINS 240 CHARACTERS.
023100 01  IX-FS1R1-F-G-240.
023200     05 IX-FS1-REC-120           PICTURE X(120).
023300     05 IX-FS1-REC-121-240.
023400        10 FILLER                PICTURE X(8).
023500        10 IX-REC-KEY-AREA.
023600           15 IX-FS1-KEY.
023700              20 IX-FS1-KEY-1-10.
023800                 25 IX-FS1-KEY-1-5      PICTURE X(5).
023900                 25 IX-FS1-KEY-6-10     PICTURE X(5).
024000               20 IX-FS1-KEY-11-13      PICTURE X(3).
024100           15 IX-REDF-RECKEY REDEFINES IX-FS1-KEY.
024200              20 R-RECKEY-1-7    PICTURE X(7).
024300              20 R-RECKEY-8-13   PICTURE X(6).
024400           15 FILLER             PICTURE X(16).
024500        10 FILLER                PICTURE X(9).
024600        10 IX-ALT-KEY1-AREA.
024700           15 IX-FS1-ALTKEY1.
024800              20 IX-FS1-ALTKEY1-1-10.
024900                 25 IX-FS1-ALTKEY1-1-5  PICTURE X(5).
025000                 25 IX-FS1-ALTKEY1-6-10 PICTURE X(5).
025100              20 IX-FS1-ALTKEY1-11-13   PICTURE X(3).
025200              20 IX-FS1-ALTKEY1-14-20   PICTURE X(7).
025300           15 IX-REDF-ALTKEY1 REDEFINES IX-FS1-ALTKEY1.
025400              20 R-ALTKEY1-1-6   PICTURE X(6).
025500              20 R-ALTKEY1-7-10  PICTURE X(4).
025600              20 R-ALTKEY1-11-20 PICTURE X(10).
025700           15 FILLER             PICTURE X(9).
025800        10 FILLER                PICTURE X(9).
025900        10 IX-ALT-KEY2-AREA.
026000           15 IX-FS1-ALTKEY2.
026100              20 IX-FS1-ALTKEY2-1-10.
026200                 25 IX-FS1-ALTKEY2-1-5  PICTURE X(5).
026300                 25 IX-FS1-ALTKEY2-6-10 PICTURE X(5).
026400              20 IX-FS1-ALTKEY2-11-13   PICTURE X(3).
026500              20 IX-FS1-ALTKEY2-14-20   PICTURE X(7).
026600           15 FILLER             PICTURE X(9).
026700        10 FILLER                PICTURE X(7).
026800 WORKING-STORAGE SECTION.
026900 01  WRK-FS1-RECKEY.
027000     05 FS1-RECKEY-1-13.
027100        10 FS1-RECKEY-1-10       PICTURE X(10).
027200        10 FS1-RECKEY-11-13      PICTURE 9(3).
027300     05 FILLER                   PICTURE X(16)  VALUE SPACE.
027400 01  WRK-FS1-ALTKEY1.
027500      05 FS1-ALTKEY1-1-20.
027600       10  FS1-ALTKEY1-1-10.
027700        15 FS1-ALTKEY1-1-5       PICTURE X(5).
027800        15 FS1-ALTKEY1-6-10      PICTURE X(5).
027900       10 FS1-ALTKEY1-11-13      PICTURE 9(3).
028000       10 FS1-ALTKEY1-14-20      PICTURE X(7).
028100     05 FILLER                   PICTURE X(9)  VALUE SPACE.
028200 01  WRK-FS1-ALTKEY2.
028300     05 FS1-ALTKEY2-1-20.
028400        10 FS1-ALTKEY2-1-10.
028500           15 FS1-ALTKEY2-1-5    PICTURE X(5).
028600           15 FS1-ALTKEY2-6-10   PICTURE X(5).
028700        10 FS1-ALTKEY2-11-13     PICTURE 9(3).
028800        10 FS1-ALTKEY2-14-20     PICTURE X(7).
028900     05 FILLER                   PICTURE X(9) VALUE SPACE.
029000 01  RECNO                       PICTURE 9(5)  VALUE ZERO.
029100 01  FS1-STATUS                  PICTURE XX   VALUE SPACE.
029200 01  EXCUT-COUNTER-06V00         PICTURE 9(6) VALUE ZERO.
029300 01  KEYSUB                      PICTURE 9(3) COMPUTATIONAL.
029400 01  INVKEY-COUNTER              PICTURE 9(3) COMPUTATIONAL.
029500 01  RECORDS-WRITTEN             PICTURE 9(3).
029600 01  RECKEY-NUM                  PICTURE 9(3).
029700 01  ALTKEY1-NUM                 PICTURE 9(3).
029800 01  ALTKEY2-NUM                 PICTURE 9(3).
029900 01  RECORD-KEY-CONTENT.
030000     05 FILLER PIC X(53) VALUE
030100          "BBBBBBBBBC002EEEEEEEEEF002ALTKEY1WWWWWWWWWV398ALTKEY2".
030200     05 FILLER PIC X(53) VALUE
030300          "BBBBBBBBCC004EEEEEEEEFF004ALTKEY1WWWWWWWWVV396ALTKEY2".
030400     05 FILLER PIC X(53) VALUE
030500          "BBBBBBBCCC006EEEEEEEFFF006ALTKEY1WWWWWWWVVV394ALTKEY2".
030600     05 FILLER PIC X(53) VALUE
030700          "BBBBBBCCCC008EEEEEEFFFF008ALTKEY1WWWWWWVVVV392ALTKEY2".
030800     05 FILLER PIC X(53) VALUE
030900          "BBBBBCCCCC010EEEEEFFFFF010ALTKEY1WWWWWVVVVV390ALTKEY2".
031000     05 FILLER PIC X(53) VALUE
031100          "BBBBCCCCCC012EEEEFFFFFF012ALTKEY1WWWWVVVVVV388ALTKEY2".
031200     05 FILLER PIC X(53) VALUE
031300          "BBBCCCCCCC014EEEFFFFFFF014ALTKEY1WWWVVVVVVV386ALTKEY2".
031400     05 FILLER PIC X(53) VALUE
031500          "BBCCCCCCCC016EEFFFFFFFF016ALTKEY1WWVVVVVVVV384ALTKEY2".
031600     05 FILLER PIC X(53) VALUE
031700          "BCCCCCCCCC018EFFFFFFFFF018ALTKEY1WVVVVVVVVV382ALTKEY2".
031800     05 FILLER PIC X(53) VALUE
031900          "CCCCCCCCCC020FFFFFFFFFF020ALTKEY1VVVVVVVVVV380ALTKEY2".
032000     05 FILLER PIC X(53) VALUE
032100          "CCCCCCCCCD022FFFFFFFFFG022ALTKEY1VVVVVVVVVV380ALTKEY2".
032200     05 FILLER PIC X(53) VALUE
032300          "CCCCCCCCDD024FFFFFFFFGG024ALTKEY1VVVVVVVVUU376ALTKEY2".
032400     05 FILLER PIC X(53) VALUE
032500          "CCCCCCCDDD026FFFFFFFGGG026ALTKEY1VVVVVVVUUU374ALTKEY2".
032600     05 FILLER PIC X(53) VALUE
032700          "CCCCCCDDDD028FFFFFFGGGG028ALTKEY1VVVVVVUUUU372ALTKEY2".
032800     05 FILLER PIC X(53) VALUE
032900          "CCCCCDDDDD030FFFFFGGGGG030ALTKEY1VVVVVUUUUU370ALTKEY2".
033000     05 FILLER PIC X(53) VALUE
033100          "CCCCDDDDDD032FFFFGGGGGG032ALTKEY1VVVVUUUUUU368ALTKEY2".
033200     05 FILLER PIC X(53) VALUE
033300          "CCCDDDDDDD034FFFGGGGGGG034ALTKEY1VVVUUUUUUU366ALTKEY2".
033400     05 FILLER PIC X(53) VALUE
033500          "CCDDDDDDDD036FFGGGGGGGG036ALTKEY1VVUUUUUUUU364ALTKEY2".
033600     05 FILLER PIC X(53) VALUE
033700          "CDDDDDDDDD038FGGGGGGGGG038ALTKEY1VUUUUUUUUU362ALTKEY2".
033800     05 FILLER PIC X(53) VALUE
033900          "DDDDDDDDDD040GGGGGGGGGG040ALTKEY1UUUUUUUUUU360ALTKEY2".
034000     05 FILLER PIC X(53) VALUE
034100          "DDDDDDDDDE042GGGGGGGGGH042ALTKEY1UUUUUUUUUU360ALTKEY2".
034200     05 FILLER PIC X(53) VALUE
034300          "DDDDDDDDEE044GGGGGGGGHH044ALTKEY1UUUUUUUUTT356ALTKEY2".
034400     05 FILLER PIC X(53) VALUE
034500          "DDDDDDDEEE046GGGGGGGHHH046ALTKEY1UUUUUUUTTT354ALTKEY2".
034600     05 FILLER PIC X(53) VALUE
034700          "DDDDDDEEEE048GGGGGGHHHH048ALTKEY1UUUUUUTTTT352ALTKEY2".
034800     05 FILLER PIC X(53) VALUE
034900          "DDDDDEEEEE050GGGGGHHHHH050ALTKEY1UUUUUTTTTT350ALTKEY2".
035000     05 FILLER PIC X(53) VALUE
035100          "DDDDEEEEEE052GGGGHHHHHH052ALTKEY1UUUUTTTTTT348ALTKEY2".
035200     05 FILLER PIC X(53) VALUE
035300          "DDDEEEEEEE054GGGHHHHHHH054ALTKEY1UUUTTTTTTT346ALTKEY2".
035400     05 FILLER PIC X(53) VALUE
035500          "DDEEEEEEEE056GGHHHHHHHH056ALTKEY1UUTTTTTTTT344ALTKEY2".
035600     05 FILLER PIC X(53) VALUE
035700          "DEEEEEEEEE058GHHHHHHHHH058ALTKEY1UTTTTTTTTT342ALTKEY2".
035800     05 FILLER PIC X(53) VALUE
035900          "EEEEEEEEEE060HHHHHHHHHH060ALTKEY1TTTTTTTTTT340ALTKEY2".
036000     05 FILLER PIC X(53) VALUE
036100          "EEEEEEEEEF062HHHHHHHHHI062ALTKEY1TTTTTTTTTT340ALTKEY2".
036200     05 FILLER PIC X(53) VALUE
036300          "EEEEEEEEFF064HHHHHHHHII064ALTKEY1TTTTTTTTSS336ALTKEY2".
036400     05 FILLER PIC X(53) VALUE
036500          "EEEEEEEFFF066HHHHHHHIII066ALTKEY1TTTTTTTSSS334ALTKEY2".
036600     05 FILLER PIC X(53) VALUE
036700          "EEEEEEFFFF068HHHHHHIIII068ALTKEY1TTTTTTSSSS332ALTKEY2".
036800     05 FILLER PIC X(53) VALUE
036900          "EEEEEFFFFF070HHHHHIIIII070ALTKEY1TTTTTSSSSS330ALTKEY2".
037000     05 FILLER PIC X(53) VALUE
037100          "EEEEFFFFFF072HHHHIIIIII072ALTKEY1TTTTSSSSSS328ALTKEY2".
037200     05 FILLER PIC X(53) VALUE
037300          "EEEFFFFFFF074HHHIIIIIII074ALTKEY1TTTSSSSSSS326ALTKEY2".
037400     05 FILLER PIC X(53) VALUE
037500          "EEFFFFFFFF076HHIIIIIIII076ALTKEY1TTSSSSSSSS324ALTKEY2".
037600     05 FILLER PIC X(53) VALUE
037700          "EFFFFFFFFF078HIIIIIIIII078ALTKEY1TSSSSSSSSS322ALTKEY2".
037800     05 FILLER PIC X(53) VALUE
037900          "FFFFFFFFFF080IIIIIIIIII080ALTKEY1SSSSSSSSSS320ALTKEY2".
038000     05 FILLER PIC X(53) VALUE
038100          "FFFFFFFFFG082IIIIIIIIIJ082ALTKEY1SSSSSSSSSS320ALTKEY2".
038200     05 FILLER PIC X(53) VALUE
038300          "FFFFFFFFGG084IIIIIIIIJJ084ALTKEY1SSSSSSSSRR316ALTKEY2".
038400     05 FILLER PIC X(53) VALUE
038500          "FFFFFFFGGG086IIIIIIIJJJ086ALTKEY1SSSSSSSRRR314ALTKEY2".
038600     05 FILLER PIC X(53) VALUE
038700          "FFFFFFGGGG088IIIIIIJJJJ088ALTKEY1SSSSSSRRRR312ALTKEY2".
038800     05 FILLER PIC X(53) VALUE
038900          "FFFFFGGGGG090IIIIIJJJJJ090ALTKEY1SSSSSRRRRR310ALTKEY2".
039000     05 FILLER PIC X(53) VALUE
039100          "FFFFGGGGGG092IIIIJJJJJJ092ALTKEY1SSSSRRRRRR308ALTKEY2".
039200     05 FILLER PIC X(53) VALUE
039300          "FFFGGGGGGG094IIIJJJJJJJ094ALTKEY1SSSRRRRRRR306ALTKEY2".
039400     05 FILLER PIC X(53) VALUE
039500          "FFGGGGGGGG096IIJJJJJJJJ096ALTKEY1SSRRRRRRRR304ALTKEY2".
039600     05 FILLER PIC X(53) VALUE
039700          "FGGGGGGGGG098IJJJJJJJJJ098ALTKEY1SRRRRRRRRR302ALTKEY2".
039800     05 FILLER PIC X(53) VALUE
039900          "GGGGGGGGGG100JJJJJJJJJJ100ALTKEY1RRRRRRRRRR300ALTKEY2".
040000     05 FILLER PIC X(53) VALUE
040100          "RRRRSSSSSS352VVVVWWWWWW352ALTKEY1GGGGFFFFFF048ALTKEY2".
040200     05 FILLER PIC X(53) VALUE
040300          "RRRSSSSSSS354VVVWWWWWWW354ALTKEY1GGGFFFFFFF046ALTKEY2".
040400     05 FILLER PIC X(53) VALUE
040500          "RRSSSSSSSS356VVWWWWWWWW356ALTKEY1GGFFFFFFFF044ALTKEY2".
040600     05 FILLER PIC X(53) VALUE
040700          "RSSSSSSSSS358VWWWWWWWWW358ALTKEY1GFFFFFFFFF042ALTKEY2".
040800     05 FILLER PIC X(53) VALUE
040900          "SSSSSSSSSS360WWWWWWWWWW360ALTKEY1FFFFFFFFFF040ALTKEY2".
041000     05 FILLER PIC X(53) VALUE
041100          "SSSSSSSSST362WWWWWWWWWX362ALTKEY1FFFFFFFFFF040ALTKEY2".
041200     05 FILLER PIC X(53) VALUE
041300          "SSSSSSSSTT364WWWWWWWWXX364ALTKEY1FFFFFFFFEE036ALTKEY2".
041400     05 FILLER PIC X(53) VALUE
041500          "SSSSSSSTTT366WWWWWWWXXX366ALTKEY1FFFFFFFEEE034ALTKEY2".
041600     05 FILLER PIC X(53) VALUE
041700          "SSSSSSTTTT368WWWWWWXXXX368ALTKEY1FFFFFFEEEE032ALTKEY2".
041800     05 FILLER PIC X(53) VALUE
041900          "SSSSSTTTTT370WWWWWXXXXX370ALTKEY1FFFFFEEEEE030ALTKEY2".
042000     05 FILLER PIC X(53) VALUE
042100          "SSSSTTTTTT372WWWWXXXXXX372ALTKEY1FFFFEEEEEE028ALTKEY2".
042200     05 FILLER PIC X(53) VALUE
042300          "SSSTTTTTTT374WWWXXXXXXX374ALTKEY1FFFEEEEEEE026ALTKEY2".
042400     05 FILLER PIC X(53) VALUE
042500          "SSTTTTTTTT376WWXXXXXXXX376ALTKEY1FFEEEEEEEE024ALTKEY2".
042600     05 FILLER PIC X(53) VALUE
042700          "STTTTTTTTT378WXXXXXXXXX378ALTKEY1FEEEEEEEEE022ALTKEY2".
042800     05 FILLER PIC X(53) VALUE
042900          "TTTTTTTTTT380XXXXXXXXXX380ALTKEY1EEEEEEEEEE020ALTKEY2".
043000     05 FILLER PIC X(53) VALUE
043100          "TTTTTTTTTU382XXXXXXXXXY382ALTKEY1EEEEEEEEEE020ALTKEY2".
043200     05 FILLER PIC X(53) VALUE
043300          "TTTTTTTTUU384XXXXXXXXYY384ALTKEY1EEEEEEEEDD016ALTKEY2".
043400     05 FILLER PIC X(53) VALUE
043500          "TTTTTTTUUU386XXXXXXXYYY386ALTKEY1EEEEEEEDDD014ALTKEY2".
043600     05 FILLER PIC X(53) VALUE
043700          "TTTTTTUUUU388XXXXXXYYYY388ALTKEY1EEEEEEDDDD012ALTKEY2".
043800     05 FILLER PIC X(53) VALUE
043900          "TTTTTUUUUU390XXXXXYYYYY390ALTKEY1EEEEEDDDDD010ALTKEY2".
044000     05 FILLER PIC X(53) VALUE
044100          "TTTTUUUUUU392XXXXYYYYYY392ALTKEY1EEEEDDDDDD008ALTKEY2".
044200     05 FILLER PIC X(53) VALUE
044300          "TTTUUUUUUU394XXXYYYYYYY394ALTKEY1EEEDDDDDDD006ALTKEY2".
044400     05 FILLER PIC X(53) VALUE
044500          "TTUUUUUUUU396XXYYYYYYYY396ALTKEY1EEDDDDDDDD004ALTKEY2".
044600     05 FILLER PIC X(53) VALUE
044700          "TUUUUUUUUU398XYYYYYYYYY398ALTKEY1EDDDDDDDDD002ALTKEY2".
044800     05 FILLER PIC X(53) VALUE
044900          "UUUUUUUUUU400YYYYYYYYYY400ALTKEY1DDDDDDDDDD000ALTKEY2".
045000 01  RECORD-KEY-DATA   REDEFINES  RECORD-KEY-CONTENT.
045100     05 KEY-VALUES                  OCCURS 75  TIMES.
045200       10 RECKEY-VALUE           PICTURE X(13).
045300       10 ALTKEY1-VALUE          PICTURE X(20).
045400       10 ALTKEY2-VALUE          PICTURE X(20).
045500 01  INIT-FLAG                   PICTURE 9.
045600 01  HOLD-FILESTATUS-RECORD.
045700     05 FILESTATUS               PICTURE XX  OCCURS 10 TIMES.
045800 01  FILE-RECORD-INFORMATION-REC.
045900     03 FILE-RECORD-INFO-SKELETON.
046000        05 FILLER                 PICTURE X(48)       VALUE
046100             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
046200        05 FILLER                 PICTURE X(46)       VALUE
046300             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
046400        05 FILLER                 PICTURE X(26)       VALUE
046500             ",LFIL=000000,ORG=  ,LBLR= ".
046600        05 FILLER                 PICTURE X(37)       VALUE
046700             ",RECKEY=                             ".
046800        05 FILLER                 PICTURE X(38)       VALUE
046900             ",ALTKEY1=                             ".
047000        05 FILLER                 PICTURE X(38)       VALUE
047100             ",ALTKEY2=                             ".
047200        05 FILLER                 PICTURE X(7)        VALUE SPACE.
047300     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
047400        05 FILE-RECORD-INFO-P1-120.
047500           07 FILLER              PIC X(5).
047600           07 XFILE-NAME           PIC X(6).
047700           07 FILLER              PIC X(8).
047800           07 XRECORD-NAME         PIC X(6).
047900           07 FILLER              PIC X(1).
048000           07 REELUNIT-NUMBER     PIC 9(1).
048100           07 FILLER              PIC X(7).
048200           07 XRECORD-NUMBER       PIC 9(6).
048300           07 FILLER              PIC X(6).
048400           07 UPDATE-NUMBER       PIC 9(2).
048500           07 FILLER              PIC X(5).
048600           07 ODO-NUMBER          PIC 9(4).
048700           07 FILLER              PIC X(5).
048800           07 XPROGRAM-NAME        PIC X(5).
048900           07 FILLER              PIC X(7).
049000           07 XRECORD-LENGTH       PIC 9(6).
049100           07 FILLER              PIC X(7).
049200           07 CHARS-OR-RECORDS    PIC X(2).
049300           07 FILLER              PIC X(1).
049400           07 XBLOCK-SIZE          PIC 9(4).
049500           07 FILLER              PIC X(6).
049600           07 RECORDS-IN-FILE     PIC 9(6).
049700           07 FILLER              PIC X(5).
049800           07 XFILE-ORGANIZATION   PIC X(2).
049900           07 FILLER              PIC X(6).
050000           07 XLABEL-TYPE          PIC X(1).
050100        05 FILE-RECORD-INFO-P121-240.
050200           07 FILLER              PIC X(8).
050300           07 XRECORD-KEY          PIC X(29).
050400           07 FILLER              PIC X(9).
050500           07 ALTERNATE-KEY1      PIC X(29).
050600           07 FILLER              PIC X(9).
050700           07 ALTERNATE-KEY2      PIC X(29).
050800           07 FILLER              PIC X(7).
050900 01  TEST-RESULTS.
051000     02 FILLER                   PIC X      VALUE SPACE.
051100     02 FEATURE                  PIC X(20)  VALUE SPACE.
051200     02 FILLER                   PIC X      VALUE SPACE.
051300     02 P-OR-F                   PIC X(5)   VALUE SPACE.
051400     02 FILLER                   PIC X      VALUE SPACE.
051500     02  PAR-NAME.
051600       03 FILLER                 PIC X(19)  VALUE SPACE.
051700       03  PARDOT-X              PIC X      VALUE SPACE.
051800       03 DOTVALUE               PIC 99     VALUE ZERO.
051900     02 FILLER                   PIC X(8)   VALUE SPACE.
052000     02 RE-MARK                  PIC X(61).
052100 01  TEST-COMPUTED.
052200     02 FILLER                   PIC X(30)  VALUE SPACE.
052300     02 FILLER                   PIC X(17)  VALUE
052400            "       COMPUTED=".
052500     02 COMPUTED-X.
052600     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
052700     03 COMPUTED-N               REDEFINES COMPUTED-A
052800                                 PIC -9(9).9(9).
052900     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
053000     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
053100     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
053200     03       CM-18V0 REDEFINES COMPUTED-A.
053300         04 COMPUTED-18V0                    PIC -9(18).
053400         04 FILLER                           PIC X.
053500     03 FILLER PIC X(50) VALUE SPACE.
053600 01  TEST-CORRECT.
053700     02 FILLER PIC X(30) VALUE SPACE.
053800     02 FILLER PIC X(17) VALUE "       CORRECT =".
053900     02 CORRECT-X.
054000     03 CORRECT-A                  PIC X(20) VALUE SPACE.
054100     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
054200     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
054300     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
054400     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
054500     03      CR-18V0 REDEFINES CORRECT-A.
054600         04 CORRECT-18V0                     PIC -9(18).
054700         04 FILLER                           PIC X.
054800     03 FILLER PIC X(2) VALUE SPACE.
054900     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
055000 01  CCVS-C-1.
055100     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
055200-    "SS  PARAGRAPH-NAME
055300-    "       REMARKS".
055400     02 FILLER                     PIC X(20)    VALUE SPACE.
055500 01  CCVS-C-2.
055600     02 FILLER                     PIC X        VALUE SPACE.
055700     02 FILLER                     PIC X(6)     VALUE "TESTED".
055800     02 FILLER                     PIC X(15)    VALUE SPACE.
055900     02 FILLER                     PIC X(4)     VALUE "FAIL".
056000     02 FILLER                     PIC X(94)    VALUE SPACE.
056100 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
056200 01  REC-CT                        PIC 99       VALUE ZERO.
056300 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
056400 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
056500 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
056600 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
056700 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
056800 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
056900 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
057000 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
057100 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
057200 01  CCVS-H-1.
057300     02  FILLER                    PIC X(39)    VALUE SPACES.
057400     02  FILLER                    PIC X(42)    VALUE
057500     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
057600     02  FILLER                    PIC X(39)    VALUE SPACES.
057700 01  CCVS-H-2A.
057800   02  FILLER                        PIC X(40)  VALUE SPACE.
057900   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
058000   02  FILLER                        PIC XXXX   VALUE
058100     "4.2 ".
058200   02  FILLER                        PIC X(28)  VALUE
058300            " COPY - NOT FOR DISTRIBUTION".
058400   02  FILLER                        PIC X(41)  VALUE SPACE.
058500
058600 01  CCVS-H-2B.
058700   02  FILLER                        PIC X(15)  VALUE
058800            "TEST RESULT OF ".
058900   02  TEST-ID                       PIC X(9).
059000   02  FILLER                        PIC X(4)   VALUE
059100            " IN ".
059200   02  FILLER                        PIC X(12)  VALUE
059300     " HIGH       ".
059400   02  FILLER                        PIC X(22)  VALUE
059500            " LEVEL VALIDATION FOR ".
059600   02  FILLER                        PIC X(58)  VALUE
059700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
059800 01  CCVS-H-3.
059900     02  FILLER                      PIC X(34)  VALUE
060000            " FOR OFFICIAL USE ONLY    ".
060100     02  FILLER                      PIC X(58)  VALUE
060200     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
060300     02  FILLER                      PIC X(28)  VALUE
060400            "  COPYRIGHT   1985 ".
060500 01  CCVS-E-1.
060600     02 FILLER                       PIC X(52)  VALUE SPACE.
060700     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
060800     02 ID-AGAIN                     PIC X(9).
060900     02 FILLER                       PIC X(45)  VALUE SPACES.
061000 01  CCVS-E-2.
061100     02  FILLER                      PIC X(31)  VALUE SPACE.
061200     02  FILLER                      PIC X(21)  VALUE SPACE.
061300     02 CCVS-E-2-2.
061400         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
061500         03 FILLER                   PIC X      VALUE SPACE.
061600         03 ENDER-DESC               PIC X(44)  VALUE
061700            "ERRORS ENCOUNTERED".
061800 01  CCVS-E-3.
061900     02  FILLER                      PIC X(22)  VALUE
062000            " FOR OFFICIAL USE ONLY".
062100     02  FILLER                      PIC X(12)  VALUE SPACE.
062200     02  FILLER                      PIC X(58)  VALUE
062300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
062400     02  FILLER                      PIC X(13)  VALUE SPACE.
062500     02 FILLER                       PIC X(15)  VALUE
062600             " COPYRIGHT 1985".
062700 01  CCVS-E-4.
062800     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
062900     02 FILLER                       PIC X(4)   VALUE " OF ".
063000     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
063100     02 FILLER                       PIC X(40)  VALUE
063200      "  TESTS WERE EXECUTED SUCCESSFULLY".
063300 01  XXINFO.
063400     02 FILLER                       PIC X(19)  VALUE
063500            "*** INFORMATION ***".
063600     02 INFO-TEXT.
063700       04 FILLER                     PIC X(8)   VALUE SPACE.
063800       04 XXCOMPUTED                 PIC X(20).
063900       04 FILLER                     PIC X(5)   VALUE SPACE.
064000       04 XXCORRECT                  PIC X(20).
064100     02 INF-ANSI-REFERENCE           PIC X(48).
064200 01  HYPHEN-LINE.
064300     02 FILLER  PIC IS X VALUE IS SPACE.
064400     02 FILLER  PIC IS X(65)    VALUE IS "************************
064500-    "*****************************************".
064600     02 FILLER  PIC IS X(54)    VALUE IS "************************
064700-    "******************************".
064800 01  CCVS-PGM-ID                     PIC X(9)   VALUE
064900     "IX210A".
065000 PROCEDURE DIVISION.
065100 CCVS1 SECTION.
065200 OPEN-FILES.
065300P    OPEN I-O RAW-DATA.
065400P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
065500P    READ RAW-DATA INVALID KEY GO TO END-E-1.
065600P    MOVE "ABORTED " TO C-ABORT.
065700P    ADD 1 TO C-NO-OF-TESTS.
065800P    ACCEPT C-DATE  FROM DATE.
065900P    ACCEPT C-TIME  FROM TIME.
066000P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
066100PEND-E-1.
066200P    CLOSE RAW-DATA.
066300     OPEN    OUTPUT PRINT-FILE.
066400     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
066500     MOVE    SPACE TO TEST-RESULTS.
066600     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
066700     MOVE    ZERO TO REC-SKL-SUB.
066800     PERFORM CCVS-INIT-FILE 9 TIMES.
066900 CCVS-INIT-FILE.
067000     ADD     1 TO REC-SKL-SUB.
067100     MOVE    FILE-RECORD-INFO-SKELETON
067200          TO FILE-RECORD-INFO (REC-SKL-SUB).
067300 CCVS-INIT-EXIT.
067400     GO TO CCVS1-EXIT.
067500 CLOSE-FILES.
067600P    OPEN I-O RAW-DATA.
067700P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
067800P    READ RAW-DATA INVALID KEY GO TO END-E-2.
067900P    MOVE "OK.     " TO C-ABORT.
068000P    MOVE PASS-COUNTER TO C-OK.
068100P    MOVE ERROR-HOLD   TO C-ALL.
068200P    MOVE ERROR-COUNTER TO C-FAIL.
068300P    MOVE DELETE-COUNTER TO C-DELETED.
068400P    MOVE INSPECT-COUNTER TO C-INSPECT.
068500P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
068600PEND-E-2.
068700P    CLOSE RAW-DATA.
068800     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
068900 TERMINATE-CCVS.
069000S    EXIT PROGRAM.
069100STERMINATE-CALL.
069200     STOP     RUN.
069300 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
069400 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
069500 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
069600 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
069700     MOVE "****TEST DELETED****" TO RE-MARK.
069800 PRINT-DETAIL.
069900     IF REC-CT NOT EQUAL TO ZERO
070000             MOVE "." TO PARDOT-X
070100             MOVE REC-CT TO DOTVALUE.
070200     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
070300     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
070400        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
070500          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
070600     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
070700     MOVE SPACE TO CORRECT-X.
070800     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
070900     MOVE     SPACE TO RE-MARK.
071000 HEAD-ROUTINE.
071100     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
071200     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
071300     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
071400     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
071500 COLUMN-NAMES-ROUTINE.
071600     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
071700     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
071800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
071900 END-ROUTINE.
072000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
072100 END-RTN-EXIT.
072200     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
072300 END-ROUTINE-1.
072400      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
072500      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
072600      ADD PASS-COUNTER TO ERROR-HOLD.
072700*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
072800      MOVE PASS-COUNTER TO CCVS-E-4-1.
072900      MOVE ERROR-HOLD TO CCVS-E-4-2.
073000      MOVE CCVS-E-4 TO CCVS-E-2-2.
073100      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
073200  END-ROUTINE-12.
073300      MOVE "TEST(S) FAILED" TO ENDER-DESC.
073400     IF       ERROR-COUNTER IS EQUAL TO ZERO
073500         MOVE "NO " TO ERROR-TOTAL
073600         ELSE
073700         MOVE ERROR-COUNTER TO ERROR-TOTAL.
073800     MOVE     CCVS-E-2 TO DUMMY-RECORD.
073900     PERFORM WRITE-LINE.
074000 END-ROUTINE-13.
074100     IF DELETE-COUNTER IS EQUAL TO ZERO
074200         MOVE "NO " TO ERROR-TOTAL  ELSE
074300         MOVE DELETE-COUNTER TO ERROR-TOTAL.
074400     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
074500     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
074600      IF   INSPECT-COUNTER EQUAL TO ZERO
074700          MOVE "NO " TO ERROR-TOTAL
074800      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
074900      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
075000      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
075100     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
075200 WRITE-LINE.
075300     ADD 1 TO RECORD-COUNT.
075400Y    IF RECORD-COUNT GREATER 42
075500Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
075600Y        MOVE SPACE TO DUMMY-RECORD
075700Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
075800Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
075900Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
076000Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
076100Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
076200Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
076300Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
076400Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
076500Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
076600Y        MOVE ZERO TO RECORD-COUNT.
076700     PERFORM WRT-LN.
076800 WRT-LN.
076900     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
077000     MOVE SPACE TO DUMMY-RECORD.
077100 BLANK-LINE-PRINT.
077200     PERFORM WRT-LN.
077300 FAIL-ROUTINE.
077400     IF     COMPUTED-X NOT EQUAL TO SPACE
077500            GO TO   FAIL-ROUTINE-WRITE.
077600     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
077700     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
077800     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
077900     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
078000     MOVE   SPACES TO INF-ANSI-REFERENCE.
078100     GO TO  FAIL-ROUTINE-EX.
078200 FAIL-ROUTINE-WRITE.
078300     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
078400     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
078500     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
078600     MOVE   SPACES TO COR-ANSI-REFERENCE.
078700 FAIL-ROUTINE-EX. EXIT.
078800 BAIL-OUT.
078900     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
079000     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
079100 BAIL-OUT-WRITE.
079200     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
079300     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
079400     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
079500     MOVE   SPACES TO INF-ANSI-REFERENCE.
079600 BAIL-OUT-EX. EXIT.
079700 CCVS1-EXIT.
079800     EXIT.
079900 SECT-0001-IX210A SECTION.
080000 WRITE-INT-GF.
080100     OPEN    OUTPUT IX-FS1.
080200     MOVE    "IX-FS1" TO XFILE-NAME           (1).
080300     MOVE    "R1-F-G" TO  XRECORD-NAME        (1).
080400     MOVE    ZERO     TO  XRECORD-NUMBER      (1).
080500     MOVE    "RC"     TO  CHARS-OR-RECORDS    (1).
080600     MOVE    CCVS-PGM-ID TO  XPROGRAM-NAME       (1).
080700     MOVE    240      TO  XRECORD-LENGTH      (1).
080800     MOVE    001      TO  XBLOCK-SIZE         (1).
080900     MOVE    "IX"     TO  XFILE-ORGANIZATION  (1).
081000     MOVE    "S"      TO  XLABEL-TYPE         (1).
081100     MOVE    200      TO  RECORDS-IN-FILE     (1).
081200     MOVE    "CREATE-FILE-FS1" TO FEATURE.
081300     MOVE    "WRITE-TEST-GF-1"  TO PAR-NAME.
081400     MOVE    ZERO TO KEYSUB.
081500     MOVE    ZERO TO INVKEY-COUNTER.
081600 WRITE-INIT-GF-01.
081700     PERFORM WRITE-TEST-GF-01  50 TIMES.
081800     PERFORM WRITE-TEST-GF-02  125 TIMES.
081900     PERFORM WRITE-TEST-GF-01  25 TIMES.
082000     GO TO   WRITE-TEST-GF-1.
082100 WRITE-TEST-GF-01.
082200     ADD     001  TO XRECORD-NUMBER (1).
082300     ADD     001  TO  KEYSUB.
082400     MOVE    RECKEY-VALUE (KEYSUB) TO FS1-RECKEY-1-13.
082500     MOVE    ALTKEY1-VALUE (KEYSUB) TO FS1-ALTKEY1-1-20.
082600     MOVE    ALTKEY2-VALUE (KEYSUB) TO FS1-ALTKEY2-1-20.
082700     MOVE    WRK-FS1-RECKEY   TO    XRECORD-KEY (1).
082800     MOVE    WRK-FS1-ALTKEY1  TO ALTERNATE-KEY1 (1).
082900     MOVE    WRK-FS1-ALTKEY2  TO ALTERNATE-KEY2 (1).
083000     MOVE    FILE-RECORD-INFO (1)  TO IX-FS1R1-F-G-240.
083100     WRITE   IX-FS1R1-F-G-240
083200                        INVALID KEY ADD 001 TO INVKEY-COUNTER.
083300     ADD     001 TO  EXCUT-COUNTER-06V00.
083400 WRITE-TEST-GF-02.
083500     ADD     002  TO FS1-RECKEY-11-13.
083600     ADD     002 TO FS1-ALTKEY1-11-13.
083700     SUBTRACT  002 FROM FS1-ALTKEY2-11-13.
083800     ADD     001  TO XRECORD-NUMBER (1).
083900     MOVE    WRK-FS1-RECKEY   TO    XRECORD-KEY (1).
084000     MOVE    WRK-FS1-ALTKEY1  TO ALTERNATE-KEY1 (1).
084100     MOVE    WRK-FS1-ALTKEY2  TO ALTERNATE-KEY2 (1).
084200     MOVE    FILE-RECORD-INFO (1) TO IX-FS1R1-F-G-240.
084300     WRITE   IX-FS1R1-F-G-240
084400                        INVALID KEY ADD 001 TO INVKEY-COUNTER.
084500     ADD     001 TO EXCUT-COUNTER-06V00.
084600 WRITE-TEST-GF-1.
084700     SUBTRACT INVKEY-COUNTER FROM EXCUT-COUNTER-06V00
084800             GIVING RECORDS-WRITTEN.
084900     MOVE    200  TO CORRECT-18V0.
085000     MOVE    RECORDS-WRITTEN TO COMPUTED-18V0.
085100     IF      RECORDS-WRITTEN EQUAL TO 200
085200             PERFORM  PASS
085300             ELSE
085400             PERFORM FAIL.
085500     MOVE    "RECORDS IN FILE" TO RE-MARK.
085600     GO TO   WRITE-TEST-GF-END.
085700 WRITE-DELETE-GF-1.
085800     PERFORM DE-LETE.
085900 WRITE-TEST-GF-END.
086000     PERFORM  PRINT-DETAIL.
086100     CLOSE   IX-FS1.
086200 READ-INIT-F1.
086300     OPEN    INPUT  IX-FS1.
086400     MOVE    "READ FILE IX-FS1" TO FEATURE.
086500     MOVE    ZERO TO EXCUT-COUNTER-06V00.
086600     MOVE    02   TO RECKEY-NUM.
086700     MOVE    002 TO ALTKEY1-NUM.
086800 READ-TEST-F1-R1.
086900     READ    IX-FS1  AT END  GO TO READ-TEST-F1.
087000     MOVE    IX-REC-KEY-AREA TO WRK-FS1-RECKEY.
087100     MOVE    IX-ALT-KEY1-AREA TO WRK-FS1-ALTKEY1.
087200     IF      FS1-RECKEY-11-13 EQUAL TO RECKEY-NUM
087300             AND FS1-ALTKEY1-11-13 EQUAL TO ALTKEY1-NUM
087400             NEXT SENTENCE
087500             ELSE
087600             PERFORM  READ-FAIL-F1.
087700     IF      EXCUT-COUNTER-06V00 GREATER THAN 200
087800             GO TO READ-TEST-F1.
087900     ADD     001  TO EXCUT-COUNTER-06V00.
088000     ADD     002  TO RECKEY-NUM
088100     ADD     002  TO ALTKEY1-NUM.
088200     GO TO   READ-TEST-F1-R1.
088300 READ-TEST-F1.
088400     IF      EXCUT-COUNTER-06V00 EQUAL TO 200
088500             PERFORM PASS ELSE
088600             PERFORM FAIL.
088700     MOVE    EXCUT-COUNTER-06V00 TO  COMPUTED-18V0.
088800     MOVE    200  TO  CORRECT-18V0.
088900     MOVE    "RECORDS IN FILE" TO RE-MARK.
089000     GO TO   READ-EXIT-F1.
089100 READ-FAIL-F1.
089200     PERFORM FAIL.
089300     MOVE    FS1-RECKEY-11-13  TO COMPUTED-18V0.
089400     MOVE    RECKEY-NUM  TO CORRECT-18V0.
089500     MOVE "NUM EMBEDDED IN RECKEY; IX-41 & IX-28"  TO RE-MARK.
089600 READ-EXIT-F1.
089700     PERFORM PRINT-DETAIL.
089800     CLOSE   IX-FS1.
089900 START-INIT.
090000     OPEN    INPUT  IX-FS1.
090100     MOVE    "START GT RECKEY " TO FEATURE.
090200     MOVE    "START-TEST-GF-01" TO PAR-NAME.
090300     MOVE    SPACE TO HOLD-FILESTATUS-RECORD.
090400*
090500* THE "START -- GREATER THAN--" IS CHECKED FOR PROPER POSITIONING
090600* OF THE RECORD POINTER FOR THE SUBSEQUENT READ STATEMENT.
090700* START-TEST-GF  USE ONLY THE PRIME RECORD KEY FOR ESTABLISHING
090800* THE CURRENT RECORD POINTER FOR THE FILE.  THE FOLLOWING IS A
090900* SUMMARY OF THE TEST CONDITIONS AND THE EXPECTED ACTION TO BE
091000* TAKEN FOR THE  TESTS.
091100*
091200*                      CONDITIONS (CONTENTS OF KEY) / ACTION
091300*
091400*   START-TEST-GF-01 - EQUAL A RECORD IN FILE / RECORD FOUND
091500*   START-TEST-GF-02 - BETWEEN 2 KEY VALUES / RECORD FOUND
091600*   START-TEST-GF-03 - LESS THAN FIRST FILE REC. / REC. FOUND
091700*   START-TEST-GF-04 - GREATER THAN LAST FILE RECORD / INVALID KEY
091800*   START-TEST-GF-05 - UNEQUAL SIZE OPERANDS (EQUAL) / RECORD FOUN
091900*   START-TEST-GF-06 - UNEQUAL SIZE OPERANDS (EQUAL) / RECORD FOUN
092000*   START-TEST-GF-07 - UNEQUAL SIZE OPERANDS (UNEQUAL) / INVLD KEY
092100*   START-TEST-GF-08 - UNEQUAL SIZE OPERANDS (UNEQUAL) / REC FOUND
092200*   START-TEST-GF-09 - UNEQUAL SIZE OPERANDS (UNEQUAL) /INVLD KEY
092300*
092400*  BEFORE EACH TEST A RECORD IS MADE AVAILABLE WHICH IS DIFFERENT
092500*  THAN THE ONE WHICH IS EXPECTED TO BE PRESENT FOLLOWING A TEST.
092600*  IF AN INVALID KEY IS EXPECTED FROM THE TEST, THE KEYS
092700*  ASSOCIATED WITH THE FILE WHICH ARE NOT PARTICIPATING IN THE
092800*  START STATEMENT WILL BE LOADED WITH VALUES WHICH WOULD
092900*  MATCH RECORDS IN THE FILE.  IF KEY MATCH IS EXPECTED FROM
093000*  THE TEST, THE KEYS ASSOCIATED WITH THE FILE WHICH ARE NOT
093100*  PARTICIPATING IN THE START STATEMENT WILL BE LOADED WITH
093200*  VALUES WHICH WOULD NOT MATCH RECORDS IN THE FILE.  THE FILE
093300*  STATUS FROM EXECUTION OF EACH START IS CAPTURED FOR LATER TESTS
093400*
093500 START-INIT-GF-01.
093600     MOVE    "START-TEST-GF-01" TO PAR-NAME.
093700     PERFORM START-INITIALIZE-RECORD.
093800     IF      INIT-FLAG NOT EQUAL TO ZERO
093900             MOVE   "**"  TO FILESTATUS (1)
094000             MOVE   "TEST IMPROPERLY INITIALIZED" TO RE-MARK
094100             GO TO START-DELETE-GF-01.
094200     MOVE    "CCCCCCCCCD022" TO FS1-RECKEY-1-13.
094300     MOVE    "EEEEEFFFFF022ALTKEY1"  TO FS1-ALTKEY1-1-20.
094400     MOVE    "EEEEEFFFFF022ALTKEY2" TO FS1-ALTKEY2-1-20.
094500     MOVE    WRK-FS1-RECKEY TO IX-REC-KEY-AREA.
094600     MOVE    WRK-FS1-ALTKEY1 TO IX-ALT-KEY1-AREA.
094700     MOVE    WRK-FS1-ALTKEY2 TO IX-ALT-KEY2-AREA.
094800 START-TEST-GF-01.
094900*
095000*  START-TEST-GF-01  - THE START SHOULD FIND A RECORD IN THE FILE
095100*                    WHICH HAS A RECORD KEY VALUE OF
095200*                    CCCCCCCCDD024  (RECORD NUMBER 12).
095300*
095400     START   IX-FS1
095500                    KEY IS GREATER THAN IX-FS1-KEY
095600          INVALID KEY   MOVE FS1-STATUS TO FILESTATUS (1)
095700                     MOVE  "INVALID KEY ON START" TO COMPUTED-A
095800                        GO TO START-FAIL-GF-01.
095900     MOVE    FS1-STATUS TO FILESTATUS (1).
096000     READ    IX-FS1  AT END
096100                     MOVE  "AT END ON READ" TO COMPUTED-A
096200                     GO TO START-FAIL-GF-01.
096300     MOVE    IX-FS1R1-F-G-240  TO  FILE-RECORD-INFO (1).
096400     IF      XRECORD-NUMBER (1)  EQUAL TO 12
096500             PERFORM PASS
096600             MOVE SPACE TO RE-MARK
096700             GO TO START-EXIT-GF-01.
096800     MOVE    12  TO RECNO.
096900     PERFORM DISPLAY-RECORD-KEYS.
097000     MOVE     XRECORD-NUMBER (1)  TO COMPUTED-18V0.
097100 START-FAIL-GF-01.
097200     PERFORM FAIL.
097300     MOVE    12  TO CORRECT-18V0.
097400     MOVE "RECORD NUMBER; IX-36 ETC " TO RE-MARK.
097500     GO TO   START-EXIT-GF-01.
097600 START-DELETE-GF-01.
097700     PERFORM DE-LETE.
097800 START-EXIT-GF-01.
097900     PERFORM PRINT-DETAIL.
098000 START-INIT-GF-02.
098100     MOVE    "START GT RECKEY " TO FEATURE.
098200     MOVE    "START-TEST-GF-02" TO PAR-NAME.
098300     PERFORM START-INITIALIZE-RECORD.
098400     IF      INIT-FLAG NOT EQUAL TO ZERO
098500             MOVE   "**"  TO FILESTATUS (2)
098600             MOVE   "TEST IMPROPERLY INITIALIZED" TO RE-MARK
098700             GO TO START-DELETE-GF-02.
098800     MOVE    "EEEEEEEFFF067" TO FS1-RECKEY-1-13.
098900     MOVE    "HHHHHHHHII064ALTKEY1"  TO FS1-ALTKEY1-1-20.
099000     MOVE    "TTTTTTTTSS336ALTKEY2" TO FS1-ALTKEY2-1-20.
099100     MOVE    WRK-FS1-RECKEY TO IX-REC-KEY-AREA.
099200     MOVE    WRK-FS1-ALTKEY1 TO IX-ALT-KEY1-AREA.
099300     MOVE    WRK-FS1-ALTKEY2 TO IX-ALT-KEY2-AREA.
099400 START-TEST-GF-02.
099500*
099600*  START-TEST-GF-02 - THE START SHOULD FIND A RECORD IN THE FILE
099700*                    WHICH HAS A RECORD KEY VALUE OF EEEEEEFFFF068
099800*                    (RECORD NUMBER 34).  THIS KEY VALUE IS
099900*                    SEQUENTIALLY A LOGICAL RECORD HIGHER THAN
100000*                    THE RECORD CONTAINING THE KEY VALUE  LOADED
100100*                    INTO THE RECORD KEY BEFORE THE START WAS
100200*                    EXECUTED.  THE KEY VALUE INITIALLY LOADED
100300*                    WAS A VALUE BETWEEN TWO EXISTING KEY VALUES.
100400*
100500     START   IX-FS1
100600        KEY GREATER THAN OR EQUAL TO IX-FS1-KEY
100700          INVALID KEY   MOVE FS1-STATUS TO FILESTATUS (2)
100800                     MOVE  "INVALID KEY ON START" TO COMPUTED-A
100900                        GO TO START-FAIL-GF-02.
101000     MOVE    FS1-STATUS TO FILESTATUS (2).
101100     READ    IX-FS1  AT END
101200                     MOVE  "AT END ON READ" TO COMPUTED-A
101300                     GO TO START-FAIL-GF-02.
101400     MOVE    IX-FS1R1-F-G-240  TO  FILE-RECORD-INFO (1).
101500     IF      XRECORD-NUMBER (1) EQUAL TO 34
101600             PERFORM PASS
101700             MOVE SPACE TO RE-MARK
101800             GO TO START-EXIT-GF-02.
101900     MOVE    34  TO RECNO.
102000     PERFORM DISPLAY-RECORD-KEYS.
102100     MOVE     XRECORD-NUMBER (1)  TO COMPUTED-18V0.
102200 START-FAIL-GF-02.
102300     PERFORM FAIL.
102400     MOVE    34   TO CORRECT-18V0.
102500     MOVE "RECORD NUMBER; IX-36 ETC " TO RE-MARK.
102600     GO TO   START-EXIT-GF-02.
102700 START-DELETE-GF-02.
102800     PERFORM DE-LETE.
102900 START-EXIT-GF-02.
103000     PERFORM PRINT-DETAIL.
103100 START-INIT-GF-03.
103200     PERFORM START-INITIALIZE-RECORD.
103300     MOVE    "START GT RECKEY " TO FEATURE.
103400     MOVE    "START-TEST-GF-03" TO PAR-NAME.
103500     IF      INIT-FLAG NOT EQUAL TO ZERO
103600             MOVE   "**"  TO FILESTATUS (3)
103700             MOVE   "TEST IMPROPERLY INITIALIZED" TO RE-MARK
103800             GO TO START-DELETE-GF-03.
103900     MOVE    "BBBBBBBBBC001" TO FS1-RECKEY-1-13.
104000     MOVE    "EEEEEEEEEF003ALTKEY1"  TO FS1-ALTKEY1-1-20.
104100     MOVE    "WWWWWWWWWV399ALTKEY2" TO FS1-ALTKEY2-1-20.
104200     MOVE    WRK-FS1-RECKEY TO IX-REC-KEY-AREA.
104300     MOVE    WRK-FS1-ALTKEY1 TO IX-ALT-KEY1-AREA.
104400     MOVE    WRK-FS1-ALTKEY2 TO IX-ALT-KEY2-AREA.
104500 START-TEST-GF-03.
104600*
104700*  START-TEST-GF-03  - THE START STATEMENT SHOULD FIND A
104800*                    RECORD IN THE FILE WHICH HAS A RECORD KEY
104900*                    VALUE OF "BBBBBBBBBC002" (RECORD NUMBER 1).
105000*                    THE KEY WAS LOADED BEFORE THE START IS
105100*                    EXECUTED WITH THE VALUE THAT IS SEQUENTIALLY
105200*                    LOWER THAN ANY CURRENTLY EXISTING KEY IN
105300*                    THE FILE.
105400*
105500     START   IX-FS1
105600                    KEY IS GREATER THAN IX-FS1-KEY
105700          INVALID KEY   MOVE FS1-STATUS TO FILESTATUS (3)
105800                     MOVE  "INVALID KEY ON START" TO COMPUTED-A
105900                        GO TO START-FAIL-GF-03
106000            END-START.
106100     MOVE    FS1-STATUS TO FILESTATUS (3).
106200     READ    IX-FS1  AT END
106300                     MOVE  "AT END ON READ" TO COMPUTED-A
106400                     GO TO START-FAIL-GF-03.
106500     MOVE    IX-FS1R1-F-G-240  TO  FILE-RECORD-INFO (1).
106600     IF      XRECORD-NUMBER (1) EQUAL TO 01
106700             PERFORM PASS
106800             MOVE SPACE TO RE-MARK
106900             GO TO START-EXIT-GF-03.
107000     MOVE    01  TO RECNO.
107100     PERFORM DISPLAY-RECORD-KEYS.
107200     MOVE     XRECORD-NUMBER (1)  TO COMPUTED-18V0.
107300 START-FAIL-GF-03.
107400     PERFORM FAIL.
107500     MOVE    01   TO CORRECT-18V0.
107600     MOVE "RECORD NUMBER; IX-36 ETC " TO RE-MARK.
107700     GO TO   START-EXIT-GF-03.
107800 START-DELETE-GF-03.
107900     PERFORM DE-LETE.
108000 START-EXIT-GF-03.
108100     PERFORM PRINT-DETAIL.
108200 START-INIT-GF-04.
108300     PERFORM START-INITIALIZE-RECORD.
108400     MOVE    "START GT RECKEY " TO FEATURE.
108500     MOVE    "START-TEST-GF-04" TO PAR-NAME.
108600     IF      INIT-FLAG NOT EQUAL TO ZERO
108700             MOVE    "TEST IMPROPERLY INITIALIZED"  TO RE-MARK
108800             MOVE   "**"  TO FILESTATUS (4)
108900             GO TO   START-DELETE-GF-04.
109000     MOVE    "UUUUUUUUUU401"  TO FS1-RECKEY-1-13.
109100     MOVE    "YYYYYYYYYY400ALTKEY1"  TO FS1-ALTKEY1-1-20.
109200     MOVE    "DDDDDDDDDD000ALTKEY2"  TO FS1-ALTKEY2-1-20.
109300     MOVE    WRK-FS1-RECKEY   TO IX-REC-KEY-AREA.
109400     MOVE    WRK-FS1-ALTKEY1  TO IX-ALT-KEY1-AREA.
109500     MOVE    WRK-FS1-ALTKEY2  TO IX-ALT-KEY2-AREA.
109600 START-TEST-GF-04.
109700*
109800*  START-TEST-GF-04 -  THE START STATEMENT SHOULD NOT FIND A
109900*                    RECORD IN THE  FILE WHICH HAS A RECORD
110000*                    KEY VALUE GREATER THAN "UUUUUUUUUU401". THIS
110100*                    VALUE IS SEQUENTIALLY GREATER THAN
110200*                    ANY RECORD KEY CURRENTLY EXISTING IN
110300*                    THE FILE.  AN INVALID KEY CONDITION
110400*                    IS EXPECTED WHEN THE START IS EXECUTED.
110500*
110600     START   IX-FS1
110700                    KEY IS GREATER THAN IX-FS1-KEY
110800          INVALID KEY    MOVE  FS1-STATUS TO FILESTATUS (4)
110900                         GO TO START-PASS-GF-04.
111000     MOVE    FS1-STATUS TO FILESTATUS (4).
111100     READ    IX-FS1 AT END
111200                     MOVE  "AT END PATH TAKEN ON READ" TO RE-MARK.
111300     MOVE    IX-FS1R1-F-G-240 TO FILE-RECORD-INFO (1).
111400     PERFORM FAIL.
111500     MOVE    XRECORD-KEY (1) TO COMPUTED-A.
111600     MOVE    "INVALID KEY" TO CORRECT-A.
111700     MOVE "RECORD NUMBER; IX-36 ETC " TO RE-MARK.
111800     GO TO   START-EXIT-GF-04.
111900 START-PASS-GF-04.
112000     PERFORM  PASS.
112100     MOVE     "INVALID KEY OK."  TO RE-MARK.
112200     GO TO   START-EXIT-GF-04.
112300 START-DELETE-GF-04.
112400     PERFORM DE-LETE.
112500 START-EXIT-GF-04.
112600     PERFORM PRINT-DETAIL.
112700 START-INIT-GF-05.
112800     PERFORM START-INITIALIZE-RECORD.
112900     MOVE    "START GT RECKEY " TO FEATURE.
113000     MOVE    "START-TEST-GF-05" TO PAR-NAME.
113100     IF      INIT-FLAG NOT EQUAL TO ZERO
113200             MOVE    "TEST IMPROPERLY INITIALIZED"  TO RE-MARK
113300             MOVE   "**"  TO FILESTATUS (5)
113400             GO TO   START-DELETE-GF-05.
113500     MOVE    "CDDDDDDDDD039" TO FS1-RECKEY-1-13.
113600     MOVE    "IIIIIIIIJJ083ALTKEY1"  TO FS1-ALTKEY1-1-20.
113700     MOVE    "ABCXXXXXXX400ALTKEY2" TO FS1-ALTKEY2-1-20.
113800     MOVE    WRK-FS1-RECKEY   TO IX-REC-KEY-AREA.
113900     MOVE    WRK-FS1-ALTKEY1  TO IX-ALT-KEY1-AREA.
114000     MOVE    WRK-FS1-ALTKEY2  TO IX-ALT-KEY2-AREA.
114100 START-TEST-GF-05.
114200*  START-TEST-GF-05 -  THE START STATEMENT USES AN OPERAND
114300*                    IN THE KEY PHRASE WHICH IS NOT THE NAME
114400*                    OF A RECORD   KEY BUT IS THE NAME OF A
114500*                    DATA ITEM WHICH IS SUBORDINATE TO THE
114600*                    RECORD KEY.  THE CONTENTS OF THE DATA ITEM
114700*                    (POSITIONS 1 THRU 7 OF THE RECORD KEY)
114800*                    IS A UNIQUE KEY VALUE FOR THE FILE. THE
114900*                    BALANCE OF THE KEY (POSITIONS 8 THRU 13) IS
115000*                    NOT A VALID KEY VALUE FOR THE FILE.  THE
115100*                    RECORD WITH THE RECORD KEY "DDDDDDDDDD040"
115200*                    (RECORD NUMBER 20) IS EXPECTED TO BE FOUND.
115300*
115400     START   IX-FS1
115500                    KEY IS GREATER THAN R-RECKEY-1-7
115600          INVALID KEY    MOVE  FS1-STATUS TO FILESTATUS (5)
115700                     MOVE  "INVALID KEY ON START" TO COMPUTED-A
115800                     GO TO START-FAIL-GF-05.
115900     MOVE    FS1-STATUS TO FILESTATUS (5).
116000     READ    IX-FS1  AT END
116100                     MOVE  "AT END ON READ" TO COMPUTED-A
116200                     GO TO  START-FAIL-GF-05.
116300     MOVE    IX-FS1R1-F-G-240 TO FILE-RECORD-INFO (1).
116400     IF      XRECORD-NUMBER (1) EQUAL TO 20
116500             PERFORM  PASS
116600             MOVE  "SUBORDINATE DATA ITEM OF KEY" TO RE-MARK
116700             GO TO START-EXIT-GF-05.
116800     MOVE    20  TO RECNO.
116900     PERFORM DISPLAY-RECORD-KEYS.
117000     MOVE    XRECORD-NUMBER (1)  TO COMPUTED-18V0.
117100 START-FAIL-GF-05.
117200     PERFORM  FAIL.
117300     MOVE    20  TO CORRECT-18V0.
117400     MOVE "RECORD NUMBER; IX-36 ETC " TO RE-MARK.
117500     GO TO   START-EXIT-GF-05.
117600 START-DELETE-GF-05.
117700     PERFORM DE-LETE.
117800 START-EXIT-GF-05.
117900     PERFORM PRINT-DETAIL.
118000 START-INIT-GF-06.
118100     PERFORM START-INITIALIZE-RECORD.
118200     MOVE "START GT RECKEY " TO FEATURE.
118300     MOVE "START-TEST-GF-06" TO PAR-NAME.
118400     IF      INIT-FLAG NOT EQUAL TO ZERO
118500             MOVE    "TEST IMPROPERLY INITIALIZED"  TO RE-MARK
118600             MOVE   "**"  TO FILESTATUS (6)
118700             GO TO   START-DELETE-GF-06.
118800     MOVE    "TTTTTTTTTT380"  TO FS1-RECKEY-1-13.
118900     MOVE    "XYYYYYYYYY399ALTKEY1"  TO FS1-ALTKEY1-1-20.
119000     MOVE    "WWWWWWWWWV399ALTKEY2"  TO FS1-ALTKEY2-1-20.
119100     MOVE    WRK-FS1-RECKEY   TO IX-REC-KEY-AREA.
119200     MOVE    WRK-FS1-ALTKEY1  TO IX-ALT-KEY1-AREA.
119300     MOVE    WRK-FS1-ALTKEY2  TO IX-ALT-KEY2-AREA.
119400 START-TEST-GF-06.
119500*
119600*  START-TEST-GF-06 -  THE START STATEMENT USES AN OPERAND IN THE
119700*                    KEY PHRASE WHICH IS NOT THE NAME OF A RECORD
119800*                    KEY BUT IS THE NAME OF A DATA ITEM THAT IS
119900*                    SUBORDINATE TO THE RECORD KEY.  THE CONTENTS
120000*                    OF THE DATA ITEM (POSITIONS 1 THRU 5 OF THE
120100*                    RECORD KEY)  IS A DUPLICATE OF THE FIRST
120200*                    5 POSITIONS OF 5 OTHER RECORDS IN THE FILE.
120300*                    THIS TEST EXPECTS THE RECORD POINTER
120400*                    TO BE POSITIONED TO RECORD KEY TTTTUUUUUU392
120500*                    (RECORD NUMBER 196) WHICH WAS THE RECORD
120600*                    WRITTEN TO THE FILE AFTER THE LAST RECORD
120700*                    THAT CONTAINS TTTTT IN THE FIRST 5 POSITIONS
120800*                    OF THE KEY.  THE RECORD KEY WAS LOADED WITH
120900*                    THE VALUE "TTTTTTTTTT380" (KEY FOR RECORD
121000*                    NUMBER 190) BEFORE THE START WAS EXECUTED.
121100*
121200     START   IX-FS1
121300                    KEY IS GREATER THAN IX-FS1-KEY-1-5
121400          INVALID KEY    MOVE  FS1-STATUS TO FILESTATUS (6)
121500                     MOVE  "INVALID KEY ON START"  TO COMPUTED-A
121600                     GO TO START-FAIL-GF-06.
121700     MOVE    FS1-STATUS TO FILESTATUS (6).
121800     READ    IX-FS1  AT END
121900                     MOVE "AT END ON READ" TO COMPUTED-A
122000                     GO TO START-FAIL-GF-06.
122100     MOVE    IX-FS1R1-F-G-240 TO FILE-RECORD-INFO (1).
122200     IF      XRECORD-NUMBER (1) EQUAL TO 196
122300             PERFORM  PASS
122400             MOVE  "SUBORDINATE DATA ITEM IN KEY"  TO RE-MARK
122500             GO TO START-EXIT-GF-06.
122600     MOVE    71  TO RECNO.
122700     PERFORM DISPLAY-RECORD-KEYS.
122800     MOVE    XRECORD-NUMBER (1)  TO COMPUTED-18V0.
122900 START-FAIL-GF-06.
123000     PERFORM  FAIL.
123100     MOVE    196  TO CORRECT-18V0.
123200     MOVE "RECORD NUMBER; IX-36 ETC " TO RE-MARK.
123300     GO TO   START-EXIT-GF-06.
123400 START-DELETE-GF-06.
123500     PERFORM DE-LETE.
123600 START-EXIT-GF-06.
123700     PERFORM PRINT-DETAIL.
123800 START-INIT-GF-07.
123900     PERFORM START-INITIALIZE-RECORD.
124000     MOVE "START GT RECKEY " TO FEATURE.
124100     MOVE "START-TEST-GF-07" TO PAR-NAME.
124200     IF      INIT-FLAG NOT EQUAL TO ZERO
124300             MOVE    "TEST IMPROPERLY INITIALIZED"  TO RE-MARK
124400             MOVE   "**"  TO FILESTATUS (7)
124500             GO TO   START-DELETE-GF-07.
124600     MOVE    "UUUUUUUUUU400"  TO FS1-RECKEY-1-13.
124700     MOVE    "FFFFFFFFFG022ALTKEY1"  TO FS1-ALTKEY1-1-20.
124800     MOVE    "VVVVVVVVVV380ALTKEY2"  TO FS1-ALTKEY2-1-20.
124900     MOVE    WRK-FS1-RECKEY   TO IX-REC-KEY-AREA.
125000     MOVE    WRK-FS1-ALTKEY1  TO IX-ALT-KEY1-AREA.
125100     MOVE    WRK-FS1-ALTKEY2  TO IX-ALT-KEY2-AREA.
125200 START-TEST-GF-07.
125300*
125400*  START-TEST-GF-07 -  THE START STATEMENT USES AN OPERAND IN THE
125500*                    KEY PHRASE OF THE START STATEMENT WHICH IS
125600*                    A DATA ITEM SUBORDINATE TO THE RECORD KEY
125700*                    NAME.  THE CONTENTS OF THE DATA ITEM
125800*                    (POSITIONS 1 THRU 7 OF THE RECORD KEY)
125900*                    IS LOADED WITH "UUUUUUU" WHICH IS THE
126000*                    KEY VALUE OF THE LAST RECORD IN THE FILE.
126100*                    THERE SHOULD BE NO RECORD IN THE FILE GREATER
126200*                    THAN THIS KEY VALUE THUS AND INVALID KEY
126300*                    IS EXPECTED WHEN THE START IS EXECUTED.
126400*
126500     START  IX-FS1
126600                   KEY IS GREATER THAN R-RECKEY-1-7
126700          INVALID KEY    MOVE  FS1-STATUS TO FILESTATUS (7)
126800                     GO TO START-PASS-GF-07.
126900     MOVE    FS1-STATUS TO FILESTATUS (7).
127000     READ    IX-FS1  AT END
127100                     MOVE  "AT END PATH TAKEN ON READ" TO RE-MARK.
127200     MOVE    IX-FS1R1-F-G-240 TO FILE-RECORD-INFO (1).
127300     PERFORM FAIL.
127400     MOVE    XRECORD-KEY (1) TO COMPUTED-A.
127500     MOVE    "INVALID KEY" TO CORRECT-A.
127600     MOVE "AT END PATH TAKEN & IX-36 ETC " TO RE-MARK.
127700     GO TO   START-EXIT-GF-07.
127800 START-PASS-GF-07.
127900     PERFORM PASS.
128000     MOVE    "INVALID KEY OK."  TO RE-MARK.
128100     GO TO   START-EXIT-GF-07.
128200 START-DELETE-GF-07.
128300     PERFORM DE-LETE.
128400 START-EXIT-GF-07.
128500     PERFORM PRINT-DETAIL.
128600 START-INIT-GF-08.
128700     PERFORM START-INITIALIZE-RECORD.
128800     MOVE "START GT RECKEY " TO FEATURE.
128900     MOVE "START-TEST-GF-08" TO PAR-NAME.
129000     IF      INIT-FLAG NOT EQUAL TO ZERO
129100             MOVE    "TEST IMPROPERLY INITIALIZED"  TO RE-MARK
129200             MOVE   "**"  TO FILESTATUS (8)
129300             GO TO   START-DELETE-GF-08.
129400     MOVE    "ABBBBBBBBC002"  TO FS1-RECKEY-1-13.
129500     MOVE    "XYYYYYYYYY399ALTKEY1"  TO FS1-ALTKEY1-1-20.
129600     MOVE    "WWWWWWWWWV399ALTKEY2"  TO FS1-ALTKEY2-1-20.
129700     MOVE    WRK-FS1-RECKEY   TO IX-REC-KEY-AREA.
129800     MOVE    WRK-FS1-ALTKEY1  TO IX-ALT-KEY1-AREA.
129900     MOVE    WRK-FS1-ALTKEY2  TO IX-ALT-KEY2-AREA.
130000 START-TEST-GF-08.
130100*
130200*  START-TEST-GF-08 -  THIS TEST USES AN OPERAND IN THE KEY
130300*                    PHRASE OF THE START STATEMENT WHICH IS A DATA
130400*                    ITEM SUBORDINATE TO THE RECORD KEY NAME.  THE
130500*                    CONTENTS OF THE DATA ITEM (POSITIONS 1 THRU
130600*                    7 OF THE RECORD KEY) IS LOADED WITH "ABBBBBBB
130700*                    BC".  THIS KEY VALUE IS LOWER THAN ANY RECORD
130800*                    KEY VALUE IN POSITIONS 1 THRU 7 EXISTING
130900*                    IN THE FILE.  THE START STATEMENT WITH THE
131000*                    KEY IS GREATER THAN PHRASE IS EXECUTED AND
131100*                    SHOULD FIND THE RECORD WITH THE KEY VALUE
131200*                    "BBBBBBBBBC002" (RECORD NUMBER 01).
131300*
131400     START   IX-FS1
131500                    KEY IS GREATER THAN R-RECKEY-1-7
131600          INVALID KEY    MOVE  FS1-STATUS TO FILESTATUS (8)
131700                     MOVE  "INVALID KEY ON START"  TO COMPUTED-A
131800                     GO TO START-FAIL-GF-08.
131900     MOVE    FS1-STATUS TO FILESTATUS (8).
132000     READ    IX-FS1  AT END
132100                     MOVE "AT END ON READ" TO COMPUTED-A
132200                     GO TO START-FAIL-GF-08.
132300     MOVE    IX-FS1R1-F-G-240 TO FILE-RECORD-INFO (1).
132400     IF      XRECORD-NUMBER (1) EQUAL TO 001
132500             PERFORM  PASS
132600             MOVE  "SUBORDINATE DATA ITEM IN KEY"  TO RE-MARK
132700             GO TO START-EXIT-GF-08.
132800     MOVE    01  TO RECNO.
132900     PERFORM DISPLAY-RECORD-KEYS.
133000     MOVE    XRECORD-NUMBER (1)  TO COMPUTED-18V0.
133100 START-FAIL-GF-08.
133200     PERFORM  FAIL.
133300     MOVE    001   TO CORRECT-18V0.
133400     MOVE "RECORD NUMBER; IX-36 ETC " TO RE-MARK.
133500     GO TO   START-EXIT-GF-08.
133600 START-DELETE-GF-08.
133700     PERFORM DE-LETE.
133800 START-EXIT-GF-08.
133900     PERFORM PRINT-DETAIL.
134000 START-INIT-GF-09.
134100     PERFORM START-INITIALIZE-RECORD.
134200     MOVE "START GT RECKEY " TO FEATURE.
134300     MOVE "START-TEST-GF-09" TO PAR-NAME.
134400     IF      INIT-FLAG NOT EQUAL TO ZERO
134500             MOVE    "TEST IMPROPERLY INITIALIZED"  TO RE-MARK
134600             MOVE   "**"  TO FILESTATUS (9)
134700             GO TO   START-DELETE-GF-09.
134800     MOVE    "UUUUUUVVVV400"  TO FS1-RECKEY-1-13.
134900     MOVE    "EEEEEEEEEF002ALTKEY1"  TO FS1-ALTKEY1-1-20.
135000     MOVE    "WWWWWWWWWV398ALTKEY2"  TO FS1-ALTKEY2-1-20.
135100     MOVE    WRK-FS1-RECKEY   TO IX-REC-KEY-AREA.
135200     MOVE    WRK-FS1-ALTKEY1  TO IX-ALT-KEY1-AREA.
135300     MOVE    WRK-FS1-ALTKEY2  TO IX-ALT-KEY2-AREA.
135400 START-TEST-GF-09.
135500*
135600*  START-TEST-GF-09 -  THIS TEST USES AN OPERAND IN THE
135700*                    KEY PHRASE OF THE START STATEMENT WHICH IS
135800*                    A DATA ITEM SUBORDINATE TO THE RECORD KEY
135900*                    NAME.  THE CONTENTS OF THE DATA ITEM
136000*                    (POSITIONS 1 THRU 7  OF THE RECORD KEY) IS
136100*                    LOADED WITH "UUUUUUV".  THIS KEY VALUE
136200*                    IS GREATER THAN ANY RECORD KEY VALUE IN
136300*                    POSITION 1 THRU 7 EXISTING IN THE FILE
136400*                    THEREFORE AN INVALID KEY CONDITION IS
136500*                    EXPECTED WHEN THE START STATEMENT IS
136600*                    EXECUTED.
136700*
136800     START   IX-FS1
136900                    KEY IS GREATER THAN R-RECKEY-1-7
137000          INVALID KEY    MOVE  FS1-STATUS TO FILESTATUS (9)
137100                     GO TO START-PASS-GF-09.
137200     MOVE    FS1-STATUS TO FILESTATUS (9).
137300     READ    IX-FS1  AT END
137400      MOVE "IX-36 ETS &     AT END PATH TAKEN ON READ" TO RE-MARK.
137500     MOVE    IX-FS1R1-F-G-240 TO FILE-RECORD-INFO (1).
137600     PERFORM FAIL.
137700     MOVE    XRECORD-KEY (1)  TO COMPUTED-A.
137800     MOVE     "INVALID KEY" TO CORRECT-A.
137900     GO TO   START-EXIT-GF-09.
138000 START-PASS-GF-09.
138100     PERFORM PASS.
138200     MOVE    "INVALID KEY OK."  TO RE-MARK.
138300     GO TO   START-EXIT-GF-09.
138400 START-DELETE-GF-09.
138500     PERFORM DE-LETE.
138600 START-EXIT-GF-09.
138700     PERFORM PRINT-DETAIL.
138800 START-TERM-GF.
138900     CLOSE   IX-FS1.
139000 START-INIT-GF-10.
139100     MOVE "FILE STATUS START:00"  TO FEATURE.
139200     MOVE "START-TEST-GF-10" TO PAR-NAME.
139300*
139400*  THIS SERIES OF TESTS CHECKS THE CONTENTS OF THE FILE STATUS
139500*  CAPTURED FROM THE TESTS IN START-TEST-GF-01 TO -09
139600*
139700 START-TEST-GF-10.
139800     IF      FILESTATUS (1)  EQUAL TO "**"
139900             PERFORM DE-LETE
140000             GO TO  START-WRITE-GF-10.
140100*
140200*  START-TEST-GF-10  - THIS TEST CHECKS THE FILE STATUS CONTENTS
140300*                    RESULTING FROM START-TEST-GF-01.  THE FILE
140400*                    STATUS CONTENTS IS EXPECTED TO BE "00".
140500*
140600     IF      FILESTATUS (1)  EQUAL TO "00"
140700             PERFORM PASS
140800     ELSE
140900         MOVE "FROM START-TEST-GF-01; IX-3 1.3.4 (1) A" TO RE-MARK
141000             PERFORM  FAIL
141100             MOVE  "00"  TO CORRECT-A
141200             MOVE   FILESTATUS (1)  TO COMPUTED-A.
141300 START-WRITE-GF-10.
141400     PERFORM  PRINT-DETAIL.
141500 START-TEST-GF-11.
141600     MOVE "FILE STATUS START:00"  TO FEATURE.
141700     MOVE "START-TEST-GF-11" TO PAR-NAME.
141800     IF      FILESTATUS (2)  EQUAL TO "**"
141900             PERFORM DE-LETE
142000             GO TO  START-WRITE-GF-11.
142100*
142200*  START-TEST-GF-02  - THIS TEST CHECKS THE FILE STATUS CONTENTS
142300*                    RESULTING FROM START-TEST-003.02. THE FILE
142400*                    STATUS CONTENTS IS EXPECTED TO BE "00"
142500*
142600     IF      FILESTATUS (2) EQUAL TO "00"
142700             PERFORM  PASS
142800             ELSE  PERFORM  FAIL
142900         MOVE "FROM START-TEST-GF-02; IX-3 1.3.4 (1) A" TO RE-MARK
143000             MOVE    "00"  TO CORRECT-A
143100             MOVE   FILESTATUS (2)  TO COMPUTED-A.
143200 START-WRITE-GF-11.
143300     PERFORM  PRINT-DETAIL.
143400 START-TEST-GF-12.
143500     MOVE "FILE STATUS START:00"  TO FEATURE.
143600     MOVE "START-TEST-GF-12" TO PAR-NAME.
143700     IF      FILESTATUS (3)  EQUAL TO "**"
143800             PERFORM DE-LETE
143900             GO TO  START-WRITE-GF-12.
144000*
144100*  START-TEST-GF-03  - THIS TEST CHECKS THE FILE STATUS CONTENTS
144200*                    RESULTING FROM START-TEST-003.03. THE FILE
144300*                    STATUS CONTENTS IS EXPECTED TO BE "00"
144400*
144500     IF      FILESTATUS (3) EQUAL TO "00"
144600             PERFORM  PASS
144700             ELSE  PERFORM  FAIL
144800         MOVE "FROM START-TEST-GF-03; IX-3 1.3.4 (1) A" TO RE-MARK
144900             MOVE    "00"  TO CORRECT-A
145000             MOVE   FILESTATUS (3)  TO COMPUTED-A.
145100 START-WRITE-GF-12.
145200     PERFORM  PRINT-DETAIL.
145300 START-TEST-GF-13.
145400     MOVE "FILE STATUS START:23"  TO FEATURE.
145500     MOVE "START-TEST-GF-13" TO PAR-NAME.
145600     IF      FILESTATUS (4)  EQUAL TO "**"
145700             PERFORM DE-LETE
145800             GO TO  START-WRITE-GF-13.
145900*
146000*  START-TEST-GF-04  - THIS TEST CHECKS THE FILE STATUS CONTENTS
146100*                    RESULTING FROM START-TEST-003.04. THE FILE
146200*                    STATUS CONTENTS IS EXPECTED TO BE "23".
146300*
146400     IF      FILESTATUS (4)  EQUAL TO "23"
146500             PERFORM  PASS
146600             ELSE  PERFORM  FAIL
146700         MOVE "FROM START-TEST-GF-04; IX-4 1.3.4 (3) C" TO RE-MARK
146800             MOVE    "23"  TO CORRECT-A
146900             MOVE   FILESTATUS (4)  TO COMPUTED-A.
147000 START-WRITE-GF-13.
147100     PERFORM  PRINT-DETAIL.
147200 START-TEST-GF-14.
147300     MOVE "FILE STATUS START:00"  TO FEATURE.
147400     MOVE "START-TEST-GF-14" TO PAR-NAME.
147500     IF      FILESTATUS (5)  EQUAL TO "**"
147600             PERFORM DE-LETE
147700             GO TO  START-WRITE-GF-14.
147800*
147900*  START-TEST-GF-05  - THIS TEST CHECKS THE FILE STATUS CONTENTS
148000*                    RESULTING FROM START-TEST-GF-05.  THE FILE
148100*                    STATUS CONTENTS IS EXPECTED TO BE "00"
148200*
148300     IF      FILESTATUS (5)  EQUAL TO "00"
148400             PERFORM  PASS
148500             ELSE  PERFORM  FAIL
148600         MOVE "FROM START-TEST-GF-05; IX-3 1.3.4 (1) A" TO RE-MARK
148700             MOVE    "00"  TO CORRECT-A
148800             MOVE   FILESTATUS (5)  TO COMPUTED-A.
148900 START-WRITE-GF-14.
149000     PERFORM  PRINT-DETAIL.
149100 START-TEST-GF-15.
149200     MOVE "FILE STATUS START:00"  TO FEATURE.
149300     MOVE "START-TEST-GF-15" TO PAR-NAME.
149400     IF      FILESTATUS (6)  EQUAL TO "**"
149500             PERFORM DE-LETE
149600             GO TO  START-WRITE-GF-15.
149700*
149800*  START-TEST-GF-15  - THIS TEST CHECKS THE FILE STATUS CONTENTS
149900*                    RESULTING FROM START-TEST-GF-06.  THE FILE
150000*                    STATUS CONTENTS IS EXPECTED TO BE "00"
150100*
150200     IF      FILESTATUS (6)  EQUAL TO "00"
150300             PERFORM  PASS
150400             ELSE  PERFORM  FAIL
150500         MOVE "FROM START-TEST-GF-01; IX-3 1.3.4 (1) A" TO RE-MARK
150600             MOVE   "00"  TO CORRECT-A
150700             MOVE   FILESTATUS (6)  TO COMPUTED-A.
150800 START-WRITE-GF-15.
150900     PERFORM  PRINT-DETAIL.
151000 START-TEST-GF-16.
151100     MOVE "FILE STATUS START:23"  TO FEATURE.
151200     MOVE "START-TEST-GF-16" TO PAR-NAME.
151300     IF      FILESTATUS (7)  EQUAL TO "**"
151400             PERFORM DE-LETE
151500             GO TO  START-WRITE-GF-16.
151600*
151700*  START-TEST-GF-16  - THIS TEST CHECKS THE FILE STATUS CONTENTS
151800*                    RESULTING FROM START-TEST-GF-07.  THE FILE
151900*                    STATUS CONTENTS IS EXPECTED TO BE "23"
152000*
152100     IF      FILESTATUS (7)  EQUAL TO "23"
152200             PERFORM  PASS
152300             ELSE  PERFORM  FAIL
152400         MOVE "FROM START-TEST-GF-07; IX-4 1.3.4 (3) C" TO RE-MARK
152500             MOVE    "23"  TO CORRECT-A
152600             MOVE   FILESTATUS (7)  TO COMPUTED-A.
152700 START-WRITE-GF-16.
152800       PERFORM  PRINT-DETAIL.
152900 START-TEST-GF-17.
153000     MOVE "FILE STATUS START:00"  TO FEATURE.
153100     MOVE "START-TEST-GF-17" TO PAR-NAME.
153200     IF      FILESTATUS (8)  EQUAL TO "**"
153300             PERFORM DE-LETE
153400             GO TO  START-WRITE-GF-17.
153500*
153600*  START-TEST-GF-17  - THIS TEST CHECKS THE FILE STATUS CONTENTS
153700*                    RESULTING FROM START-TEST-GF-08.  THE FILE
153800*                    STATUS CONTENTS IS EXPECTED TO BE "00"
153900*
154000     IF      FILESTATUS (8) EQUAL TO "00"
154100             PERFORM  PASS
154200             ELSE  PERFORM  FAIL
154300         MOVE "FROM START-TEST-GF-08; IX-3 1.3.4 (1) A" TO RE-MARK
154400             MOVE    "00"  TO CORRECT-A
154500             MOVE   FILESTATUS (8)  TO COMPUTED-A.
154600 START-WRITE-GF-17.
154700     PERFORM  PRINT-DETAIL.
154800 START-TEST-GF-18.
154900     MOVE "FILE STATUS START:23"  TO FEATURE.
155000     MOVE "START-TEST-GF-18" TO PAR-NAME.
155100     IF      FILESTATUS (9)  EQUAL TO "**"
155200             PERFORM DE-LETE
155300             GO TO  START-WRITE-GF-18.
155400*
155500*  START-WRITE-GF-18 - THIS TEST CHECKS THE FILE STATUS CONTENTS
155600*                    RESULTING FROM START-TEST-GF-09.  THE FILE
155700*                    STATUS CONTENTS IS EXPECTED TO BE "23".
155800*
155900     IF      FILESTATUS (9)  EQUAL TO "23"
156000             PERFORM PASS
156100     ELSE    PERFORM FAIL
156200         MOVE "FROM START-TEST-GF-09; IX-4 1.3.4 (3) C" TO RE-MARK
156300             MOVE  "23"  TO CORRECT-A
156400             MOVE   FILESTATUS (9)  TO COMPUTED-A.
156500 START-WRITE-GF-18.
156600     PERFORM  PRINT-DETAIL.
156700
156800
156900 START-INIT-GF-19-0.
157000     OPEN    INPUT  IX-FS1.
157100     MOVE    SPACE TO HOLD-FILESTATUS-RECORD.
157200*
157300* THE "START -- GREATER THAN--" IS CHECKED FOR PROPER POSITIONING
157400* OF THE RECORD POINTER FOR THE SUBSEQUENT READ STATEMENT.
157500* START-TEST-GF  USES ONLY THE ALTERNATE RECORD KEY WITHOUT THE
157600* THE DUPLICATES OPTION FOR ESTABLISHING THE CURRENT RECORD
157700* POINTER FOR THE FILE.  THE FOLLOWING IS A SUMMARY OF THE TEST
157800* CONDITIONS AND THE EXPECTED ACTION TO BE TAKEN FOR THE TESTS.
157900*
158000*                      CONDITIONS (CONTENTS OF KEY) / ACTION
158100*
158200*   START-TEST-GF-01  - EQUAL A RECORD IN FILE / RECORD FOUND
158300*   START-TEST-GF-02  - BETWEEN 2 KEY VALUES / RECORD FOUND
158400*   START-TEST-GF-03  - LESS THAN FIRST FILE REC. / REC. FOUND
158500*   START-TEST-GF-04  - GREATER THAN LAST FILE RECORD / INVALID KE
158600*   START-TEST-GF-05 - UNEQUAL SIZE OPERANDS (EQUAL) / RECORD FOUN
158700*   START-TEST-GF-06 - UNEQUAL SIZE OPERANDS (EQUAL) / RECORD FOUN
158800*   START-TEST-GF-07 - UNEQUAL SIZE OPERANDS (UNEQUAL) / INVLD KEY
158900*   START-TEST-GF-08 - UNEQUAL SIZE OPERANDS (UNEQUAL) / REC FOUND
159000*   START-TEST-GF-09 - UNEQUAL SIZE OPERANDS (UNEQUAL) /INVLD KEY
159100*
159200*  BEFORE EACH TEST A RECORD IS MADE AVAILABLE WHICH IS DIFFERENT
159300*  THAN THE ONE WHICH IS EXPECTED TO BE PRESENT FOLLOWING A TEST.
159400*  IF AN INVALID KEY IS EXPECTED FROM THE TEST, THE KEYS
159500*  ASSOCIATED WITH THE FILE WHICH ARE NOT PARTICIPATING IN THE
159600*  START STATEMENT WILL BE LOADED WITH VALUES WHICH WOULD
159700*  MATCH RECORDS IN THE FILE.  IF KEY MATCH IS EXPECTED FROM
159800*  THE TEST, THE KEYS ASSOCIATED WITH THE FILE WHICH ARE NOT
159900*  PARTICIPATING IN THE START STATEMENT WILL BE LOADED WITH
160000*  VALUES WHICH WOULD NOT MATCH RECORDS IN THE FILE.  THE FILE
160100*  STATUS FROM EXECUTION OF EACH START IS CAPTURED FOR LATER TESTS
160200*
160300 START-INIT-GF-19.
160400     PERFORM START-INITIALIZE-RECORD.
160500     MOVE "STR GT ALTKY W/O DUP" TO FEATURE.
160600     MOVE "START-TEST-GF-19"  TO PAR-NAME.
160700     IF      INIT-FLAG NOT EQUAL TO ZERO
160800             MOVE   "**"  TO FILESTATUS (1)
160900             MOVE   "TEST IMPROPERLY INITIALIZED" TO RE-MARK
161000             GO TO START-DELETE-GF-19.
161100     MOVE    "CCCCCDDDDD022"  TO FS1-RECKEY-1-13.
161200     MOVE    "XXXXXXXXXY382ALTKEY1"  TO FS1-ALTKEY1-1-20.
161300     MOVE    "EEEEEFFFFF022ALTKEY2" TO FS1-ALTKEY2-1-20.
161400     MOVE    WRK-FS1-RECKEY TO IX-REC-KEY-AREA.
161500     MOVE    WRK-FS1-ALTKEY1 TO IX-ALT-KEY1-AREA.
161600     MOVE    WRK-FS1-ALTKEY2 TO IX-ALT-KEY2-AREA.
161700 START-TEST-19.
161800*
161900*  START-TEST-GF-19  - THE START SHOULD FIND A RECORD IN THE FILE
162000*                    WHICH HAS AN ALTERNATE KEY VALUE OF
162100*                    XXXXXXXXYY384ALTKEY1 (RECORD NUMBER 192).
162200*
162300     START   IX-FS1
162400                    KEY IS GREATER THAN IX-FS1-ALTKEY1
162500          INVALID KEY   MOVE FS1-STATUS TO FILESTATUS (1)
162600                     MOVE  "INVALID KEY ON START" TO COMPUTED-A
162700                        GO TO START-FAIL-GF-19.
162800     MOVE    FS1-STATUS TO FILESTATUS (1).
162900     READ    IX-FS1  AT END
163000                     MOVE  "AT END ON READ" TO COMPUTED-A
163100                     GO TO START-FAIL-GF-19.
163200     MOVE    IX-FS1R1-F-G-240  TO  FILE-RECORD-INFO (1).
163300     IF      XRECORD-NUMBER (1)  EQUAL TO 192
163400             PERFORM PASS
163500             MOVE SPACE TO RE-MARK
163600             GO TO START-EXIT-GF-19.
163700     MOVE    67  TO RECNO.
163800     PERFORM DISPLAY-ALTERNATE-KEY1.
163900     MOVE     XRECORD-NUMBER (1)  TO COMPUTED-18V0.
164000 START-FAIL-GF-19.
164100     PERFORM FAIL.
164200     MOVE    192  TO CORRECT-18V0.
164300     MOVE "RECORD NUMBER; IX-36 ETC " TO RE-MARK.
164400     GO TO   START-EXIT-GF-19.
164500 START-DELETE-GF-19.
164600     PERFORM DE-LETE.
164700 START-EXIT-GF-19.
164800     PERFORM PRINT-DETAIL.
164900 START-INIT-GF-20.
165000     PERFORM START-INITIALIZE-RECORD.
165100     MOVE "STR GT ALTKY W/O DUP" TO FEATURE.
165200     MOVE "START-TEST-GF-20"  TO PAR-NAME.
165300     IF      INIT-FLAG NOT EQUAL TO ZERO
165400             MOVE   "**"  TO FILESTATUS (2)
165500             MOVE   "TEST IMPROPERLY INITIALIZED" TO RE-MARK
165600             GO TO START-DELETE-GF-20.
165700     MOVE    "CCCCCDDDDD022"  TO FS1-RECKEY-1-13.
165800     MOVE    "HHHHHHHIII67ALTKEY1"  TO FS1-ALTKEY1-1-20.
165900     MOVE    "EEEEEFFFFF022ALTKEY2" TO FS1-ALTKEY2-1-20.
166000     MOVE    WRK-FS1-RECKEY TO IX-REC-KEY-AREA.
166100     MOVE    WRK-FS1-ALTKEY1 TO IX-ALT-KEY1-AREA.
166200     MOVE    WRK-FS1-ALTKEY2 TO IX-ALT-KEY2-AREA.
166300 START-TEST-GF-20.
166400*
166500*  START-TEST-GF-20  - THE START SHOULD FIND A RECORD IN THE FILE
166600*                    WHICH HAS AN ALTERNATE KEY VALUE OF
166700*                    HHHHHHIIII068ALTKEY1 (RECORD NUMBER 34).
166800*                    THE DATA ITEM WAS LOADED WITH A KEY VALUE
166900*                    SEQUENTIALLY LOCATED BETWEEN TWO CURRENTLY
167000*                    EXISTING ALTERNATE KEYS IN THE FILE.
167100*
167200     START   IX-FS1
167300                    KEY IS GREATER THAN IX-FS1-ALTKEY1
167400          INVALID KEY   MOVE FS1-STATUS TO FILESTATUS (2)
167500                     MOVE  "INVALID KEY ON START" TO COMPUTED-A
167600                        GO TO START-FAIL-GF-20.
167700     MOVE    FS1-STATUS TO FILESTATUS (2).
167800     READ    IX-FS1  AT END
167900                     MOVE  "AT END ON READ" TO COMPUTED-A
168000                     GO TO START-FAIL-GF-20.
168100     MOVE    IX-FS1R1-F-G-240  TO  FILE-RECORD-INFO (1).
168200     IF      XRECORD-NUMBER (1)  EQUAL TO 034
168300             PERFORM PASS
168400             MOVE SPACE TO RE-MARK
168500             GO TO START-EXIT-GF-20.
168600     MOVE    34  TO RECNO.
168700     PERFORM DISPLAY-ALTERNATE-KEY1.
168800     MOVE     XRECORD-NUMBER (1)  TO COMPUTED-18V0.
168900 START-FAIL-GF-20.
169000     PERFORM FAIL.
169100     MOVE    034  TO CORRECT-18V0.
169200     MOVE "RECORD NUMBER; IX-36 ETC " TO RE-MARK.
169300     GO TO   START-EXIT-GF-20.
169400 START-DELETE-GF-20.
169500     PERFORM DE-LETE.
169600 START-EXIT-GF-20.
169700     PERFORM PRINT-DETAIL.
169800 START-INIT-GF-21.
169900     PERFORM START-INITIALIZE-RECORD.
170000     MOVE "STR GT ALTKY W/O DUP" TO FEATURE.
170100     MOVE "START-TEST-GF-21"  TO PAR-NAME.
170200     IF      INIT-FLAG NOT EQUAL TO ZERO
170300             MOVE   "**"  TO FILESTATUS (3)
170400             MOVE   "TEST IMPROPERLY INITIALIZED" TO RE-MARK
170500             GO TO START-DELETE-GF-21.
170600     MOVE    "CCCCCDDDDD022"  TO FS1-RECKEY-1-13.
170700     MOVE    "EEEEEEEEEF001ALTKEY1"  TO FS1-ALTKEY1-1-20.
170800     MOVE    "EEEEEFFFFF022ALTKEY2" TO FS1-ALTKEY2-1-20.
170900     MOVE    WRK-FS1-RECKEY TO IX-REC-KEY-AREA.
171000     MOVE    WRK-FS1-ALTKEY1 TO IX-ALT-KEY1-AREA.
171100     MOVE    WRK-FS1-ALTKEY2 TO IX-ALT-KEY2-AREA.
171200 START-TEST-GF-21.
171300*
171400*  START-TEST-GF-21  - THE START STATEMENT SHOULD FIND A
171500*                    RECORD IN THE FILE WHICH HAS AN ALTERNATE
171600*                    KEY VALUE OF EEEEEEEEEF002ALTKEY1 (RECORD
171700*                    NUMBER 01).  THE ALTERNATE KEY WAS LOADED
171800*                    WITH A VALUE THAT IS SEQUENTIALLY LOWER
171900*                    THAN ANY CURRENTLY EXISTNNG KEY IN THE FILE
172000*                    BEFORE THE START WAS EXECUTED.
172100*
172200     START   IX-FS1
172300                    KEY IS GREATER THAN IX-FS1-ALTKEY1
172400          INVALID KEY   MOVE FS1-STATUS TO FILESTATUS (3)
172500                     MOVE  "INVALID KEY ON START" TO COMPUTED-A
172600                        GO TO START-FAIL-GF-21.
172700     MOVE    FS1-STATUS TO FILESTATUS (3).
172800     READ    IX-FS1  AT END
172900                     MOVE  "AT END ON READ" TO COMPUTED-A
173000                     GO TO START-FAIL-GF-21.
173100     MOVE    IX-FS1R1-F-G-240  TO  FILE-RECORD-INFO (1).
173200     IF      XRECORD-NUMBER (1)  EQUAL TO 001
173300             PERFORM PASS
173400             MOVE SPACE TO RE-MARK
173500             GO TO START-EXIT-GF-21.
173600     MOVE    01  TO RECNO.
173700     PERFORM DISPLAY-ALTERNATE-KEY1.
173800     MOVE     XRECORD-NUMBER (1)  TO COMPUTED-18V0.
173900 START-FAIL-GF-21.
174000     PERFORM FAIL.
174100     MOVE    001  TO CORRECT-18V0.
174200     MOVE "RECORD NUMBER; IX-36 ETC " TO RE-MARK.
174300     GO TO   START-EXIT-GF-21.
174400 START-DELETE-GF-21.
174500     PERFORM DE-LETE.
174600 START-EXIT-GF-21.
174700     PERFORM PRINT-DETAIL.
174800 START-INIT-GF-22.
174900     PERFORM START-INITIALIZE-RECORD.
175000     MOVE "STR GT ALTKY W/O DUP" TO FEATURE.
175100     MOVE "START-TEST-GF-22"  TO PAR-NAME.
175200     IF      INIT-FLAG NOT EQUAL TO ZERO
175300             MOVE    "TEST IMPROPERLY INITIALIZED"  TO RE-MARK
175400             MOVE   "**"  TO FILESTATUS (4)
175500             GO TO   START-DELETE-GF-22.
175600     MOVE    "UUUUUUUUUU400"  TO FS1-RECKEY-1-13.
175700     MOVE    "YYYYYYYYYY401ALTKEY1"  TO FS1-ALTKEY1-1-20.
175800     MOVE    "DDDDDDDDDD000ALTKEY2" TO FS1-ALTKEY2-1-20.
175900     MOVE    WRK-FS1-RECKEY   TO IX-REC-KEY-AREA.
176000     MOVE    WRK-FS1-ALTKEY1  TO IX-ALT-KEY1-AREA.
176100     MOVE    WRK-FS1-ALTKEY2  TO IX-ALT-KEY2-AREA.
176200 START-TEST-GF-22.
176300*
176400*  START-TEST-GF-04  - THE START STATEMENT SHOULD NOT FIND A
176500*                    RECORD IN THE FILE WHICH HAS AN ALTERNATE
176600*                    KEY VALUE OF YYYYYYYYYY401ALTKEY1.  THIS
176700*                    VALUE IS SEQUENTIALLY GREATER THAN
176800*                    ANY ALTERNATE KEY CURRENTLY EXISTING IN
176900*                    THE FILE.  AN INVALID KEY CONDITION
177000*                    IS EXPECTED WHEN THE START IS EXECUTED.
177100*
177200     START   IX-FS1
177300                    KEY IS GREATER THAN IX-FS1-ALTKEY1
177400          INVALID KEY    MOVE  FS1-STATUS TO FILESTATUS (4)
177500                         GO TO START-PASS-GF-22.
177600     MOVE    FS1-STATUS TO FILESTATUS (4).
177700     READ    IX-FS1 AT END
177800                     MOVE  "AT END PATH TAKEN ON READ" TO RE-MARK.
177900     MOVE    IX-FS1R1-F-G-240 TO FILE-RECORD-INFO (1).
178000     PERFORM FAIL.
178100     MOVE    ALTERNATE-KEY1 (1) TO COMPUTED-A.
178200     MOVE    "INVALID KEY" TO CORRECT-A.
178300     GO TO   START-EXIT-GF-22.
178400 START-PASS-GF-22.
178500     PERFORM  PASS.
178600     MOVE     "INVALID KEY OK."  TO RE-MARK.
178700     GO TO   START-EXIT-GF-22.
178800 START-DELETE-GF-22.
178900     PERFORM DE-LETE.
179000 START-EXIT-GF-22.
179100     PERFORM PRINT-DETAIL.
179200 START-INIT-GF-23.
179300     PERFORM START-INITIALIZE-RECORD.
179400     MOVE "STR GT ALTKY W/O DUP" TO FEATURE.
179500     MOVE "START-TEST-GF-23"  TO PAR-NAME.
179600     IF      INIT-FLAG NOT EQUAL TO ZERO
179700             MOVE    "TEST IMPROPERLY INITIALIZED"  TO RE-MARK
179800             MOVE   "**"  TO FILESTATUS (5)
179900             GO TO   START-DELETE-GF-23.
180000     MOVE    "CDDDDDDDDD039"  TO FS1-RECKEY-1-13.
180100     MOVE    "GGGGHHHHHH100ALTKEY1"  TO FS1-ALTKEY1-1-20.
180200     MOVE    "ABCXXXXXXX400ALTKEY2"  TO FS1-ALTKEY2-1-20.
180300     MOVE    WRK-FS1-RECKEY   TO IX-REC-KEY-AREA.
180400     MOVE    WRK-FS1-ALTKEY1  TO IX-ALT-KEY1-AREA.
180500     MOVE    WRK-FS1-ALTKEY2  TO IX-ALT-KEY2-AREA.
180600 START-TEST-GF-23.
180700*
180800*  START-TEST-GF-23  - THE START STATEMENT USES AN OPERAND
180900*                    IN THE KEY PHRASE WHICH IS NOT THE NAME
181000*                    OF AN ALTERNATE KEY BUT IS THE NAME OF A
181100*                    DATA ITEM WHICH IS SUBORDINATE TO THE
181200*                    ALTERNATE KEY.  THE CONTENTS OF THE DATA ITEM
181300*                    (POSITIONS 1 THRU 6 OF THE ALTERNATE KEY)
181400*                    IS A UNIQUE KEY VALUE FOR THE FILE.  THE
181500*                    BALANCE OF THE KEY (POSITIONS 7 THRU 20 OF
181600*                    THE ALTERNATE KEY IS NOT A VALID KEY VALUE
181700*                    FOR THE FILE.  THE
181800*                    RECORD WITH THE ALTERNATE KEY "GGGHHHHHHH054
181900*                    ALTKEY1 (RECORD NUMBER 27) IS EXPECTED TO
182000*                    BE FOUND.
182100*
182200     START   IX-FS1
182300                    KEY IS GREATER THAN R-ALTKEY1-1-6
182400          INVALID KEY    MOVE  FS1-STATUS TO FILESTATUS (5)
182500                     MOVE  "INVALID KEY ON START" TO COMPUTED-A
182600                     GO TO START-FAIL-GF-23.
182700     MOVE    FS1-STATUS TO FILESTATUS (5).
182800     READ    IX-FS1  AT END
182900                     MOVE  "AT END ON READ" TO COMPUTED-A
183000                     GO TO  START-FAIL-GF-23.
183100     MOVE    IX-FS1R1-F-G-240 TO FILE-RECORD-INFO (1).
183200     IF      XRECORD-NUMBER (1)  EQUAL TO 27
183300             PERFORM  PASS
183400             MOVE  "SUBORDINATE DATA ITEM OF KEY" TO RE-MARK
183500             GO TO START-EXIT-GF-23.
183600     MOVE    27  TO RECNO.
183700     PERFORM DISPLAY-ALTERNATE-KEY1.
183800     MOVE    XRECORD-NUMBER (1)  TO COMPUTED-18V0.
183900 START-FAIL-GF-23.
184000     PERFORM  FAIL.
184100     MOVE    27  TO CORRECT-18V0.
184200     MOVE "RECORD NUMBER; IX-36 ETC " TO RE-MARK.
184300     GO TO   START-EXIT-GF-23.
184400 START-DELETE-GF-23.
184500     PERFORM DE-LETE.
184600 START-EXIT-GF-23.
184700     PERFORM PRINT-DETAIL.
184800 START-INIT-GF-24.
184900     PERFORM START-INITIALIZE-RECORD.
185000     MOVE "STR GT ALTKY W/O DUP" TO FEATURE.
185100     MOVE "START-TEST-GF-24"  TO PAR-NAME.
185200     IF INIT-FLAG NOT EQUAL  TO ZERO
185300             MOVE    "TEST IMPROPERLY INITIALIZED"  TO RE-MARK
185400             MOVE   "**"  TO FILESTATUS (6)
185500             GO TO   START-DELETE-GF-24.
185600     MOVE    "YYYYYUUUUU390"  TO FS1-RECKEY-1-13.
185700     MOVE    "XXXXXXXXXX380ALTKEY1" TO FS1-ALTKEY1-1-20.
185800     MOVE    "WWWWWWWWWV399ALTKEY2"  TO FS1-ALTKEY2-1-20.
185900     MOVE    WRK-FS1-RECKEY   TO IX-REC-KEY-AREA.
186000     MOVE    WRK-FS1-ALTKEY1  TO IX-ALT-KEY1-AREA.
186100     MOVE    WRK-FS1-ALTKEY2  TO IX-ALT-KEY2-AREA.
186200 START-TEST-GF-24.
186300*
186400*  START-TEST-GF-24  - THE START STATEMENT USES AN OPERAND IN THE
186500*                    KEY PHRASE WHICH IS NOT THE NAME OF AN
186600*                    ALTERNATE KEY BUT IS THE NAME OF A DATA ITEM
186700*                    THAT IS SUBORDINATE TO THE KEY.  THE CONTENTS
186800*                    OF THE DATA ITEM (POSITIONS 1 THRU 5 OF THE
186900*                    ALTERNATE KEY) IS A DUPLICATE OF THE FIRST
187000*                    5 POSITIONS OF 5 OTHER RECORDS IN THE FILE.
187100*                    THIS TEST EXPECTS THE RECORD POINTER
187200*                    TO BE POSITIONED TO RECORD KEY XXXXYYYYYY392
187300*                    ALTKEY1 (RECORD NUMBER 196) WHICH WAS THE
187400*                    RECORD WRITTEN AFTER THE LAST RECORD THAT
187500*                    CONTAINS XXXXX IN THE FIRST 5 POSITIONS OF
187600*                  THE KEY.  THE ALTERNATE KEY WAS LOADED WITH THE
187700*                    VALUE XXXXXXXXXX380ALTKEY1 (KEY FOR RECORD
187800*                    NUMBER 190) BEFORE THE START WAS EXECUTED.
187900*
188000     START   IX-FS1
188100                    KEY IS GREATER THAN IX-FS1-ALTKEY1-1-5
188200                     INVALID KEY
188300                         MOVE  FS1-STATUS TO FILESTATUS (6)
188400                     MOVE  "INVALID KEY ON START"  TO COMPUTED-A
188500                     GO TO START-FAIL-GF-24.
188600     MOVE    FS1-STATUS TO FILESTATUS (6).
188700     READ    IX-FS1  AT END
188800                     MOVE "AT END ON READ" TO COMPUTED-A
188900                     GO TO START-FAIL-GF-24.
189000     MOVE    IX-FS1R1-F-G-240 TO FILE-RECORD-INFO (1).
189100     IF      XRECORD-NUMBER (1) EQUAL TO 196
189200             PERFORM  PASS
189300             MOVE  "SUBORDINATE DATA ITEM IN KEY"  TO RE-MARK
189400             GO TO START-EXIT-GF-24.
189500     MOVE    71  TO RECNO.
189600     PERFORM DISPLAY-ALTERNATE-KEY1.
189700     MOVE    XRECORD-NUMBER (1)  TO COMPUTED-18V0.
189800 START-FAIL-GF-24.
189900     PERFORM  FAIL.
190000     MOVE    196  TO CORRECT-18V0.
190100     MOVE "RECORD NUMBER; IX-36 ETC " TO RE-MARK.
190200     GO TO   START-EXIT-GF-24.
190300 START-DELETE-GF-24.
190400     PERFORM DE-LETE.
190500 START-EXIT-GF-24.
190600     PERFORM PRINT-DETAIL.
190700 START-INIT-GF-25.
190800     PERFORM START-INITIALIZE-RECORD.
190900     MOVE "STR GT ALTKY W/O DUP" TO FEATURE.
191000     MOVE "START-TEST-GF-25"  TO PAR-NAME.
191100     IF INIT-FLAG NOT EQUAL TO ZERO
191200             MOVE    "TEST IMPROPERLY INITIALIZED"  TO RE-MARK
191300             MOVE   "**"  TO FILESTATUS (7)
191400             GO TO   START-DELETE-GF-25.
191500     MOVE    "CCCCCCCCCD022"  TO FS1-RECKEY-1-13.
191600     MOVE    "YYYYYYYYYY400ALTKEY1"  TO FS1-ALTKEY1-1-20.
191700     MOVE    "VVVVVVVVVV380ALTKEY2"  TO FS1-ALTKEY2-1-20.
191800     MOVE    WRK-FS1-RECKEY   TO IX-REC-KEY-AREA.
191900     MOVE    WRK-FS1-ALTKEY1  TO IX-ALT-KEY1-AREA.
192000     MOVE    WRK-FS1-ALTKEY2  TO IX-ALT-KEY2-AREA.
192100 START-TEST-GF-25.
192200*
192300*  START-TEST-GF-25  - THE START STATEMENT USES AN OPERAND IN THE
192400*                    KEY PHRASE OF THE START STATEMENT WHICH IS
192500*                    A DATA ITEM SUBORDINATE TO THE ALTERNATE KEY
192600*                    NAME.  THE CONTENTS OF THE DATA ITEM
192700*                    POSITIONS 1 THRU 6 OF THE ALTERNATE KEY)
192800*                    IS LOADED WITH YYYYYY WHICH IS THE KEY VALUE
192900*                    OF THE LAST RECORD IN THE FILE.  THERE SHOULD
193000*                    BE NO RECORD IN THE FILE WITH A KEY VALUE
193100*                    GREATER THUS AN INVALID KEY IS EXPECTED
193200*                    WHEN THE START IS EXECUTED.
193300*
193400     START   IX-FS1
193500                    KEY IS GREATER THAN R-ALTKEY1-1-6
193600          INVALID KEY    MOVE  FS1-STATUS TO FILESTATUS (7)
193700                     GO TO START-PASS-GF-25.
193800     MOVE    FS1-STATUS TO FILESTATUS (7).
193900     READ    IX-FS1  AT END
194000                     MOVE  "AT END PATH TAKEN ON READ" TO RE-MARK.
194100     MOVE    IX-FS1R1-F-G-240 TO FILE-RECORD-INFO (1).
194200     PERFORM FAIL.
194300     MOVE "AT END PATH AND IX-36 ETC " TO RE-MARK.
194400     MOVE    XRECORD-KEY (1) TO COMPUTED-A.
194500     MOVE    "INVALID KEY" TO CORRECT-A.
194600     GO TO   START-EXIT-GF-25.
194700 START-PASS-GF-25.
194800     PERFORM PASS.
194900     MOVE    "INVALID KEY"  TO RE-MARK.
195000     GO TO   START-EXIT-GF-25.
195100 START-DELETE-GF-25.
195200     PERFORM DE-LETE.
195300 START-EXIT-GF-25.
195400     PERFORM PRINT-DETAIL.
195500 START-INIT-GF-26.
195600     PERFORM START-INITIALIZE-RECORD.
195700     MOVE "STR GT ALTKY W/O DUP" TO FEATURE.
195800     MOVE "START-TEST-GF-26"  TO PAR-NAME.
195900     IF      INIT-FLAG NOT EQUAL TO ZERO
196000             MOVE    "TEST IMPROPERLY INITIALIZED"  TO RE-MARK
196100             MOVE   "**"  TO FILESTATUS (8)
196200             GO TO   START-DELETE-GF-26.
196300     MOVE    "YYYYYUUUUU390"  TO FS1-RECKEY-1-13.
196400     MOVE    "EEEEDEEEEE002ALTKEY1"  TO FS1-ALTKEY1-1-20.
196500     MOVE    "WWWWWWWWWV399ALTKEY2"  TO FS1-ALTKEY2-1-20.
196600     MOVE    WRK-FS1-RECKEY   TO IX-REC-KEY-AREA.
196700     MOVE    WRK-FS1-ALTKEY1  TO IX-ALT-KEY1-AREA.
196800     MOVE    WRK-FS1-ALTKEY2  TO IX-ALT-KEY2-AREA.
196900 START-TEST-GF-26.
197000*
197100*  START-TEST-GF-26  - THIS TEST USES AN OPERAND IN THE
197200*                    KEY PHRASE OF THE START STATEMENT WHICH IS
197300*                    A DATA ITEM SUBORDINATE TO THE ALTERNATE KEY
197400*                    NAME.  THE CONTENTS OF THE DATA ITEM
197500*                    (POSITIONS 1 THRU 6 OF THE ALTERNATE KEY) IS
197600*                    LOADED WITH "EEEEDE".  THIS KEY VALUE
197700*                    IS LOWER THAN ANY ALTERNATE KEY VALUE IN
197800*                    POSITION 1 THRU 6 EXISTING IN THE FILE
197900*                    THE START STATEMENT WITH THE KEY IS GREATER
198000*                    THAN PHRASE IS EXECUTED AND SHOULD FIND A
198100*                    RECORD WITH THE KEY VALUE "EEEEEEEEEF002
198200*                    ALTKEY1 (RECORD NUMBER 01).
198300*
198400     START   IX-FS1
198500                    KEY IS GREATER THAN R-ALTKEY1-1-6
198600          INVALID KEY    MOVE  FS1-STATUS TO FILESTATUS (8)
198700                     MOVE  "INVALID KEY ON START"  TO COMPUTED-A
198800                     GO TO START-FAIL-GF-26.
198900     MOVE    FS1-STATUS TO FILESTATUS (8).
199000     READ    IX-FS1  AT END
199100                     MOVE "AT END ON READ" TO COMPUTED-A
199200                     GO TO START-FAIL-GF-26.
199300     MOVE    IX-FS1R1-F-G-240 TO FILE-RECORD-INFO (1).
199400     IF      XRECORD-NUMBER (1) EQUAL TO 001
199500             PERFORM  PASS
199600             MOVE  "SUBORDINATE DATA ITEM IN KEY"  TO RE-MARK
199700             GO TO START-EXIT-GF-26.
199800     MOVE    01  TO RECNO.
199900     PERFORM DISPLAY-ALTERNATE-KEY1.
200000     MOVE    XRECORD-NUMBER (1)  TO COMPUTED-18V0.
200100 START-FAIL-GF-26.
200200     PERFORM  FAIL.
200300     MOVE    001   TO CORRECT-18V0.
200400     MOVE "RECORD NUMBER; IX-36 ETC " TO RE-MARK.
200500     GO TO   START-EXIT-GF-26.
200600 START-DELETE-GF-26.
200700     PERFORM DE-LETE.
200800 START-EXIT-GF-26.
200900     PERFORM PRINT-DETAIL.
201000 START-INIT-GF-27.
201100     PERFORM START-INITIALIZE-RECORD.
201200     MOVE "STR GT ALTKY W/O DUP" TO FEATURE.
201300     MOVE "START-TEST-GF-27"  TO PAR-NAME.
201400     IF      INIT-FLAG NOT EQUAL TO ZERO
201500             MOVE    "TEST IMPROPERLY INITIALIZED"  TO RE-MARK
201600             MOVE   "**"  TO FILESTATUS (9)
201700             GO TO   START-DELETE-GF-27.
201800     MOVE    "UUUUUUUUUU400"  TO FS1-RECKEY-1-13.
201900     MOVE    "YYYYYZYYYY400ALTKEY1"  TO FS1-ALTKEY1-1-20.
202000     MOVE    "WWWWWWWWWV398ALTKEY2"  TO FS1-ALTKEY2-1-20.
202100     MOVE    WRK-FS1-RECKEY   TO IX-REC-KEY-AREA.
202200     MOVE    WRK-FS1-ALTKEY1  TO IX-ALT-KEY1-AREA.
202300     MOVE    WRK-FS1-ALTKEY2  TO IX-ALT-KEY2-AREA.
202400 START-TEST-GF-27.
202500*
202600*  START-TEST-GF-27  - THIS TEST USES AN OPERAND IN THE
202700*                    KEY PHRASE OF THE START STATEMENT WHICH IS
202800*                    A DATA ITEM SUBORDINATE TO THE ALTERNATE KEY
202900*                    NAME.  THE CONTENTS OF THE DATA ITEM
203000*                    (POSITIONS 1 THRU 10 OF THE RECORD KEY) IS
203100*                    LOADED WITH "YYYYYZYYYY". THIS KEY VALUE
203200*                    IS GREATER THAN ANY ALTERNATE KEY VALUE IN
203300*                    POSITION 1 THRU 10 EXISTING IN THE FILE
203400*                    THEREFORE AN INVALID KEY CONDITION IS
203500*                    EXPECTED WHEN THE START STATEMENT IS
203600*                    EXECUTED.
203700*
203800     START   IX-FS1
203900                    KEY IS GREATER THAN IX-FS1-ALTKEY1-1-10
204000                                 INVALID KEY
204100                         MOVE  FS1-STATUS TO FILESTATUS (9)
204200                     GO TO START-PASS-GF-27.
204300     MOVE    FS1-STATUS TO FILESTATUS (9).
204400     READ    IX-FS1  AT END
204500       MOVE "IX-36 ETC.;    AT END PATH TAKEN ON READ" TO RE-MARK.
204600     MOVE    IX-FS1R1-F-G-240 TO FILE-RECORD-INFO (1).
204700     PERFORM FAIL.
204800     MOVE    XRECORD-KEY (1)  TO COMPUTED-A.
204900     MOVE     "INVALID KEY" TO CORRECT-A.
205000     GO TO   START-EXIT-GF-27.
205100 START-PASS-GF-27.
205200     PERFORM PASS.
205300     MOVE    "INVALID KEY OK." TO RE-MARK.
205400     GO TO   START-EXIT-GF-27.
205500 START-DELETE-GF-27.
205600     PERFORM DE-LETE.
205700 START-EXIT-GF-27.
205800     PERFORM PRINT-DETAIL.
205900
206000     CLOSE   IX-FS1.
206100
206200*
206300*  THIS SERIES OF TESTS CHECKS THE CONTENTS OF THE FILE STATUS
206400*  CAPTURED FROM THE TESTS IN START-TEST-005.
206500*
206600 START-TEST-GF-28.
206700     MOVE "FILE STATUS START:00"  TO FEATURE.
206800     MOVE "START-TEST-GF-28"  TO PAR-NAME.
206900     IF      FILESTATUS (1)  EQUAL TO "**"
207000             PERFORM DE-LETE
207100             GO TO  START-WRITE-GF-28.
207200*
207300*  START-TEST-GF-28  - THIS TEST CHECKS THE FILE STATUS CONTENTS
207400*                    RESULTING FROM START-TEST-GF-19.  THE FILE
207500*                    STATUS CONTENTS IS EXPECTED TO BE "00".
207600*
207700     IF      FILESTATUS (1)  EQUAL TO "00"
207800             PERFORM PASS
207900     ELSE
208000         MOVE "FROM START-TEST-GF-19; IX-3 1.3.4 (1) A" TO RE-MARK
208100             PERFORM  FAIL
208200             MOVE  "00"  TO CORRECT-A
208300             MOVE   FILESTATUS (1)  TO COMPUTED-A.
208400 START-WRITE-GF-28.
208500     PERFORM  PRINT-DETAIL.
208600 START-TEST-GF-29.
208700     MOVE "FILE STATUS START:00"  TO FEATURE.
208800     MOVE "START-TEST-GF-29"  TO PAR-NAME.
208900     IF      FILESTATUS (2)  EQUAL TO "**"
209000             PERFORM DE-LETE
209100             GO TO  START-WRITE-GF-29.
209200*
209300*  START-TEST-GF-29  - THIS TEST CHECKS THE FILE STATUS CONTENTS
209400*                    RESULTING FROM START-TEST-GF-20.  THE FILE
209500*                    STATUS CONTENTS IS EXPECTED TO BE "00"
209600*
209700     IF      FILESTATUS (2) EQUAL TO "00"
209800             PERFORM  PASS
209900             ELSE  PERFORM  FAIL
210000         MOVE "FROM START-TEST-GF-20; IX-3 1.3.4 (1) A" TO RE-MARK
210100             MOVE    "00"  TO CORRECT-A
210200             MOVE   FILESTATUS (2)  TO COMPUTED-A.
210300 START-WRITE-GF-29.
210400     PERFORM  PRINT-DETAIL.
210500 START-TEST-GF-30.
210600     MOVE "FILE STATUS START:00"  TO FEATURE.
210700     MOVE "START-TEST-GF-30"  TO PAR-NAME.
210800     IF      FILESTATUS (3)  EQUAL TO "**"
210900             PERFORM DE-LETE
211000             GO TO  START-WRITE-GF-30.
211100*
211200*  START-TEST-GF-30  - THIS TEST CHECKS THE FILE STATUS CONTENTS
211300*                    RESULTING FROM START-TEST-GF-21.  THE FILE
211400*                    STATUS CONTENTS IS EXPECTED TO BE "00"
211500*
211600     IF      FILESTATUS (3) EQUAL TO "00"
211700             PERFORM  PASS
211800             ELSE  PERFORM  FAIL
211900         MOVE "FROM START-TEST-GF-21; IX-3 1.3.4 (1) A" TO RE-MARK
212000             MOVE    "00"  TO CORRECT-A
212100             MOVE   FILESTATUS (3)  TO COMPUTED-A.
212200 START-WRITE-GF-30.
212300     PERFORM  PRINT-DETAIL.
212400 START-TEST-GF-31.
212500     MOVE "FILE STATUS START:23"  TO FEATURE.
212600     MOVE "START-TEST-GF-31"  TO PAR-NAME.
212700     IF      FILESTATUS (4)  EQUAL TO "**"
212800             PERFORM DE-LETE
212900             GO TO  START-WRITE-GF-31.
213000*
213100*  START-TEST-GF-31  - THIS TEST CHECKS THE FILE STATUS CONTENTS
213200*                    RESULTING FROM START-TEST-GF-22.  THE FILE
213300*                    STATUS CONTENTS IS EXPECTED TO BE "23".
213400*
213500     IF      FILESTATUS (4)  EQUAL TO "23"
213600             PERFORM  PASS
213700             ELSE  PERFORM  FAIL
213800         MOVE "FROM START-TEST-GF-22; IX-4 1.3.4 (3) C" TO RE-MARK
213900             MOVE    "23"  TO CORRECT-A
214000             MOVE   FILESTATUS (4)  TO COMPUTED-A.
214100 START-WRITE-GF-31.
214200     PERFORM  PRINT-DETAIL.
214300 START-TEST-GF-32.
214400     MOVE "FILE STATUS START:00"  TO FEATURE.
214500     MOVE "START-TEST-GF-32"  TO PAR-NAME.
214600     IF      FILESTATUS (5)  EQUAL TO "**"
214700             PERFORM DE-LETE
214800             GO TO  START-WRITE-GF-32.
214900*
215000*  START-TEST-GF.05  - THIS TEST CHECKS THE FILE STATUS CONTENTS
215100*                    RESULTING FROM START-TEST-GF-23.  THE FILE
215200*                    STATUS CONTENTS IS EXPECTED TO BE "00"
215300*
215400     IF      FILESTATUS (5)  EQUAL TO "00"
215500             PERFORM  PASS
215600             ELSE  PERFORM  FAIL
215700         MOVE "FROM START-TEST-GF-23; IX-3 1.3.4 (1) A" TO RE-MARK
215800             MOVE    "00"  TO CORRECT-A
215900             MOVE   FILESTATUS (5)  TO COMPUTED-A.
216000 START-WRITE-GF-32.
216100     PERFORM  PRINT-DETAIL.
216200 START-TEST-GF-33.
216300     MOVE "FILE STATUS START:00"  TO FEATURE.
216400     MOVE "START-TEST-GF-33"  TO PAR-NAME.
216500     IF      FILESTATUS (6)  EQUAL TO "**"
216600             PERFORM DE-LETE
216700             GO TO  START-WRITE-GF-33.
216800*
216900*  START-TEST-GF-33  - THIS TEST CHECKS THE FILE STATUS CONTENTS
217000*                    RESULTING FROM START-TEST-GF-24.  THE FILE
217100*                    STATUS CONTENTS IS EXPECTED TO BE "00"
217200*
217300     IF      FILESTATUS (6)  EQUAL TO "00"
217400             PERFORM  PASS
217500             ELSE  PERFORM  FAIL
217600         MOVE "FROM START-TEST-GF-24; IX-3 1.3.4 (1) A" TO RE-MARK
217700             MOVE   "00"  TO CORRECT-A
217800             MOVE   FILESTATUS (6)  TO COMPUTED-A.
217900 START-WRITE-GF-33.
218000     PERFORM  PRINT-DETAIL.
218100 START-TEST-GF-34.
218200     MOVE "FILE STATUS START:00"  TO FEATURE.
218300     MOVE "START-TEST-GF-34"  TO PAR-NAME.
218400     IF      FILESTATUS (7)  EQUAL TO "**"
218500             PERFORM DE-LETE
218600             GO TO  START-WRITE-GF-34.
218700*
218800*  START-TEST-GF-34  - THIS TEST CHECKS THE FILE STATUS CONTENTS
218900*                    RESULTING FROM START-TEST-GF-25.  THE FILE
219000*                    STATUS CONTENTS IS EXPECTED TO BE "23"
219100*
219200     IF      FILESTATUS (7)  EQUAL TO "23"
219300             PERFORM  PASS
219400             ELSE  PERFORM  FAIL
219500         MOVE "FROM START-TEST-GF-25; IX-4 1.3.4 (3) C" TO RE-MARK
219600             MOVE    "23"  TO CORRECT-A
219700             MOVE   FILESTATUS (7)  TO COMPUTED-A.
219800 START-WRITE-GF-34.
219900     PERFORM  PRINT-DETAIL.
220000 START-TEST-GF-35.
220100     MOVE "FILE STATUS START:00"  TO FEATURE.
220200     MOVE "START-TEST-GF-35"  TO PAR-NAME.
220300     IF      FILESTATUS (8)  EQUAL TO "**"
220400             PERFORM DE-LETE
220500             GO TO  START-WRITE-GF-35.
220600*
220700*  START-TEST-GF-35  - THIS TEST CHECKS THE FILE STATUS CONTENTS
220800*                    RESULTING FROM START-TEST-GF-26.  THE FILE
220900*                    STATUS CONTENTS IS EXPECTED TO BE "00"
221000*
221100     IF      FILESTATUS (8) EQUAL TO "00"
221200             PERFORM  PASS
221300             ELSE  PERFORM  FAIL
221400         MOVE "FROM START-TEST-GF-26; IX-3 1.3.4 (1) A" TO RE-MARK
221500             MOVE    "00"  TO CORRECT-A
221600             MOVE   FILESTATUS (8)  TO COMPUTED-A.
221700 START-WRITE-GF-35.
221800     PERFORM  PRINT-DETAIL.
221900 START-TEST-GF-36.
222000     MOVE "FILE STATUS START:23"  TO FEATURE.
222100     MOVE "START-TEST-GF-36"  TO PAR-NAME.
222200     IF      FILESTATUS (9)  EQUAL TO "**"
222300             PERFORM DE-LETE
222400             GO TO  START-WRITE-GF-36.
222500*
222600*  START-TEST-GF-36  - THIS TEST CHECKS THE FILE STATUS CONTENTS
222700*                    RESULTING FROM START-TEST-GF-27.  THE FILE
222800*                    STATUS CONTENTS IS EXPECTED TO BE "23".
222900*
223000     IF      FILESTATUS (9)  EQUAL TO "23"
223100             PERFORM PASS
223200     ELSE    PERFORM FAIL
223300         MOVE "FROM START-TEST-GF-27; IX-4 1.3.4 (3) C" TO RE-MARK
223400             MOVE  "23"  TO CORRECT-A
223500             MOVE   FILESTATUS (9)  TO COMPUTED-A.
223600 START-WRITE-GF-36.
223700     PERFORM  PRINT-DETAIL.
223800
223900
224000 START-INIT-GF-SERIES.
224100     OPEN  I-O   IX-FS1.
224200     MOVE     "START SERIES" TO FEATURE.
224300     MOVE    "START-TEST-GF-37" TO PAR-NAME.
224400     MOVE    ZERO TO INVKEY-COUNTER.
224500*
224600*    THIS TEST EXECUTES SEVERAL START STATEMENTS USING DIFFERENT
224700*    KEY VALUES.  FOLLOWING EXECUTION OF THE LAST START
224800*    STATEMENT THE READ STATEMENT IS EXECUTED.  THE START
224900*    STATEMENT SHOULD HAVE POSITION THE RECORD POINTER
225000*    SUCH THAT RECORD NUMBER 49 IS MADE AVAILABLE FOLLOWING
225100*    EXECUTION OF THE READ STATEMENT.  THE KEY OF REFERENCE
225200*    SHOULD BE ALTERNATE-KEY-2.
225300*
225400 START-TEST-GF-37.
225500     MOVE    "FGGGGGGGGG098"  TO FS1-RECKEY-1-13.
225600     MOVE    "WWWWWWWXXX366ALTKEY1"  TO FS1-ALTKEY1-1-20.
225700     MOVE    "RRRRRRRRRR300ALTKEY2"  TO FS1-ALTKEY2-1-20.
225800     MOVE    WRK-FS1-RECKEY TO IX-REC-KEY-AREA.
225900     MOVE    WRK-FS1-ALTKEY1 TO IX-ALT-KEY1-AREA.
226000     MOVE    WRK-FS1-ALTKEY2 TO IX-ALT-KEY2-AREA.
226100     START   IX-FS1
226200                     KEY IS EQUAL TO IX-FS1-ALTKEY2
226300                       INVALID KEY ADD 1  TO INVKEY-COUNTER.
226400     START   IX-FS1
226500                      INVALID KEY  ADD  01  TO INVKEY-COUNTER.
226600     START   IX-FS1
226700                    KEY IS NOT LESS THAN R-ALTKEY1-1-6
226800                       INVALID KEY ADD 1  TO INVKEY-COUNTER.
226900     START   IX-FS1
227000                     KEY IS GREATER THAN IX-FS1-ALTKEY2-1-5
227100                       INVALID KEY ADD 1  TO INVKEY-COUNTER.
227200     READ    IX-FS1  AT END
227300                     MOVE  "AT END ON READ"  TO COMPUTED-A
227400                     GO TO  START-FAIL-GF-37.
227500     MOVE    IX-FS1R1-F-G-240 TO FILE-RECORD-INFO (1).
227600     IF      XRECORD-NUMBER (1) EQUAL TO 49
227700             PERFORM  PASS
227800             MOVE    "MULTIPLE STARTS BEFORE READ " TO RE-MARK
227900             GO TO  START-EXIT-GF-37.
228000     MOVE    49   TO RECNO.
228100     PERFORM   DISPLAY-ALTERNATE-KEY2.
228200 START-FAIL-GF-37.
228300     PERFORM FAIL.
228400     MOVE    49  TO CORRECT-18V0.
228500     MOVE "AFTER MULTIPLE STARTS; IX-36 ETC " TO RE-MARK.
228600     GO TO START-EXIT-GF-37.
228700 START-DELETE-GF-37.
228800     PERFORM DE-LETE.
228900 START-EXIT-GF-37.
229000     PERFORM  PRINT-DETAIL.
229100     CLOSE   IX-FS1.
229200 START-CLOSE-FILES.
229300     GO TO   START-TEST-COMPLETE.
229400 START-INITIALIZE-RECORD.
229500     MOVE    "**"  TO FS1-STATUS.
229600     MOVE    "GGGGGGGGGG200" TO  FS1-RECKEY-1-13.
229700     MOVE    ZERO  TO INIT-FLAG.
229800     MOVE    9999  TO XRECORD-NUMBER (1).
229900     MOVE    SPACE TO IX-FS1R1-F-G-240.
230000     MOVE    WRK-FS1-RECKEY TO IX-REC-KEY-AREA.
230100     START   IX-FS1
230200                     KEY IS EQUAL TO IX-FS1-KEY
230300          INVALID KEY MOVE  1  TO INIT-FLAG.
230400     READ    IX-FS1  INTO  FILE-RECORD-INFO (1)
230500                     AT END  MOVE  1 TO INIT-FLAG.
230600     IF      XRECORD-NUMBER (1) NOT EQUAL TO 100
230700             MOVE 1 TO INIT-FLAG.
230800 DISPLAY-RECORD-KEYS.
230900     MOVE    XRECORD-KEY (1)  TO WRK-FS1-RECKEY.
231000     MOVE    FS1-RECKEY-1-13  TO COMPUTED-A.
231100     MOVE    RECKEY-VALUE (RECNO)  TO CORRECT-A.
231200     MOVE    SPACE TO P-OR-F.
231300     MOVE    "RECORD KEY VALUES" TO RE-MARK.
231400     PERFORM PRINT-DETAIL.
231500 DISPLAY-ALTERNATE-KEY1.
231600     MOVE    ALTERNATE-KEY1 (1)  TO WRK-FS1-ALTKEY1.
231700     MOVE    FS1-ALTKEY1-1-20  TO COMPUTED-A.
231800     MOVE    ALTKEY1-VALUE (RECNO)  TO CORRECT-A.
231900     MOVE    SPACE TO P-OR-F.
232000     MOVE    "ALTERNATE RECORD KEY1 VALUES"  TO RE-MARK.
232100     PERFORM PRINT-DETAIL.
232200 DISPLAY-ALTERNATE-KEY2.
232300     MOVE    ALTERNATE-KEY2 (1) TO WRK-FS1-ALTKEY2.
232400     MOVE    FS1-ALTKEY2-1-20  TO COMPUTED-A.
232500     MOVE    ALTKEY2-VALUE (RECNO)  TO CORRECT-A.
232600     MOVE    SPACE TO P-OR-F.
232700     MOVE    "ALTERNATE RECORD KEY2 VALUES"  TO RE-MARK.
232800     PERFORM PRINT-DETAIL.
232900 START-TEST-COMPLETE.
233000     EXIT.
233100 CCVS-EXIT SECTION.
233200 CCVS-999999.
233300     GO TO CLOSE-FILES.
