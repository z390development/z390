000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RL106A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*GENERAL:    THIS PROGRAM PROCESSES THREE RLEATIVE I-O FILES
001400*            IDENTIFIED AS RL-FR4,RL-FR5 AND RL-FR6.  THE FUNCTION
001500*            OF THIS PROGRAM IS TO CREATE THREE RELATIVE FILES
001600*            RANDOMLLY (ACCESS MODE RANDOM) AND VERIFY THAT THEY
001700*            WERE CREATED CORRECTLY.  THE FILES PROCESSED
001800*            CONTAIN VARIABLE LENGTH RECORDS.
001900*
002000*            X-CARD PARAMETERS WHICH MUST BE SUPPLIED FOR THIS
002100*            PROGRAM ARE:
002200*
002300*                 X-21   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
002400*                         RELATIVE  I-O DATA FILE-1
002500*                 X-22   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
002600*                         RELATIVE  I-O DATA FILE-2
002700*                 X-23   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
002800*                         RELATIVE  I-O DATA FILE-3
002900*                 X-55   SYSTEM PRINTER
003000*                 X-69   ADDITIONAL VALUE OF CLAUSES
003100*                 X-74   VALUE OF IMPLEMENTOR-NAME
003200*                 X-75   OBJECT OF VALUE OF CLAUSE FOR FILE-1
003300*                 X-76   OBJECT OF VALUE OF CLAUSE FOR FILE-2
003400*                 X-77   OBJECT OF VALUE OF CLAUSE FOR FILE-3
003500*                 X-82   SOURCE-COMPUTER
003600*                 X-83   OBJECT-COMPUTER.
003700*
003800****************************************************************
003900 ENVIRONMENT DIVISION.
004000 CONFIGURATION SECTION.
004100 SOURCE-COMPUTER.
004200     XXXXX082.
004300 OBJECT-COMPUTER.
004400     XXXXX083.
004500 INPUT-OUTPUT SECTION.
004600 FILE-CONTROL.
004700     SELECT PRINT-FILE ASSIGN TO
004800     XXXXX055.
004900     SELECT RL-FR4 ASSIGN TO
005000     XXXXX021
005100             ORGANIZATION IS RELATIVE
005200             ACCESS  MODE IS RANDOM
005300              RELATIVE KEY IS KEY-1.
005400     SELECT RL-FR5 ASSIGN TO
005500     XXXXX022
005600             ORGANIZATION IS RELATIVE
005700             ACCESS  MODE IS RANDOM
005800              RELATIVE KEY IS KEY-2.
005900     SELECT RL-FR6 ASSIGN TO
006000     XXXXX023
006100             ORGANIZATION IS RELATIVE
006200             ACCESS  MODE IS RANDOM
006300              RELATIVE KEY IS KEY-3.
006400 I-O-CONTROL.
006500     SAME RL-FR5 RL-FR6.
006600 DATA DIVISION.
006700 FILE SECTION.
006800 FD  PRINT-FILE.
006900 01  PRINT-REC PICTURE X(120).
007000 01  DUMMY-RECORD PICTURE X(120).
007100 FD  RL-FR4
007200C    VALUE OF
007300C    XXXXX074
007400C    IS
007500C    XXXXX075
007600G    XXXXX069
007700     LABEL RECORDS ARE STANDARD
007800     DATA RECORDS ARE GRP-1SEQ-RECORD-4A  GRP-1SEQ-RECORD-4B.
007900 01  GRP-1SEQ-RECORD-4A.
008000     02  FILLER-4A               PICTURE X(56).
008100 01  GRP-1SEQ-RECORD-4B.
008200     02  FILLER-4B               PICTURE X(56).
008300     02  LONG-REC-4B.
008400         03  FILLER              PICTURE X(15).
008500         03  REC-NUMBER-4B       PIC XX.
008600         03  FILLER              PICTURE X(27).
008700 FD  RL-FR5
008800     RECORD CONTAINS 56 TO 101 CHARACTERS
008900C    VALUE OF
009000C    XXXXX074
009100C    IS
009200C    XXXXX076
009300G    XXXXX069
009400     LABEL RECORDS ARE STANDARD
009500     DATA RECORDS  GRP-1SEQ-RECORD-5A  GRP-1SEQ-RECORD-5B.
009600 01  GRP-1SEQ-RECORD-5A.
009700     02  FILLER-5A               PICTURE X(56).
009800 01  GRP-1SEQ-RECORD-5B.
009900     02  FILLER-5B               PICTURE X(56).
010000     02  LONG-REC-5B.
010100         03  FILLER              PICTURE X(15).
010200         03  REC-NUMBER-5B       PIC XX.
010300         03  FILLER              PICTURE X(28).
010400 FD  RL-FR6
010500     BLOCK 3 RECORDS
010600     RECORD CONTAINS 56 TO 102 CHARACTERS
010700     LABEL RECORD STANDARD
010800C    VALUE OF
010900C    XXXXX074
011000C    IS
011100C    XXXXX077
011200     DATA RECORD  GRP-1SEQ-RECORD-6A  GRP-1SEQ-RECORD-6B.
011300 01  GRP-1SEQ-RECORD-6A.
011400     02  FILLER-6A               PICTURE X(56).
011500 01  GRP-1SEQ-RECORD-6B.
011600     02  FILLER-6B               PICTURE X(56).
011700     02  LONG-REC-6B.
011800         03  FILLER              PICTURE X(15).
011900         03  REC-NUMBER-6B       PIC XX.
012000         03  FILLER              PICTURE X(29).
012100 WORKING-STORAGE SECTION.
012200 77  SUB-1                        PICTURE 99.
012300 77  KEY-1
012400         PICTURE   9(5).
012500 77  KEY-2
012600         PICTURE   9(5).
012700 77  KEY-3
012800         PICTURE   9(5).
012900 01  READ-WRITE-COUNTER.
013000     02  ENTRY-RW OCCURS 20 TIMES  PICTURE X.
013100 01  RECORD-BUILD.
013200     02  FILLER                  PICTURE X(27)  VALUE
013300     " TYPE OF RECORD WRITTEN IS ".
013400     02  RECORD-LONG-OR-SHORT    PICTURE X(5) VALUE "SHORT".
013500     02  FILLER                  PICTURE X(24) VALUE SPACE.
013600     02  RECORD-LONG-ONLY.
013700         03  FILLER              PICTURE X(15)  VALUE
013800         " RECORD NUMBER ".
013900         03  POS-NUM2            PICTURE 99.
014000         03  FILLER-LONG         PICTURE X(29)  VALUE
014100         " AREA USED FOR LONG RECORD ".
014200 01  FILE-RECORD-INFORMATION-REC.
014300     03 FILE-RECORD-INFO-SKELETON.
014400        05 FILLER                 PICTURE X(48)       VALUE
014500             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
014600        05 FILLER                 PICTURE X(46)       VALUE
014700             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
014800        05 FILLER                 PICTURE X(26)       VALUE
014900             ",LFIL=000000,ORG=  ,LBLR= ".
015000        05 FILLER                 PICTURE X(37)       VALUE
015100             ",RECKEY=                             ".
015200        05 FILLER                 PICTURE X(38)       VALUE
015300             ",ALTKEY1=                             ".
015400        05 FILLER                 PICTURE X(38)       VALUE
015500             ",ALTKEY2=                             ".
015600        05 FILLER                 PICTURE X(7)        VALUE SPACE.
015700     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
015800        05 FILE-RECORD-INFO-P1-120.
015900           07 FILLER              PIC X(5).
016000           07 XFILE-NAME           PIC X(6).
016100           07 FILLER              PIC X(8).
016200           07 XRECORD-NAME         PIC X(6).
016300           07 FILLER              PIC X(1).
016400           07 REELUNIT-NUMBER     PIC 9(1).
016500           07 FILLER              PIC X(7).
016600           07 XRECORD-NUMBER       PIC 9(6).
016700           07 FILLER              PIC X(6).
016800           07 UPDATE-NUMBER       PIC 9(2).
016900           07 FILLER              PIC X(5).
017000           07 ODO-NUMBER          PIC 9(4).
017100           07 FILLER              PIC X(5).
017200           07 XPROGRAM-NAME        PIC X(5).
017300           07 FILLER              PIC X(7).
017400           07 XRECORD-LENGTH       PIC 9(6).
017500           07 FILLER              PIC X(7).
017600           07 CHARS-OR-RECORDS    PIC X(2).
017700           07 FILLER              PIC X(1).
017800           07 XBLOCK-SIZE          PIC 9(4).
017900           07 FILLER              PIC X(6).
018000           07 RECORDS-IN-FILE     PIC 9(6).
018100           07 FILLER              PIC X(5).
018200           07 XFILE-ORGANIZATION   PIC X(2).
018300           07 FILLER              PIC X(6).
018400           07 XLABEL-TYPE          PIC X(1).
018500        05 FILE-RECORD-INFO-P121-240.
018600           07 FILLER              PIC X(8).
018700           07 XRECORD-KEY          PIC X(29).
018800           07 FILLER              PIC X(9).
018900           07 ALTERNATE-KEY1      PIC X(29).
019000           07 FILLER              PIC X(9).
019100           07 ALTERNATE-KEY2      PIC X(29).
019200           07 FILLER              PIC X(7).
019300 01  TEST-RESULTS.
019400     02 FILLER                   PIC X      VALUE SPACE.
019500     02 FEATURE                  PIC X(20)  VALUE SPACE.
019600     02 FILLER                   PIC X      VALUE SPACE.
019700     02 P-OR-F                   PIC X(5)   VALUE SPACE.
019800     02 FILLER                   PIC X      VALUE SPACE.
019900     02  PAR-NAME.
020000       03 FILLER                 PIC X(19)  VALUE SPACE.
020100       03  PARDOT-X              PIC X      VALUE SPACE.
020200       03 DOTVALUE               PIC 99     VALUE ZERO.
020300     02 FILLER                   PIC X(8)   VALUE SPACE.
020400     02 RE-MARK                  PIC X(61).
020500 01  TEST-COMPUTED.
020600     02 FILLER                   PIC X(30)  VALUE SPACE.
020700     02 FILLER                   PIC X(17)  VALUE
020800            "       COMPUTED=".
020900     02 COMPUTED-X.
021000     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
021100     03 COMPUTED-N               REDEFINES COMPUTED-A
021200                                 PIC -9(9).9(9).
021300     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
021400     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
021500     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
021600     03       CM-18V0 REDEFINES COMPUTED-A.
021700         04 COMPUTED-18V0                    PIC -9(18).
021800         04 FILLER                           PIC X.
021900     03 FILLER PIC X(50) VALUE SPACE.
022000 01  TEST-CORRECT.
022100     02 FILLER PIC X(30) VALUE SPACE.
022200     02 FILLER PIC X(17) VALUE "       CORRECT =".
022300     02 CORRECT-X.
022400     03 CORRECT-A                  PIC X(20) VALUE SPACE.
022500     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
022600     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
022700     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
022800     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
022900     03      CR-18V0 REDEFINES CORRECT-A.
023000         04 CORRECT-18V0                     PIC -9(18).
023100         04 FILLER                           PIC X.
023200     03 FILLER PIC X(2) VALUE SPACE.
023300     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
023400 01  CCVS-C-1.
023500     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
023600-    "SS  PARAGRAPH-NAME
023700-    "       REMARKS".
023800     02 FILLER                     PIC X(20)    VALUE SPACE.
023900 01  CCVS-C-2.
024000     02 FILLER                     PIC X        VALUE SPACE.
024100     02 FILLER                     PIC X(6)     VALUE "TESTED".
024200     02 FILLER                     PIC X(15)    VALUE SPACE.
024300     02 FILLER                     PIC X(4)     VALUE "FAIL".
024400     02 FILLER                     PIC X(94)    VALUE SPACE.
024500 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
024600 01  REC-CT                        PIC 99       VALUE ZERO.
024700 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
024800 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
024900 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
025000 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
025100 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
025200 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
025300 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
025400 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
025500 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
025600 01  CCVS-H-1.
025700     02  FILLER                    PIC X(39)    VALUE SPACES.
025800     02  FILLER                    PIC X(42)    VALUE
025900     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
026000     02  FILLER                    PIC X(39)    VALUE SPACES.
026100 01  CCVS-H-2A.
026200   02  FILLER                        PIC X(40)  VALUE SPACE.
026300   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
026400   02  FILLER                        PIC XXXX   VALUE
026500     "4.2 ".
026600   02  FILLER                        PIC X(28)  VALUE
026700            " COPY - NOT FOR DISTRIBUTION".
026800   02  FILLER                        PIC X(41)  VALUE SPACE.
026900
027000 01  CCVS-H-2B.
027100   02  FILLER                        PIC X(15)  VALUE
027200            "TEST RESULT OF ".
027300   02  TEST-ID                       PIC X(9).
027400   02  FILLER                        PIC X(4)   VALUE
027500            " IN ".
027600   02  FILLER                        PIC X(12)  VALUE
027700     " HIGH       ".
027800   02  FILLER                        PIC X(22)  VALUE
027900            " LEVEL VALIDATION FOR ".
028000   02  FILLER                        PIC X(58)  VALUE
028100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
028200 01  CCVS-H-3.
028300     02  FILLER                      PIC X(34)  VALUE
028400            " FOR OFFICIAL USE ONLY    ".
028500     02  FILLER                      PIC X(58)  VALUE
028600     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
028700     02  FILLER                      PIC X(28)  VALUE
028800            "  COPYRIGHT   1985 ".
028900 01  CCVS-E-1.
029000     02 FILLER                       PIC X(52)  VALUE SPACE.
029100     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
029200     02 ID-AGAIN                     PIC X(9).
029300     02 FILLER                       PIC X(45)  VALUE SPACES.
029400 01  CCVS-E-2.
029500     02  FILLER                      PIC X(31)  VALUE SPACE.
029600     02  FILLER                      PIC X(21)  VALUE SPACE.
029700     02 CCVS-E-2-2.
029800         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
029900         03 FILLER                   PIC X      VALUE SPACE.
030000         03 ENDER-DESC               PIC X(44)  VALUE
030100            "ERRORS ENCOUNTERED".
030200 01  CCVS-E-3.
030300     02  FILLER                      PIC X(22)  VALUE
030400            " FOR OFFICIAL USE ONLY".
030500     02  FILLER                      PIC X(12)  VALUE SPACE.
030600     02  FILLER                      PIC X(58)  VALUE
030700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
030800     02  FILLER                      PIC X(13)  VALUE SPACE.
030900     02 FILLER                       PIC X(15)  VALUE
031000             " COPYRIGHT 1985".
031100 01  CCVS-E-4.
031200     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
031300     02 FILLER                       PIC X(4)   VALUE " OF ".
031400     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
031500     02 FILLER                       PIC X(40)  VALUE
031600      "  TESTS WERE EXECUTED SUCCESSFULLY".
031700 01  XXINFO.
031800     02 FILLER                       PIC X(19)  VALUE
031900            "*** INFORMATION ***".
032000     02 INFO-TEXT.
032100       04 FILLER                     PIC X(8)   VALUE SPACE.
032200       04 XXCOMPUTED                 PIC X(20).
032300       04 FILLER                     PIC X(5)   VALUE SPACE.
032400       04 XXCORRECT                  PIC X(20).
032500     02 INF-ANSI-REFERENCE           PIC X(48).
032600 01  HYPHEN-LINE.
032700     02 FILLER  PIC IS X VALUE IS SPACE.
032800     02 FILLER  PIC IS X(65)    VALUE IS "************************
032900-    "*****************************************".
033000     02 FILLER  PIC IS X(54)    VALUE IS "************************
033100-    "******************************".
033200 01  CCVS-PGM-ID                     PIC X(9)   VALUE
033300     "RL106A".
033400 PROCEDURE DIVISION.
033500 CCVS1 SECTION.
033600 OPEN-FILES.
033700     OPEN    OUTPUT PRINT-FILE.
033800     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
033900     MOVE    SPACE TO TEST-RESULTS.
034000     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
034100     MOVE    ZERO TO REC-SKL-SUB.
034200     PERFORM CCVS-INIT-FILE 9 TIMES.
034300 CCVS-INIT-FILE.
034400     ADD     1 TO REC-SKL-SUB.
034500     MOVE    FILE-RECORD-INFO-SKELETON
034600          TO FILE-RECORD-INFO (REC-SKL-SUB).
034700 CCVS-INIT-EXIT.
034800     GO TO CCVS1-EXIT.
034900 CLOSE-FILES.
035000     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
035100 TERMINATE-CCVS.
035200S    EXIT PROGRAM.
035300STERMINATE-CALL.
035400     STOP     RUN.
035500 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
035600 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
035700 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
035800 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
035900     MOVE "****TEST DELETED****" TO RE-MARK.
036000 PRINT-DETAIL.
036100     IF REC-CT NOT EQUAL TO ZERO
036200             MOVE "." TO PARDOT-X
036300             MOVE REC-CT TO DOTVALUE.
036400     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
036500     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
036600        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
036700          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
036800     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
036900     MOVE SPACE TO CORRECT-X.
037000     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
037100     MOVE     SPACE TO RE-MARK.
037200 HEAD-ROUTINE.
037300     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037400     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037500     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
037600     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
037700 COLUMN-NAMES-ROUTINE.
037800     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037900     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
038100 END-ROUTINE.
038200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
038300 END-RTN-EXIT.
038400     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038500 END-ROUTINE-1.
038600      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
038700      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
038800      ADD PASS-COUNTER TO ERROR-HOLD.
038900*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
039000      MOVE PASS-COUNTER TO CCVS-E-4-1.
039100      MOVE ERROR-HOLD TO CCVS-E-4-2.
039200      MOVE CCVS-E-4 TO CCVS-E-2-2.
039300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
039400  END-ROUTINE-12.
039500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
039600     IF       ERROR-COUNTER IS EQUAL TO ZERO
039700         MOVE "NO " TO ERROR-TOTAL
039800         ELSE
039900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
040000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
040100     PERFORM WRITE-LINE.
040200 END-ROUTINE-13.
040300     IF DELETE-COUNTER IS EQUAL TO ZERO
040400         MOVE "NO " TO ERROR-TOTAL  ELSE
040500         MOVE DELETE-COUNTER TO ERROR-TOTAL.
040600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
040700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
040800      IF   INSPECT-COUNTER EQUAL TO ZERO
040900          MOVE "NO " TO ERROR-TOTAL
041000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
041100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
041200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
041300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
041400 WRITE-LINE.
041500     ADD 1 TO RECORD-COUNT.
041600Y    IF RECORD-COUNT GREATER 50
041700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
041800Y        MOVE SPACE TO DUMMY-RECORD
041900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
042000Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
042100Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
042200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
042300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
042400Y        MOVE ZERO TO RECORD-COUNT.
042500     PERFORM WRT-LN.
042600 WRT-LN.
042700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
042800     MOVE SPACE TO DUMMY-RECORD.
042900 BLANK-LINE-PRINT.
043000     PERFORM WRT-LN.
043100 FAIL-ROUTINE.
043200     IF     COMPUTED-X NOT EQUAL TO SPACE
043300            GO TO   FAIL-ROUTINE-WRITE.
043400     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
043500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
043600     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
043700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043800     MOVE   SPACES TO INF-ANSI-REFERENCE.
043900     GO TO  FAIL-ROUTINE-EX.
044000 FAIL-ROUTINE-WRITE.
044100     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
044200     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
044300     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
044400     MOVE   SPACES TO COR-ANSI-REFERENCE.
044500 FAIL-ROUTINE-EX. EXIT.
044600 BAIL-OUT.
044700     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
044800     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
044900 BAIL-OUT-WRITE.
045000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
045100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
045200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045300     MOVE   SPACES TO INF-ANSI-REFERENCE.
045400 BAIL-OUT-EX. EXIT.
045500 CCVS1-EXIT.
045600     EXIT.
045700 SECT-RC106-001 SECTION.
045800 SECT-RC-02-001-INIT.
045900     MOVE 1 TO KEY-1  POS-NUM2.
046000     MOVE SPACE TO READ-WRITE-COUNTER.
046100     MOVE "R/W REL LENGTH RECS" TO FEATURE.
046200 REL-TEST-8.
046300     OPEN OUTPUT RL-FR4.
046400     MOVE RECORD-BUILD TO GRP-1SEQ-RECORD-4B.
046500     WRITE GRP-1SEQ-RECORD-4A INVALID KEY GO TO INVALID-TEST-8.
046600     MOVE "W" TO ENTRY-RW (POS-NUM2).
046700     ADD 1 TO POS-NUM2.
046800     MOVE POS-NUM2 TO KEY-1.
046900     MOVE RECORD-BUILD TO GRP-1SEQ-RECORD-4B.
047000     WRITE GRP-1SEQ-RECORD-4A INVALID KEY GO TO INVALID-TEST-8.
047100     MOVE "W" TO ENTRY-RW (POS-NUM2).
047200     ADD 1 TO POS-NUM2.
047300     MOVE POS-NUM2 TO KEY-1.
047400     MOVE "LONG "  TO RECORD-LONG-OR-SHORT.
047500     MOVE RECORD-BUILD TO GRP-1SEQ-RECORD-4B.
047600     WRITE GRP-1SEQ-RECORD-4B INVALID KEY GO TO INVALID-TEST-8.
047700     MOVE "W" TO ENTRY-RW (POS-NUM2).
047800     ADD 1 TO POS-NUM2.
047900     MOVE POS-NUM2 TO KEY-1.
048000     MOVE RECORD-BUILD TO GRP-1SEQ-RECORD-4B.
048100     WRITE GRP-1SEQ-RECORD-4B INVALID KEY GO TO INVALID-TEST-8.
048200     MOVE "W" TO ENTRY-RW (POS-NUM2).
048300     ADD 1 TO POS-NUM2.
048400     MOVE POS-NUM2 TO KEY-1.
048500     MOVE "SHORT" TO RECORD-LONG-OR-SHORT.
048600     PERFORM WRITE-FOR-TEST-8 THRU 8-EXIT 11 TIMES.
048700     MOVE RECORD-BUILD TO GRP-1SEQ-RECORD-4B.
048800     WRITE GRP-1SEQ-RECORD-4A INVALID KEY GO TO INVALID-TEST-8.
048900     MOVE "W" TO ENTRY-RW (POS-NUM2).
049000     ADD 1 TO POS-NUM2.
049100     MOVE POS-NUM2 TO KEY-1.
049200     MOVE RECORD-BUILD TO GRP-1SEQ-RECORD-4B.
049300     WRITE GRP-1SEQ-RECORD-4A INVALID KEY GO TO INVALID-TEST-8.
049400     MOVE "W" TO ENTRY-RW (POS-NUM2).
049500     ADD 1 TO POS-NUM2.
049600     MOVE POS-NUM2 TO KEY-1.
049700     MOVE "LONG " TO RECORD-LONG-OR-SHORT.
049800     MOVE RECORD-BUILD TO GRP-1SEQ-RECORD-4B.
049900     WRITE GRP-1SEQ-RECORD-4B INVALID KEY GO TO INVALID-TEST-8.
050000     MOVE "W" TO ENTRY-RW (POS-NUM2).
050100     MOVE SPACE  TO CORRECT-A  COMPUTED-A.
050200     MOVE SPACE TO P-OR-F.
050300     IF READ-WRITE-COUNTER NOT EQUAL TO "WWWWWWWWWWWWWWWWWW  "
050400         MOVE READ-WRITE-COUNTER TO COMPUTED-A ELSE
050500     MOVE "18 RECORDS PASSED TO TEST-9" TO RE-MARK.
050600     GO TO REL-TEST-8-WRITE.
050700 REL-DELETE-8.
050800     PERFORM DE-LETE.
050900*NOTE  RL-FR4  IS NOT CREATED  -  SO SKIP TO REL-TEST-11.
051000     MOVE "REL-TEST-8         " TO PAR-NAME.
051100     PERFORM PRINT-DETAIL.
051200     GO TO REL-TEST-11.
051300 INVALID-TEST-8.
051400     MOVE "I" TO ENTRY-RW (POS-NUM2).
051500     MOVE READ-WRITE-COUNTER TO COMPUTED-A.
051600     PERFORM FAIL.
051700     MOVE "INVALID KEY ON WRITE " TO RE-MARK.
051800 REL-TEST-8-WRITE.
051900     MOVE "REL-TEST-8         " TO PAR-NAME.
052000     PERFORM PRINT-DETAIL.
052100     CLOSE RL-FR4.
052200*
052300     GO TO INIT-TEST-9.
052400 WRITE-FOR-TEST-8.
052500     MOVE RECORD-BUILD TO GRP-1SEQ-RECORD-4B.
052600     WRITE GRP-1SEQ-RECORD-4A INVALID KEY GO TO I-KEY-8.
052700     MOVE "W" TO ENTRY-RW (POS-NUM2).
052800     ADD 1 TO POS-NUM2.
052900     MOVE POS-NUM2 TO KEY-1.
053000     GO TO 8-EXIT.
053100 I-KEY-8.
053200     MOVE "INVALID KEY ON WRITE " TO RE-MARK.
053300     MOVE "I" TO ENTRY-RW (POS-NUM2).
053400     ADD 1 TO POS-NUM2.
053500     MOVE POS-NUM2 TO KEY-1.
053600     PERFORM FAIL.
053700 8-EXIT.
053800     EXIT.
053900 INIT-TEST-9.
054000     OPEN INPUT RL-FR4.
054100     MOVE 01 TO SUB-1  KEY-1.
054200     MOVE SPACE TO READ-WRITE-COUNTER.
054300 REL-TEST-9.
054400     READ RL-FR4 INVALID KEY
054500         MOVE "E" TO ENTRY-RW (SUB-1)
054600         GO TO COMPARE-FOR-TEST-9.
054700     IF SUB-1 EQUAL TO 19
054800         GO TO COMPARE-FOR-TEST-9.
054900     MOVE "R" TO ENTRY-RW (SUB-1).
055000     ADD 1 TO SUB-1.
055100     MOVE SUB-1 TO KEY-1.
055200     GO TO REL-TEST-9.
055300 COMPARE-FOR-TEST-9.
055400     IF READ-WRITE-COUNTER EQUAL TO "RRRRRRRRRRRRRRRRRRE "
055500         PERFORM PASS
055600         GO TO REL-TEST-9-WRITE.
055700     MOVE "RRRRRRRRRRRRRRRRRRE " TO CORRECT-A.
055800     MOVE READ-WRITE-COUNTER TO COMPUTED-A.
055900     PERFORM FAIL.
056000     MOVE "INCORRECT NUMBER OF READS  " TO RE-MARK.
056100 REL-TEST-9-WRITE.
056200     MOVE "REL-TEST-9         " TO PAR-NAME.
056300     PERFORM PRINT-DETAIL.
056400     CLOSE RL-FR4.
056500 INIT-TEST-10.
056600     OPEN INPUT RL-FR4.
056700     MOVE 10 TO SUB-1  KEY-1.
056800 REL-TEST-10.
056900     READ RL-FR4 INVALID KEY
057000         MOVE "***INVALID KEY***" TO COMPUTED-A
057100         MOVE SPACE TO CORRECT-A
057200         MOVE "INVAILD KEY RL-FR4  " TO RE-MARK
057300         PERFORM FAIL
057400         GO TO REL-TEST-10-WRITE.
057500*    NOTE  *** IF REC-NUMBER-4B CONTAINS THE RECORD NUMBER
057600*          THEN FIXED LENGTH RECORDS WERE WRITTEN INSTEAD
057700*          OF VARIABLE LENGTH RECORDS.
057800*    NOTE  CHECK LENGTH OF RECORD 10.
057900 COMPARE-FOR-TEST-10.
058000     IF REC-NUMBER-4B EQUAL TO "10"
058100          MOVE "FIXED LENGTH RECORDS" TO COMPUTED-A.
058200 REL-TEST-10-WRITE.
058300     CLOSE RL-FR4.
058400     MOVE "INFO ONLY-SEE PROGRAM" TO RE-MARK.
058500     MOVE "REL-TEST-10        " TO PAR-NAME.
058600     PERFORM PRINT-DETAIL.
058700     MOVE SPACE TO READ-WRITE-COUNTER.
058800     MOVE 1 TO KEY-2  POS-NUM2.
058900 REL-TEST-11.
059000     OPEN OUTPUT RL-FR5.
059100     PERFORM REL-TEST-11-SHORT-REC  2 TIMES.
059200     PERFORM REL-TEST-11-LONG-REC 2 TIMES.
059300     PERFORM REL-TEST-11-SHORT-REC 4 TIMES.
059400     PERFORM REL-TEST-11-LONG-REC 2 TIMES.
059500     MOVE SPACE TO COMPUTED-A  CORRECT-A.
059600     MOVE "10 RECORDS PASSED  TEST-12" TO RE-MARK.
059700     GO TO REL-TEST-11-WRITE.
059800 REL-DELETE-11.
059900     PERFORM DE-LETE.
060000*    NOTE RL-FR5 IS NOT CREATED  SO SKIP TO REL-TEST-15.
060100     MOVE "REL-TEST-11        " TO PAR-NAME.
060200     PERFORM PRINT-DETAIL.
060300     GO TO REL-TEST-15.
060400 REL-TEST-11-LONG-REC.
060500     MOVE "LONG " TO RECORD-LONG-OR-SHORT.
060600     MOVE RECORD-BUILD TO GRP-1SEQ-RECORD-5B.
060700     WRITE GRP-1SEQ-RECORD-5B INVALID KEY GO TO I-KEY-11.
060800     MOVE "W" TO ENTRY-RW (POS-NUM2).
060900     ADD 1 TO POS-NUM2.
061000     MOVE POS-NUM2 TO KEY-2.
061100 REL-TEST-11-SHORT-REC.
061200     MOVE "SHORT" TO RECORD-LONG-OR-SHORT.
061300     MOVE RECORD-BUILD TO GRP-1SEQ-RECORD-5B.
061400     WRITE GRP-1SEQ-RECORD-5A INVALID KEY GO TO I-KEY-11.
061500     MOVE "W" TO ENTRY-RW (POS-NUM2).
061600     ADD 1 TO POS-NUM2.
061700     MOVE POS-NUM2 TO KEY-2.
061800 I-KEY-11.
061900     MOVE "INVALID KEY ON WRITE " TO RE-MARK.
062000     PERFORM FAIL.
062100     MOVE "I" TO ENTRY-RW (POS-NUM2).
062200     MOVE READ-WRITE-COUNTER TO COMPUTED-A.
062300 REL-TEST-11-WRITE.
062400     CLOSE RL-FR5.
062500     MOVE "REL-TEST-11        " TO PAR-NAME.
062600     PERFORM PRINT-DETAIL.
062700*
062800 INIT-TEST-12.
062900     OPEN INPUT RL-FR5.
063000     MOVE 01 TO SUB-1  KEY-2.
063100     MOVE SPACE TO READ-WRITE-COUNTER.
063200 REL-TEST-12.
063300     READ RL-FR5 INVALID KEY
063400         MOVE "E" TO ENTRY-RW (SUB-1)
063500         GO TO COMPARE-FOR-TEST-12.
063600     MOVE "R" TO ENTRY-RW (SUB-1).
063700     IF SUB-1 EQUAL TO 11
063800         GO TO COMPARE-FOR-TEST-12.
063900     ADD 1 TO SUB-1.
064000*    NOTE  BLANK OUT GARBAGE IN INPUT AREA.
064100*    MOVE SPACE TO GRP-1SEQ-RECORD-5B.
064200     MOVE SUB-1 TO KEY-2.
064300     GO TO REL-TEST-12.
064400 COMPARE-FOR-TEST-12.
064500     IF READ-WRITE-COUNTER EQUAL TO "RRRRRRRRRRE"
064600         PERFORM PASS
064700         GO TO REL-TEST-12-WRITE.
064800     MOVE "RRRRRRRRRRE" TO CORRECT-A.
064900     MOVE READ-WRITE-COUNTER TO COMPUTED-A.
065000     PERFORM FAIL.
065100 REL-TEST-12-WRITE.
065200     MOVE "REL-TEST-12        " TO PAR-NAME.
065300     PERFORM PRINT-DETAIL.
065400     CLOSE RL-FR5.
065500 INIT-TEST-13.
065600     OPEN INPUT RL-FR5.
065700     MOVE 05 TO SUB-1  KEY-2.
065800 READ-FOR-TEST-13.
065900     READ RL-FR5 INVALID KEY
066000         MOVE "***INVALID KEY***" TO COMPUTED-A
066100         MOVE SPACE TO CORRECT-A
066200         MOVE "INVALID KEY RL-FR5 " TO RE-MARK
066300         PERFORM FAIL
066400         GO TO REL-TEST-13-WRITE.
066500*    NOTE  *** IF REC-NUMBER-5B CONTAINS THE RECORD NUMBER
066600*          THEN FIXED LENGTH RECORDS WERE WRITTEN INSTEAD
066700*          OF VARIABLE LENGTH RECORDS.
066800*    NOTE CHECK LENGTH OF RECORD 5.
066900 REL-TEST-13.
067000     IF REC-NUMBER-5B EQUAL TO "05"
067100         MOVE "FIXED LENGTH RECORDS" TO COMPUTED-A.
067200 REL-TEST-13-WRITE.
067300     MOVE "INFO ONLY-SEE PROGRAM" TO RE-MARK.
067400     MOVE "REL-TEST-13        " TO PAR-NAME.
067500     PERFORM PRINT-DETAIL.
067600     MOVE 6 TO KEY-2.
067700 REL-TEST-14.
067800     READ RL-FR5 INVALID KEY
067900         MOVE "***INVALID KEY***" TO COMPUTED-A
068000         MOVE SPACE TO CORRECT-A
068100         MOVE "INVALID KEY ON RECORD 6 " TO RE-MARK
068200         PERFORM FAIL
068300         GO TO REL-TEST-14-WRITE.
068400*    NOTE  CHECK LENGTH OF RECORD 6.
068500     IF REC-NUMBER-5B EQUAL TO "06"
068600         MOVE "FIXED LENGTH RECORDS" TO COMPUTED-A.
068700 REL-TEST-14-WRITE.
068800     MOVE "INFO ONLY-SEE PROGRAM" TO RE-MARK.
068900     MOVE "REL-TEST-14        " TO PAR-NAME.
069000     PERFORM PRINT-DETAIL.
069100     MOVE SPACE TO READ-WRITE-COUNTER.
069200 INIT-TEST-15.
069300     CLOSE RL-FR5.
069400     MOVE 1 TO KEY-1  KEY-2  KEY-3  POS-NUM2.
069500 REL-TEST-15.
069600     OPEN OUTPUT RL-FR6.
069700     PERFORM REL-TEST-12-SHORT-REC 3 TIMES.
069800     PERFORM REL-TEST-12-LONG-REC 2 TIMES.
069900     PERFORM REL-TEST-12-SHORT-REC.
070000     PERFORM REL-TEST-12-LONG-REC 2 TIMES.
070100     PERFORM REL-TEST-12-SHORT-REC 3 TIMES.
070200     PERFORM REL-TEST-12-LONG-REC.
070300     MOVE SPACE TO COMPUTED-A  CORRECT-A.
070400     MOVE "12 RECORDS PASSED  TEST-16" TO RE-MARK.
070500     GO TO REL-TEST-15-WRITE.
070600 REL-DELETE-15.
070700     PERFORM DE-LETE.
070800     MOVE "REL-TEST-15        " TO PAR-NAME.
070900*    NOTE  THIS IS THE FINAL SERIES OF TESTS,  IF THESE ARE
071000*          DELETED, THE PROGRAM IS AT AN END  SO,
071100*          SKIP TO      END-PARAGRAPH.
071200     PERFORM  PRINT-DETAIL.
071300     GO TO    CCVS-EXIT.
071400 REL-TEST-12-LONG-REC.
071500     MOVE "LONG " TO RECORD-LONG-OR-SHORT.
071600     MOVE RECORD-BUILD TO GRP-1SEQ-RECORD-6B.
071700     WRITE GRP-1SEQ-RECORD-6B INVALID KEY GO TO I-KEY-15.
071800     MOVE "W" TO ENTRY-RW (POS-NUM2).
071900     ADD 1 TO POS-NUM2.
072000     MOVE POS-NUM2 TO KEY-3.
072100 REL-TEST-12-SHORT-REC.
072200     MOVE "SHORT" TO RECORD-LONG-OR-SHORT.
072300     MOVE RECORD-BUILD TO GRP-1SEQ-RECORD-6B.
072400     WRITE GRP-1SEQ-RECORD-6A INVALID KEY GO TO I-KEY-15.
072500     MOVE "W" TO ENTRY-RW (POS-NUM2).
072600     ADD 1 TO POS-NUM2.
072700     MOVE POS-NUM2 TO KEY-3.
072800 I-KEY-15.
072900     MOVE "INVALID KEY ON WRITE "   TO RE-MARK
073000     PERFORM FAIL.
073100     MOVE "I" TO ENTRY-RW (POS-NUM2).
073200     MOVE READ-WRITE-COUNTER TO COMPUTED-A.
073300 REL-TEST-15-WRITE.
073400     MOVE "REL-TEST-15        " TO PAR-NAME.
073500     PERFORM PRINT-DETAIL.
073600     CLOSE RL-FR6.
073700*
073800 INIT-TEST-16.
073900     OPEN INPUT RL-FR6.
074000     MOVE 01 TO SUB-1  KEY-3.
074100 REL-TEST-16.
074200     READ RL-FR6 INVALID KEY
074300         MOVE "***INVALID KEY***" TO COMPUTED-A
074400         MOVE SPACE TO CORRECT-A
074500         MOVE "INVALID KEY ON RANDOM-FILE3" TO RE-MARK
074600         PERFORM FAIL
074700         GO TO REL-TEST-16-WRITE.
074800     IF SUB-1 EQUAL TO 7
074900         GO TO COMPARE-FOR-TEST-16.
075000     ADD 1 TO SUB-1.
075100     MOVE SUB-1 TO KEY-3.
075200     GO TO REL-TEST-16.
075300 COMPARE-FOR-TEST-16.
075400     IF REC-NUMBER-6B EQUAL TO "07"
075500         PERFORM PASS
075600         GO TO REL-TEST-16-WRITE.
075700     MOVE "RECORD 07 EXPECTED" TO CORRECT-A.
075800     MOVE SPACE TO FILLER-LONG.
075900     MOVE RECORD-LONG-ONLY TO COMPUTED-A.
076000     MOVE "COMPUTED-A SHOWS REC READ" TO RE-MARK.
076100     PERFORM FAIL.
076200 REL-TEST-16-WRITE.
076300     MOVE "REL-TEST-16        " TO PAR-NAME.
076400     PERFORM PRINT-DETAIL.
076500 INIT-TEST-17.
076600     MOVE 01 TO SUB-1  KEY-3.
076700 READ-FOR-TEST-17.
076800     READ RL-FR6 INVALID KEY
076900         MOVE "***INVALID KEY***" TO COMPUTED-A
077000         MOVE SPACE TO CORRECT-A
077100         MOVE "INVALID KEY RL-FR6 " TO RE-MARK
077200         PERFORM FAIL
077300         GO TO REL-TEST-17-WRITE.
077400     IF SUB-1 EQUAL TO 02
077500         GO TO REL-TEST-17.
077600     ADD 1 TO SUB-1.
077700     MOVE SUB-1 TO KEY-3.
077800     GO TO READ-FOR-TEST-17.
077900 REL-TEST-17.
078000     IF REC-NUMBER-6B EQUAL TO "02"
078100        MOVE "FIXED LENGTH RECORDS" TO COMPUTED-A.
078200         GO TO REL-TEST-17-WRITE.
078300*    NOTE CHECK LENGTH OF RECORD 2.
078400*    NOTE  *** IF REC-NUMBER-6B CONTAINS THE RECORD NUMBER
078500*          THEN FIXED LENGTH RECORDS WERE WRITTEN INSTEAD
078600*          OF VARIABLE LENGTH RECORDS.
078700 REL-TEST-17-WRITE.
078800     MOVE "INFO ONLY-SEE PROGRAM" TO RE-MARK.
078900     MOVE "REL-TEST-17        " TO PAR-NAME.
079000     PERFORM PRINT-DETAIL.
079100 INIT-TEST-18.
079200     MOVE 12 TO SUB-1  KEY-3.
079300 READ-FOR-TEST-18.
079400     READ RL-FR6 INVALID KEY
079500         MOVE "***INVALID KEY***" TO COMPUTED-A
079600         MOVE "RECORD 12 IS MISSING" TO CORRECT-A
079700         MOVE "ATTEMPT TO READ LAST RECORD" TO RE-MARK
079800         PERFORM FAIL
079900         GO TO REL-TEST-18-WRITE.
080000*    NOTE  *** RECORD 12 WAS A LONG RECORD AND
080100*          REC-NUMBER-6B SHOULD CONTAIN 12.
080200 REL-TEST-18.
080300     IF REC-NUMBER-6B EQUAL TO "12"
080400          PERFORM PASS
080500         GO TO REL-TEST-18-WRITE.
080600     MOVE "WRONG LENGTH RECORD" TO COMPUTED-A.
080700             PERFORM FAIL.
080800 REL-TEST-18-WRITE.
080900     MOVE "REL-TEST-18        " TO PAR-NAME.
081000     PERFORM PRINT-DETAIL.
081100     CLOSE RL-FR6.
081200 CCVS-EXIT SECTION.
081300 CCVS-999999.
081400     GO TO CLOSE-FILES.
