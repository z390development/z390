000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     DB103M.
000400 AUTHOR.
000500     FEDERAL COMPILER TESTING CENTER.
000600 INSTALLATION.
000700     GENERAL SERVICES ADMINISTRATION
000800     AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
000900     SOFTWARE DEVELOPMENT OFFICE.
001000     5203 LEESBURG PIKE  SUITE 1100
001100     FALLS CHURCH VIRGINIA 22041.
001200
001300     PHONE   (703) 756-6153
001400
001500     " HIGH       ".
001600 DATE-WRITTEN.
001700     CCVS-74 VERSION 4.0 - 1980 JULY 1.
001800     CREATION DATE     /    VALIDATION DATE
001900     "4.2 ".
002000 SECURITY.
002100     NONE.
002200*
002300*    *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
002400*
002500*                       PROGRAM ABSTRACT
002600*
002700*    DB103M TESTS THE BASIC OPERATION OF DEBUG MODULE FACILITIES
002800*    WHEN THE COMPILE TIME DEBUGGING SWITCH IS OFF.  ALL DEBUG
002900*    LINES  SHOULD BE TREATED AS COMMENTS AND NO CODE SHOULD
003000*    BE GENERATED FOR EITHER DEBUG LINES OR DEBUGGING PROCED-
003100*    URES.
003200*
003300*    THE OBJECT PROGRAM FOR DB103M SHOULD BE EXECUTED TWICE;ONCE
003400*    WITH THE OBJECT TIME DEBUGGING SWITCH ENABLED (ON), AND ONCE
003500*    WITH THE OBJECT TIME DEBUGGING SWITCH DISABLED (OFF).  BOTH
003600*    EXECUTION RUNS SHOULD YIELD THE SAME RESULTS AS THE SETTING
003700*    OF THE OBJECT TIME DEBUGGING SWITCH SHOULD MAKE NO DIFFER-
003800*    ENCE SINCE THE COMPILE TIME DEBUGGING SWITCH WAS INITIALLY
003900*    DISABLED.
004000*
004100*
004200 ENVIRONMENT DIVISION.
004300 CONFIGURATION SECTION.
004400 SOURCE-COMPUTER.
004500     XXXXX082.
004600 OBJECT-COMPUTER.
004700     XXXXX083.
004800 INPUT-OUTPUT SECTION.
004900 FILE-CONTROL.
005000     SELECT PRINT-FILE ASSIGN TO
005100     XXXXX055.
005200 DATA DIVISION.
005300 FILE SECTION.
005400 FD  PRINT-FILE
005500     LABEL RECORDS
005600     XXXXX084
005700     DATA RECORD IS PRINT-REC DUMMY-RECORD.
005800 01  PRINT-REC PICTURE X(120).
005900 01  DUMMY-RECORD PICTURE X(120).
006000 WORKING-STORAGE SECTION.
006100 77  A PIC 9 COMP VALUE 1.
006200 77  B PIC 9 COMP VALUE 5.
006300 77  C PIC 9 COMP VALUE 9.
006400 77  D PIC 99 COMP.
006500 77  RESULT-FLAG PIC 99 COMP VALUE 0.
006600 77  DBLINE-HOLD PIC X(6).
006700 77  DBNAME-HOLD PIC X(30).
006800 77  DBCONT-HOLD PIC X(30).
006900 77  FIVE PIC 9 COMP VALUE 5.
007000 01  SIZE-19.
007100     02  FILLER PIC X.
007200     02  SIZE-18.
007300         03  FILLER PIC X.
007400         03  SIZE-17.
007500             04  FILLER PIC X.
007600             04  SIZE-16.
007700                 05  FILLER PIC X.
007800                 05  SIZE-15.
007900                     06  FILLER PIC X.
008000                     06  SIZE-14.
008100                         07  FILLER PIC X.
008200                         07  SIZE-13.
008300                             08  FILLER PIC X.
008400                             08  SIZE-12.
008500                                 09  FILLER PIC X.
008600                                 09  SIZE-11.
008700                                     10  FILLER PIC X.
008800                                     10  SIZE-10 PIC X(10).
008900 01  TEST-RESULTS.
009000     02 FILLER                    PICTURE X VALUE SPACE.
009100     02 FEATURE                   PICTURE X(20) VALUE SPACE.
009200     02 FILLER                    PICTURE X VALUE SPACE.
009300     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
009400     02 FILLER                    PICTURE X  VALUE SPACE.
009500     02  PAR-NAME.
009600       03 FILLER PICTURE X(12) VALUE SPACE.
009700       03  PARDOT-X PICTURE X  VALUE SPACE.
009800       03 DOTVALUE PICTURE 99  VALUE ZERO.
009900       03 FILLER PIC X(5) VALUE SPACE.
010000     02 FILLER PIC X(10) VALUE SPACE.
010100     02 RE-MARK PIC X(61).
010200 01  TEST-COMPUTED.
010300     02 FILLER PIC X(30) VALUE SPACE.
010400     02 FILLER PIC X(17) VALUE "       COMPUTED=".
010500     02 COMPUTED-X.
010600     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
010700     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
010800     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
010900     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
011000     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
011100     03       CM-18V0 REDEFINES COMPUTED-A.
011200         04 COMPUTED-18V0                   PICTURE -9(18).
011300         04 FILLER                          PICTURE X.
011400     03 FILLER PIC X(50) VALUE SPACE.
011500 01  TEST-CORRECT.
011600     02 FILLER PIC X(30) VALUE SPACE.
011700     02 FILLER PIC X(17) VALUE "       CORRECT =".
011800     02 CORRECT-X.
011900     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
012000     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
012100     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
012200     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
012300     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
012400     03      CR-18V0 REDEFINES CORRECT-A.
012500         04 CORRECT-18V0                    PICTURE -9(18).
012600         04 FILLER                          PICTURE X.
012700     03 FILLER PIC X(50) VALUE SPACE.
012800 01  CCVS-C-1.
012900     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
013000-    "SS  PARAGRAPH-NAME
013100-    "        REMARKS".
013200     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
013300 01  CCVS-C-2.
013400     02 FILLER PICTURE IS X VALUE IS SPACE.
013500     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
013600     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
013700     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
013800     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
013900 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
014000 01  REC-CT PICTURE 99 VALUE ZERO.
014100 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
014200 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
014300 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
014400 01  PASS-COUNTER PIC 999 VALUE ZERO.
014500 01  TOTAL-ERROR PIC 999 VALUE ZERO.
014600 01  ERROR-HOLD PIC 999 VALUE ZERO.
014700 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
014800 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
014900 01  CCVS-H-1.
015000     02  FILLER   PICTURE X(27)  VALUE SPACE.
015100     02 FILLER PICTURE X(67) VALUE
015200     " FEDERAL COMPILER TESTING CENTER COBOL COMPILER VALIDATION
015300-    " SYSTEM".
015400     02  FILLER     PICTURE X(26)  VALUE SPACE.
015500 01  CCVS-H-2.
015600     02 FILLER PICTURE X(52) VALUE IS
015700     "CCVS74 NCC  COPY, NOT FOR DISTRIBUTION.".
015800     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
015900     02 TEST-ID PICTURE IS X(9).
016000     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
016100 01  CCVS-H-3.
016200     02  FILLER PICTURE X(34) VALUE
016300     " FOR OFFICIAL USE ONLY    ".
016400     02  FILLER PICTURE X(58) VALUE
016500     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
016600     02  FILLER PICTURE X(28) VALUE
016700     "  COPYRIGHT   1974 ".
016800 01  CCVS-E-1.
016900     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
017000     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
017100     02 ID-AGAIN PICTURE IS X(9).
017200     02 FILLER PICTURE X(45) VALUE IS
017300     " NTIS DISTRIBUTION COBOL 74".
017400 01  CCVS-E-2.
017500     02  FILLER                   PICTURE X(31)  VALUE
017600     SPACE.
017700     02  FILLER                   PICTURE X(21)  VALUE SPACE.
017800     02 CCVS-E-2-2.
017900         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
018000         03 FILLER PICTURE IS X VALUE IS SPACE.
018100         03 ENDER-DESC PIC X(44) VALUE "ERRORS ENCOUNTERED".
018200 01  CCVS-E-3.
018300     02  FILLER PICTURE X(22) VALUE
018400     " FOR OFFICIAL USE ONLY".
018500     02  FILLER PICTURE X(12) VALUE SPACE.
018600     02  FILLER PICTURE X(58) VALUE
018700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
018800     02  FILLER PICTURE X(13) VALUE SPACE.
018900     02 FILLER PIC X(15) VALUE " COPYRIGHT 1974".
019000 01  CCVS-E-4.
019100     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
019200     02 FILLER PIC XXXX VALUE " OF ".
019300     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
019400     02 FILLER PIC X(40) VALUE
019500      "  TESTS WERE EXECUTED SUCCESSFULLY".
019600 01  XXINFO.
019700     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
019800     02 INFO-TEXT.
019900     04 FILLER PIC X(20) VALUE SPACE.
020000     04 XXCOMPUTED PIC X(20).
020100     04 FILLER PIC X(5) VALUE SPACE.
020200     04 XXCORRECT PIC X(20).
020300 01  HYPHEN-LINE.
020400     02 FILLER PICTURE IS X VALUE IS SPACE.
020500     02 FILLER PICTURE IS X(65) VALUE IS "************************
020600-    "*****************************************".
020700     02 FILLER PICTURE IS X(54) VALUE IS "************************
020800-    "******************************".
020900 01  CCVS-PGM-ID PIC X(6) VALUE
021000     "DB103M".
021100 PROCEDURE DIVISION.
021200 DECLARATIVES.
021300 START-UP SECTION.
021400     USE FOR DEBUGGING ON OPEN-FILES.
021500 BEGIN-START-UP.
021600     MOVE 1 TO RESULT-FLAG.
021700 DB-COMMON.
021800     MOVE DEBUG-LINE TO DBLINE-HOLD.
021900     MOVE DEBUG-NAME TO DBNAME-HOLD.
022000     MOVE DEBUG-CONTENTS TO DBCONT-HOLD.
022100 FALL-THROUGH-AND-SERIES SECTION.
022200     USE FOR DEBUGGING ON FALL-THROUGH-TEST
022300              PROC-SERIES-TEST.
022400 BEGIN-FALL-THROUGH-AND-SERIES.
022500     PERFORM DB-COMMON.
022600     MOVE 2 TO RESULT-FLAG.
022700 GO-TO SECTION.
022800     USE FOR DEBUGGING ON GO-TO-TEST.
022900 BEGIN-GO-TO.
023000     PERFORM DB-COMMON.
023100     MOVE 3 TO RESULT-FLAG.
023200 ALTER-PARAGRAPH SECTION.
023300     USE FOR DEBUGGING ON ALTERABLE-PARAGRAPH.
023400 BEGIN-ALTER-PARAGRAPH.
023500     PERFORM DB-COMMON.
023600     MOVE 4 TO RESULT-FLAG.
023700 LOOP-ITERATION SECTION.
023800     USE FOR DEBUGGING ON LOOP-ROUTINE.
023900 BEGIN-LOOP-ITERATION.
024000     PERFORM DB-COMMON.
024100     ADD 1 TO RESULT-FLAG.
024200 PERFORM-THRU SECTION.
024300     USE FOR DEBUGGING ON DO-NOTHING-1.
024400 BEGIN-PERFORM-THRU.
024500     PERFORM DB-COMMON.
024600     ADD 1 TO RESULT-FLAG.
024700 END DECLARATIVES.
024800 CCVS1 SECTION.
024900 OPEN-FILES.
025000     OPEN     OUTPUT PRINT-FILE.
025100     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
025200     MOVE    SPACE TO TEST-RESULTS.
025300     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
025400     GO TO CCVS1-EXIT.
025500 CLOSE-FILES.
025600     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
025700 TERMINATE-CCVS.
025800S    EXIT PROGRAM.
025900STERMINATE-CALL.
026000     STOP     RUN.
026100 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
026200 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
026300 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
026400 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
026500     MOVE "****TEST DELETED****" TO RE-MARK.
026600 PRINT-DETAIL.
026700     IF REC-CT NOT EQUAL TO ZERO
026800             MOVE "." TO PARDOT-X
026900             MOVE REC-CT TO DOTVALUE.
027000     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
027100     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
027200        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
027300          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
027400     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
027500     MOVE SPACE TO CORRECT-X.
027600     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
027700     MOVE     SPACE TO RE-MARK.
027800 HEAD-ROUTINE.
027900     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028000     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
028100     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
028200 COLUMN-NAMES-ROUTINE.
028300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
028600 END-ROUTINE.
028700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
028800 END-RTN-EXIT.
028900     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029000 END-ROUTINE-1.
029100      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
029200      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
029300      ADD PASS-COUNTER TO ERROR-HOLD.
029400*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
029500      MOVE PASS-COUNTER TO CCVS-E-4-1.
029600      MOVE ERROR-HOLD TO CCVS-E-4-2.
029700      MOVE CCVS-E-4 TO CCVS-E-2-2.
029800      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
029900  END-ROUTINE-12.
030000      MOVE "TEST(S) FAILED" TO ENDER-DESC.
030100     IF       ERROR-COUNTER IS EQUAL TO ZERO
030200         MOVE "NO " TO ERROR-TOTAL
030300         ELSE
030400         MOVE ERROR-COUNTER TO ERROR-TOTAL.
030500     MOVE     CCVS-E-2 TO DUMMY-RECORD.
030600     PERFORM WRITE-LINE.
030700 END-ROUTINE-13.
030800     IF DELETE-CNT IS EQUAL TO ZERO
030900         MOVE "NO " TO ERROR-TOTAL  ELSE
031000         MOVE DELETE-CNT TO ERROR-TOTAL.
031100     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
031200     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031300      IF   INSPECT-COUNTER EQUAL TO ZERO
031400          MOVE "NO " TO ERROR-TOTAL
031500      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
031600      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
031700      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031800     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031900 WRITE-LINE.
032000     ADD 1 TO RECORD-COUNT.
032100Y    IF RECORD-COUNT GREATER 50
032200Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
032300Y        MOVE SPACE TO DUMMY-RECORD
032400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
032500Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
032600Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
032700Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
032800Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
032900Y        MOVE ZERO TO RECORD-COUNT.
033000     PERFORM WRT-LN.
033100 WRT-LN.
033200     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
033300     MOVE SPACE TO DUMMY-RECORD.
033400 BLANK-LINE-PRINT.
033500     PERFORM WRT-LN.
033600 FAIL-ROUTINE.
033700     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
033800     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
033900     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
034000     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034100     GO TO FAIL-ROUTINE-EX.
034200 FAIL-ROUTINE-WRITE.
034300     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
034400     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
034500 FAIL-ROUTINE-EX. EXIT.
034600 BAIL-OUT.
034700     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
034800     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
034900 BAIL-OUT-WRITE.
035000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
035100     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035200 BAIL-OUT-EX. EXIT.
035300 CCVS1-EXIT.
035400     EXIT.
035500 START-PROGRAM-TEST.
035600     IF RESULT-FLAG IS NOT EQUAL TO 0
035700         MOVE "USE PROCEDURE EXECUTED" TO RE-MARK
035800         PERFORM FAIL
035900         PERFORM START-PROGRAM-WRITE
036000         ELSE PERFORM PASS
036100         GO TO START-PROGRAM-WRITE.
036200     MOVE "DEBUG-LINE; SEE NEXT LINE" TO RE-MARK.
036300     MOVE "<===  DEBUG-LINE" TO CORRECT-A.
036400     MOVE DBLINE-HOLD TO COMPUTED-A.
036500     PERFORM START-PROGRAM-WRITE.
036600     MOVE "DEBUG-NAME; SEE NEXT LINE" TO RE-MARK.
036700     MOVE "<===  DEBUG-NAME" TO CORRECT-A.
036800     MOVE DBNAME-HOLD TO COMPUTED-A.
036900     PERFORM START-PROGRAM-WRITE.
037000     MOVE "DEBUG-CONTENTS; SEE NEXT LINE" TO RE-MARK.
037100     MOVE "<===  DEBUG-CONTENTS" TO CORRECT-A.
037200     MOVE DBCONT-HOLD TO COMPUTED-A.
037300     GO TO   START-PROGRAM-WRITE.
037400 START-PROGRAM-DELETE.
037500     PERFORM DE-LETE.
037600 START-PROGRAM-WRITE.
037700     MOVE "DEBUG ON PROC-NAME" TO FEATURE.
037800     MOVE "START-PROGRAM-TEST" TO PAR-NAME.
037900     PERFORM PRINT-DETAIL.
038000     MOVE 0 TO RESULT-FLAG.
038100 FALL-THROUGH-TEST.
038200     IF RESULT-FLAG IS NOT EQUAL TO 0
038300         MOVE "USE PROCEDURE EXECUTED" TO RE-MARK
038400         PERFORM FAIL
038500         PERFORM FALL-THROUGH-WRITE
038600         ELSE PERFORM PASS
038700         GO TO FALL-THROUGH-WRITE.
038800     MOVE "DEBUG-LINE; SEE NEXT LINE" TO RE-MARK.
038900     MOVE "<===  DEBUG-LINE" TO CORRECT-A.
039000     MOVE DBLINE-HOLD TO COMPUTED-A.
039100     PERFORM FALL-THROUGH-WRITE.
039200     MOVE "DEBUG-NAME; SEE NEXT LINE" TO RE-MARK.
039300     MOVE "<===  DEBUG-NAME" TO CORRECT-A.
039400     MOVE DBNAME-HOLD TO COMPUTED-A.
039500     PERFORM FALL-THROUGH-WRITE.
039600     MOVE "DEBUG-CONTENTS; SEE NEXT LINE" TO RE-MARK.
039700     MOVE "<===  DEBUG-CONTENTS" TO CORRECT-A.
039800     MOVE DBCONT-HOLD TO COMPUTED-A.
039900     GO TO   FALL-THROUGH-WRITE.
040000 FALL-THROUGH-DELETE.
040100     PERFORM DE-LETE.
040200 FALL-THROUGH-WRITE.
040300     MOVE "DEBUG ON PROC-NAME" TO FEATURE.
040400     MOVE "FALL-THROUGH-TEST" TO PAR-NAME.
040500     PERFORM PRINT-DETAIL.
040600     MOVE 0 TO RESULT-FLAG.
040700 PROC-SERIES-TEST.
040800     IF RESULT-FLAG IS NOT EQUAL TO 0
040900         MOVE "USE PROCEDURE EXECUTED" TO RE-MARK
041000         PERFORM FAIL
041100         PERFORM PROC-SERIES-WRITE
041200         ELSE PERFORM PASS
041300         GO TO PROC-SERIES-WRITE.
041400     MOVE "DEBUG-LINE; SEE NEXT LINE" TO RE-MARK.
041500     MOVE "<===  DEBUG-LINE" TO CORRECT-A.
041600     MOVE DBLINE-HOLD TO COMPUTED-A.
041700     PERFORM PROC-SERIES-WRITE.
041800     MOVE "DEBUG-NAME; SEE NEXT LINE" TO RE-MARK.
041900     MOVE "<===  DEBUG-NAME" TO CORRECT-A.
042000     MOVE DBNAME-HOLD TO COMPUTED-A.
042100     PERFORM PROC-SERIES-WRITE.
042200     MOVE "DEBUG-CONTENTS; SEE NEXT LINE" TO RE-MARK.
042300     MOVE "<===  DEBUG-CONTENTS" TO CORRECT-A.
042400     MOVE DBCONT-HOLD TO COMPUTED-A.
042500     GO TO   PROC-SERIES-WRITE.
042600 PROC-SERIES-DELETE.
042700     PERFORM DE-LETE.
042800 PROC-SERIES-WRITE.
042900     MOVE "DEBUG ON PROC-NAME" TO FEATURE.
043000     MOVE "PROC-SERIES-TEST" TO PAR-NAME.
043100     PERFORM PRINT-DETAIL.
043200     MOVE 0 TO RESULT-FLAG.
043300 ALTERABLE-PARAGRAPH.
043400     GO TO GO-TO-TEST.
043500 FILLER-PARAGRAPH.
043600     DISPLAY "ALTER FAILED AT ALTER-TEST-INIT".
043700     PERFORM FAIL.
043800     GO TO ALTERED-GO-TO-TEST.
043900 GO-TO-TEST.
044000     IF RESULT-FLAG IS NOT EQUAL TO 0
044100         MOVE "USE PROCEDURE EXECUTED" TO RE-MARK
044200         PERFORM FAIL
044300         PERFORM GO-TO-WRITE
044400         ELSE PERFORM PASS
044500         GO TO GO-TO-WRITE.
044600     MOVE "DEBUG-LINE; SEE NEXT LINE" TO RE-MARK.
044700     MOVE "<===  DEBUG-LINE" TO CORRECT-A.
044800     MOVE DBLINE-HOLD TO COMPUTED-A.
044900     PERFORM GO-TO-WRITE.
045000     MOVE "DEBUG-NAME; SEE NEXT LINE" TO RE-MARK.
045100     MOVE "<===  DEBUG-NAME" TO CORRECT-A.
045200     MOVE DBNAME-HOLD TO COMPUTED-A.
045300     PERFORM GO-TO-WRITE.
045400     MOVE "DEBUG-CONTENTS; SEE NEXT LINE" TO RE-MARK.
045500     MOVE "<===  DEBUG-CONTENTS" TO CORRECT-A.
045600     MOVE DBCONT-HOLD TO COMPUTED-A.
045700     GO TO   GO-TO-WRITE.
045800 GO-TO-DELETE.
045900     PERFORM DE-LETE.
046000 GO-TO-WRITE.
046100     MOVE "DEBUG ON PROC-NAME" TO FEATURE.
046200     MOVE "GO-TO-TEST" TO PAR-NAME.
046300     PERFORM PRINT-DETAIL.
046400     MOVE 0 TO RESULT-FLAG.
046500 ALTER-TEST-INIT.
046600     ALTER ALTERABLE-PARAGRAPH TO PROCEED TO ALTERED-GO-TO-TEST.
046700 ALTER-TEST.
046800     IF RESULT-FLAG IS NOT EQUAL TO 0
046900         MOVE "USE PROCEDURE EXECUTED" TO RE-MARK
047000         PERFORM FAIL
047100         PERFORM ALTER-WRITE
047200         ELSE PERFORM PASS
047300         GO TO ALTER-WRITE.
047400     MOVE "DEBUG-LINE; SEE NEXT LINE" TO RE-MARK.
047500     MOVE "<===  DEBUG-LINE" TO CORRECT-A.
047600     MOVE DBLINE-HOLD TO COMPUTED-A.
047700     PERFORM ALTER-WRITE.
047800     MOVE "DEBUG-NAME; SEE NEXT LINE" TO RE-MARK.
047900     MOVE "<===  DEBUG-NAME" TO CORRECT-A.
048000     MOVE DBNAME-HOLD TO COMPUTED-A.
048100     PERFORM ALTER-WRITE.
048200     MOVE "DEBUG-CONTENTS; SEE NEXT LINE" TO RE-MARK.
048300     MOVE "<===  DEBUG-CONTENTS" TO CORRECT-A.
048400     MOVE DBCONT-HOLD TO COMPUTED-A.
048500     GO TO   ALTER-WRITE.
048600 ALTER-DELETE.
048700     PERFORM DE-LETE.
048800 ALTER-WRITE.
048900     MOVE "DEBUG ON PROC-NAME" TO FEATURE.
049000     MOVE "ALTER-TEST" TO PAR-NAME.
049100     PERFORM PRINT-DETAIL.
049200     MOVE 0 TO RESULT-FLAG.
049300 ALTER-WRITE-END.
049400     GO TO ALTERABLE-PARAGRAPH.
049500 ALTERED-GO-TO-TEST.
049600     IF RESULT-FLAG IS NOT EQUAL TO 0
049700         MOVE "USE PROCEDURE EXECUTED" TO RE-MARK
049800         PERFORM FAIL
049900         PERFORM ALTERED-GO-TO-WRITE
050000         ELSE PERFORM PASS
050100         GO TO ALTERED-GO-TO-WRITE.
050200     MOVE "DEBUG-LINE; SEE NEXT LINE" TO RE-MARK.
050300     MOVE "<===  DEBUG-LINE" TO CORRECT-A.
050400     MOVE DBLINE-HOLD TO COMPUTED-A.
050500     PERFORM ALTERED-GO-TO-WRITE.
050600     MOVE "DEBUG-NAME; SEE NEXT LINE" TO RE-MARK.
050700     MOVE "<===  DEBUG-NAME" TO CORRECT-A.
050800     MOVE DBNAME-HOLD TO COMPUTED-A.
050900     PERFORM ALTERED-GO-TO-WRITE.
051000     MOVE "DEBUG-CONTENTS; SEE NEXT LINE" TO RE-MARK.
051100     MOVE "<===  DEBUG-CONTENTS" TO CORRECT-A.
051200     MOVE DBCONT-HOLD TO COMPUTED-A.
051300     GO TO   ALTERED-GO-TO-WRITE.
051400 ALTERED-GO-TO-DELETE.
051500     PERFORM DE-LETE.
051600 ALTERED-GO-TO-WRITE.
051700     MOVE "DEBUG ON PROC-NAME" TO FEATURE.
051800     MOVE "ALTERED-GO-TO-TEST" TO PAR-NAME.
051900     PERFORM PRINT-DETAIL.
052000     MOVE 0 TO RESULT-FLAG.
052100 PERF-ITERATION-TEST.
052200     PERFORM LOOP-ROUTINE FIVE TIMES.
052300     IF RESULT-FLAG IS NOT EQUAL TO 0
052400         MOVE "USE PROCEDURE EXECUTED" TO RE-MARK
052500         PERFORM FAIL
052600         PERFORM PERF-ITERATION-WRITE
052700         ELSE  PERFORM PASS
052800         GO TO PERF-ITERATION-WRITE.
052900     MOVE "DEBUG-LINE; SEE NEXT LINE" TO RE-MARK.
053000     MOVE "<===  DEBUG-LINE" TO CORRECT-A.
053100     MOVE DBLINE-HOLD TO COMPUTED-A.
053200     PERFORM PERF-ITERATION-WRITE.
053300     MOVE "DEBUG-NAME; SEE NEXT LINE" TO RE-MARK.
053400     MOVE "<===  DEBUG-NAME" TO CORRECT-A.
053500     MOVE DBNAME-HOLD TO COMPUTED-A.
053600     PERFORM PERF-ITERATION-WRITE.
053700     MOVE "DEBUG-CONTENTS; SEE NEXT LINE" TO RE-MARK.
053800     MOVE "<===  DEBUG-CONTENTS" TO CORRECT-A.
053900     MOVE DBCONT-HOLD TO COMPUTED-A.
054000     GO TO   PERF-ITERATION-WRITE.
054100 PERF-ITERATION-DELETE.
054200     PERFORM DE-LETE.
054300 PERF-ITERATION-WRITE.
054400     MOVE "PERF-ITERATION-TEST" TO PAR-NAME.
054500     MOVE "DEBUG ON PROC-NAME" TO FEATURE.
054600     PERFORM PRINT-DETAIL.
054700     MOVE 0 TO RESULT-FLAG.
054800 PERF-ITERATION-END.
054900     GO TO PERFORM-THRU-TEST.
055000 LOOP-ROUTINE.
055100**NESTED PERFORMS ARE USED HERE TO ATTEMPT TO PREVENT OPTIMIZER
055200* ACTION RESULTING IN LOOP UNFOLDING AND REDUCTION.
055300     PERFORM DO-NOTHING.
055400 DO-NOTHING.
055500     ADD A B C GIVING D.
055600 DO-NOTHING-1.
055700     SUBTRACT A FROM B.
055800 PERFORM-THRU-TEST.
055900     PERFORM DO-NOTHING THRU DO-NOTHING-1 FIVE TIMES.
056000     IF RESULT-FLAG IS NOT EQUAL TO 0
056100         MOVE "USE PROCEDURE EXECUTED" TO RE-MARK
056200         PERFORM FAIL
056300         PERFORM PERFORM-THRU-WRITE
056400         ELSE PERFORM PASS
056500         GO TO PERFORM-THRU-WRITE.
056600     MOVE "DEBUG-LINE; SEE NEXT LINE" TO RE-MARK.
056700     MOVE "<===  DEBUG-LINE" TO CORRECT-A.
056800     MOVE DBLINE-HOLD TO COMPUTED-A.
056900     PERFORM PERFORM-THRU-WRITE.
057000     MOVE "DEBUG-NAME; SEE NEXT LINE" TO RE-MARK.
057100     MOVE "<===  DEBUG-NAME" TO CORRECT-A.
057200     MOVE DBNAME-HOLD TO COMPUTED-A.
057300     PERFORM PERFORM-THRU-WRITE.
057400     MOVE "DEBUG-CONTENTS; SEE NEXT LINE" TO RE-MARK.
057500     MOVE "<===  DEBUG-CONTENTS" TO CORRECT-A.
057600     MOVE DBCONT-HOLD TO COMPUTED-A.
057700     GO TO   PERFORM-THRU-WRITE.
057800 PERFORM-THRU-DELETE.
057900     PERFORM DE-LETE.
058000 PERFORM-THRU-WRITE.
058100     MOVE "PERFORM-THRU-TEST" TO PAR-NAME.
058200     MOVE "DEBUG ON PROC-NAME" TO FEATURE.
058300     PERFORM PRINT-DETAIL.
058400     MOVE 0 TO RESULT-FLAG.
058500 SIMPLE-PERFORM-TEST.
058600     PERFORM LOOP-ROUTINE.
058700     IF RESULT-FLAG IS NOT EQUAL TO 0
058800         MOVE "USE PROCEDURE EXECUTED" TO RE-MARK
058900         PERFORM FAIL
059000         PERFORM SIMPLE-PERFORM-WRITE
059100         ELSE PERFORM PASS
059200         GO TO SIMPLE-PERFORM-WRITE.
059300     MOVE "DEBUG-LINE; SEE NEXT LINE" TO RE-MARK.
059400     MOVE "<===  DEBUG-LINE" TO CORRECT-A.
059500     MOVE DBLINE-HOLD TO COMPUTED-A.
059600     PERFORM SIMPLE-PERFORM-WRITE.
059700     MOVE "DEBUG-NAME; SEE NEXT LINE" TO RE-MARK.
059800     MOVE "<===  DEBUG-NAME" TO CORRECT-A.
059900     MOVE DBNAME-HOLD TO COMPUTED-A.
060000     PERFORM SIMPLE-PERFORM-WRITE.
060100     MOVE "DEBUG-CONTENTS; SEE NEXT LINE" TO RE-MARK.
060200     MOVE "<===  DEBUG-CONTENTS" TO CORRECT-A.
060300     MOVE DBCONT-HOLD TO COMPUTED-A.
060400     GO TO   SIMPLE-PERFORM-WRITE.
060500 SIMPLE-PERFORM-DELETE.
060600     PERFORM DE-LETE.
060700 SIMPLE-PERFORM-WRITE.
060800     MOVE "SIMPLE-PERFORM-TEST" TO PAR-NAME.
060900     MOVE "DEBUG ON PROC-NAME" TO FEATURE.
061000     PERFORM PRINT-DETAIL.
061100     MOVE 0 TO RESULT-FLAG.
061200 DEBUG-LINE-TESTS-INIT.
061300     MOVE "DEBUG LINE TESTS" TO FEATURE.
061400 DEBUG-LINE-TEST-01.
061500     MOVE "COMPLETE ENTITY" TO RE-MARK.
061600     PERFORM PASS.
061700D    PERFORM FAIL.
061800     GO TO DEBUG-LINE-WRITE-01.
061900 DEBUG-LINE-DELETE-01.
062000     PERFORM DE-LETE.
062100 DEBUG-LINE-WRITE-01.
062200     MOVE "DEBUG-LINE-TEST-01" TO PAR-NAME.
062300     PERFORM PRINT-DETAIL.
062400 DEBUG-LINE-TEST-02.
062500     MOVE "CONSECUTIVE DEBUG LINES" TO RE-MARK.
062600     PERFORM PASS.
062700D    PERFORM FAIL.
062800D    SUBTRACT 1 FROM D.
062900     GO TO DEBUG-LINE-WRITE-02.
063000 DEBUG-LINE-DELETE-02.
063100     PERFORM DE-LETE.
063200 DEBUG-LINE-WRITE-02.
063300     MOVE "DEBUG-LINE-TEST-02" TO PAR-NAME.
063400     PERFORM PRINT-DETAIL.
063500 DEBUG-LINE-TEST-03.
063600     MOVE "BROKEN STATEMENTS" TO RE-MARK.
063700     PERFORM
063800D        FAIL.   GO TO DEBUG-LINE-WRITE-03.
063900DDEBUG-LINE-TEST-03A.     PERFORM
064000                             PASS.
064100                             GO TO DEBUG-LINE-WRITE-03.
064200 DEBUG-LINE-DELETE-03.
064300     PERFORM DE-LETE.
064400 DEBUG-LINE-WRITE-03.
064500     MOVE "DEBUG-LINE-TEST-03" TO PAR-NAME.
064600     PERFORM PRINT-DETAIL.
064700 DEBUG-LINE-TEST-04.
064800     MOVE "NESTED COMMENTS" TO RE-MARK.
064900D    PERFORM FAIL.
065000*    PERFORM FAIL.  MOVE "COMMENTS EXECUTED" TO COMPUTED-A.
065100*    GO TO DEBUG-LINE-WRITE-04.
065200*DEBUG-LINE-TEST-04-A.
065300D    GO TO DEBUG-LINE-WRITE-04.
065400 DEBUG-LINE-TEST-04-B.
065500     PERFORM PASS.
065600     GO TO DEBUG-LINE-WRITE-04.
065700 DEBUG-LINE-DELETE-04.
065800     PERFORM DE-LETE.
065900 DEBUG-LINE-WRITE-04.
066000     MOVE "DEBUG-LINE-TEST-04" TO PAR-NAME.
066100     PERFORM PRINT-DETAIL.
066200 DEBUG-LINE-TEST-05.
066300     MOVE "NESTED INSIDE COMMENTS" TO RE-MARK.
066400*    PERFORM FAIL.  MOVE "COMMENTS EXECUTED" TO COMPUTED-A.
066500*    GO TO DEBUG-LINE-WRITE-05.
066600DDEBUG-LINE-TEST-05-A.
066700D    PERFORM FAIL.
066800D    GO TO DEBUG-LINE-WRITE-05.
066900*DEBUG-LINE-TEST-05-B.
067000*    MOVE "    FAILURE 05B" TO COMPUTED-A.
067100*    PERFORM FAIL.  GO TO DEBUG-LINE-WRITE-05.
067200 DEBUG-LINE-TEST-05-C.
067300     PERFORM PASS.
067400     GO TO DEBUG-LINE-WRITE-05.
067500 DEBUG-LINE-DELETE-05.
067600     PERFORM DE-LETE.
067700 DEBUG-LINE-WRITE-05.
067800     MOVE "DEBUG-LINE-TEST-05" TO PAR-NAME.
067900     PERFORM PRINT-DETAIL.
068000 CCVS-EXIT SECTION.
068100 CCVS-999999.
068200     GO TO CLOSE-FILES.
