000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SM107A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*                                                              *
002200*    PROGRAM SM107A TESTS THE CAPABILITY TO COPY 1599 RECORDS  *
002300*    BY A SINGLE "COPY" STATEMENT IN THE PROCEDURE DIVISION.   *
002400*                                                              *
002500****************************************************************
002600 ENVIRONMENT DIVISION.
002700 CONFIGURATION SECTION.
002800 SOURCE-COMPUTER.
002900     XXXXX082.
003000 OBJECT-COMPUTER.
003100     XXXXX083.
003200 INPUT-OUTPUT SECTION.
003300 FILE-CONTROL.
003400     SELECT PRINT-FILE ASSIGN TO
003500     XXXXX055.
003600 DATA DIVISION.
003700 FILE SECTION.
003800 FD  PRINT-FILE.
003900 01  PRINT-REC PICTURE X(120).
004000 01  DUMMY-RECORD PICTURE X(120).
004100 WORKING-STORAGE SECTION.
004200 01  TEST-RESULTS.
004300     02 FILLER                   PIC X      VALUE SPACE.
004400     02 FEATURE                  PIC X(20)  VALUE SPACE.
004500     02 FILLER                   PIC X      VALUE SPACE.
004600     02 P-OR-F                   PIC X(5)   VALUE SPACE.
004700     02 FILLER                   PIC X      VALUE SPACE.
004800     02  PAR-NAME.
004900       03 FILLER                 PIC X(19)  VALUE SPACE.
005000       03  PARDOT-X              PIC X      VALUE SPACE.
005100       03 DOTVALUE               PIC 99     VALUE ZERO.
005200     02 FILLER                   PIC X(8)   VALUE SPACE.
005300     02 RE-MARK                  PIC X(61).
005400 01  TEST-COMPUTED.
005500     02 FILLER                   PIC X(30)  VALUE SPACE.
005600     02 FILLER                   PIC X(17)  VALUE
005700            "       COMPUTED=".
005800     02 COMPUTED-X.
005900     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
006000     03 COMPUTED-N               REDEFINES COMPUTED-A
006100                                 PIC -9(9).9(9).
006200     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
006300     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
006400     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
006500     03       CM-18V0 REDEFINES COMPUTED-A.
006600         04 COMPUTED-18V0                    PIC -9(18).
006700         04 FILLER                           PIC X.
006800     03 FILLER PIC X(50) VALUE SPACE.
006900 01  TEST-CORRECT.
007000     02 FILLER PIC X(30) VALUE SPACE.
007100     02 FILLER PIC X(17) VALUE "       CORRECT =".
007200     02 CORRECT-X.
007300     03 CORRECT-A                  PIC X(20) VALUE SPACE.
007400     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
007500     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
007600     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
007700     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
007800     03      CR-18V0 REDEFINES CORRECT-A.
007900         04 CORRECT-18V0                     PIC -9(18).
008000         04 FILLER                           PIC X.
008100     03 FILLER PIC X(2) VALUE SPACE.
008200     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
008300 01  CCVS-C-1.
008400     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
008500-    "SS  PARAGRAPH-NAME
008600-    "       REMARKS".
008700     02 FILLER                     PIC X(20)    VALUE SPACE.
008800 01  CCVS-C-2.
008900     02 FILLER                     PIC X        VALUE SPACE.
009000     02 FILLER                     PIC X(6)     VALUE "TESTED".
009100     02 FILLER                     PIC X(15)    VALUE SPACE.
009200     02 FILLER                     PIC X(4)     VALUE "FAIL".
009300     02 FILLER                     PIC X(94)    VALUE SPACE.
009400 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
009500 01  REC-CT                        PIC 99       VALUE ZERO.
009600 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
009700 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
009800 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
009900 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
010000 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
010100 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
010200 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
010300 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
010400 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
010500 01  CCVS-H-1.
010600     02  FILLER                    PIC X(39)    VALUE SPACES.
010700     02  FILLER                    PIC X(42)    VALUE
010800     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
010900     02  FILLER                    PIC X(39)    VALUE SPACES.
011000 01  CCVS-H-2A.
011100   02  FILLER                        PIC X(40)  VALUE SPACE.
011200   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
011300   02  FILLER                        PIC XXXX   VALUE
011400     "4.2 ".
011500   02  FILLER                        PIC X(28)  VALUE
011600            " COPY - NOT FOR DISTRIBUTION".
011700   02  FILLER                        PIC X(41)  VALUE SPACE.
011800
011900 01  CCVS-H-2B.
012000   02  FILLER                        PIC X(15)  VALUE
012100            "TEST RESULT OF ".
012200   02  TEST-ID                       PIC X(9).
012300   02  FILLER                        PIC X(4)   VALUE
012400            " IN ".
012500   02  FILLER                        PIC X(12)  VALUE
012600     " HIGH       ".
012700   02  FILLER                        PIC X(22)  VALUE
012800            " LEVEL VALIDATION FOR ".
012900   02  FILLER                        PIC X(58)  VALUE
013000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
013100 01  CCVS-H-3.
013200     02  FILLER                      PIC X(34)  VALUE
013300            " FOR OFFICIAL USE ONLY    ".
013400     02  FILLER                      PIC X(58)  VALUE
013500     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
013600     02  FILLER                      PIC X(28)  VALUE
013700            "  COPYRIGHT   1985 ".
013800 01  CCVS-E-1.
013900     02 FILLER                       PIC X(52)  VALUE SPACE.
014000     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
014100     02 ID-AGAIN                     PIC X(9).
014200     02 FILLER                       PIC X(45)  VALUE SPACES.
014300 01  CCVS-E-2.
014400     02  FILLER                      PIC X(31)  VALUE SPACE.
014500     02  FILLER                      PIC X(21)  VALUE SPACE.
014600     02 CCVS-E-2-2.
014700         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
014800         03 FILLER                   PIC X      VALUE SPACE.
014900         03 ENDER-DESC               PIC X(44)  VALUE
015000            "ERRORS ENCOUNTERED".
015100 01  CCVS-E-3.
015200     02  FILLER                      PIC X(22)  VALUE
015300            " FOR OFFICIAL USE ONLY".
015400     02  FILLER                      PIC X(12)  VALUE SPACE.
015500     02  FILLER                      PIC X(58)  VALUE
015600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
015700     02  FILLER                      PIC X(13)  VALUE SPACE.
015800     02 FILLER                       PIC X(15)  VALUE
015900             " COPYRIGHT 1985".
016000 01  CCVS-E-4.
016100     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
016200     02 FILLER                       PIC X(4)   VALUE " OF ".
016300     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
016400     02 FILLER                       PIC X(40)  VALUE
016500      "  TESTS WERE EXECUTED SUCCESSFULLY".
016600 01  XXINFO.
016700     02 FILLER                       PIC X(19)  VALUE
016800            "*** INFORMATION ***".
016900     02 INFO-TEXT.
017000       04 FILLER                     PIC X(8)   VALUE SPACE.
017100       04 XXCOMPUTED                 PIC X(20).
017200       04 FILLER                     PIC X(5)   VALUE SPACE.
017300       04 XXCORRECT                  PIC X(20).
017400     02 INF-ANSI-REFERENCE           PIC X(48).
017500 01  HYPHEN-LINE.
017600     02 FILLER  PIC IS X VALUE IS SPACE.
017700     02 FILLER  PIC IS X(65)    VALUE IS "************************
017800-    "*****************************************".
017900     02 FILLER  PIC IS X(54)    VALUE IS "************************
018000-    "******************************".
018100 01  CCVS-PGM-ID                     PIC X(9)   VALUE
018200     "SM107A".
018300 PROCEDURE DIVISION.
018400 CCVS1 SECTION.
018500 OPEN-FILES.
018600     OPEN     OUTPUT PRINT-FILE.
018700     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
018800     MOVE    SPACE TO TEST-RESULTS.
018900     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
019000     GO TO CCVS1-EXIT.
019100 CLOSE-FILES.
019200     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
019300 TERMINATE-CCVS.
019400S    EXIT PROGRAM.
019500STERMINATE-CALL.
019600     STOP     RUN.
019700 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
019800 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
019900 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
020000 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
020100     MOVE "****TEST DELETED****" TO RE-MARK.
020200 PRINT-DETAIL.
020300     IF REC-CT NOT EQUAL TO ZERO
020400             MOVE "." TO PARDOT-X
020500             MOVE REC-CT TO DOTVALUE.
020600     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
020700     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
020800        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
020900          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
021000     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
021100     MOVE SPACE TO CORRECT-X.
021200     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
021300     MOVE     SPACE TO RE-MARK.
021400 HEAD-ROUTINE.
021500     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
021600     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
021700     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
021800     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
021900 COLUMN-NAMES-ROUTINE.
022000     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
022100     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
022200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
022300 END-ROUTINE.
022400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
022500 END-RTN-EXIT.
022600     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
022700 END-ROUTINE-1.
022800      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
022900      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
023000      ADD PASS-COUNTER TO ERROR-HOLD.
023100*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
023200      MOVE PASS-COUNTER TO CCVS-E-4-1.
023300      MOVE ERROR-HOLD TO CCVS-E-4-2.
023400      MOVE CCVS-E-4 TO CCVS-E-2-2.
023500      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
023600  END-ROUTINE-12.
023700      MOVE "TEST(S) FAILED" TO ENDER-DESC.
023800     IF       ERROR-COUNTER IS EQUAL TO ZERO
023900         MOVE "NO " TO ERROR-TOTAL
024000         ELSE
024100         MOVE ERROR-COUNTER TO ERROR-TOTAL.
024200     MOVE     CCVS-E-2 TO DUMMY-RECORD.
024300     PERFORM WRITE-LINE.
024400 END-ROUTINE-13.
024500     IF DELETE-COUNTER IS EQUAL TO ZERO
024600         MOVE "NO " TO ERROR-TOTAL  ELSE
024700         MOVE DELETE-COUNTER TO ERROR-TOTAL.
024800     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
024900     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025000      IF   INSPECT-COUNTER EQUAL TO ZERO
025100          MOVE "NO " TO ERROR-TOTAL
025200      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
025300      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
025400      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025500     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025600 WRITE-LINE.
025700     ADD 1 TO RECORD-COUNT.
025800Y    IF RECORD-COUNT GREATER 50
025900Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
026000Y        MOVE SPACE TO DUMMY-RECORD
026100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
026200Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
026300Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
026400Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
026500Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
026600Y        MOVE ZERO TO RECORD-COUNT.
026700     PERFORM WRT-LN.
026800 WRT-LN.
026900     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
027000     MOVE SPACE TO DUMMY-RECORD.
027100 BLANK-LINE-PRINT.
027200     PERFORM WRT-LN.
027300 FAIL-ROUTINE.
027400     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
027500     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
027600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
027700     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
027800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027900     MOVE   SPACES TO INF-ANSI-REFERENCE.
028000     GO TO  FAIL-ROUTINE-EX.
028100 FAIL-ROUTINE-WRITE.
028200     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
028300     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
028400     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
028500     MOVE   SPACES TO COR-ANSI-REFERENCE.
028600 FAIL-ROUTINE-EX. EXIT.
028700 BAIL-OUT.
028800     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
028900     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
029000 BAIL-OUT-WRITE.
029100     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
029200     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
029300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029400     MOVE   SPACES TO INF-ANSI-REFERENCE.
029500 BAIL-OUT-EX. EXIT.
029600 CCVS1-EXIT.
029700     EXIT.
029800 WARNING-MSG.
029900     MOVE " IF NO OTHER REPORT LINES APPEAR BELOW, ""COPY K7SEA""
030000-         "FAILED." TO PRINT-REC.
030100     PERFORM WRITE-LINE.
030200*
030300*********************** COPY STATEMENT USED **********************
030400*
030500*COPY  K7SEA
030600*
030700******************** COPIED TEXT BEGINS BELOW ********************
030800  COPY  K7SEA.
030900*********************** END OF COPIED TEXT ***********************
031000 CCVS-EXIT SECTION.
031100 CCVS-999999.
031200     GO TO CLOSE-FILES.
