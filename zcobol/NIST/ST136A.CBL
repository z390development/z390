000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST136A.
000400
000500****************************************************************
000600*                                                              *
000700*    VALIDATION FOR:-                                          *
000800*                                                              *
000900*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
001000*                                                              *
001100*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001200*                                                              *
001300****************************************************************
001400*                                                              *
001500*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001600*                                                              *
001700*        X-55  - SYSTEM PRINTER NAME.                          *
001800*        X-82  - SOURCE COMPUTER NAME.                         *
001900*        X-83  - OBJECT COMPUTER NAME.                         *
002000*                                                              *
002100****************************************************************
002200*    ST206 TESTS THE FROM OPTION OF THE RELEASE VERB. TEN RECORDS
002300*    ARE CREATED WITH THE NUMERICAL KEY DESCENDING FROM 10 THRU 1.
002400*    THE RECORDS ARE THEN SORTED INTO ASCENDING SEQUENCE AND THE
002500*    RESULTS ARE SPOT-CHECKED.
002600*
002700 ENVIRONMENT DIVISION.
002800 CONFIGURATION SECTION.
002900 SOURCE-COMPUTER.
003000     XXXXX082.
003100 OBJECT-COMPUTER.
003200     XXXXX083.
003300 INPUT-OUTPUT SECTION.
003400 FILE-CONTROL.
003500     SELECT PRINT-FILE ASSIGN TO
003600     XXXXX055.
003700     SELECT   SORTOUT-2F ASSIGN TO
003800     XXXXX001.
003900     SELECT   SORTFILE-2F ASSIGN TO
004000     XXXXX027.
004100 DATA DIVISION.
004200 FILE SECTION.
004300 FD  PRINT-FILE.
004400 01  PRINT-REC PICTURE X(120).
004500 01  DUMMY-RECORD PICTURE X(120).
004600 FD  SORTOUT-2F
004700     LABEL RECORDS STANDARD
004800C    VALUE OF
004900C    XXXXX074
005000C    IS
005100C    XXXXX075
005200G    XXXXX069
005300     DATA RECORD IS SORTOUT-REC.
005400 01  SORTOUT-REC.
005500     02 SORTOUT-NON-KEY-1         PICTURE A(12).
005600     02 SORTOUT-KEY               PICTURE S9(8).
005700     02 SORTOUT-NON-KEY-2         PICTURE A(60).
005800 SD  SORTFILE-2F
005900     DATA RECORD IS SORTFILE-REC.
006000 01  SORTFILE-REC.
006100     02 SORTFILE-NON-KEY-1        PICTURE X(12).
006200     02 SORTFILE-KEY              PICTURE S9(8).
006300     02 SORTFILE-NON-KEY-2        PICTURE X(60).
006400 WORKING-STORAGE SECTION.
006500 77  LITERAL-B          PICTURE X(12) VALUE "B           ".
006600 77  UTIL-CTR           PICTURE S99999.
006700 77  COMMENT-1 PICTURE X(27) VALUE "KEY AREA                   ".
006800 77  COMMENT-2 PICTURE X(27) VALUE "FIRST 20 OF 60-CHAR FIELD  ".
006900 77  COMMENT-3 PICTURE X(27) VALUE "SECOND 20 OF 60-CHAR FIELD ".
007000 77  COMMENT-4 PICTURE X(27) VALUE "THIRD 20 OF 60-CHAR FIELD  ".
007100 77  ALL-A              PICTURE X(60) VALUE ALL "A".
007200 77  ALL-X              PICTURE X(60) VALUE ALL "X".
007300 77  ALL-Z              PICTURE X(60) VALUE ALL "Z".
007400 01  WORK-REC.
007500     02 WORK-NON-KEY-1  PICTURE X(12).
007600     02 WORK-KEY        PICTURE S9(8).
007700     02 WORK-NON-KEY-2  PICTURE X(60).
007800 01  COMPUTED-BREAKDOWN.
007900     02 FIRST-20CM      PICTURE X(20).
008000     02 SECOND-20CM     PICTURE X(20).
008100     02 THIRD-20CM      PICTURE X(20).
008200 01  CORRECT-BREAKDOWN.
008300     02 FIRST-20CR      PICTURE X(20).
008400     02 SECOND-20CR     PICTURE X(20).
008500     02 THIRD-20CR      PICTURE X(20).
008600 01  HOLD-REC.
008700     02 HOLD-NON-KEY-1  PICTURE X(12).
008800     02 HOLD-KEY        PICTURE S9(8).
008900     02 HOLD-NON-KEY-2  PICTURE X(60).
009000 01  TEST-RESULTS.
009100     02 FILLER                   PIC X      VALUE SPACE.
009200     02 FEATURE                  PIC X(20)  VALUE SPACE.
009300     02 FILLER                   PIC X      VALUE SPACE.
009400     02 P-OR-F                   PIC X(5)   VALUE SPACE.
009500     02 FILLER                   PIC X      VALUE SPACE.
009600     02  PAR-NAME.
009700       03 FILLER                 PIC X(19)  VALUE SPACE.
009800       03  PARDOT-X              PIC X      VALUE SPACE.
009900       03 DOTVALUE               PIC 99     VALUE ZERO.
010000     02 FILLER                   PIC X(8)   VALUE SPACE.
010100     02 RE-MARK                  PIC X(61).
010200 01  TEST-COMPUTED.
010300     02 FILLER                   PIC X(30)  VALUE SPACE.
010400     02 FILLER                   PIC X(17)  VALUE
010500            "       COMPUTED=".
010600     02 COMPUTED-X.
010700     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
010800     03 COMPUTED-N               REDEFINES COMPUTED-A
010900                                 PIC -9(9).9(9).
011000     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
011100     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
011200     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
011300     03       CM-18V0 REDEFINES COMPUTED-A.
011400         04 COMPUTED-18V0                    PIC -9(18).
011500         04 FILLER                           PIC X.
011600     03 FILLER PIC X(50) VALUE SPACE.
011700 01  TEST-CORRECT.
011800     02 FILLER PIC X(30) VALUE SPACE.
011900     02 FILLER PIC X(17) VALUE "       CORRECT =".
012000     02 CORRECT-X.
012100     03 CORRECT-A                  PIC X(20) VALUE SPACE.
012200     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
012300     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
012400     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
012500     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
012600     03      CR-18V0 REDEFINES CORRECT-A.
012700         04 CORRECT-18V0                     PIC -9(18).
012800         04 FILLER                           PIC X.
012900     03 FILLER PIC X(2) VALUE SPACE.
013000     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
013100 01  CCVS-C-1.
013200     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
013300-    "SS  PARAGRAPH-NAME
013400-    "       REMARKS".
013500     02 FILLER                     PIC X(20)    VALUE SPACE.
013600 01  CCVS-C-2.
013700     02 FILLER                     PIC X        VALUE SPACE.
013800     02 FILLER                     PIC X(6)     VALUE "TESTED".
013900     02 FILLER                     PIC X(15)    VALUE SPACE.
014000     02 FILLER                     PIC X(4)     VALUE "FAIL".
014100     02 FILLER                     PIC X(94)    VALUE SPACE.
014200 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
014300 01  REC-CT                        PIC 99       VALUE ZERO.
014400 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
014500 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
014600 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
014700 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
014800 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
014900 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
015000 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
015100 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
015200 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
015300 01  CCVS-H-1.
015400     02  FILLER                    PIC X(39)    VALUE SPACES.
015500     02  FILLER                    PIC X(42)    VALUE
015600     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
015700     02  FILLER                    PIC X(39)    VALUE SPACES.
015800 01  CCVS-H-2A.
015900   02  FILLER                        PIC X(40)  VALUE SPACE.
016000   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
016100   02  FILLER                        PIC XXXX   VALUE
016200     "4.2 ".
016300   02  FILLER                        PIC X(28)  VALUE
016400            " COPY - NOT FOR DISTRIBUTION".
016500   02  FILLER                        PIC X(41)  VALUE SPACE.
016600
016700 01  CCVS-H-2B.
016800   02  FILLER                        PIC X(15)  VALUE
016900            "TEST RESULT OF ".
017000   02  TEST-ID                       PIC X(9).
017100   02  FILLER                        PIC X(4)   VALUE
017200            " IN ".
017300   02  FILLER                        PIC X(12)  VALUE
017400     " HIGH       ".
017500   02  FILLER                        PIC X(22)  VALUE
017600            " LEVEL VALIDATION FOR ".
017700   02  FILLER                        PIC X(58)  VALUE
017800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
017900 01  CCVS-H-3.
018000     02  FILLER                      PIC X(34)  VALUE
018100            " FOR OFFICIAL USE ONLY    ".
018200     02  FILLER                      PIC X(58)  VALUE
018300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
018400     02  FILLER                      PIC X(28)  VALUE
018500            "  COPYRIGHT   1985 ".
018600 01  CCVS-E-1.
018700     02 FILLER                       PIC X(52)  VALUE SPACE.
018800     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
018900     02 ID-AGAIN                     PIC X(9).
019000     02 FILLER                       PIC X(45)  VALUE SPACES.
019100 01  CCVS-E-2.
019200     02  FILLER                      PIC X(31)  VALUE SPACE.
019300     02  FILLER                      PIC X(21)  VALUE SPACE.
019400     02 CCVS-E-2-2.
019500         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
019600         03 FILLER                   PIC X      VALUE SPACE.
019700         03 ENDER-DESC               PIC X(44)  VALUE
019800            "ERRORS ENCOUNTERED".
019900 01  CCVS-E-3.
020000     02  FILLER                      PIC X(22)  VALUE
020100            " FOR OFFICIAL USE ONLY".
020200     02  FILLER                      PIC X(12)  VALUE SPACE.
020300     02  FILLER                      PIC X(58)  VALUE
020400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
020500     02  FILLER                      PIC X(13)  VALUE SPACE.
020600     02 FILLER                       PIC X(15)  VALUE
020700             " COPYRIGHT 1985".
020800 01  CCVS-E-4.
020900     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
021000     02 FILLER                       PIC X(4)   VALUE " OF ".
021100     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
021200     02 FILLER                       PIC X(40)  VALUE
021300      "  TESTS WERE EXECUTED SUCCESSFULLY".
021400 01  XXINFO.
021500     02 FILLER                       PIC X(19)  VALUE
021600            "*** INFORMATION ***".
021700     02 INFO-TEXT.
021800       04 FILLER                     PIC X(8)   VALUE SPACE.
021900       04 XXCOMPUTED                 PIC X(20).
022000       04 FILLER                     PIC X(5)   VALUE SPACE.
022100       04 XXCORRECT                  PIC X(20).
022200     02 INF-ANSI-REFERENCE           PIC X(48).
022300 01  HYPHEN-LINE.
022400     02 FILLER  PIC IS X VALUE IS SPACE.
022500     02 FILLER  PIC IS X(65)    VALUE IS "************************
022600-    "*****************************************".
022700     02 FILLER  PIC IS X(54)    VALUE IS "************************
022800-    "******************************".
022900 01  CCVS-PGM-ID                     PIC X(9)   VALUE
023000     "ST136A".
023100 PROCEDURE DIVISION.
023200 CCVS1 SECTION.
023300 OPEN-FILES.
023400     OPEN     OUTPUT PRINT-FILE.
023500     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
023600     MOVE    SPACE TO TEST-RESULTS.
023700     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
023800     GO TO CCVS1-EXIT.
023900 CLOSE-FILES.
024000     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
024100 TERMINATE-CCVS.
024200S    EXIT PROGRAM.
024300STERMINATE-CALL.
024400     STOP     RUN.
024500 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
024600 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
024700 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
024800 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
024900     MOVE "****TEST DELETED****" TO RE-MARK.
025000 PRINT-DETAIL.
025100     IF REC-CT NOT EQUAL TO ZERO
025200             MOVE "." TO PARDOT-X
025300             MOVE REC-CT TO DOTVALUE.
025400     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
025500     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
025600        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
025700          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
025800     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
025900     MOVE SPACE TO CORRECT-X.
026000     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
026100     MOVE     SPACE TO RE-MARK.
026200 HEAD-ROUTINE.
026300     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026400     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026500     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
026600     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
026700 COLUMN-NAMES-ROUTINE.
026800     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026900     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
027100 END-ROUTINE.
027200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
027300 END-RTN-EXIT.
027400     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027500 END-ROUTINE-1.
027600      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
027700      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
027800      ADD PASS-COUNTER TO ERROR-HOLD.
027900*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
028000      MOVE PASS-COUNTER TO CCVS-E-4-1.
028100      MOVE ERROR-HOLD TO CCVS-E-4-2.
028200      MOVE CCVS-E-4 TO CCVS-E-2-2.
028300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
028400  END-ROUTINE-12.
028500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
028600     IF       ERROR-COUNTER IS EQUAL TO ZERO
028700         MOVE "NO " TO ERROR-TOTAL
028800         ELSE
028900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
029000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
029100     PERFORM WRITE-LINE.
029200 END-ROUTINE-13.
029300     IF DELETE-COUNTER IS EQUAL TO ZERO
029400         MOVE "NO " TO ERROR-TOTAL  ELSE
029500         MOVE DELETE-COUNTER TO ERROR-TOTAL.
029600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
029700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029800      IF   INSPECT-COUNTER EQUAL TO ZERO
029900          MOVE "NO " TO ERROR-TOTAL
030000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
030100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
030200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030400 WRITE-LINE.
030500     ADD 1 TO RECORD-COUNT.
030600Y    IF RECORD-COUNT GREATER 42
030700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
030800Y        MOVE SPACE TO DUMMY-RECORD
030900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
031000Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
031100Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
031200Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
031300Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
031400Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
031500Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
031600Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
031700Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
031800Y        MOVE ZERO TO RECORD-COUNT.
031900     PERFORM WRT-LN.
032000 WRT-LN.
032100     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
032200     MOVE SPACE TO DUMMY-RECORD.
032300 BLANK-LINE-PRINT.
032400     PERFORM WRT-LN.
032500 FAIL-ROUTINE.
032600     IF     COMPUTED-X NOT EQUAL TO SPACE
032700            GO TO   FAIL-ROUTINE-WRITE.
032800     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
032900     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
033000     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
033100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033200     MOVE   SPACES TO INF-ANSI-REFERENCE.
033300     GO TO  FAIL-ROUTINE-EX.
033400 FAIL-ROUTINE-WRITE.
033500     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
033600     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
033700     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
033800     MOVE   SPACES TO COR-ANSI-REFERENCE.
033900 FAIL-ROUTINE-EX. EXIT.
034000 BAIL-OUT.
034100     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
034200     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
034300 BAIL-OUT-WRITE.
034400     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
034500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
034600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034700     MOVE   SPACES TO INF-ANSI-REFERENCE.
034800 BAIL-OUT-EX. EXIT.
034900 CCVS1-EXIT.
035000     EXIT.
035100 SORT-PARA SECTION.
035200 SORT-PARAGRAPH.
035300     SORT     SORTFILE-2F ON ASCENDING KEY
035400              SORTFILE-KEY
035500              INPUT PROCEDURE INPROC
035600              GIVING SORTOUT-2F.
035700     GO       TO SORT-TESTS.
035800 INPROC SECTION.
035900  INPROC-SYSIN.
036000     MOVE     "RELEASE FROM" TO FEATURE.
036100     MOVE     10 TO UTIL-CTR.
036200 SORT-TEST-1.
036300     MOVE     "SORT-TEST-1" TO PAR-NAME.
036400     PERFORM  RELEASE-SORTFILE-REC.
036500     IF       WORK-REC EQUAL TO HOLD-REC
036600              PERFORM PASS-1 GO TO SORT-WRITE-1.
036700 SORT-FAIL-1.
036800     MOVE     WORK-NON-KEY-1 TO COMPUTED-A.
036900     MOVE     HOLD-NON-KEY-1 TO CORRECT-A.
037000     PERFORM  FAIL-1.
037100     PERFORM  PRINT-DETAIL-1.
037200     MOVE     WORK-KEY TO COMPUTED-N.
037300     MOVE     HOLD-KEY TO CORRECT-N.
037400     MOVE     COMMENT-1 TO RE-MARK.
037500     PERFORM  PRINT-DETAIL-1.
037600     MOVE     WORK-NON-KEY-2 TO COMPUTED-BREAKDOWN.
037700     MOVE     HOLD-NON-KEY-2 TO CORRECT-BREAKDOWN.
037800     MOVE     FIRST-20CM TO COMPUTED-A.
037900     MOVE     FIRST-20CR TO CORRECT-A.
038000     MOVE     COMMENT-2 TO RE-MARK.
038100     PERFORM  PRINT-DETAIL-1.
038200     MOVE     SECOND-20CM TO COMPUTED-A.
038300     MOVE     SECOND-20CR TO CORRECT-A.
038400     MOVE     COMMENT-3 TO RE-MARK.
038500     PERFORM  PRINT-DETAIL-1.
038600     MOVE     THIRD-20CM TO COMPUTED-A.
038700     MOVE     THIRD-20CR TO CORRECT-A.
038800     MOVE     COMMENT-4 TO RE-MARK.
038900 SORT-WRITE-1.
039000     PERFORM  PRINT-DETAIL-1.
039100 INPROC-CONTINUE.
039200     PERFORM  RELEASE-SORTFILE-REC 9 TIMES.
039300     GO       TO INPROC-EXIT.
039400 RELEASE-SORTFILE-REC.
039500     MOVE     ALL-A TO WORK-NON-KEY-2.
039600     MOVE     UTIL-CTR TO WORK-KEY.
039700     MOVE     "B" TO WORK-NON-KEY-1.
039800     MOVE     ALL-Z TO SORTFILE-NON-KEY-1.
039900     MOVE     -12345 TO SORTFILE-KEY.
040000     MOVE     ALL-X TO SORTFILE-NON-KEY-2.
040100*        NOTE A FALSE RECORD HAS BEEN MOVED TO SORTFILE-REC ---
040200*             THE RELEASE STATEMENT WHICH FOLLOWS SHOULD CLOBBER
040300*             IT COMPLETELY.
040400     MOVE     WORK-REC TO HOLD-REC.
040500     RELEASE  SORTFILE-REC FROM WORK-REC.
040600     SUBTRACT 1 FROM UTIL-CTR.
040700 INSPT-1. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
040800 PASS-1.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
040900 FAIL-1.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
041000 DE-LETE-1.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
041100     MOVE "****TEST DELETED****" TO RE-MARK.
041200 PRINT-DETAIL-1.
041300     IF REC-CT NOT EQUAL TO ZERO
041400             MOVE "." TO PARDOT-X
041500             MOVE REC-CT TO DOTVALUE.
041600     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE-1.
041700     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE-1
041800        PERFORM FAIL-ROUTINE-1 THRU FAIL-ROUTINE-EX-1
041900          ELSE PERFORM BAIL-OUT-1 THRU BAIL-OUT-EX-1.
042000     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
042100     MOVE SPACE TO CORRECT-X.
042200     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
042300     MOVE     SPACE TO RE-MARK.
042400 WRITE-LINE-1.
042500     ADD 1 TO RECORD-COUNT.
042600Y    IF RECORD-COUNT GREATER 50
042700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
042800Y        MOVE SPACE TO DUMMY-RECORD
042900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
043000Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN-1
043100Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN-1 2 TIMES
043200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN-1
043300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
043400Y        MOVE ZERO TO RECORD-COUNT.
043500     PERFORM WRT-LN-1.
043600 WRT-LN-1.
043700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
043800     MOVE SPACE TO DUMMY-RECORD.
043900 BLANK-LINE-PRINT-1.
044000     PERFORM WRT-LN-1.
044100 FAIL-ROUTINE-1.
044200     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-1.
044300     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-1.
044400     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
044500     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-1 2 TIMES.
044600     GO TO FAIL-ROUTINE-EX-1.
044700 FAIL-RTN-WRITE-1.
044800     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE-1
044900     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE-1 2 TIMES.
045000 FAIL-ROUTINE-EX-1. EXIT.
045100 BAIL-OUT-1.
045200     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE-1.
045300     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX-1.
045400 BAIL-OUT-WRITE-1.
045500     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
045600     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-1 2 TIMES.
045700 BAIL-OUT-EX-1. EXIT.
045800 INPROC-EXIT.
045900     EXIT.
046000 SORT-TESTS SECTION.
046100 SORT-INIT.
046200     OPEN     INPUT SORTOUT-2F.
046300     MOVE     ZERO TO UTIL-CTR.
046400 SORT-TEST-2.
046500     MOVE     "SORT-TEST-2" TO PAR-NAME.
046600     PERFORM  READ-SORTOUT.
046700     IF       SORTOUT-NON-KEY-1 NOT EQUAL TO LITERAL-B
046800              GO TO SORT-FAIL-2.
046900     IF       SORTOUT-KEY NOT EQUAL TO 1
047000              GO TO SORT-FAIL-2.
047100     IF       SORTOUT-NON-KEY-2 EQUAL TO ALL-A
047200              PERFORM PASS GO TO SORT-WRITE-2.
047300 SORT-FAIL-2.
047400     MOVE     1 TO CORRECT-N.
047500     PERFORM  BREAKDOWN-PARA.
047600 SORT-WRITE-2.
047700     PERFORM  PRINT-DETAIL.
047800 SORT-TEST-3.
047900     MOVE     "SORT-TEST-3" TO PAR-NAME.
048000     PERFORM  READ-SORTOUT 6 TIMES.
048100     IF       SORTOUT-NON-KEY-1 NOT EQUAL TO LITERAL-B
048200              GO TO SORT-FAIL-3.
048300     IF       SORTOUT-KEY NOT EQUAL TO 7
048400              GO TO SORT-FAIL-3.
048500     IF       SORTOUT-NON-KEY-2 EQUAL TO ALL-A
048600              PERFORM PASS GO TO SORT-WRITE-3.
048700 SORT-FAIL-3.
048800     MOVE     7 TO CORRECT-N.
048900     PERFORM  BREAKDOWN-PARA.
049000 SORT-WRITE-3.
049100     PERFORM  PRINT-DETAIL.
049200 SORT-TEST-4.
049300     MOVE     "SORT-TEST-4" TO PAR-NAME.
049400     PERFORM  READ-SORTOUT 3 TIMES.
049500     IF       SORTOUT-NON-KEY-1 NOT EQUAL TO LITERAL-B
049600              GO TO SORT-FAIL-4.
049700     IF       SORTOUT-KEY NOT EQUAL TO 10
049800              GO TO SORT-FAIL-4.
049900     IF       SORTOUT-NON-KEY-2 EQUAL TO ALL-A
050000              PERFORM PASS GO TO SORT-WRITE-4.
050100 SORT-FAIL-4.
050200     MOVE     10 TO CORRECT-N.
050300     PERFORM  BREAKDOWN-PARA.
050400 SORT-WRITE-4.
050500     PERFORM  PRINT-DETAIL.
050600 SORT-TEST-5.
050700     MOVE     "SORT-TEST-5" TO PAR-NAME.
050800     READ     SORTOUT-2F AT END
050900              PERFORM PASS GO TO SORT-WRITE-5.
051000 SORT-FAIL-5.
051100     MOVE     SPACE TO ALL-A.
051200     MOVE     SPACE TO LITERAL-B
051300     PERFORM  BREAKDOWN-PARA.
051400     PERFORM  PRINT-DETAIL.
051500     MOVE     "END OF FILE NOT FOUND" TO RE-MARK.
051600 SORT-WRITE-5.
051700     PERFORM  PRINT-DETAIL.
051800 CLOSE-SORT-FILES.
051900     CLOSE    SORTOUT-2F.
052000     GO TO     CCVS-EXIT.
052100 BREAKDOWN-PARA.
052200     MOVE     SORTOUT-KEY TO COMPUTED-N.
052300     MOVE     COMMENT-1 TO RE-MARK.
052400     PERFORM  FAIL.
052500     PERFORM  PRINT-DETAIL.
052600     MOVE     SORTOUT-NON-KEY-1 TO COMPUTED-A.
052700     MOVE     LITERAL-B TO CORRECT-A.
052800     PERFORM  PRINT-DETAIL.
052900     MOVE     SORTOUT-NON-KEY-2 TO COMPUTED-BREAKDOWN.
053000     MOVE     FIRST-20CM TO COMPUTED-A.
053100     MOVE     ALL-A TO CORRECT-A.
053200     MOVE     COMMENT-2 TO RE-MARK.
053300     PERFORM  PRINT-DETAIL.
053400     MOVE     SECOND-20CM TO COMPUTED-A.
053500     MOVE     ALL-A TO CORRECT-A.
053600     MOVE     COMMENT-3 TO RE-MARK.
053700     PERFORM  PRINT-DETAIL.
053800     MOVE     THIRD-20CM TO COMPUTED-A.
053900     MOVE     ALL-A TO CORRECT-A.
054000     MOVE     COMMENT-4 TO RE-MARK.
054100 READ-SORTOUT.
054200     READ     SORTOUT-2F AT END GO TO READ-ERROR.
054300     ADD      1 TO UTIL-CTR.
054400 READ-ERROR.
054500     MOVE     UTIL-CTR TO COMPUTED-N.
054600     MOVE     10 TO CORRECT-N.
054700     MOVE     "TOO FEW RECORDS IN FILE" TO RE-MARK.
054800     PERFORM  FAIL.
054900     MOVE     "READ-ERROR" TO PAR-NAME
055000     PERFORM  PRINT-DETAIL.
055100     GO       TO CLOSE-SORT-FILES.
055200 CCVS-EXIT SECTION.
055300 CCVS-999999.
055400     GO TO CLOSE-FILES.
