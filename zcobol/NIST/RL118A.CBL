000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RL118A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*            X-22   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR   *
001700*                    RELATIVE  I-O DATA FILE                   *
001800*            X-55   SYSTEM PRINTER                             *
001900*            X-69   ADDITIONAL VALUE OF CLAUSES                *
002000*            X-74   VALUE OF IMPLEMENTOR-NAME                  *
002100*            X-75   OBJECT OF VALUE OF CLAUSE                  *
002200*            X-82   SOURCE-COMPUTER                            *
002300*            X-83   OBJECT-COMPUTER.                           *
002400*                                                              *
002500****************************************************************
002600*    RL118A                                                    *
002700****************************************************************
002800*            THIS PROGRAM TESTS THE SYNTACTICAL CONSTRUCTS AND *
002900*            SEMANTIC ACTIONS ASSOCIATED WITH THE "STATUS"     *
003000*            CLAUSE FOR THE VALUES "22", "23" AND "24".        *
003100****************************************************************
003200 ENVIRONMENT DIVISION.
003300 CONFIGURATION SECTION.
003400 SOURCE-COMPUTER.
003500     XXXXX082.
003600 OBJECT-COMPUTER.
003700     XXXXX083.
003800 INPUT-OUTPUT SECTION.
003900 FILE-CONTROL.
004000     SELECT PRINT-FILE ASSIGN TO
004100     XXXXX055.
004200     SELECT   RL-FD2 ASSIGN
004300     XXXXX022
004400              ORGANIZATION RELATIVE
004500              ACCESS  RANDOM
004600              RELATIVE  RL-FD2-KEY
004700         FILE STATUS IS RL-FD2-STATUS.
004800     SELECT   RL-FD3 ASSIGN
004900     XXXXX022
005000              ORGANIZATION RELATIVE
005100              ACCESS  RANDOM
005200              RELATIVE  RL-FD3-KEY
005300         FILE STATUS IS RL-FD3-STATUS.
005400 DATA DIVISION.
005500 FILE SECTION.
005600 FD  PRINT-FILE.
005700 01  PRINT-REC PICTURE X(120).
005800 01  DUMMY-RECORD PICTURE X(120).
005900 FD  RL-FD2
006000C    VALUE OF
006100C    XXXXX074
006200C    IS
006300C    XXXXX076
006400G    XXXXX069
006500     LABEL RECORDS ARE STANDARD
006600     BLOCK CONTAINS 1 RECORDS
006700     DATA RECORD RL-FD2R1-F-G-240.
006800 01  RL-FD2R1-F-G-240.
006900     05 RL-FD2-WRK-120 PIC X(120).
007000     05 RL-FD2-GRP-120.
007100        10 RL-FD2-WRK-XN-0001-O120F
007200                        PICTURE X OCCURS 120 TIMES.
007300 FD  RL-FD3
007400C    VALUE OF
007500C    XXXXX074
007600C    IS
007700C    XXXXX076
007800G    XXXXX069
007900     LABEL RECORDS ARE STANDARD
008000     BLOCK CONTAINS 1 RECORDS
008100     DATA RECORD RL-FD3R1-F-G-240.
008200 01  RL-FD3R1-F-G-240.
008300     05 RL-FD3-WRK-120 PIC X(120).
008400     05 RL-FD3-GRP-120.
008500        10 RL-FD3-WRK-XN-0001-O120F
008600                        PICTURE X OCCURS 120 TIMES.
008700 WORKING-STORAGE SECTION.
008800 01  GRP-0001.
008900     05 RL-FD2-KEY   PIC  99   VALUE ZERO.
009000     05 RL-FD3-KEY   PIC  999  VALUE ZERO.
009100     05 WRK-CS-09V00-012  PIC S9(9) USAGE COMP  VALUE ZERO.
009200     05 WRK-CS-09V00-013  PIC S9(9) USAGE COMP  VALUE ZERO.
009300     05 WRK-CS-09V00-014  PIC S9(9) USAGE COMP  VALUE ZERO.
009400     05 WRK-CS-09V00-015  PIC S9(9) USAGE COMP  VALUE ZERO.
009500     05 WRK-CS-09V00-016  PIC S9(9) USAGE COMP  VALUE ZERO.
009600     05 WRK-CS-09V00-017  PIC S9(9) USAGE COMP  VALUE ZERO.
009700     05 WRK-CS-09V00-018  PIC S9(9) USAGE COMP  VALUE ZERO.
009800     05 RL-FD2-STATUS     PIC  XX  VALUE  SPACE.
009900     05 RL-FD3-STATUS     PIC  XX  VALUE  SPACE.
010000     05 WRK-XN-0002-001   PIC  X(2) VALUE  SPACE.
010100     05 WRK-XN-0002-002   PIC  X(2) VALUE  SPACE.
010200     05 WRK-XN-0002-003   PIC  X(2) VALUE  SPACE.
010300     05 WRK-XN-0002-004   PIC  X(2) VALUE  SPACE.
010400     05 WRK-XN-0002-005   PIC  X(2) VALUE  SPACE.
010500     05 WRK-XN-0002-006   PIC  X(2) VALUE  SPACE.
010600     05 WRK-XN-0002-007   PIC  X(2) VALUE  SPACE.
010700     05 WRK-XN-0002-008   PIC  X(2) VALUE  SPACE.
010800     05 WRK-XN-0002-009   PIC  X(2) VALUE  SPACE.
010900 01  FILE-RECORD-INFORMATION-REC.
011000     03 FILE-RECORD-INFO-SKELETON.
011100        05 FILLER                 PICTURE X(48)       VALUE
011200             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
011300        05 FILLER                 PICTURE X(46)       VALUE
011400             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
011500        05 FILLER                 PICTURE X(26)       VALUE
011600             ",LFIL=000000,ORG=  ,LBLR= ".
011700        05 FILLER                 PICTURE X(37)       VALUE
011800             ",RECKEY=                             ".
011900        05 FILLER                 PICTURE X(38)       VALUE
012000             ",ALTKEY1=                             ".
012100        05 FILLER                 PICTURE X(38)       VALUE
012200             ",ALTKEY2=                             ".
012300        05 FILLER                 PICTURE X(7)        VALUE SPACE.
012400     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
012500        05 FILE-RECORD-INFO-P1-120.
012600           07 FILLER              PIC X(5).
012700           07 XFILE-NAME           PIC X(6).
012800           07 FILLER              PIC X(8).
012900           07 XRECORD-NAME         PIC X(6).
013000           07 FILLER              PIC X(1).
013100           07 REELUNIT-NUMBER     PIC 9(1).
013200           07 FILLER              PIC X(7).
013300           07 XRECORD-NUMBER       PIC 9(6).
013400           07 FILLER              PIC X(6).
013500           07 UPDATE-NUMBER       PIC 9(2).
013600           07 FILLER              PIC X(5).
013700           07 ODO-NUMBER          PIC 9(4).
013800           07 FILLER              PIC X(5).
013900           07 XPROGRAM-NAME        PIC X(5).
014000           07 FILLER              PIC X(7).
014100           07 XRECORD-LENGTH       PIC 9(6).
014200           07 FILLER              PIC X(7).
014300           07 CHARS-OR-RECORDS    PIC X(2).
014400           07 FILLER              PIC X(1).
014500           07 XBLOCK-SIZE          PIC 9(4).
014600           07 FILLER              PIC X(6).
014700           07 RECORDS-IN-FILE     PIC 9(6).
014800           07 FILLER              PIC X(5).
014900           07 XFILE-ORGANIZATION   PIC X(2).
015000           07 FILLER              PIC X(6).
015100           07 XLABEL-TYPE          PIC X(1).
015200        05 FILE-RECORD-INFO-P121-240.
015300           07 FILLER              PIC X(8).
015400           07 XRECORD-KEY          PIC X(29).
015500           07 FILLER              PIC X(9).
015600           07 ALTERNATE-KEY1      PIC X(29).
015700           07 FILLER              PIC X(9).
015800           07 ALTERNATE-KEY2      PIC X(29).
015900           07 FILLER              PIC X(7).
016000 01  TEST-RESULTS.
016100     02 FILLER                   PIC X      VALUE SPACE.
016200     02 FEATURE                  PIC X(20)  VALUE SPACE.
016300     02 FILLER                   PIC X      VALUE SPACE.
016400     02 P-OR-F                   PIC X(5)   VALUE SPACE.
016500     02 FILLER                   PIC X      VALUE SPACE.
016600     02  PAR-NAME.
016700       03 FILLER                 PIC X(19)  VALUE SPACE.
016800       03  PARDOT-X              PIC X      VALUE SPACE.
016900       03 DOTVALUE               PIC 99     VALUE ZERO.
017000     02 FILLER                   PIC X(8)   VALUE SPACE.
017100     02 RE-MARK                  PIC X(61).
017200 01  TEST-COMPUTED.
017300     02 FILLER                   PIC X(30)  VALUE SPACE.
017400     02 FILLER                   PIC X(17)  VALUE
017500            "       COMPUTED=".
017600     02 COMPUTED-X.
017700     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
017800     03 COMPUTED-N               REDEFINES COMPUTED-A
017900                                 PIC -9(9).9(9).
018000     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
018100     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
018200     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
018300     03       CM-18V0 REDEFINES COMPUTED-A.
018400         04 COMPUTED-18V0                    PIC -9(18).
018500         04 FILLER                           PIC X.
018600     03 FILLER PIC X(50) VALUE SPACE.
018700 01  TEST-CORRECT.
018800     02 FILLER PIC X(30) VALUE SPACE.
018900     02 FILLER PIC X(17) VALUE "       CORRECT =".
019000     02 CORRECT-X.
019100     03 CORRECT-A                  PIC X(20) VALUE SPACE.
019200     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
019300     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
019400     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
019500     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
019600     03      CR-18V0 REDEFINES CORRECT-A.
019700         04 CORRECT-18V0                     PIC -9(18).
019800         04 FILLER                           PIC X.
019900     03 FILLER PIC X(2) VALUE SPACE.
020000     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
020100 01  CCVS-C-1.
020200     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
020300-    "SS  PARAGRAPH-NAME
020400-    "       REMARKS".
020500     02 FILLER                     PIC X(20)    VALUE SPACE.
020600 01  CCVS-C-2.
020700     02 FILLER                     PIC X        VALUE SPACE.
020800     02 FILLER                     PIC X(6)     VALUE "TESTED".
020900     02 FILLER                     PIC X(15)    VALUE SPACE.
021000     02 FILLER                     PIC X(4)     VALUE "FAIL".
021100     02 FILLER                     PIC X(94)    VALUE SPACE.
021200 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
021300 01  REC-CT                        PIC 99       VALUE ZERO.
021400 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
021500 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
021600 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
021700 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
021800 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
021900 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
022000 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
022100 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
022200 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
022300 01  CCVS-H-1.
022400     02  FILLER                    PIC X(39)    VALUE SPACES.
022500     02  FILLER                    PIC X(42)    VALUE
022600     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
022700     02  FILLER                    PIC X(39)    VALUE SPACES.
022800 01  CCVS-H-2A.
022900   02  FILLER                        PIC X(40)  VALUE SPACE.
023000   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
023100   02  FILLER                        PIC XXXX   VALUE
023200     "4.2 ".
023300   02  FILLER                        PIC X(28)  VALUE
023400            " COPY - NOT FOR DISTRIBUTION".
023500   02  FILLER                        PIC X(41)  VALUE SPACE.
023600
023700 01  CCVS-H-2B.
023800   02  FILLER                        PIC X(15)  VALUE
023900            "TEST RESULT OF ".
024000   02  TEST-ID                       PIC X(9).
024100   02  FILLER                        PIC X(4)   VALUE
024200            " IN ".
024300   02  FILLER                        PIC X(12)  VALUE
024400     " HIGH       ".
024500   02  FILLER                        PIC X(22)  VALUE
024600            " LEVEL VALIDATION FOR ".
024700   02  FILLER                        PIC X(58)  VALUE
024800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024900 01  CCVS-H-3.
025000     02  FILLER                      PIC X(34)  VALUE
025100            " FOR OFFICIAL USE ONLY    ".
025200     02  FILLER                      PIC X(58)  VALUE
025300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
025400     02  FILLER                      PIC X(28)  VALUE
025500            "  COPYRIGHT   1985 ".
025600 01  CCVS-E-1.
025700     02 FILLER                       PIC X(52)  VALUE SPACE.
025800     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
025900     02 ID-AGAIN                     PIC X(9).
026000     02 FILLER                       PIC X(45)  VALUE SPACES.
026100 01  CCVS-E-2.
026200     02  FILLER                      PIC X(31)  VALUE SPACE.
026300     02  FILLER                      PIC X(21)  VALUE SPACE.
026400     02 CCVS-E-2-2.
026500         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
026600         03 FILLER                   PIC X      VALUE SPACE.
026700         03 ENDER-DESC               PIC X(44)  VALUE
026800            "ERRORS ENCOUNTERED".
026900 01  CCVS-E-3.
027000     02  FILLER                      PIC X(22)  VALUE
027100            " FOR OFFICIAL USE ONLY".
027200     02  FILLER                      PIC X(12)  VALUE SPACE.
027300     02  FILLER                      PIC X(58)  VALUE
027400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
027500     02  FILLER                      PIC X(13)  VALUE SPACE.
027600     02 FILLER                       PIC X(15)  VALUE
027700             " COPYRIGHT 1985".
027800 01  CCVS-E-4.
027900     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
028000     02 FILLER                       PIC X(4)   VALUE " OF ".
028100     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
028200     02 FILLER                       PIC X(40)  VALUE
028300      "  TESTS WERE EXECUTED SUCCESSFULLY".
028400 01  XXINFO.
028500     02 FILLER                       PIC X(19)  VALUE
028600            "*** INFORMATION ***".
028700     02 INFO-TEXT.
028800       04 FILLER                     PIC X(8)   VALUE SPACE.
028900       04 XXCOMPUTED                 PIC X(20).
029000       04 FILLER                     PIC X(5)   VALUE SPACE.
029100       04 XXCORRECT                  PIC X(20).
029200     02 INF-ANSI-REFERENCE           PIC X(48).
029300 01  HYPHEN-LINE.
029400     02 FILLER  PIC IS X VALUE IS SPACE.
029500     02 FILLER  PIC IS X(65)    VALUE IS "************************
029600-    "*****************************************".
029700     02 FILLER  PIC IS X(54)    VALUE IS "************************
029800-    "******************************".
029900 01  CCVS-PGM-ID                     PIC X(9)   VALUE
030000     "RL118A".
030100 PROCEDURE DIVISION.
030200 CCVS1 SECTION.
030300 OPEN-FILES.
030400     OPEN    OUTPUT PRINT-FILE.
030500     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
030600     MOVE    SPACE TO TEST-RESULTS.
030700     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
030800     MOVE    ZERO TO REC-SKL-SUB.
030900     PERFORM CCVS-INIT-FILE 9 TIMES.
031000 CCVS-INIT-FILE.
031100     ADD     1 TO REC-SKL-SUB.
031200     MOVE    FILE-RECORD-INFO-SKELETON
031300          TO FILE-RECORD-INFO (REC-SKL-SUB).
031400 CCVS-INIT-EXIT.
031500     GO TO CCVS1-EXIT.
031600 CLOSE-FILES.
031700     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
031800 TERMINATE-CCVS.
031900S    EXIT PROGRAM.
032000STERMINATE-CALL.
032100     STOP     RUN.
032200 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
032300 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
032400 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
032500 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
032600     MOVE "****TEST DELETED****" TO RE-MARK.
032700 PRINT-DETAIL.
032800     IF REC-CT NOT EQUAL TO ZERO
032900             MOVE "." TO PARDOT-X
033000             MOVE REC-CT TO DOTVALUE.
033100     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
033200     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
033300        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
033400          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
033500     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
033600     MOVE SPACE TO CORRECT-X.
033700     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
033800     MOVE     SPACE TO RE-MARK.
033900 HEAD-ROUTINE.
034000     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034100     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034200     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
034300     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
034400 COLUMN-NAMES-ROUTINE.
034500     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034600     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
034800 END-ROUTINE.
034900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
035000 END-RTN-EXIT.
035100     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035200 END-ROUTINE-1.
035300      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
035400      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
035500      ADD PASS-COUNTER TO ERROR-HOLD.
035600*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
035700      MOVE PASS-COUNTER TO CCVS-E-4-1.
035800      MOVE ERROR-HOLD TO CCVS-E-4-2.
035900      MOVE CCVS-E-4 TO CCVS-E-2-2.
036000      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
036100  END-ROUTINE-12.
036200      MOVE "TEST(S) FAILED" TO ENDER-DESC.
036300     IF       ERROR-COUNTER IS EQUAL TO ZERO
036400         MOVE "NO " TO ERROR-TOTAL
036500         ELSE
036600         MOVE ERROR-COUNTER TO ERROR-TOTAL.
036700     MOVE     CCVS-E-2 TO DUMMY-RECORD.
036800     PERFORM WRITE-LINE.
036900 END-ROUTINE-13.
037000     IF DELETE-COUNTER IS EQUAL TO ZERO
037100         MOVE "NO " TO ERROR-TOTAL  ELSE
037200         MOVE DELETE-COUNTER TO ERROR-TOTAL.
037300     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
037400     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037500      IF   INSPECT-COUNTER EQUAL TO ZERO
037600          MOVE "NO " TO ERROR-TOTAL
037700      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
037800      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
037900      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038000     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038100 WRITE-LINE.
038200     ADD 1 TO RECORD-COUNT.
038300Y    IF RECORD-COUNT GREATER 50
038400Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
038500Y        MOVE SPACE TO DUMMY-RECORD
038600Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
038700Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
038800Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
038900Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
039000Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
039100Y        MOVE ZERO TO RECORD-COUNT.
039200     PERFORM WRT-LN.
039300 WRT-LN.
039400     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
039500     MOVE SPACE TO DUMMY-RECORD.
039600 BLANK-LINE-PRINT.
039700     PERFORM WRT-LN.
039800 FAIL-ROUTINE.
039900     IF     COMPUTED-X NOT EQUAL TO SPACE
040000            GO TO   FAIL-ROUTINE-WRITE.
040100     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
040200     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
040300     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
040400     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040500     MOVE   SPACES TO INF-ANSI-REFERENCE.
040600     GO TO  FAIL-ROUTINE-EX.
040700 FAIL-ROUTINE-WRITE.
040800     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
040900     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
041000     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
041100     MOVE   SPACES TO COR-ANSI-REFERENCE.
041200 FAIL-ROUTINE-EX. EXIT.
041300 BAIL-OUT.
041400     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
041500     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
041600 BAIL-OUT-WRITE.
041700     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
041800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
041900     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042000     MOVE   SPACES TO INF-ANSI-REFERENCE.
042100 BAIL-OUT-EX. EXIT.
042200 CCVS1-EXIT.
042300     EXIT.
042400 SECT-RL118A-001 SECTION.
042500 REL-INIT-009.
042600     MOVE   "REL-TEST-009"  TO PAR-NAME.
042700     MOVE   "CREATE RL-FD2" TO  FEATURE
042800     MOVE   "RL-FD2"        TO  XFILE-NAME (2).
042900     MOVE   "R1-F-G"        TO  XRECORD-NAME (2).
043000     MOVE    CCVS-PGM-ID    TO  XPROGRAM-NAME (2).
043100     MOVE    000240         TO  XRECORD-LENGTH (2).
043200     MOVE   "RC"            TO  CHARS-OR-RECORDS (2).
043300     MOVE    0001           TO  XBLOCK-SIZE       (2).
043400     MOVE    000500         TO  RECORDS-IN-FILE  (2).
043500     MOVE     "RL"          TO  XFILE-ORGANIZATION (2).
043600     MOVE     "S"           TO  XLABEL-TYPE        (2).
043700     MOVE     000001        TO  XRECORD-NUMBER     (2).
043800*INITIALIZE  RECORD WORK AREA NUMBER 2.
043900     MOVE     1         TO  WRK-CS-09V00-012.
044000     MOVE     ZERO      TO  WRK-CS-09V00-013 WRK-CS-09V00-014
044100                            WRK-CS-09V00-015 WRK-CS-09V00-016
044200                            WRK-CS-09V00-017 WRK-CS-09V00-018.
044300*
044400 REL-INIT-1.
044500     MOVE   "REL-TEST-1" TO PAR-NAME.
044600     MOVE   "VII-3 1.3.4 3C" TO ANSI-REFERENCE.
044700     MOVE    0 TO XRECORD-NUMBER (2).
044800     OPEN    OUTPUT RL-FD2.
044900     MOVE    SPACE TO RL-FD2-STATUS.
045000     PERFORM REL-INIT-1-A 100 TIMES.
045100     GO TO   REL-DELETE-1.
045200 REL-INIT-1-A.
045300     ADD     1 TO XRECORD-NUMBER (2).
045400     MOVE    XRECORD-NUMBER (2) TO RL-FD2-KEY.
045500     MOVE    FILE-RECORD-INFO-P1-120 (2) TO RL-FD2-WRK-120.
045600     MOVE    FILE-RECORD-INFO-P1-120 (2) TO RL-FD2-GRP-120.
045700     WRITE   RL-FD2R1-F-G-240
045800         INVALID GO TO REL-DELETE-1.
045900 REL-DELETE-1.
046000     PERFORM DE-LETE.
046100     PERFORM PRINT-DETAIL.
046200     GO TO   REL-INIT-2.
046300 REL-TEST-1.
046400     IF      RL-FD2-STATUS NOT EQUAL  TO "24"
046500             MOVE   "100TH RECORD SHOULD NOT BE WRITTEN"
046600                  TO RE-MARK
046700             MOVE    RL-FD2-STATUS TO COMPUTED-A
046800             MOVE   "24" TO CORRECT-A
046900             PERFORM FAIL
047000             PERFORM PRINT-DETAIL
047100     ELSE
047200             PERFORM PASS
047300             PERFORM PRINT-DETAIL.
047400*
047500 REL-INIT-2.
047600     MOVE   "REL-TEST-2" TO PAR-NAME.
047700     MOVE   "VII-3 1.3.4 3A" TO ANSI-REFERENCE.
047800     MOVE    SPACE TO RL-FD2-STATUS.
047900     MOVE    27 TO RL-FD2-KEY.
048000     MOVE    FILE-RECORD-INFO-P1-120 (2) TO RL-FD2-WRK-120.
048100     MOVE    FILE-RECORD-INFO-P1-120 (2) TO RL-FD2-GRP-120.
048200     WRITE   RL-FD2R1-F-G-240
048300         INVALID GO TO REL-TEST-2.
048400     GO TO   REL-TEST-2.
048500 REL-DELETE-2.
048600     PERFORM DE-LETE.
048700     PERFORM PRINT-DETAIL.
048800     GO TO   REL-INIT-3.
048900 REL-TEST-2.
049000     IF      RL-FD2-STATUS NOT EQUAL  TO "22"
049100             MOVE   "DUPLICATE KEY SHOULD HAVE OCCURRED"
049200                  TO RE-MARK
049300             MOVE    RL-FD2-STATUS TO COMPUTED-A
049400             MOVE   "22" TO CORRECT-A
049500             PERFORM FAIL
049600             PERFORM PRINT-DETAIL
049700     ELSE
049800             PERFORM PASS
049900             PERFORM PRINT-DETAIL.
050000*
050100*
050200 REL-INIT-3.
050300     MOVE   "REL-TEST-3" TO PAR-NAME.
050400     MOVE   "VII-3 1.3.4 3B" TO ANSI-REFERENCE.
050500     CLOSE   RL-FD2.
050600     OPEN    I-O RL-FD3.
050700     MOVE    999 TO RL-FD3-KEY.
050800     READ RL-FD3 INVALID GO TO REL-TEST-3.
050900     GO TO   REL-TEST-3.
051000 REL-DELETE-3.
051100     PERFORM DE-LETE.
051200     PERFORM PRINT-DETAIL.
051300     GO TO   REL-DELETE-4.
051400 REL-TEST-3.
051500     IF      RL-FD3-STATUS NOT EQUAL  TO "23"
051600             MOVE   "RECORD READ SHOULD NOT EXIST" TO RE-MARK
051700             MOVE    RL-FD3-STATUS TO COMPUTED-A
051800             MOVE   "23" TO CORRECT-A
051900             PERFORM FAIL
052000             PERFORM PRINT-DETAIL
052100     ELSE
052200             PERFORM PASS
052300             PERFORM PRINT-DETAIL.
052400*
052500 REL-INIT-4.
052600     MOVE   "REL-TEST-4" TO PAR-NAME.
052700     MOVE   "VII-3 1.3.4 3C" TO ANSI-REFERENCE.
052800     MOVE    SPACE TO RL-FD2-STATUS.
052900     MOVE    100 TO RL-FD3-KEY.
053000     GO TO REL-DELETE-4.
053100*    WRITE   RL-FD3R1-F-G-240
053200*        INVALID GO TO REL-DELETE-4.
053300*    GO TO   REL-TEST-4.
053400 REL-DELETE-4.
053500     PERFORM DE-LETE.
053600     PERFORM PRINT-DETAIL.
053700     GO TO   REL-TEST-4-EXIT.
053800 REL-TEST-4.
053900     IF      RL-FD3-STATUS NOT EQUAL  TO "24"
054000             MOVE   "BOUNDARY VIOLATION SHOULD HAVE OCCURRED"
054100                  TO RE-MARK
054200             MOVE    RL-FD3-STATUS TO COMPUTED-A
054300             MOVE   "24" TO CORRECT-A
054400             PERFORM FAIL
054500             PERFORM PRINT-DETAIL
054600     ELSE
054700             PERFORM PASS
054800             PERFORM PRINT-DETAIL.
054900 REL-TEST-4-EXIT.
055000     CLOSE RL-FD3.
055100*
055200 CCVS-EXIT SECTION.
055300 CCVS-999999.
055400     GO TO CLOSE-FILES.
