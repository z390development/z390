000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RL109A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*GENERAL:    THE FUNCTION OF THIS PROGRAM IS TO PROCESS A RELATIVE
002200*            I-O FILE RANDOMLY (ACCESS MODE IS RANDOM).  THE FILE
002300*            USED AS INPUT IS THAT FILE CREATED BY RL108A.
002400*
002500*            FIRST THE FILE IS VERIFED AS TO THE EXISTANCE AND
002600*            ACCURACY OF THE 500  RECORDS CREATED IN THE FIRST
002700*            PROGRAM.  SECONDLY, RECORDS OF THE FILE ARE SEL-
002800*            ECTIVELY UPDATED; AND THIRDLY, THE ACCURACY OF EACH
002900*            RECORD IN THE FILE IS AGAIN VERIFIED.
003000*
003100*     THIS PROGRAM TESTS THE NEW SYNTACTICAL CONSTRUCTS AND
003200*     SEMENTIC ACTIONS OF THE FOLLOWING ELEMENTS:
003300*        - ORGANIZATION
003400*        - ACCESS
003500*        - READ
003600*        - REWRITE
003700*
003800*
003900*            X-CARD PARAMETERS WHICH MUST BE SUPPLIED FOR THIS
004000*            PROGRAM ARE:
004100*
004200*                 X-21   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
004300*                         RELATIVE  I-O DATA FILE
004400*                 X-55   SYSTEM PRINTER
004500*                 X-69   ADDITIONAL VALUE OF CLAUSES
004600*                 X-74   VALUE OF IMPLEMENTOR-NAME
004700*                 X-75   OBJECT OF VALUE OF CLAUSE
004800*                 X-82   SOURCE-COMPUTER
004900*                 X-83   OBJECT-COMPUTER.
005000*
005100***************************************************
005200 ENVIRONMENT DIVISION.
005300 CONFIGURATION SECTION.
005400 SOURCE-COMPUTER.
005500     XXXXX082.
005600 OBJECT-COMPUTER.
005700     XXXXX083.
005800 INPUT-OUTPUT SECTION.
005900 FILE-CONTROL.
006000     SELECT PRINT-FILE ASSIGN TO
006100     XXXXX055.
006200     SELECT  RL-FR1 ASSIGN TO
006300     XXXXX061
006400             ORGANIZATION IS RELATIVE
006500             ACCESS  MODE IS RANDOM
006600             RELATIVE RL-FR1-KEY.
006700 DATA DIVISION.
006800 FILE SECTION.
006900 FD  PRINT-FILE.
007000 01  PRINT-REC PICTURE X(120).
007100 01  DUMMY-RECORD PICTURE X(120).
007200 FD  RL-FR1
007300     LABEL RECORDS STANDARD
007400C    VALUE OF
007500C    XXXXX074
007600C    IS
007700C    XXXXX075
007800G    XXXXX069
007900     BLOCK CONTAINS 1 RECORDS
008000     RECORD CONTAINS 120 CHARACTERS.
008100 01  RL-FR1R1-F-G-120.
008200     02 FILLER PICTURE X(120).
008300 WORKING-STORAGE SECTION.
008400 01  WRK-CS-09V00 PIC S9(09)      USAGE COMP VALUE ZERO.
008500 01  RL-FR1-KEY        PIC 9(09)  USAGE COMP VALUE ZERO.
008600 01  WRK-DS-09V00-002 PIC S9(9) VALUE ZERO.
008700 01  WRK-CS-09V00-002 PIC S9(09)       USAGE COMP VALUE ZERO.
008800 01  WRK-CS-09V00-003 PIC S9(09)       USAGE COMP VALUE ZERO.
008900 01  I-O-ERROR-RL-FR1 PIC X(3) VALUE "NO ".
009000 01  WRK-CS-09V00-001 PIC S9(09)       USAGE COMP VALUE ZERO.
009100 01  WRK-CS-09V00-004 PIC S9(09)       USAGE COMP VALUE ZERO.
009200 01  WRK-CS-09V00-005 PIC S9(09)       USAGE COMP VALUE ZERO.
009300 01  WRK-DS-09V00-001 PIC S9(09)      VALUE ZERO.
009400 01  FILE-RECORD-INFORMATION-REC.
009500     03 FILE-RECORD-INFO-SKELETON.
009600        05 FILLER                 PICTURE X(48)       VALUE
009700             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
009800        05 FILLER                 PICTURE X(46)       VALUE
009900             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
010000        05 FILLER                 PICTURE X(26)       VALUE
010100             ",LFIL=000000,ORG=  ,LBLR= ".
010200        05 FILLER                 PICTURE X(37)       VALUE
010300             ",RECKEY=                             ".
010400        05 FILLER                 PICTURE X(38)       VALUE
010500             ",ALTKEY1=                             ".
010600        05 FILLER                 PICTURE X(38)       VALUE
010700             ",ALTKEY2=                             ".
010800        05 FILLER                 PICTURE X(7)        VALUE SPACE.
010900     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
011000        05 FILE-RECORD-INFO-P1-120.
011100           07 FILLER              PIC X(5).
011200           07 XFILE-NAME           PIC X(6).
011300           07 FILLER              PIC X(8).
011400           07 XRECORD-NAME         PIC X(6).
011500           07 FILLER              PIC X(1).
011600           07 REELUNIT-NUMBER     PIC 9(1).
011700           07 FILLER              PIC X(7).
011800           07 XRECORD-NUMBER       PIC 9(6).
011900           07 FILLER              PIC X(6).
012000           07 UPDATE-NUMBER       PIC 9(2).
012100           07 FILLER              PIC X(5).
012200           07 ODO-NUMBER          PIC 9(4).
012300           07 FILLER              PIC X(5).
012400           07 XPROGRAM-NAME        PIC X(5).
012500           07 FILLER              PIC X(7).
012600           07 XRECORD-LENGTH       PIC 9(6).
012700           07 FILLER              PIC X(7).
012800           07 CHARS-OR-RECORDS    PIC X(2).
012900           07 FILLER              PIC X(1).
013000           07 XBLOCK-SIZE          PIC 9(4).
013100           07 FILLER              PIC X(6).
013200           07 RECORDS-IN-FILE     PIC 9(6).
013300           07 FILLER              PIC X(5).
013400           07 XFILE-ORGANIZATION   PIC X(2).
013500           07 FILLER              PIC X(6).
013600           07 XLABEL-TYPE          PIC X(1).
013700        05 FILE-RECORD-INFO-P121-240.
013800           07 FILLER              PIC X(8).
013900           07 XRECORD-KEY          PIC X(29).
014000           07 FILLER              PIC X(9).
014100           07 ALTERNATE-KEY1      PIC X(29).
014200           07 FILLER              PIC X(9).
014300           07 ALTERNATE-KEY2      PIC X(29).
014400           07 FILLER              PIC X(7).
014500 01  TEST-RESULTS.
014600     02 FILLER                   PIC X      VALUE SPACE.
014700     02 FEATURE                  PIC X(20)  VALUE SPACE.
014800     02 FILLER                   PIC X      VALUE SPACE.
014900     02 P-OR-F                   PIC X(5)   VALUE SPACE.
015000     02 FILLER                   PIC X      VALUE SPACE.
015100     02  PAR-NAME.
015200       03 FILLER                 PIC X(19)  VALUE SPACE.
015300       03  PARDOT-X              PIC X      VALUE SPACE.
015400       03 DOTVALUE               PIC 99     VALUE ZERO.
015500     02 FILLER                   PIC X(8)   VALUE SPACE.
015600     02 RE-MARK                  PIC X(61).
015700 01  TEST-COMPUTED.
015800     02 FILLER                   PIC X(30)  VALUE SPACE.
015900     02 FILLER                   PIC X(17)  VALUE
016000            "       COMPUTED=".
016100     02 COMPUTED-X.
016200     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
016300     03 COMPUTED-N               REDEFINES COMPUTED-A
016400                                 PIC -9(9).9(9).
016500     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
016600     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
016700     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
016800     03       CM-18V0 REDEFINES COMPUTED-A.
016900         04 COMPUTED-18V0                    PIC -9(18).
017000         04 FILLER                           PIC X.
017100     03 FILLER PIC X(50) VALUE SPACE.
017200 01  TEST-CORRECT.
017300     02 FILLER PIC X(30) VALUE SPACE.
017400     02 FILLER PIC X(17) VALUE "       CORRECT =".
017500     02 CORRECT-X.
017600     03 CORRECT-A                  PIC X(20) VALUE SPACE.
017700     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
017800     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
017900     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
018000     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
018100     03      CR-18V0 REDEFINES CORRECT-A.
018200         04 CORRECT-18V0                     PIC -9(18).
018300         04 FILLER                           PIC X.
018400     03 FILLER PIC X(2) VALUE SPACE.
018500     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
018600 01  CCVS-C-1.
018700     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
018800-    "SS  PARAGRAPH-NAME
018900-    "       REMARKS".
019000     02 FILLER                     PIC X(20)    VALUE SPACE.
019100 01  CCVS-C-2.
019200     02 FILLER                     PIC X        VALUE SPACE.
019300     02 FILLER                     PIC X(6)     VALUE "TESTED".
019400     02 FILLER                     PIC X(15)    VALUE SPACE.
019500     02 FILLER                     PIC X(4)     VALUE "FAIL".
019600     02 FILLER                     PIC X(94)    VALUE SPACE.
019700 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
019800 01  REC-CT                        PIC 99       VALUE ZERO.
019900 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
020000 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
020100 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
020200 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
020300 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
020400 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
020500 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
020600 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
020700 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
020800 01  CCVS-H-1.
020900     02  FILLER                    PIC X(39)    VALUE SPACES.
021000     02  FILLER                    PIC X(42)    VALUE
021100     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
021200     02  FILLER                    PIC X(39)    VALUE SPACES.
021300 01  CCVS-H-2A.
021400   02  FILLER                        PIC X(40)  VALUE SPACE.
021500   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
021600   02  FILLER                        PIC XXXX   VALUE
021700     "4.2 ".
021800   02  FILLER                        PIC X(28)  VALUE
021900            " COPY - NOT FOR DISTRIBUTION".
022000   02  FILLER                        PIC X(41)  VALUE SPACE.
022100
022200 01  CCVS-H-2B.
022300   02  FILLER                        PIC X(15)  VALUE
022400            "TEST RESULT OF ".
022500   02  TEST-ID                       PIC X(9).
022600   02  FILLER                        PIC X(4)   VALUE
022700            " IN ".
022800   02  FILLER                        PIC X(12)  VALUE
022900     " HIGH       ".
023000   02  FILLER                        PIC X(22)  VALUE
023100            " LEVEL VALIDATION FOR ".
023200   02  FILLER                        PIC X(58)  VALUE
023300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
023400 01  CCVS-H-3.
023500     02  FILLER                      PIC X(34)  VALUE
023600            " FOR OFFICIAL USE ONLY    ".
023700     02  FILLER                      PIC X(58)  VALUE
023800     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
023900     02  FILLER                      PIC X(28)  VALUE
024000            "  COPYRIGHT   1985 ".
024100 01  CCVS-E-1.
024200     02 FILLER                       PIC X(52)  VALUE SPACE.
024300     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
024400     02 ID-AGAIN                     PIC X(9).
024500     02 FILLER                       PIC X(45)  VALUE SPACES.
024600 01  CCVS-E-2.
024700     02  FILLER                      PIC X(31)  VALUE SPACE.
024800     02  FILLER                      PIC X(21)  VALUE SPACE.
024900     02 CCVS-E-2-2.
025000         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
025100         03 FILLER                   PIC X      VALUE SPACE.
025200         03 ENDER-DESC               PIC X(44)  VALUE
025300            "ERRORS ENCOUNTERED".
025400 01  CCVS-E-3.
025500     02  FILLER                      PIC X(22)  VALUE
025600            " FOR OFFICIAL USE ONLY".
025700     02  FILLER                      PIC X(12)  VALUE SPACE.
025800     02  FILLER                      PIC X(58)  VALUE
025900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
026000     02  FILLER                      PIC X(13)  VALUE SPACE.
026100     02 FILLER                       PIC X(15)  VALUE
026200             " COPYRIGHT 1985".
026300 01  CCVS-E-4.
026400     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
026500     02 FILLER                       PIC X(4)   VALUE " OF ".
026600     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
026700     02 FILLER                       PIC X(40)  VALUE
026800      "  TESTS WERE EXECUTED SUCCESSFULLY".
026900 01  XXINFO.
027000     02 FILLER                       PIC X(19)  VALUE
027100            "*** INFORMATION ***".
027200     02 INFO-TEXT.
027300       04 FILLER                     PIC X(8)   VALUE SPACE.
027400       04 XXCOMPUTED                 PIC X(20).
027500       04 FILLER                     PIC X(5)   VALUE SPACE.
027600       04 XXCORRECT                  PIC X(20).
027700     02 INF-ANSI-REFERENCE           PIC X(48).
027800 01  HYPHEN-LINE.
027900     02 FILLER  PIC IS X VALUE IS SPACE.
028000     02 FILLER  PIC IS X(65)    VALUE IS "************************
028100-    "*****************************************".
028200     02 FILLER  PIC IS X(54)    VALUE IS "************************
028300-    "******************************".
028400 01  CCVS-PGM-ID                     PIC X(9)   VALUE
028500     "RL109A".
028600 PROCEDURE DIVISION.
028700 CCVS1 SECTION.
028800 OPEN-FILES.
028900     OPEN    OUTPUT PRINT-FILE.
029000     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
029100     MOVE    SPACE TO TEST-RESULTS.
029200     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
029300     MOVE    ZERO TO REC-SKL-SUB.
029400     PERFORM CCVS-INIT-FILE 9 TIMES.
029500 CCVS-INIT-FILE.
029600     ADD     1 TO REC-SKL-SUB.
029700     MOVE    FILE-RECORD-INFO-SKELETON
029800          TO FILE-RECORD-INFO (REC-SKL-SUB).
029900 CCVS-INIT-EXIT.
030000     GO TO CCVS1-EXIT.
030100 CLOSE-FILES.
030200     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
030300 TERMINATE-CCVS.
030400S    EXIT PROGRAM.
030500STERMINATE-CALL.
030600     STOP     RUN.
030700 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
030800 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
030900 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
031000 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
031100     MOVE "****TEST DELETED****" TO RE-MARK.
031200 PRINT-DETAIL.
031300     IF REC-CT NOT EQUAL TO ZERO
031400             MOVE "." TO PARDOT-X
031500             MOVE REC-CT TO DOTVALUE.
031600     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
031700     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
031800        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
031900          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
032000     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
032100     MOVE SPACE TO CORRECT-X.
032200     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
032300     MOVE     SPACE TO RE-MARK.
032400 HEAD-ROUTINE.
032500     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032600     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032700     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
032800     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
032900 COLUMN-NAMES-ROUTINE.
033000     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033100     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
033300 END-ROUTINE.
033400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033500 END-RTN-EXIT.
033600     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033700 END-ROUTINE-1.
033800      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
033900      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
034000      ADD PASS-COUNTER TO ERROR-HOLD.
034100*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
034200      MOVE PASS-COUNTER TO CCVS-E-4-1.
034300      MOVE ERROR-HOLD TO CCVS-E-4-2.
034400      MOVE CCVS-E-4 TO CCVS-E-2-2.
034500      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
034600  END-ROUTINE-12.
034700      MOVE "TEST(S) FAILED" TO ENDER-DESC.
034800     IF       ERROR-COUNTER IS EQUAL TO ZERO
034900         MOVE "NO " TO ERROR-TOTAL
035000         ELSE
035100         MOVE ERROR-COUNTER TO ERROR-TOTAL.
035200     MOVE     CCVS-E-2 TO DUMMY-RECORD.
035300     PERFORM WRITE-LINE.
035400 END-ROUTINE-13.
035500     IF DELETE-COUNTER IS EQUAL TO ZERO
035600         MOVE "NO " TO ERROR-TOTAL  ELSE
035700         MOVE DELETE-COUNTER TO ERROR-TOTAL.
035800     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
035900     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036000      IF   INSPECT-COUNTER EQUAL TO ZERO
036100          MOVE "NO " TO ERROR-TOTAL
036200      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
036300      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
036400      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036500     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036600 WRITE-LINE.
036700     ADD 1 TO RECORD-COUNT.
036800Y    IF RECORD-COUNT GREATER 50
036900Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
037000Y        MOVE SPACE TO DUMMY-RECORD
037100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
037200Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
037300Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
037400Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
037500Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
037600Y        MOVE ZERO TO RECORD-COUNT.
037700     PERFORM WRT-LN.
037800 WRT-LN.
037900     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
038000     MOVE SPACE TO DUMMY-RECORD.
038100 BLANK-LINE-PRINT.
038200     PERFORM WRT-LN.
038300 FAIL-ROUTINE.
038400     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
038500     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
038600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
038700     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
038800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038900     MOVE   SPACES TO INF-ANSI-REFERENCE.
039000     GO TO  FAIL-ROUTINE-EX.
039100 FAIL-ROUTINE-WRITE.
039200     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
039300     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
039400     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
039500     MOVE   SPACES TO COR-ANSI-REFERENCE.
039600 FAIL-ROUTINE-EX. EXIT.
039700 BAIL-OUT.
039800     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
039900     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
040000 BAIL-OUT-WRITE.
040100     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
040200     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
040300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040400     MOVE   SPACES TO INF-ANSI-REFERENCE.
040500 BAIL-OUT-EX. EXIT.
040600 CCVS1-EXIT.
040700     EXIT.
040800 SECT-RL109A-001 SECTION.
040900 REL-INIT-003.
041000     OPEN    INPUT  RL-FR1.
041100     MOVE   "REL-TEST-003"   TO PAR-NAME.
041200     MOVE    ZERO TO   RL-FR1-KEY.
041300     MOVE    ZERO TO   WRK-CS-09V00-002
041400     MOVE    ZERO  TO  WRK-CS-09V00-003
041500*
041600     MOVE    01 TO REC-CT.
041700     MOVE   "READ RANDOM"  TO FEATURE.
041800 REL-TEST-003-R.
041900     ADD     1 TO WRK-CS-09V00-003
042000     MOVE    WRK-CS-09V00-003 TO RL-FR1-KEY.
042100     IF      RL-FR1-KEY GREATER +501
042200             MOVE "INVALID KEY NOT TAKEN" TO COMPUTED-A
042300             MOVE RL-FR1-KEY TO CORRECT-18V0
042400             PERFORM FAIL
042500             PERFORM PRINT-DETAIL
042600             ADD 1 TO REC-CT
042700             GO TO REL-WRITE-003.
042800     READ    RL-FR1
042900             INVALID GO TO REL-WRITE-003
043000         NOT INVALID GO TO REL-TEST-003-A
043100     END-READ.
043200 REL-TEST-003-A.
043300     MOVE    RL-FR1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
043400     IF      XRECORD-NUMBER (1) EQUAL TO RL-FR1-KEY
043500             GO TO  REL-TEST-003-R.
043600     MOVE   "YES" TO I-O-ERROR-RL-FR1.
043700     ADD     1 TO WRK-CS-09V00-002
043800     GO TO   REL-TEST-003-R.
043900 REL-WRITE-003.
044000     MOVE   "VIII-26 4.5.4"  TO ANSI-REFERENCE.
044100     IF      RL-FR1-KEY NOT EQUAL TO 501
044200             MOVE "WRONG KEY/NOT 500" TO CORRECT-A
044300             MOVE  RL-FR1-KEY TO COMPUTED-18V0
044400             PERFORM FAIL
044500     ELSE
044600             PERFORM PASS.
044700     PERFORM PRINT-DETAIL.
044800*
044900*01
045000*
045100     ADD     1 TO REC-CT.
045200     IF      XRECORD-NUMBER (1) NOT EQUAL TO 500
045300             MOVE "WRONG RECORD/NOT 500" TO CORRECT-A
045400             MOVE  XRECORD-NUMBER (1) TO COMPUTED-18V0
045500             PERFORM FAIL
045600     ELSE
045700             PERFORM PASS.
045800     PERFORM PRINT-DETAIL.
045900*
046000*02
046100*
046200     ADD     1 TO REC-CT.
046300     IF      WRK-CS-09V00-003 NOT EQUAL TO 501
046400             MOVE "INCORRECT RECORD COUNT" TO RE-MARK
046500             MOVE  WRK-CS-09V00-003 TO COMPUTED-18V0
046600             MOVE 501  TO CORRECT-18V0
046700             PERFORM FAIL
046800     ELSE
046900             PERFORM PASS.
047000     PERFORM PRINT-DETAIL.
047100*
047200*03
047300*
047400     ADD     1 TO REC-CT.
047500     IF      I-O-ERROR-RL-FR1 EQUAL TO "YES"
047600             MOVE WRK-CS-09V00-002 TO COMPUTED-18V0
047700             MOVE "RECORDS DID NOT COMPARE" TO RE-MARK
047800             PERFORM FAIL
047900     ELSE
048000             PERFORM PASS.
048100     PERFORM PRINT-DETAIL.
048200*
048300*04
048400*
048500     ADD      1 TO REC-CT.
048600     CLOSE    RL-FR1.
048700 REL-INIT-004-R .
048800     MOVE    "VIII-30 4.6.4"  TO ANSI-REFERENCE.
048900     MOVE    "REL-TEST-004" TO PAR-NAME.
049000     OPEN I-O RL-FR1.
049100     MOVE     ZERO TO RL-FR1-KEY.
049200     MOVE     ZERO TO WRK-CS-09V00-002.
049300     MOVE     ZERO TO WRK-CS-09V00-003.
049400     MOVE     ZERO TO WRK-CS-09V00-004.
049500     MOVE     ZERO TO WRK-CS-09V00-005.
049600*
049700     MOVE     01 TO REC-CT.
049800     MOVE     SPACE TO  FILE-RECORD-INFO-P1-120 (1).
049900     MOVE    "REWRITE"  TO FEATURE.
050000 REL-TEST-004-R.
050100     ADD     5 TO  WRK-CS-09V00-003.
050200     MOVE    WRK-CS-09V00-003 TO RL-FR1-KEY.
050300      IF     RL-FR1-KEY GREATER 505
050400             MOVE "INVALID KEY/NOT TAKEN" TO COMPUTED-A
050500             MOVE  RL-FR1-KEY TO CORRECT-18V0
050600             PERFORM FAIL
050700             PERFORM PRINT-DETAIL
050800             ADD 1 TO REC-CT
050900             GO TO REL-TEST-004-3.
051000     READ    RL-FR1
051100             INVALID KEY GO TO REL-TEST-004-1
051200         NOT INVALID KEY GO TO REL-TEST-004-A
051300     END-READ.
051400 REL-TEST-004-A.
051500     MOVE    RL-FR1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1)
051600     ADD     01 TO UPDATE-NUMBER (1).
051700     MOVE    CCVS-PGM-ID   TO XPROGRAM-NAME (1).
051800     MOVE    FILE-RECORD-INFO-P1-120 (1) TO RL-FR1R1-F-G-120.
051900     REWRITE RL-FR1R1-F-G-120
052000             INVALID KEY GO TO REL-TEST-004-2
052100         NOT INVALID KEY GO TO REL-TEST-004-R
052200     END-REWRITE.
052300 REL-TEST-004-1.
052400     IF      RL-FR1-KEY LESS THAN 501
052500             ADD 1 TO  WRK-CS-09V00-004
052600             GO TO   REL-TEST-004-R.
052700     PERFORM PASS.
052800     PERFORM PRINT-DETAIL.
052900*
053000*01
053100*
053200     ADD     1  TO REC-CT.
053300     GO TO   REL-TEST-004-3.
053400 REL-TEST-004-2.
053500     ADD     1 TO WRK-CS-09V00-005.
053600     IF      RL-FR1-KEY LESS 501
053700             GO TO   REL-TEST-004-R.
053800 REL-TEST-004-3.
053900     IF      WRK-CS-09V00-004 NOT EQUAL TO ZERO
054000             MOVE "INVALID KEY ON READ" TO COMPUTED-A
054100             MOVE WRK-CS-09V00-004 TO CORRECT-18V0
054200             PERFORM FAIL
054300     ELSE
054400             PERFORM PASS.
054500     PERFORM PRINT-DETAIL.
054600*
054700*02
054800*
054900     ADD     1 TO REC-CT.
055000     IF      WRK-CS-09V00-005 NOT EQUAL TO ZERO
055100             MOVE "INVALID KEY ON REWRITE" TO COMPUTED-A
055200             MOVE  WRK-CS-09V00-005 TO CORRECT-18V0
055300             PERFORM FAIL
055400     ELSE
055500             PERFORM PASS.
055600     PERFORM PRINT-DETAIL.
055700*
055800*03
055900*
056000     ADD     1 TO REC-CT.
056100     CLOSE   RL-FR1.
056200 REL-INIT-005.
056300     MOVE   "VIII-26 4.5.4" TO ANSI-REFERENCE.
056400     MOVE   "REL-TEST-005"  TO PAR-NAME.
056500     OPEN    INPUT  RL-FR1.
056600     MOVE    501  TO WRK-CS-09V00-003.
056700     MOVE    ZERO TO WRK-CS-09V00-004.
056800     MOVE    ZERO TO WRK-CS-09V00-005.
056900     MOVE    ZERO TO WRK-CS-09V00-002.
057000     MOVE    SPACE TO  FILE-RECORD-INFO-P1-120 (1).
057100     MOVE    01 TO REC-CT.
057200*
057300     MOVE   "READ RANDOM"  TO FEATURE.
057400 REL-TEST-005-R.
057500     SUBTRACT 1 FROM    WRK-CS-09V00-003.
057600     MOVE    WRK-CS-09V00-003 TO RL-FR1-KEY.
057700     IF      WRK-CS-09V00-003 LESS THAN ZERO
057800             MOVE    "INVALID KEY/NOT TAKEN"  TO RE-MARK
057900             MOVE   WRK-CS-09V00-003  TO COMPUTED-18V0
058000             MOVE   ZERO TO CORRECT-18V0
058100             PERFORM FAIL
058200             PERFORM PRINT-DETAIL
058300             ADD 1 TO REC-CT
058400             GO TO REL-TEST-005-3.
058500     READ    RL-FR1
058600             INVALID KEY  GO TO REL-TEST-005-1
058700         NOT INVALID KEY  GO TO REL-TEST-005-A
058800     END-READ.
058900 REL-TEST-005-A.
059000     MOVE    RL-FR1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
059100     IF      UPDATE-NUMBER (1) EQUAL TO 00
059200             ADD 1 TO WRK-CS-09V00-004.
059300     IF      UPDATE-NUMBER (1) EQUAL TO 01
059400             ADD 1 TO WRK-CS-09V00-005.
059500     GO TO   REL-TEST-005-R.
059600 REL-TEST-005-1.
059700     IF      RL-FR1-KEY GREATER ZERO
059800             ADD 1 TO WRK-CS-09V00-002
059900             GO TO REL-TEST-005-R.
060000     PERFORM PASS.
060100     PERFORM PRINT-DETAIL.
060200     ADD     1  TO REC-CT.
060300*01
060400     GO TO   REL-TEST-005-3.
060500 REL-TEST-005-3.
060600     IF      WRK-CS-09V00-004 NOT EQUAL TO 400
060700             MOVE "NON-UPDATED RECORDS" TO COMPUTED-A
060800             MOVE WRK-CS-09V00-004 TO CORRECT-18V0
060900             MOVE "SHOULD BE 400" TO RE-MARK
061000             PERFORM FAIL
061100     ELSE
061200             PERFORM PASS.
061300     PERFORM PRINT-DETAIL.
061400*
061500*
061600*02
061700*
061800     ADD     1 TO REC-CT.
061900     IF      WRK-CS-09V00-005 NOT EQUAL TO 100
062000             MOVE "UPDATED RECORDS" TO COMPUTED-A
062100             MOVE WRK-CS-09V00-005 TO CORRECT-18V0
062200             MOVE "SHOULD BE 100" TO RE-MARK
062300             PERFORM FAIL
062400     ELSE
062500             PERFORM PASS.
062600     PERFORM PRINT-DETAIL.
062700*
062800*03
062900*
063000     ADD     1 TO REC-CT.
063100     IF      WRK-CS-09V00-002 GREATER 1
063200             MOVE WRK-CS-09V00-002 TO COMPUTED-N
063300             MOVE  "INVALID KEY/READS" TO CORRECT-A
063400             PERFORM FAIL
063500     ELSE
063600             PERFORM PASS.
063700     PERFORM PRINT-DETAIL.
063800*
063900*04
064000*
064100     ADD     1 TO REC-CT.
064200     CLOSE   RL-FR1.
064300 CCVS-EXIT SECTION.
064400 CCVS-999999.
064500     GO TO CLOSE-FILES.
