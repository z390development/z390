000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ221A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200*        THIS ROUTINE CHECKS:
001300*
001400*           RECORD    VARYING    DEPENDING RECORD-LENGTH
001500*
001600*
001700*        THIS ROUTINE BUILDS A SEQUENTIAL MASS STORAGE FILE
001800*    WHICH CONTAINS BOTH 120 CHARACTER AND 151 CHARACTER
001900*    RECORDS.  THE MASS STORAGE FILE CONSISTS OF 1 SHORT,
002000*    1 LONG, 10 SHORT, 100 LONG, AND 338 SHORT RECORDS FOR
002100*    A TOTAL OF 450 RECORDS IN THE FILE.  THE MASS STORAGE
002200*    FILE IS READ AND FIELDS IN THE RECORDS ARE CHECKED
002300*    AGAINST THE EXPECTED VALUES.
002400*
002500*        AN INFORMATION SECTION AT THE END OF THE ROUTINE
002600*    CHECKS THE FIELD WHICH CONTAINS THE XRECORD-NUMBER.
002700*    THIS FIELD IS PART OF A LONG RECORD ONLY.  IF THE
002800*    XRECORD-NUMBER IS THERE FOR A SHORT RECORD, IT MEANS
002900*    THE MAXIMUM SIZE RECORD IS ALWAYS WRITTEN.
003000 ENVIRONMENT DIVISION.
003100 CONFIGURATION SECTION.
003200 SOURCE-COMPUTER.
003300     XXXXX082.
003400 OBJECT-COMPUTER.
003500     XXXXX083.
003600 INPUT-OUTPUT SECTION.
003700 FILE-CONTROL.
003800P    SELECT RAW-DATA   ASSIGN TO
003900P    XXXXX062
004000P           ORGANIZATION IS INDEXED
004100P           ACCESS MODE IS RANDOM
004200P           RECORD KEY IS RAW-DATA-KEY.
004300     SELECT PRINT-FILE ASSIGN TO
004400     XXXXX055.
004500     SELECT SQ-VS7 ASSIGN TO
004600     XXXXX014
004700     ORGANIZATION SEQUENTIAL
004800     ACCESS SEQUENTIAL.
004900 DATA DIVISION.
005000 FILE SECTION.
005100P
005200PFD  RAW-DATA.
005300P
005400P01  RAW-DATA-SATZ.
005500P    05  RAW-DATA-KEY        PIC X(6).
005600P    05  C-DATE              PIC 9(6).
005700P    05  C-TIME              PIC 9(8).
005800P    05  C-NO-OF-TESTS       PIC 99.
005900P    05  C-OK                PIC 999.
006000P    05  C-ALL               PIC 999.
006100P    05  C-FAIL              PIC 999.
006200P    05  C-DELETED           PIC 999.
006300P    05  C-INSPECT           PIC 999.
006400P    05  C-NOTE              PIC X(13).
006500P    05  C-INDENT            PIC X.
006600P    05  C-ABORT             PIC X(8).
006700 FD  PRINT-FILE
006800C    LABEL RECORDS
006900C    XXXXX084
007000C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007100               .
007200 01  PRINT-REC PICTURE X(120).
007300 01  DUMMY-RECORD PICTURE X(120).
007400 FD  SQ-VS7
007500C    LABEL RECORDS ARE STANDARD
007600     RECORD    VARYING    DEPENDING RECORD-LENGTH.
007700 01  SQ-VS7R1-M-G-120.
007800     02  SQ-VS7R1-FIRST PICTURE X(120).
007900 01  SQ-VS7R2-M-G-151.
008000     02  SQ-VS7R2-FIRST PICTURE X(120).
008100     02  LONG-OR-SHORT  PICTURE X(5).
008200     02  SQ-VS7-RECNO  PICTURE X(5).
008300 02  SQ-VS7-FILLER  PICTURE X(21).
008400 WORKING-STORAGE SECTION.
008500 01  RECORD-LENGTH       PICTURE 999  VALUE ZERO.
008600 01  SAVE-COUNT-OF-RECS  PICTURE X(5) VALUE SPACE.
008700 01  COUNT-OF-RECS  PICTURE S9(5) COMPUTATIONAL.
008800 01  RECORDS-IN-ERROR  PICTURE S9(5) COMPUTATIONAL.
008900 01  ERROR-FLAG PICTURE 9.
009000 01  EOF-FLAG  PICTURE 9.
009100 01  DUMP-AREA.
009200     02  TYPE-OF-REC PICTURE X(5).
009300     02  RECNO  PICTURE 9(5).
009400     02  REC-FILLER PICTURE X(21).
009500 01  FILE-RECORD-INFORMATION-REC.
009600     03 FILE-RECORD-INFO-SKELETON.
009700        05 FILLER                 PICTURE X(48)       VALUE
009800             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
009900        05 FILLER                 PICTURE X(46)       VALUE
010000             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
010100        05 FILLER                 PICTURE X(26)       VALUE
010200             ",LFIL=000000,ORG=  ,LBLR= ".
010300        05 FILLER                 PICTURE X(37)       VALUE
010400             ",RECKEY=                             ".
010500        05 FILLER                 PICTURE X(38)       VALUE
010600             ",ALTKEY1=                             ".
010700        05 FILLER                 PICTURE X(38)       VALUE
010800             ",ALTKEY2=                             ".
010900        05 FILLER                 PICTURE X(7)        VALUE SPACE.
011000     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
011100        05 FILE-RECORD-INFO-P1-120.
011200           07 FILLER              PIC X(5).
011300           07 XFILE-NAME           PIC X(6).
011400           07 FILLER              PIC X(8).
011500           07 XRECORD-NAME         PIC X(6).
011600           07 FILLER              PIC X(1).
011700           07 REELUNIT-NUMBER     PIC 9(1).
011800           07 FILLER              PIC X(7).
011900           07 XRECORD-NUMBER       PIC 9(6).
012000           07 FILLER              PIC X(6).
012100           07 UPDATE-NUMBER       PIC 9(2).
012200           07 FILLER              PIC X(5).
012300           07 ODO-NUMBER          PIC 9(4).
012400           07 FILLER              PIC X(5).
012500           07 XPROGRAM-NAME        PIC X(5).
012600           07 FILLER              PIC X(7).
012700           07 XRECORD-LENGTH       PIC 9(6).
012800           07 FILLER              PIC X(7).
012900           07 CHARS-OR-RECORDS    PIC X(2).
013000           07 FILLER              PIC X(1).
013100           07 XBLOCK-SIZE          PIC 9(4).
013200           07 FILLER              PIC X(6).
013300           07 RECORDS-IN-FILE     PIC 9(6).
013400           07 FILLER              PIC X(5).
013500           07 XFILE-ORGANIZATION   PIC X(2).
013600           07 FILLER              PIC X(6).
013700           07 XLABEL-TYPE          PIC X(1).
013800        05 FILE-RECORD-INFO-P121-240.
013900           07 FILLER              PIC X(8).
014000           07 XRECORD-KEY          PIC X(29).
014100           07 FILLER              PIC X(9).
014200           07 ALTERNATE-KEY1      PIC X(29).
014300           07 FILLER              PIC X(9).
014400           07 ALTERNATE-KEY2      PIC X(29).
014500           07 FILLER              PIC X(7).
014600 01  TEST-RESULTS.
014700     02 FILLER                    PICTURE X VALUE SPACE.
014800     02 FEATURE                   PICTURE X(20) VALUE SPACE.
014900     02 FILLER                    PICTURE X VALUE SPACE.
015000     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
015100     02 FILLER                    PICTURE X  VALUE SPACE.
015200     02  PAR-NAME.
015300       03 FILLER PICTURE X(12) VALUE SPACE.
015400       03  PARDOT-X PICTURE X  VALUE SPACE.
015500       03 DOTVALUE PICTURE 99  VALUE ZERO.
015600       03 FILLER PIC X(5) VALUE SPACE.
015700     02 FILLER PIC X(10) VALUE SPACE.
015800     02 RE-MARK PIC X(61).
015900 01  TEST-COMPUTED.
016000     02 FILLER PIC X(30) VALUE SPACE.
016100     02 FILLER PIC X(17) VALUE "       COMPUTED=".
016200     02 COMPUTED-X.
016300     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
016400     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
016500     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
016600     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
016700     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
016800     03       CM-18V0 REDEFINES COMPUTED-A.
016900         04 COMPUTED-18V0                   PICTURE -9(18).
017000         04 FILLER                          PICTURE X.
017100     03 FILLER PIC X(50) VALUE SPACE.
017200 01  TEST-CORRECT.
017300     02 FILLER PIC X(30) VALUE SPACE.
017400     02 FILLER PIC X(17) VALUE "       CORRECT =".
017500     02 CORRECT-X.
017600     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
017700     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
017800     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
017900     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
018000     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
018100     03      CR-18V0 REDEFINES CORRECT-A.
018200         04 CORRECT-18V0                    PICTURE -9(18).
018300         04 FILLER                          PICTURE X.
018400     03 FILLER PIC X(50) VALUE SPACE.
018500 01  CCVS-C-1.
018600     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
018700-    "SS  PARAGRAPH-NAME
018800-    "        REMARKS".
018900     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
019000 01  CCVS-C-2.
019100     02 FILLER PICTURE IS X VALUE IS SPACE.
019200     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
019300     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
019400     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
019500     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
019600 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
019700 01  REC-CT PICTURE 99 VALUE ZERO.
019800 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
019900 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
020000 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
020100 01  PASS-COUNTER PIC 999 VALUE ZERO.
020200 01  TOTAL-ERROR PIC 999 VALUE ZERO.
020300 01  ERROR-HOLD PIC 999 VALUE ZERO.
020400 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
020500 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
020600 01  CCVS-H-1.
020700     02  FILLER   PICTURE X(27)  VALUE SPACE.
020800     02 FILLER PICTURE X(67) VALUE
020900     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
021000-    " SYSTEM".
021100     02  FILLER     PICTURE X(26)  VALUE SPACE.
021200 01  CCVS-H-2.
021300     02 FILLER PICTURE X(52) VALUE IS
021400     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
021500     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
021600     02 TEST-ID PICTURE IS X(9).
021700     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
021800 01  CCVS-H-3.
021900     02  FILLER PICTURE X(34) VALUE
022000     " FOR OFFICIAL USE ONLY    ".
022100     02  FILLER PICTURE X(58) VALUE
022200     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022300     02  FILLER PICTURE X(28) VALUE
022400     "  COPYRIGHT   1985 ".
022500 01  CCVS-E-1.
022600     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
022700     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
022800     02 ID-AGAIN PICTURE IS X(9).
022900     02 FILLER PICTURE X(45) VALUE IS
023000     " NTIS DISTRIBUTION COBOL 85".
023100 01  CCVS-E-2.
023200     02  FILLER                   PICTURE X(31)  VALUE
023300     SPACE.
023400     02  FILLER                   PICTURE X(21)  VALUE SPACE.
023500     02 CCVS-E-2-2.
023600         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
023700         03 FILLER PICTURE IS X VALUE IS SPACE.
023800         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
023900 01  CCVS-E-3.
024000     02  FILLER PICTURE X(22) VALUE
024100     " FOR OFFICIAL USE ONLY".
024200     02  FILLER PICTURE X(12) VALUE SPACE.
024300     02  FILLER PICTURE X(58) VALUE
024400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024500     02  FILLER PICTURE X(13) VALUE SPACE.
024600     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
024700 01  CCVS-E-4.
024800     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
024900     02 FILLER PIC XXXX VALUE " OF ".
025000     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
025100     02 FILLER PIC X(40) VALUE
025200      "  TESTS WERE EXECUTED SUCCESSFULLY".
025300 01  XXINFO.
025400     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
025500     02 INFO-TEXT.
025600     04 FILLER PIC X(20) VALUE SPACE.
025700     04 XXCOMPUTED PIC X(20).
025800     04 FILLER PIC X(5) VALUE SPACE.
025900     04 XXCORRECT PIC X(20).
026000 01  HYPHEN-LINE.
026100     02 FILLER PICTURE IS X VALUE IS SPACE.
026200     02 FILLER PICTURE IS X(65) VALUE IS "************************
026300-    "*****************************************".
026400     02 FILLER PICTURE IS X(54) VALUE IS "************************
026500-    "******************************".
026600 01  CCVS-PGM-ID PIC X(6) VALUE
026700     "SQ221A".
026800 PROCEDURE DIVISION.
026900 CCVS1 SECTION.
027000 OPEN-FILES.
027100P    OPEN I-O RAW-DATA.
027200P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
027300P    READ RAW-DATA INVALID KEY GO TO END-E-1.
027400P    MOVE "ABORTED " TO C-ABORT.
027500P    ADD 1 TO C-NO-OF-TESTS.
027600P    ACCEPT C-DATE  FROM DATE.
027700P    ACCEPT C-TIME  FROM TIME.
027800P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
027900PEND-E-1.
028000P    CLOSE RAW-DATA.
028100     OPEN     OUTPUT PRINT-FILE.
028200     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
028300     MOVE    SPACE TO TEST-RESULTS.
028400     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
028500     MOVE ZERO TO REC-SKL-SUB.
028600     PERFORM CCVS-INIT-FILE 9 TIMES.
028700 CCVS-INIT-FILE.
028800     ADD 1 TO REC-SKL-SUB.
028900     MOVE FILE-RECORD-INFO-SKELETON TO
029000                  FILE-RECORD-INFO (REC-SKL-SUB).
029100 CCVS-INIT-EXIT.
029200     GO TO CCVS1-EXIT.
029300 CLOSE-FILES.
029400     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
029500P    OPEN I-O RAW-DATA.
029600P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
029700P    READ RAW-DATA INVALID KEY GO TO END-E-2.
029800P    MOVE "OK.     " TO C-ABORT.
029900P    MOVE PASS-COUNTER TO C-OK.
030000P    MOVE ERROR-HOLD   TO C-ALL.
030100P    MOVE ERROR-COUNTER TO C-FAIL.
030200P    MOVE DELETE-CNT TO C-DELETED.
030300P    MOVE INSPECT-COUNTER TO C-INSPECT.
030400P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
030500PEND-E-2.
030600P    CLOSE RAW-DATA.
030700 TERMINATE-CCVS.
030800S    EXIT PROGRAM.
030900STERMINATE-CALL.
031000     STOP     RUN.
031100 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
031200 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
031300 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
031400 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
031500     MOVE "****TEST DELETED****" TO RE-MARK.
031600 PRINT-DETAIL.
031700     IF REC-CT NOT EQUAL TO ZERO
031800             MOVE "." TO PARDOT-X
031900             MOVE REC-CT TO DOTVALUE.
032000     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
032100     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
032200        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
032300          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
032400     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
032500     MOVE SPACE TO CORRECT-X.
032600     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
032700     MOVE     SPACE TO RE-MARK.
032800 HEAD-ROUTINE.
032900     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033000     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033100     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
033200 COLUMN-NAMES-ROUTINE.
033300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
033600 END-ROUTINE.
033700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033800 END-RTN-EXIT.
033900     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034000 END-ROUTINE-1.
034100      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
034200      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
034300      ADD PASS-COUNTER TO ERROR-HOLD.
034400*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
034500      MOVE PASS-COUNTER TO CCVS-E-4-1.
034600      MOVE ERROR-HOLD TO CCVS-E-4-2.
034700      MOVE CCVS-E-4 TO CCVS-E-2-2.
034800      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
034900  END-ROUTINE-12.
035000      MOVE "TEST(S) FAILED" TO ENDER-DESC.
035100     IF       ERROR-COUNTER IS EQUAL TO ZERO
035200         MOVE "NO " TO ERROR-TOTAL
035300         ELSE
035400         MOVE ERROR-COUNTER TO ERROR-TOTAL.
035500     MOVE     CCVS-E-2 TO DUMMY-RECORD.
035600     PERFORM WRITE-LINE.
035700 END-ROUTINE-13.
035800     IF DELETE-CNT IS EQUAL TO ZERO
035900         MOVE "NO " TO ERROR-TOTAL  ELSE
036000         MOVE DELETE-CNT TO ERROR-TOTAL.
036100     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
036200     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036300      IF   INSPECT-COUNTER EQUAL TO ZERO
036400          MOVE "NO " TO ERROR-TOTAL
036500      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
036600      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
036700      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036800     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036900 WRITE-LINE.
037000     ADD 1 TO RECORD-COUNT.
037100Y    IF RECORD-COUNT GREATER 50
037200Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
037300Y        MOVE SPACE TO DUMMY-RECORD
037400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
037500Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
037600Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
037700Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
037800Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
037900Y        MOVE ZERO TO RECORD-COUNT.
038000     PERFORM WRT-LN.
038100 WRT-LN.
038200     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
038300     MOVE SPACE TO DUMMY-RECORD.
038400 BLANK-LINE-PRINT.
038500     PERFORM WRT-LN.
038600 FAIL-ROUTINE.
038700     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
038800     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
038900     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
039000     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039100     GO TO FAIL-ROUTINE-EX.
039200 FAIL-ROUTINE-WRITE.
039300     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
039400     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
039500 FAIL-ROUTINE-EX. EXIT.
039600 BAIL-OUT.
039700     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
039800     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
039900 BAIL-OUT-WRITE.
040000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
040100     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040200 BAIL-OUT-EX. EXIT.
040300 CCVS1-EXIT.
040400     EXIT.
040500 SECT-SQ221A-0001 SECTION.
040600 WRITE-INIT-GF-01.
040700     MOVE "SQ-VS7" TO XFILE-NAME (1).
040800     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
040900     MOVE "RC" TO CHARS-OR-RECORDS (1).
041000     MOVE 0001 TO XBLOCK-SIZE (1).
041100     MOVE 000450 TO RECORDS-IN-FILE (1).
041200     MOVE "SQ" TO XFILE-ORGANIZATION (1).
041300     MOVE "S" TO XLABEL-TYPE (1).
041400     MOVE 000000 TO XRECORD-NUMBER (1).
041500     MOVE ZERO TO COUNT-OF-RECS.
041600     OPEN OUTPUT SQ-VS7.
041700     MOVE "MULTIPLE LENGTH RECS" TO SQ-VS7-FILLER.
041800 WRITE-TEST-GF-01.
041900     PERFORM WRITE-SHORT-REC.
042000     PERFORM WRITE-LONG-REC.
042100     PERFORM WRITE-SHORT-REC 10 TIMES.
042200     PERFORM WRITE-LONG-REC 100 TIMES.
042300     PERFORM WRITE-SHORT-REC 338 TIMES.
042400 WRITE-WRITE-GF-01.
042500     MOVE "CREATE FILE SQ-VS7" TO FEATURE.
042600     MOVE "WRITE-TEST-GF-01" TO PAR-NAME.
042700     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
042800     MOVE COUNT-OF-RECS TO CORRECT-18V0.
042900     MOVE "FILE HAS 120 AND 151 CHAR RECS" TO RE-MARK.
043000     PERFORM PRINT-DETAIL.
043100*        A SEQUENTIAL MASS STORAGE FILE CONTAINING 450
043200*    RECORDS HAS BEEN CREATED.  THE FILE CONTAINS RECORDS
043300*    OF 120 CHARACTERS AND RECORDS OF 151 CHARACTERS.  THE
043400*    SEQUENCE IN WHICH THE RECORDS WERE WRITTEN IS S-L-10S-
043500*    100L-338S.
043600 WRITE-CLOSE-GF-01.
043700     CLOSE SQ-VS7.
043800     GO TO READ-INIT-F1-01.
043900 WRITE-SHORT-REC.
044000     MOVE "R1-M-G" TO XRECORD-NAME (1).
044100     MOVE 000120 TO XRECORD-LENGTH (1).
044200     ADD 1 TO COUNT-OF-RECS.
044300     MOVE COUNT-OF-RECS TO XRECORD-NUMBER (1).
044400     MOVE "SHORT" TO LONG-OR-SHORT.
044500     MOVE COUNT-OF-RECS TO SQ-VS7-RECNO.
044600     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-VS7R1-FIRST.
044700     MOVE 120 TO RECORD-LENGTH.
044800     WRITE SQ-VS7R1-M-G-120.
044900 WRITE-LONG-REC.
045000     MOVE "R2-M-G" TO XRECORD-NAME (1).
045100     MOVE 000151 TO XRECORD-LENGTH (1).
045200     ADD 1 TO COUNT-OF-RECS.
045300     MOVE COUNT-OF-RECS TO XRECORD-NUMBER (1).
045400     MOVE "LONG" TO LONG-OR-SHORT.
045500     MOVE COUNT-OF-RECS TO SQ-VS7-RECNO.
045600     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-VS7R2-FIRST.
045700     MOVE 151 TO RECORD-LENGTH.
045800     WRITE SQ-VS7R2-M-G-151.
045900 READ-INIT-F1-01.
046000     MOVE ZERO TO RECORD-LENGTH.
046100     MOVE ZERO TO COUNT-OF-RECS.
046200     MOVE ZERO TO EOF-FLAG.
046300     MOVE ZERO TO RECORDS-IN-ERROR.
046400     MOVE ZERO TO ERROR-FLAG.
046500     OPEN INPUT SQ-VS7.
046600 READ-TEST-F1-01.
046700     PERFORM READ-SHORT-REC THRU READ-SHORT-REC-EXIT.
046800     IF EOF-FLAG EQUAL TO 1
046900         MOVE "EOF ON FIRST READ" TO RE-MARK
047000         GO TO READ-EOF-F1-06.
047100     IF ERROR-FLAG EQUAL TO 1
047200         GO TO READ-FAIL-F1-01.
047300 READ-PASS-F1-01.
047400     PERFORM PASS.
047500     GO TO READ-WRITE-F1-01.
047600 READ-FAIL-F1-01.
047700     MOVE " FILE NOT OK. SEE PROGRAM & VII-52 OR -44" TO RE-MARK.
047800     PERFORM FAIL.
047900 READ-WRITE-F1-01.
048000     MOVE "READ SHORT RECORD" TO FEATURE.
048100     MOVE "READ-TEST-F1-01" TO PAR-NAME.
048200     MOVE "EXPECTED RECORD LENGTH: 120" TO RE-MARK.
048300     MOVE RECORD-LENGTH TO COMPUTED-N.
048400     MOVE 120 TO CORRECT-N.
048500     PERFORM PRINT-DETAIL.
048600     GO TO READ-INIT-F1-02.
048700 READ-SHORT-REC.
048800*   READ  <FILE>     NEXT RECORD     AT END                      *
048900******************************************************************
049000     IF EOF-FLAG EQUAL TO 1
049100         GO TO READ-SHORT-REC-EXIT.
049200     READ SQ-VS7 NEXT RECORD AT END
049300         MOVE 1 TO EOF-FLAG
049400         GO TO READ-SHORT-REC-EXIT.
049500     ADD 1 TO COUNT-OF-RECS.
049600     MOVE SQ-VS7R1-FIRST TO FILE-RECORD-INFO-P1-120 (1).
049700     IF XRECORD-NAME (1) NOT EQUAL TO "R1-M-G"
049800         GO TO READ-SHORT-REC-ERROR.
049900     IF  RECORD-LENGTH     NOT EQUAL TO 120
050000         GO TO READ-SHORT-REC-ERROR.
050100     IF COUNT-OF-RECS NOT EQUAL TO XRECORD-NUMBER (1)
050200         GO TO READ-SHORT-REC-ERROR.
050300     IF XLABEL-TYPE (1) EQUAL TO "S"
050400         GO TO READ-SHORT-REC-EXIT.
050500 READ-SHORT-REC-ERROR.
050600     ADD 1 TO RECORDS-IN-ERROR.
050700     MOVE 1 TO ERROR-FLAG.
050800 READ-SHORT-REC-EXIT.
050900     EXIT.
051000 READ-INIT-F1-02.
051100     MOVE ZERO TO ERROR-FLAG.
051200 READ-TEST-F1-02.
051300     PERFORM READ-LONG-REC THRU READ-LONG-REC-EXIT.
051400     IF EOF-FLAG EQUAL TO 1
051500         MOVE "EOF ON SECOND READ" TO RE-MARK
051600         GO TO READ-EOF-F1-06.
051700     IF ERROR-FLAG EQUAL TO 1
051800         GO TO READ-FAIL-F1-02.
051900 READ-PASS-F1-02.
052000     PERFORM PASS.
052100     GO TO READ-WRITE-F1-02.
052200 READ-FAIL-F1-02.
052300     MOVE "SEE VII-52 WRITE LONG RECORD OR VII-44 READ" TO RE-MARK
052400     MOVE RECORD-LENGTH TO COMPUTED-N.
052500     MOVE 151 TO CORRECT-N.
052600     PERFORM FAIL.
052700 READ-WRITE-F1-02.
052800     MOVE "READ LONG RECORD" TO FEATURE.
052900     MOVE "READ-TEST-F1-02" TO PAR-NAME.
053000     MOVE "EXPECTED RECORD LENGTH: 151" TO RE-MARK.
053100     PERFORM PRINT-DETAIL.
053200     GO TO READ-INIT-F1-03.
053300 READ-LONG-REC.
053400     IF EOF-FLAG EQUAL TO 1
053500         GO TO READ-LONG-REC-EXIT.
053600     READ SQ-VS7 END
053700         MOVE 1 TO EOF-FLAG
053800         GO TO READ-LONG-REC-EXIT.
053900     ADD 1 TO COUNT-OF-RECS.
054000     MOVE SQ-VS7R2-FIRST TO FILE-RECORD-INFO-P1-120 (1).
054100     IF XRECORD-NAME (1) NOT EQUAL TO "R2-M-G"
054200         GO TO READ-LONG-REC-ERROR.
054300     IF  RECORD-LENGTH     NOT EQUAL TO 151
054400         GO TO READ-LONG-REC-ERROR.
054500     MOVE COUNT-OF-RECS TO SAVE-COUNT-OF-RECS.
054600     IF SAVE-COUNT-OF-RECS NOT EQUAL TO SQ-VS7-RECNO
054700         GO TO READ-LONG-REC-ERROR.
054800     IF LONG-OR-SHORT EQUAL TO "LONG "
054900         GO TO READ-LONG-REC-EXIT.
055000 READ-LONG-REC-ERROR.
055100     ADD 1 TO RECORDS-IN-ERROR.
055200     MOVE 1 TO ERROR-FLAG.
055300 READ-LONG-REC-EXIT.
055400     EXIT.
055500 READ-INIT-F1-03.
055600     MOVE ZERO TO ERROR-FLAG.
055700 READ-TEST-F1-03.
055800     PERFORM READ-SHORT-REC THRU READ-SHORT-REC-EXIT 10 TIMES.
055900     IF EOF-FLAG EQUAL TO 1
056000         MOVE "UNEXPECTED EOF" TO RE-MARK
056100         GO TO READ-EOF-F1-06.
056200     IF ERROR-FLAG EQUAL TO 1
056300         GO TO READ-FAIL-F1-03.
056400 READ-PASS-F1-03.
056500     PERFORM PASS.
056600     GO TO READ-WRITE-F1-03.
056700 READ-FAIL-F1-03.
056800     MOVE "SEE VII-52 WRITE SHORT REC   OR VII-44 READ" TO RE-MARK
056900     MOVE RECORD-LENGTH TO COMPUTED-N.
057000     MOVE 120 TO CORRECT-N.
057100     PERFORM FAIL.
057200 READ-WRITE-F1-03.
057300     MOVE "READ SHORT RECORDS" TO FEATURE.
057400     MOVE "READ-TEST-F1-03" TO PAR-NAME.
057500     MOVE "EXPECTED RECORD LENGTH: 120" TO RE-MARK.
057600     PERFORM PRINT-DETAIL.
057700 READ-INIT-F1-04.
057800     MOVE ZERO TO ERROR-FLAG.
057900 READ-TEST-F1-04.
058000     PERFORM READ-LONG-REC THRU READ-LONG-REC-EXIT 100 TIMES.
058100     IF EOF-FLAG EQUAL TO 1
058200         MOVE "UNEXPECTED EOF" TO RE-MARK
058300         GO TO READ-EOF-F1-06.
058400     IF ERROR-FLAG EQUAL TO 1
058500         GO TO READ-FAIL-F1-04.
058600 READ-PASS-F1-04.
058700     PERFORM PASS.
058800     GO TO READ-WRITE-F1-04.
058900 READ-FAIL-F1-04.
059000     MOVE RECORD-LENGTH TO COMPUTED-N.
059100     MOVE 151 TO CORRECT-N.
059200     PERFORM FAIL.
059300 READ-WRITE-F1-04.
059400     MOVE "READ LONG RECORDS" TO FEATURE.
059500     MOVE "READ-TEST-F1-04" TO PAR-NAME.
059600     MOVE "EXPECTED RECORD LENGTH: 151" TO RE-MARK.
059700     PERFORM PRINT-DETAIL.
059800 READ-INIT-F1-05.
059900     MOVE ZERO TO ERROR-FLAG.
060000 READ-TEST-F1-05.
060100     PERFORM READ-SHORT-REC THRU READ-SHORT-REC-EXIT 338 TIMES.
060200     IF EOF-FLAG EQUAL TO 1
060300         MOVE "UNEXPECTED EOF" TO RE-MARK
060400         GO TO READ-EOF-F1-06.
060500     IF ERROR-FLAG EQUAL TO 1
060600         GO TO READ-FAIL-F1-05.
060700 READ-PASS-F1-05.
060800     PERFORM PASS.
060900     GO TO READ-WRITE-F1-05.
061000 READ-FAIL-F1-05.
061100     MOVE "SEE VII-52 WRITE LONG RECORD OR VII-44 READ" TO RE-MARK
061200     MOVE RECORD-LENGTH TO COMPUTED-N.
061300     MOVE 120 TO CORRECT-N.
061400     PERFORM FAIL.
061500 READ-WRITE-F1-05.
061600     MOVE "READ SHORT RECORDS" TO FEATURE.
061700     MOVE "READ-TEST-F1-05" TO PAR-NAME.
061800     MOVE "EXPECTED RECORD LENGTH: 120" TO RE-MARK.
061900     PERFORM PRINT-DETAIL.
062000 READ-INIT-F1-06.
062100     READ SQ-VS7 RECORD END
062200         GO TO READ-TEST-F1-06.
062300     MOVE "MORE THAN 450 RECORDS" TO RE-MARK.
062400     GO TO READ-FAIL-F1-06.
062500 READ-EOF-F1-06.
062600     MOVE "RECORDS READ =" TO COMPUTED-A.
062700     MOVE COUNT-OF-RECS TO CORRECT-18V0.
062800     GO TO READ-FAIL-F1-06.
062900 READ-TEST-F1-06.
063000     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
063100         MOVE "RECORDS IN ERROR =" TO COMPUTED-A
063200     MOVE RECORDS-IN-ERROR TO CORRECT-18V0
063300         GO TO READ-FAIL-F1-06.
063400 READ-PASS-F1-06.
063500     PERFORM PASS.
063600     GO TO READ-WRITE-F1-06.
063700 READ-FAIL-F1-06.
063800     PERFORM FAIL.
063900 READ-WRITE-F1-06.
064000     MOVE "READ-TEST-F1-06" TO PAR-NAME.
064100     MOVE "VERIFY FILE SQ-VS7" TO FEATURE.
064200     PERFORM PRINT-DETAIL.
064300 READ-CLOSE-F1-06.
064400     CLOSE SQ-VS7.
064500 SECT-SQ221A-0002 SECTION.
064600*        THIS SECTION CHECKS IF THE ENTIRE RECORD AREA IS
064700*    WRITTEN ON THE MASS STORAGE DEVICE WHEN A SHORT RECORD
064800*    IS WRITTEN.  THE RECORD NUMBER IN CHARACTERS 126 THROUGH
064900*    130 IS UNIQUE FOR EACH RECORD.
065000 INFO-INIT-01.
065100     OPEN INPUT SQ-VS7.
065200     MOVE ZERO TO COUNT-OF-RECS.
065300 INFO-TEST-01.
065400     READ SQ-VS7 AT END
065500         GO TO INFO-END.
065600     ADD 1 TO COUNT-OF-RECS.
065700     IF SQ-VS7-RECNO NOT EQUAL TO "00001"
065800         GO TO NO-INFO-01.
065900     MOVE "MAXIMUM RECORD SIZE WRITTEN" TO RE-MARK.
066000     MOVE "RECORD READ =" TO COMPUTED-A.
066100     MOVE 0001 TO CORRECT-18V0.
066200     GO TO INFO-WRITE-01.
066300 NO-INFO-01.
066400     MOVE "NO DEFINITE CONCLUSION POSSIBLE" TO RE-MARK.
066500 INFO-WRITE-01.
066600     MOVE "READ SHORT RECORD" TO FEATURE.
066700     MOVE "INFO-TEST-01" TO PAR-NAME.
066800     PERFORM PRINT-DETAIL.
066900 INFO-INIT-02.
067000     READ SQ-VS7 RECORD AT END
067100         GO TO INFO-END.
067200     READ SQ-VS7 END
067300         GO TO INFO-END.
067400 INFO-TEST-02.
067500     READ SQ-VS7 AT END
067600         GO TO INFO-END.
067700     IF SQ-VS7-RECNO NOT EQUAL TO "00004"
067800         GO TO NO-INFO-02.
067900     MOVE "MAXIMUM RECORD SIZE WRITTEN" TO RE-MARK.
068000     MOVE "RECORD READ =" TO COMPUTED-A.
068100     MOVE 0004 TO CORRECT-18V0.
068200     GO TO INFO-WRITE-02.
068300 NO-INFO-02.
068400     MOVE "NO DEFINITE CONCLUSION POSSIBLE" TO RE-MARK.
068500 INFO-WRITE-02.
068600     MOVE "READ SHORT RECORD" TO FEATURE.
068700     MOVE "INFO-TEST-02" TO PAR-NAME.
068800     PERFORM PRINT-DETAIL.
068900 INFO-INIT-03.
069000     ADD 3 TO COUNT-OF-RECS.
069100 INFO-INIT-03-1.
069200     READ SQ-VS7 RECORD
069300         END GO TO INFO-END.
069400     ADD 1 TO COUNT-OF-RECS.
069500     IF COUNT-OF-RECS EQUAL TO 450
069600         GO TO INFO-TEST-03.
069700     GO TO INFO-INIT-03-1.
069800 INFO-TEST-03.
069900     IF SQ-VS7-RECNO NOT EQUAL TO "00450"
070000         GO TO NO-INFO-03.
070100     MOVE "MAXIMUM RECORD SIZE WRITTEN" TO RE-MARK.
070200     MOVE "RECORD READ =" TO COMPUTED-A.
070300     MOVE 0450 TO CORRECT-18V0.
070400     GO TO INFO-WRITE-03.
070500 NO-INFO-03.
070600     MOVE "NO DEFINITE CONCLUSION POSSIBLE" TO RE-MARK.
070700 INFO-WRITE-03.
070800     MOVE "READ SHORT RECORD" TO FEATURE.
070900     MOVE "INFO-TEST-03" TO PAR-NAME.
071000     PERFORM PRINT-DETAIL.
071100 INFO-END.
071200     CLOSE SQ-VS7.
071300 TERMINATE-ROUTINE.
071400     EXIT.
071500 CCVS-EXIT SECTION.
071600 CCVS-999999.
071700     GO TO CLOSE-FILES.
