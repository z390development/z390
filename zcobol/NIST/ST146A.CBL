000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST146A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*
002200*    ST146A TESTS OPERATIONS INVOLVING FORMAT 2  OCCURS CLAUSES,
002300*    I.E.  ...OCCURS INTEGER-1 TO INTEGER-2 TIMES DEPENDING ON
002400*          DATA-NAME-1 ....
002500*    X3.23-1976, PAGE III-4, 2.1.4(3) STATES, IN PART, THAT
002600*    INTEGER-2 REPRESENTS THE MAXIMUM NUMBER OF OCCURRENCES AND
002700*    THAT ONLY THE NUMBER OF OCCURRENCES, AND NOT THE ITEM LENGTH,
002800*    IS VARIABLE.  WHENEVER THE PARENT GROUP ITEM IS REFERENCED,
002900*    ONLY THE PORTION OF THE TABLE SPECIFIED BY THE CURRENT VALUE
003000*    OF DATA-NAME-1 WILL BE USED IN THE OPERATION.
003100*
003200*    THE SORT VERB IS EXERCIZED BUT NOT CHECKED FOR ITS
003300*    CAPABILITY TO MEANINGFULLY SORT A FILE.  INSTEAD, THE
003400*    OBJECT OF ST146A IS TO CHECK THE BEHAVIOR OF VARIABLE
003500*    LENGTH TABLES BEING HANDLED IN THE IMPLICIT MOVES
003600*    RESULTING FROM
003700*        RELEASE ... FROM ...
003800*            AND
003900*        RETURN ... INTO ...
004000*            STATEMENTS.
004100*
004200*
004300 ENVIRONMENT DIVISION.
004400 CONFIGURATION SECTION.
004500 SOURCE-COMPUTER.
004600     XXXXX082.
004700 OBJECT-COMPUTER.
004800     XXXXX083.
004900 INPUT-OUTPUT SECTION.
005000 FILE-CONTROL.
005100     SELECT PRINT-FILE ASSIGN TO
005200     XXXXX055.
005300     SELECT  SQ-FS1  ASSIGN TO
005400     XXXXX014.
005500     SELECT SQ-FS2 ASSIGN TO
005600     XXXXX015.
005700     SELECT ST-FR1 ASSIGN TO
005800     XXXXX027.
005900 DATA DIVISION.
006000 FILE SECTION.
006100 FD  PRINT-FILE.
006200 01  PRINT-REC PICTURE X(120).
006300 01  DUMMY-RECORD PICTURE X(120).
006400 FD  SQ-FS1
006500C    VALUE OF
006600C    XXXXX074
006700C    IS
006800C    XXXXX075
006900G    XXXXX069
007000     LABEL RECORD IS STANDARD.
007100 01  SQ-FS1R1-F-G-140.
007200     02 FS1R1-XN-120 PIC X(120).
007300     02 FS1R1-XN-20  PIC X(20).
007400 FD  SQ-FS2
007500C    VALUE OF
007600C    XXXXX074
007700C    IS
007800C    XXXXX076
007900G    XXXXX069
008000     LABEL RECORD IS STANDARD.
008100 01  SQ-FS2R1-F-G-140.
008200     02  FS2R1-XN-120 PIC X(120).
008300     02  FS2R1-XN-20  PIC X(20).
008400 SD  ST-FR1.
008500 01  ST-FR1R1-F-G-140.
008600     02  FILLER PIC X(34).
008700     02  SORT-KEY-FIELD-XN-00006 PIC X(6).
008800     02  FILLER PIC X(100).
008900 WORKING-STORAGE SECTION.
009000 01  ODO-RECORD.
009100     02  FILLER PIC X(5).
009200     02  SO-FILE-NAME PIC X(6).
009300     02  FILLER PIC X(23).
009400     02  SO-RECNO PIC X(6).
009500     02  FILLER PIC X(80).
009600     02  GRP-ODO.
009700         03  DOI-DU-01V00 PIC 9.
009800         03  ODO-XN-00009 PIC X(9).
009900         03  ODO-GRP-00009.
010000         04  ODO-XN-00001-O009D OCCURS 1 TO 9 TIMES DEPENDING ON
010100                 DOI-DU-01V00 ASCENDING KEY ODO-XN-00001-O009D
010200                 INDEXED BY ODO-IX PIC X.
010300 01  STATIC-VALUE.
010400     02  FILLER PIC 9 VALUE 9.
010500     02  FILLER PIC X(18) VALUE " ACTIVE: 123456789".
010600 01  WRK-GRP-00019.
010700     02  WRK-DU-01V00 PIC 9.
010800     02  WRK-XN-00009-1 PIC X(9).
010900     02  WRK-XN-00009-2 PIC X(9).
011000 01  WRK-GRP-00009.
011100     02  ODO-XN-00003  PIC X(3).
011200     02  ODO-XN-00006  PIC X(6).
011300 01  WRK-GRP-0009A  REDEFINES  WRK-GRP-00009.
011400     02  ODO-XN-00005  PIC X(5).
011500     02  ODO-XN-00004  PIC X(4).
011600 01  WRK-DU-05V00 PIC 9(5).
011700 01  WRK-XN-00020 PIC X(20).
011800 01  WRK-XN-00010 PIC X(10).
011900 01  FILE-RECORD-INFORMATION-REC.
012000     03 FILE-RECORD-INFO-SKELETON.
012100        05 FILLER                 PICTURE X(48)       VALUE
012200             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
012300        05 FILLER                 PICTURE X(46)       VALUE
012400             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
012500        05 FILLER                 PICTURE X(26)       VALUE
012600             ",LFIL=000000,ORG=  ,LBLR= ".
012700        05 FILLER                 PICTURE X(37)       VALUE
012800             ",RECKEY=                             ".
012900        05 FILLER                 PICTURE X(38)       VALUE
013000             ",ALTKEY1=                             ".
013100        05 FILLER                 PICTURE X(38)       VALUE
013200             ",ALTKEY2=                             ".
013300        05 FILLER                 PICTURE X(7)        VALUE SPACE.
013400     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
013500        05 FILE-RECORD-INFO-P1-120.
013600           07 FILLER              PIC X(5).
013700           07 XFILE-NAME           PIC X(6).
013800           07 FILLER              PIC X(8).
013900           07 XRECORD-NAME         PIC X(6).
014000           07 FILLER              PIC X(1).
014100           07 REELUNIT-NUMBER     PIC 9(1).
014200           07 FILLER              PIC X(7).
014300           07 XRECORD-NUMBER       PIC 9(6).
014400           07 FILLER              PIC X(6).
014500           07 UPDATE-NUMBER       PIC 9(2).
014600           07 FILLER              PIC X(5).
014700           07 ODO-NUMBER          PIC 9(4).
014800           07 FILLER              PIC X(5).
014900           07 XPROGRAM-NAME        PIC X(5).
015000           07 FILLER              PIC X(7).
015100           07 XRECORD-LENGTH       PIC 9(6).
015200           07 FILLER              PIC X(7).
015300           07 CHARS-OR-RECORDS    PIC X(2).
015400           07 FILLER              PIC X(1).
015500           07 XBLOCK-SIZE          PIC 9(4).
015600           07 FILLER              PIC X(6).
015700           07 RECORDS-IN-FILE     PIC 9(6).
015800           07 FILLER              PIC X(5).
015900           07 XFILE-ORGANIZATION   PIC X(2).
016000           07 FILLER              PIC X(6).
016100           07 XLABEL-TYPE          PIC X(1).
016200        05 FILE-RECORD-INFO-P121-240.
016300           07 FILLER              PIC X(8).
016400           07 XRECORD-KEY          PIC X(29).
016500           07 FILLER              PIC X(9).
016600           07 ALTERNATE-KEY1      PIC X(29).
016700           07 FILLER              PIC X(9).
016800           07 ALTERNATE-KEY2      PIC X(29).
016900           07 FILLER              PIC X(7).
017000 01  TEST-RESULTS.
017100     02 FILLER                   PIC X      VALUE SPACE.
017200     02 FEATURE                  PIC X(20)  VALUE SPACE.
017300     02 FILLER                   PIC X      VALUE SPACE.
017400     02 P-OR-F                   PIC X(5)   VALUE SPACE.
017500     02 FILLER                   PIC X      VALUE SPACE.
017600     02  PAR-NAME.
017700       03 FILLER                 PIC X(19)  VALUE SPACE.
017800       03  PARDOT-X              PIC X      VALUE SPACE.
017900       03 DOTVALUE               PIC 99     VALUE ZERO.
018000     02 FILLER                   PIC X(8)   VALUE SPACE.
018100     02 RE-MARK                  PIC X(61).
018200 01  TEST-COMPUTED.
018300     02 FILLER                   PIC X(30)  VALUE SPACE.
018400     02 FILLER                   PIC X(17)  VALUE
018500            "       COMPUTED=".
018600     02 COMPUTED-X.
018700     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
018800     03 COMPUTED-N               REDEFINES COMPUTED-A
018900                                 PIC -9(9).9(9).
019000     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
019100     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
019200     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
019300     03       CM-18V0 REDEFINES COMPUTED-A.
019400         04 COMPUTED-18V0                    PIC -9(18).
019500         04 FILLER                           PIC X.
019600     03 FILLER PIC X(50) VALUE SPACE.
019700 01  TEST-CORRECT.
019800     02 FILLER PIC X(30) VALUE SPACE.
019900     02 FILLER PIC X(17) VALUE "       CORRECT =".
020000     02 CORRECT-X.
020100     03 CORRECT-A                  PIC X(20) VALUE SPACE.
020200     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
020300     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
020400     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
020500     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
020600     03      CR-18V0 REDEFINES CORRECT-A.
020700         04 CORRECT-18V0                     PIC -9(18).
020800         04 FILLER                           PIC X.
020900     03 FILLER PIC X(2) VALUE SPACE.
021000     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
021100 01  CCVS-C-1.
021200     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
021300-    "SS  PARAGRAPH-NAME
021400-    "       REMARKS".
021500     02 FILLER                     PIC X(20)    VALUE SPACE.
021600 01  CCVS-C-2.
021700     02 FILLER                     PIC X        VALUE SPACE.
021800     02 FILLER                     PIC X(6)     VALUE "TESTED".
021900     02 FILLER                     PIC X(15)    VALUE SPACE.
022000     02 FILLER                     PIC X(4)     VALUE "FAIL".
022100     02 FILLER                     PIC X(94)    VALUE SPACE.
022200 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
022300 01  REC-CT                        PIC 99       VALUE ZERO.
022400 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
022500 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
022600 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
022700 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
022800 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
022900 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
023000 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
023100 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
023200 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
023300 01  CCVS-H-1.
023400     02  FILLER                    PIC X(39)    VALUE SPACES.
023500     02  FILLER                    PIC X(42)    VALUE
023600     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
023700     02  FILLER                    PIC X(39)    VALUE SPACES.
023800 01  CCVS-H-2A.
023900   02  FILLER                        PIC X(40)  VALUE SPACE.
024000   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
024100   02  FILLER                        PIC XXXX   VALUE
024200     "4.2 ".
024300   02  FILLER                        PIC X(28)  VALUE
024400            " COPY - NOT FOR DISTRIBUTION".
024500   02  FILLER                        PIC X(41)  VALUE SPACE.
024600
024700 01  CCVS-H-2B.
024800   02  FILLER                        PIC X(15)  VALUE
024900            "TEST RESULT OF ".
025000   02  TEST-ID                       PIC X(9).
025100   02  FILLER                        PIC X(4)   VALUE
025200            " IN ".
025300   02  FILLER                        PIC X(12)  VALUE
025400     " HIGH       ".
025500   02  FILLER                        PIC X(22)  VALUE
025600            " LEVEL VALIDATION FOR ".
025700   02  FILLER                        PIC X(58)  VALUE
025800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025900 01  CCVS-H-3.
026000     02  FILLER                      PIC X(34)  VALUE
026100            " FOR OFFICIAL USE ONLY    ".
026200     02  FILLER                      PIC X(58)  VALUE
026300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
026400     02  FILLER                      PIC X(28)  VALUE
026500            "  COPYRIGHT   1985 ".
026600 01  CCVS-E-1.
026700     02 FILLER                       PIC X(52)  VALUE SPACE.
026800     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
026900     02 ID-AGAIN                     PIC X(9).
027000     02 FILLER                       PIC X(45)  VALUE SPACES.
027100 01  CCVS-E-2.
027200     02  FILLER                      PIC X(31)  VALUE SPACE.
027300     02  FILLER                      PIC X(21)  VALUE SPACE.
027400     02 CCVS-E-2-2.
027500         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
027600         03 FILLER                   PIC X      VALUE SPACE.
027700         03 ENDER-DESC               PIC X(44)  VALUE
027800            "ERRORS ENCOUNTERED".
027900 01  CCVS-E-3.
028000     02  FILLER                      PIC X(22)  VALUE
028100            " FOR OFFICIAL USE ONLY".
028200     02  FILLER                      PIC X(12)  VALUE SPACE.
028300     02  FILLER                      PIC X(58)  VALUE
028400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
028500     02  FILLER                      PIC X(13)  VALUE SPACE.
028600     02 FILLER                       PIC X(15)  VALUE
028700             " COPYRIGHT 1985".
028800 01  CCVS-E-4.
028900     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
029000     02 FILLER                       PIC X(4)   VALUE " OF ".
029100     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
029200     02 FILLER                       PIC X(40)  VALUE
029300      "  TESTS WERE EXECUTED SUCCESSFULLY".
029400 01  XXINFO.
029500     02 FILLER                       PIC X(19)  VALUE
029600            "*** INFORMATION ***".
029700     02 INFO-TEXT.
029800       04 FILLER                     PIC X(8)   VALUE SPACE.
029900       04 XXCOMPUTED                 PIC X(20).
030000       04 FILLER                     PIC X(5)   VALUE SPACE.
030100       04 XXCORRECT                  PIC X(20).
030200     02 INF-ANSI-REFERENCE           PIC X(48).
030300 01  HYPHEN-LINE.
030400     02 FILLER  PIC IS X VALUE IS SPACE.
030500     02 FILLER  PIC IS X(65)    VALUE IS "************************
030600-    "*****************************************".
030700     02 FILLER  PIC IS X(54)    VALUE IS "************************
030800-    "******************************".
030900 01  CCVS-PGM-ID                     PIC X(9)   VALUE
031000     "ST146A".
031100 PROCEDURE DIVISION.
031200 CCVS1 SECTION.
031300 OPEN-FILES.
031400     OPEN    OUTPUT PRINT-FILE.
031500     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
031600     MOVE    SPACE TO TEST-RESULTS.
031700     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
031800     MOVE    ZERO TO REC-SKL-SUB.
031900     PERFORM CCVS-INIT-FILE 9 TIMES.
032000 CCVS-INIT-FILE.
032100     ADD     1 TO REC-SKL-SUB.
032200     MOVE    FILE-RECORD-INFO-SKELETON
032300          TO FILE-RECORD-INFO (REC-SKL-SUB).
032400 CCVS-INIT-EXIT.
032500     GO TO CCVS1-EXIT.
032600 CLOSE-FILES.
032700     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
032800 TERMINATE-CCVS.
032900S    EXIT PROGRAM.
033000STERMINATE-CALL.
033100     STOP     RUN.
033200 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
033300 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
033400 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
033500 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
033600     MOVE "****TEST DELETED****" TO RE-MARK.
033700 PRINT-DETAIL.
033800     IF REC-CT NOT EQUAL TO ZERO
033900             MOVE "." TO PARDOT-X
034000             MOVE REC-CT TO DOTVALUE.
034100     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
034200     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
034300        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
034400          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
034500     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
034600     MOVE SPACE TO CORRECT-X.
034700     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
034800     MOVE     SPACE TO RE-MARK.
034900 HEAD-ROUTINE.
035000     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035100     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035200     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
035300     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
035400 COLUMN-NAMES-ROUTINE.
035500     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035600     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
035800 END-ROUTINE.
035900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
036000 END-RTN-EXIT.
036100     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036200 END-ROUTINE-1.
036300      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
036400      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
036500      ADD PASS-COUNTER TO ERROR-HOLD.
036600*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
036700      MOVE PASS-COUNTER TO CCVS-E-4-1.
036800      MOVE ERROR-HOLD TO CCVS-E-4-2.
036900      MOVE CCVS-E-4 TO CCVS-E-2-2.
037000      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
037100  END-ROUTINE-12.
037200      MOVE "TEST(S) FAILED" TO ENDER-DESC.
037300     IF       ERROR-COUNTER IS EQUAL TO ZERO
037400         MOVE "NO " TO ERROR-TOTAL
037500         ELSE
037600         MOVE ERROR-COUNTER TO ERROR-TOTAL.
037700     MOVE     CCVS-E-2 TO DUMMY-RECORD.
037800     PERFORM WRITE-LINE.
037900 END-ROUTINE-13.
038000     IF DELETE-COUNTER IS EQUAL TO ZERO
038100         MOVE "NO " TO ERROR-TOTAL  ELSE
038200         MOVE DELETE-COUNTER TO ERROR-TOTAL.
038300     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
038400     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038500      IF   INSPECT-COUNTER EQUAL TO ZERO
038600          MOVE "NO " TO ERROR-TOTAL
038700      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
038800      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
038900      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
039000     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
039100 WRITE-LINE.
039200     ADD 1 TO RECORD-COUNT.
039300Y    IF RECORD-COUNT GREATER 42
039400Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
039500Y        MOVE SPACE TO DUMMY-RECORD
039600Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
039700Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
039800Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
039900Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
040000Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
040100Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
040200Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
040300Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
040400Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
040500Y        MOVE ZERO TO RECORD-COUNT.
040600     PERFORM WRT-LN.
040700 WRT-LN.
040800     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
040900     MOVE SPACE TO DUMMY-RECORD.
041000 BLANK-LINE-PRINT.
041100     PERFORM WRT-LN.
041200 FAIL-ROUTINE.
041300     IF     COMPUTED-X NOT EQUAL TO SPACE
041400            GO TO   FAIL-ROUTINE-WRITE.
041500     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
041600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
041700     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
041800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041900     MOVE   SPACES TO INF-ANSI-REFERENCE.
042000     GO TO  FAIL-ROUTINE-EX.
042100 FAIL-ROUTINE-WRITE.
042200     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
042300     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
042400     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
042500     MOVE   SPACES TO COR-ANSI-REFERENCE.
042600 FAIL-ROUTINE-EX. EXIT.
042700 BAIL-OUT.
042800     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
042900     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
043000 BAIL-OUT-WRITE.
043100     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
043200     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
043300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043400     MOVE   SPACES TO INF-ANSI-REFERENCE.
043500 BAIL-OUT-EX. EXIT.
043600 CCVS1-EXIT.
043700     EXIT.
043800 BEGIN-ST216-TESTS SECTION.
043900 INIT-WRK-AREA.
044000     MOVE STATIC-VALUE TO WRK-GRP-00019.
044100     MOVE 9 TO DOI-DU-01V00.
044200     MOVE " ACTIVE: " TO ODO-XN-00009.
044300     MOVE "1" TO ODO-XN-00001-O009D (1).
044400     MOVE "2" TO ODO-XN-00001-O009D (2).
044500     MOVE "3" TO ODO-XN-00001-O009D (3).
044600     MOVE "4" TO ODO-XN-00001-O009D (4).
044700     MOVE "5" TO ODO-XN-00001-O009D (5).
044800     MOVE "6" TO ODO-XN-00001-O009D (6).
044900     MOVE "7" TO ODO-XN-00001-O009D (7).
045000     MOVE "8" TO ODO-XN-00001-O009D (8).
045100     MOVE "9" TO ODO-XN-00001-O009D (9).
045200 BUILD-SQ-FS1 SECTION.
045300 BUILD-SQ-FS1-PARA1.
045400     OPEN OUTPUT SQ-FS1.
045500     MOVE "SQ-FS1" TO XFILE-NAME (1).
045600     MOVE "FS1R1 " TO XRECORD-NAME (1).
045700     MOVE "ST216" TO XPROGRAM-NAME (1).
045800     MOVE 140 TO XRECORD-LENGTH (1).
045900     MOVE "1R" TO CHARS-OR-RECORDS (1).
046000     MOVE 4000 TO RECORDS-IN-FILE (1).
046100     MOVE "SQ" TO XFILE-ORGANIZATION (1).
046200     MOVE "S" TO XLABEL-TYPE (1).
046300     PERFORM BUILD-SQ-FS1-PARA2 VARYING ODO-IX FROM 1 BY 1
046400         UNTIL ODO-IX IS GREATER THAN 1000.
046500     GO TO BUILD-SQ-FS1-PARA3.
046600 BUILD-SQ-FS1-PARA2.
046700     SET XRECORD-NUMBER (1) TO ODO-IX.
046800     MOVE 9 TO ODO-NUMBER (1).
046900     MOVE FILE-RECORD-INFO-P1-120 (1) TO ODO-RECORD.
047000     PERFORM INIT-WRK-AREA.
047100     WRITE SQ-FS1R1-F-G-140 FROM ODO-RECORD.
047200 BUILD-SQ-FS1-PARA3.
047300     CLOSE SQ-FS1.
047400 END-OF-BUILD-SQ-FS1 SECTION.
047500 EXECUTE-THE-SORT.
047600     SORT ST-FR1 ON ASCENDING KEY SORT-KEY-FIELD-XN-00006
047700         INPUT PROCEDURE IS SORT-INPUT-PROCEDURES
047800         OUTPUT PROCEDURE IS SORT-OUTPUT-PROCEDURES.
047900XFILE-DUMP SECTION.
048000XF-D-1.
048100X    PERFORM END-ROUTINE.
048200X    MOVE " DUMP OF FIRST 10 (OF 1000) RECORDS FROM SQ-FS1:"
048300X        TO PRINT-REC.
048400X    PERFORM WRITE-LINE.
048500X    PERFORM F-D-2 10 TIMES.
048600X    GO TO F-D-3.
048700XF-D-2.
048800X    READ SQ-FS1 AT END GO TO F-D-3.
048900X    MOVE FS1R1-XN-120 TO PRINT-REC.
049000X    PERFORM WRITE-LINE.
049100X    MOVE FS1R1-XN-20 TO PRINT-REC.
049200X    PERFORM WRITE-LINE.
049300XF-D-3.
049400X    CLOSE SQ-FS1.
049500X    OPEN INPUT SQ-FS2.
049600X    PERFORM END-ROUTINE.
049700X    MOVE " DUMP OF FIRST 10 (OF 1000) RECORDS FROM SQ-FS2:"
049800X        TO PRINT-REC.
049900X    PERFORM WRITE-LINE.
050000X    PERFORM F-D-4 10 TIMES.
050100X    GO TO F-D-5.
050200XF-D-4.
050300X    READ SQ-FS2 AT END GO TO F-D-5.
050400X    MOVE FS2R1-XN-120 TO PRINT-REC.
050500X    PERFORM WRITE-LINE.
050600X    MOVE FS2R1-XN-20 TO PRINT-REC.
050700X    PERFORM WRITE-LINE.
050800XF-D-5.
050900X    CLOSE SQ-FS2.
051000 CCVS-EXIT SECTION.
051100 CCVS-999999.
051200     GO TO CLOSE-FILES.
051300 SORT-INPUT-PROCEDURES SECTION.
051400 S-I-P-1.
051500     OPEN INPUT SQ-FS1.
051600     MOVE 9 TO DOI-DU-01V00.
051700     READ SQ-FS1 INTO ODO-RECORD AT END GO TO S-I-P-3.
051800     MOVE 3 TO ODO-NUMBER (1).
051900     MOVE 3 TO DOI-DU-01V00.
052000     RELEASE ST-FR1R1-F-G-140 FROM ODO-RECORD.
052100     MOVE 9 TO DOI-DU-01V00.
052200     READ SQ-FS1 INTO ODO-RECORD AT END GO TO S-I-P-3.
052300     MOVE 7 TO ODO-NUMBER (1).
052400     MOVE 7 TO DOI-DU-01V00.
052500     RELEASE ST-FR1R1-F-G-140 FROM ODO-RECORD.
052600 S-I-P-2.
052700     MOVE 9 TO DOI-DU-01V00.
052800     READ SQ-FS1 INTO ODO-RECORD AT END GO TO S-I-P-3.
052900     MOVE 9 TO DOI-DU-01V00.
053000     RELEASE ST-FR1R1-F-G-140 FROM ODO-RECORD.
053100     GO TO S-I-P-2.
053200 S-I-P-3.
053300     CLOSE SQ-FS1.
053400 SORT-OUTPUT-PROCEDURES SECTION.
053500 S-O-P-1.
053600     OPEN OUTPUT SQ-FS2.
053700     MOVE "OCCURS DEPENDING ON" TO FEATURE.
053800 CLEAR-ODO-RECORD.
053900     MOVE 9 TO DOI-DU-01V00.
054000     MOVE SPACES TO ODO-RECORD.
054100     MOVE 9 TO DOI-DU-01V00.
054200 RELEASE-TEST-1.
054300     RETURN ST-FR1 INTO ODO-RECORD AT END GO TO RELEASE-DELETE-1.
054400     IF SO-RECNO NOT EQUAL TO "000001" GO TO RELEASE-DELETE-1.
054500     MOVE 9 TO DOI-DU-01V00.
054600     MOVE ODO-GRP-00009 TO WRK-GRP-00009.
054700     IF ODO-XN-00003 IS EQUAL TO "123" AND
054800        ODO-XN-00006 IS NOT EQUAL TO "456789"
054900         PERFORM PASS-1
055000         ELSE
055100         PERFORM FAIL-1
055200         MOVE "3 ACTIVE: 123" TO CORRECT-A
055300         MOVE 9 TO DOI-DU-01V00
055400         MOVE GRP-ODO TO COMPUTED-A.
055500     MOVE "SQ-FS2" TO SO-FILE-NAME.
055600     WRITE SQ-FS2R1-F-G-140 FROM ODO-RECORD.
055700     GO TO RELEASE-WRITE-1.
055800 RELEASE-DELETE-1.
055900     PERFORM DE-LETE-1.
056000 RELEASE-WRITE-1.
056100     MOVE "RELEASE-TEST-1" TO PAR-NAME.
056200     MOVE "RELEASE 3 ODO - RETURN 9 ODO" TO RE-MARK.
056300     PERFORM PRINT-DETAIL-1.
056400 RETURN-TEST-1.
056500     PERFORM CLEAR-ODO-RECORD.
056600     MOVE 5 TO DOI-DU-01V00.
056700     RETURN ST-FR1 INTO ODO-RECORD AT END GO TO RETURN-DELETE-1.
056800     IF SO-RECNO NOT EQUAL TO "000002" GO TO RETURN-DELETE-1.
056900     MOVE 9 TO DOI-DU-01V00.
057000     MOVE ODO-GRP-00009 TO WRK-GRP-00009.
057100     IF ODO-XN-00005 IS EQUAL TO "12345" AND
057200        ODO-XN-00004 IS NOT EQUAL TO "6789"
057300         PERFORM PASS-1
057400         ELSE
057500         PERFORM FAIL-1
057600         MOVE "7 ACTIVE: 12345" TO CORRECT-A
057700         MOVE 7 TO DOI-DU-01V00
057800         MOVE GRP-ODO TO COMPUTED-A.
057900     MOVE "SQ-FS2" TO SO-FILE-NAME.
058000     WRITE SQ-FS2R1-F-G-140 FROM ODO-RECORD.
058100     GO TO RETURN-WRITE-1.
058200 RETURN-DELETE-1.
058300     PERFORM DE-LETE-1.
058400 RETURN-WRITE-1.
058500     MOVE "RETURN-TEST-1" TO PAR-NAME.
058600     MOVE "RELEASE 7 ODO - RETURN 5 ODO" TO RE-MARK.
058700     PERFORM PRINT-DETAIL-1.
058800 RELEASE-TEST-2.
058900     PERFORM CLEAR-ODO-RECORD.
059000     RETURN ST-FR1 INTO ODO-RECORD AT END GO TO RELEASE-DELETE-2.
059100     IF SO-RECNO NOT EQUAL TO "000003" GO TO RELEASE-DELETE-2.
059200     IF GRP-ODO IS EQUAL TO "9 ACTIVE: 123456789"
059300         PERFORM PASS-1
059400         ELSE
059500         PERFORM FAIL-1
059600         MOVE "9 ACTIVE: 123456789" TO CORRECT-A
059700         MOVE GRP-ODO TO COMPUTED-A.
059800     MOVE "SQ-FS2" TO SO-FILE-NAME.
059900     WRITE SQ-FS2R1-F-G-140 FROM ODO-RECORD.
060000     GO TO RELEASE-WRITE-2.
060100 RELEASE-DELETE-2.
060200     PERFORM DE-LETE-1.
060300 RELEASE-WRITE-2.
060400     MOVE "RELEASE-TEST-2" TO PAR-NAME.
060500     MOVE "RELEASE 9 ODO - RETURN 9 ODO" TO RE-MARK.
060600     PERFORM PRINT-DETAIL-1.
060700 RETURN-TEST-2.
060800     PERFORM CLEAR-ODO-RECORD.
060900     MOVE 3 TO DOI-DU-01V00.
061000     RETURN ST-FR1 INTO ODO-RECORD AT END GO TO RETURN-DELETE-2.
061100     IF SO-RECNO NOT EQUAL TO "000004" GO TO RETURN-DELETE-2.
061200     MOVE 9 TO DOI-DU-01V00.
061300     MOVE ODO-GRP-00009 TO WRK-GRP-00009.
061400     IF ODO-XN-00003 IS EQUAL TO "123" AND
061500        ODO-XN-00006 IS EQUAL TO "456789"
061600         PERFORM PASS-1
061700         ELSE
061800         PERFORM FAIL-1
061900         MOVE "9 ACTIVE: 123456789" TO CORRECT-A
062000         MOVE GRP-ODO TO COMPUTED-A.
062100     MOVE "SQ-FS2" TO SO-FILE-NAME.
062200     WRITE SQ-FS2R1-F-G-140 FROM ODO-RECORD.
062300     GO TO RETURN-WRITE-2.
062400 RETURN-DELETE-2.
062500     PERFORM DE-LETE-1.
062600 RETURN-WRITE-2.
062700     MOVE "RETURN-TEST-2" TO PAR-NAME.
062800     MOVE "RELEASE 9 ODO - RETURN 6 ODO" TO RE-MARK.
062900     PERFORM PRINT-DETAIL-1.
063000 S-O-P-2.
063100     PERFORM CLEAR-ODO-RECORD.
063200     RETURN ST-FR1 INTO ODO-RECORD AT END GO TO S-O-P-3.
063300     MOVE "SQ-FS2" TO SO-FILE-NAME.
063400     WRITE SQ-FS2R1-F-G-140 FROM ODO-RECORD.
063500     GO TO S-O-P-2.
063600 INSPT-1. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
063700 PASS-1.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
063800 FAIL-1.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
063900 DE-LETE-1.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
064000     MOVE "****TEST DELETED****" TO RE-MARK.
064100 PRINT-DETAIL-1.
064200     IF REC-CT NOT EQUAL TO ZERO
064300             MOVE "." TO PARDOT-X
064400             MOVE REC-CT TO DOTVALUE.
064500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE-1.
064600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE-1
064700        PERFORM FAIL-ROUTINE-1 THRU FAIL-ROUTINE-EX-1
064800          ELSE PERFORM BAIL-OUT-1 THRU BAIL-OUT-EX-1.
064900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
065000     MOVE SPACE TO CORRECT-X.
065100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
065200     MOVE     SPACE TO RE-MARK.
065300 WRITE-LINE-1.
065400     ADD 1 TO RECORD-COUNT.
065500Y    IF RECORD-COUNT GREATER 50
065600Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
065700Y        MOVE SPACE TO DUMMY-RECORD
065800Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
065900Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN-1
066000Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN-1 2 TIMES
066100Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN-1
066200Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
066300Y        MOVE ZERO TO RECORD-COUNT.
066400     PERFORM WRT-LN-1.
066500 WRT-LN-1.
066600     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
066700     MOVE SPACE TO DUMMY-RECORD.
066800 BLANK-LINE-PRINT-1.
066900     PERFORM WRT-LN-1.
067000 FAIL-ROUTINE-1.
067100     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-1.
067200     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-1.
067300     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
067400     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-1 2 TIMES.
067500     GO TO FAIL-ROUTINE-EX-1.
067600 FAIL-RTN-WRITE-1.
067700     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE-1
067800     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE-1 2 TIMES.
067900 FAIL-ROUTINE-EX-1. EXIT.
068000 BAIL-OUT-1.
068100     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE-1.
068200     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX-1.
068300 BAIL-OUT-WRITE-1.
068400     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
068500     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-1 2 TIMES.
068600 BAIL-OUT-EX-1. EXIT.
068700 S-O-P-3.
068800     CLOSE SQ-FS2.
