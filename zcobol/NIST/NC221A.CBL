000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     NC221A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*                                                              *
002200*    PROGRAM NC221A TEST THE USE OF INDEXED IDENTIFIERS WITH   *
002300*    FORMATS 1, 2 AND 3 OF THE "INSPECT" STATEMENT.            *
002400*                                                              *
002500****************************************************************
002600 ENVIRONMENT DIVISION.
002700 CONFIGURATION SECTION.
002800 SOURCE-COMPUTER.
002900     XXXXX082.
003000 OBJECT-COMPUTER.
003100     XXXXX083.
003200 INPUT-OUTPUT SECTION.
003300 FILE-CONTROL.
003400     SELECT PRINT-FILE ASSIGN TO
003500     XXXXX055.
003600 DATA DIVISION.
003700 FILE SECTION.
003800 FD  PRINT-FILE.
003900 01  PRINT-REC PICTURE X(120).
004000 01  DUMMY-RECORD PICTURE X(120).
004100 WORKING-STORAGE SECTION.
004200
004300 01  WS-RIGHT-1-83.
004400   03  WS-RIGHT-1-20                PIC X(20).
004500   03  WS-RIGHT-21-40               PIC X(20).
004600   03  WS-RIGHT-41-60               PIC X(20).
004700   03  WS-RIGHT-61-80               PIC X(20).
004800   03  WS-RIGHT-81-83               PIC X(3).
004900 01  WS-WRONG-1-83.
005000   03  WS-WRONG-1-20                PIC X(20).
005100   03  WS-WRONG-21-40               PIC X(20).
005200   03  WS-WRONG-41-60               PIC X(20).
005300   03  WS-WRONG-61-80               PIC X(20).
005400   03  WS-WRONG-81-83               PIC X(3).
005500
005600 01  TABLE1.
005700     02  TABLE1-REC              PICTURE X(83)
005800                                 OCCURS 4 TIMES
005900                                 INDEXED BY INDEX1.
006000 01  TABLE2.
006100     02  WRK-DU-999              PICTURE 999
006200                                 OCCURS 4 TIMES
006300                                 INDEXED BY INDEX2.
006400 01  TABLE3.
006500     02  TABLE3-SYMBOL           PICTURE X
006600                                 OCCURS 3 TIMES
006700                                 INDEXED BY INDEX3.
006800 01  TABLE4.
006900     02  TABLE4-LETTER           PICTURE XX
007000                                 OCCURS 5 TIMES
007100                                 INDEXED BY INDEX4.
007200 01  WC-XN-83  PIC X(83) VALUE
007300     "AH YES AH YES W.C. FRITOES HERE. ANYONE WHO HATES DOGS AND K
007400-    "IDS CAN NOT BE ALL BAD.".
007500 01  ANS-XN-83-1 PIC X(83) VALUE
007600     "OH YES AH YES W.C. FROTOES HERE, ANYONE WHO HATES DOGS AND K
007700-    "IDS CAN NOT BE ALL BAD.".
007800 01  ANS-XN-83-2 PIC X(83) VALUE
007900     "AH YES,AH YES W.C. FRITOES HERE. ANYONE WHO HATES DOGS AND K
008000-    "IDS CAN NOT BE ALL BAD.".
008100 01  ANS-XN-83-3 PIC X(83) VALUE
008200     "OH YES AH YES W.C. FRITOES HERE. ANYONE WHO HATES DOGS AND K
008300-    "IDS CAN NOT BE ALL BAD.".
008400 01  ANS-XN-83-4 PIC X(83) VALUE
008500     "AH YES AH YES W.C. FRITOES HERE. ANYONE WHO HATES DOGS AND K
008600-    "IDS CAN NOT BE ALL-BAD.".
008700 01  ANS-XN-83-5 PIC X(83) VALUE
008800     "EH YES AH YES W.C. FRITOES HERE. ANYONE WHO HATES DOGS AND K
008900-    "IDS CAN NOT BE ALL BAD.".
009000 01  ANS-XN-83-6 PIC X(83) VALUE
009100     "AH YES OH YES W.C. FRITOES HERE. ANYONE WHO HATES DOGS AND K
009200-    "IDS CAN NOT BE ALL BAD.".
009300*01  TEST-RESULTS.
009400*    02 FILLER                   PIC X      VALUE SPACE.
009500*    02 FEATURE                  PIC X(20)  VALUE SPACE.
009600*    02 FILLER                   PIC X      VALUE SPACE.
009700*    02 P-OR-F                   PIC X(5)   VALUE SPACE.
009800*    02 FILLER                   PIC X      VALUE SPACE.
009900*    02  PAR-NAME.
010000*      03 FILLER                 PIC X(19)  VALUE SPACE.
010100*      03  PARDOT-X              PIC X      VALUE SPACE.
010200*      03 DOTVALUE               PIC 99     VALUE ZERO.
010300*    02 FILLER                   PIC X(8)   VALUE SPACE.
010400*    02 RE-MARK                  PIC X(61).
010500 01  TEST-RESULTS.
010600     02 FILLER                   PIC X      VALUE SPACE.
010700     02 FEATURE                  PIC X(20)  VALUE SPACE.
010800     02 FILLER                   PIC X      VALUE SPACE.
010900     02 P-OR-F                   PIC X(5)   VALUE SPACE.
011000     02 FILLER                   PIC X      VALUE SPACE.
011100     02  PAR-NAME.
011200       03 FILLER                 PIC X(19)  VALUE SPACE.
011300       03  PARDOT-X              PIC X      VALUE SPACE.
011400       03 DOTVALUE               PIC 99     VALUE ZERO.
011500     02 FILLER                   PIC X(8)   VALUE SPACE.
011600     02 RE-MARK                  PIC X(61).
011700 01  TEST-COMPUTED.
011800     02 FILLER                   PIC X(30)  VALUE SPACE.
011900     02 FILLER                   PIC X(17)  VALUE
012000            "       COMPUTED=".
012100     02 COMPUTED-X.
012200     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
012300     03 COMPUTED-N               REDEFINES COMPUTED-A
012400                                 PIC -9(9).9(9).
012500     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
012600     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
012700     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
012800     03       CM-18V0 REDEFINES COMPUTED-A.
012900         04 COMPUTED-18V0                    PIC -9(18).
013000         04 FILLER                           PIC X.
013100     03 FILLER PIC X(50) VALUE SPACE.
013200 01  TEST-CORRECT.
013300     02 FILLER PIC X(30) VALUE SPACE.
013400     02 FILLER PIC X(17) VALUE "       CORRECT =".
013500     02 CORRECT-X.
013600     03 CORRECT-A                  PIC X(20) VALUE SPACE.
013700     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
013800     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
013900     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
014000     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
014100     03      CR-18V0 REDEFINES CORRECT-A.
014200         04 CORRECT-18V0                     PIC -9(18).
014300         04 FILLER                           PIC X.
014400     03 FILLER PIC X(2) VALUE SPACE.
014500     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
014600 01  CCVS-C-1.
014700     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
014800-    "SS  PARAGRAPH-NAME
014900-    "       REMARKS".
015000     02 FILLER                     PIC X(20)    VALUE SPACE.
015100 01  CCVS-C-2.
015200     02 FILLER                     PIC X        VALUE SPACE.
015300     02 FILLER                     PIC X(6)     VALUE "TESTED".
015400     02 FILLER                     PIC X(15)    VALUE SPACE.
015500     02 FILLER                     PIC X(4)     VALUE "FAIL".
015600     02 FILLER                     PIC X(94)    VALUE SPACE.
015700 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
015800 01  REC-CT                        PIC 99       VALUE ZERO.
015900 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
016000 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
016100 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
016200 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
016300 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
016400 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
016500 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
016600 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
016700 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
016800 01  CCVS-H-1.
016900     02  FILLER                    PIC X(39)    VALUE SPACES.
017000     02  FILLER                    PIC X(42)    VALUE
017100     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
017200     02  FILLER                    PIC X(39)    VALUE SPACES.
017300 01  CCVS-H-2A.
017400   02  FILLER                        PIC X(40)  VALUE SPACE.
017500   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
017600   02  FILLER                        PIC XXXX   VALUE
017700     "4.2 ".
017800   02  FILLER                        PIC X(28)  VALUE
017900            " COPY - NOT FOR DISTRIBUTION".
018000   02  FILLER                        PIC X(41)  VALUE SPACE.
018100
018200 01  CCVS-H-2B.
018300   02  FILLER                        PIC X(15)  VALUE
018400            "TEST RESULT OF ".
018500   02  TEST-ID                       PIC X(9).
018600   02  FILLER                        PIC X(4)   VALUE
018700            " IN ".
018800   02  FILLER                        PIC X(12)  VALUE
018900     " HIGH       ".
019000   02  FILLER                        PIC X(22)  VALUE
019100            " LEVEL VALIDATION FOR ".
019200   02  FILLER                        PIC X(58)  VALUE
019300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
019400 01  CCVS-H-3.
019500     02  FILLER                      PIC X(34)  VALUE
019600            " FOR OFFICIAL USE ONLY    ".
019700     02  FILLER                      PIC X(58)  VALUE
019800     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
019900     02  FILLER                      PIC X(28)  VALUE
020000            "  COPYRIGHT   1985 ".
020100 01  CCVS-E-1.
020200     02 FILLER                       PIC X(52)  VALUE SPACE.
020300     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
020400     02 ID-AGAIN                     PIC X(9).
020500     02 FILLER                       PIC X(45)  VALUE SPACES.
020600 01  CCVS-E-2.
020700     02  FILLER                      PIC X(31)  VALUE SPACE.
020800     02  FILLER                      PIC X(21)  VALUE SPACE.
020900     02 CCVS-E-2-2.
021000         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
021100         03 FILLER                   PIC X      VALUE SPACE.
021200         03 ENDER-DESC               PIC X(44)  VALUE
021300            "ERRORS ENCOUNTERED".
021400 01  CCVS-E-3.
021500     02  FILLER                      PIC X(22)  VALUE
021600            " FOR OFFICIAL USE ONLY".
021700     02  FILLER                      PIC X(12)  VALUE SPACE.
021800     02  FILLER                      PIC X(58)  VALUE
021900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
022000     02  FILLER                      PIC X(13)  VALUE SPACE.
022100     02 FILLER                       PIC X(15)  VALUE
022200             " COPYRIGHT 1985".
022300 01  CCVS-E-4.
022400     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
022500     02 FILLER                       PIC X(4)   VALUE " OF ".
022600     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
022700     02 FILLER                       PIC X(40)  VALUE
022800      "  TESTS WERE EXECUTED SUCCESSFULLY".
022900 01  XXINFO.
023000     02 FILLER                       PIC X(19)  VALUE
023100            "*** INFORMATION ***".
023200     02 INFO-TEXT.
023300       04 FILLER                     PIC X(8)   VALUE SPACE.
023400       04 XXCOMPUTED                 PIC X(20).
023500       04 FILLER                     PIC X(5)   VALUE SPACE.
023600       04 XXCORRECT                  PIC X(20).
023700     02 INF-ANSI-REFERENCE           PIC X(48).
023800 01  HYPHEN-LINE.
023900     02 FILLER  PIC IS X VALUE IS SPACE.
024000     02 FILLER  PIC IS X(65)    VALUE IS "************************
024100-    "*****************************************".
024200     02 FILLER  PIC IS X(54)    VALUE IS "************************
024300-    "******************************".
024400 01  CCVS-PGM-ID                     PIC X(9)   VALUE
024500     "NC221A".
024600 PROCEDURE DIVISION.
024700 CCVS1 SECTION.
024800 OPEN-FILES.
024900     OPEN     OUTPUT PRINT-FILE.
025000     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
025100     MOVE    SPACE TO TEST-RESULTS.
025200     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
025300     GO TO CCVS1-EXIT.
025400 CLOSE-FILES.
025500     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
025600 TERMINATE-CCVS.
025700S    EXIT PROGRAM.
025800STERMINATE-CALL.
025900     STOP     RUN.
026000 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
026100 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
026200 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
026300 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
026400     MOVE "****TEST DELETED****" TO RE-MARK.
026500 PRINT-DETAIL.
026600     IF REC-CT NOT EQUAL TO ZERO
026700             MOVE "." TO PARDOT-X
026800             MOVE REC-CT TO DOTVALUE.
026900     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
027000     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
027100        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
027200          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
027300     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
027400     MOVE SPACE TO CORRECT-X.
027500     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
027600     MOVE     SPACE TO RE-MARK.
027700 HEAD-ROUTINE.
027800     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027900     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028000     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
028100     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
028200 COLUMN-NAMES-ROUTINE.
028300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
028600 END-ROUTINE.
028700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
028800 END-RTN-EXIT.
028900     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029000 END-ROUTINE-1.
029100      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
029200      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
029300      ADD PASS-COUNTER TO ERROR-HOLD.
029400*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
029500      MOVE PASS-COUNTER TO CCVS-E-4-1.
029600      MOVE ERROR-HOLD TO CCVS-E-4-2.
029700      MOVE CCVS-E-4 TO CCVS-E-2-2.
029800      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
029900  END-ROUTINE-12.
030000      MOVE "TEST(S) FAILED" TO ENDER-DESC.
030100     IF       ERROR-COUNTER IS EQUAL TO ZERO
030200         MOVE "NO " TO ERROR-TOTAL
030300         ELSE
030400         MOVE ERROR-COUNTER TO ERROR-TOTAL.
030500     MOVE     CCVS-E-2 TO DUMMY-RECORD.
030600     PERFORM WRITE-LINE.
030700 END-ROUTINE-13.
030800     IF DELETE-COUNTER IS EQUAL TO ZERO
030900         MOVE "NO " TO ERROR-TOTAL  ELSE
031000         MOVE DELETE-COUNTER TO ERROR-TOTAL.
031100     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
031200     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031300      IF   INSPECT-COUNTER EQUAL TO ZERO
031400          MOVE "NO " TO ERROR-TOTAL
031500      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
031600      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
031700      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031800     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031900 WRITE-LINE.
032000     ADD 1 TO RECORD-COUNT.
032100Y    IF RECORD-COUNT GREATER 50
032200Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
032300Y        MOVE SPACE TO DUMMY-RECORD
032400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
032500Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
032600Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
032700Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
032800Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
032900Y        MOVE ZERO TO RECORD-COUNT.
033000     PERFORM WRT-LN.
033100 WRT-LN.
033200     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
033300     MOVE SPACE TO DUMMY-RECORD.
033400 BLANK-LINE-PRINT.
033500     PERFORM WRT-LN.
033600 FAIL-ROUTINE.
033700     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
033800     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
033900     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
034000     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
034100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034200     MOVE   SPACES TO INF-ANSI-REFERENCE.
034300     GO TO  FAIL-ROUTINE-EX.
034400 FAIL-ROUTINE-WRITE.
034500     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
034600     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
034700     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
034800     MOVE   SPACES TO COR-ANSI-REFERENCE.
034900 FAIL-ROUTINE-EX. EXIT.
035000 BAIL-OUT.
035100     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
035200     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
035300 BAIL-OUT-WRITE.
035400     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
035500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
035600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035700     MOVE   SPACES TO INF-ANSI-REFERENCE.
035800 BAIL-OUT-EX. EXIT.
035900 CCVS1-EXIT.
036000     EXIT.
036100 INIT-TABLE1.
036200     MOVE
036300     "AH YES AH YES W.C. FRITOES HERE. ANYONE WHO HATES DOGS AND K
036400-    "IDS CAN NOT BE ALL BAD."
036500         TO WC-XN-83.
036600     MOVE WC-XN-83 TO TABLE1-REC (1).
036700     MOVE WC-XN-83 TO TABLE1-REC (2).
036800     MOVE WC-XN-83 TO TABLE1-REC (3).
036900     MOVE WC-XN-83 TO TABLE1-REC (4).
037000 INIT-TABLE3.
037100     MOVE " " TO TABLE3-SYMBOL (1).
037200     MOVE "," TO TABLE3-SYMBOL (2).
037300     MOVE "-" TO TABLE3-SYMBOL (3).
037400 INIT-TABLE4.
037500     MOVE "AH" TO TABLE4-LETTER (1).
037600     MOVE "OH" TO TABLE4-LETTER (2).
037700     MOVE "HE" TO TABLE4-LETTER (3).
037800     MOVE "LL" TO TABLE4-LETTER (4).
037900     MOVE "H " TO TABLE4-LETTER (5).
038000*
038100 INS-INIT-F1-1.
038200     MOVE "INS-TEST-F1-1"     TO PAR-NAME.
038300     MOVE "IV-21 4.3.8.2"     TO ANSI-REFERENCE.
038400     MOVE "TALLY FOR LEADING" TO FEATURE.
038500     MOVE ZEROS TO TABLE2.
038600     SET INDEX1 TO 1.
038700     SET INDEX2 TO 1.
038800 INS-TEST-F1-1.
038900     INSPECT TABLE1-REC (INDEX1) TALLYING WRK-DU-999 (INDEX2)
039000        FOR LEADING "AH"
039100     IF WRK-DU-999 (INDEX2) EQUAL TO 1
039200        PERFORM PASS
039300        GO TO INS-WRITE-F1-1.
039400     GO TO INS-FAIL-F1-1.
039500 INS-DELETE-F1-1.
039600     PERFORM DE-LETE.
039700     GO TO INS-WRITE-F1-1.
039800 INS-FAIL-F1-1.
039900     PERFORM FAIL.
040000     MOVE WRK-DU-999 (INDEX2) TO COMPUTED-N.
040100     MOVE 1 TO CORRECT-N.
040200 INS-WRITE-F1-1.
040300     PERFORM PRINT-DETAIL.
040400*
040500 INS-INIT-F1-2.
040600     MOVE "INS-TEST-F1-2"        TO PAR-NAME.
040700     MOVE "IV-21 4.3.8.2"        TO ANSI-REFERENCE.
040800     MOVE "TALLY FOR CHAR AFTER" TO FEATURE.
040900     MOVE ZEROS TO TABLE2.
041000     SET INDEX1 TO 2.
041100     SET INDEX2 TO 2.
041200 INS-TEST-F1-2.
041300     INSPECT TABLE1-REC (INDEX1 + 1)
041400        TALLYING WRK-DU-999 (INDEX2 + 1)
041500        FOR CHARACTERS AFTER " W".
041600     IF WRK-DU-999 (INDEX2 + 1) EQUAL TO 68
041700        PERFORM PASS
041800        GO TO INS-WRITE-F1-2.
041900     GO TO INS-FAIL-F1-2.
042000 INS-DELETE-F1-2.
042100     PERFORM DE-LETE.
042200     GO TO INS-WRITE-F1-2.
042300 INS-FAIL-F1-2.
042400     PERFORM FAIL.
042500     MOVE WRK-DU-999 (INDEX2 + 1) TO COMPUTED-N.
042600     MOVE 68 TO CORRECT-N.
042700 INS-WRITE-F1-2.
042800     PERFORM PRINT-DETAIL.
042900*
043000 INS-INIT-F1-3.
043100     MOVE "INS-TEST-F1-3" TO PAR-NAME.
043200     MOVE "IV-21 4.3.8.2"        TO ANSI-REFERENCE.
043300     MOVE "TALLY FOR ALL BEFORE" TO FEATURE.
043400     MOVE ZEROS TO TABLE2.
043500     SET INDEX1 TO 3.
043600     SET INDEX2 TO 3.
043700 INS-TEST-F1-3.
043800     INSPECT TABLE1-REC (INDEX1 - 1)
043900        TALLYING WRK-DU-999 (INDEX2 - 2)
044000        FOR ALL " " BEFORE INITIAL "W.C.".
044100     IF WRK-DU-999 (INDEX2 - 2) EQUAL TO 4
044200        PERFORM PASS
044300        GO TO INS-WRITE-F1-3.
044400     GO TO INS-FAIL-F1-3.
044500 INS-DELETE-F1-3.
044600     PERFORM DE-LETE.
044700     GO TO INS-WRITE-F1-3.
044800 INS-FAIL-F1-3.
044900     PERFORM FAIL.
045000     MOVE WRK-DU-999 (INDEX2 - 2) TO COMPUTED-N.
045100     MOVE 4 TO CORRECT-N.
045200 INS-WRITE-F1-3.
045300     PERFORM PRINT-DETAIL.
045400*
045500 INS-INIT-F2-4.
045600     MOVE "INS-TEST-F2-4" TO PAR-NAME.
045700     MOVE "IV-21 4.3.8.2"        TO ANSI-REFERENCE.
045800     MOVE "REPLACE BEFORE FIRST" TO FEATURE.
045900     SET INDEX1 TO 4.
046000     SET INDEX4 TO 1.
046100 INS-TEST-F2-4.
046200     INSPECT TABLE1-REC (INDEX1) REPLACING LEADING
046300        TABLE4-LETTER (INDEX4) BY TABLE4-LETTER (INDEX4 + 1)
046400        BEFORE INITIAL " AH YES" FIRST "I" BY "O"
046500        AFTER INITIAL "." ALL ". " BY ", " AFTER INITIAL
046600        TABLE4-LETTER (INDEX4 + 2).
046700     IF TABLE1-REC (INDEX1) EQUAL TO ANS-XN-83-1
046800        PERFORM PASS
046900        GO TO INS-WRITE-F2-4.
047000     GO TO INS-FAIL-F2-4.
047100 INS-DELETE-F2-4.
047200     PERFORM DE-LETE.
047300     GO TO INS-WRITE-F2-4.
047400 INS-FAIL-F2-4.
047500     MOVE    TABLE1-REC (INDEX1) TO WS-WRONG-1-83.
047600     MOVE    ANS-XN-83-1     TO WS-RIGHT-1-83.
047700     PERFORM FAIL.
047800     MOVE    WS-RIGHT-1-20   TO CORRECT-A.
047900     MOVE    WS-WRONG-1-20   TO COMPUTED-A.
048000     PERFORM PRINT-DETAIL.
048100     MOVE    WS-RIGHT-21-40  TO CORRECT-A.
048200     MOVE    WS-WRONG-21-40  TO COMPUTED-A.
048300     PERFORM PRINT-DETAIL.
048400     MOVE    WS-RIGHT-41-60  TO CORRECT-A.
048500     MOVE    WS-WRONG-41-60  TO COMPUTED-A.
048600     PERFORM PRINT-DETAIL.
048700     MOVE    WS-RIGHT-61-80  TO CORRECT-A.
048800     MOVE    WS-WRONG-61-80  TO COMPUTED-A.
048900     PERFORM PRINT-DETAIL.
049000     MOVE    WS-RIGHT-81-83  TO CORRECT-A.
049100     MOVE    WS-WRONG-81-83  TO COMPUTED-A.
049200     PERFORM PRINT-DETAIL.
049300 INS-WRITE-F2-4.
049400     PERFORM PRINT-DETAIL.
049500*
049600 INS-INIT-F2-5.
049700     MOVE "INS-TEST-F2-5" TO PAR-NAME.
049800     MOVE "IV-21 4.3.8.2"      TO ANSI-REFERENCE.
049900     MOVE "REPLACE LEAD AFTER" TO FEATURE
050000     PERFORM INIT-TABLE1.
050100     MOVE
050200     "AH YES,AH YES W.C. FRITOES HERE. ANYONE WHO HATES DOGS AND K
050300-    "IDS CAN NOT BE ALL BAD."
050400         TO ANS-XN-83-2.
050500     SET INDEX1 TO 1.
050600     SET INDEX3 TO 1.
050700 INS-TEST-F2-5.
050800     INSPECT TABLE1-REC (INDEX1) REPLACING LEADING
050900        TABLE3-SYMBOL (INDEX3) BY TABLE3-SYMBOL (INDEX3 + 1)
051000        AFTER INITIAL "YES".
051100     IF TABLE1-REC (INDEX1) EQUAL TO ANS-XN-83-2
051200        PERFORM PASS
051300        GO TO INS-WRITE-F2-5.
051400     GO TO INS-FAIL-F2-5.
051500 INS-DELETE-F2-5.
051600     PERFORM DE-LETE.
051700     GO TO INS-WRITE-F2-5.
051800 INS-FAIL-F2-5.
051900     MOVE    TABLE1-REC (INDEX1) TO WS-WRONG-1-83.
052000     MOVE    ANS-XN-83-2     TO WS-RIGHT-1-83.
052100     PERFORM FAIL.
052200     MOVE    WS-RIGHT-1-20   TO CORRECT-A.
052300     MOVE    WS-WRONG-1-20   TO COMPUTED-A.
052400     PERFORM PRINT-DETAIL.
052500     MOVE    WS-RIGHT-21-40  TO CORRECT-A.
052600     MOVE    WS-WRONG-21-40  TO COMPUTED-A.
052700     PERFORM PRINT-DETAIL.
052800     MOVE    WS-RIGHT-41-60  TO CORRECT-A.
052900     MOVE    WS-WRONG-41-60  TO COMPUTED-A.
053000     PERFORM PRINT-DETAIL.
053100     MOVE    WS-RIGHT-61-80  TO CORRECT-A.
053200     MOVE    WS-WRONG-61-80  TO COMPUTED-A.
053300     PERFORM PRINT-DETAIL.
053400     MOVE    WS-RIGHT-81-83  TO CORRECT-A.
053500     MOVE    WS-WRONG-81-83  TO COMPUTED-A.
053600     PERFORM PRINT-DETAIL.
053700 INS-WRITE-F2-5.
053800     PERFORM PRINT-DETAIL.
053900*
054000 INS-INIT-F2-6.
054100     MOVE "INS-TEST-F2-6" TO PAR-NAME.
054200     MOVE "IV-21 4.3.8.2"        TO ANSI-REFERENCE.
054300     MOVE "REPLACE FIRST BEFORE" TO FEATURE.
054400     PERFORM INIT-TABLE1.
054500     SET INDEX1 TO 3.
054600     MOVE
054700     "OH YES AH YES W.C. FRITOES HERE. ANYONE WHO HATES DOGS AND K
054800-    "IDS CAN NOT BE ALL BAD."
054900         TO ANS-XN-83-3.
055000 INS-TEST-F2-6.
055100     INSPECT TABLE1-REC (INDEX1 - 1) REPLACING FIRST "A" BY "O"
055200        BEFORE INITIAL "H YES".
055300     IF TABLE1-REC (INDEX1 - 1) EQUAL TO ANS-XN-83-3
055400        PERFORM PASS
055500        GO TO INS-WRITE-F2-6.
055600     GO TO INS-FAIL-F2-6.
055700 INS-DELETE-F2-6.
055800     PERFORM DE-LETE.
055900     GO TO INS-WRITE-F2-6.
056000 INS-FAIL-F2-6.
056100     MOVE    TABLE1-REC (INDEX1 - 1) TO WS-WRONG-1-83.
056200     MOVE    ANS-XN-83-3     TO WS-RIGHT-1-83.
056300     PERFORM FAIL.
056400     MOVE    WS-RIGHT-1-20   TO CORRECT-A.
056500     MOVE    WS-WRONG-1-20   TO COMPUTED-A.
056600     PERFORM PRINT-DETAIL.
056700     MOVE    WS-RIGHT-21-40  TO CORRECT-A.
056800     MOVE    WS-WRONG-21-40  TO COMPUTED-A.
056900     PERFORM PRINT-DETAIL.
057000     MOVE    WS-RIGHT-41-60  TO CORRECT-A.
057100     MOVE    WS-WRONG-41-60  TO COMPUTED-A.
057200     PERFORM PRINT-DETAIL.
057300     MOVE    WS-RIGHT-61-80  TO CORRECT-A.
057400     MOVE    WS-WRONG-61-80  TO COMPUTED-A.
057500     PERFORM PRINT-DETAIL.
057600     MOVE    WS-RIGHT-81-83  TO CORRECT-A.
057700     MOVE    WS-WRONG-81-83  TO COMPUTED-A.
057800     PERFORM PRINT-DETAIL.
057900 INS-WRITE-F2-6.
058000     PERFORM PRINT-DETAIL.
058100*
058200 INS-INIT-F2-7.
058300     MOVE "INS-TEST-F2-7"     TO PAR-NAME.
058400     MOVE "IV-21 4.3.8.2"     TO ANSI-REFERENCE.
058500     MOVE "REPLACE ALL AFTER" TO FEATURE.
058600     PERFORM INIT-TABLE1.
058700     PERFORM INIT-TABLE4.
058800     MOVE
058900     "AH YES AH YES W.C. FRITOES HERE. ANYONE WHO HATES DOGS AND K
059000-    "IDS CAN NOT BE ALL-BAD."
059100     TO ANS-XN-83-4.
059200     SET INDEX1 TO 1.
059300     SET INDEX4 TO 4.
059400 INS-TEST-F2-7.
059500     INSPECT TABLE1-REC (INDEX1 + 1) REPLACING ALL SPACES BY "-"
059600        AFTER TABLE4-LETTER (INDEX4).
059700     IF TABLE1-REC (INDEX1 + 1) EQUAL TO ANS-XN-83-4
059800        PERFORM PASS
059900        GO TO INS-WRITE-F2-7.
060000     GO TO INS-FAIL-F2-7.
060100 INS-DELETE-F2-7.
060200     PERFORM DE-LETE.
060300     GO TO INS-WRITE-F2-7.
060400 INS-FAIL-F2-7.
060500     MOVE    TABLE1-REC (INDEX1 + 1) TO WS-WRONG-1-83.
060600     MOVE    ANS-XN-83-4     TO WS-RIGHT-1-83.
060700     PERFORM FAIL.
060800     MOVE    WS-RIGHT-1-20   TO CORRECT-A.
060900     MOVE    WS-WRONG-1-20   TO COMPUTED-A.
061000     PERFORM PRINT-DETAIL.
061100     MOVE    WS-RIGHT-21-40  TO CORRECT-A.
061200     MOVE    WS-WRONG-21-40  TO COMPUTED-A.
061300     PERFORM PRINT-DETAIL.
061400     MOVE    WS-RIGHT-41-60  TO CORRECT-A.
061500     MOVE    WS-WRONG-41-60  TO COMPUTED-A.
061600     PERFORM PRINT-DETAIL.
061700     MOVE    WS-RIGHT-61-80  TO CORRECT-A.
061800     MOVE    WS-WRONG-61-80  TO COMPUTED-A.
061900     PERFORM PRINT-DETAIL.
062000     MOVE    WS-RIGHT-81-83  TO CORRECT-A.
062100     MOVE    WS-WRONG-81-83  TO COMPUTED-A.
062200     PERFORM PRINT-DETAIL.
062300 INS-WRITE-F2-7.
062400     PERFORM PRINT-DETAIL.
062500*
062600 INS-INIT-F3-8.
062700     MOVE "INS-TEST-F3-8"       TO PAR-NAME.
062800     MOVE "IV-21 4.3.8.2"       TO ANSI-REFERENCE.
062900     MOVE "TALLY REPLACE CHARS" TO FEATURE.
063000     MOVE 1 TO REC-CT.
063100     PERFORM INIT-TABLE1.
063200     PERFORM INIT-TABLE4.
063300     MOVE ZEROS TO TABLE2.
063400     SET INDEX1 TO 4.
063500     SET INDEX2 TO 1.
063600     SET INDEX4 TO 5.
063700 INS-TEST-F3-8-0.
063800     INSPECT TABLE1-REC (INDEX1 - 2)
063900        TALLYING WRK-DU-999 (INDEX2 + 2) FOR CHARACTERS
064000        AFTER "L" REPLACING ALL "A" BY "E"
064100        BEFORE INITIAL TABLE4-LETTER (INDEX4).
064200     GO TO INS-TEST-F3-8-1.
064300 INS-DELETE-F3-8.
064400     PERFORM DE-LETE.
064500     PERFORM PRINT-DETAIL.
064600     GO TO INS-INIT-F3-9.
064700 INS-TEST-F3-8-1.
064800     IF WRK-DU-999 (INDEX2 + 2) EQUAL TO 6
064900        PERFORM PASS
065000        GO TO INS-WRITE-F3-8-1
065100        ELSE GO TO INS-FAIL-F3-8-1.
065200 INS-DELETE-F3-8-1.
065300     PERFORM DE-LETE.
065400     GO TO INS-WRITE-F3-8-1.
065500 INS-FAIL-F3-8-1.
065600     MOVE WRK-DU-999 (INDEX2 + 2) TO COMPUTED-N
065700     MOVE 6 TO CORRECT-N .
065800     PERFORM FAIL.
065900 INS-WRITE-F3-8-1.
066000     PERFORM PRINT-DETAIL.
066100*
066200 INS-TEST-F3-8-2.
066300     ADD 1 TO REC-CT.
066400     IF TABLE1-REC (INDEX1 - 2) EQUAL TO ANS-XN-83-5
066500        PERFORM PASS
066600        GO TO INS-WRITE-F3-8-2
066700     ELSE
066800        GO TO INS-FAIL-F3-8-2.
066900 INS-DELETE-F3-8-2.
067000     PERFORM DE-LETE.
067100     GO TO INS-WRITE-F3-8-2.
067200 INS-FAIL-F3-8-2.
067300     MOVE    TABLE1-REC (INDEX1 - 2) TO WS-WRONG-1-83
067400     MOVE    ANS-XN-83-5     TO WS-RIGHT-1-83
067500     PERFORM FAIL
067600     MOVE    WS-RIGHT-1-20   TO CORRECT-A
067700     MOVE    WS-WRONG-1-20   TO COMPUTED-A
067800     PERFORM PRINT-DETAIL
067900     MOVE    WS-RIGHT-21-40  TO CORRECT-A
068000     MOVE    WS-WRONG-21-40  TO COMPUTED-A
068100     PERFORM PRINT-DETAIL
068200     MOVE    WS-RIGHT-41-60  TO CORRECT-A
068300     MOVE    WS-WRONG-41-60  TO COMPUTED-A
068400     PERFORM PRINT-DETAIL
068500     MOVE    WS-RIGHT-61-80  TO CORRECT-A
068600     MOVE    WS-WRONG-61-80  TO COMPUTED-A
068700     PERFORM PRINT-DETAIL
068800     MOVE    WS-RIGHT-81-83  TO CORRECT-A
068900     MOVE    WS-WRONG-81-83  TO COMPUTED-A.
069000 INS-WRITE-F3-8-2.
069100     PERFORM PRINT-DETAIL.
069200*
069300 INS-INIT-F3-9.
069400     MOVE "INS-TEST-F3-9"        TO PAR-NAME.
069500     MOVE "IV-21 4.3.8.2"        TO ANSI-REFERENCE.
069600     MOVE "TALLY BEFORE REPLACE" TO FEATURE.
069700     MOVE 1 TO REC-CT.
069800     PERFORM INIT-TABLE1.
069900     MOVE ZEROS TO TABLE2.
070000     PERFORM INIT-TABLE4.
070100     SET INDEX1 TO 4.
070200     SET INDEX2 TO 2.
070300     SET INDEX4 TO 1.
070400 INS-TEST-F3-9-0.
070500     INSPECT TABLE1-REC (INDEX1) TALLYING WRK-DU-999 (INDEX2)
070600        FOR ALL "A" BEFORE "L" REPLACING FIRST
070700        TABLE4-LETTER (INDEX4) BY TABLE4-LETTER (INDEX4 + 1)
070800        AFTER INITIAL "H".
070900     GO TO INS-TEST-F3-9-1.
071000 INS-DELETE-F3-9.
071100     PERFORM DE-LETE.
071200     PERFORM PRINT-DETAIL.
071300     GO TO INS-INIT-F3-10.
071400 INS-TEST-F3-9-1.
071500     IF WRK-DU-999 (INDEX2) EQUAL TO 7
071600        PERFORM PASS
071700        GO TO INS-WRITE-F3-9-1
071800        ELSE GO TO INS-FAIL-F3-9-1.
071900 INS-DELETE-F3-9-1.
072000     PERFORM DE-LETE.
072100     GO TO INS-WRITE-F3-9-1.
072200 INS-FAIL-F3-9-1.
072300     MOVE WRK-DU-999 (INDEX2) TO COMPUTED-N
072400     MOVE 7 TO CORRECT-N
072500     PERFORM FAIL.
072600 INS-WRITE-F3-9-1.
072700     PERFORM PRINT-DETAIL.
072800*
072900 INS-TEST-F3-9-2.
073000     ADD 1 TO REC-CT.
073100     IF TABLE1-REC (INDEX1) EQUAL TO ANS-XN-83-6
073200        PERFORM PASS
073300        GO TO INS-WRITE-F3-9-2
073400     ELSE
073500        GO TO INS-FAIL-F3-9-2.
073600 INS-DELETE-F3-9-2.
073700     PERFORM DE-LETE.
073800     GO TO INS-WRITE-F3-9-2.
073900 INS-FAIL-F3-9-2.
074000     MOVE    TABLE1-REC (INDEX1) TO WS-WRONG-1-83
074100     MOVE    ANS-XN-83-6     TO WS-RIGHT-1-83
074200     PERFORM FAIL
074300     MOVE    WS-RIGHT-1-20   TO CORRECT-A
074400     MOVE    WS-WRONG-1-20   TO COMPUTED-A
074500     PERFORM PRINT-DETAIL
074600     MOVE    WS-RIGHT-21-40  TO CORRECT-A
074700     MOVE    WS-WRONG-21-40  TO COMPUTED-A
074800     PERFORM PRINT-DETAIL
074900     MOVE    WS-RIGHT-41-60  TO CORRECT-A
075000     MOVE    WS-WRONG-41-60  TO COMPUTED-A
075100     PERFORM PRINT-DETAIL
075200     MOVE    WS-RIGHT-61-80  TO CORRECT-A
075300     MOVE    WS-WRONG-61-80  TO COMPUTED-A
075400     PERFORM PRINT-DETAIL
075500     MOVE    WS-RIGHT-81-83  TO CORRECT-A
075600     MOVE    WS-WRONG-81-83  TO COMPUTED-A.
075700 INS-WRITE-F3-9-2.
075800     PERFORM PRINT-DETAIL.
075900*
076000 INS-INIT-F3-10.
076100     MOVE "INS-TEST-F3-10"       TO PAR-NAME.
076200     MOVE "IV-21 4.3.8.2"        TO ANSI-REFERENCE.
076300     MOVE "TALLY LEAD REPL LEAD" TO FEATURE.
076400     MOVE 1 TO REC-CT.
076500     PERFORM INIT-TABLE1.
076600     MOVE ZEROS TO TABLE2.
076700     PERFORM INIT-TABLE4.
076800     SET INDEX1 TO 1.
076900     SET INDEX2 TO 1.
077000     SET INDEX4 TO 1.
077100 INS-TEST-F3-10-0.
077200     INSPECT TABLE1-REC (INDEX1) TALLYING WRK-DU-999 (INDEX2)
077300        FOR LEADING TABLE4-LETTER (INDEX4) REPLACING
077400        LEADING TABLE4-LETTER (INDEX4) BY "OH".
077500     GO TO INS-TEST-F3-10-1.
077600 INS-DELETE-F3-10.
077700     PERFORM DE-LETE.
077800     PERFORM PRINT-DETAIL.
077900     GO TO INS-INIT-F3-11.
078000 INS-TEST-F3-10-1.
078100     IF WRK-DU-999 (INDEX2) EQUAL TO 1
078200        PERFORM PASS
078300        GO TO INS-WRITE-F3-10-1
078400     ELSE
078500        GO TO INS-FAIL-F3-10-1.
078600 INS-DELETE-F3-10-1.
078700     PERFORM DE-LETE.
078800     GO TO INS-WRITE-F3-10-1.
078900 INS-FAIL-F3-10-1.
079000     MOVE WRK-DU-999 (INDEX2) TO COMPUTED-N
079100     MOVE 1 TO CORRECT-N
079200     PERFORM FAIL.
079300 INS-WRITE-F3-10-1.
079400     PERFORM PRINT-DETAIL.
079500*
079600 INS-TEST-F3-10-2.
079700     ADD 1 TO REC-CT.
079800     IF TABLE1-REC (INDEX1) EQUAL TO ANS-XN-83-3
079900        PERFORM PASS
080000        GO TO INS-WRITE-F3-10-2
080100     ELSE
080200        GO TO INS-FAIL-F3-10-2.
080300 INS-DELETE-F3-10-2.
080400     PERFORM DE-LETE.
080500     GO TO INS-WRITE-F3-10-2.
080600 INS-FAIL-F3-10-2.
080700     MOVE    TABLE1-REC (INDEX1) TO WS-WRONG-1-83
080800     MOVE    ANS-XN-83-3     TO WS-RIGHT-1-83
080900     PERFORM FAIL
081000     MOVE    WS-RIGHT-1-20   TO CORRECT-A
081100     MOVE    WS-WRONG-1-20   TO COMPUTED-A
081200     PERFORM PRINT-DETAIL
081300     MOVE    WS-RIGHT-21-40  TO CORRECT-A
081400     MOVE    WS-WRONG-21-40  TO COMPUTED-A
081500     PERFORM PRINT-DETAIL
081600     MOVE    WS-RIGHT-41-60  TO CORRECT-A
081700     MOVE    WS-WRONG-41-60  TO COMPUTED-A
081800     PERFORM PRINT-DETAIL
081900     MOVE    WS-RIGHT-61-80  TO CORRECT-A
082000     MOVE    WS-WRONG-61-80  TO COMPUTED-A
082100     PERFORM PRINT-DETAIL
082200     MOVE    WS-RIGHT-81-83  TO CORRECT-A
082300     MOVE    WS-WRONG-81-83  TO COMPUTED-A.
082400 INS-WRITE-F3-10-2.
082500     PERFORM PRINT-DETAIL.
082600*
082700 INS-INIT-F3-11.
082800     MOVE "INS-TEST-F3-11"       TO PAR-NAME.
082900     MOVE "IV-21 4.3.8.2"        TO ANSI-REFERENCE.
083000     MOVE "TALLY REPL FIRST AFT" TO FEATURE.
083100     MOVE 1 TO REC-CT.
083200     PERFORM INIT-TABLE1.
083300     MOVE ZEROS TO TABLE2.
083400     SET INDEX1 TO 2.
083500     SET INDEX2 TO 2.
083600 INS-TEST-F3-11-0.
083700     INSPECT TABLE1-REC (INDEX1) TALLYING WRK-DU-999 (INDEX2)
083800        FOR ALL "A" REPLACING FIRST "AH" BY "OH" AFTER
083900        INITIAL "YES".
084000     GO TO INS-TEST-F3-11-1.
084100 INS-DELETE-F3-11.
084200     PERFORM DE-LETE.
084300     PERFORM PRINT-DETAIL.
084400     GO TO INS-INIT-F3-12.
084500 INS-TEST-F3-11-1.
084600     IF WRK-DU-999 (INDEX2) EQUAL TO 8
084700        PERFORM PASS
084800        GO TO INS-WRITE-F3-11-1
084900     ELSE
085000        GO TO INS-FAIL-F3-11-1.
085100 INS-DELETE-F3-11-1.
085200     PERFORM DE-LETE.
085300     GO TO INS-WRITE-F3-11-1.
085400 INS-FAIL-F3-11-1.
085500     MOVE WRK-DU-999 (INDEX2) TO COMPUTED-N
085600     MOVE 8 TO CORRECT-N
085700     PERFORM FAIL.
085800 INS-WRITE-F3-11-1.
085900     PERFORM PRINT-DETAIL.
086000*
086100 INS-TEST-F3-11-2.
086200     ADD 1 TO REC-CT.
086300     IF TABLE1-REC (INDEX1) EQUAL TO ANS-XN-83-6
086400        PERFORM PASS
086500        GO TO INS-WRITE-F3-11-2
086600     ELSE
086700        GO TO INS-FAIL-F3-11-2.
086800 INS-DELETE-F3-11-2.
086900     PERFORM DE-LETE.
087000     GO TO INS-WRITE-F3-11-2.
087100 INS-FAIL-F3-11-2.
087200     MOVE    TABLE1-REC (INDEX1) TO WS-WRONG-1-83
087300     MOVE    ANS-XN-83-6     TO WS-RIGHT-1-83
087400     PERFORM FAIL
087500     MOVE    WS-RIGHT-1-20   TO CORRECT-A
087600     MOVE    WS-WRONG-1-20   TO COMPUTED-A
087700     PERFORM PRINT-DETAIL
087800     MOVE    WS-RIGHT-21-40  TO CORRECT-A
087900     MOVE    WS-WRONG-21-40  TO COMPUTED-A
088000     PERFORM PRINT-DETAIL
088100     MOVE    WS-RIGHT-41-60  TO CORRECT-A
088200     MOVE    WS-WRONG-41-60  TO COMPUTED-A
088300     PERFORM PRINT-DETAIL
088400     MOVE    WS-RIGHT-61-80  TO CORRECT-A
088500     MOVE    WS-WRONG-61-80  TO COMPUTED-A
088600     PERFORM PRINT-DETAIL
088700     MOVE    WS-RIGHT-81-83  TO CORRECT-A
088800     MOVE    WS-WRONG-81-83  TO COMPUTED-A.
088900 INS-WRITE-F3-11-2.
089000     PERFORM PRINT-DETAIL.
089100*
089200 INS-INIT-F3-12.
089300     MOVE "INS-TEST-F3-12"       TO PAR-NAME.
089400     MOVE "IV-21 4.3.8.2"        TO ANSI-REFERENCE.
089500     MOVE "TALLY CHARS REPL BEF" TO FEATURE.
089600     MOVE 1 TO REC-CT.
089700     PERFORM INIT-TABLE1.
089800     MOVE ZEROS TO TABLE2.
089900     PERFORM INIT-TABLE4.
090000     SET INDEX1 TO 3.
090100     SET INDEX2 TO 3.
090200     SET INDEX4 TO 1.
090300 INS-TEST-F3-12-0.
090400     INSPECT TABLE1-REC (INDEX1) TALLYING WRK-DU-999 (INDEX2)
090500        FOR CHARACTERS AFTER TABLE4-LETTER (INDEX4)
090600        REPLACING ALL "AH" BY "OH"
090700        BEFORE "YES".
090800     GO TO INS-TEST-F3-12-1.
090900 INS-DELETE-F3-12.
091000     PERFORM DE-LETE.
091100     PERFORM PRINT-DETAIL.
091200     GO TO CCVS-999999.
091300 INS-TEST-F3-12-1.
091400     IF WRK-DU-999 (INDEX2) EQUAL TO 81
091500        PERFORM PASS
091600        GO TO INS-WRITE-F3-12-1
091700        ELSE
091800        GO TO INS-FAIL-F3-12-1.
091900 INS-DELETE-F3-12-1.
092000     PERFORM DE-LETE.
092100     GO TO INS-WRITE-F3-12-1.
092200 INS-FAIL-F3-12-1.
092300     MOVE WRK-DU-999 (INDEX2) TO COMPUTED-N
092400     MOVE 81 TO CORRECT-N
092500     PERFORM FAIL.
092600 INS-WRITE-F3-12-1.
092700     PERFORM PRINT-DETAIL.
092800*
092900 INS-TEST-F3-12-2.
093000     ADD 1 TO REC-CT.
093100     IF TABLE1-REC (INDEX1) EQUAL TO ANS-XN-83-3
093200        PERFORM PASS
093300        GO TO INS-WRITE-F3-12-2
093400     ELSE
093500        GO TO INS-FAIL-F3-12-2.
093600 INS-DELETE-F3-12-2.
093700     PERFORM DE-LETE.
093800     GO TO INS-WRITE-F3-12-2.
093900 INS-FAIL-F3-12-2.
094000     MOVE    TABLE1-REC (INDEX1) TO WS-WRONG-1-83
094100     MOVE    ANS-XN-83-3     TO WS-RIGHT-1-83
094200     PERFORM FAIL
094300     MOVE    WS-RIGHT-1-20   TO CORRECT-A
094400     MOVE    WS-WRONG-1-20   TO COMPUTED-A
094500     PERFORM PRINT-DETAIL
094600     MOVE    WS-RIGHT-21-40  TO CORRECT-A
094700     MOVE    WS-WRONG-21-40  TO COMPUTED-A
094800     PERFORM PRINT-DETAIL
094900     MOVE    WS-RIGHT-41-60  TO CORRECT-A
095000     MOVE    WS-WRONG-41-60  TO COMPUTED-A
095100     PERFORM PRINT-DETAIL
095200     MOVE    WS-RIGHT-61-80  TO CORRECT-A
095300     MOVE    WS-WRONG-61-80  TO COMPUTED-A
095400     PERFORM PRINT-DETAIL
095500     MOVE    WS-RIGHT-81-83  TO CORRECT-A
095600     MOVE    WS-WRONG-81-83  TO COMPUTED-A.
095700 INS-WRITE-F3-12-2.
095800     PERFORM PRINT-DETAIL.
095900 CCVS-EXIT SECTION.
096000 CCVS-999999.
096100     GO TO CLOSE-FILES.
