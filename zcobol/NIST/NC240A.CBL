000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     NC240A.
000400
000500****************************************************************
000600*                                                              *
000700*    VALIDATION FOR:-                                          *
000800*                                                              *
000900*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
001000*                                                              *
001100*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001200*                                                              *
001300****************************************************************
001400*                                                              *
001500*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001600*                                                              *
001700*        X-55  - SYSTEM PRINTER NAME.                          *
001800*        X-82  - SOURCE COMPUTER NAME.                         *
001900*        X-83  - OBJECT COMPUTER NAME.                         *
002000*                                                              *
002100****************************************************************
002200*                                                              *
002300*    PROGRAM NC240A TESTS THE CONSTRUCTION AND ACCESS OF A     *
002400*    THREE-DIMENSIONAL TABLE USING SUBSCRIPTS.  THE CONTENT OF *
002500*    TABLE ELEMENTS IS VERIFIED BY USE OF THE FORMAT 4         *
002600*    "PERFORM" STATEMENT.                                      *
002700*                                                              *
002800****************************************************************
002900
003000 ENVIRONMENT DIVISION.
003100 CONFIGURATION SECTION.
003200 SOURCE-COMPUTER.
003300     XXXXX082.
003400 OBJECT-COMPUTER.
003500     XXXXX083.
003600 INPUT-OUTPUT SECTION.
003700 FILE-CONTROL.
003800     SELECT PRINT-FILE ASSIGN TO
003900     XXXXX055.
004000 DATA DIVISION.
004100 FILE SECTION.
004200 FD  PRINT-FILE.
004300 01  PRINT-REC PICTURE X(120).
004400 01  DUMMY-RECORD PICTURE X(120).
004500 WORKING-STORAGE SECTION.
004600 77  SUB-1              PICTURE S99   VALUE ZERO.
004700 77  SUB-2              PICTURE 99    VALUE ZERO.
004800 77  SUB-3              PICTURE 99    VALUE ZERO.
004900 77   TEST-CHECK PIC X(4) VALUE SPACE.
005000 77  CON-10             PICTURE 99  VALUE 10.
005100 77  CON-7              PICTURE 99  VALUE 07.
005200 77  ELEM-HOLD-AREA               PICTURE X(15) VALUE SPACES.
005300 77  CON-5              PICTURE 99  VALUE 05.
005400 77  SEC-HOLD-AREA                PICTURE X(11)  VALUE SPACES.
005500 77  CON-6              PICTURE 99  VALUE 06.
005600 77  GRP-HOLD-AREA                PICTURE X(5)  VALUE SPACES.
005700 01  GRP-NAME.
005800     02  FILLER              PICTURE XXX    VALUE "GRP".
005900     02  ADD-GRP             PICTURE 99     VALUE 01.
006000
006100 01  SEC-NAME.
006200     02  FILLER              PICTURE X(5)   VALUE "SEC (".
006300     02  SEC-GRP             PICTURE 99     VALUE 00.
006400     02  FILLER              PICTURE X      VALUE ",".
006500     02  ADD-SEC             PICTURE 99     VALUE 01.
006600     02  FILLER              PICTURE X      VALUE ")".
006700
006800 01  ELEM-NAME.
006900     02  FILLER              PICTURE X(6)   VALUE "ELEM (".
007000     02  ELEM-GRP            PICTURE 99     VALUE 00.
007100     02  FILLER              PICTURE X      VALUE ",".
007200     02  ELEM-SEC            PICTURE 99     VALUE 00.
007300     02  FILLER              PICTURE X      VALUE ",".
007400     02  ADD-ELEM            PICTURE 99     VALUE 01.
007500     02  FILLER              PICTURE X      VALUE ")".
007600
007700 01  3-DIMENSION-TBL.
007800     02  GRP-ENTRY OCCURS 10 TIMES INDEXED BY IDX-1.
007900         03  ENTRY-1         PICTURE X(5).
008000         03  GRP2-ENTRY OCCURS 10 TIMES INDEXED BY IDX-2.
008100             04  ENTRY-2     PICTURE X(11).
008200             04  GRP3-ENTRY OCCURS 10 TIMES INDEXED BY IDX-3.
008300                 05  ENTRY-3 PICTURE X(15).
008400 01  TEST-RESULTS.
008500     02 FILLER                   PIC X      VALUE SPACE.
008600     02 FEATURE                  PIC X(20)  VALUE SPACE.
008700     02 FILLER                   PIC X      VALUE SPACE.
008800     02 P-OR-F                   PIC X(5)   VALUE SPACE.
008900     02 FILLER                   PIC X      VALUE SPACE.
009000     02  PAR-NAME.
009100       03 FILLER                 PIC X(19)  VALUE SPACE.
009200       03  PARDOT-X              PIC X      VALUE SPACE.
009300       03 DOTVALUE               PIC 99     VALUE ZERO.
009400     02 FILLER                   PIC X(8)   VALUE SPACE.
009500     02 RE-MARK                  PIC X(61).
009600 01  TEST-COMPUTED.
009700     02 FILLER                   PIC X(30)  VALUE SPACE.
009800     02 FILLER                   PIC X(17)  VALUE
009900            "       COMPUTED=".
010000     02 COMPUTED-X.
010100     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
010200     03 COMPUTED-N               REDEFINES COMPUTED-A
010300                                 PIC -9(9).9(9).
010400     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
010500     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
010600     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
010700     03       CM-18V0 REDEFINES COMPUTED-A.
010800         04 COMPUTED-18V0                    PIC -9(18).
010900         04 FILLER                           PIC X.
011000     03 FILLER PIC X(50) VALUE SPACE.
011100 01  TEST-CORRECT.
011200     02 FILLER PIC X(30) VALUE SPACE.
011300     02 FILLER PIC X(17) VALUE "       CORRECT =".
011400     02 CORRECT-X.
011500     03 CORRECT-A                  PIC X(20) VALUE SPACE.
011600     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
011700     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
011800     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
011900     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
012000     03      CR-18V0 REDEFINES CORRECT-A.
012100         04 CORRECT-18V0                     PIC -9(18).
012200         04 FILLER                           PIC X.
012300     03 FILLER PIC X(2) VALUE SPACE.
012400     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
012500 01  CCVS-C-1.
012600     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
012700-    "SS  PARAGRAPH-NAME
012800-    "       REMARKS".
012900     02 FILLER                     PIC X(20)    VALUE SPACE.
013000 01  CCVS-C-2.
013100     02 FILLER                     PIC X        VALUE SPACE.
013200     02 FILLER                     PIC X(6)     VALUE "TESTED".
013300     02 FILLER                     PIC X(15)    VALUE SPACE.
013400     02 FILLER                     PIC X(4)     VALUE "FAIL".
013500     02 FILLER                     PIC X(94)    VALUE SPACE.
013600 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
013700 01  REC-CT                        PIC 99       VALUE ZERO.
013800 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
013900 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
014000 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
014100 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
014200 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
014300 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
014400 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
014500 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
014600 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
014700 01  CCVS-H-1.
014800     02  FILLER                    PIC X(39)    VALUE SPACES.
014900     02  FILLER                    PIC X(42)    VALUE
015000     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
015100     02  FILLER                    PIC X(39)    VALUE SPACES.
015200 01  CCVS-H-2A.
015300   02  FILLER                        PIC X(40)  VALUE SPACE.
015400   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
015500   02  FILLER                        PIC XXXX   VALUE
015600     "4.2 ".
015700   02  FILLER                        PIC X(28)  VALUE
015800            " COPY - NOT FOR DISTRIBUTION".
015900   02  FILLER                        PIC X(41)  VALUE SPACE.
016000
016100 01  CCVS-H-2B.
016200   02  FILLER                        PIC X(15)  VALUE
016300            "TEST RESULT OF ".
016400   02  TEST-ID                       PIC X(9).
016500   02  FILLER                        PIC X(4)   VALUE
016600            " IN ".
016700   02  FILLER                        PIC X(12)  VALUE
016800     " HIGH       ".
016900   02  FILLER                        PIC X(22)  VALUE
017000            " LEVEL VALIDATION FOR ".
017100   02  FILLER                        PIC X(58)  VALUE
017200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
017300 01  CCVS-H-3.
017400     02  FILLER                      PIC X(34)  VALUE
017500            " FOR OFFICIAL USE ONLY    ".
017600     02  FILLER                      PIC X(58)  VALUE
017700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
017800     02  FILLER                      PIC X(28)  VALUE
017900            "  COPYRIGHT   1985 ".
018000 01  CCVS-E-1.
018100     02 FILLER                       PIC X(52)  VALUE SPACE.
018200     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
018300     02 ID-AGAIN                     PIC X(9).
018400     02 FILLER                       PIC X(45)  VALUE SPACES.
018500 01  CCVS-E-2.
018600     02  FILLER                      PIC X(31)  VALUE SPACE.
018700     02  FILLER                      PIC X(21)  VALUE SPACE.
018800     02 CCVS-E-2-2.
018900         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
019000         03 FILLER                   PIC X      VALUE SPACE.
019100         03 ENDER-DESC               PIC X(44)  VALUE
019200            "ERRORS ENCOUNTERED".
019300 01  CCVS-E-3.
019400     02  FILLER                      PIC X(22)  VALUE
019500            " FOR OFFICIAL USE ONLY".
019600     02  FILLER                      PIC X(12)  VALUE SPACE.
019700     02  FILLER                      PIC X(58)  VALUE
019800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
019900     02  FILLER                      PIC X(13)  VALUE SPACE.
020000     02 FILLER                       PIC X(15)  VALUE
020100             " COPYRIGHT 1985".
020200 01  CCVS-E-4.
020300     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
020400     02 FILLER                       PIC X(4)   VALUE " OF ".
020500     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
020600     02 FILLER                       PIC X(40)  VALUE
020700      "  TESTS WERE EXECUTED SUCCESSFULLY".
020800 01  XXINFO.
020900     02 FILLER                       PIC X(19)  VALUE
021000            "*** INFORMATION ***".
021100     02 INFO-TEXT.
021200       04 FILLER                     PIC X(8)   VALUE SPACE.
021300       04 XXCOMPUTED                 PIC X(20).
021400       04 FILLER                     PIC X(5)   VALUE SPACE.
021500       04 XXCORRECT                  PIC X(20).
021600     02 INF-ANSI-REFERENCE           PIC X(48).
021700 01  HYPHEN-LINE.
021800     02 FILLER  PIC IS X VALUE IS SPACE.
021900     02 FILLER  PIC IS X(65)    VALUE IS "************************
022000-    "*****************************************".
022100     02 FILLER  PIC IS X(54)    VALUE IS "************************
022200-    "******************************".
022300 01  CCVS-PGM-ID                     PIC X(9)   VALUE
022400     "NC240A".
022500 PROCEDURE DIVISION.
022600 CCVS1 SECTION.
022700 OPEN-FILES.
022800     OPEN     OUTPUT PRINT-FILE.
022900     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
023000     MOVE    SPACE TO TEST-RESULTS.
023100     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
023200     GO TO CCVS1-EXIT.
023300 CLOSE-FILES.
023400     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
023500 TERMINATE-CCVS.
023600S    EXIT PROGRAM.
023700STERMINATE-CALL.
023800     STOP     RUN.
023900 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
024000 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
024100 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
024200 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
024300     MOVE "****TEST DELETED****" TO RE-MARK.
024400 PRINT-DETAIL.
024500     IF REC-CT NOT EQUAL TO ZERO
024600             MOVE "." TO PARDOT-X
024700             MOVE REC-CT TO DOTVALUE.
024800     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
024900     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
025000        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
025100          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
025200     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
025300     MOVE SPACE TO CORRECT-X.
025400     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
025500     MOVE     SPACE TO RE-MARK.
025600 HEAD-ROUTINE.
025700     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025800     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025900     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
026000     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
026100 COLUMN-NAMES-ROUTINE.
026200     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026300     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
026500 END-ROUTINE.
026600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
026700 END-RTN-EXIT.
026800     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026900 END-ROUTINE-1.
027000      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
027100      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
027200      ADD PASS-COUNTER TO ERROR-HOLD.
027300*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
027400      MOVE PASS-COUNTER TO CCVS-E-4-1.
027500      MOVE ERROR-HOLD TO CCVS-E-4-2.
027600      MOVE CCVS-E-4 TO CCVS-E-2-2.
027700      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
027800  END-ROUTINE-12.
027900      MOVE "TEST(S) FAILED" TO ENDER-DESC.
028000     IF       ERROR-COUNTER IS EQUAL TO ZERO
028100         MOVE "NO " TO ERROR-TOTAL
028200         ELSE
028300         MOVE ERROR-COUNTER TO ERROR-TOTAL.
028400     MOVE     CCVS-E-2 TO DUMMY-RECORD.
028500     PERFORM WRITE-LINE.
028600 END-ROUTINE-13.
028700     IF DELETE-COUNTER IS EQUAL TO ZERO
028800         MOVE "NO " TO ERROR-TOTAL  ELSE
028900         MOVE DELETE-COUNTER TO ERROR-TOTAL.
029000     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
029100     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029200      IF   INSPECT-COUNTER EQUAL TO ZERO
029300          MOVE "NO " TO ERROR-TOTAL
029400      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
029500      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
029600      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029700     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029800 WRITE-LINE.
029900     ADD 1 TO RECORD-COUNT.
030000Y    IF RECORD-COUNT GREATER 50
030100Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
030200Y        MOVE SPACE TO DUMMY-RECORD
030300Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
030400Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
030500Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
030600Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
030700Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
030800Y        MOVE ZERO TO RECORD-COUNT.
030900     PERFORM WRT-LN.
031000 WRT-LN.
031100     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
031200     MOVE SPACE TO DUMMY-RECORD.
031300 BLANK-LINE-PRINT.
031400     PERFORM WRT-LN.
031500 FAIL-ROUTINE.
031600     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
031700     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
031800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
031900     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
032000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032100     MOVE   SPACES TO INF-ANSI-REFERENCE.
032200     GO TO  FAIL-ROUTINE-EX.
032300 FAIL-ROUTINE-WRITE.
032400     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
032500     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
032600     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
032700     MOVE   SPACES TO COR-ANSI-REFERENCE.
032800 FAIL-ROUTINE-EX. EXIT.
032900 BAIL-OUT.
033000     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
033100     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
033200 BAIL-OUT-WRITE.
033300     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
033400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
033500     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033600     MOVE   SPACES TO INF-ANSI-REFERENCE.
033700 BAIL-OUT-EX. EXIT.
033800 CCVS1-EXIT.
033900     EXIT.
034000 SECT-NC24A-0001 SECTION.
034100 TH-13-001.
034200 BUILD-LEVEL-1.
034300     ADD 1 TO SUB-1.
034400     IF SUB-1 = 11 GO TO CHECK-ENTRIES.
034500     MOVE GRP-NAME TO ENTRY-1 (SUB-1).
034600     ADD 1 TO ADD-GRP.
034700
034800 BUILD-LEVEL-2.
034900     ADD 1 TO SUB-2.
035000     IF SUB-2 = 11
035100         MOVE ZERO TO SUB-2
035200         MOVE 01 TO ADD-SEC
035300         GO TO BUILD-LEVEL-1.
035400     MOVE SUB-1 TO SEC-GRP.
035500     MOVE SEC-NAME TO ENTRY-2 (SUB-1, SUB-2).
035600     ADD 1 TO ADD-SEC.
035700
035800 BUILD-LEVEL-3.
035900     ADD 1 TO SUB-3.
036000     IF SUB-3 = 11
036100         MOVE ZERO TO SUB-3
036200              MOVE 01 TO ADD-ELEM
036300              GO TO BUILD-LEVEL-2.
036400     MOVE SUB-1 TO ELEM-GRP.
036500     MOVE SUB-2 TO ELEM-SEC.
036600     MOVE ELEM-NAME TO ENTRY-3 (SUB-1, SUB-2, SUB-3).
036700     ADD 1 TO ADD-ELEM.
036800     GO TO BUILD-LEVEL-3.
036900
037000 CHECK-ENTRIES.
037100     MOVE "PERFORM VARYING LEV1" TO FEATURE.
037200     MOVE "CHECK-ENTRIES       " TO PAR-NAME.
037300     MOVE SPACES TO TEST-CHECK.
037400     MOVE "GRP05" TO GRP-HOLD-AREA.
037500     PERFORM FIND-LEVEL-1-ENTRY VARYING CON-5 FROM 1 BY 1
037600         UNTIL CON-5 = 11.
037700     IF TEST-CHECK = "PASS" GO TO TH1-INIT-GF-2.
037800     MOVE GRP-HOLD-AREA TO CORRECT-A.
037900     MOVE ENTRY-1 (05) TO COMPUTED-A.
038000
038100     MOVE "PERFORM VARYING DATA NAMES " TO RE-MARK.
038200     PERFORM FAIL.
038300     PERFORM PRINT-DETAIL.
038400*
038500 TH1-INIT-GF-2.
038600     MOVE "GRP10" TO GRP-HOLD-AREA.
038700     MOVE "TH1-TEST-GF-2      " TO PAR-NAME.
038800     MOVE "VI-109" TO ANSI-REFERENCE.
038900     MOVE SPACES TO TEST-CHECK.
039000 TH1-TEST-GF-2.
039100     PERFORM FIND-LEVEL-1-ENTRY
039200             VARYING CON-5 FROM 1 BY 1 UNTIL CON-5 = 11.
039300     IF TEST-CHECK = "PASS"
039400         PERFORM PASS
039500         GO TO TH1-WRITE-GF-2
039600     ELSE
039700         GO TO TH1-FAIL-GF-2.
039800 TH1-DELETE-GF-2.
039900     PERFORM DE-LETE.
040000     GO TO TH1-WRITE-GF-2.
040100 TH1-FAIL-GF-2.
040200     MOVE GRP-HOLD-AREA TO CORRECT-A.
040300     MOVE ENTRY-1 (10) TO COMPUTED-A.
040400
040500     MOVE "PERFORM VARYING DATA NAMES " TO RE-MARK.
040600     PERFORM FAIL.
040700 TH1-WRITE-GF-2.
040800     PERFORM PRINT-DETAIL.
040900
041000 TH1-INIT-GF-3.
041100     MOVE "GRP07" TO GRP-HOLD-AREA.
041200     MOVE "TH1-TEST-GF-3      " TO PAR-NAME.
041300     MOVE "VI-109" TO ANSI-REFERENCE.
041400     MOVE SPACES TO TEST-CHECK.
041500 TH1-TEST-GF-3.
041600     PERFORM FIND-LEVEL-1-ENTRY
041700             VARYING CON-5 FROM 1 BY 1 UNTIL CON-5 = 11.
041800     IF TEST-CHECK = "PASS"
041900         PERFORM PASS
042000         GO TO TH1-WRITE-GF-3
042100     ELSE
042200         GO TO TH1-FAIL-GF-3.
042300 TH1-DELETE-GF-3.
042400     PERFORM DE-LETE.
042500     GO TO TH1-WRITE-GF-3.
042600 TH1-FAIL-GF-3.
042700     MOVE GRP-HOLD-AREA TO CORRECT-A.
042800     MOVE ENTRY-1 (07) TO COMPUTED-A.
042900
043000     MOVE "PERFORM VARYING DATA NAMES " TO RE-MARK.
043100     PERFORM FAIL.
043200 TH1-WRITE-GF-3.
043300     PERFORM PRINT-DETAIL.
043400*
043500 TH1-INIT-GF-4.
043600     MOVE "TH1-TEST-GF-4      " TO PAR-NAME.
043700     MOVE "VI-109" TO ANSI-REFERENCE.
043800     MOVE "GRP01" TO GRP-HOLD-AREA.
043900 TH1-TEST-GF-4.
044000     PERFORM FIND-LEVEL-1-ENTRY
044100             VARYING CON-5 FROM 1 BY 1 UNTIL CON-5 = 11.
044200     IF TEST-CHECK = "PASS"
044300         PERFORM PASS
044400         GO TO TH1-WRITE-GF-4
044500     ELSE
044600         GO TO TH1-FAIL-GF-4.
044700 TH1-DELETE-GF-4.
044800     PERFORM DE-LETE.
044900     GO TO TH1-WRITE-GF-4.
045000 TH1-FAIL-GF-4.
045100     MOVE GRP-HOLD-AREA TO CORRECT-A.
045200     MOVE ENTRY-1 (01) TO COMPUTED-A.
045300
045400     MOVE "PERFORM VARYING DATA NAMES " TO RE-MARK.
045500     PERFORM FAIL.
045600 TH1-WRITE-GF-4.
045700     PERFORM PRINT-DETAIL.
045800     GO TO TH2-INIT-GF-1.
045900
046000 FIND-LEVEL-1-ENTRY.
046100     IF ENTRY-1 (CON-5) = GRP-HOLD-AREA
046200         MOVE "PASS" TO TEST-CHECK.
046300
046400 TH2-INIT-GF-1.
046500     MOVE "TH2-TEST-GF-1      " TO PAR-NAME.
046600     MOVE "PERFORM VARYING LEV2" TO FEATURE.
046700     MOVE "VI-109" TO ANSI-REFERENCE.
046800     MOVE "SEC (03,05)" TO SEC-HOLD-AREA.
046900     MOVE SPACES TO TEST-CHECK.
047000 TH2-TEST-GF-1.
047100     PERFORM FIND-LEVEL-2-ENTRY
047200             VARYING CON-5 FROM 1 BY 1 UNTIL CON-5 = 11
047300             AFTER   CON-6 FROM 1 BY 1 UNTIL CON-6 = 10.
047400     IF TEST-CHECK = "PASS"
047500         PERFORM PASS
047600         GO TO TH2-WRITE-GF-1
047700     ELSE
047800         GO TO TH2-FAIL-GF-1.
047900 TH2-DELETE-GF-1.
048000     PERFORM DE-LETE.
048100     GO TO TH2-WRITE-GF-1.
048200 TH2-FAIL-GF-1.
048300     MOVE SEC-HOLD-AREA TO CORRECT-A.
048400     MOVE ENTRY-2 (03, 05) TO COMPUTED-A.
048500
048600     MOVE "PERFORM VARYING DATA NAMES " TO RE-MARK.
048700     PERFORM FAIL.
048800 TH2-WRITE-GF-1.
048900     PERFORM PRINT-DETAIL.
049000
049100 TH2-INIT-GF-2.
049200     MOVE "TH2-TEST-GF-2      " TO PAR-NAME.
049300     MOVE "VI-109" TO ANSI-REFERENCE.
049400     MOVE SPACES TO TEST-CHECK.
049500     MOVE "SEC (01,01)" TO SEC-HOLD-AREA.
049600 TH2-TEST-GF-2.
049700     PERFORM FIND-LEVEL-2-ENTRY
049800             VARYING CON-5 FROM 1 BY 1 UNTIL CON-5 = 11
049900             AFTER   CON-6 FROM 1 BY 1 UNTIL CON-6 = 10.
050000     IF TEST-CHECK = "PASS"
050100         PERFORM PASS
050200         GO TO TH2-WRITE-GF-2
050300     ELSE
050400         GO TO TH2-FAIL-GF-2.
050500 TH2-DELETE-GF-2.
050600     PERFORM DE-LETE.
050700     GO TO TH2-WRITE-GF-2.
050800 TH2-FAIL-GF-2.
050900     MOVE SEC-HOLD-AREA TO CORRECT-A.
051000     MOVE ENTRY-2 (01, 01) TO COMPUTED-A.
051100
051200     MOVE "PERFORM VARYING DATA NAMES " TO RE-MARK.
051300     PERFORM FAIL.
051400 TH2-WRITE-GF-2.
051500     PERFORM PRINT-DETAIL.
051600
051700 TH2-INIT-GF-3.
051800     MOVE "TH2-TEST-GF-3      " TO PAR-NAME.
051900     MOVE SPACES TO TEST-CHECK.
052000     MOVE "VI-109" TO ANSI-REFERENCE.
052100     MOVE "SEC (10,01)" TO SEC-HOLD-AREA.
052200 TH2-TEST-GF-3.
052300     PERFORM FIND-LEVEL-2-ENTRY
052400             VARYING CON-5 FROM 1 BY 1 UNTIL CON-5 = 11
052500             AFTER   CON-6 FROM 1 BY 1 UNTIL CON-6 = 10.
052600     IF TEST-CHECK = "PASS"
052700         PERFORM PASS
052800         GO TO TH2-WRITE-GF-3
052900     ELSE
053000         GO TO TH2-FAIL-GF-3.
053100 TH2-DELETE-GF-3.
053200     PERFORM DE-LETE.
053300     GO TO TH2-WRITE-GF-3.
053400 TH2-FAIL-GF-3.
053500     MOVE SEC-HOLD-AREA TO CORRECT-A.
053600     MOVE ENTRY-2 (10, 01) TO COMPUTED-A.
053700
053800     MOVE "PERFORM VARYING DATA NAMES " TO RE-MARK.
053900     PERFORM FAIL.
054000 TH2-WRITE-GF-3.
054100     PERFORM PRINT-DETAIL.
054200*
054300 TH2-INIT-GF-4.
054400     MOVE "TH2-TEST-GF-4      " TO PAR-NAME.
054500     MOVE "VI-109" TO ANSI-REFERENCE.
054600     MOVE SPACES TO TEST-CHECK.
054700     MOVE SPACES TO TEST-CHECK.
054800     MOVE "SEC (10,10)" TO SEC-HOLD-AREA.
054900 TH2-TEST-GF-4.
055000     PERFORM FIND-LEVEL-2-ENTRY
055100             VARYING CON-5 FROM 2 BY 2 UNTIL CON-5 = 12
055200             AFTER   CON-6 FROM 2 BY 2 UNTIL CON-6 = 12.
055300     IF TEST-CHECK = "PASS"
055400         PERFORM PASS
055500         GO TO TH2-WRITE-GF-4
055600     ELSE
055700         GO TO TH2-FAIL-GF-4.
055800 TH2-DELETE-GF-4.
055900     PERFORM DE-LETE.
056000     GO TO TH2-WRITE-GF-4.
056100 TH2-FAIL-GF-4.
056200     MOVE SEC-HOLD-AREA TO CORRECT-A.
056300     MOVE ENTRY-2 (10, 10) TO COMPUTED-A.
056400
056500     MOVE "PERFORM VARYING DATA NAMES " TO RE-MARK.
056600     PERFORM FAIL.
056700 TH2-WRITE-GF-4.
056800     PERFORM PRINT-DETAIL.
056900     GO TO TH3-INIT-GF-1.
057000*
057100 FIND-LEVEL-2-ENTRY.
057200     IF ENTRY-2 (CON-5, CON-6) = SEC-HOLD-AREA
057300         MOVE "PASS" TO TEST-CHECK.
057400*
057500 TH3-INIT-GF-1.
057600     MOVE "PERFORM VARYING LEV3" TO FEATURE.
057700     MOVE "VI-109" TO ANSI-REFERENCE.
057800     MOVE SPACES TO TEST-CHECK.
057900     MOVE "TH3-TEST-GF-1      " TO PAR-NAME.
058000     MOVE "ELEM (01,02,03)" TO ELEM-HOLD-AREA.
058100 TH3-TEST-GF-1.
058200     PERFORM FIND-LEVEL-3-ENTRY
058300             VARYING CON-5 FROM 1 BY 1 UNTIL CON-5 = 11
058400             AFTER   CON-6 FROM 1 BY 1 UNTIL CON-6 = 10
058500             AFTER   CON-7 FROM 1 BY 1 UNTIL CON-7 = 10.
058600     IF TEST-CHECK = "PASS"
058700         PERFORM PASS
058800         GO TO TH3-WRITE-GF-1
058900     ELSE
059000         GO TO TH3-FAIL-GF-1.
059100 TH3-DELETE-GF-1.
059200     PERFORM DE-LETE.
059300     GO TO TH3-WRITE-GF-1.
059400 TH3-FAIL-GF-1.
059500     MOVE ELEM-HOLD-AREA TO CORRECT-A.
059600     MOVE ENTRY-3 (01, 02, 03) TO COMPUTED-A.
059700
059800     MOVE "PERFORM VARYING DATA NAMES " TO RE-MARK.
059900     PERFORM FAIL.
060000 TH3-WRITE-GF-1.
060100     PERFORM PRINT-DETAIL.
060200
060300 TH3-INIT-GF-2.
060400     MOVE "TH3-TEST-GF-2      " TO PAR-NAME.
060500     MOVE "VI-109" TO ANSI-REFERENCE.
060600     MOVE "ELEM (10,10,10)" TO ELEM-HOLD-AREA.
060700     MOVE SPACES TO TEST-CHECK.
060800 TH3-TEST-GF-2.
060900     PERFORM FIND-LEVEL-3-ENTRY
061000             VARYING CON-5 FROM 1 BY 1 UNTIL CON-5 = 11
061100             AFTER   CON-6 FROM 1 BY 1 UNTIL CON-6 = 11
061200             AFTER   CON-7 FROM 1 BY 1 UNTIL CON-7 = 11.
061300     IF TEST-CHECK = "PASS"
061400         PERFORM PASS
061500         GO TO TH3-WRITE-GF-2
061600     ELSE
061700         GO TO TH3-FAIL-GF-2.
061800 TH3-DELETE-GF-2.
061900     PERFORM DE-LETE.
062000     GO TO TH3-WRITE-GF-2.
062100 TH3-FAIL-GF-2.
062200     MOVE ELEM-HOLD-AREA TO CORRECT-A.
062300     MOVE ENTRY-3 (10, 10, 10) TO COMPUTED-A.
062400
062500     MOVE "PERFORM VARYING DATA NAMES " TO RE-MARK.
062600     PERFORM FAIL.
062700 TH3-WRITE-GF-2.
062800     PERFORM PRINT-DETAIL.
062900
063000 TH3-INIT-GF-3.
063100     MOVE "TH3-TEST-GF-3      " TO PAR-NAME.
063200     MOVE "VI-109" TO ANSI-REFERENCE.
063300     MOVE "ELEM (08,07,06)" TO ELEM-HOLD-AREA.
063400     MOVE SPACES TO TEST-CHECK.
063500 TH3-TEST-GF-3.
063600     PERFORM FIND-LEVEL-3-ENTRY
063700             VARYING CON-5 FROM 1 BY 1 UNTIL CON-5 = 11
063800             AFTER   CON-6 FROM 1 BY 1 UNTIL CON-6 = 10
063900             AFTER   CON-7 FROM 1 BY 1 UNTIL CON-7 = 10.
064000     IF TEST-CHECK = "PASS"
064100         PERFORM PASS
064200         GO TO TH3-WRITE-GF-3
064300     ELSE
064400         GO TO TH3-FAIL-GF-3.
064500 TH3-DELETE-GF-3.
064600     PERFORM DE-LETE.
064700     GO TO TH3-WRITE-GF-3.
064800 TH3-FAIL-GF-3.
064900     MOVE ELEM-HOLD-AREA TO CORRECT-A.
065000     MOVE ENTRY-3 (08, 07, 06) TO COMPUTED-A.
065100
065200     MOVE "PERFORM VARYING DATA NAMES " TO RE-MARK.
065300     PERFORM FAIL.
065400 TH3-WRITE-GF-3.
065500     PERFORM PRINT-DETAIL.
065600*
065700 TH3-INIT-GF-4.
065800     MOVE "TH3-TEST-GF-4      " TO PAR-NAME.
065900     MOVE "VI-109" TO ANSI-REFERENCE.
066000     MOVE SPACES TO TEST-CHECK.
066100     MOVE "ELEM (06,04,08)" TO ELEM-HOLD-AREA.
066200 TH3-TEST-GF-4.
066300     PERFORM FIND-LEVEL-3-ENTRY
066400             VARYING CON-5 FROM 3 BY 3 UNTIL CON-5 = 12
066500             AFTER   CON-6 FROM 2 BY 2 UNTIL CON-6 = 12
066600             AFTER   CON-7 FROM 8 BY 8 UNTIL CON-7 = 16.
066700     IF TEST-CHECK = "PASS"
066800         PERFORM PASS
066900         GO TO TH3-WRITE-GF-4
067000     ELSE
067100         GO TO TH3-FAIL-GF-4.
067200 TH3-DELETE-GF-4.
067300     PERFORM DE-LETE.
067400     GO TO TH3-WRITE-GF-4.
067500 TH3-FAIL-GF-4.
067600     MOVE ELEM-HOLD-AREA TO CORRECT-A.
067700     MOVE ENTRY-3 (06, 04, 08) TO COMPUTED-A.
067800
067900     MOVE "PERFORM VARYING DATA NAMES " TO RE-MARK.
068000     PERFORM FAIL.
068100 TH3-WRITE-GF-4.
068200     PERFORM PRINT-DETAIL.
068300     GO TO END-3LEVEL-TEST.
068400
068500 FIND-LEVEL-3-ENTRY.
068600     IF ENTRY-3 (CON-5, CON-6, CON-7) = ELEM-HOLD-AREA
068700         MOVE "PASS" TO TEST-CHECK.
068800
068900 END-3LEVEL-TEST.
069000     EXIT.
069100 CCVS-EXIT SECTION.
069200 CCVS-999999.
069300     GO TO CLOSE-FILES.
