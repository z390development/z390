000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ113A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
000900*                             REVISED 1986, AUGUST             *
001000*                                                              *
001100*    CREATION DATE     /     VALIDATION DATE                   *
001200*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001300*                                                              *
001400****************************************************************
001500*                                                              *
001600*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001700*                                                              *
001800*            X-01   SEQUENTIAL MAGNETIC TAPE                   *
001900*            X-55   SYSTEM PRINTER                             *
002000*            X-82   SOURCE-COMPUTER                            *
002100*            X-83   OBJECT-COMPUTER.                           *
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    SQ113A CREATES A MAGNETIC TAPE FILE CONTAINING 750 FIXED  *
002600*    LENGTH RECORDS, EACH 120 CHARACTERS LONG.  THE FILE IS    *
002700*    READ TWICE.  THE FIRST PASS CHECKS THAT ALL THE EXPECTED  *
002800*    RECORDS ARE PRESENT.  THE SECOND PASS PERFORMS SIMILAR    *
002900*    CHECKS, BUT USES ALL FOUR VARIANTS OF THE READ STATEMENT  *
003000*    WITH THE END PHRASE THAT CAN BE PRODUCED BY INCLUDING OR  *
003100*    OMITTING THE OPTIONAL WORDS "RECORD" AND "AT".            *
003200*                                                              *
003300*    THE PROGRAM IS ALMOST IDENTICAL TO SQ102A, AND IS DERIVED *
003400*    FROM THAT PROGRAM BY INCLUDING A FILE STATUS CLAUSE IN    *
003500*    THE FILE-CONTROL ENTRY FOR THE TEST FILE, AND INCLUDING   *
003600*    TESTS ON THE I-O STATUS RETURNED AFTER EACH OPERATION ON  *
003700*    THE FILE                                                  *
003800*                                                              *
003900*    THE PROGRAM OMITS THE OPTIONAL WORDS "ORGANIZATION IS"    *
004000*    FROM THE "ORGANIZATION IS SEQUENTIAL" CLAUSE OF THE       *
004100*    FILE-CONTROL ENTRY, AND PLACES THE ASSIGN CLAUSE IN A     *
004200*    POSITION OTHER THAN FIRST IN THE SAME ENTRY.              *
004300*                                                              *
004400****************************************************************
004500*
004600*
004700 ENVIRONMENT DIVISION.
004800 CONFIGURATION SECTION.
004900 SOURCE-COMPUTER.
005000     XXXXX082.
005100 OBJECT-COMPUTER.
005200     XXXXX083.
005300*
005400 INPUT-OUTPUT SECTION.
005500 FILE-CONTROL.
005600     SELECT PRINT-FILE ASSIGN TO
005700     XXXXX055.
005800*
005900P    SELECT RAW-DATA   ASSIGN TO
006000P    XXXXX062
006100P          ORGANIZATION IS INDEXED
006200P          ACCESS MODE  IS RANDOM
006300P          RECORD-KEY   IS RAW-DATA-KEY.
006400P
006500     SELECT SQ-FS1
006600            ACCESS MODE IS SEQUENTIAL
006700            SEQUENTIAL
006800            ASSIGN TO
006900     XXXXX001
007000            FILE STATUS IS SQ-FS1-STATUS.
007100*
007200*
007300 DATA DIVISION.
007400 FILE SECTION.
007500 FD  PRINT-FILE
007600C    LABEL RECORDS
007700C    XXXXX084
007800C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007900               .
008000 01  PRINT-REC    PICTURE X(120).
008100 01  DUMMY-RECORD PICTURE X(120).
008200P
008300PFD  RAW-DATA.
008400P01  RAW-DATA-SATZ.
008500P    05  RAW-DATA-KEY        PIC X(6).
008600P    05  C-DATE              PIC 9(6).
008700P    05  C-TIME              PIC 9(8).
008800P    05  NO-OF-TESTS         PIC 99.
008900P    05  C-OK                PIC 999.
009000P    05  C-ALL               PIC 999.
009100P    05  C-FAIL              PIC 999.
009200P    05  C-DELETED           PIC 999.
009300P    05  C-INSPECT           PIC 999.
009400P    05  C-NOTE              PIC X(13).
009500P    05  C-INDENT            PIC X.
009600P    05  C-ABORT             PIC X(8).
009700*
009800 FD  SQ-FS1
009900C    LABEL RECORD IS STANDARD
010000                .
010100 01  SQ-FS1R1-F-G-120 PIC X(120).
010200*
010300 WORKING-STORAGE SECTION.
010400*
010500***************************************************************
010600*                                                             *
010700*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
010800*                                                             *
010900***************************************************************
011000*
011100 01  SQ-FS1-STATUS.
011200   03  SQ-FS1-KEY-1   PIC X.
011300   03  SQ-FS1-KEY-2   PIC X.
011400*
011500 01  SQ-FS1-STATUS-COPY PIC XX.
011600*
011700 01  WRK-CS-09V00 PIC S9(9) USAGE COMP VALUE ZERO.
011800 01  RECORDS-IN-ERROR PIC S9(5) USAGE COMP VALUE ZERO.
011900 01  ERROR-FLAG PIC 9 VALUE ZERO.
012000 01  EOF-FLAG   PICTURE 9 VALUE ZERO.
012100*
012200***************************************************************
012300*                                                             *
012400*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
012500*                                                             *
012600***************************************************************
012700*
012800 01  REC-SKEL-SUB   PIC 99.
012900*
013000 01  FILE-RECORD-INFORMATION-REC.
013100     03 FILE-RECORD-INFO-SKELETON.
013200        05 FILLER                 PICTURE X(48)       VALUE
013300             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
013400        05 FILLER                 PICTURE X(46)       VALUE
013500             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
013600        05 FILLER                 PICTURE X(26)       VALUE
013700             ",LFIL=000000,ORG=  ,LBLR= ".
013800        05 FILLER                 PICTURE X(37)       VALUE
013900             ",RECKEY=                             ".
014000        05 FILLER                 PICTURE X(38)       VALUE
014100             ",ALTKEY1=                             ".
014200        05 FILLER                 PICTURE X(38)       VALUE
014300             ",ALTKEY2=                             ".
014400        05 FILLER                 PICTURE X(7)        VALUE SPACE.
014500     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
014600        05 FILE-RECORD-INFO-P1-120.
014700           07 FILLER              PIC X(5).
014800           07 XFILE-NAME          PIC X(6).
014900           07 FILLER              PIC X(8).
015000           07 XRECORD-NAME        PIC X(6).
015100           07 FILLER              PIC X(1).
015200           07 REELUNIT-NUMBER     PIC 9(1).
015300           07 FILLER              PIC X(7).
015400           07 XRECORD-NUMBER      PIC 9(6).
015500           07 FILLER              PIC X(6).
015600           07 UPDATE-NUMBER       PIC 9(2).
015700           07 FILLER              PIC X(5).
015800           07 ODO-NUMBER          PIC 9(4).
015900           07 FILLER              PIC X(5).
016000           07 XPROGRAM-NAME       PIC X(5).
016100           07 FILLER              PIC X(7).
016200           07 XRECORD-LENGTH      PIC 9(6).
016300           07 FILLER              PIC X(7).
016400           07 CHARS-OR-RECORDS    PIC X(2).
016500           07 FILLER              PIC X(1).
016600           07 XBLOCK-SIZE         PIC 9(4).
016700           07 FILLER              PIC X(6).
016800           07 RECORDS-IN-FILE     PIC 9(6).
016900           07 FILLER              PIC X(5).
017000           07 XFILE-ORGANIZATION  PIC X(2).
017100           07 FILLER              PIC X(6).
017200           07 XLABEL-TYPE         PIC X(1).
017300        05 FILE-RECORD-INFO-P121-240.
017400           07 FILLER              PIC X(8).
017500           07 XRECORD-KEY         PIC X(29).
017600           07 FILLER              PIC X(9).
017700           07 ALTERNATE-KEY1      PIC X(29).
017800           07 FILLER              PIC X(9).
017900           07 ALTERNATE-KEY2      PIC X(29).
018000           07 FILLER              PIC X(7).
018100*
018200 01  TEST-RESULTS.
018300     02 FILLER              PIC X      VALUE SPACE.
018400     02  PAR-NAME.
018500       03 FILLER              PIC X(14)  VALUE SPACE.
018600       03 PARDOT-X            PIC X      VALUE SPACE.
018700       03 DOTVALUE            PIC 99     VALUE ZERO.
018800     02 FILLER              PIC X      VALUE SPACE.
018900     02 FEATURE             PIC X(24)  VALUE SPACE.
019000     02 FILLER              PIC X      VALUE SPACE.
019100     02 P-OR-F              PIC X(5)   VALUE SPACE.
019200     02 FILLER              PIC X(9)   VALUE SPACE.
019300     02 RE-MARK             PIC X(61).
019400 01  TEST-COMPUTED.
019500   02 FILLER  PIC X(30)  VALUE SPACE.
019600   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
019700   02 COMPUTED-X.
019800     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
019900     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
020000     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
020100     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
020200     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
020300     03       CM-18V0 REDEFINES COMPUTED-A.
020400        04 COMPUTED-18V0                   PIC -9(18).
020500        04 FILLER                          PIC X.
020600     03 FILLER PIC X(50) VALUE SPACE.
020700 01  TEST-CORRECT.
020800     02 FILLER PIC X(30) VALUE SPACE.
020900     02 FILLER PIC X(17) VALUE "       CORRECT =".
021000     02 CORRECT-X.
021100     03 CORRECT-A                  PIC X(20) VALUE SPACE.
021200     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
021300     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
021400     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
021500     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
021600     03      CR-18V0 REDEFINES CORRECT-A.
021700         04 CORRECT-18V0                     PIC -9(18).
021800         04 FILLER                           PIC X.
021900     03 FILLER PIC X(2) VALUE SPACE.
022000     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
022100*
022200 01  CCVS-C-1.
022300     02 FILLER  PIC IS X        VALUE  SPACE.
022400     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
022500     02 FILLER  PIC IS X        VALUE  SPACE.
022600     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
022700     02 FILLER  PIC IS X        VALUE  SPACE.
022800     02 FILLER  PIC IS X(5)     VALUE "PASS ".
022900     02 FILLER  PIC IS X(9)     VALUE  SPACE.
023000     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
023100 01  CCVS-C-2.
023200     02 FILLER  PIC X(19)  VALUE  SPACE.
023300     02 FILLER  PIC X(6)   VALUE "TESTED".
023400     02 FILLER  PIC X(19)  VALUE  SPACE.
023500     02 FILLER  PIC X(4)   VALUE "FAIL".
023600     02 FILLER  PIC X(72)  VALUE  SPACE.
023700*
023800 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
023900 01  REC-CT            PIC 99       VALUE ZERO.
024000 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
024100 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
024200 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
024300 01  PASS-COUNTER      PIC 999      VALUE ZERO.
024400 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
024500 01  ERROR-HOLD        PIC 999      VALUE ZERO.
024600 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
024700 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
024800 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
024900 01  CCVS-H-1.
025000     02  FILLER          PIC X(39)    VALUE SPACES.
025100     02  FILLER          PIC X(42)    VALUE
025200     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
025300     02  FILLER          PIC X(39)    VALUE SPACES.
025400 01  CCVS-H-2A.
025500   02  FILLER            PIC X(40)  VALUE SPACE.
025600   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
025700   02  FILLER            PIC XXXX   VALUE
025800     "4.2 ".
025900   02  FILLER            PIC X(28)  VALUE
026000            " COPY - NOT FOR DISTRIBUTION".
026100   02  FILLER            PIC X(41)  VALUE SPACE.
026200*
026300 01  CCVS-H-2B.
026400   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
026500   02  TEST-ID           PIC X(9).
026600   02  FILLER            PIC X(4)   VALUE " IN ".
026700   02  FILLER            PIC X(12)  VALUE
026800     " HIGH       ".
026900   02  FILLER            PIC X(22)  VALUE
027000            " LEVEL VALIDATION FOR ".
027100   02  FILLER            PIC X(58)  VALUE
027200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
027300 01  CCVS-H-3.
027400     02  FILLER          PIC X(34)  VALUE
027500            " FOR OFFICIAL USE ONLY    ".
027600     02  FILLER          PIC X(58)  VALUE
027700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
027800     02  FILLER          PIC X(28)  VALUE
027900            "  COPYRIGHT   1985,1986 ".
028000 01  CCVS-E-1.
028100     02 FILLER           PIC X(52)  VALUE SPACE.
028200     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
028300     02 ID-AGAIN         PIC X(9).
028400     02 FILLER           PIC X(45)  VALUE SPACES.
028500 01  CCVS-E-2.
028600     02  FILLER          PIC X(31)  VALUE SPACE.
028700     02  FILLER          PIC X(21)  VALUE SPACE.
028800     02  CCVS-E-2-2.
028900         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
029000         03 FILLER         PIC X      VALUE SPACE.
029100         03 ENDER-DESC     PIC X(44)  VALUE
029200            "ERRORS ENCOUNTERED".
029300 01  CCVS-E-3.
029400     02  FILLER          PIC X(22)  VALUE
029500            " FOR OFFICIAL USE ONLY".
029600     02  FILLER          PIC X(12)  VALUE SPACE.
029700     02  FILLER          PIC X(58)  VALUE
029800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
029900     02  FILLER          PIC X(8)   VALUE SPACE.
030000     02  FILLER          PIC X(20)  VALUE
030100             " COPYRIGHT 1985,1986".
030200 01  CCVS-E-4.
030300     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
030400     02 FILLER           PIC X(4)   VALUE " OF ".
030500     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
030600     02 FILLER           PIC X(40)  VALUE
030700      "  TESTS WERE EXECUTED SUCCESSFULLY".
030800 01  XXINFO.
030900     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
031000     02 INFO-TEXT.
031100       04 FILLER             PIC X(8)   VALUE SPACE.
031200       04 XXCOMPUTED         PIC X(20).
031300       04 FILLER             PIC X(5)   VALUE SPACE.
031400       04 XXCORRECT          PIC X(20).
031500     02 INF-ANSI-REFERENCE PIC X(48).
031600 01  HYPHEN-LINE.
031700     02 FILLER  PIC IS X VALUE IS SPACE.
031800     02 FILLER  PIC IS X(65)    VALUE IS "************************
031900-    "*****************************************".
032000     02 FILLER  PIC IS X(54)    VALUE IS "************************
032100-    "******************************".
032200 01  CCVS-PGM-ID  PIC X(9)   VALUE
032300     "SQ113A".
032400*
032500*
032600 PROCEDURE DIVISION.
032700*
032800 CCVS1 SECTION.
032900 OPEN-FILES.
033000P    OPEN    I-O RAW-DATA.
033100P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
033200P    READ    RAW-DATA INVALID KEY GO TO END-E-1.
033300P    MOVE   "ABORTED "   TO C-ABORT.
033400P    ADD     1           TO C-NO-OF-TESTS.
033500P    ACCEPT  C-DATE      FROM DATE.
033600P    ACCEPT  C-TIME      FROM TIME.
033700P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
033800PEND-E-1.
033900P    CLOSE   RAW-DATA.
034000     OPEN    OUTPUT PRINT-FILE.
034100     MOVE    CCVS-PGM-ID TO TEST-ID.
034200     MOVE    CCVS-PGM-ID TO ID-AGAIN.
034300     MOVE    SPACE TO TEST-RESULTS.
034400     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
034500     MOVE    ZERO TO REC-SKEL-SUB.
034600     PERFORM CCVS-INIT-FILE 10 TIMES.
034700     GO TO CCVS1-EXIT.
034800*
034900 CCVS-INIT-FILE.
035000     ADD     1 TO REC-SKL-SUB.
035100     MOVE    FILE-RECORD-INFO-SKELETON TO
035200                  FILE-RECORD-INFO (REC-SKL-SUB).
035300*
035400 CLOSE-FILES.
035500     PERFORM END-ROUTINE THRU END-ROUTINE-13.
035600     CLOSE   PRINT-FILE.
035700P    OPEN    I-O RAW-DATA.
035800P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
035900P    READ    RAW-DATA INVALID KEY GO TO END-E-2.
036000P    MOVE   "OK.     " TO C-ABORT.
036100P    MOVE    PASS-COUNTER  TO C-OK.
036200P    MOVE    ERROR-HOLD    TO C-ALL.
036300P    MOVE    ERROR-COUNTER TO C-FAIL.
036400P    MOVE    DELETE-CNT    TO C-DELETED.
036500P    MOVE    INSPECT-COUNTER TO C-INSPECT.
036600P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
036700PEND-E-2.
036800P    CLOSE   RAW-DATA.
036900 TERMINATE-CCVS.
037000S    EXIT    PROGRAM.
037100     STOP    RUN.
037200*
037300 INSPT.
037400     MOVE   "INSPT" TO P-OR-F.
037500     ADD     1 TO INSPECT-COUNTER.
037600     PERFORM PRINT-DETAIL.
037700*
037800 PASS.
037900     MOVE   "PASS " TO P-OR-F.
038000     ADD     1 TO PASS-COUNTER.
038100     PERFORM PRINT-DETAIL.
038200*
038300 FAIL.
038400     MOVE   "FAIL*" TO P-OR-F.
038500     ADD     1 TO ERROR-COUNTER.
038600     PERFORM PRINT-DETAIL.
038700*
038800 DE-LETE.
038900     MOVE   "****TEST DELETED****" TO RE-MARK.
039000     MOVE   "*****" TO P-OR-F.
039100     ADD     1 TO DELETE-COUNTER.
039200     PERFORM PRINT-DETAIL.
039300*
039400 PRINT-DETAIL.
039500     IF REC-CT NOT EQUAL TO ZERO
039600         MOVE   "." TO PARDOT-X
039700         MOVE    REC-CT TO DOTVALUE.
039800     MOVE    TEST-RESULTS TO PRINT-REC.
039900     PERFORM WRITE-LINE.
040000     IF P-OR-F EQUAL TO "FAIL*"
040100         PERFORM WRITE-LINE
040200         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
040300     ELSE
040400         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
040500     MOVE    SPACE TO P-OR-F.
040600     MOVE    SPACE TO COMPUTED-X.
040700     MOVE    SPACE TO CORRECT-X.
040800     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
040900     MOVE    SPACE TO RE-MARK.
041000*
041100 HEAD-ROUTINE.
041200     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041300     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041400     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
041500     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
041600 COLUMN-NAMES-ROUTINE.
041700     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
041800     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
042000 END-ROUTINE.
042100     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
042200     PERFORM WRITE-LINE 5 TIMES.
042300 END-RTN-EXIT.
042400     MOVE    CCVS-E-1 TO DUMMY-RECORD.
042500     PERFORM WRITE-LINE 2 TIMES.
042600*
042700 END-ROUTINE-1.
042800     ADD     ERROR-COUNTER   TO ERROR-HOLD
042900     ADD     INSPECT-COUNTER TO ERROR-HOLD.
043000     ADD     DELETE-COUNTER  TO ERROR-HOLD.
043100     ADD     PASS-COUNTER    TO ERROR-HOLD.
043200     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
043300     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
043400     MOVE    CCVS-E-4        TO CCVS-E-2-2.
043500     MOVE    CCVS-E-2        TO DUMMY-RECORD
043600     PERFORM WRITE-LINE.
043700     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
043800     IF ERROR-COUNTER IS EQUAL TO ZERO
043900         MOVE   "NO " TO ERROR-TOTAL
044000     ELSE
044100         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
044200     MOVE    CCVS-E-2 TO DUMMY-RECORD.
044300     PERFORM WRITE-LINE.
044400 END-ROUTINE-13.
044500     IF DELETE-COUNTER IS EQUAL TO ZERO
044600         MOVE   "NO " TO ERROR-TOTAL
044700     ELSE
044800         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
044900     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
045000     MOVE    CCVS-E-2 TO DUMMY-RECORD.
045100     PERFORM WRITE-LINE.
045200     IF INSPECT-COUNTER EQUAL TO ZERO
045300         MOVE   "NO " TO ERROR-TOTAL
045400     ELSE
045500         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
045600     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
045700     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
045800     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
045900*
046000 WRITE-LINE.
046100     ADD     1 TO RECORD-COUNT.
046200Y    IF RECORD-COUNT GREATER 50
046300Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
046400Y        MOVE  SPACE TO DUMMY-RECORD
046500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
046600Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
046700Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
046800Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
046900Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
047000Y        MOVE  ZERO TO RECORD-COUNT.
047100     PERFORM WRT-LN.
047200*
047300 WRT-LN.
047400     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
047500     MOVE    SPACE TO DUMMY-RECORD.
047600 BLANK-LINE-PRINT.
047700     PERFORM WRT-LN.
047800 FAIL-ROUTINE.
047900     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
048000     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
048100     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
048200     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
048300     MOVE    XXINFO TO DUMMY-RECORD.
048400     PERFORM WRITE-LINE 2 TIMES.
048500     MOVE    SPACES TO INF-ANSI-REFERENCE.
048600     GO TO   FAIL-ROUTINE-EX.
048700 FAIL-ROUTINE-WRITE.
048800     MOVE    TEST-COMPUTED  TO PRINT-REC
048900     PERFORM WRITE-LINE
049000     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
049100     MOVE    TEST-CORRECT   TO PRINT-REC
049200     PERFORM WRITE-LINE 2 TIMES.
049300     MOVE    SPACES         TO COR-ANSI-REFERENCE.
049400 FAIL-ROUTINE-EX.
049500     EXIT.
049600 BAIL-OUT.
049700     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
049800     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
049900 BAIL-OUT-WRITE.
050000     MOVE    CORRECT-A      TO XXCORRECT.
050100     MOVE    COMPUTED-A     TO XXCOMPUTED.
050200     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
050300     MOVE    XXINFO TO DUMMY-RECORD.
050400     PERFORM WRITE-LINE 2 TIMES.
050500     MOVE    SPACES TO INF-ANSI-REFERENCE.
050600 BAIL-OUT-EX.
050700     EXIT.
050800 CCVS1-EXIT.
050900     EXIT.
051000*
051100****************************************************************
051200*                                                              *
051300*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
051400*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
051500*                                                              *
051600****************************************************************
051700*
051800 SECT-SQ113-0001 SECTION.
051900 SEQ-INIT-WR-01.
052000     MOVE    "SQ-FS1" TO XFILE-NAME (1).
052100     MOVE    "R1-F-G" TO XRECORD-NAME (1).
052200     MOVE     CCVS-PGM-ID TO XPROGRAM-NAME (1).
052300     MOVE     000120 TO XRECORD-LENGTH (1).
052400     MOVE    "RC"    TO CHARS-OR-RECORDS (1).
052500     MOVE     0001   TO XBLOCK-SIZE (1).
052600     MOVE     000750 TO RECORDS-IN-FILE (1).
052700     MOVE    "SQ"    TO XFILE-ORGANIZATION (1).
052800     MOVE    "S"     TO XLABEL-TYPE (1).
052900     MOVE     ZERO   TO XRECORD-NUMBER (1).
053000     MOVE    "CREATE 750 RECORD FILE" TO FEATURE.
053100     MOVE    "SEQ-TEST-WR-01" TO PAR-NAME.
053200     MOVE    "**"    TO SQ-FS1-STATUS.
053300     MOVE    "00"    TO SQ-FS1-STATUS-COPY.
053400*
053500 SEQ-TEST-WR-01.
053600     OPEN OUTPUT SQ-FS1.
053700     IF SQ-FS1-STATUS NOT EQUAL TO "00"
053800         MOVE    SQ-FS1-STATUS TO SQ-FS1-STATUS-COPY
053900         MOVE   "00" TO SQ-FS1-STATUS.
054000*
054100 SEQ-TEST-WR-01-LOOP.
054200     ADD     1 TO XRECORD-NUMBER (1).
054300     MOVE    FILE-RECORD-INFO-P1-120 (1)  TO SQ-FS1R1-F-G-120.
054400     WRITE   SQ-FS1R1-F-G-120.
054500     IF SQ-FS1-STATUS NOT EQUAL TO "00"
054600         MOVE    SQ-FS1-STATUS TO SQ-FS1-STATUS-COPY
054700         MOVE   "00" TO SQ-FS1-STATUS.
054800     IF XRECORD-NUMBER (1) LESS THAN 750
054900         GO TO   SEQ-TEST-WR-01-LOOP.
055000*
055100     CLOSE   SQ-FS1.
055200     IF SQ-FS1-STATUS NOT EQUAL TO "00"
055300         MOVE    SQ-FS1-STATUS TO SQ-FS1-STATUS-COPY
055400         MOVE   "00" TO SQ-FS1-STATUS.
055500*
055600     IF SQ-FS1-STATUS-COPY EQUAL "00"
055700         PERFORM PASS
055800     ELSE
055900         MOVE    SQ-FS1-STATUS-COPY TO COMPUTED-A
056000         MOVE   "00" TO CORRECT-A
056100         MOVE   "ERROR DURING FILE CREATION" TO RE-MARK
056200         PERFORM FAIL.
056300*
056400*    A SEQUENTIAL TAPE FILE HAS BEEN CREATED.  IT CONTAINS 750
056500*    RECORDS, EACH 120 CHARACTERS LONG.  THE FILE WILL NOW BE
056600*    READ AND THE RECORDS VERIFIED.
056700*
056800 SEQ-INIT-GF-02.
056900     MOVE   "SEQ-TEST-GF-02" TO PAR-NAME.
057000     MOVE   "VERIFY NEW FILE" TO FEATURE.
057100     MOVE   "**"    TO SQ-FS1-STATUS.
057200     MOVE    1      TO REC-CT.
057300     GO TO  SEQ-TEST-GF-02-01.
057400 SEQ-DELETE-02-01.
057500     PERFORM DE-LETE.
057600     GO TO   SEQ-DELETE-02-02.
057700 SEQ-TEST-GF-02-01.
057800     OPEN INPUT SQ-FS1.
057900     IF SQ-FS1-STATUS NOT EQUAL TO "00"
058000         MOVE    SQ-FS1-STATUS TO COMPUTED-A
058100         MOVE   "00" TO CORRECT-A
058200         MOVE   "FAILURE FILE STATUS FROM OPEN" TO RE-MARK
058300         PERFORM FAIL
058400         GO TO   SEQ-DELETE-02-02
058500     ELSE
058600         PERFORM PASS.
058700*
058800 SEQ-INIT-GF-02-02.
058900     MOVE    FILE-RECORD-INFO-P1-120 (1)
059000                TO FILE-RECORD-INFO-P1-120 (2).
059100     MOVE    ZERO   TO XRECORD-NUMBER (2).
059200     MOVE   "00"    TO SQ-FS1-STATUS-COPY.
059300     GO TO   SEQ-TEST-GF-02-02.
059400 SEQ-DELETE-02-02.
059500     ADD     1 TO REC-CT.
059600     PERFORM DE-LETE.
059700     ADD     1 TO REC-CT.
059800     PERFORM DE-LETE.
059900     ADD     1 TO REC-CT.
060000     PERFORM DE-LETE.
060100     GO TO   SEQ-DELETE-GF-02-05.
060200 SEQ-TEST-GF-02-02.
060300     ADD     1 TO REC-CT.
060400 SEQ-TEST-GF-02-02-LOOP.
060500     READ SQ-FS1
060600          AT END GO TO SEQ-TEST-GF-02-02-1.
060700     IF SQ-FS1-STATUS NOT EQUAL TO "00"
060800         MOVE    SQ-FS1-STATUS TO SQ-FS1-STATUS-COPY
060900         MOVE   "00" TO SQ-FS1-STATUS.
061000     MOVE   SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
061100     ADD    1 TO XRECORD-NUMBER (2).
061200     IF XRECORD-NUMBER (2) GREATER THAN 750
061300         GO TO   SEQ-TEST-GF-02-02-1.
061400     IF FILE-RECORD-INFO-P1-120 (1)
061500                NOT EQUAL TO FILE-RECORD-INFO-P1-120 (2)
061600         ADD     1 TO RECORDS-IN-ERROR.
061700     GO TO   SEQ-TEST-GF-02-02-LOOP.
061800*
061900 SEQ-TEST-GF-02-02-1.
062000     IF XRECORD-NUMBER (2) = 750
062100         PERFORM PASS
062200     ELSE
062300         MOVE   "RECORD COUNTING ERROR" TO RE-MARK
062400         MOVE    XRECORD-NUMBER (2) TO COMPUTED-18V0
062500         MOVE    750 TO CORRECT-18V0
062600         MOVE   "VII-44" TO ANSI-REFERENCE
062700         PERFORM FAIL.
062800*
062900     ADD     1 TO REC-CT.
063000     IF SQ-FS1-STATUS-COPY NOT EQUAL "00"
063100         MOVE   "AT LEAST ONE UNSUCCESSFUL READ" TO RE-MARK
063200         MOVE    SQ-FS1-STATUS-COPY TO COMPUTED-A
063300         MOVE   "00" TO CORRECT-A
063400         PERFORM FAIL
063500     ELSE
063600         PERFORM PASS.
063700*
063800     ADD     1 TO REC-CT.
063900     IF RECORDS-IN-ERROR EQUAL TO ZERO
064000         PERFORM PASS
064100     ELSE
064200         MOVE   "RECORD CONTENT ERRORS" TO RE-MARK
064300         MOVE    ZERO TO CORRECT-18V0
064400         MOVE    RECORDS-IN-ERROR TO COMPUTED-18V0
064500         MOVE   "VII-44; 4.4.2" TO ANSI-REFERENCE
064600         PERFORM FAIL.
064700*
064800 SEQ-INIT-GF-02-05.
064900     MOVE   "**" TO SQ-FS1-STATUS.
065000     GO TO   SEQ-TEST-GF-02-05.
065100 SEQ-DELETE-GF-02-05.
065200     ADD     1 TO REC-CT.
065300     PERFORM DE-LETE.
065400     GO TO   SEQ-TEST-GF-02-END.
065500 SEQ-TEST-GF-02-05.
065600     ADD     1 TO REC-CT.
065700     CLOSE   SQ-FS1.
065800     IF SQ-FS1-STATUS EQUAL "00"
065900         PERFORM PASS
066000     ELSE
066100         MOVE   "UNEXPECTED FILE STATUS ON CLOSE" TO RE-MARK
066200         MOVE   "00" TO CORRECT-A
066300         MOVE    SQ-FS1-STATUS TO COMPUTED-A
066400         MOVE   "VII-3, VII-44" TO ANSI-REFERENCE
066500         PERFORM FAIL.
066600*
066700 SEQ-TEST-GF-02-END.
066800*
066900*
067000 SEQ-INIT-GF-03.
067100     MOVE   "SEQ-TEST-GF-03" TO PAR-NAME.
067200     MOVE   "OPEN FILE FOR INPUT" TO FEATURE.
067300     MOVE   "**"    TO SQ-FS1-STATUS.
067400     MOVE    1      TO REC-CT.
067500     GO TO  SEQ-TEST-GF-03.
067600 SEQ-DELETE-03.
067700     PERFORM DE-LETE.
067800     GO TO   SEQ-TEST-03-END.
067900 SEQ-TEST-GF-03.
068000     OPEN    INPUT SQ-FS1.
068100     IF SQ-FS1-STATUS NOT EQUAL TO "00"
068200         MOVE    SQ-FS1-STATUS TO COMPUTED-A
068300         MOVE   "00" TO CORRECT-A
068400         MOVE   "FAILURE FILE STATUS FROM OPEN" TO RE-MARK
068500         PERFORM FAIL
068600     ELSE
068700         PERFORM PASS.
068800 SEQ-TEST-03-END.
068900*
069000*
069100*    THIS SERIES OF TESTS CHECKS FOUR LEVEL 1 VARIANTS OF
069200*    THE READ STATEMENT
069300*
069400 SEQ-INIT-GF-04.
069500     MOVE    ZERO TO XRECORD-NUMBER (2).
069600     MOVE    ZERO TO RECORDS-IN-ERROR.
069700     MOVE   "READ...RECORD AT END"     TO FEATURE.
069800     MOVE   "SEQ-TEST-GF-O4" TO PAR-NAME.
069900     MOVE    ZERO TO ERROR-FLAG.
070000     MOVE   "**"  TO SQ-FS1-STATUS-COPY.
070100     MOVE    1 TO REC-CT.
070200     GO TO  SEQ-TEST-GF-04.
070300 SEQ-DELETE-04.
070400     PERFORM DE-LETE.
070500     ADD     1 TO REC-CT.
070600     PERFORM DE-LETE.
070700     ADD     1 TO REC-CT.
070800     PERFORM DE-LETE.
070900     GO TO   SEQ-TEST-04-END.
071000 SEQ-TEST-GF-04.
071100     READ SQ-FS1 RECORD AT END
071200         MOVE    1 TO EOF-FLAG
071300         GO TO   SEQ-TEST-GF-04-01.
071400     IF SQ-FS1-STATUS NOT EQUAL TO "00"
071500         MOVE    SQ-FS1-STATUS TO SQ-FS1-STATUS-COPY
071600         MOVE   "00" TO SQ-FS1-STATUS.
071700     MOVE   SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
071800     ADD    1 TO XRECORD-NUMBER (2)
071900     IF XRECORD-NUMBER (2) NOT EQUAL TO XRECORD-NUMBER (1)
072000         ADD     1 TO RECORDS-IN-ERROR
072100         MOVE    1 TO ERROR-FLAG.
072200     IF XRECORD-NUMBER (2) LESS THAN 200
072300         GO TO   SEQ-TEST-GF-04.
072400*
072500 SEQ-TEST-GF-04-01.
072600     IF EOF-FLAG NOT EQUAL TO ZERO
072700         MOVE   "PREMATURE END OF FILE" TO RE-MARK
072800         MOVE    750 TO CORRECT-18V0
072900         MOVE    XRECORD-NUMBER (2) TO COMPUTED-18V0
073000         MOVE   "VII-44" TO ANSI-REFERENCE
073100         PERFORM FAIL
073200     ELSE
073300         PERFORM PASS.
073400*
073500 SEQ-TEST-GF-04-02.
073600     ADD     1 TO REC-CT.
073700     IF SQ-FS1-STATUS-COPY = "**"
073800         PERFORM PASS
073900     ELSE
074000         MOVE    SQ-FS1-STATUS-COPY TO COMPUTED-A
074100         MOVE   "**" TO CORRECT-A
074200         MOVE   "UNEXPECTED FILE STATUS FOR AT LEAST ONE READ"
074300                   TO RE-MARK
074400         MOVE   "VII-44" TO ANSI-REFERENCE
074500         PERFORM FAIL.
074600*
074700 SEQ-TEST-GF-04-03.
074800     ADD     1 TO REC-CT.
074900     IF ERROR-FLAG EQUAL TO ZERO
075000         PERFORM PASS
075100     ELSE
075200         MOVE    ERROR-FLAG TO COMPUTED-18V0
075300         MOVE    ZERO TO CORRECT-18V0
075400         MOVE   "ERROR IN ONE OR MORE RECORDS" TO RE-MARK
075500         MOVE   "VII-44" TO ANSI-REFERENCE
075600         PERFORM FAIL.
075700 SEQ-TEST-04-END.
075800*
075900*
076000 SEQ-INIT-GF-O5.
076100     IF EOF-FLAG EQUAL TO 1
076200         GO TO SEQ-DELETE-05.
076300     MOVE    ZERO TO ERROR-FLAG.
076400     MOVE   "READ...AT END..." TO FEATURE
076500     MOVE   "SEQ-TEST-GF-O5" TO PAR-NAME.
076600     MOVE    ZERO TO RECORDS-IN-ERROR.
076700     MOVE   "**"  TO SQ-FS1-STATUS-COPY.
076800     MOVE    1 TO REC-CT.
076900     GO TO  SEQ-TEST-GF-05.
077000 SEQ-DELETE-05.
077100     PERFORM DE-LETE.
077200     ADD     1 TO REC-CT.
077300     PERFORM DE-LETE.
077400     ADD     1 TO REC-CT.
077500     PERFORM DE-LETE.
077600     GO TO   SEQ-TEST-05-END.
077700 SEQ-TEST-GF-05.
077800     READ SQ-FS1 AT END
077900         MOVE    1 TO EOF-FLAG
078000         GO TO   SEQ-TEST-GF-05-01.
078100     IF SQ-FS1-STATUS NOT EQUAL TO "00"
078200         MOVE    SQ-FS1-STATUS TO SQ-FS1-STATUS-COPY
078300         MOVE   "00" TO SQ-FS1-STATUS.
078400     MOVE   SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
078500     ADD    1 TO XRECORD-NUMBER (2)
078600     IF XRECORD-NUMBER (2) NOT EQUAL TO XRECORD-NUMBER (1)
078700         ADD     1 TO RECORDS-IN-ERROR
078800         MOVE    1 TO ERROR-FLAG.
078900     IF XRECORD-NUMBER (2) LESS THAN 400
079000         GO TO   SEQ-TEST-GF-05.
079100*
079200 SEQ-TEST-GF-05-01.
079300     IF EOF-FLAG NOT EQUAL TO ZERO
079400         MOVE   "PREMATURE END OF FILE" TO RE-MARK
079500         MOVE    750 TO CORRECT-18V0
079600         MOVE    XRECORD-NUMBER (2) TO COMPUTED-18V0
079700         MOVE   "VII-44" TO ANSI-REFERENCE
079800         PERFORM FAIL
079900     ELSE
080000         PERFORM PASS.
080100*
080200 SEQ-TEST-GF-05-02.
080300     ADD     1 TO REC-CT.
080400     IF SQ-FS1-STATUS-COPY = "**"
080500         PERFORM PASS
080600     ELSE
080700         MOVE    SQ-FS1-STATUS-COPY TO COMPUTED-A
080800         MOVE   "**" TO CORRECT-A
080900         MOVE   "UNEXPECTED FILE STATUS FOR AT LEAST ONE READ"
081000                   TO RE-MARK
081100         MOVE   "VII-44" TO ANSI-REFERENCE
081200         PERFORM FAIL.
081300*
081400 SEQ-TEST-GF-05-03.
081500     ADD     1 TO REC-CT.
081600     IF ERROR-FLAG EQUAL TO ZERO
081700         PERFORM PASS
081800     ELSE
081900         MOVE    ERROR-FLAG TO COMPUTED-18V0
082000         MOVE    ZERO TO CORRECT-18V0
082100         MOVE   "ERROR IN ONE OR MORE RECORDS" TO RE-MARK
082200         MOVE   "VII-44" TO ANSI-REFERENCE
082300         PERFORM FAIL.
082400 SEQ-TEST-05-END.
082500*
082600*
082700 SEQ-INIT-GF-O6.
082800     IF EOF-FLAG EQUAL TO 1
082900         GO TO SEQ-DELETE-06.
083000     MOVE    ZERO TO ERROR-FLAG.
083100     MOVE   "READ...RECORD END..." TO FEATURE
083200     MOVE   "SEQ-TEST-GF-O6" TO PAR-NAME.
083300     MOVE    ZERO TO RECORDS-IN-ERROR.
083400     MOVE   "**"  TO SQ-FS1-STATUS-COPY.
083500     MOVE    1 TO REC-CT.
083600     GO TO  SEQ-TEST-GF-06.
083700 SEQ-DELETE-06.
083800     PERFORM DE-LETE.
083900     ADD     1 TO REC-CT.
084000     PERFORM DE-LETE.
084100     ADD     1 TO REC-CT.
084200     PERFORM DE-LETE.
084300     GO TO   SEQ-TEST-06-END.
084400 SEQ-TEST-GF-06.
084500     READ SQ-FS1 RECORD END
084600         MOVE    1 TO EOF-FLAG
084700         GO TO   SEQ-TEST-GF-06-01.
084800     IF SQ-FS1-STATUS NOT EQUAL TO "00"
084900         MOVE    SQ-FS1-STATUS TO SQ-FS1-STATUS-COPY
085000         MOVE   "00" TO SQ-FS1-STATUS.
085100     MOVE   SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
085200     ADD    1 TO XRECORD-NUMBER (2)
085300     IF XRECORD-NUMBER (2) NOT EQUAL TO XRECORD-NUMBER (1)
085400         ADD     1 TO RECORDS-IN-ERROR
085500         MOVE    1 TO ERROR-FLAG.
085600     IF XRECORD-NUMBER (2) LESS THAN 600
085700         GO TO   SEQ-TEST-GF-06.
085800*
085900 SEQ-TEST-GF-06-01.
086000     IF EOF-FLAG NOT EQUAL TO ZERO
086100         MOVE   "PREMATURE END OF FILE" TO RE-MARK
086200         MOVE    750 TO CORRECT-18V0
086300         MOVE    XRECORD-NUMBER (2) TO COMPUTED-18V0
086400         MOVE   "VII-44" TO ANSI-REFERENCE
086500         PERFORM FAIL
086600     ELSE
086700         PERFORM PASS.
086800*
086900 SEQ-TEST-GF-06-02.
087000     ADD     1 TO REC-CT.
087100     IF SQ-FS1-STATUS-COPY = "**"
087200         PERFORM PASS
087300     ELSE
087400         MOVE    SQ-FS1-STATUS-COPY TO COMPUTED-A
087500         MOVE   "**" TO CORRECT-A
087600         MOVE   "UNEXPECTED FILE STATUS FOR AT LEAST ONE READ"
087700                   TO RE-MARK
087800         MOVE   "VII-44" TO ANSI-REFERENCE
087900         PERFORM FAIL.
088000*
088100 SEQ-TEST-GF-06-03.
088200     ADD     1 TO REC-CT.
088300     IF ERROR-FLAG EQUAL TO ZERO
088400         PERFORM PASS
088500     ELSE
088600         MOVE    ERROR-FLAG TO COMPUTED-18V0
088700         MOVE    ZERO TO CORRECT-18V0
088800         MOVE   "ERROR IN ONE OR MORE RECORDS" TO RE-MARK
088900         MOVE   "VII-44" TO ANSI-REFERENCE
089000         PERFORM FAIL.
089100 SEQ-TEST-06-END.
089200*
089300*
089400 SEQ-INIT-GF-O7.
089500     IF EOF-FLAG EQUAL TO 1
089600         GO TO SEQ-DELETE-07.
089700     MOVE    ZERO TO ERROR-FLAG.
089800     MOVE   "READ... END..." TO FEATURE
089900     MOVE   "SEQ-TEST-GF-O7" TO PAR-NAME.
090000     MOVE    ZERO TO RECORDS-IN-ERROR.
090100     MOVE   "**"  TO SQ-FS1-STATUS-COPY.
090200     MOVE    1 TO REC-CT.
090300     GO TO  SEQ-TEST-GF-07.
090400 SEQ-DELETE-07.
090500     PERFORM DE-LETE.
090600     ADD     1 TO REC-CT.
090700     PERFORM DE-LETE.
090800     ADD     1 TO REC-CT.
090900     PERFORM DE-LETE.
091000     GO TO   SEQ-TEST-07-END.
091100 SEQ-TEST-GF-07.
091200     READ SQ-FS1 END
091300         MOVE    1 TO EOF-FLAG
091400         GO TO   SEQ-TEST-GF-07-01.
091500     IF SQ-FS1-STATUS NOT EQUAL TO "00"
091600         MOVE    SQ-FS1-STATUS TO SQ-FS1-STATUS-COPY
091700         MOVE   "00" TO SQ-FS1-STATUS.
091800     MOVE   SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
091900     ADD    1 TO XRECORD-NUMBER (2)
092000     IF XRECORD-NUMBER (2) NOT EQUAL TO XRECORD-NUMBER (1)
092100         ADD     1 TO RECORDS-IN-ERROR
092200         MOVE    1 TO ERROR-FLAG.
092300     IF XRECORD-NUMBER (2) LESS THAN 750
092400         GO TO   SEQ-TEST-GF-07.
092500*
092600 SEQ-TEST-GF-07-01.
092700     IF EOF-FLAG NOT EQUAL TO ZERO
092800         MOVE   "PREMATURE END OF FILE" TO RE-MARK
092900         MOVE    750 TO CORRECT-18V0
093000         MOVE    XRECORD-NUMBER (2) TO COMPUTED-18V0
093100         MOVE   "VII-44" TO ANSI-REFERENCE
093200         PERFORM FAIL
093300     ELSE
093400         PERFORM PASS.
093500*
093600 SEQ-TEST-GF-07-02.
093700     ADD     1 TO REC-CT.
093800     IF SQ-FS1-STATUS-COPY = "**"
093900         PERFORM PASS
094000     ELSE
094100         MOVE    SQ-FS1-STATUS-COPY TO COMPUTED-A
094200         MOVE   "**" TO CORRECT-A
094300         MOVE   "UNEXPECTED FILE STATUS FOR AT LEAST ONE READ"
094400                   TO RE-MARK
094500         MOVE   "VII-44" TO ANSI-REFERENCE
094600         PERFORM FAIL.
094700*
094800 SEQ-TEST-GF-07-03.
094900     ADD     1 TO REC-CT.
095000     IF ERROR-FLAG EQUAL TO ZERO
095100         PERFORM PASS
095200     ELSE
095300         MOVE    ERROR-FLAG TO COMPUTED-18V0
095400         MOVE    ZERO TO CORRECT-18V0
095500         MOVE   "ERROR IN ONE OR MORE RECORDS" TO RE-MARK
095600         MOVE   "VII-44" TO ANSI-REFERENCE
095700         PERFORM FAIL.
095800 SEQ-TEST-07-END.
095900*
096000*
096100 SEQ-INIT-GF-O8.
096200     IF EOF-FLAG EQUAL TO 1
096300         GO TO SEQ-DELETE-08.
096400     MOVE   "READ... END... AT EOF" TO FEATURE
096500     MOVE   "SEQ-TEST-GF-O8" TO PAR-NAME.
096600     MOVE   "**"  TO SQ-FS1-STATUS.
096700     MOVE    1 TO REC-CT.
096800     GO TO  SEQ-TEST-GF-08.
096900 SEQ-DELETE-08.
097000     PERFORM DE-LETE.
097100     GO TO   SEQ-TEST-08-END.
097200 SEQ-TEST-GF-08.
097300     READ SQ-FS1 END
097400         MOVE    1 TO EOF-FLAG.
097500     IF SQ-FS1-STATUS NOT EQUAL TO "10"
097600         MOVE    SQ-FS1-STATUS TO COMPUTED-A
097700         MOVE   "00" TO CORRECT-A
097800         MOVE   "EXPECTED EOF STATUS CODE NOT RETURNED"
097900                    TO RE-MARK
098000         MOVE   "VII-3, VII-44" TO ANSI-REFERENCE
098100         PERFORM FAIL
098200     ELSE
098300         PERFORM PASS.
098400*
098500 SEQ-TEST-GF-08-02.
098600     ADD     1 TO REC-CT.
098700     IF EOF-FLAG NOT EQUAL TO 1
098800         MOVE    EOF-FLAG TO COMPUTED-18V0
098900         MOVE    1 TO CORRECT-18V0
099000         MOVE   "EOF NOT FOUND AFTER 750 RECORDS" TO RE-MARK
099100         PERFORM FAIL
099200     ELSE
099300         PERFORM PASS.
099400 SEQ-TEST-08-END.
099500*
099600*
099700 SEQ-INIT-GF-O9.
099800     MOVE   "CLOSE FILE " TO FEATURE
099900     MOVE   "SEQ-TEST-GF-O9" TO PAR-NAME.
100000     MOVE   "**"  TO SQ-FS1-STATUS.
100100     MOVE    1 TO REC-CT.
100200     GO TO  SEQ-TEST-GF-09.
100300 SEQ-DELETE-09.
100400     PERFORM DE-LETE.
100500     GO TO   SEQ-TEST-09-END.
100600 SEQ-TEST-GF-09.
100700     CLOSE SQ-FS1.
100800     IF SQ-FS1-STATUS NOT EQUAL TO "00"
100900         MOVE    SQ-FS1-STATUS TO COMPUTED-A
101000         MOVE   "00" TO CORRECT-A
101100         MOVE   "UNEXPECTED FILE STATUS FROM CLOSE" TO RE-MARK
101200         PERFORM FAIL
101300     ELSE
101400         PERFORM PASS.
101500 SEQ-TEST-09-END.
101600*
101700*
101800 TERMINATE-ROUTINE.
101900     EXIT.
102000 CCVS-EXIT SECTION.
102100 CCVS-999999.
102200     GO TO CLOSE-FILES.
