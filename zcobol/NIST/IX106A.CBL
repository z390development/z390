000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IX106A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300* THE PURPOSE OF THIS PROGRAM IS TO TEST THE ABILITY TO
001400* USE THE THREE DIFFERENT TYPES OF FILES (SEQUENTIAL ,
001500* INDEXED , AND RELATIVE) IN ONE PROGRAM . THE PROGRAM
001600* IS BROKEN INTO FIVE SECTIONS . THE FIRST SECTION TESTS
001700* THE ABILITY TO CREATE A RELATIVE FILE RANDOMLY . THE
001800* SECOND SECTION TESTS THE ABILITY TO USE ALL THREE FILE
001900* TYPES , READING IN THE RELATIVE FILE AND WRITING OUT THE
002000* SEQUENTIAL AND INDEXED FILES . THE THIRD SECTION FURTHER
002100* TESTS THE ABILITY TO USE THE THREE FILE TYPES . THE FOURTH
002200* SECTION TESTS THE ABILITY TO DELETE RECORDS FROM THE
002300* DIFFERENT FILE TYPES . THE FIFTH SECTION TESTS THE ABILITY
002400* TO REWRITE RECORDS TO EACH OF THE FILE TYPES .
002500*
002600* X-CARDS WHICH MUST BE RELACED WITH IMPLEMENTORS NAMES' IN
002700* THIS PROGRAM ARE :
002800*
002900*        X-14 IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
003000*             SEQUENTIAL FILE .
003100*        X-21 IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
003200*             RELATIVE FILE-1 , FILE-2 .
003300*        X-24 IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
003400*             INDEXED FILE .
003500*        X-44 SYSTEM-NAME IN ASSIGN CLAUSE FOR
003600*        INDEXED FILE .
003700*        X-55 SYSTEM PRINTER .
003800*        X-62   FOR RAW-DATA
003900*        X-82 SOURCE-COMPUTER .
004000*        X-83 OBJECT-COMPUTER .
004100*    C   X-84 PRINTE-FILE LABELS
004200****************************************************************
004300 ENVIRONMENT DIVISION.
004400 CONFIGURATION SECTION.
004500 SOURCE-COMPUTER.
004600     XXXXX082.
004700 OBJECT-COMPUTER.
004800     XXXXX083.
004900 INPUT-OUTPUT SECTION.
005000 FILE-CONTROL.
005100P    SELECT RAW-DATA   ASSIGN TO
005200P    XXXXX062
005300P           ORGANIZATION IS INDEXED
005400P           ACCESS MODE IS RANDOM
005500P           RECORD KEY IS RAW-DATA-KEY.
005600     SELECT PRINT-FILE ASSIGN TO
005700     XXXXX055.
005800     SELECT  RL-FR1
005900     ASSIGN TO
006000     XXXXX021
006100        ACCESS MODE IS RANDOM
006200        RELATIVE KEY IS RL-KEY
006300        ORGANIZATION IS RELATIVE
006400        FILE STATUS IS FR1-STATUS.
006500     SELECT  IX-FS1
006600     ASSIGN TO
006700     XXXXX024
006800J    XXXXX044
006900        ACCESS MODE IS RANDOM
007000        ORGANIZATION IS INDEXED
007100        RECORD KEY IS IX-FS1-KEY-11-13
007200        FILE STATUS IS FS1-STATUS-IX.
007300     SELECT  SQ-FS1
007400     ASSIGN TO
007500     XXXXX014
007600        ACCESS MODE IS SEQUENTIAL
007700        ORGANIZATION IS SEQUENTIAL
007800        FILE STATUS IS FS1-STATUS-SQ.
007900 DATA DIVISION.
008000 FILE SECTION.
008100P
008200PFD  RAW-DATA.
008300P
008400P01  RAW-DATA-SATZ.
008500P    05  RAW-DATA-KEY        PIC X(6).
008600P    05  C-DATE              PIC 9(6).
008700P    05  C-TIME              PIC 9(8).
008800P    05  C-NO-OF-TESTS       PIC 99.
008900P    05  C-OK                PIC 999.
009000P    05  C-ALL               PIC 999.
009100P    05  C-FAIL              PIC 999.
009200P    05  C-DELETED           PIC 999.
009300P    05  C-INSPECT           PIC 999.
009400P    05  C-NOTE              PIC X(13).
009500P    05  C-INDENT            PIC X.
009600P    05  C-ABORT             PIC X(8).
009700 FD  PRINT-FILE.
009800 01  PRINT-REC PICTURE X(120).
009900 01  DUMMY-RECORD PICTURE X(120).
010000 FD  RL-FR1
010100C    LABEL RECORDS ARE STANDARD
010200C    DATA RECORD IS RL-FR1R1-F-G-241
010300     RECORD CONTAINS 241 CHARACTERS.
010400 01  RL-FR1R1-F-G-241.
010500     05 RL-FR1-REC-120           PICTURE X(120).
010600     05 RL-FR1-REC-121-241.
010700        10 FILLER                PICTURE X(8).
010800        10 RL-REC-KEY-AREA.
010900           15 RL-FR1-KEY.
011000              20 RL-FR1-KEY-1-10.
011100                 25 RL-FR1-KEY-1-5      PICTURE X(5).
011200                 25 RL-FR1-KEY-6-10     PICTURE X(5).
011300               20 RL-FR1-KEY-11-13      PICTURE 9(3).
011400           15 RL-REDF-RECKEY REDEFINES RL-FR1-KEY.
011500              20 R-RECKEY-1-7    PICTURE X(7).
011600              20 R-RECKEY-8-13   PICTURE X(6).
011700           15 FILLER             PICTURE X(16).
011800        10 FILLER                PICTURE X(9).
011900        10 RL-ALT-KEY1-AREA.
012000           15 RL-FR1-ALTKEY1.
012100              20 RL-FR1-ALTKEY1-1-10.
012200                 25 RL-FR1-ALTKEY1-1-5  PICTURE X(5).
012300                 25 RL-FR1-ALTKEY1-6-10 PICTURE X(5).
012400              20 RL-FR1-ALTKEY1-11-13   PICTURE X(3).
012500              20 RL-FR1-ALTKEY1-14-20   PICTURE X(7).
012600           15 RL-REDF-ALTKEY1 REDEFINES RL-FR1-ALTKEY1.
012700              20 R-ALTKEY1-1-6   PICTURE X(6).
012800              20 R-ALTKEY1-7-10  PICTURE X(4).
012900              20 R-ALTKEY1-11-20 PICTURE X(10).
013000           15 FILLER             PICTURE X(9).
013100        10 FILLER                PICTURE X(9).
013200        10 RL-ALT-KEY2-AREA.
013300           15 RL-FR1-ALTKEY2.
013400              20 RL-FR1-ALTKEY2-1-10.
013500                 25 RL-FR1-ALTKEY2-1-5  PICTURE X(5).
013600                 25 RL-FR1-ALTKEY2-6-10 PICTURE X(5).
013700              20 RL-FR1-ALTKEY2-11-13   PICTURE X(3).
013800              20 RL-FR1-ALTKEY2-14-20   PICTURE X(7).
013900           15 FILLER             PICTURE X(9).
014000        10 FILLER                PICTURE X(8).
014100 FD  IX-FS1
014200C    LABEL RECORDS ARE STANDARD
014300C    DATA RECORD IS IX-FS1R1-F-G-241
014400     RECORD CONTAINS 241 CHARACTERS.
014500 01  IX-FS1R1-F-G-241.
014600     05 IX-FS1-REC-120           PICTURE X(120).
014700     05 IX-FS1-REC-121-241.
014800        10 FILLER                PICTURE X(8).
014900        10 IX-REC-KEY-AREA.
015000           15 IX-FS1-KEY.
015100              20 IX-FS1-KEY-1-10.
015200                 25 IX-FS1-KEY-1-5      PICTURE X(5).
015300                 25 IX-FS1-KEY-6-10     PICTURE X(5).
015400              20 IX-FS1-KEY-11-13      PICTURE X(3).
015500           15 IX-REDF-RECKEY REDEFINES IX-FS1-KEY.
015600              20 I-RECKEY-1-7    PICTURE X(7).
015700              20 I-RECKEY-8-13   PICTURE X(6).
015800           15 FILLER             PICTURE X(16).
015900        10 FILLER                PICTURE X(9).
016000        10 IX-ALT-KEY1-AREA.
016100           15 IX-FS1-ALTKEY1.
016200              20 IX-FS1-ALTKEY1-1-10.
016300                 25 IX-FS1-ALTKEY1-1-5  PICTURE X(5).
016400                 25 IX-FS1-ALTKEY1-6-10 PICTURE X(5).
016500              20 IX-FS1-ALTKEY1-11-13   PICTURE X(3).
016600              20 IX-FS1-ALTKEY1-14-20   PICTURE X(7).
016700           15 IX-REDF-ALTKEY1 REDEFINES IX-FS1-ALTKEY1.
016800              20 I-ALTKEY1-1-6   PICTURE X(6).
016900              20 I-ALTKEY1-7-10  PICTURE X(4).
017000              20 I-ALTKEY1-11-20 PICTURE X(10).
017100           15 FILLER             PICTURE X(9).
017200        10 FILLER                PICTURE X(9).
017300        10 IX-ALT-KEY2-AREA.
017400           15 IX-FS1-ALTKEY2.
017500              20 IX-FS1-ALTKEY2-1-10.
017600                 25 IX-FR1-ALTKEY2-1-5  PICTURE X(5).
017700                 25 IX-FR1-ALTKEY2-6-10 PICTURE X(5).
017800              20 IX-FS1-ALTKEY2-11-13   PICTURE X(3).
017900              20 IX-FS1-ALTKEY2-14-20   PICTURE X(7).
018000           15 FILLER             PICTURE X(9).
018100        10 FILLER                PICTURE X(8).
018200 FD  SQ-FS1
018300C    LABEL RECORDS ARE STANDARD
018400C    DATA RECORD IS SQ-FS1R1-F-G-241
018500     RECORD CONTAINS 241 CHARACTERS.
018600 01  SQ-FS1R1-F-G-241.
018700     05 SQ-FS1-REC-120           PICTURE X(120).
018800     05 SQ-FS1-REC-121-241.
018900        10 FILLER                PICTURE X(8).
019000        10 SQ-REC-KEY-AREA.
019100           15 SQ-FS1-KEY.
019200              20 SQ-FS1-KEY-1-10.
019300                 25 SQ-FS1-KEY-1-5      PICTURE X(5).
019400                 25 SQ-FS1-KEY-6-10     PICTURE X(5).
019500               20 SQ-FS1-KEY-11-13      PICTURE 9(3).
019600           15 SQ-REDF-RECKEY REDEFINES SQ-FS1-KEY.
019700              20 S-RECKEY-1-7    PICTURE X(7).
019800              20 S-RECKEY-8-13   PICTURE X(6).
019900           15 FILLER             PICTURE X(16).
020000        10 FILLER                PICTURE X(9).
020100        10 SQ-ALT-KEY1-AREA.
020200           15 SQ-FS1-ALTKEY1.
020300              20 SQ-FS1-ALTKEY1-1-10.
020400                 25 SQ-FS1-ALTKEY1-1-5  PICTURE X(5).
020500                 25 SQ-FS1-ALTKEY1-6-10 PICTURE X(5).
020600              20 SQ-FS1-ALTKEY1-11-13   PICTURE X(3).
020700              20 SQ-FS1-ALTKEY1-14-20   PICTURE X(7).
020800           15 SQ-REDF-ALTKEY1 REDEFINES SQ-FS1-ALTKEY1.
020900              20 S-ALTKEY1-1-6   PICTURE X(6).
021000              20 S-ALTKEY1-7-10  PICTURE X(4).
021100              20 S-ALTKEY1-11-20 PICTURE X(10).
021200           15 FILLER             PICTURE X(9).
021300        10 FILLER                PICTURE X(9).
021400        10 SQ-ALT-KEY2-AREA.
021500           15 SQ-FS1-ALTKEY2.
021600              20 SQ-FS1-ALTKEY2-1-10.
021700                 25 SQ-FS1-ALTKEY2-1-5  PICTURE X(5).
021800                 25 SQ-FS1-ALTKEY2-6-10 PICTURE X(5).
021900              20 SQ-FS1-ALTKEY2-11-13   PICTURE X(3).
022000              20 SQ-FS1-ALTKEY2-14-20   PICTURE X(7).
022100           15 FILLER             PICTURE X(9).
022200        10 FILLER                PICTURE X(8).
022300 WORKING-STORAGE SECTION.
022400 01  WRK-DS-09V00-001 PIC S9(09)      USAGE COMP VALUE ZERO.
022500 01  WRK-DS-09V00-002 PIC 9(3) VALUE ZERO.
022600 01  WRK-CS-09V00-002 PIC S9(09)       USAGE COMP VALUE ZERO.
022700 01  WRK-CS-09V00-003 PIC S9(09)       USAGE COMP VALUE ZERO.
022800 01  RL-KEY   PIC 9(3).
022900 01  RL-KEY2  PIC 9(3).
023000*
023100 01  WRK-FR1-RECKEY.
023200     05 FR1-RECKEY-1-13.
023300        10 FR1-RECKEY-1-10       PICTURE X(10).
023400        10 FR1-RECKEY-11-13      PICTURE 9(3).
023500     05 FILLER                   PICTURE X(16)  VALUE SPACE.
023600 01  WRK-FR1-ALTKEY1.
023700      05 FR1-ALTKEY1-1-20.
023800       10  FR1-ALTKEY1-1-10.
023900        15 FR1-ALTKEY1-1-5       PICTURE X(5).
024000        15 FR1-ALTKEY1-6-10      PICTURE X(5).
024100       10 FR1-ALTKEY1-11-13      PICTURE 9(3).
024200       10 FR1-ALTKEY1-14-20      PICTURE X(7).
024300     05 FILLER                   PICTURE X(9)  VALUE SPACE.
024400 01  WRK-FR1-ALTKEY2.
024500     05 FR1-ALTKEY2-1-20.
024600        10 FR1-ALTKEY2-1-10.
024700           15 FR1-ALTKEY2-1-5    PICTURE X(5).
024800           15 FR1-ALTKEY2-6-10   PICTURE X(5).
024900        10 FR1-ALTKEY2-11-13     PICTURE 9(3).
025000        10 FR1-ALTKEY2-14-20     PICTURE X(7).
025100     05 FILLER                   PICTURE X(9) VALUE SPACE.
025200 01  RECNO                       PICTURE 9(5)  VALUE ZERO.
025300 01  FR1-STATUS                  PICTURE XX   VALUE SPACE.
025400 01  FS1-STATUS-IX PIC XX VALUE SPACE.
025500 01  FS1-STATUS-SQ PIC XX VALUE SPACE.
025600 01  EXCUT-COUNTER-06V00         PICTURE 9(6) VALUE ZERO.
025700 01  KEYSUB                      PICTURE 9(3) COMPUTATIONAL.
025800 01  INVKEY-COUNTER-RL           PICTURE 9(3) COMPUTATIONAL.
025900 01  INVKEY-COUNTER-IX           PICTURE 9(3) COMPUTATIONAL.
026000 01  RECORDS-WRITTEN             PICTURE 9(3).
026100 01  RECKEY-NUM                  PICTURE 9(3).
026200 01  ALTKEY1-NUM                 PICTURE 9(3).
026300 01  ALTKEY2-NUM                 PICTURE 9(3).
026400 01  RECORD-KEY-CONTENT.
026500     05 FILLER PIC X(53) VALUE
026600          "BBBBBBBBBC225EEEEEEEEEF001ALTKEY1WWWWWWWWWV076ALTKEY2".
026700     05 FILLER PIC X(53) VALUE
026800          "BBBBBBBBCC224EEEEEEEEFF002ALTKEY1WWWWWWWWVV077ALTKEY2".
026900     05 FILLER PIC X(53) VALUE
027000          "BBBBBBBCCC223EEEEEEEFFF003ALTKEY1WWWWWWWVVV078ALTKEY2".
027100     05 FILLER PIC X(53) VALUE
027200          "BBBBBBCCCC222EEEEEEFFFF004ALTKEY1WWWWWWVVVV079ALTKEY2".
027300     05 FILLER PIC X(53) VALUE
027400          "BBBBBCCCCC221EEEEEFFFFF005ALTKEY1WWWWWVVVVV080ALTKEY2".
027500     05 FILLER PIC X(53) VALUE
027600          "BBBBCCCCCC220EEEEFFFFFF006ALTKEY1WWWWVVVVVV081ALTKEY2".
027700     05 FILLER PIC X(53) VALUE
027800          "BBBCCCCCCC219EEEFFFFFFF007ALTKEY1WWWVVVVVVV082ALTKEY2".
027900     05 FILLER PIC X(53) VALUE
028000          "BBCCCCCCCC218EEFFFFFFFF008ALTKEY1WWVVVVVVVV083ALTKEY2".
028100     05 FILLER PIC X(53) VALUE
028200          "BCCCCCCCCC217EFFFFFFFFF009ALTKEY1WVVVVVVVVV084ALTKEY2".
028300     05 FILLER PIC X(53) VALUE
028400          "CCCCCCCCCC216FFFFFFFFFF010ALTKEY1VVVVVVVVVV085ALTKEY2".
028500     05 FILLER PIC X(53) VALUE
028600          "CCCCCCCCCD215FFFFFFFFFG011ALTKEY1VVVVVVVVVV086ALTKEY2".
028700     05 FILLER PIC X(53) VALUE
028800          "CCCCCCCCDD214FFFFFFFFGG012ALTKEY1VVVVVVVVUU087ALTKEY2".
028900     05 FILLER PIC X(53) VALUE
029000          "CCCCCCCDDD213FFFFFFFGGG013ALTKEY1VVVVVVVUUU088ALTKEY2".
029100     05 FILLER PIC X(53) VALUE
029200          "CCCCCCDDDD212FFFFFFGGGG014ALTKEY1VVVVVVUUUU089ALTKEY2".
029300     05 FILLER PIC X(53) VALUE
029400          "CCCCCDDDDD211FFFFFGGGGG015ALTKEY1VVVVVUUUUU090ALTKEY2".
029500     05 FILLER PIC X(53) VALUE
029600          "CCCCDDDDDD210FFFFGGGGGG016ALTKEY1VVVVUUUUUU091ALTKEY2".
029700     05 FILLER PIC X(53) VALUE
029800          "CCCDDDDDDD209FFFGGGGGGG017ALTKEY1VVVUUUUUUU092ALTKEY2".
029900     05 FILLER PIC X(53) VALUE
030000          "CCDDDDDDDD208FFGGGGGGGG018ALTKEY1VVUUUUUUUU093ALTKEY2".
030100     05 FILLER PIC X(53) VALUE
030200          "CDDDDDDDDD207FGGGGGGGGG019ALTKEY1VUUUUUUUUU094ALTKEY2".
030300     05 FILLER PIC X(53) VALUE
030400          "DDDDDDDDDD206GGGGGGGGGG020ALTKEY1UUUUUUUUUU095ALTKEY2".
030500     05 FILLER PIC X(53) VALUE
030600          "DDDDDDDDDE205GGGGGGGGGH021ALTKEY1UUUUUUUUUU096ALTKEY2".
030700     05 FILLER PIC X(53) VALUE
030800          "DDDDDDDDEE204GGGGGGGGHH022ALTKEY1UUUUUUUUTT097ALTKEY2".
030900     05 FILLER PIC X(53) VALUE
031000          "DDDDDDDEEE203GGGGGGGHHH023ALTKEY1UUUUUUUTTT098ALTKEY2".
031100     05 FILLER PIC X(53) VALUE
031200          "DDDDDDEEEE202GGGGGGHHHH024ALTKEY1UUUUUUTTTT099ALTKEY2".
031300     05 FILLER PIC X(53) VALUE
031400          "DDDDDEEEEE201GGGGGHHHHH025ALTKEY1UUUUUTTTTT100ALTKEY2".
031500     05 FILLER PIC X(53) VALUE
031600          "DDDDEEEEEE200GGGGHHHHHH026ALTKEY1UUUUTTTTTT101ALTKEY2".
031700     05 FILLER PIC X(53) VALUE
031800          "DDDEEEEEEE199GGGHHHHHHH027ALTKEY1UUUTTTTTTT102ALTKEY2".
031900     05 FILLER PIC X(53) VALUE
032000          "DDEEEEEEEE198GGHHHHHHHH028ALTKEY1UUTTTTTTTT103ALTKEY2".
032100     05 FILLER PIC X(53) VALUE
032200          "DEEEEEEEEE197GHHHHHHHHH029ALTKEY1UTTTTTTTTT104ALTKEY2".
032300     05 FILLER PIC X(53) VALUE
032400          "EEEEEEEEEE196HHHHHHHHHH030ALTKEY1TTTTTTTTTT105ALTKEY2".
032500     05 FILLER PIC X(53) VALUE
032600          "EEEEEEEEEF195HHHHHHHHHI031ALTKEY1TTTTTTTTTT106ALTKEY2".
032700     05 FILLER PIC X(53) VALUE
032800          "EEEEEEEEFF194HHHHHHHHII032ALTKEY1TTTTTTTTSS107ALTKEY2".
032900     05 FILLER PIC X(53) VALUE
033000          "EEEEEEEFFF193HHHHHHHIII033ALTKEY1TTTTTTTSSS108ALTKEY2".
033100     05 FILLER PIC X(53) VALUE
033200          "EEEEEEFFFF192HHHHHHIIII034ALTKEY1TTTTTTSSSS109ALTKEY2".
033300     05 FILLER PIC X(53) VALUE
033400          "EEEEEFFFFF191HHHHHIIIII035ALTKEY1TTTTTSSSSS110ALTKEY2".
033500     05 FILLER PIC X(53) VALUE
033600          "EEEEFFFFFF190HHHHIIIIII036ALTKEY1TTTTSSSSSS111ALTKEY2".
033700     05 FILLER PIC X(53) VALUE
033800          "EEEFFFFFFF189HHHIIIIIII037ALTKEY1TTTSSSSSSS112ALTKEY2".
033900     05 FILLER PIC X(53) VALUE
034000          "EEFFFFFFFF188HHIIIIIIII038ALTKEY1TTSSSSSSSS113ALTKEY2".
034100     05 FILLER PIC X(53) VALUE
034200          "EFFFFFFFFF187HIIIIIIIII039ALTKEY1TSSSSSSSSS114ALTKEY2".
034300     05 FILLER PIC X(53) VALUE
034400          "FFFFFFFFFF186IIIIIIIIII040ALTKEY1SSSSSSSSSS115ALTKEY2".
034500     05 FILLER PIC X(53) VALUE
034600          "FFFFFFFFFG185IIIIIIIIIJ041ALTKEY1SSSSSSSSSS116ALTKEY2".
034700     05 FILLER PIC X(53) VALUE
034800          "FFFFFFFFGG184IIIIIIIIJJ042ALTKEY1SSSSSSSSRR117ALTKEY2".
034900     05 FILLER PIC X(53) VALUE
035000          "FFFFFFFGGG183IIIIIIIJJJ043ALTKEY1SSSSSSSRRR118ALTKEY2".
035100     05 FILLER PIC X(53) VALUE
035200          "FFFFFFGGGG182IIIIIIJJJJ044ALTKEY1SSSSSSRRRR119ALTKEY2".
035300     05 FILLER PIC X(53) VALUE
035400          "FFFFFGGGGG181IIIIIJJJJJ045ALTKEY1SSSSSRRRRR120ALTKEY2".
035500     05 FILLER PIC X(53) VALUE
035600          "FFFFGGGGGG180IIIIJJJJJJ046ALTKEY1SSSSRRRRRR121ALTKEY2".
035700     05 FILLER PIC X(53) VALUE
035800          "FFFGGGGGGG179IIIJJJJJJJ047ALTKEY1SSSRRRRRRR122ALTKEY2".
035900     05 FILLER PIC X(53) VALUE
036000          "FFGGGGGGGG178IIJJJJJJJJ048ALTKEY1SSRRRRRRRR123ALTKEY2".
036100     05 FILLER PIC X(53) VALUE
036200          "FGGGGGGGGG177IJJJJJJJJJ049ALTKEY1SRRRRRRRRR124ALTKEY2".
036300     05 FILLER PIC X(53) VALUE
036400          "GGGGGGGGGG176JJJJJJJJJJ050ALTKEY1RRRRRRRRRR125ALTKEY2".
036500     05 FILLER PIC X(53) VALUE
036600          "RRRRSSSSSS175VVVVWWWWWW051ALTKEY1GGGGFFFFFF126ALTKEY2".
036700     05 FILLER PIC X(53) VALUE
036800          "RRRSSSSSSS174VVVWWWWWWW052ALTKEY1GGGFFFFFFF127ALTKEY2".
036900     05 FILLER PIC X(53) VALUE
037000          "RRSSSSSSSS173VVWWWWWWWW053ALTKEY1GGFFFFFFFF128ALTKEY2".
037100     05 FILLER PIC X(53) VALUE
037200          "RSSSSSSSSS172VWWWWWWWWW054ALTKEY1GFFFFFFFFF129ALTKEY2".
037300     05 FILLER PIC X(53) VALUE
037400          "SSSSSSSSSS171WWWWWWWWWW055ALTKEY1FFFFFFFFFF130ALTKEY2".
037500     05 FILLER PIC X(53) VALUE
037600          "SSSSSSSSST170WWWWWWWWWX056ALTKEY1FFFFFFFFFF131ALTKEY2".
037700     05 FILLER PIC X(53) VALUE
037800          "SSSSSSSSTT169WWWWWWWWXX057ALTKEY1FFFFFFFFEE132ALTKEY2".
037900     05 FILLER PIC X(53) VALUE
038000          "SSSSSSSTTT168WWWWWWWXXX058ALTKEY1FFFFFFFEEE133ALTKEY2".
038100     05 FILLER PIC X(53) VALUE
038200          "SSSSSSTTTT167WWWWWWXXXX059ALTKEY1FFFFFFEEEE134ALTKEY2".
038300     05 FILLER PIC X(53) VALUE
038400          "SSSSSTTTTT166WWWWWXXXXX060ALTKEY1FFFFFEEEEE135ALTKEY2".
038500     05 FILLER PIC X(53) VALUE
038600          "SSSSTTTTTT165WWWWXXXXXX061ALTKEY1FFFFEEEEEE136ALTKEY2".
038700     05 FILLER PIC X(53) VALUE
038800          "SSSTTTTTTT164WWWXXXXXXX062ALTKEY1FFFEEEEEEE137ALTKEY2".
038900     05 FILLER PIC X(53) VALUE
039000          "SSTTTTTTTT163WWXXXXXXXX063ALTKEY1FFEEEEEEEE138ALTKEY2".
039100     05 FILLER PIC X(53) VALUE
039200          "STTTTTTTTT162WXXXXXXXXX064ALTKEY1FEEEEEEEEE139ALTKEY2".
039300     05 FILLER PIC X(53) VALUE
039400          "TTTTTTTTTT161XXXXXXXXXX065ALTKEY1EEEEEEEEEE140ALTKEY2".
039500     05 FILLER PIC X(53) VALUE
039600          "TTTTTTTTTU160XXXXXXXXXY066ALTKEY1EEEEEEEEEE141ALTKEY2".
039700     05 FILLER PIC X(53) VALUE
039800          "TTTTTTTTUU159XXXXXXXXYY067ALTKEY1EEEEEEEEDD142ALTKEY2".
039900     05 FILLER PIC X(53) VALUE
040000          "TTTTTTTUUU158XXXXXXXYYY068ALTKEY1EEEEEEEDDD143ALTKEY2".
040100     05 FILLER PIC X(53) VALUE
040200          "TTTTTTUUUU157XXXXXXYYYY069ALTKEY1EEEEEEDDDD144ALTKEY2".
040300     05 FILLER PIC X(53) VALUE
040400          "TTTTTUUUUU156XXXXXYYYYY070ALTKEY1EEEEEDDDDD145ALTKEY2".
040500     05 FILLER PIC X(53) VALUE
040600          "TTTTUUUUUU155XXXXYYYYYY071ALTKEY1EEEEDDDDDD146ALTKEY2".
040700     05 FILLER PIC X(53) VALUE
040800          "TTTUUUUUUU154XXXYYYYYYY072ALTKEY1EEEDDDDDDD147ALTKEY2".
040900     05 FILLER PIC X(53) VALUE
041000          "TTUUUUUUUU153XXYYYYYYYY073ALTKEY1EEDDDDDDDD148ALTKEY2".
041100     05 FILLER PIC X(53) VALUE
041200          "TUUUUUUUUU152XYYYYYYYYY074ALTKEY1EDDDDDDDDD149ALTKEY2".
041300     05 FILLER PIC X(53) VALUE
041400          "UUUUUUUUUU151YYYYYYYYYY075ALTKEY1DDDDDDDDDD150ALTKEY2".
041500 01  RECORD-KEY-DATA   REDEFINES  RECORD-KEY-CONTENT.
041600     05 KEY-VALUES                  OCCURS 75  TIMES.
041700       10 RECKEY-VALUE           PICTURE X(13).
041800       10 ALTKEY1-VALUE          PICTURE X(20).
041900       10 ALTKEY2-VALUE          PICTURE X(20).
042000 01  INIT-FLAG                   PICTURE 9.
042100 01  HOLD-FILESTATUS-RECORD.
042200     05 FILESTATUS               PICTURE XX  OCCURS 10 TIMES.
042300
042400 01  FILE-RECORD-INFORMATION-REC.
042500     03 FILE-RECORD-INFO-SKELETON.
042600        05 FILLER                 PICTURE X(48)       VALUE
042700             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
042800        05 FILLER                 PICTURE X(46)       VALUE
042900             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
043000        05 FILLER                 PICTURE X(26)       VALUE
043100             ",LFIL=000000,ORG=  ,LBLR= ".
043200        05 FILLER                 PICTURE X(37)       VALUE
043300             ",RECKEY=                             ".
043400        05 FILLER                 PICTURE X(38)       VALUE
043500             ",ALTKEY1=                             ".
043600        05 FILLER                 PICTURE X(38)       VALUE
043700             ",ALTKEY2=                             ".
043800        05 FILLER                 PICTURE X(7)        VALUE SPACE.
043900     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
044000        05 FILE-RECORD-INFO-P1-120.
044100           07 FILLER              PIC X(5).
044200           07 XFILE-NAME           PIC X(6).
044300           07 FILLER              PIC X(8).
044400           07 XRECORD-NAME         PIC X(6).
044500           07 FILLER              PIC X(1).
044600           07 REELUNIT-NUMBER     PIC 9(1).
044700           07 FILLER              PIC X(7).
044800           07 XRECORD-NUMBER       PIC 9(6).
044900           07 FILLER              PIC X(6).
045000           07 UPDATE-NUMBER       PIC 9(2).
045100           07 FILLER              PIC X(5).
045200           07 ODO-NUMBER          PIC 9(4).
045300           07 FILLER              PIC X(5).
045400           07 XPROGRAM-NAME        PIC X(5).
045500           07 FILLER              PIC X(7).
045600           07 XRECORD-LENGTH       PIC 9(6).
045700           07 FILLER              PIC X(7).
045800           07 CHARS-OR-RECORDS    PIC X(2).
045900           07 FILLER              PIC X(1).
046000           07 XBLOCK-SIZE          PIC 9(4).
046100           07 FILLER              PIC X(6).
046200           07 RECORDS-IN-FILE     PIC 9(6).
046300           07 FILLER              PIC X(5).
046400           07 XFILE-ORGANIZATION   PIC X(2).
046500           07 FILLER              PIC X(6).
046600           07 XLABEL-TYPE          PIC X(1).
046700        05 FILE-RECORD-INFO-P121-240.
046800           07 FILLER              PIC X(8).
046900           07 XRECORD-KEY          PIC X(29).
047000           07 FILLER              PIC X(9).
047100           07 ALTERNATE-KEY1      PIC X(29).
047200           07 FILLER              PIC X(9).
047300           07 ALTERNATE-KEY2      PIC X(29).
047400           07 FILLER              PIC X(7).
047500
047600 01  TEST-RESULTS.
047700     02 FILLER                   PIC X      VALUE SPACE.
047800     02 FEATURE                  PIC X(20)  VALUE SPACE.
047900     02 FILLER                   PIC X      VALUE SPACE.
048000     02 P-OR-F                   PIC X(5)   VALUE SPACE.
048100     02 FILLER                   PIC X      VALUE SPACE.
048200     02  PAR-NAME.
048300       03 FILLER                 PIC X(19)  VALUE SPACE.
048400       03  PARDOT-X              PIC X      VALUE SPACE.
048500       03 DOTVALUE               PIC 99     VALUE ZERO.
048600     02 FILLER                   PIC X(8)   VALUE SPACE.
048700     02 RE-MARK                  PIC X(61).
048800 01  TEST-COMPUTED.
048900     02 FILLER                   PIC X(30)  VALUE SPACE.
049000     02 FILLER                   PIC X(17)  VALUE
049100            "       COMPUTED=".
049200     02 COMPUTED-X.
049300     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
049400     03 COMPUTED-N               REDEFINES COMPUTED-A
049500                                 PIC -9(9).9(9).
049600     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
049700     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
049800     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
049900     03       CM-18V0 REDEFINES COMPUTED-A.
050000         04 COMPUTED-18V0                    PIC -9(18).
050100         04 FILLER                           PIC X.
050200     03 FILLER PIC X(50) VALUE SPACE.
050300 01  TEST-CORRECT.
050400     02 FILLER PIC X(30) VALUE SPACE.
050500     02 FILLER PIC X(17) VALUE "       CORRECT =".
050600     02 CORRECT-X.
050700     03 CORRECT-A                  PIC X(20) VALUE SPACE.
050800     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
050900     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
051000     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
051100     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
051200     03      CR-18V0 REDEFINES CORRECT-A.
051300         04 CORRECT-18V0                     PIC -9(18).
051400         04 FILLER                           PIC X.
051500     03 FILLER PIC X(2) VALUE SPACE.
051600     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
051700 01  CCVS-C-1.
051800     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
051900-    "SS  PARAGRAPH-NAME
052000-    "       REMARKS".
052100     02 FILLER                     PIC X(20)    VALUE SPACE.
052200 01  CCVS-C-2.
052300     02 FILLER                     PIC X        VALUE SPACE.
052400     02 FILLER                     PIC X(6)     VALUE "TESTED".
052500     02 FILLER                     PIC X(15)    VALUE SPACE.
052600     02 FILLER                     PIC X(4)     VALUE "FAIL".
052700     02 FILLER                     PIC X(94)    VALUE SPACE.
052800 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
052900 01  REC-CT                        PIC 99       VALUE ZERO.
053000 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
053100 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
053200 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
053300 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
053400 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
053500 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
053600 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
053700 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
053800 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
053900 01  CCVS-H-1.
054000     02  FILLER                    PIC X(39)    VALUE SPACES.
054100     02  FILLER                    PIC X(42)    VALUE
054200     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
054300     02  FILLER                    PIC X(39)    VALUE SPACES.
054400 01  CCVS-H-2A.
054500   02  FILLER                        PIC X(40)  VALUE SPACE.
054600   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
054700   02  FILLER                        PIC XXXX   VALUE
054800     "4.2 ".
054900   02  FILLER                        PIC X(28)  VALUE
055000            " COPY - NOT FOR DISTRIBUTION".
055100   02  FILLER                        PIC X(41)  VALUE SPACE.
055200
055300 01  CCVS-H-2B.
055400   02  FILLER                        PIC X(15)  VALUE
055500            "TEST RESULT OF ".
055600   02  TEST-ID                       PIC X(9).
055700   02  FILLER                        PIC X(4)   VALUE
055800            " IN ".
055900   02  FILLER                        PIC X(12)  VALUE
056000     " HIGH       ".
056100   02  FILLER                        PIC X(22)  VALUE
056200            " LEVEL VALIDATION FOR ".
056300   02  FILLER                        PIC X(58)  VALUE
056400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
056500 01  CCVS-H-3.
056600     02  FILLER                      PIC X(34)  VALUE
056700            " FOR OFFICIAL USE ONLY    ".
056800     02  FILLER                      PIC X(58)  VALUE
056900     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
057000     02  FILLER                      PIC X(28)  VALUE
057100            "  COPYRIGHT   1985 ".
057200 01  CCVS-E-1.
057300     02 FILLER                       PIC X(52)  VALUE SPACE.
057400     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
057500     02 ID-AGAIN                     PIC X(9).
057600     02 FILLER                       PIC X(45)  VALUE SPACES.
057700 01  CCVS-E-2.
057800     02  FILLER                      PIC X(31)  VALUE SPACE.
057900     02  FILLER                      PIC X(21)  VALUE SPACE.
058000     02 CCVS-E-2-2.
058100         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
058200         03 FILLER                   PIC X      VALUE SPACE.
058300         03 ENDER-DESC               PIC X(44)  VALUE
058400            "ERRORS ENCOUNTERED".
058500 01  CCVS-E-3.
058600     02  FILLER                      PIC X(22)  VALUE
058700            " FOR OFFICIAL USE ONLY".
058800     02  FILLER                      PIC X(12)  VALUE SPACE.
058900     02  FILLER                      PIC X(58)  VALUE
059000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
059100     02  FILLER                      PIC X(13)  VALUE SPACE.
059200     02 FILLER                       PIC X(15)  VALUE
059300             " COPYRIGHT 1985".
059400 01  CCVS-E-4.
059500     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
059600     02 FILLER                       PIC X(4)   VALUE " OF ".
059700     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
059800     02 FILLER                       PIC X(40)  VALUE
059900      "  TESTS WERE EXECUTED SUCCESSFULLY".
060000 01  XXINFO.
060100     02 FILLER                       PIC X(19)  VALUE
060200            "*** INFORMATION ***".
060300     02 INFO-TEXT.
060400       04 FILLER                     PIC X(8)   VALUE SPACE.
060500       04 XXCOMPUTED                 PIC X(20).
060600       04 FILLER                     PIC X(5)   VALUE SPACE.
060700       04 XXCORRECT                  PIC X(20).
060800     02 INF-ANSI-REFERENCE           PIC X(48).
060900 01  HYPHEN-LINE.
061000     02 FILLER  PIC IS X VALUE IS SPACE.
061100     02 FILLER  PIC IS X(65)    VALUE IS "************************
061200-    "*****************************************".
061300     02 FILLER  PIC IS X(54)    VALUE IS "************************
061400-    "******************************".
061500 01  CCVS-PGM-ID                     PIC X(9)   VALUE
061600     "IX106A".
061700 PROCEDURE DIVISION.
061800 CCVS1 SECTION.
061900 OPEN-FILES.
062000P    OPEN I-O RAW-DATA.
062100P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
062200P    READ RAW-DATA INVALID KEY GO TO END-E-1.
062300P    MOVE "ABORTED " TO C-ABORT.
062400P    ADD 1 TO C-NO-OF-TESTS.
062500P    ACCEPT C-DATE  FROM DATE.
062600P    ACCEPT C-TIME  FROM TIME.
062700P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
062800PEND-E-1.
062900P    CLOSE RAW-DATA.
063000     OPEN    OUTPUT PRINT-FILE.
063100     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
063200     MOVE    SPACE TO TEST-RESULTS.
063300     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
063400     MOVE    ZERO TO REC-SKL-SUB.
063500     PERFORM CCVS-INIT-FILE 9 TIMES.
063600 CCVS-INIT-FILE.
063700     ADD     1 TO REC-SKL-SUB.
063800     MOVE    FILE-RECORD-INFO-SKELETON
063900          TO FILE-RECORD-INFO (REC-SKL-SUB).
064000 CCVS-INIT-EXIT.
064100     GO TO CCVS1-EXIT.
064200 CLOSE-FILES.
064300P    OPEN I-O RAW-DATA.
064400P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
064500P    READ RAW-DATA INVALID KEY GO TO END-E-2.
064600P    MOVE "OK.     " TO C-ABORT.
064700P    MOVE PASS-COUNTER TO C-OK.
064800P    MOVE ERROR-HOLD   TO C-ALL.
064900P    MOVE ERROR-COUNTER TO C-FAIL.
065000P    MOVE DELETE-COUNTER TO C-DELETED.
065100P    MOVE INSPECT-COUNTER TO C-INSPECT.
065200P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
065300PEND-E-2.
065400P    CLOSE RAW-DATA.
065500     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
065600 TERMINATE-CCVS.
065700S    EXIT PROGRAM.
065800STERMINATE-CALL.
065900     STOP     RUN.
066000 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
066100 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
066200 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
066300 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
066400     MOVE "****TEST DELETED****" TO RE-MARK.
066500 PRINT-DETAIL.
066600     IF REC-CT NOT EQUAL TO ZERO
066700             MOVE "." TO PARDOT-X
066800             MOVE REC-CT TO DOTVALUE.
066900     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
067000     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
067100        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
067200          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
067300     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
067400     MOVE SPACE TO CORRECT-X.
067500     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
067600     MOVE     SPACE TO RE-MARK.
067700 HEAD-ROUTINE.
067800     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
067900     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
068000     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
068100     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
068200 COLUMN-NAMES-ROUTINE.
068300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
068400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
068500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
068600 END-ROUTINE.
068700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
068800 END-RTN-EXIT.
068900     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
069000 END-ROUTINE-1.
069100      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
069200      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
069300      ADD PASS-COUNTER TO ERROR-HOLD.
069400*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
069500      MOVE PASS-COUNTER TO CCVS-E-4-1.
069600      MOVE ERROR-HOLD TO CCVS-E-4-2.
069700      MOVE CCVS-E-4 TO CCVS-E-2-2.
069800      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
069900  END-ROUTINE-12.
070000      MOVE "TEST(S) FAILED" TO ENDER-DESC.
070100     IF       ERROR-COUNTER IS EQUAL TO ZERO
070200         MOVE "NO " TO ERROR-TOTAL
070300         ELSE
070400         MOVE ERROR-COUNTER TO ERROR-TOTAL.
070500     MOVE     CCVS-E-2 TO DUMMY-RECORD.
070600     PERFORM WRITE-LINE.
070700 END-ROUTINE-13.
070800     IF DELETE-COUNTER IS EQUAL TO ZERO
070900         MOVE "NO " TO ERROR-TOTAL  ELSE
071000         MOVE DELETE-COUNTER TO ERROR-TOTAL.
071100     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
071200     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
071300      IF   INSPECT-COUNTER EQUAL TO ZERO
071400          MOVE "NO " TO ERROR-TOTAL
071500      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
071600      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
071700      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
071800     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
071900 WRITE-LINE.
072000     ADD 1 TO RECORD-COUNT.
072100Y    IF RECORD-COUNT GREATER 42
072200Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
072300Y        MOVE SPACE TO DUMMY-RECORD
072400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
072500Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
072600Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
072700Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
072800Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
072900Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
073000Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
073100Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
073200Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
073300Y        MOVE ZERO TO RECORD-COUNT.
073400     PERFORM WRT-LN.
073500 WRT-LN.
073600     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
073700     MOVE SPACE TO DUMMY-RECORD.
073800 BLANK-LINE-PRINT.
073900     PERFORM WRT-LN.
074000 FAIL-ROUTINE.
074100     IF     COMPUTED-X NOT EQUAL TO SPACE
074200            GO TO   FAIL-ROUTINE-WRITE.
074300     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
074400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
074500     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
074600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
074700     MOVE   SPACES TO INF-ANSI-REFERENCE.
074800     GO TO  FAIL-ROUTINE-EX.
074900 FAIL-ROUTINE-WRITE.
075000     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
075100     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
075200     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
075300     MOVE   SPACES TO COR-ANSI-REFERENCE.
075400 FAIL-ROUTINE-EX. EXIT.
075500 BAIL-OUT.
075600     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
075700     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
075800 BAIL-OUT-WRITE.
075900     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
076000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
076100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
076200     MOVE   SPACES TO INF-ANSI-REFERENCE.
076300 BAIL-OUT-EX. EXIT.
076400 CCVS1-EXIT.
076500     EXIT.
076600******************************************************************
076700 SECT-0001-RIS101 SECTION.
076800*
076900* THIS SECTION CREATES A RELATIVE FILE RANDOMLY.
077000*
077100 WRITE-INT-GF-01.
077200     OPEN    OUTPUT RL-FR1.
077300     MOVE    "RL-FR1" TO XFILE-NAME           (1).
077400     MOVE    "R1-F-G" TO  XRECORD-NAME        (1).
077500     MOVE    ZERO     TO  XRECORD-NUMBER      (1).
077600     MOVE    "RC"     TO  CHARS-OR-RECORDS    (1).
077700     MOVE    CCVS-PGM-ID TO  XPROGRAM-NAME    (1).
077800     MOVE    241      TO  XRECORD-LENGTH      (1).
077900     MOVE    001      TO  XBLOCK-SIZE         (1).
078000     MOVE    "RL"     TO  XFILE-ORGANIZATION  (1).
078100     MOVE    "S"      TO  XLABEL-TYPE         (1).
078200     MOVE    225      TO  RECORDS-IN-FILE     (1).
078300     MOVE    "WRITE RL-FR1   " TO FEATURE.
078400     MOVE    "WRITE-TEST-GF-01" TO PAR-NAME.
078500     MOVE    ZERO TO KEYSUB.
078600     MOVE    ZERO TO INVKEY-COUNTER-RL.
078700 WRITE-INIT-GF-01-01.
078800     PERFORM WRITE-TEST-GF-01-R1 75 TIMES.
078900     GO TO   WRITE-TEST-GF-01.
079000 WRITE-TEST-GF-01-R1.
079100*
079200* WRITE-TEST-GF-01-R1 - WRITES THREE RECORDS FOR EACH PASS THRU .
079300*                      1) FOR THE FIRST RECORD CREATED RL-KEY IS
079400*                         SET TO FR1-RECKEY-11-13 .
079500*                      2) FOR THE SECOND RECORD CREATED RL-KEY IS
079600*                         SET TO FR1-ALTKEY1-11-13 .
079700*                      3) FOR THE THIRD RECORD CREATED RL-KEY IS
079800*                         SET TO FR1-ALTKEY2-11-13 .
079900*                      THESE RECORD KEYS ARE IN THREE DIFFERENT
080000*                      ORDERINGS.
080100*                      1) FR1-RECKEY-11-13 ARE THE NUMBERS FROM
080200*                         225 TO 151 DECENDING .
080300*                      2) FR1-ALTKEY1-11-13 ARE THE NUMBERS FROM
080400*                         1 TO 75 ASCENDING .
080500*                      3) FR1-ALTKEY-11-13 ARE THE NUMBERS FROM
080600*                         76 TO 151 ASCENDING .
080700*
080800     ADD     001  TO XRECORD-NUMBER (1).
080900     ADD     001  TO  KEYSUB.
081000     MOVE    RECKEY-VALUE (KEYSUB) TO FR1-RECKEY-1-13.
081100     MOVE    ALTKEY1-VALUE (KEYSUB) TO FR1-ALTKEY1-1-20.
081200     MOVE    ALTKEY2-VALUE (KEYSUB) TO FR1-ALTKEY2-1-20.
081300     MOVE    WRK-FR1-RECKEY   TO    XRECORD-KEY (1).
081400     MOVE    WRK-FR1-ALTKEY1  TO ALTERNATE-KEY1 (1).
081500     MOVE    WRK-FR1-ALTKEY2  TO ALTERNATE-KEY2 (1).
081600     MOVE    FILE-RECORD-INFO (1)  TO RL-FR1R1-F-G-241.
081700     MOVE FR1-RECKEY-11-13 TO RL-KEY.
081800     WRITE   RL-FR1R1-F-G-241
081900                        INVALID KEY ADD 001 TO INVKEY-COUNTER-RL.
082000     ADD     001 TO EXCUT-COUNTER-06V00.
082100     ADD     001 TO XRECORD-NUMBER (1).
082200     MOVE  FR1-ALTKEY1-11-13 TO FR1-RECKEY-11-13.
082300     MOVE WRK-FR1-RECKEY TO XRECORD-KEY (1).
082400     MOVE FR1-RECKEY-11-13 TO RL-KEY.
082500     MOVE FILE-RECORD-INFO (1) TO RL-FR1R1-F-G-241.
082600     WRITE   RL-FR1R1-F-G-241
082700                        INVALID KEY ADD 001 TO INVKEY-COUNTER-RL.
082800     ADD     001 TO EXCUT-COUNTER-06V00.
082900     ADD     001 TO XRECORD-NUMBER (1).
083000     MOVE  FR1-ALTKEY2-11-13 TO FR1-RECKEY-11-13.
083100     MOVE WRK-FR1-RECKEY TO XRECORD-KEY (1).
083200     MOVE FR1-RECKEY-11-13 TO RL-KEY.
083300     MOVE FILE-RECORD-INFO (1) TO RL-FR1R1-F-G-241.
083400     WRITE   RL-FR1R1-F-G-241
083500                        INVALID KEY ADD 001 TO INVKEY-COUNTER-RL.
083600     ADD      001 TO EXCUT-COUNTER-06V00.
083700 WRITE-TEST-GF-01.
083800     SUBTRACT INVKEY-COUNTER-RL FROM EXCUT-COUNTER-06V00
083900             GIVING RECORDS-WRITTEN.
084000 WRITE-TEST-CHECK.
084100     MOVE    225  TO CORRECT-18V0.
084200     MOVE    RECORDS-WRITTEN TO COMPUTED-18V0.
084300     IF      RECORDS-WRITTEN EQUAL TO 225
084400             PERFORM  PASS
084500             ELSE
084600             MOVE "VIII-37  4.9.2                    " TO RE-MARK
084700             PERFORM FAIL.
084800     PERFORM PRINT-DETAIL.
084900 WRITE-TEST-GF-01-END.
085000     CLOSE   RL-FR1.
085100******************************************************************
085200 SECT-0002-RIS101 SECTION.
085300*
085400* THIS SECTION CREATES A SEQUENTIAL AND AN INDEXED FILE USING THE
085500* RELATIVE FILE CREATED IN THE PREVIOUS SECTION AS INPUT .
085600*
085700 WRITE-INIT-GF-02.
085800     OPEN    OUTPUT IX-FS1 SQ-FS1.
085900     OPEN    INPUT RL-FR1.
086000     MOVE    ZERO TO RL-KEY.
086100     MOVE    ZERO TO INVKEY-COUNTER-RL.
086200     MOVE    ZERO TO INVKEY-COUNTER-IX.
086300     MOVE ZERO TO EXCUT-COUNTER-06V00.
086400     PERFORM WRITE-TEST-GF-02-01 75 TIMES.
086500     PERFORM WRITE-TEST-GF-02-02 75 TIMES.
086600     PERFORM WRITE-TEST-GF-02-03 75 TIMES.
086700     GO TO WRITE-TEST-GF-02-END.
086800 WRITE-INT-GF-02-IX.
086900     MOVE    "WRITE IX-FS1  " TO FEATURE.
087000     MOVE    "WRITE-TEST-GF-02" TO PAR-NAME.
087100 WRITE-INT-GF-02-SQ.
087200     MOVE    "WRITE SQ-FS1  " TO FEATURE.
087300     MOVE    "WRITE-TEST-GF-02" TO PAR-NAME.
087400 WRITE-TEST-GF-02-01.
087500*
087600* WRITE-TEST-GF-02-01 - READS IN THE RELATIVE FILE IN SEQUENCE ,
087700*                      MOVES RL-FR1-ALTKEY1-11-13 TO
087800*                      RL-FR1-ALTKEY2-11-13 SO THAT ALL THE
087900*                      KEYS ON THE RECORD ARE THE SAME , THEN
088000*                      WRITES A SEQUENTIAL RECORD AND AN INDEXED
088100*                      FILE RECORD .
088200*
088300     ADD     001 TO RL-KEY.
088400     READ RL-FR1
088500         INVALID KEY ADD 001 TO INVKEY-COUNTER-RL.
088600     MOVE    RL-FR1-REC-120 TO FILE-RECORD-INFO-P1-120(1).
088700     MOVE    RL-FR1-ALTKEY1-11-13 TO RL-FR1-ALTKEY2-11-13.
088800     MOVE    RL-FR1R1-F-G-241 TO SQ-FS1R1-F-G-241.
088900     MOVE    SQ-FS1R1-F-G-241 TO IX-FS1R1-F-G-241.
089000     MOVE    "SQ-FS1" TO XFILE-NAME           (1).
089100     MOVE    "SQ"     TO  XFILE-ORGANIZATION  (1).
089200     MOVE    "WRITE SQ-FS1  " TO FEATURE.
089300     MOVE    "WRITE-TEST-GF-02" TO PAR-NAME.
089400     MOVE FILE-RECORD-INFO-P1-120(1) TO SQ-FS1-REC-120.
089500     WRITE   SQ-FS1R1-F-G-241.
089600     MOVE    "IX-FS1" TO XFILE-NAME           (1).
089700     MOVE    "IX"     TO  XFILE-ORGANIZATION  (1).
089800     MOVE    "WRITE IX-FS1  " TO FEATURE.
089900     MOVE    "WRITE-TEST-GF-02" TO PAR-NAME.
090000     MOVE FILE-RECORD-INFO-P1-120(1) TO IX-FS1-REC-120.
090100     WRITE   IX-FS1R1-F-G-241
090200         INVALID KEY ADD 001 TO INVKEY-COUNTER-IX.
090300     ADD 001 TO EXCUT-COUNTER-06V00.
090400 WRITE-TEST-GF-02-02.
090500*
090600* WRITE-TEST-GF-02-02 - READS IN THE RELATIVE FILE IN SEQUENCE
090700*                 STARTING AT NUMBER 76 WHERE WRITE-TEST-GF-02-01
090800*                     LEFT OFF . MOVES RL-FR1-ALTKEY2-11-13 TO
090900*                     RL-FR1-ALTKEY1-11-13 SO THAT ALL THE KEYS
091000*                     IN THE RECORD ARE THE SAME . WRITES A
091100*                     SEQUENTIAL AND AN INDEXED FILE RECORD .
091200*
091300     ADD     001 TO RL-KEY.
091400     READ RL-FR1
091500         INVALID KEY ADD 001 TO INVKEY-COUNTER-RL.
091600     MOVE    RL-FR1-REC-120 TO FILE-RECORD-INFO-P1-120(1).
091700     MOVE    RL-FR1-ALTKEY2-11-13 TO RL-FR1-ALTKEY1-11-13.
091800     MOVE    RL-FR1R1-F-G-241 TO SQ-FS1R1-F-G-241.
091900     MOVE    SQ-FS1R1-F-G-241 TO IX-FS1R1-F-G-241.
092000     MOVE    "SQ-FS1" TO XFILE-NAME           (1).
092100     MOVE    "SQ"     TO  XFILE-ORGANIZATION  (1).
092200     MOVE FILE-RECORD-INFO-P1-120(1) TO SQ-FS1-REC-120.
092300     WRITE   SQ-FS1R1-F-G-241.
092400     MOVE    "IX-FS1" TO XFILE-NAME           (1).
092500     MOVE    "IX"     TO  XFILE-ORGANIZATION  (1).
092600     MOVE FILE-RECORD-INFO-P1-120(1) TO IX-FS1-REC-120.
092700     WRITE   IX-FS1R1-F-G-241
092800         INVALID KEY ADD 001 TO INVKEY-COUNTER-IX.
092900     ADD 001 TO EXCUT-COUNTER-06V00.
093000 WRITE-TEST-GF-02-03.
093100*
093200* WRITE-TEST-GF-02-03 - READS IN THE RELATIVE FILE IN SEQUENCE
093300*                STARTING AT NUMBER 151 WHERE WRITE-TEST-GF-02-02
093400*                    LEFT OFF . MOVES RL-FR1-KEY-11-13 TO
093500*                    RL-FR1-ALTKEY1-11-13 AND RL-ALTKEY2-11-13
093600*                    SO THAT ALL THE KEYS IN THE RECORD ARE
093700*                    THE SAME . WRITES A SEQUENTIAL AND AN
093800*                    INDEXED FILE RECORD .
093900*
094000     ADD     001 TO RL-KEY.
094100     READ RL-FR1
094200         INVALID KEY ADD 001 TO INVKEY-COUNTER-RL.
094300     MOVE    RL-FR1-REC-120 TO FILE-RECORD-INFO-P1-120(1).
094400     MOVE RL-FR1-KEY-11-13 TO RL-FR1-ALTKEY1-11-13.
094500     MOVE    RL-FR1-ALTKEY1-11-13 TO RL-FR1-ALTKEY2-11-13.
094600     MOVE    RL-FR1R1-F-G-241 TO SQ-FS1R1-F-G-241.
094700     MOVE    SQ-FS1R1-F-G-241 TO IX-FS1R1-F-G-241.
094800     MOVE    "SQ-FS1" TO XFILE-NAME           (1).
094900     MOVE    "SQ"     TO  XFILE-ORGANIZATION  (1).
095000     MOVE FILE-RECORD-INFO-P1-120(1) TO SQ-FS1-REC-120.
095100     WRITE   SQ-FS1R1-F-G-241.
095200     MOVE    "IX-FS1" TO XFILE-NAME           (1).
095300     MOVE    "IX"     TO  XFILE-ORGANIZATION  (1).
095400     MOVE FILE-RECORD-INFO-P1-120(1) TO IX-FS1-REC-120.
095500     WRITE   IX-FS1R1-F-G-241
095600         INVALID KEY ADD 001 TO INVKEY-COUNTER-IX.
095700     ADD 001 TO EXCUT-COUNTER-06V00.
095800 WRITE-TEST-GF-02-END.
095900     CLOSE RL-FR1.
096000     CLOSE SQ-FS1.
096100     CLOSE IX-FS1.
096200     MOVE "READ RL-FR1  " TO FEATURE.
096300     MOVE "WRITE-TEST-GF-02" TO PAR-NAME.
096400     PERFORM WRITE-TEST-GF-01 THRU WRITE-TEST-CHECK.
096500     SUBTRACT INVKEY-COUNTER-IX FROM EXCUT-COUNTER-06V00
096600          GIVING RECORDS-WRITTEN.
096700 WRITE-TEST-GF-02-2.
096800     PERFORM WRITE-INT-GF-02-IX.
096900     MOVE "WRITE-TEST-GF-02-2" TO PAR-NAME.
097000     PERFORM WRITE-TEST-CHECK.
097100 WRITE-TEST-GF-02-3.
097200     PERFORM WRITE-INT-GF-02-SQ.
097300     MOVE "WRITE-TEST-GF-02-3" TO PAR-NAME.
097400     PERFORM WRITE-TEST-CHECK.
097500******************************************************************
097600 SECT-0003-RIS101 SECTION.
097700*
097800* THIS SECTION TESTS THE ABILITY TO HAVE ALL THREE DIFFERNT FILE
097900* TYPES OPENED AND USED AT THE SAME TIME .
098000*
098100 READ-TEST-F2-01-01.
098200     MOVE ZEROES TO REC-CT.
098300     OPEN INPUT RL-FR1.
098400     OPEN INPUT IX-FS1.
098500     OPEN INPUT SQ-FS1.
098600     MOVE    "OPEN ALL - SEPARATE" TO FEATURE.
098700     MOVE    "READ-TEST-F2-01-02" TO PAR-NAME.
098800 READ-TEST-F2-01-02.
098900*
099000* READ-TEST-F2-01-02 - THIS TESTS THE ABILITY TO READ ALL THREE
099100*                      TYPES OF FILES IN ANY ORDER WITH ALL OF THE
099200*                      FILES OPEN AT ONCE .
099300*
099400     MOVE ZERO TO RL-KEY.
099500     ADD 001 TO RL-KEY.
099600     READ SQ-FS1 INTO IX-FS1R1-F-G-241 AT END GO TEST-FINISH-EXIT.
099700     READ IX-FS1
099800         INVALID KEY
099900         MOVE "1ST IX-FS1 READ - KEY SHOULD BE 001" TO RE-MARK
100000         PERFORM FAIL
100100         PERFORM PRINT-DETAIL
100200         GO TO READ-TEST-F2-01-02-END.
100300     READ RL-FR1
100400         INVALID KEY
100500         MOVE "1ST RL-FS1 READ - KEY SHOULD BE 001" TO RE-MARK
100600         PERFORM FAIL
100700         PERFORM PRINT-DETAIL
100800         GO TO READ-TEST-F2-01-02-END.
100900     READ SQ-FS1 AT END GO TO TEST-FINISH-EXIT.
101000     READ SQ-FS1 AT END GO TO TEST-FINISH-EXIT.
101100     READ RL-FR1
101200         INVALID KEY
101300         MOVE "2ND IX-FS1 READ - KEY SHOULD BE 001" TO RE-MARK
101400         PERFORM FAIL
101500         PERFORM PRINT-DETAIL
101600         GO TO READ-TEST-F2-01-02-END.
101700     READ IX-FS1
101800         INVALID KEY
101900         MOVE "2ND RL-FR1 READ - KEY SHOULD BE 001" TO RE-MARK
102000         PERFORM FAIL
102100         PERFORM PRINT-DETAIL
102200         GO TO READ-TEST-F2-01-02-END.
102300     READ SQ-FS1 AT END GO TO TEST-FINISH-EXIT.
102400     PERFORM PASS.
102500     PERFORM PRINT-DETAIL.
102600 READ-TEST-F2-01-02-END.
102700     CLOSE RL-FR1.
102800     CLOSE IX-FS1.
102900     CLOSE SQ-FS1.
103000 READ-INIT-F2-02.
103100     OPEN I-O IX-FS1 SQ-FS1 RL-FR1.
103200 READ-TEST-F2-02.
103300     READ SQ-FS1 AT END GO TO TEST-FINISH-EXIT.
103400 READ-WRITE-F2-02.
103500     CLOSE RL-FR1 IX-FS1 SQ-FS1.
103600     MOVE    "R-I-S " TO XFILE-NAME           (1).
103700     MOVE    ZERO     TO  XRECORD-NUMBER      (1).
103800     MOVE    "AL"     TO  XFILE-ORGANIZATION  (1).
103900     MOVE    "OPEN ALL 3 IN 1 LINE" TO FEATURE.
104000     MOVE    "READ-TEST-F2-02   " TO PAR-NAME.
104100     PERFORM PASS.
104200     PERFORM PRINT-DETAIL.
104300******************************************************************
104400 SECT-0004-RIS101 SECTION.
104500*
104600* THIS SECTION TESTS THE ABILITY TO DELETE RECORDS FROM ONE FILE
104700* TYPE WHILE HAVING THE OTHER FILES OPEN .
104800*
104900 DELETE-TEST-GF-01.
105000*
105100* DELETE-TEST-GF-01-01 -IN THIS TEST RECORD NUMBER 121 IS DELETED
105200*                  THE RELATIVE FILE . THE FILE IS THEN CLOSED .
105300*                   THE RELATIVE FILE IS THEN RE-OPENED AND
105400*                   READ EXPECTING TO FIND 122 VALID RECORDS
105500*                   AND AN INVALID KEY FOR WHAT USED TO BE
105600*                   THE 122ND RECORD.  RL-FR1-RECKEY-11-13
105700*                   IS CHECKED TO SEE IF RECORD 123 IS READ
105800*                   AS IT SHOULD BE.
105900*
106000     OPEN I-O IX-FS1 RL-FR1 SQ-FS1.
106100     MOVE    ZERO TO IX-FS1-KEY-11-13.
106200     MOVE    ZERO TO RL-KEY.
106300     MOVE    ZERO TO INVKEY-COUNTER-RL.
106400     MOVE    ZERO TO INVKEY-COUNTER-IX.
106500     MOVE    121 TO IX-FS1-KEY-11-13.
106600     READ    IX-FS1
106700         INVALID KEY ADD 001 TO INVKEY-COUNTER-IX.
106800     ADD     121 TO RL-KEY.
106900     MOVE    "R-I-S " TO XFILE-NAME           (1)
107000     MOVE    ZERO     TO  XRECORD-NUMBER      (1)
107100     MOVE    "RL"     TO  XFILE-ORGANIZATION  (1)
107200     MOVE    "DELETE RL RECORD" TO FEATURE
107300     MOVE    "DELETE-TEST-GF-01   " TO PAR-NAME
107400     DELETE RL-FR1
107500         INVALID KEY PERFORM FAIL
107600         PERFORM PRINT-DETAIL
107700         GO TO DELETE-TEST-GF-01-END.
107800     CLOSE RL-FR1.
107900     OPEN INPUT RL-FR1.
108000     MOVE ZERO TO RL-KEY.
108100     PERFORM DELETE-TEST-GF-01-02-R2 122 TIMES.
108200 DELETE-TEST-GF-01-02-R2.
108300     ADD   1 TO RL-KEY.
108400     READ RL-FR1 INVALID KEY
108500           ADD 1 TO INVKEY-COUNTER-RL.
108600 DELETE-TEST-GF-01-02-CK.
108700     IF RL-FR1-KEY-11-13 EQUAL TO 123
108800        ADD 1 TO INVKEY-COUNTER-RL.
108900        IF
109000           INVKEY-COUNTER-RL EQUAL TO 2
109100           PERFORM PASS ELSE
109200           MOVE "VII-19 4.3.2                        " TO RE-MARK
109300           PERFORM FAIL.
109400     PERFORM PRINT-DETAIL.
109500 DELETE-TEST-GF-01-END.
109600     CLOSE RL-FR1 IX-FS1 SQ-FS1.
109700******************************************************************
109800 SECT-TEST-005-RIS101 SECTION.
109900*
110000* THIS SECTION TESTS THE ABILITY TO REWRITE A FILE WHILE OTHER
110100* FILES ARE BEING MANIPULATED .
110200*
110300 REWRITE-INIT-GF-01.
110400     OPEN I-O SQ-FS1 IX-FS1 RL-FR1.
110500     MOVE ZEROES TO RL-KEY.
110600     ADD 003 TO RL-KEY.
110700     MOVE    ZERO TO INVKEY-COUNTER-RL.
110800     MOVE    ZERO TO INVKEY-COUNTER-IX.
110900 REWRITE-TEST-GF-01.
111000*
111100* REWRITE-TEST-GF-01:TESTS THE ABILITY TO REWRITE A RELATIVE FILE
111200*                    WHILE ALSO MANIPULATING DATA FROM AN INEXED
111300*                    FILE .
111400*
111500 READ-INIT-RL.
111600     READ RL-FR1
111700         INVALID KEY
111800         MOVE    "READ RL RECORD" TO FEATURE
111900         MOVE    "READ-INIT-RL      " TO PAR-NAME
112000     PERFORM FAIL PERFORM PRINT-DETAIL GO REWRITE-TEST-005-END.
112100     MOVE RL-FR1-ALTKEY2-11-13 TO IX-FS1-KEY-11-13.
112200 READ-INIT-IX.
112300     READ IX-FS1
112400         INVALID KEY
112500         MOVE    "READ IX RECORD" TO FEATURE
112600         MOVE    "READ-INIT-IX.      " TO PAR-NAME
112700     PERFORM FAIL PERFORM PRINT-DETAIL GO REWRITE-TEST-005-END.
112800     MOVE RL-FR1-ALTKEY2-11-13 TO IX-FS1-KEY-11-13.
112900     MOVE IX-FS1R1-F-G-241 TO RL-FR1R1-F-G-241.
113000     REWRITE RL-FR1R1-F-G-241
113100         INVALID KEY
113200         MOVE    "REWRITE RL RECORD" TO FEATURE
113300         MOVE    "REWRITE-TEST-GF-01"    TO PAR-NAME
113400     PERFORM FAIL PERFORM PRINT-DETAIL GO REWRITE-TEST-005-END.
113500 REWRITE-TEST-005-01-1.
113600     READ RL-FR1
113700         INVALID KEY
113800         MOVE    "READ RL RECORD" TO FEATURE
113900         MOVE    "REWRITE-TEST-005-01-1" TO PAR-NAME
114000       PERFORM FAIL PERFORM PRINT-DETAIL GO REWRITE-TEST-005-END.
114100 REWRITE-TEST-01.
114200     MOVE    "REWRITE RL RECORD" TO FEATURE
114300     MOVE    "REWRITE-TEST-GF-01"    TO PAR-NAME.
114400     IF RL-FR1-KEY-11-13 NOT EQUAL 78
114500         PERFORM FAIL
114600         MOVE RL-FR1-KEY-11-13 TO COMPUTED-A
114700         MOVE "78" TO CORRECT-A
114800         PERFORM PRINT-DETAIL
114900         MOVE     RL-FR1-REC-120 TO DUMMY-RECORD
115000         PERFORM  WRITE-LINE
115100         MOVE RL-FR1-REC-121-241 TO DUMMY-RECORD
115200         PERFORM WRITE-LINE
115300     ELSE
115400         PERFORM PASS.
115500     PERFORM PRINT-DETAIL.
115600***************************************************************
115700 REWRITE-TEST-GF-02.
115800*
115900* REWRITE-TEST-GF-02   TESTS THE ABILITY TO REWRITE A SEQUENTIAL
116000*                      FILE WHILE WORKING WITH A RELATIVE ALSO .
116100*
116200     PERFORM READ-TEST-F2-02       9 TIMES.
116300     MOVE 15 TO RL-KEY.
116400     READ RL-FR1 INTO SQ-FS1R1-F-G-241
116500         INVALID KEY
116600         MOVE "RL INTO SQ" TO FEATURE
116700         MOVE "REWRITE-TEST-GF-02I" TO PAR-NAME
116800         MOVE "VIII-26 4.5.2                         " TO RE-MARK
116900         PERFORM FAIL
117000         PERFORM PRINT-DETAIL
117100         GO TEST-FINISH-EXIT.
117200     MOVE "REWRITE-TEST-GF-02 " TO PAR-NAME.
117300     MOVE "REWRITE SQ" TO FEATURE.
117400     REWRITE SQ-FS1R1-F-G-241.
117500     CLOSE SQ-FS1.
117600     OPEN I-O SQ-FS1.
117700     PERFORM READ-TEST-F2-02       9 TIMES.
117800     IF SQ-FS1-ALTKEY2-11-13 EQUAL TO  "090"
117900         PERFORM PASS
118000     ELSE
118100         PERFORM FAIL
118200         MOVE "90" TO CORRECT-A
118300         MOVE SQ-FS1-KEY-11-13 TO COMPUTED-A.
118400     PERFORM PRINT-DETAIL.
118500********* END OF 005-02 REWRITE SQ RECORD ************************
118600 REWRITE-TEST-GF-03.
118700*
118800* REWRITE-TEST-GF-03  TESTS THE ABILITY TO REWRITE AN INDEXED FILE
118900*                      WHILE ALSO READING A RELATIVE FILE .
119000*
119100     MOVE 15 TO RL-KEY.
119200     MOVE "077" TO IX-FS1-KEY-11-13.
119300     MOVE "REWRITE-TEST-GF-03 " TO PAR-NAME.
119400     MOVE "REWRITE IX" TO FEATURE.
119500     READ IX-FS1
119600         INVALID KEY
119700         MOVE    "READ IX RECORD" TO FEATURE
119800       PERFORM FAIL PERFORM PRINT-DETAIL GO REWRITE-TEST-005-END.
119900     READ RL-FR1
120000         INVALID KEY
120100         MOVE "READ RL TO PASS TO IX" TO RE-MARK
120200         PERFORM FAIL
120300         PERFORM PRINT-DETAIL
120400         GO REWRITE-TEST-005-END.
120500     REWRITE IX-FS1R1-F-G-241 FROM RL-FR1R1-F-G-241
120600         INVALID KEY
120700         MOVE "REWRITE IX STATEMENT" TO RE-MARK
120800         PERFORM FAIL
120900         PERFORM PRINT-DETAIL
121000         GO TO REWRITE-TEST-005-END.
121100     MOVE "015" TO IX-FS1-KEY-11-13.
121200     READ IX-FS1
121300         INVALID KEY
121400         MOVE "RE-READ IX FOR CHECK" TO RE-MARK
121500         PERFORM FAIL
121600         PERFORM PRINT-DETAIL
121700         GO REWRITE-TEST-005-END.
121800     IF IX-FS1-ALTKEY2-11-13 EQUAL TO "090"
121900         PERFORM PASS
122000     ELSE
122100         MOVE IX-FS1-REC-120 TO DUMMY-RECORD
122200         PERFORM WRITE-LINE
122300         MOVE IX-FS1-REC-121-241 TO DUMMY-RECORD
122400         PERFORM WRITE-LINE
122500         PERFORM FAIL.
122600     PERFORM PRINT-DETAIL.
122700 REWRITE-TEST-005-END.
122800     CLOSE SQ-FS1 IX-FS1 RL-FR1.
122900 TEST-FINISH-EXIT.
123000     EXIT.
123100 CCVS-EXIT SECTION.
123200 CCVS-999999.
123300     GO TO CLOSE-FILES.
