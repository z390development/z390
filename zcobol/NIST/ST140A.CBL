000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST140A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*
001400*    OBJECTIVE -
001500*        ROUTINE ST210  IS A TEST OF THE MERGE STATEMENT USING
001600*    THE ASCII COLLATING SEQUENCE AND MULTIPLE FILE TAPE.
001700*    THIS ROUTINE IS A TEST OF THE COMPILERS ABILITY TO MERGE
001800*    THE SECOND FILE OF A MULTI-FILE REEL WITH A MASS-STORAGE
001900*    FILE TO PRODUCE A MASS-STORAGE FILE.
002000*
002100*
002200*    FEATURES TESTED -
002300*    *   ALPHABET-NAME IS STANDARD-1 (THE ASCII COLLATING SEQ.)
002400*    *   COLLATING SEQUENCE IS ALPHABET-NAME
002500*    *   MULTIPLE FILE TAPE
002600*    *   FIXED LENGTH RECORDS
002700*    *   SAME SORT AREA IN THE I-O-CONTROL PARAGRAPH
002800*    *   QUALIFIED ALPHANUMERIC AND NUMERIC SORT KEYS
002900*    *   USING FILE-NAME SERIES
003000*    *   OUTPUT PROCEDURE IS SECTION-NAME
003100*    *   RETURN RECORD INTO     PART OF THE OUTPUT PROCEDURE
003200*
003300*    *   MERGE MERGE-FILE-NAME
003400*        ON DESCENDING KEY KEY-1 OF DATA-NAME-1
003500*        ASCENDING KEY-2 OF DATA-NAME-2
003600*        COLLATING SEQUENCE IS ALPHABET-NAME
003700*        OUTPUT PROCEDURE IS SECTION-NAME.
003800*
003900*
004000*
004100*
004200*    FILES USED -
004300*    *   FILES SQ-FS1 AND SQ-FS3 ARE WRITTEN ONTO A MULTIPLE
004400*    FILE TAPE.  FILE SQ-FS2 IS WRITTEN ONTO MASS-STORAGE.
004500*    THEN THE MERGE STATEMENT USES SQ-FS3 AND SQ-FS2 TO CREATE  A
004600*    NEW MASS-STORAGE FILE SQ-FS4.  ALL FILES HAVE FIXED LENGTH
004700*    RECORDS AND 132 CHARACTERS PER RECORD.
004800*
004900*        SQ-FS1
005000*    51 RECORDS
005100*    FIXED LENGTH RECORDS 132 CHARACTERS
005200*    BLOCKED 1
005300*    RESERVE 2 AREAS
005400*
005500*        SQ-FS2
005600*    51 RECORDS
005700*    FIXED LENGTH RECORDS 132 CHARACTERS
005800*    BLOCKED 2
005900*    RESERVE 4 AREAS
006000*
006100*        SQ-FS3
006200*    51 RECORDS
006300*    FIXED LENGTH RECORDS 132 CHARACTERS
006400*    BLOCKED 1
006500*    RESERVE 6 AREAS
006600*
006700*        NOTE THAT FILE SQ-FS3 IS THE SECOND POSITION
006800*    ON A MULTIPLE FILE TAPE.  BOTH FILES SQ-FS1 AND SQ-FS3 ARE
006900*    ON THE SAME MULTIPLE FILE TAPE.
007000*
007100*        SQ-FS4
007200*    FINAL TOTAL OF 102 RECORDS AS A RESULT OF THE MERGE
007300*    FIXED LENGTH RECORDS 132 CHARACTERS
007400*    BLOCKED 3
007500*    RESERVE 4 AREAS
007600*
007700*
007800*    X-CARDS USED  -
007900*    X-XXX008     SQ-FS1
008000*    X-XXX014     SQ-FS2
008100*    X-XXX009     SQ-FS3
008200*    X-XXX015     SQ-FS4
008300*    X-XXX027     MERGE FILE ST-FS1
008400*    X-55         SYSTEM PRINTER NAME.
008500*    X-82         SOURCE COMPUTER NAME.
008600*    X-83         OBJECT COMPUTER NAME.
008700*
008800*
008900*    OPTIONS RECOMMENDED -
009000*    *   *OPT8  X  TO BE USED IF NECESSARY TO DUMP THE
009100*                  FILES AS THEY ARE CREATED AND READ DURING
009200*                  MRG-TESTS 3 THRU 8.
009300*
009400*
009500*    TEST DESCRIPTIONS -
009600*    BLD-TEST-001     CHECKS THE CREATION OF SQ-FS1
009700*    BLD-TEST-002     CHECKS THE CREATION OF SQ-FS2
009800*    BLD-TEST-003     CHECKS THE CREATION OF SQ-FS3
009900*    MRG-TEST-003     TESTS RECORDS 1-20 ON MERGE RESULT SQ-FS4
010000*    MRG-TEST-004     TESTS RECORDS 21-40 ON MERGE RESULT SQ-FS4
010100*    MRG-TEST-005     TESTS RECORDS 41-60 ON MERGE RESULT SQ-FS4
010200*    MRG-TEST-006     TESTS RECORDS 61-80 ON MERGE RESULT SQ-FS4
010300*    MRG-TEST-007     TESTS RECORDS 81-100 ON MERGE RESULT SQ-FS4
010400*    MRG-TEST-008     TESTS RECORDS 101-102 ON MERGE RESULT SQ-FS4
010500*    MRG-TEST-009     AN EOF CHECK ON SQ-FS4
010600*    MRG-TEST-010     CHECK THAT THE NUMERIC KEY ON THE LAST
010700*                     RECORD ON SQ-FS4 EQUALS 102
010800*
010900*
011000*    ************************************************************
011100 ENVIRONMENT DIVISION.
011200 CONFIGURATION SECTION.
011300 SOURCE-COMPUTER.
011400     XXXXX082.
011500 OBJECT-COMPUTER.
011600     XXXXX083.
011700 SPECIAL-NAMES.
011800     ALPHABET MY-FAVORITE-ALPHABET IS STANDARD-1.
011900 INPUT-OUTPUT SECTION.
012000 FILE-CONTROL.
012100     SELECT PRINT-FILE ASSIGN TO
012200     XXXXX055.
012300     SELECT SQ-FS1 ASSIGN
012400     XXXXX008
012500     ; ORGANIZATION IS SEQUENTIAL
012600     ACCESS MODE SEQUENTIAL
012700     RESERVE 2 AREAS.
012800     SELECT SQ-FS2 ASSIGN TO
012900     XXXXX014
013000     ORGANIZATION IS SEQUENTIAL
013100     ACCESS MODE IS SEQUENTIAL
013200     RESERVE 4 AREAS.
013300     SELECT SQ-FS3 ASSIGN TO
013400     XXXXX009
013500     ORGANIZATION SEQUENTIAL
013600     ; ACCESS MODE IS SEQUENTIAL
013700     RESERVE 6 AREAS.
013800     SELECT SQ-FS4 ASSIGN TO
013900     XXXXX015
014000     ORGANIZATION IS SEQUENTIAL
014100     ; ACCESS MODE IS SEQUENTIAL
014200     RESERVE 4 AREAS.
014300     SELECT ST-FS1 ASSIGN TO
014400     XXXXX027.
014500 I-O-CONTROL.
014600     SAME SORT AREA FOR SQ-FS1 ST-FS1,
014700     MULTIPLE FILE TAPE CONTAINS SQ-FS1 POSITION 1
014800     SQ-FS3 POSITION 2.
014900 DATA DIVISION.
015000 FILE SECTION.
015100 FD  PRINT-FILE.
015200 01  PRINT-REC PICTURE X(120).
015300 01  DUMMY-RECORD PICTURE X(120).
015400 FD  SQ-FS1
015500     LABEL RECORDS STANDARD
015600C    VALUE OF
015700C    XXXXX074
015800C    IS
015900C    XXXXX075
016000G    XXXXX069
016100     BLOCK CONTAINS 1 RECORDS
016200     RECORD CONTAINS 132 CHARACTERS
016300     DATA RECORDS SQ-FS1R1-F-G-132, SQ-FS1R2-F-G-132.
016400 01  SQ-FS1R1-F-G-132.
016500     10 REC-PREAMBLE PIC X(120).
016600     10 REST-OF-1.
016700     20 KEY-1.
016800         30 ALPHAN-KEY PIC X.
016900         30 NUM-KEY PIC 999.
017000     20 KEY-2.
017100         30 ALPHAN-KEY PIC X.
017200         30 NUM-KEY PIC 999.
017300     20 KEY-3.
017400         30 ALPHAN-KEY PIC X.
017500         30 NUM-KEY PIC 999.
017600 01  SQ-FS1R2-F-G-132.
017700     02 FILLER PIC X(120).
017800     02 GARBAGE PIC X(12).
017900 FD  SQ-FS2
018000     LABEL RECORD STANDARD
018100C    VALUE OF
018200C    XXXXX074
018300C    IS
018400C    XXXXX076
018500G    XXXXX069
018600     BLOCK CONTAINS 2 RECORDS
018700     RECORD CONTAINS 132 CHARACTERS
018800     DATA RECORD SQ-FS2R1-F-G-132.
018900 01  SQ-FS2R1-F-G-132.
019000     10 REC-PRE-2 PIC X(120).
019100     10 REST-OF-2.
019200     20 KEY-4.
019300         30 ALPHAN-KEY PIC X.
019400         30 NUM-KEY PIC 999.
019500     20 KEY-5.
019600         30 ALPHAN-KEY PIC X.
019700         30 NUM-KEY PIC 999.
019800     20 KEY-6.
019900         30 ALPHAN-KEY PIC X.
020000         30 NUM-KEY PIC 999.
020100 FD  SQ-FS3
020200     LABEL RECORDS STANDARD
020300C    VALUE OF
020400C    XXXXX074
020500C    IS
020600C    XXXXX077
020700G    XXXXX069
020800     BLOCK CONTAINS 1 RECORDS
020900     RECORD CONTAINS 132 CHARACTERS
021000     DATA RECORD SQ-FS3R1-F-G-132.
021100 01  SQ-FS3R1-F-G-132.
021200     10 REC-PRE-3 PIC X(120).
021300     10 REST-OF-3.
021400     20 KEY-7.
021500         30 ALPHAN-KEY PIC X.
021600         30 NUM-KEY PIC 999.
021700     20 KEY-8.
021800         30 ALPHAN-KEY PIC X.
021900         30 NUM-KEY PIC 999.
022000     20 KEY-9.
022100         30 ALPHAN-KEY PIC X.
022200         30 NUM-KEY PIC 999.
022300 FD  SQ-FS4
022400     LABEL RECORD IS STANDARD
022500C    ; VALUE OF
022600C    XXXXX074
022700C    IS
022800C    XXXXX078
022900G    XXXXX069
023000     ; BLOCK CONTAINS 3 RECORDS
023100     RECORD CONTAINS 132 CHARACTERS
023200     DATA RECORD SQ-FS4R1-F-G-132.
023300 01  SQ-FS4R1-F-G-132.
023400     10  REC-PRE-4 PIC X(120).
023500     10  REST-OF-4.
023600     20  KEY-10.
023700          30  ALPHAN-KEY PIC X.
023800          30  NUM-KEY PIC 999.
023900     20  KEY-11.
024000          30  ALPHAN-KEY PIC X.
024100          30  NUM-KEY PIC 999.
024200     20  KEY-12.
024300          30  ALPHAN-KEY PIC X.
024400          30  NUM-KEY PIC 999.
024500 SD  ST-FS1
024600     RECORD CONTAINS 132 CHARACTERS
024700     DATA RECORD IS ST-FS1R1-F-G-132.
024800 01  ST-FS1R1-F-G-132.
024900     02 FILLER PIC X(120).
025000     02 NON-KEY-1.
025100         03 A-KEY PIC X.
025200         03 N-KEY PIC 999.
025300     02 SORT-KEY.
025400         03 A-KEY PIC X.
025500         03 N-KEY PIC 999.
025600     02 NON-KEY-2.
025700         03 A-KEY PIC X.
025800         03 N-KEY PIC 999.
025900 WORKING-STORAGE SECTION.
026000 77  WRK-DU-9-0001 PIC 9 VALUE 0.
026100 77  WRK-DU-999-0001 PIC 999.
026200 77  WRK-DU-999-2 PIC 999 VALUE 001.
026300 77  LAST-REC-NUM  PIC 999 VALUE ZERO.
026400 01  WRK-XN-0001 PIC X(51) VALUE
026500     "ZYXWVUTSRQPONMLKJIHGFEDCBA>=<;9876543210/.-,+*)($$ ".
026600 01  WRK-XN-O051F-X-0001 REDEFINES WRK-XN-0001.
026700     02 CHAR PIC X OCCURS 51 TIMES.
026800 01  WRK-XN-2    PIC X(51) VALUE
026900     "ZYXWVUTSRQPONMLKJIHGFEDCBA>=<;9876543210/.-,+*)($$ ".
027000 01  WRK-XN-0051F-X-0002 REDEFINES WRK-XN-2.
027100     02 ASCIIS PIC X OCCURS 51 TIMES.
027200 01  WRK-XN-O020F-0001.
027300     02 COMPU PIC X OCCURS 20 TIMES.
027400 01  WRK-XN-X-0001 REDEFINES WRK-XN-O020F-0001.
027500     02 FILLER PIC X(20).
027600 01  WRK-XN-O120F-1.
027700     02 COLLS PIC X OCCURS 120 TIMES.
027800 01  WRK-XN-X-2 REDEFINES WRK-XN-O120F-1.
027900     02 WRK-XN-0002 PIC X(20).
028000     02 WRK-XN-0003 PIC X(20).
028100     02 WRK-XN-0004 PIC X(20).
028200     02 WRK-XN-0005 PIC X(20).
028300     02 WRK-XN-0006 PIC X(20).
028400     02 WRK-XN-0007 PIC X(20).
028500 01  FILE-RECORD-INFORMATION-REC.
028600     03 FILE-RECORD-INFO-SKELETON.
028700        05 FILLER                 PICTURE X(48)       VALUE
028800             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
028900        05 FILLER                 PICTURE X(46)       VALUE
029000             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
029100        05 FILLER                 PICTURE X(26)       VALUE
029200             ",LFIL=000000,ORG=  ,LBLR= ".
029300        05 FILLER                 PICTURE X(37)       VALUE
029400             ",RECKEY=                             ".
029500        05 FILLER                 PICTURE X(38)       VALUE
029600             ",ALTKEY1=                             ".
029700        05 FILLER                 PICTURE X(38)       VALUE
029800             ",ALTKEY2=                             ".
029900        05 FILLER                 PICTURE X(7)        VALUE SPACE.
030000     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
030100        05 FILE-RECORD-INFO-P1-120.
030200           07 FILLER              PIC X(5).
030300           07 XFILE-NAME           PIC X(6).
030400           07 FILLER              PIC X(8).
030500           07 XRECORD-NAME         PIC X(6).
030600           07 FILLER              PIC X(1).
030700           07 REELUNIT-NUMBER     PIC 9(1).
030800           07 FILLER              PIC X(7).
030900           07 XRECORD-NUMBER       PIC 9(6).
031000           07 FILLER              PIC X(6).
031100           07 UPDATE-NUMBER       PIC 9(2).
031200           07 FILLER              PIC X(5).
031300           07 ODO-NUMBER          PIC 9(4).
031400           07 FILLER              PIC X(5).
031500           07 XPROGRAM-NAME        PIC X(5).
031600           07 FILLER              PIC X(7).
031700           07 XRECORD-LENGTH       PIC 9(6).
031800           07 FILLER              PIC X(7).
031900           07 CHARS-OR-RECORDS    PIC X(2).
032000           07 FILLER              PIC X(1).
032100           07 XBLOCK-SIZE          PIC 9(4).
032200           07 FILLER              PIC X(6).
032300           07 RECORDS-IN-FILE     PIC 9(6).
032400           07 FILLER              PIC X(5).
032500           07 XFILE-ORGANIZATION   PIC X(2).
032600           07 FILLER              PIC X(6).
032700           07 XLABEL-TYPE          PIC X(1).
032800        05 FILE-RECORD-INFO-P121-240.
032900           07 FILLER              PIC X(8).
033000           07 XRECORD-KEY          PIC X(29).
033100           07 FILLER              PIC X(9).
033200           07 ALTERNATE-KEY1      PIC X(29).
033300           07 FILLER              PIC X(9).
033400           07 ALTERNATE-KEY2      PIC X(29).
033500           07 FILLER              PIC X(7).
033600 01  TEST-RESULTS.
033700     02 FILLER                   PIC X      VALUE SPACE.
033800     02 FEATURE                  PIC X(20)  VALUE SPACE.
033900     02 FILLER                   PIC X      VALUE SPACE.
034000     02 P-OR-F                   PIC X(5)   VALUE SPACE.
034100     02 FILLER                   PIC X      VALUE SPACE.
034200     02  PAR-NAME.
034300       03 FILLER                 PIC X(19)  VALUE SPACE.
034400       03  PARDOT-X              PIC X      VALUE SPACE.
034500       03 DOTVALUE               PIC 99     VALUE ZERO.
034600     02 FILLER                   PIC X(8)   VALUE SPACE.
034700     02 RE-MARK                  PIC X(61).
034800 01  TEST-COMPUTED.
034900     02 FILLER                   PIC X(30)  VALUE SPACE.
035000     02 FILLER                   PIC X(17)  VALUE
035100            "       COMPUTED=".
035200     02 COMPUTED-X.
035300     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
035400     03 COMPUTED-N               REDEFINES COMPUTED-A
035500                                 PIC -9(9).9(9).
035600     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
035700     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
035800     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
035900     03       CM-18V0 REDEFINES COMPUTED-A.
036000         04 COMPUTED-18V0                    PIC -9(18).
036100         04 FILLER                           PIC X.
036200     03 FILLER PIC X(50) VALUE SPACE.
036300 01  TEST-CORRECT.
036400     02 FILLER PIC X(30) VALUE SPACE.
036500     02 FILLER PIC X(17) VALUE "       CORRECT =".
036600     02 CORRECT-X.
036700     03 CORRECT-A                  PIC X(20) VALUE SPACE.
036800     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
036900     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
037000     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
037100     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
037200     03      CR-18V0 REDEFINES CORRECT-A.
037300         04 CORRECT-18V0                     PIC -9(18).
037400         04 FILLER                           PIC X.
037500     03 FILLER PIC X(2) VALUE SPACE.
037600     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
037700 01  CCVS-C-1.
037800     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
037900-    "SS  PARAGRAPH-NAME
038000-    "       REMARKS".
038100     02 FILLER                     PIC X(20)    VALUE SPACE.
038200 01  CCVS-C-2.
038300     02 FILLER                     PIC X        VALUE SPACE.
038400     02 FILLER                     PIC X(6)     VALUE "TESTED".
038500     02 FILLER                     PIC X(15)    VALUE SPACE.
038600     02 FILLER                     PIC X(4)     VALUE "FAIL".
038700     02 FILLER                     PIC X(94)    VALUE SPACE.
038800 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
038900 01  REC-CT                        PIC 99       VALUE ZERO.
039000 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
039100 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
039200 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
039300 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
039400 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
039500 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
039600 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
039700 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
039800 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
039900 01  CCVS-H-1.
040000     02  FILLER                    PIC X(39)    VALUE SPACES.
040100     02  FILLER                    PIC X(42)    VALUE
040200     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
040300     02  FILLER                    PIC X(39)    VALUE SPACES.
040400 01  CCVS-H-2A.
040500   02  FILLER                        PIC X(40)  VALUE SPACE.
040600   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
040700   02  FILLER                        PIC XXXX   VALUE
040800     "4.2 ".
040900   02  FILLER                        PIC X(28)  VALUE
041000            " COPY - NOT FOR DISTRIBUTION".
041100   02  FILLER                        PIC X(41)  VALUE SPACE.
041200
041300 01  CCVS-H-2B.
041400   02  FILLER                        PIC X(15)  VALUE
041500            "TEST RESULT OF ".
041600   02  TEST-ID                       PIC X(9).
041700   02  FILLER                        PIC X(4)   VALUE
041800            " IN ".
041900   02  FILLER                        PIC X(12)  VALUE
042000     " HIGH       ".
042100   02  FILLER                        PIC X(22)  VALUE
042200            " LEVEL VALIDATION FOR ".
042300   02  FILLER                        PIC X(58)  VALUE
042400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
042500 01  CCVS-H-3.
042600     02  FILLER                      PIC X(34)  VALUE
042700            " FOR OFFICIAL USE ONLY    ".
042800     02  FILLER                      PIC X(58)  VALUE
042900     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
043000     02  FILLER                      PIC X(28)  VALUE
043100            "  COPYRIGHT   1985 ".
043200 01  CCVS-E-1.
043300     02 FILLER                       PIC X(52)  VALUE SPACE.
043400     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
043500     02 ID-AGAIN                     PIC X(9).
043600     02 FILLER                       PIC X(45)  VALUE SPACES.
043700 01  CCVS-E-2.
043800     02  FILLER                      PIC X(31)  VALUE SPACE.
043900     02  FILLER                      PIC X(21)  VALUE SPACE.
044000     02 CCVS-E-2-2.
044100         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
044200         03 FILLER                   PIC X      VALUE SPACE.
044300         03 ENDER-DESC               PIC X(44)  VALUE
044400            "ERRORS ENCOUNTERED".
044500 01  CCVS-E-3.
044600     02  FILLER                      PIC X(22)  VALUE
044700            " FOR OFFICIAL USE ONLY".
044800     02  FILLER                      PIC X(12)  VALUE SPACE.
044900     02  FILLER                      PIC X(58)  VALUE
045000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
045100     02  FILLER                      PIC X(13)  VALUE SPACE.
045200     02 FILLER                       PIC X(15)  VALUE
045300             " COPYRIGHT 1985".
045400 01  CCVS-E-4.
045500     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
045600     02 FILLER                       PIC X(4)   VALUE " OF ".
045700     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
045800     02 FILLER                       PIC X(40)  VALUE
045900      "  TESTS WERE EXECUTED SUCCESSFULLY".
046000 01  XXINFO.
046100     02 FILLER                       PIC X(19)  VALUE
046200            "*** INFORMATION ***".
046300     02 INFO-TEXT.
046400       04 FILLER                     PIC X(8)   VALUE SPACE.
046500       04 XXCOMPUTED                 PIC X(20).
046600       04 FILLER                     PIC X(5)   VALUE SPACE.
046700       04 XXCORRECT                  PIC X(20).
046800     02 INF-ANSI-REFERENCE           PIC X(48).
046900 01  HYPHEN-LINE.
047000     02 FILLER  PIC IS X VALUE IS SPACE.
047100     02 FILLER  PIC IS X(65)    VALUE IS "************************
047200-    "*****************************************".
047300     02 FILLER  PIC IS X(54)    VALUE IS "************************
047400-    "******************************".
047500 01  CCVS-PGM-ID                     PIC X(9)   VALUE
047600     "ST140A".
047700 PROCEDURE DIVISION.
047800 DECLARATIVES.
047900 SECT-ST210-DEC SECTION.
048000     USE AFTER STANDARD EXCEPTION PROCEDURE ON INPUT.
048100 SRT-WRITE-DEC.
048200     MOVE "ERROR ON OUTPUT DECL." TO FEATURE.
048300     MOVE "SRT-TEST-DEC" TO PAR-NAME.
048400     WRITE   PRINT-REC FROM TEST-RESULTS AFTER ADVANCING 2 LINES.
048500     STOP RUN.
048600 END DECLARATIVES.
048700 CCVS1 SECTION.
048800 OPEN-FILES.
048900     OPEN    OUTPUT PRINT-FILE.
049000     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
049100     MOVE    SPACE TO TEST-RESULTS.
049200     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
049300     MOVE    ZERO TO REC-SKL-SUB.
049400     PERFORM CCVS-INIT-FILE 9 TIMES.
049500 CCVS-INIT-FILE.
049600     ADD     1 TO REC-SKL-SUB.
049700     MOVE    FILE-RECORD-INFO-SKELETON
049800          TO FILE-RECORD-INFO (REC-SKL-SUB).
049900 CCVS-INIT-EXIT.
050000     GO TO CCVS1-EXIT.
050100 CLOSE-FILES.
050200     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
050300 TERMINATE-CCVS.
050400S    EXIT PROGRAM.
050500STERMINATE-CALL.
050600     STOP     RUN.
050700 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
050800 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
050900 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
051000 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
051100     MOVE "****TEST DELETED****" TO RE-MARK.
051200 PRINT-DETAIL.
051300     IF REC-CT NOT EQUAL TO ZERO
051400             MOVE "." TO PARDOT-X
051500             MOVE REC-CT TO DOTVALUE.
051600     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
051700     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
051800        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
051900          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
052000     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
052100     MOVE SPACE TO CORRECT-X.
052200     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
052300     MOVE     SPACE TO RE-MARK.
052400 HEAD-ROUTINE.
052500     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
052600     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
052700     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
052800     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
052900 COLUMN-NAMES-ROUTINE.
053000     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
053100     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
053200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
053300 END-ROUTINE.
053400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
053500 END-RTN-EXIT.
053600     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
053700 END-ROUTINE-1.
053800      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
053900      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
054000      ADD PASS-COUNTER TO ERROR-HOLD.
054100*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
054200      MOVE PASS-COUNTER TO CCVS-E-4-1.
054300      MOVE ERROR-HOLD TO CCVS-E-4-2.
054400      MOVE CCVS-E-4 TO CCVS-E-2-2.
054500      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
054600  END-ROUTINE-12.
054700      MOVE "TEST(S) FAILED" TO ENDER-DESC.
054800     IF       ERROR-COUNTER IS EQUAL TO ZERO
054900         MOVE "NO " TO ERROR-TOTAL
055000         ELSE
055100         MOVE ERROR-COUNTER TO ERROR-TOTAL.
055200     MOVE     CCVS-E-2 TO DUMMY-RECORD.
055300     PERFORM WRITE-LINE.
055400 END-ROUTINE-13.
055500     IF DELETE-COUNTER IS EQUAL TO ZERO
055600         MOVE "NO " TO ERROR-TOTAL  ELSE
055700         MOVE DELETE-COUNTER TO ERROR-TOTAL.
055800     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
055900     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
056000      IF   INSPECT-COUNTER EQUAL TO ZERO
056100          MOVE "NO " TO ERROR-TOTAL
056200      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
056300      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
056400      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
056500     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
056600 WRITE-LINE.
056700     ADD 1 TO RECORD-COUNT.
056800Y    IF RECORD-COUNT GREATER 42
056900Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
057000Y        MOVE SPACE TO DUMMY-RECORD
057100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
057200Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
057300Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
057400Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
057500Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
057600Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
057700Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
057800Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
057900Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
058000Y        MOVE ZERO TO RECORD-COUNT.
058100     PERFORM WRT-LN.
058200 WRT-LN.
058300     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
058400     MOVE SPACE TO DUMMY-RECORD.
058500 BLANK-LINE-PRINT.
058600     PERFORM WRT-LN.
058700 FAIL-ROUTINE.
058800     IF     COMPUTED-X NOT EQUAL TO SPACE
058900            GO TO   FAIL-ROUTINE-WRITE.
059000     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
059100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
059200     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
059300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
059400     MOVE   SPACES TO INF-ANSI-REFERENCE.
059500     GO TO  FAIL-ROUTINE-EX.
059600 FAIL-ROUTINE-WRITE.
059700     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
059800     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
059900     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
060000     MOVE   SPACES TO COR-ANSI-REFERENCE.
060100 FAIL-ROUTINE-EX. EXIT.
060200 BAIL-OUT.
060300     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
060400     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
060500 BAIL-OUT-WRITE.
060600     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
060700     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
060800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
060900     MOVE   SPACES TO INF-ANSI-REFERENCE.
061000 BAIL-OUT-EX. EXIT.
061100 CCVS1-EXIT.
061200     EXIT.
061300 SECT-ST210-0001 SECTION.
061400 BLD-INIT-001.
061500     MOVE "CREATE FILE SQ-FS1" TO FEATURE.
061600     OPEN OUTPUT SQ-FS1.
061700     MOVE "SQ-FS1" TO XFILE-NAME (1).
061800     MOVE "R1-F-G" TO XRECORD-NAME (1).
061900     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
062000     MOVE 000132 TO XRECORD-LENGTH (1).
062100     MOVE "RC" TO CHARS-OR-RECORDS (1).
062200     MOVE 0001 TO XBLOCK-SIZE (1).
062300     MOVE 000051 TO RECORDS-IN-FILE (1).
062400     MOVE "SQ" TO XFILE-ORGANIZATION (1).
062500     MOVE "S" TO XLABEL-TYPE (1).
062600     MOVE 000001 TO XRECORD-NUMBER (1).
062700     MOVE SPACES TO WRK-XN-O120F-1.
062800 BLD-TEST-001.
062900     PERFORM BLD-TEST-001-BUILD VARYING WRK-DU-999-0001
063000         FROM 1 BY 1 UNTIL WRK-DU-999-0001 IS GREATER THAN 51.
063100X    MOVE    SPACES TO PRINT-REC.
063200X    WRITE   PRINT-REC.
063300     IF XRECORD-NUMBER (1) IS NOT EQUAL TO 000052
063400         PERFORM FAIL MOVE "INCORR. NO. OF RECS." TO RE-MARK
063500         ELSE
063600         PERFORM PASS.
063700     GO TO BLD-WRITE-001.
063800 BLD-TEST-001-BUILD.
063900     MOVE "JUNKSLOPJUNK" TO GARBAGE.
064000     MOVE WRK-DU-999-0001 TO NUM-KEY OF KEY-1 NUM-KEY OF KEY-2
064100         NUM-KEY OF KEY-3.
064200     MOVE FILE-RECORD-INFO-P1-120 (1) TO REC-PREAMBLE.
064300     ADD 1 TO XRECORD-NUMBER (1).
064400     MOVE ASCIIS (WRK-DU-999-0001) TO COLLS (WRK-DU-999-2).
064500     ADD 1 TO WRK-DU-999-2.
064600     MOVE ASCIIS (WRK-DU-999-0001) TO COLLS (WRK-DU-999-2).
064700     ADD 1 TO WRK-DU-999-2.
064800X    WRITE PRINT-REC FROM SQ-FS1R1-F-G-132.
064900X    WRITE PRINT-REC FROM REST-OF-1.
065000X    MOVE SPACES TO PRINT-REC.
065100     WRITE   SQ-FS1R1-F-G-132.
065200 BLD-DELETE-001.
065300     PERFORM DE-LETE.
065400 BLD-WRITE-001.
065500     MOVE "BLD-TEST-001" TO PAR-NAME.
065600     MOVE "FIRST FILE CREATED" TO COMPUTED-A.
065700     MOVE XRECORD-NUMBER (1) TO CORRECT-18V0.
065800     PERFORM PRINT-DETAIL.
065900X    MOVE    SPACES TO PRINT-REC.
066000X    WRITE   PRINT-REC.
066100     CLOSE SQ-FS1 WITH NO REWIND.
066200 BLD-INIT-002.
066300     MOVE "CREATE FILE SQ-FS2" TO FEATURE.
066400     OPEN OUTPUT SQ-FS2.
066500     MOVE  "SQ-FS2" TO XFILE-NAME (1).
066600     MOVE 000001 TO XRECORD-NUMBER (1).
066700     MOVE 0002 TO XBLOCK-SIZE (1).
066800 BLD-TEST-002.
066900     PERFORM BLD-TEST-002-BUILD VARYING WRK-DU-999-0001 FROM
067000         1 BY 1 UNTIL WRK-DU-999-0001 IS GREATER THAN 51.
067100X    MOVE    SPACES TO PRINT-REC.
067200X    WRITE   PRINT-REC.
067300     IF XRECORD-NUMBER (1) IS NOT EQUAL TO 000052
067400         PERFORM FAIL MOVE "INCORR. NO. OF RECS." TO RE-MARK
067500         ELSE
067600         PERFORM PASS.
067700     GO TO BLD-WRITE-002.
067800 BLD-TEST-002-BUILD.
067900     MOVE CHAR (WRK-DU-999-0001) TO ALPHAN-KEY OF KEY-4
068000         ALPHAN-KEY OF KEY-5 ALPHAN-KEY OF KEY-6.
068100     ADD 51 WRK-DU-999-0001 GIVING NUM-KEY OF KEY-4
068200         NUM-KEY OF KEY-5 NUM-KEY OF KEY-6.
068300     MOVE FILE-RECORD-INFO-P1-120 (1) TO REC-PRE-2.
068400     ADD 000001 TO XRECORD-NUMBER (1).
068500X    WRITE PRINT-REC FROM SQ-FS2R1-F-G-132.
068600X    WRITE PRINT-REC FROM REST-OF-2.
068700X    MOVE SPACES TO PRINT-REC.
068800     WRITE   SQ-FS2R1-F-G-132.
068900 BLD-DELETE-002.
069000     PERFORM DE-LETE.
069100 BLD-WRITE-002.
069200     MOVE "BLD-TEST-002" TO PAR-NAME.
069300     MOVE "2ND FILE CREATED" TO COMPUTED-A.
069400     MOVE XRECORD-NUMBER (1) TO CORRECT-18V0.
069500     PERFORM PRINT-DETAIL.
069600X    MOVE    SPACES TO PRINT-REC.
069700X    WRITE   PRINT-REC.
069800     CLOSE SQ-FS2.
069900 BLD-INIT-003.
070000     MOVE "CREATE FILE SQ-FS3" TO FEATURE.
070100     MOVE  "SQ-FS3" TO XFILE-NAME (1).
070200     MOVE 000001 TO XRECORD-NUMBER (1).
070300     MOVE 0001 TO XBLOCK-SIZE (1).
070400     OPEN OUTPUT SQ-FS3.
070500 BLD-TEST-003.
070600     PERFORM BLD-TEST-003-BUILD VARYING WRK-DU-999-0001 FROM
070700         1 BY 1 UNTIL WRK-DU-999-0001 IS GREATER THAN 51.
070800X    MOVE    SPACES TO PRINT-REC.
070900X    WRITE   PRINT-REC.
071000     IF XRECORD-NUMBER (1) IS NOT EQUAL TO 52
071100         PERFORM FAIL MOVE "INCORR. NO. OF RECS." TO RE-MARK
071200         ELSE
071300         PERFORM PASS.
071400     GO TO BLD-WRITE-003.
071500 BLD-TEST-003-BUILD.
071600     MOVE CHAR (WRK-DU-999-0001) TO ALPHAN-KEY OF KEY-7
071700         ALPHAN-KEY OF KEY-8 ALPHAN-KEY OF KEY-9.
071800     MOVE WRK-DU-999-0001 TO NUM-KEY OF KEY-7 NUM-KEY OF KEY-8
071900         NUM-KEY OF KEY-9.
072000     MOVE FILE-RECORD-INFO-P1-120 (1) TO REC-PRE-3.
072100     ADD 000001 TO XRECORD-NUMBER (1).
072200X    WRITE PRINT-REC FROM SQ-FS3R1-F-G-132.
072300X    WRITE PRINT-REC FROM REST-OF-3.
072400X    MOVE SPACES TO PRINT-REC.
072500     WRITE   SQ-FS3R1-F-G-132.
072600 BLD-DELETE-003.
072700     PERFORM DE-LETE.
072800 BLD-WRITE-003.
072900     MOVE "BLD-TEST-003" TO PAR-NAME.
073000     MOVE "3RD FILE CREATED" TO COMPUTED-A.
073100     MOVE XRECORD-NUMBER (1) TO CORRECT-18V0.
073200     PERFORM PRINT-DETAIL.
073300X    MOVE    SPACES TO PRINT-REC.
073400X    WRITE   PRINT-REC.
073500     CLOSE SQ-FS3.
073600 MRG-INIT-001.
073700     MERGE ST-FS1
073800         ON DESCENDING KEY A-KEY OF SORT-KEY
073900         ASCENDING N-KEY OF NON-KEY-2
074000     COLLATING SEQUENCE IS MY-FAVORITE-ALPHABET
074100         USING SQ-FS2, SQ-FS3
074200     OUTPUT PROCEDURE IS SECT-ST210-0002.
074300 SRT-TEST-003.
074400     MOVE SPACES TO WRK-XN-X-0001.
074500     OPEN INPUT SQ-FS4.
074600     PERFORM RD-1 THRU R1-EXIT VARYING WRK-DU-999-0001 FROM 1 BY 1
074700         UNTIL WRK-DU-999-0001 IS GREATER THAN 20.
074800X    MOVE    SPACES TO PRINT-REC.
074900X    WRITE   PRINT-REC.
075000     IF WRK-XN-X-0001 IS NOT EQUAL TO WRK-XN-0002
075100         PERFORM FAIL GO TO SRT-FAIL-003
075200         ELSE
075300         PERFORM PASS.
075400     GO TO SRT-WRITE-003.
075500 SRT-DELETE-003.
075600     PERFORM DE-LETE.
075700     GO TO SRT-WRITE-003.
075800 SRT-FAIL-003.
075900     MOVE WRK-XN-X-0001 TO COMPUTED-A.
076000     MOVE WRK-XN-0002 TO CORRECT-A.
076100 SRT-WRITE-003.
076200     MOVE "MRG-TEST-003" TO PAR-NAME.
076300     MOVE "STAN. COLLATING SEQ." TO FEATURE.
076400     PERFORM PRINT-DETAIL.
076500X    MOVE    SPACES TO PRINT-REC.
076600X    WRITE   PRINT-REC.
076700 SRT-INIT-004.
076800     MOVE SPACES TO WRK-XN-X-0001.
076900 SRT-TEST-004.
077000     PERFORM RD-1 THRU R1-EXIT VARYING WRK-DU-999-0001 FROM 1 BY 1
077100         UNTIL WRK-DU-999-0001 IS GREATER THAN 20.
077200X    MOVE    SPACES TO PRINT-REC.
077300X    WRITE   PRINT-REC.
077400     IF WRK-XN-X-0001 IS NOT EQUAL TO WRK-XN-0003
077500         PERFORM FAIL GO TO SRT-FAIL-004
077600         ELSE
077700         PERFORM PASS.
077800     GO TO SRT-WRITE-004.
077900 SRT-DELETE-004.
078000     PERFORM DE-LETE.
078100     GO TO SRT-WRITE-004.
078200 SRT-FAIL-004.
078300     MOVE WRK-XN-X-0001 TO COMPUTED-A.
078400     MOVE WRK-XN-0003 TO CORRECT-A.
078500 SRT-WRITE-004.
078600     MOVE "MRG-TEST-004" TO PAR-NAME.
078700     MOVE "STAN. COLLATING SEQ." TO FEATURE.
078800     PERFORM PRINT-DETAIL.
078900X    MOVE    SPACES TO PRINT-REC.
079000X    WRITE   PRINT-REC.
079100 SRT-INIT-005.
079200     MOVE SPACES TO WRK-XN-X-0001.
079300 SRT-TEST-005.
079400     PERFORM RD-1 THRU R1-EXIT VARYING WRK-DU-999-0001 FROM 1 BY 1
079500         UNTIL WRK-DU-999-0001 IS GREATER THAN 20.
079600X    MOVE    SPACES TO PRINT-REC.
079700X    WRITE   PRINT-REC.
079800     IF WRK-XN-X-0001 IS NOT EQUAL TO WRK-XN-0004
079900         PERFORM FAIL GO TO SRT-FAIL-005
080000         ELSE
080100         PERFORM PASS.
080200     GO TO SRT-WRITE-005.
080300 SRT-DELETE-005.
080400     PERFORM DE-LETE.
080500     GO TO SRT-WRITE-005.
080600 SRT-FAIL-005.
080700     MOVE WRK-XN-X-0001 TO COMPUTED-A.
080800     MOVE WRK-XN-0004 TO CORRECT-A.
080900 SRT-WRITE-005.
081000     MOVE "MRG-TEST-005" TO PAR-NAME.
081100     MOVE "STAN. COLLATING SEQ." TO FEATURE.
081200     PERFORM PRINT-DETAIL.
081300X    MOVE    SPACES TO PRINT-REC.
081400X    WRITE   PRINT-REC.
081500 SRT-INIT-006.
081600     MOVE SPACES TO WRK-XN-X-0001.
081700 SRT-TEST-006.
081800     PERFORM RD-1 THRU R1-EXIT VARYING WRK-DU-999-0001 FROM 1 BY 1
081900         UNTIL WRK-DU-999-0001 IS GREATER THAN 20.
082000X    MOVE    SPACES TO PRINT-REC.
082100X    WRITE   PRINT-REC.
082200     IF WRK-XN-X-0001 IS NOT EQUAL TO WRK-XN-0005
082300         PERFORM FAIL GO TO SRT-FAIL-006
082400         ELSE
082500         PERFORM PASS.
082600     GO TO SRT-WRITE-006.
082700 SRT-DELETE-006.
082800     PERFORM DE-LETE.
082900     GO TO SRT-WRITE-006.
083000 SRT-FAIL-006.
083100     MOVE WRK-XN-X-0001 TO COMPUTED-A.
083200     MOVE WRK-XN-0005 TO CORRECT-A.
083300 SRT-WRITE-006.
083400     MOVE "MRG-TEST-006" TO PAR-NAME.
083500     MOVE "STAN. COLLATING SEQ." TO FEATURE.
083600     PERFORM PRINT-DETAIL.
083700X    MOVE    SPACES TO PRINT-REC.
083800X    WRITE   PRINT-REC.
083900 SRT-INIT-007.
084000     MOVE SPACES TO WRK-XN-X-0001.
084100 SRT-TEST-007.
084200     PERFORM RD-1 THRU R1-EXIT VARYING WRK-DU-999-0001 FROM 1 BY 1
084300         UNTIL WRK-DU-999-0001 IS GREATER THAN 20.
084400X    MOVE    SPACES TO PRINT-REC.
084500X    WRITE   PRINT-REC.
084600     IF WRK-XN-X-0001 IS NOT EQUAL TO WRK-XN-0006
084700         PERFORM FAIL GO TO SRT-FAIL-007
084800         ELSE
084900         PERFORM PASS.
085000     GO TO SRT-WRITE-007.
085100 SRT-DELETE-007.
085200     PERFORM DE-LETE.
085300     GO TO SRT-WRITE-007.
085400 SRT-FAIL-007.
085500     MOVE WRK-XN-X-0001 TO COMPUTED-A.
085600     MOVE WRK-XN-0006 TO CORRECT-A.
085700 SRT-WRITE-007.
085800     MOVE "MRG-TEST-007" TO PAR-NAME.
085900     MOVE "STAN. COLLATING SEQ." TO FEATURE.
086000     PERFORM PRINT-DETAIL.
086100X    MOVE    SPACES TO PRINT-REC.
086200X    WRITE   PRINT-REC.
086300 SRT-INIT-008.
086400     MOVE SPACES TO WRK-XN-X-0001.
086500 SRT-TEST-008.
086600     PERFORM RD-1 THRU R1-EXIT VARYING WRK-DU-999-0001 FROM 1 BY 1
086700         UNTIL WRK-DU-999-0001 IS GREATER THAN 2.
086800X    MOVE    SPACES TO PRINT-REC.
086900X    WRITE   PRINT-REC.
087000     IF WRK-XN-X-0001 IS NOT EQUAL TO WRK-XN-0007
087100         PERFORM FAIL GO TO SRT-FAIL-008
087200         ELSE
087300         PERFORM PASS.
087400     GO TO SRT-WRITE-008.
087500 SRT-DELETE-008.
087600     PERFORM DE-LETE.
087700     GO TO SRT-WRITE-008.
087800 SRT-FAIL-008.
087900     MOVE WRK-XN-X-0001 TO COMPUTED-A.
088000     MOVE WRK-XN-0007 TO CORRECT-A.
088100 SRT-WRITE-008.
088200     MOVE "MRG-TEST-008" TO PAR-NAME.
088300     MOVE "STAN. COLLATING SEQ." TO FEATURE.
088400     PERFORM PRINT-DETAIL.
088500     MOVE    NUM-KEY OF KEY-11 TO LAST-REC-NUM.
088600 SRT-TEST-009.
088700     IF WRK-DU-9-0001 IS NOT EQUAL TO ZERO
088800         GO TO SRT-FAIL-009.
088900     READ SQ-FS4 AT END PERFORM PASS
089000         GO TO SRT-WRITE-009.
089100     GO TO SRT-FAIL-009.
089200 SRT-DELETE-009.
089300     PERFORM DE-LETE.
089400     GO TO SRT-WRITE-009.
089500 SRT-FAIL-009.
089600     MOVE "EOF NOT FOUND" TO RE-MARK.
089700     PERFORM FAIL .
089800 SRT-WRITE-009.
089900     MOVE "EOF CHECK SQ-FS4" TO FEATURE.
090000     MOVE "MRG-TEST-009" TO PAR-NAME.
090100     PERFORM PRINT-DETAIL.
090200 SRT-TEST-010.
090300     IF LAST-REC-NUM IS NOT EQUAL TO 102
090400         PERFORM FAIL GO TO SRT-FAIL-010
090500         ELSE
090600         PERFORM PASS.
090700     GO TO SRT-WRITE-010.
090800 SRT-DELETE-010.
090900     PERFORM DE-LETE.
091000     GO TO SRT-WRITE-010.
091100 SRT-FAIL-010.
091200     MOVE LAST-REC-NUM TO COMPUTED-18V0.
091300     MOVE 102 TO CR-18V0.
091400 SRT-WRITE-010.
091500     MOVE "NUMER. SEQ. CHECK" TO FEATURE.
091600     MOVE "MRG-TEST-010" TO PAR-NAME.
091700     PERFORM PRINT-DETAIL.
091800     CLOSE   SQ-FS4.
091900     GO TO CCVS-999999.
092000 READ-SQ-FS1 SECTION.
092100 RD-1.
092200     IF WRK-DU-9-0001 IS NOT EQUAL TO ZERO
092300         GO TO R1-EXIT.
092400     READ SQ-FS4 AT END GO TO PREMATURE-EOF.
092500     MOVE ALPHAN-KEY OF KEY-12 TO COMPU (WRK-DU-999-0001).
092600     GO TO R1-EXIT.
092700 PREMATURE-EOF.
092800     MOVE 1 TO WRK-DU-9-0001.
092900     MOVE "PREMATURE EOF FOUND" TO RE-MARK.
093000 R1-EXIT.
093100     EXIT.
093200 SECT-ST210-0002 SECTION.
093300 SORT-OUTPUT-PROC.
093400     OPEN OUTPUT SQ-FS4.
093500 RETURN-THE-OLD-RECORDS.
093600     RETURN ST-FS1 RECORD INTO SQ-FS4R1-F-G-132
093700         AT END GO TO CLOSE-AFTER-SORT.
093800X    WRITE PRINT-REC FROM SQ-FS4R1-F-G-132.
093900X    WRITE PRINT-REC FROM REST-OF-4.
094000X    MOVE SPACES TO PRINT-REC.
094100     WRITE   SQ-FS4R1-F-G-132.
094200     GO TO RETURN-THE-OLD-RECORDS.
094300 CLOSE-AFTER-SORT.
094400     CLOSE SQ-FS4.
094500 CCVS-EXIT SECTION.
094600 CCVS-999999.
094700     GO TO CLOSE-FILES.
