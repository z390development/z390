000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ208M.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    " HIGH       ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "4.2 ".
001100*                                                              *
001200*        THE ROUTINE SQ208M TESTS THE USE OF THE LEVEL 2 WRITE
001300*    STATEMENT AND THE LINAGE CLAUSE FOR A FILE DESIGNATED AS
001400*    PRINTER OUTPUT.  THESE STATEMENTS CONTROL THE VERTICAL
001500*    POSITIONING OF EACH LINE ON A PRINTED PAGE.  THE LINAGE
001600*    CLAUSE SPECIFICALLY CONTROLS THE VERTICAL FORMAT OF A LOGICAL
001700*    PRINT PAGE. SQ208M TESTS THE USE OF DATA-NAMES IN THE LINAGE,
001800*    FOOTING, TOP, AND BOTTOM PHRASES.  VALUES OF DATA-NAMES ARE
001900*    CHANGED IN ORDER TO CHECK REDEFINITION OF LOGICAL PAGE
002000*    FORMATS AFTER OVERFLOW OR WRITE ADVANCING PAGE OPERATIONS.
002100*    IT IS ASSUMED THAT ALL LEVEL 2 NUCLEUS OPTIONS ARE AVAILABLE
002200*    IN TESTING SQ208M.
002300*        BECAUSE OF THE NATURE OF THESE TESTS A "PASS" OR "FAIL"
002400*    CANNOT BE DETERMINED WITHIN THE PROGRAM.  THE USER MUST
002500*    VISUALLY CHECK THE POSITION OF EACH LINE TO DETERMINE THE
002600*    ACCURACY OF THE VARIOUS WRITE AND LINAGE OPTIONS.
002700 ENVIRONMENT DIVISION.
002800 CONFIGURATION SECTION.
002900 SOURCE-COMPUTER.
003000     XXXXX082.
003100 OBJECT-COMPUTER.
003200     XXXXX083.
003300 INPUT-OUTPUT SECTION.
003400 FILE-CONTROL.
003500P    SELECT RAW-DATA   ASSIGN TO
003600P    XXXXX062
003700P           ORGANIZATION IS INDEXED
003800P           ACCESS MODE IS RANDOM
003900P           RECORD KEY IS RAW-DATA-KEY.
004000     SELECT PRINT-FILE ASSIGN TO
004100     XXXXX055.
004200 DATA DIVISION.
004300 FILE SECTION.
004400P
004500PFD  RAW-DATA.
004600P
004700P01  RAW-DATA-SATZ.
004800P    05  RAW-DATA-KEY        PIC X(6).
004900P    05  C-DATE              PIC 9(6).
005000P    05  C-TIME              PIC 9(8).
005100P    05  C-NO-OF-TESTS       PIC 99.
005200P    05  C-OK                PIC 999.
005300P    05  C-ALL               PIC 999.
005400P    05  C-FAIL              PIC 999.
005500P    05  C-DELETED           PIC 999.
005600P    05  C-INSPECT           PIC 999.
005700P    05  C-NOTE              PIC X(13).
005800P    05  C-INDENT            PIC X.
005900P    05  C-ABORT             PIC X(8).
006000 FD  PRINT-FILE
006100C    LABEL RECORDS
006200C    XXXXX084
006300C    DATA RECORD IS PRINT-REC DUMMY-RECORD
006400     LINAGE LINAGE-CTR
006500              FOOTING FOOT-CTR
006600              TOP TOP-CTR
006700              BOTTOM BOTTOM-CTR.
006800 01  PRINT-REC PICTURE X(120).
006900 01  DUMMY-RECORD PICTURE X(120).
007000 WORKING-STORAGE SECTION.
007100 77  LINAGE-CTR         PIC 999      VALUE 66.
007200 01  FOOT-CTR           PIC 999      VALUE 66.
007300 01  SPACING-CTR.
007400     02 TOP-CTR         PIC 999      VALUE 0.
007500     02 BOTTOM-CTR      PIC 999      VALUE 0.
007600 01  DETAIL-LINE-1.
007700     02 FILLER          PIC X(20)    VALUE SPACE.
007800     02 FILLER          PIC X(13)    VALUE "THIS IS LINE ".
007900     02 DL1-LINE-NO     PIC 999.
008000     02 FILLER          PIC X(4)     VALUE " OF ".
008100     02 DL1-TOTAL-LINES PIC 999.
008200     02 FILLER          PIC X(34)    VALUE " DETAIL LINES.  LINAGE
008300-                                          "-COUNTER IS ".
008400     02 DL1-LC          PIC 999.
008500     02 FILLER          PIC X(40)    VALUE ".".
008600 01  DETAIL-LINE-2.
008700     02 FILLER          PIC X(20)    VALUE SPACE.
008800     02 FILLER          PIC X(13)    VALUE "THIS IS LINE ".
008900     02 DL2-LINE-NO     PIC 999.
009000     02 FILLER          PIC X(41)    VALUE " OF 010 DETAIL LINES.
009100-    " LINAGE-COUNTER IS ".
009200     02 DL2-LC          PIC 999.
009300     02 FILLER          PIC X(40)    VALUE ".".
009400 01  DETAIL-LINE-3.
009500     02 FILLER          PIC X(20)    VALUE SPACE.
009600     02 FILLER          PIC X(13)    VALUE "THIS IS LINE ".
009700     02 DL3-LINE-NO     PIC 99.
009800     02 FILLER          PIC X(40)    VALUE " OF 60 DETAIL LINES.
009900-    "LINAGE-COUNTER IS ".
010000     02 DL3-LC          PIC 999.
010100     02 FILLER          PIC X(42)    VALUE ".".
010200 01  FOOT-LINE-1.
010300     02 FILLER          PIC X(20)    VALUE SPACE.
010400     02 FILLER          PIC X(57)    VALUE "THIS IS LINE 001 OF 00
010500-    "1 FOOTING LINES. LINAGE-COUNTER IS ".
010600     02 FL1-LC          PIC 999.
010700     02 FILLER          PIC X(40)    VALUE ".".
010800 01  FOOT-LINE-3.
010900     02 FILLER          PIC X(103)   VALUE "THIS LINE WAS PRINTED
011000-    "FROM AN EOP CLAUSE.  THE VALUE OF THE LINAGE-COUNTER PRIOR T
011100-    "O THIS EXECUTION IS ".
011200     02 FL3-LC          PIC 999.
011300     02 FILLER          PIC X(14)    VALUE ".".
011400 01  INFO-LINE-1        PIC X(120)   VALUE "THIS TEST IS DESIGNED
011500-    "TO TEST THE OVERFLOW RESULTS OF A WRITE BEFORE ADVANCING OPE
011600-    "RATION CONTAINING AN EOP PHRASE.".
011700 01  INFO-LINE-2        PIC X(120)   VALUE "THIS TEST IS DESIGNED
011800-    "TO TEST THE OVERFLOW RESULTS OF A WRITE AFTER ADVANCING OPER
011900-    "ATION CONTAINING AN EOP PHRASE.".
012000 01  INFO-LINE-3        PIC X(120)   VALUE "FOR THIS TEST LINAGE A
012100-    "ND FOOTING VALUES ARE 40.".
012200 01  INFO-LINE-4        PIC X(120)   VALUE "39 DETAIL LINES SHOULD
012300-    " PRINT ON THE 1ST LOGICAL PAGE AND THE REMAINING 21 DETAIL L
012400-    "INES ON THE 2ND LOGICAL PAGE.".
012500 01  INFO-LINE-6        PIC X(120)   VALUE "THE EOP LINE SHOULD FO
012600-    "LLOW DETAIL LINE 39 AND BE THE LAST LINE ON THE 1ST LOGICAL
012700-    "PAGE.".
012800 01  INFO-LINE-7        PIC X(120)   VALUE "THE EOP LINE SHOULD FO
012900-    "LLOW DETAIL LINE 39 AND BE THE FIRST LINE ON THE 2ND LOGICAL
013000-    " PAGE.".
013100 01  INFO-LINE-8        PIC X(120)   VALUE "ALL LINAGE-COUNTER VAL
013200-    "UES REPRESENT VALUES PRIOR TO EXECUTION OF THE WRITE OPERATI
013300-    "ON.  NO MODIFICATIONS HAVE BEEN MADE.".
013400 01  COMMENT-LINE-1     PIC X(120)   VALUE "BECAUSE OF THE NATURE
013500-    "OF THESE TESTS A PASS OR FAIL CANNOT BE DETERMINED WITHIN TH
013600-    "E PROGRAM.  THE USER MUST VISUALLY".
013700 01  COMMENT-LINE-2     PIC X(120)   VALUE "CHECK THE POSITION OF
013800-    "EACH LINE TO DETERMINE THE ACCURACY OF THE VARIOUS WRITE OPT
013900-    "IONS. VII-22, 3.2.2 LINAGE, VII-27-29".
014000 01  COMMENT-LINE-3     PIC X(120)   VALUE "IN THIS TEST THE FIRST
014100-    " LOGICAL PAGE SHOULD CONTAIN 65 DETAIL LINES.".
014200 01  COMMENT-LINE-4     PIC X(120)   VALUE "1 FOOTING LINE AND BE
014300-    "FOLLOWED BY 1 BLANK LINE.  ALL SUCCEEDING LOGICAL PAGES SHOU
014400-    "LD CONTAIN 29 DETAIL LINES, 1 FOOTING".
014500 01  COMMENT-LINE-5     PIC X(120)   VALUE "LINE AND BE SEPARATED
014600-    "BY 3 BLANK LINES".
014700 01  COMMENT-LINE-6     PIC X(120)   VALUE "IN THIS TEST THE FIRST
014800-    " LOGICAL PAGE SHOULD CONTAIN 19 DETAIL LINES, 1 FOOTING LINE
014900-    ", BE PRECEDED BY 2 BLANK LINES, AND".
015000 01  COMMENT-LINE-7     PIC X(120)   VALUE "BE FOLLOWED BY 4 BLANK
015100-    " LINES.  ALL SUCCEEDING LOGICAL PAGES SHOULD CONTAIN 39 DETA
015200-    "IL LINES, 1 FOOTING LINE, AND BE".
015300 01  COMMENT-LINE-8     PIC X(120)   VALUE "SEPARATED BY 3 BLANK L
015400-    "INES.".
015500 01  COMMENT-LINE-9     PIC X(120)   VALUE "IN THIS TEST THE FIRST
015600-    " LOGICAL PAGE SHOULD CONTAIN 15 DETAIL LINES, BE PRECEDED BY
015700-    " 2 BLANK LINES, AND BE FOLLOWED BY".
015800 01  COMMENT-LINE-10    PIC X(120)   VALUE "9 BLANK LINES.  ALL SU
015900-    "CCEEDING LOGICAL PAGES SHOULD CONTAIN 40 DETAIL LINES AND BE
016000-    " SEPARATED BY 3 BLANK LINES.".
016100 01  COMMENT-LINE-11    PIC X(120)   VALUE "THIS TEST IS DESIGNED
016200-    "TO TEST THE MINIMUM LINAGE VALUE OF 1 AND THE MINIMUM TOP VA
016300-    "LUE OF ZERO.  EACH LOGICAL PAGE SHOULD".
016400 01  COMMENT-LINE-12    PIC X(120)   VALUE "CONTAIN 1 DETAIL LINE
016500-    "AND BE SEPARATED BY 2 BLANK LINES.  THE FIRST PAGE SHOULD NO
016600-    "T BE PRECEDED BY ANY BLANK LINES.".
016700 01  COMMENT-LINE-13    PIC X(120)   VALUE "THIS TEST IS DESIGNED
016800-    "TO TEST THE MINIMUM FOOTING LINE VALUE OF 1 AND MINIMUM BOTT
016900-    "OM VALUE OF ZERO.  EACH LOGICAL PAGE".
017000 01  COMMENT-LINE-14    PIC X(120)   VALUE "SHOULD CONTAIN 1 DETAI
017100-    "L LINE, 1 FOOTING LINE, AND BE SEPARATED BY 1 BLANK LINE.".
017200 01  LAST-LINE          PIC X(120)   VALUE "THIS IS THE LAST LINE
017300-    "IN THE PAGE BODY OF THIS LOGICAL PAGE.  USE IT AS A REFERENC
017400-    "E POINT FOR THE FOLLOWING TEST PAGES.".
017500 01  TEST-RESULTS.
017600     02 FILLER                    PICTURE X VALUE SPACE.
017700     02 FEATURE                   PICTURE X(20) VALUE SPACE.
017800     02 FILLER                    PICTURE X VALUE SPACE.
017900     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
018000     02 FILLER                    PICTURE X  VALUE SPACE.
018100     02  PAR-NAME.
018200       03 FILLER PICTURE X(12) VALUE SPACE.
018300       03  PARDOT-X PICTURE X  VALUE SPACE.
018400       03 DOTVALUE PICTURE 99  VALUE ZERO.
018500       03 FILLER PIC X(5) VALUE SPACE.
018600     02 FILLER PIC X(10) VALUE SPACE.
018700     02 RE-MARK PIC X(61).
018800 01  TEST-COMPUTED.
018900     02 FILLER PIC X(30) VALUE SPACE.
019000     02 FILLER PIC X(17) VALUE "       COMPUTED=".
019100     02 COMPUTED-X.
019200     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
019300     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
019400     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
019500     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
019600     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
019700     03       CM-18V0 REDEFINES COMPUTED-A.
019800         04 COMPUTED-18V0                   PICTURE -9(18).
019900         04 FILLER                          PICTURE X.
020000     03 FILLER PIC X(50) VALUE SPACE.
020100 01  TEST-CORRECT.
020200     02 FILLER PIC X(30) VALUE SPACE.
020300     02 FILLER PIC X(17) VALUE "       CORRECT =".
020400     02 CORRECT-X.
020500     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
020600     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
020700     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
020800     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
020900     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
021000     03      CR-18V0 REDEFINES CORRECT-A.
021100         04 CORRECT-18V0                    PICTURE -9(18).
021200         04 FILLER                          PICTURE X.
021300     03 FILLER PIC X(50) VALUE SPACE.
021400 01  CCVS-C-1.
021500     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
021600-    "SS  PARAGRAPH-NAME
021700-    "        REMARKS".
021800     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
021900 01  CCVS-C-2.
022000     02 FILLER PICTURE IS X VALUE IS SPACE.
022100     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
022200     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
022300     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
022400     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
022500 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
022600 01  REC-CT PICTURE 99 VALUE ZERO.
022700 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
022800 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
022900 01  INSPECT-COUNTER PIC 999 VALUE 7.
023000 01  PASS-COUNTER PIC 999 VALUE ZERO.
023100 01  TOTAL-ERROR PIC 999 VALUE ZERO.
023200 01  ERROR-HOLD PIC 999 VALUE ZERO.
023300 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
023400 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
023500 01  CCVS-H-1.
023600     02  FILLER   PICTURE X(27)  VALUE SPACE.
023700     02 FILLER PICTURE X(67) VALUE
023800     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
023900-    " SYSTEM".
024000     02  FILLER     PICTURE X(26)  VALUE SPACE.
024100 01  CCVS-H-2.
024200     02 FILLER PICTURE X(52) VALUE IS
024300     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
024400     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
024500     02 TEST-ID PICTURE IS X(9).
024600     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
024700 01  CCVS-H-3.
024800     02  FILLER PICTURE X(34) VALUE
024900     " FOR OFFICIAL USE ONLY    ".
025000     02  FILLER PICTURE X(58) VALUE
025100     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
025200     02  FILLER PICTURE X(28) VALUE
025300     "  COPYRIGHT   1985 ".
025400 01  CCVS-E-1.
025500     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
025600     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
025700     02 ID-AGAIN PICTURE IS X(9).
025800     02 FILLER PICTURE X(45) VALUE IS
025900     " NTIS DISTRIBUTION COBOL 85".
026000 01  CCVS-E-2.
026100     02  FILLER                   PICTURE X(31)  VALUE
026200     SPACE.
026300     02  FILLER                   PICTURE X(21)  VALUE SPACE.
026400     02 CCVS-E-2-2.
026500         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
026600         03 FILLER PICTURE IS X VALUE IS SPACE.
026700         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
026800 01  CCVS-E-3.
026900     02  FILLER PICTURE X(22) VALUE
027000     " FOR OFFICIAL USE ONLY".
027100     02  FILLER PICTURE X(12) VALUE SPACE.
027200     02  FILLER PICTURE X(58) VALUE
027300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
027400     02  FILLER PICTURE X(13) VALUE SPACE.
027500     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
027600 01  CCVS-E-4.
027700     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
027800     02 FILLER PIC XXXX VALUE " OF ".
027900     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
028000     02 FILLER PIC X(40) VALUE
028100      "  TESTS WERE EXECUTED SUCCESSFULLY".
028200 01  XXINFO.
028300     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
028400     02 INFO-TEXT.
028500     04 FILLER PIC X(20) VALUE SPACE.
028600     04 XXCOMPUTED PIC X(20).
028700     04 FILLER PIC X(5) VALUE SPACE.
028800     04 XXCORRECT PIC X(20).
028900 01  HYPHEN-LINE.
029000     02 FILLER PICTURE IS X VALUE IS SPACE.
029100     02 FILLER PICTURE IS X(65) VALUE IS "************************
029200-    "*****************************************".
029300     02 FILLER PICTURE IS X(54) VALUE IS "************************
029400-    "******************************".
029500 01  CCVS-PGM-ID PIC X(6) VALUE
029600     "SQ208M".
029700 PROCEDURE DIVISION.
029800 CCVS1 SECTION.
029900 OPEN-FILES.
030000P    OPEN I-O RAW-DATA.
030100P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
030200P    READ RAW-DATA INVALID KEY GO TO END-E-1.
030300P    MOVE "ABORTED " TO C-ABORT.
030400P    ADD 1 TO C-NO-OF-TESTS.
030500P    ACCEPT C-DATE  FROM DATE.
030600P    ACCEPT C-TIME  FROM TIME.
030700P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
030800PEND-E-1.
030900P    CLOSE RAW-DATA.
031000     OPEN     OUTPUT PRINT-FILE.
031100     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
031200     MOVE    SPACE TO TEST-RESULTS.
031300     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
031400     GO TO CCVS1-EXIT.
031500 CLOSE-FILES.
031600     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
031700P    OPEN I-O RAW-DATA.
031800P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
031900P    READ RAW-DATA INVALID KEY GO TO END-E-2.
032000P    MOVE "OK.     " TO C-ABORT.
032100P    MOVE PASS-COUNTER TO C-OK.
032200P    MOVE ERROR-HOLD   TO C-ALL.
032300P    MOVE ERROR-COUNTER TO C-FAIL.
032400P    MOVE DELETE-CNT TO C-DELETED.
032500P    MOVE INSPECT-COUNTER TO C-INSPECT.
032600P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
032700PEND-E-2.
032800P    CLOSE RAW-DATA.
032900 TERMINATE-CCVS.
033000S    EXIT PROGRAM.
033100STERMINATE-CALL.
033200     STOP     RUN.
033300 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
033400 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
033500 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
033600 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
033700     MOVE "****TEST DELETED****" TO RE-MARK.
033800 PRINT-DETAIL.
033900     IF REC-CT NOT EQUAL TO ZERO
034000             MOVE "." TO PARDOT-X
034100             MOVE REC-CT TO DOTVALUE.
034200     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
034300     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
034400        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
034500          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
034600     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
034700     MOVE SPACE TO CORRECT-X.
034800     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
034900     MOVE     SPACE TO RE-MARK.
035000 HEAD-ROUTINE.
035100     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035200     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
035300     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
035400 COLUMN-NAMES-ROUTINE.
035500     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035600     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
035800 END-ROUTINE.
035900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
036000 END-RTN-EXIT.
036100     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036200 END-ROUTINE-1.
036300      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
036400      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
036500      ADD PASS-COUNTER TO ERROR-HOLD.
036600*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
036700      MOVE PASS-COUNTER TO CCVS-E-4-1.
036800      MOVE ERROR-HOLD TO CCVS-E-4-2.
036900      MOVE CCVS-E-4 TO CCVS-E-2-2.
037000      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
037100  END-ROUTINE-12.
037200      MOVE "TEST(S) FAILED" TO ENDER-DESC.
037300     IF       ERROR-COUNTER IS EQUAL TO ZERO
037400         MOVE "NO " TO ERROR-TOTAL
037500         ELSE
037600         MOVE ERROR-COUNTER TO ERROR-TOTAL.
037700     MOVE     CCVS-E-2 TO DUMMY-RECORD.
037800     PERFORM WRITE-LINE.
037900 END-ROUTINE-13.
038000     IF DELETE-CNT IS EQUAL TO ZERO
038100         MOVE "NO " TO ERROR-TOTAL  ELSE
038200         MOVE DELETE-CNT TO ERROR-TOTAL.
038300     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
038400     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038500      IF   INSPECT-COUNTER EQUAL TO ZERO
038600          MOVE "NO " TO ERROR-TOTAL
038700      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
038800      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
038900      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
039000     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
039100 WRITE-LINE.
039200     ADD 1 TO RECORD-COUNT.
039300Y    IF RECORD-COUNT GREATER 50
039400Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
039500Y        MOVE SPACE TO DUMMY-RECORD
039600Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
039700Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
039800Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
039900Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
040000Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
040100Y        MOVE ZERO TO RECORD-COUNT.
040200     PERFORM WRT-LN.
040300 WRT-LN.
040400     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
040500     MOVE SPACE TO DUMMY-RECORD.
040600 BLANK-LINE-PRINT.
040700     PERFORM WRT-LN.
040800 FAIL-ROUTINE.
040900     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
041000     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
041100     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
041200     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041300     GO TO FAIL-ROUTINE-EX.
041400 FAIL-ROUTINE-WRITE.
041500     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
041600     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
041700 FAIL-ROUTINE-EX. EXIT.
041800 BAIL-OUT.
041900     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
042000     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
042100 BAIL-OUT-WRITE.
042200     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
042300     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042400 BAIL-OUT-EX. EXIT.
042500 CCVS1-EXIT.
042600     EXIT.
042700 SECT-SQ208M-0001 SECTION.
042800 WRITE-INIT-GF-01.
042900     MOVE COMMENT-LINE-1 TO PRINT-REC.
043000     WRITE PRINT-REC AFTER ADVANCING 5 LINES.
043100     MOVE COMMENT-LINE-2 TO PRINT-REC.
043200     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
043300     MOVE SPACE TO DUMMY-RECORD.
043400     PERFORM BLANK-LINE-PRINT.
043500 WRITE-TEST-GF-01.
043600*             THIS TEST CHECKS THE RESULTS OF CHANGING THE VALUES
043700*             OF THE DATA-NAMES IN THE LINAGE CLAUSE AFTER AN
043800*             OPEN OUTPUT PRINT-FILE.
043900     MOVE SPACE TO DUMMY-RECORD.
044000     PERFORM INITIALIZE-PAGE.
044100     MOVE "LINAGE AFTER OPEN" TO FEATURE.
044200     MOVE "WRITE-TEST-GF-01" TO PAR-NAME.
044300     PERFORM PRINT-DETAIL.
044400     MOVE COMMENT-LINE-3 TO PRINT-REC.
044500     WRITE PRINT-REC AFTER ADVANCING 5 LINES.
044600     MOVE COMMENT-LINE-4 TO PRINT-REC.
044700     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
044800     MOVE COMMENT-LINE-5 TO PRINT-REC.
044900     WRITE PRINT-REC AFTER ADVANCING 1 LINES.
045000     MOVE SPACE TO DUMMY-RECORD.
045100     PERFORM PRINT-LAST-LINE.
045200     MOVE SPACE TO DUMMY-RECORD.
045300     PERFORM BLANK-LINE-PRINT.
045400     MOVE 30 TO LINAGE-CTR, FOOT-CTR.
045500     MOVE 1 TO TOP-CTR.
045600     MOVE 2 TO BOTTOM-CTR.
045700     MOVE 1 TO DL1-LINE-NO.
045800     MOVE 123 TO DL1-TOTAL-LINES.
045900     PERFORM PRINT-DETAIL-1 123 TIMES.
046000 WRITE-TEST-GF-02.
046100*             THIS TEST CHECKS THE RESULTS OF CHANGING THE VALUES
046200*             OF THE DATA-NAMES IN THE LINAGE CLAUSE PRIOR TO A
046300*             PAGE OVERFLOW.
046400     PERFORM INITIALIZE-PAGE.
046500     MOVE "LINAGE AFT OVERFLOW" TO FEATURE.
046600     MOVE "WRITE-TEST-GF-02" TO PAR-NAME.
046700     PERFORM PRINT-DETAIL.
046800     MOVE COMMENT-LINE-6 TO PRINT-REC.
046900     WRITE PRINT-REC AFTER ADVANCING 5 LINES.
047000     MOVE COMMENT-LINE-7 TO PRINT-REC.
047100     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
047200     MOVE COMMENT-LINE-8 TO PRINT-REC.
047300     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
047400     MOVE SPACE TO DUMMY-RECORD.
047500     PERFORM PRINT-LAST-LINE.
047600     MOVE 20 TO LINAGE-CTR, FOOT-CTR.
047700     MOVE 2 TO TOP-CTR.
047800     MOVE 3 TO BOTTOM-CTR.
047900     MOVE SPACE TO DUMMY-RECORD.
048000     PERFORM BLANK-LINE-PRINT.
048100     MOVE 40 TO LINAGE-CTR, FOOT-CTR.
048200     MOVE 1 TO TOP-CTR.
048300     MOVE 2 TO BOTTOM-CTR.
048400     MOVE 1 TO DL1-LINE-NO.
048500     MOVE 136 TO DL1-TOTAL-LINES.
048600     PERFORM PRINT-DETAIL-1 136 TIMES.
048700 WRITE-TEST-GF-03.
048800*             THIS TEST CHECKS THE RESULTS OF CHANGING THE VALUES
048900*             OF THE DATA-NAMES IN THE LINAGE-CLAUSE PRIOR TO A
049000*             WRITE ADVANCING PAGE OPERATION.
049100     PERFORM INITIALIZE-PAGE.
049200     MOVE "LINAGE AFT WRT PAGE" TO FEATURE.
049300     MOVE "WRITE-TEST-GF-03" TO PAR-NAME.
049400     PERFORM PRINT-DETAIL.
049500     MOVE COMMENT-LINE-9 TO PRINT-REC.
049600     WRITE PRINT-REC AFTER ADVANCING 5 LINES.
049700     MOVE COMMENT-LINE-10 TO PRINT-REC.
049800     WRITE PRINT-REC AFTER ADVANCING 1 LINES.
049900     MOVE SPACE TO DUMMY-RECORD.
050000     PERFORM PRINT-LAST-LINE.
050100     MOVE 20 TO LINAGE-CTR, FOOT-CTR.
050200     MOVE 2 TO TOP-CTR.
050300     MOVE 3 TO BOTTOM-CTR.
050400     MOVE SPACE TO DUMMY-RECORD.
050500     PERFORM BLANK-LINE-PRINT.
050600     MOVE 1 TO DL1-LINE-NO.
050700     MOVE 135 TO DL1-TOTAL-LINES.
050800     PERFORM PRINT-DETAIL-2 15 TIMES.
050900     MOVE 40 TO LINAGE-CTR, FOOT-CTR.
051000     MOVE 1 TO TOP-CTR.
051100     MOVE 2 TO BOTTOM-CTR.
051200     MOVE SPACE TO DUMMY-RECORD.
051300     WRITE PRINT-REC BEFORE ADVANCING PAGE.
051400     MOVE 16 TO DL1-LINE-NO.
051500     PERFORM PRINT-DETAIL-2 120 TIMES.
051600 WRITE-TEST-GF-04.
051700*             THIS TEST CHECKS THE MINIMUM LINAGE VALUE OF 1
051800*             AND THE MINIMUM TOP VALUE OF ZERO.
051900     PERFORM INITIALIZE-PAGE.
052000     MOVE "MIN LINAGE / 0 TOP" TO FEATURE.
052100     MOVE "WRITE-TEST-GF-04" TO PAR-NAME.
052200     PERFORM PRINT-DETAIL.
052300     MOVE COMMENT-LINE-11 TO PRINT-REC.
052400     WRITE PRINT-REC AFTER ADVANCING 5 LINES.
052500     MOVE COMMENT-LINE-12 TO PRINT-REC.
052600     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
052700     MOVE SPACE TO DUMMY-RECORD.
052800     PERFORM PRINT-LAST-LINE.
052900     MOVE 1 TO LINAGE-CTR, FOOT-CTR.
053000     MOVE 0 TO TOP-CTR.
053100     MOVE 2 TO BOTTOM-CTR.
053200     MOVE 1 TO DL2-LINE-NO.
053300     PERFORM PRINT-DETAIL-3 10 TIMES.
053400 WRITE-TEST-GF-05.
053500*             THIS TEST CHECKS THE MINIMUM FOOTING VALUE OF 1
053600*             AND THE MINIMUM BOTTOM VALUE OF ZERO.
053700     PERFORM INITIALIZE-PAGE.
053800     MOVE "MIN FOOTING / 0 BOTM" TO FEATURE.
053900     MOVE "WRITE-TEST-GF-05" TO PAR-NAME.
054000     PERFORM PRINT-DETAIL.
054100     MOVE COMMENT-LINE-13 TO PRINT-REC.
054200     WRITE PRINT-REC AFTER ADVANCING 5 LINES.
054300     MOVE COMMENT-LINE-14 TO PRINT-REC.
054400     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
054500     MOVE SPACE TO DUMMY-RECORD.
054600     PERFORM PRINT-LAST-LINE.
054700     MOVE 2 TO LINAGE-CTR.
054800     MOVE 1 TO FOOT-CTR, TOP-CTR.
054900     MOVE 0 TO BOTTOM-CTR.
055000     MOVE 1 TO DL2-LINE-NO.
055100     PERFORM PRINT-DETAIL-4 10 TIMES.
055200 WRITE-TEST-GF-06.
055300*             THIS TEST SHOWS THE RESULTS OF A WRITE BEFORE
055400*             OPERATION WITH AN EOP PHRASE.  LINAGE AND FOOTING
055500*             VALUES ARE SPECIFIED AND EQUAL.
055600     MOVE SPACE TO DUMMY-RECORD.
055700     PERFORM INITIALIZE-PAGE.
055800     MOVE "WRITE BEFORE" TO FEATURE.
055900     MOVE "WRITE-TEST-GF-06" TO PAR-NAME.
056000     PERFORM PRINT-DETAIL.
056100     MOVE INFO-LINE-1 TO PRINT-REC.
056200     WRITE PRINT-REC AFTER ADVANCING 5 LINES.
056300     MOVE INFO-LINE-3 TO PRINT-REC.
056400     WRITE PRINT-REC AFTER ADVANCING 1 LINES.
056500     MOVE INFO-LINE-4 TO PRINT-REC.
056600     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
056700     MOVE INFO-LINE-6 TO PRINT-REC.
056800     WRITE PRINT-REC AFTER ADVANCING 1 LINES.
056900     MOVE INFO-LINE-8 TO PRINT-REC.
057000     WRITE PRINT-REC AFTER ADVANCING 1 LINES.
057100     MOVE SPACE TO DUMMY-RECORD.
057200     PERFORM BLANK-LINE-PRINT UNTIL LINAGE-COUNTER EQUAL 66.
057300     MOVE 40 TO LINAGE-CTR, FOOT-CTR.
057400     MOVE 1 TO TOP-CTR, BOTTOM-CTR.
057500     MOVE LAST-LINE TO PRINT-REC.
057600     WRITE PRINT-REC BEFORE ADVANCING 1 LINE.
057700     MOVE SPACE TO DUMMY-RECORD.
057800     MOVE 1 TO DL3-LINE-NO.
057900     PERFORM WRITE-BEFORE 60 TIMES.
058000 WRITE-TEST-GF-07.
058100*             THIS TEST SHOWS THE RESULTS OF A WRITE AFTER
058200*             OPERATION WITH AN EOP PHRASE.  LINAGE AND FOOTING
058300*             VALUES ARE SPECIFIED AND EQUAL.
058400     MOVE SPACE TO DUMMY-RECORD.
058500     PERFORM INITIALIZE-PAGE.
058600     MOVE "WRITE AFTER" TO FEATURE.
058700     MOVE "WRITE-TEST-GF-07" TO PAR-NAME.
058800     PERFORM PRINT-DETAIL.
058900     MOVE INFO-LINE-2 TO PRINT-REC.
059000     WRITE PRINT-REC AFTER ADVANCING 5 LINES.
059100     MOVE INFO-LINE-3 TO PRINT-REC.
059200     WRITE PRINT-REC AFTER ADVANCING 1 LINES.
059300     MOVE INFO-LINE-4 TO PRINT-REC.
059400     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
059500     MOVE INFO-LINE-7 TO PRINT-REC.
059600     WRITE PRINT-REC AFTER ADVANCING 1 LINES.
059700     MOVE INFO-LINE-8 TO PRINT-REC.
059800     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
059900     MOVE SPACE TO DUMMY-RECORD.
060000     PERFORM BLANK-LINE-PRINT UNTIL LINAGE-COUNTER EQUAL 66.
060100     MOVE 40 TO LINAGE-CTR, FOOT-CTR.
060200     MOVE 1 TO TOP-CTR, BOTTOM-CTR.
060300     MOVE LAST-LINE TO PRINT-REC.
060400     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
060500     MOVE SPACE TO DUMMY-RECORD.
060600     MOVE 1 TO DL3-LINE-NO.
060700     PERFORM WRITE-AFTER 60 TIMES.
060800 SQ208M-END-ROUTINE.
060900     MOVE "END OF SQ208M VALIDATION TESTS" TO PRINT-REC.
061000     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
061100     GO TO CCVS-EXIT.
061200 INITIALIZE-PAGE.
061300     MOVE 0 TO TOP-CTR, BOTTOM-CTR.
061400     MOVE 66 TO LINAGE-CTR, FOOT-CTR.
061500     PERFORM BLANK-LINE-PRINT UNTIL LINAGE-COUNTER EQUAL 1.
061600 PRINT-LAST-LINE.
061700     PERFORM BLANK-LINE-PRINT UNTIL LINAGE-COUNTER EQUAL 65.
061800     MOVE LAST-LINE TO PRINT-REC.
061900     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
062000 PRINT-DETAIL-1.
062100     MOVE LINAGE-COUNTER TO DL1-LC.
062200     MOVE DETAIL-LINE-1 TO PRINT-REC.
062300     WRITE PRINT-REC BEFORE ADVANCING 1 LINE AT END-OF-PAGE
062400              MOVE LINAGE-COUNTER TO FL1-LC
062500              MOVE FOOT-LINE-1 TO PRINT-REC
062600              WRITE PRINT-REC BEFORE ADVANCING 1 LINE.
062700     ADD 1 TO DL1-LINE-NO.
062800 PRINT-DETAIL-2.
062900     MOVE LINAGE-COUNTER TO DL1-LC.
063000     MOVE DETAIL-LINE-1 TO PRINT-REC.
063100     WRITE PRINT-REC BEFORE ADVANCING 1 LINE.
063200     ADD 1 TO DL1-LINE-NO.
063300 PRINT-DETAIL-3.
063400     MOVE LINAGE-COUNTER TO DL2-LC.
063500     MOVE DETAIL-LINE-2 TO PRINT-REC.
063600     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
063700     ADD 1 TO DL2-LINE-NO.
063800 PRINT-DETAIL-4.
063900     MOVE LINAGE-COUNTER TO DL2-LC.
064000     MOVE DETAIL-LINE-2 TO PRINT-REC.
064100     WRITE PRINT-REC AFTER ADVANCING 1 LINE AT EOP
064200              MOVE LINAGE-COUNTER TO FL1-LC
064300              MOVE FOOT-LINE-1 TO PRINT-REC
064400              WRITE PRINT-REC AFTER ADVANCING 1 LINE.
064500     ADD 1 TO DL2-LINE-NO.
064600 WRITE-BEFORE.
064700     MOVE LINAGE-COUNTER TO DL3-LC.
064800     MOVE DETAIL-LINE-3 TO PRINT-REC.
064900     WRITE PRINT-REC BEFORE ADVANCING 1 LINE AT EOP
065000              MOVE LINAGE-COUNTER TO FL3-LC
065100              MOVE FOOT-LINE-3 TO PRINT-REC
065200              WRITE PRINT-REC BEFORE ADVANCING 1 LINE.
065300     ADD 1 TO DL3-LINE-NO.
065400 WRITE-AFTER.
065500     MOVE LINAGE-COUNTER TO DL3-LC.
065600     MOVE DETAIL-LINE-3 TO PRINT-REC.
065700     WRITE PRINT-REC AFTER ADVANCING 1 LINE AT EOP
065800              MOVE LINAGE-COUNTER TO FL3-LC
065900              MOVE FOOT-LINE-3 TO PRINT-REC
066000              WRITE PRINT-REC AFTER ADVANCING 1 LINE.
066100     ADD 1 TO DL3-LINE-NO.
066200 CCVS-EXIT SECTION.
066300 CCVS-999999.
066400     GO TO CLOSE-FILES.
