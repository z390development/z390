000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ227A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
000900*                             REVISED 1986, AUGUST             *
001000*                                                              *
001100*    CREATION DATE     /     VALIDATION DATE                   *
001200*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001300*                                                              *
001400****************************************************************
001500*                                                              *
001600*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001700*                                                              *
001800*            X-14   SEQUENTIAL MASS STORAGE FILE               *
001900*            X-55   SYSTEM PRINTER                             *
002000*            X-82   SOURCE-COMPUTER                            *
002100*            X-83   OBJECT-COMPUTER.                           *
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    THIS PROGRAM OPENS FOR OUTPUT A FILE WHICH IS ASSIGNED    *
002600*    TO A MASS STORAGE MEDIUM. ONE RECORD IS THEN WRITTEN TO   *
002700*    THIS FILE WHICH IS THEN CLOSED.  THE FILE IS THEN OPENED  *
002800*    FOR I-O, AND A READ STATEMENT ON THE FILE IS CARRIED OUT. *
002900*    A REWRITE ON A RECORD THAT IS TOO LONG FOR THE FILE IS    *
003000*    ATTEMPTED WHICH SHOULD CAUSE AN EXCEPTION CONDITION WITH  *
003100*    I-O STATUS "44".  THIS LOGIC ERROR SHOULD CAUSE ENTRY TO  *
003200*    THE APPLICABLE ERROR DECLARATIVE.                         *
003300*                                                              *
003400*    THIS PROGRAM HAS BEEN SPLIT FROM V2.0 ONWARDS.            *
003500*    THE NEW PROGRAM IS SQ228A.                                *
003600****************************************************************
003700*
003800 ENVIRONMENT DIVISION.
003900 CONFIGURATION SECTION.
004000 SOURCE-COMPUTER.
004100     XXXXX082.
004200 OBJECT-COMPUTER.
004300     XXXXX083.
004400*
004500 INPUT-OUTPUT SECTION.
004600 FILE-CONTROL.
004700     SELECT PRINT-FILE ASSIGN TO
004800     XXXXX055.
004900*
005000P    SELECT RAW-DATA   ASSIGN TO
005100P    XXXXX062
005200P          ORGANIZATION IS INDEXED
005300P          ACCESS MODE  IS RANDOM
005400P          RECORD-KEY   IS RAW-DATA-KEY.
005500P
005600     SELECT SQ-FS4
005700            ASSIGN
005800     XXXXX014
005900            STATUS SQ-FS4-STATUS OF STATUS-GROUP
006000            ACCESS MODE IS SEQUENTIAL
006100            ORGANIZATION IS SEQUENTIAL
006200            .
006300*
006400*
006500 DATA DIVISION.
006600 FILE SECTION.
006700 FD  PRINT-FILE
006800C    LABEL RECORDS
006900C    XXXXX084
007000C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007100               .
007200 01  PRINT-REC    PICTURE X(120).
007300 01  DUMMY-RECORD PICTURE X(120).
007400P
007500PFD  RAW-DATA.
007600P01  RAW-DATA-SATZ.
007700P    05  RAW-DATA-KEY        PIC X(6).
007800P    05  C-DATE              PIC 9(6).
007900P    05  C-TIME              PIC 9(8).
008000P    05  NO-OF-TESTS         PIC 99.
008100P    05  C-OK                PIC 999.
008200P    05  C-ALL               PIC 999.
008300P    05  C-FAIL              PIC 999.
008400P    05  C-DELETED           PIC 999.
008500P    05  C-INSPECT           PIC 999.
008600P    05  C-NOTE              PIC X(13).
008700P    05  C-INDENT            PIC X.
008800P    05  C-ABORT             PIC X(8).
008900*
009000 FD  SQ-FS4
009100C    LABEL RECORD IS STANDARD
009200     BLOCK CONTAINS 138 CHARACTERS
009300     RECORD VARYING SIZE FROM 50 TO 138 CHARACTERS
009400       DEPENDING ON SQ-FS4-RECSIZE
009500                .
009600 01  SQ-FS4R1-F-G-120.
009700        05 FFILE-RECORD-INFO-P1-120.
009800           07 FILLER              PIC X(5).
009900           07 FFILE-NAME          PIC X(6).
010000           07 FILLER              PIC X(8).
010100           07 FRECORD-NAME        PIC X(6).
010200           07 FILLER              PIC X(1).
010300           07 FREELUNIT-NUMBER    PIC 9(1).
010400           07 FILLER              PIC X(7).
010500           07 FRECORD-NUMBER      PIC 9(6).
010600           07 FILLER              PIC X(6).
010700           07 FUPDATE-NUMBER      PIC 9(2).
010800           07 FILLER              PIC X(5).
010900           07 FODO-NUMBER         PIC 9(4).
011000           07 FILLER              PIC X(5).
011100           07 FPROGRAM-NAME       PIC X(5).
011200           07 FILLER              PIC X(7).
011300           07 FRECORD-LENGTH      PIC 9(6).
011400           07 FILLER              PIC X(7).
011500           07 FCHARS-OR-RECORDS   PIC X(2).
011600           07 FILLER              PIC X(1).
011700           07 FBLOCK-SIZE         PIC 9(4).
011800           07 FILLER              PIC X(6).
011900           07 FRECORDS-IN-FILE    PIC 9(6).
012000           07 FILLER              PIC X(5).
012100           07 FFILE-ORGANIZATION  PIC X(2).
012200           07 FILLER              PIC X(6).
012300           07 FLABEL-TYPE         PIC X(1).
012400*
012500 01  SQ-FS4R2-F-G-138.
012600     03  FILLER PIC X(120).
012700     03  EXT-18 PIC X(18).
012800*
012900 WORKING-STORAGE SECTION.
013000*
013100***************************************************************
013200*                                                             *
013300*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
013400*                                                             *
013500***************************************************************
013600*
013700 01  STATUS-GROUP.
013800     04  SQ-FS4-STATUS.
013900         07  SQ-FS4-KEY-1   PIC X.
014000         07  SQ-FS4-KEY-2   PIC X.
014100*
014200 01  DELETE-SW.
014300     03  DELETE-SW-1 PIC X.
014400     03  DELETE-SW-1-GROUP.
014500         05  DELETE-SW-2 PIC X.
014600*
014700 01  DECL-EXEC-I-O PIC X(12).
014800*
014900 01  DECL-EXEC-SW PIC X.
015000*
015100 01  SQ-FS4-RECSIZE PIC 999.
015200*
015300***************************************************************
015400*                                                             *
015500*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
015600*                                                             *
015700***************************************************************
015800*
015900 01  REC-SKEL-SUB   PIC 99.
016000*
016100 01  FILE-RECORD-INFORMATION-REC.
016200     03 FILE-RECORD-INFO-SKELETON.
016300        05 FILLER                 PICTURE X(48)       VALUE
016400             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
016500        05 FILLER                 PICTURE X(46)       VALUE
016600             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
016700        05 FILLER                 PICTURE X(26)       VALUE
016800             ",LFIL=000000,ORG=  ,LBLR= ".
016900        05 FILLER                 PICTURE X(37)       VALUE
017000             ",RECKEY=                             ".
017100        05 FILLER                 PICTURE X(38)       VALUE
017200             ",ALTKEY1=                             ".
017300        05 FILLER                 PICTURE X(38)       VALUE
017400             ",ALTKEY2=                             ".
017500        05 FILLER                 PICTURE X(7)        VALUE SPACE.
017600     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
017700        05 FILE-RECORD-INFO-P1-120.
017800           07 FILLER              PIC X(5).
017900           07 XFILE-NAME          PIC X(6).
018000           07 FILLER              PIC X(8).
018100           07 XRECORD-NAME        PIC X(6).
018200           07 FILLER              PIC X(1).
018300           07 REELUNIT-NUMBER     PIC 9(1).
018400           07 FILLER              PIC X(7).
018500           07 XRECORD-NUMBER      PIC 9(6).
018600           07 FILLER              PIC X(6).
018700           07 UPDATE-NUMBER       PIC 9(2).
018800           07 FILLER              PIC X(5).
018900           07 ODO-NUMBER          PIC 9(4).
019000           07 FILLER              PIC X(5).
019100           07 XPROGRAM-NAME       PIC X(5).
019200           07 FILLER              PIC X(7).
019300           07 XRECORD-LENGTH      PIC 9(6).
019400           07 FILLER              PIC X(7).
019500           07 CHARS-OR-RECORDS    PIC X(2).
019600           07 FILLER              PIC X(1).
019700           07 XBLOCK-SIZE         PIC 9(4).
019800           07 FILLER              PIC X(6).
019900           07 RECORDS-IN-FILE     PIC 9(6).
020000           07 FILLER              PIC X(5).
020100           07 XFILE-ORGANIZATION  PIC X(2).
020200           07 FILLER              PIC X(6).
020300           07 XLABEL-TYPE         PIC X(1).
020400        05 FILE-RECORD-INFO-P121-240.
020500           07 FILLER              PIC X(8).
020600           07 XRECORD-KEY         PIC X(29).
020700           07 FILLER              PIC X(9).
020800           07 ALTERNATE-KEY1      PIC X(29).
020900           07 FILLER              PIC X(9).
021000           07 ALTERNATE-KEY2      PIC X(29).
021100           07 FILLER              PIC X(7).
021200*
021300 01  TEST-RESULTS.
021400     02 FILLER              PIC X      VALUE SPACE.
021500     02  PAR-NAME.
021600       03 FILLER              PIC X(14)  VALUE SPACE.
021700       03 PARDOT-X            PIC X      VALUE SPACE.
021800       03 DOTVALUE            PIC 99     VALUE ZERO.
021900     02 FILLER              PIC X      VALUE SPACE.
022000     02 FEATURE             PIC X(24)  VALUE SPACE.
022100     02 FILLER              PIC X      VALUE SPACE.
022200     02 P-OR-F              PIC X(5)   VALUE SPACE.
022300     02 FILLER              PIC X(9)   VALUE SPACE.
022400     02 RE-MARK             PIC X(61).
022500 01  TEST-COMPUTED.
022600   02 FILLER  PIC X(30)  VALUE SPACE.
022700   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
022800   02 COMPUTED-X.
022900     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
023000     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
023100     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
023200     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
023300     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
023400     03       CM-18V0 REDEFINES COMPUTED-A.
023500        04 COMPUTED-18V0                   PIC -9(18).
023600        04 FILLER                          PIC X.
023700     03 FILLER PIC X(50) VALUE SPACE.
023800 01  TEST-CORRECT.
023900     02 FILLER PIC X(30) VALUE SPACE.
024000     02 FILLER PIC X(17) VALUE "       CORRECT =".
024100     02 CORRECT-X.
024200     03 CORRECT-A                  PIC X(20) VALUE SPACE.
024300     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
024400     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
024500     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
024600     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
024700     03      CR-18V0 REDEFINES CORRECT-A.
024800         04 CORRECT-18V0                     PIC -9(18).
024900         04 FILLER                           PIC X.
025000     03 FILLER PIC X(2) VALUE SPACE.
025100     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
025200*
025300 01  CCVS-C-1.
025400     02 FILLER  PIC IS X        VALUE  SPACE.
025500     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
025600     02 FILLER  PIC IS X        VALUE  SPACE.
025700     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
025800     02 FILLER  PIC IS X        VALUE  SPACE.
025900     02 FILLER  PIC IS X(5)     VALUE "PASS ".
026000     02 FILLER  PIC IS X(9)     VALUE  SPACE.
026100     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
026200 01  CCVS-C-2.
026300     02 FILLER  PIC X(19)  VALUE  SPACE.
026400     02 FILLER  PIC X(6)   VALUE "TESTED".
026500     02 FILLER  PIC X(19)  VALUE  SPACE.
026600     02 FILLER  PIC X(4)   VALUE "FAIL".
026700     02 FILLER  PIC X(72)  VALUE  SPACE.
026800*
026900 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
027000 01  REC-CT            PIC 99       VALUE ZERO.
027100 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
027200 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
027300 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
027400 01  PASS-COUNTER      PIC 999      VALUE ZERO.
027500 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
027600 01  ERROR-HOLD        PIC 999      VALUE ZERO.
027700 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
027800 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
027900 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
028000 01  CCVS-H-1.
028100     02  FILLER          PIC X(39)    VALUE SPACES.
028200     02  FILLER          PIC X(42)    VALUE
028300     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
028400     02  FILLER          PIC X(39)    VALUE SPACES.
028500 01  CCVS-H-2A.
028600   02  FILLER            PIC X(40)  VALUE SPACE.
028700   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
028800   02  FILLER            PIC XXXX   VALUE
028900     "4.2 ".
029000   02  FILLER            PIC X(28)  VALUE
029100            " COPY - NOT FOR DISTRIBUTION".
029200   02  FILLER            PIC X(41)  VALUE SPACE.
029300*
029400 01  CCVS-H-2B.
029500   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
029600   02  TEST-ID           PIC X(9).
029700   02  FILLER            PIC X(4)   VALUE " IN ".
029800   02  FILLER            PIC X(12)  VALUE
029900     " HIGH       ".
030000   02  FILLER            PIC X(22)  VALUE
030100            " LEVEL VALIDATION FOR ".
030200   02  FILLER            PIC X(58)  VALUE
030300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
030400 01  CCVS-H-3.
030500     02  FILLER          PIC X(34)  VALUE
030600            " FOR OFFICIAL USE ONLY    ".
030700     02  FILLER          PIC X(58)  VALUE
030800     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
030900     02  FILLER          PIC X(28)  VALUE
031000            "  COPYRIGHT   1985,1986 ".
031100 01  CCVS-E-1.
031200     02 FILLER           PIC X(52)  VALUE SPACE.
031300     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
031400     02 ID-AGAIN         PIC X(9).
031500     02 FILLER           PIC X(45)  VALUE SPACES.
031600 01  CCVS-E-2.
031700     02  FILLER          PIC X(31)  VALUE SPACE.
031800     02  FILLER          PIC X(21)  VALUE SPACE.
031900     02  CCVS-E-2-2.
032000         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
032100         03 FILLER         PIC X      VALUE SPACE.
032200         03 ENDER-DESC     PIC X(44)  VALUE
032300            "ERRORS ENCOUNTERED".
032400 01  CCVS-E-3.
032500     02  FILLER          PIC X(22)  VALUE
032600            " FOR OFFICIAL USE ONLY".
032700     02  FILLER          PIC X(12)  VALUE SPACE.
032800     02  FILLER          PIC X(58)  VALUE
032900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
033000     02  FILLER          PIC X(8)   VALUE SPACE.
033100     02  FILLER          PIC X(20)  VALUE
033200             " COPYRIGHT 1985,1986".
033300 01  CCVS-E-4.
033400     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
033500     02 FILLER           PIC X(4)   VALUE " OF ".
033600     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
033700     02 FILLER           PIC X(40)  VALUE
033800      "  TESTS WERE EXECUTED SUCCESSFULLY".
033900 01  XXINFO.
034000     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
034100     02 INFO-TEXT.
034200       04 FILLER             PIC X(8)   VALUE SPACE.
034300       04 XXCOMPUTED         PIC X(20).
034400       04 FILLER             PIC X(5)   VALUE SPACE.
034500       04 XXCORRECT          PIC X(20).
034600     02 INF-ANSI-REFERENCE PIC X(48).
034700 01  HYPHEN-LINE.
034800     02 FILLER  PIC IS X VALUE IS SPACE.
034900     02 FILLER  PIC IS X(65)    VALUE IS "************************
035000-    "*****************************************".
035100     02 FILLER  PIC IS X(54)    VALUE IS "************************
035200-    "******************************".
035300 01  CCVS-PGM-ID  PIC X(9)   VALUE
035400     "SQ227A".
035500*
035600*
035700 PROCEDURE DIVISION.
035800 DECLARATIVES.
035900*
036000 SECT-SQ227A-0001 SECTION.
036100     USE AFTER EXCEPTION PROCEDURE I-O.
036200 I-O-ERROR-PROCESS.
036300     MOVE   "EXECUTED" TO DECL-EXEC-I-O.
036400     IF DECL-EXEC-SW NOT = SPACE
036500         GO TO   END-DECLS.
036600*
036700     MOVE    1 TO REC-CT.
036800     MOVE   "DCL-REWRITE-01" TO PAR-NAME.
036900     GO TO   DCL-REWRITE-01-01.
037000 DECL-DELETE-01-01.
037100     PERFORM DECL-DE-LETE.
037200     GO TO   DECL-TEST-01-01-END.
037300 DCL-REWRITE-01-01.
037400     IF SQ-FS4-STATUS = "44"
037500         PERFORM DECL-PASS
037600     ELSE
037700         MOVE    SQ-FS4-STATUS TO COMPUTED-A
037800         MOVE   "44" TO CORRECT-A
037900         MOVE   "UNEXPECTED I-O STATUS ON FAILED REWRITE"
038000                   TO RE-MARK
038100         MOVE   "VII-4, VII-48,4.5.4(2)" TO ANSI-REFERENCE
038200         PERFORM DECL-FAIL.
038300 DECL-TEST-01-01-END.
038400*
038500     ADD     1 TO REC-CT.
038600     GO TO   DCL-REWRITE-01-02.
038700 DECL-DELETE-01-02.
038800     PERFORM DECL-DE-LETE.
038900     GO TO   DECL-TEST-01-02-END.
039000 DCL-REWRITE-01-02.
039100     IF SQ-FS4R1-F-G-120 = FILE-RECORD-INFO-P1-120 (1)
039200         PERFORM DECL-PASS
039300     ELSE
039400         MOVE   "FIRST 120 CHARACTERS OF RECORD AREA CHANGED"
039500                   TO RE-MARK
039600         MOVE   "VII-4, VII-49,4.5.4(9)" TO ANSI-REFERENCE
039700         PERFORM DECL-FAIL.
039800 DECL-TEST-01-02-END.
039900*
040000     ADD     1 TO REC-CT.
040100     GO TO   DCL-REWRITE-01-03.
040200 DECL-DELETE-01-03.
040300     PERFORM DECL-DE-LETE.
040400     GO TO   DECL-TEST-01-03-END.
040500 DCL-REWRITE-01-03.
040600     IF EXT-18 = "ABCDEFGHIJKLMNOPQR"
040700         PERFORM DECL-PASS
040800     ELSE
040900         MOVE    EXT-18 TO COMPUTED-A
041000         MOVE   "ABCDEFGHIJKLMNOPQR" TO CORRECT-A
041100         MOVE   "LAST 18 CHARACTERS OF RECORD CHANGED"
041200                   TO RE-MARK
041300         MOVE   "VII-4, VII-49,4.5.4(9)" TO ANSI-REFERENCE
041400         PERFORM DECL-FAIL.
041500 DECL-TEST-01-03-END.
041600*
041700     PERFORM DECL-WRITE-LINE.
041800     MOVE   "ABNORMAL TERMINATION AT THIS POINT IS ACCEPTABLE"
041900               TO DUMMY-RECORD.
042000     PERFORM DECL-WRITE-LINE 3 TIMES.
042100     GO TO   END-DECLS.
042200*
042300*
042400 DECL-PASS.
042500     MOVE   "PASS " TO P-OR-F.
042600     ADD     1 TO PASS-COUNTER.
042700     PERFORM DECL-PRINT-DETAIL.
042800*
042900 DECL-FAIL.
043000     MOVE   "FAIL*" TO P-OR-F.
043100     ADD     1 TO ERROR-COUNTER.
043200     PERFORM DECL-PRINT-DETAIL.
043300*
043400 DECL-DE-LETE.
043500     MOVE   "****TEST DELETED****" TO RE-MARK.
043600     MOVE   "*****" TO P-OR-F.
043700     ADD     1 TO DELETE-COUNTER.
043800     PERFORM DECL-PRINT-DETAIL.
043900*
044000 DECL-PRINT-DETAIL.
044100     IF REC-CT NOT EQUAL TO ZERO
044200             MOVE "." TO PARDOT-X
044300             MOVE REC-CT TO DOTVALUE.
044400     MOVE    TEST-RESULTS TO PRINT-REC.
044500     PERFORM DECL-WRITE-LINE.
044600     IF P-OR-F EQUAL TO "FAIL*"
044700         PERFORM DECL-WRITE-LINE
044800         PERFORM DECL-FAIL-ROUTINE THRU DECL-FAIL-EX
044900     ELSE
045000         PERFORM DECL-BAIL THRU DECL-BAIL-EX.
045100     MOVE    SPACE TO P-OR-F.
045200     MOVE    SPACE TO COMPUTED-X.
045300     MOVE    SPACE TO CORRECT-X.
045400     IF REC-CT EQUAL TO ZERO
045500         MOVE    SPACE TO PAR-NAME.
045600     MOVE    SPACE TO RE-MARK.
045700*
045800 DECL-WRITE-LINE.
045900     ADD     1 TO RECORD-COUNT.
046000Y    IF RECORD-COUNT GREATER 50
046100Y        MOVE    DUMMY-RECORD TO DUMMY-HOLD
046200Y        MOVE    SPACE TO DUMMY-RECORD
046300Y        WRITE   DUMMY-RECORD AFTER ADVANCING PAGE
046400Y        MOVE    CCVS-C-1 TO DUMMY-RECORD PERFORM DECL-WRT-LN
046500Y        MOVE    CCVS-C-2 TO DUMMY-RECORD
046600Y        PERFORM DECL-WRT-LN 2 TIMES
046700Y        MOVE    HYPHEN-LINE TO DUMMY-RECORD
046800Y        PERFORM DECL-WRT-LN
046900Y        MOVE    DUMMY-HOLD TO DUMMY-RECORD
047000Y        MOVE    ZERO TO RECORD-COUNT.
047100     PERFORM DECL-WRT-LN.
047200*
047300 DECL-WRT-LN.
047400     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
047500     MOVE    SPACE TO DUMMY-RECORD.
047600*
047700 DECL-FAIL-ROUTINE.
047800     IF COMPUTED-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
047900     IF CORRECT-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
048000     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
048100     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
048200     MOVE    XXINFO TO DUMMY-RECORD.
048300     PERFORM DECL-WRITE-LINE 2 TIMES.
048400     MOVE    SPACES TO INF-ANSI-REFERENCE.
048500     GO TO   DECL-FAIL-EX.
048600 DECL-FAIL-WRITE.
048700     MOVE    TEST-COMPUTED TO PRINT-REC
048800     PERFORM DECL-WRITE-LINE
048900     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
049000     MOVE    TEST-CORRECT TO PRINT-REC
049100     PERFORM DECL-WRITE-LINE 2 TIMES.
049200     MOVE    SPACES TO COR-ANSI-REFERENCE.
049300 DECL-FAIL-EX.
049400     EXIT.
049500*
049600 DECL-BAIL.
049700     IF COMPUTED-A NOT EQUAL TO SPACE GO TO DECL-BAIL-WRITE.
049800     IF CORRECT-A EQUAL TO SPACE GO TO DECL-BAIL-EX.
049900 DECL-BAIL-WRITE.
050000     MOVE    CORRECT-A TO XXCORRECT.
050100     MOVE    COMPUTED-A TO XXCOMPUTED.
050200     MOVE    XXINFO TO DUMMY-RECORD.
050300     PERFORM DECL-WRITE-LINE 2 TIMES.
050400 DECL-BAIL-EX.
050500     EXIT.
050600*
050700 END-DECLS.
050800 END DECLARATIVES.
050900*
051000*
051100 CCVS1 SECTION.
051200 OPEN-FILES.
051300P    OPEN    I-O RAW-DATA.
051400P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
051500P    READ    RAW-DATA INVALID KEY GO TO END-E-1.
051600P    MOVE   "ABORTED "   TO C-ABORT.
051700P    ADD     1           TO C-NO-OF-TESTS.
051800P    ACCEPT  C-DATE      FROM DATE.
051900P    ACCEPT  C-TIME      FROM TIME.
052000P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
052100PEND-E-1.
052200P    CLOSE   RAW-DATA.
052300     OPEN    OUTPUT PRINT-FILE.
052400     MOVE    CCVS-PGM-ID TO TEST-ID.
052500     MOVE    CCVS-PGM-ID TO ID-AGAIN.
052600     MOVE    SPACE TO TEST-RESULTS.
052700     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
052800     MOVE    ZERO TO REC-SKEL-SUB.
052900     PERFORM CCVS-INIT-FILE 10 TIMES.
053000     GO TO CCVS1-EXIT.
053100*
053200 CCVS-INIT-FILE.
053300     ADD     1 TO REC-SKL-SUB.
053400     MOVE    FILE-RECORD-INFO-SKELETON TO
053500                  FILE-RECORD-INFO (REC-SKL-SUB).
053600*
053700 CLOSE-FILES.
053800     PERFORM END-ROUTINE THRU END-ROUTINE-13.
053900     CLOSE   PRINT-FILE.
054000P    OPEN    I-O RAW-DATA.
054100P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
054200P    READ    RAW-DATA INVALID KEY GO TO END-E-2.
054300P    MOVE   "OK.     " TO C-ABORT.
054400P    MOVE    PASS-COUNTER  TO C-OK.
054500P    MOVE    ERROR-HOLD    TO C-ALL.
054600P    MOVE    ERROR-COUNTER TO C-FAIL.
054700P    MOVE    DELETE-CNT    TO C-DELETED.
054800P    MOVE    INSPECT-COUNTER TO C-INSPECT.
054900P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
055000PEND-E-2.
055100P    CLOSE   RAW-DATA.
055200 TERMINATE-CCVS.
055300S    EXIT    PROGRAM.
055400     STOP    RUN.
055500*
055600 INSPT.
055700     MOVE   "INSPT" TO P-OR-F.
055800     ADD     1 TO INSPECT-COUNTER.
055900     PERFORM PRINT-DETAIL.
056000*
056100 PASS.
056200     MOVE   "PASS " TO P-OR-F.
056300     ADD     1 TO PASS-COUNTER.
056400     PERFORM PRINT-DETAIL.
056500*
056600 FAIL.
056700     MOVE   "FAIL*" TO P-OR-F.
056800     ADD     1 TO ERROR-COUNTER.
056900     PERFORM PRINT-DETAIL.
057000*
057100 DE-LETE.
057200     MOVE   "****TEST DELETED****" TO RE-MARK.
057300     MOVE   "*****" TO P-OR-F.
057400     ADD     1 TO DELETE-COUNTER.
057500     PERFORM PRINT-DETAIL.
057600*
057700 PRINT-DETAIL.
057800     IF REC-CT NOT EQUAL TO ZERO
057900         MOVE   "." TO PARDOT-X
058000         MOVE    REC-CT TO DOTVALUE.
058100     MOVE    TEST-RESULTS TO PRINT-REC.
058200     PERFORM WRITE-LINE.
058300     IF P-OR-F EQUAL TO "FAIL*"
058400         PERFORM WRITE-LINE
058500         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
058600     ELSE
058700         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
058800     MOVE    SPACE TO P-OR-F.
058900     MOVE    SPACE TO COMPUTED-X.
059000     MOVE    SPACE TO CORRECT-X.
059100     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
059200     MOVE    SPACE TO RE-MARK.
059300*
059400 HEAD-ROUTINE.
059500     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
059600     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
059700     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
059800     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
059900 COLUMN-NAMES-ROUTINE.
060000     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
060100     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
060200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
060300 END-ROUTINE.
060400     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
060500     PERFORM WRITE-LINE 5 TIMES.
060600 END-RTN-EXIT.
060700     MOVE    CCVS-E-1 TO DUMMY-RECORD.
060800     PERFORM WRITE-LINE 2 TIMES.
060900*
061000 END-ROUTINE-1.
061100     ADD     ERROR-COUNTER   TO ERROR-HOLD
061200     ADD     INSPECT-COUNTER TO ERROR-HOLD.
061300     ADD     DELETE-COUNTER  TO ERROR-HOLD.
061400     ADD     PASS-COUNTER    TO ERROR-HOLD.
061500     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
061600     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
061700     MOVE    CCVS-E-4        TO CCVS-E-2-2.
061800     MOVE    CCVS-E-2        TO DUMMY-RECORD
061900     PERFORM WRITE-LINE.
062000     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
062100     IF ERROR-COUNTER IS EQUAL TO ZERO
062200         MOVE   "NO " TO ERROR-TOTAL
062300     ELSE
062400         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
062500     MOVE    CCVS-E-2 TO DUMMY-RECORD.
062600     PERFORM WRITE-LINE.
062700 END-ROUTINE-13.
062800     IF DELETE-COUNTER IS EQUAL TO ZERO
062900         MOVE   "NO " TO ERROR-TOTAL
063000     ELSE
063100         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
063200     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
063300     MOVE    CCVS-E-2 TO DUMMY-RECORD.
063400     PERFORM WRITE-LINE.
063500     IF INSPECT-COUNTER EQUAL TO ZERO
063600         MOVE   "NO " TO ERROR-TOTAL
063700     ELSE
063800         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
063900     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
064000     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
064100     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
064200*
064300 WRITE-LINE.
064400     ADD     1 TO RECORD-COUNT.
064500Y    IF RECORD-COUNT GREATER 50
064600Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
064700Y        MOVE  SPACE TO DUMMY-RECORD
064800Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
064900Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
065000Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
065100Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
065200Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
065300Y        MOVE  ZERO TO RECORD-COUNT.
065400     PERFORM WRT-LN.
065500*
065600 WRT-LN.
065700     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
065800     MOVE    SPACE TO DUMMY-RECORD.
065900 BLANK-LINE-PRINT.
066000     PERFORM WRT-LN.
066100 FAIL-ROUTINE.
066200     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
066300     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
066400     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
066500     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
066600     MOVE    XXINFO TO DUMMY-RECORD.
066700     PERFORM WRITE-LINE 2 TIMES.
066800     MOVE    SPACES TO INF-ANSI-REFERENCE.
066900     GO TO   FAIL-ROUTINE-EX.
067000 FAIL-ROUTINE-WRITE.
067100     MOVE    TEST-COMPUTED  TO PRINT-REC
067200     PERFORM WRITE-LINE
067300     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
067400     MOVE    TEST-CORRECT   TO PRINT-REC
067500     PERFORM WRITE-LINE 2 TIMES.
067600     MOVE    SPACES         TO COR-ANSI-REFERENCE.
067700 FAIL-ROUTINE-EX.
067800     EXIT.
067900 BAIL-OUT.
068000     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
068100     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
068200 BAIL-OUT-WRITE.
068300     MOVE    CORRECT-A      TO XXCORRECT.
068400     MOVE    COMPUTED-A     TO XXCOMPUTED.
068500     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
068600     MOVE    XXINFO TO DUMMY-RECORD.
068700     PERFORM WRITE-LINE 2 TIMES.
068800     MOVE    SPACES TO INF-ANSI-REFERENCE.
068900 BAIL-OUT-EX.
069000     EXIT.
069100 CCVS1-EXIT.
069200     EXIT.
069300*
069400****************************************************************
069500*                                                              *
069600*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
069700*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
069800*                                                              *
069900****************************************************************
070000*
070100 SECT-SQ227A-0002 SECTION.
070200 STA-INIT.
070300     MOVE    SPACE TO DELETE-SW.
070400*
070500     MOVE   "SQ-FS4" TO XFILE-NAME (1).
070600     MOVE   "R1-F-G" TO XRECORD-NAME (1).
070700     MOVE    CCVS-PGM-ID TO XPROGRAM-NAME (1).
070800     MOVE    120 TO XRECORD-LENGTH (1).
070900     MOVE   "CC" TO CHARS-OR-RECORDS (1).
071000     MOVE    1   TO XBLOCK-SIZE (1).
071100     MOVE    1   TO RECORDS-IN-FILE (1).
071200     MOVE   "SQ" TO XFILE-ORGANIZATION (1).
071300     MOVE   "S"  TO XLABEL-TYPE (1).
071400*
071500*    OPEN THE FILE IN THE OUTPUT MODE
071600*
071700 SEQ-INIT-01.
071800     MOVE    0 TO REC-CT.
071900     MOVE   "*" TO DECL-EXEC-SW.
072000     MOVE   "**" TO SQ-FS4-STATUS.
072100     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
072200     MOVE    ZERO TO XRECORD-NUMBER (1).
072300     MOVE   "OPEN, CREATE FILE"  TO FEATURE.
072400     MOVE   "SEQ-TEST-OP-01" TO PAR-NAME.
072500     GO TO   SEQ-TEST-OP-01.
072600 SEQ-DELETE-01.
072700     MOVE   "*" TO DELETE-SW-1.
072800     GO TO   SEQ-DELETE-01-01.
072900 SEQ-TEST-OP-01.
073000     OPEN    OUTPUT SQ-FS4.
073100*
073200*    CHECK I-O STATUS RETURNED FROM OPEN OUTPUT
073300*
073400     ADD    1 TO REC-CT.
073500     IF DELETE-SW NOT = SPACE
073600         GO TO   SEQ-DELETE-01-01.
073700     GO TO   SEQ-TEST-OP-01-01.
073800 SEQ-DELETE-01-01.
073900     PERFORM DE-LETE.
074000     GO TO   SEQ-TEST-01-01-END.
074100 SEQ-TEST-OP-01-01.
074200     IF SQ-FS4-STATUS = "00"
074300         PERFORM PASS
074400     ELSE
074500         MOVE    SQ-FS4-STATUS TO COMPUTED-A
074600         MOVE   "00" TO CORRECT-A
074700         MOVE   "UNEXPECTED ERROR CODE FROM OPEN OUTPUT"
074800                   TO RE-MARK
074900         MOVE   "VII-3, VII-43" TO ANSI-REFERENCE
075000         PERFORM FAIL.
075100 SEQ-TEST-01-01-END.
075200*
075300*    CHECK EXECUTION OF I-O DECLARATIVE
075400*
075500     ADD     1 TO REC-CT.
075600     IF DELETE-SW NOT = SPACE
075700         GO TO   SEQ-DELETE-01-02.
075800     GO TO   SEQ-TEST-OP-01-02.
075900 SEQ-DELETE-01-02.
076000     PERFORM DE-LETE.
076100     GO TO   SEQ-TEST-01-02-END.
076200 SEQ-TEST-OP-01-02.
076300     IF DECL-EXEC-I-O = "NOT EXECUTED"
076400         PERFORM PASS
076500     ELSE
076600         MOVE    DECL-EXEC-I-O TO COMPUTED-A
076700         MOVE   "NOT EXECUTED" TO CORRECT-A
076800         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
076900                   TO RE-MARK
077000         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
077100         PERFORM FAIL.
077200 SEQ-TEST-01-02-END.
077300*
077400*
077500*    A NEW FILE IS OPEN.  WE NOW WRITE ONE RECORD OF 120 CHARS.
077600*
077700 SEQ-INIT-02.
077800     MOVE    0 TO REC-CT.
077900     MOVE   "*" TO DECL-EXEC-SW.
078000     ADD     1 TO XRECORD-NUMBER (1).
078100     MOVE   "**" TO SQ-FS4-STATUS.
078200     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
078300     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-FS4R1-F-G-120.
078400     MOVE   "987654321123456789" TO EXT-18.
078500     MOVE    120 TO SQ-FS4-RECSIZE.
078600     MOVE   "WRITE A RECORD"  TO FEATURE.
078700     MOVE   "SEQ-TEST-WR-02" TO PAR-NAME.
078800     IF DELETE-SW NOT EQUAL TO SPACE
078900         GO TO SEQ-DELETE-02.
079000     GO TO   SEQ-TEST-WR-02.
079100 SEQ-DELETE-02.
079200     MOVE   "*" TO DELETE-SW-2.
079300     GO TO   SEQ-DELETE-02-01.
079400 SEQ-TEST-WR-02.
079500     WRITE   SQ-FS4R2-F-G-138.
079600*
079700*    CHECK I-O STATUS RETURNED FROM WRITE
079800*
079900     ADD    1 TO REC-CT.
080000     IF DELETE-SW NOT = SPACE
080100         GO TO   SEQ-DELETE-02-01.
080200     GO TO   SEQ-TEST-WR-02-01.
080300 SEQ-DELETE-02-01.
080400     PERFORM DE-LETE.
080500     GO TO   SEQ-TEST-02-01-END.
080600 SEQ-TEST-WR-02-01.
080700     IF SQ-FS4-STATUS = "00"
080800         PERFORM PASS
080900     ELSE
081000         MOVE    SQ-FS4-STATUS TO COMPUTED-A
081100         MOVE   "00" TO CORRECT-A
081200         MOVE   "UNEXPECTED ERROR CODE FROM WRITE"
081300                   TO RE-MARK
081400         MOVE   "VII-3, VII-53" TO ANSI-REFERENCE
081500         PERFORM FAIL.
081600 SEQ-TEST-02-01-END.
081700*
081800*    CHECK EXECUTION OF I-O DECLARATIVE
081900*
082000     ADD     1 TO REC-CT.
082100     IF DELETE-SW NOT = SPACE
082200         GO TO   SEQ-DELETE-02-02.
082300     GO TO   SEQ-TEST-WR-02-02.
082400 SEQ-DELETE-02-02.
082500     PERFORM DE-LETE.
082600     GO TO   SEQ-TEST-02-02-END.
082700 SEQ-TEST-WR-02-02.
082800     IF DECL-EXEC-I-O = "NOT EXECUTED"
082900         PERFORM PASS
083000     ELSE
083100         MOVE    DECL-EXEC-I-O TO COMPUTED-A
083200         MOVE   "NOT EXECUTED" TO CORRECT-A
083300         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
083400                   TO RE-MARK
083500         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
083600         PERFORM FAIL.
083700 SEQ-TEST-02-02-END.
083800*
083900*
084000*    NOW CLOSE THE FILE.
084100*
084200 SEQ-INIT-03.
084300     MOVE    0 TO REC-CT.
084400     MOVE   "*" TO DECL-EXEC-SW.
084500     MOVE   "**" TO SQ-FS4-STATUS.
084600     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
084700     MOVE   "CLOSE FILE" TO FEATURE.
084800     MOVE   "SEQ-TEST-CL-03" TO PAR-NAME.
084900     IF DELETE-SW NOT EQUAL TO SPACE
085000         GO TO SEQ-DELETE-03.
085100     GO TO   SEQ-TEST-CL-03.
085200 SEQ-DELETE-03.
085300     MOVE   "*" TO DELETE-SW-2.
085400     GO TO   SEQ-DELETE-03-01.
085500 SEQ-TEST-CL-03.
085600     CLOSE   SQ-FS4.
085700*
085800*    CHECK I-O STATUS RETURNED FROM CLOSE
085900*
086000     ADD    1 TO REC-CT.
086100     IF DELETE-SW NOT = SPACE
086200         GO TO   SEQ-DELETE-03-01.
086300     GO TO   SEQ-TEST-CL-03-01.
086400 SEQ-DELETE-03-01.
086500     PERFORM DE-LETE.
086600     GO TO   SEQ-TEST-03-01-END.
086700 SEQ-TEST-CL-03-01.
086800     IF SQ-FS4-STATUS = "00"
086900         PERFORM PASS
087000     ELSE
087100         MOVE    SQ-FS4-STATUS TO COMPUTED-A
087200         MOVE   "00" TO CORRECT-A
087300         MOVE   "UNEXPECTED ERROR CODE FROM CLOSE"
087400                   TO RE-MARK
087500         MOVE   "VII-3, VII-38,4.2.4(4)" TO ANSI-REFERENCE
087600         PERFORM FAIL.
087700 SEQ-TEST-03-01-END.
087800*
087900*    CHECK EXECUTION OF I-O DECLARATIVE
088000*
088100     ADD     1 TO REC-CT.
088200     IF DELETE-SW NOT = SPACE
088300         GO TO   SEQ-DELETE-03-02.
088400     GO TO   SEQ-TEST-CL-03-02.
088500 SEQ-DELETE-03-02.
088600     PERFORM DE-LETE.
088700     GO TO   SEQ-TEST-03-02-END.
088800 SEQ-TEST-CL-03-02.
088900     IF DECL-EXEC-I-O = "NOT EXECUTED"
089000         PERFORM PASS
089100     ELSE
089200         MOVE    DECL-EXEC-I-O TO COMPUTED-A
089300         MOVE   "NOT EXECUTED" TO CORRECT-A
089400         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
089500                   TO RE-MARK
089600         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
089700         PERFORM FAIL.
089800 SEQ-TEST-03-02-END.
089900     MOVE    SPACE TO DELETE-SW-2.
090000*
090100*
090200*    OPEN THE FILE IN THE I-O MODE
090300*
090400 SEQ-INIT-04.
090500     MOVE    0 TO REC-CT.
090600     MOVE   "*" TO DECL-EXEC-SW.
090700     MOVE   "**" TO SQ-FS4-STATUS.
090800     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
090900     MOVE    ZERO TO XRECORD-NUMBER (1).
091000     MOVE   "OPEN FILE FOR I-O" TO FEATURE.
091100     MOVE   "SEQ-TEST-OP-04" TO PAR-NAME.
091200     IF DELETE-SW NOT = SPACE
091300         GO TO SEQ-DELETE-04-01.
091400     GO TO   SEQ-TEST-OP-04.
091500 SEQ-DELETE-04.
091600     MOVE   "*" TO DELETE-SW-2.
091700     GO TO   SEQ-DELETE-04-01.
091800 SEQ-TEST-OP-04.
091900     OPEN    I-O SQ-FS4.
092000*
092100*    CHECK I-O STATUS RETURNED FROM OPEN I-O
092200*
092300     ADD    1 TO REC-CT.
092400     IF DELETE-SW NOT = SPACE
092500         GO TO   SEQ-DELETE-04-01.
092600     GO TO   SEQ-TEST-OP-04-01.
092700 SEQ-DELETE-04-01.
092800     PERFORM DE-LETE.
092900     GO TO   SEQ-TEST-04-01-END.
093000 SEQ-TEST-OP-04-01.
093100     IF SQ-FS4-STATUS = "00"
093200         PERFORM PASS
093300     ELSE
093400         MOVE    SQ-FS4-STATUS TO COMPUTED-A
093500         MOVE   "00" TO CORRECT-A
093600         MOVE   "UNEXPECTED I-O STATUS CODE FROM OPEN I-O"
093700                   TO RE-MARK
093800         MOVE   "VII-3, VII-40" TO ANSI-REFERENCE
093900         PERFORM FAIL.
094000 SEQ-TEST-04-01-END.
094100*
094200     ADD     1 TO REC-CT.
094300     IF DELETE-SW NOT = SPACE
094400         GO TO   SEQ-DELETE-04-02.
094500     GO TO   SEQ-TEST-OP-04-02.
094600 SEQ-DELETE-04-02.
094700     PERFORM DE-LETE.
094800     GO TO   SEQ-TEST-04-02-END.
094900 SEQ-TEST-OP-04-02.
095000     IF DECL-EXEC-I-O = "NOT EXECUTED"
095100         PERFORM PASS
095200     ELSE
095300         MOVE    DECL-EXEC-I-O TO COMPUTED-A
095400         MOVE   "NOT EXECUTED" TO CORRECT-A
095500         MOVE  "UNEXPECTED EXECUTION OF I-O DECLARATIVE ON OPEN"
095600                   TO RE-MARK
095700         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
095800         PERFORM FAIL.
095900 SEQ-TEST-04-02-END.
096000*
096100*
096200*    THE FILE IS OPEN FOR I-O.  WE READ THE ONLY RECORD.
096300*
096400 SEQ-INIT-05.
096500     MOVE    0 TO REC-CT.
096600     MOVE   "*" TO DECL-EXEC-SW.
096700     ADD     1 TO XRECORD-NUMBER (1).
096800     MOVE   "**" TO SQ-FS4-STATUS.
096900     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
097000     MOVE    ZERO TO SQ-FS4-RECSIZE.
097100     MOVE    SPACE TO SQ-FS4R2-F-G-138.
097200     MOVE   "READ FIRST RECORD" TO FEATURE.
097300     MOVE   "SEQ-TEST-RD-05" TO PAR-NAME.
097400     IF DELETE-SW NOT EQUAL TO SPACE
097500         GO TO SEQ-DELETE-05.
097600     GO TO   SEQ-TEST-RD-05.
097700 SEQ-DELETE-05.
097800     MOVE   "*" TO DELETE-SW-2.
097900     GO TO   SEQ-DELETE-05-01.
098000 SEQ-TEST-RD-05.
098100     READ    SQ-FS4.
098200*
098300*    CHECK I-O STATUS RETURNED FROM READ
098400*
098500     ADD    1 TO REC-CT.
098600     IF DELETE-SW NOT = SPACE
098700         GO TO   SEQ-DELETE-05-01.
098800     GO TO   SEQ-TEST-RD-05-01.
098900 SEQ-DELETE-05-01.
099000     PERFORM DE-LETE.
099100     GO TO   SEQ-TEST-05-01-END.
099200 SEQ-TEST-RD-05-01.
099300     IF SQ-FS4-STATUS = "00"
099400         PERFORM PASS
099500     ELSE
099600         MOVE    SQ-FS4-STATUS TO COMPUTED-A
099700         MOVE   "00" TO CORRECT-A
099800         MOVE   "UNEXPECTED STATUS CODE FROM READ"
099900                   TO RE-MARK
100000         MOVE   "VII-3, VII-44" TO ANSI-REFERENCE
100100         PERFORM FAIL.
100200 SEQ-TEST-05-01-END.
100300*
100400*    CHECK EXECUTION OF I-O DECLARATIVE
100500*
100600     ADD     1 TO REC-CT.
100700     IF DELETE-SW NOT = SPACE
100800         GO TO   SEQ-DELETE-05-02.
100900     GO TO   SEQ-TEST-RD-05-02.
101000 SEQ-DELETE-05-02.
101100     PERFORM DE-LETE.
101200     GO TO   SEQ-TEST-05-02-END.
101300 SEQ-TEST-RD-05-02.
101400     IF DECL-EXEC-I-O = "NOT EXECUTED"
101500         PERFORM PASS
101600     ELSE
101700         MOVE    DECL-EXEC-I-O TO COMPUTED-A
101800         MOVE   "NOT EXECUTED" TO CORRECT-A
101900         MOVE   "UNEXPECTED EXECUTION OF I-O DECLARATIVE"
102000                   TO RE-MARK
102100         MOVE   "VII-2,1.3.5, VII-51,4.6.4(5)" TO ANSI-REFERENCE
102200         PERFORM FAIL.
102300 SEQ-TEST-05-02-END.
102400*
102500*    CHECK THAT THE CORRECT RECORD HAS BEEN RETURNED, BY
102600*    CHECKING THE RECORD-NUMBER FIELD.
102700*
102800     ADD     1 TO REC-CT.
102900     IF DELETE-SW NOT = SPACE
103000         GO TO   SEQ-DELETE-05-03.
103100     GO TO   SEQ-TEST-RD-05-03.
103200 SEQ-DELETE-05-03.
103300     PERFORM DE-LETE.
103400     GO TO   SEQ-TEST-05-03-END.
103500 SEQ-TEST-RD-05-03.
103600     IF FRECORD-NUMBER = XRECORD-NUMBER (1)
103700         PERFORM PASS
103800     ELSE
103900         MOVE    FRECORD-NUMBER TO COMPUTED-18V0
104000         MOVE    XRECORD-NUMBER (1) TO CORRECT-18V0
104100         MOVE   "INCORRECT RECORD NUMBER FOUND" TO RE-MARK
104200         PERFORM FAIL.
104300 SEQ-TEST-05-03-END.
104400*
104500*    CHECK THE LENGTH OF THE RECORD RETURNED
104600*
104700     ADD     1 TO REC-CT.
104800     IF DELETE-SW NOT = SPACE
104900         GO TO   SEQ-DELETE-05-04.
105000     GO TO   SEQ-TEST-RD-05-04.
105100 SEQ-DELETE-05-04.
105200     PERFORM DE-LETE.
105300     GO TO   SEQ-TEST-05-04-END.
105400 SEQ-TEST-RD-05-04.
105500     IF SQ-FS4-RECSIZE = 120
105600         PERFORM PASS
105700     ELSE
105800         MOVE    SQ-FS4-RECSIZE TO COMPUTED-18V0
105900         MOVE    120 TO CORRECT-18V0
106000         MOVE   "INCORRECT RECORD LENGTH RETURNED" TO RE-MARK
106100         MOVE   "VII-32, 3.8.4(11)" TO ANSI-REFERENCE
106200         PERFORM FAIL.
106300 SEQ-TEST-05-04-END.
106400     MOVE    SPACE TO DELETE-SW-2.
106500*
106600*
106700*    TRY TO WRITE A RECORD OF A DIFFERENT SIZE THAN READ
106800*
106900 SEQ-INIT-06.
107000     MOVE    0 TO REC-CT.
107100     MOVE    SPACE TO DECL-EXEC-SW.
107200     MOVE   "**" TO SQ-FS4-STATUS.
107300     MOVE   "NOT EXECUTED" TO DECL-EXEC-I-O.
107400     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-FS4R1-F-G-120.
107500     MOVE   "ABCDEFGHIJKLMNOPQR" TO EXT-18.
107600     MOVE    130 TO SQ-FS4-RECSIZE.
107700     MOVE   "REWRITE DIFFERENT SIZE REC" TO FEATURE.
107800     MOVE   "SEQ-TEST-RW-06" TO PAR-NAME.
107900     IF DELETE-SW NOT = SPACE
108000         GO TO SEQ-DELETE-06-01.
108100     GO TO   SEQ-TEST-RW-06.
108200 SEQ-DELETE-06.
108300     MOVE   "*" TO DELETE-SW-2.
108400     GO TO   SEQ-DELETE-06-01.
108500 SEQ-TEST-RW-06.
108600     REWRITE SQ-FS4R1-F-G-120.
108700     MOVE    0 TO REC-CT.
108800*
108900*    CHECK I-O STATUS RETURNED FROM REWRITE
109000*
109100     ADD    1 TO REC-CT.
109200     IF DELETE-SW NOT = SPACE
109300         GO TO   SEQ-DELETE-06-01.
109400     GO TO   SEQ-TEST-RW-06-01.
109500 SEQ-DELETE-06-01.
109600     PERFORM DE-LETE.
109700     GO TO   SEQ-TEST-06-01-END.
109800 SEQ-TEST-RW-06-01.
109900     IF SQ-FS4-STATUS = "44"
110000         PERFORM PASS
110100     ELSE
110200         MOVE    SQ-FS4-STATUS TO COMPUTED-A
110300         MOVE   "44" TO CORRECT-A
110400         MOVE   "UNEXPECTED STATUS CODE FROM REWRITE
110500-        "OF DIFF SZ REC THAN READ"
110600                   TO RE-MARK
110700         MOVE   "VII-41.3.5(4)D, VII-48" TO ANSI-REFERENCE
110800         PERFORM FAIL.
110900 SEQ-TEST-06-01-END.
111000 CCVS-EXIT SECTION.
111100 CCVS-999999.
111200     GO TO   CLOSE-FILES.
