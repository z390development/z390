000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     OBIC3A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*
002200*        THE SUBPROGRAM IC220 PRINTS THE RESULTS FOR THE TESTING
002300*    OF A SEGMENTED LEVEL 1 SORT PROGRAM AS A SUBPROGRAM.  IT IS
002400*    CALLED BY THE MAIN PROGRAM IC218 AND THE SUBPROGRAM IC219.
002500*    THE LINKAGE VARIABLE PRINT-FLAG INDICATES WHETHER THE
002600*    HEADING (FLAG=1), FOOTING (FLAG=3), OR A REPORT LINE (FLAG=2)
002700*    SHOULD BE PRINTED.
002800*
002900******************************************************************
003000 ENVIRONMENT DIVISION.
003100 CONFIGURATION SECTION.
003200 SOURCE-COMPUTER.
003300     XXXXX082.
003400 OBJECT-COMPUTER.
003500     XXXXX083.
003600 INPUT-OUTPUT SECTION.
003700 FILE-CONTROL.
003800     SELECT PRINT-FILE ASSIGN TO
003900     XXXXX055.
004000 DATA DIVISION.
004100 FILE SECTION.
004200 FD  PRINT-FILE.
004300 01  PRINT-REC PICTURE X(120).
004400 01  DUMMY-RECORD PICTURE X(120).
004500 WORKING-STORAGE SECTION.
004600 01  TEST-RESULTS.
004700     02 FILLER                   PIC X      VALUE SPACE.
004800     02 FEATURE                  PIC X(20)  VALUE SPACE.
004900     02 FILLER                   PIC X      VALUE SPACE.
005000     02 P-OR-F                   PIC X(5)   VALUE SPACE.
005100     02 FILLER                   PIC X      VALUE SPACE.
005200     02  PAR-NAME.
005300       03 FILLER                 PIC X(19)  VALUE SPACE.
005400       03  PARDOT-X              PIC X      VALUE SPACE.
005500       03 DOTVALUE               PIC 99     VALUE ZERO.
005600     02 FILLER                   PIC X(8)   VALUE SPACE.
005700     02 RE-MARK                  PIC X(61).
005800 01  TEST-COMPUTED.
005900     02 FILLER                   PIC X(30)  VALUE SPACE.
006000     02 FILLER                   PIC X(17)  VALUE
006100            "       COMPUTED=".
006200     02 COMPUTED-X.
006300     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
006400     03 COMPUTED-N               REDEFINES COMPUTED-A
006500                                 PIC -9(9).9(9).
006600     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
006700     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
006800     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
006900     03       CM-18V0 REDEFINES COMPUTED-A.
007000         04 COMPUTED-18V0                    PIC -9(18).
007100         04 FILLER                           PIC X.
007200     03 FILLER PIC X(50) VALUE SPACE.
007300 01  TEST-CORRECT.
007400     02 FILLER PIC X(30) VALUE SPACE.
007500     02 FILLER PIC X(17) VALUE "       CORRECT =".
007600     02 CORRECT-X.
007700     03 CORRECT-A                  PIC X(20) VALUE SPACE.
007800     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
007900     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
008000     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
008100     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
008200     03      CR-18V0 REDEFINES CORRECT-A.
008300         04 CORRECT-18V0                     PIC -9(18).
008400         04 FILLER                           PIC X.
008500     03 FILLER PIC X(2) VALUE SPACE.
008600     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
008700 01  CCVS-C-1.
008800     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
008900-    "SS  PARAGRAPH-NAME
009000-    "       REMARKS".
009100     02 FILLER                     PIC X(20)    VALUE SPACE.
009200 01  CCVS-C-2.
009300     02 FILLER                     PIC X        VALUE SPACE.
009400     02 FILLER                     PIC X(6)     VALUE "TESTED".
009500     02 FILLER                     PIC X(15)    VALUE SPACE.
009600     02 FILLER                     PIC X(4)     VALUE "FAIL".
009700     02 FILLER                     PIC X(94)    VALUE SPACE.
009800 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
009900 01  REC-CT                        PIC 99       VALUE ZERO.
010000 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
010100 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
010200 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
010300 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
010400 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
010500 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
010600 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
010700 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
010800 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
010900 01  CCVS-H-1.
011000     02  FILLER                    PIC X(39)    VALUE SPACES.
011100     02  FILLER                    PIC X(42)    VALUE
011200     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
011300     02  FILLER                    PIC X(39)    VALUE SPACES.
011400 01  CCVS-H-2A.
011500   02  FILLER                        PIC X(40)  VALUE SPACE.
011600   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
011700   02  FILLER                        PIC XXXX   VALUE
011800     "4.2 ".
011900   02  FILLER                        PIC X(28)  VALUE
012000            " COPY - NOT FOR DISTRIBUTION".
012100   02  FILLER                        PIC X(41)  VALUE SPACE.
012200
012300 01  CCVS-H-2B.
012400   02  FILLER                        PIC X(15)  VALUE
012500            "TEST RESULT OF ".
012600   02  TEST-ID                       PIC X(9).
012700   02  FILLER                        PIC X(4)   VALUE
012800            " IN ".
012900   02  FILLER                        PIC X(12)  VALUE
013000     " HIGH       ".
013100   02  FILLER                        PIC X(22)  VALUE
013200            " LEVEL VALIDATION FOR ".
013300   02  FILLER                        PIC X(58)  VALUE
013400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
013500 01  CCVS-H-3.
013600     02  FILLER                      PIC X(34)  VALUE
013700            " FOR OFFICIAL USE ONLY    ".
013800     02  FILLER                      PIC X(58)  VALUE
013900     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
014000     02  FILLER                      PIC X(28)  VALUE
014100            "  COPYRIGHT   1985 ".
014200 01  CCVS-E-1.
014300     02 FILLER                       PIC X(52)  VALUE SPACE.
014400     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
014500     02 ID-AGAIN                     PIC X(9).
014600     02 FILLER                       PIC X(45)  VALUE SPACES.
014700 01  CCVS-E-2.
014800     02  FILLER                      PIC X(31)  VALUE SPACE.
014900     02  FILLER                      PIC X(21)  VALUE SPACE.
015000     02 CCVS-E-2-2.
015100         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
015200         03 FILLER                   PIC X      VALUE SPACE.
015300         03 ENDER-DESC               PIC X(44)  VALUE
015400            "ERRORS ENCOUNTERED".
015500 01  CCVS-E-3.
015600     02  FILLER                      PIC X(22)  VALUE
015700            " FOR OFFICIAL USE ONLY".
015800     02  FILLER                      PIC X(12)  VALUE SPACE.
015900     02  FILLER                      PIC X(58)  VALUE
016000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
016100     02  FILLER                      PIC X(13)  VALUE SPACE.
016200     02 FILLER                       PIC X(15)  VALUE
016300             " COPYRIGHT 1985".
016400 01  CCVS-E-4.
016500     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
016600     02 FILLER                       PIC X(4)   VALUE " OF ".
016700     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
016800     02 FILLER                       PIC X(40)  VALUE
016900      "  TESTS WERE EXECUTED SUCCESSFULLY".
017000 01  XXINFO.
017100     02 FILLER                       PIC X(19)  VALUE
017200            "*** INFORMATION ***".
017300     02 INFO-TEXT.
017400       04 FILLER                     PIC X(8)   VALUE SPACE.
017500       04 XXCOMPUTED                 PIC X(20).
017600       04 FILLER                     PIC X(5)   VALUE SPACE.
017700       04 XXCORRECT                  PIC X(20).
017800     02 INF-ANSI-REFERENCE           PIC X(48).
017900 01  HYPHEN-LINE.
018000     02 FILLER  PIC IS X VALUE IS SPACE.
018100     02 FILLER  PIC IS X(65)    VALUE IS "************************
018200-    "*****************************************".
018300     02 FILLER  PIC IS X(54)    VALUE IS "************************
018400-    "******************************".
018500 01  CCVS-PGM-ID                     PIC X(9)   VALUE
018600     "OBIC3A".
018700 LINKAGE SECTION.
018800 01  PRINT-LINE-VALUES.
018900     02  PASS-OR-FAIL        PICTURE X(5).
019000     02  R-COUNT             PICTURE 99.
019100     02  FEATURE-TESTED      PICTURE X(20).
019200     02  COMPUTED-SORT-KEY   PICTURE X(20).
019300     02  CORRECT-SORT-KEY    PICTURE X(20).
019400     02  PARAGRAPH-NAME      PICTURE X(12).
019500 01  PRINT-FLAG              PICTURE 9.
019600 PROCEDURE DIVISION USING PRINT-LINE-VALUES  PRINT-FLAG.
019700 SECT-IC220-0001 SECTION.
019800 BOILER-PLATE.
019900     GO TO CCVS1-EXIT.
020000 CLOSE-FILES.
020100     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
020200 TERMINATE-CCVS.
020300S    EXIT PROGRAM.
020400STERMINATE-CALL.
020500     STOP     RUN.
020600 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
020700 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
020800 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
020900 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
021000     MOVE "****TEST DELETED****" TO RE-MARK.
021100 PRINT-DETAIL.
021200     IF REC-CT NOT EQUAL TO ZERO
021300             MOVE "." TO PARDOT-X
021400             MOVE REC-CT TO DOTVALUE.
021500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
021600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
021700        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
021800          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
021900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
022000     MOVE SPACE TO CORRECT-X.
022100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
022200     MOVE     SPACE TO RE-MARK.
022300 HEAD-ROUTINE.
022400     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
022500     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
022600     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
022700     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
022800 COLUMN-NAMES-ROUTINE.
022900     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
023000     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
023200 END-ROUTINE.
023300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
023400 END-RTN-EXIT.
023500     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023600 END-ROUTINE-1.
023700      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
023800      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
023900      ADD PASS-COUNTER TO ERROR-HOLD.
024000*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
024100      MOVE PASS-COUNTER TO CCVS-E-4-1.
024200      MOVE ERROR-HOLD TO CCVS-E-4-2.
024300      MOVE CCVS-E-4 TO CCVS-E-2-2.
024400      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
024500  END-ROUTINE-12.
024600      MOVE "TEST(S) FAILED" TO ENDER-DESC.
024700     IF       ERROR-COUNTER IS EQUAL TO ZERO
024800         MOVE "NO " TO ERROR-TOTAL
024900         ELSE
025000         MOVE ERROR-COUNTER TO ERROR-TOTAL.
025100     MOVE     CCVS-E-2 TO DUMMY-RECORD.
025200     PERFORM WRITE-LINE.
025300 END-ROUTINE-13.
025400     IF DELETE-COUNTER IS EQUAL TO ZERO
025500         MOVE "NO " TO ERROR-TOTAL  ELSE
025600         MOVE DELETE-COUNTER TO ERROR-TOTAL.
025700     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
025800     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025900      IF   INSPECT-COUNTER EQUAL TO ZERO
026000          MOVE "NO " TO ERROR-TOTAL
026100      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
026200      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
026300      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026400     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026500 WRITE-LINE.
026600     ADD 1 TO RECORD-COUNT.
026700Y    IF RECORD-COUNT GREATER 50
026800Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
026900Y        MOVE SPACE TO DUMMY-RECORD
027000Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
027100Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
027200Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
027300Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
027400Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
027500Y        MOVE ZERO TO RECORD-COUNT.
027600     PERFORM WRT-LN.
027700 WRT-LN.
027800     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
027900     MOVE SPACE TO DUMMY-RECORD.
028000 BLANK-LINE-PRINT.
028100     PERFORM WRT-LN.
028200 FAIL-ROUTINE.
028300     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
028400     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
028500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
028600     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
028700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028800     MOVE   SPACES TO INF-ANSI-REFERENCE.
028900     GO TO  FAIL-ROUTINE-EX.
029000 FAIL-ROUTINE-WRITE.
029100     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
029200     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
029300     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
029400     MOVE   SPACES TO COR-ANSI-REFERENCE.
029500 FAIL-ROUTINE-EX. EXIT.
029600 BAIL-OUT.
029700     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
029800     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
029900 BAIL-OUT-WRITE.
030000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
030100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
030200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030300     MOVE   SPACES TO INF-ANSI-REFERENCE.
030400 BAIL-OUT-EX. EXIT.
030500 CCVS1-EXIT.
030600     EXIT.
030700 SECT-IC220-0002 SECTION.
030800 BRANCH-STATEMENT.
030900     GO TO PRINT-HEADING  PROCESS-LINE  PRINT-FOOTING
031000         DEPENDING ON PRINT-FLAG.
031100     MOVE "ERROR IN PRINT-FLAG" TO DUMMY-RECORD.
031200     PERFORM WRITE-LINE.
031300     GO TO IC220-EXIT.
031400 PRINT-HEADING.
031500     MOVE 0 TO R-COUNT.
031600 OPEN-FILES.
031700     OPEN     OUTPUT PRINT-FILE.
031800     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
031900     MOVE    SPACE TO TEST-RESULTS.
032000     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
032100     GO TO IC220-EXIT.
032200 PRINT-FOOTING.
032300     PERFORM CLOSE-FILES.
032400     GO TO IC220-EXIT.
032500 PROCESS-LINE.
032600     IF PASS-OR-FAIL EQUAL TO "PASS "
032700         PERFORM PASS
032800             ELSE PERFORM FAIL
032900                  MOVE COMPUTED-SORT-KEY TO COMPUTED-A
033000                  MOVE CORRECT-SORT-KEY TO CORRECT-A.
033100     MOVE R-COUNT TO REC-CT.
033200     MOVE FEATURE-TESTED TO FEATURE.
033300     MOVE PARAGRAPH-NAME TO PAR-NAME.
033400     PERFORM PRINT-DETAIL.
033500 IC220-EXIT.
033600     EXIT PROGRAM.
