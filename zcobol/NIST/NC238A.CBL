000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     NC238A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*
002200*    PROGRAM NC238A TESTS FORMATS 1 AND 2 OF THE "SEARCH"      *
002300*    STATEMENT USING A TWO-DIMENDIONAL TABLE WITH ASCENDING    *
002400*    AND DESCENDING KEYS AND MULTIPLE INDICES.  SINGLE AND     *
002500*    MULTIPLE CONDITIONS ARE USED IN THE "WHEN" PHRASE.        *
002600*                                                              *
002700****************************************************************
002800 ENVIRONMENT DIVISION.
002900 CONFIGURATION SECTION.
003000 SOURCE-COMPUTER.
003100     XXXXX082.
003200 OBJECT-COMPUTER.
003300     XXXXX083.
003400 INPUT-OUTPUT SECTION.
003500 FILE-CONTROL.
003600     SELECT PRINT-FILE ASSIGN TO
003700     XXXXX055.
003800 DATA DIVISION.
003900 FILE SECTION.
004000 FD  PRINT-FILE.
004100 01  PRINT-REC PICTURE X(120).
004200 01  DUMMY-RECORD PICTURE X(120).
004300 WORKING-STORAGE SECTION.
004400 77  SUB-1              PICTURE S99  VALUE ZERO.
004500 77  SUB-2              PICTURE 99   VALUE ZERO.
004600 77  SUB-3              PICTURE 99   VALUE ZERO.
004700 77  CON-7              PICTURE 99  VALUE 07.
004800 77  CON-10             PICTURE 99  VALUE 10.
004900 77  GRP-HOLD-AREA                PICTURE X(5)  VALUE SPACES.
005000 77  CON-5              PICTURE 99  VALUE 05.
005100 77  SEC-HOLD-AREA                PICTURE X(11)  VALUE SPACES.
005200 77  CON-6              PICTURE 99  VALUE 06.
005300 77  ELEM-HOLD-AREA               PICTURE X(15)  VALUE SPACES.
005400 77  SUB-4  PICTURE 9 VALUE 9.
005500 77  SUB-5  PICTURE 9 VALUE 1.
005600 77  SUB-6  PICTURE 99 VALUE 01.
005700 77  LEVEL-HOLD   PICTURE X(4) VALUE SPACES.
005800 01  ALPHA-TABLE.
005900     02  FILLER   PICTURE X(4)  VALUE "PPPP".
006000     02  FILLER   PICTURE X(4)  VALUE "OOOO".
006100     02  FILLER   PICTURE X(4)  VALUE "NNNN".
006200     02  FILLER   PICTURE X(4)  VALUE "MMMM".
006300     02  FILLER   PICTURE X(4)  VALUE "LLLL".
006400     02  FILLER   PICTURE X(4)  VALUE "KKKK".
006500     02  FILLER   PICTURE X(4)  VALUE "JJJJ".
006600     02  FILLER   PICTURE X(4)  VALUE "IIII".
006700     02  FILLER   PICTURE X(4)  VALUE "HHHH".
006800     02  FILLER   PICTURE X(4)  VALUE "GGGG".
006900     02  FILLER   PICTURE X(4)  VALUE "FFFF".
007000     02  FILLER   PICTURE X(4)  VALUE "EEEE".
007100     02  FILLER   PICTURE X(4)  VALUE "DDDD".
007200     02  FILLER   PICTURE X(4)  VALUE "CCCC".
007300     02  FILLER   PICTURE X(4)  VALUE "BBBB".
007400     02  FILLER   PICTURE X(4)  VALUE "AAAA".
007500 01  ALPHA-BET-TABLE REDEFINES ALPHA-TABLE.
007600     02  ALPHA-BET OCCURS 16 TIMES PICTURE X(4).
007700
007800 01  SERIES-TABLE-2.
007900     02  1ST-ENTRY OCCURS 4 TIMES ASCENDING KEY IS FIELD-1 FIELD-2
008000         DESCENDING KEY IS FIELD-3  FIELD-4 INDEXED BY IDX-4
008100         IDX-5  IDX-6.
008200         03  FIELD-1  PICTURE 9.
008300         03  FIELD-2  PICTURE 9.
008400         03  FIELD-3  PICTURE 9.
008500         03  FIELD-4  PICTURE 9.
008600         03  2ND-ENTRY OCCURS 4 TIMES DESCENDING IS FIELD-5
008700             FIELD-6  FIELD-7  FIELD-8 INDEXED IDX-7 IDX-8 IDX-9.
008800             04  FIELD-5  PICTURE X.
008900             04  FIELD-6  PICTURE X.
009000             04  FIELD-7  PICTURE X.
009100             04  FIELD-8  PICTURE X.
009200 01  NOTE-1.
009300     02  FILLER                   PICTURE X(74)  VALUE
009400     "NOTE 1 - CORRECT AND COMPUTED DATA ARE EQUAL BUT THE AT END
009500-    "PATH WAS TAKEN".
009600     02  FILLER                   PICTURE X(46)  VALUE SPACES.
009700 01  NOTE-2.
009800     02  FILLER                   PICTURE X(112)  VALUE
009900     "NOTE 2 - CORRECT AND COMPUTED DATA ARE NOT EQUAL. THE COMPUT
010000-    "ED ENTRY WAS EXTRACTED FROM THE TABLE BY SUBSCRIPTS.".
010100     02  FILLER                   PICTURE X(8)  VALUE SPACES.
010200
010300 01  END-STMT.
010400     02  FILLER         PICTURE X(7)  VALUE "AT END ".
010500     02  END-IDX                  PICTURE X(5)  VALUE SPACES.
010600     02  FILLER                   PICTURE XXX  VALUE " = ".
010700     02  IDX-VALU                 PICTURE 99  VALUE 00.
010800     02  FILLER                   PICTURE XXX  VALUE SPACES.
010900 01  TEST-RESULTS.
011000     02 FILLER                   PIC X      VALUE SPACE.
011100     02 FEATURE                  PIC X(20)  VALUE SPACE.
011200     02 FILLER                   PIC X      VALUE SPACE.
011300     02 P-OR-F                   PIC X(5)   VALUE SPACE.
011400     02 FILLER                   PIC X      VALUE SPACE.
011500     02  PAR-NAME.
011600       03 FILLER                 PIC X(19)  VALUE SPACE.
011700       03  PARDOT-X              PIC X      VALUE SPACE.
011800       03 DOTVALUE               PIC 99     VALUE ZERO.
011900     02 FILLER                   PIC X(8)   VALUE SPACE.
012000     02 RE-MARK                  PIC X(61).
012100 01  TEST-COMPUTED.
012200     02 FILLER                   PIC X(30)  VALUE SPACE.
012300     02 FILLER                   PIC X(17)  VALUE
012400            "       COMPUTED=".
012500     02 COMPUTED-X.
012600     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
012700     03 COMPUTED-N               REDEFINES COMPUTED-A
012800                                 PIC -9(9).9(9).
012900     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
013000     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
013100     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
013200     03       CM-18V0 REDEFINES COMPUTED-A.
013300         04 COMPUTED-18V0                    PIC -9(18).
013400         04 FILLER                           PIC X.
013500     03 FILLER PIC X(50) VALUE SPACE.
013600 01  TEST-CORRECT.
013700     02 FILLER PIC X(30) VALUE SPACE.
013800     02 FILLER PIC X(17) VALUE "       CORRECT =".
013900     02 CORRECT-X.
014000     03 CORRECT-A                  PIC X(20) VALUE SPACE.
014100     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
014200     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
014300     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
014400     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
014500     03      CR-18V0 REDEFINES CORRECT-A.
014600         04 CORRECT-18V0                     PIC -9(18).
014700         04 FILLER                           PIC X.
014800     03 FILLER PIC X(2) VALUE SPACE.
014900     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
015000 01  CCVS-C-1.
015100     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
015200-    "SS  PARAGRAPH-NAME
015300-    "       REMARKS".
015400     02 FILLER                     PIC X(20)    VALUE SPACE.
015500 01  CCVS-C-2.
015600     02 FILLER                     PIC X        VALUE SPACE.
015700     02 FILLER                     PIC X(6)     VALUE "TESTED".
015800     02 FILLER                     PIC X(15)    VALUE SPACE.
015900     02 FILLER                     PIC X(4)     VALUE "FAIL".
016000     02 FILLER                     PIC X(94)    VALUE SPACE.
016100 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
016200 01  REC-CT                        PIC 99       VALUE ZERO.
016300 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
016400 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
016500 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
016600 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
016700 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
016800 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
016900 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
017000 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
017100 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
017200 01  CCVS-H-1.
017300     02  FILLER                    PIC X(39)    VALUE SPACES.
017400     02  FILLER                    PIC X(42)    VALUE
017500     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
017600     02  FILLER                    PIC X(39)    VALUE SPACES.
017700 01  CCVS-H-2A.
017800   02  FILLER                        PIC X(40)  VALUE SPACE.
017900   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
018000   02  FILLER                        PIC XXXX   VALUE
018100     "4.2 ".
018200   02  FILLER                        PIC X(28)  VALUE
018300            " COPY - NOT FOR DISTRIBUTION".
018400   02  FILLER                        PIC X(41)  VALUE SPACE.
018500
018600 01  CCVS-H-2B.
018700   02  FILLER                        PIC X(15)  VALUE
018800            "TEST RESULT OF ".
018900   02  TEST-ID                       PIC X(9).
019000   02  FILLER                        PIC X(4)   VALUE
019100            " IN ".
019200   02  FILLER                        PIC X(12)  VALUE
019300     " HIGH       ".
019400   02  FILLER                        PIC X(22)  VALUE
019500            " LEVEL VALIDATION FOR ".
019600   02  FILLER                        PIC X(58)  VALUE
019700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
019800 01  CCVS-H-3.
019900     02  FILLER                      PIC X(34)  VALUE
020000            " FOR OFFICIAL USE ONLY    ".
020100     02  FILLER                      PIC X(58)  VALUE
020200     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
020300     02  FILLER                      PIC X(28)  VALUE
020400            "  COPYRIGHT   1985 ".
020500 01  CCVS-E-1.
020600     02 FILLER                       PIC X(52)  VALUE SPACE.
020700     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
020800     02 ID-AGAIN                     PIC X(9).
020900     02 FILLER                       PIC X(45)  VALUE SPACES.
021000 01  CCVS-E-2.
021100     02  FILLER                      PIC X(31)  VALUE SPACE.
021200     02  FILLER                      PIC X(21)  VALUE SPACE.
021300     02 CCVS-E-2-2.
021400         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
021500         03 FILLER                   PIC X      VALUE SPACE.
021600         03 ENDER-DESC               PIC X(44)  VALUE
021700            "ERRORS ENCOUNTERED".
021800 01  CCVS-E-3.
021900     02  FILLER                      PIC X(22)  VALUE
022000            " FOR OFFICIAL USE ONLY".
022100     02  FILLER                      PIC X(12)  VALUE SPACE.
022200     02  FILLER                      PIC X(58)  VALUE
022300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
022400     02  FILLER                      PIC X(13)  VALUE SPACE.
022500     02 FILLER                       PIC X(15)  VALUE
022600             " COPYRIGHT 1985".
022700 01  CCVS-E-4.
022800     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
022900     02 FILLER                       PIC X(4)   VALUE " OF ".
023000     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
023100     02 FILLER                       PIC X(40)  VALUE
023200      "  TESTS WERE EXECUTED SUCCESSFULLY".
023300 01  XXINFO.
023400     02 FILLER                       PIC X(19)  VALUE
023500            "*** INFORMATION ***".
023600     02 INFO-TEXT.
023700       04 FILLER                     PIC X(8)   VALUE SPACE.
023800       04 XXCOMPUTED                 PIC X(20).
023900       04 FILLER                     PIC X(5)   VALUE SPACE.
024000       04 XXCORRECT                  PIC X(20).
024100     02 INF-ANSI-REFERENCE           PIC X(48).
024200 01  HYPHEN-LINE.
024300     02 FILLER  PIC IS X VALUE IS SPACE.
024400     02 FILLER  PIC IS X(65)    VALUE IS "************************
024500-    "*****************************************".
024600     02 FILLER  PIC IS X(54)    VALUE IS "************************
024700-    "******************************".
024800 01  CCVS-PGM-ID                     PIC X(9)   VALUE
024900     "NC238A".
025000 PROCEDURE DIVISION.
025100 CCVS1 SECTION.
025200 OPEN-FILES.
025300     OPEN     OUTPUT PRINT-FILE.
025400     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
025500     MOVE    SPACE TO TEST-RESULTS.
025600     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
025700     GO TO CCVS1-EXIT.
025800 CLOSE-FILES.
025900     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
026000 TERMINATE-CCVS.
026100S    EXIT PROGRAM.
026200STERMINATE-CALL.
026300     STOP     RUN.
026400 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
026500 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
026600 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
026700 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
026800     MOVE "****TEST DELETED****" TO RE-MARK.
026900 PRINT-DETAIL.
027000     IF REC-CT NOT EQUAL TO ZERO
027100             MOVE "." TO PARDOT-X
027200             MOVE REC-CT TO DOTVALUE.
027300     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
027400     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
027500        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
027600          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
027700     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
027800     MOVE SPACE TO CORRECT-X.
027900     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
028000     MOVE     SPACE TO RE-MARK.
028100 HEAD-ROUTINE.
028200     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028300     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028400     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
028500     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
028600 COLUMN-NAMES-ROUTINE.
028700     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028800     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
029000 END-ROUTINE.
029100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
029200 END-RTN-EXIT.
029300     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029400 END-ROUTINE-1.
029500      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
029600      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
029700      ADD PASS-COUNTER TO ERROR-HOLD.
029800*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
029900      MOVE PASS-COUNTER TO CCVS-E-4-1.
030000      MOVE ERROR-HOLD TO CCVS-E-4-2.
030100      MOVE CCVS-E-4 TO CCVS-E-2-2.
030200      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
030300  END-ROUTINE-12.
030400      MOVE "TEST(S) FAILED" TO ENDER-DESC.
030500     IF       ERROR-COUNTER IS EQUAL TO ZERO
030600         MOVE "NO " TO ERROR-TOTAL
030700         ELSE
030800         MOVE ERROR-COUNTER TO ERROR-TOTAL.
030900     MOVE     CCVS-E-2 TO DUMMY-RECORD.
031000     PERFORM WRITE-LINE.
031100 END-ROUTINE-13.
031200     IF DELETE-COUNTER IS EQUAL TO ZERO
031300         MOVE "NO " TO ERROR-TOTAL  ELSE
031400         MOVE DELETE-COUNTER TO ERROR-TOTAL.
031500     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
031600     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031700      IF   INSPECT-COUNTER EQUAL TO ZERO
031800          MOVE "NO " TO ERROR-TOTAL
031900      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
032000      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
032100      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
032200     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
032300 WRITE-LINE.
032400     ADD 1 TO RECORD-COUNT.
032500Y    IF RECORD-COUNT GREATER 50
032600Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
032700Y        MOVE SPACE TO DUMMY-RECORD
032800Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
032900Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
033000Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
033100Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
033200Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
033300Y        MOVE ZERO TO RECORD-COUNT.
033400     PERFORM WRT-LN.
033500 WRT-LN.
033600     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
033700     MOVE SPACE TO DUMMY-RECORD.
033800 BLANK-LINE-PRINT.
033900     PERFORM WRT-LN.
034000 FAIL-ROUTINE.
034100     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
034200     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
034300     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
034400     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
034500     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034600     MOVE   SPACES TO INF-ANSI-REFERENCE.
034700     GO TO  FAIL-ROUTINE-EX.
034800 FAIL-ROUTINE-WRITE.
034900     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
035000     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
035100     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
035200     MOVE   SPACES TO COR-ANSI-REFERENCE.
035300 FAIL-ROUTINE-EX. EXIT.
035400 BAIL-OUT.
035500     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
035600     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
035700 BAIL-OUT-WRITE.
035800     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
035900     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
036000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036100     MOVE   SPACES TO INF-ANSI-REFERENCE.
036200 BAIL-OUT-EX. EXIT.
036300 CCVS1-EXIT.
036400     EXIT.
036500 SECT-NC238A-001 SECTION.
036600 TH-11-001.
036700     SET IDX-4  IDX-7 TO 01.
036800 BUILD-LOOP-1.
036900     MOVE SUB-5 TO FIELD-1 (IDX-4) FIELD-2 (IDX-4).
037000     MOVE SUB-4 TO FIELD-3 (IDX-4) FIELD-4 (IDX-4).
037100     PERFORM BUILD-ENTRY-2 THRU ENTRY-2-EXIT.
037200     IF 2ND-ENTRY (4, 4) EQUAL TO "AAAA" GO TO BUILD-EXIT.
037300     ADD 1 TO SUB-5.
037400     SUBTRACT 1 FROM SUB-4.
037500     SET IDX-4 UP BY 1.
037600     GO TO BUILD-LOOP-1.
037700 BUILD-ENTRY-2.
037800     MOVE ALPHA-BET (SUB-6) TO 2ND-ENTRY (IDX-4, IDX-7).
037900     IF IDX-7 EQUAL TO 4
038000         SET IDX-7 TO 1
038100         ADD 1 TO SUB-6
038200         GO TO ENTRY-2-EXIT.
038300     SET IDX-7 UP BY 1.
038400     ADD 1 TO SUB-6.
038500     GO TO BUILD-ENTRY-2.
038600 ENTRY-2-EXIT.
038700     EXIT.
038800 BUILD-EXIT.
038900     EXIT.
039000*
039100 SCH-INIT-F1-1.
039200     MOVE "SCH-TEST-F1-1" TO PAR-NAME.
039300     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
039400     MOVE "SEARCH" TO FEATURE.
039500     MOVE "IMPLIED VARYING OPTION" TO RE-MARK.
039600     SET IDX-4 TO 01.
039700 SCH-TEST-F1-1.
039800     SEARCH 1ST-ENTRY
039900         WHEN 1ST-ENTRY (IDX-4) EQUAL TO "2288LLLLKKKKJJJJIIII"
040000             MOVE 1ST-ENTRY (IDX-4) TO LEVEL-HOLD.
040100     IF LEVEL-HOLD EQUAL TO "2288"
040200         PERFORM PASS
040300         GO TO SCH-WRITE-F1-1.
040400     GO TO SCH-FAIL-F1-1.
040500 SCH-DELETE-F1-1.
040600     PERFORM DE-LETE.
040700     GO TO SCH-WRITE-F1-1.
040800 SCH-FAIL-F1-1.
040900     MOVE "2288" TO CORRECT-A.
041000     MOVE "ENTRY NOT FOUND" TO COMPUTED-A.
041100     PERFORM FAIL.
041200 SCH-WRITE-F1-1.
041300     PERFORM PRINT-DETAIL.
041400*
041500 SCH-INIT-F1-2.
041600     MOVE "SCH-TEST-F1-2" TO PAR-NAME.
041700     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
041800     MOVE "FORMAT 1 VARYING OPTION" TO RE-MARK.
041900     MOVE "SEARCH WHEN SERIES" TO FEATURE.
042000     SET IDX-5 TO 04.
042100 SCH-TEST-F1-2.
042200     SEARCH 1ST-ENTRY VARYING IDX-5
042300                      AT END MOVE SPACES TO LEVEL-HOLD
042400         WHEN FIELD-1 (IDX-5) EQUAL TO 3
042500             MOVE FIELD-1 (IDX-5) TO LEVEL-HOLD
042600         WHEN FIELD-4 (IDX-5) EQUAL TO 6
042700             MOVE FIELD-4 (IDX-5) TO LEVEL-HOLD.
042800     MOVE "FORMAT 1 W/0 VARYING" TO RE-MARK.
042900     IF LEVEL-HOLD EQUAL TO "6   "
043000         PERFORM PASS
043100         GO TO SCH-WRITE-F1-2.
043200     GO TO SCH-FAIL-F1-2.
043300 SCH-DELETE-F1-2.
043400     PERFORM DE-LETE.
043500     GO TO SCH-WRITE-F1-2.
043600 SCH-FAIL-F1-2.
043700     MOVE "6" TO CORRECT-A.
043800     MOVE LEVEL-HOLD TO COMPUTED-A.
043900     PERFORM FAIL.
044000 SCH-WRITE-F1-2.
044100     PERFORM PRINT-DETAIL.
044200*
044300 SCH-INIT-F1-3.
044400     MOVE "SCH-TEST-F1-3" TO PAR-NAME.
044500     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
044600     MOVE "SEARCH WHEN SERIES" TO FEATURE.
044700     SET IDX-5 TO 03.
044800     SET IDX-8 TO 01.
044900 SCH-TEST-F1-3.
045000     SEARCH 2ND-ENTRY VARYING IDX-8
045100                      AT END MOVE SPACES TO LEVEL-HOLD
045200         WHEN FIELD-7 (IDX-5, IDX-8) EQUAL TO "E"
045300             MOVE FIELD-7 (IDX-5, IDX-8) TO LEVEL-HOLD
045400         WHEN FIELD-5 (IDX-5, IDX-8) EQUAL TO "E"
045500             MOVE FIELD-5 (IDX-5, IDX-8) TO LEVEL-HOLD
045600         WHEN FIELD-8 (IDX-5, IDX-8) EQUAL TO "E"
045700             MOVE FIELD-8 (IDX-5, IDX-8) TO LEVEL-HOLD.
045800     IF LEVEL-HOLD EQUAL TO "E   "
045900         PERFORM PASS
046000         GO TO SCH-WRITE-F1-3.
046100     GO TO SCH-FAIL-F1-3.
046200 SCH-DELETE-F1-3.
046300     PERFORM DE-LETE.
046400     GO TO SCH-WRITE-F1-3.
046500 SCH-FAIL-F1-3.
046600     MOVE "E" TO CORRECT-A.
046700     MOVE LEVEL-HOLD TO COMPUTED-A.
046800     PERFORM FAIL.
046900 SCH-WRITE-F1-3.
047000     PERFORM PRINT-DETAIL.
047100*
047200 SCH-INIT-F1-4.
047300     MOVE "SCH-TEST-F1-4" TO PAR-NAME.
047400     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
047500     MOVE "SEARCH VARYING" TO FEATURE.
047600     MOVE "WHEN-COMPOUND CONDITION" TO RE-MARK.
047700     SET IDX-4 IDX-9 TO 04.
047800 SCH-TEST-F1-4.
047900     SEARCH 2ND-ENTRY VARYING IDX-9
048000                      AT END MOVE SPACES TO LEVEL-HOLD
048100         WHEN FIELD-6 (IDX-4, IDX-9) NOT EQUAL TO "A"
048200          AND FIELD-7 (IDX-4, IDX-9) NOT EQUAL TO "A"
048300              MOVE "A" TO LEVEL-HOLD.
048400     IF LEVEL-HOLD EQUAL TO SPACES
048500         PERFORM PASS
048600         GO TO SCH-WRITE-F1-4.
048700     GO TO SCH-FAIL-F1-4.
048800 SCH-DELETE-F1-4.
048900     PERFORM DE-LETE.
049000     GO TO SCH-WRITE-F1-4.
049100 SCH-FAIL-F1-4.
049200     MOVE LEVEL-HOLD TO COMPUTED-A.
049300     MOVE "NO SUCH ENTRY" TO CORRECT-A.
049400     PERFORM FAIL.
049500 SCH-WRITE-F1-4.
049600     PERFORM PRINT-DETAIL.
049700*
049800 SCH-INIT-F1-5.
049900     MOVE "SCH-TEST-F1-5" TO PAR-NAME.
050000     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
050100     MOVE "SEARCH WHEN SERIES" TO FEATURE.
050200     SET IDX-6 TO 02.
050300     SET IDX-7 TO 02.
050400 SCH-TEST-F1-5.
050500     SEARCH 2ND-ENTRY VARYING IDX-7
050600                      AT END MOVE SPACES TO LEVEL-HOLD
050700         WHEN FIELD-5 (IDX-6, IDX-7) EQUAL TO "M"
050800             MOVE FIELD-5 (IDX-6, IDX-7) TO LEVEL-HOLD
050900         WHEN FIELD-6 (IDX-6, IDX-7) EQUAL TO "N"
051000             MOVE FIELD-6 (IDX-6, IDX-7) TO LEVEL-HOLD
051100         WHEN FIELD-7 (IDX-6, IDX-7) EQUAL TO "O"
051200             MOVE FIELD-7 (IDX-6, IDX-7) TO LEVEL-HOLD
051300         WHEN FIELD-8 (IDX-6, IDX-7) EQUAL TO "I"
051400             MOVE FIELD-8 (IDX-6, IDX-7) TO LEVEL-HOLD.
051500     IF LEVEL-HOLD EQUAL TO "I   "
051600         PERFORM PASS
051700         GO TO SCH-WRITE-F1-5.
051800     GO TO SCH-FAIL-F1-5.
051900 SCH-DELETE-F1-5.
052000     PERFORM DE-LETE.
052100     GO TO SCH-WRITE-F1-5.
052200 SCH-FAIL-F1-5.
052300     MOVE "I" TO CORRECT-A.
052400     MOVE LEVEL-HOLD TO COMPUTED-A.
052500     PERFORM FAIL.
052600 SCH-WRITE-F1-5.
052700     PERFORM PRINT-DETAIL.
052800*
052900 SCH-INIT-F2-6.
053000     MOVE "SCH-TEST-F2-6" TO PAR-NAME.
053100     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
053200     MOVE "SEARCH ALL " TO FEATURE.
053300     MOVE "WHEN-COMPOUND CONDITION" TO RE-MARK.
053400 SCH-TEST-F2-6.
053500     SEARCH ALL 1ST-ENTRY
053600                      AT END MOVE SPACES TO LEVEL-HOLD
053700         WHEN FIELD-1 (IDX-4) EQUAL TO 2 AND
053800              FIELD-2 (IDX-4) EQUAL TO 2 MOVE 2 TO LEVEL-HOLD.
053900     IF LEVEL-HOLD EQUAL TO "2   "
054000         PERFORM PASS
054100         GO TO SCH-WRITE-F2-6.
054200     GO TO SCH-FAIL-F2-6.
054300 SCH-DELETE-F2-6.
054400     PERFORM DE-LETE.
054500     GO TO SCH-WRITE-F2-6.
054600 SCH-FAIL-F2-6.
054700     MOVE LEVEL-HOLD TO COMPUTED-A.
054800     MOVE "2" TO CORRECT-A.
054900     PERFORM FAIL.
055000 SCH-WRITE-F2-6.
055100     PERFORM PRINT-DETAIL.
055200*
055300 SCH-INIT-F2-7.
055400     MOVE "SCH-TEST-F2-7" TO PAR-NAME.
055500     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
055600     MOVE "SEARCH ALL " TO FEATURE.
055700 SCH-TEST-F2-7.
055800     SEARCH ALL 1ST-ENTRY
055900                      AT END MOVE SPACES TO LEVEL-HOLD
056000         WHEN FIELD-1 (IDX-4) EQUAL TO 4 AND
056100              FIELD-2 (IDX-4) EQUAL TO 4 AND
056200              FIELD-3 (IDX-4) EQUAL TO 6 AND
056300              FIELD-4 (IDX-4) EQUAL TO 6
056400              MOVE 6 TO LEVEL-HOLD.
056500     IF LEVEL-HOLD EQUAL TO "6   "
056600         PERFORM PASS
056700         GO TO SCH-WRITE-F2-7.
056800     GO TO SCH-FAIL-F2-7.
056900 SCH-DELETE-F2-7.
057000     PERFORM DE-LETE.
057100     GO TO SCH-WRITE-F2-7.
057200 SCH-FAIL-F2-7.
057300     MOVE LEVEL-HOLD TO COMPUTED-A.
057400     MOVE "6" TO CORRECT-A.
057500     PERFORM FAIL.
057600 SCH-WRITE-F2-7.
057700     PERFORM PRINT-DETAIL.
057800*
057900 SCH-INIT-F2-8.
058000     MOVE "SCH-TEST-F2-8" TO PAR-NAME.
058100     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
058200     MOVE "SEARCH ALL " TO FEATURE.
058300     MOVE SPACES TO LEVEL-HOLD.
058400     SET IDX-4 TO 01.
058500 SCH-TEST-F2-8.
058600     SEARCH ALL 2ND-ENTRY
058700         WHEN FIELD-5  (IDX-4, IDX-7) EQUAL TO "O" AND
058800              FIELD-6  (IDX-4, IDX-7) EQUAL TO "O" AND
058900              FIELD-7  (IDX-4, IDX-7) EQUAL TO "O" AND
059000              FIELD-8  (IDX-4, IDX-7) EQUAL TO "P"
059100             MOVE "OOOP" TO LEVEL-HOLD.
059200     IF LEVEL-HOLD EQUAL TO "OOOP"
059300         GO TO SCH-FAIL-F2-8.
059400     PERFORM PASS.
059500     GO TO SCH-WRITE-F2-8.
059600 SCH-DELETE-F2-8.
059700     PERFORM DE-LETE.
059800     GO TO SCH-WRITE-F2-8.
059900 SCH-FAIL-F2-8.
060000     MOVE "NO SUCH ENTRY" TO CORRECT-A
060100     MOVE LEVEL-HOLD TO COMPUTED-A
060200     PERFORM FAIL.
060300 SCH-WRITE-F2-8.
060400     PERFORM PRINT-DETAIL.
060500*
060600 SCH-INIT-F2-9.
060700     MOVE "SCH-TEST-F2-9" TO PAR-NAME.
060800     MOVE "VI-121 6.21.2" TO ANSI-REFERENCE.
060900     MOVE "SEARCH ALL " TO FEATURE.
061000     MOVE SPACES TO LEVEL-HOLD.
061100     SET IDX-4 TO 04.
061200 SCH-TEST-F2-9.
061300     SEARCH ALL 2ND-ENTRY
061400         WHEN FIELD-5 (IDX-4, IDX-7) EQUAL TO "B" AND
061500              FIELD-6 (IDX-4, IDX-7) EQUAL TO "B"
061600             MOVE "BB" TO LEVEL-HOLD.
061700     IF LEVEL-HOLD EQUAL TO "BB "
061800         PERFORM PASS
061900         GO TO SCH-WRITE-F2-9.
062000     GO TO SCH-FAIL-F2-9.
062100 SCH-DELETE-F2-9.
062200     PERFORM DE-LETE.
062300     GO TO SCH-WRITE-F2-9.
062400 SCH-FAIL-F2-9.
062500     MOVE "BB  " TO CORRECT-A.
062600     MOVE LEVEL-HOLD TO COMPUTED-A.
062700     PERFORM FAIL.
062800 SCH-WRITE-F2-9.
062900     PERFORM PRINT-DETAIL.
063000*
063100 SCH-INIT-F2-10.
063200*    ===-->  ARITHMETIC EXPRESSION OF ZERO  <--===
063300     MOVE "SCH-TEST-F2-10" TO PAR-NAME.
063400     MOVE   "VI-51 6.2" TO ANSI-REFERENCE.
063500     MOVE "SEARCH ALL " TO FEATURE.
063600     MOVE "ARITHMETIC EXPRESSION OF ZERO" TO RE-MARK.
063700 SCH-TEST-F2-10.
063800     SEARCH  ALL 1ST-ENTRY
063900             AT END  MOVE ZERO TO LEVEL-HOLD
064000        WHEN FIELD-1 (IDX-4) EQUAL TO ZERO
064100             MOVE    2 TO LEVEL-HOLD.
064200     IF      LEVEL-HOLD EQUAL TO ZERO
064300             PERFORM PASS
064400             GO TO   SCH-WRITE-F2-10.
064500     GO TO SCH-FAIL-F2-10.
064600 SCH-DELETE-F2-10.
064700     PERFORM DE-LETE.
064800     GO TO SCH-WRITE-F2-10.
064900 SCH-FAIL-F2-10.
065000     MOVE    LEVEL-HOLD TO COMPUTED-A.
065100     MOVE    ZERO TO CORRECT-A.
065200     PERFORM FAIL.
065300 SCH-WRITE-F2-10.
065400     PERFORM PRINT-DETAIL.
065500*
065600 CCVS-EXIT SECTION.
065700 CCVS-999999.
065800     GO TO CLOSE-FILES.
