000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IC201A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*        THE PROGRAM IC201 TESTS THE CALL STATEMENT WITH AN
002200*    IDENTIFIER AS AN OPERAND, AND FOUR OPERANDS IN THE
002300*    USING PHRASE.  THE REPETITION OF A DATA-NAME IN THE
002400*    USING PHRASE IS TESTED, AND THE USE OF THE ON OVERFLOW
002500*    PHRASE IN A CALL STATEMENT IS SYNTACTICALLY CHECKED
002600*    IN THE PROGRAM.
002700****************************************************************
002800 ENVIRONMENT DIVISION.
002900 CONFIGURATION SECTION.
003000 SOURCE-COMPUTER.
003100     XXXXX082.
003200 OBJECT-COMPUTER.
003300     XXXXX083.
003400 INPUT-OUTPUT SECTION.
003500 FILE-CONTROL.
003600     SELECT PRINT-FILE ASSIGN TO
003700     XXXXX055.
003800 DATA DIVISION.
003900 FILE SECTION.
004000 FD  PRINT-FILE.
004100 01  PRINT-REC PICTURE X(120).
004200 01  DUMMY-RECORD PICTURE X(120).
004300 WORKING-STORAGE SECTION.
004400 77  DN1 PICTURE S99  VALUE ZERO.
004500 77  DN3 PICTURE S99.
004600 77  ID1 PICTURE X(6) VALUE "IC202A".
004700 77  ID2 PICTURE X(6).
004800 77  DN2 PICTURE S99
004900         USAGE COMPUTATIONAL, VALUE ZERO.
005000 77  DN4 PICTURE S99
005100         USAGE IS COMPUTATIONAL.
005200 77  CALL-COUNT PIC S99.
005300 77  FAIL-FLAG PIC 9.
005400 01  TEST-RESULTS.
005500     02 FILLER                   PIC X      VALUE SPACE.
005600     02 FEATURE                  PIC X(20)  VALUE SPACE.
005700     02 FILLER                   PIC X      VALUE SPACE.
005800     02 P-OR-F                   PIC X(5)   VALUE SPACE.
005900     02 FILLER                   PIC X      VALUE SPACE.
006000     02  PAR-NAME.
006100       03 FILLER                 PIC X(19)  VALUE SPACE.
006200       03  PARDOT-X              PIC X      VALUE SPACE.
006300       03 DOTVALUE               PIC 99     VALUE ZERO.
006400     02 FILLER                   PIC X(8)   VALUE SPACE.
006500     02 RE-MARK                  PIC X(61).
006600 01  TEST-COMPUTED.
006700     02 FILLER                   PIC X(30)  VALUE SPACE.
006800     02 FILLER                   PIC X(17)  VALUE
006900            "       COMPUTED=".
007000     02 COMPUTED-X.
007100     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
007200     03 COMPUTED-N               REDEFINES COMPUTED-A
007300                                 PIC -9(9).9(9).
007400     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
007500     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
007600     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
007700     03       CM-18V0 REDEFINES COMPUTED-A.
007800         04 COMPUTED-18V0                    PIC -9(18).
007900         04 FILLER                           PIC X.
008000     03 FILLER PIC X(50) VALUE SPACE.
008100 01  TEST-CORRECT.
008200     02 FILLER PIC X(30) VALUE SPACE.
008300     02 FILLER PIC X(17) VALUE "       CORRECT =".
008400     02 CORRECT-X.
008500     03 CORRECT-A                  PIC X(20) VALUE SPACE.
008600     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
008700     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
008800     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
008900     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
009000     03      CR-18V0 REDEFINES CORRECT-A.
009100         04 CORRECT-18V0                     PIC -9(18).
009200         04 FILLER                           PIC X.
009300     03 FILLER PIC X(2) VALUE SPACE.
009400     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
009500 01  CCVS-C-1.
009600     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
009700-    "SS  PARAGRAPH-NAME
009800-    "       REMARKS".
009900     02 FILLER                     PIC X(20)    VALUE SPACE.
010000 01  CCVS-C-2.
010100     02 FILLER                     PIC X        VALUE SPACE.
010200     02 FILLER                     PIC X(6)     VALUE "TESTED".
010300     02 FILLER                     PIC X(15)    VALUE SPACE.
010400     02 FILLER                     PIC X(4)     VALUE "FAIL".
010500     02 FILLER                     PIC X(94)    VALUE SPACE.
010600 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
010700 01  REC-CT                        PIC 99       VALUE ZERO.
010800 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
010900 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
011000 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
011100 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
011200 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
011300 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
011400 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
011500 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
011600 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
011700 01  CCVS-H-1.
011800     02  FILLER                    PIC X(39)    VALUE SPACES.
011900     02  FILLER                    PIC X(42)    VALUE
012000     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
012100     02  FILLER                    PIC X(39)    VALUE SPACES.
012200 01  CCVS-H-2A.
012300   02  FILLER                        PIC X(40)  VALUE SPACE.
012400   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
012500   02  FILLER                        PIC XXXX   VALUE
012600     "4.2 ".
012700   02  FILLER                        PIC X(28)  VALUE
012800            " COPY - NOT FOR DISTRIBUTION".
012900   02  FILLER                        PIC X(41)  VALUE SPACE.
013000
013100 01  CCVS-H-2B.
013200   02  FILLER                        PIC X(15)  VALUE
013300            "TEST RESULT OF ".
013400   02  TEST-ID                       PIC X(9).
013500   02  FILLER                        PIC X(4)   VALUE
013600            " IN ".
013700   02  FILLER                        PIC X(12)  VALUE
013800     " HIGH       ".
013900   02  FILLER                        PIC X(22)  VALUE
014000            " LEVEL VALIDATION FOR ".
014100   02  FILLER                        PIC X(58)  VALUE
014200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
014300 01  CCVS-H-3.
014400     02  FILLER                      PIC X(34)  VALUE
014500            " FOR OFFICIAL USE ONLY    ".
014600     02  FILLER                      PIC X(58)  VALUE
014700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
014800     02  FILLER                      PIC X(28)  VALUE
014900            "  COPYRIGHT   1985 ".
015000 01  CCVS-E-1.
015100     02 FILLER                       PIC X(52)  VALUE SPACE.
015200     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
015300     02 ID-AGAIN                     PIC X(9).
015400     02 FILLER                       PIC X(45)  VALUE SPACES.
015500 01  CCVS-E-2.
015600     02  FILLER                      PIC X(31)  VALUE SPACE.
015700     02  FILLER                      PIC X(21)  VALUE SPACE.
015800     02 CCVS-E-2-2.
015900         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
016000         03 FILLER                   PIC X      VALUE SPACE.
016100         03 ENDER-DESC               PIC X(44)  VALUE
016200            "ERRORS ENCOUNTERED".
016300 01  CCVS-E-3.
016400     02  FILLER                      PIC X(22)  VALUE
016500            " FOR OFFICIAL USE ONLY".
016600     02  FILLER                      PIC X(12)  VALUE SPACE.
016700     02  FILLER                      PIC X(58)  VALUE
016800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
016900     02  FILLER                      PIC X(13)  VALUE SPACE.
017000     02 FILLER                       PIC X(15)  VALUE
017100             " COPYRIGHT 1985".
017200 01  CCVS-E-4.
017300     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
017400     02 FILLER                       PIC X(4)   VALUE " OF ".
017500     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
017600     02 FILLER                       PIC X(40)  VALUE
017700      "  TESTS WERE EXECUTED SUCCESSFULLY".
017800 01  XXINFO.
017900     02 FILLER                       PIC X(19)  VALUE
018000            "*** INFORMATION ***".
018100     02 INFO-TEXT.
018200       04 FILLER                     PIC X(8)   VALUE SPACE.
018300       04 XXCOMPUTED                 PIC X(20).
018400       04 FILLER                     PIC X(5)   VALUE SPACE.
018500       04 XXCORRECT                  PIC X(20).
018600     02 INF-ANSI-REFERENCE           PIC X(48).
018700 01  HYPHEN-LINE.
018800     02 FILLER  PIC IS X VALUE IS SPACE.
018900     02 FILLER  PIC IS X(65)    VALUE IS "************************
019000-    "*****************************************".
019100     02 FILLER  PIC IS X(54)    VALUE IS "************************
019200-    "******************************".
019300 01  CCVS-PGM-ID                     PIC X(9)   VALUE
019400     "IC201A".
019500 PROCEDURE DIVISION.
019600 CCVS1 SECTION.
019700 OPEN-FILES.
019800     OPEN     OUTPUT PRINT-FILE.
019900     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
020000     MOVE    SPACE TO TEST-RESULTS.
020100     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
020200     GO TO CCVS1-EXIT.
020300 CLOSE-FILES.
020400     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
020500 TERMINATE-CCVS.
020600S    EXIT PROGRAM.
020700STERMINATE-CALL.
020800     STOP     RUN.
020900 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
021000 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
021100 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
021200 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
021300     MOVE "****TEST DELETED****" TO RE-MARK.
021400 PRINT-DETAIL.
021500     IF REC-CT NOT EQUAL TO ZERO
021600             MOVE "." TO PARDOT-X
021700             MOVE REC-CT TO DOTVALUE.
021800     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
021900     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
022000        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
022100          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
022200     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
022300     MOVE SPACE TO CORRECT-X.
022400     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
022500     MOVE     SPACE TO RE-MARK.
022600 HEAD-ROUTINE.
022700     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
022800     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
022900     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
023000     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
023100 COLUMN-NAMES-ROUTINE.
023200     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
023300     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
023500 END-ROUTINE.
023600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
023700 END-RTN-EXIT.
023800     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023900 END-ROUTINE-1.
024000      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
024100      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
024200      ADD PASS-COUNTER TO ERROR-HOLD.
024300*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
024400      MOVE PASS-COUNTER TO CCVS-E-4-1.
024500      MOVE ERROR-HOLD TO CCVS-E-4-2.
024600      MOVE CCVS-E-4 TO CCVS-E-2-2.
024700      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
024800  END-ROUTINE-12.
024900      MOVE "TEST(S) FAILED" TO ENDER-DESC.
025000     IF       ERROR-COUNTER IS EQUAL TO ZERO
025100         MOVE "NO " TO ERROR-TOTAL
025200         ELSE
025300         MOVE ERROR-COUNTER TO ERROR-TOTAL.
025400     MOVE     CCVS-E-2 TO DUMMY-RECORD.
025500     PERFORM WRITE-LINE.
025600 END-ROUTINE-13.
025700     IF DELETE-COUNTER IS EQUAL TO ZERO
025800         MOVE "NO " TO ERROR-TOTAL  ELSE
025900         MOVE DELETE-COUNTER TO ERROR-TOTAL.
026000     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
026100     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026200      IF   INSPECT-COUNTER EQUAL TO ZERO
026300          MOVE "NO " TO ERROR-TOTAL
026400      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
026500      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
026600      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026700     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026800 WRITE-LINE.
026900     ADD 1 TO RECORD-COUNT.
027000Y    IF RECORD-COUNT GREATER 50
027100Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
027200Y        MOVE SPACE TO DUMMY-RECORD
027300Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
027400Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
027500Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
027600Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
027700Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
027800Y        MOVE ZERO TO RECORD-COUNT.
027900     PERFORM WRT-LN.
028000 WRT-LN.
028100     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
028200     MOVE SPACE TO DUMMY-RECORD.
028300 BLANK-LINE-PRINT.
028400     PERFORM WRT-LN.
028500 FAIL-ROUTINE.
028600     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
028700     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
028800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
028900     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
029000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029100     MOVE   SPACES TO INF-ANSI-REFERENCE.
029200     GO TO  FAIL-ROUTINE-EX.
029300 FAIL-ROUTINE-WRITE.
029400     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
029500     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
029600     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
029700     MOVE   SPACES TO COR-ANSI-REFERENCE.
029800 FAIL-ROUTINE-EX. EXIT.
029900 BAIL-OUT.
030000     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
030100     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
030200 BAIL-OUT-WRITE.
030300     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
030400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
030500     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030600     MOVE   SPACES TO INF-ANSI-REFERENCE.
030700 BAIL-OUT-EX. EXIT.
030800 CCVS1-EXIT.
030900     EXIT.
031000 SECT-IC201-0001 SECTION.
031100 CALL-TEST-01.
031200     MOVE "CALL-TEST-01" TO PAR-NAME.
031300     MOVE     "LEV 2 CALL STATEMENT" TO FEATURE.
031400     MOVE 0 TO CALL-COUNT.
031500*        THIS TEST HAS CALL STATEMENTS WITH AN IDENTIFIER
031600*    CONTAINING THE NAME OF THE SUBPROGRAM TO BE CALLED.
031700*        CALL-TEST-01 CONTAINS THE BASIC LEVEL 2 CALL STATEMENT.
031800*    IF IT CANNOT BE COMPILED AND EXECUTED CORRECTLY, THERE IS
031900*    NO USE IN RUNNING THE LEVEL 2 IPC ROUTINES.
032000 CALL-TEST-01-01.
032100     MOVE 1 TO REC-CT.
032200     MOVE ZERO TO DN3, DN4.
032300     CALL "IC202A" USING DN1, DN2, DN3, DN4.
032400     PERFORM CHECK-TEST-01.
032500     IF FAIL-FLAG EQUAL TO ZERO
032600         PERFORM PASS
032700         GO TO CALL-WRITE-01-01.
032800 CALL-FAIL-01-01.
032900     PERFORM FAIL.
033000     MOVE FAIL-FLAG TO COMPUTED-18V0.
033100     MOVE "NO. OF WRONG VALUES RETURNED" TO RE-MARK.
033200 CALL-WRITE-01-01.
033300     PERFORM PRINT-DETAIL.
033400 CALL-TEST-01-02.
033500     ADD 1 TO REC-CT.
033600     MOVE ZERO TO DN3, DN4.
033700     CALL ID1 USING DN1, DN2, DN3, DN4.
033800     PERFORM CHECK-TEST-01.
033900     IF FAIL-FLAG EQUAL TO ZERO
034000         PERFORM PASS
034100         GO TO CALL-WRITE-01-02.
034200 CALL-FAIL-01-02.
034300     PERFORM FAIL.
034400     MOVE FAIL-FLAG TO COMPUTED-18V0.
034500     MOVE "NO. OF WRONG VALUES RETURNED" TO RE-MARK.
034600 CALL-WRITE-01-02.
034700     PERFORM PRINT-DETAIL.
034800 CALL-TEST-01-03.
034900     ADD 1 TO REC-CT.
035000     MOVE ID1 TO ID2.
035100     MOVE ZERO TO DN3, DN4.
035200     CALL ID2 USING DN1 DN2 DN3 DN4.
035300     PERFORM CHECK-TEST-01.
035400     IF FAIL-FLAG EQUAL TO ZERO
035500         PERFORM PASS
035600         GO TO CALL-WRITE-01-03.
035700 CALL-FAIL-01-03.
035800     PERFORM FAIL.
035900     MOVE FAIL-FLAG TO COMPUTED-18V0.
036000     MOVE "NO. OF WRONG VALUES RETURNED" TO RE-MARK.
036100 CALL-WRITE-01-03.
036200     PERFORM PRINT-DETAIL.
036300 CALL-TEST-01-04.
036400     ADD 1 TO REC-CT.
036500     MOVE "IC202A" TO ID2.
036600     MOVE ZERO TO DN3, DN4.
036700     CALL ID2 USING DN1, DN2, DN3, DN4.
036800     PERFORM CHECK-TEST-01.
036900     IF FAIL-FLAG EQUAL TO ZERO
037000         PERFORM PASS
037100         GO TO CALL-WRITE-01-04.
037200 CALL-FAIL-01-04.
037300     PERFORM FAIL.
037400     MOVE FAIL-FLAG TO COMPUTED-18V0.
037500     MOVE "NO. OF WRONG VALUES RETURNED" TO RE-MARK.
037600 CALL-WRITE-01-04.
037700     PERFORM PRINT-DETAIL.
037800 CALL-TEST-02.
037900     MOVE "CALL-TEST-02" TO PAR-NAME.
038000     MOVE "DATA-NAME USED TWICE" TO FEATURE.
038100*        THIS TEST USES A DATA-NAME MORE THAN ONCE IN
038200*    A USING PHRASE OF A CALL STATEMENT.
038300 CALL-TEST-02-01.
038400     MOVE 1 TO REC-CT.
038500     MOVE 1 TO DN1.
038600     MOVE 0 TO DN2, DN3, DN4.
038700     CALL "IC202A" USING DN1, DN2, DN1, DN4.
038800     IF DN1 NOT EQUAL TO 2
038900         GO TO CALL-FAIL-02-01-1.
039000     IF DN2 NOT EQUAL TO 0
039100         GO TO CALL-FAIL-02-01-2.
039200     IF DN3 NOT EQUAL TO 0
039300         GO TO CALL-FAIL-02-01-3.
039400     IF DN4 NOT EQUAL TO 5
039500         GO TO CALL-FAIL-02-01-4.
039600     GO TO CALL-PASS-02-01.
039700 CALL-DELETE-02-01.
039800     PERFORM DE-LETE.
039900     GO TO CALL-WRITE-02-01.
040000 CALL-PASS-02-01.
040100     PERFORM PASS.
040200     GO TO CALL-WRITE-02-01.
040300 CALL-FAIL-02-01-1.
040400     MOVE DN1 TO COMPUTED-18V0.
040500     MOVE 2 TO CORRECT-18V0.
040600     MOVE "ERROR IN DN1 VALUE RETURNED" TO RE-MARK.
040700     GO TO CALL-FAIL-02-01.
040800 CALL-FAIL-02-01-2.
040900     MOVE DN2 TO COMPUTED-18V0.
041000     MOVE 0 TO CORRECT-18V0.
041100     MOVE "ERROR IN DN2 VALUE RETURNED" TO RE-MARK.
041200     GO TO CALL-FAIL-02-01.
041300 CALL-FAIL-02-01-3.
041400     MOVE DN3 TO COMPUTED-18V0.
041500     MOVE ZERO TO CORRECT-18V0.
041600     MOVE "DN3 VALUE CHANGED BY CALL" TO RE-MARK.
041700     GO TO CALL-FAIL-02-01.
041800 CALL-FAIL-02-01-4.
041900     MOVE DN4 TO COMPUTED-18V0.
042000     MOVE 5 TO CORRECT-18V0.
042100     MOVE "ERROR IN DN4 VALUE RETURNED" TO RE-MARK.
042200 CALL-FAIL-02-01.
042300     PERFORM FAIL.
042400 CALL-WRITE-02-01.
042500     PERFORM PRINT-DETAIL.
042600 CALL-TEST-02-02.
042700     ADD 1 TO REC-CT.
042800     MOVE 0 TO DN4, DN3, DN2, DN1.
042900     CALL ID1 USING DN1 DN2 DN3 DN2.
043000     IF DN1 NOT EQUAL TO 0
043100         GO TO CALL-FAIL-02-02-1.
043200     IF DN2 NOT EQUAL TO 6
043300         GO TO CALL-FAIL-02-02-2.
043400     IF DN3 NOT EQUAL TO 1
043500         GO TO CALL-FAIL-02-02-3.
043600     IF DN4 NOT EQUAL TO 0
043700         GO TO CALL-FAIL-02-02-4.
043800     GO TO CALL-PASS-02-02.
043900 CALL-DELETE-02-02.
044000     PERFORM DE-LETE.
044100     GO TO CALL-WRITE-02-02.
044200 CALL-PASS-02-02.
044300     PERFORM PASS.
044400     GO TO CALL-WRITE-02-02.
044500 CALL-FAIL-02-02-1.
044600     MOVE DN1 TO COMPUTED-18V0.
044700     MOVE ZERO TO CORRECT-18V0.
044800     MOVE "ERROR IN DN1 VALUE RETURNED" TO RE-MARK.
044900     GO TO CALL-FAIL-02-02.
045000 CALL-FAIL-02-02-2.
045100     MOVE DN2 TO COMPUTED-18V0.
045200     MOVE 6 TO CORRECT-18V0.
045300     MOVE "ERROR IN DN2 VALUE RETURNED" TO RE-MARK.
045400     GO TO CALL-FAIL-02-02.
045500 CALL-FAIL-02-02-3.
045600     MOVE DN3 TO COMPUTED-18V0.
045700     MOVE 1 TO CORRECT-18V0.
045800     MOVE "ERROR IN DN3 VALUE RETURNED" TO RE-MARK.
045900     GO TO CALL-FAIL-02-02.
046000 CALL-FAIL-02-02-4.
046100     MOVE DN4 TO COMPUTED-18V0.
046200     MOVE 0 TO CORRECT-18V0.
046300     MOVE "DN4 VALUE CHANGED BY CALL" TO RE-MARK.
046400 CALL-FAIL-02-02.
046500     PERFORM FAIL.
046600 CALL-WRITE-02-02.
046700     PERFORM PRINT-DETAIL.
046800 CALL-TEST-02-03.
046900     ADD 1 TO REC-CT.
047000     MOVE 0 TO DN4, DN3.
047100     MOVE 10 TO DN2.
047200     MOVE 25 TO DN1.
047300     CALL ID1 USING DN1 DN2 DN1 DN2.
047400     IF DN1 EQUAL TO 26
047500         GO TO CHECK-02-03-2.
047600     GO TO CALL-FAIL-02-03-1.
047700 CALL-DELETE-02-03.
047800     PERFORM DE-LETE.
047900     GO TO CALL-WRITE-02-03.
048000 CALL-FAIL-02-03-1.
048100     MOVE DN1 TO COMPUTED-18V0.
048200     MOVE 26 TO CORRECT-18V0.
048300     MOVE "ERROR IN DN1 VALUE RETURNED" TO RE-MARK.
048400     GO TO CALL-FAIL-02-03.
048500 CHECK-02-03-2.
048600     IF DN2 EQUAL TO 7
048700         GO TO CHECK-02-03-3.
048800 CALL-FAIL-02-03-2.
048900     MOVE DN2 TO COMPUTED-18V0.
049000     MOVE 7 TO CORRECT-18V0.
049100     MOVE "ERROR IN DN2 VALUE RETURNED" TO RE-MARK.
049200     GO TO CALL-FAIL-02-03.
049300 CHECK-02-03-3.
049400     IF DN3 EQUAL TO 0
049500         GO TO CHECK-02-03-4.
049600 CALL-FAIL-02-03-3.
049700     MOVE DN3 TO COMPUTED-18V0.
049800     MOVE 0 TO CORRECT-18V0.
049900     MOVE "DN3 VALUE CHANGED BY CALL" TO RE-MARK.
050000     GO TO CALL-FAIL-02-03.
050100 CHECK-02-03-4.
050200     IF DN4 EQUAL TO 0
050300         GO TO CALL-PASS-02-03.
050400 CALL-FAIL-02-03-4.
050500     MOVE DN4 TO COMPUTED-18V0.
050600     MOVE 0 TO CORRECT-18V0.
050700     MOVE "DN4 VALUE CHANGED BY CALL" TO RE-MARK.
050800 CALL-FAIL-02-03.
050900     PERFORM FAIL.
051000     GO TO CALL-WRITE-02-03.
051100 CALL-PASS-02-03.
051200     PERFORM PASS.
051300 CALL-WRITE-02-03.
051400     PERFORM PRINT-DETAIL.
051500 CALL-TEST-03.
051600*        THIS TEST USES THE ON OVERFLOW PHRASE IN THE CALL
051700*    STATEMENT.  THIS IS A SYNTACTICAL CHECK ONLY, THE ON
051800*    OVERFLOW CONDITION SHOULD NEVER OCCUR.
051900     MOVE "CALL-TEST-03" TO PAR-NAME.
052000     MOVE "ON OVERFLOW PHRASE" TO FEATURE.
052100 CALL-TEST-03-01.
052200     MOVE 7 TO CALL-COUNT.
052300     MOVE 20 TO DN1.
052400     MOVE 30 TO DN2.
052500     MOVE ZERO TO DN3, DN4.
052600     CALL "IC202A" USING DN1, DN2, DN3, DN4;
052700         ON OVERFLOW MOVE "OVERFLOW SHOULD NOT OCCUR" TO RE-MARK
052800                     GO TO CALL-FAIL-03-01.
052900     PERFORM CHECK-TEST-03.
053000     IF FAIL-FLAG EQUAL TO ZERO
053100         PERFORM PASS
053200         GO TO CALL-WRITE-03-01.
053300     MOVE FAIL-FLAG TO COMPUTED-18V0.
053400     MOVE "NO. OF WRONG VALUES RETURNED" TO RE-MARK.
053500 CALL-FAIL-03-01.
053600     PERFORM FAIL.
053700 CALL-WRITE-03-01.
053800     PERFORM PRINT-DETAIL.
053900 CALL-TEST-03-02.
054000     MOVE ZERO TO DN3, DN4.
054100     CALL "IC202A" USING DN1, DN2, DN3, DN4;
054200         OVERFLOW MOVE "OVERFLOW SHOULD NOT OCCUR" TO RE-MARK
054300                  GO TO CALL-FAIL-03-02.
054400     PERFORM CHECK-TEST-03.
054500     IF FAIL-FLAG EQUAL TO ZERO
054600         PERFORM PASS
054700         GO TO CALL-WRITE-03-02.
054800     MOVE FAIL-FLAG TO COMPUTED-18V0.
054900     MOVE "NO. OF WRONG VALUES RETURNED" TO RE-MARK.
055000 CALL-FAIL-03-02.
055100     PERFORM FAIL.
055200 CALL-WRITE-03-02.
055300     PERFORM PRINT-DETAIL.
055400 CALL-TEST-03-03.
055500     MOVE ZERO TO DN3, DN4.
055600     CALL ID1 USING DN1 DN2 DN3 DN4
055700         ON OVERFLOW MOVE "OVERFLOW SHOULD NOT OCCUR" TO RE-MARK
055800                     GO TO CALL-FAIL-03-03.
055900     PERFORM   CHECK-TEST-03.
056000     IF FAIL-FLAG EQUAL TO ZERO
056100         PERFORM PASS
056200         GO TO CALL-WRITE-03-03.
056300     MOVE FAIL-FLAG TO COMPUTED-18V0.
056400     MOVE "NO. OF WRONG VALUES RETURNED" TO RE-MARK.
056500 CALL-FAIL-03-03.
056600     PERFORM FAIL.
056700 CALL-WRITE-03-03.
056800     PERFORM PRINT-DETAIL.
056900 CALL-TEST-03-04.
057000     MOVE ZERO TO DN3, DN4.
057100     CALL ID1 USING DN1 DN2 DN3 DN4;
057200         OVERFLOW MOVE "OVERFLOW SHOULD NOT OCCUR" TO RE-MARK,
057300                  GO TO CALL-FAIL-03-04.
057400     PERFORM CHECK-TEST-03.
057500     IF FAIL-FLAG EQUAL TO ZERO
057600         PERFORM PASS
057700         GO TO CALL-WRITE-03-04.
057800     MOVE FAIL-FLAG TO COMPUTED-18V0.
057900     MOVE "NO. OF WRONG VALUES RETURNED" TO RE-MARK.
058000 CALL-FAIL-03-04.
058100     PERFORM FAIL.
058200 CALL-WRITE-03-04.
058300     PERFORM PRINT-DETAIL.
058400     GO TO EXIT-IC201.
058500 CALL-DELETE-03.
058600*        IF THE ON OVERFLOW PHRASE IS NOT RECOGNIZED, DELETE ALL
058700*    OF THE ABOVE CALL-TEST-03 PARAGRAPHS, STARTING WITH
058800*    CALL-TEST-03-01.
058900     PERFORM DE-LETE.
059000     PERFORM PRINT-DETAIL.
059100 EXIT-IC201.
059200     GO TO CCVS-EXIT.
059300 SECT-IC201-0002 SECTION.
059400 CHECK-TEST-01.
059500     MOVE ZERO TO FAIL-FLAG.
059600     ADD 1 TO CALL-COUNT.
059700     IF DN1 EQUAL TO ZERO
059800             NEXT SENTENCE
059900         ELSE ADD 1 TO FAIL-FLAG.
060000     IF DN2 NOT EQUAL TO ZERO
060100         ADD 1 TO FAIL-FLAG.
060200     IF DN3 NOT EQUAL TO 1
060300         ADD 1 TO FAIL-FLAG.
060400     IF DN4 NOT EQUAL TO CALL-COUNT
060500         ADD 1 TO FAIL-FLAG.
060600 CHECK-TEST-03.
060700     MOVE ZERO TO FAIL-FLAG.
060800     ADD 1 TO CALL-COUNT.
060900     IF DN4 NOT EQUAL TO CALL-COUNT
061000         ADD 1 TO FAIL-FLAG.
061100     IF DN3 NOT EQUAL TO 21
061200         ADD 1 TO FAIL-FLAG.
061300     IF DN2 NOT EQUAL TO 30
061400         ADD 1 TO FAIL-FLAG.
061500     IF DN1 NOT EQUAL TO 20
061600         ADD 1 TO FAIL-FLAG.
061700 CCVS-EXIT SECTION.
061800 CCVS-999999.
061900     GO TO CLOSE-FILES.
