000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ153A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 3.0.                                 *
000900*                                                              *
001000*    CREATION DATE     /     VALIDATION DATE                   *
001100*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001200*                                                              *
001300****************************************************************
001400*                                                              *
001500*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001600*                                                              *
001700*            X-14   SEQUENTIAL MASS STORAGE FILE               *
001800*            X-55   SYSTEM PRINTER                             *
001900*            X-82   SOURCE-COMPUTER                            *
002000*            X-83   OBJECT-COMPUTER                            *
002100*            X-84   LABEL RECORDS OPTION.                      *
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    THIS PROGRAM CHECKS FOR THE CORRECT RESPONSE TO WRITING TO*
002600*    A FILE OPEN IN THE I-O MODE.  THE TEST FOR CORRECT I-O    *
002700*    STATUS 48 IS IN THE DECLARATIVES.  AN ABNORMAL TERMINATION*
002800*    IS POSSIBLE AFTER THE TEST OF THE I-O STATUS CODE IS      *
002900*    ACCOMPLISHED BUT BEFORE CONTROL IS RETURNED TO THE MAIN   *
003000*    LINE CODE.                                                *
003100*                                                              *
003200****************************************************************
003300*
003400 ENVIRONMENT DIVISION.
003500 CONFIGURATION SECTION.
003600 SOURCE-COMPUTER.
003700     XXXXX082.
003800 OBJECT-COMPUTER.
003900     XXXXX083.
004000*
004100 INPUT-OUTPUT SECTION.
004200 FILE-CONTROL.
004300     SELECT PRINT-FILE ASSIGN TO
004400     XXXXX055.
004500*
004600     SELECT SQ-FS4
004700            ASSIGN
004800     XXXXX014
004900            FILE STATUS SQ-FS4-STATUS
005000            ORGANIZATION IS SEQUENTIAL
005100            .
005200*
005300*
005400 DATA DIVISION.
005500 FILE SECTION.
005600 FD  PRINT-FILE
005700C    LABEL RECORDS
005800C    XXXXX084
005900C    DATA RECORD IS PRINT-REC DUMMY-RECORD
006000               .
006100 01  PRINT-REC    PICTURE X(120).
006200 01  DUMMY-RECORD PICTURE X(120).
006300*
006400 FD  SQ-FS4
006500C    LABEL RECORD IS STANDARD
006600     BLOCK  CONTAINS 120 CHARACTERS
006700     RECORD CONTAINS 120 CHARACTERS
006800                .
006900 01  SQ-FS4R1-F-G-120.
007000        05 FFILE-RECORD-INFO-P1-120    PICTURE X(120).
007100*
007200 WORKING-STORAGE SECTION.
007300*
007400***************************************************************
007500*                                                             *
007600*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
007700*                                                             *
007800***************************************************************
007900*
008000 01  STATUS-GROUP.
008100     04  SQ-FS4-STATUS    PICTURE XX.
008200*
008300***************************************************************
008400*                                                             *
008500*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
008600*                                                             *
008700***************************************************************
008800*
008900 01  FILE-RECORD-INFORMATION-REC.
009000     03 FILE-RECORD-INFO-SKELETON.
009100        05 FILLER                 PICTURE X(48)       VALUE
009200             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
009300        05 FILLER                 PICTURE X(46)       VALUE
009400             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
009500        05 FILLER                 PICTURE X(26)       VALUE
009600             ",LFIL=000000,ORG=  ,LBLR= ".
009700        05 FILLER                 PICTURE X(37)       VALUE
009800             ",RECKEY=                             ".
009900        05 FILLER                 PICTURE X(38)       VALUE
010000             ",ALTKEY1=                             ".
010100        05 FILLER                 PICTURE X(38)       VALUE
010200             ",ALTKEY2=                             ".
010300        05 FILLER                 PICTURE X(7)        VALUE SPACE.
010400     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
010500        05 FILE-RECORD-INFO-P1-120.
010600           07 FILLER              PIC X(5).
010700           07 XFILE-NAME          PIC X(6).
010800           07 FILLER              PIC X(8).
010900           07 XRECORD-NAME        PIC X(6).
011000           07 FILLER              PIC X(1).
011100           07 REELUNIT-NUMBER     PIC 9(1).
011200           07 FILLER              PIC X(7).
011300           07 XRECORD-NUMBER      PIC 9(6).
011400           07 FILLER              PIC X(6).
011500           07 UPDATE-NUMBER       PIC 9(2).
011600           07 FILLER              PIC X(5).
011700           07 ODO-NUMBER          PIC 9(4).
011800           07 FILLER              PIC X(5).
011900           07 XPROGRAM-NAME       PIC X(5).
012000           07 FILLER              PIC X(7).
012100           07 XRECORD-LENGTH      PIC 9(6).
012200           07 FILLER              PIC X(7).
012300           07 CHARS-OR-RECORDS    PIC X(2).
012400           07 FILLER              PIC X(1).
012500           07 XBLOCK-SIZE         PIC 9(4).
012600           07 FILLER              PIC X(6).
012700           07 RECORDS-IN-FILE     PIC 9(6).
012800           07 FILLER              PIC X(5).
012900           07 XFILE-ORGANIZATION  PIC X(2).
013000           07 FILLER              PIC X(6).
013100           07 XLABEL-TYPE         PIC X(1).
013200        05 FILE-RECORD-INFO-P121-240.
013300           07 FILLER              PIC X(8).
013400           07 XRECORD-KEY         PIC X(29).
013500           07 FILLER              PIC X(9).
013600           07 ALTERNATE-KEY1      PIC X(29).
013700           07 FILLER              PIC X(9).
013800           07 ALTERNATE-KEY2      PIC X(29).
013900           07 FILLER              PIC X(7).
014000*
014100 01  TEST-RESULTS.
014200     02 FILLER              PIC X      VALUE SPACE.
014300     02  PAR-NAME.
014400       03 FILLER              PIC X(14)  VALUE SPACE.
014500       03 PARDOT-X            PIC X      VALUE SPACE.
014600       03 DOTVALUE            PIC 99     VALUE ZERO.
014700     02 FILLER              PIC X      VALUE SPACE.
014800     02 FEATURE             PIC X(24)  VALUE SPACE.
014900     02 FILLER              PIC X      VALUE SPACE.
015000     02 P-OR-F              PIC X(5)   VALUE SPACE.
015100     02 FILLER              PIC X(9)   VALUE SPACE.
015200     02 RE-MARK             PIC X(61).
015300 01  TEST-COMPUTED.
015400   02 FILLER  PIC X(30)  VALUE SPACE.
015500   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
015600   02 COMPUTED-X.
015700     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
015800     03 FILLER PIC X(50) VALUE SPACE.
015900 01  TEST-CORRECT.
016000     02 FILLER PIC X(30) VALUE SPACE.
016100     02 FILLER PIC X(17) VALUE "       CORRECT =".
016200     02 CORRECT-X.
016300     03 CORRECT-A                  PIC X(20) VALUE SPACE.
016400     03 FILLER PIC X(2) VALUE SPACE.
016500     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
016600*
016700 01  CCVS-C-1.
016800     02 FILLER  PIC IS X        VALUE  SPACE.
016900     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
017000     02 FILLER  PIC IS X        VALUE  SPACE.
017100     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
017200     02 FILLER  PIC IS X        VALUE  SPACE.
017300     02 FILLER  PIC IS X(5)     VALUE "PASS ".
017400     02 FILLER  PIC IS X(9)     VALUE  SPACE.
017500     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
017600 01  CCVS-C-2.
017700     02 FILLER  PIC X(19)  VALUE  SPACE.
017800     02 FILLER  PIC X(6)   VALUE "TESTED".
017900     02 FILLER  PIC X(19)  VALUE  SPACE.
018000     02 FILLER  PIC X(4)   VALUE "FAIL".
018100     02 FILLER  PIC X(72)  VALUE  SPACE.
018200*
018300 01  REC-CT            PIC 99       VALUE ZERO.
018400 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
018500 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
018600 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
018700 01  PASS-COUNTER      PIC 999      VALUE ZERO.
018800 01  DUMMY-HOLD        PIC X(120)    VALUE SPACE.
018900 01  ERROR-HOLD        PIC 999      VALUE ZERO.
019000 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
019100 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
019200 01  CCVS-H-1.
019300     02  FILLER          PIC X(39)    VALUE SPACES.
019400     02  FILLER          PIC X(42)    VALUE
019500     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
019600     02  FILLER          PIC X(39)    VALUE SPACES.
019700 01  CCVS-H-2A.
019800   02  FILLER            PIC X(40)  VALUE SPACE.
019900   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
020000   02  FILLER            PIC XXXX   VALUE
020100     "4.2 ".
020200   02  FILLER            PIC X(28)  VALUE
020300            " COPY - NOT FOR DISTRIBUTION".
020400   02  FILLER            PIC X(41)  VALUE SPACE.
020500*
020600 01  CCVS-H-2B.
020700   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
020800   02  TEST-ID           PIC X(9).
020900   02  FILLER            PIC X(4)   VALUE " IN ".
021000   02  FILLER            PIC X(12)  VALUE
021100     " HIGH       ".
021200   02  FILLER            PIC X(22)  VALUE
021300            " LEVEL VALIDATION FOR ".
021400   02  FILLER            PIC X(58)  VALUE
021500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
021600 01  CCVS-H-3.
021700     02  FILLER          PIC X(34)  VALUE
021800            " FOR OFFICIAL USE ONLY    ".
021900     02  FILLER          PIC X(58)  VALUE
022000     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022100     02  FILLER          PIC X(28)  VALUE
022200            "  COPYRIGHT   1985,1986 ".
022300 01  CCVS-E-1.
022400     02 FILLER           PIC X(52)  VALUE SPACE.
022500     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
022600     02 ID-AGAIN         PIC X(9).
022700     02 FILLER           PIC X(45)  VALUE SPACES.
022800 01  CCVS-E-2.
022900     02  FILLER          PIC X(31)  VALUE SPACE.
023000     02  FILLER          PIC X(21)  VALUE SPACE.
023100     02  CCVS-E-2-2.
023200         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
023300         03 FILLER         PIC X      VALUE SPACE.
023400         03 ENDER-DESC     PIC X(44)  VALUE
023500            "ERRORS ENCOUNTERED".
023600 01  CCVS-E-3.
023700     02  FILLER          PIC X(22)  VALUE
023800            " FOR OFFICIAL USE ONLY".
023900     02  FILLER          PIC X(12)  VALUE SPACE.
024000     02  FILLER          PIC X(58)  VALUE
024100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024200     02  FILLER          PIC X(8)   VALUE SPACE.
024300     02  FILLER          PIC X(20)  VALUE
024400             " COPYRIGHT 1985,1986".
024500 01  CCVS-E-4.
024600     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
024700     02 FILLER           PIC X(4)   VALUE " OF ".
024800     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
024900     02 FILLER           PIC X(40)  VALUE
025000      "  TESTS WERE EXECUTED SUCCESSFULLY".
025100 01  XXINFO.
025200     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
025300     02 INFO-TEXT.
025400       04 FILLER             PIC X(8)   VALUE SPACE.
025500       04 XXCOMPUTED         PIC X(20).
025600       04 FILLER             PIC X(5)   VALUE SPACE.
025700       04 XXCORRECT          PIC X(20).
025800     02 INF-ANSI-REFERENCE PIC X(48).
025900 01  HYPHEN-LINE.
026000     02 FILLER  PIC IS X VALUE IS SPACE.
026100     02 FILLER  PIC IS X(65)    VALUE IS "************************
026200-    "*****************************************".
026300     02 FILLER  PIC IS X(54)    VALUE IS "************************
026400-    "******************************".
026500 01  CCVS-PGM-ID  PIC X(9)   VALUE
026600     "SQ153A".
026700*
026800*
026900 PROCEDURE DIVISION.
027000 DECLARATIVES.
027100*
027200 SECT-SQ153A-0001 SECTION.
027300     USE AFTER STANDARD EXCEPTION PROCEDURE I-O.
027400 O-ERROR-PROCESS.
027500     IF SQ-FS4-STATUS = "48"
027600             PERFORM DECL-PASS
027700             GO TO ABNORMAL-TERM-DECL
027800     ELSE
027900             MOVE "48" TO CORRECT-A
028000             MOVE SQ-FS4-STATUS TO COMPUTED-A
028100             MOVE "STATUS FOR WRITE OF FILE OPEN I-O INCORRECT"
028200                     TO RE-MARK
028300             MOVE "VII-5, 1.3.5(4)G" TO ANSI-REFERENCE
028400             PERFORM DECL-FAIL
028500             GO TO ABNORMAL-TERM-DECL
028600     END-IF.
028700*
028800*
028900 DECL-PASS.
029000     MOVE   "PASS " TO P-OR-F.
029100     ADD     1 TO PASS-COUNTER.
029200     PERFORM DECL-PRINT-DETAIL.
029300*
029400 DECL-FAIL.
029500     MOVE   "FAIL*" TO P-OR-F.
029600     ADD     1 TO ERROR-COUNTER.
029700     PERFORM DECL-PRINT-DETAIL.
029800*
029900 DECL-DE-LETE.
030000     MOVE   "****TEST DELETED****" TO RE-MARK.
030100     MOVE   "*****" TO P-OR-F.
030200     ADD     1 TO DELETE-COUNTER.
030300     PERFORM DECL-PRINT-DETAIL.
030400*
030500 DECL-PRINT-DETAIL.
030600     IF REC-CT NOT EQUAL TO ZERO
030700             MOVE "." TO PARDOT-X
030800             MOVE REC-CT TO DOTVALUE.
030900     MOVE    TEST-RESULTS TO PRINT-REC.
031000     PERFORM DECL-WRITE-LINE.
031100     IF P-OR-F EQUAL TO "FAIL*"
031200         PERFORM DECL-WRITE-LINE
031300         PERFORM DECL-FAIL-ROUTINE THRU DECL-FAIL-EX
031400     ELSE
031500         PERFORM DECL-BAIL THRU DECL-BAIL-EX.
031600     MOVE    SPACE TO P-OR-F.
031700     MOVE    SPACE TO COMPUTED-X.
031800     MOVE    SPACE TO CORRECT-X.
031900     IF REC-CT EQUAL TO ZERO
032000         MOVE    SPACE TO PAR-NAME.
032100     MOVE    SPACE TO RE-MARK.
032200*
032300 DECL-WRITE-LINE.
032400     ADD     1 TO RECORD-COUNT.
032500Y    IF RECORD-COUNT GREATER 50
032600Y        MOVE    DUMMY-RECORD TO DUMMY-HOLD
032700Y        MOVE    SPACE TO DUMMY-RECORD
032800Y        WRITE   DUMMY-RECORD AFTER ADVANCING PAGE
032900Y        MOVE    CCVS-C-1 TO DUMMY-RECORD PERFORM DECL-WRT-LN
033000Y        MOVE    CCVS-C-2 TO DUMMY-RECORD
033100Y        PERFORM DECL-WRT-LN 2 TIMES
033200Y        MOVE    HYPHEN-LINE TO DUMMY-RECORD
033300Y        PERFORM DECL-WRT-LN
033400Y        MOVE    DUMMY-HOLD TO DUMMY-RECORD
033500Y        MOVE    ZERO TO RECORD-COUNT.
033600     PERFORM DECL-WRT-LN.
033700*
033800 DECL-WRT-LN.
033900     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
034000     MOVE    SPACE TO DUMMY-RECORD.
034100*
034200 DECL-FAIL-ROUTINE.
034300     IF COMPUTED-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
034400     IF CORRECT-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
034500     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
034600     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
034700     MOVE    XXINFO TO DUMMY-RECORD.
034800     PERFORM DECL-WRITE-LINE 2 TIMES.
034900     MOVE    SPACES TO INF-ANSI-REFERENCE.
035000     GO TO   DECL-FAIL-EX.
035100 DECL-FAIL-WRITE.
035200     MOVE    TEST-COMPUTED TO PRINT-REC
035300     PERFORM DECL-WRITE-LINE
035400     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
035500     MOVE    TEST-CORRECT TO PRINT-REC
035600     PERFORM DECL-WRITE-LINE 2 TIMES.
035700     MOVE    SPACES TO COR-ANSI-REFERENCE.
035800 DECL-FAIL-EX.
035900     EXIT.
036000*
036100 DECL-BAIL.
036200     IF COMPUTED-A NOT EQUAL TO SPACE GO TO DECL-BAIL-WRITE.
036300     IF CORRECT-A EQUAL TO SPACE GO TO DECL-BAIL-EX.
036400 DECL-BAIL-WRITE.
036500     MOVE    CORRECT-A TO XXCORRECT.
036600     MOVE    COMPUTED-A TO XXCOMPUTED.
036700     MOVE    XXINFO TO DUMMY-RECORD.
036800     PERFORM DECL-WRITE-LINE 2 TIMES.
036900 DECL-BAIL-EX.
037000     EXIT.
037100*
037200 ABNORMAL-TERM-DECL.
037300     MOVE SPACE TO DUMMY-RECORD.
037400     PERFORM DECL-WRITE-LINE.
037500     MOVE "ABNORMAL TERMINATION AT THIS POINT IS ACCEPTABLE"
037600             TO DUMMY-RECORD.
037700     PERFORM DECL-WRITE-LINE 3 TIMES.
037800*
037900 END DECLARATIVES.
038000*
038100*
038200 CCVS1 SECTION.
038300 OPEN-FILES.
038400     OPEN    OUTPUT PRINT-FILE.
038500     MOVE    CCVS-PGM-ID TO TEST-ID.
038600     MOVE    CCVS-PGM-ID TO ID-AGAIN.
038700     MOVE    SPACE TO TEST-RESULTS.
038800     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
038900     GO TO CCVS1-EXIT.
039000*
039100 CLOSE-FILES.
039200     PERFORM END-ROUTINE THRU END-ROUTINE-13.
039300     CLOSE   PRINT-FILE.
039400 TERMINATE-CCVS.
039500     STOP    RUN.
039600*
039700 INSPT.
039800     MOVE   "INSPT" TO P-OR-F.
039900     ADD     1 TO INSPECT-COUNTER.
040000     PERFORM PRINT-DETAIL.
040100*
040200 PASS.
040300     MOVE   "PASS " TO P-OR-F.
040400     ADD     1 TO PASS-COUNTER.
040500     PERFORM PRINT-DETAIL.
040600*
040700 FAIL.
040800     MOVE   "FAIL*" TO P-OR-F.
040900     ADD     1 TO ERROR-COUNTER.
041000     PERFORM PRINT-DETAIL.
041100*
041200 DE-LETE.
041300     MOVE   "****TEST DELETED****" TO RE-MARK.
041400     MOVE   "*****" TO P-OR-F.
041500     ADD     1 TO DELETE-COUNTER.
041600     PERFORM PRINT-DETAIL.
041700*
041800 PRINT-DETAIL.
041900     IF REC-CT NOT EQUAL TO ZERO
042000         MOVE   "." TO PARDOT-X
042100         MOVE    REC-CT TO DOTVALUE.
042200     MOVE    TEST-RESULTS TO PRINT-REC.
042300     PERFORM WRITE-LINE.
042400     IF P-OR-F EQUAL TO "FAIL*"
042500         PERFORM WRITE-LINE
042600         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
042700     ELSE
042800         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
042900     MOVE    SPACE TO P-OR-F.
043000     MOVE    SPACE TO COMPUTED-X.
043100     MOVE    SPACE TO CORRECT-X.
043200     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
043300     MOVE    SPACE TO RE-MARK.
043400*
043500 HEAD-ROUTINE.
043600     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043700     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043800     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
043900     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
044000 COLUMN-NAMES-ROUTINE.
044100     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
044200     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
044400 END-ROUTINE.
044500     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
044600     PERFORM WRITE-LINE 5 TIMES.
044700 END-RTN-EXIT.
044800     MOVE    CCVS-E-1 TO DUMMY-RECORD.
044900     PERFORM WRITE-LINE 2 TIMES.
045000*
045100 END-ROUTINE-1.
045200     ADD     ERROR-COUNTER   TO ERROR-HOLD
045300     ADD     INSPECT-COUNTER TO ERROR-HOLD.
045400     ADD     DELETE-COUNTER  TO ERROR-HOLD.
045500     ADD     PASS-COUNTER    TO ERROR-HOLD.
045600     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
045700     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
045800     MOVE    CCVS-E-4        TO CCVS-E-2-2.
045900     MOVE    CCVS-E-2        TO DUMMY-RECORD
046000     PERFORM WRITE-LINE.
046100     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
046200     IF ERROR-COUNTER IS EQUAL TO ZERO
046300         MOVE   "NO " TO ERROR-TOTAL
046400     ELSE
046500         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
046600     MOVE    CCVS-E-2 TO DUMMY-RECORD.
046700     PERFORM WRITE-LINE.
046800 END-ROUTINE-13.
046900     IF DELETE-COUNTER IS EQUAL TO ZERO
047000         MOVE   "NO " TO ERROR-TOTAL
047100     ELSE
047200         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
047300     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
047400     MOVE    CCVS-E-2 TO DUMMY-RECORD.
047500     PERFORM WRITE-LINE.
047600     IF INSPECT-COUNTER EQUAL TO ZERO
047700         MOVE   "NO " TO ERROR-TOTAL
047800     ELSE
047900         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
048000     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
048100     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
048200     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
048300*
048400 WRITE-LINE.
048500     ADD     1 TO RECORD-COUNT.
048600Y    IF RECORD-COUNT GREATER 50
048700Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
048800Y        MOVE  SPACE TO DUMMY-RECORD
048900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
049000Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
049100Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
049200Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
049300Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
049400Y        MOVE  ZERO TO RECORD-COUNT.
049500     PERFORM WRT-LN.
049600*
049700 WRT-LN.
049800     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
049900     MOVE    SPACE TO DUMMY-RECORD.
050000 BLANK-LINE-PRINT.
050100     PERFORM WRT-LN.
050200 FAIL-ROUTINE.
050300     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
050400     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
050500     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
050600     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
050700     MOVE    XXINFO TO DUMMY-RECORD.
050800     PERFORM WRITE-LINE 2 TIMES.
050900     MOVE    SPACES TO INF-ANSI-REFERENCE.
051000     GO TO   FAIL-ROUTINE-EX.
051100 FAIL-ROUTINE-WRITE.
051200     MOVE    TEST-COMPUTED  TO PRINT-REC
051300     PERFORM WRITE-LINE
051400     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
051500     MOVE    TEST-CORRECT   TO PRINT-REC
051600     PERFORM WRITE-LINE 2 TIMES.
051700     MOVE    SPACES         TO COR-ANSI-REFERENCE.
051800 FAIL-ROUTINE-EX.
051900     EXIT.
052000 BAIL-OUT.
052100     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
052200     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
052300 BAIL-OUT-WRITE.
052400     MOVE    CORRECT-A      TO XXCORRECT.
052500     MOVE    COMPUTED-A     TO XXCOMPUTED.
052600     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
052700     MOVE    XXINFO TO DUMMY-RECORD.
052800     PERFORM WRITE-LINE 2 TIMES.
052900     MOVE    SPACES TO INF-ANSI-REFERENCE.
053000 BAIL-OUT-EX.
053100     EXIT.
053200 CCVS1-EXIT.
053300     EXIT.
053400*
053500****************************************************************
053600*                                                              *
053700*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
053800*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
053900*                                                              *
054000****************************************************************
054100*
054200 SECT-SQ153A-0002 SECTION.
054300*
054400*    THIS TEST CREATES FILE SQ-FS4 AND CLOSES IT.
054500*    FIRST IT SETS UP A SKELETON RECORD IN WORKING STORAGE.
054600*
054700 WRITE-INIT-GF-01.
054800     MOVE "SQ-FS4" TO XFILE-NAME (1).
054900     MOVE "R1-F-G" TO XRECORD-NAME (1).
055000     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
055100     MOVE 120 TO XRECORD-LENGTH (1).
055200     MOVE "RC" TO CHARS-OR-RECORDS (1).
055300     MOVE 1 TO XBLOCK-SIZE (1).
055400     MOVE 1 TO RECORDS-IN-FILE (1).
055500     MOVE "SQ" TO XFILE-ORGANIZATION (1).
055600     MOVE "S" TO XLABEL-TYPE (1).
055700     MOVE 1 TO XRECORD-NUMBER (1).
055800*
055900 WRITE-OPEN-01.
056000     OPEN OUTPUT SQ-FS4.
056100*
056200 WRITE-TEST-01-01.
056300     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-FS4R1-F-G-120.
056400     WRITE SQ-FS4R1-F-G-120.
056500*
056600 CLOSE-TEST-01.
056700     CLOSE SQ-FS4.
056800*
056900 OPEN-TEST-02.
057000     OPEN I-O SQ-FS4.
057100*
057200*        THIS TEST OPENS THE FILE JUST CREATED IN THE I-O MODE.
057300*        WE ATTEMPT TO WRITE ANOTHER RECORD AND EXAMINE IN A
057400*        DECLARATIVE THE I-O STATUS RETURNED.  IT IS POSSIBLE
057500*        THAT THE SYSTEM ACTION MAY BE ABNORMAL PROGRAM
057600*        TERMINATION AFTER THE DECLARATIVE IS EXECUTED.  THE
057700*        RECORD NUMBER FIELD IN THE RECORD TO BE WRITTEN IS
057800*        CHANGED FROM THAT IN THE RECORD ORIGINALLY WRITTEN TO
057900*        AID IN ESTABLISHING THE ORIGIN OF THE RECORD IN ANY
058000*        SUBSEQUENT EXAMINATION OF THE FILE.
058100*
058200 WRITE-INIT-02.
058300     MOVE 1 TO REC-CT.
058400     MOVE "WRITE-TEST-02" TO PAR-NAME.
058500     MOVE "WRITE TO I-O FILE" TO FEATURE.
058600     MOVE 2 TO XRECORD-NUMBER (1).
058700 WRITE-TEST-02.
058800     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-FS4R1-F-G-120.
058900     WRITE SQ-FS4R1-F-G-120.
059000*
059100 CLOSE-TEST-02.
059200     CLOSE SQ-FS4.
059300*
059400 CCVS-EXIT SECTION.
059500 CCVS-999999.
059600     GO TO   CLOSE-FILES.
