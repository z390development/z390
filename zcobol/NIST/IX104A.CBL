000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IX104A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*    THIS PROGRAM TESTS THE SYNTACTICAL CONSTRUCTS AND SEMANTIC
001400*    ACTIONS ASSOCIATED WITH THE FOLLOWING ELEMENTS:
001500*
001600*    (1) FILE STATUS
001700*    (2) USE AFTER EXCEPTION USING FILE-NAME
001800*    (3) READ
001900*    (4) WRITE
002000*    (5) REWRITE
002100*    (6) RECORD KEY
002200*    (7) ACCESS
002300*
002400*    THIS PROGRAM CREATES AN INDEXED FILE SEQUENTIALLY (ACCESS
002500*    MODE SEQUENTIAL) AND THEN UPDATES SELECTIVE RECORDS OF THE
002600*    FILE.  THE FILE STATUS CONTENTS ARE CAPTURED AND TESTED FOR
002700*    ACCURACY FOR EACH OPEN, CLOSE, READ AND REWRITE STATEMENT
002800*    USED.  THE READ, WRITE AND REWRITE STATEMENTS ARE USED
002900*    WITHOUT THE APPROPRIATE AT END OR INVALID KEY PHRASES. THE
003000*    OMISSION OF THESE PHRASES ARE PERMITTED IF AN APPLICABLE USE
003100*    PROCEDURE HAS BEEN SPECIFIED.
003200*
003300*
003400*       X-CARDS  WHICH MUST BE REPLACED FOR THIS PROGRAM ARE
003500*
003600*             X-25   INDEXED FILE IMPLEMENTOR-NAME IN ASSIGN TO
003700*                    CLAUSE FOR DATA FILE IX-FD2
003800*             X-45   INDEXED FILE IMPLEMENTOR-NAME IN ASSIGN TO
003900*                    CLAUSE FOR INDEX FILE IX-FD2
004000*             X-55   IMPLEMENTOR-NAME FOR SYSTEM PRINTER
004100*             X-62   FOR RAW-DATA
004200*             X-82   IMPLEMENTOR-NAME FOR SOURCE-COMPUTER
004300*             X-83   IMPLEMENTOR-NAME FOR OBJECT-COMPUTER
004400*
004500*         NOTE:  X-CARDS 45 AND 62       ARE OPTIONAL
004600*               AND NEED ONLY TO BE PRESENT IF THE COMPILER RE-
004700*               QUIRES THIS CODE BE AVAILABLE FOR PROPER PROGRAM
004800*               COMPILATION AND EXECUTION. IF THE VP-ROUTINE IS
004900*               USED THE  X-CARDS MAY BE AUTOMATICALLY SELECTED
005000*               FOR INCLUSION IN THE PROGRAM BY SPECIFYING THE
005100*               APPROPRIATE LETTER IN THE "*OPT" VP-ROUTINE
005200*               CONTROL CARD. THE LETTER  CORRESPONDS TO A
005300*               CHARACTER IN POSITION 7 OF THE SOURCE LINE AND
005400*               THEY ARE AS FOLLOWS
005500*
005600*                  J  SELECTS X-CARD 45
005700*
005800******************************************************
005900 ENVIRONMENT DIVISION.
006000 CONFIGURATION SECTION.
006100 SOURCE-COMPUTER.
006200     XXXXX082.
006300 OBJECT-COMPUTER.
006400     XXXXX083.
006500 INPUT-OUTPUT SECTION.
006600 FILE-CONTROL.
006700P    SELECT RAW-DATA   ASSIGN TO
006800P    XXXXX062
006900P           ORGANIZATION IS INDEXED
007000P           ACCESS MODE IS RANDOM
007100P           RECORD KEY IS RAW-DATA-KEY.
007200     SELECT PRINT-FILE ASSIGN TO
007300     XXXXX055.
007400     SELECT   IX-FS2 ASSIGN
007500     XXXXX025
007600J    XXXXX045
007700             ORGANIZATION IS INDEXED
007800        ACCESS SEQUENTIAL
007900        FILE STATUS IS IX-FS2-STATUS
008000        RECORD  IX-FS2-KEY.
008100 DATA DIVISION.
008200 FILE SECTION.
008300P
008400PFD  RAW-DATA.
008500P
008600P01  RAW-DATA-SATZ.
008700P    05  RAW-DATA-KEY        PIC X(6).
008800P    05  C-DATE              PIC 9(6).
008900P    05  C-TIME              PIC 9(8).
009000P    05  C-NO-OF-TESTS       PIC 99.
009100P    05  C-OK                PIC 999.
009200P    05  C-ALL               PIC 999.
009300P    05  C-FAIL              PIC 999.
009400P    05  C-DELETED           PIC 999.
009500P    05  C-INSPECT           PIC 999.
009600P    05  C-NOTE              PIC X(13).
009700P    05  C-INDENT            PIC X.
009800P    05  C-ABORT             PIC X(8).
009900 FD  PRINT-FILE.
010000 01  PRINT-REC PICTURE X(120).
010100 01  DUMMY-RECORD PICTURE X(120).
010200 FD  IX-FS2
010300C    LABEL RECORDS ARE STANDARD
010400C    DATA RECORDS IX-FS2R1-F-G-240
010500     BLOCK CONTAINS 480
010600     RECORD CONTAINS  240  CHARACTERS.
010700 01  IX-FS2R1-F-G-240.
010800     05 IX-FS2-REC-120    PIC X(120).
010900     05 IX-FS2-REC-120-240.
011000     10  FILLER PICTURE X(8).
011100     10  IX-FS2-KEY PIC X(29).
011200     10  FILLER PIC X(83).
011300 WORKING-STORAGE SECTION.
011400 01  GRP-0101.
011500     02 FILLER PIC X(10) VALUE "ABCD921XYZ".
011600     02  WRK-DU-09V00-001 PIC 9(9) VALUE ZERO.
011700     02 FILLER PIC X(10) VALUE "Z2F()$+-AB".
011800 01  GRP-0001.
011900     05 WRK-CS-09V00-012  PIC S9(9) USAGE COMP  VALUE ZERO.
012000     05 WRK-CS-09V00-013  PIC S9(9) USAGE COMP  VALUE ZERO.
012100     05 WRK-CS-09V00-014  PIC S9(9) USAGE COMP  VALUE ZERO.
012200     05 WRK-CS-09V00-015  PIC S9(9) USAGE COMP  VALUE ZERO.
012300     05 WRK-CS-09V00-016  PIC S9(9) USAGE COMP  VALUE ZERO.
012400     05 WRK-CS-09V00-017  PIC S9(9) USAGE COMP  VALUE ZERO.
012500     05 WRK-CS-09V00-018  PIC S9(9) USAGE COMP  VALUE ZERO.
012600     05 IX-FS2-STATUS     PIC  XX  VALUE  SPACE.
012700     05 WRK-XN-0002-001   PIC  X(2) VALUE  SPACE.
012800     05 WRK-XN-0002-002   PIC  X(2) VALUE  SPACE.
012900     05 WRK-XN-0002-003   PIC  X(2) VALUE  SPACE.
013000     05 WRK-XN-0002-004   PIC  X(2) VALUE  SPACE.
013100     05 WRK-XN-0002-005   PIC  X(2) VALUE  SPACE.
013200     05 WRK-XN-0002-006   PIC  X(2) VALUE  SPACE.
013300     05 WRK-XN-0002-007   PIC  X(2) VALUE  SPACE.
013400     05 WRK-XN-0002-008   PIC  X(2) VALUE  SPACE.
013500     05 WRK-XN-0002-009   PIC  X(2) VALUE  SPACE.
013600 01  DUMMY-WRK-REC.
013700     02 DUMMY-WRK1       PIC X(120).
013800     02 DUMMY-WRK2  REDEFINES  DUMMY-WRK1.
013900        03 FILLER   PIC X(5).
014000        03 DUMMY-WRK-INDENT-5  PIC X(115).
014100 01  FILE-RECORD-INFORMATION-REC.
014200     03 FILE-RECORD-INFO-SKELETON.
014300        05 FILLER                 PICTURE X(48)       VALUE
014400             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
014500        05 FILLER                 PICTURE X(46)       VALUE
014600             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
014700        05 FILLER                 PICTURE X(26)       VALUE
014800             ",LFIL=000000,ORG=  ,LBLR= ".
014900        05 FILLER                 PICTURE X(37)       VALUE
015000             ",RECKEY=                             ".
015100        05 FILLER                 PICTURE X(38)       VALUE
015200             ",ALTKEY1=                             ".
015300        05 FILLER                 PICTURE X(38)       VALUE
015400             ",ALTKEY2=                             ".
015500        05 FILLER                 PICTURE X(7)        VALUE SPACE.
015600     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
015700        05 FILE-RECORD-INFO-P1-120.
015800           07 FILLER              PIC X(5).
015900           07 XFILE-NAME           PIC X(6).
016000           07 FILLER              PIC X(8).
016100           07 XRECORD-NAME         PIC X(6).
016200           07 FILLER              PIC X(1).
016300           07 REELUNIT-NUMBER     PIC 9(1).
016400           07 FILLER              PIC X(7).
016500           07 XRECORD-NUMBER       PIC 9(6).
016600           07 FILLER              PIC X(6).
016700           07 UPDATE-NUMBER       PIC 9(2).
016800           07 FILLER              PIC X(5).
016900           07 ODO-NUMBER          PIC 9(4).
017000           07 FILLER              PIC X(5).
017100           07 XPROGRAM-NAME        PIC X(5).
017200           07 FILLER              PIC X(7).
017300           07 XRECORD-LENGTH       PIC 9(6).
017400           07 FILLER              PIC X(7).
017500           07 CHARS-OR-RECORDS    PIC X(2).
017600           07 FILLER              PIC X(1).
017700           07 XBLOCK-SIZE          PIC 9(4).
017800           07 FILLER              PIC X(6).
017900           07 RECORDS-IN-FILE     PIC 9(6).
018000           07 FILLER              PIC X(5).
018100           07 XFILE-ORGANIZATION   PIC X(2).
018200           07 FILLER              PIC X(6).
018300           07 XLABEL-TYPE          PIC X(1).
018400        05 FILE-RECORD-INFO-P121-240.
018500           07 FILLER              PIC X(8).
018600           07 XRECORD-KEY          PIC X(29).
018700           07 FILLER              PIC X(9).
018800           07 ALTERNATE-KEY1      PIC X(29).
018900           07 FILLER              PIC X(9).
019000           07 ALTERNATE-KEY2      PIC X(29).
019100           07 FILLER              PIC X(7).
019200 01  TEST-RESULTS.
019300     02 FILLER                   PIC X      VALUE SPACE.
019400     02 FEATURE                  PIC X(20)  VALUE SPACE.
019500     02 FILLER                   PIC X      VALUE SPACE.
019600     02 P-OR-F                   PIC X(5)   VALUE SPACE.
019700     02 FILLER                   PIC X      VALUE SPACE.
019800     02  PAR-NAME.
019900       03 FILLER                 PIC X(19)  VALUE SPACE.
020000       03  PARDOT-X              PIC X      VALUE SPACE.
020100       03 DOTVALUE               PIC 99     VALUE ZERO.
020200     02 FILLER                   PIC X(8)   VALUE SPACE.
020300     02 RE-MARK                  PIC X(61).
020400 01  TEST-COMPUTED.
020500     02 FILLER                   PIC X(30)  VALUE SPACE.
020600     02 FILLER                   PIC X(17)  VALUE
020700            "       COMPUTED=".
020800     02 COMPUTED-X.
020900     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
021000     03 COMPUTED-N               REDEFINES COMPUTED-A
021100                                 PIC -9(9).9(9).
021200     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
021300     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
021400     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
021500     03       CM-18V0 REDEFINES COMPUTED-A.
021600         04 COMPUTED-18V0                    PIC -9(18).
021700         04 FILLER                           PIC X.
021800     03 FILLER PIC X(50) VALUE SPACE.
021900 01  TEST-CORRECT.
022000     02 FILLER PIC X(30) VALUE SPACE.
022100     02 FILLER PIC X(17) VALUE "       CORRECT =".
022200     02 CORRECT-X.
022300     03 CORRECT-A                  PIC X(20) VALUE SPACE.
022400     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
022500     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
022600     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
022700     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
022800     03      CR-18V0 REDEFINES CORRECT-A.
022900         04 CORRECT-18V0                     PIC -9(18).
023000         04 FILLER                           PIC X.
023100     03 FILLER PIC X(2) VALUE SPACE.
023200     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
023300 01  CCVS-C-1.
023400     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
023500-    "SS  PARAGRAPH-NAME
023600-    "       REMARKS".
023700     02 FILLER                     PIC X(20)    VALUE SPACE.
023800 01  CCVS-C-2.
023900     02 FILLER                     PIC X        VALUE SPACE.
024000     02 FILLER                     PIC X(6)     VALUE "TESTED".
024100     02 FILLER                     PIC X(15)    VALUE SPACE.
024200     02 FILLER                     PIC X(4)     VALUE "FAIL".
024300     02 FILLER                     PIC X(94)    VALUE SPACE.
024400 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
024500 01  REC-CT                        PIC 99       VALUE ZERO.
024600 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
024700 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
024800 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
024900 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
025000 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
025100 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
025200 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
025300 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
025400 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
025500 01  CCVS-H-1.
025600     02  FILLER                    PIC X(39)    VALUE SPACES.
025700     02  FILLER                    PIC X(42)    VALUE
025800     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
025900     02  FILLER                    PIC X(39)    VALUE SPACES.
026000 01  CCVS-H-2A.
026100   02  FILLER                        PIC X(40)  VALUE SPACE.
026200   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
026300   02  FILLER                        PIC XXXX   VALUE
026400     "4.2 ".
026500   02  FILLER                        PIC X(28)  VALUE
026600            " COPY - NOT FOR DISTRIBUTION".
026700   02  FILLER                        PIC X(41)  VALUE SPACE.
026800
026900 01  CCVS-H-2B.
027000   02  FILLER                        PIC X(15)  VALUE
027100            "TEST RESULT OF ".
027200   02  TEST-ID                       PIC X(9).
027300   02  FILLER                        PIC X(4)   VALUE
027400            " IN ".
027500   02  FILLER                        PIC X(12)  VALUE
027600     " HIGH       ".
027700   02  FILLER                        PIC X(22)  VALUE
027800            " LEVEL VALIDATION FOR ".
027900   02  FILLER                        PIC X(58)  VALUE
028000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
028100 01  CCVS-H-3.
028200     02  FILLER                      PIC X(34)  VALUE
028300            " FOR OFFICIAL USE ONLY    ".
028400     02  FILLER                      PIC X(58)  VALUE
028500     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
028600     02  FILLER                      PIC X(28)  VALUE
028700            "  COPYRIGHT   1985 ".
028800 01  CCVS-E-1.
028900     02 FILLER                       PIC X(52)  VALUE SPACE.
029000     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
029100     02 ID-AGAIN                     PIC X(9).
029200     02 FILLER                       PIC X(45)  VALUE SPACES.
029300 01  CCVS-E-2.
029400     02  FILLER                      PIC X(31)  VALUE SPACE.
029500     02  FILLER                      PIC X(21)  VALUE SPACE.
029600     02 CCVS-E-2-2.
029700         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
029800         03 FILLER                   PIC X      VALUE SPACE.
029900         03 ENDER-DESC               PIC X(44)  VALUE
030000            "ERRORS ENCOUNTERED".
030100 01  CCVS-E-3.
030200     02  FILLER                      PIC X(22)  VALUE
030300            " FOR OFFICIAL USE ONLY".
030400     02  FILLER                      PIC X(12)  VALUE SPACE.
030500     02  FILLER                      PIC X(58)  VALUE
030600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
030700     02  FILLER                      PIC X(13)  VALUE SPACE.
030800     02 FILLER                       PIC X(15)  VALUE
030900             " COPYRIGHT 1985".
031000 01  CCVS-E-4.
031100     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
031200     02 FILLER                       PIC X(4)   VALUE " OF ".
031300     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
031400     02 FILLER                       PIC X(40)  VALUE
031500      "  TESTS WERE EXECUTED SUCCESSFULLY".
031600 01  XXINFO.
031700     02 FILLER                       PIC X(19)  VALUE
031800            "*** INFORMATION ***".
031900     02 INFO-TEXT.
032000       04 FILLER                     PIC X(8)   VALUE SPACE.
032100       04 XXCOMPUTED                 PIC X(20).
032200       04 FILLER                     PIC X(5)   VALUE SPACE.
032300       04 XXCORRECT                  PIC X(20).
032400     02 INF-ANSI-REFERENCE           PIC X(48).
032500 01  HYPHEN-LINE.
032600     02 FILLER  PIC IS X VALUE IS SPACE.
032700     02 FILLER  PIC IS X(65)    VALUE IS "************************
032800-    "*****************************************".
032900     02 FILLER  PIC IS X(54)    VALUE IS "************************
033000-    "******************************".
033100 01  CCVS-PGM-ID                     PIC X(9)   VALUE
033200     "IX104A".
033300 PROCEDURE DIVISION.
033400 DECLARATIVES.
033500 IX-FS2-01 SECTION.
033600     USE    AFTER STANDARD ERROR PROCEDURE ON IX-FS2.
033700 IX-FS2-01-01.
033800     ADD      1 TO  WRK-CS-09V00-013.
033900     GO TO    IX-FS2-01-03
034000              IX-FS2-01-05
034100              DEPENDING ON  WRK-CS-09V00-012.
034200     GO TO    IX-FS2-01-EXIT.
034300 IX-FS2-01-03.
034400*ENTRY FROM SEGMENT INX-TEST-001.
034500*    SHOULD NOT ENTER HERE UNLESS SPACE ALLOCATION TOO SMALL.
034600     ADD     1 TO  WRK-CS-09V00-014.
034700 IX-FS2-01-05.
034800     ADD      1 TO WRK-CS-09V00-017.
034900     IF       XRECORD-NUMBER (2) EQUAL TO 500
035000              MOVE   IX-FS2-STATUS TO WRK-XN-0002-002
035100              MOVE  "10" TO WRK-XN-0002-003.
035200 IX-FS2-01-EXIT.
035300     EXIT.
035400 END DECLARATIVES.
035500 CCVS1 SECTION.
035600 OPEN-FILES.
035700P    OPEN I-O RAW-DATA.
035800P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
035900P    READ RAW-DATA INVALID KEY GO TO END-E-1.
036000P    MOVE "ABORTED " TO C-ABORT.
036100P    ADD 1 TO C-NO-OF-TESTS.
036200P    ACCEPT C-DATE  FROM DATE.
036300P    ACCEPT C-TIME  FROM TIME.
036400P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
036500PEND-E-1.
036600P    CLOSE RAW-DATA.
036700     OPEN    OUTPUT PRINT-FILE.
036800     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
036900     MOVE    SPACE TO TEST-RESULTS.
037000     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
037100     MOVE    ZERO TO REC-SKL-SUB.
037200     PERFORM CCVS-INIT-FILE 9 TIMES.
037300 CCVS-INIT-FILE.
037400     ADD     1 TO REC-SKL-SUB.
037500     MOVE    FILE-RECORD-INFO-SKELETON
037600          TO FILE-RECORD-INFO (REC-SKL-SUB).
037700 CCVS-INIT-EXIT.
037800     GO TO CCVS1-EXIT.
037900 CLOSE-FILES.
038000P    OPEN I-O RAW-DATA.
038100P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
038200P    READ RAW-DATA INVALID KEY GO TO END-E-2.
038300P    MOVE "OK.     " TO C-ABORT.
038400P    MOVE PASS-COUNTER TO C-OK.
038500P    MOVE ERROR-HOLD   TO C-ALL.
038600P    MOVE ERROR-COUNTER TO C-FAIL.
038700P    MOVE DELETE-COUNTER TO C-DELETED.
038800P    MOVE INSPECT-COUNTER TO C-INSPECT.
038900P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
039000PEND-E-2.
039100P    CLOSE RAW-DATA.
039200     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
039300 TERMINATE-CCVS.
039400S    EXIT PROGRAM.
039500STERMINATE-CALL.
039600     STOP     RUN.
039700 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
039800 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
039900 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
040000 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
040100     MOVE "****TEST DELETED****" TO RE-MARK.
040200 PRINT-DETAIL.
040300     IF REC-CT NOT EQUAL TO ZERO
040400             MOVE "." TO PARDOT-X
040500             MOVE REC-CT TO DOTVALUE.
040600     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
040700     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
040800        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
040900          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
041000     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
041100     MOVE SPACE TO CORRECT-X.
041200     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
041300     MOVE     SPACE TO RE-MARK.
041400 HEAD-ROUTINE.
041500     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041600     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041700     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
041800     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
041900 COLUMN-NAMES-ROUTINE.
042000     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
042100     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
042300 END-ROUTINE.
042400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
042500 END-RTN-EXIT.
042600     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042700 END-ROUTINE-1.
042800      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
042900      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
043000      ADD PASS-COUNTER TO ERROR-HOLD.
043100*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
043200      MOVE PASS-COUNTER TO CCVS-E-4-1.
043300      MOVE ERROR-HOLD TO CCVS-E-4-2.
043400      MOVE CCVS-E-4 TO CCVS-E-2-2.
043500      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
043600  END-ROUTINE-12.
043700      MOVE "TEST(S) FAILED" TO ENDER-DESC.
043800     IF       ERROR-COUNTER IS EQUAL TO ZERO
043900         MOVE "NO " TO ERROR-TOTAL
044000         ELSE
044100         MOVE ERROR-COUNTER TO ERROR-TOTAL.
044200     MOVE     CCVS-E-2 TO DUMMY-RECORD.
044300     PERFORM WRITE-LINE.
044400 END-ROUTINE-13.
044500     IF DELETE-COUNTER IS EQUAL TO ZERO
044600         MOVE "NO " TO ERROR-TOTAL  ELSE
044700         MOVE DELETE-COUNTER TO ERROR-TOTAL.
044800     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
044900     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
045000      IF   INSPECT-COUNTER EQUAL TO ZERO
045100          MOVE "NO " TO ERROR-TOTAL
045200      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
045300      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
045400      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
045500     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
045600 WRITE-LINE.
045700     ADD 1 TO RECORD-COUNT.
045800Y    IF RECORD-COUNT GREATER 42
045900Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
046000Y        MOVE SPACE TO DUMMY-RECORD
046100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
046200Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
046300Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
046400Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
046500Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
046600Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
046700Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
046800Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
046900Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
047000Y        MOVE ZERO TO RECORD-COUNT.
047100     PERFORM WRT-LN.
047200 WRT-LN.
047300     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
047400     MOVE SPACE TO DUMMY-RECORD.
047500 BLANK-LINE-PRINT.
047600     PERFORM WRT-LN.
047700 FAIL-ROUTINE.
047800     IF     COMPUTED-X NOT EQUAL TO SPACE
047900            GO TO   FAIL-ROUTINE-WRITE.
048000     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
048100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
048200     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
048300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
048400     MOVE   SPACES TO INF-ANSI-REFERENCE.
048500     GO TO  FAIL-ROUTINE-EX.
048600 FAIL-ROUTINE-WRITE.
048700     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
048800     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
048900     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
049000     MOVE   SPACES TO COR-ANSI-REFERENCE.
049100 FAIL-ROUTINE-EX. EXIT.
049200 BAIL-OUT.
049300     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
049400     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
049500 BAIL-OUT-WRITE.
049600     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
049700     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
049800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
049900     MOVE   SPACES TO INF-ANSI-REFERENCE.
050000 BAIL-OUT-EX. EXIT.
050100 CCVS1-EXIT.
050200     EXIT.
050300 SECT-IX-04-001 SECTION.
050400 WRITE-INIT-GF-01.
050500     MOVE     "CREATE IX-FS2" TO  FEATURE
050600     MOVE     "IX-FS2"        TO  XFILE-NAME (2).
050700     MOVE     "R1-F-G"        TO  XRECORD-NAME (2).
050800     MOVE     CCVS-PGM-ID     TO  XPROGRAM-NAME (2).
050900     MOVE     000240          TO  XRECORD-LENGTH (2).
051000     MOVE     "RC"            TO  CHARS-OR-RECORDS (2).
051100     MOVE     0001            TO  XBLOCK-SIZE       (2).
051200     MOVE     000500          TO  RECORDS-IN-FILE  (2).
051300     MOVE    "IX"                TO XFILE-ORGANIZATION (2).
051400     MOVE    "WRITE-TEST-GF-01" TO PAR-NAME.
051500     MOVE     "S"             TO  XLABEL-TYPE        (2).
051600     MOVE     000001          TO  XRECORD-NUMBER     (2).
051700*INITIALIZE  RECORD WORK AREA NUMBER 2.
051800     MOVE     1         TO  WRK-CS-09V00-012.
051900     MOVE     ZERO      TO  WRK-CS-09V00-013 WRK-CS-09V00-014
052000                            WRK-CS-09V00-015 WRK-CS-09V00-016
052100                            WRK-CS-09V00-017 WRK-CS-09V00-018.
052200     MOVE     SPACE     TO  IX-FS2-STATUS.
052300     MOVE    ZERO TO WRK-DU-09V00-001.
052400     OPEN     OUTPUT    IX-FS2.
052500     MOVE GRP-0101 TO IX-FS2-KEY.
052600     MOVE     IX-FS2-STATUS TO WRK-XN-0002-001.
052700*CAPTURE STATUS KEY AFTER  OPEN STATEMENT IS EXECUTED.
052800 WRITE-TEST-GF-01.
052900     MOVE    "99"  TO IX-FS2-STATUS.
053000     MOVE     XRECORD-NUMBER (2) TO WRK-DU-09V00-001.
053100     MOVE     GRP-0101 TO XRECORD-KEY (2).
053200     MOVE     FILE-RECORD-INFO (2) TO IX-FS2R1-F-G-240.
053300     WRITE   IX-FS2R1-F-G-240.
053400     IF        IX-FS2-STATUS NOT EQUAL TO "00"
053500         ADD  1  TO WRK-CS-09V00-016.
053600     IF       XRECORD-NUMBER (2) EQUAL TO 500
053700              GO TO  WRITE-TEST-GF-01-2.
053800     ADD      01 TO  XRECORD-NUMBER (2).
053900     GO TO    WRITE-TEST-GF-01.
054000 WRITE-TEST-GF-01-2.
054100     IF       WRK-CS-09V00-014 NOT EQUAL TO ZERO
054200              MOVE "EXCEPTIONS/ERRORS" TO RE-MARK
054300              MOVE  ZERO TO CORRECT-18V0
054400              MOVE WRK-CS-09V00-014 TO COMPUTED-18V0
054500              MOVE "IX-41 4.9.2                       " TO RE-MARK
054600              PERFORM   FAIL
054700              ELSE
054800              PERFORM   PASS.
054900     PERFORM  PRINT-DETAIL.
055000 WRITE-TEST-GF-02.
055100     MOVE     "CREATE IX-FS2" TO  FEATURE
055200     MOVE    "WRITE-TEST-GF-02" TO PAR-NAME.
055300     IF       XRECORD-NUMBER (2) NOT EQUAL TO 500
055400              MOVE "INCORRECT COUNT" TO RE-MARK
055500              MOVE  500 TO CORRECT-18V0
055600             MOVE   XRECORD-NUMBER (2)  TO COMPUTED-18V0
055700              MOVE "IX-41 4.9.2                       " TO RE-MARK
055800              PERFORM  FAIL
055900              ELSE
056000              PERFORM PASS.
056100     PERFORM  PRINT-DETAIL.
056200 WRITE-TEST-GF-03.
056300     MOVE "OPEN: 00 EXP.    " TO  FEATURE.
056400     MOVE    "WRITE-TEST-GF-03" TO PAR-NAME.
056500     IF       WRK-XN-0002-001 NOT EQUAL TO  "00"
056600              MOVE WRK-XN-0002-001 TO COMPUTED-A
056700              MOVE "00" TO CORRECT-A
056800              MOVE "IX-41 4.9.2; IX-3 1.3.4  (1) A    " TO RE-MARK
056900              PERFORM  FAIL
057000              ELSE
057100              PERFORM  PASS.
057200     PERFORM  PRINT-DETAIL.
057300 WRITE-TEST-GF-04.
057400     MOVE     "WRITE: 00 EXP." TO  FEATURE.
057500     MOVE    "WRITE-TEST-GF-04" TO PAR-NAME.
057600     IF        IX-FS2-STATUS NOT EQUAL TO "00"
057700              MOVE IX-FS2-STATUS TO COMPUTED-A
057800              MOVE "00" TO CORRECT-A
057900              MOVE "IX-41 4.9.2; IX-3 1.3.4 (1) A     " TO RE-MARK
058000              PERFORM   FAIL
058100              ELSE
058200              PERFORM   PASS.
058300     PERFORM  PRINT-DETAIL.
058400 WRITE-TEST-GF-05.
058500     MOVE "WRITE: 00 EXP.   " TO  FEATURE.
058600     MOVE    "WRITE-TEST-GF-05" TO PAR-NAME.
058700     IF      WRK-CS-09V00-016    NOT EQUAL TO ZERO
058800              MOVE   ZERO TO CORRECT-18V0
058900              MOVE    WRK-CS-09V00-016 TO COMPUTED-18V0
059000              MOVE "IX-41 4.9.2; IX-3 1.3.4 (1) A     " TO RE-MARK
059100              PERFORM   FAIL
059200              ELSE
059300              PERFORM  PASS.
059400     PERFORM  PRINT-DETAIL.
059500 WRITE-TEST-GF-06.
059600     MOVE "CLOSE: 00 EXP.   " TO  FEATURE.
059700     MOVE    "WRITE-TEST-GF-06" TO PAR-NAME.
059800     MOVE     SPACE  TO  IX-FS2-STATUS.
059900     CLOSE    IX-FS2.
060000     IF        IX-FS2-STATUS NOT EQUAL TO "00"
060100              MOVE "CLOSE/STATUS; IX-3 1.3.4 (1) A" TO RE-MARK
060200              MOVE   IX-FS2-STATUS TO COMPUTED-A
060300              MOVE "00" TO CORRECT-A
060400              PERFORM FAIL
060500              ELSE
060600              PERFORM PASS.
060700     PERFORM  PRINT-DETAIL.
060800 READ-INIT-F1-01.
060900     MOVE     2     TO  WRK-CS-09V00-012.
061000     MOVE     ZERO  TO  WRK-CS-09V00-013.
061100     MOVE     ZERO  TO  WRK-CS-09V00-014.
061200     MOVE     ZERO  TO  WRK-CS-09V00-015.
061300     MOVE     ZERO  TO  WRK-CS-09V00-016.
061400     MOVE     ZERO  TO  WRK-CS-09V00-017.
061500     MOVE     ZERO  TO  WRK-CS-09V00-018.
061600     MOVE    SPACE TO IX-FS2-STATUS.
061700     OPEN     I-O  IX-FS2.
061800     MOVE     SPACE     TO  WRK-XN-0002-002
061900     MOVE     SPACE     TO  WRK-XN-0002-003
062000     MOVE     SPACE     TO  WRK-XN-0002-004
062100     MOVE      IX-FS2-STATUS TO WRK-XN-0002-001
062200     MOVE     SPACE TO IX-FS2-STATUS.
062300*CAPTURE THE CONTENTS OF STATUS KEY AFTER OPEN IS EXECUTED.
062400 READ-TEST-F1-01.
062500     ADD      1 TO WRK-CS-09V00-014.
062600     ADD      1 TO WRK-CS-09V00-015.
062700     READ  IX-FS2.
062800     IF        IX-FS2-STATUS EQUAL TO "10"
062900              GO TO  READ-TEST-F1-01-3.
063000     MOVE     IX-FS2R1-F-G-240 TO FILE-RECORD-INFO (2).
063100     IF       WRK-CS-09V00-015 EQUAL TO 5
063200              ADD 01 TO UPDATE-NUMBER (2)
063300     MOVE     FILE-RECORD-INFO (2) TO IX-FS2R1-F-G-240
063400             PERFORM  READ-010-UPDATE
063500           MOVE ZERO TO WRK-CS-09V00-015
063600              GO TO  READ-TEST-F1-01-2.
063700     IF       WRK-CS-09V00-014 GREATER 500
063800              GO TO  READ-TEST-F1-01-3.
063900     GO TO    READ-TEST-F1-01.
064000 READ-010-UPDATE.
064100     REWRITE   IX-FS2R1-F-G-240.
064200 READ-TEST-F1-01-2.
064300     IF        IX-FS2-STATUS NOT EQUAL TO "00"
064400              ADD 1 TO WRK-CS-09V00-016.
064500     MOVE    SPACE  TO   IX-FS2-STATUS.
064600     GO TO    READ-TEST-F1-01.
064700 READ-TEST-F1-01-3.
064800     MOVE    "READ: 10 EXP. "  TO FEATURE.
064900     MOVE    "READ-TEST-F1-01-3" TO PAR-NAME.
065000     IF       WRK-CS-09V00-013 NOT EQUAL TO 1
065100              MOVE  "IX-4 1.3.4 (2) A                 " TO RE-MARK
065200              MOVE WRK-CS-09V00-013 TO COMPUTED-18V0
065300              MOVE  1 TO CORRECT-18V0
065400              PERFORM FAIL
065500              ELSE
065600              PERFORM PASS.
065700     PERFORM  PRINT-DETAIL.
065800 READ-TEST-F1-02.
065900     MOVE    "READ                "  TO FEATURE.
066000     MOVE    "READ-TEST-F1-02  " TO PAR-NAME.
066100     IF       WRK-CS-09V00-014 NOT EQUAL TO 501
066200              MOVE "INCORRECT COUNT IX-28 4.5.2" TO RE-MARK
066300              MOVE WRK-CS-09V00-014 TO COMPUTED-18V0
066400              MOVE 501 TO CORRECT-18V0
066500              PERFORM FAIL
066600              ELSE
066700              PERFORM PASS.
066800     PERFORM  PRINT-DETAIL.
066900 READ-TEST-F1-03.
067000     MOVE    "OPEN:  00 EXP.      "  TO FEATURE.
067100     MOVE    "READ-TEST-F1-03  " TO PAR-NAME.
067200     IF       WRK-XN-0002-001 NOT EQUAL TO "00"
067300              MOVE  "IX-3 1.3.4 (1) A                 " TO RE-MARK
067400              MOVE WRK-XN-0002-001 TO COMPUTED-A
067500              MOVE  "00" TO CORRECT-A
067600              PERFORM FAIL
067700              ELSE
067800              PERFORM PASS.
067900     PERFORM  PRINT-DETAIL.
068000 READ-TEST-F1-04.
068100     MOVE    "READ AT END: 10 EXP."  TO FEATURE.
068200     MOVE    "READ-TEST-F1-04  " TO PAR-NAME.
068300     IF        IX-FS2-STATUS NOT EQUAL  TO "10"
068400              MOVE "ATEND/STATUS" TO RE-MARK
068500              MOVE  "IX-4 1.3.4 (2) A                 " TO RE-MARK
068600              MOVE  IX-FS2-STATUS TO COMPUTED-A
068700              MOVE "10" TO CORRECT-A
068800              PERFORM FAIL
068900              ELSE
069000              PERFORM PASS.
069100     PERFORM  PRINT-DETAIL.
069200 READ-TEST-F1-05.
069300     MOVE    "READ:   10 EXP.     "  TO FEATURE.
069400     MOVE    "READ-TEST-F1-05  " TO PAR-NAME.
069500     IF       WRK-XN-0002-002 NOT EQUAL TO "10"
069600              MOVE  "IX-4 1.3.4 (2) A                 " TO RE-MARK
069700              MOVE  WRK-XN-0002-002 TO COMPUTED-A
069800              MOVE  "10" TO CORRECT-A
069900              PERFORM FAIL
070000              ELSE
070100              PERFORM PASS.
070200     PERFORM  PRINT-DETAIL.
070300 READ-TEST-F1-06.
070400     MOVE    "READ NO EXCEPTION 10"  TO FEATURE.
070500     MOVE    "READ-TEST-F1-06  " TO PAR-NAME.
070600     IF       WRK-XN-0002-003 NOT EQUAL TO "10"
070700              MOVE "NO/EXCEPTION IX-4 1.3.4 (2) A" TO  RE-MARK
070800              MOVE WRK-XN-0002-003 TO COMPUTED-A
070900              MOVE "10" TO CORRECT-A
071000              PERFORM FAIL
071100              ELSE
071200              PERFORM PASS.
071300     PERFORM  PRINT-DETAIL.
071400 READ-TEST-F1-07.
071500     MOVE    "CLOSE:    00 EXP.   "  TO FEATURE.
071600     MOVE    "READ-TEST-F1-07  " TO PAR-NAME.
071700     MOVE     SPACE TO IX-FS2-STATUS.
071800     CLOSE    IX-FS2
071900     IF        IX-FS2-STATUS NOT EQUAL TO "00"
072000              MOVE "CLOSE/STATUS  IX-3  1.3.4 (1) A" TO RE-MARK
072100              MOVE  IX-FS2-STATUS TO  COMPUTED-A
072200              MOVE "00" TO CORRECT-A
072300              PERFORM FAIL
072400              ELSE
072500              PERFORM PASS.
072600     PERFORM  PRINT-DETAIL.
072700 CCVS-EXIT SECTION.
072800 CCVS-999999.
072900     GO TO CLOSE-FILES.
