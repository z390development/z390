000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     NC224A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*    PROGRAM NC224A TESTS THE USE OF REFERENCE MODIFICATION    *
002200*    ON A VARIETY OF DATA ITEMS USING LITERALS, DATA NAMES     *
002300*    AND ARITHMETIC EXPRESSIONS AS PARAMETERS.                 *
002400*    SUBSCRIPTED AND QUALIFIED DATA ITEMS ARE ALSO USED.       *
002500*                                                              *
002600****************************************************************
002700 ENVIRONMENT DIVISION.
002800 CONFIGURATION SECTION.
002900 SOURCE-COMPUTER.
003000     XXXXX082.
003100 OBJECT-COMPUTER.
003200     XXXXX083.
003300 INPUT-OUTPUT SECTION.
003400 FILE-CONTROL.
003500     SELECT PRINT-FILE ASSIGN TO
003600     XXXXX055.
003700 DATA DIVISION.
003800 FILE SECTION.
003900 FD  PRINT-FILE.
004000 01  PRINT-REC PICTURE X(120).
004100 01  DUMMY-RECORD PICTURE X(120).
004200 WORKING-STORAGE SECTION.
004300 01  TEST-1-DATA                 PIC   9(6)     VALUE 123456.
004400 01  TEST-2-DATA                 PIC   Z(5)9.
004500 01  TEST-3-DATA-GRP.
004600   03  TEST-3-DATA               PIC   X(6)     VALUE "ABCDEF".
004700 01  TEST-4-DATA                 PIC   XXBXXBXX VALUE "AB CD EF".
004800
004900 01  WS-2                        PIC  S9        VALUE +2.
005000 01  WS-3                        PIC  S9        VALUE +3.
005100 01  WS-5                        PIC  S9        VALUE +5.
005200 01  WS-6                        PIC  S9        VALUE +6.
005300 01  WS-7                        PIC  S9        VALUE +7.
005400 01  WS-10                       PIC  S99       VALUE +10.
005500 01  TEST-5-TABLE.
005600   03        TABLE-GROUP         OCCURS 4.
005700     05      TABLE-1             PIC 9(8)
005800                                 OCCURS 2.
005900   03         TEST-3-DATA        PIC X(6).
006000*
006100 01  TEST-RESULTS.
006200     02 FILLER                   PIC X      VALUE SPACE.
006300     02 FEATURE                  PIC X(20)  VALUE SPACE.
006400     02 FILLER                   PIC X      VALUE SPACE.
006500     02 P-OR-F                   PIC X(5)   VALUE SPACE.
006600     02 FILLER                   PIC X      VALUE SPACE.
006700     02  PAR-NAME.
006800       03 FILLER                 PIC X(19)  VALUE SPACE.
006900       03  PARDOT-X              PIC X      VALUE SPACE.
007000       03 DOTVALUE               PIC 99     VALUE ZERO.
007100     02 FILLER                   PIC X(8)   VALUE SPACE.
007200     02 RE-MARK                  PIC X(61).
007300 01  TEST-COMPUTED.
007400     02 FILLER                   PIC X(30)  VALUE SPACE.
007500     02 FILLER                   PIC X(17)  VALUE
007600            "       COMPUTED=".
007700     02 COMPUTED-X.
007800     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
007900     03 COMPUTED-N               REDEFINES COMPUTED-A
008000                                 PIC -9(9).9(9).
008100     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
008200     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
008300     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
008400     03       CM-18V0 REDEFINES COMPUTED-A.
008500         04 COMPUTED-18V0                    PIC -9(18).
008600         04 FILLER                           PIC X.
008700     03 FILLER PIC X(50) VALUE SPACE.
008800 01  TEST-CORRECT.
008900     02 FILLER PIC X(30) VALUE SPACE.
009000     02 FILLER PIC X(17) VALUE "       CORRECT =".
009100     02 CORRECT-X.
009200     03 CORRECT-A                  PIC X(20) VALUE SPACE.
009300     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
009400     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
009500     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
009600     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
009700     03      CR-18V0 REDEFINES CORRECT-A.
009800         04 CORRECT-18V0                     PIC -9(18).
009900         04 FILLER                           PIC X.
010000     03 FILLER PIC X(2) VALUE SPACE.
010100     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
010200 01  CCVS-C-1.
010300     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
010400-    "SS  PARAGRAPH-NAME
010500-    "       REMARKS".
010600     02 FILLER                     PIC X(20)    VALUE SPACE.
010700 01  CCVS-C-2.
010800     02 FILLER                     PIC X        VALUE SPACE.
010900     02 FILLER                     PIC X(6)     VALUE "TESTED".
011000     02 FILLER                     PIC X(15)    VALUE SPACE.
011100     02 FILLER                     PIC X(4)     VALUE "FAIL".
011200     02 FILLER                     PIC X(94)    VALUE SPACE.
011300 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
011400 01  REC-CT                        PIC 99       VALUE ZERO.
011500 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
011600 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
011700 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
011800 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
011900 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
012000 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
012100 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
012200 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
012300 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
012400 01  CCVS-H-1.
012500     02  FILLER                    PIC X(39)    VALUE SPACES.
012600     02  FILLER                    PIC X(42)    VALUE
012700     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
012800     02  FILLER                    PIC X(39)    VALUE SPACES.
012900 01  CCVS-H-2A.
013000   02  FILLER                        PIC X(40)  VALUE SPACE.
013100   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
013200   02  FILLER                        PIC XXXX   VALUE
013300     "4.2 ".
013400   02  FILLER                        PIC X(28)  VALUE
013500            " COPY - NOT FOR DISTRIBUTION".
013600   02  FILLER                        PIC X(41)  VALUE SPACE.
013700
013800 01  CCVS-H-2B.
013900   02  FILLER                        PIC X(15)  VALUE
014000            "TEST RESULT OF ".
014100   02  TEST-ID                       PIC X(9).
014200   02  FILLER                        PIC X(4)   VALUE
014300            " IN ".
014400   02  FILLER                        PIC X(12)  VALUE
014500     " HIGH       ".
014600   02  FILLER                        PIC X(22)  VALUE
014700            " LEVEL VALIDATION FOR ".
014800   02  FILLER                        PIC X(58)  VALUE
014900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
015000 01  CCVS-H-3.
015100     02  FILLER                      PIC X(34)  VALUE
015200            " FOR OFFICIAL USE ONLY    ".
015300     02  FILLER                      PIC X(58)  VALUE
015400     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
015500     02  FILLER                      PIC X(28)  VALUE
015600            "  COPYRIGHT   1985 ".
015700 01  CCVS-E-1.
015800     02 FILLER                       PIC X(52)  VALUE SPACE.
015900     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
016000     02 ID-AGAIN                     PIC X(9).
016100     02 FILLER                       PIC X(45)  VALUE SPACES.
016200 01  CCVS-E-2.
016300     02  FILLER                      PIC X(31)  VALUE SPACE.
016400     02  FILLER                      PIC X(21)  VALUE SPACE.
016500     02 CCVS-E-2-2.
016600         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
016700         03 FILLER                   PIC X      VALUE SPACE.
016800         03 ENDER-DESC               PIC X(44)  VALUE
016900            "ERRORS ENCOUNTERED".
017000 01  CCVS-E-3.
017100     02  FILLER                      PIC X(22)  VALUE
017200            " FOR OFFICIAL USE ONLY".
017300     02  FILLER                      PIC X(12)  VALUE SPACE.
017400     02  FILLER                      PIC X(58)  VALUE
017500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
017600     02  FILLER                      PIC X(13)  VALUE SPACE.
017700     02 FILLER                       PIC X(15)  VALUE
017800             " COPYRIGHT 1985".
017900 01  CCVS-E-4.
018000     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
018100     02 FILLER                       PIC X(4)   VALUE " OF ".
018200     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
018300     02 FILLER                       PIC X(40)  VALUE
018400      "  TESTS WERE EXECUTED SUCCESSFULLY".
018500 01  XXINFO.
018600     02 FILLER                       PIC X(19)  VALUE
018700            "*** INFORMATION ***".
018800     02 INFO-TEXT.
018900       04 FILLER                     PIC X(8)   VALUE SPACE.
019000       04 XXCOMPUTED                 PIC X(20).
019100       04 FILLER                     PIC X(5)   VALUE SPACE.
019200       04 XXCORRECT                  PIC X(20).
019300     02 INF-ANSI-REFERENCE           PIC X(48).
019400 01  HYPHEN-LINE.
019500     02 FILLER  PIC IS X VALUE IS SPACE.
019600     02 FILLER  PIC IS X(65)    VALUE IS "************************
019700-    "*****************************************".
019800     02 FILLER  PIC IS X(54)    VALUE IS "************************
019900-    "******************************".
020000 01  CCVS-PGM-ID                     PIC X(9)   VALUE
020100     "NC224A".
020200 PROCEDURE DIVISION.
020300 CCVS1 SECTION.
020400 OPEN-FILES.
020500     OPEN     OUTPUT PRINT-FILE.
020600     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
020700     MOVE    SPACE TO TEST-RESULTS.
020800     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
020900     GO TO CCVS1-EXIT.
021000 CLOSE-FILES.
021100     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
021200 TERMINATE-CCVS.
021300S    EXIT PROGRAM.
021400STERMINATE-CALL.
021500     STOP     RUN.
021600 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
021700 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
021800 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
021900 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
022000     MOVE "****TEST DELETED****" TO RE-MARK.
022100 PRINT-DETAIL.
022200     IF REC-CT NOT EQUAL TO ZERO
022300             MOVE "." TO PARDOT-X
022400             MOVE REC-CT TO DOTVALUE.
022500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
022600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
022700        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
022800          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
022900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
023000     MOVE SPACE TO CORRECT-X.
023100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
023200     MOVE     SPACE TO RE-MARK.
023300 HEAD-ROUTINE.
023400     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023500     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023600     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
023700     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
023800 COLUMN-NAMES-ROUTINE.
023900     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
024000     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
024200 END-ROUTINE.
024300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
024400 END-RTN-EXIT.
024500     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024600 END-ROUTINE-1.
024700      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
024800      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
024900      ADD PASS-COUNTER TO ERROR-HOLD.
025000*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
025100
025200      MOVE PASS-COUNTER TO CCVS-E-4-1.
025300      MOVE ERROR-HOLD TO CCVS-E-4-2.
025400      MOVE CCVS-E-4 TO CCVS-E-2-2.
025500      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
025600  END-ROUTINE-12.
025700      MOVE "TEST(S) FAILED" TO ENDER-DESC.
025800     IF       ERROR-COUNTER IS EQUAL TO ZERO
025900         MOVE "NO " TO ERROR-TOTAL
026000         ELSE
026100         MOVE ERROR-COUNTER TO ERROR-TOTAL.
026200     MOVE     CCVS-E-2 TO DUMMY-RECORD.
026300     PERFORM WRITE-LINE.
026400 END-ROUTINE-13.
026500     IF DELETE-COUNTER IS EQUAL TO ZERO
026600         MOVE "NO " TO ERROR-TOTAL  ELSE
026700         MOVE DELETE-COUNTER TO ERROR-TOTAL.
026800     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
026900     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027000      IF   INSPECT-COUNTER EQUAL TO ZERO
027100          MOVE "NO " TO ERROR-TOTAL
027200      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
027300      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
027400      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027500     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027600 WRITE-LINE.
027700     ADD 1 TO RECORD-COUNT.
027800Y    IF RECORD-COUNT GREATER 50
027900Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
028000Y        MOVE SPACE TO DUMMY-RECORD
028100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
028200Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
028300Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
028400Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
028500Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
028600Y        MOVE ZERO TO RECORD-COUNT.
028700     PERFORM WRT-LN.
028800 WRT-LN.
028900     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
029000     MOVE SPACE TO DUMMY-RECORD.
029100 BLANK-LINE-PRINT.
029200     PERFORM WRT-LN.
029300 FAIL-ROUTINE.
029400     IF     COMPUTED-X NOT EQUAL TO SPACE
029500            GO TO    FAIL-ROUTINE-WRITE.
029600     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
029700     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
029800     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
029900     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030000     MOVE   SPACES TO INF-ANSI-REFERENCE.
030100     GO TO  FAIL-ROUTINE-EX.
030200 FAIL-ROUTINE-WRITE.
030300     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
030400     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
030500     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
030600     MOVE   SPACES TO COR-ANSI-REFERENCE.
030700 FAIL-ROUTINE-EX. EXIT.
030800 BAIL-OUT.
030900     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
031000     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
031100 BAIL-OUT-WRITE.
031200     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
031300     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
031400     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031500     MOVE   SPACES TO INF-ANSI-REFERENCE.
031600 BAIL-OUT-EX. EXIT.
031700 CCVS1-EXIT.
031800     EXIT.
031900 SECT-NC224A-001 SECTION.
032000*
032100 REF-INIT-GF-1.
032200     MOVE   "REFERENCE MODIFICATION" TO FEATURE.
032300     MOVE   "IV-22 4.3.8.3" TO ANSI-REFERENCE.
032400     MOVE    123456  TO TEST-1-DATA.
032500     MOVE    1       TO REC-CT.
032600     GO TO   REF-TEST-GF-1-1.
032700 REF-DELETE-GF-1.
032800     PERFORM DE-LETE.
032900     PERFORM PRINT-DETAIL.
033000     GO TO   REF-INIT-GF-2.
033100 REF-TEST-GF-1-1.
033200     MOVE   "REF-TEST-GF-1-1" TO PAR-NAME.
033300     IF      TEST-1-DATA (3:) = 3456
033400             PERFORM PASS
033500             GO TO REF-WRITE-GF-1-1
033600     ELSE
033700             GO TO REF-FAIL-GF-1-1.
033800 REF-DELETE-GF-1-1.
033900     PERFORM DE-LETE.
034000     GO TO REF-WRITE-GF-1-1.
034100 REF-FAIL-GF-1-1.
034200     MOVE    3456 TO CORRECT-N
034300     MOVE    TEST-1-DATA (3:) TO COMPUTED-X
034400     MOVE   "INCORRECT REFERENCE MODIFICATION" TO RE-MARK
034500     PERFORM FAIL.
034600 REF-WRITE-GF-1-1.
034700     PERFORM PRINT-DETAIL.
034800*
034900 REF-TEST-GF-1-2.
035000     ADD     1       TO REC-CT.
035100     MOVE   "REF-TEST-GF-1-2" TO PAR-NAME.
035200     IF      TEST-1-DATA (2: WS-3) = 234
035300             PERFORM PASS
035400             GO TO REF-WRITE-GF-1-2
035500     ELSE
035600             GO TO REF-FAIL-GF-1-2.
035700 REF-DELETE-GF-1-2.
035800     PERFORM DE-LETE.
035900     GO TO REF-WRITE-GF-1-2.
036000 REF-FAIL-GF-1-2.
036100     MOVE    234 TO CORRECT-N
036200     MOVE    TEST-1-DATA (2: WS-3) TO COMPUTED-X
036300     MOVE   "INCORRECT REFERENCE MODIFICATION" TO RE-MARK
036400     PERFORM FAIL.
036500 REF-WRITE-GF-1-2.
036600     PERFORM PRINT-DETAIL.
036700*
036800 REF-TEST-GF-1-3.
036900     ADD     1       TO REC-CT.
037000     MOVE   "REF-TEST-GF-1-3" TO PAR-NAME.
037100     IF      TEST-1-DATA (10 - 7: 6 + 2 - 5) = 345
037200             PERFORM PASS
037300             GO TO REF-WRITE-GF-1-3
037400     ELSE
037500             GO TO REF-FAIL-GF-1-3.
037600 REF-DELETE-GF-1-3.
037700     PERFORM DE-LETE.
037800     GO TO REF-WRITE-GF-1-3.
037900 REF-FAIL-GF-1-3.
038000     MOVE    345 TO CORRECT-N
038100     MOVE    TEST-1-DATA (10 - 7: 6 + 2 - 5)
038200         TO COMPUTED-X
038300     MOVE   "INCORRECT REFERENCE MODIFICATION" TO RE-MARK
038400     PERFORM FAIL.
038500 REF-WRITE-GF-1-3.
038600     PERFORM PRINT-DETAIL.
038700*
038800 REF-INIT-GF-2.
038900     MOVE   "IV-22 4.3.8.3" TO ANSI-REFERENCE.
039000     MOVE    1234    TO TEST-2-DATA.
039100     MOVE    1       TO REC-CT.
039200     GO TO   REF-TEST-GF-2-1.
039300 REF-DELETE-GF-2.
039400     PERFORM DE-LETE.
039500     PERFORM PRINT-DETAIL.
039600     GO TO   REF-INIT-GF-3.
039700 REF-TEST-GF-2-1.
039800     MOVE   "REF-TEST-GF-2-1" TO PAR-NAME.
039900     IF      TEST-2-DATA (WS-3:) = "1234"
040000             PERFORM PASS
040100             GO TO REF-WRITE-GF-2-1
040200     ELSE
040300             GO TO REF-FAIL-GF-2-1.
040400 REF-DELETE-GF-2-1.
040500     PERFORM DE-LETE.
040600     GO TO REF-WRITE-GF-2-1.
040700 REF-FAIL-GF-2-1.
040800     MOVE   "1234" TO CORRECT-X
040900     MOVE    TEST-2-DATA (WS-3:) TO COMPUTED-X
041000     MOVE   "INCORRECT REFERENCE MODIFICATION" TO RE-MARK
041100     PERFORM FAIL.
041200 REF-WRITE-GF-2-1.
041300     PERFORM PRINT-DETAIL.
041400*
041500 REF-TEST-GF-2-2.
041600     ADD     1       TO REC-CT.
041700     MOVE   "REF-TEST-GF-2-2" TO PAR-NAME.
041800     IF      TEST-2-DATA (WS-2: 3) = " 12"
041900             PERFORM PASS
042000             GO TO REF-WRITE-GF-2-2
042100     ELSE
042200             GO TO REF-FAIL-GF-2-2.
042300 REF-DELETE-GF-2-2.
042400     PERFORM DE-LETE.
042500     GO TO REF-WRITE-GF-2-2.
042600 REF-FAIL-GF-2-2.
042700     MOVE   " 12" TO CORRECT-X
042800     MOVE    TEST-2-DATA (WS-2: 3) TO COMPUTED-X
042900     MOVE   "INCORRECT REFERENCE MODIFICATION" TO RE-MARK
043000     PERFORM FAIL.
043100 REF-WRITE-GF-2-2.
043200     PERFORM PRINT-DETAIL.
043300*
043400 REF-TEST-GF-2-3.
043500     ADD     1       TO REC-CT.
043600     MOVE   "REF-TEST-GF-2-3" TO PAR-NAME.
043700     IF      TEST-2-DATA (10 - 7: 6 + 2 - 5) = "123"
043800             PERFORM PASS
043900             GO TO REF-WRITE-GF-2-3
044000     ELSE
044100             GO TO REF-FAIL-GF-2-3.
044200 REF-DELETE-GF-2-3.
044300     PERFORM DE-LETE.
044400     GO TO REF-WRITE-GF-2-3.
044500 REF-FAIL-GF-2-3.
044600     MOVE   "123" TO CORRECT-X
044700     MOVE    TEST-2-DATA (10 - 7: 6 + 2 - 5)
044800          TO COMPUTED-X
044900     MOVE   "INCORRECT REFERENCE MODIFICATION" TO RE-MARK
045000     PERFORM FAIL.
045100 REF-WRITE-GF-2-3.
045200     PERFORM PRINT-DETAIL.
045300*
045400 REF-INIT-GF-3.
045500     MOVE   "IV-22 4.3.8.3" TO ANSI-REFERENCE.
045600     MOVE   "ABCDEF" TO TEST-3-DATA IN TEST-3-DATA-GRP.
045700     MOVE    1       TO REC-CT.
045800     GO TO   REF-TEST-GF-3-1.
045900 REF-DELETE-GF-3.
046000     PERFORM DE-LETE.
046100     PERFORM PRINT-DETAIL.
046200     GO TO   REF-INIT-GF-3.
046300 REF-TEST-GF-3-1.
046400     MOVE   "REF-TEST-GF-3-1" TO PAR-NAME.
046500     IF      TEST-3-DATA IN TEST-3-DATA-GRP (3:) = "CDEF"
046600             PERFORM PASS
046700             GO TO REF-WRITE-GF-3-1
046800     ELSE
046900             GO TO REF-FAIL-GF-3-1.
047000 REF-DELETE-GF-3-1.
047100     PERFORM DE-LETE.
047200     GO TO REF-WRITE-GF-3-1.
047300 REF-FAIL-GF-3-1.
047400     MOVE   "CDEF" TO CORRECT-X.
047500     MOVE    TEST-3-DATA IN TEST-3-DATA-GRP (3:) TO COMPUTED-X.
047600     MOVE   "INCORRECT REFERENCE MODIFICATION" TO RE-MARK.
047700     PERFORM FAIL.
047800 REF-WRITE-GF-3-1.
047900     PERFORM PRINT-DETAIL.
048000*
048100 REF-TEST-GF-3-2.
048200     ADD     1       TO REC-CT.
048300     MOVE   "REF-TEST-GF-3-2" TO PAR-NAME.
048400     IF      TEST-3-DATA IN TEST-3-DATA-GRP (2: WS-3) = "BCD"
048500             PERFORM PASS
048600             GO TO REF-WRITE-GF-3-2
048700     ELSE
048800             GO TO REF-FAIL-GF-3-2.
048900 REF-DELETE-GF-3-2.
049000     PERFORM DE-LETE.
049100     GO TO REF-WRITE-GF-3-2.
049200 REF-FAIL-GF-3-2.
049300     MOVE   "BCD" TO CORRECT-X.
049400     MOVE    TEST-3-DATA IN TEST-3-DATA-GRP (2: WS-3)
049500          TO COMPUTED-X.
049600     MOVE   "INCORRECT REFERENCE MODIFICATION" TO RE-MARK.
049700     PERFORM FAIL.
049800 REF-WRITE-GF-3-2.
049900     PERFORM PRINT-DETAIL.
050000*
050100 REF-TEST-GF-3-3.
050200     ADD     1       TO REC-CT.
050300     MOVE   "REF-TEST-GF-3-3" TO PAR-NAME.
050400     IF      TEST-3-DATA IN TEST-3-DATA-GRP (10 - 7: 6 + 2 - 5)
050500           = "CDE"
050600             PERFORM PASS
050700             GO TO REF-WRITE-GF-3-3
050800     ELSE
050900             GO TO REF-FAIL-GF-3-3.
051000 REF-DELETE-GF-3-3.
051100     PERFORM DE-LETE.
051200     GO TO REF-WRITE-GF-3-3.
051300 REF-FAIL-GF-3-3.
051400     MOVE   "CDE" TO CORRECT-X.
051500     MOVE    TEST-3-DATA IN TEST-3-DATA-GRP (10 - 7: 6 + 2 - 5)
051600          TO COMPUTED-X
051700     MOVE   "INCORRECT REFERENCE MODIFICATION" TO RE-MARK
051800     PERFORM FAIL.
051900 REF-WRITE-GF-3-3.
052000     PERFORM PRINT-DETAIL.
052100*
052200 REF-INIT-GF-4.
052300     MOVE   "IV-22 4.3.8.3" TO ANSI-REFERENCE.
052400     MOVE   "ABCDEF" TO TEST-4-DATA.
052500     MOVE    1       TO REC-CT.
052600     GO TO   REF-TEST-GF-4-1.
052700 REF-DELETE-GF-4.
052800     PERFORM DE-LETE.
052900     PERFORM PRINT-DETAIL.
053000     GO TO   REF-INIT-GF-5.
053100 REF-TEST-GF-4-1.
053200     MOVE   "REF-TEST-GF-4-1" TO PAR-NAME.
053300     IF      TEST-4-DATA (3:) = " CD EF"
053400             PERFORM PASS
053500             GO TO REF-WRITE-GF-4-1
053600     ELSE
053700             GO TO REF-FAIL-GF-4-1.
053800 REF-DELETE-GF-4-1.
053900     PERFORM DE-LETE.
054000     GO TO REF-WRITE-GF-4-1.
054100 REF-FAIL-GF-4-1.
054200     MOVE   " CD EF" TO CORRECT-X
054300     MOVE    TEST-4-DATA (3:) TO COMPUTED-X
054400     MOVE   "INCORRECT REFERENCE MODIFICATION" TO RE-MARK
054500     PERFORM FAIL.
054600 REF-WRITE-GF-4-1.
054700     PERFORM PRINT-DETAIL.
054800*
054900 REF-TEST-GF-4-2.
055000     ADD     1       TO REC-CT.
055100     MOVE   "REF-TEST-GF-4-2" TO PAR-NAME.
055200     IF      TEST-4-DATA (WS-2: WS-3) = "B C"
055300             PERFORM PASS
055400             GO TO REF-WRITE-GF-4-2
055500     ELSE
055600             GO TO REF-FAIL-GF-4-2.
055700 REF-DELETE-GF-4-2.
055800     PERFORM DE-LETE.
055900     GO TO REF-WRITE-GF-4-2.
056000 REF-FAIL-GF-4-2.
056100     MOVE   "B C" TO CORRECT-X
056200     MOVE    TEST-4-DATA (WS-2: WS-3) TO COMPUTED-X
056300     MOVE   "INCORRECT REFERENCE MODIFICATION" TO RE-MARK
056400     PERFORM FAIL.
056500 REF-WRITE-GF-4-2.
056600     PERFORM PRINT-DETAIL.
056700*
056800 REF-TEST-GF-4-3.
056900     ADD     1       TO REC-CT.
057000     MOVE   "REF-TEST-GF-4-3" TO PAR-NAME.
057100     IF      TEST-4-DATA (10 - 7: 6 + 2 - 5) = " CD"
057200             PERFORM PASS
057300             GO TO REF-WRITE-GF-4-3
057400     ELSE
057500             GO TO REF-FAIL-GF-4-3.
057600 REF-DELETE-GF-4-3.
057700     PERFORM DE-LETE.
057800     GO TO REF-WRITE-GF-4-3.
057900 REF-FAIL-GF-4-3.
058000     MOVE   " CD" TO CORRECT-X
058100     MOVE    TEST-4-DATA (10 - 7: 6 + 2 - 5)
058200          TO COMPUTED-X
058300     MOVE   "INCORRECT REFERENCE MODIFICATION" TO RE-MARK
058400     PERFORM FAIL.
058500 REF-WRITE-GF-4-3.
058600     PERFORM PRINT-DETAIL.
058700*
058800 REF-INIT-GF-5.
058900*    ===-->  SUBSCRIPTED DATA-NAME  <--===
059000     MOVE   "IV-22 4.3.8.3.3 SR4" TO ANSI-REFERENCE.
059100     MOVE    12345678 TO TABLE-1 (3 2).
059200     MOVE    1       TO REC-CT.
059300     GO TO   REF-TEST-GF-5-1.
059400 REF-DELETE-GF-5.
059500     PERFORM DE-LETE.
059600     PERFORM PRINT-DETAIL.
059700     GO TO   REF-INIT-GF-6.
059800 REF-TEST-GF-5-1.
059900     MOVE   "REF-TEST-GF-5-1" TO PAR-NAME.
060000     IF      TABLE-1 (3 2) (2: 5) = 23456
060100             PERFORM PASS
060200             GO TO REF-WRITE-GF-5-1
060300     ELSE
060400             GO TO REF-FAIL-GF-5-1.
060500 REF-DELETE-GF-5-1.
060600     PERFORM DE-LETE.
060700     GO TO REF-WRITE-GF-5-1.
060800 REF-FAIL-GF-5-1.
060900     MOVE    23456   TO CORRECT-N
061000     MOVE    TABLE-1 (3 2) (2: 5) TO COMPUTED-X
061100     MOVE   "INCORRECT REFERENCE MODIFICATION" TO RE-MARK
061200     PERFORM FAIL.
061300 REF-WRITE-GF-5-1.
061400     PERFORM PRINT-DETAIL.
061500*
061600 REF-INIT-GF-6.
061700*    ===-->  QUALIFIED DATA-NAME  <--===
061800     MOVE   "IV-22 4.3.8.3.3 SR4" TO ANSI-REFERENCE.
061900     MOVE   "OPQRST" TO TEST-3-DATA OF TEST-5-TABLE.
062000     MOVE    1       TO REC-CT.
062100     GO TO   REF-TEST-GF-6-1.
062200 REF-DELETE-GF-6.
062300     PERFORM DE-LETE.
062400     PERFORM PRINT-DETAIL.
062500     GO TO   CCVS-EXIT.
062600 REF-TEST-GF-6-1.
062700     MOVE   "REF-TEST-GF-6-1" TO PAR-NAME.
062800     IF      TEST-3-DATA OF TEST-5-TABLE (2: 4) = "PQRS"
062900             PERFORM PASS
063000             GO TO   REF-WRITE-GF-6-1
063100     ELSE
063200             GO TO   REF-FAIL-GF-6-1.
063300 REF-DELETE-GF-6-1.
063400     PERFORM DE-LETE.
063500     GO TO   REF-WRITE-GF-6-1.
063600 REF-FAIL-GF-6-1.
063700     MOVE   "PQRS"   TO CORRECT-X.
063800     MOVE    TEST-3-DATA OF TEST-5-TABLE (2: 4)
063900          TO COMPUTED-X
064000     MOVE   "INCORRECT REFERENCE MODIFICATION" TO RE-MARK
064100     PERFORM FAIL.
064200 REF-WRITE-GF-6-1.
064300     PERFORM PRINT-DETAIL.
064400*
064500 CCVS-EXIT SECTION.
064600 CCVS-999999.
064700     GO TO CLOSE-FILES.
