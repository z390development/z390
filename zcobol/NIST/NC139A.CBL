000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     NC139A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*
002200*    PROGRAM NC139A TESTS THE USE OF NUMERIC LITERALS WITH
002300*    RELATIVE INDEXING WHEN ACCESSING 2 AND 3 DIMENSIONAL
002400*    TABLES.
002500*    THE USE OF INDEXES AND SUBSCRIPTS TOGETHER IS ALSO TESTED.
002600*
002700 ENVIRONMENT DIVISION.
002800 CONFIGURATION SECTION.
002900 SOURCE-COMPUTER.
003000     XXXXX082.
003100 OBJECT-COMPUTER.
003200     XXXXX083.
003300 INPUT-OUTPUT SECTION.
003400 FILE-CONTROL.
003500     SELECT PRINT-FILE ASSIGN TO
003600     XXXXX055.
003700 DATA DIVISION.
003800 FILE SECTION.
003900 FD  PRINT-FILE.
004000 01  PRINT-REC PICTURE X(120).
004100 01  DUMMY-RECORD PICTURE X(120).
004200 WORKING-STORAGE SECTION.
004300*         LITERALS AND INDEX-NAMES MAY BE MIXED IN A TABLE
004400*    REFERENCE.  THE LITERALS MAY BE SIGNED BUT MUST BE POSITIVE.
004500*    RELATIVE INDEXING WITH BOTH POSITIVE AND NEGATIVE INTEGERS
004600*    IS PERMITTED.
004700 01  WS-2      PIC 9.
004800 01  WS-PLUS-2 PIC S9.
004900 01  WS-4      PIC 9.
005000 01  WS-PLUS-4 PIC S9.
005100 77  TEMP PIC XXX.
005200 77  EXPECTED-VALUE  PIC XXX.
005300*        TWO DIMENSIONAL TABLE, 6X4, WITH INDEXES.
005400 01  GRP-TAB1.
005500     02  GRP-1  OCCURS 6 TIMES
005600                INDEXED BY IN1.
005700         03  ELEM1  PIC  XXX
005800                OCCURS 4 TIMES
005900                INDEXED BY IN2.
006000*       THREE DIMENSIONAL TABLE, 3X2X4, WITH INDEXES.
006100 01  GRP-TAB2.
006200     02  GRP-2   OCCURS 3 TIMES
006300                 INDEXED BY INDEX1.
006400         03  GRP-3  OCCURS 2 TIMES
006500                    INDEXED BY INDEX2.
006600             04  ELEM2 PIC XXX
006700                       OCCURS 4 TIMES
006800                       INDEXED BY INDEX3.
006900 01  TABLE-VALUES.
007000     02  VALUES-1   PIC  X(12)
007100             VALUE "AAABBBCCCDDD".
007200     02  VALUES-2   PIC  X(12)
007300             VALUE "EEEFFFGGGHHH".
007400     02  VALUES-3   PIC  X(12)
007500             VALUE "IIIJJJKKKLLL".
007600     02  VALUES-4   PIC  X(12)
007700             VALUE "MMMNNNOOOPPP".
007800     02  VALUES-5   PIC  X(12)
007900             VALUE "QQQRRRSSSTTT".
008000     02  VALUES-6   PIC  X(12)
008100             VALUE "UUUVVVWWWXXX".
008200 01  TEST-RESULTS.
008300     02 FILLER                   PIC X      VALUE SPACE.
008400     02 FEATURE                  PIC X(20)  VALUE SPACE.
008500     02 FILLER                   PIC X      VALUE SPACE.
008600     02 P-OR-F                   PIC X(5)   VALUE SPACE.
008700     02 FILLER                   PIC X      VALUE SPACE.
008800     02  PAR-NAME.
008900       03 FILLER                 PIC X(19)  VALUE SPACE.
009000       03  PARDOT-X              PIC X      VALUE SPACE.
009100       03 DOTVALUE               PIC 99     VALUE ZERO.
009200     02 FILLER                   PIC X(8)   VALUE SPACE.
009300     02 RE-MARK                  PIC X(61).
009400 01  TEST-COMPUTED.
009500     02 FILLER                   PIC X(30)  VALUE SPACE.
009600     02 FILLER                   PIC X(17)  VALUE
009700            "       COMPUTED=".
009800     02 COMPUTED-X.
009900     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
010000     03 COMPUTED-N               REDEFINES COMPUTED-A
010100                                 PIC -9(9).9(9).
010200     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
010300     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
010400     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
010500     03       CM-18V0 REDEFINES COMPUTED-A.
010600         04 COMPUTED-18V0                    PIC -9(18).
010700         04 FILLER                           PIC X.
010800     03 FILLER PIC X(50) VALUE SPACE.
010900 01  TEST-CORRECT.
011000     02 FILLER PIC X(30) VALUE SPACE.
011100     02 FILLER PIC X(17) VALUE "       CORRECT =".
011200     02 CORRECT-X.
011300     03 CORRECT-A                  PIC X(20) VALUE SPACE.
011400     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
011500     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
011600     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
011700     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
011800     03      CR-18V0 REDEFINES CORRECT-A.
011900         04 CORRECT-18V0                     PIC -9(18).
012000         04 FILLER                           PIC X.
012100     03 FILLER PIC X(2) VALUE SPACE.
012200     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
012300 01  CCVS-C-1.
012400     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
012500-    "SS  PARAGRAPH-NAME
012600-    "       REMARKS".
012700     02 FILLER                     PIC X(20)    VALUE SPACE.
012800 01  CCVS-C-2.
012900     02 FILLER                     PIC X        VALUE SPACE.
013000     02 FILLER                     PIC X(6)     VALUE "TESTED".
013100     02 FILLER                     PIC X(15)    VALUE SPACE.
013200     02 FILLER                     PIC X(4)     VALUE "FAIL".
013300     02 FILLER                     PIC X(94)    VALUE SPACE.
013400 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
013500 01  REC-CT                        PIC 99       VALUE ZERO.
013600 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
013700 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
013800 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
013900 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
014000 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
014100 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
014200 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
014300 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
014400 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
014500 01  CCVS-H-1.
014600     02  FILLER                    PIC X(39)    VALUE SPACES.
014700     02  FILLER                    PIC X(42)    VALUE
014800     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
014900     02  FILLER                    PIC X(39)    VALUE SPACES.
015000 01  CCVS-H-2A.
015100   02  FILLER                        PIC X(40)  VALUE SPACE.
015200   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
015300   02  FILLER                        PIC XXXX   VALUE
015400     "4.2 ".
015500   02  FILLER                        PIC X(28)  VALUE
015600            " COPY - NOT FOR DISTRIBUTION".
015700   02  FILLER                        PIC X(41)  VALUE SPACE.
015800
015900 01  CCVS-H-2B.
016000   02  FILLER                        PIC X(15)  VALUE
016100            "TEST RESULT OF ".
016200   02  TEST-ID                       PIC X(9).
016300   02  FILLER                        PIC X(4)   VALUE
016400            " IN ".
016500   02  FILLER                        PIC X(12)  VALUE
016600     " HIGH       ".
016700   02  FILLER                        PIC X(22)  VALUE
016800            " LEVEL VALIDATION FOR ".
016900   02  FILLER                        PIC X(58)  VALUE
017000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
017100 01  CCVS-H-3.
017200     02  FILLER                      PIC X(34)  VALUE
017300            " FOR OFFICIAL USE ONLY    ".
017400     02  FILLER                      PIC X(58)  VALUE
017500     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
017600     02  FILLER                      PIC X(28)  VALUE
017700            "  COPYRIGHT   1985 ".
017800 01  CCVS-E-1.
017900     02 FILLER                       PIC X(52)  VALUE SPACE.
018000     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
018100     02 ID-AGAIN                     PIC X(9).
018200     02 FILLER                       PIC X(45)  VALUE SPACES.
018300 01  CCVS-E-2.
018400     02  FILLER                      PIC X(31)  VALUE SPACE.
018500     02  FILLER                      PIC X(21)  VALUE SPACE.
018600     02 CCVS-E-2-2.
018700         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
018800         03 FILLER                   PIC X      VALUE SPACE.
018900         03 ENDER-DESC               PIC X(44)  VALUE
019000            "ERRORS ENCOUNTERED".
019100 01  CCVS-E-3.
019200     02  FILLER                      PIC X(22)  VALUE
019300            " FOR OFFICIAL USE ONLY".
019400     02  FILLER                      PIC X(12)  VALUE SPACE.
019500     02  FILLER                      PIC X(58)  VALUE
019600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
019700     02  FILLER                      PIC X(13)  VALUE SPACE.
019800     02 FILLER                       PIC X(15)  VALUE
019900             " COPYRIGHT 1985".
020000 01  CCVS-E-4.
020100     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
020200     02 FILLER                       PIC X(4)   VALUE " OF ".
020300     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
020400     02 FILLER                       PIC X(40)  VALUE
020500      "  TESTS WERE EXECUTED SUCCESSFULLY".
020600 01  XXINFO.
020700     02 FILLER                       PIC X(19)  VALUE
020800            "*** INFORMATION ***".
020900     02 INFO-TEXT.
021000       04 FILLER                     PIC X(8)   VALUE SPACE.
021100       04 XXCOMPUTED                 PIC X(20).
021200       04 FILLER                     PIC X(5)   VALUE SPACE.
021300       04 XXCORRECT                  PIC X(20).
021400     02 INF-ANSI-REFERENCE           PIC X(48).
021500 01  HYPHEN-LINE.
021600     02 FILLER  PIC IS X VALUE IS SPACE.
021700     02 FILLER  PIC IS X(65)    VALUE IS "************************
021800-    "*****************************************".
021900     02 FILLER  PIC IS X(54)    VALUE IS "************************
022000-    "******************************".
022100 01  CCVS-PGM-ID                     PIC X(9)   VALUE
022200     "NC139A".
022300 PROCEDURE DIVISION.
022400 CCVS1 SECTION.
022500 OPEN-FILES.
022600     OPEN     OUTPUT PRINT-FILE.
022700     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
022800     MOVE    SPACE TO TEST-RESULTS.
022900     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
023000     GO TO CCVS1-EXIT.
023100 CLOSE-FILES.
023200     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
023300 TERMINATE-CCVS.
023400S    EXIT PROGRAM.
023500STERMINATE-CALL.
023600     STOP     RUN.
023700 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
023800 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
023900 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
024000 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
024100     MOVE "****TEST DELETED****" TO RE-MARK.
024200 PRINT-DETAIL.
024300     IF REC-CT NOT EQUAL TO ZERO
024400             MOVE "." TO PARDOT-X
024500             MOVE REC-CT TO DOTVALUE.
024600     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
024700     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
024800        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
024900          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
025000     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
025100     MOVE SPACE TO CORRECT-X.
025200     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
025300     MOVE     SPACE TO RE-MARK.
025400 HEAD-ROUTINE.
025500     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025600     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025700     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
025800     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
025900 COLUMN-NAMES-ROUTINE.
026000     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026100     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
026300 END-ROUTINE.
026400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
026500 END-RTN-EXIT.
026600     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026700 END-ROUTINE-1.
026800      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
026900      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
027000      ADD PASS-COUNTER TO ERROR-HOLD.
027100*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
027200      MOVE PASS-COUNTER TO CCVS-E-4-1.
027300      MOVE ERROR-HOLD TO CCVS-E-4-2.
027400      MOVE CCVS-E-4 TO CCVS-E-2-2.
027500      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
027600  END-ROUTINE-12.
027700      MOVE "TEST(S) FAILED" TO ENDER-DESC.
027800     IF       ERROR-COUNTER IS EQUAL TO ZERO
027900         MOVE "NO " TO ERROR-TOTAL
028000         ELSE
028100         MOVE ERROR-COUNTER TO ERROR-TOTAL.
028200     MOVE     CCVS-E-2 TO DUMMY-RECORD.
028300     PERFORM WRITE-LINE.
028400 END-ROUTINE-13.
028500     IF DELETE-COUNTER IS EQUAL TO ZERO
028600         MOVE "NO " TO ERROR-TOTAL  ELSE
028700         MOVE DELETE-COUNTER TO ERROR-TOTAL.
028800     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
028900     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029000      IF   INSPECT-COUNTER EQUAL TO ZERO
029100          MOVE "NO " TO ERROR-TOTAL
029200      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
029300      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
029400      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029500     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029600 WRITE-LINE.
029700     ADD 1 TO RECORD-COUNT.
029800Y    IF RECORD-COUNT GREATER 42
029900Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
030000Y        MOVE SPACE TO DUMMY-RECORD
030100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
030200Y        MOVE CCVS-H-1  TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
030300Y        MOVE CCVS-H-2A TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
030400Y        MOVE CCVS-H-2B TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
030500Y        MOVE CCVS-H-3  TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
030600Y        MOVE CCVS-C-1  TO DUMMY-RECORD  PERFORM WRT-LN
030700Y        MOVE CCVS-C-2  TO DUMMY-RECORD  PERFORM WRT-LN
030800Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
030900Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
031000Y        MOVE ZERO TO RECORD-COUNT.
031100     PERFORM WRT-LN.
031200 WRT-LN.
031300     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
031400     MOVE SPACE TO DUMMY-RECORD.
031500 BLANK-LINE-PRINT.
031600     PERFORM WRT-LN.
031700 FAIL-ROUTINE.
031800     IF     COMPUTED-X NOT EQUAL TO SPACE
031900            GO TO FAIL-ROUTINE-WRITE.
032000     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
032100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
032200     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
032300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032400     MOVE   SPACES TO INF-ANSI-REFERENCE.
032500     GO TO  FAIL-ROUTINE-EX.
032600 FAIL-ROUTINE-WRITE.
032700     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
032800     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
032900     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
033000     MOVE   SPACES TO COR-ANSI-REFERENCE.
033100 FAIL-ROUTINE-EX. EXIT.
033200 BAIL-OUT.
033300     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
033400     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
033500 BAIL-OUT-WRITE.
033600     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
033700     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
033800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033900     MOVE   SPACES TO INF-ANSI-REFERENCE.
034000 BAIL-OUT-EX. EXIT.
034100 CCVS1-EXIT.
034200     EXIT.
034300*********************************
034400*        STATEMENT DELETION INSTRUCTIONS
034500*         IF THE COMPILER REJECTS ANY OF THE TABLE REFERENCES IN
034600*    THIS ROUTINE, DELETE THAT LINE OF CODE BY PLACING AN * IN
034700*    COLUMN 7.  LEAVE THE PERFORM...THRU STATEMENT.  THE TEST
034800*    ELEMENT DELETED APPEARS AS A FAILURE ON THE OUTPUT REPORT.
034900*****************************************
035000 SECT-NC139A-001 SECTION.
035100 NC139A-001.
035200     MOVE "IV-21 4.3.8.2" TO ANSI-REFERENCE.
035300*        THIS SECTION STORES AAA THRU XXX IN THE TWO TABLES
035400*    REFERENCED IN THE TESTS.
035500 BUILD-TABLE.
035600     SET IN1 TO 1.
035700     MOVE VALUES-1 TO GRP-1 (IN1).
035800     MOVE VALUES-2 TO GRP-1 (IN1 + 1).
035900     MOVE VALUES-3 TO GRP-1 (IN1 + 2).
036000     MOVE VALUES-4 TO GRP-1 (IN1 + 3).
036100     MOVE VALUES-5 TO GRP-1 (IN1 + 4).
036200     MOVE VALUES-6 TO GRP-1 (IN1 + 5).
036300     MOVE GRP-TAB1 TO GRP-TAB2.
036400 SECT-TH110-0002 SECTION.
036500*       THIS SECTION CONTAINS THE TESTS WHICH VALIDATE
036600*    THE HANDLING OF LITERALS MIXED WITH INDEX-NAMES
036700*    IN REFERENCING TWO AND THREE DIMENSIONAL TABLES.
036800 IND-INIT-001.
036900*        THIS TEST MIXES UNSIGNED LITERALS WITH INDEX-NAMES.
037000     SET IN1  IN2  TO 1.
037100     SET INDEX1  INDEX2  INDEX3  TO 1.
037200     MOVE "AAA" TO EXPECTED-VALUE.
037300     MOVE SPACE TO TEMP.
037400     MOVE ZERO TO REC-CT.
037500     MOVE "IND-TEST-001" TO PAR-NAME.
037600     MOVE "INDEXES AND LITERALS" TO FEATURE.
037700 IND-TEST-001-01.
037800     MOVE ELEM1 (IN1, 1) TO TEMP.
037900     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
038000 IND-TEST-001-02.
038100     MOVE ELEM1(1 IN2) TO TEMP.
038200     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
038300 IND-TEST-001-03.
038400     MOVE ELEM1(1, IN2) TO TEMP.
038500     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
038600 IND-TEST-001-04.
038700     MOVE ELEM2 (1 INDEX2 1)  TO TEMP.
038800     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
038900 IND-TEST-001-05.
039000     MOVE ELEM2(INDEX1 INDEX2 1) TO TEMP.
039100     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
039200 IND-TEST-001-06.
039300     MOVE ELEM2 (INDEX1, 1  INDEX3) TO TEMP.
039400     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
039500 IND-TEST-001-07.
039600     MOVE ELEM2 (1 1 INDEX3) TO TEMP.
039700     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
039800     GO TO IND-INIT-002.
039900 IND-DELETE-001.
040000     PERFORM DE-LETE.
040100     PERFORM SYNTAX-CHECK-WRITE.
040200 IND-INIT-002.
040300*       THIS TEST MIXES SIGNED LITERALS WITH INDEX-NAMES.
040400     MOVE ZERO TO REC-CT.
040500     MOVE SPACE TO TEMP.
040600     MOVE "GGG" TO EXPECTED-VALUE.
040700     MOVE "IND-TEST-002" TO PAR-NAME.
040800     SET INDEX1 TO 1.
040900     SET IN1 INDEX2 TO 2.
041000     SET IN2 INDEX3 TO 3.
041100 IND-TEST-002-01.
041200     MOVE ELEM1(IN1, +3) TO TEMP.
041300     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
041400 IND-TEST-002-02.
041500     MOVE ELEM1(+2, IN2) TO TEMP.
041600     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
041700 IND-TEST-002-03.
041800     IF ELEM1 (+2 IN2) EQUAL TO "GGG"
041900         MOVE "GGG" TO TEMP.
042000     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
042100 IND-TEST-002-04.
042200     IF ELEM1 (IN1  +3) IS EQUAL TO EXPECTED-VALUE
042300          MOVE "GGG" TO TEMP.
042400     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
042500 IND-TEST-002-05.
042600     MOVE ELEM2(+1, INDEX2, +3)  TO TEMP.
042700     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
042800 IND-TEST-002-06.
042900     MOVE ELEM2(+1 INDEX2 +3) TO TEMP.
043000     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
043100 IND-TEST-002-07.
043200     MOVE ELEM2 (INDEX1  +2, +3) TO TEMP.
043300     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
043400 IND-TEST-002-08.
043500     MOVE ELEM2 (INDEX1  INDEX2  +3)  TO  TEMP.
043600     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
043700     GO TO IND-INIT-003.
043800 IND-DELETE-002.
043900     PERFORM DE-LETE.
044000     PERFORM SYNTAX-CHECK-WRITE.
044100 IND-INIT-003.
044200*       THIS TEST MIXES UNSIGNED LITERALS WITH RELATIVE INDEXING.
044300     MOVE ZERO TO REC-CT.
044400     MOVE SPACE TO TEMP.
044500     MOVE "SSS" TO EXPECTED-VALUE.
044600     MOVE "IND-TEST-003" TO PAR-NAME.
044700     SET IN1 TO 6.
044800     SET INDEX3 TO 4.
044900     SET INDEX2 TO 1.
045000     SET IN2 INDEX1 TO 2.
045100 IND-TEST-003-01.
045200     MOVE ELEM1(IN1 - 1, 3) TO TEMP.
045300     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
045400 IND-TEST-003-02.
045500     MOVE ELEM1 ( 5, IN2 + 1) TO TEMP.
045600     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
045700 IND-TEST-003-03.
045800     MOVE ELEM1(IN1 - 1 3) TO TEMP.
045900     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
046000 IND-TEST-003-04.
046100     MOVE ELEM1 (5 IN2 + 1) TO TEMP.
046200     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
046300 IND-TEST-003-05.
046400     MOVE ELEM2 (3, INDEX2, INDEX3 - 1) TO TEMP.
046500     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
046600 IND-TEST-003-06.
046700     MOVE ELEM2 (3 INDEX2 INDEX3 - 1) TO TEMP.
046800     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
046900 IND-TEST-003-07.
047000     MOVE ELEM2(INDEX1 + 1, 1, 3) TO TEMP.
047100     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
047200 IND-TEST-003-08.
047300     IF ELEM2(INDEX1 + 1 1 3) IS EQUAL TO "SSS"
047400              MOVE "SSS" TO TEMP.
047500     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
047600 IND-TEST-003-09.
047700     MOVE ELEM2 (INDEX1 + 1 INDEX2 3) TO TEMP.
047800     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
047900 IND-TEST-003-10.
048000     MOVE ELEM2 (3 1 INDEX3 - 1) TO TEMP.
048100     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
048200 IND-TEST-003-11.
048300     MOVE ELEM2(INDEX1 + 1 1 INDEX3 - 1) TO TEMP.
048400     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
048500     GO TO IND-INIT-004.
048600 IND-DELETE-003.
048700     PERFORM DE-LETE.
048800     PERFORM SYNTAX-CHECK-WRITE.
048900 IND-INIT-004.
049000*        THIS TEST MIXES SIGNED LITERALS WITH RELATIVE INDEXING.
049100     MOVE ZERO TO REC-CT.
049200     MOVE SPACE TO TEMP.
049300     MOVE "VVV" TO EXPECTED-VALUE.
049400     MOVE "IND-TEST-004" TO PAR-NAME.
049500     SET IN1 TO 2.
049600     SET IN2 TO 4.
049700     SET INDEX1 TO 2.
049800     SET INDEX2 TO 1.
049900     SET INDEX3 TO 4.
050000 IND-TEST-004-01.
050100     MOVE ELEM1(IN1 + 4, +2) TO TEMP.
050200     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
050300 IND-TEST-004-02.
050400     MOVE ELEM1 (IN1 + 4 +2) TO TEMP.
050500     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
050600 IND-TEST-004-03.
050700     MOVE ELEM1 (+6, IN2 - 2) TO TEMP.
050800     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
050900 IND-TEST-004-04.
051000     IF ELEM1(+6 IN2 - 2) IS EQUAL TO "VVV"
051100              MOVE "VVV" TO TEMP.
051200     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
051300 IND-TEST-004-05.
051400     IF ELEM2 (INDEX1 + 1, +2, INDEX3 - 2)
051500         IS EQUAL TO EXPECTED-VALUE
051600              MOVE "VVV" TO TEMP.
051700     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
051800 IND-TEST-004-06.
051900     MOVE ELEM2(INDEX1 + 1 +2 INDEX3 - 2)   TO  TEMP.
052000     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
052100 IND-TEST-004-07.
052200     MOVE ELEM2 (+3 +2 INDEX3 - 2)  TO TEMP.
052300     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
052400 IND-TEST-004-08.
052500     MOVE ELEM2 (INDEX1 + 1 +2 +2) TO TEMP.
052600     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
052700 IND-TEST-004-09.
052800     MOVE ELEM2(INDEX1 + 1, INDEX2 + 1, +2) TO TEMP.
052900     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
053000 IND-TEST-004-10.
053100     MOVE ELEM2 (+3 INDEX2 + 1 +2) TO TEMP.
053200     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
053300     GO TO IND-INIT-005.
053400 IND-DELETE-004.
053500     PERFORM DE-LETE.
053600     PERFORM SYNTAX-CHECK-WRITE.
053700 IND-INIT-005.
053800*        THIS TEST MIXES SIGNED AND UNSIGNED LITERALS
053900*    WITH RELATIVE INDEXING.
054000     MOVE ZERO TO REC-CT.
054100     MOVE SPACE TO TEMP.
054200     MOVE "PPP" TO EXPECTED-VALUE.
054300     MOVE "IND-TEST-005" TO PAR-NAME.
054400     SET INDEX1 TO 3.
054500     SET INDEX2 TO 1.
054600     SET INDEX3 TO 2.
054700 IND-TEST-005-01.
054800     MOVE ELEM2 (+2, INDEX2 + 1, 4)  TO  TEMP.
054900     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
055000 IND-TEST-005-02.
055100     MOVE ELEM2(+2 INDEX2 + 1 4) TO TEMP.
055200     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
055300 IND-TEST-005-03.
055400     MOVE ELEM2 (2 +2 INDEX3 + 2) TO TEMP.
055500     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
055600 IND-TEST-005-04.
055700     IF ELEM2 (INDEX1 - 1, 2  +4) IS EQUAL TO EXPECTED-VALUE
055800              MOVE "PPP" TO TEMP.
055900     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
056000 IND-TEST-005-05.
056100     MOVE ELEM2(+2 2 INDEX3 + 2) TO TEMP.
056200     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
056300     GO TO CCVS-EXIT.
056400 IND-DELETE-005.
056500     PERFORM DE-LETE.
056600     PERFORM SYNTAX-CHECK-WRITE.
056700 IND-INIT-006.
056800     MOVE "IV-21 4.3.8.2" TO ANSI-REFERENCE.
056900*        THIS TEST MIXES DATA-NAMES WITH RELATIVE INDEXING.
057000     MOVE ZERO TO REC-CT.
057100     MOVE SPACE TO TEMP.
057200     MOVE "PPP" TO EXPECTED-VALUE.
057300     MOVE "IND-TEST-006" TO PAR-NAME.
057400     SET INDEX1 TO 3.
057500     SET INDEX2 TO 1.
057600     SET INDEX3 TO 2.
057700     MOVE    2 TO WS-2.
057800     MOVE   +2 TO WS-PLUS-2.
057900     MOVE    4 TO WS-4.
058000     MOVE   +4 TO WS-PLUS-4.
058100 IND-TEST-006-01.
058200     MOVE ELEM2 (WS-PLUS-2, INDEX2 + 1,  WS-4)  TO  TEMP.
058300     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
058400 IND-TEST-006-02.
058500     MOVE ELEM2(WS-PLUS-2 INDEX2 + 1  WS-4) TO TEMP.
058600     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
058700 IND-TEST-006-03.
058800     MOVE ELEM2 ( WS-2 WS-PLUS-2 INDEX3 + 2) TO TEMP.
058900     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
059000 IND-TEST-006-04.
059100     IF ELEM2 (INDEX1 - 1,  WS-2   WS-PLUS-4) = EXPECTED-VALUE
059200              MOVE "PPP" TO TEMP.
059300     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
059400 IND-TEST-006-05.
059500     MOVE ELEM2(WS-PLUS-2  WS-2 INDEX3 + 2) TO TEMP.
059600     PERFORM SYNTAX-CHECK THRU SYNTAX-CHECK-WRITE.
059700     GO TO CCVS-EXIT.
059800 IND-DELETE-006.
059900     PERFORM DE-LETE.
060000     PERFORM SYNTAX-CHECK-WRITE.
060100     GO TO CCVS-EXIT.
060200 SECT-TH110-0003 SECTION.
060300 SYNTAX-CHECK.
060400     ADD 1 TO REC-CT.
060500     IF TEMP IS EQUAL TO EXPECTED-VALUE
060600              PERFORM PASS
060700              GO TO SYNTAX-CHECK-WRITE.
060800 SYNTAX-FAIL.
060900     PERFORM FAIL.
061000     MOVE TEMP TO COMPUTED-A.
061100     MOVE EXPECTED-VALUE TO CORRECT-A.
061200 SYNTAX-CHECK-WRITE.
061300     PERFORM PRINT-DETAIL.
061400     MOVE SPACE TO TEMP.
061500 CCVS-EXIT SECTION.
061600 CCVS-999999.
061700     GO TO CLOSE-FILES.
