000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     CM101M.
000400 AUTHOR.
000500     FEDERAL COMPILER TESTING CENTER.
000600 INSTALLATION.
000700     GENERAL SERVICES ADMINISTRATION
000800     AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
000900     SOFTWARE DEVELOPMENT OFFICE.
001000     5203 LEESBURG PIKE  SUITE 1100
001100     FALLS CHURCH VIRGINIA 22041.
001200
001300     PHONE   (703) 756-6153
001400
001500     " HIGH       ".
001600 DATE-WRITTEN.
001700     CCVS-74 VERSION 4.0 - 1980 JULY 1.
001800     CREATION DATE     /    VALIDATION DATE
001900     "4.2 ".
002000 SECURITY.
002100     NONE.
002200 ENVIRONMENT DIVISION.
002300 CONFIGURATION SECTION.
002400 SOURCE-COMPUTER.
002500     XXXXX082.
002600 OBJECT-COMPUTER.
002700     XXXXX083.
002800 INPUT-OUTPUT SECTION.
002900 FILE-CONTROL.
003000     SELECT PRINT-FILE ASSIGN TO
003100     XXXXX055.
003200 DATA DIVISION.
003300 FILE SECTION.
003400 FD  PRINT-FILE
003500     LABEL RECORDS
003600     XXXXX084
003700     DATA RECORD IS PRINT-REC DUMMY-RECORD.
003800 01  PRINT-REC PICTURE X(120).
003900 01  DUMMY-RECORD PICTURE X(120).
004000 WORKING-STORAGE SECTION.
004100 77  PASSWORD1 PIC X(10) VALUE
004200     XXXXX031.
004300 77  DISABLE-STATUS PIC XX VALUE "99".
004400 77  POLL-COUNT PIC 9(8).
004500 77  INIT-TIME PIC 9(8).
004600 77  COMP-TIME PIC 9(8).
004700 01  SYSTEM-TIME.
004800     02  SYS-HRS PIC 99.
004900     02  SYS-MINS PIC 99.
005000     02  SYS-SECS PIC 99V99.
005100 01  MSG-TIME.
005200     02  HOURS PIC 99.
005300     02  MINUTES PIC 99.
005400     02  SECONDS PIC 99V99.
005500 01  SPEC-LINE-1.
005600     02  FILLER PIC X(40) VALUE
005700     " INITIAL ENABLE RETURNED STATUS CODE OF ".
005800     02  INIT-ENABLE-STATUS PIC XX.
005900 01  INCOMING-MSG.
006000     02  KILL-FIELD PIC X(4).
006100     02  FILLER PIC X(68).
006200 01  LOG-HDR-1.
006300     02  FILLER PIC X(48) VALUE SPACES.
006400     02  FILLER PIC X(24) VALUE "LOG OF INCOMING MESSAGES".
006500 01  LOG-HDR-2.
006600     02  FILLER PIC X VALUE SPACE.
006700     02  FILLER PIC X(19) VALUE "SYMBOLIC SOURCE IS ".
006800     02  SYM-SOURCE PIC X(25).
006900     02  FILLER PIC X(16) VALUE "MESSAGE DATE IS ".
007000     02  MSG-DATE PIC 9(6) VALUE ZERO.
007100 01  LOG-HDR-3.
007200     02  FILLER PIC X VALUE SPACE.
007300     02  FILLER PIC X(12) VALUE "TIME  RECVD".
007400     02  FILLER PIC X(9) VALUE "LOG LAG".
007500     02  FILLER PIC X(7) VALUE "LENGTH".
007600     02  FILLER PIC X(4) VALUE "END".
007700     02  FILLER PIC X(3) VALUE "QD".
007800     02  FILLER PIC X(40) VALUE "POLL COUNT".
007900     02  FILLER PIC X(16) VALUE "MESSAGE CONTENTS".
008000 01  LOG-HDR-4.
008100     02  FILLER PIC X VALUE SPACE.
008200     02  FILLER PIC X(11) VALUE ALL "-".
008300     02  FILLER PIC X VALUE SPACES.
008400     02  FILLER PIC X(7) VALUE ALL "-".
008500     02  FILLER PIC X(2) VALUE SPACES.
008600     02  FILLER PIC X(6) VALUE ALL "-".
008700     02  FILLER PIC X VALUE SPACE.
008800     02  FILLER PIC XXX VALUE "---".
008900     02  FILLER PIC X VALUE SPACES.
009000     02  FILLER PIC XX VALUE "--".
009100     02  FILLER PIC X VALUE SPACES.
009200     02  FILLER PIC X(10) VALUE ALL "-".
009300     02  FILLER PIC X(2) VALUE SPACES.
009400     02  FILLER PIC X(72) VALUE ALL "-".
009500 01  LOG-LINE.
009600     02  FILLER PIC X VALUE SPACE.
009700     02  RECEIPT-TIME.
009800         03  HOURS PIC 99.
009900         03  FILLER PIC X VALUE ":".
010000         03  MINUTES PIC 99.
010100         03  FILLER PIC X VALUE ":".
010200         03  SECONDS PIC 99.99.
010300     02  LAG-TIME PIC -(4)9.99.
010400     02  FILLER PIC XX VALUE SPACES.
010500     02  MESSAGE-LENGTH PIC ZZZ9.
010600     02  FILLER PIC XXX VALUE SPACES.
010700     02  SENTINEL PIC XXX.
010800     02  FILLER PIC X VALUE SPACES.
010900     02  QUEUE-DEPTH PIC 99.
011000     02  FILLER PIC X VALUE SPACES.
011100     02  IDLE-COUNT PIC ZZ,ZZZ,ZZ9.
011200     02  IDLE-OVERFLOW REDEFINES IDLE-COUNT PIC X(10).
011300     02  FILLER PIC XX VALUE SPACES.
011400     02  MSG PIC X(72).
011500     66  LONG-NARRATIVE RENAMES LAG-TIME THRU MSG.
011600     66  SHORT-NARRATIVE RENAMES IDLE-COUNT THRU MSG.
011700 01  TEST-RESULTS.
011800     02 FILLER                    PICTURE X VALUE SPACE.
011900     02 FEATURE                   PICTURE X(18).
012000     02 FILLER                    PICTURE X VALUE SPACE.
012100     02 P-OR-F                    PICTURE X(5).
012200     02 FILLER                    PICTURE X  VALUE SPACE.
012300     02  PAR-NAME PIC X(20).
012400     02 FILLER                    PICTURE X VALUE SPACE.
012500     02  COMPUTED-A.
012600         03  FILLER PIC X(9) VALUE SPACES.
012700         03  COMPUTED-STATUS PIC XX.
012800         03  FILLER PIC X(9) VALUE SPACES.
012900     02 FILLER                    PICTURE X VALUE SPACE.
013000     02  CORRECT-A.
013100         03  FILLER PIC X(9) VALUE SPACES.
013200         03  CORRECT-STATUS PIC XX.
013300         03  FILLER PIC X(9) VALUE SPACES.
013400     02 FILLER                    PICTURE X VALUE SPACE.
013500     02 RE-MARK                   PICTURE X(30).
013600 01  COLUMNS-LINE-1.
013700     02  FILLER PIC X(3) VALUE SPACES.
013800     02  FILLER PIC X(17) VALUE "FEATURE TESTED".
013900     02  FILLER PIC X(9) VALUE "RESLT".
014000     02  FILLER PIC X(21) VALUE "PARAGRAPH NAME".
014100     02  FILLER PIC X(22) VALUE "COMPUTED DATA".
014200     02  FILLER PIC X(29) VALUE "CORRECT DATA".
014300     02  FILLER PIC X(7) VALUE "REMARKS".
014400 01  COLUMNS-LINE-2.
014500     02  FILLER PIC X VALUE SPACE.
014600     02  FILLER PIC X(18) VALUE ALL "-".
014700     02  FILLER PIC X VALUE SPACE.
014800     02  FILLER PIC X(5) VALUE ALL "-".
014900     02  FILLER PIC X VALUE SPACE.
015000     02  FILLER PIC X(20) VALUE ALL "-".
015100     02  FILLER PIC X VALUE SPACE.
015200     02  FILLER PIC X(20) VALUE ALL "-".
015300     02  FILLER PIC X VALUE SPACE.
015400     02  FILLER PIC X(20) VALUE ALL "-".
015500     02  FILLER PIC X VALUE SPACE.
015600     02  FILLER PIC X(31) VALUE ALL "-".
015700 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
015800 01  REC-CT PICTURE 99 VALUE ZERO.
015900 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
016000 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
016100 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
016200 01  PASS-COUNTER PIC 999 VALUE ZERO.
016300 01  TOTAL-ERROR PIC 999 VALUE ZERO.
016400 01  ERROR-HOLD PIC 999 VALUE ZERO.
016500 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
016600 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
016700 01  CCVS-H-1.
016800     02  FILLER   PICTURE X(27)  VALUE SPACE.
016900     02 FILLER PICTURE X(67) VALUE
017000     " FEDERAL COMPILER TESTING CENTER COBOL COMPILER VALIDATION
017100-    " SYSTEM".
017200     02  FILLER     PICTURE X(26)  VALUE SPACE.
017300 01  CCVS-H-2.
017400     02 FILLER PICTURE X(52) VALUE IS
017500     "CCVS74 NCC  COPY, NOT FOR DISTRIBUTION.".
017600     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
017700     02 TEST-ID PICTURE IS X(9).
017800     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
017900 01  CCVS-H-3.
018000     02  FILLER PICTURE X(34) VALUE
018100     " FOR OFFICIAL USE ONLY    ".
018200     02  FILLER PICTURE X(58) VALUE
018300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
018400     02  FILLER PICTURE X(28) VALUE
018500     "  COPYRIGHT   1974 ".
018600 01  CCVS-E-1.
018700     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
018800     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
018900     02 ID-AGAIN PICTURE IS X(9).
019000     02 FILLER PICTURE X(45) VALUE IS
019100     " NTIS DISTRIBUTION COBOL 74".
019200 01  CCVS-E-2.
019300     02  FILLER                   PICTURE X(31)  VALUE
019400     SPACE.
019500     02  FILLER                   PICTURE X(21)  VALUE SPACE.
019600     02 CCVS-E-2-2.
019700         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
019800         03 FILLER PICTURE IS X VALUE IS SPACE.
019900         03 ENDER-DESC PIC X(44) VALUE "ERRORS ENCOUNTERED".
020000 01  CCVS-E-3.
020100     02  FILLER PICTURE X(22) VALUE
020200     " FOR OFFICIAL USE ONLY".
020300     02  FILLER PICTURE X(12) VALUE SPACE.
020400     02  FILLER PICTURE X(58) VALUE
020500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
020600     02  FILLER PICTURE X(13) VALUE SPACE.
020700     02 FILLER PIC X(15) VALUE " COPYRIGHT 1974".
020800 01  CCVS-E-4.
020900     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
021000     02 FILLER PIC XXXX VALUE " OF ".
021100     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
021200     02 FILLER PIC X(40) VALUE
021300      "  TESTS WERE EXECUTED SUCCESSFULLY".
021400 01  XXINFO.
021500     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
021600     02 INFO-TEXT.
021700     04 FILLER PIC X(20) VALUE SPACE.
021800     04 XXCOMPUTED PIC X(20).
021900     04 FILLER PIC X(5) VALUE SPACE.
022000     04 XXCORRECT PIC X(20).
022100 01  HYPHEN-LINE.
022200     02 FILLER PICTURE IS X VALUE IS SPACE.
022300     02 FILLER PICTURE IS X(65) VALUE IS "************************
022400-    "*****************************************".
022500     02 FILLER PICTURE IS X(54) VALUE IS "************************
022600-    "******************************".
022700 01  CCVS-PGM-ID PIC X(6) VALUE
022800     "CM101M".
022900 COMMUNICATION SECTION.
023000 CD  CM-INQUE-1 FOR INPUT
023100     SYMBOLIC QUEUE IS MAIN-QUEUE
023200     SYMBOLIC SUB-QUEUE-1 IS NO-SPEC-1
023300     SYMBOLIC SUB-QUEUE-2 IS NO-SPEC-2
023400     SYMBOLIC SUB-QUEUE-3 IS NO-SPEC-3
023500     MESSAGE DATE IS DATE-RECEIVED
023600     MESSAGE TIME IS TIME-RECEIVED
023700     SYMBOLIC SOURCE IS WHERE-FROM
023800     TEXT LENGTH IS MSG-LENGTH
023900     END KEY IS END-KEY
024000     STATUS KEY IS STATUS-KEY
024100     MESSAGE COUNT IS MSG-COUNT.
024200 PROCEDURE    DIVISION.
024300 SECT-CM101M-0001 SECTION.
024400 CM101M-INIT.
024500     OPEN     OUTPUT PRINT-FILE.
024600     MOVE "CM101M     " TO TEST-ID.
024700     MOVE     TEST-ID TO ID-AGAIN.
024800     MOVE    SPACE TO TEST-RESULTS.
024900     PERFORM HEAD-ROUTINE.
025000     MOVE
025100     XXXXX030
025200     TO MAIN-QUEUE.
025300     MOVE SPACES TO NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
025400     ENABLE INPUT  CM-INQUE-1 WITH KEY
025500     XXXXX031.
025600     MOVE STATUS-KEY TO INIT-ENABLE-STATUS.
025700     MOVE SPEC-LINE-1 TO PRINT-REC.
025800     WRITE PRINT-REC
025900         AFTER 2 LINES.
026000     MOVE HYPHEN-LINE TO PRINT-REC.
026100     WRITE PRINT-REC
026200         AFTER 2 LINES.
026300 LOG-INIT.
026400     MOVE ZERO TO POLL-COUNT.
026500     MOVE ALL "*" TO MSG.
026600 LOG-MSG.
026700     MOVE   SPACES TO INCOMING-MSG.
026800     RECEIVE CM-INQUE-1 MESSAGE INTO INCOMING-MSG
026900         NO DATA PERFORM INCREMENT-POLL-COUNT GO TO LOG-MSG.
027000     ACCEPT SYSTEM-TIME FROM TIME.
027100     ACCEPT CM-INQUE-1 MESSAGE COUNT.
027200     IF STATUS-KEY IS NOT EQUAL TO ZERO
027300         DISPLAY "RUN ABORTED - STATUS KEY WAS " STATUS-KEY
027400         STOP RUN.
027500     IF MSG-DATE IS EQUAL TO ZERO PERFORM LOG-HEADER.
027600     IF KILL-FIELD IS EQUAL TO "KILL"
027700         ACCEPT INIT-TIME FROM TIME
027800         DISABLE INPUT CM-INQUE-1 WITH KEY
027900     XXXXX031
028000         ACCEPT COMP-TIME FROM TIME
028100         MOVE STATUS-KEY TO DISABLE-STATUS.
028200     MOVE TIME-RECEIVED TO MSG-TIME.
028300     MOVE CORR MSG-TIME TO RECEIPT-TIME.
028400     COMPUTE LAG-TIME =
028500         ((SYS-HRS * 3600) + (SYS-MINS * 60) + SYS-SECS) -
028600         ((HOURS OF MSG-TIME * 3600) + (MINUTES OF MSG-TIME * 60)
028700         + SECONDS OF MSG-TIME).
028800     IF END-KEY IS EQUAL TO "3"
028900         MOVE "EGI" TO SENTINEL
029000         ELSE IF END-KEY IS EQUAL TO "2"
029100         MOVE "EMI" TO SENTINEL
029200             ELSE MOVE END-KEY TO SENTINEL.
029300     MOVE MSG-COUNT TO QUEUE-DEPTH.
029400     MOVE MSG-LENGTH TO MESSAGE-LENGTH.
029500     IF POLL-COUNT IS EQUAL TO 99999999
029600         MOVE " OVERFLOW " TO IDLE-OVERFLOW
029700         ELSE MOVE POLL-COUNT TO IDLE-COUNT.
029800     MOVE INCOMING-MSG TO MSG.
029900     MOVE LOG-LINE TO PRINT-REC.
030000     PERFORM WRITE-LINE.
030100 LOG-MSG-01.
030200     IF KILL-FIELD IS EQUAL TO "WAIT"
030300         PERFORM GET-INITIAL-TIME
030400         PERFORM DELAY-FOR-30-SECS
030500         GO TO LOG-INIT.
030600     IF KILL-FIELD IS NOT EQUAL TO "KILL" GO TO LOG-INIT.
030700 DISABLE-CM-INQUE-1.
030800     MOVE INIT-TIME TO MSG-TIME.
030900     MOVE CORR MSG-TIME TO RECEIPT-TIME.
031000     MOVE "-DISABLE COMMAND INITIATED FROM PROGRAM"
031100         TO LONG-NARRATIVE.
031200     MOVE LOG-LINE TO PRINT-REC.
031300     WRITE PRINT-REC
031400         AFTER 2 LINES.
031500     MOVE COMP-TIME TO MSG-TIME.
031600     MOVE CORR MSG-TIME TO RECEIPT-TIME.
031700     MOVE "- STATUS CODE OF" TO LONG-NARRATIVE.
031800     MOVE DISABLE-STATUS TO QUEUE-DEPTH.
031900     MOVE "AND EXECUTION CONTROL RETURNED FROM MCS"
032000         TO SHORT-NARRATIVE.
032100     MOVE LOG-LINE TO PRINT-REC.
032200     PERFORM WRITE-LINE.
032300     MOVE SPACES TO PRINT-REC.
032400     PERFORM WRITE-LINE.
032500 GET-INITIAL-TIME.
032600     ACCEPT SYSTEM-TIME FROM TIME.
032700     COMPUTE INIT-TIME =
032800         SYS-HRS * 3600 + SYS-MINS * 60 + SYS-SECS.
032900 LOOK-FOR-LATE-TRANSMISSIONS.
033000     ACCEPT CM-INQUE-1 MESSAGE COUNT.
033100     IF MSG-COUNT IS NOT EQUAL TO ZERO
033200         PERFORM LOG-INIT THRU LOG-MSG
033300         GO TO LOOK-FOR-LATE-TRANSMISSIONS.
033400 GET-TIME-DIFFERENCE.
033500     ACCEPT SYSTEM-TIME FROM TIME.
033600     COMPUTE COMP-TIME =
033700         SYS-HRS * 3600 + SYS-MINS * 60 + SYS-SECS - INIT-TIME.
033800 CHECK-FOR-15.
033900     IF COMP-TIME IS LESS THAN 15
034000         GO TO LOOK-FOR-LATE-TRANSMISSIONS.
034100 15-SECONDS-HAVE-ELAPSED.
034200     MOVE HYPHEN-LINE TO PRINT-REC.
034300     WRITE PRINT-REC
034400         AFTER 2 LINES.
034500     MOVE HYPHEN-LINE TO PRINT-REC.
034600     PERFORM WRITE-LINE.
034700 STATUS-TESTS-INIT.
034800     MOVE " BEGIN INPUT STATUS TESTS" TO PRINT-REC.
034900     WRITE PRINT-REC
035000         AFTER 2 LINES.
035100     MOVE COLUMNS-LINE-1 TO PRINT-REC.
035200     WRITE PRINT-REC
035300         AFTER 2 LINES.
035400     MOVE COLUMNS-LINE-2 TO PRINT-REC.
035500     PERFORM WRITE-LINE.
035600     MOVE SPACES TO PRINT-REC.
035700     PERFORM WRITE-LINE.
035800     MOVE "MCS STATUS WORD" TO FEATURE.
035900 REC-STATUS-TEST-01.
036000     MOVE "QUEUE NAME NOT SPECIFIED" TO RE-MARK.
036100     MOVE "99" TO STATUS-KEY.
036200     MOVE SPACES TO MAIN-QUEUE NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
036300     RECEIVE CM-INQUE-1 MESSAGE INTO INCOMING-MSG
036400         NO DATA ADD 0 TO POLL-COUNT.
036500     IF STATUS-KEY IS EQUAL TO "20"
036600         PERFORM PASS GO TO REC-STATUS-WRITE-01.
036700     MOVE STATUS-KEY TO COMPUTED-STATUS.
036800     MOVE "20" TO CORRECT-STATUS.
036900     PERFORM FAIL.
037000     GO TO REC-STATUS-WRITE-01.
037100 REC-STATUS-DELETE-01.
037200     PERFORM DE-LETE.
037300 REC-STATUS-WRITE-01.
037400     MOVE "REC-STATUS-TEST-01" TO PAR-NAME.
037500     PERFORM PRINT-DETAIL.
037600 REC-STATUS-TEST-02.
037700     MOVE "UNKNOWN SUB-QUEUE-1 SPECIFIED" TO RE-MARK.
037800     MOVE "99" TO STATUS-KEY.
037900     MOVE
038000     XXXXX030
038100         TO MAIN-QUEUE.
038200     MOVE "DUMMYNAME" TO NO-SPEC-1.
038300     MOVE SPACES TO NO-SPEC-2 NO-SPEC-3.
038400     RECEIVE CM-INQUE-1 MESSAGE INTO INCOMING-MSG
038500         NO DATA ADD 0 TO POLL-COUNT.
038600     IF STATUS-KEY IS EQUAL TO "20"
038700         PERFORM PASS GO TO REC-STATUS-WRITE-02.
038800     MOVE STATUS-KEY TO COMPUTED-STATUS.
038900     MOVE "20" TO CORRECT-STATUS.
039000     PERFORM FAIL.
039100     GO TO REC-STATUS-WRITE-02.
039200 REC-STATUS-DELETE-02.
039300     PERFORM DE-LETE.
039400 REC-STATUS-WRITE-02.
039500     MOVE "REC-STATUS-TEST-02" TO PAR-NAME.
039600     PERFORM PRINT-DETAIL.
039700 ACCPT-STATUS-TEST-01.
039800     MOVE "QUEUE NAME NOT SPECIFIED" TO RE-MARK.
039900     MOVE "99" TO STATUS-KEY.
040000     MOVE SPACES TO MAIN-QUEUE NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
040100     ACCEPT CM-INQUE-1 MESSAGE COUNT.
040200     IF STATUS-KEY IS EQUAL TO "20"
040300         PERFORM PASS GO TO ACCPT-STATUS-WRITE-01.
040400     MOVE STATUS-KEY TO COMPUTED-STATUS.
040500     MOVE "20" TO CORRECT-STATUS.
040600     PERFORM FAIL.
040700     GO TO ACCPT-STATUS-WRITE-01.
040800 ACCPT-STATUS-DELETE-01.
040900     PERFORM DE-LETE.
041000 ACCPT-STATUS-WRITE-01.
041100     MOVE "ACCPT-STATUS-TEST-01" TO PAR-NAME.
041200     PERFORM PRINT-DETAIL.
041300 ACCPT-STATUS-TEST-02.
041400     MOVE "UNKNOWN SUB-QUEUE-1 SPECIFIED" TO RE-MARK.
041500     MOVE "99" TO STATUS-KEY.
041600     MOVE
041700     XXXXX030
041800         TO MAIN-QUEUE.
041900     MOVE "DUMMYNAME" TO NO-SPEC-1.
042000     MOVE SPACES TO NO-SPEC-2 NO-SPEC-3.
042100     ACCEPT CM-INQUE-1 COUNT.
042200     IF STATUS-KEY IS EQUAL TO "20"
042300     PERFORM PASS GO TO ACCPT-STATUS-WRITE-02.
042400     MOVE STATUS-KEY TO COMPUTED-STATUS.
042500     MOVE "20" TO CORRECT-STATUS.
042600     PERFORM FAIL.
042700      GO TO ACCPT-STATUS-WRITE-02.
042800 ACCPT-STATUS-DELETE-02.
042900     PERFORM DE-LETE.
043000 ACCPT-STATUS-WRITE-02.
043100     MOVE "ACCPT-STATUS-TEST-02" TO PAR-NAME.
043200     PERFORM PRINT-DETAIL.
043300 ENABL-STATUS-TEST-01.
043400     MOVE "QUEUE NAME NOT SPECIFIED" TO RE-MARK.
043500     MOVE "99" TO STATUS-KEY.
043600     MOVE SPACES TO MAIN-QUEUE NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
043700     ENABLE INPUT CM-INQUE-1 WITH KEY
043800     XXXXX031
043900     IF STATUS-KEY IS EQUAL TO "20"
044000         PERFORM PASS GO TO ENABL-STATUS-WRITE-01.
044100     MOVE STATUS-KEY TO COMPUTED-STATUS.
044200     MOVE "20" TO CORRECT-STATUS.
044300     PERFORM FAIL.
044400     GO TO ENABL-STATUS-WRITE-01.
044500 ENABL-STATUS-DELETE-01.
044600     PERFORM DE-LETE.
044700 ENABL-STATUS-WRITE-01.
044800     MOVE "ENABL-STATUS-TEST-01" TO PAR-NAME.
044900     PERFORM PRINT-DETAIL.
045000 ENABL-STATUS-TEST-02.
045100     MOVE "UNKNOWN SUB-QUEUE-1 SPECIFIED" TO RE-MARK.
045200     MOVE "99" TO STATUS-KEY.
045300     MOVE
045400     XXXXX030
045500         TO MAIN-QUEUE.
045600     MOVE "DUMMYNAME" TO NO-SPEC-1.
045700     MOVE SPACES TO NO-SPEC-2 NO-SPEC-3.
045800     ENABLE INPUT CM-INQUE-1 KEY
045900         PASSWORD1.
046000     IF STATUS-KEY IS EQUAL TO "20"
046100         PERFORM PASS GO TO ENABL-STATUS-WRITE-02.
046200     MOVE STATUS-KEY TO COMPUTED-STATUS.
046300     MOVE "20" TO CORRECT-STATUS.
046400     PERFORM FAIL.
046500     GO TO ENABL-STATUS-WRITE-02.
046600 ENABL-STATUS-DELETE-02.
046700     PERFORM DE-LETE.
046800 ENABL-STATUS-WRITE-02.
046900     MOVE "ENABL-STATUS-TEST-02" TO PAR-NAME.
047000     PERFORM PRINT-DETAIL.
047100 ENABL-STATUS-TEST-03.
047200     MOVE "INVALID PASSWORD USED" TO RE-MARK.
047300     MOVE "99" TO STATUS-KEY.
047400     MOVE
047500     XXXXX030
047600         TO MAIN-QUEUE.
047700     MOVE SPACES TO NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
047800     ENABLE INPUT CM-INQUE-1 WITH KEY "LETMEIN".
047900     IF STATUS-KEY IS EQUAL TO "40"
048000         PERFORM PASS GO TO ENABL-STATUS-WRITE-03.
048100     MOVE STATUS-KEY TO COMPUTED-STATUS.
048200     MOVE "40" TO CORRECT-STATUS.
048300     PERFORM FAIL.
048400     GO TO ENABL-STATUS-WRITE-03.
048500 ENABL-STATUS-DELETE-03.
048600     PERFORM DE-LETE.
048700 ENABL-STATUS-WRITE-03.
048800     MOVE "ENABL-STATUS-TEST-03" TO PAR-NAME.
048900     PERFORM PRINT-DETAIL.
049000 ENABL-STATUS-TEST-04.
049100     MOVE "NO QUEUE NAME / WRONG PASSWORD" TO RE-MARK.
049200     MOVE  "99" TO STATUS-KEY.
049300     MOVE SPACES TO MAIN-QUEUE NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
049400     ENABLE INPUT CM-INQUE-1 WITH KEY
049500         "LETMEIN".
049600     MOVE "INFO" TO P-OR-F.
049700     MOVE STATUS-KEY TO COMPUTED-STATUS.
049800     MOVE "  INFO TEST FOR BOTH" TO CORRECT-A.
049900     GO TO ENABL-STATUS-WRITE-04.
050000 ENABL-STATUS-DELETE-04.
050100     PERFORM DE-LETE.
050200 ENABL-STATUS-WRITE-04.
050300     MOVE "ENABL-STATUS-TEST-04" TO PAR-NAME.
050400     PERFORM PRINT-DETAIL.
050500 DISAB-STATUS-TEST-01.
050600     MOVE "QUEUE NAME NOT SPECIFIED" TO RE-MARK.
050700     MOVE "99" TO STATUS-KEY.
050800     MOVE SPACES TO MAIN-QUEUE NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
050900     DISABLE INPUT CM-INQUE-1 WITH KEY
051000     XXXXX031
051100     IF STATUS-KEY IS EQUAL TO "20"
051200         PERFORM PASS GO TO DISAB-STATUS-WRITE-01.
051300     MOVE STATUS-KEY TO COMPUTED-STATUS.
051400     MOVE "20" TO CORRECT-STATUS.
051500     PERFORM FAIL.
051600     GO TO DISAB-STATUS-WRITE-01.
051700 DISAB-STATUS-DELETE-01.
051800     PERFORM DE-LETE.
051900 DISAB-STATUS-WRITE-01.
052000     MOVE "DISAB-STATUS-TEST-01" TO PAR-NAME.
052100     PERFORM PRINT-DETAIL.
052200 DISAB-STATUS-TEST-02.
052300     MOVE "UNKNOWN SUB-QUEUE-1 SPECIFIED" TO RE-MARK.
052400     MOVE "99" TO STATUS-KEY.
052500     MOVE
052600     XXXXX030
052700         TO MAIN-QUEUE.
052800     MOVE "DUMMYNAME" TO NO-SPEC-1.
052900     MOVE SPACES TO NO-SPEC-2 NO-SPEC-3.
053000     DISABLE INPUT CM-INQUE-1 WITH KEY
053100     PASSWORD1.
053200     IF STATUS-KEY IS EQUAL TO "20"
053300         PERFORM PASS GO TO DISAB-STATUS-WRITE-02.
053400     MOVE STATUS-KEY TO COMPUTED-STATUS.
053500     MOVE "20" TO CORRECT-STATUS.
053600     PERFORM FAIL.
053700      GO TO DISAB-STATUS-WRITE-02.
053800 DISAB-STATUS-DELETE-02.
053900     PERFORM DE-LETE.
054000 DISAB-STATUS-WRITE-02.
054100     MOVE "DISAB-STATUS-TEST-02" TO PAR-NAME.
054200     PERFORM PRINT-DETAIL.
054300 DISAB-STATUS-TEST-03.
054400     MOVE "INVALID PASSWORD USED" TO RE-MARK.
054500     MOVE "99" TO STATUS-KEY.
054600     MOVE
054700     XXXXX030
054800         TO MAIN-QUEUE.
054900     MOVE SPACES TO NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
055000     DISABLE INPUT CM-INQUE-1 WITH KEY
055100     "KILLITNOW".
055200     IF STATUS-KEY IS EQUAL TO "40"
055300         PERFORM PASS GO TO DISAB-STATUS-WRITE-03.
055400     MOVE STATUS-KEY TO COMPUTED-STATUS.
055500     MOVE "40" TO CORRECT-STATUS.
055600     PERFORM FAIL.
055700     GO TO DISAB-STATUS-WRITE-03.
055800 DISAB-STATUS-DELETE-03.
055900     PERFORM DE-LETE.
056000 DISAB-STATUS-WRITE-03.
056100     MOVE "DISAB-STATUS-TEST-03" TO PAR-NAME.
056200     PERFORM PRINT-DETAIL.
056300 RENAB-STATUS-TEST-01.
056400     MOVE "RE-ENABLE PREVIOUSLY DISABLED" TO RE-MARK.
056500     MOVE "99" TO STATUS-KEY.
056600     MOVE
056700     XXXXX030
056800         TO MAIN-QUEUE.
056900     MOVE SPACES TO NO-SPEC-1 NO-SPEC-2 NO-SPEC-3.
057000     ENABLE INPUT CM-INQUE-1 KEY
057100     PASSWORD1.
057200     IF STATUS-KEY IS EQUAL TO ZERO
057300         PERFORM PASS GO TO RENAB-STATUS-WRITE-01.
057400     MOVE STATUS-KEY TO COMPUTED-STATUS
057500     MOVE ZERO TO CORRECT-STATUS.
057600     PERFORM FAIL.
057700     GO TO RENAB-STATUS-WRITE-01.
057800 RENAB-STATUS-DELETE-01.
057900     PERFORM DE-LETE.
058000 RENAB-STATUS-WRITE-01.
058100     MOVE "RENAB-STATUS-TEST-01" TO PAR-NAME.
058200     PERFORM PRINT-DETAIL.
058300 CLOSE-FILES.
058400     PERFORM END-ROUTINE THRU END-ROUTINE-3.
058500     CLOSE    PRINT-FILE.
058600     STOP     RUN.
058700 PASS.
058800     MOVE "PASS" TO P-OR-F.
058900 FAIL.
059000     ADD      1 TO ERROR-COUNTER.
059100     MOVE "FAIL*" TO P-OR-F.
059200 DE-LETE.
059300     MOVE     SPACE TO P-OR-F.
059400     MOVE     "    ************    " TO COMPUTED-A.
059500     MOVE     "    ************    " TO CORRECT-A.
059600     MOVE "****TEST DELETED****" TO RE-MARK.
059700     ADD 1 TO DELETE-CNT.
059800 PRINT-DETAIL.
059900     MOVE     TEST-RESULTS TO PRINT-REC.
060000     PERFORM WRITE-LINE.
060100     MOVE     SPACE TO P-OR-F.
060200     MOVE     SPACE TO COMPUTED-A.
060300     MOVE SPACE TO CORRECT-A.
060400 END-ROUTINE.
060500     MOVE     HYPHEN-LINE TO DUMMY-RECORD.
060600     PERFORM WRITE-LINE.
060700 PARA-Z.
060800     PERFORM  BLANK-LINE-PRINT 4 TIMES.
060900     MOVE     CCVS-E-1 TO DUMMY-RECORD.
061000     PERFORM WRITE-LINE.
061100 END-ROUTINE-1.
061200     PERFORM  BLANK-LINE-PRINT.
061300     IF       ERROR-COUNTER IS EQUAL TO ZERO
061400              GO TO END-ROUTINE-2.
061500     MOVE     ERROR-COUNTER TO ERROR-TOTAL.
061600     GO TO    END-ROUTINE-3.
061700 END-ROUTINE-2.
061800     MOVE " NO" TO ERROR-TOTAL.
061900 END-ROUTINE-3.
062000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
062100     PERFORM WRITE-LINE.
062200     IF DELETE-CNT IS EQUAL TO ZERO
062300         MOVE " NO" TO ERROR-TOTAL  ELSE
062400     MOVE DELETE-CNT TO ERROR-TOTAL.
062500     MOVE "TESTS DELETED     " TO ENDER-DESC.
062600     MOVE CCVS-E-2 TO DUMMY-RECORD.
062700     PERFORM WRITE-LINE.
062800 END-ROUTINE-4.
062900     MOVE CCVS-E-3 TO DUMMY-RECORD.
063000     PERFORM WRITE-LINE.
063100 BLANK-LINE-PRINT.
063200     MOVE     SPACE TO DUMMY-RECORD.
063300     PERFORM WRITE-LINE.
063400 WRITE-LINE.
063500     WRITE DUMMY-RECORD AFTER ADVANCING 1 LINE.
063600 INCREMENT-POLL-COUNT.
063700     ADD 1 TO POLL-COUNT ON SIZE ERROR ADD 0 TO POLL-COUNT.
063800 DELAY-FOR-30-SECS.
063900     PERFORM GET-TIME-DIFFERENCE.
064000     IF COMP-TIME IS LESS THAN 30
064100         GO TO DELAY-FOR-30-SECS.
064200 LOG-HEADER.
064300     MOVE LOG-HDR-1 TO PRINT-REC
064400     WRITE PRINT-REC
064500         AFTER 3 LINES.
064600     MOVE DATE-RECEIVED TO MSG-DATE.
064700     MOVE WHERE-FROM TO SYM-SOURCE.
064800     MOVE LOG-HDR-2 TO PRINT-REC.
064900     WRITE PRINT-REC
065000         AFTER 3 LINES.
065100     MOVE LOG-HDR-3 TO PRINT-REC.
065200     WRITE PRINT-REC
065300         AFTER 2 LINES.
065400     MOVE LOG-HDR-4 TO PRINT-REC.
065500     PERFORM WRITE-LINE.
065600     MOVE SPACES TO PRINT-REC.
065700     PERFORM WRITE-LINE.
065800 HEAD-ROUTINE.
065900     MOVE CCVS-H-1 TO PRINT-REC
066000     WRITE PRINT-REC
066100         AFTER ADVANCING PAGE.
066200     MOVE CCVS-H-2 TO PRINT-REC.
066300     WRITE PRINT-REC
066400         AFTER 2 LINES.
066500     MOVE CCVS-H-3 TO PRINT-REC.
066600     WRITE PRINT-REC
066700         AFTER 5 LINES.
066800     MOVE HYPHEN-LINE TO PRINT-REC.
066900     PERFORM WRITE-LINE.
