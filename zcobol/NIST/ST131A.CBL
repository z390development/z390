000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST131A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*    THIS PROGRAM CONTAINS 3 SORTS USING NUMERIC OR ALPHABETIC
002200*    KEYS - BUT NOT BOTH IN THE SAME KEY  DUE TO DIFFERING
002300*    COLLATING SEQUENCES AMONG COMPUTERS. EXTERNAL FILES ARE
002400*    GENERATED INTERNALLY FOR SUBSEQUENT USE. THE SELECT CLAUSE
002500*    IS HIGHLY DEPENDENT ON HARDWARE. THE USER SHOULD EXERCISE THE
002600*    VARIOUS OPTIONS OF HARDWARE ASSIGNMENTS TO THE EXTENT THEY
002700*    ARE AVAILABLE. THE SORT OF A MULTI-REEL FILE IS EXERCISED
002800*    IN PROGRAM ST202. HOWEVER THE EXERCISE OF THE "FOR MULTIPLE
002900*    REEL-UNIT" OF THE GIVING OPTION IS NOT DUE TO THE INDETER-
003000*    MINATE LENGTH OF SUCH A FILE (E.G. RECORDING DENSITY OR SIZE
003100*    OF UNIT) AND PROCESSING COST. SORT INPUT-OUTPUT OPTIONS
003200*    WILL BE EXERCISED AS FOLLOWS.
003300*        SORT 1  USING        GIVING
003400*        SORT 2  INPUT PROC   GIVING
003500*        SORT 3  INPUT PROC   OUTPUT PROC
003600
003700 ENVIRONMENT DIVISION.
003800 CONFIGURATION SECTION.
003900 SOURCE-COMPUTER.
004000     XXXXX082.
004100 OBJECT-COMPUTER.
004200     XXXXX083.
004300 INPUT-OUTPUT SECTION.
004400 FILE-CONTROL.
004500     SELECT PRINT-FILE ASSIGN TO
004600     XXXXX055.
004700     SELECT SORT1 ASSIGN TO
004800     XXXXX027.
004900     SELECT SORT2 ASSIGN TO
005000     XXXXX028.
005100     SELECT SORT3 ASSIGN TO
005200     XXXXX029.
005300     SELECT FILE1 ASSIGN TO
005400     XXXXX001.
005500     SELECT FILE2 ASSIGN TO
005600     XXXXX014.
005700     SELECT FILE3 ASSIGN TO
005800     XXXXX015.
005900 I-O-CONTROL.
006000     SAME RECORD AREA FOR SORT1 SORT2
006100     SAME RECORD AREA FOR SORT3 FILE3.
006200 DATA DIVISION.
006300 FILE SECTION.
006400 FD  PRINT-FILE.
006500 01  PRINT-REC PICTURE X(120).
006600 01  DUMMY-RECORD PICTURE X(120).
006700 FD  FILE1
006800C    LABEL RECORDS ARE STANDARD
006900C    VALUE OF
007000C    XXXXX074
007100C    IS
007200C    XXXXX075
007300     BLOCK CONTAINS 10 RECORDS
007400C    DATA RECORD R1
007500     .
007600 01  R1.
007700     02  FILLER PICTURE X(120).
007800 FD  FILE2
007900C    LABEL RECORDS ARE STANDARD
008000C    VALUE OF
008100C    XXXXX074
008200C    IS
008300C    XXXXX076
008400     BLOCK CONTAINS 10 RECORDS
008500C    DATA RECORD R2
008600     .
008700 01  R2.
008800     02  R2-KEYS.
008900         03  R2-1 PICTURE 999.
009000         03  R2-2 PICTURE AA.
009100         03  R2-3 PICTURE AA.
009200     02  FILLER PICTURE X(113).
009300 FD  FILE3
009400     BLOCK CONTAINS 10 RECORDS
009500C    LABEL RECORDS ARE STANDARD
009600C    VALUE OF
009700C    XXXXX074
009800C    IS
009900C    XXXXX077
010000C    DATA RECORD IS R3
010100     .
010200 01  R3.
010300     02  R3-KEYS.
010400         03  R3-1 PICTURE 999.
010500         03  R3-2 PICTURE AA.
010600         03  R3-3 PICTURE AA.
010700         03  R3-4 PICTURE 9999.
010800     02  FILLER PICTURE X(109).
010900 SD  SORT1
011000     RECORD CONTAINS 120 CHARACTERS
011100     DATA RECORD IS S1.
011200 01  S1.
011300     02  S1-KEYS.
011400         03  S1-1 PICTURE 999.
011500         03  S1-2 PICTURE AA.
011600     02  FILLER PICTURE X(115).
011700 SD  SORT2
011800     RECORD 120
011900     DATA RECORD IS S2.
012000 01  S2.
012100     02  S2-KEYS.
012200         03  S2-1 PICTURE 999.
012300         03  S2-2 PICTURE AA.
012400         03  S2-3 PICTURE AA.
012500     02  FILLER PICTURE X(113).
012600 SD  SORT3
012700     RECORD 120 CHARACTERS
012800     DATA RECORD S3.
012900 01  S3.
013000     02  S3-KEYS.
013100         03  S3-1 PICTURE 999.
013200         03  S3-2 PICTURE AA.
013300         03  S3-3 PICTURE AA.
013400         03  S3-4 PICTURE 9999.
013500     02  FILLER PICTURE X(109).
013600 WORKING-STORAGE SECTION.
013700 77  SUBSCRIPT-1 PICTURE  99 COMPUTATIONAL VALUE ZERO.
013800 77  C0 PICTURE  99 COMPUTATIONAL VALUE ZERO.
013900 77  C1 PICTURE  99 COMPUTATIONAL VALUE 1.
014000 77  CA PICTURE A VALUE "A".
014100 77  CB PICTURE A VALUE "B".
014200 01  ALPHA-TABLE.
014300     02  ALPHA-TAB PICTURE IS A(25) VALUE IS "ABCDEFGHIJKLMNPQRSTU
014400-    "VWXYZ".
014500     02  ALPHA-TBL REDEFINES ALPHA-TAB PICTURE A OCCURS 25 TIMES.
014600 01  W-KEYS.
014700     02  W-S3-KEYS.
014800         03  W-S2-KEYS.
014900             04  W-S1-KEYS.
015000                 05  S1-1W PICTURE 999 VALUE 567.
015100                 05  S1-2W.
015200                     06  S1-2W-A PICTURE A.
015300                     06  S1-2W-B PICTURE A.
015400             04  S2-3W.
015500                 05  S2-3W-A PICTURE A.
015600                 05  S2-3W-B PICTURE A.
015700         03  S3-4W PICTURE 9999 VALUE 7051.
015800 01  FILE-RECORD-INFORMATION-REC.
015900     03 FILE-RECORD-INFO-SKELETON.
016000        05 FILLER                 PICTURE X(48)       VALUE
016100             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
016200        05 FILLER                 PICTURE X(46)       VALUE
016300             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
016400        05 FILLER                 PICTURE X(26)       VALUE
016500             ",LFIL=000000,ORG=  ,LBLR= ".
016600        05 FILLER                 PICTURE X(37)       VALUE
016700             ",RECKEY=                             ".
016800        05 FILLER                 PICTURE X(38)       VALUE
016900             ",ALTKEY1=                             ".
017000        05 FILLER                 PICTURE X(38)       VALUE
017100             ",ALTKEY2=                             ".
017200        05 FILLER                 PICTURE X(7)        VALUE SPACE.
017300     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
017400        05 FILE-RECORD-INFO-P1-120.
017500           07 FILLER              PIC X(5).
017600           07 XFILE-NAME           PIC X(6).
017700           07 FILLER              PIC X(8).
017800           07 XRECORD-NAME         PIC X(6).
017900           07 FILLER              PIC X(1).
018000           07 REELUNIT-NUMBER     PIC 9(1).
018100           07 FILLER              PIC X(7).
018200           07 XRECORD-NUMBER       PIC 9(6).
018300           07 FILLER              PIC X(6).
018400           07 UPDATE-NUMBER       PIC 9(2).
018500           07 FILLER              PIC X(5).
018600           07 ODO-NUMBER          PIC 9(4).
018700           07 FILLER              PIC X(5).
018800           07 XPROGRAM-NAME        PIC X(5).
018900           07 FILLER              PIC X(7).
019000           07 XRECORD-LENGTH       PIC 9(6).
019100           07 FILLER              PIC X(7).
019200           07 CHARS-OR-RECORDS    PIC X(2).
019300           07 FILLER              PIC X(1).
019400           07 XBLOCK-SIZE          PIC 9(4).
019500           07 FILLER              PIC X(6).
019600           07 RECORDS-IN-FILE     PIC 9(6).
019700           07 FILLER              PIC X(5).
019800           07 XFILE-ORGANIZATION   PIC X(2).
019900           07 FILLER              PIC X(6).
020000           07 XLABEL-TYPE          PIC X(1).
020100        05 FILE-RECORD-INFO-P121-240.
020200           07 FILLER              PIC X(8).
020300           07 XRECORD-KEY          PIC X(29).
020400           07 FILLER              PIC X(9).
020500           07 ALTERNATE-KEY1      PIC X(29).
020600           07 FILLER              PIC X(9).
020700           07 ALTERNATE-KEY2      PIC X(29).
020800           07 FILLER              PIC X(7).
020900 01  TEST-RESULTS.
021000     02 FILLER                   PIC X      VALUE SPACE.
021100     02 FEATURE                  PIC X(20)  VALUE SPACE.
021200     02 FILLER                   PIC X      VALUE SPACE.
021300     02 P-OR-F                   PIC X(5)   VALUE SPACE.
021400     02 FILLER                   PIC X      VALUE SPACE.
021500     02  PAR-NAME.
021600       03 FILLER                 PIC X(19)  VALUE SPACE.
021700       03  PARDOT-X              PIC X      VALUE SPACE.
021800       03 DOTVALUE               PIC 99     VALUE ZERO.
021900     02 FILLER                   PIC X(8)   VALUE SPACE.
022000     02 RE-MARK                  PIC X(61).
022100 01  TEST-COMPUTED.
022200     02 FILLER                   PIC X(30)  VALUE SPACE.
022300     02 FILLER                   PIC X(17)  VALUE
022400            "       COMPUTED=".
022500     02 COMPUTED-X.
022600     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
022700     03 COMPUTED-N               REDEFINES COMPUTED-A
022800                                 PIC -9(9).9(9).
022900     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
023000     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
023100     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
023200     03       CM-18V0 REDEFINES COMPUTED-A.
023300         04 COMPUTED-18V0                    PIC -9(18).
023400         04 FILLER                           PIC X.
023500     03 FILLER PIC X(50) VALUE SPACE.
023600 01  TEST-CORRECT.
023700     02 FILLER PIC X(30) VALUE SPACE.
023800     02 FILLER PIC X(17) VALUE "       CORRECT =".
023900     02 CORRECT-X.
024000     03 CORRECT-A                  PIC X(20) VALUE SPACE.
024100     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
024200     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
024300     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
024400     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
024500     03      CR-18V0 REDEFINES CORRECT-A.
024600         04 CORRECT-18V0                     PIC -9(18).
024700         04 FILLER                           PIC X.
024800     03 FILLER PIC X(2) VALUE SPACE.
024900     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
025000 01  CCVS-C-1.
025100     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
025200-    "SS  PARAGRAPH-NAME
025300-    "       REMARKS".
025400     02 FILLER                     PIC X(20)    VALUE SPACE.
025500 01  CCVS-C-2.
025600     02 FILLER                     PIC X        VALUE SPACE.
025700     02 FILLER                     PIC X(6)     VALUE "TESTED".
025800     02 FILLER                     PIC X(15)    VALUE SPACE.
025900     02 FILLER                     PIC X(4)     VALUE "FAIL".
026000     02 FILLER                     PIC X(94)    VALUE SPACE.
026100 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
026200 01  REC-CT                        PIC 99       VALUE ZERO.
026300 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
026400 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
026500 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
026600 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
026700 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
026800 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
026900 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
027000 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
027100 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
027200 01  CCVS-H-1.
027300     02  FILLER                    PIC X(39)    VALUE SPACES.
027400     02  FILLER                    PIC X(42)    VALUE
027500     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
027600     02  FILLER                    PIC X(39)    VALUE SPACES.
027700 01  CCVS-H-2A.
027800   02  FILLER                        PIC X(40)  VALUE SPACE.
027900   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
028000   02  FILLER                        PIC XXXX   VALUE
028100     "4.2 ".
028200   02  FILLER                        PIC X(28)  VALUE
028300            " COPY - NOT FOR DISTRIBUTION".
028400   02  FILLER                        PIC X(41)  VALUE SPACE.
028500
028600 01  CCVS-H-2B.
028700   02  FILLER                        PIC X(15)  VALUE
028800            "TEST RESULT OF ".
028900   02  TEST-ID                       PIC X(9).
029000   02  FILLER                        PIC X(4)   VALUE
029100            " IN ".
029200   02  FILLER                        PIC X(12)  VALUE
029300     " HIGH       ".
029400   02  FILLER                        PIC X(22)  VALUE
029500            " LEVEL VALIDATION FOR ".
029600   02  FILLER                        PIC X(58)  VALUE
029700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
029800 01  CCVS-H-3.
029900     02  FILLER                      PIC X(34)  VALUE
030000            " FOR OFFICIAL USE ONLY    ".
030100     02  FILLER                      PIC X(58)  VALUE
030200     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
030300     02  FILLER                      PIC X(28)  VALUE
030400            "  COPYRIGHT   1985 ".
030500 01  CCVS-E-1.
030600     02 FILLER                       PIC X(52)  VALUE SPACE.
030700     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
030800     02 ID-AGAIN                     PIC X(9).
030900     02 FILLER                       PIC X(45)  VALUE SPACES.
031000 01  CCVS-E-2.
031100     02  FILLER                      PIC X(31)  VALUE SPACE.
031200     02  FILLER                      PIC X(21)  VALUE SPACE.
031300     02 CCVS-E-2-2.
031400         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
031500         03 FILLER                   PIC X      VALUE SPACE.
031600         03 ENDER-DESC               PIC X(44)  VALUE
031700            "ERRORS ENCOUNTERED".
031800 01  CCVS-E-3.
031900     02  FILLER                      PIC X(22)  VALUE
032000            " FOR OFFICIAL USE ONLY".
032100     02  FILLER                      PIC X(12)  VALUE SPACE.
032200     02  FILLER                      PIC X(58)  VALUE
032300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
032400     02  FILLER                      PIC X(13)  VALUE SPACE.
032500     02 FILLER                       PIC X(15)  VALUE
032600             " COPYRIGHT 1985".
032700 01  CCVS-E-4.
032800     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
032900     02 FILLER                       PIC X(4)   VALUE " OF ".
033000     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
033100     02 FILLER                       PIC X(40)  VALUE
033200      "  TESTS WERE EXECUTED SUCCESSFULLY".
033300 01  XXINFO.
033400     02 FILLER                       PIC X(19)  VALUE
033500            "*** INFORMATION ***".
033600     02 INFO-TEXT.
033700       04 FILLER                     PIC X(8)   VALUE SPACE.
033800       04 XXCOMPUTED                 PIC X(20).
033900       04 FILLER                     PIC X(5)   VALUE SPACE.
034000       04 XXCORRECT                  PIC X(20).
034100     02 INF-ANSI-REFERENCE           PIC X(48).
034200 01  HYPHEN-LINE.
034300     02 FILLER  PIC IS X VALUE IS SPACE.
034400     02 FILLER  PIC IS X(65)    VALUE IS "************************
034500-    "*****************************************".
034600     02 FILLER  PIC IS X(54)    VALUE IS "************************
034700-    "******************************".
034800 01  CCVS-PGM-ID                     PIC X(9)   VALUE
034900     "ST131A".
035000 PROCEDURE DIVISION.
035100 CCVS1 SECTION.
035200 OPEN-FILES.
035300     OPEN     OUTPUT PRINT-FILE.
035400     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
035500     MOVE    SPACE TO TEST-RESULTS.
035600     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
035700     GO TO CCVS1-EXIT.
035800 CLOSE-FILES.
035900     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
036000 TERMINATE-CCVS.
036100S    EXIT PROGRAM.
036200STERMINATE-CALL.
036300     STOP     RUN.
036400 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
036500 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
036600 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
036700 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
036800     MOVE "****TEST DELETED****" TO RE-MARK.
036900 PRINT-DETAIL.
037000     IF REC-CT NOT EQUAL TO ZERO
037100             MOVE "." TO PARDOT-X
037200             MOVE REC-CT TO DOTVALUE.
037300     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
037400     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
037500        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
037600          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
037700     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
037800     MOVE SPACE TO CORRECT-X.
037900     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
038000     MOVE     SPACE TO RE-MARK.
038100 HEAD-ROUTINE.
038200     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038300     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038400     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
038500     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
038600 COLUMN-NAMES-ROUTINE.
038700     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038800     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
039000 END-ROUTINE.
039100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
039200 END-RTN-EXIT.
039300     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039400 END-ROUTINE-1.
039500      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
039600      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
039700      ADD PASS-COUNTER TO ERROR-HOLD.
039800*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
039900      MOVE PASS-COUNTER TO CCVS-E-4-1.
040000      MOVE ERROR-HOLD TO CCVS-E-4-2.
040100      MOVE CCVS-E-4 TO CCVS-E-2-2.
040200      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
040300  END-ROUTINE-12.
040400      MOVE "TEST(S) FAILED" TO ENDER-DESC.
040500     IF       ERROR-COUNTER IS EQUAL TO ZERO
040600         MOVE "NO " TO ERROR-TOTAL
040700         ELSE
040800         MOVE ERROR-COUNTER TO ERROR-TOTAL.
040900     MOVE     CCVS-E-2 TO DUMMY-RECORD.
041000     PERFORM WRITE-LINE.
041100 END-ROUTINE-13.
041200     IF DELETE-COUNTER IS EQUAL TO ZERO
041300         MOVE "NO " TO ERROR-TOTAL  ELSE
041400         MOVE DELETE-COUNTER TO ERROR-TOTAL.
041500     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
041600     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
041700      IF   INSPECT-COUNTER EQUAL TO ZERO
041800          MOVE "NO " TO ERROR-TOTAL
041900      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
042000      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
042100      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
042200     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
042300 WRITE-LINE.
042400     ADD 1 TO RECORD-COUNT.
042500Y    IF RECORD-COUNT GREATER 42
042600Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
042700Y        MOVE SPACE TO DUMMY-RECORD
042800Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
042900Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
043000Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
043100Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
043200Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
043300Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
043400Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
043500Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
043600Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
043700Y        MOVE ZERO TO RECORD-COUNT.
043800     PERFORM WRT-LN.
043900 WRT-LN.
044000     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
044100     MOVE SPACE TO DUMMY-RECORD.
044200 BLANK-LINE-PRINT.
044300     PERFORM WRT-LN.
044400 FAIL-ROUTINE.
044500     IF     COMPUTED-X NOT EQUAL TO SPACE
044600            GO TO   FAIL-ROUTINE-WRITE.
044700     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
044800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
044900     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
045000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045100     MOVE   SPACES TO INF-ANSI-REFERENCE.
045200     GO TO  FAIL-ROUTINE-EX.
045300 FAIL-ROUTINE-WRITE.
045400     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
045500     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
045600     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
045700     MOVE   SPACES TO COR-ANSI-REFERENCE.
045800 FAIL-ROUTINE-EX. EXIT.
045900 BAIL-OUT.
046000     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
046100     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
046200 BAIL-OUT-WRITE.
046300     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
046400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
046500     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
046600     MOVE   SPACES TO INF-ANSI-REFERENCE.
046700 BAIL-OUT-EX. EXIT.
046800 CCVS1-EXIT.
046900     EXIT.
047000 P1-CREATE-F1.
047100     OPEN    OUTPUT FILE1.
047200     MOVE CA TO S1-2W-A.
047300     MOVE CB TO S2-3W-A.
047400 P2-CREATE-F1.
047500     PERFORM P4-CREATE-F1 2 TIMES.
047600 P3-CREATE-F1.
047700     MOVE CA TO S2-3W-A.
047800     PERFORM P4-CREATE-F1 2 TIMES.
047900     CLOSE FILE1.
048000     GO TO FIRST-SORT.
048100 P4-CREATE-F1.
048200     MOVE C0 TO SUBSCRIPT-1.
048300     PERFORM P5-CREATE-F1 25 TIMES.
048400 P5-CREATE-F1.
048500     ADD C1 TO SUBSCRIPT-1.
048600     SUBTRACT C1 FROM S3-4W.
048700     MOVE ALPHA-TBL (SUBSCRIPT-1) TO S1-2W-B S2-3W-B.
048800     MOVE W-S3-KEYS TO R1.
048900     WRITE R1.
049000 F1-NOTE.
049100*    NOTE.
049200*      KEY-1 WILL BE 567 IN ALL RECORDS.
049300*      KEY-2 WILL BE >A> IN FIRST LETTER WITH 4 OCCURRENCES OF THE
049400*        ALPHABET IN THE SECOND LETTER.
049500*      KEY-3 WILL BE >A> OR >B> IN FIRST LETTER WITH 2 OCCURRENCES
049600*        OF THE ALPHABET FOR EACH IN THE SECOND LETTER.
049700*      KEY-4 WILL VARY FROM 7050 THRU 6951.
049800*      THE LETTER "O" HAS BEEN OMITTED.
049900 SRT-1 SECTION.
050000 FIRST-SORT.
050100     SORT SORT1
050200         ON DESCENDING KEY S1-1
050300         ON ASCENDING KEY S1-2
050400         USING FILE1
050500         GIVING FILE2.
050600*    NOTE SORT STATEMENT WITH ALL OPTIONAL WORDS.
050700*    NOTE OUTPUT WILL BE TESTED IN THE FOLLOWING INPUT PROCEDURE.
050800 SRT-2 SECTION.
050900 SECOND-SORT.
051000     SORT SORT2
051100         ASCENDING S2-1
051200         DESCENDING S2-2
051300         ASCENDING S2-3
051400         INPUT PROCEDURE SRT-2-INPUT
051500         GIVING FILE3.
051600*      NOTE SORT STATEMENT WITH ALL OPTIONAL WORDS OMITTED.
051700     GO TO SRT-3.
051800 SRT-2-INPUT SECTION.
051900 OPEN-1.
052000     OPEN     INPUT FILE2.
052100     MOVE     "SORT, INPUT PROC" TO FEATURE.
052200 SORT-TEST-1.
052300     PERFORM  READ-RELEASE-FILE2.
052400     IF       W-S1-KEYS EQUAL TO "567AA"
052500              PERFORM PASS-1 GO TO SORT-WRITE-1.
052600     GO       TO SORT-FAIL-1.
052700 SORT-DELETE-1.
052800     PERFORM  DE-LETE-1.
052900     GO       TO SORT-WRITE-1.
053000 SORT-FAIL-1.
053100     MOVE     W-S1-KEYS TO COMPUTED-A.
053200     MOVE     "567AA" TO CORRECT-A.
053300     PERFORM  FAIL-1.
053400 SORT-WRITE-1.
053500     MOVE     "SORT-TEST-1 " TO PAR-NAME.
053600     PERFORM  PRINT-DETAIL-1.
053700 SORT-TEST-2.
053800     PERFORM  READ-RELEASE-FILE2 35 TIMES.
053900     IF       W-S1-KEYS EQUAL TO "567AI"
054000              PERFORM PASS-1 GO TO SORT-WRITE-2.
054100     GO       TO SORT-FAIL-2.
054200 SORT-DELETE-2.
054300     PERFORM  DE-LETE-1.
054400     GO       TO SORT-WRITE-2.
054500 SORT-FAIL-2.
054600     MOVE     W-S1-KEYS TO COMPUTED-A.
054700     MOVE     "567AI" TO CORRECT-A.
054800     PERFORM  FAIL-1.
054900 SORT-WRITE-2.
055000     MOVE     "SORT-TEST-2 " TO PAR-NAME.
055100     PERFORM  PRINT-DETAIL-1.
055200 SORT-TEST-3.
055300     PERFORM  READ-RELEASE-FILE2 35 TIMES.
055400     IF       W-S1-KEYS EQUAL TO "567AS"
055500              PERFORM PASS-1 GO TO SORT-WRITE-3.
055600     GO       TO SORT-FAIL-3.
055700 SORT-DELETE-3.
055800     PERFORM  DE-LETE-1.
055900     GO       TO SORT-WRITE-3.
056000 SORT-FAIL-3.
056100     MOVE     W-S1-KEYS TO COMPUTED-A.
056200     MOVE     "567AS" TO CORRECT-A.
056300     PERFORM  FAIL-1.
056400 SORT-WRITE-3.
056500     MOVE     "SORT-TEST-3 " TO PAR-NAME.
056600     PERFORM  PRINT-DETAIL-1.
056700 SORT-TEST-4.
056800     PERFORM  READ-RELEASE-FILE2 29 TIMES.
056900     IF       W-S1-KEYS EQUAL TO "567AZ"
057000              PERFORM PASS-1 GO TO SORT-WRITE-4.
057100     GO       TO SORT-FAIL-4.
057200 SORT-DELETE-4.
057300     PERFORM  DE-LETE-1.
057400     GO       TO SORT-WRITE-4.
057500 SORT-FAIL-4.
057600     MOVE     W-S1-KEYS TO COMPUTED-A.
057700     MOVE     "567AZ" TO CORRECT-A.
057800     PERFORM  FAIL-1.
057900 SORT-WRITE-4.
058000     MOVE     "SORT-TEST-4 " TO PAR-NAME.
058100     PERFORM  PRINT-DETAIL-1.
058200 CLOSE-1.
058300     CLOSE    FILE2.
058400     GO       TO EXIT-1.
058500 READ-RELEASE-FILE2.
058600     READ     FILE2 AT END GO TO TERMINAL-1.
058700     MOVE     R2 TO W-S3-KEYS.
058800     RELEASE  S2 FROM R2.
058900 TERMINAL-1.
059000     PERFORM  FAIL-1.
059100     MOVE     "TERMINAL-1" TO PAR-NAME.
059200     MOVE     "END OF FILE PREMATURELY" TO RE-MARK.
059300     PERFORM  PRINT-DETAIL-1.
059400     MOVE     SPACE TO FEATURE.
059500     MOVE     "FOUND, PREVIOUS TEST WAS" TO RE-MARK.
059600     PERFORM  PRINT-DETAIL-1.
059700     MOVE     "LAST SUCCESSFUL TEST." TO RE-MARK.
059800     PERFORM  PRINT-DETAIL-1.
059900     GO       TO CLOSE-1.
060000 INSPT-1. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
060100 PASS-1.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
060200 FAIL-1.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
060300 DE-LETE-1.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
060400     MOVE "****TEST DELETED****" TO RE-MARK.
060500 PRINT-DETAIL-1.
060600     IF REC-CT NOT EQUAL TO ZERO
060700             MOVE "." TO PARDOT-X
060800             MOVE REC-CT TO DOTVALUE.
060900     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE-1.
061000     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE-1
061100        PERFORM FAIL-ROUTINE-1 THRU FAIL-ROUTINE-EX-1
061200          ELSE PERFORM BAIL-OUT-1 THRU BAIL-OUT-EX-1.
061300     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
061400     MOVE SPACE TO CORRECT-X.
061500     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
061600     MOVE     SPACE TO RE-MARK.
061700 WRITE-LINE-1.
061800     ADD 1 TO RECORD-COUNT.
061900Y    IF RECORD-COUNT GREATER 50
062000Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
062100Y        MOVE SPACE TO DUMMY-RECORD
062200Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
062300Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN-1
062400Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN-1 2 TIMES
062500Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN-1
062600Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
062700Y        MOVE ZERO TO RECORD-COUNT.
062800     PERFORM WRT-LN-1.
062900 WRT-LN-1.
063000     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
063100     MOVE SPACE TO DUMMY-RECORD.
063200 BLANK-LINE-PRINT-1.
063300     PERFORM WRT-LN-1.
063400 FAIL-ROUTINE-1.
063500     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-1.
063600     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-1.
063700     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
063800     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-1 2 TIMES.
063900     GO TO FAIL-ROUTINE-EX-1.
064000 FAIL-RTN-WRITE-1.
064100     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE-1
064200     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE-1 2 TIMES.
064300 FAIL-ROUTINE-EX-1. EXIT.
064400 BAIL-OUT-1.
064500     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE-1.
064600     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX-1.
064700 BAIL-OUT-WRITE-1.
064800     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
064900     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-1 2 TIMES.
065000 BAIL-OUT-EX-1. EXIT.
065100 EXIT-1.
065200     EXIT.
065300 SRT-3 SECTION.
065400 THIRD-SORT.
065500     SORT SORT3
065600         ON DESCENDING KEY S3-1 S3-2 S3-3
065700         ASCENDING S3-4
065800       INPUT PROCEDURE IS SRT3-INPUT
065900       OUTPUT PROCEDURE SRT3-OUTPUT-1 THRU SRT3-OUTPUT-2.
066000 NOTE-SORT-3.
066100*    NOTE SORT STATEMENT WITH INCLUSION-OMISSION OF OPTIONAL
066200*        WORDS AND THRU OPTION. THE OUTPUT OF SRT-2 IS TESTED
066300*        IN THE INPUT PROCEDURE OF THIS (THIRD) SORT.  THE OUTPUT
066400*        OF THE THIRD SORT IS TESTED IN THE OUTPUT PROCEDURE
066500*        WITHOUT THE GENERATION OF AN OUTPUT FILE.
066600 END-FIRST-PROGRAM.
066700     GO TO CCVS-EXIT.
066800 SRT3-INPUT SECTION.
066900 OPEN-2.
067000     OPEN     INPUT FILE3.
067100     MOVE     "SORT, INPUT PROC" TO FEATURE.
067200 SORT-TEST-5.
067300     PERFORM  READ-RELEASE-FILE3.
067400     MOVE     R3-KEYS TO W-S3-KEYS.
067500     IF       W-S2-KEYS EQUAL TO "567AZAZ"
067600              PERFORM PASS-2 GO TO SORT-WRITE-5.
067700     GO       TO SORT-FAIL-5.
067800 SORT-DELETE-5.
067900     PERFORM  DE-LETE-2.
068000     GO       TO SORT-WRITE-5.
068100 SORT-FAIL-5.
068200     MOVE     W-S2-KEYS TO COMPUTED-A.
068300     MOVE     "567AZAZ" TO CORRECT-A.
068400     PERFORM  FAIL-2.
068500 SORT-WRITE-5.
068600     MOVE     "SORT-TEST-5 " TO PAR-NAME.
068700     PERFORM  PRINT-DETAIL-2.
068800 SORT-TEST-6.
068900     PERFORM  READ-RELEASE-FILE3 35 TIMES.
069000     MOVE     R3-KEYS TO W-S3-KEYS.
069100     IF       W-S2-KEYS EQUAL TO "567ARBR"
069200              PERFORM PASS-2 GO TO SORT-WRITE-6.
069300     GO       TO SORT-FAIL-6.
069400 SORT-DELETE-6.
069500     PERFORM  DE-LETE-2.
069600     GO       TO SORT-WRITE-6.
069700 SORT-FAIL-6.
069800     MOVE     W-S2-KEYS TO COMPUTED-A.
069900     MOVE     "567ARBR" TO CORRECT-A.
070000     PERFORM  FAIL-2.
070100 SORT-WRITE-6.
070200     MOVE     "SORT-TEST-6 " TO PAR-NAME.
070300     PERFORM  PRINT-DETAIL-2.
070400 SORT-TEST-7.
070500     PERFORM  READ-RELEASE-FILE3 35 TIMES.
070600     MOVE     R3-KEYS TO W-S3-KEYS.
070700     IF       W-S2-KEYS EQUAL TO "567AHBH"
070800              PERFORM PASS-2 GO TO SORT-WRITE-7.
070900     GO       TO SORT-FAIL-7.
071000 SORT-DELETE-7.
071100     PERFORM  DE-LETE-2.
071200     GO       TO SORT-WRITE-7.
071300 SORT-FAIL-7.
071400     MOVE     W-S2-KEYS TO COMPUTED-A.
071500     MOVE     "567AHBH" TO CORRECT-A.
071600     PERFORM  FAIL-2.
071700 SORT-WRITE-7.
071800     MOVE     "SORT-TEST-7 " TO PAR-NAME.
071900     PERFORM  PRINT-DETAIL-2.
072000 SORT-TEST-8.
072100     PERFORM  READ-RELEASE-FILE3 29 TIMES.
072200     MOVE     R3-KEYS TO W-S3-KEYS.
072300     IF       W-S2-KEYS EQUAL TO "567AABA"
072400              PERFORM PASS-2 GO TO SORT-WRITE-8.
072500     GO       TO SORT-FAIL-8.
072600 SORT-DELETE-8.
072700     PERFORM  DE-LETE-2.
072800     GO       TO SORT-WRITE-8.
072900 SORT-FAIL-8.
073000     MOVE     W-S2-KEYS TO COMPUTED-A.
073100     MOVE     "567AABA" TO CORRECT-A.
073200     PERFORM  FAIL-2.
073300 SORT-WRITE-8.
073400     MOVE     "SORT-TEST-8 " TO PAR-NAME.
073500     PERFORM  PRINT-DETAIL-2.
073600 CLOSE-2.
073700     CLOSE    FILE3.
073800     GO       TO EXIT-2.
073900 READ-RELEASE-FILE3.
074000     READ     FILE3 AT END GO TO TERMINAL-2.
074100     RELEASE  S3.
074200*    NOTE    READ AND RELEASE ARE THE ONLY STATEMENTS NECESSARY
074300*    TO USE FILE3 AS INPUT TO THE THIRD SORT.  THIS IS SINCE
074400*    THE RECORD AREAS ARE THE SAME FROM THE CLAUSE
074500*            SAME RECORD AREA SORT3 FILE3.
074600 TERMINAL-2.
074700     PERFORM  FAIL-2.
074800     MOVE     "TERMINAL-2" TO PAR-NAME.
074900     MOVE     "END OF FILE PREMATURELY" TO RE-MARK.
075000     PERFORM  PRINT-DETAIL-2.
075100     MOVE     SPACE TO FEATURE.
075200     MOVE     "FOUND, PREVIOUS TEST WAS" TO RE-MARK.
075300     PERFORM  PRINT-DETAIL-2.
075400     MOVE     "LAST SUCCESSFUL TEST" TO RE-MARK.
075500     PERFORM  PRINT-DETAIL-2.
075600     GO       TO CLOSE-2.
075700 INSPT-2. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
075800 PASS-2.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
075900 FAIL-2.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
076000 DE-LETE-2.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
076100     MOVE "****TEST DELETED****" TO RE-MARK.
076200 PRINT-DETAIL-2.
076300     IF REC-CT NOT EQUAL TO ZERO
076400             MOVE "." TO PARDOT-X
076500             MOVE REC-CT TO DOTVALUE.
076600     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE-2.
076700     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE-2
076800        PERFORM FAIL-ROUTINE-2 THRU FAIL-ROUTINE-EX-2
076900          ELSE PERFORM BAIL-OUT-2 THRU BAIL-OUT-EX-2.
077000     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
077100     MOVE SPACE TO CORRECT-X.
077200     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
077300     MOVE     SPACE TO RE-MARK.
077400 WRITE-LINE-2.
077500     ADD 1 TO RECORD-COUNT.
077600Y    IF RECORD-COUNT GREATER 50
077700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
077800Y        MOVE SPACE TO DUMMY-RECORD
077900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
078000Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN-2
078100Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN-2 2 TIMES
078200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN-2
078300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
078400Y        MOVE ZERO TO RECORD-COUNT.
078500     PERFORM WRT-LN-2.
078600 WRT-LN-2.
078700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
078800     MOVE SPACE TO DUMMY-RECORD.
078900 BLANK-LINE-PRINT-2.
079000     PERFORM WRT-LN-2.
079100 FAIL-ROUTINE-2.
079200     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-2.
079300     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-2.
079400     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
079500     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-2 2 TIMES.
079600     GO TO FAIL-ROUTINE-EX-2.
079700 FAIL-RTN-WRITE-2.
079800     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE-2
079900     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE-2 2 TIMES.
080000 FAIL-ROUTINE-EX-2. EXIT.
080100 BAIL-OUT-2.
080200     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE-2.
080300     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX-2.
080400 BAIL-OUT-WRITE-2.
080500     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
080600     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-2 2 TIMES.
080700 BAIL-OUT-EX-2. EXIT.
080800 EXIT-2.
080900     EXIT.
081000 SRT3-OUTPUT-1 SECTION.
081100 INIT-3.
081200     MOVE     "SORT, OUTPUT PROC" TO FEATURE.
081300 SORT-TEST-9.
081400     PERFORM  RETURN-SORT3.
081500     IF       S3-KEYS EQUAL TO "567AZBZ7001"
081600              PERFORM PASS-3 GO TO SORT-WRITE-9.
081700     GO       TO SORT-FAIL-9.
081800 SORT-DELETE-9.
081900     PERFORM  DE-LETE-3.
082000     GO       TO SORT-WRITE-9.
082100 SORT-FAIL-9.
082200     MOVE     S3-KEYS TO COMPUTED-A.
082300     MOVE     "567AZBZ7001" TO CORRECT-A.
082400     PERFORM  FAIL-3.
082500 SORT-WRITE-9.
082600     MOVE     "SORT-TEST-9 " TO PAR-NAME.
082700     PERFORM  PRINT-DETAIL-3.
082800 SORT-TEST-10.
082900     PERFORM  RETURN-SORT3.
083000     IF       S3-KEYS EQUAL TO "567AZBZ7026"
083100              PERFORM PASS-3 GO TO SORT-WRITE-10.
083200     GO       TO SORT-FAIL-10.
083300 SORT-DELETE-10.
083400     PERFORM  DE-LETE-3.
083500     GO       TO SORT-WRITE-10.
083600 SORT-FAIL-10.
083700     MOVE     S3-KEYS TO COMPUTED-A.
083800     MOVE     "567AZBZ7026" TO CORRECT-A.
083900     PERFORM  FAIL-3.
084000 SORT-WRITE-10.
084100     MOVE     "SORT-TEST-10" TO PAR-NAME.
084200     PERFORM  PRINT-DETAIL-3.
084300 SORT-TEST-11.
084400     PERFORM  RETURN-SORT3 35 TIMES.
084500     IF       S3-KEYS EQUAL TO "567AQBQ7010"
084600              PERFORM PASS-3 GO TO SORT-WRITE-11.
084700     GO       TO SORT-FAIL-11.
084800 SORT-DELETE-11.
084900     PERFORM  DE-LETE-3.
085000     GO       TO SORT-WRITE-11.
085100 SORT-FAIL-11.
085200     MOVE     S3-KEYS TO COMPUTED-A.
085300     MOVE     "567AQBQ7010" TO CORRECT-A.
085400     PERFORM  FAIL-3.
085500 SORT-WRITE-11.
085600     MOVE     "SORT-TEST-11" TO PAR-NAME.
085700     PERFORM  PRINT-DETAIL-3.
085800 SORT-TEST-12.
085900     PERFORM  RETURN-SORT3.
086000     IF       S3-KEYS EQUAL TO "567AQBQ7035"
086100              PERFORM PASS-3 GO TO SORT-WRITE-12.
086200     GO       TO SORT-FAIL-12.
086300 SORT-DELETE-12.
086400     PERFORM  DE-LETE-3.
086500     GO       TO SORT-WRITE-12.
086600 SORT-FAIL-12.
086700     MOVE     S3-KEYS TO COMPUTED-A.
086800     MOVE     "567AQBQ7035" TO CORRECT-A.
086900     PERFORM  FAIL-3.
087000 SORT-WRITE-12.
087100     MOVE     "SORT-TEST-12" TO PAR-NAME.
087200     PERFORM  PRINT-DETAIL-3.
087300 SORT-TEST-13.
087400     PERFORM  RETURN-SORT3 35 TIMES.
087500     IF       S3-KEYS EQUAL TO "567AGBG7019"
087600              PERFORM PASS-3 GO TO SORT-WRITE-13.
087700     GO       TO SORT-FAIL-13.
087800 SORT-DELETE-13.
087900     PERFORM  DE-LETE-3.
088000     GO       TO SORT-WRITE-13.
088100 SORT-FAIL-13.
088200     MOVE     S3-KEYS TO COMPUTED-A.
088300     MOVE     "567AGBG7019" TO CORRECT-A.
088400     PERFORM  FAIL-3.
088500 SORT-WRITE-13.
088600     MOVE     "SORT-TEST-13" TO PAR-NAME.
088700     PERFORM  PRINT-DETAIL-3.
088800 SORT-TEST-14.
088900     PERFORM  RETURN-SORT3 27 TIMES.
089000     IF       S3-KEYS EQUAL TO "567AAAA7000"
089100              PERFORM PASS-3 GO TO SORT-WRITE-14.
089200     GO       TO SORT-FAIL-14.
089300 SORT-DELETE-14.
089400     PERFORM  DE-LETE-3.
089500     GO       TO SORT-WRITE-14.
089600 SORT-FAIL-14.
089700     MOVE     S3-KEYS TO COMPUTED-A.
089800     MOVE     "567AAAA7000" TO CORRECT-A.
089900     PERFORM  FAIL-3.
090000 SORT-WRITE-14.
090100     MOVE     "SORT-TEST-14" TO PAR-NAME.
090200     PERFORM  PRINT-DETAIL-3.
090300 SORT-TEST-15.
090400     RETURN   SORT3 RECORD AT END
090500              PERFORM PASS-3 GO TO SORT-WRITE-15.
090600*    NOTE     THE FOLLOWING SENTENCES SHOULD NOT BE EXECUTED.
090700     PERFORM FAIL-3.
090800     MOVE     "END OF FILE NOT FOUND" TO RE-MARK.
090900     GO       TO SORT-WRITE-15.
091000 SORT-DELETE-15.
091100     PERFORM  DE-LETE-3.
091200 SORT-WRITE-15.
091300     MOVE     "SORT-TEST-15" TO PAR-NAME.
091400     PERFORM  PRINT-DETAIL-3.
091500 CLOSE-3.
091600     GO       TO EXIT-3.
091700 SRT3-OUTPUT-2 SECTION.
091800 RETURN-SORT3.
091900     RETURN   SORT3 RECORD AT END GO TO TERMINAL-3.
092000*    NOTE     RETURN VERB WITH ALL OPTIONS EXCEPT INTO.
092100 TERMINAL-3.
092200     PERFORM  FAIL-3.
092300     MOVE     "TERMINAL-3" TO PAR-NAME.
092400     MOVE     "END OF FILE PREMATURELY" TO RE-MARK.
092500     PERFORM  PRINT-DETAIL-3.
092600     MOVE     SPACE TO FEATURE.
092700     MOVE     "FOUND, PREVIOUS TEST WAS" TO RE-MARK.
092800     PERFORM  PRINT-DETAIL-3.
092900     MOVE     "LAST SUCCESSFUL TEST." TO RE-MARK
093000     PERFORM  PRINT-DETAIL-3.
093100     GO       TO CLOSE-3.
093200 PASS-3.
093300     MOVE "PASS" TO P-OR-F.  ADD 1 TO PASS-COUNTER.
093400 FAIL-3.
093500     ADD      1 TO ERROR-COUNTER.
093600     MOVE "FAIL*" TO P-OR-F.
093700 DE-LETE-3.
093800     MOVE     SPACE TO P-OR-F.
093900     MOVE     "    ************    " TO COMPUTED-A.
094000     MOVE     "    ************    " TO CORRECT-A.
094100     MOVE "****TEST DELETED****" TO RE-MARK.
094200     ADD 1 TO DELETE-COUNTER.
094300 PRINT-DETAIL-3.
094400     IF REC-CT NOT EQUAL TO ZERO
094500             MOVE "." TO PARDOT-X
094600             MOVE REC-CT TO DOTVALUE.
094700     MOVE     TEST-RESULTS TO PRINT-REC.
094800     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
094900     MOVE     SPACE TO P-OR-F.
095000     MOVE     SPACE TO COMPUTED-A.
095100     MOVE SPACE TO CORRECT-A.
095200     IF     REC-CT EQUAL TO ZERO
095300              MOVE SPACE TO PAR-NAME.
095400     MOVE     SPACE TO RE-MARK.
095500 EXIT-3.
095600     EXIT.
095700 END-CCVS SECTION.
095800 CCVS-EXIT SECTION.
095900 CCVS-999999.
096000     GO TO CLOSE-FILES.
