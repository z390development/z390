000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IC208A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*        THE SUBPROGRAM IC208 CONTAINS TABLES AND AN INDEX
002200*    DATA ITEM WHICH ARE DEFINED IN THE LINKAGE SECTION
002300*    AND NAMED AS OPERANDS IN THE USING PHRASE OF THE
002400*    PROCEDURE DIVISION HEADER.  ONE OF THE TABLES IS DEFINED
002500*    WITH AN OCCURS DEPENDING ON CLAUSE AND HAS CONDITION-NAME
002600*    ENTRIES ASSOCIATED WITH IT.  THE SEARCH STATEMENT IS USED
002700*    TO TEST THE VARIABLE LENGTH TABLE CAPABILITY.
002800****************************************************************
002900 ENVIRONMENT DIVISION.
003000 CONFIGURATION SECTION.
003100 SOURCE-COMPUTER.
003200     XXXXX082.
003300 OBJECT-COMPUTER.
003400     XXXXX083.
003500 DATA DIVISION.
003600 LINKAGE SECTION.
003700 77  INDEX-1 USAGE IS INDEX.
003800 77  DN3 PICTURE 99.
003900 01  TABLE-01.
004000     02  DN1 PICTURE X
004100             OCCURS 1 TO 15 TIMES
004200             DEPENDING ON DN3
004300             INDEXED BY IN1.
004400         88  CN1 VALUE "A".
004500         88  CN2 VALUE "H".
004600         88  CN3 VALUE "O".
004700 01  TABLE-02.
004800     02  DN2 PICTURE X
004900             OCCURS 8 TIMES.
005000 PROCEDURE DIVISION USING TABLE-01, TABLE-02, INDEX-1, DN3.
005100 SECT-IC208-0001 SECTION.
005200 LINK-TEST-01.
005300*    THIS TEST USES THE INDEX DATA ITEM SET IN THE CALLING
005400*    PROGRAM TO SET AN INDEX AND REFERENCE A TABLE ITEM.
005500     SET IN1 TO INDEX-1.
005600     MOVE DN1 (IN1) TO DN2 (1).
005700*        LINK-TEST-02 TESTS THE VARIABLE LENGTH TABLE CAPABILITY
005800*    WITH THE DATA-NAME WHOSE CONTENTS IS THE TABLE LENGTH
005900*    DEFINED IN THE LINKAGE SECTION.
006000 LINK-TEST-02-01.
006100     SET IN1 TO 1.
006200     SEARCH DN1 VARYING IN1
006300         AT END MOVE "Z" TO DN2 (2)
006400         WHEN DN1 (IN1) EQUAL TO "D"
006500             MOVE "D" TO DN2 (2).
006600 LINK-TEST-02-02.
006700     SET IN1 TO 1.
006800     SEARCH DN1 VARYING IN1
006900         AT END MOVE "Y" TO DN2 (3)
007000         WHEN DN1 (IN1) EQUAL TO "B"
007100             MOVE "B" TO DN2 (3).
007200 LINK-TEST-02-03.
007300     MOVE 7 TO DN3.
007400     SET IN1 TO 1.
007500     SEARCH DN1 VARYING IN1
007600         AT END MOVE "X" TO DN2 (4)
007700         WHEN DN1 (IN1) EQUAL TO "H"
007800             MOVE "H" TO DN2 (4).
007900 LINK-TEST-02-04.
008000     SET IN1 TO 1.
008100     SEARCH DN1 VARYING IN1
008200         AT END MOVE "W" TO DN2 (5)
008300         WHEN DN1 (IN1) EQUAL TO "G"
008400             MOVE "G" TO DN2 (5).
008500 LINK-TEST-03.
008600     MOVE 10 TO DN3.
008700*        LINK-TEST-03 TESTS THE USE OF CONDITION-NAMES WHICH
008800*    WERE DEFINED IN THE LINKAGE SECTION.
008900 LINK-TEST-03-01.
009000     IF CN1 (1)  MOVE "A" TO DN2 (6).
009100 LINK-TEST-03-02.
009200     IF CN1 (5)  MOVE "N" TO DN2 (7)
009300         ELSE MOVE "V" TO DN2 (7).
009400 LINK-TEST-03-03.
009500     IF CN2 (8) MOVE "H" TO DN2 (8).
009600 LINK-TEST-04.
009700*        THIS TEST SETS THE INDEX DATA ITEM AND TABLE LENGTH
009800*    FOR REFERENCE IN THE CALLING PROGRAM.
009900     SET IN1 TO 2.
010000     SET INDEX-1 TO IN1.
010100     MOVE 9 TO DN3.
010200 EXIT-IC208.
010300     EXIT PROGRAM.
