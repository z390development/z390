000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     OBSQ1A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    " HIGH       ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "4.2 ".
001100*                                                              *
001200*        THE ROUTINE OBSQ1A CREATES A TAPE FILE WHICH HAS FIXED
001300*    LENGTH RECORDS.  THE FILE IS THEN CLOSED AND OPENED AS AN
001400*    INPUT FILE.  THE FILE IS READ AND FIELDS IN THE INPUT RECORDS
001500*    ARE COMPARED TO THE VALUES WRITTEN TO ENSURE THAT THE RECORDS
001600*    WERE PROCESSED CORRECTLY.  THE FILE IS CLOSED AND OPENED
001700*    AGAIN AS AN INPUT FILE.  FOUR READ FORMAT OPTIONS ARE USED
001800*    TO READ THE FILE AND FIELDS IN THE RECORDS ARE VERIFIED.
001900*    THE OPEN, CLOSE, READ, AND WRITE STATEMENTS ARE TESTED FOR
002000*    LEVEL ONE FEATURES.
002100*
002200*    THIS ROUTINE TESTS THE OBSOLETE LANGUAGE FEATURE "VALUE OF".
002300*    IT IS IDENTICAL WITH THE OLD (74) TEST PROGRAM SQ102.
002400*
002500*    USED X-CARDS:
002600*         XXXXX001
002700*         XXXXX055
002800*     P   XXXXX062
002900*         XXXXX082
003000*         XXXXX083
003100*     C   XXXXX084
003200*
003300*
003400*     OBSOLETE FEATURES WHICH ARE TESTED:
003500*
003600*         VALUE OF
003700*         XXXXX074
003800*         IS
003900*         XXXXX075
004000*         XXXXX069
004100*
004200*         DATA RECORDS ARE  ...           DATA RECORD  ...
004300*         LABEL RECORDS ARE ...           LABEL RECORD ...
004400 ENVIRONMENT DIVISION.
004500 CONFIGURATION SECTION.
004600 SOURCE-COMPUTER.
004700     XXXXX082.
004800 OBJECT-COMPUTER.
004900     XXXXX083.
005000 INPUT-OUTPUT SECTION.
005100 FILE-CONTROL.
005200P    SELECT RAW-DATA   ASSIGN TO
005300P    XXXXX062
005400P           ORGANIZATION IS INDEXED
005500P           ACCESS MODE IS RANDOM
005600P           RECORD KEY IS RAW-DATA-KEY.
005700     SELECT PRINT-FILE ASSIGN TO
005800     XXXXX055.
005900     SELECT SQ-FS1 ASSIGN TO
006000     XXXXX001
006100     ORGANIZATION IS SEQUENTIAL
006200     ACCESS MODE IS SEQUENTIAL.
006300 DATA DIVISION.
006400 FILE SECTION.
006500P
006600PFD  RAW-DATA
006700P       DATA RECORD IS RAW-DATA-SATZ
006800P       RECORD CONTAINS      50 CHARACTERS
006900P       LABEL RECORDS ARE STANDARD.
007000P
007100P01  RAW-DATA-SATZ.
007200P    05  RAW-DATA-KEY.
007300P        10  C-2             PIC XX.
007400P        10  C-POS3          PIC X.
007500P        10  FILLER          PIC XX.
007600P    05  C-DATUM.
007700P        10  C-D-JJ          PIC XX.
007800P        10  C-D-MM          PIC XX.
007900P        10  C-D-DD          PIC XX.
008000P    05 C-DATE REDEFINES C-DATUM   PIC 9(6).
008100P    05 C-ZEIT.
008200P        10  C-T-HH          PIC XX.
008300P        10  C-T-MM          PIC XX.
008400P        10  C-T-SS          PIC XX.
008500P        10  C-T-HS          PIC XX.
008600P    05 C-TIME REDEFINES C-ZEIT  PIC 9(8).
008700P    05  C-NO-OF-TESTS       PIC 99.
008800P    05  C-OK                PIC 999.
008900P    05  C-ALL               PIC 999.
009000P    05  C-FAIL              PIC 999.
009100P    05  C-DELETED           PIC 999.
009200P    05  C-INSPECT           PIC 999.
009300P    05  C-NOTE              PIC X(13).
009400P    05  C-INDENT            PIC X.
009500 FD  PRINT-FILE.
009600 01  PRINT-REC PICTURE X(120).
009700 01  DUMMY-RECORD PICTURE X(120).
009800 FD  SQ-FS1
009900C    VALUE OF
010000C    XXXXX074
010100C    IS
010200C    XXXXX075
010300G    XXXXX069
010400     DATA RECORD    SQ-FS1R1-F-G-120
010500     LABEL RECORD STANDARD.
010600 01  SQ-FS1R1-F-G-120.
010700     02  FILLER PIC X(120).
010800 WORKING-STORAGE SECTION.
010900 01  WRK-CS-09V00 PIC S9(9) USAGE COMP VALUE ZERO.
011000 01  RECORDS-IN-ERROR PIC S9(5) USAGE COMP VALUE ZERO.
011100 01  ERROR-FLAG PIC 9 VALUE ZERO.
011200 01  EOF-FLAG   PICTURE 9 VALUE ZERO.
011300 01  FILE-RECORD-INFORMATION-REC.
011400     03 FILE-RECORD-INFO-SKELETON.
011500        05 FILLER                 PICTURE X(48)       VALUE
011600             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
011700        05 FILLER                 PICTURE X(46)       VALUE
011800             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
011900        05 FILLER                 PICTURE X(26)       VALUE
012000             ",LFIL=000000,ORG=  ,LBLR= ".
012100        05 FILLER                 PICTURE X(37)       VALUE
012200             ",RECKEY=                             ".
012300        05 FILLER                 PICTURE X(38)       VALUE
012400             ",ALTKEY1=                             ".
012500        05 FILLER                 PICTURE X(38)       VALUE
012600             ",ALTKEY2=                             ".
012700        05 FILLER                 PICTURE X(7)        VALUE SPACE.
012800     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
012900        05 FILE-RECORD-INFO-P1-120.
013000           07 FILLER              PIC X(5).
013100           07 XFILE-NAME           PIC X(6).
013200           07 FILLER              PIC X(8).
013300           07 XRECORD-NAME         PIC X(6).
013400           07 FILLER              PIC X(1).
013500           07 REELUNIT-NUMBER     PIC 9(1).
013600           07 FILLER              PIC X(7).
013700           07 XRECORD-NUMBER       PIC 9(6).
013800           07 FILLER              PIC X(6).
013900           07 UPDATE-NUMBER       PIC 9(2).
014000           07 FILLER              PIC X(5).
014100           07 ODO-NUMBER          PIC 9(4).
014200           07 FILLER              PIC X(5).
014300           07 XPROGRAM-NAME        PIC X(5).
014400           07 FILLER              PIC X(7).
014500           07 XRECORD-LENGTH       PIC 9(6).
014600           07 FILLER              PIC X(7).
014700           07 CHARS-OR-RECORDS    PIC X(2).
014800           07 FILLER              PIC X(1).
014900           07 XBLOCK-SIZE          PIC 9(4).
015000           07 FILLER              PIC X(6).
015100           07 RECORDS-IN-FILE     PIC 9(6).
015200           07 FILLER              PIC X(5).
015300           07 XFILE-ORGANIZATION   PIC X(2).
015400           07 FILLER              PIC X(6).
015500           07 XLABEL-TYPE          PIC X(1).
015600        05 FILE-RECORD-INFO-P121-240.
015700           07 FILLER              PIC X(8).
015800           07 XRECORD-KEY          PIC X(29).
015900           07 FILLER              PIC X(9).
016000           07 ALTERNATE-KEY1      PIC X(29).
016100           07 FILLER              PIC X(9).
016200           07 ALTERNATE-KEY2      PIC X(29).
016300           07 FILLER              PIC X(7).
016400 01  TEST-RESULTS.
016500     02 FILLER                    PICTURE X VALUE SPACE.
016600     02 FEATURE                   PICTURE X(20) VALUE SPACE.
016700     02 FILLER                    PICTURE X VALUE SPACE.
016800     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
016900     02 FILLER                    PICTURE X  VALUE SPACE.
017000     02  PAR-NAME.
017100       03 FILLER PICTURE X(12) VALUE SPACE.
017200       03  PARDOT-X PICTURE X  VALUE SPACE.
017300       03 DOTVALUE PICTURE 99  VALUE ZERO.
017400       03 FILLER PIC X(5) VALUE SPACE.
017500     02 FILLER PIC X(10) VALUE SPACE.
017600     02 RE-MARK PIC X(61).
017700 01  TEST-COMPUTED.
017800     02 FILLER PIC X(30) VALUE SPACE.
017900     02 FILLER PIC X(17) VALUE "       COMPUTED=".
018000     02 COMPUTED-X.
018100     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
018200     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
018300     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
018400     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
018500     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
018600     03       CM-18V0 REDEFINES COMPUTED-A.
018700         04 COMPUTED-18V0                   PICTURE -9(18).
018800         04 FILLER                          PICTURE X.
018900     03 FILLER PIC X(50) VALUE SPACE.
019000 01  TEST-CORRECT.
019100     02 FILLER PIC X(30) VALUE SPACE.
019200     02 FILLER PIC X(17) VALUE "       CORRECT =".
019300     02 CORRECT-X.
019400     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
019500     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
019600     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
019700     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
019800     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
019900     03      CR-18V0 REDEFINES CORRECT-A.
020000         04 CORRECT-18V0                    PICTURE -9(18).
020100         04 FILLER                          PICTURE X.
020200     03 FILLER PIC X(50) VALUE SPACE.
020300 01  CCVS-C-1.
020400     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
020500-    "SS  PARAGRAPH-NAME
020600-    "        REMARKS".
020700     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
020800 01  CCVS-C-2.
020900     02 FILLER PICTURE IS X VALUE IS SPACE.
021000     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
021100     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
021200     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
021300     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
021400 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
021500 01  REC-CT PICTURE 99 VALUE ZERO.
021600 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
021700 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
021800 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
021900 01  PASS-COUNTER PIC 999 VALUE ZERO.
022000 01  TOTAL-ERROR PIC 999 VALUE ZERO.
022100 01  ERROR-HOLD PIC 999 VALUE ZERO.
022200 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
022300 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
022400 01  CCVS-H-1.
022500     02  FILLER   PICTURE X(27)  VALUE SPACE.
022600     02 FILLER PICTURE X(67) VALUE
022700     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
022800-    " SYSTEM".
022900     02  FILLER     PICTURE X(26)  VALUE SPACE.
023000 01  CCVS-H-2.
023100     02 FILLER PICTURE X(52) VALUE IS
023200     "CCVS74 FSTC COPY, NOT FOR DISTRIBUTION.".
023300     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
023400     02 TEST-ID PICTURE IS X(9).
023500     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
023600 01  CCVS-H-3.
023700     02  FILLER PICTURE X(34) VALUE
023800     " FOR OFFICIAL USE ONLY    ".
023900     02  FILLER PICTURE X(58) VALUE
024000     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
024100     02  FILLER PICTURE X(28) VALUE
024200     "  COPYRIGHT   1974 ".
024300 01  CCVS-E-1.
024400     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
024500     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
024600     02 ID-AGAIN PICTURE IS X(9).
024700     02 FILLER PICTURE X(45) VALUE IS
024800     " NTIS DISTRIBUTION COBOL 74".
024900 01  CCVS-E-2.
025000     02  FILLER                   PICTURE X(31)  VALUE
025100     SPACE.
025200     02  FILLER                   PICTURE X(21)  VALUE SPACE.
025300     02 CCVS-E-2-2.
025400         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
025500         03 FILLER PICTURE IS X VALUE IS SPACE.
025600         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
025700 01  CCVS-E-3.
025800     02  FILLER PICTURE X(22) VALUE
025900     " FOR OFFICIAL USE ONLY".
026000     02  FILLER PICTURE X(12) VALUE SPACE.
026100     02  FILLER PICTURE X(58) VALUE
026200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
026300     02  FILLER PICTURE X(13) VALUE SPACE.
026400     02 FILLER PIC X(15) VALUE " COPYRIGHT 1974".
026500 01  CCVS-E-4.
026600     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
026700     02 FILLER PIC XXXX VALUE " OF ".
026800     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
026900     02 FILLER PIC X(40) VALUE
027000      "  TESTS WERE EXECUTED SUCCESSFULLY".
027100 01  XXINFO.
027200     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
027300     02 INFO-TEXT.
027400     04 FILLER PIC X(20) VALUE SPACE.
027500     04 XXCOMPUTED PIC X(20).
027600     04 FILLER PIC X(5) VALUE SPACE.
027700     04 XXCORRECT PIC X(20).
027800 01  HYPHEN-LINE.
027900     02 FILLER PICTURE IS X VALUE IS SPACE.
028000     02 FILLER PICTURE IS X(65) VALUE IS "************************
028100-    "*****************************************".
028200     02 FILLER PICTURE IS X(54) VALUE IS "************************
028300-    "******************************".
028400 01  CCVS-PGM-ID PIC X(6) VALUE
028500     "OBSQ1A".
028600 PROCEDURE DIVISION.
028700 CCVS1 SECTION.
028800 OPEN-FILES.
028900P    OPEN I-O RAW-DATA.
029000P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
029100P    READ RAW-DATA INVALID KEY GO TO END-E-1.
029200P    ADD 1 TO C-NO-OF-TESTS.
029300P    ACCEPT C-DATE  FROM DATE.
029400P    ACCEPT C-TIME  FROM TIME.
029500P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
029600PEND-E-1.
029700P    CLOSE RAW-DATA.
029800     OPEN     OUTPUT PRINT-FILE.
029900     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
030000     MOVE    SPACE TO TEST-RESULTS.
030100     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
030200     MOVE ZERO TO REC-SKL-SUB.
030300     PERFORM CCVS-INIT-FILE 9 TIMES.
030400 CCVS-INIT-FILE.
030500     ADD 1 TO REC-SKL-SUB.
030600     MOVE FILE-RECORD-INFO-SKELETON TO
030700                  FILE-RECORD-INFO (REC-SKL-SUB).
030800 CCVS-INIT-EXIT.
030900     GO TO CCVS1-EXIT.
031000 CLOSE-FILES.
031100     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
031200P    OPEN I-O RAW-DATA.
031300P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
031400P    READ RAW-DATA INVALID KEY GO TO END-E-2.
031500P    MOVE PASS-COUNTER TO C-OK.
031600P    MOVE ERROR-HOLD   TO C-ALL.
031700P    MOVE ERROR-COUNTER TO C-FAIL.
031800P    MOVE DELETE-CNT TO C-DELETED.
031900P    MOVE INSPECT-COUNTER TO C-INSPECT.
032000P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
032100PEND-E-2.
032200P    CLOSE RAW-DATA.
032300 TERMINATE-CCVS.
032400S    EXIT PROGRAM.
032500STERMINATE-CALL.
032600     STOP     RUN.
032700 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
032800 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
032900 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
033000 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
033100     MOVE "****TEST DELETED****" TO RE-MARK.
033200 PRINT-DETAIL.
033300     IF REC-CT NOT EQUAL TO ZERO
033400             MOVE "." TO PARDOT-X
033500             MOVE REC-CT TO DOTVALUE.
033600     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
033700     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
033800        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
033900          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
034000     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
034100     MOVE SPACE TO CORRECT-X.
034200     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
034300     MOVE     SPACE TO RE-MARK.
034400 HEAD-ROUTINE.
034500     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034600     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
034700     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
034800 COLUMN-NAMES-ROUTINE.
034900     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035000     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
035200 END-ROUTINE.
035300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
035400 END-RTN-EXIT.
035500     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035600 END-ROUTINE-1.
035700      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
035800      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
035900      ADD PASS-COUNTER TO ERROR-HOLD.
036000*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
036100      MOVE PASS-COUNTER TO CCVS-E-4-1.
036200      MOVE ERROR-HOLD TO CCVS-E-4-2.
036300      MOVE CCVS-E-4 TO CCVS-E-2-2.
036400      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
036500  END-ROUTINE-12.
036600      MOVE "TEST(S) FAILED" TO ENDER-DESC.
036700     IF       ERROR-COUNTER IS EQUAL TO ZERO
036800         MOVE "NO " TO ERROR-TOTAL
036900         ELSE
037000         MOVE ERROR-COUNTER TO ERROR-TOTAL.
037100     MOVE     CCVS-E-2 TO DUMMY-RECORD.
037200     PERFORM WRITE-LINE.
037300 END-ROUTINE-13.
037400     IF DELETE-CNT IS EQUAL TO ZERO
037500         MOVE "NO " TO ERROR-TOTAL  ELSE
037600         MOVE DELETE-CNT TO ERROR-TOTAL.
037700     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
037800     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037900      IF   INSPECT-COUNTER EQUAL TO ZERO
038000          MOVE "NO " TO ERROR-TOTAL
038100      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
038200      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
038300      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038400     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038500 WRITE-LINE.
038600     ADD 1 TO RECORD-COUNT.
038700Y    IF RECORD-COUNT GREATER 50
038800Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
038900Y        MOVE SPACE TO DUMMY-RECORD
039000Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
039100Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
039200Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
039300Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
039400Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
039500Y        MOVE ZERO TO RECORD-COUNT.
039600     PERFORM WRT-LN.
039700 WRT-LN.
039800     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
039900     MOVE SPACE TO DUMMY-RECORD.
040000 BLANK-LINE-PRINT.
040100     PERFORM WRT-LN.
040200 FAIL-ROUTINE.
040300     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
040400     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
040500     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
040600     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040700     GO TO FAIL-ROUTINE-EX.
040800 FAIL-ROUTINE-WRITE.
040900     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
041000     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
041100 FAIL-ROUTINE-EX. EXIT.
041200 BAIL-OUT.
041300     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
041400     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
041500 BAIL-OUT-WRITE.
041600     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
041700     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041800 BAIL-OUT-EX. EXIT.
041900 CCVS1-EXIT.
042000     EXIT.
042100 SECT-OBSQ1A-0001 SECTION.
042200 SEQ-INIT-001.
042300     MOVE "SQ-FS1" TO XFILE-NAME (1).
042400     MOVE "R1-F-G" TO XRECORD-NAME (1).
042500     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
042600     MOVE 000120 TO XRECORD-LENGTH (1).
042700     MOVE "RC"   TO CHARS-OR-RECORDS (1).
042800     MOVE 0001   TO XBLOCK-SIZE (1).
042900     MOVE 000750 TO RECORDS-IN-FILE (1).
043000     MOVE "SQ"   TO XFILE-ORGANIZATION (1).
043100     MOVE "S" TO XLABEL-TYPE (1).
043200     MOVE 000001 TO XRECORD-NUMBER (1).
043300     OPEN OUTPUT SQ-FS1.
043400 SEQ-TEST-001.
043500     MOVE FILE-RECORD-INFO-P1-120 (1)  TO SQ-FS1R1-F-G-120.
043600     WRITE SQ-FS1R1-F-G-120.
043700     IF XRECORD-NUMBER (1) EQUAL TO 750
043800         GO TO SEQ-WRITE-001.
043900     ADD 1 TO XRECORD-NUMBER (1).
044000     GO TO SEQ-TEST-001.
044100 SEQ-WRITE-001.
044200     MOVE "CREATE FILE SQ-FS1" TO FEATURE.
044300     MOVE "SEQ-TEST-001" TO PAR-NAME.
044400     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
044500     MOVE  XRECORD-NUMBER (1) TO CORRECT-18V0.
044600     PERFORM PRINT-DETAIL.
044700     CLOSE SQ-FS1.
044800*        A SEQUENTIAL TAPE FILE WITH 120 CHARACTER RECORDS
044900*    HAS BEEN CREATED. THE FILE CONTAINS 750 RECORDS.
045000 SEQ-INIT-002.
045100     MOVE ZERO TO WRK-CS-09V00.
045200*        THIS TEST READS AND CHECKS THE FILE CREATED IN
045300*    SEQ-TEST-001.
045400     OPEN INPUT SQ-FS1.
045500 SEQ-TEST-002.
045600     READ SQ-FS1
045700          AT END GO TO SEQ-TEST-002-1.
045800     MOVE   SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
045900     ADD 1 TO WRK-CS-09V00.
046000     IF WRK-CS-09V00 GREATER THAN 750
046100        MOVE "MORE THAN 750 RECORDS" TO RE-MARK
046200        GO TO SEQ-FAIL-002.
046300     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
046400         ADD 1 TO RECORDS-IN-ERROR
046500         GO TO SEQ-TEST-002.
046600     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS1"
046700        ADD 1 TO RECORDS-IN-ERROR
046800        GO TO SEQ-TEST-002.
046900     IF XLABEL-TYPE (1) NOT EQUAL TO "S"
047000        ADD 1 TO RECORDS-IN-ERROR.
047100     GO TO SEQ-TEST-002.
047200 SEQ-TEST-002-1.
047300     IF RECORDS-IN-ERROR EQUAL TO ZERO
047400         GO TO SEQ-PASS-002.
047500     MOVE "ERRORS IN READING SQ-FS1" TO RE-MARK.
047600 SEQ-FAIL-002.
047700     MOVE "RECORDS IN ERROR =" TO COMPUTED-A.
047800     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
047900     PERFORM FAIL.
048000     GO TO SEQ-WRITE-002.
048100 SEQ-PASS-002.
048200     PERFORM PASS.
048300     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
048400     MOVE WRK-CS-09V00 TO CORRECT-18V0.
048500 SEQ-WRITE-002.
048600     MOVE "SEQ-TEST-002" TO PAR-NAME.
048700     MOVE "VERIFY FILE SQ-FS1" TO FEATURE.
048800     PERFORM PRINT-DETAIL.
048900 SEQ-CLOSE-002.
049000     CLOSE SQ-FS1.
049100 READ-INIT-01.
049200     MOVE ZERO TO WRK-CS-09V00.
049300     MOVE ZERO TO RECORDS-IN-ERROR.
049400     OPEN INPUT   SQ-FS1.
049500*            FOUR OPTIONS FOR THE READ STATEMENT ARE CHECKED
049600*    IN THIS SERIES OF TESTS.
049700     MOVE "LEV 1 READ STATEMENT" TO FEATURE.
049800     MOVE "READ...RECORD AT END ..." TO RE-MARK.
049900     MOVE "READ-TEST-01" TO PAR-NAME.
050000     MOVE ZERO TO ERROR-FLAG.
050100 READ-TEST-01.
050200     READ SQ-FS1 RECORD AT END
050300              MOVE "UNEXPECTED EOF" TO COMPUTED-A
050400              MOVE 1 TO EOF-FLAG
050500              GO TO READ-FAIL-01.
050600     PERFORM RECORD-CHECK.
050700     IF WRK-CS-09V00 EQUAL TO 200
050800              GO TO READ-TEST-01-1.
050900             GO TO READ-TEST-01.
051000 RECORD-CHECK.
051100     MOVE SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
051200     ADD 1 TO WRK-CS-09V00.
051300     IF WRK-CS-09V00 NOT EQUAL TO XRECORD-NUMBER (1)
051400         ADD 1 TO RECORDS-IN-ERROR
051500         MOVE 1 TO ERROR-FLAG.
051600 READ-TEST-01-1.
051700     IF ERROR-FLAG EQUAL TO ZERO
051800         GO TO READ-PASS-01.
051900     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
052000 READ-FAIL-01.
052100     PERFORM FAIL.
052200     GO TO READ-WRITE-01.
052300 READ-PASS-01.
052400     PERFORM PASS.
052500 READ-WRITE-01.
052600     PERFORM PRINT-DETAIL.
052700 READ-INIT-02.
052800     IF EOF-FLAG EQUAL TO 1
052900        GO TO SEQ-EOF-003.
053000     MOVE ZERO TO ERROR-FLAG.
053100     MOVE "READ...AT END..." TO RE-MARK.
053200     MOVE "READ-TEST-02" TO PAR-NAME.
053300 READ-TEST-02.
053400     READ SQ-FS1 AT END
053500         MOVE "UNEXPECTED EOF" TO COMPUTED-A
053600         MOVE 1 TO EOF-FLAG
053700         GO TO READ-FAIL-02.
053800     PERFORM RECORD-CHECK.
053900     IF WRK-CS-09V00 EQUAL TO 400
054000         GO TO READ-TEST-02-1.
054100     GO TO READ-TEST-02.
054200 READ-TEST-02-1.
054300     IF ERROR-FLAG EQUAL TO ZERO
054400         GO TO READ-PASS-02.
054500     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
054600 READ-FAIL-02.
054700     PERFORM FAIL.
054800     GO TO READ-WRITE-02.
054900 READ-PASS-02.
055000     PERFORM PASS.
055100 READ-WRITE-02.
055200     PERFORM PRINT-DETAIL.
055300 READ-INIT-03.
055400     IF EOF-FLAG EQUAL TO 1
055500        GO TO SEQ-EOF-003.
055600     MOVE ZERO TO ERROR-FLAG.
055700     MOVE "READ...RECORD END..." TO RE-MARK.
055800     MOVE "READ-TEST-03" TO PAR-NAME.
055900 READ-TEST-03.
056000     READ SQ-FS1 RECORD END
056100          MOVE "UNEXPECTED EOF" TO COMPUTED-A
056200          MOVE 1 TO EOF-FLAG
056300          GO TO READ-FAIL-03.
056400     PERFORM RECORD-CHECK.
056500     IF WRK-CS-09V00 EQUAL TO 600
056600         GO TO READ-TEST-03-1.
056700     GO TO READ-TEST-03.
056800 READ-TEST-03-1.
056900     IF ERROR-FLAG EQUAL TO ZERO
057000         GO TO READ-PASS-03.
057100     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
057200 READ-FAIL-03.
057300     PERFORM FAIL.
057400     GO TO READ-WRITE-03.
057500 READ-PASS-03.
057600     PERFORM PASS.
057700 READ-WRITE-03.
057800     PERFORM PRINT-DETAIL.
057900 READ-INIT-04.
058000     IF EOF-FLAG EQUAL TO 1
058100         GO TO SEQ-EOF-003.
058200     MOVE ZERO TO ERROR-FLAG.
058300     MOVE "READ...END..." TO RE-MARK.
058400     MOVE  "READ-TEST-04" TO PAR-NAME.
058500 READ-TEST-04.
058600     READ SQ-FS1 END GO TO READ-TEST-04-1.
058700     PERFORM RECORD-CHECK.
058800     IF WRK-CS-09V00 GREATER THAN 750
058900          GO TO READ-TEST-04-1.
059000     GO TO READ-TEST-04.
059100 READ-TEST-04-1.
059200     IF ERROR-FLAG EQUAL TO ZERO
059300          GO TO READ-PASS-04.
059400 READ-FAIL-04.
059500     MOVE "ERROR IN RECORD(S)" TO COMPUTED-A.
059600     PERFORM FAIL.
059700     GO TO READ-WRITE-04.
059800 READ-PASS-04.
059900     PERFORM PASS.
060000 READ-WRITE-04.
060100     PERFORM PRINT-DETAIL.
060200 SEQ-TEST-003.
060300     IF RECORDS-IN-ERROR NOT EQUAL TO ZERO
060400          MOVE "RECORDS IN ERROR =" TO COMPUTED-A
060500          MOVE RECORDS-IN-ERROR TO CORRECT-18V0
060600          GO TO SEQ-FAIL-003.
060700     IF WRK-CS-09V00 GREATER THAN 750
060800          MOVE "MORE THAN 750 RECORDS" TO RE-MARK
060900          GO TO SEQ-FAIL-003.
061000 SEQ-PASS-003.
061100     PERFORM PASS.
061200     GO TO SEQ-WRITE-003.
061300 SEQ-EOF-003.
061400     MOVE "LESS THAN 750 RECORDS" TO RE-MARK.
061500     MOVE "RECORDS READ =" TO COMPUTED-A.
061600     MOVE WRK-CS-09V00 TO CORRECT-18V0.
061700 SEQ-FAIL-003.
061800     PERFORM FAIL.
061900 SEQ-WRITE-003.
062000     MOVE "SEQ-TEST-003" TO PAR-NAME.
062100     MOVE "READ FILE SQ-FS1" TO FEATURE.
062200     PERFORM PRINT-DETAIL.
062300 SEQ-CLOSE-003.
062400     CLOSE SQ-FS1.
062500 TERMINATE-ROUTINE.
062600     EXIT.
062700 CCVS-EXIT SECTION.
062800 CCVS-999999.
062900     GO TO CLOSE-FILES.
