000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ106A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 1.0 ISSUED IN JANUARY 1986.          *
000900*                             REVISED 1986, AUGUST             *
001000*                                                              *
001100*    CREATION DATE     /     VALIDATION DATE                   *
001200*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001300*                                                              *
001400****************************************************************
001500*                                                              *
001600*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001700*                                                              *
001800*            X-01   SEQUENTIAL MAGNETIC TAPE FILE              *
001900*            X-55   SYSTEM PRINTER                             *
002000*            X-82   SOURCE-COMPUTER                            *
002100*            X-83   OBJECT-COMPUTER.                           *
002200*                                                              *
002300****************************************************************
002400
002500*    THIS PROGRAM BUILDS A SEQUENTIAL TAPE FILE WHICH CONTAINS *
002600*    BOTH 120 CHARACTER AND 151 CHARACTER RECORDS.             *
002700*                                                              *
002800*    THE SEQUENCE OF RECORD TYPES IS SLSSLSLLLSS, WHERE S      *
002900*    INDICATES 120 CHARACTERS AND L INDICATES 151 CHARACTERS,  *
003000*    FOR A TOTAL OF 11 RECORDS IN THE FILE.  SIX OF THE        *
003100*    RECORDS ARE WRITEN USING WRITE FROM, THE OTHERS USING A   *
003200*    WRITE STATEMENT WITHOUT THE FROM PHRASE.  THE FILE IS     *
003300*    THEN CLOSED AND REOPENED FOR INPUT.  IT IS READ USING     *
003400*    TWELVE DIFFERENT FORMATS OF THE READ STATEMENT.  THE      *
003500*    VARIANTS ARE PRODUCED BY INCLUDING OR OMITTING THE NOT AT *
003600*    END AND END-READ PHRASES, AND INCLUDING OR EXCLUDING THE  *
003700*    OPTIONAL WORD "AT" IN THE END AND NOT END PHRASES.        *
003800*    FIELDS IN EACH RECORD ARE CHECKED AGAINST THE EXPECTED    *
003900*    VALUES.                                                   *
004000*                                                              *
004100*    WHERE A SHORT RECORD IS EXPECTED, A CHECK IS MADE THAT    *
004200*    THE RECORD AREA DOES NOT CONTAIN THE VALUES THAT WERE     *
004300*    PRESENT IN THAT PART OF THE RECORD AREA BEYOND THE RECORD *
004400*    WHEN IT WAS WRITTEN.  THIS ASSUMPTION IS NOT FULLY        *
004500*    JUSTIFIED, AS THE CONTENT OF THE RECORD AREA BEYOND THE   *
004600*    END OF THE RECORD WHEN A SHORT RECORD IS READ IS          *
004700*    UNDEFINED, BUT IT IS UNLIKELY THAT THE VALUES TESTED FOR  *
004800*    WOULD OCCUR BY CHANCE.                                    *
004900*                                                              *
005000****************************************************************
005100*
005200 ENVIRONMENT DIVISION.
005300 CONFIGURATION SECTION.
005400 SOURCE-COMPUTER.
005500     XXXXX082.
005600 OBJECT-COMPUTER.
005700     XXXXX083.
005800 INPUT-OUTPUT SECTION.
005900 FILE-CONTROL.
006000P    SELECT RAW-DATA   ASSIGN TO
006100P    XXXXX062
006200P           ORGANIZATION IS INDEXED
006300P           ACCESS MODE IS RANDOM
006400P           RECORD KEY IS RAW-DATA-KEY.
006500*
006600     SELECT PRINT-FILE ASSIGN TO
006700     XXXXX055.
006800*
006900     SELECT SQ-VS6 ASSIGN
007000     XXXXX001
007100     STATUS SQ-STATUS
007200     ORGANIZATION IS SEQUENTIAL.
007300*
007400*
007500 DATA DIVISION.
007600 FILE SECTION.
007700P
007800PFD  RAW-DATA.
007900P
008000P01  RAW-DATA-SATZ.
008100P    05  RAW-DATA-KEY        PIC X(6).
008200P    05  C-DATE              PIC 9(6).
008300P    05  C-TIME              PIC 9(8).
008400P    05  C-NO-OF-TESTS       PIC 99.
008500P    05  C-OK                PIC 999.
008600P    05  C-ALL               PIC 999.
008700P    05  C-FAIL              PIC 999.
008800P    05  C-DELETED           PIC 999.
008900P    05  C-INSPECT           PIC 999.
009000P    05  C-NOTE              PIC X(13).
009100P    05  C-INDENT            PIC X.
009200P    05  C-ABORT             PIC X(8).
009300*
009400 FD  PRINT-FILE
009500C    LABEL RECORDS
009600C    XXXXX084
009700C    DATA RECORD IS PRINT-REC DUMMY-RECORD
009800               .
009900 01  PRINT-REC PICTURE X(120).
010000 01  DUMMY-RECORD PICTURE X(120).
010100*
010200*
010300 FD  SQ-VS6
010400C    LABEL RECORDS ARE STANDARD
010500C    DATA RECORDS ARE SQ-VS6R1-M-G-120  SQ-VS6R2-M-G-151
010600     RECORD CONTAINS 120 TO 151 CHARACTERS.
010700*
010800 01  SQ-VS6R1-M-G-120.
010900     02  SQ-VS6R1-FIRST PIC X(120).
011000*
011100 01  SQ-VS6R2-M-G-151.
011200     02  SQ-VS6R2-FIRST  PIC X(120).
011300     02  SQ-VS6R2-SECOND.
011400         05  SQ-VS6R2-SECOND-L.
011500             07  LONG-OR-SHORT   PIC X(5).
011600             07  SQ-VS6-RECNO    PIC X(5).
011700         05  SQ-VS6R2-SECOND-R.
011800             07  SQ-VS6-FILLER   PIC X(21).
011900*
012000*
012100 WORKING-STORAGE SECTION.
012200*
012300***************************************************************
012400*                                                             *
012500*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
012600*                                                             *
012700***************************************************************
012800*
012900 01  SQ-STATUS.
013000   03  SQ-STATUS-1 PIC X.
013100   03  SQ-STATUS-2 PIC X.
013200*
013300 01  BUFFER-COPY.
013400   03  BUFFER-COPY-120    PIC X(120).
013500   03  BUFFER-COPY-SECOND.
013600       05  BUFFER-COPY-SECOND-L.
013700           07  BUFFER-COPY-L-OR-S PIC X(5).
013800           07  BUFFER-COPY-RECNO  PIC 9(5).
013900       05  BUFFER-COPY-SECOND-R.
014000           07  BUFFER-COPY-END    PIC X(21).
014100*
014200 01  EOF-FLAG      PIC X(12).
014300 01  NOT-EOF-FLAG  PIC X(12).
014400 01  END-READ-FLAG PIC X(12).
014500*
014600 01  DELETE-SW.
014700   03  DELETE-SW-1 PIC X.
014800   03  DELETE-SW-1-GROUP.
014900     05  DELETE-SW-2 PIC X.
015000     05  DELETE-SW-2-GROUP.
015100         07  DELETE-SW-3 PIC X.
015200*
015300***************************************************************
015400*                                                             *
015500*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
015600*                                                             *
015700***************************************************************
015800*
015900 01  REC-SKEL-SUB   PIC 99.
016000*
016100 01  FILE-RECORD-INFORMATION-REC.
016200     03 FILE-RECORD-INFO-SKELETON.
016300        05 FILLER                 PICTURE X(48)       VALUE
016400             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
016500        05 FILLER                 PICTURE X(46)       VALUE
016600             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
016700        05 FILLER                 PICTURE X(26)       VALUE
016800             ",LFIL=000000,ORG=  ,LBLR= ".
016900        05 FILLER                 PICTURE X(37)       VALUE
017000             ",RECKEY=                             ".
017100        05 FILLER                 PICTURE X(38)       VALUE
017200             ",ALTKEY1=                             ".
017300        05 FILLER                 PICTURE X(38)       VALUE
017400             ",ALTKEY2=                             ".
017500        05 FILLER                 PICTURE X(7)        VALUE SPACE.
017600     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
017700        05 FILE-RECORD-INFO-P1-120.
017800           07 FILLER              PIC X(5).
017900           07 XFILE-NAME          PIC X(6).
018000           07 FILLER              PIC X(8).
018100           07 XRECORD-NAME        PIC X(6).
018200           07 FILLER              PIC X(1).
018300           07 REELUNIT-NUMBER     PIC 9(1).
018400           07 FILLER              PIC X(7).
018500           07 XRECORD-NUMBER      PIC 9(6).
018600           07 FILLER              PIC X(6).
018700           07 UPDATE-NUMBER       PIC 9(2).
018800           07 FILLER              PIC X(5).
018900           07 ODO-NUMBER          PIC 9(4).
019000           07 FILLER              PIC X(5).
019100           07 XPROGRAM-NAME       PIC X(5).
019200           07 FILLER              PIC X(7).
019300           07 XRECORD-LENGTH      PIC 9(6).
019400           07 FILLER              PIC X(7).
019500           07 CHARS-OR-RECORDS    PIC X(2).
019600           07 FILLER              PIC X(1).
019700           07 XBLOCK-SIZE         PIC 9(4).
019800           07 FILLER              PIC X(6).
019900           07 RECORDS-IN-FILE     PIC 9(6).
020000           07 FILLER              PIC X(5).
020100           07 XFILE-ORGANIZATION  PIC X(2).
020200           07 FILLER              PIC X(6).
020300           07 XLABEL-TYPE         PIC X(1).
020400        05 FILE-RECORD-INFO-P121-240.
020500           07 FILLER              PIC X(8).
020600           07 XRECORD-KEY         PIC X(29).
020700           07 FILLER              PIC X(9).
020800           07 ALTERNATE-KEY1      PIC X(29).
020900           07 FILLER              PIC X(9).
021000           07 ALTERNATE-KEY2      PIC X(29).
021100           07 FILLER              PIC X(7).
021200*
021300 01  TEST-RESULTS.
021400     02 FILLER              PIC X      VALUE SPACE.
021500     02  PAR-NAME.
021600       03 FILLER              PIC X(14)  VALUE SPACE.
021700       03 PARDOT-X            PIC X      VALUE SPACE.
021800       03 DOTVALUE            PIC 99     VALUE ZERO.
021900     02 FILLER              PIC X      VALUE SPACE.
022000     02 FEATURE             PIC X(24)  VALUE SPACE.
022100     02 FILLER              PIC X      VALUE SPACE.
022200     02 P-OR-F              PIC X(5)   VALUE SPACE.
022300     02 FILLER              PIC X(9)   VALUE SPACE.
022400     02 RE-MARK             PIC X(61).
022500 01  TEST-COMPUTED.
022600   02 FILLER  PIC X(30)  VALUE SPACE.
022700   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
022800   02 COMPUTED-X.
022900     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
023000     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
023100     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
023200     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
023300     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
023400     03       CM-18V0 REDEFINES COMPUTED-A.
023500        04 COMPUTED-18V0                   PIC -9(18).
023600        04 FILLER                          PIC X.
023700     03 FILLER PIC X(50) VALUE SPACE.
023800 01  TEST-CORRECT.
023900     02 FILLER PIC X(30) VALUE SPACE.
024000     02 FILLER PIC X(17) VALUE "       CORRECT =".
024100     02 CORRECT-X.
024200     03 CORRECT-A                  PIC X(20) VALUE SPACE.
024300     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
024400     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
024500     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
024600     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
024700     03      CR-18V0 REDEFINES CORRECT-A.
024800         04 CORRECT-18V0                     PIC -9(18).
024900         04 FILLER                           PIC X.
025000     03 FILLER PIC X(2) VALUE SPACE.
025100     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
025200*
025300 01  CCVS-C-1.
025400     02 FILLER  PIC IS X        VALUE  SPACE.
025500     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
025600     02 FILLER  PIC IS X        VALUE  SPACE.
025700     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
025800     02 FILLER  PIC IS X        VALUE  SPACE.
025900     02 FILLER  PIC IS X(5)     VALUE "PASS ".
026000     02 FILLER  PIC IS X(9)     VALUE  SPACE.
026100     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
026200 01  CCVS-C-2.
026300     02 FILLER  PIC X(19)  VALUE  SPACE.
026400     02 FILLER  PIC X(6)   VALUE "TESTED".
026500     02 FILLER  PIC X(19)  VALUE  SPACE.
026600     02 FILLER  PIC X(4)   VALUE "FAIL".
026700     02 FILLER  PIC X(72)  VALUE  SPACE.
026800*
026900 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
027000 01  REC-CT            PIC 99       VALUE ZERO.
027100 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
027200 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
027300 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
027400 01  PASS-COUNTER      PIC 999      VALUE ZERO.
027500 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
027600 01  ERROR-HOLD        PIC 999      VALUE ZERO.
027700 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
027800 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
027900 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
028000 01  CCVS-H-1.
028100     02  FILLER          PIC X(39)    VALUE SPACES.
028200     02  FILLER          PIC X(42)    VALUE
028300     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
028400     02  FILLER          PIC X(39)    VALUE SPACES.
028500 01  CCVS-H-2A.
028600   02  FILLER            PIC X(40)  VALUE SPACE.
028700   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
028800   02  FILLER            PIC XXXX   VALUE
028900     "4.2 ".
029000   02  FILLER            PIC X(28)  VALUE
029100            " COPY - NOT FOR DISTRIBUTION".
029200   02  FILLER            PIC X(41)  VALUE SPACE.
029300*
029400 01  CCVS-H-2B.
029500   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
029600   02  TEST-ID           PIC X(9).
029700   02  FILLER            PIC X(4)   VALUE " IN ".
029800   02  FILLER            PIC X(12)  VALUE
029900     " HIGH       ".
030000   02  FILLER            PIC X(22)  VALUE
030100            " LEVEL VALIDATION FOR ".
030200   02  FILLER            PIC X(58)  VALUE
030300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
030400 01  CCVS-H-3.
030500     02  FILLER          PIC X(34)  VALUE
030600            " FOR OFFICIAL USE ONLY    ".
030700     02  FILLER          PIC X(58)  VALUE
030800     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
030900     02  FILLER          PIC X(28)  VALUE
031000            "  COPYRIGHT   1985,1986 ".
031100 01  CCVS-E-1.
031200     02 FILLER           PIC X(52)  VALUE SPACE.
031300     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
031400     02 ID-AGAIN         PIC X(9).
031500     02 FILLER           PIC X(45)  VALUE SPACES.
031600 01  CCVS-E-2.
031700     02  FILLER          PIC X(31)  VALUE SPACE.
031800     02  FILLER          PIC X(21)  VALUE SPACE.
031900     02  CCVS-E-2-2.
032000         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
032100         03 FILLER         PIC X      VALUE SPACE.
032200         03 ENDER-DESC     PIC X(44)  VALUE
032300            "ERRORS ENCOUNTERED".
032400 01  CCVS-E-3.
032500     02  FILLER          PIC X(22)  VALUE
032600            " FOR OFFICIAL USE ONLY".
032700     02  FILLER          PIC X(12)  VALUE SPACE.
032800     02  FILLER          PIC X(58)  VALUE
032900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
033000     02  FILLER          PIC X(8)   VALUE SPACE.
033100     02  FILLER          PIC X(20)  VALUE
033200             " COPYRIGHT 1985,1986".
033300 01  CCVS-E-4.
033400     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
033500     02 FILLER           PIC X(4)   VALUE " OF ".
033600     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
033700     02 FILLER           PIC X(40)  VALUE
033800      "  TESTS WERE EXECUTED SUCCESSFULLY".
033900 01  XXINFO.
034000     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
034100     02 INFO-TEXT.
034200       04 FILLER             PIC X(8)   VALUE SPACE.
034300       04 XXCOMPUTED         PIC X(20).
034400       04 FILLER             PIC X(5)   VALUE SPACE.
034500       04 XXCORRECT          PIC X(20).
034600     02 INF-ANSI-REFERENCE PIC X(48).
034700 01  HYPHEN-LINE.
034800     02 FILLER  PIC IS X VALUE IS SPACE.
034900     02 FILLER  PIC IS X(65)    VALUE IS "************************
035000-    "*****************************************".
035100     02 FILLER  PIC IS X(54)    VALUE IS "************************
035200-    "******************************".
035300 01  CCVS-PGM-ID  PIC X(9)   VALUE
035400     "SQ106A".
035500*
035600*
035700 PROCEDURE DIVISION.
035800 CCVS1 SECTION.
035900 OPEN-FILES.
036000P    OPEN    I-O RAW-DATA.
036100P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
036200P    READ    RAW-DATA INVALID KEY GO TO END-E-1.
036300P    MOVE   "ABORTED "   TO C-ABORT.
036400P    ADD     1           TO C-NO-OF-TESTS.
036500P    ACCEPT  C-DATE      FROM DATE.
036600P    ACCEPT  C-TIME      FROM TIME.
036700P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
036800PEND-E-1.
036900P    CLOSE   RAW-DATA.
037000     OPEN    OUTPUT PRINT-FILE.
037100     MOVE    CCVS-PGM-ID TO TEST-ID.
037200     MOVE    CCVS-PGM-ID TO ID-AGAIN.
037300     MOVE    SPACE TO TEST-RESULTS.
037400     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
037500     MOVE    ZERO TO REC-SKEL-SUB.
037600     PERFORM CCVS-INIT-FILE 10 TIMES.
037700     GO TO CCVS1-EXIT.
037800*
037900 CCVS-INIT-FILE.
038000     ADD     1 TO REC-SKL-SUB.
038100     MOVE    FILE-RECORD-INFO-SKELETON TO
038200                  FILE-RECORD-INFO (REC-SKL-SUB).
038300*
038400 CLOSE-FILES.
038500     PERFORM END-ROUTINE THRU END-ROUTINE-13.
038600     CLOSE   PRINT-FILE.
038700P    OPEN    I-O RAW-DATA.
038800P    MOVE    CCVS-PGM-ID TO RAW-DATA-KEY.
038900P    READ    RAW-DATA INVALID KEY GO TO END-E-2.
039000P    MOVE   "OK.     " TO C-ABORT.
039100P    MOVE    PASS-COUNTER  TO C-OK.
039200P    MOVE    ERROR-HOLD    TO C-ALL.
039300P    MOVE    ERROR-COUNTER TO C-FAIL.
039400P    MOVE    DELETE-CNT    TO C-DELETED.
039500P    MOVE    INSPECT-COUNTER TO C-INSPECT.
039600P    REWRITE RAW-DATA-SATZ INVALID KEY CONTINUE.
039700PEND-E-2.
039800P    CLOSE   RAW-DATA.
039900 TERMINATE-CCVS.
040000S    EXIT    PROGRAM.
040100     STOP    RUN.
040200*
040300 INSPT.
040400     MOVE   "INSPT" TO P-OR-F.
040500     ADD     1 TO INSPECT-COUNTER.
040600     PERFORM PRINT-DETAIL.
040700*
040800 PASS.
040900     MOVE   "PASS " TO P-OR-F.
041000     ADD     1 TO PASS-COUNTER.
041100     PERFORM PRINT-DETAIL.
041200*
041300 FAIL.
041400     MOVE   "FAIL*" TO P-OR-F.
041500     ADD     1 TO ERROR-COUNTER.
041600     PERFORM PRINT-DETAIL.
041700*
041800 DE-LETE.
041900     MOVE   "****TEST DELETED****" TO RE-MARK.
042000     MOVE   "*****" TO P-OR-F.
042100     ADD     1 TO DELETE-COUNTER.
042200     PERFORM PRINT-DETAIL.
042300*
042400 PRINT-DETAIL.
042500     IF REC-CT NOT EQUAL TO ZERO
042600         MOVE   "." TO PARDOT-X
042700         MOVE    REC-CT TO DOTVALUE.
042800     MOVE    TEST-RESULTS TO PRINT-REC.
042900     PERFORM WRITE-LINE.
043000     IF P-OR-F EQUAL TO "FAIL*"
043100         PERFORM WRITE-LINE
043200         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
043300     ELSE
043400         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
043500     MOVE    SPACE TO P-OR-F.
043600     MOVE    SPACE TO COMPUTED-X.
043700     MOVE    SPACE TO CORRECT-X.
043800     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
043900     MOVE    SPACE TO RE-MARK.
044000*
044100 HEAD-ROUTINE.
044200     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044300     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044400     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
044500     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
044600 COLUMN-NAMES-ROUTINE.
044700     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
044800     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
045000 END-ROUTINE.
045100     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
045200     PERFORM WRITE-LINE 5 TIMES.
045300 END-RTN-EXIT.
045400     MOVE    CCVS-E-1 TO DUMMY-RECORD.
045500     PERFORM WRITE-LINE 2 TIMES.
045600*
045700 END-ROUTINE-1.
045800     ADD     ERROR-COUNTER   TO ERROR-HOLD
045900     ADD     INSPECT-COUNTER TO ERROR-HOLD.
046000     ADD     DELETE-COUNTER  TO ERROR-HOLD.
046100     ADD     PASS-COUNTER    TO ERROR-HOLD.
046200     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
046300     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
046400     MOVE    CCVS-E-4        TO CCVS-E-2-2.
046500     MOVE    CCVS-E-2        TO DUMMY-RECORD
046600     PERFORM WRITE-LINE.
046700     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
046800     IF ERROR-COUNTER IS EQUAL TO ZERO
046900         MOVE   "NO " TO ERROR-TOTAL
047000     ELSE
047100         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
047200     MOVE    CCVS-E-2 TO DUMMY-RECORD.
047300     PERFORM WRITE-LINE.
047400 END-ROUTINE-13.
047500     IF DELETE-COUNTER IS EQUAL TO ZERO
047600         MOVE   "NO " TO ERROR-TOTAL
047700     ELSE
047800         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
047900     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
048000     MOVE    CCVS-E-2 TO DUMMY-RECORD.
048100     PERFORM WRITE-LINE.
048200     IF INSPECT-COUNTER EQUAL TO ZERO
048300         MOVE   "NO " TO ERROR-TOTAL
048400     ELSE
048500         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
048600     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
048700     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
048800     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
048900*
049000 WRITE-LINE.
049100     ADD     1 TO RECORD-COUNT.
049200Y    IF RECORD-COUNT GREATER 50
049300Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
049400Y        MOVE  SPACE TO DUMMY-RECORD
049500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
049600Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
049700Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
049800Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
049900Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
050000Y        MOVE  ZERO TO RECORD-COUNT.
050100     PERFORM WRT-LN.
050200*
050300 WRT-LN.
050400     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
050500     MOVE    SPACE TO DUMMY-RECORD.
050600 BLANK-LINE-PRINT.
050700     PERFORM WRT-LN.
050800 FAIL-ROUTINE.
050900     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
051000     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
051100     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
051200     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
051300     MOVE    XXINFO TO DUMMY-RECORD.
051400     PERFORM WRITE-LINE 2 TIMES.
051500     MOVE    SPACES TO INF-ANSI-REFERENCE.
051600     GO TO   FAIL-ROUTINE-EX.
051700 FAIL-ROUTINE-WRITE.
051800     MOVE    TEST-COMPUTED  TO PRINT-REC
051900     PERFORM WRITE-LINE
052000     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
052100     MOVE    TEST-CORRECT   TO PRINT-REC
052200     PERFORM WRITE-LINE 2 TIMES.
052300     MOVE    SPACES         TO COR-ANSI-REFERENCE.
052400 FAIL-ROUTINE-EX.
052500     EXIT.
052600 BAIL-OUT.
052700     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
052800     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
052900 BAIL-OUT-WRITE.
053000     MOVE    CORRECT-A      TO XXCORRECT.
053100     MOVE    COMPUTED-A     TO XXCOMPUTED.
053200     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
053300     MOVE    XXINFO TO DUMMY-RECORD.
053400     PERFORM WRITE-LINE 2 TIMES.
053500     MOVE    SPACES TO INF-ANSI-REFERENCE.
053600 BAIL-OUT-EX.
053700     EXIT.
053800 CCVS1-EXIT.
053900     EXIT.
054000*
054100****************************************************************
054200*                                                              *
054300*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
054400*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
054500*                                                              *
054600****************************************************************
054700*
054800 SECT-SQ106-0001 SECTION.
054900 SEQ-INIT-01.
055000     MOVE    SPACE TO DELETE-SW.
055100*
055200     MOVE   "SQ-VS6" TO XFILE-NAME (1).
055300     MOVE    CCVS-PGM-ID TO XPROGRAM-NAME (1).
055400     MOVE   "RC"  TO CHARS-OR-RECORDS (1).
055500     MOVE    0001 TO XBLOCK-SIZE (1).
055600     MOVE    11   TO RECORDS-IN-FILE (1).
055700     MOVE   "SQ"  TO XFILE-ORGANIZATION (1).
055800     MOVE   "S"   TO XLABEL-TYPE (1).
055900     MOVE    0    TO XRECORD-NUMBER (1).
056000     MOVE    ZERO TO BUFFER-COPY-RECNO.
056100     MOVE   "MULTIPLE REC LENGTHS" TO BUFFER-COPY-END.
056200*
056300*    THE FIRST ACTION IS TO OPEN THE FILE FOR OUTPUT, AND SO
056400*    CREATE IT.  IF THE OPEN IS DELETED, ALL SUCCEDING TESTS
056500*    ARE AUTOMATICALLY DELETED WITH IT.  A SUBORDINATE TEST
056600*    CHECKS THE I-O STATUS RETURNED FROM THE OPEN OPERATION.
056700*
056800     MOVE   "**"  TO SQ-STATUS.
056900     MOVE   "OPEN FILE FOR OUTPUT" TO FEATURE.
057000     MOVE   "SEQ-TEST-GF-01" TO PAR-NAME.
057100     GO TO   SEQ-TEST-GF-01.
057200 SEQ-DELETE-01.
057300     MOVE   "*" TO DELETE-SW-1.
057400     GO TO   SEQ-DELETE-01-01.
057500 SEQ-TEST-GF-01.
057600     OPEN OUTPUT SQ-VS6.
057700     GO TO   SEQ-TEST-GF-01-01.
057800 SEQ-DELETE-01-01.
057900     PERFORM DE-LETE.
058000     GO TO   SEQ-TEST-01-01-END.
058100 SEQ-TEST-GF-01-01.
058200     IF SQ-STATUS = "00"
058300         PERFORM PASS
058400     ELSE
058500         MOVE    SQ-STATUS TO COMPUTED-A
058600         MOVE   "00" TO CORRECT-A
058700         MOVE   "UNEXPECTED I-O STATUS FROM OPEN" TO RE-MARK
058800         MOVE   "VII-2, VII-39" TO ANSI-REFERENCE
058900         PERFORM FAIL
059000         MOVE   "*" TO DELETE-SW-1.
059100 SEQ-TEST-01-01-END.
059200*
059300*
059400*    UNLESS AN ERROR OCCURRED DURING EXECUTION OF THE OPEN
059500*    STATEMENT, THE FILE IS NOW OPEN, AND READY FOR RECORDS TO
059600*    BE WRITTEN TO IT.  IF AN ERROR I-O STATUS VALUE WAS
059700*    RETURNED, ALL THE REMAINING TESTS ARE DELETED.
059800*
059900*    CREATE A SHORT RECORD USING THE BASIC WRITE STATEMENT
060000*
060100 SEQ-INIT-02.
060200     MOVE    1 TO REC-CT.
060300     MOVE   "WRITE SHORT RECORD" TO FEATURE.
060400     MOVE   "SEQ-TEST-WR-02" TO PAR-NAME.
060500     ADD     1 TO XRECORD-NUMBER (1).
060600     ADD     1 TO BUFFER-COPY-RECNO.
060700     MOVE   "R1-M-G" TO XRECORD-NAME (1).
060800     MOVE    120 TO XRECORD-LENGTH (1).
060900     MOVE   "SHORT" TO BUFFER-COPY-L-OR-S.
061000     MOVE   "**" TO SQ-STATUS.
061100     IF DELETE-SW NOT EQUAL SPACE
061200         GO TO SEQ-DELETE-02.
061300     GO TO SEQ-TEST-WR-02.
061400 SEQ-DELETE-02.
061500     GO TO   SEQ-DELETE-02-01.
061600 SEQ-TEST-WR-02.
061700     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-VS6R2-FIRST.
061800     MOVE    BUFFER-COPY-SECOND TO SQ-VS6R2-SECOND.
061900     WRITE   SQ-VS6R1-M-G-120.
062000     GO TO   SEQ-TEST-WR-02-01.
062100 SEQ-DELETE-02-01.
062200     PERFORM DE-LETE.
062300     GO TO   SEQ-TEST-02-01-END.
062400 SEQ-TEST-WR-02-01.
062500     IF SQ-STATUS = "00"
062600         PERFORM PASS
062700     ELSE
062800         MOVE    SQ-STATUS TO COMPUTED-A
062900         MOVE   "00" TO CORRECT-A
063000         MOVE   "UNEXPECTED I-O STATUS FROM WRITE" TO RE-MARK
063100         MOVE   "VII-3, VII-53,4.7.4(6)" TO ANSI-REFERENCE
063200         PERFORM FAIL.
063300 SEQ-TEST-02-01-END.
063400*
063500*    CREATE A LONG RECORD USING THE BASIC WRITE STATEMENT
063600*
063700 SEQ-INIT-03.
063800     MOVE    1 TO REC-CT.
063900     MOVE   "WRITE LONG RECORD" TO FEATURE.
064000     MOVE   "SEQ-TEST-WR-03" TO PAR-NAME.
064100     ADD     1 TO XRECORD-NUMBER (1).
064200     ADD     1 TO BUFFER-COPY-RECNO.
064300     MOVE   "R2-M-G" TO XRECORD-NAME (1).
064400     MOVE    151 TO XRECORD-LENGTH (1).
064500     MOVE   "LONG" TO BUFFER-COPY-L-OR-S.
064600     MOVE   "**" TO SQ-STATUS.
064700     IF DELETE-SW NOT EQUAL SPACE
064800         GO TO SEQ-DELETE-03.
064900     GO TO SEQ-TEST-WR-03.
065000 SEQ-DELETE-03.
065100     GO TO   SEQ-DELETE-03-01.
065200 SEQ-TEST-WR-03.
065300     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-VS6R2-FIRST.
065400     MOVE    BUFFER-COPY-SECOND TO SQ-VS6R2-SECOND.
065500     WRITE   SQ-VS6R2-M-G-151.
065600     GO TO   SEQ-TEST-WR-03-01.
065700 SEQ-DELETE-03-01.
065800     PERFORM DE-LETE.
065900     GO TO   SEQ-TEST-03-01-END.
066000 SEQ-TEST-WR-03-01.
066100     IF SQ-STATUS = "00"
066200         PERFORM PASS
066300     ELSE
066400         MOVE    SQ-STATUS TO COMPUTED-A
066500         MOVE   "00" TO CORRECT-A
066600         MOVE   "UNEXPECTED I-O STATUS FROM WRITE" TO RE-MARK
066700         MOVE   "VII-3, VII-53,4.7.4(6)" TO ANSI-REFERENCE
066800         PERFORM FAIL.
066900 SEQ-TEST-03-01-END.
067000*
067100*
067200*    CREATE A SHORT RECORD USING WRITE FROM, WITH A 151
067300*    CHARACTER AREA AS THE SOURCE.
067400*
067500 SEQ-INIT-04.
067600     MOVE    1 TO REC-CT.
067700     MOVE   "WRITE SHORT RECORD FROM" TO FEATURE.
067800     MOVE   "SEQ-TEST-WR-04" TO PAR-NAME.
067900     ADD     1 TO XRECORD-NUMBER (1).
068000     ADD     1 TO BUFFER-COPY-RECNO.
068100     MOVE   "R1-M-G" TO XRECORD-NAME (1).
068200     MOVE    120 TO XRECORD-LENGTH (1).
068300     MOVE   "SHORT" TO BUFFER-COPY-L-OR-S.
068400     MOVE   "**" TO SQ-STATUS.
068500     IF DELETE-SW NOT EQUAL SPACE
068600         GO TO SEQ-DELETE-04.
068700     GO TO SEQ-TEST-WR-04.
068800 SEQ-DELETE-04.
068900     GO TO   SEQ-DELETE-04-01.
069000 SEQ-TEST-WR-04.
069100     MOVE    FILE-RECORD-INFO-P1-120 (1) TO BUFFER-COPY-120.
069200     WRITE   SQ-VS6R1-M-G-120 FROM BUFFER-COPY.
069300     GO TO   SEQ-TEST-WR-04-01.
069400 SEQ-DELETE-04-01.
069500     PERFORM DE-LETE.
069600     GO TO   SEQ-TEST-04-01-END.
069700 SEQ-TEST-WR-04-01.
069800     IF SQ-STATUS = "00"
069900         PERFORM PASS
070000     ELSE
070100         MOVE    SQ-STATUS TO COMPUTED-A
070200         MOVE   "00" TO CORRECT-A
070300         MOVE   "UNEXPECTED I-O STATUS FROM WRITE" TO RE-MARK
070400         MOVE   "VII-3, VII-53,4.7.4(6)" TO ANSI-REFERENCE
070500         PERFORM FAIL.
070600 SEQ-TEST-04-01-END.
070700*
070800*
070900*    CREATE A SHORT RECORD USING WRITE FROM, WITH A 151
071000*    CHARACTER SOURCE FIELD.
071100*
071200 SEQ-INIT-05.
071300     MOVE    1 TO REC-CT.
071400     MOVE   "WRITE SHORT RECORD FROM" TO FEATURE.
071500     MOVE   "SEQ-TEST-WR-05" TO PAR-NAME.
071600     ADD     1 TO XRECORD-NUMBER (1).
071700     ADD     1 TO BUFFER-COPY-RECNO.
071800     MOVE   "R1-M-G" TO XRECORD-NAME (1).
071900     MOVE    120 TO XRECORD-LENGTH (1).
072000     MOVE   "SHORT" TO BUFFER-COPY-L-OR-S.
072100     MOVE   "**" TO SQ-STATUS.
072200     IF DELETE-SW-1 NOT EQUAL SPACE
072300         GO TO SEQ-DELETE-05.
072400     GO TO SEQ-TEST-WR-05.
072500 SEQ-DELETE-05.
072600     GO TO   SEQ-DELETE-05-01.
072700 SEQ-TEST-WR-05.
072800     MOVE    FILE-RECORD-INFO-P1-120 (1) TO BUFFER-COPY-120.
072900     WRITE   SQ-VS6R1-M-G-120 FROM BUFFER-COPY.
073000     GO TO   SEQ-TEST-WR-05-01.
073100 SEQ-DELETE-05-01.
073200     PERFORM DE-LETE.
073300     GO TO   SEQ-TEST-05-01-END.
073400 SEQ-TEST-WR-05-01.
073500     IF SQ-STATUS = "00"
073600         PERFORM PASS
073700     ELSE
073800         MOVE    SQ-STATUS TO COMPUTED-A
073900         MOVE   "00" TO CORRECT-A
074000         MOVE   "UNEXPECTED I-O STATUS FROM WRITE" TO RE-MARK
074100         MOVE   "VII-3, VII-53,4.7.4(6)" TO ANSI-REFERENCE
074200         PERFORM FAIL.
074300 SEQ-TEST-05-01-END.
074400*
074500*
074600*    CREATE A LONG RECORD USING WRITE FROM.
074700*
074800 SEQ-INIT-06.
074900     MOVE    1 TO REC-CT.
075000     MOVE   "WRITE LONG RECORD FROM" TO FEATURE.
075100     MOVE   "SEQ-TEST-WR-06" TO PAR-NAME.
075200     ADD     1 TO XRECORD-NUMBER (1).
075300     ADD     1 TO BUFFER-COPY-RECNO.
075400     MOVE   "R2-M-G" TO XRECORD-NAME (1).
075500     MOVE    151 TO XRECORD-LENGTH (1).
075600     MOVE   "LONG" TO BUFFER-COPY-L-OR-S.
075700     MOVE   "**" TO SQ-STATUS.
075800     IF DELETE-SW NOT EQUAL SPACE
075900         GO TO SEQ-DELETE-06.
076000     GO TO SEQ-TEST-WR-06.
076100 SEQ-DELETE-06.
076200     GO TO   SEQ-DELETE-06-01.
076300 SEQ-TEST-WR-06.
076400     MOVE    FILE-RECORD-INFO-P1-120 (1) TO BUFFER-COPY-120.
076500     WRITE   SQ-VS6R2-M-G-151 FROM BUFFER-COPY.
076600     GO TO   SEQ-TEST-WR-06-01.
076700 SEQ-DELETE-06-01.
076800     PERFORM DE-LETE.
076900     GO TO   SEQ-TEST-06-01-END.
077000 SEQ-TEST-WR-06-01.
077100     IF SQ-STATUS = "00"
077200         PERFORM PASS
077300     ELSE
077400         MOVE    SQ-STATUS TO COMPUTED-A
077500         MOVE   "00" TO CORRECT-A
077600         MOVE   "UNEXPECTED I-O STATUS FROM WRITE" TO RE-MARK
077700         MOVE   "VII-3, VII-53,4.7.4(6)" TO ANSI-REFERENCE
077800         PERFORM FAIL.
077900 SEQ-TEST-06-01-END.
078000*
078100*
078200*    CREATE A SHORT RECORD USING WRITE FROM, WITH A 151
078300*    CHARACTER AREA AS THE SOURCE.
078400*
078500 SEQ-INIT-07.
078600     MOVE    1 TO REC-CT.
078700     MOVE   "WRITE SHORT RECORD FROM" TO FEATURE.
078800     MOVE   "SEQ-TEST-WR-07" TO PAR-NAME.
078900     ADD     1 TO XRECORD-NUMBER (1).
079000     ADD     1 TO BUFFER-COPY-RECNO.
079100     MOVE   "R1-M-G" TO XRECORD-NAME (1).
079200     MOVE    120 TO XRECORD-LENGTH (1).
079300     MOVE   "SHORT" TO BUFFER-COPY-L-OR-S.
079400     MOVE   "**" TO SQ-STATUS.
079500     IF DELETE-SW NOT EQUAL SPACE
079600         GO TO SEQ-DELETE-07.
079700     GO TO SEQ-TEST-WR-07.
079800 SEQ-DELETE-07.
079900     GO TO   SEQ-DELETE-07-01.
080000 SEQ-TEST-WR-07.
080100     MOVE    FILE-RECORD-INFO-P1-120 (1) TO BUFFER-COPY-120.
080200     WRITE   SQ-VS6R1-M-G-120 FROM BUFFER-COPY.
080300     GO TO   SEQ-TEST-WR-07-01.
080400 SEQ-DELETE-07-01.
080500     PERFORM DE-LETE.
080600     GO TO   SEQ-TEST-07-01-END.
080700 SEQ-TEST-WR-07-01.
080800     IF SQ-STATUS = "00"
080900         PERFORM PASS
081000     ELSE
081100         MOVE    SQ-STATUS TO COMPUTED-A
081200         MOVE   "00" TO CORRECT-A
081300         MOVE   "UNEXPECTED I-O STATUS FROM WRITE" TO RE-MARK
081400         MOVE   "VII-3, VII-53,4.7.4(6)" TO ANSI-REFERENCE
081500         PERFORM FAIL.
081600 SEQ-TEST-07-01-END.
081700*
081800*
081900*    CREATE A LONG RECORD USING WRITE FROM, USING A 151
082000*    CHARACTER SOURCE AREA.
082100*
082200 SEQ-INIT-08.
082300     MOVE    1 TO REC-CT.
082400     MOVE   "WRITE LONG RECORD FROM" TO FEATURE.
082500     MOVE   "SEQ-TEST-WR-08" TO PAR-NAME.
082600     ADD     1 TO XRECORD-NUMBER (1).
082700     ADD     1 TO BUFFER-COPY-RECNO.
082800     MOVE   "R2-M-G" TO XRECORD-NAME (1).
082900     MOVE    151 TO XRECORD-LENGTH (1).
083000     MOVE   "LONG" TO BUFFER-COPY-L-OR-S.
083100     MOVE   "**" TO SQ-STATUS.
083200     IF DELETE-SW NOT EQUAL SPACE
083300         GO TO SEQ-DELETE-08.
083400     GO TO SEQ-TEST-WR-08.
083500 SEQ-DELETE-08.
083600     GO TO   SEQ-DELETE-08-01.
083700 SEQ-TEST-WR-08.
083800     MOVE    FILE-RECORD-INFO-P1-120 (1) TO BUFFER-COPY-120.
083900     WRITE   SQ-VS6R2-M-G-151 FROM BUFFER-COPY.
084000     GO TO   SEQ-TEST-WR-08-01.
084100 SEQ-DELETE-08-01.
084200     PERFORM DE-LETE.
084300     GO TO   SEQ-TEST-08-01-END.
084400 SEQ-TEST-WR-08-01.
084500     IF SQ-STATUS = "00"
084600         PERFORM PASS
084700     ELSE
084800         MOVE    SQ-STATUS TO COMPUTED-A
084900         MOVE   "00" TO CORRECT-A
085000         MOVE   "UNEXPECTED I-O STATUS FROM WRITE" TO RE-MARK
085100         MOVE   "VII-3, VII-53,4.7.4(6)" TO ANSI-REFERENCE
085200         PERFORM FAIL.
085300 SEQ-TEST-08-01-END.
085400*
085500*
085600*    CREATE A LONG RECORD USING WRITE FROM, USING A 151
085700*    CHARACTER SOURCE AREA.
085800*
085900 SEQ-INIT-09.
086000     MOVE    1 TO REC-CT.
086100     MOVE   "WRITE LONG RECORD FROM" TO FEATURE.
086200     MOVE   "SEQ-TEST-WR-09" TO PAR-NAME.
086300     ADD     1 TO XRECORD-NUMBER (1).
086400     ADD     1 TO BUFFER-COPY-RECNO.
086500     MOVE   "R2-M-G" TO XRECORD-NAME (1).
086600     MOVE    151 TO XRECORD-LENGTH (1).
086700     MOVE   "LONG" TO BUFFER-COPY-L-OR-S.
086800     MOVE   "**" TO SQ-STATUS.
086900     IF DELETE-SW NOT EQUAL SPACE
087000         GO TO SEQ-DELETE-09.
087100     GO TO SEQ-TEST-WR-09.
087200 SEQ-DELETE-09.
087300     GO TO   SEQ-DELETE-09-01.
087400 SEQ-TEST-WR-09.
087500     MOVE    FILE-RECORD-INFO-P1-120 (1) TO BUFFER-COPY-120.
087600     WRITE   SQ-VS6R2-M-G-151 FROM BUFFER-COPY.
087700     GO TO   SEQ-TEST-WR-09-01.
087800 SEQ-DELETE-09-01.
087900     PERFORM DE-LETE.
088000     GO TO   SEQ-TEST-09-01-END.
088100 SEQ-TEST-WR-09-01.
088200     IF SQ-STATUS = "00"
088300         PERFORM PASS
088400     ELSE
088500         MOVE    SQ-STATUS TO COMPUTED-A
088600         MOVE   "00" TO CORRECT-A
088700         MOVE   "UNEXPECTED I-O STATUS FROM WRITE" TO RE-MARK
088800         MOVE   "VII-3, VII-53,4.7.4(6)" TO ANSI-REFERENCE
088900         PERFORM FAIL.
089000 SEQ-TEST-09-01-END.
089100*
089200*
089300*    CREATE A LONG RECORD USING THE BASIC WRITE STATEMENT
089400*
089500 SEQ-INIT-10.
089600     MOVE    1 TO REC-CT.
089700     MOVE   "WRITE LONG RECORD" TO FEATURE.
089800     MOVE   "SEQ-TEST-WR-10" TO PAR-NAME.
089900     ADD     1 TO XRECORD-NUMBER (1).
090000     ADD     1 TO BUFFER-COPY-RECNO.
090100     MOVE   "R2-M-G" TO XRECORD-NAME (1).
090200     MOVE    151 TO XRECORD-LENGTH (1).
090300     MOVE   "LONG" TO BUFFER-COPY-L-OR-S.
090400     MOVE   "**" TO SQ-STATUS.
090500     IF DELETE-SW NOT EQUAL SPACE
090600         GO TO SEQ-DELETE-10.
090700     GO TO SEQ-TEST-WR-10.
090800 SEQ-DELETE-10.
090900     GO TO   SEQ-DELETE-10-01.
091000 SEQ-TEST-WR-10.
091100     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-VS6R2-FIRST.
091200     MOVE    BUFFER-COPY-SECOND TO SQ-VS6R2-SECOND.
091300     WRITE   SQ-VS6R2-M-G-151.
091400     GO TO   SEQ-TEST-WR-10-01.
091500 SEQ-DELETE-10-01.
091600     PERFORM DE-LETE.
091700     GO TO   SEQ-TEST-10-01-END.
091800 SEQ-TEST-WR-10-01.
091900     IF SQ-STATUS = "00"
092000         PERFORM PASS
092100     ELSE
092200         MOVE    SQ-STATUS TO COMPUTED-A
092300         MOVE   "00" TO CORRECT-A
092400         MOVE   "UNEXPECTED I-O STATUS FROM WRITE" TO RE-MARK
092500         MOVE   "VII-3, VII-53,4.7.4(6)" TO ANSI-REFERENCE
092600         PERFORM FAIL.
092700 SEQ-TEST-10-01-END.
092800*
092900*
093000*    CREATE A SHORT RECORD USING THE BASIC WRITE STATEMENT
093100*
093200 SEQ-INIT-11.
093300     MOVE    1 TO REC-CT.
093400     MOVE   "WRITE SHORT RECORD" TO FEATURE.
093500     MOVE   "SEQ-TEST-WR-11" TO PAR-NAME.
093600     ADD     1 TO XRECORD-NUMBER (1).
093700     ADD     1 TO BUFFER-COPY-RECNO.
093800     MOVE   "R1-M-G" TO XRECORD-NAME (1).
093900     MOVE    120 TO XRECORD-LENGTH (1).
094000     MOVE   "SHORT" TO BUFFER-COPY-L-OR-S.
094100     MOVE   "**" TO SQ-STATUS.
094200     IF DELETE-SW NOT EQUAL SPACE
094300         GO TO SEQ-DELETE-11.
094400     GO TO SEQ-TEST-WR-11.
094500 SEQ-DELETE-11.
094600     GO TO   SEQ-DELETE-11-01.
094700 SEQ-TEST-WR-11.
094800     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-VS6R2-FIRST.
094900     MOVE    BUFFER-COPY-SECOND TO SQ-VS6R2-SECOND.
095000     WRITE   SQ-VS6R1-M-G-120.
095100     GO TO   SEQ-TEST-WR-11-01.
095200 SEQ-DELETE-11-01.
095300     PERFORM DE-LETE.
095400     GO TO   SEQ-TEST-11-01-END.
095500 SEQ-TEST-WR-11-01.
095600     IF SQ-STATUS = "00"
095700         PERFORM PASS
095800     ELSE
095900         MOVE    SQ-STATUS TO COMPUTED-A
096000         MOVE   "00" TO CORRECT-A
096100         MOVE   "UNEXPECTED I-O STATUS FROM WRITE" TO RE-MARK
096200         MOVE   "VII-3, VII-53,4.7.4(6)" TO ANSI-REFERENCE
096300         PERFORM FAIL.
096400 SEQ-TEST-11-01-END.
096500*
096600*    CREATE A SHORT RECORD USING THE BASIC WRITE STATEMENT
096700*
096800 SEQ-INIT-12.
096900     MOVE    1 TO REC-CT.
097000     MOVE   "WRITE SHORT RECORD" TO FEATURE.
097100     MOVE   "SEQ-TEST-WR-12" TO PAR-NAME.
097200     ADD     1 TO XRECORD-NUMBER (1).
097300     ADD     1 TO BUFFER-COPY-RECNO.
097400     MOVE   "R1-M-G" TO XRECORD-NAME (1).
097500     MOVE    120 TO XRECORD-LENGTH (1).
097600     MOVE   "SHORT" TO BUFFER-COPY-L-OR-S.
097700     MOVE   "**" TO SQ-STATUS.
097800     IF DELETE-SW NOT EQUAL SPACE
097900         GO TO SEQ-DELETE-12.
098000     GO TO SEQ-TEST-WR-12.
098100 SEQ-DELETE-12.
098200     GO TO   SEQ-DELETE-12-01.
098300 SEQ-TEST-WR-12.
098400     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-VS6R2-FIRST.
098500     MOVE    BUFFER-COPY-SECOND TO SQ-VS6R2-SECOND.
098600     WRITE   SQ-VS6R1-M-G-120.
098700     GO TO   SEQ-TEST-WR-12-01.
098800 SEQ-DELETE-12-01.
098900     PERFORM DE-LETE.
099000     GO TO   SEQ-TEST-12-01-END.
099100 SEQ-TEST-WR-12-01.
099200     IF SQ-STATUS = "00"
099300         PERFORM PASS
099400     ELSE
099500         MOVE    SQ-STATUS TO COMPUTED-A
099600         MOVE   "00" TO CORRECT-A
099700         MOVE   "UNEXPECTED I-O STATUS FROM WRITE" TO RE-MARK
099800         MOVE   "VII-3, VII-53,4.7.4(6)" TO ANSI-REFERENCE
099900         PERFORM FAIL.
100000 SEQ-TEST-12-01-END.
100100*
100200*
100300*    ALL REQUIRED RECORDS HAVE BEEN WRITTEN, SO THE FILE
100400*    CAN BE CLOSED.
100500*
100600 SEQ-INIT-13.
100700     MOVE    1 TO REC-CT.
100800     MOVE   "CLOSE NEW FILE" TO FEATURE.
100900     MOVE   "SEQ-TEST-WR-13" TO PAR-NAME.
101000     MOVE   "**" TO SQ-STATUS.
101100     IF DELETE-SW NOT EQUAL SPACE
101200         GO TO SEQ-DELETE-13.
101300     GO TO SEQ-TEST-WR-13.
101400 SEQ-DELETE-13.
101500     GO TO   SEQ-DELETE-13-01.
101600 SEQ-TEST-WR-13.
101700     CLOSE   SQ-VS6.
101800     GO TO   SEQ-TEST-WR-13-01.
101900 SEQ-DELETE-13-01.
102000     PERFORM DE-LETE.
102100     GO TO   SEQ-TEST-13-01-END.
102200 SEQ-TEST-WR-13-01.
102300     IF SQ-STATUS = "00"
102400         PERFORM PASS
102500     ELSE
102600         MOVE    SQ-STATUS TO COMPUTED-A
102700         MOVE   "00" TO CORRECT-A
102800         MOVE   "UNEXPECTED I-O STATUS FROM CLOSE" TO RE-MARK
102900         MOVE   "VII-3, VII-38,4.2.4(4)" TO ANSI-REFERENCE
103000         PERFORM FAIL.
103100 SEQ-TEST-13-01-END.
103200*
103300*
103400*    A SEQUENTIAL TAPE FILE CONTAINING 11 RECORDS HAS BEEN
103500*    CREATED.  THE FILE CONTAINS RECORDS OF 120 CHARACTERS AND
103600*    RECORDS OF 151 CHARACTERS.  THE SEQUENCE IN WHICH THE
103700*    RECORDS WERE WRITTEN IS SLSSLSLLLSS.  THE NEXT GROUP OF
103800*    OPENS THE FILE FOR INPUT AND READS IT, USING TWELVE
103900*    DIFFERENT FORMATS OF THE READ STATEMENT.  DELETION OF THIS
104000*    TEST CAUSES DELETION OF ALL SUBSEQUENT TESTS.
104100*
104200*
104300 SEQ-INIT-14.
104400     MOVE   "**"  TO SQ-STATUS.
104500     MOVE   "OPEN FILE FOR INPUT" TO FEATURE.
104600     MOVE   "SEQ-TEST-GF-14" TO PAR-NAME.
104700     IF DELETE-SW NOT = SPACE
104800         GO TO SEQ-DELETE-14.
104900     GO TO   SEQ-TEST-GF-14.
105000 SEQ-DELETE-14.
105100     MOVE   "*" TO DELETE-SW-1.
105200     GO TO   SEQ-DELETE-14-01.
105300 SEQ-TEST-GF-14.
105400     OPEN INPUT SQ-VS6.
105500     GO TO   SEQ-TEST-GF-14-01.
105600 SEQ-DELETE-14-01.
105700     PERFORM DE-LETE.
105800     GO TO   SEQ-TEST-14-01-END.
105900 SEQ-TEST-GF-14-01.
106000     IF SQ-STATUS = "00"
106100         PERFORM PASS
106200     ELSE
106300         MOVE    SQ-STATUS TO COMPUTED-A
106400         MOVE   "00" TO CORRECT-A
106500         MOVE   "UNEXPECTED I-O STATUS FROM OPEN" TO RE-MARK
106600         MOVE   "VII-2, VII-39" TO ANSI-REFERENCE
106700         PERFORM FAIL
106800         MOVE   "*" TO DELETE-SW-1.
106900 SEQ-TEST-14-01-END.
107000*
107100*
107200*    UNLESS AN ERROR OCCURRED DURING EXECUTION OF THE OPEN
107300*    STATEMENT, THE FILE IS NOW OPEN, AND READY FOR RECORDS TO
107400*    BE WRITTEN TO IT.  IF AN ERROR I-O STATUS VALUE WAS
107500*    RETURNED, ALL THE REMAINING TESTS ARE DELETED.
107600*
107700*    READ A SHORT RECORD, USING READ ... AT END
107800*
107900 SEQ-INIT-15.
108000     MOVE    1 TO REC-CT.
108100     MOVE    1 TO XRECORD-NUMBER (1).
108200     MOVE   "**********" TO SQ-VS6R2-SECOND-L.
108300     MOVE   "SHORT" TO BUFFER-COPY-L-OR-S.
108400     MOVE    1 TO BUFFER-COPY-RECNO.
108500     MOVE   "**" TO SQ-STATUS.
108600     MOVE   "NOT EXECUTED"  TO EOF-FLAG.
108700     MOVE   "READ SHORT AT END" TO FEATURE.
108800     MOVE   "SEQ-TEST-RD-15" TO PAR-NAME.
108900     IF DELETE-SW NOT = SPACE
109000         GO TO   SEQ-DELETE-15.
109100     GO TO   SEQ-TEST-RD-15.
109200 SEQ-DELETE-15.
109300     MOVE   "*" TO DELETE-SW-3.
109400     GO TO   SEQ-DELETE-15-01.
109500*
109600*    EXECUTE THE READ STATEMENT
109700*
109800 SEQ-TEST-RD-15.
109900     READ    SQ-VS6 AT END
110000                MOVE    "EXECUTED" TO EOF-FLAG.
110100     MOVE    SQ-VS6R1-M-G-120 TO FILE-RECORD-INFO-P1-120 (2).
110200     GO TO   SEQ-TEST-RD-15-01.
110300*
110400*    CHECK THE FILE STATUS VALUE
110500*
110600 SEQ-DELETE-15-01.
110700     PERFORM DE-LETE.
110800     GO TO   SEQ-TEST-15-01-END.
110900 SEQ-TEST-RD-15-01.
111000     IF SQ-STATUS = "00"
111100         PERFORM PASS
111200     ELSE
111300         MOVE    SQ-STATUS TO COMPUTED-A
111400         MOVE   "00" TO CORRECT-A
111500         MOVE   "UNEXPECTED I-O STATUS ON READ" TO RE-MARK
111600         MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
111700         PERFORM FAIL.
111800 SEQ-TEST-15-01-END.
111900*
112000*    CHECK THE RECORD NUMBER OF THE RECORD READ
112100*
112200     ADD     1 TO REC-CT.
112300     IF DELETE-SW NOT EQUAL SPACE
112400         GO TO   SEQ-DELETE-15-02.
112500     GO TO   SEQ-TEST-RD-15-02.
112600 SEQ-DELETE-15-02.
112700     PERFORM DE-LETE.
112800     GO TO   SEQ-TEST-15-02-END.
112900 SEQ-TEST-RD-15-02.
113000     IF XRECORD-NUMBER (1) = XRECORD-NUMBER (2)
113100         PERFORM PASS
113200     ELSE
113300         MOVE    XRECORD-NUMBER (2) TO COMPUTED-A
113400         MOVE    XRECORD-NUMBER (1) TO CORRECT-A
113500         MOVE   "UNEXPECTED RECORD RETURNED" TO RE-MARK
113600         PERFORM FAIL.
113700 SEQ-TEST-15-02-END.
113800*
113900*    CHECK THE EXTENDED PART OF THE RECORD
114000*
114100     ADD     1 TO REC-CT.
114200*    IF DELETE-SW NOT = TO SPACE
114300*        GO TO SEQ-DELETE-15-03.
114400*    GO TO   SEQ-TEST-RD-15-03.
114500 SEQ-DELETE-15-03.
114600     PERFORM DE-LETE.
114700     GO TO   SEQ-TEST-15-03-END.
114800 SEQ-TEST-RD-15-03.
114900     IF SQ-VS6R2-SECOND-L NOT = BUFFER-COPY-SECOND-L
115000         PERFORM PASS
115100     ELSE
115200         MOVE    SQ-VS6R2-SECOND-L TO COMPUTED-A
115300         MOVE   "**UNDEFINED**" TO CORRECT-A
115400         MOVE   "BUFFER CONTENTS FOR LONG RECORD" TO RE-MARK
115500         PERFORM FAIL.
115600 SEQ-TEST-15-03-END.
115700*
115800*    CHECK EXECUTION OF THE END PATH
115900*
116000     ADD     1 TO REC-CT.
116100     IF DELETE-SW NOT = SPACE
116200         GO TO   SEQ-DELETE-15-04.
116300     GO TO   SEQ-TEST-RD-15-04.
116400 SEQ-DELETE-15-04.
116500     PERFORM DE-LETE.
116600     GO TO   SEQ-TEST-15-04-END.
116700 SEQ-TEST-RD-15-04.
116800     IF EOF-FLAG = "NOT EXECUTED"
116900         PERFORM PASS
117000     ELSE
117100         MOVE    EOF-FLAG TO COMPUTED-A
117200         MOVE   "NOT EXECUTED" TO CORRECT-A
117300         MOVE   "AT END BRANCH TAKEN BEFORE EOF" TO RE-MARK
117400         MOVE   "V11-46, 4.4.4(10)" TO ANSI-REFERENCE
117500         MOVE   "*" TO DELETE-SW-2
117600         PERFORM FAIL.
117700 SEQ-TEST-15-04-END.
117800     MOVE    SPACE TO DELETE-SW-3.
117900*
118000*
118100*    READ A LONG RECORD, USING READ ... END
118200*
118300 SEQ-INIT-16.
118400     MOVE    1 TO REC-CT.
118500     ADD     1 TO XRECORD-NUMBER (1).
118600     MOVE   "**********" TO SQ-VS6R2-SECOND-L.
118700     MOVE   "LONG"  TO BUFFER-COPY-L-OR-S.
118800     ADD     1 TO BUFFER-COPY-RECNO.
118900     MOVE   "**" TO SQ-STATUS.
119000     MOVE   "NOT EXECUTED"  TO EOF-FLAG.
119100     MOVE   "READ LONG END" TO FEATURE.
119200     MOVE   "SEQ-TEST-RD-16" TO PAR-NAME.
119300     IF DELETE-SW NOT = SPACE
119400         GO TO   SEQ-DELETE-16.
119500     GO TO   SEQ-TEST-RD-16.
119600  SEQ-DELETE-16.
119700     MOVE   "*" TO DELETE-SW-3.
119800     GO TO   SEQ-DELETE-16-01.
119900*
120000*   EXECUTE THE READ STATEMENT
120100*
120200 SEQ-TEST-RD-16.
120300     READ    SQ-VS6 END
120400                MOVE   "EXECUTED" TO EOF-FLAG.
120500     MOVE    SQ-VS6R1-M-G-120 TO FILE-RECORD-INFO-P1-120 (2).
120600     GO TO   SEQ-TEST-RD-16-01.
120700 SEQ-DELETE-16-01.
120800     PERFORM DE-LETE.
120900     GO TO   SEQ-TEST-16-01-END.
121000*
121100*   CHECK THE FILE STATUS RETURNED
121200*
121300 SEQ-TEST-RD-16-01.
121400     IF SQ-STATUS = "00"
121500         PERFORM PASS
121600     ELSE
121700         MOVE    SQ-STATUS TO COMPUTED-A
121800         MOVE   "00" TO CORRECT-A
121900         MOVE   "UNEXPECTED I-O STATUS ON READ" TO RE-MARK
122000         MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
122100         PERFORM FAIL.
122200 SEQ-TEST-16-01-END.
122300*
122400*    CHECK THE IDENTITY OF THE RECORD RETURNED
122500*
122600     ADD     1 TO REC-CT.
122700     IF DELETE-SW NOT EQUAL SPACE
122800         GO TO   SEQ-DELETE-16-02.
122900     GO TO   SEQ-TEST-RD-16-02.
123000 SEQ-DELETE-16-02.
123100     PERFORM DE-LETE.
123200     GO TO   SEQ-TEST-16-02-END.
123300 SEQ-TEST-RD-16-02.
123400     IF XRECORD-NUMBER (1) = XRECORD-NUMBER (2)
123500         PERFORM PASS
123600     ELSE
123700         MOVE    XRECORD-NUMBER (2) TO COMPUTED-A
123800         MOVE    XRECORD-NUMBER (1) TO CORRECT-A
123900         MOVE   "UNEXPECTED RECORD RETURNED" TO RE-MARK
124000         PERFORM FAIL.
124100 SEQ-TEST-16-02-END.
124200*
124300*    CHECK THE RECORD EXTENSION AREA
124400*
124500     ADD     1 TO REC-CT.
124600     IF DELETE-SW NOT EQUAL TO SPACE
124700         GO TO SEQ-DELETE-16-03.
124800     GO TO   SEQ-TEST-RD-16-03.
124900 SEQ-DELETE-16-03.
125000     PERFORM DE-LETE.
125100     GO TO   SEQ-TEST-16-03-END.
125200 SEQ-TEST-RD-16-03.
125300     IF SQ-VS6R2-SECOND-L = BUFFER-COPY-SECOND-L
125400         PERFORM PASS
125500     ELSE
125600         MOVE SQ-VS6R2-SECOND-L TO COMPUTED-A
125700         MOVE    BUFFER-COPY-SECOND-L TO CORRECT-A
125800         MOVE   "INCORRECT VALUE IN BUFFER EXTENSION" TO RE-MARK
125900         PERFORM FAIL.
126000 SEQ-TEST-16-03-END.
126100*
126200*    CHECK EXECUTION OF THE END PHRASE
126300*
126400     ADD     1 TO REC-CT.
126500     IF DELETE-SW NOT = SPACE
126600         GO TO   SEQ-DELETE-16-04.
126700     GO TO   SEQ-TEST-RD-16-04.
126800 SEQ-DELETE-16-04.
126900     PERFORM DE-LETE.
127000     GO TO   SEQ-TEST-16-04-END.
127100 SEQ-TEST-RD-16-04.
127200     IF EOF-FLAG = "NOT EXECUTED"
127300         PERFORM PASS
127400     ELSE
127500         MOVE    EOF-FLAG TO COMPUTED-A
127600         MOVE   "NOT EXECUTED" TO CORRECT-A
127700         MOVE   "AT END BRANCH TAKEN BEFORE EOF" TO RE-MARK
127800         MOVE   "V11-46,4.4.4(10)" TO ANSI-REFERENCE
127900         MOVE   "*" TO DELETE-SW-2
128000         PERFORM FAIL.
128100 SEQ-TEST-16-04-END.
128200     MOVE    SPACE TO DELETE-SW-3.
128300*
128400*
128500*    READ A SHORT RECORD, USING READ ... AT END ... NOT AT END
128600*
128700 SEQ-INIT-17.
128800     MOVE    1 TO REC-CT.
128900     ADD     1 TO XRECORD-NUMBER (1).
129000     MOVE   "**********" TO SQ-VS6R2-SECOND-L.
129100     MOVE   "SHORT"  TO BUFFER-COPY-L-OR-S.
129200     ADD     1 TO BUFFER-COPY-RECNO.
129300     MOVE   "**" TO SQ-STATUS.
129400     MOVE   "NOT EXECUTED"  TO EOF-FLAG.
129500     MOVE   "NOT EXECUTED"  TO NOT-EOF-FLAG.
129600     MOVE   "READ SHORT AT END N A E" TO FEATURE.
129700     MOVE   "SEQ-TEST-RD-17" TO PAR-NAME.
129800     IF DELETE-SW NOT = SPACE
129900         GO TO   SEQ-DELETE-17.
130000     GO TO   SEQ-TEST-RD-17.
130100 SEQ-DELETE-17.
130200     MOVE   "*" TO DELETE-SW-3.
130300     GO TO   SEQ-DELETE-17-01.
130400*
130500*    EXECUTE THE READ STATEMENT
130600*
130700 SEQ-TEST-RD-17.
130800     READ    SQ-VS6
130900        AT END
131000                MOVE   "EXECUTED" TO EOF-FLAG
131100        NOT AT END
131200                MOVE   "EXECUTED" TO NOT-EOF-FLAG.
131300     MOVE    SQ-VS6R1-M-G-120 TO FILE-RECORD-INFO-P1-120 (2).
131400     GO TO   SEQ-TEST-RD-17-01.
131500*
131600*    CHECK THE FILE STATUS VALUE
131700*
131800 SEQ-DELETE-17-01.
131900     PERFORM DE-LETE.
132000     GO TO   SEQ-TEST-17-01-END.
132100 SEQ-TEST-RD-17-01.
132200     IF SQ-STATUS = "00"
132300         PERFORM PASS
132400     ELSE
132500         MOVE    SQ-STATUS TO COMPUTED-A
132600         MOVE   "00" TO CORRECT-A
132700         MOVE   "UNEXPECTED I-O STATUS ON READ" TO RE-MARK
132800         MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
132900         PERFORM FAIL.
133000 SEQ-TEST-17-01-END.
133100*
133200*    CHECK THE RECORD NUMBER OF THE RECORD READ
133300*
133400     ADD     1 TO REC-CT.
133500     IF DELETE-SW NOT EQUAL SPACE
133600         GO TO   SEQ-DELETE-17-02.
133700     GO TO   SEQ-TEST-RD-17-02.
133800 SEQ-DELETE-17-02.
133900     PERFORM DE-LETE.
134000     GO TO   SEQ-TEST-17-02-END.
134100 SEQ-TEST-RD-17-02.
134200     IF XRECORD-NUMBER (1) = XRECORD-NUMBER (2)
134300         PERFORM PASS
134400     ELSE
134500         MOVE    XRECORD-NUMBER (2) TO COMPUTED-A
134600         MOVE    XRECORD-NUMBER (1) TO CORRECT-A
134700         MOVE   "UNEXPECTED RECORD RETURNED" TO RE-MARK
134800         PERFORM FAIL.
134900 SEQ-TEST-17-02-END.
135000*
135100*    CHECK THE EXTENDED PART OF THE RECORD
135200*
135300     ADD     1 TO REC-CT.
135400*    IF DELETE-SW NOT = TO SPACE
135500*        GO TO SEQ-DELETE-17-03.
135600*    GO TO   SEQ-TEST-RD-17-03.
135700 SEQ-DELETE-17-03.
135800     PERFORM DE-LETE.
135900     GO TO   SEQ-TEST-17-03-END.
136000 SEQ-TEST-RD-17-03.
136100     IF SQ-VS6R2-SECOND-L NOT = BUFFER-COPY-SECOND-L
136200         PERFORM PASS
136300     ELSE
136400         MOVE    SQ-VS6R2-SECOND-L TO COMPUTED-A
136500         MOVE   "**UNDEFINED**" TO CORRECT-A
136600         MOVE   "BUFFER CONTENTS FOR LONG RECORD" TO RE-MARK
136700         PERFORM FAIL.
136800 SEQ-TEST-17-03-END.
136900*
137000*    CHECK EXECUTION OF THE NOT END PATH
137100*
137200     ADD     1 TO REC-CT.
137300     IF DELETE-SW NOT = SPACE
137400         GO TO   SEQ-DELETE-17-04.
137500     GO TO   SEQ-TEST-RD-17-04.
137600 SEQ-DELETE-17-04.
137700     PERFORM DE-LETE.
137800     GO TO   SEQ-TEST-17-04-END.
137900 SEQ-TEST-RD-17-04.
138000     IF NOT-EOF-FLAG = "EXECUTED"
138100         PERFORM PASS
138200     ELSE
138300         MOVE    NOT-EOF-FLAG TO COMPUTED-A
138400         MOVE   "EXECUTED" TO CORRECT-A
138500         MOVE   "NOT END PATH NOT EXECUTED" TO RE-MARK
138600         MOVE   "VII-46,4.4.4(11)" TO ANSI-REFERENCE
138700         PERFORM FAIL.
138800 SEQ-TEST-17-04-END.
138900*
139000*    CHECK EXECUTION OF THE END PATH
139100*
139200     ADD     1 TO REC-CT.
139300     IF DELETE-SW NOT = SPACE
139400         GO TO   SEQ-DELETE-17-05.
139500     GO TO   SEQ-TEST-RD-17-05.
139600 SEQ-DELETE-17-05.
139700     PERFORM DE-LETE.
139800     GO TO   SEQ-TEST-17-05-END.
139900 SEQ-TEST-RD-17-05.
140000     IF EOF-FLAG = "NOT EXECUTED"
140100         PERFORM PASS
140200     ELSE
140300         MOVE    EOF-FLAG TO COMPUTED-A
140400         MOVE   "NOT EXECUTED" TO CORRECT-A
140500         MOVE   "AT END BRANCH TAKEN BEFORE EOF" TO RE-MARK
140600         MOVE   "V11-46, 4.4.4(10)" TO ANSI-REFERENCE
140700         MOVE   "*" TO DELETE-SW-2
140800         PERFORM FAIL.
140900 SEQ-TEST-17-05-END.
141000     MOVE    SPACE TO DELETE-SW-3.
141100*
141200*
141300*    READ A SHORT RECORD, USING READ ... END ... NOT AT END
141400*
141500 SEQ-INIT-18.
141600     MOVE    1 TO REC-CT.
141700     ADD     1 TO XRECORD-NUMBER (1).
141800     MOVE   "**********" TO SQ-VS6R2-SECOND-L.
141900     MOVE   "SHORT"  TO BUFFER-COPY-L-OR-S.
142000     ADD     1 TO BUFFER-COPY-RECNO.
142100     MOVE   "**" TO SQ-STATUS.
142200     MOVE   "NOT EXECUTED"  TO EOF-FLAG.
142300     MOVE   "NOT EXECUTED"  TO NOT-EOF-FLAG.
142400     MOVE   "READ SHORT END N A E" TO FEATURE.
142500     MOVE   "SEQ-TEST-RD-18" TO PAR-NAME.
142600     IF DELETE-SW NOT = SPACE
142700         GO TO   SEQ-DELETE-18.
142800     GO TO   SEQ-TEST-RD-18.
142900 SEQ-DELETE-18.
143000     MOVE   "*" TO DELETE-SW-3.
143100     GO TO   SEQ-DELETE-18-01.
143200*
143300*    EXECUTE THE READ STATEMENT
143400*
143500 SEQ-TEST-RD-18.
143600     READ    SQ-VS6
143700        END
143800                MOVE   "EXECUTED" TO EOF-FLAG
143900        NOT AT END
144000                MOVE   "EXECUTED" TO NOT-EOF-FLAG.
144100     MOVE    SQ-VS6R1-M-G-120 TO FILE-RECORD-INFO-P1-120 (2).
144200     GO TO   SEQ-TEST-RD-18-01.
144300*
144400*    CHECK THE FILE STATUS VALUE
144500*
144600 SEQ-DELETE-18-01.
144700     PERFORM DE-LETE.
144800     GO TO   SEQ-TEST-18-01-END.
144900 SEQ-TEST-RD-18-01.
145000     IF SQ-STATUS = "00"
145100         PERFORM PASS
145200     ELSE
145300         MOVE    SQ-STATUS TO COMPUTED-A
145400         MOVE   "00" TO CORRECT-A
145500         MOVE   "UNEXPECTED I-O STATUS ON READ" TO RE-MARK
145600         MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
145700         PERFORM FAIL.
145800 SEQ-TEST-18-01-END.
145900*
146000*    CHECK THE RECORD NUMBER OF THE RECORD READ
146100*
146200     ADD     1 TO REC-CT.
146300     IF DELETE-SW NOT EQUAL SPACE
146400         GO TO   SEQ-DELETE-18-02.
146500     GO TO   SEQ-TEST-RD-18-02.
146600 SEQ-DELETE-18-02.
146700     PERFORM DE-LETE.
146800     GO TO   SEQ-TEST-18-02-END.
146900 SEQ-TEST-RD-18-02.
147000     IF XRECORD-NUMBER (1) = XRECORD-NUMBER (2)
147100         PERFORM PASS
147200     ELSE
147300         MOVE    XRECORD-NUMBER (2) TO COMPUTED-A
147400         MOVE    XRECORD-NUMBER (1) TO CORRECT-A
147500         MOVE   "UNEXPECTED RECORD RETURNED" TO RE-MARK
147600         PERFORM FAIL.
147700 SEQ-TEST-18-02-END.
147800*
147900*    CHECK THE EXTENDED PART OF THE RECORD
148000*
148100     ADD     1 TO REC-CT.
148200*    IF DELETE-SW NOT = TO SPACE
148300*        GO TO SEQ-DELETE-18-03.
148400*    GO TO   SEQ-TEST-RD-18-03.
148500 SEQ-DELETE-18-03.
148600     PERFORM DE-LETE.
148700     GO TO   SEQ-TEST-18-03-END.
148800 SEQ-TEST-RD-18-03.
148900     IF SQ-VS6R2-SECOND-L NOT = BUFFER-COPY-SECOND-L
149000         PERFORM PASS
149100     ELSE
149200         MOVE    SQ-VS6R2-SECOND-L TO COMPUTED-A
149300         MOVE   "**UNDEFINED**" TO CORRECT-A
149400         MOVE   "BUFFER CONTENTS FOR LONG RECORD" TO RE-MARK
149500         PERFORM FAIL.
149600 SEQ-TEST-18-03-END.
149700*
149800*    CHECK EXECUTION OF THE NOT END PATH
149900*
150000     ADD     1 TO REC-CT.
150100     IF DELETE-SW NOT = SPACE
150200         GO TO   SEQ-DELETE-18-04.
150300     GO TO   SEQ-TEST-RD-18-04.
150400 SEQ-DELETE-18-04.
150500     PERFORM DE-LETE.
150600     GO TO   SEQ-TEST-18-04-END.
150700 SEQ-TEST-RD-18-04.
150800     IF NOT-EOF-FLAG = "EXECUTED"
150900         PERFORM PASS
151000     ELSE
151100         MOVE    NOT-EOF-FLAG TO COMPUTED-A
151200         MOVE   "EXECUTED" TO CORRECT-A
151300         MOVE   "NOT END PATH NOT EXECUTED" TO RE-MARK
151400         MOVE   "VII-46,4.4.4(11)" TO ANSI-REFERENCE
151500         PERFORM FAIL.
151600 SEQ-TEST-18-04-END.
151700*
151800*    CHECK EXECUTION OF THE END PATH
151900*
152000     ADD     1 TO REC-CT.
152100     IF DELETE-SW NOT = SPACE
152200         GO TO   SEQ-DELETE-18-05.
152300     GO TO   SEQ-TEST-RD-18-05.
152400 SEQ-DELETE-18-05.
152500     PERFORM DE-LETE.
152600     GO TO   SEQ-TEST-18-05-END.
152700 SEQ-TEST-RD-18-05.
152800     IF EOF-FLAG = "NOT EXECUTED"
152900         PERFORM PASS
153000     ELSE
153100         MOVE    EOF-FLAG TO COMPUTED-A
153200         MOVE   "NOT EXECUTED" TO CORRECT-A
153300         MOVE   "AT END BRANCH TAKEN BEFORE EOF" TO RE-MARK
153400         MOVE   "V11-46, 4.4.4(10)" TO ANSI-REFERENCE
153500         MOVE   "*" TO DELETE-SW-2
153600         PERFORM FAIL.
153700 SEQ-TEST-18-05-END.
153800     MOVE    SPACE TO DELETE-SW-3.
153900*
154000*
154100*    READ A LONG RECORD, USING READ ... AT END ... NOT END ...
154200*
154300 SEQ-INIT-19.
154400     MOVE    1 TO REC-CT.
154500     ADD     1 TO XRECORD-NUMBER (1).
154600     MOVE   "**********" TO SQ-VS6R2-SECOND-L.
154700     MOVE   "LONG" TO BUFFER-COPY-L-OR-S.
154800     ADD     1 TO BUFFER-COPY-RECNO.
154900     MOVE   "**" TO SQ-STATUS.
155000     MOVE   "NOT EXECUTED"  TO EOF-FLAG.
155100     MOVE   "NOT EXECUTED"  TO NOT-EOF-FLAG.
155200     MOVE   "READ LONG AT END NOT END" TO FEATURE.
155300     MOVE   "SEQ-TEST-RD-19" TO PAR-NAME.
155400     IF DELETE-SW NOT = SPACE
155500         GO TO   SEQ-DELETE-19.
155600     GO TO   SEQ-TEST-RD-19.
155700 SEQ-DELETE-19.
155800     MOVE   "*" TO DELETE-SW-3.
155900     GO TO   SEQ-DELETE-19-01.
156000*
156100*   EXECUTE THE READ STATEMENT
156200*
156300 SEQ-TEST-RD-19.
156400     READ    SQ-VS6
156500        AT END
156600                MOVE   "EXECUTED" TO EOF-FLAG
156700        NOT END
156800                MOVE   "EXECUTED" TO NOT-EOF-FLAG.
156900     MOVE    SQ-VS6R1-M-G-120 TO FILE-RECORD-INFO-P1-120 (2).
157000     GO TO   SEQ-TEST-RD-19-01.
157100 SEQ-DELETE-19-01.
157200     PERFORM DE-LETE.
157300     GO TO   SEQ-TEST-19-01-END.
157400*
157500*   CHECK THE FILE STATUS RETURNED
157600*
157700 SEQ-TEST-RD-19-01.
157800     IF SQ-STATUS = "00"
157900         PERFORM PASS
158000     ELSE
158100         MOVE    SQ-STATUS TO COMPUTED-A
158200         MOVE   "00" TO CORRECT-A
158300         MOVE   "UNEXPECTED I-O STATUS ON READ" TO RE-MARK
158400         MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
158500         PERFORM FAIL.
158600 SEQ-TEST-19-01-END.
158700*
158800*    CHECK THE IDENTITY OF THE RECORD RETURNED
158900*
159000     ADD     1 TO REC-CT.
159100     IF DELETE-SW NOT EQUAL SPACE
159200         GO TO   SEQ-DELETE-19-02.
159300     GO TO   SEQ-TEST-RD-19-02.
159400 SEQ-DELETE-19-02.
159500     PERFORM DE-LETE.
159600     GO TO   SEQ-TEST-19-02-END.
159700 SEQ-TEST-RD-19-02.
159800     IF XRECORD-NUMBER (1) = XRECORD-NUMBER (2)
159900         PERFORM PASS
160000     ELSE
160100         MOVE    XRECORD-NUMBER (2) TO COMPUTED-A
160200         MOVE    XRECORD-NUMBER (1) TO CORRECT-A
160300         MOVE   "UNEXPECTED RECORD RETURNED" TO RE-MARK
160400         PERFORM FAIL.
160500 SEQ-TEST-19-02-END.
160600*
160700*    CHECK THE RECORD EXTENSION AREA
160800*
160900     ADD     1 TO REC-CT.
161000     IF DELETE-SW NOT EQUAL TO SPACE
161100         GO TO SEQ-DELETE-19-03.
161200     GO TO   SEQ-TEST-RD-19-03.
161300 SEQ-DELETE-19-03.
161400     PERFORM DE-LETE.
161500     GO TO   SEQ-TEST-19-03-END.
161600 SEQ-TEST-RD-19-03.
161700     IF SQ-VS6R2-SECOND-L = BUFFER-COPY-SECOND-L
161800         PERFORM PASS
161900     ELSE
162000         MOVE    SQ-VS6R2-SECOND-L TO COMPUTED-A
162100         MOVE    BUFFER-COPY-SECOND-L TO CORRECT-A
162200         MOVE   "INCORRECT VALUE IN BUFFER EXTENSION" TO RE-MARK
162300         PERFORM FAIL.
162400 SEQ-TEST-19-03-END.
162500*
162600*    CHECK EXECUTION OF THE NOT END PATH
162700*
162800     ADD     1 TO REC-CT.
162900     IF DELETE-SW NOT = SPACE
163000         GO TO   SEQ-DELETE-19-04.
163100     GO TO   SEQ-TEST-RD-19-04.
163200 SEQ-DELETE-19-04.
163300     PERFORM DE-LETE.
163400     GO TO   SEQ-TEST-19-04-END.
163500 SEQ-TEST-RD-19-04.
163600     IF NOT-EOF-FLAG = "EXECUTED"
163700         PERFORM PASS
163800     ELSE
163900         MOVE    NOT-EOF-FLAG TO COMPUTED-A
164000         MOVE   "EXECUTED" TO CORRECT-A
164100         MOVE   "NOT END PATH NOT EXECUTED" TO RE-MARK
164200         MOVE   "VII-46,4.4.4(11)" TO ANSI-REFERENCE
164300         PERFORM FAIL.
164400 SEQ-TEST-19-04-END.
164500*
164600*    CHECK EXECUTION OF THE END PHRASE
164700*
164800     ADD     1 TO REC-CT.
164900     IF DELETE-SW NOT = SPACE
165000         GO TO   SEQ-DELETE-19-05.
165100     GO TO   SEQ-TEST-RD-19-05.
165200 SEQ-DELETE-19-05.
165300     PERFORM DE-LETE.
165400     GO TO   SEQ-TEST-19-05-END.
165500 SEQ-TEST-RD-19-05.
165600     IF EOF-FLAG = "NOT EXECUTED"
165700         PERFORM PASS
165800     ELSE
165900         MOVE    EOF-FLAG TO COMPUTED-A
166000         MOVE   "NOT EXECUTED" TO CORRECT-A
166100         MOVE   "AT END BRANCH TAKEN BEFORE EOF" TO RE-MARK
166200         MOVE   "V11-46,4.4.4(10)" TO ANSI-REFERENCE
166300         MOVE   "*" TO DELETE-SW-2
166400         PERFORM FAIL.
166500 SEQ-TEST-19-05-END.
166600     MOVE    SPACE TO DELETE-SW-3.
166700*
166800*
166900*    READ A SHORT RECORD, USING READ ... END ... NOT END
167000*
167100 SEQ-INIT-20.
167200     MOVE    1 TO REC-CT.
167300     ADD     1 TO XRECORD-NUMBER (1).
167400     MOVE   "**********" TO SQ-VS6R2-SECOND-L.
167500     MOVE   "SHORT" TO BUFFER-COPY-L-OR-S.
167600     ADD     1 TO BUFFER-COPY-RECNO.
167700     MOVE   "**" TO SQ-STATUS.
167800     MOVE   "NOT EXECUTED"  TO EOF-FLAG.
167900     MOVE   "NOT EXECUTED"  TO NOT-EOF-FLAG.
168000     MOVE   "READ SHORT END NOT END" TO FEATURE.
168100     MOVE   "SEQ-TEST-RD-20" TO PAR-NAME.
168200     IF DELETE-SW NOT = SPACE
168300         GO TO   SEQ-DELETE-20.
168400     GO TO   SEQ-TEST-RD-20.
168500 SEQ-DELETE-20.
168600     MOVE   "*" TO DELETE-SW-3.
168700     GO TO   SEQ-DELETE-20-01.
168800*
168900*    EXECUTE THE READ STATEMENT
169000*
169100 SEQ-TEST-RD-20.
169200     READ    SQ-VS6
169300        END
169400                MOVE   "EXECUTED" TO EOF-FLAG
169500        NOT END
169600                MOVE   "EXECUTED" TO NOT-EOF-FLAG.
169700     MOVE    SQ-VS6R1-M-G-120 TO FILE-RECORD-INFO-P1-120 (2).
169800     GO TO   SEQ-TEST-RD-20-01.
169900*
170000*    CHECK THE FILE STATUS VALUE
170100*
170200 SEQ-DELETE-20-01.
170300     PERFORM DE-LETE.
170400     GO TO   SEQ-TEST-20-01-END.
170500 SEQ-TEST-RD-20-01.
170600     IF SQ-STATUS = "00"
170700         PERFORM PASS
170800     ELSE
170900         MOVE    SQ-STATUS TO COMPUTED-A
171000         MOVE   "00" TO CORRECT-A
171100         MOVE   "UNEXPECTED I-O STATUS ON READ" TO RE-MARK
171200         MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
171300         PERFORM FAIL.
171400 SEQ-TEST-20-01-END.
171500*
171600*    CHECK THE RECORD NUMBER OF THE RECORD READ
171700*
171800     ADD     1 TO REC-CT.
171900     IF DELETE-SW NOT EQUAL SPACE
172000         GO TO   SEQ-DELETE-20-02.
172100     GO TO   SEQ-TEST-RD-20-02.
172200 SEQ-DELETE-20-02.
172300     PERFORM DE-LETE.
172400     GO TO   SEQ-TEST-20-02-END.
172500 SEQ-TEST-RD-20-02.
172600     IF XRECORD-NUMBER (1) = XRECORD-NUMBER (2)
172700         PERFORM PASS
172800     ELSE
172900         MOVE    XRECORD-NUMBER (2) TO COMPUTED-A
173000         MOVE    XRECORD-NUMBER (1) TO CORRECT-A
173100         MOVE   "UNEXPECTED RECORD RETURNED" TO RE-MARK
173200         PERFORM FAIL.
173300 SEQ-TEST-20-02-END.
173400*
173500*    CHECK THE EXTENDED PART OF THE RECORD
173600*
173700     ADD     1 TO REC-CT.
173800*    IF DELETE-SW NOT = TO SPACE
173900*        GO TO SEQ-DELETE-20-03.
174000*    GO TO   SEQ-TEST-RD-20-03.
174100 SEQ-DELETE-20-03.
174200     PERFORM DE-LETE.
174300     GO TO   SEQ-TEST-20-03-END.
174400 SEQ-TEST-RD-20-03.
174500     IF SQ-VS6R2-SECOND-L NOT = BUFFER-COPY-SECOND-L
174600         PERFORM PASS
174700     ELSE
174800         MOVE    SQ-VS6R2-SECOND-L TO COMPUTED-A
174900         MOVE   "**UNDEFINED**" TO CORRECT-A
175000         MOVE   "BUFFER CONTENTS FOR LONG RECORD" TO RE-MARK
175100         PERFORM FAIL.
175200 SEQ-TEST-20-03-END.
175300*
175400*    CHECK EXECUTION OF THE NOT END PATH
175500*
175600     ADD     1 TO REC-CT.
175700     IF DELETE-SW NOT = SPACE
175800         GO TO   SEQ-DELETE-20-04.
175900     GO TO   SEQ-TEST-RD-20-04.
176000 SEQ-DELETE-20-04.
176100     PERFORM DE-LETE.
176200     GO TO   SEQ-TEST-20-04-END.
176300 SEQ-TEST-RD-20-04.
176400     IF NOT-EOF-FLAG = "EXECUTED"
176500         PERFORM PASS
176600     ELSE
176700         MOVE    NOT-EOF-FLAG TO COMPUTED-A
176800         MOVE   "EXECUTED" TO CORRECT-A
176900         MOVE   "NOT END PATH NOT EXECUTED" TO RE-MARK
177000         MOVE   "VII-46,4.4.4(11)" TO ANSI-REFERENCE
177100         PERFORM FAIL.
177200 SEQ-TEST-20-04-END.
177300*
177400*    CHECK EXECUTION OF THE END PATH
177500*
177600     ADD     1 TO REC-CT.
177700     IF DELETE-SW NOT = SPACE
177800         GO TO   SEQ-DELETE-20-05.
177900     GO TO   SEQ-TEST-RD-20-05.
178000 SEQ-DELETE-20-05.
178100     PERFORM DE-LETE.
178200     GO TO   SEQ-TEST-20-05-END.
178300 SEQ-TEST-RD-20-05.
178400     IF EOF-FLAG = "NOT EXECUTED"
178500         PERFORM PASS
178600     ELSE
178700         MOVE    EOF-FLAG TO COMPUTED-A
178800         MOVE   "NOT EXECUTED" TO CORRECT-A
178900         MOVE   "AT END BRANCH TAKEN BEFORE EOF" TO RE-MARK
179000         MOVE   "V11-46, 4.4.4(10)" TO ANSI-REFERENCE
179100         MOVE   "*" TO DELETE-SW-2
179200         PERFORM FAIL.
179300 SEQ-TEST-20-05-END.
179400     MOVE    SPACE TO DELETE-SW-3.
179500*
179600*
179700*    READ A LONG RECORD,
179800*    USING READ ... AT END ... END-READ
179900*
180000 SEQ-INIT-21.
180100     MOVE    1 TO REC-CT.
180200     ADD     1 TO XRECORD-NUMBER (1).
180300     MOVE   "**********" TO SQ-VS6R2-SECOND-L.
180400     MOVE   "LONG" TO BUFFER-COPY-L-OR-S.
180500     ADD     1 TO BUFFER-COPY-RECNO.
180600     MOVE   "**" TO SQ-STATUS.
180700     MOVE   "NOT EXECUTED"  TO EOF-FLAG.
180800     MOVE   "NOT EXECUTED"  TO NOT-EOF-FLAG.
180900     MOVE   "NOT EXECUTED"  TO END-READ-FLAG.
181000     MOVE   "READ LONG AT END END-RD" TO FEATURE.
181100     MOVE   "SEQ-TEST-RD-21" TO PAR-NAME.
181200     IF DELETE-SW NOT = SPACE
181300         GO TO   SEQ-DELETE-21.
181400     GO TO   SEQ-TEST-RD-21.
181500 SEQ-DELETE-21.
181600     MOVE   "*" TO DELETE-SW-3.
181700     GO TO   SEQ-DELETE-21-01.
181800*
181900*   EXECUTE THE READ STATEMENT
182000*
182100 SEQ-TEST-RD-21.
182200     READ    SQ-VS6
182300        AT END
182400                MOVE   "EXECUTED" TO EOF-FLAG
182500     END-READ
182600     MOVE   "EXECUTED" TO END-READ-FLAG.
182700     MOVE    SQ-VS6R1-M-G-120 TO FILE-RECORD-INFO-P1-120 (2).
182800     GO TO   SEQ-TEST-RD-21-01.
182900 SEQ-DELETE-21-01.
183000     PERFORM DE-LETE.
183100     GO TO   SEQ-TEST-21-01-END.
183200*
183300*   CHECK THE FILE STATUS RETURNED
183400*
183500 SEQ-TEST-RD-21-01.
183600     IF SQ-STATUS = "00"
183700         PERFORM PASS
183800     ELSE
183900         MOVE    SQ-STATUS TO COMPUTED-A
184000         MOVE   "00" TO CORRECT-A
184100         MOVE   "UNEXPECTED I-O STATUS ON READ" TO RE-MARK
184200         MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
184300         PERFORM FAIL.
184400 SEQ-TEST-21-01-END.
184500*
184600*    CHECK THE IDENTITY OF THE RECORD RETURNED
184700*
184800     ADD     1 TO REC-CT.
184900     IF DELETE-SW NOT EQUAL SPACE
185000         GO TO   SEQ-DELETE-21-02.
185100     GO TO   SEQ-TEST-RD-21-02.
185200 SEQ-DELETE-21-02.
185300     PERFORM DE-LETE.
185400     GO TO   SEQ-TEST-21-02-END.
185500 SEQ-TEST-RD-21-02.
185600     IF XRECORD-NUMBER (1) = XRECORD-NUMBER (2)
185700         PERFORM PASS
185800     ELSE
185900         MOVE    XRECORD-NUMBER (2) TO COMPUTED-A
186000         MOVE    XRECORD-NUMBER (1) TO CORRECT-A
186100         MOVE   "UNEXPECTED RECORD RETURNED" TO RE-MARK
186200         PERFORM FAIL.
186300 SEQ-TEST-21-02-END.
186400*
186500*    CHECK THE RECORD EXTENSION AREA
186600*
186700     ADD     1 TO REC-CT.
186800     IF DELETE-SW NOT EQUAL TO SPACE
186900         GO TO SEQ-DELETE-21-03.
187000     GO TO   SEQ-TEST-RD-21-03.
187100 SEQ-DELETE-21-03.
187200     PERFORM DE-LETE.
187300     GO TO   SEQ-TEST-21-03-END.
187400 SEQ-TEST-RD-21-03.
187500     IF SQ-VS6R2-SECOND-L = BUFFER-COPY-SECOND-L
187600         PERFORM PASS
187700     ELSE
187800         MOVE    SQ-VS6R2-SECOND-L TO COMPUTED-A
187900         MOVE    BUFFER-COPY-SECOND-L TO CORRECT-A
188000         MOVE   "INCORRECT VALUE IN BUFFER EXTENSION" TO RE-MARK
188100         PERFORM FAIL.
188200 SEQ-TEST-21-03-END.
188300*
188400*    CHECK EXECUTION OF THE STATEMENT AFTER END-READ
188500*
188600     ADD     1 TO REC-CT.
188700     IF DELETE-SW NOT = SPACE
188800         GO TO   SEQ-DELETE-21-04.
188900     GO TO   SEQ-TEST-RD-21-04.
189000 SEQ-DELETE-21-04.
189100     PERFORM DE-LETE.
189200     GO TO   SEQ-TEST-21-04-END.
189300 SEQ-TEST-RD-21-04.
189400     IF END-READ-FLAG = "EXECUTED"
189500         PERFORM PASS
189600     ELSE
189700         MOVE    END-READ-FLAG TO COMPUTED-A
189800         MOVE   "EXECUTED" TO CORRECT-A
189900         MOVE   "NOT END PATH NOT EXECUTED" TO RE-MARK
190000         MOVE   "IV-40, VII-47,4.4.4(14)" TO ANSI-REFERENCE
190100         PERFORM FAIL.
190200 SEQ-TEST-21-04-END.
190300*
190400*    CHECK EXECUTION OF THE END PHRASE
190500*
190600     ADD     1 TO REC-CT.
190700     IF DELETE-SW NOT = SPACE
190800         GO TO   SEQ-DELETE-21-05.
190900     GO TO   SEQ-TEST-RD-21-05.
191000 SEQ-DELETE-21-05.
191100     PERFORM DE-LETE.
191200     GO TO   SEQ-TEST-21-05-END.
191300 SEQ-TEST-RD-21-05.
191400     IF EOF-FLAG = "NOT EXECUTED"
191500         PERFORM PASS
191600     ELSE
191700         MOVE    EOF-FLAG TO COMPUTED-A
191800         MOVE   "NOT EXECUTED" TO CORRECT-A
191900         MOVE   "AT END BRANCH TAKEN BEFORE EOF" TO RE-MARK
192000         MOVE   "V11-46,4.4.4(10)" TO ANSI-REFERENCE
192100         MOVE   "*" TO DELETE-SW-2
192200         PERFORM FAIL.
192300 SEQ-TEST-21-05-END.
192400     MOVE    SPACE TO DELETE-SW-3.
192500*
192600*
192700*    READ A LONG RECORD,
192800*    USING READ ... END ... END-READ
192900*
193000 SEQ-INIT-22.
193100     MOVE    1 TO REC-CT.
193200     ADD     1 TO XRECORD-NUMBER (1).
193300     MOVE   "**********" TO SQ-VS6R2-SECOND-L.
193400     MOVE   "LONG" TO BUFFER-COPY-L-OR-S.
193500     ADD     1 TO BUFFER-COPY-RECNO.
193600     MOVE   "**" TO SQ-STATUS.
193700     MOVE   "NOT EXECUTED"  TO EOF-FLAG.
193800     MOVE   "NOT EXECUTED"  TO NOT-EOF-FLAG.
193900     MOVE   "NOT EXECUTED"  TO END-READ-FLAG.
194000     MOVE   "READ LONG END END-READ" TO FEATURE.
194100     MOVE   "SEQ-TEST-RD-22" TO PAR-NAME.
194200     IF DELETE-SW NOT = SPACE
194300         GO TO   SEQ-DELETE-22.
194400     GO TO   SEQ-TEST-RD-22.
194500 SEQ-DELETE-22.
194600     MOVE   "*" TO DELETE-SW-3.
194700     GO TO   SEQ-DELETE-22-01.
194800*
194900*   EXECUTE THE READ STATEMENT
195000*
195100 SEQ-TEST-RD-22.
195200     READ    SQ-VS6
195300        END
195400                MOVE   "EXECUTED" TO EOF-FLAG
195500     END-READ
195600     MOVE   "EXECUTED" TO END-READ-FLAG.
195700     MOVE    SQ-VS6R1-M-G-120 TO FILE-RECORD-INFO-P1-120 (2).
195800     GO TO   SEQ-TEST-RD-22-01.
195900 SEQ-DELETE-22-01.
196000     PERFORM DE-LETE.
196100     GO TO   SEQ-TEST-22-01-END.
196200*
196300*   CHECK THE FILE STATUS RETURNED
196400*
196500 SEQ-TEST-RD-22-01.
196600     IF SQ-STATUS = "00"
196700         PERFORM PASS
196800     ELSE
196900         MOVE    SQ-STATUS TO COMPUTED-A
197000         MOVE   "00" TO CORRECT-A
197100         MOVE   "UNEXPECTED I-O STATUS ON READ" TO RE-MARK
197200         MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
197300         PERFORM FAIL.
197400 SEQ-TEST-22-01-END.
197500*
197600*    CHECK THE IDENTITY OF THE RECORD RETURNED
197700*
197800     ADD     1 TO REC-CT.
197900     IF DELETE-SW NOT EQUAL SPACE
198000         GO TO   SEQ-DELETE-22-02.
198100     GO TO   SEQ-TEST-RD-22-02.
198200 SEQ-DELETE-22-02.
198300     PERFORM DE-LETE.
198400     GO TO   SEQ-TEST-22-02-END.
198500 SEQ-TEST-RD-22-02.
198600     IF XRECORD-NUMBER (1) = XRECORD-NUMBER (2)
198700         PERFORM PASS
198800     ELSE
198900         MOVE    XRECORD-NUMBER (2) TO COMPUTED-A
199000         MOVE    XRECORD-NUMBER (1) TO CORRECT-A
199100         MOVE   "UNEXPECTED RECORD RETURNED" TO RE-MARK
199200         PERFORM FAIL.
199300 SEQ-TEST-22-02-END.
199400*
199500*    CHECK THE RECORD EXTENSION AREA
199600*
199700     ADD     1 TO REC-CT.
199800     IF DELETE-SW NOT EQUAL TO SPACE
199900         GO TO SEQ-DELETE-22-03.
200000     GO TO   SEQ-TEST-RD-22-03.
200100 SEQ-DELETE-22-03.
200200     PERFORM DE-LETE.
200300     GO TO   SEQ-TEST-22-03-END.
200400 SEQ-TEST-RD-22-03.
200500     IF SQ-VS6R2-SECOND-L = BUFFER-COPY-SECOND-L
200600         PERFORM PASS
200700     ELSE
200800         MOVE    SQ-VS6R2-SECOND-L TO COMPUTED-A
200900         MOVE    BUFFER-COPY-SECOND-L TO CORRECT-A
201000         MOVE   "INCORRECT VALUE IN BUFFER EXTENSION" TO RE-MARK
201100         PERFORM FAIL.
201200 SEQ-TEST-22-03-END.
201300*
201400*    CHECK EXECUTION OF THE STATEMENT AFTER END-READ
201500*
201600     ADD     1 TO REC-CT.
201700     IF DELETE-SW NOT = SPACE
201800         GO TO   SEQ-DELETE-22-04.
201900     GO TO   SEQ-TEST-RD-22-04.
202000 SEQ-DELETE-22-04.
202100     PERFORM DE-LETE.
202200     GO TO   SEQ-TEST-22-04-END.
202300 SEQ-TEST-RD-22-04.
202400     IF END-READ-FLAG = "EXECUTED"
202500         PERFORM PASS
202600     ELSE
202700         MOVE    END-READ-FLAG TO COMPUTED-A
202800         MOVE   "EXECUTED" TO CORRECT-A
202900         MOVE   "NOT END PATH NOT EXECUTED" TO RE-MARK
203000         MOVE   "IV-40, VII-47,4.4.4(14)" TO ANSI-REFERENCE
203100         PERFORM FAIL.
203200 SEQ-TEST-22-04-END.
203300*
203400*    CHECK EXECUTION OF THE END PHRASE
203500*
203600     ADD     1 TO REC-CT.
203700     IF DELETE-SW NOT = SPACE
203800         GO TO   SEQ-DELETE-22-05.
203900     GO TO   SEQ-TEST-RD-22-05.
204000 SEQ-DELETE-22-05.
204100     PERFORM DE-LETE.
204200     GO TO   SEQ-TEST-22-05-END.
204300 SEQ-TEST-RD-22-05.
204400     IF EOF-FLAG = "NOT EXECUTED"
204500         PERFORM PASS
204600     ELSE
204700         MOVE    EOF-FLAG TO COMPUTED-A
204800         MOVE   "NOT EXECUTED" TO CORRECT-A
204900         MOVE   "AT END BRANCH TAKEN BEFORE EOF" TO RE-MARK
205000         MOVE   "V11-46,4.4.4(10)" TO ANSI-REFERENCE
205100         MOVE   "*" TO DELETE-SW-2
205200         PERFORM FAIL.
205300 SEQ-TEST-22-05-END.
205400     MOVE    SPACE TO DELETE-SW-3.
205500*
205600*
205700*    READ A LONG RECORD,
205800*    USING READ ... AT END ... NOT AT END ... END-READ
205900*
206000 SEQ-INIT-23.
206100     MOVE    1 TO REC-CT.
206200     ADD     1 TO XRECORD-NUMBER (1).
206300     MOVE   "**********" TO SQ-VS6R2-SECOND-L.
206400     MOVE   "LONG" TO BUFFER-COPY-L-OR-S.
206500     ADD     1 TO BUFFER-COPY-RECNO.
206600     MOVE   "**" TO SQ-STATUS.
206700     MOVE   "NOT EXECUTED"  TO EOF-FLAG.
206800     MOVE   "NOT EXECUTED"  TO NOT-EOF-FLAG.
206900     MOVE   "NOT EXECUTED"  TO END-READ-FLAG.
207000     MOVE   "READ LONG AT END NAE E-R" TO FEATURE.
207100     MOVE   "SEQ-TEST-RD-23" TO PAR-NAME.
207200     IF DELETE-SW NOT = SPACE
207300         GO TO   SEQ-DELETE-23.
207400     GO TO   SEQ-TEST-RD-23.
207500 SEQ-DELETE-23.
207600     MOVE   "*" TO DELETE-SW-3.
207700     GO TO   SEQ-DELETE-23-01.
207800*
207900*   EXECUTE THE READ STATEMENT
208000*
208100 SEQ-TEST-RD-23.
208200     READ    SQ-VS6
208300        AT END
208400                MOVE   "EXECUTED" TO EOF-FLAG
208500        NOT AT END
208600                MOVE   "EXECUTED" TO NOT-EOF-FLAG
208700     END-READ
208800     MOVE   "EXECUTED" TO END-READ-FLAG.
208900     MOVE    SQ-VS6R1-M-G-120 TO FILE-RECORD-INFO-P1-120 (2).
209000     GO TO   SEQ-TEST-RD-23-01.
209100 SEQ-DELETE-23-01.
209200     PERFORM DE-LETE.
209300     GO TO   SEQ-TEST-23-01-END.
209400*
209500*   CHECK THE FILE STATUS RETURNED
209600*
209700 SEQ-TEST-RD-23-01.
209800     IF SQ-STATUS = "00"
209900         PERFORM PASS
210000     ELSE
210100         MOVE    SQ-STATUS TO COMPUTED-A
210200         MOVE   "00" TO CORRECT-A
210300         MOVE   "UNEXPECTED I-O STATUS ON READ" TO RE-MARK
210400         MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
210500         PERFORM FAIL.
210600 SEQ-TEST-23-01-END.
210700*
210800*    CHECK THE IDENTITY OF THE RECORD RETURNED
210900*
211000     ADD     1 TO REC-CT.
211100     IF DELETE-SW NOT EQUAL SPACE
211200         GO TO   SEQ-DELETE-23-02.
211300     GO TO   SEQ-TEST-RD-23-02.
211400 SEQ-DELETE-23-02.
211500     PERFORM DE-LETE.
211600     GO TO   SEQ-TEST-23-02-END.
211700 SEQ-TEST-RD-23-02.
211800     IF XRECORD-NUMBER (1) = XRECORD-NUMBER (2)
211900         PERFORM PASS
212000     ELSE
212100         MOVE    XRECORD-NUMBER (2) TO COMPUTED-A
212200         MOVE    XRECORD-NUMBER (1) TO CORRECT-A
212300         MOVE   "UNEXPECTED RECORD RETURNED" TO RE-MARK
212400         PERFORM FAIL.
212500 SEQ-TEST-23-02-END.
212600*
212700*    CHECK THE RECORD EXTENSION AREA
212800*
212900     ADD     1 TO REC-CT.
213000     IF DELETE-SW NOT EQUAL TO SPACE
213100         GO TO SEQ-DELETE-23-03.
213200     GO TO   SEQ-TEST-RD-23-03.
213300 SEQ-DELETE-23-03.
213400     PERFORM DE-LETE.
213500     GO TO   SEQ-TEST-23-03-END.
213600 SEQ-TEST-RD-23-03.
213700     IF SQ-VS6R2-SECOND-L = BUFFER-COPY-SECOND-L
213800         PERFORM PASS
213900     ELSE
214000         MOVE    SQ-VS6R2-SECOND-L TO COMPUTED-A
214100         MOVE    BUFFER-COPY-SECOND-L TO CORRECT-A
214200         MOVE   "INCORRECT VALUE IN BUFFER EXTENSION" TO RE-MARK
214300         PERFORM FAIL.
214400 SEQ-TEST-23-03-END.
214500*
214600*    CHECK EXECUTION OF THE NOT END PATH
214700*
214800     ADD     1 TO REC-CT.
214900     IF DELETE-SW NOT = SPACE
215000         GO TO   SEQ-DELETE-23-04.
215100     GO TO   SEQ-TEST-RD-23-04.
215200 SEQ-DELETE-23-04.
215300     PERFORM DE-LETE.
215400     GO TO   SEQ-TEST-23-04-END.
215500 SEQ-TEST-RD-23-04.
215600     IF NOT-EOF-FLAG = "EXECUTED"
215700         PERFORM PASS
215800     ELSE
215900         MOVE    NOT-EOF-FLAG TO COMPUTED-A
216000         MOVE   "EXECUTED" TO CORRECT-A
216100         MOVE   "NOT END PATH NOT EXECUTED" TO RE-MARK
216200         MOVE   "VII-46,4.4.4(11)" TO ANSI-REFERENCE
216300         PERFORM FAIL.
216400 SEQ-TEST-23-04-END.
216500*
216600*    CHECK EXECUTION OF THE STATEMENT AFTER END-READ
216700*
216800     ADD     1 TO REC-CT.
216900     IF DELETE-SW NOT = SPACE
217000         GO TO   SEQ-DELETE-23-05.
217100     GO TO   SEQ-TEST-RD-23-05.
217200 SEQ-DELETE-23-05.
217300     PERFORM DE-LETE.
217400     GO TO   SEQ-TEST-23-05-END.
217500 SEQ-TEST-RD-23-05.
217600     IF END-READ-FLAG = "EXECUTED"
217700         PERFORM PASS
217800     ELSE
217900         MOVE    END-READ-FLAG TO COMPUTED-A
218000         MOVE   "EXECUTED" TO CORRECT-A
218100         MOVE   "NOT END PATH NOT EXECUTED" TO RE-MARK
218200         MOVE   "IV-40, VII-47,4.4.4(14)" TO ANSI-REFERENCE
218300         PERFORM FAIL.
218400 SEQ-TEST-23-05-END.
218500*
218600*    CHECK EXECUTION OF THE END PHRASE
218700*
218800     ADD     1 TO REC-CT.
218900     IF DELETE-SW NOT = SPACE
219000         GO TO   SEQ-DELETE-23-06.
219100     GO TO   SEQ-TEST-RD-23-06.
219200 SEQ-DELETE-23-06.
219300     PERFORM DE-LETE.
219400     GO TO   SEQ-TEST-23-06-END.
219500 SEQ-TEST-RD-23-06.
219600     IF EOF-FLAG = "NOT EXECUTED"
219700         PERFORM PASS
219800     ELSE
219900         MOVE    EOF-FLAG TO COMPUTED-A
220000         MOVE   "NOT EXECUTED" TO CORRECT-A
220100         MOVE   "AT END BRANCH TAKEN BEFORE EOF" TO RE-MARK
220200         MOVE   "V11-46,4.4.4(10)" TO ANSI-REFERENCE
220300         MOVE   "*" TO DELETE-SW-2
220400         PERFORM FAIL.
220500 SEQ-TEST-23-06-END.
220600     MOVE    SPACE TO DELETE-SW-3.
220700*
220800*
220900*    READ A SHORT RECORD,
221000*    USING READ ... END ... NOT AT END ... END-READ
221100*
221200 SEQ-INIT-24.
221300     MOVE    1 TO REC-CT.
221400     ADD     1 TO XRECORD-NUMBER (1).
221500     MOVE   "**********" TO SQ-VS6R2-SECOND-L.
221600     MOVE   "SHORT" TO BUFFER-COPY-L-OR-S.
221700     ADD     1 TO BUFFER-COPY-RECNO.
221800     MOVE   "**" TO SQ-STATUS.
221900     MOVE   "NOT EXECUTED"  TO EOF-FLAG.
222000     MOVE   "NOT EXECUTED"  TO NOT-EOF-FLAG.
222100     MOVE   "NOT EXECUTED"  TO END-READ-FLAG.
222200     MOVE   "READ SHORT END N A R E-R" TO FEATURE.
222300     MOVE   "SEQ-TEST-RD-24" TO PAR-NAME.
222400     IF DELETE-SW NOT = SPACE
222500         GO TO   SEQ-DELETE-24.
222600     GO TO   SEQ-TEST-RD-24.
222700 SEQ-DELETE-24.
222800     MOVE   "*" TO DELETE-SW-3.
222900     GO TO   SEQ-DELETE-24-01.
223000*
223100*    EXECUTE THE READ STATEMENT
223200*
223300 SEQ-TEST-RD-24.
223400     READ    SQ-VS6
223500        END
223600                MOVE   "EXECUTED" TO EOF-FLAG
223700        NOT AT END
223800                MOVE   "EXECUTED" TO NOT-EOF-FLAG
223900     END-READ
224000     MOVE   "EXECUTED" TO END-READ-FLAG.
224100     MOVE    SQ-VS6R1-M-G-120 TO FILE-RECORD-INFO-P1-120 (2).
224200     GO TO   SEQ-TEST-RD-24-01.
224300*
224400*    CHECK THE FILE STATUS VALUE
224500*
224600 SEQ-DELETE-24-01.
224700     PERFORM DE-LETE.
224800     GO TO   SEQ-TEST-24-01-END.
224900 SEQ-TEST-RD-24-01.
225000     IF SQ-STATUS = "00"
225100         PERFORM PASS
225200     ELSE
225300         MOVE    SQ-STATUS TO COMPUTED-A
225400         MOVE   "00" TO CORRECT-A
225500         MOVE   "UNEXPECTED I-O STATUS ON READ" TO RE-MARK
225600         MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
225700         PERFORM FAIL.
225800 SEQ-TEST-24-01-END.
225900*
226000*    CHECK THE RECORD NUMBER OF THE RECORD READ
226100*
226200     ADD     1 TO REC-CT.
226300     IF DELETE-SW NOT EQUAL SPACE
226400         GO TO   SEQ-DELETE-24-02.
226500     GO TO   SEQ-TEST-RD-24-02.
226600 SEQ-DELETE-24-02.
226700     PERFORM DE-LETE.
226800     GO TO   SEQ-TEST-24-02-END.
226900 SEQ-TEST-RD-24-02.
227000     IF XRECORD-NUMBER (1) = XRECORD-NUMBER (2)
227100         PERFORM PASS
227200     ELSE
227300         MOVE    XRECORD-NUMBER (2) TO COMPUTED-A
227400         MOVE    XRECORD-NUMBER (1) TO CORRECT-A
227500         MOVE   "UNEXPECTED RECORD RETURNED" TO RE-MARK
227600         PERFORM FAIL.
227700 SEQ-TEST-24-02-END.
227800*
227900*    CHECK THE EXTENDED PART OF THE RECORD
228000*
228100     ADD     1 TO REC-CT.
228200*    IF DELETE-SW NOT = TO SPACE
228300*        GO TO SEQ-DELETE-24-03.
228400*    GO TO   SEQ-TEST-RD-24-03.
228500 SEQ-DELETE-24-03.
228600     PERFORM DE-LETE.
228700     GO TO   SEQ-TEST-24-03-END.
228800 SEQ-TEST-RD-24-03.
228900     IF SQ-VS6R2-SECOND-L NOT = BUFFER-COPY-SECOND-L
229000         PERFORM PASS
229100     ELSE
229200         MOVE    SQ-VS6R2-SECOND-L TO COMPUTED-A
229300         MOVE   "**UNDEFINED**" TO CORRECT-A
229400         MOVE   "BUFFER CONTENTS FOR LONG RECORD" TO RE-MARK
229500         PERFORM FAIL.
229600 SEQ-TEST-24-03-END.
229700*
229800*    CHECK EXECUTION OF THE NOT END PATH
229900*
230000     ADD     1 TO REC-CT.
230100     IF DELETE-SW NOT = SPACE
230200         GO TO   SEQ-DELETE-24-04.
230300     GO TO   SEQ-TEST-RD-24-04.
230400 SEQ-DELETE-24-04.
230500     PERFORM DE-LETE.
230600     GO TO   SEQ-TEST-24-04-END.
230700 SEQ-TEST-RD-24-04.
230800     IF NOT-EOF-FLAG = "EXECUTED"
230900         PERFORM PASS
231000     ELSE
231100         MOVE    NOT-EOF-FLAG TO COMPUTED-A
231200         MOVE   "EXECUTED" TO CORRECT-A
231300         MOVE   "NOT END PATH NOT EXECUTED" TO RE-MARK
231400         MOVE   "VII-46,4.4.4(11)" TO ANSI-REFERENCE
231500         PERFORM FAIL.
231600 SEQ-TEST-24-04-END.
231700*
231800*
231900*    CHECK EXECUTION OF THE STATEMENT AFTER END-READ
232000*
232100     ADD     1 TO REC-CT.
232200     IF DELETE-SW NOT = SPACE
232300         GO TO   SEQ-DELETE-24-05.
232400     GO TO   SEQ-TEST-RD-24-05.
232500 SEQ-DELETE-24-05.
232600     PERFORM DE-LETE.
232700     GO TO   SEQ-TEST-24-05-END.
232800 SEQ-TEST-RD-24-05.
232900     IF END-READ-FLAG = "EXECUTED"
233000         PERFORM PASS
233100     ELSE
233200         MOVE    END-READ-FLAG TO COMPUTED-A
233300         MOVE   "EXECUTED" TO CORRECT-A
233400         MOVE   "NOT END PATH NOT EXECUTED" TO RE-MARK
233500         MOVE   "IV-40, VII-47,4.4.4(14)" TO ANSI-REFERENCE
233600         PERFORM FAIL.
233700 SEQ-TEST-24-05-END.
233800*
233900*    CHECK EXECUTION OF THE END PATH
234000*
234100     ADD     1 TO REC-CT.
234200     IF DELETE-SW NOT = SPACE
234300         GO TO   SEQ-DELETE-24-06.
234400     GO TO   SEQ-TEST-RD-24-06.
234500 SEQ-DELETE-24-06.
234600     PERFORM DE-LETE.
234700     GO TO   SEQ-TEST-24-06-END.
234800 SEQ-TEST-RD-24-06.
234900     IF EOF-FLAG = "NOT EXECUTED"
235000         PERFORM PASS
235100     ELSE
235200         MOVE    EOF-FLAG TO COMPUTED-A
235300         MOVE   "NOT EXECUTED" TO CORRECT-A
235400         MOVE   "AT END BRANCH TAKEN BEFORE EOF" TO RE-MARK
235500         MOVE   "V11-46, 4.4.4(10)" TO ANSI-REFERENCE
235600         MOVE   "*" TO DELETE-SW-2
235700         PERFORM FAIL.
235800 SEQ-TEST-24-06-END.
235900     MOVE    SPACE TO DELETE-SW-3.
236000*
236100*
236200*    READ A SHORT RECORD,
236300*    USING READ ... AT END ... NOT END ... END-READ
236400*
236500 SEQ-INIT-25.
236600     MOVE    1 TO REC-CT.
236700     ADD     1 TO XRECORD-NUMBER (1).
236800     MOVE   "**********" TO SQ-VS6R2-SECOND-L.
236900     MOVE   "SHORT" TO BUFFER-COPY-L-OR-S.
237000     ADD     1 TO BUFFER-COPY-RECNO.
237100     MOVE   "**" TO SQ-STATUS.
237200     MOVE   "NOT EXECUTED"  TO EOF-FLAG.
237300     MOVE   "NOT EXECUTED"  TO NOT-EOF-FLAG.
237400     MOVE   "NOT EXECUTED"  TO END-READ-FLAG.
237500     MOVE   "READ SHORT A END N E E-R" TO FEATURE.
237600     MOVE   "SEQ-TEST-RD-25" TO PAR-NAME.
237700     IF DELETE-SW NOT = SPACE
237800         GO TO   SEQ-DELETE-25.
237900     GO TO   SEQ-TEST-RD-25.
238000 SEQ-DELETE-25.
238100     MOVE   "*" TO DELETE-SW-3.
238200     GO TO   SEQ-DELETE-25-01.
238300*
238400*    EXECUTE THE READ STATEMENT
238500*
238600 SEQ-TEST-RD-25.
238700     READ    SQ-VS6
238800        AT END
238900                MOVE   "EXECUTED" TO EOF-FLAG
239000        NOT END
239100                MOVE   "EXECUTED" TO NOT-EOF-FLAG
239200     END-READ
239300     MOVE   "EXECUTED" TO END-READ-FLAG.
239400     MOVE    SQ-VS6R1-M-G-120 TO FILE-RECORD-INFO-P1-120 (2).
239500     GO TO   SEQ-TEST-RD-25-01.
239600*
239700*    CHECK THE FILE STATUS VALUE
239800*
239900 SEQ-DELETE-25-01.
240000     PERFORM DE-LETE.
240100     GO TO   SEQ-TEST-25-01-END.
240200 SEQ-TEST-RD-25-01.
240300     IF SQ-STATUS = "00"
240400         PERFORM PASS
240500     ELSE
240600         MOVE    SQ-STATUS TO COMPUTED-A
240700         MOVE   "00" TO CORRECT-A
240800         MOVE   "UNEXPECTED I-O STATUS ON READ" TO RE-MARK
240900         MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
241000         PERFORM FAIL.
241100 SEQ-TEST-25-01-END.
241200*
241300*    CHECK THE RECORD NUMBER OF THE RECORD READ
241400*
241500     ADD     1 TO REC-CT.
241600     IF DELETE-SW NOT EQUAL SPACE
241700         GO TO   SEQ-DELETE-25-02.
241800     GO TO   SEQ-TEST-RD-25-02.
241900 SEQ-DELETE-25-02.
242000     PERFORM DE-LETE.
242100     GO TO   SEQ-TEST-25-02-END.
242200 SEQ-TEST-RD-25-02.
242300     IF XRECORD-NUMBER (1) = XRECORD-NUMBER (2)
242400         PERFORM PASS
242500     ELSE
242600         MOVE    XRECORD-NUMBER (2) TO COMPUTED-A
242700         MOVE    XRECORD-NUMBER (1) TO CORRECT-A
242800         MOVE   "UNEXPECTED RECORD RETURNED" TO RE-MARK
242900         PERFORM FAIL.
243000 SEQ-TEST-25-02-END.
243100*
243200*    CHECK THE EXTENDED PART OF THE RECORD
243300*
243400     ADD     1 TO REC-CT.
243500*    IF DELETE-SW NOT = TO SPACE
243600*        GO TO SEQ-DELETE-25-03.
243700*    GO TO   SEQ-TEST-RD-25-03.
243800 SEQ-DELETE-25-03.
243900     PERFORM DE-LETE.
244000     GO TO   SEQ-TEST-25-03-END.
244100 SEQ-TEST-RD-25-03.
244200     IF SQ-VS6R2-SECOND-L NOT = BUFFER-COPY-SECOND-L
244300         PERFORM PASS
244400     ELSE
244500         MOVE    SQ-VS6R2-SECOND-L TO COMPUTED-A
244600         MOVE   "**UNDEFINED**" TO CORRECT-A
244700         MOVE   "BUFFER CONTENTS FOR LONG RECORD" TO RE-MARK
244800         PERFORM FAIL.
244900 SEQ-TEST-25-03-END.
245000*
245100*    CHECK EXECUTION OF THE NOT END PATH
245200*
245300     ADD     1 TO REC-CT.
245400     IF DELETE-SW NOT = SPACE
245500         GO TO   SEQ-DELETE-25-04.
245600     GO TO   SEQ-TEST-RD-25-04.
245700 SEQ-DELETE-25-04.
245800     PERFORM DE-LETE.
245900     GO TO   SEQ-TEST-25-04-END.
246000 SEQ-TEST-RD-25-04.
246100     IF NOT-EOF-FLAG = "EXECUTED"
246200         PERFORM PASS
246300     ELSE
246400         MOVE    NOT-EOF-FLAG TO COMPUTED-A
246500         MOVE   "EXECUTED" TO CORRECT-A
246600         MOVE   "NOT END PATH NOT EXECUTED" TO RE-MARK
246700         MOVE   "VII-46,4.4.4(11)" TO ANSI-REFERENCE
246800         PERFORM FAIL.
246900 SEQ-TEST-25-04-END.
247000*
247100*
247200*    CHECK EXECUTION OF THE STATEMENT AFTER END-READ
247300*
247400     ADD     1 TO REC-CT.
247500     IF DELETE-SW NOT = SPACE
247600         GO TO   SEQ-DELETE-25-05.
247700     GO TO   SEQ-TEST-RD-25-05.
247800 SEQ-DELETE-25-05.
247900     PERFORM DE-LETE.
248000     GO TO   SEQ-TEST-25-05-END.
248100 SEQ-TEST-RD-25-05.
248200     IF END-READ-FLAG = "EXECUTED"
248300         PERFORM PASS
248400     ELSE
248500         MOVE    END-READ-FLAG TO COMPUTED-A
248600         MOVE   "EXECUTED" TO CORRECT-A
248700         MOVE   "NOT END PATH NOT EXECUTED" TO RE-MARK
248800         MOVE   "IV-40, VII-47,4.4.4(14)" TO ANSI-REFERENCE
248900         PERFORM FAIL.
249000 SEQ-TEST-25-05-END.
249100*
249200*    CHECK EXECUTION OF THE END PATH
249300*
249400     ADD     1 TO REC-CT.
249500     IF DELETE-SW NOT = SPACE
249600         GO TO   SEQ-DELETE-25-06.
249700     GO TO   SEQ-TEST-RD-25-06.
249800 SEQ-DELETE-25-06.
249900     PERFORM DE-LETE.
250000     GO TO   SEQ-TEST-25-06-END.
250100 SEQ-TEST-RD-25-06.
250200     IF EOF-FLAG = "NOT EXECUTED"
250300         PERFORM PASS
250400     ELSE
250500         MOVE    EOF-FLAG TO COMPUTED-A
250600         MOVE   "NOT EXECUTED" TO CORRECT-A
250700         MOVE   "AT END BRANCH TAKEN BEFORE EOF" TO RE-MARK
250800         MOVE   "V11-46, 4.4.4(10)" TO ANSI-REFERENCE
250900         MOVE   "*" TO DELETE-SW-2
251000         PERFORM FAIL.
251100 SEQ-TEST-25-06-END.
251200     MOVE    SPACE TO DELETE-SW-3.
251300*
251400*
251500*    READ AT END OF FILE, RAISING EOF CONDITION
251600*    USING READ ... END ... NOT END ... END-READ
251700*
251800 SEQ-INIT-26.
251900     MOVE    1 TO REC-CT.
252000     MOVE   "**" TO SQ-STATUS.
252100     MOVE   "NOT EXECUTED"  TO EOF-FLAG.
252200     MOVE   "NOT EXECUTED"  TO NOT-EOF-FLAG.
252300     MOVE   "NOT EXECUTED"  TO END-READ-FLAG.
252400     MOVE   "READ SHORT A END N E E-R" TO FEATURE.
252500     MOVE   "SEQ-TEST-RD-26" TO PAR-NAME.
252600     IF DELETE-SW NOT = SPACE
252700         GO TO   SEQ-DELETE-26.
252800     GO TO   SEQ-TEST-RD-26.
252900 SEQ-DELETE-26.
253000     MOVE   "*" TO DELETE-SW-3.
253100     GO TO   SEQ-DELETE-26-01.
253200*
253300*    EXECUTE THE READ STATEMENT
253400*
253500 SEQ-TEST-RD-26.
253600     READ    SQ-VS6
253700        END
253800                MOVE   "EXECUTED" TO EOF-FLAG
253900        NOT END
254000                MOVE   "EXECUTED" TO NOT-EOF-FLAG
254100     END-READ
254200     MOVE   "EXECUTED" TO END-READ-FLAG.
254300     MOVE    SQ-VS6R1-M-G-120 TO FILE-RECORD-INFO-P1-120 (2).
254400     GO TO   SEQ-TEST-RD-26-01.
254500*
254600*    CHECK THE FILE STATUS VALUE
254700*
254800 SEQ-DELETE-26-01.
254900     PERFORM DE-LETE.
255000     GO TO   SEQ-TEST-26-01-END.
255100 SEQ-TEST-RD-26-01.
255200     IF SQ-STATUS = "10"
255300         PERFORM PASS
255400     ELSE
255500         MOVE    SQ-STATUS TO COMPUTED-A
255600         MOVE   "10" TO CORRECT-A
255700         MOVE   "I-O STATUS FOR EOF NOT RETURNED" TO RE-MARK
255800         MOVE   "VII-3, VII-44,4.4.4(3)" TO ANSI-REFERENCE
255900         PERFORM FAIL.
256000 SEQ-TEST-26-01-END.
256100*
256200*
256300*    CHECK EXECUTION OF THE NOT END PATH
256400*
256500     ADD     1 TO REC-CT.
256600     IF DELETE-SW NOT = SPACE
256700         GO TO   SEQ-DELETE-26-02.
256800     GO TO   SEQ-TEST-RD-26-02.
256900 SEQ-DELETE-26-02.
257000     PERFORM DE-LETE.
257100     GO TO   SEQ-TEST-26-02-END.
257200 SEQ-TEST-RD-26-02.
257300     IF NOT-EOF-FLAG = "NOT EXECUTED"
257400         PERFORM PASS
257500     ELSE
257600         MOVE    NOT-EOF-FLAG TO COMPUTED-A
257700         MOVE   "NOT EXECUTED" TO CORRECT-A
257800         MOVE   "NOT END PATH EXECUTED AT EOF" TO RE-MARK
257900         MOVE   "VII-46,4.4.4(11)" TO ANSI-REFERENCE
258000         PERFORM FAIL.
258100 SEQ-TEST-26-02-END.
258200*
258300*
258400*    CHECK EXECUTION OF THE STATEMENT AFTER END-READ
258500*
258600     ADD     1 TO REC-CT.
258700     IF DELETE-SW NOT = SPACE
258800         GO TO   SEQ-DELETE-26-03.
258900     GO TO   SEQ-TEST-RD-26-03.
259000 SEQ-DELETE-26-03.
259100     PERFORM DE-LETE.
259200     GO TO   SEQ-TEST-26-03-END.
259300 SEQ-TEST-RD-26-03.
259400     IF END-READ-FLAG = "EXECUTED"
259500         PERFORM PASS
259600     ELSE
259700         MOVE    END-READ-FLAG TO COMPUTED-A
259800         MOVE   "EXECUTED" TO CORRECT-A
259900         MOVE   "NOT END PATH NOT EXECUTED" TO RE-MARK
260000         MOVE   "IV-40, VII-47,4.4.4(14)" TO ANSI-REFERENCE
260100         PERFORM FAIL.
260200 SEQ-TEST-26-03-END.
260300*
260400*    CHECK EXECUTION OF THE END PATH
260500*
260600     ADD     1 TO REC-CT.
260700     IF DELETE-SW NOT = SPACE
260800         GO TO   SEQ-DELETE-26-04.
260900     GO TO   SEQ-TEST-RD-26-04.
261000 SEQ-DELETE-26-04.
261100     PERFORM DE-LETE.
261200     GO TO   SEQ-TEST-26-04-END.
261300 SEQ-TEST-RD-26-04.
261400     IF EOF-FLAG = "EXECUTED"
261500         PERFORM PASS
261600     ELSE
261700         MOVE    EOF-FLAG TO COMPUTED-A
261800         MOVE   "EXECUTED" TO CORRECT-A
261900         MOVE   "AT END BRANCH NOT TAKEN AT EOF" TO RE-MARK
262000         MOVE   "V11-46, 4.4.4(10)" TO ANSI-REFERENCE
262100         PERFORM FAIL.
262200 SEQ-TEST-26-04-END.
262300     MOVE    SPACE TO DELETE-SW-3.
262400*
262500*
262600*    THE END OF THE FILE HAS BEEN REACHED, SO IT CAN BE CLOSED
262700*
262800 SEQ-INIT-27.
262900     MOVE    1 TO REC-CT.
263000     MOVE   "CLOSE FILE AFTER READING" TO FEATURE.
263100     MOVE   "SEQ-TEST-CL-27" TO PAR-NAME.
263200     MOVE   "**" TO SQ-STATUS.
263300     IF DELETE-SW NOT EQUAL SPACE
263400         GO TO SEQ-DELETE-27.
263500     GO TO SEQ-TEST-CL-27.
263600 SEQ-DELETE-27.
263700     GO TO   SEQ-DELETE-27-01.
263800 SEQ-TEST-CL-27.
263900     CLOSE   SQ-VS6.
264000     GO TO   SEQ-TEST-CL-27-01.
264100 SEQ-DELETE-27-01.
264200     PERFORM DE-LETE.
264300     GO TO   SEQ-TEST-27-01-END.
264400 SEQ-TEST-CL-27-01.
264500     IF SQ-STATUS = "00"
264600         PERFORM PASS
264700     ELSE
264800         MOVE    SQ-STATUS TO COMPUTED-A
264900         MOVE   "00" TO CORRECT-A
265000         MOVE   "UNEXPECTED I-O STATUS FROM CLOSE" TO RE-MARK
265100         MOVE   "VII-3, VII-38,4.2.4(4)" TO ANSI-REFERENCE
265200         PERFORM FAIL.
265300 SEQ-TEST-27-01-END.
265400*
265500*
265600 TERMINATE-ROUTINE.
265700     EXIT.
265800 CCVS-EXIT SECTION.
265900 CCVS-999999.
266000     GO TO CLOSE-FILES.
