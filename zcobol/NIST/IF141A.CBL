000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IF141A.
000400***********************************************************
000500*                                                         *
000600* This program forms part of the CCVS85 COBOL Test Suite. *
000700* It contains tests for the Intrinsic Function VARIANCE   *
000800*                                                         *
000900***********************************************************
001000 ENVIRONMENT DIVISION.
001100 CONFIGURATION SECTION.
001200 SOURCE-COMPUTER.
001300     XXXXX082.
001400 OBJECT-COMPUTER.
001500     XXXXX083.
001600 INPUT-OUTPUT SECTION.
001700 FILE-CONTROL.
001800     SELECT PRINT-FILE ASSIGN TO
001900     XXXXX055.
002000 DATA DIVISION.
002100 FILE SECTION.
002200 FD  PRINT-FILE.
002300 01  PRINT-REC PICTURE X(120).
002400 01  DUMMY-RECORD PICTURE X(120).
002500 WORKING-STORAGE SECTION.
002600***********************************************************
002700* Variables specific to the Intrinsic Function Test IF141A*
002800***********************************************************
002900 01  A                   PIC S9(10)          VALUE 5.
003000 01  B                   PIC S9(10)          VALUE 7.
003100 01  C                   PIC S9(10)          VALUE -4.
003200 01  D                   PIC S9(10)          VALUE 10.
003300 01  E                   PIC S9(5)V9(5)      VALUE 34.26.
003400 01  F                   PIC S9(5)V9(5)      VALUE -8.32.
003500 01  G                   PIC S9(5)V9(5)      VALUE 4.08.
003600 01  H                   PIC S9(5)V9(5)      VALUE -5.3.
003700 01  P                   PIC S9(10)          VALUE 4.
003800 01  Q                   PIC S9(10)          VALUE 3.
003900 01  R                   PIC S9(10)          VALUE 5.
004000 01  ARG3                PIC S9(10)          VALUE 2.
004100 01  ARR                                     VALUE "40537".
004200     02  IND OCCURS 5 TIMES PIC 9.
004300 01  TEMP                PIC S9(10).
004400 01  WS-NUM              PIC S9(5)V9(6).
004500 01  MIN-RANGE           PIC S9(5)V9(7).
004600 01  MAX-RANGE           PIC S9(5)V9(7).
004700*
004800**********************************************************
004900*
005000 01  TEST-RESULTS.
005100     02 FILLER                   PIC X      VALUE SPACE.
005200     02 FEATURE                  PIC X(20)  VALUE SPACE.
005300     02 FILLER                   PIC X      VALUE SPACE.
005400     02 P-OR-F                   PIC X(5)   VALUE SPACE.
005500     02 FILLER                   PIC X      VALUE SPACE.
005600     02  PAR-NAME.
005700       03 FILLER                 PIC X(19)  VALUE SPACE.
005800       03  PARDOT-X              PIC X      VALUE SPACE.
005900       03 DOTVALUE               PIC 99     VALUE ZERO.
006000     02 FILLER                   PIC X(8)   VALUE SPACE.
006100     02 RE-MARK                  PIC X(61).
006200 01  TEST-COMPUTED.
006300     02 FILLER                   PIC X(30)  VALUE SPACE.
006400     02 FILLER                   PIC X(17)  VALUE
006500            "       COMPUTED=".
006600     02 COMPUTED-X.
006700     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
006800     03 COMPUTED-N               REDEFINES COMPUTED-A
006900                                 PIC -9(9).9(9).
007000     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
007100     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
007200     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
007300     03       CM-18V0 REDEFINES COMPUTED-A.
007400         04 COMPUTED-18V0                    PIC -9(18).
007500         04 FILLER                           PIC X.
007600     03 FILLER PIC X(50) VALUE SPACE.
007700 01  TEST-CORRECT.
007800     02 FILLER PIC X(30) VALUE SPACE.
007900     02 FILLER PIC X(17) VALUE "       CORRECT =".
008000     02 CORRECT-X.
008100     03 CORRECT-A                  PIC X(20) VALUE SPACE.
008200     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
008300     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
008400     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
008500     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
008600     03      CR-18V0 REDEFINES CORRECT-A.
008700         04 CORRECT-18V0                     PIC -9(18).
008800         04 FILLER                           PIC X.
008900     03 FILLER PIC X(2) VALUE SPACE.
009000     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
009100 01  TEST-CORRECT-MIN.
009200     02 FILLER PIC X(30) VALUE SPACE.
009300     02 FILLER PIC X(17) VALUE "     MIN VALUE =".
009400     02 CORRECTMI-X.
009500     03 CORRECTMI-A                 PIC X(20) VALUE SPACE.
009600     03 CORRECT-MIN    REDEFINES CORRECTMI-A     PIC -9(9).9(9).
009700     03 CORRECTMI-0V18 REDEFINES CORRECTMI-A     PIC -.9(18).
009800     03 CORRECTMI-4V14 REDEFINES CORRECTMI-A     PIC -9(4).9(14).
009900     03 CORRECTMI-14V4 REDEFINES CORRECTMI-A     PIC -9(14).9(4).
010000     03      CR-18V0 REDEFINES CORRECTMI-A.
010100         04 CORRECTMI-18V0                     PIC -9(18).
010200         04 FILLER                           PIC X.
010300     03 FILLER PIC X(2) VALUE SPACE.
010400     03 FILLER                           PIC X(48) VALUE SPACE.
010500 01  TEST-CORRECT-MAX.
010600     02 FILLER PIC X(30) VALUE SPACE.
010700     02 FILLER PIC X(17) VALUE "     MAX VALUE =".
010800     02 CORRECTMA-X.
010900     03 CORRECTMA-A                  PIC X(20) VALUE SPACE.
011000     03 CORRECT-MAX    REDEFINES CORRECTMA-A     PIC -9(9).9(9).
011100     03 CORRECTMA-0V18 REDEFINES CORRECTMA-A     PIC -.9(18).
011200     03 CORRECTMA-4V14 REDEFINES CORRECTMA-A     PIC -9(4).9(14).
011300     03 CORRECTMA-14V4 REDEFINES CORRECTMA-A     PIC -9(14).9(4).
011400     03      CR-18V0 REDEFINES CORRECTMA-A.
011500         04 CORRECTMA-18V0                     PIC -9(18).
011600         04 FILLER                           PIC X.
011700     03 FILLER PIC X(2) VALUE SPACE.
011800     03 CORMA-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
011900 01  CCVS-C-1.
012000     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
012100-    "SS  PARAGRAPH-NAME
012200-    "       REMARKS".
012300     02 FILLER                     PIC X(20)    VALUE SPACE.
012400 01  CCVS-C-2.
012500     02 FILLER                     PIC X        VALUE SPACE.
012600     02 FILLER                     PIC X(6)     VALUE "TESTED".
012700     02 FILLER                     PIC X(15)    VALUE SPACE.
012800     02 FILLER                     PIC X(4)     VALUE "FAIL".
012900     02 FILLER                     PIC X(94)    VALUE SPACE.
013000 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
013100 01  REC-CT                        PIC 99       VALUE ZERO.
013200 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
013300 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
013400 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
013500 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
013600 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
013700 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
013800 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
013900 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
014000 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
014100 01  CCVS-H-1.
014200     02  FILLER                    PIC X(39)    VALUE SPACES.
014300     02  FILLER                    PIC X(42)    VALUE
014400     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
014500     02  FILLER                    PIC X(39)    VALUE SPACES.
014600 01  CCVS-H-2A.
014700   02  FILLER                        PIC X(40)  VALUE SPACE.
014800   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
014900   02  FILLER                        PIC XXXX   VALUE
015000     "4.2 ".
015100   02  FILLER                        PIC X(28)  VALUE
015200            " COPY - NOT FOR DISTRIBUTION".
015300   02  FILLER                        PIC X(41)  VALUE SPACE.
015400
015500 01  CCVS-H-2B.
015600   02  FILLER                        PIC X(15)  VALUE
015700            "TEST RESULT OF ".
015800   02  TEST-ID                       PIC X(9).
015900   02  FILLER                        PIC X(4)   VALUE
016000            " IN ".
016100   02  FILLER                        PIC X(12)  VALUE
016200     " HIGH       ".
016300   02  FILLER                        PIC X(22)  VALUE
016400            " LEVEL VALIDATION FOR ".
016500   02  FILLER                        PIC X(58)  VALUE
016600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
016700 01  CCVS-H-3.
016800     02  FILLER                      PIC X(34)  VALUE
016900            " FOR OFFICIAL USE ONLY    ".
017000     02  FILLER                      PIC X(58)  VALUE
017100     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
017200     02  FILLER                      PIC X(28)  VALUE
017300            "  COPYRIGHT   1985 ".
017400 01  CCVS-E-1.
017500     02 FILLER                       PIC X(52)  VALUE SPACE.
017600     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
017700     02 ID-AGAIN                     PIC X(9).
017800     02 FILLER                       PIC X(45)  VALUE SPACES.
017900 01  CCVS-E-2.
018000     02  FILLER                      PIC X(31)  VALUE SPACE.
018100     02  FILLER                      PIC X(21)  VALUE SPACE.
018200     02 CCVS-E-2-2.
018300         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
018400         03 FILLER                   PIC X      VALUE SPACE.
018500         03 ENDER-DESC               PIC X(44)  VALUE
018600            "ERRORS ENCOUNTERED".
018700 01  CCVS-E-3.
018800     02  FILLER                      PIC X(22)  VALUE
018900            " FOR OFFICIAL USE ONLY".
019000     02  FILLER                      PIC X(12)  VALUE SPACE.
019100     02  FILLER                      PIC X(58)  VALUE
019200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
019300     02  FILLER                      PIC X(13)  VALUE SPACE.
019400     02 FILLER                       PIC X(15)  VALUE
019500             " COPYRIGHT 1985".
019600 01  CCVS-E-4.
019700     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
019800     02 FILLER                       PIC X(4)   VALUE " OF ".
019900     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
020000     02 FILLER                       PIC X(40)  VALUE
020100      "  TESTS WERE EXECUTED SUCCESSFULLY".
020200 01  XXINFO.
020300     02 FILLER                       PIC X(19)  VALUE
020400            "*** INFORMATION ***".
020500     02 INFO-TEXT.
020600       04 FILLER                     PIC X(8)   VALUE SPACE.
020700       04 XXCOMPUTED                 PIC X(20).
020800       04 FILLER                     PIC X(5)   VALUE SPACE.
020900       04 XXCORRECT                  PIC X(20).
021000     02 INF-ANSI-REFERENCE           PIC X(48).
021100 01  HYPHEN-LINE.
021200     02 FILLER  PIC IS X VALUE IS SPACE.
021300     02 FILLER  PIC IS X(65)    VALUE IS "************************
021400-    "*****************************************".
021500     02 FILLER  PIC IS X(54)    VALUE IS "************************
021600-    "******************************".
021700 01  CCVS-PGM-ID                     PIC X(9)   VALUE
021800     "IF141A".
021900 PROCEDURE DIVISION.
022000 CCVS1 SECTION.
022100 OPEN-FILES.
022200     OPEN     OUTPUT PRINT-FILE.
022300     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
022400     MOVE    SPACE TO TEST-RESULTS.
022500     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
022600     GO TO CCVS1-EXIT.
022700 CLOSE-FILES.
022800     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
022900 TERMINATE-CCVS.
023000     STOP     RUN.
023100 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
023200 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
023300 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
023400 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
023500     MOVE "****TEST DELETED****" TO RE-MARK.
023600 PRINT-DETAIL.
023700     IF REC-CT NOT EQUAL TO ZERO
023800             MOVE "." TO PARDOT-X
023900             MOVE REC-CT TO DOTVALUE.
024000     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
024100     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
024200        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
024300          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
024400     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
024500     MOVE SPACE TO CORRECT-X.
024600     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
024700     MOVE     SPACE TO RE-MARK.
024800 HEAD-ROUTINE.
024900     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025000     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025100     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
025200     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
025300 COLUMN-NAMES-ROUTINE.
025400     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025500     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
025700 END-ROUTINE.
025800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
025900 END-RTN-EXIT.
026000     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026100 END-ROUTINE-1.
026200      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
026300      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
026400      ADD PASS-COUNTER TO ERROR-HOLD.
026500      MOVE PASS-COUNTER TO CCVS-E-4-1.
026600      MOVE ERROR-HOLD TO CCVS-E-4-2.
026700      MOVE CCVS-E-4 TO CCVS-E-2-2.
026800      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
026900  END-ROUTINE-12.
027000      MOVE "TEST(S) FAILED" TO ENDER-DESC.
027100     IF       ERROR-COUNTER IS EQUAL TO ZERO
027200         MOVE "NO " TO ERROR-TOTAL
027300         ELSE
027400         MOVE ERROR-COUNTER TO ERROR-TOTAL.
027500     MOVE     CCVS-E-2 TO DUMMY-RECORD.
027600     PERFORM WRITE-LINE.
027700 END-ROUTINE-13.
027800     IF DELETE-COUNTER IS EQUAL TO ZERO
027900         MOVE "NO " TO ERROR-TOTAL  ELSE
028000         MOVE DELETE-COUNTER TO ERROR-TOTAL.
028100     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
028200     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028300      IF   INSPECT-COUNTER EQUAL TO ZERO
028400          MOVE "NO " TO ERROR-TOTAL
028500      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
028600      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
028700      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028800     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028900 WRITE-LINE.
029000     ADD 1 TO RECORD-COUNT.
029100Y    IF RECORD-COUNT GREATER 42
029200Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
029300Y        MOVE SPACE TO DUMMY-RECORD
029400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
029500Y        MOVE CCVS-H-1  TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
029600Y        MOVE CCVS-H-2A TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
029700Y        MOVE CCVS-H-2B TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
029800Y        MOVE CCVS-H-3  TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
029900Y        MOVE CCVS-C-1  TO DUMMY-RECORD  PERFORM WRT-LN
030000Y        MOVE CCVS-C-2  TO DUMMY-RECORD  PERFORM WRT-LN
030100Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
030200Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
030300Y        MOVE ZERO TO RECORD-COUNT.
030400     PERFORM WRT-LN.
030500 WRT-LN.
030600     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
030700     MOVE SPACE TO DUMMY-RECORD.
030800 BLANK-LINE-PRINT.
030900     PERFORM WRT-LN.
031000 FAIL-ROUTINE.
031100     IF     COMPUTED-X NOT EQUAL TO SPACE
031200            GO TO FAIL-ROUTINE-WRITE.
031300     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
031400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
031500     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
031600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031700     MOVE   SPACES TO INF-ANSI-REFERENCE.
031800     GO TO  FAIL-ROUTINE-EX.
031900 FAIL-ROUTINE-WRITE.
032000     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE.
032100     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE
032200                              CORMA-ANSI-REFERENCE.
032300     IF CORRECT-MIN NOT EQUAL TO SPACES THEN
032400           MOVE TEST-CORRECT-MIN TO PRINT-REC PERFORM WRITE-LINE
032500           MOVE TEST-CORRECT-MAX TO PRINT-REC PERFORM WRITE-LINE
032600     ELSE
032700           MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE.
032800     PERFORM WRITE-LINE.
032900     MOVE   SPACES TO COR-ANSI-REFERENCE.
033000 FAIL-ROUTINE-EX. EXIT.
033100 BAIL-OUT.
033200     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
033300     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
033400 BAIL-OUT-WRITE.
033500     MOVE CORRECT-A TO XXCORRECT.
033600     MOVE COMPUTED-A TO XXCOMPUTED.
033700     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
033800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033900     MOVE   SPACES TO INF-ANSI-REFERENCE.
034000 BAIL-OUT-EX. EXIT.
034100 CCVS1-EXIT.
034200     EXIT.
034300********************************************************
034400*                                                      *
034500*    Intrinsic Function Tests     IF141A - VARIANCE    *
034600*                                                      *
034700********************************************************
034800 SECT-IF141A SECTION.
034900 F-VARIANCE-INFO.
035000     MOVE     "See ref. A-74 2.45" TO ANSI-REFERENCE.
035100     MOVE     "VARIANCE Function"     TO FEATURE.
035200*****************TEST (a) - SIMPLE TEST*****************
035300 F-VARIANCE-01.
035400     MOVE ZERO TO WS-NUM.
035500     MOVE  48.6865 TO MIN-RANGE.
035600     MOVE  48.6885 TO MAX-RANGE.
035700 F-VARIANCE-TEST-01.
035800     COMPUTE WS-NUM = FUNCTION VARIANCE(5, -2, -14, 0).
035900     IF (WS-NUM >= MIN-RANGE) AND
036000        (WS-NUM <= MAX-RANGE) THEN
036100                    PERFORM PASS
036200     ELSE
036300                    MOVE WS-NUM TO COMPUTED-N
036400                    MOVE MIN-RANGE TO CORRECT-MIN
036500                    MOVE MAX-RANGE TO CORRECT-MAX
036600                    PERFORM FAIL.
036700     GO TO F-VARIANCE-WRITE-01.
036800 F-VARIANCE-DELETE-01.
036900     PERFORM  DE-LETE.
037000     GO TO    F-VARIANCE-WRITE-01.
037100 F-VARIANCE-WRITE-01.
037200     MOVE "F-VARIANCE-01" TO PAR-NAME.
037300     PERFORM  PRINT-DETAIL.
037400*****************TEST (b) - SIMPLE TEST*****************
037500 F-VARIANCE-02.
037600     EVALUATE FUNCTION VARIANCE(3.9, -0.3, 8.7, 100.2)
037700     WHEN  1741.70 THRU  1741.77
037800                    PERFORM PASS
037900     WHEN OTHER
038000                    PERFORM FAIL.
038100     GO TO F-VARIANCE-WRITE-02.
038200 F-VARIANCE-DELETE-02.
038300     PERFORM  DE-LETE.
038400     GO TO    F-VARIANCE-WRITE-02.
038500 F-VARIANCE-WRITE-02.
038600     MOVE "F-VARIANCE-02" TO PAR-NAME.
038700     PERFORM  PRINT-DETAIL.
038800*****************TEST (c) - SIMPLE TEST*****************
038900 F-VARIANCE-03.
039000     MOVE  27.2494 TO MIN-RANGE.
039100     MOVE  27.2505 TO MAX-RANGE.
039200 F-VARIANCE-TEST-03.
039300     IF (FUNCTION VARIANCE(A, B, C, D) >= MIN-RANGE) AND
039400        (FUNCTION VARIANCE(A, B, C, D) <= MAX-RANGE) THEN
039500                    PERFORM PASS
039600     ELSE
039700                    PERFORM FAIL.
039800     GO TO F-VARIANCE-WRITE-03.
039900 F-VARIANCE-DELETE-03.
040000     PERFORM  DE-LETE.
040100     GO TO    F-VARIANCE-WRITE-03.
040200 F-VARIANCE-WRITE-03.
040300     MOVE "F-VARIANCE-03" TO PAR-NAME.
040400     PERFORM  PRINT-DETAIL.
040500*****************TEST (d) - SIMPLE TEST*****************
040600 F-VARIANCE-04.
040700     MOVE ZERO TO WS-NUM.
040800     MOVE  283.728 TO MIN-RANGE.
040900     MOVE  283.740 TO MAX-RANGE.
041000 F-VARIANCE-TEST-04.
041100     COMPUTE WS-NUM = FUNCTION VARIANCE(E, F, G, H).
041200     IF (WS-NUM >= MIN-RANGE) AND
041300        (WS-NUM <= MAX-RANGE) THEN
041400                    PERFORM PASS
041500     ELSE
041600                    MOVE WS-NUM TO COMPUTED-N
041700                    MOVE MIN-RANGE TO CORRECT-MIN
041800                    MOVE MAX-RANGE TO CORRECT-MAX
041900                    PERFORM FAIL.
042000     GO TO F-VARIANCE-WRITE-04.
042100 F-VARIANCE-DELETE-04.
042200     PERFORM  DE-LETE.
042300     GO TO    F-VARIANCE-WRITE-04.
042400 F-VARIANCE-WRITE-04.
042500     MOVE "F-VARIANCE-04" TO PAR-NAME.
042600     PERFORM  PRINT-DETAIL.
042700*****************TEST (e) - SIMPLE TEST*****************
042800 F-VARIANCE-05.
042900     MOVE ZERO TO WS-NUM.
043000     MOVE  94.6981 TO MIN-RANGE.
043100     MOVE  94.7019 TO MAX-RANGE.
043200 F-VARIANCE-TEST-05.
043300     COMPUTE WS-NUM =
043400          FUNCTION VARIANCE(10.2, -0.2, 5.6, -15.6).
043500     IF (WS-NUM >= MIN-RANGE) AND
043600        (WS-NUM <= MAX-RANGE) THEN
043700                    PERFORM PASS
043800     ELSE
043900                    MOVE WS-NUM TO COMPUTED-N
044000                    MOVE MIN-RANGE TO CORRECT-MIN
044100                    MOVE MAX-RANGE TO CORRECT-MAX
044200                    PERFORM FAIL.
044300     GO TO F-VARIANCE-WRITE-05.
044400 F-VARIANCE-DELETE-05.
044500     PERFORM  DE-LETE.
044600     GO TO    F-VARIANCE-WRITE-05.
044700 F-VARIANCE-WRITE-05.
044800     MOVE "F-VARIANCE-05" TO PAR-NAME.
044900     PERFORM  PRINT-DETAIL.
045000*****************TEST (f) - SIMPLE TEST*****************
045100 F-VARIANCE-06.
045200     MOVE ZERO TO WS-NUM.
045300     MOVE  156.194 TO MIN-RANGE.
045400     MOVE  156.200 TO MAX-RANGE.
045500 F-VARIANCE-TEST-06.
045600     COMPUTE WS-NUM =
045700            FUNCTION VARIANCE(A, B, C, D, E, F, G, H).
045800     IF (WS-NUM >= MIN-RANGE) AND
045900        (WS-NUM <= MAX-RANGE) THEN
046000                    PERFORM PASS
046100     ELSE
046200                    MOVE WS-NUM TO COMPUTED-N
046300                    MOVE MIN-RANGE TO CORRECT-MIN
046400                    MOVE MAX-RANGE TO CORRECT-MAX
046500                    PERFORM FAIL.
046600     GO TO F-VARIANCE-WRITE-06.
046700 F-VARIANCE-DELETE-06.
046800     PERFORM  DE-LETE.
046900     GO TO    F-VARIANCE-WRITE-06.
047000 F-VARIANCE-WRITE-06.
047100     MOVE "F-VARIANCE-06" TO PAR-NAME.
047200     PERFORM  PRINT-DETAIL.
047300*****************TEST (g) - SIMPLE TEST*****************
047400 F-VARIANCE-07.
047500     MOVE ZERO TO WS-NUM.
047600     MOVE  4.66657 TO MIN-RANGE.
047700     MOVE  4.66675 TO MAX-RANGE.
047800 F-VARIANCE-TEST-07.
047900     COMPUTE WS-NUM =
048000           FUNCTION VARIANCE(IND(1), IND(2), IND(3)).
048100     IF (WS-NUM >= MIN-RANGE) AND
048200        (WS-NUM <= MAX-RANGE) THEN
048300                    PERFORM PASS
048400     ELSE
048500                    MOVE WS-NUM TO COMPUTED-N
048600                    MOVE MIN-RANGE TO CORRECT-MIN
048700                    MOVE MAX-RANGE TO CORRECT-MAX
048800                    PERFORM FAIL.
048900     GO TO F-VARIANCE-WRITE-07.
049000 F-VARIANCE-DELETE-07.
049100     PERFORM  DE-LETE.
049200     GO TO    F-VARIANCE-WRITE-07.
049300 F-VARIANCE-WRITE-07.
049400     MOVE "F-VARIANCE-07" TO PAR-NAME.
049500     PERFORM  PRINT-DETAIL.
049600*****************TEST (h) - SIMPLE TEST*****************
049700 F-VARIANCE-08.
049800     MOVE ZERO TO WS-NUM.
049900     MOVE  2.66661 TO MIN-RANGE.
050000     MOVE  2.66671 TO MAX-RANGE.
050100 F-VARIANCE-TEST-08.
050200     COMPUTE WS-NUM =
050300            FUNCTION VARIANCE(IND(P), IND(Q), IND(R)).
050400     IF (WS-NUM >= MIN-RANGE) AND
050500        (WS-NUM <= MAX-RANGE) THEN
050600                    PERFORM PASS
050700     ELSE
050800                    MOVE WS-NUM TO COMPUTED-N
050900                    MOVE MIN-RANGE TO CORRECT-MIN
051000                    MOVE MAX-RANGE TO CORRECT-MAX
051100                    PERFORM FAIL.
051200     GO TO F-VARIANCE-WRITE-08.
051300 F-VARIANCE-DELETE-08.
051400     PERFORM  DE-LETE.
051500     GO TO    F-VARIANCE-WRITE-08.
051600 F-VARIANCE-WRITE-08.
051700     MOVE "F-VARIANCE-08" TO PAR-NAME.
051800     PERFORM  PRINT-DETAIL.
051900*****************TEST (i) - SIMPLE TEST*****************
052000 F-VARIANCE-09.
052100     MOVE ZERO TO WS-NUM.
052200     MOVE 5.35989 TO MIN-RANGE.
052300     MOVE 5.36011 TO MAX-RANGE.
052400 F-VARIANCE-TEST-09.
052500     COMPUTE WS-NUM = FUNCTION VARIANCE(IND(ALL)).
052600     IF (WS-NUM >= MIN-RANGE) AND
052700        (WS-NUM <= MAX-RANGE) THEN
052800                    PERFORM PASS
052900     ELSE
053000                    MOVE WS-NUM TO COMPUTED-N
053100                    MOVE MIN-RANGE TO CORRECT-MIN
053200                    MOVE MAX-RANGE TO CORRECT-MAX
053300                    PERFORM FAIL.
053400     GO TO F-VARIANCE-WRITE-09.
053500 F-VARIANCE-DELETE-09.
053600     PERFORM  DE-LETE.
053700     GO TO    F-VARIANCE-WRITE-09.
053800 F-VARIANCE-WRITE-09.
053900     MOVE "F-VARIANCE-09" TO PAR-NAME.
054000     PERFORM  PRINT-DETAIL.
054100*****************TEST (k) - SIMPLE TEST*****************
054200 F-VARIANCE-11.
054300     MOVE ZERO TO WS-NUM.
054400     MOVE -0.000020 TO MIN-RANGE.
054500     MOVE  0.000020 TO MAX-RANGE.
054600 F-VARIANCE-TEST-11.
054700     COMPUTE WS-NUM = FUNCTION VARIANCE(A, 5, A).
054800     IF (WS-NUM >= MIN-RANGE) AND
054900        (WS-NUM <= MAX-RANGE) THEN
055000                    PERFORM PASS
055100     ELSE
055200                    MOVE WS-NUM TO COMPUTED-N
055300                    MOVE MIN-RANGE TO CORRECT-MIN
055400                    MOVE MAX-RANGE TO CORRECT-MAX
055500                    PERFORM FAIL.
055600     GO TO F-VARIANCE-WRITE-11.
055700 F-VARIANCE-DELETE-11.
055800     PERFORM  DE-LETE.
055900     GO TO    F-VARIANCE-WRITE-11.
056000 F-VARIANCE-WRITE-11.
056100     MOVE "F-VARIANCE-11" TO PAR-NAME.
056200     PERFORM  PRINT-DETAIL.
056300*****************TEST (a) - COMPLEX TEST****************
056400 F-VARIANCE-12.
056500     MOVE ZERO TO WS-NUM.
056600     MOVE 78.9968 TO MIN-RANGE.
056700     MOVE 79.0031 TO MAX-RANGE.
056800 F-VARIANCE-TEST-12.
056900     COMPUTE WS-NUM = FUNCTION VARIANCE(A, B) + 78.
057000     IF (WS-NUM >= MIN-RANGE) AND
057100        (WS-NUM <= MAX-RANGE) THEN
057200                    PERFORM PASS
057300     ELSE
057400                    MOVE WS-NUM TO COMPUTED-N
057500                    MOVE MIN-RANGE TO CORRECT-MIN
057600                    MOVE MAX-RANGE TO CORRECT-MAX
057700                    PERFORM FAIL.
057800     GO TO F-VARIANCE-WRITE-12.
057900 F-VARIANCE-DELETE-12.
058000     PERFORM  DE-LETE.
058100     GO TO    F-VARIANCE-WRITE-12.
058200 F-VARIANCE-WRITE-12.
058300     MOVE "F-VARIANCE-12" TO PAR-NAME.
058400     PERFORM  PRINT-DETAIL.
058500*****************TEST (b) - COMPLEX TEST****************
058600 F-VARIANCE-13.
058700     MOVE ZERO TO WS-NUM.
058800     MOVE  139.234 TO MIN-RANGE.
058900     MOVE  139.245 TO MAX-RANGE.
059000 F-VARIANCE-TEST-13.
059100     COMPUTE WS-NUM = FUNCTION VARIANCE(2.6 + 30, 4.5 * 2).
059200     IF (WS-NUM >= MIN-RANGE) AND
059300        (WS-NUM <= MAX-RANGE) THEN
059400                    PERFORM PASS
059500     ELSE
059600                    MOVE WS-NUM TO COMPUTED-N
059700                    MOVE MIN-RANGE TO CORRECT-MIN
059800                    MOVE MAX-RANGE TO CORRECT-MAX
059900                    PERFORM FAIL.
060000     GO TO F-VARIANCE-WRITE-13.
060100 F-VARIANCE-DELETE-13.
060200     PERFORM  DE-LETE.
060300     GO TO    F-VARIANCE-WRITE-13.
060400 F-VARIANCE-WRITE-13.
060500     MOVE "F-VARIANCE-13" TO PAR-NAME.
060600     PERFORM  PRINT-DETAIL.
060700*****************TEST (c) - COMPLEX TEST****************
060800 F-VARIANCE-14.
060900     MOVE ZERO TO WS-NUM.
061000     MOVE  374.658 TO MIN-RANGE.
061100     MOVE  374.688 TO MAX-RANGE.
061200 F-VARIANCE-TEST-14.
061300     COMPUTE WS-NUM = FUNCTION VARIANCE(E, 9 * A, 0, B / 2).
061400     IF (WS-NUM >= MIN-RANGE) AND
061500        (WS-NUM <= MAX-RANGE) THEN
061600                    PERFORM PASS
061700     ELSE
061800                    MOVE WS-NUM TO COMPUTED-N
061900                    MOVE MIN-RANGE TO CORRECT-MIN
062000                    MOVE MAX-RANGE TO CORRECT-MAX
062100                    PERFORM FAIL.
062200     GO TO F-VARIANCE-WRITE-14.
062300 F-VARIANCE-DELETE-14.
062400     PERFORM  DE-LETE.
062500     GO TO    F-VARIANCE-WRITE-14.
062600 F-VARIANCE-WRITE-14.
062700     MOVE "F-VARIANCE-14" TO PAR-NAME.
062800     PERFORM  PRINT-DETAIL.
062900*****************TEST (d) - COMPLEX TEST****************
063000 F-VARIANCE-15.
063100     MOVE ZERO TO WS-NUM.
063200     MOVE 0.999960 TO MIN-RANGE.
063300     MOVE 1.00004 TO MAX-RANGE.
063400 F-VARIANCE-TEST-15.
063500     COMPUTE WS-NUM = FUNCTION VARIANCE(A, B) +
063600                      FUNCTION VARIANCE(1, 1).
063700     IF (WS-NUM >= MIN-RANGE) AND
063800        (WS-NUM <= MAX-RANGE) THEN
063900                    PERFORM PASS
064000     ELSE
064100                    MOVE WS-NUM TO COMPUTED-N
064200                    MOVE MIN-RANGE TO CORRECT-MIN
064300                    MOVE MAX-RANGE TO CORRECT-MAX
064400                    PERFORM FAIL.
064500     GO TO F-VARIANCE-WRITE-15.
064600 F-VARIANCE-DELETE-15.
064700     PERFORM  DE-LETE.
064800     GO TO    F-VARIANCE-WRITE-15.
064900 F-VARIANCE-WRITE-15.
065000     MOVE "F-VARIANCE-15" TO PAR-NAME.
065100     PERFORM  PRINT-DETAIL.
065200*****************TEST (e) - COMPLEX TEST****************
065300 F-VARIANCE-16.
065400     MOVE ZERO TO WS-NUM.
065500     MOVE -0.000040 TO MIN-RANGE.
065600     MOVE 0.000040 TO MAX-RANGE.
065700 F-VARIANCE-TEST-16.
065800     COMPUTE WS-NUM = FUNCTION VARIANCE(
065900                      FUNCTION VARIANCE(0), 0).
066000     IF (WS-NUM >= MIN-RANGE) AND
066100        (WS-NUM <= MAX-RANGE) THEN
066200                    PERFORM PASS
066300     ELSE
066400                    MOVE WS-NUM TO COMPUTED-N
066500                    MOVE MIN-RANGE TO CORRECT-MIN
066600                    MOVE MAX-RANGE TO CORRECT-MAX
066700                    PERFORM FAIL.
066800     GO TO F-VARIANCE-WRITE-16.
066900 F-VARIANCE-DELETE-16.
067000     PERFORM  DE-LETE.
067100     GO TO    F-VARIANCE-WRITE-16.
067200 F-VARIANCE-WRITE-16.
067300     MOVE "F-VARIANCE-16" TO PAR-NAME.
067400     PERFORM  PRINT-DETAIL.
067500*****************SPECIAL PERFORM TEST**********************
067600 F-VARIANCE-17.
067700     PERFORM F-VARIANCE-TEST-17
067800       UNTIL FUNCTION VARIANCE(1, 1, ARG3) > 3.
067900     PERFORM PASS.
068000     GO TO F-VARIANCE-WRITE-17.
068100 F-VARIANCE-TEST-17.
068200     COMPUTE ARG3 = ARG3 + 1.
068300 F-VARIANCE-DELETE-17.
068400     PERFORM  DE-LETE.
068500     GO TO    F-VARIANCE-WRITE-17.
068600 F-VARIANCE-WRITE-17.
068700     MOVE "F-VARIANCE-17" TO PAR-NAME.
068800     PERFORM  PRINT-DETAIL.
068900********************END OF TESTS***************
069000 CCVS-EXIT SECTION.
069100 CCVS-999999.
069200     GO TO CLOSE-FILES.
