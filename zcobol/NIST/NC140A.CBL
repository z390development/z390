000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     NC140A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*
002200*    PROGRAM NC140A TESTS FORMAT 2 OF THE "SET" STATEMENT
002300*    USING A VARIETY OF DATA-NAMES CONTAINING POSITIVE AND
002400*    NEGATIVE VALUES, AS WELL AS POSITIVE AND NEGATIVE INTEGERS.
002500*
002600****************************************************************
002700 ENVIRONMENT DIVISION.
002800 CONFIGURATION SECTION.
002900 SOURCE-COMPUTER.
003000     XXXXX082.
003100 OBJECT-COMPUTER.
003200     XXXXX083.
003300 INPUT-OUTPUT SECTION.
003400 FILE-CONTROL.
003500     SELECT PRINT-FILE ASSIGN TO
003600     XXXXX055.
003700 DATA DIVISION.
003800 FILE SECTION.
003900 FD  PRINT-FILE.
004000 01  PRINT-REC PICTURE X(120).
004100 01  DUMMY-RECORD PICTURE X(120).
004200 WORKING-STORAGE SECTION.
004300 01  GRP-TABLE1.
004400     02  ELEM1  PIC S999    OCCURS 100 TIMES
004500              INDEXED BY INDEX1.
004600*    TWO DIMENSIONAL TABLE.
004700 01  GRP-TABLE2.
004800     02  GROUP1    OCCURS 10 TIMES
004900              INDEXED BY IN1.
005000         03  ELEM2  PIC S9999
005100              USAGE IS COMPUTATIONAL
005200              OCCURS 10 TIMES
005300              INDEXED BY IN2.
005400*    SUBSCRIPTS FOR TABLE REFERENCES.
005500 01  GRP-SUB.
005600     02  S1  PIC  S999  VALUE 1.
005700     02  S21 PIC  S999  VALUE 1.
005800     02  S22 PIC  S999  VALUE 1.
005900*    DATA ITEMS USED IN SET STATEMENTS, FORMAT 2.
006000 77  CS-3     PICTURE S999    COMPUTATIONAL   VALUE ZERO.
006100 77  CU-3     PICTURE  999    COMPUTATIONAL   VALUE ZERO.
006200 77  DS-3     PICTURE S999    DISPLAY         VALUE ZERO.
006300 77  DU-3     PICTURE  999    DISPLAY         VALUE ZERO.
006400 77  DS-LS-3  PICTURE S999    SIGN IS LEADING SEPARATE CHARACTER
006500              VALUE ZERO.
006600 77  DS-TS-3  PICTURE S999    SIGN IS TRAILING SEPARATE
006700               CHARACTER  VALUE ZERO.
006800 77  EXPECTED-VALUE  PIC S999.
006900 77  TEMP  PICTURE S999.
007000 77  WRK1   PIC   S999   VALUE ZERO.
007100 01  TEST-RESULTS.
007200     02 FILLER                   PIC X      VALUE SPACE.
007300     02 FEATURE                  PIC X(20)  VALUE SPACE.
007400     02 FILLER                   PIC X      VALUE SPACE.
007500     02 P-OR-F                   PIC X(5)   VALUE SPACE.
007600     02 FILLER                   PIC X      VALUE SPACE.
007700     02  PAR-NAME.
007800       03 FILLER                 PIC X(19)  VALUE SPACE.
007900       03  PARDOT-X              PIC X      VALUE SPACE.
008000       03 DOTVALUE               PIC 99     VALUE ZERO.
008100     02 FILLER                   PIC X(8)   VALUE SPACE.
008200     02 RE-MARK                  PIC X(61).
008300 01  TEST-COMPUTED.
008400     02 FILLER                   PIC X(30)  VALUE SPACE.
008500     02 FILLER                   PIC X(17)  VALUE
008600            "       COMPUTED=".
008700     02 COMPUTED-X.
008800     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
008900     03 COMPUTED-N               REDEFINES COMPUTED-A
009000                                 PIC -9(9).9(9).
009100     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
009200     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
009300     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
009400     03       CM-18V0 REDEFINES COMPUTED-A.
009500         04 COMPUTED-18V0                    PIC -9(18).
009600         04 FILLER                           PIC X.
009700     03 FILLER PIC X(50) VALUE SPACE.
009800 01  TEST-CORRECT.
009900     02 FILLER PIC X(30) VALUE SPACE.
010000     02 FILLER PIC X(17) VALUE "       CORRECT =".
010100     02 CORRECT-X.
010200     03 CORRECT-A                  PIC X(20) VALUE SPACE.
010300     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
010400     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
010500     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
010600     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
010700     03      CR-18V0 REDEFINES CORRECT-A.
010800         04 CORRECT-18V0                     PIC -9(18).
010900         04 FILLER                           PIC X.
011000     03 FILLER PIC X(2) VALUE SPACE.
011100     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
011200 01  CCVS-C-1.
011300     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
011400-    "SS  PARAGRAPH-NAME
011500-    "       REMARKS".
011600     02 FILLER                     PIC X(20)    VALUE SPACE.
011700 01  CCVS-C-2.
011800     02 FILLER                     PIC X        VALUE SPACE.
011900     02 FILLER                     PIC X(6)     VALUE "TESTED".
012000     02 FILLER                     PIC X(15)    VALUE SPACE.
012100     02 FILLER                     PIC X(4)     VALUE "FAIL".
012200     02 FILLER                     PIC X(94)    VALUE SPACE.
012300 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
012400 01  REC-CT                        PIC 99       VALUE ZERO.
012500 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
012600 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
012700 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
012800 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
012900 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
013000 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
013100 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
013200 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
013300 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
013400 01  CCVS-H-1.
013500     02  FILLER                    PIC X(39)    VALUE SPACES.
013600     02  FILLER                    PIC X(42)    VALUE
013700     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
013800     02  FILLER                    PIC X(39)    VALUE SPACES.
013900 01  CCVS-H-2A.
014000   02  FILLER                        PIC X(40)  VALUE SPACE.
014100   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
014200   02  FILLER                        PIC XXXX   VALUE
014300     "4.2 ".
014400   02  FILLER                        PIC X(28)  VALUE
014500            " COPY - NOT FOR DISTRIBUTION".
014600   02  FILLER                        PIC X(41)  VALUE SPACE.
014700
014800 01  CCVS-H-2B.
014900   02  FILLER                        PIC X(15)  VALUE
015000            "TEST RESULT OF ".
015100   02  TEST-ID                       PIC X(9).
015200   02  FILLER                        PIC X(4)   VALUE
015300            " IN ".
015400   02  FILLER                        PIC X(12)  VALUE
015500     " HIGH       ".
015600   02  FILLER                        PIC X(22)  VALUE
015700            " LEVEL VALIDATION FOR ".
015800   02  FILLER                        PIC X(58)  VALUE
015900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
016000 01  CCVS-H-3.
016100     02  FILLER                      PIC X(34)  VALUE
016200            " FOR OFFICIAL USE ONLY    ".
016300     02  FILLER                      PIC X(58)  VALUE
016400     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
016500     02  FILLER                      PIC X(28)  VALUE
016600            "  COPYRIGHT   1985 ".
016700 01  CCVS-E-1.
016800     02 FILLER                       PIC X(52)  VALUE SPACE.
016900     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
017000     02 ID-AGAIN                     PIC X(9).
017100     02 FILLER                       PIC X(45)  VALUE SPACES.
017200 01  CCVS-E-2.
017300     02  FILLER                      PIC X(31)  VALUE SPACE.
017400     02  FILLER                      PIC X(21)  VALUE SPACE.
017500     02 CCVS-E-2-2.
017600         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
017700         03 FILLER                   PIC X      VALUE SPACE.
017800         03 ENDER-DESC               PIC X(44)  VALUE
017900            "ERRORS ENCOUNTERED".
018000 01  CCVS-E-3.
018100     02  FILLER                      PIC X(22)  VALUE
018200            " FOR OFFICIAL USE ONLY".
018300     02  FILLER                      PIC X(12)  VALUE SPACE.
018400     02  FILLER                      PIC X(58)  VALUE
018500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
018600     02  FILLER                      PIC X(13)  VALUE SPACE.
018700     02 FILLER                       PIC X(15)  VALUE
018800             " COPYRIGHT 1985".
018900 01  CCVS-E-4.
019000     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
019100     02 FILLER                       PIC X(4)   VALUE " OF ".
019200     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
019300     02 FILLER                       PIC X(40)  VALUE
019400      "  TESTS WERE EXECUTED SUCCESSFULLY".
019500 01  XXINFO.
019600     02 FILLER                       PIC X(19)  VALUE
019700            "*** INFORMATION ***".
019800     02 INFO-TEXT.
019900       04 FILLER                     PIC X(8)   VALUE SPACE.
020000       04 XXCOMPUTED                 PIC X(20).
020100       04 FILLER                     PIC X(5)   VALUE SPACE.
020200       04 XXCORRECT                  PIC X(20).
020300     02 INF-ANSI-REFERENCE           PIC X(48).
020400 01  HYPHEN-LINE.
020500     02 FILLER  PIC IS X VALUE IS SPACE.
020600     02 FILLER  PIC IS X(65)    VALUE IS "************************
020700-    "*****************************************".
020800     02 FILLER  PIC IS X(54)    VALUE IS "************************
020900-    "******************************".
021000 01  CCVS-PGM-ID                     PIC X(9)   VALUE
021100     "NC140A".
021200 PROCEDURE DIVISION.
021300 CCVS1 SECTION.
021400 OPEN-FILES.
021500     OPEN     OUTPUT PRINT-FILE.
021600     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
021700     MOVE    SPACE TO TEST-RESULTS.
021800     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
021900     GO TO CCVS1-EXIT.
022000 CLOSE-FILES.
022100     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
022200 TERMINATE-CCVS.
022300S    EXIT PROGRAM.
022400STERMINATE-CALL.
022500     STOP     RUN.
022600 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
022700 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
022800 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
022900 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
023000     MOVE "****TEST DELETED****" TO RE-MARK.
023100 PRINT-DETAIL.
023200     IF REC-CT NOT EQUAL TO ZERO
023300             MOVE "." TO PARDOT-X
023400             MOVE REC-CT TO DOTVALUE.
023500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
023600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
023700        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
023800          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
023900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
024000     MOVE SPACE TO CORRECT-X.
024100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
024200     MOVE     SPACE TO RE-MARK.
024300 HEAD-ROUTINE.
024400     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024500     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024600     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
024700     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
024800 COLUMN-NAMES-ROUTINE.
024900     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025000     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
025200 END-ROUTINE.
025300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
025400 END-RTN-EXIT.
025500     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025600 END-ROUTINE-1.
025700      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
025800      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
025900      ADD PASS-COUNTER TO ERROR-HOLD.
026000*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
026100      MOVE PASS-COUNTER TO CCVS-E-4-1.
026200      MOVE ERROR-HOLD TO CCVS-E-4-2.
026300      MOVE CCVS-E-4 TO CCVS-E-2-2.
026400      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
026500  END-ROUTINE-12.
026600      MOVE "TEST(S) FAILED" TO ENDER-DESC.
026700     IF       ERROR-COUNTER IS EQUAL TO ZERO
026800         MOVE "NO " TO ERROR-TOTAL
026900         ELSE
027000         MOVE ERROR-COUNTER TO ERROR-TOTAL.
027100     MOVE     CCVS-E-2 TO DUMMY-RECORD.
027200     PERFORM WRITE-LINE.
027300 END-ROUTINE-13.
027400     IF DELETE-COUNTER IS EQUAL TO ZERO
027500         MOVE "NO " TO ERROR-TOTAL  ELSE
027600         MOVE DELETE-COUNTER TO ERROR-TOTAL.
027700     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
027800     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027900      IF   INSPECT-COUNTER EQUAL TO ZERO
028000          MOVE "NO " TO ERROR-TOTAL
028100      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
028200      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
028300      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028400     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028500 WRITE-LINE.
028600     ADD 1 TO RECORD-COUNT.
028700Y    IF RECORD-COUNT GREATER 42
028800Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
028900Y        MOVE SPACE TO DUMMY-RECORD
029000Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
029100Y        MOVE CCVS-H-1  TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
029200Y        MOVE CCVS-H-2A TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
029300Y        MOVE CCVS-H-2B TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
029400Y        MOVE CCVS-H-3  TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
029500Y        MOVE CCVS-C-1  TO DUMMY-RECORD  PERFORM WRT-LN
029600Y        MOVE CCVS-C-2  TO DUMMY-RECORD  PERFORM WRT-LN
029700Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
029800Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
029900Y        MOVE ZERO TO RECORD-COUNT.
030000     PERFORM WRT-LN.
030100 WRT-LN.
030200     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
030300     MOVE SPACE TO DUMMY-RECORD.
030400 BLANK-LINE-PRINT.
030500     PERFORM WRT-LN.
030600 FAIL-ROUTINE.
030700     IF     COMPUTED-X NOT EQUAL TO SPACE
030800            GO TO FAIL-ROUTINE-WRITE.
030900     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
031000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
031100     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
031200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031300     MOVE   SPACES TO INF-ANSI-REFERENCE.
031400     GO TO  FAIL-ROUTINE-EX.
031500 FAIL-ROUTINE-WRITE.
031600     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
031700     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
031800     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
031900     MOVE   SPACES TO COR-ANSI-REFERENCE.
032000 FAIL-ROUTINE-EX. EXIT.
032100 BAIL-OUT.
032200     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
032300     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
032400 BAIL-OUT-WRITE.
032500     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
032600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
032700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032800     MOVE   SPACES TO INF-ANSI-REFERENCE.
032900 BAIL-OUT-EX. EXIT.
033000 CCVS1-EXIT.
033100     EXIT.
033200**********************************
033300*STATEMENT DELETION INSTRUCTIONS
033400*       IF THE COMPILER REJECTS ANY SET STATEMENTS IN THESE TESTS,
033500*    DELETE THAT LINE OF CODE BY PLACING AN * IN COLUMN 7.  LEAVE
033600*    THE PERFORM ... THRU STATEMENT.  THE TEST DELETED APPEARS AS
033700*    A FAILURE ON THE OUTPUT REPORT.
033800**********************************
033900 SECT-NC140A-0001 SECTION.
034000 NC140A-0001.
034100     MOVE "VI-127 6.22.4" TO ANSI-REFERENCE.
034200*    THIS SECTION STORES VALUES IN THE TWO TABLES
034300*    USED IN TESTING THE INDEX VALUES.
034400 MOVE-VALUE.
034500     ADD 1 TO WRK1.
034600     MOVE WRK1 TO ELEM1 (S1) ELEM2 (S21 S22).
034700     IF WRK1 IS EQUAL TO 100
034800              GO TO SECT-TH111-0002.
034900 INCRE-SUBS.
035000     ADD 1 TO S1.
035100     ADD 1 TO S22.
035200     IF S22 LESS THAN 11
035300              GO TO MOVE-VALUE.
035400     MOVE 1 TO S22.
035500     ADD 1 TO S21.
035600     GO TO MOVE-VALUE.
035700 SECT-TH111-0002 SECTION.
035800 SET-INIT-001.
035900     MOVE ZERO TO REC-CT.
036000*        THIS TEST VERIFIES THAT THE SET INDEX-NAME UP BY INTEGER
036100*    FUNCTIONS CORRECTLY. THE INTEGER MAY BE POSITIVE, NEGATIVE,
036200*    OR UNSIGNED.
036300     MOVE ZERO TO TEMP.
036400     MOVE 6 TO EXPECTED-VALUE.
036500     MOVE "SET IN UP BY INTEGER" TO FEATURE.
036600     MOVE "SET-TEST-001" TO PAR-NAME.
036700 SET-TEST-001-01.
036800     SET INDEX1 TO 1.
036900     SET INDEX1 UP BY 5.
037000     PERFORM TEST-CHECK1 THRU TEST-WRITE.
037100 SET-TEST-001-02.
037200     SET INDEX1 TO 1.
037300     SET INDEX1 UP BY +5.
037400     PERFORM TEST-CHECK1 THRU TEST-WRITE.
037500 SET-TEST-001-03.
037600     SET INDEX1 TO 11.
037700     SET INDEX1 UP BY -5.
037800     PERFORM TEST-CHECK1 THRU TEST-WRITE.
037900 SET-TEST-001-04.
038000     SET IN1 TO 1.
038100     SET IN2 INDEX1 TO 2.
038200     SET IN2 INDEX1 UP BY 4.
038300     PERFORM TEST-CHECK1 THRU TEST-WRITE.
038400 SET-TEST-001-05.
038500     PERFORM TEST-CHECK2 THRU TEST-WRITE.
038600 SET-TEST-001-06.
038700     SET IN2 INDEX1 TO 2.
038800     SET IN2 INDEX1 UP BY +4.
038900     PERFORM TEST-CHECK1 THRU TEST-WRITE.
039000 SET-TEST-001-07.
039100     PERFORM TEST-CHECK2 THRU TEST-WRITE.
039200 SET-TEST-001-08.
039300     SET IN2 INDEX1 TO 10.
039400     SET IN2 INDEX1 UP BY -4.
039500     PERFORM TEST-CHECK1 THRU TEST-WRITE.
039600 SET-TEST-001-09.
039700     PERFORM TEST-CHECK2 THRU TEST-WRITE.
039800 SET-TEST-001-10.
039900     SET IN1 TO 5.
040000     SET IN2 TO 10.
040100     SET IN1 IN2 UP BY -4.
040200     PERFORM TEST-CHECK2 THRU TEST-WRITE.
040300 SET-TEST-001-11.
040400     SET IN2 INDEX1 TO 10.
040500     SET IN1 TO 5.
040600     SET IN1 IN2 INDEX1 UP BY -4.
040700     PERFORM TEST-CHECK1 THRU TEST-WRITE.
040800 SET-TEST-001-12.
040900     PERFORM TEST-CHECK2 THRU TEST-WRITE.
041000     GO TO SET-INIT-002.
041100 SET-DELETE-001.
041200     PERFORM DE-LETE.
041300     PERFORM TEST-WRITE.
041400 SET-INIT-002.
041500     MOVE ZERO TO REC-CT.
041600     MOVE "SET-TEST-002" TO PAR-NAME.
041700     MOVE ZERO TO TEMP.
041800     MOVE 54 TO EXPECTED-VALUE.
041900     MOVE "SET IN DOWN BY INTEG" TO FEATURE.
042000*       THIS TEST VERIFIES THAT THE SET INDEX-NAME DOWN BY
042100*    INTEGER FUNCTIONS CORRECTLY.  THE INTEGER MAY BE POSITIVE,
042200*    NEGATIVE, OR UNSIGNED.
042300 SET-TEST-002-01.
042400     SET INDEX1 TO 95.
042500     SET INDEX1 DOWN BY 41.
042600     PERFORM TEST-CHECK1 THRU TEST-WRITE.
042700 SET-TEST-002-02.
042800     SET INDEX1 TO 95.
042900     SET INDEX1 DOWN BY +41.
043000     PERFORM TEST-CHECK1 THRU TEST-WRITE.
043100 SET-TEST-002-03.
043200     SET INDEX1 TO 21.
043300     SET INDEX1 DOWN BY -33.
043400     PERFORM TEST-CHECK1 THRU TEST-WRITE.
043500 SET-TEST-002-04.
043600     SET IN1 TO 9.
043700     SET IN2 TO 4.
043800     SET INDEX1 TO 57.
043900     SET IN1 INDEX1 DOWN BY 3.
044000     PERFORM TEST-CHECK1 THRU TEST-WRITE.
044100 SET-TEST-002-05.
044200     PERFORM TEST-CHECK2 THRU TEST-WRITE.
044300 SET-TEST-002-06.
044400     SET IN1 TO 9.
044500     SET INDEX1 TO 57.
044600     SET IN1 INDEX1 DOWN BY +3.
044700     PERFORM TEST-CHECK1 THRU TEST-WRITE.
044800 SET-TEST-002-07.
044900     PERFORM TEST-CHECK2 THRU TEST-WRITE.
045000 SET-TEST-002-08.
045100     SET IN1 TO 3.
045200     SET INDEX1 TO 51.
045300     SET INDEX1 IN1 DOWN BY -3.
045400     PERFORM TEST-CHECK1 THRU TEST-WRITE.
045500 SET-TEST-002-09.
045600     PERFORM TEST-CHECK2 THRU TEST-WRITE.
045700 SET-TEST-002-10.
045800     SET IN1 TO 4.
045900     SET IN2 TO 2.
046000     SET IN1 IN2 DOWN BY -2.
046100     PERFORM TEST-CHECK2 THRU TEST-WRITE.
046200 SET-TEST-002-11.
046300     SET IN1 TO 5.
046400     SET IN2 TO 3.
046500     SET INDEX1 TO 53.
046600     SET IN1 IN2 INDEX1 DOWN BY -1.
046700     PERFORM TEST-CHECK1 THRU TEST-WRITE.
046800 SET-TEST-002-12.
046900     PERFORM TEST-CHECK2 THRU TEST-WRITE.
047000     GO TO SET-INIT-003.
047100 SET-DELETE-002.
047200     PERFORM DE-LETE.
047300     PERFORM TEST-WRITE.
047400 SET-INIT-003.
047500     MOVE ZERO TO REC-CT.
047600     MOVE "SET-TEST-003" TO PAR-NAME.
047700     MOVE ZERO TO TEMP.
047800     MOVE 39 TO EXPECTED-VALUE.
047900     MOVE "SET IN UP BY DATA-NM" TO FEATURE.
048000*        THIS TEST VERIFIES THAT THE SET INDEX-NAME UP BY
048100*    DATA-NAME FUNCTIONS CORRECTLY.  THE VALUE STORED IN DATA-NAME
048200*    MAY BE POSITIVE, NEGATIVE OR ZERO.  VARIOUS DATA TYPES ARE
048300*    USED IN THE TEST.
048400 SET-TEST-003-01.
048500     SET INDEX1 TO 21.
048600     MOVE +18 TO CS-3.
048700     SET INDEX1 UP BY CS-3.
048800     PERFORM TEST-CHECK1 THRU TEST-WRITE.
048900 SET-TEST-003-02.
049000     SET INDEX1 TO 21.
049100     MOVE +18 TO DS-3.
049200     SET INDEX1 UP BY DS-3.
049300     PERFORM TEST-CHECK1 THRU TEST-WRITE.
049400 SET-TEST-003-03.
049500     SET INDEX1 TO 21.
049600     MOVE +18 TO DS-LS-3.
049700     SET INDEX1  UP BY DS-LS-3.
049800     PERFORM TEST-CHECK1 THRU TEST-WRITE.
049900 SET-TEST-003-04.
050000     SET INDEX1 TO 21.
050100     MOVE +18 TO DS-TS-3.
050200     SET INDEX1 UP BY DS-TS-3.
050300     PERFORM TEST-CHECK1 THRU TEST-WRITE.
050400 SET-TEST-003-05.
050500     SET INDEX1 TO 21.
050600     MOVE 18 TO CU-3.
050700     SET INDEX1 UP BY CU-3.
050800     PERFORM TEST-CHECK1 THRU TEST-WRITE.
050900 SET-TEST-003-06.
051000     SET INDEX1 TO 21.
051100     MOVE 18 TO DU-3.
051200     SET INDEX1 UP BY DU-3.
051300     PERFORM TEST-CHECK1 THRU TEST-WRITE.
051400 SET-TEST-003-07.
051500     SET INDEX1 TO 39.
051600     MOVE 0 TO CS-3.
051700     SET INDEX1 UP BY CS-3.
051800     PERFORM TEST-CHECK1 THRU TEST-WRITE.
051900 SET-TEST-003-08.
052000     SET INDEX1 TO 39.
052100     MOVE ZERO TO DS-3.
052200     SET INDEX1 UP BY DS-3.
052300     PERFORM TEST-CHECK1 THRU TEST-WRITE.
052400 SET-TEST-003-09.
052500     SET INDEX1 TO 39.
052600     MOVE 0 TO DS-LS-3.
052700     SET INDEX1 UP BY DS-LS-3.
052800     PERFORM TEST-CHECK1 THRU TEST-WRITE.
052900 SET-TEST-003-10.
053000     SET INDEX1 TO 39.
053100     MOVE ZERO TO DS-TS-3.
053200     SET INDEX1 UP BY DS-TS-3.
053300     PERFORM TEST-CHECK1 THRU TEST-WRITE.
053400 SET-TEST-003-11.
053500     SET INDEX1 TO 39.
053600     MOVE 0 TO CU-3.
053700     SET INDEX1 UP BY CU-3.
053800     PERFORM TEST-CHECK1 THRU TEST-WRITE.
053900 SET-TEST-003-12.
054000     SET INDEX1 TO 39.
054100     MOVE ZERO TO DU-3.
054200     SET INDEX1 UP BY DU-3.
054300     PERFORM TEST-CHECK1 THRU TEST-WRITE.
054400 SET-TEST-003-13.
054500     SET INDEX1 TO 70.
054600     MOVE -31 TO CS-3.
054700     SET INDEX1 UP BY CS-3.
054800     PERFORM TEST-CHECK1 THRU TEST-WRITE.
054900 SET-TEST-003-14.
055000     SET INDEX1 TO 70.
055100     MOVE -31 TO DS-3.
055200     SET INDEX1 UP BY DS-3.
055300     PERFORM TEST-CHECK1 THRU TEST-WRITE.
055400 SET-TEST-003-15.
055500     SET INDEX1 TO 70.
055600     MOVE -31 TO DS-LS-3.
055700     SET INDEX1 UP BY DS-LS-3.
055800     PERFORM TEST-CHECK1 THRU TEST-WRITE.
055900 SET-TEST-003-16.
056000     SET INDEX1 TO 70.
056100     MOVE -31 TO DS-TS-3.
056200     SET INDEX1 UP BY DS-TS-3.
056300     PERFORM TEST-CHECK1 THRU TEST-WRITE.
056400 SET-TEST-003-17.
056500     SET IN1 TO 1.
056600     SET IN2 TO 6.
056700     MOVE +3 TO DS-LS-3.
056800     SET IN1 IN2 UP BY DS-LS-3.
056900     PERFORM TEST-CHECK1 THRU TEST-WRITE.
057000 SET-TEST-003-18.
057100     SET IN1 TO 1.
057200     SET IN2 TO 6.
057300     MOVE +3 TO CS-3.
057400     SET INDEX1 TO 36.
057500     SET IN1 IN2 INDEX1 UP BY CS-3.
057600     PERFORM TEST-CHECK1 THRU TEST-WRITE.
057700 SET-TEST-003-19.
057800     PERFORM TEST-CHECK2 THRU TEST-WRITE.
057900 SET-TEST-003-20.
058000     SET IN1 TO 5.
058100     SET IN2 TO 10.
058200     SET INDEX1 TO 40.
058300     MOVE -1 TO DS-TS-3.
058400     SET IN1 IN2 INDEX1 UP BY DS-TS-3.
058500     PERFORM TEST-CHECK1 THRU TEST-WRITE.
058600 SET-TEST-003-21.
058700     PERFORM TEST-CHECK2 THRU TEST-WRITE.
058800 SET-TEST-003-22.
058900     SET IN1 TO 4.
059000     SET IN2 TO 9.
059100     SET INDEX1 TO 39.
059200     MOVE ZERO TO CU-3.
059300     SET IN1 IN2 INDEX1 UP BY CU-3.
059400     PERFORM TEST-CHECK1 THRU TEST-WRITE.
059500 SET-TEST-003-23.
059600     PERFORM TEST-CHECK2 THRU TEST-WRITE.
059700     GO TO SET-INIT-004.
059800 SET-DELETE-003.
059900     PERFORM DE-LETE.
060000     PERFORM TEST-WRITE.
060100 SET-INIT-004.
060200     MOVE ZERO TO REC-CT.
060300     MOVE "SET-TEST-004" TO PAR-NAME.
060400     MOVE ZERO TO TEMP.
060500     MOVE 77 TO EXPECTED-VALUE.
060600     MOVE "SET IN DOWN BY DNAME" TO FEATURE.
060700*        THIS TEST VERIFIES THAT THE SET INDEX-NAME DOWN BY
060800*    DATA-NAME FUNCTIONS CORRECTLY.  THE VALUE STORED IN DATA-NAME
060900*    MAY BE POSITIVE, NEGATIVE OR ZERO.  VARIOUS DATA TYPES ARE
061000*    USED IN THE TEST.
061100 SET-TEST-004-01.
061200     SET INDEX1 TO 100.
061300     MOVE +23 TO CS-3.
061400     SET INDEX1 DOWN BY CS-3.
061500     PERFORM TEST-CHECK1 THRU TEST-WRITE.
061600 SET-TEST-004-02.
061700     SET INDEX1 TO 100.
061800     MOVE +23 TO DS-3.
061900     SET INDEX1 DOWN BY DS-3.
062000     PERFORM TEST-CHECK1 THRU TEST-WRITE.
062100 SET-TEST-004-03.
062200     SET INDEX1 TO 100.
062300     MOVE +23 TO DS-LS-3.
062400     SET INDEX1 DOWN BY DS-LS-3.
062500     PERFORM TEST-CHECK1 THRU TEST-WRITE.
062600 SET-TEST-004-04.
062700     SET INDEX1 TO 100.
062800     MOVE +23 TO DS-TS-3.
062900     SET INDEX1 DOWN BY DS-TS-3.
063000     PERFORM TEST-CHECK1 THRU TEST-WRITE.
063100 SET-TEST-004-05.
063200     SET INDEX1 TO 100.
063300     MOVE 23 TO CU-3.
063400     SET INDEX1 DOWN BY CU-3.
063500     PERFORM TEST-CHECK1 THRU TEST-WRITE.
063600 SET-TEST-004-06.
063700     SET INDEX1 TO 100.
063800     MOVE 23 TO DU-3.
063900     SET INDEX1 DOWN BY DU-3.
064000     PERFORM TEST-CHECK1 THRU TEST-WRITE.
064100 SET-TEST-004-07.
064200     MOVE ZERO TO CS-3.
064300     SET INDEX1 TO 77.
064400     SET INDEX1 DOWN BY CS-3.
064500     PERFORM TEST-CHECK1 THRU TEST-WRITE.
064600 SET-TEST-004-08.
064700     MOVE 0 TO DS-3.
064800     SET INDEX1 TO 77.
064900     SET INDEX1 DOWN BY DS-3.
065000     PERFORM TEST-CHECK1 THRU TEST-WRITE.
065100 SET-TEST-004-09.
065200     MOVE 0 TO DS-LS-3.
065300     SET INDEX1 TO 77.
065400     SET INDEX1 DOWN BY DS-LS-3.
065500     PERFORM TEST-CHECK1 THRU TEST-WRITE.
065600 SET-TEST-004-10.
065700     MOVE ZERO TO DS-TS-3.
065800     SET INDEX1 TO 77.
065900     SET INDEX1 DOWN BY DS-TS-3.
066000     PERFORM TEST-CHECK1 THRU TEST-WRITE.
066100 SET-TEST-004-11.
066200     MOVE 0 TO CU-3.
066300     SET INDEX1 TO 77.
066400     SET INDEX1 DOWN BY CU-3.
066500     PERFORM TEST-CHECK1 THRU TEST-WRITE.
066600 SET-TEST-004-12.
066700     MOVE ZERO TO DU-3.
066800     SET INDEX1 TO 77.
066900     SET INDEX1 DOWN BY DU-3.
067000     PERFORM TEST-CHECK1 THRU TEST-WRITE.
067100 SET-TEST-004-13.
067200     SET INDEX1 TO 2.
067300     MOVE -75 TO CS-3.
067400     SET INDEX1 DOWN BY CS-3.
067500     PERFORM TEST-CHECK1 THRU TEST-WRITE.
067600 SET-TEST-004-14.
067700     SET INDEX1 TO 2.
067800     MOVE -75 TO DS-3.
067900     SET INDEX1 DOWN BY DS-3.
068000     PERFORM TEST-CHECK1 THRU TEST-WRITE.
068100 SET-TEST-004-15.
068200     SET INDEX1 TO 2.
068300     MOVE -75 TO DS-LS-3.
068400     SET INDEX1 DOWN BY DS-LS-3.
068500     PERFORM TEST-CHECK1 THRU TEST-WRITE.
068600 SET-TEST-004-16.
068700     SET INDEX1 TO 2.
068800     MOVE -75 TO DS-TS-3.
068900     SET INDEX1 DOWN BY DS-TS-3.
069000     PERFORM TEST-CHECK1 THRU TEST-WRITE.
069100 SET-TEST-004-17.
069200     SET IN1 TO 10.
069300     SET IN2 TO 9.
069400     MOVE +2 TO DS-TS-3.
069500     SET IN1 IN2 DOWN BY DS-TS-3.
069600     PERFORM TEST-CHECK2 THRU TEST-WRITE.
069700 SET-TEST-004-18.
069800     SET IN1 TO 10.
069900     SET IN2 TO 9.
070000     SET INDEX1 TO 79.
070100     MOVE 2 TO CU-3.
070200     SET IN1 IN2 INDEX1 DOWN BY CU-3.
070300     PERFORM TEST-CHECK1 THRU TEST-WRITE.
070400 SET-TEST-004-19.
070500     PERFORM TEST-CHECK2 THRU TEST-WRITE.
070600 SET-TEST-004-20.
070700     SET IN1 TO 3.
070800     SET IN2 TO 2.
070900     SET INDEX1 TO 72.
071000     MOVE -5 TO DS-3.
071100     SET INDEX1 IN1 IN2 DOWN BY DS-3.
071200     PERFORM TEST-CHECK1 THRU TEST-WRITE.
071300 SET-TEST-004-21.
071400     PERFORM TEST-CHECK2 THRU TEST-WRITE.
071500 SET-TEST-004-22.
071600     MOVE ZERO TO DS-TS-3.
071700     SET IN1 TO 8.
071800     SET IN2 TO 7.
071900     SET INDEX1 TO 77.
072000     SET IN1 IN2 INDEX1 DOWN BY DS-TS-3.
072100     PERFORM TEST-CHECK1 THRU TEST-WRITE.
072200 SET-TEST-004-23.
072300     PERFORM TEST-CHECK2 THRU TEST-WRITE.
072400     GO TO CCVS-EXIT.
072500 SET-DELETE-004.
072600     PERFORM DE-LETE.
072700     PERFORM TEST-WRITE.
072800     GO TO CCVS-EXIT.
072900 SECT-TH111-0003 SECTION.
073000 TEST-CHECK1.
073100     MOVE ELEM1 (INDEX1) TO TEMP.
073200     GO TO TEST-CHECK.
073300 TEST-CHECK2.
073400     MOVE ELEM2 (IN1 IN2) TO TEMP.
073500 TEST-CHECK.
073600     ADD 1 TO REC-CT.
073700     IF TEMP IS EQUAL TO EXPECTED-VALUE
073800          PERFORM PASS
073900          GO TO TEST-WRITE.
074000 TEST-FAIL.
074100     PERFORM FAIL.
074200     MOVE TEMP TO COMPUTED-18V0.
074300     MOVE EXPECTED-VALUE TO CORRECT-18V0.
074400 TEST-WRITE.
074500     PERFORM PRINT-DETAIL.
074600     MOVE ZERO TO TEMP.
074700 CCVS-EXIT SECTION.
074800 CCVS-999999.
074900     GO TO CLOSE-FILES.
