000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST115A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*        X-XXXP01     SQ-FS1                                   *
002000*        X-XXX065     4 DIGIT INTEGER FOR THE NUMBER           *
002100*                        RECORDS IN THE FILE SQ-FS1.           *
002200*                                                              *
002300*                                                              *
002400****************************************************************
002500*
002600*
002700*    OBJECTIVE -
002800*        ROUTINE ST115 BUILDS A SEQUENTIAL FILE SQ-FS1 WHICH
002900*    IS THEN PASSED TO ST116 TO BE SORTED.
003000*
003100*
003200*    FEATURES TESTED -
003300*    *   FIXED LENGTH RECORDS
003400*    *   OCCURS CLAUSES
003500*
003600*
003700*
003800*    FILES USED -
003900*    *   FILE SQ-FS1 CAN BE ON MAGNETIC TAPE OR MASS-STORAGE.
004000*
004100*        SQ-FS1 -
004200*    THE NUMBER OF RECORDS ON SQ-FS1 IS A VARIABLE (X-65).  THIS
004300*        NUMBER SHOULD BE LARGE ENOUGH TO FORCE THE SORT ROUTINE
004400*        IN ST116 TO BE NON-CORE RESIDENT.  THAT IS FORCE
004500*        THE SYSTEM TO USE SOME MEANS OF AUX. STORAGE FOR THE SORT
004600*        SUB-STRINGS.
004700*    FIXED LENGTH RECORDS ( 507 CHARACTERS PER RECORD )
004800*    BLOCKED 1
004900*    RESERVE 2 AREAS
005000*
005100*
005200*
005300*    OPTIONS RECOMMENDED -
005400*    *   *OPT8  X  TO BE USED IF NECESSARY TO DUMP THE
005500*                 FILE SQ-FS1 ONCE IT HAS BEEN CREATED.
005600*
005700*
005800*    TEST DESCRIPTIONS -
005900*        NOT APPLICABLE.
006000*
006100*
006200*    ************************************************************
006300 ENVIRONMENT DIVISION.
006400 CONFIGURATION SECTION.
006500 SOURCE-COMPUTER.
006600     XXXXX082.
006700 OBJECT-COMPUTER.
006800     XXXXX083.
006900 INPUT-OUTPUT SECTION.
007000 FILE-CONTROL.
007100     SELECT PRINT-FILE ASSIGN TO
007200     XXXXX055.
007300     SELECT SQ-FS1 ASSIGN TO
007400     XXXXP001
007500     ORGANIZATION IS SEQUENTIAL
007600     ACCESS MODE IS SEQUENTIAL.
007700 DATA DIVISION.
007800 FILE SECTION.
007900 FD  PRINT-FILE.
008000 01  PRINT-REC PICTURE X(120).
008100 01  DUMMY-RECORD PICTURE X(120).
008200 FD  SQ-FS1
008300     LABEL RECORDS STANDARD
008400C    VALUE OF
008500C    XXXXX074
008600C    IS
008700C    XXXXX075
008800G    XXXXX069
008900     BLOCK CONTAINS 1 RECORDS
009000     RECORD CONTAINS 507 CHARACTERS
009100     DATA RECORD IS SQ-FS1R1-F-G-507.
009200 01  SQ-FS1R1-F-G-507.
009300     10 REC-PREAMBLE PIC X(120).
009400     10  LENGTH-1 PIC 999.
009500     10  THE-THREE-KEYS.
009600     20 KEY-1.
009700         30 ALPHAN-KEY PIC X.
009800         30 NUM-KEY PIC 999.
009900     20 KEY-2.
010000         30 ALPHAN-KEY PIC X.
010100         30 NUM-KEY PIC 999.
010200     20 KEY-3.
010300         30 ALPHAN-KEY PIC X.
010400         30 NUM-KEY PIC 999.
010500     10  STUFF-1 OCCURS
010600             31 TIMES.
010700         30  FILL-ME-UPS  PIC  X(12).
010800 WORKING-STORAGE SECTION.
010900 77  WRK-DU-9-0001 PIC 9 VALUE 0.
011000 77  WRK-DU-999-0001 PIC 999.
011100 77  WRK-DU-999-2 PIC 999 VALUE 001.
011200 77  WRK-DU-999-0002 PIC 999 VALUE 0.
011300 77  WRK-DU-04V00 PIC 9(4) VALUE ZERO.
011400X77  COUNT-OF-RECS PIC 9(6) VALUE ZERO.
011500 01  WRK-XN-0001 PIC X(51) VALUE
011600     "/A.Z-B,Y+C*X)D(W$E$V F0U1G2T3H4S5I6R7J8Q9K;P<L=O>MN".
011700 01  WRK-XN-O051F-X-0001 REDEFINES WRK-XN-0001.
011800     02 CHAR PIC X OCCURS 51 TIMES.
011900 01  FILE-RECORD-INFORMATION-REC.
012000     03 FILE-RECORD-INFO-SKELETON.
012100        05 FILLER                 PICTURE X(48)       VALUE
012200             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
012300        05 FILLER                 PICTURE X(46)       VALUE
012400             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
012500        05 FILLER                 PICTURE X(26)       VALUE
012600             ",LFIL=000000,ORG=  ,LBLR= ".
012700        05 FILLER                 PICTURE X(37)       VALUE
012800             ",RECKEY=                             ".
012900        05 FILLER                 PICTURE X(38)       VALUE
013000             ",ALTKEY1=                             ".
013100        05 FILLER                 PICTURE X(38)       VALUE
013200             ",ALTKEY2=                             ".
013300        05 FILLER                 PICTURE X(7)        VALUE SPACE.
013400     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
013500        05 FILE-RECORD-INFO-P1-120.
013600           07 FILLER              PIC X(5).
013700           07 XFILE-NAME           PIC X(6).
013800           07 FILLER              PIC X(8).
013900           07 XRECORD-NAME         PIC X(6).
014000           07 FILLER              PIC X(1).
014100           07 REELUNIT-NUMBER     PIC 9(1).
014200           07 FILLER              PIC X(7).
014300           07 XRECORD-NUMBER       PIC 9(6).
014400           07 FILLER              PIC X(6).
014500           07 UPDATE-NUMBER       PIC 9(2).
014600           07 FILLER              PIC X(5).
014700           07 ODO-NUMBER          PIC 9(4).
014800           07 FILLER              PIC X(5).
014900           07 XPROGRAM-NAME        PIC X(5).
015000           07 FILLER              PIC X(7).
015100           07 XRECORD-LENGTH       PIC 9(6).
015200           07 FILLER              PIC X(7).
015300           07 CHARS-OR-RECORDS    PIC X(2).
015400           07 FILLER              PIC X(1).
015500           07 XBLOCK-SIZE          PIC 9(4).
015600           07 FILLER              PIC X(6).
015700           07 RECORDS-IN-FILE     PIC 9(6).
015800           07 FILLER              PIC X(5).
015900           07 XFILE-ORGANIZATION   PIC X(2).
016000           07 FILLER              PIC X(6).
016100           07 XLABEL-TYPE          PIC X(1).
016200        05 FILE-RECORD-INFO-P121-240.
016300           07 FILLER              PIC X(8).
016400           07 XRECORD-KEY          PIC X(29).
016500           07 FILLER              PIC X(9).
016600           07 ALTERNATE-KEY1      PIC X(29).
016700           07 FILLER              PIC X(9).
016800           07 ALTERNATE-KEY2      PIC X(29).
016900           07 FILLER              PIC X(7).
017000 01  TEST-RESULTS.
017100     02 FILLER                   PIC X      VALUE SPACE.
017200     02 FEATURE                  PIC X(20)  VALUE SPACE.
017300     02 FILLER                   PIC X      VALUE SPACE.
017400     02 P-OR-F                   PIC X(5)   VALUE SPACE.
017500     02 FILLER                   PIC X      VALUE SPACE.
017600     02  PAR-NAME.
017700       03 FILLER                 PIC X(19)  VALUE SPACE.
017800       03  PARDOT-X              PIC X      VALUE SPACE.
017900       03 DOTVALUE               PIC 99     VALUE ZERO.
018000     02 FILLER                   PIC X(8)   VALUE SPACE.
018100     02 RE-MARK                  PIC X(61).
018200 01  TEST-COMPUTED.
018300     02 FILLER                   PIC X(30)  VALUE SPACE.
018400     02 FILLER                   PIC X(17)  VALUE
018500            "       COMPUTED=".
018600     02 COMPUTED-X.
018700     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
018800     03 COMPUTED-N               REDEFINES COMPUTED-A
018900                                 PIC -9(9).9(9).
019000     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
019100     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
019200     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
019300     03       CM-18V0 REDEFINES COMPUTED-A.
019400         04 COMPUTED-18V0                    PIC -9(18).
019500         04 FILLER                           PIC X.
019600     03 FILLER PIC X(50) VALUE SPACE.
019700 01  TEST-CORRECT.
019800     02 FILLER PIC X(30) VALUE SPACE.
019900     02 FILLER PIC X(17) VALUE "       CORRECT =".
020000     02 CORRECT-X.
020100     03 CORRECT-A                  PIC X(20) VALUE SPACE.
020200     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
020300     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
020400     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
020500     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
020600     03      CR-18V0 REDEFINES CORRECT-A.
020700         04 CORRECT-18V0                     PIC -9(18).
020800         04 FILLER                           PIC X.
020900     03 FILLER PIC X(2) VALUE SPACE.
021000     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
021100 01  CCVS-C-1.
021200     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
021300-    "SS  PARAGRAPH-NAME
021400-    "       REMARKS".
021500     02 FILLER                     PIC X(20)    VALUE SPACE.
021600 01  CCVS-C-2.
021700     02 FILLER                     PIC X        VALUE SPACE.
021800     02 FILLER                     PIC X(6)     VALUE "TESTED".
021900     02 FILLER                     PIC X(15)    VALUE SPACE.
022000     02 FILLER                     PIC X(4)     VALUE "FAIL".
022100     02 FILLER                     PIC X(94)    VALUE SPACE.
022200 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
022300 01  REC-CT                        PIC 99       VALUE ZERO.
022400 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
022500 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
022600 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
022700 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
022800 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
022900 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
023000 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
023100 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
023200 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
023300 01  CCVS-H-1.
023400     02  FILLER                    PIC X(39)    VALUE SPACES.
023500     02  FILLER                    PIC X(42)    VALUE
023600     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
023700     02  FILLER                    PIC X(39)    VALUE SPACES.
023800 01  CCVS-H-2A.
023900   02  FILLER                        PIC X(40)  VALUE SPACE.
024000   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
024100   02  FILLER                        PIC XXXX   VALUE
024200     "4.2 ".
024300   02  FILLER                        PIC X(28)  VALUE
024400            " COPY - NOT FOR DISTRIBUTION".
024500   02  FILLER                        PIC X(41)  VALUE SPACE.
024600
024700 01  CCVS-H-2B.
024800   02  FILLER                        PIC X(15)  VALUE
024900            "TEST RESULT OF ".
025000   02  TEST-ID                       PIC X(9).
025100   02  FILLER                        PIC X(4)   VALUE
025200            " IN ".
025300   02  FILLER                        PIC X(12)  VALUE
025400     " HIGH       ".
025500   02  FILLER                        PIC X(22)  VALUE
025600            " LEVEL VALIDATION FOR ".
025700   02  FILLER                        PIC X(58)  VALUE
025800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025900 01  CCVS-H-3.
026000     02  FILLER                      PIC X(34)  VALUE
026100            " FOR OFFICIAL USE ONLY    ".
026200     02  FILLER                      PIC X(58)  VALUE
026300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
026400     02  FILLER                      PIC X(28)  VALUE
026500            "  COPYRIGHT   1985 ".
026600 01  CCVS-E-1.
026700     02 FILLER                       PIC X(52)  VALUE SPACE.
026800     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
026900     02 ID-AGAIN                     PIC X(9).
027000     02 FILLER                       PIC X(45)  VALUE SPACES.
027100 01  CCVS-E-2.
027200     02  FILLER                      PIC X(31)  VALUE SPACE.
027300     02  FILLER                      PIC X(21)  VALUE SPACE.
027400     02 CCVS-E-2-2.
027500         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
027600         03 FILLER                   PIC X      VALUE SPACE.
027700         03 ENDER-DESC               PIC X(44)  VALUE
027800            "ERRORS ENCOUNTERED".
027900 01  CCVS-E-3.
028000     02  FILLER                      PIC X(22)  VALUE
028100            " FOR OFFICIAL USE ONLY".
028200     02  FILLER                      PIC X(12)  VALUE SPACE.
028300     02  FILLER                      PIC X(58)  VALUE
028400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
028500     02  FILLER                      PIC X(13)  VALUE SPACE.
028600     02 FILLER                       PIC X(15)  VALUE
028700             " COPYRIGHT 1985".
028800 01  CCVS-E-4.
028900     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
029000     02 FILLER                       PIC X(4)   VALUE " OF ".
029100     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
029200     02 FILLER                       PIC X(40)  VALUE
029300      "  TESTS WERE EXECUTED SUCCESSFULLY".
029400 01  XXINFO.
029500     02 FILLER                       PIC X(19)  VALUE
029600            "*** INFORMATION ***".
029700     02 INFO-TEXT.
029800       04 FILLER                     PIC X(8)   VALUE SPACE.
029900       04 XXCOMPUTED                 PIC X(20).
030000       04 FILLER                     PIC X(5)   VALUE SPACE.
030100       04 XXCORRECT                  PIC X(20).
030200     02 INF-ANSI-REFERENCE           PIC X(48).
030300 01  HYPHEN-LINE.
030400     02 FILLER  PIC IS X VALUE IS SPACE.
030500     02 FILLER  PIC IS X(65)    VALUE IS "************************
030600-    "*****************************************".
030700     02 FILLER  PIC IS X(54)    VALUE IS "************************
030800-    "******************************".
030900 01  CCVS-PGM-ID                     PIC X(9)   VALUE
031000     "ST115A".
031100 PROCEDURE DIVISION.
031200 CCVS1 SECTION.
031300 OPEN-FILES.
031400     OPEN    OUTPUT PRINT-FILE.
031500     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
031600     MOVE    SPACE TO TEST-RESULTS.
031700     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
031800     MOVE    ZERO TO REC-SKL-SUB.
031900     PERFORM CCVS-INIT-FILE 9 TIMES.
032000 CCVS-INIT-FILE.
032100     ADD     1 TO REC-SKL-SUB.
032200     MOVE    FILE-RECORD-INFO-SKELETON
032300          TO FILE-RECORD-INFO (REC-SKL-SUB).
032400 CCVS-INIT-EXIT.
032500     GO TO CCVS1-EXIT.
032600 CLOSE-FILES.
032700     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
032800 TERMINATE-CCVS.
032900S    EXIT PROGRAM.
033000STERMINATE-CALL.
033100     STOP     RUN.
033200 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
033300 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
033400 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
033500 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
033600     MOVE "****TEST DELETED****" TO RE-MARK.
033700 PRINT-DETAIL.
033800     IF REC-CT NOT EQUAL TO ZERO
033900             MOVE "." TO PARDOT-X
034000             MOVE REC-CT TO DOTVALUE.
034100     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
034200     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
034300        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
034400          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
034500     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
034600     MOVE SPACE TO CORRECT-X.
034700     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
034800     MOVE     SPACE TO RE-MARK.
034900 HEAD-ROUTINE.
035000     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035100     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035200     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
035300     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
035400 COLUMN-NAMES-ROUTINE.
035500     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035600     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
035800 END-ROUTINE.
035900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
036000 END-RTN-EXIT.
036100     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036200 END-ROUTINE-1.
036300      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
036400      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
036500      ADD PASS-COUNTER TO ERROR-HOLD.
036600*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
036700      MOVE PASS-COUNTER TO CCVS-E-4-1.
036800      MOVE ERROR-HOLD TO CCVS-E-4-2.
036900      MOVE CCVS-E-4 TO CCVS-E-2-2.
037000      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
037100  END-ROUTINE-12.
037200      MOVE "TEST(S) FAILED" TO ENDER-DESC.
037300     IF       ERROR-COUNTER IS EQUAL TO ZERO
037400         MOVE "NO " TO ERROR-TOTAL
037500         ELSE
037600         MOVE ERROR-COUNTER TO ERROR-TOTAL.
037700     MOVE     CCVS-E-2 TO DUMMY-RECORD.
037800     PERFORM WRITE-LINE.
037900 END-ROUTINE-13.
038000     IF DELETE-COUNTER IS EQUAL TO ZERO
038100         MOVE "NO " TO ERROR-TOTAL  ELSE
038200         MOVE DELETE-COUNTER TO ERROR-TOTAL.
038300     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
038400     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038500      IF   INSPECT-COUNTER EQUAL TO ZERO
038600          MOVE "NO " TO ERROR-TOTAL
038700      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
038800      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
038900      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
039000     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
039100 WRITE-LINE.
039200     ADD 1 TO RECORD-COUNT.
039300Y    IF RECORD-COUNT GREATER 42
039400Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
039500Y        MOVE SPACE TO DUMMY-RECORD
039600Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
039700Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
039800Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
039900Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
040000Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
040100Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
040200Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
040300Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
040400Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
040500Y        MOVE ZERO TO RECORD-COUNT.
040600     PERFORM WRT-LN.
040700 WRT-LN.
040800     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
040900     MOVE SPACE TO DUMMY-RECORD.
041000 BLANK-LINE-PRINT.
041100     PERFORM WRT-LN.
041200 FAIL-ROUTINE.
041300     IF     COMPUTED-X NOT EQUAL TO SPACE
041400            GO TO   FAIL-ROUTINE-WRITE.
041500     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
041600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
041700     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
041800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041900     MOVE   SPACES TO INF-ANSI-REFERENCE.
042000     GO TO  FAIL-ROUTINE-EX.
042100 FAIL-ROUTINE-WRITE.
042200     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
042300     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
042400     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
042500     MOVE   SPACES TO COR-ANSI-REFERENCE.
042600 FAIL-ROUTINE-EX. EXIT.
042700 BAIL-OUT.
042800     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
042900     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
043000 BAIL-OUT-WRITE.
043100     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
043200     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
043300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043400     MOVE   SPACES TO INF-ANSI-REFERENCE.
043500 BAIL-OUT-EX. EXIT.
043600 CCVS1-EXIT.
043700     EXIT.
043800 SECT-ST115-0001 SECTION.
043900 SRT-INIT-001.
044000     MOVE "CREATE FILE SQ-FS1" TO FEATURE.
044100     OPEN OUTPUT SQ-FS1.
044200     MOVE "SQ-FS1" TO XFILE-NAME (1).
044300     MOVE "R1-F-G" TO XRECORD-NAME (1).
044400     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
044500     MOVE "RC" TO CHARS-OR-RECORDS (1).
044600     MOVE 0001 TO XBLOCK-SIZE (1).
044700     MOVE
044800     XXXXX065
044900             TO RECORDS-IN-FILE (1).
045000     MOVE    507 TO XRECORD-LENGTH (1).
045100     MOVE "SQ" TO XFILE-ORGANIZATION (1).
045200     MOVE "S" TO XLABEL-TYPE (1).
045300     MOVE 000000 TO XRECORD-NUMBER (1).
045400 SRT-TEST-001.
045500     MOVE    001 TO WRK-DU-999-0001.
045600     MOVE    1 TO WRK-DU-04V00.
045700 SRT-TEST-001-01.
045800     PERFORM SRT-TEST-001-BUILD.
045900     ADD 1 TO WRK-DU-04V00.
046000     IF WRK-DU-04V00 IS GREATER THAN
046100     XXXXX065
046200     GO TO SRT-WRITE-001.
046300     GO TO SRT-TEST-001-01.
046400 SRT-TEST-001-BUILD.
046500     MOVE CHAR (WRK-DU-999-0001) TO ALPHAN-KEY OF KEY-1
046600         ALPHAN-KEY OF KEY-2 ALPHAN-KEY OF KEY-3.
046700     MOVE WRK-DU-04V00    TO NUM-KEY OF KEY-1 NUM-KEY OF KEY-2
046800         NUM-KEY OF KEY-3.
046900     MOVE    507 TO LENGTH-1.
047000     PERFORM PAD-THE-RECORD-LENGTH VARYING WRK-DU-999-0002
047100         FROM 1 BY 1 UNTIL WRK-DU-999-0002 IS GREATER THAN
047200             31.
047300     ADD 1 TO XRECORD-NUMBER (1).
047400     MOVE FILE-RECORD-INFO-P1-120 (1) TO REC-PREAMBLE.
047500     ADD     001 TO WRK-DU-999-0001.
047600     IF      WRK-DU-999-0001 IS GREATER THAN 51
047700         MOVE 001 TO WRK-DU-999-0001.
047800     WRITE   SQ-FS1R1-F-G-507.
047900 PAD-THE-RECORD-LENGTH.
048000     MOVE THE-THREE-KEYS  TO STUFF-1 (WRK-DU-999-0002).
048100 SRT-DELETE-001.
048200     PERFORM DE-LETE.
048300 SRT-WRITE-001.
048400     MOVE    "FILE-CREATE" TO PAR-NAME.
048500     MOVE    "SQ-FS1 FILE CREATED" TO COMPUTED-A.
048600     MOVE XRECORD-NUMBER (1) TO CORRECT-18V0.
048700     MOVE    "PASSED TO ST116 FOR SORTING" TO RE-MARK.
048800     PERFORM PRINT-DETAIL.
048900     MOVE    "        ************   ST116 WILL NOT PRODUCE ANY PR
049000-    "INTED REPORT   ************" TO PRINT-REC.
049100     WRITE   PRINT-REC AFTER ADVANCING 1 LINES.
049200     CLOSE SQ-FS1.
049300XFILEDUMP SECTION.
049400XFILE-1-DUMP-INIT.
049500X    OPEN INPUT SQ-FS1.
049600X    MOVE ZERO TO COUNT-OF-RECS.
049700XFILE-1-DUMP.
049800X    READ SQ-FS1 RECORD
049900X        AT END GO TO FILE-1-DUMP-END.
050000X    ADD 1 TO COUNT-OF-RECS.
050100X    IF COUNT-OF-RECS GREATER THAN
050200X    XXXXX065
050300X        GO TO FILE-1-DUMP-END.
050400X    PERFORM FILE-1-DUMP-WRITE.
050500X    GO TO FILE-1-DUMP.
050600XFILE-1-DUMP-WRITE.
050700X    MOVE SQ-FS1R1-F-G-507 TO DUMMY-RECORD.
050800X    WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
050900XFILE-1-DUMP-END.
051000X    MOVE    " SQ-FS1 RECORDS TO SORTED BY ST116 SHOWN BELOW"
051100X        TO DUMMY-RECORD.
051200X    WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
051300X    MOVE    COUNT-OF-RECS TO DUMMY-RECORD.
051400X    WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
051500X    CLOSE   SQ-FS1.
051600 CCVS-EXIT SECTION.
051700 CCVS-999999.
051800     GO TO CLOSE-FILES.
