000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RW103A.
000400 AUTHOR.
000500     FEDERAL COMPILER TESTING CENTER.
000600 INSTALLATION.
000700     GENERAL SERVICES ADMINISTRATION
000800     AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
000900     SOFTWARE DEVELOPMENT OFFICE.
001000     5203 LEESBURG PIKE  SUITE 1100
001100     FALLS CHURCH VIRGINIA 22041.
001200
001300     PHONE   (703) 756-6153
001400
001500     " HIGH       ".
001600 DATE-WRITTEN.
001700     CCVS-74 VERSION 4.0 - 1980 JULY 1.
001800     CREATION DATE     /    VALIDATION DATE
001900     "4.2 ".
002000 SECURITY.
002100     NONE.
002200******************************************************************
002300*
002400*        THE ROUTINE RW103A TESTS BASIC REPORT WRITER MODULE
002500*    FUNCTIONS.  ONE OUTPUT REPORT IS PRODUCED BY THE RWCS.
002600*    THE REPORT DESCRIPTION IN THIS ROUTINE CONTAINS
002700*            PAGE  30
002800*            HEADING 1
002900*            FIRST DETAIL 6
003000*            LAST DETAIL 25
003100*    WITHOUT THE OPTIONAL FOOTING PHRASE.  THE ASSUMED VALUE
003200*    FOR THE FOOTING PHRASE IS
003300*            FOOTING - VALUE OF 25.
003400*    THERE IS A PAGE HEADING REPORT GROUP AND A DETAIL REPORT
003500*    GROUP DEFINED FOR THE REPORT.
003600*
003700*        THE PROCEDURE DIVISION FOR RW103A
003800*            OPENS THE SEQUENTIAL FILE RW-FS3,
003900*            INITIATES THE REPORT RW-FS3-REPORT-1,
004000*            CHECKS THE VALUES IN LINE-COUNTER AND PAGE-COUNTER
004100*    AFTER EXECUTING THE INITIATE STATEMENT,
004200*            GENERATES A THREE PAGE REPORT WITH GENERATE DATA-
004300*    NAME STATEMENTS,
004400*            CHECKS THE VALUES IN LINE-COUNTER AND PAGE-COUNTER
004500*    AFTER EACH GENERATE STATEMENT,
004600*            CHECKS THAT LINE-COUNTER AND PAGE-COUNTER ARE RESET
004700*    WHEN PAGE ADVANCING PROCESSING HAS OCCURRED,
004800*            TERMINATES THE REPORT RW-FS3-REPORT-1,
004900*            CLOSES THE REPORT FILE RW-FS3.
005000*
005100*        THE OUTPUT OF THIS ROUTINE CONSISTS OF AN OUTPUT REPORT
005200*    IN THE USUAL AUDIT ROUTINE FORMAT PRODUCED USING WRITE
005300*    STATEMENTS AND A REPORT PRODUCED BY THE RWCS.  BOTH REPORTS
005400*    MUST BE CAREFULLY EXAMINED TO VERIFY THAT THE TESTS IN
005500*    RW103 WERE EXECUTED CORRECTLY.
005600*
005700*       THE OUTPUT REPORT GENERATED BY THE RWCS CONSISTS OF
005800*    THREE PAGES WITH EACH PAGE CONTAINING A SINGLE PAGE HEADING
005900*    ON LINE 1 AND TWENTY DETAIL LINES ON LINES 6 THROUGH 25.
006000*    LINES 2 THROUGH 5 AND 26 THROUGH 30 SHOULD BE BLANK.
006100*
006200*        THE VALUE OF LINE-COUNTER IN THE DETAIL LINE IS FIVE
006300*    GREATER THAN THE DETAIL LINE NUMBER, AND PAGE-COUNTER IS
006400*    EQUAL TO THE PAGE ON WHICH THE DETAIL LINE IS PRESENTED.
006500*
006600******************************************************************
006700*
006800*    REFERENCE  AMERICAN NATIONAL STANDARD PROGRAMMING
006900*                   LANGUAGE COBOL, X3.23-1974
007000*        SECTION VIII - REPORT WRITER MODULE
007100*
007200******************************************************************
007300 ENVIRONMENT DIVISION.
007400 CONFIGURATION SECTION.
007500 SOURCE-COMPUTER.
007600     XXXXX082.
007700 OBJECT-COMPUTER.
007800     XXXXX083.
007900 INPUT-OUTPUT SECTION.
008000 FILE-CONTROL.
008100     SELECT PRINT-FILE ASSIGN TO
008200     XXXXX055.
008300     SELECT RW-FS3 ASSIGN TO
008400     XXXXX049.
008500 DATA DIVISION.
008600 FILE SECTION.
008700 FD  PRINT-FILE
008800     LABEL RECORDS
008900     XXXXX084
009000     DATA RECORD IS PRINT-REC DUMMY-RECORD.
009100 01  PRINT-REC PICTURE X(120).
009200 01  DUMMY-RECORD PICTURE X(120).
009300 FD  RW-FS3
009400     LABEL RECORDS ARE STANDARD
009500C    VALUE OF
009600C    XXXXX074
009700C       IS
009800C    XXXXX075
009900G    XXXXX069
010000     REPORT IS RW-FS3-REPORT-1.
010100 WORKING-STORAGE SECTION.
010200 01  LC-ERRORS  PIC 99 VALUE 0.
010300 01  PC-ERRORS  PIC 99 VALUE 0.
010400 01  WS-COUNTER PIC 99 VALUE 0.
010500 01  PAGENO    PIC 99  VALUE 1.
010600 01  TEMP-COMP   PIC 99.
010700 01  TEST-RESULTS.
010800     02 FILLER                    PICTURE X VALUE SPACE.
010900     02 FEATURE                   PICTURE X(20) VALUE SPACE.
011000     02 FILLER                    PICTURE X VALUE SPACE.
011100     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
011200     02 FILLER                    PICTURE X  VALUE SPACE.
011300     02  PAR-NAME.
011400       03 FILLER PICTURE X(12) VALUE SPACE.
011500       03  PARDOT-X PICTURE X  VALUE SPACE.
011600       03 DOTVALUE PICTURE 99  VALUE ZERO.
011700       03 FILLER PIC X(5) VALUE SPACE.
011800     02 FILLER PIC X(10) VALUE SPACE.
011900     02 RE-MARK PIC X(61).
012000 01  TEST-COMPUTED.
012100     02 FILLER PIC X(30) VALUE SPACE.
012200     02 FILLER PIC X(17) VALUE "       COMPUTED=".
012300     02 COMPUTED-X.
012400     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
012500     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
012600     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
012700     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
012800     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
012900     03       CM-18V0 REDEFINES COMPUTED-A.
013000         04 COMPUTED-18V0                   PICTURE -9(18).
013100         04 FILLER                          PICTURE X.
013200     03 FILLER PIC X(50) VALUE SPACE.
013300 01  TEST-CORRECT.
013400     02 FILLER PIC X(30) VALUE SPACE.
013500     02 FILLER PIC X(17) VALUE "       CORRECT =".
013600     02 CORRECT-X.
013700     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
013800     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
013900     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
014000     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
014100     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
014200     03      CR-18V0 REDEFINES CORRECT-A.
014300         04 CORRECT-18V0                    PICTURE -9(18).
014400         04 FILLER                          PICTURE X.
014500     03 FILLER PIC X(50) VALUE SPACE.
014600 01  CCVS-C-1.
014700     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
014800-    "SS  PARAGRAPH-NAME
014900-    "        REMARKS".
015000     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
015100 01  CCVS-C-2.
015200     02 FILLER PICTURE IS X VALUE IS SPACE.
015300     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
015400     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
015500     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
015600     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
015700 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
015800 01  REC-CT PICTURE 99 VALUE ZERO.
015900 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
016000 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
016100 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
016200 01  PASS-COUNTER PIC 999 VALUE ZERO.
016300 01  TOTAL-ERROR PIC 999 VALUE ZERO.
016400 01  ERROR-HOLD PIC 999 VALUE ZERO.
016500 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
016600 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
016700 01  CCVS-H-1.
016800     02  FILLER   PICTURE X(27)  VALUE SPACE.
016900     02 FILLER PICTURE X(67) VALUE
017000     " FEDERAL COMPILER TESTING CENTER COBOL COMPILER VALIDATION
017100-    " SYSTEM".
017200     02  FILLER     PICTURE X(26)  VALUE SPACE.
017300 01  CCVS-H-2.
017400     02 FILLER PICTURE X(52) VALUE IS
017500     "CCVS74 NCC  COPY, NOT FOR DISTRIBUTION.".
017600     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
017700     02 TEST-ID PICTURE IS X(9).
017800     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
017900 01  CCVS-H-3.
018000     02  FILLER PICTURE X(34) VALUE
018100     " FOR OFFICIAL USE ONLY    ".
018200     02  FILLER PICTURE X(58) VALUE
018300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
018400     02  FILLER PICTURE X(28) VALUE
018500     "  COPYRIGHT   1974 ".
018600 01  CCVS-E-1.
018700     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
018800     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
018900     02 ID-AGAIN PICTURE IS X(9).
019000     02 FILLER PICTURE X(45) VALUE IS
019100     " NTIS DISTRIBUTION COBOL 74".
019200 01  CCVS-E-2.
019300     02  FILLER                   PICTURE X(31)  VALUE
019400     SPACE.
019500     02  FILLER                   PICTURE X(21)  VALUE SPACE.
019600     02 CCVS-E-2-2.
019700         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
019800         03 FILLER PICTURE IS X VALUE IS SPACE.
019900         03 ENDER-DESC PIC X(44) VALUE "ERRORS ENCOUNTERED".
020000 01  CCVS-E-3.
020100     02  FILLER PICTURE X(22) VALUE
020200     " FOR OFFICIAL USE ONLY".
020300     02  FILLER PICTURE X(12) VALUE SPACE.
020400     02  FILLER PICTURE X(58) VALUE
020500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
020600     02  FILLER PICTURE X(13) VALUE SPACE.
020700     02 FILLER PIC X(15) VALUE " COPYRIGHT 1974".
020800 01  CCVS-E-4.
020900     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
021000     02 FILLER PIC XXXX VALUE " OF ".
021100     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
021200     02 FILLER PIC X(40) VALUE
021300      "  TESTS WERE EXECUTED SUCCESSFULLY".
021400 01  XXINFO.
021500     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
021600     02 INFO-TEXT.
021700     04 FILLER PIC X(20) VALUE SPACE.
021800     04 XXCOMPUTED PIC X(20).
021900     04 FILLER PIC X(5) VALUE SPACE.
022000     04 XXCORRECT PIC X(20).
022100 01  HYPHEN-LINE.
022200     02 FILLER PICTURE IS X VALUE IS SPACE.
022300     02 FILLER PICTURE IS X(65) VALUE IS "************************
022400-    "*****************************************".
022500     02 FILLER PICTURE IS X(54) VALUE IS "************************
022600-    "******************************".
022700 01  CCVS-PGM-ID PIC X(6) VALUE
022800     "RW103A".
022900 REPORT SECTION.
023000 RD  RW-FS3-REPORT-1
023100     PAGE 30
023200     HEADING 1
023300     FIRST DETAIL 6
023400     LAST DETAIL 25.
023500 01  RW-FS3-HEADING
023600     LINE 1
023700     TYPE IS PAGE HEADING.
023800     03  PIC X(36)  COLUMN 20
023900         VALUE "U.S. NAVY COBOL AUDIT ROUTINE RW103A".
024000     03  PIC X(5)  COLUMN 60   VALUE "LINE ".
024100     03  PIC 9   COLUMN 65  SOURCE LINE-COUNTER.
024200     03  COLUMN 70  PIC X(5)
024300         VALUE "PAGE ".
024400     03  COLUMN 75  PIC 9
024500         SOURCE PAGE-COUNTER.
024600 01  RW-FS3-DETAIL
024700     LINE PLUS 1
024800     TYPE IS DE.
024900     03  PIC X(12)  COLUMN 20
025000         VALUE "DETAIL LINE ".
025100     03  PIC 99 COLUMN 32
025200         SOURCE IS WS-COUNTER.
025300     03  PIC X(13)   COLUMN 36
025400         VALUE "PAGE-COUNTER ".
025500     03  PIC 9  COLUMN 49
025600         SOURCE PAGE-COUNTER.
025700     03  PIC X(13)  COLUMN 55
025800         VALUE "LINE-COUNTER ".
025900     03  PIC 99   COLUMN IS 68
026000         SOURCE IS LINE-COUNTER.
026100 PROCEDURE DIVISION.
026200 CCVS1 SECTION.
026300 OPEN-FILES.
026400     OPEN     OUTPUT PRINT-FILE.
026500     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
026600     MOVE    SPACE TO TEST-RESULTS.
026700     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
026800     GO TO CCVS1-EXIT.
026900 CLOSE-FILES.
027000     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
027100 TERMINATE-CCVS.
027200S    EXIT PROGRAM.
027300STERMINATE-CALL.
027400     STOP     RUN.
027500 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
027600 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
027700 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
027800 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
027900     MOVE "****TEST DELETED****" TO RE-MARK.
028000 PRINT-DETAIL.
028100     IF REC-CT NOT EQUAL TO ZERO
028200             MOVE "." TO PARDOT-X
028300             MOVE REC-CT TO DOTVALUE.
028400     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
028500     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
028600        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
028700          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
028800     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
028900     MOVE SPACE TO CORRECT-X.
029000     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
029100     MOVE     SPACE TO RE-MARK.
029200 HEAD-ROUTINE.
029300     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029400     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
029500     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
029600 COLUMN-NAMES-ROUTINE.
029700     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029800     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
030000 END-ROUTINE.
030100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
030200 END-RTN-EXIT.
030300     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030400 END-ROUTINE-1.
030500      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
030600      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
030700      ADD PASS-COUNTER TO ERROR-HOLD.
030800*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
030900      MOVE PASS-COUNTER TO CCVS-E-4-1.
031000      MOVE ERROR-HOLD TO CCVS-E-4-2.
031100      MOVE CCVS-E-4 TO CCVS-E-2-2.
031200      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
031300  END-ROUTINE-12.
031400      MOVE "TEST(S) FAILED" TO ENDER-DESC.
031500     IF       ERROR-COUNTER IS EQUAL TO ZERO
031600         MOVE "NO " TO ERROR-TOTAL
031700         ELSE
031800         MOVE ERROR-COUNTER TO ERROR-TOTAL.
031900     MOVE     CCVS-E-2 TO DUMMY-RECORD.
032000     PERFORM WRITE-LINE.
032100 END-ROUTINE-13.
032200     IF DELETE-CNT IS EQUAL TO ZERO
032300         MOVE "NO " TO ERROR-TOTAL  ELSE
032400         MOVE DELETE-CNT TO ERROR-TOTAL.
032500     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
032600     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
032700      IF   INSPECT-COUNTER EQUAL TO ZERO
032800          MOVE "NO " TO ERROR-TOTAL
032900      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
033000      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
033100      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033200     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033300 WRITE-LINE.
033400     ADD 1 TO RECORD-COUNT.
033500Y    IF RECORD-COUNT GREATER 50
033600Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
033700Y        MOVE SPACE TO DUMMY-RECORD
033800Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
033900Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
034000Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
034100Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
034200Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
034300Y        MOVE ZERO TO RECORD-COUNT.
034400     PERFORM WRT-LN.
034500 WRT-LN.
034600     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
034700     MOVE SPACE TO DUMMY-RECORD.
034800 BLANK-LINE-PRINT.
034900     PERFORM WRT-LN.
035000 FAIL-ROUTINE.
035100     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
035200     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
035300     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
035400     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035500     GO TO FAIL-ROUTINE-EX.
035600 FAIL-ROUTINE-WRITE.
035700     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
035800     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
035900 FAIL-ROUTINE-EX. EXIT.
036000 BAIL-OUT.
036100     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
036200     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
036300 BAIL-OUT-WRITE.
036400     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
036500     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036600 BAIL-OUT-EX. EXIT.
036700 CCVS1-EXIT.
036800     EXIT.
036900 SECT-RW103-0001 SECTION.
037000 RW103-INIT.
037100     OPEN OUTPUT RW-FS3.
037200 INIT-TEST-04.
037300     INITIATE RW-FS3-REPORT-1.
037400*
037500*        AFTER EXECUTION OF THE INITIATE STATEMENT FOR A REPORT,
037600*    THE REPORT LINE-COUNTER SHOULD BE ZERO AND PAGE-COUNTER
037700*    SHOULD BE ONE.
037800*    REFERENCE  PAGE VIII-53, 3.2.4(1)B AND C, INITIATE STATEMENT
037900*
038000 INIT-TEST-04-01.
038100     IF LINE-COUNTER EQUAL TO ZERO
038200         PERFORM PASS
038300         GO TO INIT-WRITE-04-01.
038400 INIT-FAIL-04-01.
038500     PERFORM FAIL.
038600     MOVE ZERO TO CORRECT-18V0.
038700     MOVE LINE-COUNTER TO COMPUTED-18V0.
038800     MOVE "LINE-COUNTER AFTER INITIATE" TO RE-MARK.
038900 INIT-WRITE-04-01.
039000     MOVE "INIT-TEST-04" TO PAR-NAME.
039100     MOVE 1 TO REC-CT.
039200     MOVE "INITIATE REPORT" TO FEATURE.
039300     PERFORM PRINT-DETAIL.
039400 INIT-TEST-04-02.
039500     IF PAGE-COUNTER EQUAL TO 1
039600         PERFORM PASS
039700         GO TO INIT-WRITE-04-02.
039800 INIT-FAIL-04-02.
039900     PERFORM FAIL.
040000     MOVE 1 TO CORRECT-18V0.
040100     MOVE PAGE-COUNTER TO COMPUTED-18V0.
040200     MOVE "PAGE-COUNTER AFTER INITIATE" TO RE-MARK.
040300 INIT-WRITE-04-02.
040400     MOVE 2 TO REC-CT.
040500     PERFORM PRINT-DETAIL.
040600 GENER-TEST-08.
040700*        THIS TEST EXECUTES THE CHRONOLOGICALLY FIRST GENERATE
040800*    STATEMENT FOR THE REPORT RW-FS3-REPORT-1.
040900*    REFERENCE  PAGE VIII-52, 3.1.4(5)B AND D, GENERATE STATEMENT
041000*
041100     ADD 1 TO WS-COUNTER.
041200     GENERATE RW-FS3-DETAIL.
041300*
041400*    OUTPUT REPORT INFO
041500*
041600*        THE PAGE HEADING REPORT GROUP IS PRESENTED ON LINE 1
041700*    OF PAGE 1.
041800*    REFERENCE  PAGE VIII-14, 2.5.5.7, PAGE HEADING PRE. RULES
041900*
042000*        THE LINE-COUNTER VALUE PRINTED ON THE PH LINE SHOULD
042100*    EQUAL ONE.
042200*    REFERENCE PAGE VIII-5, 2.4.5(6), LINE-COUNTER RULES
042300*
042400*        THE FIRST DETAIL LINE IS PRESENTED ON LINE 6 OF PAGE 1.
042500*    REFERENCE  PAGE VIII-18, 2.5.5.8.1(4)B, BODY GROUP PRE RULES
042600*
042700 GENER-TEST-08-01.
042800     IF LINE-COUNTER EQUAL TO 6
042900         PERFORM PASS
043000         GO TO GENER-WRITE-08-01.
043100*
043200*        THE LINE-COUNTER SETTING AFTER THE GENERATE STATEMENT
043300*    IS EQUAL TO THE LINE NUMBER ON WHICH THE PRINT LINE WAS
043400*    PRESENTED, IN THIS CASE 6.
043500*    REFERENCE  PAGE VIII-19, 2.5.5.8.1(6)D, FINAL L-C SETTING
043600*
043700 GENER-FAIL-08-01.
043800     PERFORM FAIL.
043900     MOVE 6 TO CORRECT-18V0.
044000     MOVE LINE-COUNTER TO COMPUTED-18V0.
044100     MOVE "LINE-COUNTER AFTER FIRST GENER" TO RE-MARK.
044200 GENER-WRITE-08-01.
044300     MOVE "GENER-TEST-8" TO PAR-NAME.
044400     MOVE "FIRST GENERATE" TO FEATURE.
044500     MOVE 1 TO REC-CT.
044600     PERFORM PRINT-DETAIL.
044700 GENER-TEST-08-02.
044800     IF PAGE-COUNTER EQUAL TO 1
044900         PERFORM PASS
045000         GO TO GENER-WRITE-08-02.
045100*
045200*    EXECUTION OF THE FIRST GENERATE STATEMENT SHOULD NOT
045300*    CHANGE THE VALUE OF PAGE-COUNTER.  IT SHOULD STILL BE
045400*    EQUAL TO ONE.
045500*    REFERENCE  PAGE VIII-4, 2.4.4, PAGE-COUNTER RULES
045600*
045700 GENER-FAIL-08-02.
045800     PERFORM FAIL.
045900     MOVE 1 TO CORRECT-18V0.
046000     MOVE PAGE-COUNTER TO COMPUTED-18V0.
046100     MOVE "PAGE-COUNTER AFTER GENER" TO RE-MARK.
046200 GENER-WRITE-08-02.
046300     MOVE 2 TO REC-CT.
046400     PERFORM PRINT-DETAIL.
046500 GENER-TEST-09.
046600*        THIS TEST EXECUTES A GENERATE STATEMENT FOR THE DETAIL
046700*    REPORT GROUP 19 TIMES.
046800*    REFERENCE  PAGE VIII-51, 3.1.4(2), (6)B, GENERATE STATEMENT
046900*
047000     PERFORM GENER-DETAIL-LINE 19 TIMES.
047100*
047200*    OUTPUT REPORT INFO
047300*        NINETEEN DETAIL LINES SINGLE SPACED ARE PRESENTED ON
047400*    LINES 7 THROUGH 25 OF THE FIRST REPORT PAGE.
047500*    REFERENCE  PAGE VIII-18, 2.5.5.8.1(4)B, BODY GROUP PRE. RULES
047600*
047700     GO TO GENER-TEST-09-01.
047800 GENER-DETAIL-LINE.
047900     ADD 1 TO WS-COUNTER.
048000     GENERATE RW-FS3-DETAIL.
048100     MOVE WS-COUNTER TO TEMP-COMP.
048200     ADD 5 TO TEMP-COMP.
048300     IF LINE-COUNTER NOT EQUAL TO TEMP-COMP
048400         ADD 1 TO LC-ERRORS.
048500*
048600*        THE LINE-COUNTER SETTING AFTER THE GENERATE STATEMENT
048700*    IS EQUAL TO THE LINE NUMBER ON WHICH THE PRINT LINE WAS
048800*    PRESENTED.  THIS NUMBER IS FIVE GREATER THAN THE DETAIL
048900*    LINE NUMBER.
049000*    REFERENCE  PAGE VIII-19, 2.5.5.8.1(6)D, FINAL L-C SETTING
049100*
049200     IF PAGE-COUNTER NOT EQUAL TO PAGENO
049300         ADD 1 TO PC-ERRORS.
049400*
049500*        EXECUTION OF A GENERATE STATEMENT WHICH DOES NOT CAUSE
049600*    PAGE ADVANCING SHOULD NOT CHANGE THE VALUE OF PAGE-COUNTER.
049700*    REFERENCE  PAGE VIII-4, 2.4.4, PAGE-COUNTER RULES.
049800*
049900 GENER-TEST-09-01.
050000     IF LC-ERRORS EQUAL TO ZERO
050100         PERFORM PASS
050200         GO TO GENER-WRITE-09-01.
050300 GENER-FAIL-09-01.
050400     PERFORM FAIL.
050500     MOVE LC-ERRORS TO COMPUTED-18V0.
050600     MOVE ZERO TO CORRECT-18V0.
050700     MOVE "NUMBER OF LINE-COUNTER ERRORS" TO RE-MARK.
050800 GENER-WRITE-09-01.
050900     MOVE "GENER-TEST-9" TO PAR-NAME.
051000     MOVE 1 TO REC-CT.
051100     MOVE "GENERATE 19 LINES" TO FEATURE.
051200     PERFORM PRINT-DETAIL.
051300 GENER-TEST-09-02.
051400     IF PC-ERRORS EQUAL TO ZERO
051500         PERFORM PASS
051600     GO TO GENER-WRITE-09-02.
051700 GENER-FAIL-09-02.
051800     PERFORM FAIL.
051900     MOVE PC-ERRORS TO COMPUTED-18V0.
052000     MOVE ZERO TO CORRECT-18V0.
052100     MOVE "NUMBER OF PAGE-COUNTER ERRORS" TO RE-MARK.
052200 GENER-WRITE-09-02.
052300     MOVE 2 TO REC-CT.
052400     PERFORM PRINT-DETAIL.
052500 GENER-TEST-10.
052600*
052700*        THIS TEST EXECUTES A GENERATE STATEMENT WHICH CAUSES
052800*    THE PAGE HEADING REPORT GROUP TO BE PRESENTED ON LINE 1
052900*    OF PAGE 2, AND THE FIRST DETAIL REPORT GROUP TO BE PRESENTED
053000*    ON LINE 6 OF PAGE 2.
053100*    REFERENCES  PAGE VIII-51, 3.1.4(4), THE GENERATE STATEMENT
053200*                PAGE VIII-17, 2.5.5.8.1(3)B, (4)B,
053300*                        BODY GROUP PRESENTATION RULES
053400*
053500     MOVE 1 TO WS-COUNTER.
053600     GENERATE RW-FS3-DETAIL.
053700 GENER-TEST-10-01.
053800     IF LINE-COUNTER EQUAL TO 6
053900         PERFORM PASS
054000         GO TO GENER-WRITE-10-01.
054100*
054200*        LINE-COUNTER SHOULD BE RESET TO ZERO WHEN THE PAGE
054300*    ADVANCE FROM PAGE 1 TO PAGE 2 IS EXECUTED, AND LINE-COUNTER
054400*    IS SET TO 6 WHEN THE DETAIL REPORT GROUP IS PRESENTED.
054500*    REFERENCES  PAGE VIII-5, 2.4.5(4), LINE-COUNTER RULES
054600*                PAGE VIII-19, 2.5.5.8.1(6)D, FINAL L-C SETTING
054700*
054800 GENER-FAIL-10-01.
054900     PERFORM FAIL.
055000     MOVE 6 TO CORRECT-18V0.
055100     MOVE LINE-COUNTER TO COMPUTED-18V0.
055200     MOVE "LINE-COUNTER AFTER PAGE ADVANCE" TO RE-MARK.
055300 GENER-WRITE-10-01.
055400     MOVE "GENR-TEST-10" TO PAR-NAME.
055500     MOVE "PAGE ADVANCE" TO FEATURE.
055600     MOVE 1 TO REC-CT.
055700     PERFORM PRINT-DETAIL.
055800 GENER-TEST-10-02.
055900     IF PAGE-COUNTER EQUAL TO 2
056000         PERFORM PASS
056100         GO TO GENER-WRITE-10-02.
056200*
056300*        PAGE-COUNTER SHOULD BE INCREMENTED TO 2 WHEN THE PAGE
056400*    ADVANCE FROM PAGE 1 TO PAGE 2 IS EXECUTED.
056500*    REFERENCE  PAGE VIII-5, 2.4.4(5), PAGE-COUNTER RULES
056600*
056700 GENER-FAIL-10-02.
056800     PERFORM FAIL.
056900     MOVE 2 TO CORRECT-18V0.
057000     MOVE PAGE-COUNTER TO COMPUTED-18V0.
057100     MOVE "PAGE-COUNTER AFTER PAGE ADVANCE" TO RE-MARK.
057200 GENER-WRITE-10-02.
057300     MOVE 2 TO REC-CT.
057400     PERFORM PRINT-DETAIL.
057500 GENER-TEST-11.
057600*        THIS TEST EXECUTES A GENERATE STATEMENT FOR THE DETAIL
057700*    REPORT GROUP 19 TIMES.  NINETEEN DETAIL LINES SINGLE SPACED
057800*    ARE PRESENTED ON LINES 7 THROUGH 25 OF THE SECOND REPORT
057900*    PAGE.
058000*    REFERENCES  PAGE VIII-51, 3.1.4(2),(6)B, GENERATE STATEMENT
058100*                PAGE VIII-18, 2.5.5.8.1(4)B, BODY GROUP PRE RULES
058200*
058300     MOVE 2 TO PAGENO.
058400     MOVE ZERO TO LC-ERRORS  PC-ERRORS.
058500     PERFORM GENER-DETAIL-LINE 19 TIMES.
058600 GENER-TEST-11-01.
058700     IF LC-ERRORS EQUAL TO ZERO
058800         PERFORM PASS
058900         GO TO GENER-WRITE-11-01.
059000 GENER-FAIL-11-01.
059100     PERFORM FAIL.
059200     MOVE LC-ERRORS TO COMPUTED-18V0.
059300     MOVE ZERO TO CORRECT-18V0.
059400     MOVE "NUMBER OF LINE-COUNTER ERRORS" TO RE-MARK.
059500 GENER-WRITE-11-01.
059600     MOVE "GENR-TEST-11" TO PAR-NAME.
059700     MOVE 1 TO REC-CT.
059800     MOVE "GENERATE 19 LINES" TO FEATURE.
059900     PERFORM PRINT-DETAIL.
060000 GENER-TEST-11-02.
060100     IF PC-ERRORS EQUAL TO ZERO
060200         PERFORM PASS
060300         GO TO GENER-WRITE-11-02.
060400 GENER-FAIL-11-02.
060500     PERFORM FAIL.
060600     MOVE PC-ERRORS TO COMPUTED-18V0.
060700     MOVE ZERO TO CORRECT-18V0.
060800     MOVE "NUMBER OF PAGE-COUNTER ERRORS" TO RE-MARK.
060900 GENER-WRITE-11-02.
061000     MOVE 2 TO REC-CT.
061100     PERFORM PRINT-DETAIL.
061200 GENER-TEST-12.
061300*        THIS TEST EXECUTES A GENERATE STATEMENT WHICH CAUSES
061400*    THE PAGE HEADING REPORT GROUP TO BE PRESENTED ON LINE 1
061500*    OF PAGE 3, AND THE FIRST DETAIL REPORT GROUP TO BE PRESENTED
061600*    ON LINE 6 OF PAGE 3.
061700*    REFERENCES  PAGE VIII-51, 3.1.4(4), THE GENERATE STATEMENT
061800*                PAGE VIII-17, 2.5.5.8.1(3)B, (4)B,
061900*                        BODY GROUP PRESENTATION RULES
062000*
062100     MOVE 1 TO WS-COUNTER.
062200     GENERATE RW-FS3-DETAIL.
062300 GENER-TEST-12-01.
062400     IF LINE-COUNTER EQUAL TO 6
062500         PERFORM PASS
062600         GO TO GENER-WRITE-12-01.
062700*
062800*        LINE-COUNTER SHOULD BE RESET TO ZERO WHEN THE PAGE
062900*    ADVANCE FROM PAGE 2 TO PAGE 3 IS EXECUTED, AND LINE-COUNTER
063000*    IS SET TO 6 WHEN THE DETAIL REPORT GROUP IS PRESENTED.
063100*    REFERENCES  PAGE VIII-5, 2.4.5(4), LINE-COUNTER RULES
063200*                PAGE VIII-19, 2.5.5.8.1(6)D, FINAL L-C SETTING
063300*
063400 GENER-FAIL-12-01.
063500     PERFORM FAIL.
063600     MOVE 6 TO CORRECT-18V0.
063700     MOVE LINE-COUNTER TO COMPUTED-18V0.
063800     MOVE "LINE-COUNTER AFTER PAGE ADVANCE" TO RE-MARK.
063900 GENER-WRITE-12-01.
064000     MOVE "GENR-TEST-12" TO PAR-NAME.
064100     MOVE "PAGE ADVANCE" TO FEATURE.
064200     MOVE 1 TO REC-CT.
064300     PERFORM PRINT-DETAIL.
064400 GENER-TEST-12-02.
064500     IF PAGE-COUNTER EQUAL TO 3
064600         PERFORM PASS
064700         GO TO GENER-WRITE-12-02.
064800*
064900*        PAGE-COUNTER SHOULD BE INCREMENTED TO 3 WHEN THE PAGE
065000*    ADVANCE FROM PAGE 2 TO PAGE 3 IS EXECUTED.
065100*    REFERENCE  PAGE VIII-5, 2.4.4(5), PAGE-COUNTER RULES
065200*
065300 GENER-FAIL-12-02.
065400     PERFORM FAIL.
065500     MOVE 3 TO CORRECT-18V0.
065600     MOVE PAGE-COUNTER TO COMPUTED-18V0.
065700     MOVE "PAGE-COUNTER AFTER PAGE ADVANCE" TO RE-MARK.
065800 GENER-WRITE-12-02.
065900     MOVE 2 TO REC-CT.
066000     PERFORM PRINT-DETAIL.
066100 GENER-TEST-13.
066200*        THIS TEST EXECUTES A GENERATE STATEMENT FOR THE DETAIL
066300*    REPORT GROUP 19 TIMES.  NINETEEN DETAIL LINES SINGLE SPACED
066400*    ARE PRESENTED ON LINES 7 THROUGH 25 OF THE THIRD REPORT PAGE.
066500*    REFERENCES  PAGE VIII-51, 3.1.4(2), (6)B, GENERATE STATEMENT
066600*                PAGE VIII-18, 2.5.5.8.1(4)B, BODY GROUP PRE RULES
066700*
066800     MOVE 3 TO PAGENO.
066900     MOVE ZERO TO LC-ERRORS  PC-ERRORS.
067000     PERFORM GENER-DETAIL-LINE 19 TIMES.
067100 GENER-TEST-13-01.
067200     IF LC-ERRORS EQUAL TO ZERO
067300         PERFORM PASS
067400         GO TO GENER-WRITE-13-01.
067500 GENER-FAIL-13-01.
067600     PERFORM FAIL.
067700     MOVE LC-ERRORS TO COMPUTED-18V0.
067800     MOVE ZERO TO CORRECT-18V0.
067900     MOVE "NUMBER OF LINE-COUNTER ERRORS" TO RE-MARK.
068000 GENER-WRITE-13-01.
068100     MOVE "GENR-TEST-13" TO PAR-NAME.
068200     MOVE 1 TO REC-CT.
068300     MOVE "GENERATE 19 LINES" TO FEATURE.
068400     PERFORM PRINT-DETAIL.
068500 GENER-TEST-13-02.
068600     IF PC-ERRORS EQUAL TO ZERO
068700         PERFORM PASS
068800         GO TO GENER-WRITE-13-02.
068900 GENER-FAIL-13-02.
069000     PERFORM FAIL.
069100     MOVE PC-ERRORS TO COMPUTED-18V0.
069200     MOVE ZERO TO CORRECT-18V0.
069300     MOVE "NUMBER OF PAGE-COUNTER ERRORS" TO RE-MARK.
069400 GENER-WRITE-13-02.
069500     MOVE 2 TO REC-CT.
069600     PERFORM PRINT-DETAIL.
069700*
069800 TERM-TEST-STATE.
069900     TERMINATE RW-FS3-REPORT-1.
070000 CLOSE-RW-FS3.
070100     CLOSE RW-FS3.
070200 TERM-WRITE-03.
070300     MOVE "TERMINATE REPORT" TO FEATURE.
070400     MOVE ZERO TO REC-CT.
070500     MOVE "TERM-TEST-03" TO PAR-NAME.
070600     MOVE "3 PAGE REPORT" TO COMPUTED-A.
070700     MOVE "20 DE LINES PER PAGE" TO CORRECT-A.
070800     MOVE "CHECK RWCS OUTPUT REPORT" TO RE-MARK.
070900     PERFORM PRINT-DETAIL.
071000 EXIT-RW103.
071100     EXIT.
071200 CCVS-EXIT SECTION.
071300 CCVS-999999.
071400     GO TO CLOSE-FILES.
