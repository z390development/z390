000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ154A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 3.0.                                 *
000900*                                                              *
001000*    CREATION DATE     /     VALIDATION DATE                   *
001100*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001200*                                                              *
001300****************************************************************
001400*                                                              *
001500*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001600*                                                              *
001700*            X-01   SEQUENTIAL TAPE                            *
001800*            X-55   SYSTEM PRINTER                             *
001900*            X-82   SOURCE-COMPUTER                            *
002000*            X-83   OBJECT-COMPUTER                            *
002100*            X-84   LABEL RECORDS OPTION.                      *
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    THIS PROGRAM CHECKS FOR THE CORRECT RESPONSE TO WRITING TO*
002600*    A FILE THAT IS NOT OPEN (NOT OPEN IN THE OUTPUT OR EXTEND *
002700*    MODE).  THE TEST FOR CORRECT I-O STATUS CODE 48 IS IN THE *
002800*    MAIN LINE CODE, THEREFORE AN ABNORMAL TERMINATION IS      *
002900*    POSSIBLE BEFORE THE TEST OF THE I-O STATUS CODE IS        *
003000*    ACCOMPLISHED.                                             *
003100*                                                              *
003200****************************************************************
003300*
003400 ENVIRONMENT DIVISION.
003500 CONFIGURATION SECTION.
003600 SOURCE-COMPUTER.
003700     XXXXX082.
003800 OBJECT-COMPUTER.
003900     XXXXX083.
004000*
004100 INPUT-OUTPUT SECTION.
004200 FILE-CONTROL.
004300     SELECT PRINT-FILE ASSIGN TO
004400     XXXXX055.
004500*
004600     SELECT SQ-FS1 ASSIGN TO
004700     XXXXX001
004800            FILE STATUS IS SQ-FS1-STATUS.
004900*
005000*
005100 DATA DIVISION.
005200 FILE SECTION.
005300 FD  PRINT-FILE
005400C    LABEL RECORDS
005500C    XXXXX084
005600C    DATA RECORD IS PRINT-REC DUMMY-RECORD
005700               .
005800 01  PRINT-REC    PICTURE X(120).
005900 01  DUMMY-RECORD PICTURE X(120).
006000*
006100 FD  SQ-FS1
006200C    LABEL RECORD IS STANDARD
006300                .
006400 01  SQ-FS1R1-F-G-120 PIC X(120).
006500*
006600 WORKING-STORAGE SECTION.
006700*
006800***************************************************************
006900*                                                             *
007000*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
007100*                                                             *
007200***************************************************************
007300*
007400 01  SQ-FS1-STATUS.
007500   03  SQ-FS1-KEY-1   PIC X.
007600   03  SQ-FS1-KEY-2   PIC X.
007700*
007800***************************************************************
007900*                                                             *
008000*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
008100*                                                             *
008200***************************************************************
008300*
008400 01  REC-SKEL-SUB   PIC 99.
008500*
008600 01  FILE-RECORD-INFORMATION-REC.
008700     03 FILE-RECORD-INFO-SKELETON.
008800        05 FILLER                 PICTURE X(48)       VALUE
008900             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
009000        05 FILLER                 PICTURE X(46)       VALUE
009100             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
009200        05 FILLER                 PICTURE X(26)       VALUE
009300             ",LFIL=000000,ORG=  ,LBLR= ".
009400        05 FILLER                 PICTURE X(37)       VALUE
009500             ",RECKEY=                             ".
009600        05 FILLER                 PICTURE X(38)       VALUE
009700             ",ALTKEY1=                             ".
009800        05 FILLER                 PICTURE X(38)       VALUE
009900             ",ALTKEY2=                             ".
010000        05 FILLER                 PICTURE X(7)        VALUE SPACE.
010100     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
010200        05 FILE-RECORD-INFO-P1-120.
010300           07 FILLER              PIC X(5).
010400           07 XFILE-NAME          PIC X(6).
010500           07 FILLER              PIC X(8).
010600           07 XRECORD-NAME        PIC X(6).
010700           07 FILLER              PIC X(1).
010800           07 REELUNIT-NUMBER     PIC 9(1).
010900           07 FILLER              PIC X(7).
011000           07 XRECORD-NUMBER      PIC 9(6).
011100           07 FILLER              PIC X(6).
011200           07 UPDATE-NUMBER       PIC 9(2).
011300           07 FILLER              PIC X(5).
011400           07 ODO-NUMBER          PIC 9(4).
011500           07 FILLER              PIC X(5).
011600           07 XPROGRAM-NAME       PIC X(5).
011700           07 FILLER              PIC X(7).
011800           07 XRECORD-LENGTH      PIC 9(6).
011900           07 FILLER              PIC X(7).
012000           07 CHARS-OR-RECORDS    PIC X(2).
012100           07 FILLER              PIC X(1).
012200           07 XBLOCK-SIZE         PIC 9(4).
012300           07 FILLER              PIC X(6).
012400           07 RECORDS-IN-FILE     PIC 9(6).
012500           07 FILLER              PIC X(5).
012600           07 XFILE-ORGANIZATION  PIC X(2).
012700           07 FILLER              PIC X(6).
012800           07 XLABEL-TYPE         PIC X(1).
012900        05 FILE-RECORD-INFO-P121-240.
013000           07 FILLER              PIC X(8).
013100           07 XRECORD-KEY         PIC X(29).
013200           07 FILLER              PIC X(9).
013300           07 ALTERNATE-KEY1      PIC X(29).
013400           07 FILLER              PIC X(9).
013500           07 ALTERNATE-KEY2      PIC X(29).
013600           07 FILLER              PIC X(7).
013700*
013800 01  TEST-RESULTS.
013900     02 FILLER              PIC X      VALUE SPACE.
014000     02 FEATURE             PIC X(24)  VALUE SPACE.
014100     02 FILLER              PIC X      VALUE SPACE.
014200     02 P-OR-F              PIC X(5)   VALUE SPACE.
014300     02 FILLER              PIC X      VALUE SPACE.
014400     02  PAR-NAME.
014500       03 FILLER              PIC X(14)  VALUE SPACE.
014600       03 PARDOT-X            PIC X      VALUE SPACE.
014700       03 DOTVALUE            PIC 99     VALUE ZERO.
014800     02 FILLER              PIC X(9)   VALUE SPACE.
014900     02 RE-MARK             PIC X(61).
015000 01  TEST-COMPUTED.
015100   02 FILLER  PIC X(30)  VALUE SPACE.
015200   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
015300   02 COMPUTED-X.
015400     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
015500     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
015600     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
015700     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
015800     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
015900     03       CM-18V0 REDEFINES COMPUTED-A.
016000        04 COMPUTED-18V0                   PIC -9(18).
016100        04 FILLER                          PIC X.
016200     03 FILLER PIC X(50) VALUE SPACE.
016300 01  TEST-CORRECT.
016400     02 FILLER PIC X(30) VALUE SPACE.
016500     02 FILLER PIC X(17) VALUE "       CORRECT =".
016600     02 CORRECT-X.
016700     03 CORRECT-A                  PIC X(20) VALUE SPACE.
016800     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
016900     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
017000     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
017100     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
017200     03      CR-18V0 REDEFINES CORRECT-A.
017300         04 CORRECT-18V0                     PIC -9(18).
017400         04 FILLER                           PIC X.
017500     03 FILLER PIC X(2) VALUE SPACE.
017600     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
017700 01  CCVS-C-1.
017800     02 FILLER  PIC IS X(4)     VALUE SPACE.
017900     02 FILLER  PIC IS X(98)    VALUE IS "FEATURE               PA
018000-    "SS  PARAGRAPH-NAME
018100-    "       REMARKS".
018200     02 FILLER           PIC X(17)    VALUE SPACE.
018300 01  CCVS-C-2.
018400     02 FILLER           PIC XXXX     VALUE SPACE.
018500     02 FILLER           PIC X(6)     VALUE "TESTED".
018600     02 FILLER           PIC X(16)    VALUE SPACE.
018700     02 FILLER           PIC X(4)     VALUE "FAIL".
018800     02 FILLER           PIC X(90)    VALUE SPACE.
018900 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
019000 01  REC-CT            PIC 99       VALUE ZERO.
019100 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
019200 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
019300 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
019400 01  PASS-COUNTER      PIC 999      VALUE ZERO.
019500 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
019600 01  ERROR-HOLD        PIC 999      VALUE ZERO.
019700 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
019800 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
019900 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
020000 01  CCVS-H-1.
020100     02  FILLER          PIC X(39)    VALUE SPACES.
020200     02  FILLER          PIC X(42)    VALUE
020300     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
020400     02  FILLER          PIC X(39)    VALUE SPACES.
020500 01  CCVS-H-2A.
020600   02  FILLER            PIC X(40)  VALUE SPACE.
020700   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
020800   02  FILLER            PIC XXXX   VALUE
020900     "4.2 ".
021000   02  FILLER            PIC X(28)  VALUE
021100            " COPY - NOT FOR DISTRIBUTION".
021200   02  FILLER            PIC X(41)  VALUE SPACE.
021300*
021400 01  CCVS-H-2B.
021500   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
021600   02  TEST-ID           PIC X(9).
021700   02  FILLER            PIC X(4)   VALUE " IN ".
021800   02  FILLER            PIC X(12)  VALUE
021900     " HIGH       ".
022000   02  FILLER            PIC X(22)  VALUE
022100            " LEVEL VALIDATION FOR ".
022200   02  FILLER            PIC X(58)  VALUE
022300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
022400 01  CCVS-H-3.
022500     02  FILLER          PIC X(34)  VALUE
022600            " FOR OFFICIAL USE ONLY    ".
022700     02  FILLER          PIC X(58)  VALUE
022800     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022900     02  FILLER          PIC X(28)  VALUE
023000            "  COPYRIGHT   1985,1986 ".
023100 01  CCVS-E-1.
023200     02 FILLER           PIC X(52)  VALUE SPACE.
023300     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
023400     02 ID-AGAIN         PIC X(9).
023500     02 FILLER           PIC X(45)  VALUE SPACES.
023600 01  CCVS-E-2.
023700     02  FILLER          PIC X(31)  VALUE SPACE.
023800     02  FILLER          PIC X(21)  VALUE SPACE.
023900     02  CCVS-E-2-2.
024000         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
024100         03 FILLER         PIC X      VALUE SPACE.
024200         03 ENDER-DESC     PIC X(44)  VALUE
024300            "ERRORS ENCOUNTERED".
024400 01  CCVS-E-3.
024500     02  FILLER          PIC X(22)  VALUE
024600            " FOR OFFICIAL USE ONLY".
024700     02  FILLER          PIC X(12)  VALUE SPACE.
024800     02  FILLER          PIC X(58)  VALUE
024900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025000     02  FILLER          PIC X(8)   VALUE SPACE.
025100     02  FILLER          PIC X(20)  VALUE
025200             " COPYRIGHT 1985,1986".
025300 01  CCVS-E-4.
025400     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
025500     02 FILLER           PIC X(4)   VALUE " OF ".
025600     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
025700     02 FILLER           PIC X(40)  VALUE
025800      "  TESTS WERE EXECUTED SUCCESSFULLY".
025900 01  XXINFO.
026000     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
026100     02 INFO-TEXT.
026200       04 FILLER             PIC X(8)   VALUE SPACE.
026300       04 XXCOMPUTED         PIC X(20).
026400       04 FILLER             PIC X(5)   VALUE SPACE.
026500       04 XXCORRECT          PIC X(20).
026600     02 INF-ANSI-REFERENCE PIC X(48).
026700 01  HYPHEN-LINE.
026800     02 FILLER  PIC IS X VALUE IS SPACE.
026900     02 FILLER  PIC IS X(65)    VALUE IS "************************
027000-    "*****************************************".
027100     02 FILLER  PIC IS X(54)    VALUE IS "************************
027200-    "******************************".
027300 01  CCVS-PGM-ID  PIC X(9)   VALUE
027400     "SQ154A".
027500*
027600 PROCEDURE DIVISION.
027700 CCVS1 SECTION.
027800 OPEN-FILES.
027900     OPEN    OUTPUT PRINT-FILE.
028000     MOVE    CCVS-PGM-ID TO TEST-ID.
028100     MOVE    CCVS-PGM-ID TO ID-AGAIN.
028200     MOVE    SPACE TO TEST-RESULTS.
028300     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
028400     MOVE    ZERO TO REC-SKEL-SUB.
028500     PERFORM CCVS-INIT-FILE 10 TIMES.
028600     GO TO CCVS1-EXIT.
028700*
028800 CCVS-INIT-FILE.
028900     ADD     1 TO REC-SKL-SUB.
029000     MOVE    FILE-RECORD-INFO-SKELETON TO
029100                  FILE-RECORD-INFO (REC-SKL-SUB).
029200*
029300 CLOSE-FILES.
029400     PERFORM END-ROUTINE THRU END-ROUTINE-13.
029500     CLOSE   PRINT-FILE.
029600 TERMINATE-CCVS.
029700     STOP    RUN.
029800*
029900 INSPT.
030000     MOVE   "INSPT" TO P-OR-F.
030100     ADD     1 TO INSPECT-COUNTER.
030200     PERFORM PRINT-DETAIL.
030300
030400 PASS.
030500     MOVE   "PASS " TO P-OR-F.
030600     ADD     1 TO PASS-COUNTER.
030700     PERFORM PRINT-DETAIL.
030800*
030900 FAIL.
031000     MOVE   "FAIL*" TO P-OR-F.
031100     ADD     1 TO ERROR-COUNTER.
031200     PERFORM PRINT-DETAIL.
031300*
031400 DE-LETE.
031500     MOVE   "****TEST DELETED****" TO RE-MARK.
031600     MOVE   "*****" TO P-OR-F.
031700     ADD     1 TO DELETE-COUNTER.
031800     PERFORM PRINT-DETAIL.
031900*
032000 PRINT-DETAIL.
032100     IF REC-CT NOT EQUAL TO ZERO
032200         MOVE   "." TO PARDOT-X
032300         MOVE    REC-CT TO DOTVALUE.
032400     MOVE    TEST-RESULTS TO PRINT-REC.
032500     PERFORM WRITE-LINE.
032600     IF P-OR-F EQUAL TO "FAIL*"
032700         PERFORM WRITE-LINE
032800         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
032900     ELSE
033000         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
033100     MOVE    SPACE TO P-OR-F.
033200     MOVE    SPACE TO COMPUTED-X.
033300     MOVE    SPACE TO CORRECT-X.
033400     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
033500     MOVE    SPACE TO RE-MARK.
033600*
033700 HEAD-ROUTINE.
033800     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033900     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034000     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
034100     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
034200 COLUMN-NAMES-ROUTINE.
034300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
034600 END-ROUTINE.
034700     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
034800     PERFORM WRITE-LINE 5 TIMES.
034900 END-RTN-EXIT.
035000     MOVE    CCVS-E-1 TO DUMMY-RECORD.
035100     PERFORM WRITE-LINE 2 TIMES.
035200*
035300 END-ROUTINE-1.
035400     ADD     ERROR-COUNTER   TO ERROR-HOLD
035500     ADD     INSPECT-COUNTER TO ERROR-HOLD.
035600     ADD     DELETE-COUNTER  TO ERROR-HOLD.
035700     ADD     PASS-COUNTER    TO ERROR-HOLD.
035800     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
035900     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
036000     MOVE    CCVS-E-4        TO CCVS-E-2-2.
036100     MOVE    CCVS-E-2        TO DUMMY-RECORD
036200     PERFORM WRITE-LINE.
036300     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
036400     IF ERROR-COUNTER IS EQUAL TO ZERO
036500         MOVE   "NO " TO ERROR-TOTAL
036600     ELSE
036700         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
036800     MOVE    CCVS-E-2 TO DUMMY-RECORD.
036900     PERFORM WRITE-LINE.
037000 END-ROUTINE-13.
037100     IF DELETE-COUNTER IS EQUAL TO ZERO
037200         MOVE   "NO " TO ERROR-TOTAL
037300     ELSE
037400         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
037500     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
037600     MOVE    CCVS-E-2 TO DUMMY-RECORD.
037700     PERFORM WRITE-LINE.
037800     IF INSPECT-COUNTER EQUAL TO ZERO
037900         MOVE   "NO " TO ERROR-TOTAL
038000     ELSE
038100         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
038200     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
038300     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038400     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038500*
038600 WRITE-LINE.
038700     ADD     1 TO RECORD-COUNT.
038800Y    IF RECORD-COUNT GREATER 50
038900Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
039000Y        MOVE  SPACE TO DUMMY-RECORD
039100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
039200Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
039300Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
039400Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
039500Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
039600Y        MOVE  ZERO TO RECORD-COUNT.
039700     PERFORM WRT-LN.
039800*
039900 WRT-LN.
040000     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
040100     MOVE    SPACE TO DUMMY-RECORD.
040200 BLANK-LINE-PRINT.
040300     PERFORM WRT-LN.
040400 FAIL-ROUTINE.
040500     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
040600     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
040700     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
040800     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
040900     MOVE    XXINFO TO DUMMY-RECORD.
041000     PERFORM WRITE-LINE 2 TIMES.
041100     MOVE    SPACES TO INF-ANSI-REFERENCE.
041200     GO TO   FAIL-ROUTINE-EX.
041300 FAIL-ROUTINE-WRITE.
041400     MOVE    TEST-COMPUTED  TO PRINT-REC
041500     PERFORM WRITE-LINE
041600     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
041700     MOVE    TEST-CORRECT   TO PRINT-REC
041800     PERFORM WRITE-LINE 2 TIMES.
041900     MOVE    SPACES         TO COR-ANSI-REFERENCE.
042000 FAIL-ROUTINE-EX.
042100     EXIT.
042200 BAIL-OUT.
042300     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
042400     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
042500 BAIL-OUT-WRITE.
042600     MOVE    CORRECT-A      TO XXCORRECT.
042700     MOVE    COMPUTED-A     TO XXCOMPUTED.
042800     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
042900     MOVE    XXINFO TO DUMMY-RECORD.
043000     PERFORM WRITE-LINE 2 TIMES.
043100     MOVE    SPACES TO INF-ANSI-REFERENCE.
043200 BAIL-OUT-EX.
043300     EXIT.
043400 CCVS1-EXIT.
043500     EXIT.
043600*
043700****************************************************************
043800*                                                              *
043900*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
044000*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
044100*                                                              *
044200****************************************************************
044300*
044400 SECT-SQ154A-0001 SECTION.
044500 WRITE-INIT-GF-01.
044600*
044700*        THIS TEST CREATES FILE SQ-FS1 AND CLOSES IT.
044800*        FIRST IT SETS UP A SKELETON RECORD IN WORKING STORAGE.
044900*
045000     MOVE "SQ-FS1"     TO XFILE-NAME (1).
045100     MOVE "R1-F-G"     TO XRECORD-NAME (1).
045200     MOVE  CCVS-PGM-ID TO XPROGRAM-NAME (1).
045300     MOVE 120          TO XRECORD-LENGTH (1).
045400     MOVE "RC"         TO CHARS-OR-RECORDS (1).
045500     MOVE 1            TO XBLOCK-SIZE (1).
045600     MOVE 1            TO RECORDS-IN-FILE (1).
045700     MOVE "SQ"         TO XFILE-ORGANIZATION (1).
045800     MOVE "S"          TO XLABEL-TYPE (1).
045900     MOVE 1            TO XRECORD-NUMBER (1).
046000*
046100 WRITE-OPEN-01.
046200     OPEN    OUTPUT SQ-FS1.
046300*
046400*        WRITE A SINGLE RECORD TO THE FILE
046500*
046600 WRITE-TEST-01-01.
046700     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-FS1R1-F-G-120.
046800     WRITE   SQ-FS1R1-F-G-120.
046900*
047000*        CLOSE THE FILE.
047100*
047200 CLOSE-INIT-01.
047300 CLOSE-TEST-01.
047400     CLOSE   SQ-FS1.
047500*
047600 WRITE-INIT-01.
047700*        WE WILL NOW ATTEMPT TO WRITE A RECORD TO THE
047800*        CLOSED FILE.  I-O STATUS 48 SHOULD BE GENERATED.
047900*
048000     MOVE "WRITE TO CLOSED FILE" TO FEATURE.
048100     MOVE "**" TO SQ-FS1-STATUS.
048200     MOVE "WRITE-TEST-01" TO PAR-NAME.
048300     MOVE 1 TO REC-CT.
048400     MOVE "ABNORMAL TERMINATION AT THIS POINT IS ACCEPTABLE"
048500             TO DUMMY-RECORD
048600     PERFORM WRITE-LINE 3 TIMES.
048700*
048800 WRITE-TEST-01.
048900     WRITE SQ-FS1R1-F-G-120.
049000     IF SQ-FS1-STATUS = "48"
049100             PERFORM PASS
049200     ELSE
049300             MOVE "48" TO CORRECT-A
049400             MOVE SQ-FS1-STATUS TO COMPUTED-A
049500             MOVE "STATUS FOR WRITE TO CLOSED FILE INCORRECT"
049600                     TO RE-MARK
049700             MOVE "VII-5, 1.3.5(4)G" TO ANSI-REFERENCE
049800             PERFORM FAIL
049900     END-IF.
050000*
050100 CCVS-EXIT SECTION.
050200 CCVS-999999.
050300     GO TO CLOSE-FILES.
