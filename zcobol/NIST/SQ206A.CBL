000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ206A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    " HIGH       ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "4.2 ".
001100*                                                              *
001200*         THE ROUTINE SQ206A TESTS THE USE OF THE CLAUSES SAME
001300*    RECORD AREA AND SAME AREA OF THE I-O-CONTROL PARAGRAPH.
001400*    TAPE FILES AND MASS-STORAGE FILES ARE CREATED WHICH
001500*    REFERENCE THE SAME RECORD AREA OR ARE NAMED IN A SAME AREA
001600*    CLAUSE.  THE FILES ARE PROCESSED AND THE CONTENTS OF THE
001700*    RECORDS VERIFIED AGAINST THE EXPECTED RESULTS.
001800 ENVIRONMENT DIVISION.
001900 CONFIGURATION SECTION.
002000 SOURCE-COMPUTER.
002100     XXXXX082.
002200 OBJECT-COMPUTER.
002300     XXXXX083.
002400 INPUT-OUTPUT SECTION.
002500 FILE-CONTROL.
002600P    SELECT RAW-DATA   ASSIGN TO
002700P    XXXXX062
002800P           ORGANIZATION IS INDEXED
002900P           ACCESS MODE IS RANDOM
003000P           RECORD KEY IS RAW-DATA-KEY.
003100     SELECT PRINT-FILE ASSIGN TO
003200     XXXXX055.
003300     SELECT SQ-FS1 ASSIGN TO
003400     XXXXX001
003500     ORGANIZATION SEQUENTIAL.
003600     SELECT SQ-FS2 ASSIGN
003700     XXXXX014
003800     ACCESS IS SEQUENTIAL.
003900     SELECT SQ-FS3 ASSIGN TO
004000     XXXXX015
004100     ORGANIZATION IS SEQUENTIAL
004200     ACCESS MODE SEQUENTIAL.
004300     SELECT SQ-FS4 ASSIGN
004400     XXXXX002
004500     ORGANIZATION SEQUENTIAL
004600     ACCESS SEQUENTIAL.
004700 I-O-CONTROL.
004800     SAME SQ-FS1, SQ-FS2
004900     SAME RECORD AREA FOR SQ-FS1, SQ-FS2, SQ-FS3, SQ-FS4.
005000 DATA DIVISION.
005100 FILE SECTION.
005200P
005300PFD  RAW-DATA.
005400P
005500P01  RAW-DATA-SATZ.
005600P    05  RAW-DATA-KEY        PIC X(6).
005700P    05  C-DATE              PIC 9(6).
005800P    05  C-TIME              PIC 9(8).
005900P    05  C-NO-OF-TESTS       PIC 99.
006000P    05  C-OK                PIC 999.
006100P    05  C-ALL               PIC 999.
006200P    05  C-FAIL              PIC 999.
006300P    05  C-DELETED           PIC 999.
006400P    05  C-INSPECT           PIC 999.
006500P    05  C-NOTE              PIC X(13).
006600P    05  C-INDENT            PIC X.
006700P    05  C-ABORT             PIC X(8).
006800 FD  PRINT-FILE
006900C    LABEL RECORDS
007000C    XXXXX084
007100C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007200               .
007300 01  PRINT-REC PICTURE X(120).
007400 01  DUMMY-RECORD PICTURE X(120).
007500 FD  SQ-FS1
007600C    LABEL RECORDS ARE STANDARD
007700     BLOCK CONTAINS 120 CHARACTERS.
007800 01  SQ-FS1R1-F-G-120   PIC X(120).
007900 FD  SQ-FS2
008000C    LABEL RECORD IS STANDARD
008100                .
008200 01  SQ-FS2R1-F-G-120 PIC X(120).
008300 FD  SQ-FS3
008400C    LABEL RECORD STANDARD
008500                .
008600 01  SQ-FS3R1-F-G-120   PIC X(120).
008700 FD  SQ-FS4
008800C    LABEL RECORDS STANDARD
008900                .
009000 01  SQ-FS4R1-F-G-120 PIC X(120).
009100 WORKING-STORAGE SECTION.
009200 77  WRK-RECORD-COUNT      PIC 9(4) VALUE 0.
009300 77  RECORDS-IN-ERROR   PIC 9(4) VALUE 0.
009400 01  COUNT-OF-RECS PIC 9999.
009500 01  FILE-RECORD-INFORMATION-REC.
009600     03 FILE-RECORD-INFO-SKELETON.
009700        05 FILLER                 PICTURE X(48)       VALUE
009800             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
009900        05 FILLER                 PICTURE X(46)       VALUE
010000             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
010100        05 FILLER                 PICTURE X(26)       VALUE
010200             ",LFIL=000000,ORG=  ,LBLR= ".
010300        05 FILLER                 PICTURE X(37)       VALUE
010400             ",RECKEY=                             ".
010500        05 FILLER                 PICTURE X(38)       VALUE
010600             ",ALTKEY1=                             ".
010700        05 FILLER                 PICTURE X(38)       VALUE
010800             ",ALTKEY2=                             ".
010900        05 FILLER                 PICTURE X(7)        VALUE SPACE.
011000     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
011100        05 FILE-RECORD-INFO-P1-120.
011200           07 FILLER              PIC X(5).
011300           07 XFILE-NAME           PIC X(6).
011400           07 FILLER              PIC X(8).
011500           07 XRECORD-NAME         PIC X(6).
011600           07 FILLER              PIC X(1).
011700           07 REELUNIT-NUMBER     PIC 9(1).
011800           07 FILLER              PIC X(7).
011900           07 XRECORD-NUMBER       PIC 9(6).
012000           07 FILLER              PIC X(6).
012100           07 UPDATE-NUMBER       PIC 9(2).
012200           07 FILLER              PIC X(5).
012300           07 ODO-NUMBER          PIC 9(4).
012400           07 FILLER              PIC X(5).
012500           07 XPROGRAM-NAME        PIC X(5).
012600           07 FILLER              PIC X(7).
012700           07 XRECORD-LENGTH       PIC 9(6).
012800           07 FILLER              PIC X(7).
012900           07 CHARS-OR-RECORDS    PIC X(2).
013000           07 FILLER              PIC X(1).
013100           07 XBLOCK-SIZE          PIC 9(4).
013200           07 FILLER              PIC X(6).
013300           07 RECORDS-IN-FILE     PIC 9(6).
013400           07 FILLER              PIC X(5).
013500           07 XFILE-ORGANIZATION   PIC X(2).
013600           07 FILLER              PIC X(6).
013700           07 XLABEL-TYPE          PIC X(1).
013800        05 FILE-RECORD-INFO-P121-240.
013900           07 FILLER              PIC X(8).
014000           07 XRECORD-KEY          PIC X(29).
014100           07 FILLER              PIC X(9).
014200           07 ALTERNATE-KEY1      PIC X(29).
014300           07 FILLER              PIC X(9).
014400           07 ALTERNATE-KEY2      PIC X(29).
014500           07 FILLER              PIC X(7).
014600 01  TEST-RESULTS.
014700     02 FILLER                    PICTURE X VALUE SPACE.
014800     02 FEATURE                   PICTURE X(20) VALUE SPACE.
014900     02 FILLER                    PICTURE X VALUE SPACE.
015000     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
015100     02 FILLER                    PICTURE X  VALUE SPACE.
015200     02  PAR-NAME.
015300       03 FILLER PICTURE X(12) VALUE SPACE.
015400       03  PARDOT-X PICTURE X  VALUE SPACE.
015500       03 DOTVALUE PICTURE 99  VALUE ZERO.
015600       03 FILLER PIC X(5) VALUE SPACE.
015700     02 FILLER PIC X(10) VALUE SPACE.
015800     02 RE-MARK PIC X(61).
015900 01  TEST-COMPUTED.
016000     02 FILLER PIC X(30) VALUE SPACE.
016100     02 FILLER PIC X(17) VALUE "       COMPUTED=".
016200     02 COMPUTED-X.
016300     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
016400     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
016500     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
016600     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
016700     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
016800     03       CM-18V0 REDEFINES COMPUTED-A.
016900         04 COMPUTED-18V0                   PICTURE -9(18).
017000         04 FILLER                          PICTURE X.
017100     03 FILLER PIC X(50) VALUE SPACE.
017200 01  TEST-CORRECT.
017300     02 FILLER PIC X(30) VALUE SPACE.
017400     02 FILLER PIC X(17) VALUE "       CORRECT =".
017500     02 CORRECT-X.
017600     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
017700     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
017800     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
017900     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
018000     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
018100     03      CR-18V0 REDEFINES CORRECT-A.
018200         04 CORRECT-18V0                    PICTURE -9(18).
018300         04 FILLER                          PICTURE X.
018400     03 FILLER PIC X(50) VALUE SPACE.
018500 01  CCVS-C-1.
018600     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
018700-    "SS  PARAGRAPH-NAME
018800-    "        REMARKS".
018900     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
019000 01  CCVS-C-2.
019100     02 FILLER PICTURE IS X VALUE IS SPACE.
019200     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
019300     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
019400     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
019500     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
019600 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
019700 01  REC-CT PICTURE 99 VALUE ZERO.
019800 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
019900 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
020000 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
020100 01  PASS-COUNTER PIC 999 VALUE ZERO.
020200 01  TOTAL-ERROR PIC 999 VALUE ZERO.
020300 01  ERROR-HOLD PIC 999 VALUE ZERO.
020400 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
020500 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
020600 01  CCVS-H-1.
020700     02  FILLER   PICTURE X(27)  VALUE SPACE.
020800     02 FILLER PICTURE X(67) VALUE
020900     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
021000-    " SYSTEM".
021100     02  FILLER     PICTURE X(26)  VALUE SPACE.
021200 01  CCVS-H-2.
021300     02 FILLER PICTURE X(52) VALUE IS
021400     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
021500     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
021600     02 TEST-ID PICTURE IS X(9).
021700     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
021800 01  CCVS-H-3.
021900     02  FILLER PICTURE X(34) VALUE
022000     " FOR OFFICIAL USE ONLY    ".
022100     02  FILLER PICTURE X(58) VALUE
022200     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022300     02  FILLER PICTURE X(28) VALUE
022400     "  COPYRIGHT   1985 ".
022500 01  CCVS-E-1.
022600     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
022700     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
022800     02 ID-AGAIN PICTURE IS X(9).
022900     02 FILLER PICTURE X(45) VALUE IS
023000     " NTIS DISTRIBUTION COBOL 85".
023100 01  CCVS-E-2.
023200     02  FILLER                   PICTURE X(31)  VALUE
023300     SPACE.
023400     02  FILLER                   PICTURE X(21)  VALUE SPACE.
023500     02 CCVS-E-2-2.
023600         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
023700         03 FILLER PICTURE IS X VALUE IS SPACE.
023800         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
023900 01  CCVS-E-3.
024000     02  FILLER PICTURE X(22) VALUE
024100     " FOR OFFICIAL USE ONLY".
024200     02  FILLER PICTURE X(12) VALUE SPACE.
024300     02  FILLER PICTURE X(58) VALUE
024400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024500     02  FILLER PICTURE X(13) VALUE SPACE.
024600     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
024700 01  CCVS-E-4.
024800     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
024900     02 FILLER PIC XXXX VALUE " OF ".
025000     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
025100     02 FILLER PIC X(40) VALUE
025200      "  TESTS WERE EXECUTED SUCCESSFULLY".
025300 01  XXINFO.
025400     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
025500     02 INFO-TEXT.
025600     04 FILLER PIC X(20) VALUE SPACE.
025700     04 XXCOMPUTED PIC X(20).
025800     04 FILLER PIC X(5) VALUE SPACE.
025900     04 XXCORRECT PIC X(20).
026000 01  HYPHEN-LINE.
026100     02 FILLER PICTURE IS X VALUE IS SPACE.
026200     02 FILLER PICTURE IS X(65) VALUE IS "************************
026300-    "*****************************************".
026400     02 FILLER PICTURE IS X(54) VALUE IS "************************
026500-    "******************************".
026600 01  CCVS-PGM-ID PIC X(6) VALUE
026700     "SQ206A".
026800 PROCEDURE DIVISION.
026900 CCVS1 SECTION.
027000 OPEN-FILES.
027100P    OPEN I-O RAW-DATA.
027200P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
027300P    READ RAW-DATA INVALID KEY GO TO END-E-1.
027400P    MOVE "ABORTED " TO C-ABORT.
027500P    ADD 1 TO C-NO-OF-TESTS.
027600P    ACCEPT C-DATE  FROM DATE.
027700P    ACCEPT C-TIME  FROM TIME.
027800P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
027900PEND-E-1.
028000P    CLOSE RAW-DATA.
028100     OPEN     OUTPUT PRINT-FILE.
028200     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
028300     MOVE    SPACE TO TEST-RESULTS.
028400     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
028500     MOVE ZERO TO REC-SKL-SUB.
028600     PERFORM CCVS-INIT-FILE 9 TIMES.
028700 CCVS-INIT-FILE.
028800     ADD 1 TO REC-SKL-SUB.
028900     MOVE FILE-RECORD-INFO-SKELETON TO
029000                  FILE-RECORD-INFO (REC-SKL-SUB).
029100 CCVS-INIT-EXIT.
029200     GO TO CCVS1-EXIT.
029300 CLOSE-FILES.
029400     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
029500P    OPEN I-O RAW-DATA.
029600P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
029700P    READ RAW-DATA INVALID KEY GO TO END-E-2.
029800P    MOVE "OK.     " TO C-ABORT.
029900P    MOVE PASS-COUNTER TO C-OK.
030000P    MOVE ERROR-HOLD   TO C-ALL.
030100P    MOVE ERROR-COUNTER TO C-FAIL.
030200P    MOVE DELETE-CNT TO C-DELETED.
030300P    MOVE INSPECT-COUNTER TO C-INSPECT.
030400P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
030500PEND-E-2.
030600P    CLOSE RAW-DATA.
030700 TERMINATE-CCVS.
030800S    EXIT PROGRAM.
030900STERMINATE-CALL.
031000     STOP     RUN.
031100 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
031200 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
031300 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
031400 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
031500     MOVE "****TEST DELETED****" TO RE-MARK.
031600 PRINT-DETAIL.
031700     IF REC-CT NOT EQUAL TO ZERO
031800             MOVE "." TO PARDOT-X
031900             MOVE REC-CT TO DOTVALUE.
032000     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
032100     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
032200        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
032300          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
032400     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
032500     MOVE SPACE TO CORRECT-X.
032600     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
032700     MOVE     SPACE TO RE-MARK.
032800 HEAD-ROUTINE.
032900     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033000     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033100     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
033200 COLUMN-NAMES-ROUTINE.
033300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
033600 END-ROUTINE.
033700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033800 END-RTN-EXIT.
033900     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034000 END-ROUTINE-1.
034100      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
034200      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
034300      ADD PASS-COUNTER TO ERROR-HOLD.
034400*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
034500      MOVE PASS-COUNTER TO CCVS-E-4-1.
034600      MOVE ERROR-HOLD TO CCVS-E-4-2.
034700      MOVE CCVS-E-4 TO CCVS-E-2-2.
034800      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
034900  END-ROUTINE-12.
035000      MOVE "TEST(S) FAILED" TO ENDER-DESC.
035100     IF       ERROR-COUNTER IS EQUAL TO ZERO
035200         MOVE "NO " TO ERROR-TOTAL
035300         ELSE
035400         MOVE ERROR-COUNTER TO ERROR-TOTAL.
035500     MOVE     CCVS-E-2 TO DUMMY-RECORD.
035600     PERFORM WRITE-LINE.
035700 END-ROUTINE-13.
035800     IF DELETE-CNT IS EQUAL TO ZERO
035900         MOVE "NO " TO ERROR-TOTAL  ELSE
036000         MOVE DELETE-CNT TO ERROR-TOTAL.
036100     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
036200     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036300      IF   INSPECT-COUNTER EQUAL TO ZERO
036400          MOVE "NO " TO ERROR-TOTAL
036500      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
036600      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
036700      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036800     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036900 WRITE-LINE.
037000     ADD 1 TO RECORD-COUNT.
037100Y    IF RECORD-COUNT GREATER 50
037200Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
037300Y        MOVE SPACE TO DUMMY-RECORD
037400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
037500Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
037600Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
037700Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
037800Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
037900Y        MOVE ZERO TO RECORD-COUNT.
038000     PERFORM WRT-LN.
038100 WRT-LN.
038200     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
038300     MOVE SPACE TO DUMMY-RECORD.
038400 BLANK-LINE-PRINT.
038500     PERFORM WRT-LN.
038600 FAIL-ROUTINE.
038700     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
038800     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
038900     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
039000     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039100     GO TO FAIL-ROUTINE-EX.
039200 FAIL-ROUTINE-WRITE.
039300     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
039400     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
039500 FAIL-ROUTINE-EX. EXIT.
039600 BAIL-OUT.
039700     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
039800     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
039900 BAIL-OUT-WRITE.
040000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
040100     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040200 BAIL-OUT-EX. EXIT.
040300 CCVS1-EXIT.
040400     EXIT.
040500 SECT-SQ206A-0001 SECTION.
040600 WRITE-INIT-GF-01.
040700*             IN THIS TEST TWO FILES ARE CREATED USING THE SAME
040800*             RECORD AREA.  THE LOGICAL RECORD WRITTEN ON SQ-FS1
040900*             REMAINS IN THE RECORD AREA TO BE WRITTEN ON SQ-FS3.
041000*             ONLY THE FILE NAMES CHANGE.
041100     MOVE "R1-F-G" TO XRECORD-NAME (1).
041200     MOVE "SQ206"  TO XPROGRAM-NAME (1).
041300     MOVE 120      TO XRECORD-LENGTH (1).
041400     MOVE "RC"     TO CHARS-OR-RECORDS (1).
041500     MOVE 1        TO XBLOCK-SIZE (1).
041600     MOVE 750      TO RECORDS-IN-FILE (1).
041700     MOVE "SQ"     TO XFILE-ORGANIZATION (1).
041800     MOVE "S"      TO XLABEL-TYPE (1).
041900     MOVE 1        TO XRECORD-NUMBER (1).
042000     OPEN OUTPUT SQ-FS1, SQ-FS3.
042100 WRITE-TEST-GF-01.
042200     MOVE "SQ-FS1" TO XFILE-NAME (1).
042300     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-FS1R1-F-G-120.
042400     WRITE SQ-FS1R1-F-G-120.
042500     MOVE "SQ-FS3" TO XFILE-NAME (1).
042600     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-FS3R1-F-G-120.
042700     WRITE SQ-FS3R1-F-G-120.
042800     IF XRECORD-NUMBER (1) EQUAL TO 750
042900              GO TO WRITE-WRITE-GF-01.
043000     ADD 1 TO XRECORD-NUMBER (1).
043100     GO TO WRITE-TEST-GF-01.
043200 WRITE-DELETE-GF-01.
043300     PERFORM DE-LETE.
043400 WRITE-WRITE-GF-01.
043500     MOVE "CREATE SQ-FS1,SQ-FS3" TO FEATURE.
043600     MOVE "WRITE-TEST-GF-01" TO PAR-NAME.
043700     MOVE "FILES CREATED RECS =" TO COMPUTED-A.
043800     MOVE XRECORD-NUMBER (1) TO CORRECT-18V0.
043900     PERFORM PRINT-DETAIL.
044000     CLOSE SQ-FS1, SQ-FS3.
044100 WRITE-INIT-GF-02.
044200     MOVE "SQ-FS4" TO XFILE-NAME (2).
044300     MOVE "R1-F-G" TO XRECORD-NAME (2).
044400     MOVE "SQ206"  TO XPROGRAM-NAME (2).
044500     MOVE 120      TO XRECORD-LENGTH (2).
044600     MOVE "RC"     TO CHARS-OR-RECORDS (2).
044700     MOVE 1        TO XBLOCK-SIZE (2).
044800     MOVE 750      TO RECORDS-IN-FILE (2).
044900     MOVE "SQ"     TO XFILE-ORGANIZATION (2).
045000     MOVE "S"      TO XLABEL-TYPE (2).
045100     MOVE 1        TO XRECORD-NUMBER (2).
045200     OPEN INPUT SQ-FS1, SQ-FS3
045300          OUTPUT SQ-FS4.
045400 WRITE-TEST-GF-02.
045500     MOVE FILE-RECORD-INFO-P1-120 (2) TO SQ-FS4R1-F-G-120.
045600     WRITE SQ-FS4R1-F-G-120.
045700     IF XRECORD-NUMBER (2) EQUAL TO 750
045800              GO TO WRITE-WRITE-GF-02.
045900     ADD 1 TO XRECORD-NUMBER (2).
046000     GO TO WRITE-TEST-GF-02.
046100 WRITE-DELETE-GF-02.
046200     PERFORM DE-LETE.
046300 WRITE-WRITE-GF-02.
046400     MOVE "CREATE FILE SQ-FS4" TO FEATURE.
046500     MOVE "WRITE-TEST-GF-02" TO PAR-NAME.
046600     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
046700     MOVE XRECORD-NUMBER (2) TO CORRECT-18V0.
046800     PERFORM PRINT-DETAIL.
046900     CLOSE SQ-FS4.
047000 READ-INIT-GF-01.
047100*             THIS TEST READS AND VALIDATES SQ-FS1 WHICH WAS
047200*             CREATED IN WRITE-TEST-GF-01. SQ-FS1 IS OPENED FOR
047300*             INPUT IN WRITE-INIT-GF-02.
047400     MOVE 0 TO WRK-RECORD-COUNT, RECORDS-IN-ERROR.
047500 READ-TEST-GF-01.
047600     READ SQ-FS1
047700              AT END GO TO READ-TEST-GF-01-01.
047800     MOVE SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
047900     ADD 1 TO WRK-RECORD-COUNT.
048000     IF WRK-RECORD-COUNT GREATER THAN 750
048100              MOVE "MORE THAN 750 RECORDS" TO RE-MARK
048200              GO TO READ-FAIL-GF-01.
048300     IF WRK-RECORD-COUNT NOT EQUAL TO XRECORD-NUMBER (1)
048400              ADD 1 TO RECORDS-IN-ERROR
048500              GO TO READ-TEST-GF-01.
048600     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS1"
048700              ADD 1 TO RECORDS-IN-ERROR
048800              GO TO READ-TEST-GF-01.
048900     IF XLABEL-TYPE (1) NOT EQUAL TO "S"
049000              ADD 1 TO RECORDS-IN-ERROR.
049100     GO TO READ-TEST-GF-01.
049200 READ-TEST-GF-01-01.
049300     IF RECORDS-IN-ERROR EQUAL TO ZERO
049400              GO TO READ-PASS-GF-01.
049500     MOVE "ERRORS IN READING-SQ-FS1" TO RE-MARK.
049600     GO TO READ-FAIL-GF-01.
049700 READ-DELETE-GF-01.
049800     PERFORM DE-LETE.
049900     GO TO READ-WRITE-GF-01.
050000 READ-FAIL-GF-01.
050100     MOVE "RECORDS IN ERROR =" TO COMPUTED-A.
050200     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
050300     PERFORM FAIL.
050400     GO TO READ-WRITE-GF-01.
050500 READ-PASS-GF-01.
050600     PERFORM PASS.
050700     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
050800     MOVE WRK-RECORD-COUNT TO CORRECT-18V0.
050900 READ-WRITE-GF-01.
051000     MOVE "READ-TEST-GF-01" TO PAR-NAME.
051100     MOVE "VERIFY FILE SQ-FS1" TO FEATURE.
051200     PERFORM PRINT-DETAIL.
051300 READ-CLOSE-GF-01.
051400     CLOSE SQ-FS1.
051500 READ-INIT-GF-02.
051600*             THIS TEST READS AND VALIDATES SQ-FS3 WHICH WAS
051700*             CREATED IN WRITE-TEST-GF-01. SQ-FS3 IS OPENED FOR
051800*             INPUT IN WRITE-INIT-GF-02.
051900     MOVE 0 TO WRK-RECORD-COUNT, RECORDS-IN-ERROR.
052000 READ-TEST-GF-02.
052100     READ SQ-FS3
052200              AT END GO TO READ-TEST-GF-02-01.
052300     MOVE SQ-FS3R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (3).
052400     ADD 1 TO WRK-RECORD-COUNT.
052500     IF WRK-RECORD-COUNT GREATER THAN 750
052600              MOVE "MORE THAN 750 RECORDS" TO RE-MARK
052700              GO TO READ-FAIL-GF-02.
052800     IF WRK-RECORD-COUNT NOT EQUAL TO XRECORD-NUMBER (3)
052900              ADD 1 TO RECORDS-IN-ERROR
053000              GO TO READ-TEST-GF-02.
053100     IF XFILE-NAME (3) NOT EQUAL TO "SQ-FS3"
053200              ADD 1 TO RECORDS-IN-ERROR
053300              GO TO READ-TEST-GF-02.
053400     IF XLABEL-TYPE (3) NOT EQUAL TO "S"
053500              ADD 1 TO RECORDS-IN-ERROR.
053600     GO TO READ-TEST-GF-02.
053700 READ-TEST-GF-02-01.
053800     IF RECORDS-IN-ERROR EQUAL TO ZERO
053900              GO TO READ-PASS-GF-02.
054000     MOVE "ERRORS IN READING SQ-FS3" TO RE-MARK.
054100     GO TO READ-FAIL-GF-02.
054200 READ-DELETE-GF-02.
054300     PERFORM DE-LETE.
054400     GO TO READ-WRITE-GF-02.
054500 READ-FAIL-GF-02.
054600     MOVE "RECORDS IN ERROR =" TO COMPUTED-A.
054700     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
054800     PERFORM FAIL.
054900     GO TO READ-WRITE-GF-02.
055000 READ-PASS-GF-02.
055100     PERFORM PASS.
055200     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
055300     MOVE WRK-RECORD-COUNT TO CORRECT-18V0.
055400 READ-WRITE-GF-02.
055500     MOVE "READ-TEST-GF-02" TO PAR-NAME.
055600     MOVE "VERIFY FILE SQ-FS3" TO FEATURE.
055700     PERFORM PRINT-DETAIL.
055800 READ-CLOSE-GF-02.
055900     CLOSE SQ-FS3.
056000 READ-INIT-GF-03.
056100*             IN THIS TEST SQ-FS2 IS CREATED AND SQ-FS4 IS READ
056200*             AND VALIDATED USING SAME RECORD AREA.  SQ-FS4 WAS
056300*             CREATED IN WRITE-TEST-GF-02.
056400     MOVE "SQ-FS2" TO XFILE-NAME (2).
056500     MOVE "R1-F-G" TO XRECORD-NAME (2).
056600     MOVE "SQ206"  TO XPROGRAM-NAME (2).
056700     MOVE 120      TO XRECORD-LENGTH (2).
056800     MOVE "RC"     TO CHARS-OR-RECORDS (2).
056900     MOVE 1        TO XBLOCK-SIZE (2).
057000     MOVE 750      TO RECORDS-IN-FILE (2).
057100     MOVE "SQ"     TO XFILE-ORGANIZATION (2).
057200     MOVE "S"      TO XLABEL-TYPE (2).
057300     MOVE 1        TO XRECORD-NUMBER (2).
057400     OPEN INPUT SQ-FS4
057500          OUTPUT SQ-FS2.
057600 READ-TEST-GF-03.
057700     MOVE FILE-RECORD-INFO-P1-120 (2) TO SQ-FS2R1-F-G-120.
057800     WRITE SQ-FS2R1-F-G-120.
057900     IF XRECORD-NUMBER (2) EQUAL TO 750
058000              GO TO READ-WRITE-GF-03.
058100     ADD 1 TO XRECORD-NUMBER (2).
058200     GO TO READ-TEST-GF-03.
058300 READ-DELETE-GF-03.
058400     PERFORM DE-LETE.
058500 READ-WRITE-GF-03.
058600     MOVE "CREATE FILE SQ-FS2" TO FEATURE.
058700     MOVE "READ-TEST-GF-03" TO PAR-NAME.
058800     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
058900     MOVE XRECORD-NUMBER (2) TO CORRECT-18V0.
059000     PERFORM PRINT-DETAIL.
059100     CLOSE SQ-FS2.
059200 READ-INIT-GF-04.
059300*             THIS TEST READS AND VALIDATES SQ-FS4 WHICH WAS
059400*             CREATED IN WRITE-TEST-GF-02. SQ-FS4 IS OPENED FOR
059500*             INPUT IN WRITE-INIT-GF-03.
059600     MOVE 0 TO WRK-RECORD-COUNT, RECORDS-IN-ERROR.
059700 READ-TEST-GF-04.
059800     READ SQ-FS4
059900              AT END GO TO READ-TEST-GF-04-01.
060000     MOVE SQ-FS4R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (4).
060100     ADD 1 TO WRK-RECORD-COUNT.
060200     IF WRK-RECORD-COUNT GREATER THAN 750
060300              MOVE "MORE THAN 750 RECORDS" TO RE-MARK
060400              GO TO READ-FAIL-GF-04.
060500     IF WRK-RECORD-COUNT NOT EQUAL TO XRECORD-NUMBER (4)
060600              ADD 1 TO RECORDS-IN-ERROR
060700              GO TO READ-TEST-GF-04.
060800     IF XFILE-NAME (4) NOT EQUAL TO "SQ-FS4"
060900              ADD 1 TO RECORDS-IN-ERROR
061000              GO TO READ-TEST-GF-04.
061100     IF XLABEL-TYPE (4) NOT EQUAL TO "S"
061200              ADD 1 TO RECORDS-IN-ERROR.
061300     GO TO READ-TEST-GF-04.
061400 READ-TEST-GF-04-01.
061500     IF RECORDS-IN-ERROR EQUAL TO ZERO
061600              GO TO READ-PASS-GF-04.
061700     MOVE "ERRORS IN READING SQ-FS4" TO RE-MARK.
061800     GO TO READ-FAIL-GF-04.
061900 READ-DELETE-GF-04.
062000     PERFORM DE-LETE.
062100     GO TO READ-WRITE-GF-04.
062200 READ-FAIL-GF-04.
062300     MOVE "RECORDS IN ERROR =" TO COMPUTED-A.
062400     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
062500     PERFORM FAIL.
062600     GO TO READ-WRITE-GF-04.
062700 READ-PASS-GF-04.
062800     PERFORM PASS.
062900     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
063000     MOVE WRK-RECORD-COUNT TO CORRECT-18V0.
063100 READ-WRITE-GF-04.
063200     MOVE "READ-TEST-GF-04" TO PAR-NAME.
063300     MOVE "VERIFY FILE SQ-FS4" TO FEATURE.
063400     PERFORM PRINT-DETAIL.
063500 READ-CLOSE-GF-04.
063600     CLOSE SQ-FS4.
063700 READ-INIT-GF-05.
063800*             THIS TEST READS AND VALIDATE SQ-FS2 WHICH WAS
063900*             CREATED IN WRITE-TEST-GF-02.
064000     MOVE 0 TO WRK-RECORD-COUNT, RECORDS-IN-ERROR.
064100     OPEN INPUT SQ-FS2.
064200 READ-TEST-GF-05.
064300     READ SQ-FS2
064400              AT END GO TO READ-TEST-GF-05-01.
064500     MOVE SQ-FS2R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (2).
064600     ADD 1 TO WRK-RECORD-COUNT.
064700     IF WRK-RECORD-COUNT GREATER THAN 750
064800              MOVE "MORE THAN 750 RECORDS" TO RE-MARK
064900              GO TO READ-FAIL-GF-05.
065000     IF WRK-RECORD-COUNT NOT EQUAL TO XRECORD-NUMBER (2)
065100              ADD 1 TO RECORDS-IN-ERROR
065200              GO TO READ-TEST-GF-05.
065300     IF XFILE-NAME (2) NOT EQUAL TO "SQ-FS2"
065400              ADD 1 TO RECORDS-IN-ERROR
065500              GO TO READ-TEST-GF-05.
065600     IF XLABEL-TYPE (2) NOT EQUAL TO "S"
065700              ADD 1 TO RECORDS-IN-ERROR.
065800     GO TO READ-TEST-GF-05.
065900 READ-TEST-GF-05-01.
066000     IF RECORDS-IN-ERROR EQUAL TO ZERO
066100              GO TO READ-PASS-GF-05.
066200     MOVE "ERRORS IN READING SQ-FS2" TO RE-MARK.
066300     GO TO READ-FAIL-GF-05.
066400 READ-DELETE-GF-05.
066500     PERFORM DE-LETE.
066600     GO TO READ-WRITE-GF-05.
066700 READ-FAIL-GF-05.
066800     MOVE "RECORDS IN ERROR =" TO COMPUTED-A.
066900     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
067000     PERFORM FAIL.
067100     GO TO READ-WRITE-GF-05.
067200 READ-PASS-GF-05.
067300     PERFORM PASS.
067400     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
067500     MOVE WRK-RECORD-COUNT TO CORRECT-18V0.
067600 READ-WRITE-GF-05.
067700     MOVE "READ-TEST-GF-05" TO PAR-NAME.
067800     MOVE "VERIFY FILE SQ-FS2" TO FEATURE.
067900     PERFORM PRINT-DETAIL.
068000 READ-CLOSE-GF-05.
068100     CLOSE SQ-FS2.
068200 SQ206A-END-ROUTINE.
068300     MOVE "END OF SQ206A VALIDATION TESTS" TO PRINT-REC.
068400     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
068500 TERMINATE-SQ206A.
068600     EXIT.
068700 CCVS-EXIT SECTION.
068800 CCVS-999999.
068900     GO TO CLOSE-FILES.
