000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IX204A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*IX204A
001400******************************************************************
001500*
001600*    NEW TESTS:
001700*                         CLOSE  ... <WITH LOCK>
001800*
001900*
002000*    THIS PROGRAM TESTS THE SYNTACTICAL CONSTRUCTS AND SEMANTIC
002100*    ACTIONS ASSOCIATED WITH THE FOLLOWING ELEMENTS:
002200*
002300*    (1) FILE STATUS   (ONLY 00 & 10)
002400*    (2) USE AFTER ERROR PROCEDURE ON FILE-NAME
002500*    (3) READ
002600*    (4) WRITE
002700*    (5) REWRITE
002800*    (6) RECORD KEY
002900*    (7) ACCESS
003000*
003100*    THIS PROGRAM CREATES AN INDEXED FILE SEQUENTIALLY (ACCESS
003200*    MODE DYMANIC) AND THEN UPDATES SELECTIVE RECORDS OF THE FILE.
003300*    THE FILE STATUS CONTENTS ARE CAPTURED AND TESTED FOR ACCURACY
003400*    FOR EACH OPEN, CLOSE, READ AND REWRITE STATEMENT USED.  THE
003500*    READ, WRITE AND REWRITE STATEMENTS ARE USED WITHOUT THE
003600*    APPROPRIATE AT END OR INVALID KEY PHRASES.  THE OMISSION OF
003700*    THESE PHRASES ARE PERMITTED IF AN APPLICABLE USE PROCEDURE
003800*    HAS BEEN SPECIFIED.
003900*
004000*
004100*       X-CARDS  WHICH MUST BE REPLACED FOR THIS PROGRAM ARE
004200*
004300*             X-25   INDEXED FILE IMPLEMENTOR-NAME IN ASSIGN TO
004400*                    CLAUSE FOR DATA FILE IX-FD2
004500*             X-45   INDEXED FILE IMPLEMENTOR-NAME IN ASSIGN TO
004600*                    CLAUSE FOR INDEX FILE IX-FD2
004700*             X-55   IMPLEMENTOR-NAME FOR SYSTEM PRINTER
004800*             X-62   IMPLEMENTOR-NAME FOR RAW-DATA
004900*             X-82   IMPLEMENTOR-NAME FOR SOURCE-COMPUTER
005000*             X-83   IMPLEMENTOR-NAME FOR OBJECT-COMPUTER
005100*             X-84   LABEL RECORDS    FOR PRINT-FILEPUTER
005200*
005300*         NOTE:  X-CARDS 45, 62 AND 84      ARE OPTIONAL
005400*               AND NEED ONLY TO BE PRESENT IF THE COMPILER RE-
005500*               QUIRES THIS CODE BE AVAILABLE FOR PROPER PROGRAM
005600*               COMPILATION AND EXECUTION. IF THE VP-ROUTINE IS
005700*               USED THE  X-CARDS MAY BE AUTOMATICALLY SELECTED
005800*               FOR INCLUSION IN THE PROGRAM BY SPECIFYING THE
005900*               APPROPRIATE LETTER IN THE "*OPT" VP-ROUTINE
006000*               CONTROL CARD. THE LETTER  CORRESPONDS TO A
006100*               CHARACTER IN POSITION 7 OF THE SOURCE LINE AND
006200*               THEY ARE AS FOLLOWS
006300*
006400*                  P  SELECTS X-CARDS 62
006500*                  J  SELECTS X-CARD 45
006600*                  C  SELECTS X-CARD 84
006700*
006800******************************************************
006900 ENVIRONMENT DIVISION.
007000 CONFIGURATION SECTION.
007100 SOURCE-COMPUTER.
007200     XXXXX082.
007300 OBJECT-COMPUTER.
007400     XXXXX083.
007500 INPUT-OUTPUT SECTION.
007600 FILE-CONTROL.
007700P    SELECT RAW-DATA   ASSIGN TO
007800P    XXXXX062
007900P           ORGANIZATION IS INDEXED
008000P           ACCESS MODE IS RANDOM
008100P           RECORD KEY IS RAW-DATA-KEY.
008200     SELECT PRINT-FILE ASSIGN TO
008300     XXXXX055.
008400     SELECT IX-FD2 ASSIGN
008500     XXXXX025
008600J    XXXXX045
008700             ORGANIZATION IS INDEXED
008800        ACCESS  DYNAMIC
008900        FILE STATUS IS IX-FD2-STATUS
009000        RECORD  IX-FD2-KEY.
009100 DATA DIVISION.
009200 FILE SECTION.
009300P
009400PFD  RAW-DATA.
009500P
009600P01  RAW-DATA-SATZ.
009700P    05  RAW-DATA-KEY        PIC X(6).
009800P    05  C-DATE              PIC 9(6).
009900P    05  C-TIME              PIC 9(8).
010000P    05  C-NO-OF-TESTS       PIC 99.
010100P    05  C-OK                PIC 999.
010200P    05  C-ALL               PIC 999.
010300P    05  C-FAIL              PIC 999.
010400P    05  C-DELETED           PIC 999.
010500P    05  C-INSPECT           PIC 999.
010600P    05  C-NOTE              PIC X(13).
010700P    05  C-INDENT            PIC X.
010800P    05  C-ABORT             PIC X(8).
010900 FD  PRINT-FILE.
011000 01  PRINT-REC PICTURE X(120).
011100 01  DUMMY-RECORD PICTURE X(120).
011200 FD  IX-FD2
011300C    LABEL RECORDS ARE STANDARD
011400C    DATA RECORDS IX-FD2R1-F-G-240
011500     BLOCK CONTAINS 480
011600     RECORD CONTAINS  240  CHARACTERS.
011700 01  IX-FD2R1-F-G-240.
011800     05 IX-FD2-REC-120    PIC X(120).
011900     05 IX-FD2-REC-120-240.
012000     10  FILLER PICTURE X(8).
012100     10  IX-FD2-KEY PIC X(29).
012200     10  FILLER PIC X(83).
012300 WORKING-STORAGE SECTION.
012400 01  GRP-0101.
012500     02 FILLER PIC X(10) VALUE "ABCD921XYZ".
012600     02  WRK-DU-09V00-001 PIC 9(9) VALUE ZERO.
012700     02 FILLER PIC X(10) VALUE "Z2F()$+-AB".
012800 01  GRP-0001.
012900     05 WRK-CS-09V00-012  PIC S9(9) USAGE COMP  VALUE ZERO.
013000     05 WRK-CS-09V00-013  PIC S9(9) USAGE COMP  VALUE ZERO.
013100     05 WRK-CS-09V00-014  PIC S9(9) USAGE COMP  VALUE ZERO.
013200     05 WRK-CS-09V00-015  PIC S9(9) USAGE COMP  VALUE ZERO.
013300     05 WRK-CS-09V00-016  PIC S9(9) USAGE COMP  VALUE ZERO.
013400     05 WRK-CS-09V00-017  PIC S9(9) USAGE COMP  VALUE ZERO.
013500     05 WRK-CS-09V00-018  PIC S9(9) USAGE COMP  VALUE ZERO.
013600     05 IX-FD2-STATUS     PIC  XX  VALUE  SPACE.
013700     05 WRK-XN-0002-001   PIC  X(2) VALUE  SPACE.
013800     05 WRK-XN-0002-002   PIC  X(2) VALUE  SPACE.
013900     05 WRK-XN-0002-003   PIC  X(2) VALUE  SPACE.
014000     05 WRK-XN-0002-004   PIC  X(2) VALUE  SPACE.
014100     05 WRK-XN-0002-005   PIC  X(2) VALUE  SPACE.
014200     05 WRK-XN-0002-006   PIC  X(2) VALUE  SPACE.
014300     05 WRK-XN-0002-007   PIC  X(2) VALUE  SPACE.
014400     05 WRK-XN-0002-008   PIC  X(2) VALUE  SPACE.
014500     05 WRK-XN-0002-009   PIC  X(2) VALUE  SPACE.
014600 01  DUMMY-WRK-REC.
014700     02 DUMMY-WRK1       PIC X(120).
014800     02 DUMMY-WRK2  REDEFINES  DUMMY-WRK1.
014900        03 FILLER   PIC X(5).
015000        03 DUMMY-WRK-INDENT-5  PIC X(115).
015100 01  FILE-RECORD-INFORMATION-REC.
015200     03 FILE-RECORD-INFO-SKELETON.
015300        05 FILLER                 PICTURE X(48)       VALUE
015400             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
015500        05 FILLER                 PICTURE X(46)       VALUE
015600             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
015700        05 FILLER                 PICTURE X(26)       VALUE
015800             ",LFIL=000000,ORG=  ,LBLR= ".
015900        05 FILLER                 PICTURE X(37)       VALUE
016000             ",RECKEY=                             ".
016100        05 FILLER                 PICTURE X(38)       VALUE
016200             ",ALTKEY1=                             ".
016300        05 FILLER                 PICTURE X(38)       VALUE
016400             ",ALTKEY2=                             ".
016500        05 FILLER                 PICTURE X(7)        VALUE SPACE.
016600     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
016700        05 FILE-RECORD-INFO-P1-120.
016800           07 FILLER              PIC X(5).
016900           07 XFILE-NAME           PIC X(6).
017000           07 FILLER              PIC X(8).
017100           07 XRECORD-NAME         PIC X(6).
017200           07 FILLER              PIC X(1).
017300           07 REELUNIT-NUMBER     PIC 9(1).
017400           07 FILLER              PIC X(7).
017500           07 XRECORD-NUMBER       PIC 9(6).
017600           07 FILLER              PIC X(6).
017700           07 UPDATE-NUMBER       PIC 9(2).
017800           07 FILLER              PIC X(5).
017900           07 ODO-NUMBER          PIC 9(4).
018000           07 FILLER              PIC X(5).
018100           07 XPROGRAM-NAME        PIC X(5).
018200           07 FILLER              PIC X(7).
018300           07 XRECORD-LENGTH       PIC 9(6).
018400           07 FILLER              PIC X(7).
018500           07 CHARS-OR-RECORDS    PIC X(2).
018600           07 FILLER              PIC X(1).
018700           07 XBLOCK-SIZE          PIC 9(4).
018800           07 FILLER              PIC X(6).
018900           07 RECORDS-IN-FILE     PIC 9(6).
019000           07 FILLER              PIC X(5).
019100           07 XFILE-ORGANIZATION   PIC X(2).
019200           07 FILLER              PIC X(6).
019300           07 XLABEL-TYPE          PIC X(1).
019400        05 FILE-RECORD-INFO-P121-240.
019500           07 FILLER              PIC X(8).
019600           07 XRECORD-KEY          PIC X(29).
019700           07 FILLER              PIC X(9).
019800           07 ALTERNATE-KEY1      PIC X(29).
019900           07 FILLER              PIC X(9).
020000           07 ALTERNATE-KEY2      PIC X(29).
020100           07 FILLER              PIC X(7).
020200 01  TEST-RESULTS.
020300     02 FILLER                   PIC X      VALUE SPACE.
020400     02 FEATURE                  PIC X(20)  VALUE SPACE.
020500     02 FILLER                   PIC X      VALUE SPACE.
020600     02 P-OR-F                   PIC X(5)   VALUE SPACE.
020700     02 FILLER                   PIC X      VALUE SPACE.
020800     02  PAR-NAME.
020900       03 FILLER                 PIC X(19)  VALUE SPACE.
021000       03  PARDOT-X              PIC X      VALUE SPACE.
021100       03 DOTVALUE               PIC 99     VALUE ZERO.
021200     02 FILLER                   PIC X(8)   VALUE SPACE.
021300     02 RE-MARK                  PIC X(61).
021400 01  TEST-COMPUTED.
021500     02 FILLER                   PIC X(30)  VALUE SPACE.
021600     02 FILLER                   PIC X(17)  VALUE
021700            "       COMPUTED=".
021800     02 COMPUTED-X.
021900     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
022000     03 COMPUTED-N               REDEFINES COMPUTED-A
022100                                 PIC -9(9).9(9).
022200     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
022300     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
022400     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
022500     03       CM-18V0 REDEFINES COMPUTED-A.
022600         04 COMPUTED-18V0                    PIC -9(18).
022700         04 FILLER                           PIC X.
022800     03 FILLER PIC X(50) VALUE SPACE.
022900 01  TEST-CORRECT.
023000     02 FILLER PIC X(30) VALUE SPACE.
023100     02 FILLER PIC X(17) VALUE "       CORRECT =".
023200     02 CORRECT-X.
023300     03 CORRECT-A                  PIC X(20) VALUE SPACE.
023400     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
023500     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
023600     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
023700     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
023800     03      CR-18V0 REDEFINES CORRECT-A.
023900         04 CORRECT-18V0                     PIC -9(18).
024000         04 FILLER                           PIC X.
024100     03 FILLER PIC X(2) VALUE SPACE.
024200     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
024300 01  CCVS-C-1.
024400     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
024500-    "SS  PARAGRAPH-NAME
024600-    "       REMARKS".
024700     02 FILLER                     PIC X(20)    VALUE SPACE.
024800 01  CCVS-C-2.
024900     02 FILLER                     PIC X        VALUE SPACE.
025000     02 FILLER                     PIC X(6)     VALUE "TESTED".
025100     02 FILLER                     PIC X(15)    VALUE SPACE.
025200     02 FILLER                     PIC X(4)     VALUE "FAIL".
025300     02 FILLER                     PIC X(94)    VALUE SPACE.
025400 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
025500 01  REC-CT                        PIC 99       VALUE ZERO.
025600 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
025700 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
025800 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
025900 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
026000 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
026100 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
026200 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
026300 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
026400 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
026500 01  CCVS-H-1.
026600     02  FILLER                    PIC X(39)    VALUE SPACES.
026700     02  FILLER                    PIC X(42)    VALUE
026800     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
026900     02  FILLER                    PIC X(39)    VALUE SPACES.
027000 01  CCVS-H-2A.
027100   02  FILLER                        PIC X(40)  VALUE SPACE.
027200   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
027300   02  FILLER                        PIC XXXX   VALUE
027400     "4.2 ".
027500   02  FILLER                        PIC X(28)  VALUE
027600            " COPY - NOT FOR DISTRIBUTION".
027700   02  FILLER                        PIC X(41)  VALUE SPACE.
027800
027900 01  CCVS-H-2B.
028000   02  FILLER                        PIC X(15)  VALUE
028100            "TEST RESULT OF ".
028200   02  TEST-ID                       PIC X(9).
028300   02  FILLER                        PIC X(4)   VALUE
028400            " IN ".
028500   02  FILLER                        PIC X(12)  VALUE
028600     " HIGH       ".
028700   02  FILLER                        PIC X(22)  VALUE
028800            " LEVEL VALIDATION FOR ".
028900   02  FILLER                        PIC X(58)  VALUE
029000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
029100 01  CCVS-H-3.
029200     02  FILLER                      PIC X(34)  VALUE
029300            " FOR OFFICIAL USE ONLY    ".
029400     02  FILLER                      PIC X(58)  VALUE
029500     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
029600     02  FILLER                      PIC X(28)  VALUE
029700            "  COPYRIGHT   1985 ".
029800 01  CCVS-E-1.
029900     02 FILLER                       PIC X(52)  VALUE SPACE.
030000     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
030100     02 ID-AGAIN                     PIC X(9).
030200     02 FILLER                       PIC X(45)  VALUE SPACES.
030300 01  CCVS-E-2.
030400     02  FILLER                      PIC X(31)  VALUE SPACE.
030500     02  FILLER                      PIC X(21)  VALUE SPACE.
030600     02 CCVS-E-2-2.
030700         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
030800         03 FILLER                   PIC X      VALUE SPACE.
030900         03 ENDER-DESC               PIC X(44)  VALUE
031000            "ERRORS ENCOUNTERED".
031100 01  CCVS-E-3.
031200     02  FILLER                      PIC X(22)  VALUE
031300            " FOR OFFICIAL USE ONLY".
031400     02  FILLER                      PIC X(12)  VALUE SPACE.
031500     02  FILLER                      PIC X(58)  VALUE
031600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
031700     02  FILLER                      PIC X(13)  VALUE SPACE.
031800     02 FILLER                       PIC X(15)  VALUE
031900             " COPYRIGHT 1985".
032000 01  CCVS-E-4.
032100     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
032200     02 FILLER                       PIC X(4)   VALUE " OF ".
032300     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
032400     02 FILLER                       PIC X(40)  VALUE
032500      "  TESTS WERE EXECUTED SUCCESSFULLY".
032600 01  XXINFO.
032700     02 FILLER                       PIC X(19)  VALUE
032800            "*** INFORMATION ***".
032900     02 INFO-TEXT.
033000       04 FILLER                     PIC X(8)   VALUE SPACE.
033100       04 XXCOMPUTED                 PIC X(20).
033200       04 FILLER                     PIC X(5)   VALUE SPACE.
033300       04 XXCORRECT                  PIC X(20).
033400     02 INF-ANSI-REFERENCE           PIC X(48).
033500 01  HYPHEN-LINE.
033600     02 FILLER  PIC IS X VALUE IS SPACE.
033700     02 FILLER  PIC IS X(65)    VALUE IS "************************
033800-    "*****************************************".
033900     02 FILLER  PIC IS X(54)    VALUE IS "************************
034000-    "******************************".
034100 01  CCVS-PGM-ID                     PIC X(9)   VALUE
034200     "IX204A".
034300 PROCEDURE DIVISION.
034400 DECLARATIVES.
034500 IX-FD2-01 SECTION.
034600     USE    AFTER STANDARD ERROR PROCEDURE ON IX-FD2.
034700 IX-FD2-01-01.
034800     ADD      1 TO  WRK-CS-09V00-013.
034900     GO TO    IX-FD2-01-03
035000              IX-FD2-01-05
035100              DEPENDING ON  WRK-CS-09V00-012.
035200     GO TO    IX-FD2-01-EXIT.
035300 IX-FD2-01-03.
035400*ENTRY FROM SEGMENT INX-TEST-001.
035500*    SHOULD NOT ENTER HERE UNLESS SPACE ALLOCATION TOO SMALL.
035600     ADD     1 TO  WRK-CS-09V00-014.
035700 IX-FD2-01-05.
035800     ADD      1 TO WRK-CS-09V00-017.
035900     IF       XRECORD-NUMBER (2) EQUAL TO 500
036000              MOVE   IX-FD2-STATUS TO WRK-XN-0002-002
036100              MOVE  "10" TO WRK-XN-0002-003.
036200 IX-FD2-01-EXIT.
036300     EXIT.
036400 END DECLARATIVES.
036500 CCVS1 SECTION.
036600 OPEN-FILES.
036700P    OPEN I-O RAW-DATA.
036800P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
036900P    READ RAW-DATA INVALID KEY GO TO END-E-1.
037000P    MOVE "ABORTED " TO C-ABORT.
037100P    ADD 1 TO C-NO-OF-TESTS.
037200P    ACCEPT C-DATE  FROM DATE.
037300P    ACCEPT C-TIME  FROM TIME.
037400P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
037500PEND-E-1.
037600P    CLOSE RAW-DATA.
037700     OPEN    OUTPUT PRINT-FILE.
037800     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
037900     MOVE    SPACE TO TEST-RESULTS.
038000     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
038100     MOVE    ZERO TO REC-SKL-SUB.
038200     PERFORM CCVS-INIT-FILE 9 TIMES.
038300 CCVS-INIT-FILE.
038400     ADD     1 TO REC-SKL-SUB.
038500     MOVE    FILE-RECORD-INFO-SKELETON
038600          TO FILE-RECORD-INFO (REC-SKL-SUB).
038700 CCVS-INIT-EXIT.
038800     GO TO CCVS1-EXIT.
038900 CLOSE-FILES.
039000P    OPEN I-O RAW-DATA.
039100P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
039200P    READ RAW-DATA INVALID KEY GO TO END-E-2.
039300P    MOVE "OK.     " TO C-ABORT.
039400P    MOVE PASS-COUNTER TO C-OK.
039500P    MOVE ERROR-HOLD   TO C-ALL.
039600P    MOVE ERROR-COUNTER TO C-FAIL.
039700P    MOVE DELETE-COUNTER TO C-DELETED.
039800P    MOVE INSPECT-COUNTER TO C-INSPECT.
039900P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
040000PEND-E-2.
040100P    CLOSE RAW-DATA.
040200     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
040300 TERMINATE-CCVS.
040400S    EXIT PROGRAM.
040500STERMINATE-CALL.
040600     STOP     RUN.
040700 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
040800 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
040900 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
041000 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
041100     MOVE "****TEST DELETED****" TO RE-MARK.
041200 PRINT-DETAIL.
041300     IF REC-CT NOT EQUAL TO ZERO
041400             MOVE "." TO PARDOT-X
041500             MOVE REC-CT TO DOTVALUE.
041600     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
041700     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
041800        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
041900          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
042000     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
042100     MOVE SPACE TO CORRECT-X.
042200     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
042300     MOVE     SPACE TO RE-MARK.
042400 HEAD-ROUTINE.
042500     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042600     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042700     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
042800     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
042900 COLUMN-NAMES-ROUTINE.
043000     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
043100     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
043300 END-ROUTINE.
043400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
043500 END-RTN-EXIT.
043600     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043700 END-ROUTINE-1.
043800      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
043900      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
044000      ADD PASS-COUNTER TO ERROR-HOLD.
044100*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
044200      MOVE PASS-COUNTER TO CCVS-E-4-1.
044300      MOVE ERROR-HOLD TO CCVS-E-4-2.
044400      MOVE CCVS-E-4 TO CCVS-E-2-2.
044500      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
044600  END-ROUTINE-12.
044700      MOVE "TEST(S) FAILED" TO ENDER-DESC.
044800     IF       ERROR-COUNTER IS EQUAL TO ZERO
044900         MOVE "NO " TO ERROR-TOTAL
045000         ELSE
045100         MOVE ERROR-COUNTER TO ERROR-TOTAL.
045200     MOVE     CCVS-E-2 TO DUMMY-RECORD.
045300     PERFORM WRITE-LINE.
045400 END-ROUTINE-13.
045500     IF DELETE-COUNTER IS EQUAL TO ZERO
045600         MOVE "NO " TO ERROR-TOTAL  ELSE
045700         MOVE DELETE-COUNTER TO ERROR-TOTAL.
045800     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
045900     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
046000      IF   INSPECT-COUNTER EQUAL TO ZERO
046100          MOVE "NO " TO ERROR-TOTAL
046200      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
046300      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
046400      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
046500     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
046600 WRITE-LINE.
046700     ADD 1 TO RECORD-COUNT.
046800Y    IF RECORD-COUNT GREATER 42
046900Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
047000Y        MOVE SPACE TO DUMMY-RECORD
047100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
047200Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
047300Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
047400Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
047500Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
047600Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
047700Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
047800Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
047900Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
048000Y        MOVE ZERO TO RECORD-COUNT.
048100     PERFORM WRT-LN.
048200 WRT-LN.
048300     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
048400     MOVE SPACE TO DUMMY-RECORD.
048500 BLANK-LINE-PRINT.
048600     PERFORM WRT-LN.
048700 FAIL-ROUTINE.
048800     IF     COMPUTED-X NOT EQUAL TO SPACE
048900            GO TO   FAIL-ROUTINE-WRITE.
049000     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
049100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
049200     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
049300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
049400     MOVE   SPACES TO INF-ANSI-REFERENCE.
049500     GO TO  FAIL-ROUTINE-EX.
049600 FAIL-ROUTINE-WRITE.
049700     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
049800     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
049900     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
050000     MOVE   SPACES TO COR-ANSI-REFERENCE.
050100 FAIL-ROUTINE-EX. EXIT.
050200 BAIL-OUT.
050300     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
050400     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
050500 BAIL-OUT-WRITE.
050600     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
050700     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
050800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
050900     MOVE   SPACES TO INF-ANSI-REFERENCE.
051000 BAIL-OUT-EX. EXIT.
051100 CCVS1-EXIT.
051200     EXIT.
051300 SECT-IX-04-001 SECTION.
051400 WRITE-INIT-GF-01.
051500     MOVE     "CREATE IX-FD2" TO  FEATURE
051600     MOVE    "WRITE-TEST-001" TO PAR-NAME.
051700     MOVE     "IX-FD2"        TO  XFILE-NAME (2).
051800     MOVE     "R1-F-G"        TO  XRECORD-NAME (2).
051900     MOVE     CCVS-PGM-ID     TO  XPROGRAM-NAME (2).
052000     MOVE     000240          TO  XRECORD-LENGTH (2).
052100     MOVE     "RC"            TO  CHARS-OR-RECORDS (2).
052200     MOVE     0001            TO  XBLOCK-SIZE       (2).
052300     MOVE     000500          TO  RECORDS-IN-FILE  (2).
052400     MOVE    "IX"                TO XFILE-ORGANIZATION (2).
052500     MOVE     "S"             TO  XLABEL-TYPE        (2).
052600     MOVE     000001          TO  XRECORD-NUMBER     (2).
052700*INITIALIZE  RECORD WORK AREA NUMBER 2.
052800     MOVE     1         TO  WRK-CS-09V00-012.
052900     MOVE     ZERO      TO  WRK-CS-09V00-013 WRK-CS-09V00-014
053000                            WRK-CS-09V00-015 WRK-CS-09V00-016
053100                            WRK-CS-09V00-017 WRK-CS-09V00-018.
053200     MOVE     SPACE     TO  IX-FD2-STATUS.
053300     MOVE    ZERO TO WRK-DU-09V00-001.
053400     OPEN    OUTPUT  IX-FD2.
053500     MOVE    GRP-0101  TO IX-FD2-KEY.
053600     MOVE     IX-FD2-STATUS TO WRK-XN-0002-001.
053700*CAPTURE STATUS KEY AFTER  OPEN STATEMENT IS EXECUTED.
053800 WRITE-TEST-GF-01-R.
053900     MOVE    "99"  TO IX-FD2-STATUS.
054000     MOVE     XRECORD-NUMBER (2) TO WRK-DU-09V00-001.
054100     MOVE     GRP-0101 TO XRECORD-KEY (2).
054200     MOVE     FILE-RECORD-INFO (2) TO IX-FD2R1-F-G-240.
054300     WRITE   IX-FD2R1-F-G-240.
054400     IF        IX-FD2-STATUS NOT EQUAL TO "00"
054500         ADD  1  TO WRK-CS-09V00-016.
054600     IF       XRECORD-NUMBER (2) EQUAL TO 500
054700              GO TO  WRITE-TEST-GF-01.
054800     ADD      01 TO  XRECORD-NUMBER (2).
054900     GO TO    WRITE-TEST-GF-01-R.
055000 WRITE-TEST-GF-01.
055100     MOVE     "WRITE  IX-FD2." TO  FEATURE.
055200     MOVE    "WRITE-TEST-GF-01" TO PAR-NAME.
055300     IF       WRK-CS-09V00-014 NOT EQUAL TO ZERO
055400              MOVE "EXCEPTIONS/ERRORS; IX-41 4.9.2" TO RE-MARK
055500              MOVE  ZERO TO CORRECT-18V0
055600              MOVE WRK-CS-09V00-014 TO COMPUTED-18V0
055700              PERFORM   FAIL
055800              ELSE
055900              PERFORM   PASS.
056000     PERFORM  PRINT-DETAIL.
056100 WRITE-TEST-GF-02.
056200     MOVE    "WRITE  IX-FD2." TO  FEATURE.
056300     MOVE    "WRITE-TEST-GF-02" TO PAR-NAME.
056400     IF       XRECORD-NUMBER (2) NOT EQUAL TO 500
056500              MOVE "INCORRECT COUNT; IX-41 4.9.2" TO RE-MARK
056600              MOVE  500 TO CORRECT-18V0
056700             MOVE   XRECORD-NUMBER (2)  TO COMPUTED-18V0
056800              PERFORM  FAIL
056900              ELSE
057000              PERFORM PASS.
057100     PERFORM  PRINT-DETAIL.
057200 WRITE-TEST-GF-03.
057300     MOVE    "OPEN OUTPUT 00" TO  FEATURE.
057400     MOVE    "WRITE-TEST-GF-03" TO PAR-NAME.
057500     IF       WRK-XN-0002-001 NOT EQUAL TO  "00"
057600              MOVE "STATUS/OPEN; IX-3 1.3.4 (1) A" TO RE-MARK
057700              MOVE WRK-XN-0002-001 TO COMPUTED-A
057800              MOVE "00" TO CORRECT-A
057900              PERFORM  FAIL
058000              ELSE
058100              PERFORM  PASS.
058200     PERFORM  PRINT-DETAIL.
058300 WRITE-TEST-GF-04.
058400     MOVE    "WRITE STATUS 00" TO  FEATURE.
058500     MOVE    "WRITE-TEST-GF-04" TO PAR-NAME.
058600     IF        IX-FD2-STATUS NOT EQUAL TO "00"
058700              MOVE "STATUS/WRITE; IX-3 1.3.4 (1) A" TO RE-MARK
058800              MOVE IX-FD2-STATUS TO COMPUTED-A
058900              MOVE "00" TO CORRECT-A
059000              PERFORM   FAIL
059100              ELSE
059200              PERFORM   PASS.
059300     PERFORM  PRINT-DETAIL.
059400 WRITE-TEST-GF-05.
059500     MOVE    "WRITE STATUS 00" TO  FEATURE.
059600     MOVE    "WRITE-TEST-GF-05" TO PAR-NAME.
059700     IF      WRK-CS-09V00-016    NOT EQUAL TO ZERO
059800              MOVE  "STATUS/WRITE; IX-3 1.3.4 (1) A"  TO RE-MARK
059900              MOVE    ZERO TO CORRECT-18V0
060000              MOVE    WRK-CS-09V00-016  TO COMPUTED-18V0
060100              PERFORM   FAIL
060200              ELSE
060300              PERFORM  PASS.
060400     PERFORM  PRINT-DETAIL.
060500 WRITE-TEST-GF-06.
060600     MOVE    "CLOSE: STATUS: 00" TO  FEATURE.
060700     MOVE    "WRITE-TEST-GF-06" TO PAR-NAME.
060800     MOVE     SPACE  TO  IX-FD2-STATUS.
060900     CLOSE    IX-FD2.
061000     IF        IX-FD2-STATUS NOT EQUAL TO "00"
061100              MOVE "CLOSE/STATUS; IX-3 1.3.4 (1) A" TO RE-MARK
061200              MOVE IX-FD2-STATUS TO COMPUTED-18V0
061300              MOVE "00" TO CORRECT-A
061400              PERFORM FAIL
061500              ELSE
061600              PERFORM PASS.
061700     PERFORM  PRINT-DETAIL.
061800 RWRT-INIT-GF-01.
061900     MOVE     2     TO  WRK-CS-09V00-012.
062000     MOVE     ZERO  TO  WRK-CS-09V00-013.
062100     MOVE     ZERO  TO  WRK-CS-09V00-014.
062200     MOVE     ZERO  TO  WRK-CS-09V00-015.
062300     MOVE     ZERO  TO  WRK-CS-09V00-016.
062400     MOVE     ZERO  TO  WRK-CS-09V00-017.
062500     MOVE     ZERO  TO  WRK-CS-09V00-018.
062600     MOVE    SPACE TO IX-FD2-STATUS.
062700     OPEN     I-O  IX-FD2.
062800     MOVE     SPACE     TO  WRK-XN-0002-002
062900     MOVE     SPACE     TO  WRK-XN-0002-003
063000     MOVE     SPACE     TO  WRK-XN-0002-004
063100     MOVE      IX-FD2-STATUS TO WRK-XN-0002-001
063200     MOVE     SPACE TO IX-FD2-STATUS.
063300*CAPTURE THE CONTENTS OF STATUS KEY AFTER OPEN IS EXECUTED.
063400 RWRT-TEST-GF-01-R.
063500     ADD      1 TO WRK-CS-09V00-014.
063600     ADD      1 TO WRK-CS-09V00-015.
063700     READ  IX-FD2 NEXT RECORD.
063800     IF        IX-FD2-STATUS EQUAL TO "10"
063900              GO TO  RWRT-TEST-GF-01.
064000     MOVE     IX-FD2R1-F-G-240 TO FILE-RECORD-INFO (2).
064100     IF       WRK-CS-09V00-015 EQUAL TO 5
064200              ADD 01 TO UPDATE-NUMBER (2)
064300              MOVE FILE-RECORD-INFO (2) TO IX-FD2R1-F-G-240
064400             PERFORM  RWRT-010-UPDATE
064500             MOVE ZERO TO WRK-CS-09V00-015
064600              GO TO  RWRT-TEST-GF-01-2.
064700     IF       WRK-CS-09V00-014 GREATER 500
064800              GO TO  RWRT-TEST-GF-01.
064900     GO TO    RWRT-TEST-GF-01-R.
065000 RWRT-010-UPDATE.
065100     REWRITE   IX-FD2R1-F-G-240.
065200 RWRT-TEST-GF-01-2.
065300     IF        IX-FD2-STATUS NOT EQUAL TO "00"
065400              ADD 1 TO WRK-CS-09V00-016.
065500     MOVE    SPACE  TO   IX-FD2-STATUS.
065600     GO TO    RWRT-TEST-GF-01-R.
065700 RWRT-TEST-GF-01.
065800     MOVE    "RWRT-TEST-GF-01" TO PAR-NAME.
065900     MOVE    "REWRITE IX-FD2"  TO FEATURE.
066000     IF       WRK-CS-09V00-013 NOT EQUAL TO 1
066100              MOVE  "EXCEPTIONS/ERRORS; IX-33 4.6.2" TO RE-MARK
066200              MOVE WRK-CS-09V00-013 TO COMPUTED-18V0
066300              MOVE  1 TO CORRECT-18V0
066400              PERFORM FAIL
066500              ELSE
066600              PERFORM PASS.
066700     PERFORM  PRINT-DETAIL.
066800 RWRT-TEST-GF-02.
066900     MOVE    "RWRT-TEST-GF-02" TO PAR-NAME.
067000     MOVE    "UPDATE  IX-FD2"  TO FEATURE.
067100     IF       WRK-CS-09V00-014 NOT EQUAL TO 501
067200              MOVE "INCORRECT COUNT; IX-33 4.6.2" TO RE-MARK
067300              MOVE WRK-CS-09V00-014 TO COMPUTED-18V0
067400              MOVE 501 TO CORRECT-18V0
067500              PERFORM FAIL
067600              ELSE
067700              PERFORM PASS.
067800     PERFORM  PRINT-DETAIL.
067900 RWRT-TEST-GF-03.
068000     MOVE    "RWRT-TEST-GF-03" TO PAR-NAME.
068100     MOVE    "OPEN I-O STATUS: 00"  TO FEATURE.
068200     IF       WRK-XN-0002-001 NOT EQUAL TO "00"
068300              MOVE "OPEN/STATUS; IX-3 1.3.4 (1) A"  TO  RE-MARK
068400              MOVE WRK-XN-0002-001 TO COMPUTED-A
068500              MOVE  "00" TO CORRECT-A
068600              PERFORM FAIL
068700              ELSE
068800              PERFORM PASS.
068900     PERFORM  PRINT-DETAIL.
069000 RWRT-TEST-GF-04.
069100     MOVE    "RWRT-TEST-GF-04" TO PAR-NAME.
069200     MOVE    "READ I-O STATUS 10"  TO FEATURE.
069300     IF        IX-FD2-STATUS NOT EQUAL  TO "10"
069400              MOVE "AT END/STATUS; IX-4 1.3.4 (2) A" TO RE-MARK
069500              MOVE  IX-FD2-STATUS TO COMPUTED-A
069600              MOVE "10" TO CORRECT-A
069700              PERFORM FAIL
069800              ELSE
069900              PERFORM PASS.
070000     PERFORM  PRINT-DETAIL.
070100 RWRT-TEST-GF-05.
070200     MOVE    "RWRT-TEST-GF-05" TO PAR-NAME.
070300     MOVE    "UPDATE  IX-FD2"  TO FEATURE.
070400     IF       WRK-XN-0002-002 NOT EQUAL TO "10"
070500              MOVE  "EXCEPTIN/STATUS; IX-4 1.3.4 (2) A" TO RE-MARK
070600              MOVE  WRK-XN-0002-002 TO COMPUTED-A
070700              MOVE  "10" TO CORRECT-A
070800              PERFORM FAIL
070900              ELSE
071000              PERFORM PASS.
071100     PERFORM  PRINT-DETAIL.
071200 RWRT-TEST-GF-06.
071300     MOVE    "RWRT-TEST-GF-06" TO PAR-NAME.
071400     MOVE    "STATUS: 10    "  TO FEATURE.
071500     IF       WRK-XN-0002-003 NOT EQUAL TO "10"
071600              MOVE "NO/EXCEPTION; IX-4 1.3.4 (2) A" TO  RE-MARK
071700              MOVE WRK-XN-0002-003 TO COMPUTED-A
071800              MOVE "10" TO CORRECT-A
071900              PERFORM FAIL
072000              ELSE
072100              PERFORM PASS.
072200     PERFORM  PRINT-DETAIL.
072300 RWRT-TEST-GF-07.
072400     MOVE    "RWRT-TEST-GF-07" TO PAR-NAME.
072500     MOVE    "CLOSE . LOCK: 00"  TO FEATURE.
072600     MOVE     SPACE TO IX-FD2-STATUS.
072700     CLOSE    IX-FD2      WITH LOCK.
072800     IF        IX-FD2-STATUS NOT EQUAL TO "00"
072900              MOVE "CLOSE/STATUS; IX-3 1.3.4 (1) A" TO RE-MARK
073000              MOVE  IX-FD2-STATUS TO  COMPUTED-A
073100              MOVE "00" TO CORRECT-A
073200              PERFORM FAIL
073300              ELSE
073400              PERFORM PASS.
073500     PERFORM  PRINT-DETAIL.
073600
073700 CCVS-EXIT SECTION.
073800 CCVS-999999.
073900     GO TO CLOSE-FILES.
