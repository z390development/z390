000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RL119A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*            X-22   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR   *
001700*                    RELATIVE  I-O DATA FILE                   *
001800*            X-55   SYSTEM PRINTER                             *
001900*            X-69   ADDITIONAL VALUE OF CLAUSES                *
002000*            X-74   VALUE OF IMPLEMENTOR-NAME                  *
002100*            X-75   OBJECT OF VALUE OF CLAUSE                  *
002200*            X-82   SOURCE-COMPUTER                            *
002300*            X-83   OBJECT-COMPUTER.                           *
002400*            X-92   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR   *
002500*                    RELATIVE  I-O DATA FILE                   *
002600*                                                              *
002700****************************************************************
002800*    RL119A                                                    *
002900****************************************************************
003000*            THIS PROGRAM TESTS THE SYNTACTICAL CONSTRUCTS AND *
003100*            SEMANTIC ACTIONS ASSOCIATED WITH THE "STATUS"     *
003200*            CLAUSE FOR THE VALUES "35".                       *
003300*                                                              *
003400*            THE CODE FOR THE VALUE "39" HAS BEEN ASTERISKED   *
003500*            OUT AS NO SUITABLE METHOD OF TESTING THIS         *
003600*            CONDITION IS AVAILABLE AT THE TIME OF WRITING.    *
003700****************************************************************
003800 ENVIRONMENT DIVISION.
003900 CONFIGURATION SECTION.
004000 SOURCE-COMPUTER.
004100     XXXXX082.
004200 OBJECT-COMPUTER.
004300     XXXXX083.
004400 INPUT-OUTPUT SECTION.
004500 FILE-CONTROL.
004600     SELECT PRINT-FILE ASSIGN TO
004700     XXXXX055.
004800     SELECT   RL-FD3 ASSIGN
004900     XXXXX092
005000              ORGANIZATION RELATIVE
005100              ACCESS  RANDOM
005200              RELATIVE  RL-FD3-KEY
005300         FILE STATUS IS RL-FD3-STATUS.
005400 DATA DIVISION.
005500 FILE SECTION.
005600 FD  PRINT-FILE.
005700 01  PRINT-REC PICTURE X(120).
005800 01  DUMMY-RECORD PICTURE X(120).
005900 FD  RL-FD3
006000C    VALUE OF
006100C    XXXXX074
006200C    IS
006300C    XXXXX076
006400G    XXXXX069
006500     LABEL RECORDS ARE STANDARD
006600     BLOCK CONTAINS 1 RECORDS
006700     DATA RECORD RL-FD3R1-F-G-240.
006800 01  RL-FD3R1-F-G-240.
006900     05 RL-FD3-WRK-120 PIC X(120).
007000     05 RL-FD3-GRP-120.
007100        10 RL-FD3-WRK-XN-0001-O120F
007200                        PICTURE X OCCURS 120 TIMES.
007300 WORKING-STORAGE SECTION.
007400 01  GRP-0001.
007500     05 RL-FD3-KEY   PIC 9(8)  VALUE ZERO.
007600     05 WRK-CS-09V00-012  PIC S9(9) USAGE COMP  VALUE ZERO.
007700     05 WRK-CS-09V00-013  PIC S9(9) USAGE COMP  VALUE ZERO.
007800     05 WRK-CS-09V00-014  PIC S9(9) USAGE COMP  VALUE ZERO.
007900     05 WRK-CS-09V00-015  PIC S9(9) USAGE COMP  VALUE ZERO.
008000     05 WRK-CS-09V00-016  PIC S9(9) USAGE COMP  VALUE ZERO.
008100     05 WRK-CS-09V00-017  PIC S9(9) USAGE COMP  VALUE ZERO.
008200     05 WRK-CS-09V00-018  PIC S9(9) USAGE COMP  VALUE ZERO.
008300     05 RL-FD3-STATUS     PIC  XX  VALUE  SPACE.
008400     05 WRK-XN-0002-001   PIC  X(2) VALUE  SPACE.
008500     05 WRK-XN-0002-002   PIC  X(2) VALUE  SPACE.
008600     05 WRK-XN-0002-003   PIC  X(2) VALUE  SPACE.
008700     05 WRK-XN-0002-004   PIC  X(2) VALUE  SPACE.
008800     05 WRK-XN-0002-005   PIC  X(2) VALUE  SPACE.
008900     05 WRK-XN-0002-006   PIC  X(2) VALUE  SPACE.
009000     05 WRK-XN-0002-007   PIC  X(2) VALUE  SPACE.
009100     05 WRK-XN-0002-008   PIC  X(2) VALUE  SPACE.
009200     05 WRK-XN-0002-009   PIC  X(2) VALUE  SPACE.
009300 01  FILE-RECORD-INFORMATION-REC.
009400     03 FILE-RECORD-INFO-SKELETON.
009500        05 FILLER                 PICTURE X(48)       VALUE
009600             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
009700        05 FILLER                 PICTURE X(46)       VALUE
009800             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
009900        05 FILLER                 PICTURE X(26)       VALUE
010000             ",LFIL=000000,ORG=  ,LBLR= ".
010100        05 FILLER                 PICTURE X(37)       VALUE
010200             ",RECKEY=                             ".
010300        05 FILLER                 PICTURE X(38)       VALUE
010400             ",ALTKEY1=                             ".
010500        05 FILLER                 PICTURE X(38)       VALUE
010600             ",ALTKEY2=                             ".
010700        05 FILLER                 PICTURE X(7)        VALUE SPACE.
010800     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
010900        05 FILE-RECORD-INFO-P1-120.
011000           07 FILLER              PIC X(5).
011100           07 XFILE-NAME           PIC X(6).
011200           07 FILLER              PIC X(8).
011300           07 XRECORD-NAME         PIC X(6).
011400           07 FILLER              PIC X(1).
011500           07 REELUNIT-NUMBER     PIC 9(1).
011600           07 FILLER              PIC X(7).
011700           07 XRECORD-NUMBER       PIC 9(6).
011800           07 FILLER              PIC X(6).
011900           07 UPDATE-NUMBER       PIC 9(2).
012000           07 FILLER              PIC X(5).
012100           07 ODO-NUMBER          PIC 9(4).
012200           07 FILLER              PIC X(5).
012300           07 XPROGRAM-NAME        PIC X(5).
012400           07 FILLER              PIC X(7).
012500           07 XRECORD-LENGTH       PIC 9(6).
012600           07 FILLER              PIC X(7).
012700           07 CHARS-OR-RECORDS    PIC X(2).
012800           07 FILLER              PIC X(1).
012900           07 XBLOCK-SIZE          PIC 9(4).
013000           07 FILLER              PIC X(6).
013100           07 RECORDS-IN-FILE     PIC 9(6).
013200           07 FILLER              PIC X(5).
013300           07 XFILE-ORGANIZATION   PIC X(2).
013400           07 FILLER              PIC X(6).
013500           07 XLABEL-TYPE          PIC X(1).
013600        05 FILE-RECORD-INFO-P121-240.
013700           07 FILLER              PIC X(8).
013800           07 XRECORD-KEY          PIC X(29).
013900           07 FILLER              PIC X(9).
014000           07 ALTERNATE-KEY1      PIC X(29).
014100           07 FILLER              PIC X(9).
014200           07 ALTERNATE-KEY2      PIC X(29).
014300           07 FILLER              PIC X(7).
014400 01  TEST-RESULTS.
014500     02 FILLER                   PIC X      VALUE SPACE.
014600     02 FEATURE                  PIC X(20)  VALUE SPACE.
014700     02 FILLER                   PIC X      VALUE SPACE.
014800     02 P-OR-F                   PIC X(5)   VALUE SPACE.
014900     02 FILLER                   PIC X      VALUE SPACE.
015000     02  PAR-NAME.
015100       03 FILLER                 PIC X(19)  VALUE SPACE.
015200       03  PARDOT-X              PIC X      VALUE SPACE.
015300       03 DOTVALUE               PIC 99     VALUE ZERO.
015400     02 FILLER                   PIC X(8)   VALUE SPACE.
015500     02 RE-MARK                  PIC X(61).
015600 01  TEST-COMPUTED.
015700     02 FILLER                   PIC X(30)  VALUE SPACE.
015800     02 FILLER                   PIC X(17)  VALUE
015900            "       COMPUTED=".
016000     02 COMPUTED-X.
016100     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
016200     03 COMPUTED-N               REDEFINES COMPUTED-A
016300                                 PIC -9(9).9(9).
016400     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
016500     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
016600     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
016700     03       CM-18V0 REDEFINES COMPUTED-A.
016800         04 COMPUTED-18V0                    PIC -9(18).
016900         04 FILLER                           PIC X.
017000     03 FILLER PIC X(50) VALUE SPACE.
017100 01  TEST-CORRECT.
017200     02 FILLER PIC X(30) VALUE SPACE.
017300     02 FILLER PIC X(17) VALUE "       CORRECT =".
017400     02 CORRECT-X.
017500     03 CORRECT-A                  PIC X(20) VALUE SPACE.
017600     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
017700     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
017800     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
017900     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
018000     03      CR-18V0 REDEFINES CORRECT-A.
018100         04 CORRECT-18V0                     PIC -9(18).
018200         04 FILLER                           PIC X.
018300     03 FILLER PIC X(2) VALUE SPACE.
018400     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
018500 01  CCVS-C-1.
018600     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
018700-    "SS  PARAGRAPH-NAME
018800-    "       REMARKS".
018900     02 FILLER                     PIC X(20)    VALUE SPACE.
019000 01  CCVS-C-2.
019100     02 FILLER                     PIC X        VALUE SPACE.
019200     02 FILLER                     PIC X(6)     VALUE "TESTED".
019300     02 FILLER                     PIC X(15)    VALUE SPACE.
019400     02 FILLER                     PIC X(4)     VALUE "FAIL".
019500     02 FILLER                     PIC X(94)    VALUE SPACE.
019600 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
019700 01  REC-CT                        PIC 99       VALUE ZERO.
019800 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
019900 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
020000 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
020100 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
020200 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
020300 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
020400 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
020500 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
020600 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
020700 01  CCVS-H-1.
020800     02  FILLER                    PIC X(39)    VALUE SPACES.
020900     02  FILLER                    PIC X(42)    VALUE
021000     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
021100     02  FILLER                    PIC X(39)    VALUE SPACES.
021200 01  CCVS-H-2A.
021300   02  FILLER                        PIC X(40)  VALUE SPACE.
021400   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
021500   02  FILLER                        PIC XXXX   VALUE
021600     "4.2 ".
021700   02  FILLER                        PIC X(28)  VALUE
021800            " COPY - NOT FOR DISTRIBUTION".
021900   02  FILLER                        PIC X(41)  VALUE SPACE.
022000
022100 01  CCVS-H-2B.
022200   02  FILLER                        PIC X(15)  VALUE
022300            "TEST RESULT OF ".
022400   02  TEST-ID                       PIC X(9).
022500   02  FILLER                        PIC X(4)   VALUE
022600            " IN ".
022700   02  FILLER                        PIC X(12)  VALUE
022800     " HIGH       ".
022900   02  FILLER                        PIC X(22)  VALUE
023000            " LEVEL VALIDATION FOR ".
023100   02  FILLER                        PIC X(58)  VALUE
023200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
023300 01  CCVS-H-3.
023400     02  FILLER                      PIC X(34)  VALUE
023500            " FOR OFFICIAL USE ONLY    ".
023600     02  FILLER                      PIC X(58)  VALUE
023700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
023800     02  FILLER                      PIC X(28)  VALUE
023900            "  COPYRIGHT   1985 ".
024000 01  CCVS-E-1.
024100     02 FILLER                       PIC X(52)  VALUE SPACE.
024200     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
024300     02 ID-AGAIN                     PIC X(9).
024400     02 FILLER                       PIC X(45)  VALUE SPACES.
024500 01  CCVS-E-2.
024600     02  FILLER                      PIC X(31)  VALUE SPACE.
024700     02  FILLER                      PIC X(21)  VALUE SPACE.
024800     02 CCVS-E-2-2.
024900         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
025000         03 FILLER                   PIC X      VALUE SPACE.
025100         03 ENDER-DESC               PIC X(44)  VALUE
025200            "ERRORS ENCOUNTERED".
025300 01  CCVS-E-3.
025400     02  FILLER                      PIC X(22)  VALUE
025500            " FOR OFFICIAL USE ONLY".
025600     02  FILLER                      PIC X(12)  VALUE SPACE.
025700     02  FILLER                      PIC X(58)  VALUE
025800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025900     02  FILLER                      PIC X(13)  VALUE SPACE.
026000     02 FILLER                       PIC X(15)  VALUE
026100             " COPYRIGHT 1985".
026200 01  CCVS-E-4.
026300     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
026400     02 FILLER                       PIC X(4)   VALUE " OF ".
026500     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
026600     02 FILLER                       PIC X(40)  VALUE
026700      "  TESTS WERE EXECUTED SUCCESSFULLY".
026800 01  XXINFO.
026900     02 FILLER                       PIC X(19)  VALUE
027000            "*** INFORMATION ***".
027100     02 INFO-TEXT.
027200       04 FILLER                     PIC X(8)   VALUE SPACE.
027300       04 XXCOMPUTED                 PIC X(20).
027400       04 FILLER                     PIC X(5)   VALUE SPACE.
027500       04 XXCORRECT                  PIC X(20).
027600     02 INF-ANSI-REFERENCE           PIC X(48).
027700 01  HYPHEN-LINE.
027800     02 FILLER  PIC IS X VALUE IS SPACE.
027900     02 FILLER  PIC IS X(65)    VALUE IS "************************
028000-    "*****************************************".
028100     02 FILLER  PIC IS X(54)    VALUE IS "************************
028200-    "******************************".
028300 01  CCVS-PGM-ID                     PIC X(9)   VALUE
028400     "RL119A".
028500 PROCEDURE DIVISION.
028600 DECLARATIVES.
028700 RL-FD3-01 SECTION.
028800     USE AFTER ERROR PROCEDURE RL-FD3.
028900 RL-FD3-01-01.
029000     IF RL-FD3-STATUS EQUAL TO "35"
029100         PERFORM D-PASS
029200     ELSE
029300         MOVE RL-FD3-STATUS TO COMPUTED-A
029400         MOVE "35" TO CORRECT-A
029500         PERFORM D-FAIL.
029600     PERFORM D-PRINT-DETAIL.
029700     GO TO D-CLOSE-FILES.
029800 D-PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
029900 D-FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
030000 D-CLOSE-FILES.
030100     PERFORM D-END-ROUTINE THRU D-END-ROUTINE-13.
030200     CLOSE PRINT-FILE.
030300     STOP RUN.
030400 D-PRINT-DETAIL.
030500     IF REC-CT NOT EQUAL TO ZERO
030600             MOVE "." TO PARDOT-X
030700             MOVE REC-CT TO DOTVALUE.
030800     MOVE     TEST-RESULTS TO PRINT-REC.
030900             PERFORM D-WRITE-LINE.
031000     IF P-OR-F EQUAL TO "FAIL*"  PERFORM D-WRITE-LINE
031100        PERFORM D-FAIL-ROUTINE THRU D-FAIL-ROUTINE-EX
031200          ELSE PERFORM D-BAIL-OUT THRU D-BAIL-OUT-EX.
031300     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
031400     MOVE SPACE TO CORRECT-X.
031500     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
031600     MOVE     SPACE TO RE-MARK.
031700 D-END-ROUTINE.
031800     MOVE HYPHEN-LINE TO DUMMY-RECORD.
031900     PERFORM D-WRITE-LINE 5 TIMES.
032000 D-END-RTN-EXIT.
032100     MOVE CCVS-E-1 TO DUMMY-RECORD.
032200     PERFORM D-WRITE-LINE 2 TIMES.
032300 D-END-ROUTINE-1.
032400      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
032500      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
032600      ADD PASS-COUNTER TO ERROR-HOLD.
032700*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO D-END-ROUTINE-12.
032800      MOVE PASS-COUNTER TO CCVS-E-4-1.
032900      MOVE ERROR-HOLD TO CCVS-E-4-2.
033000      MOVE CCVS-E-4 TO CCVS-E-2-2.
033100      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM D-WRITE-LINE.
033200  D-END-ROUTINE-12.
033300      MOVE "TEST(S) FAILED" TO ENDER-DESC.
033400     IF       ERROR-COUNTER IS EQUAL TO ZERO
033500         MOVE "NO " TO ERROR-TOTAL
033600         ELSE
033700         MOVE ERROR-COUNTER TO ERROR-TOTAL.
033800     MOVE     CCVS-E-2 TO DUMMY-RECORD.
033900     PERFORM D-WRITE-LINE.
034000 D-END-ROUTINE-13.
034100     IF DELETE-COUNTER IS EQUAL TO ZERO
034200         MOVE "NO " TO ERROR-TOTAL  ELSE
034300         MOVE DELETE-COUNTER TO ERROR-TOTAL.
034400     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
034500     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM D-WRITE-LINE.
034600      IF   INSPECT-COUNTER EQUAL TO ZERO
034700          MOVE "NO " TO ERROR-TOTAL
034800      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
034900      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
035000      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM D-WRITE-LINE.
035100     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM D-WRITE-LINE.
035200 D-WRITE-LINE.
035300     ADD 1 TO RECORD-COUNT.
035400Y    IF RECORD-COUNT GREATER 50
035500Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
035600Y        MOVE SPACE TO DUMMY-RECORD
035700Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
035800Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM D-WRT-LN
035900Y        MOVE CCVS-C-2 TO DUMMY-RECORD
036000Y        PERFORM D-WRT-LN 2 TIMES
036100Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM D-WRT-LN
036200Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
036300Y        MOVE ZERO TO RECORD-COUNT.
036400     PERFORM D-WRT-LN.
036500 D-WRT-LN.
036600     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
036700     MOVE SPACE TO DUMMY-RECORD.
036800 D-FAIL-ROUTINE.
036900     IF     COMPUTED-X NOT EQUAL TO SPACE
037000            GO TO   D-FAIL-ROUTINE-WRITE.
037100     IF     CORRECT-X NOT EQUAL TO SPACE
037200            GO TO D-FAIL-ROUTINE-WRITE.
037300     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
037400     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
037500     MOVE   XXINFO TO DUMMY-RECORD. PERFORM D-WRITE-LINE 2 TIMES.
037600     MOVE   SPACES TO INF-ANSI-REFERENCE.
037700     GO TO  D-FAIL-ROUTINE-EX.
037800 D-FAIL-ROUTINE-WRITE.
037900     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM D-WRITE-LINE
038000     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
038100     MOVE   TEST-CORRECT TO PRINT-REC
038200     PERFORM D-WRITE-LINE 2 TIMES.
038300     MOVE   SPACES TO COR-ANSI-REFERENCE.
038400 D-FAIL-ROUTINE-EX. EXIT.
038500 D-BAIL-OUT.
038600     IF  COMPUTED-A NOT EQUAL TO SPACE GO TO D-BAIL-OUT-WRITE.
038700     IF  CORRECT-A EQUAL TO SPACE GO TO D-BAIL-OUT-EX.
038800 D-BAIL-OUT-WRITE.
038900     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
039000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
039100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM D-WRITE-LINE 2 TIMES.
039200     MOVE   SPACES TO INF-ANSI-REFERENCE.
039300 D-BAIL-OUT-EX. EXIT.
039400 END DECLARATIVES.
039500 CCVS1 SECTION.
039600 OPEN-FILES.
039700     OPEN    OUTPUT PRINT-FILE.
039800     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
039900     MOVE    SPACE TO TEST-RESULTS.
040000     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
040100     MOVE    ZERO TO REC-SKL-SUB.
040200     PERFORM CCVS-INIT-FILE 9 TIMES.
040300 CCVS-INIT-FILE.
040400     ADD     1 TO REC-SKL-SUB.
040500     MOVE    FILE-RECORD-INFO-SKELETON
040600          TO FILE-RECORD-INFO (REC-SKL-SUB).
040700 CCVS-INIT-EXIT.
040800     GO TO CCVS1-EXIT.
040900 CLOSE-FILES.
041000     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
041100 TERMINATE-CCVS.
041200S    EXIT PROGRAM.
041300STERMINATE-CALL.
041400     STOP     RUN.
041500 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
041600 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
041700 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
041800 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
041900     MOVE "****TEST DELETED****" TO RE-MARK.
042000 PRINT-DETAIL.
042100     IF REC-CT NOT EQUAL TO ZERO
042200             MOVE "." TO PARDOT-X
042300             MOVE REC-CT TO DOTVALUE.
042400     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
042500     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
042600        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
042700          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
042800     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
042900     MOVE SPACE TO CORRECT-X.
043000     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
043100     MOVE     SPACE TO RE-MARK.
043200 HEAD-ROUTINE.
043300     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043400     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043500     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
043600     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
043700 COLUMN-NAMES-ROUTINE.
043800     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
043900     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
044100 END-ROUTINE.
044200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
044300 END-RTN-EXIT.
044400     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044500 END-ROUTINE-1.
044600      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
044700      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
044800      ADD PASS-COUNTER TO ERROR-HOLD.
044900*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
045000      MOVE PASS-COUNTER TO CCVS-E-4-1.
045100      MOVE ERROR-HOLD TO CCVS-E-4-2.
045200      MOVE CCVS-E-4 TO CCVS-E-2-2.
045300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
045400  END-ROUTINE-12.
045500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
045600     IF       ERROR-COUNTER IS EQUAL TO ZERO
045700         MOVE "NO " TO ERROR-TOTAL
045800         ELSE
045900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
046000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
046100     PERFORM WRITE-LINE.
046200 END-ROUTINE-13.
046300     IF DELETE-COUNTER IS EQUAL TO ZERO
046400         MOVE "NO " TO ERROR-TOTAL  ELSE
046500         MOVE DELETE-COUNTER TO ERROR-TOTAL.
046600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
046700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
046800      IF   INSPECT-COUNTER EQUAL TO ZERO
046900          MOVE "NO " TO ERROR-TOTAL
047000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
047100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
047200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
047300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
047400 WRITE-LINE.
047500     ADD 1 TO RECORD-COUNT.
047600Y    IF RECORD-COUNT GREATER 50
047700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
047800Y        MOVE SPACE TO DUMMY-RECORD
047900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
048000Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
048100Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
048200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
048300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
048400Y        MOVE ZERO TO RECORD-COUNT.
048500     PERFORM WRT-LN.
048600 WRT-LN.
048700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
048800     MOVE SPACE TO DUMMY-RECORD.
048900 BLANK-LINE-PRINT.
049000     PERFORM WRT-LN.
049100 FAIL-ROUTINE.
049200     IF     COMPUTED-X NOT EQUAL TO SPACE
049300            GO TO   FAIL-ROUTINE-WRITE.
049400     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
049500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
049600     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
049700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
049800     MOVE   SPACES TO INF-ANSI-REFERENCE.
049900     GO TO  FAIL-ROUTINE-EX.
050000 FAIL-ROUTINE-WRITE.
050100     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
050200     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
050300     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
050400     MOVE   SPACES TO COR-ANSI-REFERENCE.
050500 FAIL-ROUTINE-EX. EXIT.
050600 BAIL-OUT.
050700     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
050800     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
050900 BAIL-OUT-WRITE.
051000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
051100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
051200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
051300     MOVE   SPACES TO INF-ANSI-REFERENCE.
051400 BAIL-OUT-EX. EXIT.
051500 CCVS1-EXIT.
051600     EXIT.
051700 SECT-RL119A-001 SECTION.
051800*
051900 REL-INIT-1.
052000     MOVE   "REL-TEST-1" TO PAR-NAME.
052100     MOVE   "VIII-4 1.3.4 4B" TO ANSI-REFERENCE.
052200     MOVE    SPACE TO RL-FD3-STATUS.
052300     OPEN    I-O RL-FD3.
052400     GO TO   REL-TEST-1.
052500 REL-DELETE-1.
052600     PERFORM DE-LETE.
052700     PERFORM PRINT-DETAIL.
052800     GO TO   REL-TEST-1-EXIT.
052900 REL-TEST-1.
053000     IF      RL-FD3-STATUS NOT EQUAL  TO "35"
053100             MOVE   "NON-EXISTING FILE HAS BEEN OPENED"
053200                  TO RE-MARK
053300             MOVE    RL-FD3-STATUS TO COMPUTED-A
053400             MOVE   "35" TO CORRECT-A
053500             PERFORM FAIL
053600             PERFORM PRINT-DETAIL
053700     ELSE
053800             PERFORM PASS
053900             PERFORM PRINT-DETAIL.
054000 REL-TEST-1-EXIT.
054100*    EXIT.
054200*
054300 CCVS-EXIT SECTION.
054400 CCVS-999999.
054500     GO TO CLOSE-FILES.
