000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RL206A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*GENERAL:    THIS RUN UNIT IS THE FIRST OF A SERIES WHICH
001400*            PROCESSES A RELATIVE I-O FILE.  THE FUNCTION OF THIS
001500*            PROGRAM IS TO CREATE A RELATIVE FILE SEQUENTIALLY
001600*            (ACCESS MODE SEQUENTIAL) AND VERIFY THAT IT WAS
001700*            CREATED CORRECTLY.  THE FILE IS IDENTIFED AS "RL-FS1"
001800*            AND IS PASSED TO SUBSEQUENT RUN UNITS FOR PROCESSING.
001900*
002000*            X-CARD PARAMETERS WHICH MUST BE SUPPLIED FOR THIS
002100*            PROGRAM ARE:
002200*
002300*                 X-21   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
002400*                         RELATIVE  I-O DATA FILE
002500*                 X-55   SYSTEM PRINTER
002600*                 X-69   ADDITIONAL VALUE OF CLAUSES
002700*                 X-74   VALUE OF IMPLEMENTOR-NAME
002800*                 X-75   OBJECT OF VALUE OF CLAUSE
002900*                 X-82   SOURCE-COMPUTER
003000*                 X-83   OBJECT-COMPUTER.
003100*
003200****************************************************************
003300 ENVIRONMENT DIVISION.
003400 CONFIGURATION SECTION.
003500 SOURCE-COMPUTER.
003600     XXXXX082.
003700 OBJECT-COMPUTER.
003800     XXXXX083.
003900 INPUT-OUTPUT SECTION.
004000 FILE-CONTROL.
004100     SELECT PRINT-FILE ASSIGN TO
004200     XXXXX055.
004300     SELECT   RL-FS1 ASSIGN TO
004400     XXXXP021
004500             ORGANIZATION IS RELATIVE.
004600*    ABSENCE OF THE ACCESS CLAUSE IS TREATED AS THOUGH
004700*     SEQUENTIAL HAD BEEN SPECIFIED.
004800 DATA DIVISION.
004900 FILE SECTION.
005000 FD  PRINT-FILE.
005100 01  PRINT-REC PICTURE X(120).
005200 01  DUMMY-RECORD PICTURE X(120).
005300 FD  RL-FS1
005400     LABEL RECORDS STANDARD
005500C    VALUE OF
005600C    XXXXX074
005700C    IS
005800C    XXXXX075
005900G    XXXXX069
006000     BLOCK CONTAINS 1 RECORDS
006100     RECORD IS VARYING IN SIZE
006200     FROM 120 TO 140 CHARACTERS
006300     DEPENDING ON WRK-SIZE.
006400 01  RL-FS1R1-F-G-140.
006500     02 FILLER PIC X(140).
006600 WORKING-STORAGE SECTION.
006700 01  WRK-SIZE     PIC 9(3).
006800 01  WRK-CS-09V00 PIC S9(9) USAGE COMP VALUE ZERO.
006900 01  FILE-RECORD-INFORMATION-REC.
007000     03 FILE-RECORD-INFO-SKELETON.
007100        05 FILLER                 PICTURE X(48)       VALUE
007200             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
007300        05 FILLER                 PICTURE X(46)       VALUE
007400             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
007500        05 FILLER                 PICTURE X(26)       VALUE
007600             ",LFIL=000000,ORG=  ,LBLR= ".
007700        05 FILLER                 PICTURE X(37)       VALUE
007800             ",RECKEY=                             ".
007900        05 FILLER                 PICTURE X(38)       VALUE
008000             ",ALTKEY1=                             ".
008100        05 FILLER                 PICTURE X(38)       VALUE
008200             ",ALTKEY2=                             ".
008300        05 FILLER                 PICTURE X(7)        VALUE SPACE.
008400     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
008500        05 FILE-RECORD-INFO-P1-120.
008600           07 FILLER              PIC X(5).
008700           07 XFILE-NAME           PIC X(6).
008800           07 FILLER              PIC X(8).
008900           07 XRECORD-NAME         PIC X(6).
009000           07 FILLER              PIC X(1).
009100           07 REELUNIT-NUMBER     PIC 9(1).
009200           07 FILLER              PIC X(7).
009300           07 XRECORD-NUMBER       PIC 9(6).
009400           07 FILLER              PIC X(6).
009500           07 UPDATE-NUMBER       PIC 9(2).
009600           07 FILLER              PIC X(5).
009700           07 ODO-NUMBER          PIC 9(4).
009800           07 FILLER              PIC X(5).
009900           07 XPROGRAM-NAME        PIC X(5).
010000           07 FILLER              PIC X(7).
010100           07 XRECORD-LENGTH       PIC 9(6).
010200           07 FILLER              PIC X(7).
010300           07 CHARS-OR-RECORDS    PIC X(2).
010400           07 FILLER              PIC X(1).
010500           07 XBLOCK-SIZE          PIC 9(4).
010600           07 FILLER              PIC X(6).
010700           07 RECORDS-IN-FILE     PIC 9(6).
010800           07 FILLER              PIC X(5).
010900           07 XFILE-ORGANIZATION   PIC X(2).
011000           07 FILLER              PIC X(6).
011100           07 XLABEL-TYPE          PIC X(1).
011200        05 FILE-RECORD-INFO-P121-240.
011300           07 FILLER              PIC X(8).
011400           07 XRECORD-KEY          PIC X(29).
011500           07 FILLER              PIC X(9).
011600           07 ALTERNATE-KEY1      PIC X(29).
011700           07 FILLER              PIC X(9).
011800           07 ALTERNATE-KEY2      PIC X(29).
011900           07 FILLER              PIC X(7).
012000 01  NEW-140-CHAR-AREA.
012100   03        FILLER               PIC X(120).
012200   03        EXTRA-20-CHARS       PIC X(20).
012300
012400 01  TEST-RESULTS.
012500     02 FILLER                   PIC X      VALUE SPACE.
012600     02 FEATURE                  PIC X(20)  VALUE SPACE.
012700     02 FILLER                   PIC X      VALUE SPACE.
012800     02 P-OR-F                   PIC X(5)   VALUE SPACE.
012900     02 FILLER                   PIC X      VALUE SPACE.
013000     02  PAR-NAME.
013100       03 FILLER                 PIC X(19)  VALUE SPACE.
013200       03  PARDOT-X              PIC X      VALUE SPACE.
013300       03 DOTVALUE               PIC 99     VALUE ZERO.
013400     02 FILLER                   PIC X(8)   VALUE SPACE.
013500     02 RE-MARK                  PIC X(61).
013600 01  TEST-COMPUTED.
013700     02 FILLER                   PIC X(30)  VALUE SPACE.
013800     02 FILLER                   PIC X(17)  VALUE
013900            "       COMPUTED=".
014000     02 COMPUTED-X.
014100     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
014200     03 COMPUTED-N               REDEFINES COMPUTED-A
014300                                 PIC -9(9).9(9).
014400     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
014500     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
014600     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
014700     03       CM-18V0 REDEFINES COMPUTED-A.
014800         04 COMPUTED-18V0                    PIC -9(18).
014900         04 FILLER                           PIC X.
015000     03 FILLER PIC X(50) VALUE SPACE.
015100 01  TEST-CORRECT.
015200     02 FILLER PIC X(30) VALUE SPACE.
015300     02 FILLER PIC X(17) VALUE "       CORRECT =".
015400     02 CORRECT-X.
015500     03 CORRECT-A                  PIC X(20) VALUE SPACE.
015600     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
015700     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
015800     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
015900     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
016000     03      CR-18V0 REDEFINES CORRECT-A.
016100         04 CORRECT-18V0                     PIC -9(18).
016200         04 FILLER                           PIC X.
016300     03 FILLER PIC X(2) VALUE SPACE.
016400     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
016500 01  CCVS-C-1.
016600     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
016700-    "SS  PARAGRAPH-NAME
016800-    "       REMARKS".
016900     02 FILLER                     PIC X(20)    VALUE SPACE.
017000 01  CCVS-C-2.
017100     02 FILLER                     PIC X        VALUE SPACE.
017200     02 FILLER                     PIC X(6)     VALUE "TESTED".
017300     02 FILLER                     PIC X(15)    VALUE SPACE.
017400     02 FILLER                     PIC X(4)     VALUE "FAIL".
017500     02 FILLER                     PIC X(94)    VALUE SPACE.
017600 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
017700 01  REC-CT                        PIC 99       VALUE ZERO.
017800 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
017900 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
018000 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
018100 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
018200 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
018300 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
018400 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
018500 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
018600 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
018700 01  CCVS-H-1.
018800     02  FILLER                    PIC X(39)    VALUE SPACES.
018900     02  FILLER                    PIC X(42)    VALUE
019000     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
019100     02  FILLER                    PIC X(39)    VALUE SPACES.
019200 01  CCVS-H-2A.
019300   02  FILLER                        PIC X(40)  VALUE SPACE.
019400   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
019500   02  FILLER                        PIC XXXX   VALUE
019600     "4.2 ".
019700   02  FILLER                        PIC X(28)  VALUE
019800            " COPY - NOT FOR DISTRIBUTION".
019900   02  FILLER                        PIC X(41)  VALUE SPACE.
020000
020100 01  CCVS-H-2B.
020200   02  FILLER                        PIC X(15)  VALUE
020300            "TEST RESULT OF ".
020400   02  TEST-ID                       PIC X(9).
020500   02  FILLER                        PIC X(4)   VALUE
020600            " IN ".
020700   02  FILLER                        PIC X(12)  VALUE
020800     " HIGH       ".
020900   02  FILLER                        PIC X(22)  VALUE
021000            " LEVEL VALIDATION FOR ".
021100   02  FILLER                        PIC X(58)  VALUE
021200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
021300 01  CCVS-H-3.
021400     02  FILLER                      PIC X(34)  VALUE
021500            " FOR OFFICIAL USE ONLY    ".
021600     02  FILLER                      PIC X(58)  VALUE
021700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
021800     02  FILLER                      PIC X(28)  VALUE
021900            "  COPYRIGHT   1985 ".
022000 01  CCVS-E-1.
022100     02 FILLER                       PIC X(52)  VALUE SPACE.
022200     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
022300     02 ID-AGAIN                     PIC X(9).
022400     02 FILLER                       PIC X(45)  VALUE SPACES.
022500 01  CCVS-E-2.
022600     02  FILLER                      PIC X(31)  VALUE SPACE.
022700     02  FILLER                      PIC X(21)  VALUE SPACE.
022800     02 CCVS-E-2-2.
022900         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
023000         03 FILLER                   PIC X      VALUE SPACE.
023100         03 ENDER-DESC               PIC X(44)  VALUE
023200            "ERRORS ENCOUNTERED".
023300 01  CCVS-E-3.
023400     02  FILLER                      PIC X(22)  VALUE
023500            " FOR OFFICIAL USE ONLY".
023600     02  FILLER                      PIC X(12)  VALUE SPACE.
023700     02  FILLER                      PIC X(58)  VALUE
023800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
023900     02  FILLER                      PIC X(13)  VALUE SPACE.
024000     02 FILLER                       PIC X(15)  VALUE
024100             " COPYRIGHT 1985".
024200 01  CCVS-E-4.
024300     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
024400     02 FILLER                       PIC X(4)   VALUE " OF ".
024500     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
024600     02 FILLER                       PIC X(40)  VALUE
024700      "  TESTS WERE EXECUTED SUCCESSFULLY".
024800 01  XXINFO.
024900     02 FILLER                       PIC X(19)  VALUE
025000            "*** INFORMATION ***".
025100     02 INFO-TEXT.
025200       04 FILLER                     PIC X(8)   VALUE SPACE.
025300       04 XXCOMPUTED                 PIC X(20).
025400       04 FILLER                     PIC X(5)   VALUE SPACE.
025500       04 XXCORRECT                  PIC X(20).
025600     02 INF-ANSI-REFERENCE           PIC X(48).
025700 01  HYPHEN-LINE.
025800     02 FILLER  PIC IS X VALUE IS SPACE.
025900     02 FILLER  PIC IS X(65)    VALUE IS "************************
026000-    "*****************************************".
026100     02 FILLER  PIC IS X(54)    VALUE IS "************************
026200-    "******************************".
026300 01  CCVS-PGM-ID                     PIC X(9)   VALUE
026400     "RL206A".
026500 PROCEDURE DIVISION.
026600 CCVS1 SECTION.
026700 OPEN-FILES.
026800     OPEN    OUTPUT PRINT-FILE.
026900     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
027000     MOVE    SPACE TO TEST-RESULTS.
027100     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
027200     MOVE    ZERO TO REC-SKL-SUB.
027300     PERFORM CCVS-INIT-FILE 9 TIMES.
027400 CCVS-INIT-FILE.
027500     ADD     1 TO REC-SKL-SUB.
027600     MOVE    FILE-RECORD-INFO-SKELETON
027700          TO FILE-RECORD-INFO (REC-SKL-SUB).
027800 CCVS-INIT-EXIT.
027900     GO TO CCVS1-EXIT.
028000 CLOSE-FILES.
028100     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
028200 TERMINATE-CCVS.
028300S    EXIT PROGRAM.
028400STERMINATE-CALL.
028500     STOP     RUN.
028600 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
028700 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
028800 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
028900 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
029000     MOVE "****TEST DELETED****" TO RE-MARK.
029100 PRINT-DETAIL.
029200     IF REC-CT NOT EQUAL TO ZERO
029300             MOVE "." TO PARDOT-X
029400             MOVE REC-CT TO DOTVALUE.
029500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
029600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
029700        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
029800          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
029900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
030000     MOVE SPACE TO CORRECT-X.
030100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
030200     MOVE     SPACE TO RE-MARK.
030300 HEAD-ROUTINE.
030400     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030500     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030600     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030700     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030800 COLUMN-NAMES-ROUTINE.
030900     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031000     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
031200 END-ROUTINE.
031300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
031400 END-RTN-EXIT.
031500     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031600 END-ROUTINE-1.
031700      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
031800      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
031900      ADD PASS-COUNTER TO ERROR-HOLD.
032000*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
032100      MOVE PASS-COUNTER TO CCVS-E-4-1.
032200      MOVE ERROR-HOLD TO CCVS-E-4-2.
032300      MOVE CCVS-E-4 TO CCVS-E-2-2.
032400      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
032500  END-ROUTINE-12.
032600      MOVE "TEST(S) FAILED" TO ENDER-DESC.
032700     IF       ERROR-COUNTER IS EQUAL TO ZERO
032800         MOVE "NO " TO ERROR-TOTAL
032900         ELSE
033000         MOVE ERROR-COUNTER TO ERROR-TOTAL.
033100     MOVE     CCVS-E-2 TO DUMMY-RECORD.
033200     PERFORM WRITE-LINE.
033300 END-ROUTINE-13.
033400     IF DELETE-COUNTER IS EQUAL TO ZERO
033500         MOVE "NO " TO ERROR-TOTAL  ELSE
033600         MOVE DELETE-COUNTER TO ERROR-TOTAL.
033700     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
033800     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033900      IF   INSPECT-COUNTER EQUAL TO ZERO
034000          MOVE "NO " TO ERROR-TOTAL
034100      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
034200      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
034300      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034400     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034500 WRITE-LINE.
034600     ADD 1 TO RECORD-COUNT.
034700Y    IF RECORD-COUNT GREATER 50
034800Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
034900Y        MOVE SPACE TO DUMMY-RECORD
035000Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
035100Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
035200Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
035300Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
035400Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
035500Y        MOVE ZERO TO RECORD-COUNT.
035600     PERFORM WRT-LN.
035700 WRT-LN.
035800     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
035900     MOVE SPACE TO DUMMY-RECORD.
036000 BLANK-LINE-PRINT.
036100     PERFORM WRT-LN.
036200 FAIL-ROUTINE.
036300     IF   COMPUTED-X NOT EQUAL TO SPACE
036400          GO TO FAIL-ROUTINE-WRITE.
036500     IF   CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
036600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
036700     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
036800     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036900     MOVE   SPACES TO INF-ANSI-REFERENCE.
037000     GO TO  FAIL-ROUTINE-EX.
037100 FAIL-ROUTINE-WRITE.
037200     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
037300     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
037400     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
037500     MOVE   SPACES TO COR-ANSI-REFERENCE.
037600 FAIL-ROUTINE-EX. EXIT.
037700 BAIL-OUT.
037800     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
037900     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
038000 BAIL-OUT-WRITE.
038100     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
038200     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
038300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038400     MOVE   SPACES TO INF-ANSI-REFERENCE.
038500 BAIL-OUT-EX. EXIT.
038600 CCVS1-EXIT.
038700     EXIT.
038800 SECT-RL206A-001 SECTION.
038900 REL-INIT-001.
039000     MOVE     "FILE CREATE RL-FS1" TO FEATURE.
039100     OPEN     OUTPUT    RL-FS1.
039200     MOVE     "RL-FS1" TO XFILE-NAME (1).
039300     MOVE     "R1-F-G" TO XRECORD-NAME (1).
039400     MOVE CCVS-PGM-ID      TO XPROGRAM-NAME (1).
039500     MOVE     000120   TO XRECORD-LENGTH (1).
039600     MOVE     "RC"     TO CHARS-OR-RECORDS (1).
039700     MOVE     0001     TO XBLOCK-SIZE (1).
039800     MOVE     000500   TO RECORDS-IN-FILE (1).
039900     MOVE     "RL"     TO XFILE-ORGANIZATION (1).
040000     MOVE     "S"      TO XLABEL-TYPE (1).
040100     MOVE    000001    TO XRECORD-NUMBER (1).
040200 REL-TEST-001.
040300     MOVE    FILE-RECORD-INFO-P1-120 (1) TO NEW-140-CHAR-AREA.
040400     MOVE   "ABCDEFGHIJKLMNOPQRST"       TO EXTRA-20-CHARS.
040500     MOVE    NEW-140-CHAR-AREA           TO RL-FS1R1-F-G-140.
040600     IF      XRECORD-NUMBER (1) > 32
040700             MOVE   140 TO WRK-SIZE.
040800     IF      XRECORD-NUMBER (1) = 32
040900             MOVE   135 TO WRK-SIZE.
041000     IF      XRECORD-NUMBER (1) = 31
041100             MOVE   125 TO WRK-SIZE.
041200     IF      XRECORD-NUMBER (1) < 31
041300             MOVE   140 TO WRK-SIZE.
041400     IF      XRECORD-NUMBER (1) < 21
041500             MOVE   130 TO WRK-SIZE.
041600     IF      XRECORD-NUMBER (1) < 11
041700             MOVE   120 TO WRK-SIZE.
041800     WRITE   RL-FS1R1-F-G-140
041900             INVALID KEY GO TO REL-FAIL-001.
042000     IF      XRECORD-NUMBER (1) EQUAL TO 500
042100             GO TO REL-WRITE-001.
042200     ADD     000001 TO XRECORD-NUMBER (1).
042300     GO      TO REL-TEST-001.
042400 REL-DELETE-001.
042500     PERFORM DE-LETE.
042600     GO TO  REL-WRITE-001.
042700 REL-FAIL-001.
042800     PERFORM FAIL.
042900     MOVE   "BOUNDARY VIOLATION"  TO RE-MARK.
043000 REL-WRITE-001.
043100     MOVE   "REL-TEST-001" TO   PAR-NAME
043200     MOVE   "FILE CREATED, LFILE "  TO COMPUTED-A.
043300     MOVE    XRECORD-NUMBER (1) TO CORRECT-18V0.
043400     PERFORM PRINT-DETAIL.
043500     CLOSE   RL-FS1.
043600 REL-INIT-002.
043700     OPEN    INPUT     RL-FS1.
043800     MOVE    ZERO      TO WRK-CS-09V00.
043900 REL-TEST-002.
044000     READ    RL-FS1 INTO NEW-140-CHAR-AREA
044100             AT END GO TO REL-TEST-002-1.
044200     ADD     1 TO WRK-CS-09V00.
044300     IF      WRK-CS-09V00 GREATER 500
044400             MOVE "MORE THAN 500 RECORDS" TO RE-MARK
044500             GO TO REL-TEST-002-1.
044600     PERFORM SIZE-TEST-1.
044700     GO      TO REL-TEST-002.
044800 REL-DELETE-002.
044900     PERFORM DE-LETE.
045000     PERFORM PRINT-DETAIL.
045100 REL-TEST-002-1.
045200     IF      XRECORD-NUMBER (1) NOT EQUAL TO 500
045300             PERFORM FAIL
045400     ELSE
045500             PERFORM PASS.
045600     GO      TO REL-WRITE-002.
045700 REL-WRITE-002.
045800     MOVE   "REL-TEST-002" TO PAR-NAME.
045900     MOVE   "FILE VERIFIED, LFILE" TO COMPUTED-A.
046000     MOVE    XRECORD-NUMBER (1) TO CORRECT-18V0.
046100     PERFORM PRINT-DETAIL.
046200     CLOSE   RL-FS1.
046300     GO TO   CCVS-EXIT.
046400 SIZE-TEST-1 SECTION.
046500*===================
046600 REL-SIZE-TEST-1.
046700     IF      WRK-CS-09V00 > 32
046800             PERFORM SIZE-TEST-2.
046900     IF      WRK-CS-09V00 = 32
047000             PERFORM SIZE-TEST-3.
047100     IF      WRK-CS-09V00 = 31
047200             PERFORM SIZE-TEST-4.
047300     IF      WRK-CS-09V00 < 11
047400             PERFORM SIZE-TEST-7
047500             GO TO   SIZE-TEST-1-EXIT.
047600     IF      WRK-CS-09V00 < 21
047700             PERFORM SIZE-TEST-6
047800             GO TO   SIZE-TEST-1-EXIT.
047900     IF      WRK-CS-09V00 < 31
048000             PERFORM SIZE-TEST-5.
048100 SIZE-TEST-1-EXIT.
048200     EXIT.
048300 SIZE-TEST-2 SECTION.
048400 REL-SIZE-TEST-2.
048500     IF      WRK-SIZE NOT = 140
048600             MOVE  "WRONG LENGTH RECORD" TO RE-MARK
048700             MOVE   WRK-SIZE TO COMPUTED-18V0
048800             MOVE   140      TO CORRECT-18V0
048900             PERFORM FAIL
049000             PERFORM PRINT-DETAIL
049100     ELSE
049200             PERFORM PASS.
049300*            PERFORM PRINT-DETAIL.
049400 SIZE-TEST-2-EXIT.
049500     EXIT.
049600 SIZE-TEST-3 SECTION.
049700 REL-SIZE-TEST-3.
049800     IF      WRK-SIZE NOT = 135
049900             MOVE  "WRONG LENGTH RECORD" TO RE-MARK
050000             MOVE   WRK-SIZE TO COMPUTED-18V0
050100             MOVE   135      TO CORRECT-18V0
050200             PERFORM FAIL
050300             PERFORM PRINT-DETAIL
050400     ELSE
050500             PERFORM PASS.
050600*            PERFORM PRINT-DETAIL.
050700 SIZE-TEST-3-EXIT.
050800     EXIT.
050900 SIZE-TEST-4 SECTION.
051000 REL-SIZE-TEST-4.
051100     IF      WRK-SIZE NOT = 125
051200             MOVE  "WRONG LENGTH RECORD" TO RE-MARK
051300             MOVE   WRK-SIZE TO COMPUTED-18V0
051400             MOVE   125      TO CORRECT-18V0
051500             PERFORM FAIL
051600             PERFORM PRINT-DETAIL
051700     ELSE
051800             PERFORM PASS.
051900*            PERFORM PRINT-DETAIL.
052000 SIZE-TEST-4-EXIT.
052100     EXIT.
052200 SIZE-TEST-5 SECTION.
052300 REL-SIZE-TEST-5.
052400     IF      WRK-SIZE NOT = 140
052500             MOVE  "WRONG LENGTH RECORD" TO RE-MARK
052600             MOVE   WRK-SIZE TO COMPUTED-18V0
052700             MOVE   140      TO CORRECT-18V0
052800             PERFORM FAIL
052900             PERFORM PRINT-DETAIL
053000     ELSE
053100             PERFORM PASS.
053200*            PERFORM PRINT-DETAIL.
053300 SIZE-TEST-5-EXIT.
053400     EXIT.
053500 SIZE-TEST-6 SECTION.
053600 REL-SIZE-TEST-6.
053700     IF      WRK-SIZE NOT = 130
053800             MOVE  "WRONG LENGTH RECORD" TO RE-MARK
053900             MOVE   WRK-SIZE TO COMPUTED-18V0
054000             MOVE   130      TO CORRECT-18V0
054100             PERFORM FAIL
054200             PERFORM PRINT-DETAIL
054300     ELSE
054400             PERFORM PASS.
054500*            PERFORM PRINT-DETAIL.
054600 SIZE-TEST-6-EXIT.
054700     EXIT.
054800 SIZE-TEST-7 SECTION.
054900 REL-SIZE-TEST-7.
055000     IF      WRK-SIZE NOT = 120
055100             MOVE  "WRONG LENGTH RECORD" TO RE-MARK
055200             MOVE   WRK-SIZE TO COMPUTED-18V0
055300             MOVE   120      TO CORRECT-18V0
055400             PERFORM FAIL
055500             PERFORM PRINT-DETAIL
055600     ELSE
055700             PERFORM PASS.
055800*            PERFORM PRINT-DETAIL.
055900 SIZE-TEST-7-EXIT.
056000     EXIT.
056100 CCVS-EXIT SECTION.
056200 CCVS-999999.
056300     GO TO CLOSE-FILES.
