000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     NC239A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*                                                              *
002200*    PROGRAM NC239A TESTS THE CONSTRUCTION AND ACCESS OF A     *
002300*    THREE-DIMENSIONAL TABLE USING INDICES.                    *
002400*    VALUES ARE VERIFIED USING THE "IF" STATEMENT.             *
002500*                                                ~             *
002600****************************************************************
002700 ENVIRONMENT DIVISION.
002800 CONFIGURATION SECTION.
002900 SOURCE-COMPUTER.
003000     XXXXX082.
003100 OBJECT-COMPUTER.
003200     XXXXX083.
003300 INPUT-OUTPUT SECTION.
003400 FILE-CONTROL.
003500     SELECT PRINT-FILE ASSIGN TO
003600     XXXXX055.
003700 DATA DIVISION.
003800 FILE SECTION.
003900 FD  PRINT-FILE.
004000 01  PRINT-REC PICTURE X(120).
004100 01  DUMMY-RECORD PICTURE X(120).
004200 WORKING-STORAGE SECTION.
004300 77  SUB-1              PICTURE S99  VALUE ZERO.
004400 77  SUB-2              PICTURE 99   VALUE ZERO.
004500 77  SUB-3              PICTURE 99   VALUE ZERO.
004600 77  CON-7              PICTURE 99   VALUE 07.
004700 77  CON-10             PICTURE 99   VALUE 10.
004800 77  CON-5              PICTURE 99   VALUE 05.
004900 77  CON-6              PICTURE 99   VALUE 06.
005000 01  GRP-NAME.
005100     02  FILLER              PICTURE XXX    VALUE "GRP".
005200     02  ADD-GRP             PICTURE 99     VALUE 01.
005300
005400 01  SEC-NAME.
005500     02  FILLER              PICTURE X(5)   VALUE "SEC (".
005600     02  SEC-GRP             PICTURE 99     VALUE 00.
005700     02  FILLER              PICTURE X      VALUE ",".
005800     02  ADD-SEC             PICTURE 99     VALUE 01.
005900     02  FILLER              PICTURE X      VALUE ")".
006000
006100 01  ELEM-NAME.
006200     02  FILLER              PICTURE X(6)   VALUE "ELEM (".
006300     02  ELEM-GRP            PICTURE 99     VALUE 00.
006400     02  FILLER              PICTURE X      VALUE ",".
006500     02  ELEM-SEC            PICTURE 99     VALUE 00.
006600     02  FILLER              PICTURE X      VALUE ",".
006700     02  ADD-ELEM            PICTURE 99     VALUE 01.
006800     02  FILLER              PICTURE X      VALUE ")".
006900
007000 01  3-DIMENSION-TBL.
007100     02  GRP-ENTRY OCCURS 10 TIMES INDEXED BY IDX-1.
007200         03  ENTRY-1         PICTURE X(5).
007300         03  GRP2-ENTRY OCCURS 10 TIMES INDEXED BY IDX-2.
007400             04  ENTRY-2     PICTURE X(11).
007500             04  GRP3-ENTRY OCCURS 10 TIMES INDEXED BY IDX-3.
007600                 05  ENTRY-3 PICTURE X(15).
007700
007800 01  TEST-RESULTS.
007900     02 FILLER                   PIC X      VALUE SPACE.
008000     02 FEATURE                  PIC X(20)  VALUE SPACE.
008100     02 FILLER                   PIC X      VALUE SPACE.
008200     02 P-OR-F                   PIC X(5)   VALUE SPACE.
008300     02 FILLER                   PIC X      VALUE SPACE.
008400     02  PAR-NAME.
008500       03 FILLER                 PIC X(19)  VALUE SPACE.
008600       03  PARDOT-X              PIC X      VALUE SPACE.
008700       03 DOTVALUE               PIC 99     VALUE ZERO.
008800     02 FILLER                   PIC X(8)   VALUE SPACE.
008900     02 RE-MARK                  PIC X(61).
009000 01  TEST-COMPUTED.
009100     02 FILLER                   PIC X(30)  VALUE SPACE.
009200     02 FILLER                   PIC X(17)  VALUE
009300            "       COMPUTED=".
009400     02 COMPUTED-X.
009500     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
009600     03 COMPUTED-N               REDEFINES COMPUTED-A
009700                                 PIC -9(9).9(9).
009800     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
009900     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
010000     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
010100     03       CM-18V0 REDEFINES COMPUTED-A.
010200         04 COMPUTED-18V0                    PIC -9(18).
010300         04 FILLER                           PIC X.
010400     03 FILLER PIC X(50) VALUE SPACE.
010500 01  TEST-CORRECT.
010600     02 FILLER PIC X(30) VALUE SPACE.
010700     02 FILLER PIC X(17) VALUE "       CORRECT =".
010800     02 CORRECT-X.
010900     03 CORRECT-A                  PIC X(20) VALUE SPACE.
011000     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
011100     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
011200     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
011300     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
011400     03      CR-18V0 REDEFINES CORRECT-A.
011500         04 CORRECT-18V0                     PIC -9(18).
011600         04 FILLER                           PIC X.
011700     03 FILLER PIC X(2) VALUE SPACE.
011800     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
011900 01  CCVS-C-1.
012000     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
012100-    "SS  PARAGRAPH-NAME
012200-    "       REMARKS".
012300     02 FILLER                     PIC X(20)    VALUE SPACE.
012400 01  CCVS-C-2.
012500     02 FILLER                     PIC X        VALUE SPACE.
012600     02 FILLER                     PIC X(6)     VALUE "TESTED".
012700     02 FILLER                     PIC X(15)    VALUE SPACE.
012800     02 FILLER                     PIC X(4)     VALUE "FAIL".
012900     02 FILLER                     PIC X(94)    VALUE SPACE.
013000 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
013100 01  REC-CT                        PIC 99       VALUE ZERO.
013200 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
013300 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
013400 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
013500 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
013600 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
013700 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
013800 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
013900 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
014000 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
014100 01  CCVS-H-1.
014200     02  FILLER                    PIC X(39)    VALUE SPACES.
014300     02  FILLER                    PIC X(42)    VALUE
014400     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
014500     02  FILLER                    PIC X(39)    VALUE SPACES.
014600 01  CCVS-H-2A.
014700   02  FILLER                        PIC X(40)  VALUE SPACE.
014800   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
014900   02  FILLER                        PIC XXXX   VALUE
015000     "4.2 ".
015100   02  FILLER                        PIC X(28)  VALUE
015200            " COPY - NOT FOR DISTRIBUTION".
015300   02  FILLER                        PIC X(41)  VALUE SPACE.
015400
015500 01  CCVS-H-2B.
015600   02  FILLER                        PIC X(15)  VALUE
015700            "TEST RESULT OF ".
015800   02  TEST-ID                       PIC X(9).
015900   02  FILLER                        PIC X(4)   VALUE
016000            " IN ".
016100   02  FILLER                        PIC X(12)  VALUE
016200     " HIGH       ".
016300   02  FILLER                        PIC X(22)  VALUE
016400            " LEVEL VALIDATION FOR ".
016500   02  FILLER                        PIC X(58)  VALUE
016600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
016700 01  CCVS-H-3.
016800     02  FILLER                      PIC X(34)  VALUE
016900            " FOR OFFICIAL USE ONLY    ".
017000     02  FILLER                      PIC X(58)  VALUE
017100     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
017200     02  FILLER                      PIC X(28)  VALUE
017300            "  COPYRIGHT   1985 ".
017400 01  CCVS-E-1.
017500     02 FILLER                       PIC X(52)  VALUE SPACE.
017600     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
017700     02 ID-AGAIN                     PIC X(9).
017800     02 FILLER                       PIC X(45)  VALUE SPACES.
017900 01  CCVS-E-2.
018000     02  FILLER                      PIC X(31)  VALUE SPACE.
018100     02  FILLER                      PIC X(21)  VALUE SPACE.
018200     02 CCVS-E-2-2.
018300         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
018400         03 FILLER                   PIC X      VALUE SPACE.
018500         03 ENDER-DESC               PIC X(44)  VALUE
018600            "ERRORS ENCOUNTERED".
018700 01  CCVS-E-3.
018800     02  FILLER                      PIC X(22)  VALUE
018900            " FOR OFFICIAL USE ONLY".
019000     02  FILLER                      PIC X(12)  VALUE SPACE.
019100     02  FILLER                      PIC X(58)  VALUE
019200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
019300     02  FILLER                      PIC X(13)  VALUE SPACE.
019400     02 FILLER                       PIC X(15)  VALUE
019500             " COPYRIGHT 1985".
019600 01  CCVS-E-4.
019700     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
019800     02 FILLER                       PIC X(4)   VALUE " OF ".
019900     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
020000     02 FILLER                       PIC X(40)  VALUE
020100      "  TESTS WERE EXECUTED SUCCESSFULLY".
020200 01  XXINFO.
020300     02 FILLER                       PIC X(19)  VALUE
020400            "*** INFORMATION ***".
020500     02 INFO-TEXT.
020600       04 FILLER                     PIC X(8)   VALUE SPACE.
020700       04 XXCOMPUTED                 PIC X(20).
020800       04 FILLER                     PIC X(5)   VALUE SPACE.
020900       04 XXCORRECT                  PIC X(20).
021000     02 INF-ANSI-REFERENCE           PIC X(48).
021100 01  HYPHEN-LINE.
021200     02 FILLER  PIC IS X VALUE IS SPACE.
021300     02 FILLER  PIC IS X(65)    VALUE IS "************************
021400-    "*****************************************".
021500     02 FILLER  PIC IS X(54)    VALUE IS "************************
021600-    "******************************".
021700 01  CCVS-PGM-ID                     PIC X(9)   VALUE
021800     "NC239A".
021900 PROCEDURE DIVISION.
022000 CCVS1 SECTION.
022100 OPEN-FILES.
022200     OPEN     OUTPUT PRINT-FILE.
022300     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
022400     MOVE    SPACE TO TEST-RESULTS.
022500     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
022600     GO TO CCVS1-EXIT.
022700 CLOSE-FILES.
022800     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
022900 TERMINATE-CCVS.
023000S    EXIT PROGRAM.
023100STERMINATE-CALL.
023200     STOP     RUN.
023300 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
023400 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
023500 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
023600 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
023700     MOVE "****TEST DELETED****" TO RE-MARK.
023800 PRINT-DETAIL.
023900     IF REC-CT NOT EQUAL TO ZERO
024000             MOVE "." TO PARDOT-X
024100             MOVE REC-CT TO DOTVALUE.
024200     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
024300     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
024400        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
024500          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
024600     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
024700     MOVE SPACE TO CORRECT-X.
024800     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
024900     MOVE     SPACE TO RE-MARK.
025000 HEAD-ROUTINE.
025100     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025200     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025300     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
025400     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
025500 COLUMN-NAMES-ROUTINE.
025600     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025700     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
025900 END-ROUTINE.
026000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
026100 END-RTN-EXIT.
026200     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
026300 END-ROUTINE-1.
026400      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
026500      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
026600      ADD PASS-COUNTER TO ERROR-HOLD.
026700*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
026800      MOVE PASS-COUNTER TO CCVS-E-4-1.
026900      MOVE ERROR-HOLD TO CCVS-E-4-2.
027000      MOVE CCVS-E-4 TO CCVS-E-2-2.
027100      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
027200  END-ROUTINE-12.
027300      MOVE "TEST(S) FAILED" TO ENDER-DESC.
027400     IF       ERROR-COUNTER IS EQUAL TO ZERO
027500         MOVE "NO " TO ERROR-TOTAL
027600         ELSE
027700         MOVE ERROR-COUNTER TO ERROR-TOTAL.
027800     MOVE     CCVS-E-2 TO DUMMY-RECORD.
027900     PERFORM WRITE-LINE.
028000 END-ROUTINE-13.
028100     IF DELETE-COUNTER IS EQUAL TO ZERO
028200         MOVE "NO " TO ERROR-TOTAL  ELSE
028300         MOVE DELETE-COUNTER TO ERROR-TOTAL.
028400     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
028500     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028600      IF   INSPECT-COUNTER EQUAL TO ZERO
028700          MOVE "NO " TO ERROR-TOTAL
028800      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
028900      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
029000      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029100     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
029200 WRITE-LINE.
029300     ADD 1 TO RECORD-COUNT.
029400Y    IF RECORD-COUNT GREATER 50
029500Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
029600Y        MOVE SPACE TO DUMMY-RECORD
029700Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
029800Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
029900Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
030000Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
030100Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
030200Y        MOVE ZERO TO RECORD-COUNT.
030300     PERFORM WRT-LN.
030400 WRT-LN.
030500     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
030600     MOVE SPACE TO DUMMY-RECORD.
030700 BLANK-LINE-PRINT.
030800     PERFORM WRT-LN.
030900 FAIL-ROUTINE.
031000     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
031100     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
031200     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
031300     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
031400     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031500     MOVE   SPACES TO INF-ANSI-REFERENCE.
031600     GO TO  FAIL-ROUTINE-EX.
031700 FAIL-ROUTINE-WRITE.
031800     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
031900     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
032000     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
032100     MOVE   SPACES TO COR-ANSI-REFERENCE.
032200 FAIL-ROUTINE-EX. EXIT.
032300 BAIL-OUT.
032400     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
032500     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
032600 BAIL-OUT-WRITE.
032700     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
032800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
032900     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033000     MOVE   SPACES TO INF-ANSI-REFERENCE.
033100 BAIL-OUT-EX. EXIT.
033200 CCVS1-EXIT.
033300     EXIT.
033400 SECT-NC239A-001 SECTION.
033500 TH-12-001.
033600 TABLE-INIT.
033700     PERFORM TABLE-INIT-SUBROUTINE VARYING SUB-1 FROM 1 BY 1
033800         UNTIL SUB-1 EQUAL TO 11
033900         AFTER SUB-2 FROM 1 BY 1 UNTIL SUB-2 EQUAL TO 11
034000         AFTER SUB-3 FROM 1 BY 1 UNTIL SUB-3 EQUAL TO 11.
034100     GO TO TABLE-TEST.
034200
034300 TABLE-INIT-SUBROUTINE.
034400     SET IDX-1 TO SUB-1.
034500     SET IDX-2 TO SUB-2.
034600     SET IDX-3 TO SUB-3.
034700     SET ADD-GRP, SEC-GRP, ELEM-GRP TO IDX-1.
034800     MOVE GRP-NAME TO ENTRY-1 (IDX-1).
034900     SET ADD-SEC, ELEM-SEC TO IDX-2.
035000     MOVE SEC-NAME TO ENTRY-2 (IDX-1, IDX-2).
035100     SET ADD-ELEM TO IDX-3.
035200     MOVE ELEM-NAME TO ENTRY-3 (IDX-1, IDX-2, IDX-3).
035300
035400 TABLE-TEST.
035500     MOVE "LEVEL 1 INT INDEXING" TO FEATURE.
035600     MOVE "TABLE-TEST" TO PAR-NAME.
035700     MOVE "IV-21 & II-15 4.4.2" TO ANSI-REFERENCE.
035800     SET IDX-1 TO 5.
035900     IF ENTRY-1 (IDX-1) IS NOT EQUAL TO "GRP05"
036000         GO TO TABLE-FAIL.
036100     PERFORM PASS.
036200     GO TO TABLE-WRITE.
036300 TABLE-FAIL.
036400     MOVE "GRP05" TO CORRECT-A
036500     MOVE ENTRY-1 (IDX-1) TO COMPUTED-A
036600     MOVE "INTERNAL INDEXING LEVEL 1  " TO RE-MARK
036700     PERFORM FAIL.
036800 TABLE-WRITE.
036900     PERFORM PRINT-DETAIL.
037000
037100 TH1-INIT-GF-1.
037200     MOVE "TH1-TEST-GF-1" TO PAR-NAME.
037300     MOVE "IV-21 & II-15 4.4.2" TO ANSI-REFERENCE.
037400     MOVE "LEVEL 1 INT INDEXING" TO FEATURE.
037500     SET IDX-1 TO 8.
037600 TH1-TEST-GF-1.
037700     IF ENTRY-1 (IDX-1) IS NOT EQUAL TO "GRP08"
037800          GO TO TH1-FAIL-GF-1.
037900     PERFORM PASS.
038000     GO TO TH1-WRITE-GF-1.
038100 TH1-DELETE-GF-1.
038200     PERFORM DE-LETE.
038300     GO TO TH1-WRITE-GF-1.
038400 TH1-FAIL-GF-1.
038500     MOVE "GRP08" TO CORRECT-A
038600     MOVE ENTRY-1 (IDX-1) TO COMPUTED-A
038700     MOVE "INTERNAL INDEXING LEVEL 1  " TO RE-MARK
038800     PERFORM FAIL.
038900 TH1-WRITE-GF-1.
039000     PERFORM PRINT-DETAIL.
039100
039200 TH2-INIT-GF-1.
039300     MOVE "LEVEL 2 INT INDEXING" TO FEATURE.
039400     MOVE "TH2-TEST-GF-1" TO PAR-NAME.
039500     MOVE "IV-21 & II-15 4.4.2" TO ANSI-REFERENCE.
039600     SET IDX-1 TO 5.
039700     SET IDX-2 TO 6.
039800 TH2-TEST-GF-1.
039900     IF ENTRY-2 (IDX-1, IDX-2) IS NOT EQUAL TO "SEC (05,06)"
040000         GO TO TH2-FAIL-GF-1.
040100     PERFORM PASS.
040200     GO TO TH2-WRITE-GF-1.
040300 TH2-DELETE-GF-1.
040400     PERFORM DE-LETE.
040500     GO TO TH2-WRITE-GF-1.
040600 TH2-FAIL-GF-1.
040700     MOVE "SEC (05,06)" TO CORRECT-A
040800     MOVE ENTRY-2 (IDX-1, IDX-2) TO COMPUTED-A
040900     MOVE "INTERNAL INDEXING LEVEL 2  " TO RE-MARK
041000     PERFORM FAIL.
041100 TH2-WRITE-GF-1.
041200     PERFORM PRINT-DETAIL.
041300
041400 TH2-INIT-GF-2.
041500     MOVE "TH2-TEST-GF-2" TO PAR-NAME.
041600     MOVE "IV-21 & II-15 4.4.2" TO ANSI-REFERENCE.
041700     MOVE "LEVEL 2 INT INDEXING" TO FEATURE.
041800     SET IDX-1, IDX-2 TO 8.
041900 TH2-TEST-GF-2.
042000     IF ENTRY-2 (IDX-1, IDX-2) IS NOT EQUAL TO "SEC (08,08)"
042100         GO TO TH2-FAIL-GF-2.
042200     PERFORM PASS.
042300     GO TO TH2-WRITE-GF-2.
042400 TH2-DELETE-GF-2.
042500     PERFORM DE-LETE.
042600     GO TO TH2-WRITE-GF-2.
042700 TH2-FAIL-GF-2.
042800     MOVE "SEC (08,08)" TO CORRECT-A
042900     MOVE ENTRY-2 (IDX-1, IDX-2) TO COMPUTED-A
043000     MOVE "INTERNAL INDEXING LEVEL 2  " TO RE-MARK
043100     PERFORM FAIL.
043200 TH2-WRITE-GF-2.
043300     PERFORM PRINT-DETAIL.
043400
043500 TH2-INIT-GF-3.
043600     MOVE "TH2-TEST-GF-3" TO PAR-NAME.
043700     MOVE "IV-21 & II-15 4.4.2" TO ANSI-REFERENCE.
043800     MOVE "LEVEL 2 INT INDEXING" TO FEATURE.
043900     SET IDX-1 TO 3.
044000     SET IDX-2 TO 7.
044100 TH2-TEST-GF-3.
044200     IF ENTRY-2 (IDX-1, IDX-2) IS NOT EQUAL TO "SEC (03,07)"
044300         GO TO TH2-FAIL-GF-3.
044400     PERFORM PASS.
044500     GO TO TH2-WRITE-GF-3.
044600 TH2-DELETE-GF-3.
044700     PERFORM DE-LETE.
044800     GO TO TH2-WRITE-GF-3.
044900 TH2-FAIL-GF-3.
045000     MOVE "SEC (03,07)" TO CORRECT-A
045100     MOVE ENTRY-2 (IDX-1, IDX-2) TO COMPUTED-A
045200     MOVE "INTERNAL INDEXING LEVEL 2  " TO RE-MARK
045300     PERFORM FAIL.
045400 TH2-WRITE-GF-3.
045500     PERFORM PRINT-DETAIL.
045600
045700 TH3-INIT-GF-1.
045800     MOVE "TH3-TEST-GF-1" TO PAR-NAME.
045900     MOVE "IV-21 & II-15 4.4.2" TO ANSI-REFERENCE.
046000     MOVE "LEVEL 3 INT INDEXING" TO FEATURE.
046100     SET IDX-1 TO 2.
046200     SET IDX-2 TO 6.
046300     SET IDX-3 TO 10.
046400 TH3-TEST-GF-1.
046500     IF ENTRY-3 (IDX-1, IDX-2, IDX-3) IS NOT EQUAL TO
046600              "ELEM (02,06,10)"
046700         GO TO TH3-FAIL-GF-1.
046800     PERFORM PASS.
046900     GO TO TH3-WRITE-GF-1.
047000 TH3-DELETE-GF-1.
047100     PERFORM DE-LETE.
047200     GO TO TH3-WRITE-GF-1.
047300 TH3-FAIL-GF-1.
047400     MOVE "ELEM (02,06,10)" TO CORRECT-A
047500     MOVE ENTRY-3 (IDX-1, IDX-2, IDX-3) TO COMPUTED-A
047600     MOVE "INTERNAL INDEXING LEVEL 3  " TO RE-MARK
047700     PERFORM FAIL.
047800 TH3-WRITE-GF-1.
047900     PERFORM PRINT-DETAIL.
048000
048100 TH3-INIT-GF-2.
048200     MOVE "TH3-TEST-GF-2" TO PAR-NAME.
048300     MOVE "IV-21 & II-15 4.4.2" TO ANSI-REFERENCE.
048400     MOVE "LEVEL 3 INT INDEXING" TO FEATURE.
048500     SET IDX-1, IDX-2, IDX-3 TO 6.
048600 TH3-TEST-GF-2.
048700     IF ENTRY-3 (IDX-1, IDX-2, IDX-3) IS NOT EQUAL TO
048800              "ELEM (06,06,06)"
048900         GO TO TH3-FAIL-GF-2.
049000     PERFORM PASS.
049100     GO TO TH3-WRITE-GF-2.
049200 TH3-DELETE-GF-2.
049300     PERFORM DE-LETE.
049400     GO TO TH3-WRITE-GF-2.
049500 TH3-FAIL-GF-2.
049600     MOVE "ELEM (06,06,06)" TO CORRECT-A
049700     MOVE ENTRY-3 (IDX-1, IDX-2, IDX-3) TO COMPUTED-A
049800     MOVE "INTERNAL INDEXING LEVEL 3  " TO RE-MARK
049900     PERFORM FAIL.
050000 TH3-WRITE-GF-2.
050100     PERFORM PRINT-DETAIL.
050200
050300 TH3-INIT-GF-3.
050400     MOVE "TH3-TEST-GF-3" TO PAR-NAME.
050500     MOVE "IV-21 & II-15 4.4.2" TO ANSI-REFERENCE.
050600     MOVE "LEVEL 3 INT INDEXING" TO FEATURE.
050700     SET IDX-1 TO 9.
050800     SET IDX-2 TO 8.
050900     SET IDX-3 TO 7.
051000 TH3-TEST-GF-3.
051100     IF ENTRY-3 (IDX-1, IDX-2, IDX-3) IS NOT EQUAL TO
051200         "ELEM (09,08,07)"
051300         GO TO TH3-FAIL-GF-3.
051400     PERFORM PASS.
051500     GO TO TH3-WRITE-GF-3.
051600 TH3-DELETE-GF-3.
051700     PERFORM DE-LETE.
051800     GO TO TH3-WRITE-GF-3.
051900 TH3-FAIL-GF-3.
052000     MOVE "ELEM (09,08,07)" TO CORRECT-A
052100     MOVE ENTRY-3 (IDX-1, IDX-2, IDX-3) TO COMPUTED-A
052200     MOVE "INTERNAL INDEXING LEVEL 3  " TO RE-MARK
052300     PERFORM FAIL.
052400 TH3-WRITE-GF-3.
052500     PERFORM PRINT-DETAIL.
052600 CCVS-EXIT SECTION.
052700 CCVS-999999.
052800     GO TO CLOSE-FILES.
