000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RL205A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*    THE FUNCTION OF THIS PROGRAM IS TO TEST THE PERMISSIBLE SYN-
001400*    TACTICAL CONSTRUCTS OF COBOL ELEMENTS ASSOCIATED WITH LEVEL 2
001500*    OF THE RELATIVE I-O MODULE.  THE ELEMENTS TESTED IN THIS
001600*    ROUTINE ARE:
001700*
001800*            USE AFTER ERROR PROCEDURE FILE-NAME-1 FILE-NAME-2
001900*            READ .....  NEXT
002000*            READ .....  NEXT RECORD INTO ....
002100*            READ .....  NEXT INTO .....
002200*            READ .....  NEXT INTO ..... AT END ....
002300*            READ .....
002400*            READ .....  INTO .....
002500*            READ .....  RECORD
002600*            READ .....  RECORD  INVALID .....
002700*            READ .....  RECORD  INVALID KEY ....
002800*            START FILE-NAME-2
002900*            START FILE-NAME-2 KEY EQUAL TO ....
003000*            START FILE-NAME-2 KEY IS EQUAL TO  ....
003100*            START FILE-NAME-2 KEY IS EQUAL .....
003200*            START FILE-NAME-2 KEY IS =  ......
003300*            START FILE-NAME-2 KEY IS GREATER  .....
003400*            START FILE-NAME-2 KEY  GREATER THAN ....
003500*            START FILE-NAME-2 KEY IS GREATER  .....
003600*            START FILE-NAME-2 KEY IS  >   ....
003700*            START FILE-NAME-2 KEY     >   ....
003800*            START FILE-NAME-2 KEY IS NOT LESS THAN ....
003900*            START FILE-NAME-2 KEY IS NOT LESS  ....
004000*            START FILE-NAME-2 KEY    NOT LESS  ....
004100*            START FILE-NAME-2 KEY IS NOT  <  .....
004200*            START FILE-NAME-1 KEY IS EQUAL TO INVALID KEY .....
004300*            START FILE-NAME-1 KEY IS EQUAL TO INVALID ....
004400*            START FILE-NAME-1 INVALID KEY ....
004500*            START FILE-NAME-1 ; INVALID KEY ....
004600*            START FILE-NAME-1 KEY EQUAL TO  .....
004700*            FILE POSITION INDICATOR
004800*
004900*    EACH ELEMENT TESTED WILL BE EXERCISED SEMANTICALLY BY THIS
005000*    ROUTINE.
005100*    FOR A RELATIVE OR INDEXED FILE IN THE DYNAMIC ACCESS MODE,
005200*    EXECUTION OF AN "OPEN I-O" STATEMENT FOLLOWED BYONE OR
005300*    MORE "WRITE" STATEMENTS AND THEN A "READ NEXT" STATEMENT
005400*    WILL CAUSE THE "READ" STATEMENT TO ACCESS THE FIRST RECORD
005500*    IN THE FILE AT THE TIME OF EXECUTION OF THE "READ"
005600*    STATEMENT.  SYNTAX TESTS FOR THE "START" STATEMENT ARE
005700*    ALSO INCLUDED.
005800*
005900*
006000*       X-CARDS  WHICH MUST BE REPLACED FOR THIS PROGRAM ARE
006100*
006200*             X-21   RELATIVE FILE IMPLEMENTOR-NAME IN ASSGN TO
006300*                    CLAUSE FOR DATA FILE RL-FS1
006400*             X-22   RELATIVE FILE IMPLEMENTOR-NAME IN ASSIGN TO
006500*                    CLAUSE FOR DATA FILE RL-FD2
006600*             X-55   IMPLEMENTOR-NAME FOR SYSTEM PRINTER
006700*             X-69   ADDITIONAL VALUE OF PHRASES
006800*             X-74   VALUE OF IMPLEMENTOR-NAME
006900*             X-75   OBJECT OF VALUE OF CLAUSE FOR FILE RL-FS1
007000*             X-76   OBJECT OF VALUE OF CLAUSE FOR FILE RL-FD2
007100*             X-82   IMPLEMENTOR-NAME FOR SOURCE-COMPUTER
007200*             X-83   IMPLEMENTOR-NAME FOR OBJECT-COMPUTER
007300*
007400*        NOTE:  X-CARDS 69,74,75 AND 76 ARE OPTIONAL
007500*               AND NEED ONLY TO BE PRESENT IF THE COMPILER RE-
007600*               QUIRES THIS CODE BE AVAILABLE FOR PROPER PROGRAM
007700*               COMPILATION AND EXECUTION. IF THE VP-ROUTINE IS
007800*               USED THE  X-CARDS MAY BE AUTOMATICALLY SELECTED
007900*               FOR INCLUSION IN THE PROGRAM BY SPECIFYING THE
008000*               APPROPRIATE LETTER IN THE "*OPT" VP-ROUTINE
008100*               CONTROL CARD. THE LETTER  CORRESPONDS TO A
008200*               CHARACTER IN POSITION 7 OF THE SOURCE LINE AND
008300*               THEY ARE AS FOLLOWS
008400*
008500*                  C  SELECTS X-CARDS 74,75 AND 76
008600*                  G  SELECTS X-CARDS 69
008700*
008800*        NOTE:  THERE IS OPTIONAL SOURCE CODE IN THIS PROGRAM
008900*               FOR THE CONVENIENCE OF THE USER.  THIS OPTIONAL
009000*               CODE IS IDENTIFIED BY THE LETTER  X IN
009100*               POSITION 7  OF THE SOURCE LINE.  USE OF
009200*               SOURCE CODE WITH LETTER X WILL PRINT THE CONTENTS
009300*               OF THE FILES AFTER THE TEST REPORT.
009400*               IF THE VP-ROUTINE IS USED THE APPROPRIATE
009500*               SOURCE CODE MAY BE SELECTED BY SPECIFYING THE
009600*               RESPECTIVE LETTER IN THE "*OPT" VP-ROUTINE CONTROL
009700*               CARD.
009800*
009900******************************************************
010000 ENVIRONMENT DIVISION.
010100 CONFIGURATION SECTION.
010200 SOURCE-COMPUTER.
010300     XXXXX082.
010400 OBJECT-COMPUTER.
010500     XXXXX083.
010600 INPUT-OUTPUT SECTION.
010700 FILE-CONTROL.
010800     SELECT PRINT-FILE ASSIGN TO
010900     XXXXX055.
011000     SELECT   RL-FD1
011100        ASSIGN TO
011200     XXXXX021
011300         ORGANIZATION IS RELATIVE
011400       ACCESS MODE IS DYNAMIC
011500       RELATIVE KEY IS RL-FD1-KEY.
011600     SELECT   RL-FS2
011700         ASSIGN TO
011800     XXXXX022
011900        ACCESS MODE IS SEQUENTIAL
012000       RELATIVE KEY IS RL-FS2-KEY
012100         ORGANIZATION IS RELATIVE.
012200 DATA DIVISION.
012300 FILE SECTION.
012400 FD  PRINT-FILE.
012500 01  PRINT-REC PICTURE X(120).
012600 01  DUMMY-RECORD PICTURE X(120).
012700 FD  RL-FD1
012800     RECORD CONTAINS 240 CHARACTERS
012900C    VALUE OF
013000C    XXXXX074
013100C    IS
013200C    XXXXX075
013300G    XXXXX069
013400     .
013500 01  RL-FD1R1-F-G-240.
013600     05 RL-FD1-REC-001-120        PICTURE X(120).
013700     05 RL-FD1-REC-121-240.
013800     10 FILLER          PICTURE X(8).
013900     10 RL-FD1-FILLER.
014000        15 RL-FS1-KEYNUM PICTURE 9(5).
014100    10 FILLER           PICTURE X(5).
014200     10 FILLER           PICTURE X(19).
014300     10 FILLER           PICTURE X(9).
014400     10 RL-FD1-FILLER1.
014500        15 RL-FD1-FILLER1NUM      PICTURE 9(5).
014600    10 FILLER                    PICTURE 9(5).
014700     10 FILLER                    PICTURE X(19).
014800     10 FILLER                    PICTURE X(45).
014900 FD  RL-FS2
015000C    VALUE OF
015100C    XXXXX074
015200C    IS
015300C    XXXXX076
015400G    XXXXX069
015500     .
015600 01  RL-FS2R1-F-G-240.
015700     05 RL-FS2-REC-001-120        PICTURE X(120).
015800     05 RL-FS2-REC-121-240.
015900        10 FILLER                 PICTURE X(8).
016000        10 RL-FS2-FILLER.
016100           15 RL-FS2-KEYNUM       PICTURE 9(5).
016200       10 FILLER                 PICTURE 9(5).
016300        10 FILLER                 PICTURE X(19).
016400        10 FILLER                 PICTURE X(9).
016500        10 RL-FS2-FILLER1.
016600           15 RL-FS2-FILLER1NUM   PICTURE 9(5).
016700       10 FILLER                 PICTURE 9(5).
016800        10 FILLER                 PICTURE X(19).
016900        10 FILLER                 PICTURE X(45).
017000 WORKING-STORAGE SECTION.
017100 01  WRK-XN-00001    PIC X.
017200 01  WRK-XN-00002    PIC X.
017300 01  RL-FD1-KEY           PICTURE 9(5)  VALUE ZERO.
017400 01  RL-FS2-KEY           PICTURE 9(5)  VALUE ZERO.
017500 01  RL-FD1-FILESIZE              PICTURE 9(6) VALUE 300.
017600 01  RL-FS2-FILESIZE              PICTURE 9(6) VALUE 300.
017700 01  WRK-RL-FD1-RECKEY-CHAR.
017800  03 WRK-RL-FD1-RECKEY   PIC 9(5)  VALUE ZERO.
017900 01  WRK-RL-FS2-RECKEY    PIC 9(5)  VALUE ZERO.
018000 01  WRK-RL-FD1-FILLER.
018100     03 WRK-DU-05V00-002          PICTURE 9(5)  VALUE  ZERO.
018200 01  WRK-RL-FS2-FILLER.
018300     03 WRK-DU-05V00-004          PICTURE 9(5)  VALUE  ZERO.
018400 01  EXCUT-COUNTER-06V00          PICTURE S9(6) VALUE  ZERO.
018500 01  INV-KEY-COUNTER              PICTURE S9(6) VALUE  ZERO.
018600 01  LOGICAL-FILE-REC             PICTURE S9(6) VALUE  ZERO.
018700 01  ERROR-COUNTER-06V00          PICTURE S9(6) VALUE  ZERO.
018800 01  ASCEND-DESEND-SWITCH        PICTURE XX   VALUE "UP".
018900             88 ASCEND VALUE "UP".
019000             88 DSCEND VALUE "DN".
019100 01  FILE-RECORD-INFORMATION-REC.
019200     03 FILE-RECORD-INFO-SKELETON.
019300        05 FILLER                 PICTURE X(48)       VALUE
019400             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
019500        05 FILLER                 PICTURE X(46)       VALUE
019600             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
019700        05 FILLER                 PICTURE X(26)       VALUE
019800             ",LFIL=000000,ORG=  ,LBLR= ".
019900        05 FILLER                 PICTURE X(37)       VALUE
020000             ",RECKEY=                             ".
020100        05 FILLER                 PICTURE X(38)       VALUE
020200             ",ALTKEY1=                             ".
020300        05 FILLER                 PICTURE X(38)       VALUE
020400             ",ALTKEY2=                             ".
020500        05 FILLER                 PICTURE X(7)        VALUE SPACE.
020600     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
020700        05 FILE-RECORD-INFO-P1-120.
020800           07 FILLER              PIC X(5).
020900           07 XFILE-NAME           PIC X(6).
021000           07 FILLER              PIC X(8).
021100           07 XRECORD-NAME         PIC X(6).
021200           07 FILLER              PIC X(1).
021300           07 REELUNIT-NUMBER     PIC 9(1).
021400           07 FILLER              PIC X(7).
021500           07 XRECORD-NUMBER       PIC 9(6).
021600           07 FILLER              PIC X(6).
021700           07 UPDATE-NUMBER       PIC 9(2).
021800           07 FILLER              PIC X(5).
021900           07 ODO-NUMBER          PIC 9(4).
022000           07 FILLER              PIC X(5).
022100           07 XPROGRAM-NAME        PIC X(5).
022200           07 FILLER              PIC X(7).
022300           07 XRECORD-LENGTH       PIC 9(6).
022400           07 FILLER              PIC X(7).
022500           07 CHARS-OR-RECORDS    PIC X(2).
022600           07 FILLER              PIC X(1).
022700           07 XBLOCK-SIZE          PIC 9(4).
022800           07 FILLER              PIC X(6).
022900           07 RECORDS-IN-FILE     PIC 9(6).
023000           07 FILLER              PIC X(5).
023100           07 XFILE-ORGANIZATION   PIC X(2).
023200           07 FILLER              PIC X(6).
023300           07 XLABEL-TYPE          PIC X(1).
023400        05 FILE-RECORD-INFO-P121-240.
023500           07 FILLER              PIC X(8).
023600           07 XRECORD-KEY          PIC X(29).
023700           07 FILLER              PIC X(9).
023800           07 ALTERNATE-KEY1      PIC X(29).
023900           07 FILLER              PIC X(9).
024000           07 ALTERNATE-KEY2      PIC X(29).
024100           07 FILLER              PIC X(7).
024200 01  TEST-RESULTS.
024300     02 FILLER                   PIC X      VALUE SPACE.
024400     02 FEATURE                  PIC X(20)  VALUE SPACE.
024500     02 FILLER                   PIC X      VALUE SPACE.
024600     02 P-OR-F                   PIC X(5)   VALUE SPACE.
024700     02 FILLER                   PIC X      VALUE SPACE.
024800     02  PAR-NAME.
024900       03 FILLER                 PIC X(19)  VALUE SPACE.
025000       03  PARDOT-X              PIC X      VALUE SPACE.
025100       03 DOTVALUE               PIC 99     VALUE ZERO.
025200     02 FILLER                   PIC X(8)   VALUE SPACE.
025300     02 RE-MARK                  PIC X(61).
025400 01  TEST-COMPUTED.
025500     02 FILLER                   PIC X(30)  VALUE SPACE.
025600     02 FILLER                   PIC X(17)  VALUE
025700            "       COMPUTED=".
025800     02 COMPUTED-X.
025900     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
026000     03 COMPUTED-N               REDEFINES COMPUTED-A
026100                                 PIC -9(9).9(9).
026200     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
026300     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
026400     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
026500     03       CM-18V0 REDEFINES COMPUTED-A.
026600         04 COMPUTED-18V0                    PIC -9(18).
026700         04 FILLER                           PIC X.
026800     03 FILLER PIC X(50) VALUE SPACE.
026900 01  TEST-CORRECT.
027000     02 FILLER PIC X(30) VALUE SPACE.
027100     02 FILLER PIC X(17) VALUE "       CORRECT =".
027200     02 CORRECT-X.
027300     03 CORRECT-A                  PIC X(20) VALUE SPACE.
027400     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
027500     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
027600     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
027700     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
027800     03      CR-18V0 REDEFINES CORRECT-A.
027900         04 CORRECT-18V0                     PIC -9(18).
028000         04 FILLER                           PIC X.
028100     03 FILLER PIC X(2) VALUE SPACE.
028200     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
028300 01  CCVS-C-1.
028400     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
028500-    "SS  PARAGRAPH-NAME
028600-    "       REMARKS".
028700     02 FILLER                     PIC X(20)    VALUE SPACE.
028800 01  CCVS-C-2.
028900     02 FILLER                     PIC X        VALUE SPACE.
029000     02 FILLER                     PIC X(6)     VALUE "TESTED".
029100     02 FILLER                     PIC X(15)    VALUE SPACE.
029200     02 FILLER                     PIC X(4)     VALUE "FAIL".
029300     02 FILLER                     PIC X(94)    VALUE SPACE.
029400 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
029500 01  REC-CT                        PIC 99       VALUE ZERO.
029600 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
029700 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
029800 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
029900 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
030000 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
030100 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
030200 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
030300 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
030400 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
030500 01  CCVS-H-1.
030600     02  FILLER                    PIC X(39)    VALUE SPACES.
030700     02  FILLER                    PIC X(42)    VALUE
030800     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
030900     02  FILLER                    PIC X(39)    VALUE SPACES.
031000 01  CCVS-H-2A.
031100   02  FILLER                        PIC X(40)  VALUE SPACE.
031200   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
031300   02  FILLER                        PIC XXXX   VALUE
031400     "4.2 ".
031500   02  FILLER                        PIC X(28)  VALUE
031600            " COPY - NOT FOR DISTRIBUTION".
031700   02  FILLER                        PIC X(41)  VALUE SPACE.
031800
031900 01  CCVS-H-2B.
032000   02  FILLER                        PIC X(15)  VALUE
032100            "TEST RESULT OF ".
032200   02  TEST-ID                       PIC X(9).
032300   02  FILLER                        PIC X(4)   VALUE
032400            " IN ".
032500   02  FILLER                        PIC X(12)  VALUE
032600     " HIGH       ".
032700   02  FILLER                        PIC X(22)  VALUE
032800            " LEVEL VALIDATION FOR ".
032900   02  FILLER                        PIC X(58)  VALUE
033000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
033100 01  CCVS-H-3.
033200     02  FILLER                      PIC X(34)  VALUE
033300            " FOR OFFICIAL USE ONLY    ".
033400     02  FILLER                      PIC X(58)  VALUE
033500     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
033600     02  FILLER                      PIC X(28)  VALUE
033700            "  COPYRIGHT   1985 ".
033800 01  CCVS-E-1.
033900     02 FILLER                       PIC X(52)  VALUE SPACE.
034000     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
034100     02 ID-AGAIN                     PIC X(9).
034200     02 FILLER                       PIC X(45)  VALUE SPACES.
034300 01  CCVS-E-2.
034400     02  FILLER                      PIC X(31)  VALUE SPACE.
034500     02  FILLER                      PIC X(21)  VALUE SPACE.
034600     02 CCVS-E-2-2.
034700         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
034800         03 FILLER                   PIC X      VALUE SPACE.
034900         03 ENDER-DESC               PIC X(44)  VALUE
035000            "ERRORS ENCOUNTERED".
035100 01  CCVS-E-3.
035200     02  FILLER                      PIC X(22)  VALUE
035300            " FOR OFFICIAL USE ONLY".
035400     02  FILLER                      PIC X(12)  VALUE SPACE.
035500     02  FILLER                      PIC X(58)  VALUE
035600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
035700     02  FILLER                      PIC X(13)  VALUE SPACE.
035800     02 FILLER                       PIC X(15)  VALUE
035900             " COPYRIGHT 1985".
036000 01  CCVS-E-4.
036100     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
036200     02 FILLER                       PIC X(4)   VALUE " OF ".
036300     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
036400     02 FILLER                       PIC X(40)  VALUE
036500      "  TESTS WERE EXECUTED SUCCESSFULLY".
036600 01  XXINFO.
036700     02 FILLER                       PIC X(19)  VALUE
036800            "*** INFORMATION ***".
036900     02 INFO-TEXT.
037000       04 FILLER                     PIC X(8)   VALUE SPACE.
037100       04 XXCOMPUTED                 PIC X(20).
037200       04 FILLER                     PIC X(5)   VALUE SPACE.
037300       04 XXCORRECT                  PIC X(20).
037400     02 INF-ANSI-REFERENCE           PIC X(48).
037500 01  HYPHEN-LINE.
037600     02 FILLER  PIC IS X VALUE IS SPACE.
037700     02 FILLER  PIC IS X(65)    VALUE IS "************************
037800-    "*****************************************".
037900     02 FILLER  PIC IS X(54)    VALUE IS "************************
038000-    "******************************".
038100 01  CCVS-PGM-ID                     PIC X(9)   VALUE
038200     "RL205A".
038300 PROCEDURE DIVISION.
038400 DECLARATIVES.
038500 USE-RL205-TEST SECTION.
038600     USE      AFTER ERROR PROCEDURE RL-FD1  RL-FS2.
038700 USE-PAR-001.
038800     ADD      010000  TO ERROR-COUNTER-06V00.
038900 USE-PAR-EXIT.
039000     EXIT.
039100 END DECLARATIVES.
039200 CCVS1 SECTION.
039300 OPEN-FILES.
039400     OPEN    OUTPUT PRINT-FILE.
039500     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
039600     MOVE    SPACE TO TEST-RESULTS.
039700     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
039800     MOVE    ZERO TO REC-SKL-SUB.
039900     PERFORM CCVS-INIT-FILE 9 TIMES.
040000 CCVS-INIT-FILE.
040100     ADD     1 TO REC-SKL-SUB.
040200     MOVE    FILE-RECORD-INFO-SKELETON
040300          TO FILE-RECORD-INFO (REC-SKL-SUB).
040400 CCVS-INIT-EXIT.
040500     GO TO CCVS1-EXIT.
040600 CLOSE-FILES.
040700     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
040800 TERMINATE-CCVS.
040900S    EXIT PROGRAM.
041000STERMINATE-CALL.
041100     STOP     RUN.
041200 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
041300 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
041400 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
041500 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
041600     MOVE "****TEST DELETED****" TO RE-MARK.
041700 PRINT-DETAIL.
041800     IF REC-CT NOT EQUAL TO ZERO
041900             MOVE "." TO PARDOT-X
042000             MOVE REC-CT TO DOTVALUE.
042100     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
042200     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
042300        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
042400          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
042500     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
042600     MOVE SPACE TO CORRECT-X.
042700     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
042800     MOVE     SPACE TO RE-MARK.
042900 HEAD-ROUTINE.
043000     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043100     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043200     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
043300     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
043400 COLUMN-NAMES-ROUTINE.
043500     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
043600     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
043800 END-ROUTINE.
043900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
044000 END-RTN-EXIT.
044100     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044200 END-ROUTINE-1.
044300      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
044400      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
044500      ADD PASS-COUNTER TO ERROR-HOLD.
044600*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
044700      MOVE PASS-COUNTER TO CCVS-E-4-1.
044800      MOVE ERROR-HOLD TO CCVS-E-4-2.
044900      MOVE CCVS-E-4 TO CCVS-E-2-2.
045000      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
045100  END-ROUTINE-12.
045200      MOVE "TEST(S) FAILED" TO ENDER-DESC.
045300     IF       ERROR-COUNTER IS EQUAL TO ZERO
045400         MOVE "NO " TO ERROR-TOTAL
045500         ELSE
045600         MOVE ERROR-COUNTER TO ERROR-TOTAL.
045700     MOVE     CCVS-E-2 TO DUMMY-RECORD.
045800     PERFORM WRITE-LINE.
045900 END-ROUTINE-13.
046000     IF DELETE-COUNTER IS EQUAL TO ZERO
046100         MOVE "NO " TO ERROR-TOTAL  ELSE
046200         MOVE DELETE-COUNTER TO ERROR-TOTAL.
046300     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
046400     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
046500      IF   INSPECT-COUNTER EQUAL TO ZERO
046600          MOVE "NO " TO ERROR-TOTAL
046700      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
046800      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
046900      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
047000     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
047100 WRITE-LINE.
047200     ADD 1 TO RECORD-COUNT.
047300Y    IF RECORD-COUNT GREATER 50
047400Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
047500Y        MOVE SPACE TO DUMMY-RECORD
047600Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
047700Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
047800Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
047900Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
048000Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
048100Y        MOVE ZERO TO RECORD-COUNT.
048200     PERFORM WRT-LN.
048300 WRT-LN.
048400     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
048500     MOVE SPACE TO DUMMY-RECORD.
048600 BLANK-LINE-PRINT.
048700     PERFORM WRT-LN.
048800 FAIL-ROUTINE.
048900     IF     COMPUTED-X NOT EQUAL TO SPACE
049000            GO TO   FAIL-ROUTINE-WRITE.
049100     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
049200     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
049300     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
049400     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
049500     MOVE   SPACES TO INF-ANSI-REFERENCE.
049600     GO TO  FAIL-ROUTINE-EX.
049700 FAIL-ROUTINE-WRITE.
049800     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
049900     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
050000     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
050100     MOVE   SPACES TO COR-ANSI-REFERENCE.
050200 FAIL-ROUTINE-EX. EXIT.
050300 BAIL-OUT.
050400     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
050500     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
050600 BAIL-OUT-WRITE.
050700     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
050800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
050900     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
051000     MOVE   SPACES TO INF-ANSI-REFERENCE.
051100 BAIL-OUT-EX. EXIT.
051200 CCVS1-EXIT.
051300     EXIT.
051400 SECT-RL205-0001 SECTION.
051500 REL-INIT-001.
051600     OPEN     OUTPUT  RL-FD1.
051700     OPEN     OUTPUT  RL-FS2.
051800     MOVE     "RL-FD1"  TO XFILE-NAME (1).
051900     MOVE     "R1-F-G"  TO XRECORD-NAME (1).
052000     MOVE     ZERO      TO XRECORD-NUMBER (1).
052100     MOVE ".XXX."       TO XPROGRAM-NAME (1).
052200     MOVE     000240    TO XRECORD-LENGTH (1).
052300     MOVE     0001      TO XBLOCK-SIZE (1).
052400     MOVE     "RC"      TO CHARS-OR-RECORDS (1).
052500     MOVE     "RL"      TO XFILE-ORGANIZATION (1).
052600     MOVE     "S"       TO XLABEL-TYPE (1).
052700     MOVE     000300    TO RL-FD1-FILESIZE.
052800     MOVE     000300    TO RECORDS-IN-FILE (1).
052900     MOVE     00001     TO WRK-RL-FD1-RECKEY.
053000     MOVE     00300     TO WRK-DU-05V00-002.
053100     MOVE     ZERO      TO EXCUT-COUNTER-06V00.
053200     MOVE     ZERO      TO INV-KEY-COUNTER.
053300     MOVE     "REL-TEST-001" TO PAR-NAME.
053400     MOVE     ZERO TO REC-CT.
053500     MOVE     "RL-FS2"  TO XFILE-NAME (2).
053600     MOVE     "R1-F-G"  TO XRECORD-NAME (2).
053700     MOVE     ZERO      TO XRECORD-NUMBER (2).
053800     MOVE ".XXX."       TO XPROGRAM-NAME (2).
053900     MOVE     000240    TO XRECORD-LENGTH (2).
054000     MOVE     0001      TO XBLOCK-SIZE (2).
054100     MOVE     "RC"      TO CHARS-OR-RECORDS (2).
054200     MOVE     "RL"      TO XFILE-ORGANIZATION (2).
054300     MOVE     "S"       TO XLABEL-TYPE (2).
054400     MOVE     00300     TO RL-FS2-FILESIZE.
054500     MOVE     00300     TO RECORDS-IN-FILE (2).
054600     MOVE     00001     TO  WRK-RL-FS2-RECKEY.
054700     MOVE     00300     TO WRK-DU-05V00-004.
054800 REL-TEST-001-R1.
054900     ADD      0001 TO   XRECORD-NUMBER (1).
055000     MOVE     WRK-RL-FD1-RECKEY  TO XRECORD-KEY (1).
055100     MOVE     WRK-RL-FD1-FILLER  TO ALTERNATE-KEY1 (1).
055200     MOVE     FILE-RECORD-INFO (1) TO RL-FD1R1-F-G-240.
055300     MOVE     WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
055400     WRITE    RL-FD1R1-F-G-240
055500              INVALID KEY
055600              ADD       000001 TO INV-KEY-COUNTER.
055700     ADD      000001  TO EXCUT-COUNTER-06V00.
055800     ADD      00001   TO WRK-RL-FD1-RECKEY.
055900     SUBTRACT 00001   FROM WRK-DU-05V00-002.
056000     IF       XRECORD-NUMBER (1) LESS THAN RL-FD1-FILESIZE
056100              GO TO REL-TEST-001-R1.
056200     CLOSE    RL-FD1.
056300 REL-TEST-001-01.
056400     MOVE     "CREATE FILE RL-FD1"  TO FEATURE.
056500     MOVE     01 TO REC-CT.
056600     IF       EXCUT-COUNTER-06V00  NOT EQUAL TO RL-FD1-FILESIZE
056700              PERFORM   FAIL
056800              MOVE      RL-FD1-FILESIZE  TO  CORRECT-N
056900              MOVE      EXCUT-COUNTER-06V00 TO COMPUTED-N
057000              MOVE      "INCORRECT NUMBER OF WRITES" TO RE-MARK
057100              PERFORM   PRINT-DETAIL
057200              GO TO     REL-INIT-001-R2.
057300     IF       INV-KEY-COUNTER NOT EQUAL TO ZERO
057400              PERFORM   FAIL
057500              MOVE      INV-KEY-COUNTER TO COMPUTED-N
057600              MOVE      ZERO TO  CORRECT-N
057700              MOVE      "INVALID KEY ON WRITE" TO RE-MARK
057800              PERFORM   PRINT-DETAIL
057900              GO TO     REL-INIT-001-R2.
058000*
058100*    01
058200*
058300     PERFORM  PASS.
058400     PERFORM  REL-WRITE-001.
058500 REL-INIT-001-R2.
058600     MOVE     ZERO   TO INV-KEY-COUNTER.
058700     MOVE     ZERO   TO EXCUT-COUNTER-06V00.
058800 REL-TEST-001-R2.
058900     ADD      0001  TO  XRECORD-NUMBER (2).
059000     MOVE     WRK-RL-FS2-RECKEY  TO  XRECORD-KEY (2).
059100     MOVE     WRK-RL-FS2-FILLER  TO  ALTERNATE-KEY1 (2).
059200     MOVE     FILE-RECORD-INFO (2) TO RL-FS2R1-F-G-240.
059300     WRITE    RL-FS2R1-F-G-240
059400              INVALID KEY
059500              ADD   000001 TO INV-KEY-COUNTER.
059600     ADD      000001 TO EXCUT-COUNTER-06V00.
059700     ADD      00001  TO  WRK-RL-FS2-RECKEY.
059800     SUBTRACT 00001  FROM WRK-DU-05V00-004.
059900     IF       XRECORD-NUMBER (2) LESS THAN RL-FS2-FILESIZE
060000              GO TO  REL-TEST-001-R2.
060100     CLOSE    RL-FS2.
060200 REL-TEST-001-02.
060300     MOVE     "CREATE FILE RL-FS2" TO  FEATURE.
060400     MOVE     02  TO REC-CT.
060500     IF       EXCUT-COUNTER-06V00 NOT EQUAL TO RL-FS2-FILESIZE
060600              PERFORM   FAIL
060700              MOVE      RL-FS2-FILESIZE  TO  CORRECT-N
060800              MOVE      EXCUT-COUNTER-06V00 TO COMPUTED-N
060900              MOVE      "INCORRECT NUMBER OF WRITES" TO RE-MARK
061000              PERFORM   PRINT-DETAIL
061100              GO  TO    REL-EXIT-001.
061200*
061300*    02
061400*
061500     IF       INV-KEY-COUNTER  NOT EQUAL TO ZERO
061600              PERFORM   FAIL
061700              MOVE      INV-KEY-COUNTER  TO COMPUTED-N
061800              MOVE      ZERO TO CORRECT-N
061900              MOVE      "INVALID KEY ON WRITE" TO RE-MARK
062000              PERFORM   PRINT-DETAIL
062100              GO TO     REL-EXIT-001.
062200     PERFORM  PASS.
062300     PERFORM  REL-WRITE-001.
062400     GO TO    REL-EXIT-001.
062500 REL-WRITE-001.
062600     PERFORM  PRINT-DETAIL.
062700 REL-DELETE-001.
062800     PERFORM  DE-LETE.
062900     PERFORM  PRINT-DETAIL.
063000 REL-EXIT-001.
063100     EXIT.
063200 REL-INIT-002.
063300     PERFORM  BLANK-LINE-PRINT.
063400     MOVE     "THE FOLLOWING  TESTS ACCESS A FILE DEFINED AS
063500-             "ACCESS MODE IS DYNAMIC."  TO  PRINT-REC.
063600     PERFORM  WRITE-LINE.
063700     PERFORM  BLANK-LINE-PRINT.
063800     MOVE     "READ NEXT"  TO FEATURE.
063900     MOVE     ZERO  TO  REC-CT.
064000     MOVE     "REL-TEST-002"  TO  PAR-NAME.
064100 REL-INIT-002-R1.
064200     OPEN  INPUT  RL-FD1.
064300     PERFORM  REL-INIT-002-R.
064400 REL-TEST-002-R1.
064500     READ     RL-FD1 NEXT.
064600     MOVE     RL-FD1R1-F-G-240  TO  FILE-RECORD-INFO (1).
064700     PERFORM  REL-VERIFY-002
064800     IF       EXCUT-COUNTER-06V00 LESS THAN  10
064900              GO TO REL-TEST-002-R1.
065000     CLOSE    RL-FD1.
065100 REL-TEST-002-01.
065200     MOVE     01  TO REC-CT.
065300     PERFORM  REL-TEST-002.
065400     GO TO    REL-EXIT-002-01.
065500*
065600*    01
065700*
065800 REL-DELETE-002-01.
065900     MOVE     01  TO REC-CT.
066000     PERFORM  DE-LETE.
066100     PERFORM  REL-WRITE-002.
066200 REL-EXIT-002-01.
066300     EXIT.
066400 REL-INIT-002-R2.
066500     PERFORM  REL-INIT-002-R.
066600     OPEN     INPUT     RL-FD1.
066700 REL-TEST-002-R2.
066800     MOVE     SPACE TO FILE-RECORD-INFO (9).
066900     MOVE     SPACE TO FILE-RECORD-INFO (1).
067000     READ     RL-FD1   NEXT RECORD
067100              INTO   FILE-RECORD-INFO (9).
067200     MOVE     RL-FD1R1-F-G-240  TO  FILE-RECORD-INFO (1).
067300     PERFORM  REL-VERIFY-002.
067400     IF       XRECORD-NUMBER (9) NOT EQUAL TO LOGICAL-FILE-REC
067500              ADD   000100  TO ERROR-COUNTER-06V00.
067600     IF       EXCUT-COUNTER-06V00 LESS THAN 10
067700              GO TO  REL-TEST-002-R2.
067800     CLOSE    RL-FD1.
067900 REL-TEST-002-02.
068000     MOVE     02 TO REC-CT.
068100     PERFORM  REL-TEST-002.
068200*
068300*    02
068400*
068500     GO TO    REL-EXIT-002-02.
068600 REL-DELETE-002-02.
068700     MOVE     02  TO REC-CT.
068800     PERFORM  DE-LETE.
068900     PERFORM  REL-WRITE-002.
069000 REL-EXIT-002-02.
069100     EXIT.
069200 REL-INIT-002-R3.
069300     OPEN     INPUT  RL-FD1.
069400     PERFORM  REL-INIT-002-R.
069500 REL-TEST-002-R3.
069600     MOVE     SPACE TO FILE-RECORD-INFO (9).
069700     MOVE     SPACE TO FILE-RECORD-INFO (1).
069800     READ     RL-FD1  NEXT
069900              INTO   FILE-RECORD-INFO (9).
070000     MOVE     RL-FD1R1-F-G-240 TO FILE-RECORD-INFO (1).
070100     PERFORM  REL-VERIFY-002.
070200     IF       XRECORD-NUMBER (9) NOT EQUAL TO LOGICAL-FILE-REC
070300              ADD   000100  TO  ERROR-COUNTER-06V00.
070400     IF       EXCUT-COUNTER-06V00 LESS THAN 10
070500              GO TO  REL-TEST-002-R3.
070600     CLOSE    RL-FD1.
070700 REL-TEST-002-03.
070800     MOVE     03 TO REC-CT.
070900     PERFORM  REL-TEST-002.
071000*
071100*    03
071200*
071300     GO  TO   REL-EXIT-002-03.
071400 REL-DELETE-002-03.
071500     MOVE     03  TO REC-CT.
071600     PERFORM  DE-LETE.
071700     PERFORM  REL-WRITE-002.
071800 REL-EXIT-002-03.
071900     EXIT.
072000 REL-INIT-002-R4.
072100     OPEN     INPUT  RL-FD1.
072200     PERFORM  REL-INIT-002-R.
072300     MOVE     RL-FD1-FILESIZE TO ERROR-COUNTER-06V00.
072400     ADD      000001  TO ERROR-COUNTER-06V00.
072500 REL-TEST-002-R4.
072600     MOVE     SPACE TO FILE-RECORD-INFO (9).
072700     MOVE     SPACE TO FILE-RECORD-INFO (1).
072800     READ     RL-FD1  NEXT INTO  FILE-RECORD-INFO (9) AT END
072900              SUBTRACT   000001  FROM  ERROR-COUNTER-06V00
073000             GO TO   REL-TEST-002-04.
073100     MOVE     RL-FD1R1-F-G-240  TO  FILE-RECORD-INFO (1).
073200     PERFORM  REL-VERIFY-002.
073300     IF      XRECORD-NUMBER (9) NOT EQUAL TO LOGICAL-FILE-REC
073400             ADD  00100  TO ERROR-COUNTER-06V00.
073500     IF       EXCUT-COUNTER-06V00  GREATER THAN RL-FD1-FILESIZE
073600              NEXT SENTENCE
073700              ELSE
073800              GO TO    REL-TEST-002-R4.
073900*
074000*    TEST REL-002-04 TESTS THE COBOL CONSTRUCT  "READ FILE-
074100*    NAME NEXT INTO IDENTIFIER AT END".  THE TEST READS THE FILE
074200*    SEQUENTIALY VIA THE RELATIVE KEY  (RECORD KEY IS THE KEY OF
074300*    REFERENCE) UNTIL AN END-OF-FILE CONDITION OCCURS.  A CHECK
074400*    IS MADE TO VERIFY THAT THE PROPER RECORDS WERE RETRIVED AND
074500*    THE AT END PATH WAS TAKEN ON THE 301 ST READ.
074600*
074700 REL-TEST-002-04.
074800     CLOSE   RL-FD1.
074900     MOVE     04   TO REC-CT.
075000     PERFORM  REL-TEST-002.
075100*   .04
075200     GO TO    REL-EXIT-002-04.
075300 REL-DELETE-002-04.
075400     MOVE     04  TO REC-CT.
075500     PERFORM  DE-LETE.
075600     PERFORM  REL-WRITE-002.
075700 REL-EXIT-002-04.
075800     EXIT.
075900 REL-INIT-002-R5.
076000     OPEN     INPUT  RL-FD1.
076100     PERFORM  REL-INIT-002-R.
076200     MOVE    "READ"  TO FEATURE.
076300     MOVE     ZERO TO WRK-RL-FD1-RECKEY.
076400 REL-TEST-002-R5.
076500     ADD      00005   TO WRK-RL-FD1-RECKEY.
076600     ADD      000004  TO LOGICAL-FILE-REC.
076700     MOVE     WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
076800     READ RL-FD1.
076900     MOVE     RL-FD1R1-F-G-240  TO  FILE-RECORD-INFO (1).
077000     PERFORM  REL-VERIFY-002.
077100     MOVE     SPACE TO FILE-RECORD-INFO (1).
077200     IF       EXCUT-COUNTER-06V00  LESS THAN 10
077300              GO TO    REL-TEST-002-R5.
077400     CLOSE    RL-FD1.
077500 REL-TEST-002-05.
077600     MOVE     05   TO REC-CT.
077700     PERFORM  REL-TEST-002.
077800*   .05
077900     GO TO    REL-EXIT-002-05.
078000 REL-DELETE-002-05.
078100     MOVE     05  TO REC-CT.
078200     PERFORM  DE-LETE.
078300     PERFORM  REL-WRITE-002.
078400 REL-EXIT-002-05.
078500     EXIT.
078600 REL-INIT-002-R6.
078700     OPEN     INPUT  RL-FD1.
078800     PERFORM  REL-INIT-002-R.
078900     MOVE     ZERO TO WRK-RL-FD1-RECKEY.
079000 REL-TEST-002-R6.
079100     MOVE     SPACE TO FILE-RECORD-INFO (9).
079200     MOVE     SPACE TO FILE-RECORD-INFO (1).
079300     ADD      00005   TO WRK-RL-FD1-RECKEY.
079400     ADD      000004  TO LOGICAL-FILE-REC.
079500     MOVE     WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
079600     READ     RL-FD1  INTO   FILE-RECORD-INFO (9).
079700     MOVE     RL-FD1R1-F-G-240  TO  FILE-RECORD-INFO (1).
079800     PERFORM  REL-VERIFY-002.
079900     IF       XRECORD-NUMBER (9)   NOT EQUAL   TO LOGICAL-FILE-REC
080000              ADD   000100 TO ERROR-COUNTER-06V00.
080100     IF       EXCUT-COUNTER-06V00  LESS THAN 10
080200              GO TO    REL-TEST-002-R6.
080300     CLOSE    RL-FD1.
080400 REL-TEST-002-06.
080500     MOVE     06   TO REC-CT.
080600     PERFORM  REL-TEST-002.
080700*   .06
080800     GO TO    REL-EXIT-002-06.
080900 REL-DELETE-002-06.
081000     MOVE     06  TO REC-CT.
081100     PERFORM  DE-LETE.
081200     PERFORM  REL-WRITE-002.
081300 REL-EXIT-002-06.
081400     EXIT.
081500 REL-INIT-002-R7.
081600     OPEN     INPUT  RL-FD1.
081700     PERFORM  REL-INIT-002-R.
081800     MOVE     ZERO  TO WRK-RL-FD1-RECKEY.
081900     MOVE     ZERO  TO LOGICAL-FILE-REC.
082000 REL-TEST-002-R7.
082100     MOVE      SPACE TO FILE-RECORD-INFO (1).
082200     ADD      00005   TO WRK-RL-FD1-RECKEY.
082300     ADD   0004  TO LOGICAL-FILE-REC.
082400     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
082500     READ   RL-FD1 RECORD.
082600     MOVE     RL-FD1R1-F-G-240  TO  FILE-RECORD-INFO (1).
082700     PERFORM  REL-VERIFY-002.
082800     IF       EXCUT-COUNTER-06V00  LESS THAN 10
082900              GO TO    REL-TEST-002-R7.
083000     CLOSE    RL-FD1.
083100 REL-TEST-002-07.
083200     MOVE     07   TO REC-CT.
083300     PERFORM  REL-TEST-002.
083400*   .07
083500     GO TO    REL-EXIT-002-07.
083600 REL-DELETE-002-07.
083700     MOVE     07  TO REC-CT.
083800     PERFORM  DE-LETE.
083900     PERFORM  REL-WRITE-002.
084000 REL-EXIT-002-07.
084100     EXIT.
084200 REL-INIT-002-R8.
084300     OPEN     INPUT  RL-FD1.
084400     PERFORM  REL-INIT-002-R.
084500     MOVE     00301  TO WRK-RL-FD1-RECKEY.
084600     MOVE     SPACE TO RL-FD1R1-F-G-240.
084700 REL-TEST-002-R8.
084800     ADD      00005   TO WRK-RL-FD1-RECKEY.
084900     MOVE     WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
085000     READ   RL-FD1 RECORD INVALID
085100              SUBTRACT  000001  FROM ERROR-COUNTER-06V00.
085200     ADD     000001  TO EXCUT-COUNTER-06V00.
085300     IF       EXCUT-COUNTER-06V00  LESS THAN 10
085400              GO TO    REL-TEST-002-R8.
085500     CLOSE    RL-FD1.
085600 REL-TEST-002-08.
085700     MOVE     08   TO REC-CT.
085800     PERFORM  REL-TEST-002.
085900*   .08
086000     GO TO    REL-EXIT-002-08.
086100 REL-DELETE-002-08.
086200     MOVE     08  TO REC-CT.
086300     PERFORM  DE-LETE.
086400     PERFORM  REL-WRITE-002.
086500 REL-EXIT-002-08.
086600     EXIT.
086700 REL-INIT-002-R9.
086800     OPEN     INPUT  RL-FD1.
086900     PERFORM  REL-INIT-002-R.
087000     MOVE     00301  TO WRK-RL-FD1-RECKEY.
087100     MOVE     SPACE TO RL-FD1R1-F-G-240.
087200 REL-TEST-002-R9.
087300     ADD     00004  TO WRK-RL-FD1-RECKEY.
087400     MOVE     WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
087500     MOVE     SPACE TO FILE-RECORD-INFO (1).
087600     READ   RL-FD1 RECORD INVALID KEY
087700              SUBTRACT  000001  FROM ERROR-COUNTER-06V00.
087800     ADD    00001  TO EXCUT-COUNTER-06V00.
087900     IF       EXCUT-COUNTER-06V00  LESS THAN 10
088000              GO TO    REL-TEST-002-R9.
088100     CLOSE    RL-FD1.
088200 REL-TEST-002-09.
088300     MOVE     09   TO REC-CT.
088400     PERFORM  REL-TEST-002.
088500*   .09
088600     GO TO    REL-EXIT-002-09.
088700 REL-DELETE-002-09.
088800     MOVE     09  TO REC-CT.
088900     PERFORM  DE-LETE.
089000     PERFORM  REL-WRITE-002.
089100 REL-EXIT-002-09.
089200     GO TO    REL-EXIT-002.
089300 REL-INIT-002-R.
089400     MOVE     00010  TO ERROR-COUNTER-06V00.
089500     MOVE     ZERO TO EXCUT-COUNTER-06V00.
089600     MOVE     ZERO TO INV-KEY-COUNTER.
089700     MOVE     ZERO TO LOGICAL-FILE-REC.
089800 REL-VERIFY-002.
089900     ADD      000001    TO  EXCUT-COUNTER-06V00.
090000     ADD      000001    TO  LOGICAL-FILE-REC.
090100     IF       XRECORD-NUMBER (1) EQUAL TO  LOGICAL-FILE-REC
090200              SUBTRACT   000001 FROM  ERROR-COUNTER-06V00.
090300 REL-TEST-002.
090400     IF       ERROR-COUNTER-06V00 EQUAL TO ZERO
090500              PERFORM   PASS
090600              ELSE
090700              PERFORM   FAIL
090800              MOVE      ZERO TO   CORRECT-N
090900              MOVE      ERROR-COUNTER-06V00 TO COMPUTED-N
091000              MOVE      "SEE PARA. - REL-TEST-002" TO RE-MARK.
091100     PERFORM  REL-WRITE-002.
091200*
091300*       EACH TEST IS EXECUTED 10 TIMES EXCEPT FOR  REL-TEST-002-04
091400*    WHICH IS EXECUTED 300 TIMES.  FOLLOWING THE LAST
091500*    EXECUTION A TEST IS MADE ON ERROR-COUNTER-06V00 WHICH IS
091600*    EXPECTED TO BE ZERO.  IF ERROR-COUNTER-06V00 IS NOT ZERO
091700*    THE VALUE IN THE COUNTER INDICATES HOW THE EXECUTION FAILED
091800*    AND THE NUMBER OF TIMES THE UNEXPECTED ACTION OCCURRED
091900*    DURING THE TEST.  BEFORE THE TEST BEGINS ERROR-COUNTER-06V00
092000*    IS INITIALIZED WITH A VALUE.  EACH TIME THE CORRECT RECORD
092100*    WAS MADE AVAILABLE FOLLOWING THE READ, OR AN INVALID KEY
092200*    CONDITION OCCURRED THAT WAS EXPECTED FOLLOWING A READ OR
092300*    START, ERROR-COUNTER-06V00 IS DECREMENTED BY 1.
092400*    FOR EACH EXECUTION THAT DID NOT PRODUCE THE EXPECTED
092500*    RESULTS  THE ERROR-COUNTER-06V00 IS INCREMENTED BY THE VALUE
092600*    FOR THE ACTION LISTED BELOW, E.G., VALUE 20003 WOULD INDICATE
092700*    THAT OF THE 10 EXECUTIONS DURING THE TEST (READING LEFT TO
092800*    RIGHT)  2 INVALID KEY CONDITIONS AND 3 RECORDS RETRIEVED
092900*    AS A RESULT OF THE READ OR START WAS NOT-AS EXPECTED.
093000*
093100*
093200*
093300*    COMPUTED RESULT                 INDICATED
093400*       INCREMENTS                     ACTION
093500*
093600*       000100          THE  RECORD  FOUND IN THE IDENTIFIER
093700*                       SPECIFIED IN THE INTO PHRASE OF THE
093800*                       READ STATEMENT WAS NOT THE RECORD
093900*                       EXPECTED FOLLOWING EXECUTION OF THE
094000*                       READ.
094100*
094200*       000001          THE RECORD RETREIVED FROM THE FILE
094300*                       FOLLOWING THE READ WAS NOT THE ONE
094400*                       EXPECTED.
094500*
094600*       010000          AN UNEXPECTED INVALID KEY OR AT END
094700*                       CONDITION OCCURRED.  NOTE - ASSUMPTION
094800*                       IS THAT THE "USE" STATEMENT IS ONLY
094900*                       EXECUTED WHEN AN INVALID KEY OR AT END
095000*                       CONDITION OCCURS AND THE INVALID KEY OR
095100*                       AT END PHRASE HAS NOT BEEN SPECIFIED.
095200*
095300 REL-WRITE-002.
095400     PERFORM  PRINT-DETAIL.
095500 REL-EXIT-002.
095600     EXIT.
095700 REL-INIT-003.
095800     OPEN     INPUT  RL-FD1.
095900     OPEN     INPUT  RL-FS2.
096000     PERFORM  BLANK-LINE-PRINT.
096100     MOVE     "THE FOLLOWING TESTS ACCESS A FILE DEFINE AS
096200-             "ACCESS MODE IS SEQUENTIAL"  TO PRINT-REC.
096300     PERFORM  WRITE-LINE.
096400     PERFORM  BLANK-LINE-PRINT.
096500     MOVE     "START  EQUAL TO"  TO FEATURE.
096600     MOVE     "REL-TEST-003"  TO PAR-NAME.
096700     MOVE     ZERO TO REC-CT.
096800     PERFORM  REL-INIT-003-R.
096900 REL-TEST-003-R1.
097000     ADD      00003   TO  WRK-RL-FS2-RECKEY.
097100     MOVE     WRK-RL-FS2-RECKEY TO RL-FS2-KEY.
097200     START    RL-FS2.
097300     READ     RL-FS2       RECORD  AT END
097400             ADD   010000  TO ERROR-COUNTER-06V00
097500              GO TO       REL-TEST-003-01.
097600     MOVE     RL-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
097700     PERFORM  REL-VERIFY-003A.
097800     IF       EXCUT-COUNTER-06V00  LESS THAN 10
097900              GO TO    REL-TEST-003-R1.
098000 REL-TEST-003-01.
098100     MOVE     01   TO REC-CT.
098200     PERFORM  REL-TEST-003.
098300*   .01
098400     GO TO    REL-EXIT-003-01.
098500 REL-DELETE-003-01.
098600     PERFORM  DE-LETE.
098700     PERFORM  REL-WRITE-003.
098800 REL-EXIT-003-01.
098900     EXIT.
099000 REL-INIT-003-R2.
099100     PERFORM  REL-INIT-003-R.
099200 REL-TEST-003-R2.
099300     ADD      00003   TO  WRK-RL-FS2-RECKEY.
099400     MOVE     WRK-RL-FS2-RECKEY TO RL-FS2-KEY.
099500     START    RL-FS2  KEY EQUAL TO RL-FS2-KEY.
099600     READ     RL-FS2       RECORD  AT END
099700             ADD   010000  TO ERROR-COUNTER-06V00
099800              GO TO       REL-TEST-003-02.
099900     MOVE     RL-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
100000     PERFORM  REL-VERIFY-003A.
100100     IF       EXCUT-COUNTER-06V00  LESS THAN 10
100200              GO TO    REL-TEST-003-R2.
100300 REL-TEST-003-02.
100400     MOVE     02   TO REC-CT.
100500     PERFORM  REL-TEST-003.
100600*   .02
100700     GO TO    REL-EXIT-003-02.
100800 REL-DELETE-003-02.
100900     MOVE     02  TO REC-CT.
101000     PERFORM  DE-LETE.
101100     PERFORM  REL-WRITE-003.
101200 REL-EXIT-003-02.
101300     EXIT.
101400 REL-INIT-003-R3.
101500     PERFORM  REL-INIT-003-R.
101600 REL-TEST-003-R3.
101700     ADD      00003   TO  WRK-RL-FS2-RECKEY.
101800     MOVE     WRK-RL-FS2-RECKEY TO RL-FS2-KEY.
101900     START    RL-FS2  KEY IS EQUAL TO  RL-FS2-KEY.
102000     READ     RL-FS2       RECORD  AT END
102100             ADD   010000  TO ERROR-COUNTER-06V00
102200              GO TO       REL-TEST-003-03.
102300     MOVE     RL-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
102400     PERFORM  REL-VERIFY-003A.
102500     IF       EXCUT-COUNTER-06V00  LESS THAN 10
102600              GO TO    REL-TEST-003-R3.
102700 REL-TEST-003-03.
102800     MOVE     03   TO REC-CT.
102900     PERFORM  REL-TEST-003.
103000*   .03
103100     GO TO    REL-EXIT-003-03.
103200 REL-DELETE-003-03.
103300     MOVE     03  TO REC-CT.
103400     PERFORM  DE-LETE.
103500     PERFORM  REL-WRITE-003.
103600 REL-EXIT-003-03.
103700     EXIT.
103800 REL-INIT-003-R4.
103900     PERFORM  REL-INIT-003-R.
104000 REL-TEST-003-R4.
104100     ADD     00003   TO  WRK-RL-FS2-RECKEY.
104200     MOVE    WRK-RL-FS2-RECKEY TO RL-FS2-KEY.
104300     START   RL-FS2  KEY IS EQUAL  RL-FS2-KEY.
104400     READ    RL-FS2       RECORD  AT END
104500             ADD   010000  TO ERROR-COUNTER-06V00
104600             GO TO       REL-TEST-003-04.
104700     MOVE    RL-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
104800     PERFORM REL-VERIFY-003A.
104900     IF      EXCUT-COUNTER-06V00  LESS THAN 10
105000             GO TO    REL-TEST-003-R4.
105100 REL-TEST-003-04.
105200     MOVE     04   TO REC-CT.
105300     PERFORM  REL-TEST-003.
105400*   .04
105500     GO TO    REL-EXIT-003-04.
105600 REL-DELETE-003-04.
105700     MOVE     04  TO REC-CT.
105800     PERFORM  DE-LETE.
105900     PERFORM  REL-WRITE-003.
106000 REL-EXIT-003-04.
106100     EXIT.
106200 REL-INIT-003-R5.
106300     PERFORM  REL-INIT-003-R.
106400 REL-TEST-003-R5.
106500     ADD      00003   TO  WRK-RL-FS2-RECKEY.
106600     MOVE     WRK-RL-FS2-RECKEY TO RL-FS2-KEY.
106700     START    RL-FS2  KEY IS  =  RL-FS2-KEY.
106800     READ     RL-FS2       RECORD  AT END
106900             ADD   010000  TO ERROR-COUNTER-06V00
107000              GO TO       REL-TEST-003-05.
107100     MOVE     RL-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
107200     PERFORM  REL-VERIFY-003A.
107300     IF       EXCUT-COUNTER-06V00  LESS THAN 10
107400              GO TO    REL-TEST-003-R5.
107500 REL-TEST-003-05.
107600     MOVE     05   TO REC-CT.
107700     PERFORM  REL-TEST-003.
107800*   .05
107900     GO TO    REL-EXIT-003-05.
108000 REL-DELETE-003-05.
108100     MOVE     05  TO REC-CT.
108200     PERFORM  DE-LETE.
108300     PERFORM  REL-WRITE-003.
108400 REL-EXIT-003-05.
108500     EXIT.
108600 REL-INIT-003-R6.
108700     PERFORM  REL-INIT-003-R.
108800     ADD      000001 TO LOGICAL-FILE-REC.
108900     MOVE     "START  GREATER THAN"  TO FEATURE.
109000 REL-TEST-003-R6.
109100     ADD      00003   TO  WRK-RL-FS2-RECKEY.
109200     MOVE     WRK-RL-FS2-RECKEY TO RL-FS2-KEY.
109300     START    RL-FS2  KEY IS GREATER THAN  RL-FS2-KEY.
109400     READ     RL-FS2       RECORD  AT END
109500             ADD   010000  TO ERROR-COUNTER-06V00
109600              GO TO       REL-TEST-003-06.
109700     MOVE     RL-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
109800     PERFORM  REL-VERIFY-003A.
109900     IF       EXCUT-COUNTER-06V00  LESS THAN 10
110000              GO TO    REL-TEST-003-R6.
110100 REL-TEST-003-06.
110200     MOVE     06   TO REC-CT.
110300     PERFORM  REL-TEST-003.
110400*   .06
110500     GO TO    REL-EXIT-003-06.
110600 REL-DELETE-003-06.
110700     MOVE     06  TO REC-CT.
110800     PERFORM  DE-LETE.
110900     PERFORM  REL-WRITE-003.
111000 REL-EXIT-003-06.
111100     EXIT.
111200 REL-INIT-003-R7.
111300     PERFORM  REL-INIT-003-R.
111400     ADD      000001 TO LOGICAL-FILE-REC.
111500 REL-TEST-003-R7.
111600     ADD      00003   TO  WRK-RL-FS2-RECKEY.
111700     MOVE     WRK-RL-FS2-RECKEY TO RL-FS2-KEY.
111800     START    RL-FS2  KEY GREATER THAN RL-FS2-KEY.
111900     READ     RL-FS2       RECORD  AT END
112000             ADD   010000  TO ERROR-COUNTER-06V00
112100              GO TO       REL-TEST-003-07.
112200     MOVE     RL-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
112300     PERFORM  REL-VERIFY-003A.
112400     IF       EXCUT-COUNTER-06V00  LESS THAN 10
112500              GO TO    REL-TEST-003-R7.
112600 REL-TEST-003-07.
112700     MOVE     07   TO REC-CT.
112800     PERFORM  REL-TEST-003.
112900*   .07
113000     GO TO    REL-EXIT-003-07.
113100 REL-DELETE-003-07.
113200     MOVE     07  TO REC-CT.
113300     PERFORM  DE-LETE.
113400     PERFORM  REL-WRITE-003.
113500 REL-EXIT-003-07.
113600     EXIT.
113700 REL-INIT-003-R8.
113800     PERFORM  REL-INIT-003-R.
113900     ADD      00001  TO LOGICAL-FILE-REC.
114000 REL-TEST-003-R8.
114100     ADD      00003   TO  WRK-RL-FS2-RECKEY.
114200     MOVE   WRK-RL-FS2-RECKEY TO RL-FS2-KEY.
114300     START   RL-FS2 KEY IS GREATER RL-FS2-KEY.
114400     READ     RL-FS2       RECORD  AT END
114500             ADD   010000  TO ERROR-COUNTER-06V00
114600              GO TO       REL-TEST-003-08.
114700     MOVE     RL-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
114800     PERFORM  REL-VERIFY-003A.
114900     IF       EXCUT-COUNTER-06V00  LESS THAN 10
115000              GO TO    REL-TEST-003-R8.
115100 REL-TEST-003-08.
115200     MOVE     08   TO REC-CT.
115300     PERFORM  REL-TEST-003.
115400*   .08
115500     GO TO    REL-EXIT-003-08.
115600 REL-DELETE-003-08.
115700     MOVE     08  TO REC-CT.
115800     PERFORM  DE-LETE.
115900     PERFORM  REL-WRITE-003.
116000 REL-EXIT-003-08.
116100     EXIT.
116200 REL-INIT-003-R9.
116300     PERFORM  REL-INIT-003-R.
116400     ADD    00001  TO LOGICAL-FILE-REC.
116500 REL-TEST-003-R9.
116600     ADD      00003   TO  WRK-RL-FS2-RECKEY.
116700     MOVE    WRK-RL-FS2-RECKEY TO RL-FS2-KEY.
116800     START   RL-FS2 KEY IS > RL-FS2-KEY.
116900     READ     RL-FS2       RECORD  AT END
117000             ADD   010000  TO ERROR-COUNTER-06V00
117100              GO TO       REL-TEST-003-09.
117200     MOVE     RL-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
117300     PERFORM   REL-VERIFY-003A.
117400     IF       EXCUT-COUNTER-06V00  LESS THAN 10
117500              GO TO REL-TEST-003-R9.
117600 REL-TEST-003-09.
117700     MOVE     09   TO REC-CT.
117800     PERFORM  REL-TEST-003.
117900*   .09
118000     GO TO    REL-EXIT-003-09.
118100 REL-DELETE-003-09.
118200     MOVE     09  TO REC-CT.
118300     PERFORM  DE-LETE.
118400     PERFORM  REL-WRITE-003.
118500 REL-EXIT-003-09.
118600     EXIT.
118700 REL-INIT-003-R10.
118800     PERFORM  REL-INIT-003-R.
118900     ADD     00001  TO LOGICAL-FILE-REC.
119000 REL-TEST-003-R10.
119100     ADD      00003   TO  WRK-RL-FS2-RECKEY.
119200     MOVE   WRK-RL-FS2-RECKEY TO RL-FS2-KEY.
119300     START   RL-FS2 KEY > RL-FS2-KEY.
119400     READ     RL-FS2       RECORD  AT END
119500             ADD   010000  TO ERROR-COUNTER-06V00
119600              GO TO       REL-TEST-003-10.
119700     MOVE     RL-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
119800     PERFORM  REL-VERIFY-003A.
119900     IF       EXCUT-COUNTER-06V00  LESS THAN 10
120000              GO TO    REL-TEST-003-R10.
120100 REL-TEST-003-10.
120200     MOVE     10   TO REC-CT.
120300     PERFORM  REL-TEST-003.
120400*   .10
120500     GO TO    REL-EXIT-003-10.
120600 REL-DELETE-003-10.
120700     MOVE     10  TO REC-CT.
120800     PERFORM  DE-LETE.
120900     PERFORM  REL-WRITE-003.
121000 REL-EXIT-003-10.
121100     EXIT.
121200 REL-INIT-003-R11.
121300     MOVE     "START  NOT LESS THAN" TO FEATURE.
121400     PERFORM  REL-INIT-003-R.
121500 REL-TEST-003-R11.
121600     ADD      00003   TO  WRK-RL-FS2-RECKEY.
121700     MOVE    WRK-RL-FS2-RECKEY TO RL-FS2-KEY.
121800     START   RL-FS2 KEY IS NOT LESS THAN RL-FS2-KEY.
121900     READ     RL-FS2       RECORD  AT END
122000             ADD   010000  TO ERROR-COUNTER-06V00
122100              GO TO       REL-TEST-003-11.
122200     MOVE     RL-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
122300     PERFORM  REL-VERIFY-003A.
122400     IF       EXCUT-COUNTER-06V00  LESS THAN 10
122500              GO TO    REL-TEST-003-R11.
122600 REL-TEST-003-11.
122700     MOVE     11   TO REC-CT.
122800     PERFORM  REL-TEST-003.
122900*   .11
123000     GO TO    REL-EXIT-003-11.
123100 REL-DELETE-003-11.
123200     MOVE     11  TO REC-CT.
123300     PERFORM  DE-LETE.
123400     PERFORM  REL-WRITE-003.
123500 REL-EXIT-003-11.
123600     EXIT.
123700 REL-INIT-003-R12.
123800     PERFORM  REL-INIT-003-R.
123900 REL-TEST-003-R12.
124000     ADD     0003 TO  WRK-RL-FS2-RECKEY.
124100     MOVE    WRK-RL-FS2-RECKEY TO RL-FS2-KEY.
124200     START  RL-FS2 KEY IS NOT LESS  RL-FS2-KEY.
124300     READ     RL-FS2       RECORD  AT END
124400             ADD   010000  TO ERROR-COUNTER-06V00
124500              GO TO       REL-TEST-003-12.
124600     MOVE     RL-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
124700     PERFORM  REL-VERIFY-003A.
124800     IF       EXCUT-COUNTER-06V00  LESS THAN 10
124900              GO TO    REL-TEST-003-R12.
125000 REL-TEST-003-12.
125100     MOVE     12   TO REC-CT.
125200     PERFORM  REL-TEST-003.
125300*   .12
125400     GO TO    REL-EXIT-003-12.
125500 REL-DELETE-003-12.
125600     MOVE     12  TO REC-CT.
125700     PERFORM  DE-LETE.
125800     PERFORM  REL-WRITE-003.
125900 REL-EXIT-003-12.
126000     EXIT.
126100 REL-INIT-003-R13.
126200     PERFORM  REL-INIT-003-R.
126300 REL-TEST-003-R13.
126400     ADD     003  TO  WRK-RL-FS2-RECKEY.
126500     MOVE    WRK-RL-FS2-RECKEY TO RL-FS2-KEY.
126600     START   RL-FS2  KEY NOT LESS THAN RL-FS2-KEY.
126700     READ     RL-FS2       RECORD  AT END
126800             ADD   010000  TO ERROR-COUNTER-06V00
126900              GO TO       REL-TEST-003-13.
127000     MOVE     RL-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
127100     PERFORM  REL-VERIFY-003A.
127200     IF       EXCUT-COUNTER-06V00  LESS THAN 10
127300              GO TO    REL-TEST-003-R13.
127400 REL-TEST-003-13.
127500     MOVE     13   TO REC-CT.
127600     PERFORM  REL-TEST-003.
127700*   .13
127800     GO TO    REL-EXIT-003-13.
127900 REL-DELETE-003-13.
128000     MOVE     13  TO REC-CT.
128100     PERFORM  DE-LETE.
128200     PERFORM  REL-WRITE-003.
128300 REL-EXIT-003-13.
128400     EXIT.
128500 REL-INIT-003-R14.
128600     PERFORM  REL-INIT-003-R.
128700 REL-TEST-003-R14.
128800     ADD    003 TO  WRK-RL-FS2-RECKEY.
128900     MOVE    WRK-RL-FS2-RECKEY TO RL-FS2-KEY.
129000     START   RL-FS2 KEY IS NOT  < RL-FS2-KEY.
129100     READ     RL-FS2       RECORD  AT END
129200             ADD   010000  TO ERROR-COUNTER-06V00
129300              GO TO       REL-TEST-003-14.
129400     MOVE     RL-FS2R1-F-G-240  TO  FILE-RECORD-INFO (2).
129500     PERFORM  REL-VERIFY-003A.
129600     IF       EXCUT-COUNTER-06V00  LESS THAN 10
129700              GO TO    REL-TEST-003-R14.
129800 REL-TEST-003-14.
129900     MOVE     14   TO REC-CT.
130000     PERFORM  REL-TEST-003.
130100*   .14
130200     GO TO    REL-EXIT-003-14.
130300 REL-DELETE-003-14.
130400     MOVE     14  TO REC-CT.
130500     PERFORM  DE-LETE.
130600     PERFORM  REL-WRITE-003.
130700 REL-EXIT-003-14.
130800     EXIT.
130900 REL-INIT-003-R15.
131000     PERFORM  BLANK-LINE-PRINT.
131100     MOVE     "THE FOLLOWING TESTS ACCESS A FILE DEFINED AS
131200-             "ACCESS MODE IS DYNAMIC"  TO PRINT-REC.
131300     PERFORM  WRITE-LINE.
131400     PERFORM  BLANK-LINE-PRINT.
131500     MOVE     "START  EQUAL TO " TO FEATURE.
131600     PERFORM  REL-INIT-003-R.
131700 REL-TEST-003-R15.
131800     ADD     0002 TO WRK-RL-FD1-RECKEY.
131900     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
132000     START   RL-FD1 KEY IS EQUAL TO RL-FD1-KEY INVALID KEY
132100               ADD 010000  TO ERROR-COUNTER-06V00.
132200     READ     RL-FD1  NEXT RECORD  AT END
132300              ADD   010000  TO ERROR-COUNTER-06V00
132400              GO TO       REL-TEST-003-15.
132500     MOVE     RL-FD1R1-F-G-240  TO  FILE-RECORD-INFO (1).
132600     PERFORM  REL-VERIFY-003B.
132700     IF       EXCUT-COUNTER-06V00  LESS THAN 10
132800              GO TO    REL-TEST-003-R15.
132900 REL-TEST-003-15.
133000     MOVE     15   TO REC-CT.
133100     PERFORM  REL-TEST-003.
133200*   .15
133300     GO TO    REL-EXIT-003-15.
133400 REL-DELETE-003-15.
133500     MOVE     15  TO REC-CT.
133600     PERFORM  DE-LETE.
133700     PERFORM  REL-WRITE-003.
133800 REL-EXIT-003-15.
133900     EXIT.
134000 REL-INIT-003-R16.
134100     MOVE     "START  INVALID KEY"  TO FEATURE.
134200     PERFORM  REL-INIT-003-R.
134300     MOVE    RL-FD1-FILESIZE TO WRK-RL-FD1-RECKEY.
134400     MOVE     RL-FD1-FILESIZE  TO  LOGICAL-FILE-REC.
134500 REL-TEST-003-R16.
134600     ADD    0002  TO WRK-RL-FD1-RECKEY.
134700     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
134800     START   RL-FD1 KEY IS EQUAL TO RL-FD1-KEY INVALID
134900              SUBTRACT   000001  FROM ERROR-COUNTER-06V00.
135000     ADD      000001 TO EXCUT-COUNTER-06V00.
135100     IF       EXCUT-COUNTER-06V00  LESS THAN 10
135200              GO TO    REL-TEST-003-R16.
135300 REL-TEST-003-16.
135400     MOVE     16   TO REC-CT.
135500     PERFORM  REL-TEST-003.
135600*   .16
135700     GO TO    REL-EXIT-003-16.
135800 REL-DELETE-003-16.
135900     MOVE     16  TO REC-CT.
136000     PERFORM  DE-LETE.
136100     PERFORM  REL-WRITE-003.
136200 REL-EXIT-003-16.
136300     EXIT.
136400 REL-INIT-003-R17.
136500     PERFORM  REL-INIT-003-R.
136600     MOVE     RL-FD1-FILESIZE  TO  LOGICAL-FILE-REC.
136700     MOVE     RL-FD1-FILESIZE  TO  WRK-RL-FD1-RECKEY.
136800 REL-TEST-003-R17.
136900     ADD      00003   TO WRK-RL-FD1-RECKEY.
137000     MOVE     WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
137100     START    RL-FD1   INVALID KEY
137200              SUBTRACT   000001  FROM ERROR-COUNTER-06V00.
137300     ADD      000001 TO EXCUT-COUNTER-06V00.
137400     IF       EXCUT-COUNTER-06V00  LESS THAN 10
137500              GO TO    REL-TEST-003-R17.
137600 REL-TEST-003-17.
137700     MOVE     17   TO REC-CT.
137800     PERFORM  REL-TEST-003.
137900*   .17
138000     GO TO    REL-EXIT-003-17.
138100 REL-DELETE-003-17.
138200     MOVE     17  TO REC-CT.
138300     PERFORM  DE-LETE.
138400     PERFORM  REL-WRITE-003.
138500 REL-EXIT-003-17.
138600     EXIT.
138700 REL-INIT-003-R18.
138800     PERFORM  REL-INIT-003-R.
138900     MOVE     RL-FD1-FILESIZE  TO  LOGICAL-FILE-REC.
139000     MOVE     RL-FD1-FILESIZE  TO  WRK-RL-FD1-RECKEY.
139100 REL-TEST-003-R18.
139200     ADD      00003   TO WRK-RL-FD1-RECKEY.
139300     MOVE     WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
139400     START    RL-FD1  ; INVALID KEY
139500              SUBTRACT   000001  FROM ERROR-COUNTER-06V00.
139600     ADD      000001 TO EXCUT-COUNTER-06V00.
139700     IF       EXCUT-COUNTER-06V00  LESS THAN 10
139800              GO TO    REL-TEST-003-R18.
139900 REL-TEST-003-18.
140000     MOVE     18   TO REC-CT.
140100     PERFORM  REL-TEST-003.
140200*   .18
140300     GO TO    REL-EXIT-003-18.
140400 REL-DELETE-003-18.
140500     MOVE     18  TO REC-CT.
140600     PERFORM  DE-LETE.
140700     PERFORM  REL-WRITE-003.
140800 REL-EXIT-003-18.
140900     EXIT.
141000 REL-INIT-003-R19.
141100     PERFORM  REL-INIT-003-R.
141200     MOVE     RL-FD1-FILESIZE  TO  WRK-RL-FD1-RECKEY.
141300     MOVE     WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
141400 REL-TEST-003-R19.
141500     ADD      000002  TO WRK-RL-FD1-RECKEY.
141600     MOVE     WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
141700     START    RL-FD1 KEY IS EQUAL TO  RL-FD1-KEY ; INVALID KEY
141800              SUBTRACT   000001  FROM ERROR-COUNTER-06V00.
141900     ADD      000001  TO EXCUT-COUNTER-06V00.
142000     IF       EXCUT-COUNTER-06V00  LESS THAN 10
142100              GO TO    REL-TEST-003-R19.
142200 REL-TEST-003-19.
142300     MOVE     19   TO REC-CT.
142400     PERFORM  REL-TEST-003.
142500*   .19
142600     GO TO    REL-END-003.
142700 REL-DELETE-003-19.
142800     MOVE     19  TO REC-CT.
142900     PERFORM  DE-LETE.
143000     PERFORM  REL-WRITE-003.
143100 REL-EXIT-003-19.
143200     EXIT.
143300 REL-INIT-003-R.
143400     MOVE     ZERO TO LOGICAL-FILE-REC.
143500     MOVE     ZERO TO EXCUT-COUNTER-06V00.
143600     MOVE     00055  TO WRK-DU-05V00-002.
143700     MOVE     00050  TO WRK-DU-05V00-004.
143800     MOVE     ZERO TO  WRK-RL-FS2-RECKEY.
143900     MOVE    ZERO TO WRK-RL-FD1-RECKEY.
144000     MOVE     10  TO ERROR-COUNTER-06V00.
144100 REL-VERIFY-003A.
144200     IF       ASCEND
144300              ADD    000003  TO LOGICAL-FILE-REC
144400              ELSE
144500              SUBTRACT   000003  FROM  LOGICAL-FILE-REC.
144600     IF       LOGICAL-FILE-REC  EQUAL  TO XRECORD-NUMBER (2)
144700              SUBTRACT   000001  FROM ERROR-COUNTER-06V00.
144800     ADD      000001 TO EXCUT-COUNTER-06V00.
144900 REL-VERIFY-003B.
145000     IF       ASCEND
145100              ADD    000002  TO LOGICAL-FILE-REC
145200              ELSE
145300              SUBTRACT   000002  FROM  LOGICAL-FILE-REC.
145400     IF       LOGICAL-FILE-REC  EQUAL  TO XRECORD-NUMBER (1)
145500              SUBTRACT   000001  FROM ERROR-COUNTER-06V00.
145600     ADD      000001 TO EXCUT-COUNTER-06V00.
145700 REL-TEST-003.
145800     IF       EXCUT-COUNTER-06V00  NOT EQUAL  TO 000010
145900              MULTIPLY  100  BY   EXCUT-COUNTER-06V00
146000              ADD  EXCUT-COUNTER-06V00 TO ERROR-COUNTER-06V00.
146100     IF       ERROR-COUNTER-06V00 EQUAL TO ZERO
146200              PERFORM PASS
146300              ELSE
146400              PERFORM   FAIL
146500              MOVE   ZERO  TO CORRECT-N
146600              MOVE     ERROR-COUNTER-06V00  TO COMPUTED-N
146700              MOVE    "SEE PARA. - REL-TEST-003"  TO RE-MARK.
146800     PERFORM   REL-WRITE-003.
146900*
147000*       EACH TEST IS EXECUTED 10 TIMES.  FOLLOWING THE 10TH
147100*    EXECUTION A TEST IS MADE ON ERROR-COUNTER-06V00 WHICH IS
147200*    EXPECTED TO BE ZERO.  IF ERROR-COUNTER-06V00 IS NOT ZERO
147300*    THE VALUE IN THE COUNTER INDICATES HOW THE EXECUTION FAILED
147400*    AND THE NUMBER OF TIMES THE UNEXPECTED ACTION OCCURRED
147500*    DURING THE TEST.  BEFORE THE TEST BEGINS ERROR-COUNTER-06V00
147600*    IS LOADED WITH THE VALUE 10.  EACH TIME THE CORRECT RECORD
147700*    WAS MADE AVAILABLE FOLLOWING THE READ, OR AN INVALID KEY
147800*    CONDITION OCCURRED THAT WAS EXPECTED FOLLOWING A READ OR
147900*    START, ERROR-COUNTER-06V00 IS DECREMENTED BY 1.
148000*    FOR EACH ACTION THAT DID NOT OCCUR AS
148100*    EXPECTED THE ERROR-COUNTER-06V00 IS INCREMENTED BY THE VALUE
148200*    FOR THE ACTION LISTED BELOW, E.G., VALUE 20003 WOULD INDICATE
148300*    THAT OF THE 10 EXECUTIONS DURING THE TEST (READING LEFT TO
148400*    RIGHT)  2 INVALID KEY CONDITIONS AND 3 RECORDS RETRIEVED
148500*    AS A RESULT OF THE READ OR START WAS NOT AS EXPECTED.
148600*
148700*    COMPUTED RESULT                 INDICATED
148800*       INCREMENTS                     ACTION
148900*
149000*       000001          THE RECORD RETREIVED FROM THE FILE
149100*                       FOLLOWING THE READ WAS NOT THE ONE
149200*                       EXPECTED.
149300*
149400*       000100          INDICATES,BY 10"S THE NUMBER OF TIMES THE
149500*                       TEST WAS EXECUTED.
149600*
149700*       010000          AN UNEXPECTED INVALID KEY OR AT END
149800*                       CONDITION OCCURRED.  NOTE - ASSUMPTION
149900*                       IS THAT THE "USE" STATEMENT IS ONLY
150000*                       EXECUTED WHEN AN INVALID KEY OR AT END
150100*                       CONDITION OCCURS AND THE INVALID KEY OR
150200*                       AT END PHRASE HAS NOT BEEN SPECIFIED.
150300*
150400 REL-WRITE-003.
150500     PERFORM  PRINT-DETAIL.
150600 REL-END-003.
150700     CLOSE   RL-FD1.
150800     CLOSE   RL-FS2.
150900 REL-EXIT-003.
151000     EXIT.
151100*
151200*    THE FOLLOWING SECTION CONTAINS ALL THE NEW TESTS FOR 8X:
151300*
151400 NEW-COBOL-8X-TESTS SECTION.
151500*==========================
151600 REL-8X-INIT-1.
151700     MOVE   "XVII-70 2.2.37" TO ANSI-REFERENCE.
151800     MOVE   "REL-8X-TEST-1"  TO PAR-NAME.
151900     OPEN    I-O RL-FD1.
152000* DELETE THE NEXT LINE TO DELETE THE TEST
152100*    GO TO REL-8X-INIT-1-BETA.
152200 REL-8X-INIT-1-ALPHA.
152300     GO TO REL-8X-DELETE-1.
152400 REL-8X-INIT-1-BETA.
152500     MOVE    LOW-VALUES TO WRK-RL-FD1-RECKEY-CHAR.
152600     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
152700     MOVE    301 TO RECORDS-IN-FILE (1).
152800     MOVE    FILE-RECORD-INFO (1) TO RL-FD1R1-F-G-240.
152900     WRITE   RL-FD1R1-F-G-240
153000             INVALID KEY
153100                 MOVE  "INVALID KEY ON WRITING NEW 1ST RECORD"
153200                     TO RE-MARK
153300                 PERFORM FAIL
153400                 PERFORM PRINT-DETAIL
153500                 GO TO   REL-8X-INIT-2.
153600     MOVE    302 TO RECORDS-IN-FILE (1).
153700     MOVE    FILE-RECORD-INFO (1) TO RL-FD1R1-F-G-240.
153800     MOVE    ZERO TO RL-FD1-KEY.
153900     WRITE   RL-FD1R1-F-G-240
154000             INVALID KEY
154100                 MOVE   "INVALID KEY ON WRITING NEW 2ND RECORD"
154200                      TO RE-MARK
154300                 PERFORM FAIL
154400                 PERFORM PRINT-DETAIL
154500                 GO TO   REL-8X-INIT-2.
154600     MOVE    SPACES TO FILE-RECORD-INFO (1).
154700     GO TO   REL-8X-TEST-1-0.
154800 REL-8X-DELETE-1.
154900     PERFORM DE-LETE.
155000     PERFORM PRINT-DETAIL.
155100     GO TO   REL-8X-INIT-2.
155200 REL-8X-TEST-1-0.
155300     READ    RL-FD1 INTO FILE-RECORD-INFO (1).
155400 REL-8X-TEST-1-1.
155500     IF      RECORDS-IN-FILE (1) = 301
155600             PERFORM PASS
155700             GO TO   REL-8X-WRITE-1.
155800     MOVE   "FIRST RECORD JUST INSERTED NOT FOUND" TO RE-MARK.
155900     PERFORM FAIL.
156000 REL-8X-WRITE-1.
156100     PERFORM PRINT-DETAIL.
156200*
156300 REL-8X-INIT-2.
156400     MOVE   "VIII-33 4.7.2"  TO ANSI-REFERENCE.
156500     MOVE   "REL-8X-TEST-2"  TO PAR-NAME.
156600     OPEN    I-O RL-FS2.
156700     MOVE    123 TO WRK-RL-FS2-RECKEY.
156800     MOVE    WRK-RL-FS2-RECKEY TO RL-FS2-KEY.
156900     MOVE    SPACES TO FILE-RECORD-INFO (1).
157000     GO TO   REL-8X-TEST-2-0.
157100 REL-8X-DELETE-2.
157200     PERFORM DE-LETE.
157300     PERFORM PRINT-DETAIL.
157400     GO TO   REL-8X-INIT-3.
157500 REL-8X-TEST-2-0.
157600     START   RL-FS2
157700             KEY IS GREATER THAN OR EQUAL TO RL-FS2-KEY.
157800     READ    RL-FS2  NEXT    INTO FILE-RECORD-INFO (1)
157900             AT END  MOVE "AT END ENCOUNTERED" TO RE-MARK
158000                     PERFORM FAIL
158100                     PERFORM PRINT-DETAIL
158200                     GO TO   REL-8X-INIT-3.
158300 REL-8X-TEST-2-1.
158400     IF      XRECORD-NUMBER (1) < 123
158500             MOVE   "RECORD NUMBER LESS THAN RELATIVE KEY"
158600                  TO RE-MARK
158700             MOVE    123 TO CORRECT-N
158800             MOVE    XRECORD-NUMBER (1) TO COMPUTED-N
158900             PERFORM FAIL
159000             PERFORM PRINT-DETAIL
159100     ELSE
159200             PERFORM PASS
159300             PERFORM PRINT-DETAIL.
159400*
159500 REL-8X-INIT-3.
159600     MOVE   "VIII-33 4.7.2"  TO ANSI-REFERENCE.
159700     MOVE   "REL-8X-TEST-3"  TO PAR-NAME.
159800     MOVE    154 TO WRK-RL-FS2-RECKEY.
159900     MOVE    WRK-RL-FS2-RECKEY TO RL-FS2-KEY.
160000     MOVE    SPACES TO FILE-RECORD-INFO (1).
160100     GO TO   REL-8X-TEST-3-0.
160200 REL-8X-DELETE-3.
160300     PERFORM DE-LETE.
160400     PERFORM PRINT-DETAIL.
160500     GO TO   REL-8X-INIT-4.
160600 REL-8X-TEST-3-0.
160700     START   RL-FS2
160800             KEY GREATER OR EQUAL TO RL-FS2-KEY.
160900     READ    RL-FS2  NEXT    INTO FILE-RECORD-INFO (1)
161000             AT END  MOVE "AT END ENCOUNTERED" TO RE-MARK
161100                     PERFORM FAIL
161200                     PERFORM PRINT-DETAIL
161300                     GO TO   REL-8X-INIT-4.
161400 REL-8X-TEST-3-1.
161500     IF      XRECORD-NUMBER (1) < 154
161600             MOVE   "RECORD NUMBER LESS THAN RELATIVE KEY"
161700                  TO RE-MARK
161800             MOVE    154 TO CORRECT-N
161900             MOVE    XRECORD-NUMBER (1) TO COMPUTED-N
162000             PERFORM FAIL
162100             PERFORM PRINT-DETAIL
162200     ELSE
162300             PERFORM PASS
162400             PERFORM PRINT-DETAIL.
162500*
162600 REL-8X-INIT-4.
162700     MOVE   "VIII-33 4.7.2"  TO ANSI-REFERENCE.
162800     MOVE   "REL-8X-TEST-4"  TO PAR-NAME.
162900     MOVE    226 TO WRK-RL-FS2-RECKEY.
163000     MOVE    WRK-RL-FS2-RECKEY TO RL-FS2-KEY.
163100     MOVE    SPACES TO FILE-RECORD-INFO (1).
163200     GO TO   REL-8X-TEST-4-0.
163300 REL-8X-DELETE-4.
163400     PERFORM DE-LETE.
163500     PERFORM PRINT-DETAIL.
163600     GO TO   REL-8X-INIT-5.
163700 REL-8X-TEST-4-0.
163800     START   RL-FS2
163900             KEY IS >= RL-FS2-KEY.
164000     READ    RL-FS2  NEXT    INTO FILE-RECORD-INFO (1)
164100             AT END  MOVE "AT END ENCOUNTERED" TO RE-MARK
164200                     PERFORM FAIL
164300                     PERFORM PRINT-DETAIL
164400                     GO TO   REL-8X-INIT-5.
164500 REL-8X-TEST-4-1.
164600     IF      XRECORD-NUMBER (1) < 226
164700             MOVE   "RECORD NUMBER LESS THAN RELATIVE KEY"
164800                  TO RE-MARK
164900             MOVE    226 TO CORRECT-N
165000             MOVE    XRECORD-NUMBER (1) TO COMPUTED-N
165100             PERFORM FAIL
165200             PERFORM PRINT-DETAIL
165300     ELSE
165400             PERFORM PASS
165500             PERFORM PRINT-DETAIL.
165600*
165700 REL-8X-INIT-5.
165800     MOVE   "VIII-33 4.7.2"  TO ANSI-REFERENCE.
165900     MOVE   "REL-8X-TEST-5"  TO PAR-NAME.
166000     MOVE    300 TO WRK-RL-FS2-RECKEY.
166100     MOVE    WRK-RL-FS2-RECKEY TO RL-FS2-KEY.
166200     MOVE    SPACES TO FILE-RECORD-INFO (1).
166300     GO TO   REL-8X-TEST-5-0.
166400 REL-8X-DELETE-5.
166500     PERFORM DE-LETE.
166600     PERFORM PRINT-DETAIL.
166700     GO TO   REL-8X-INIT-6.
166800 REL-8X-TEST-5-0.
166900     START   RL-FS2
167000             KEY >=  RL-FS2-KEY.
167100     READ    RL-FS2  NEXT    INTO FILE-RECORD-INFO (1)
167200             AT END  MOVE "AT END ENCOUNTERED" TO RE-MARK
167300                     PERFORM FAIL
167400                     PERFORM PRINT-DETAIL
167500                     GO TO   REL-8X-INIT-6.
167600 REL-8X-TEST-5-1.
167700     IF      XRECORD-NUMBER (1) < 300
167800             MOVE   "RECORD NUMBER LESS THAN RELATIVE KEY"
167900                  TO RE-MARK
168000             MOVE    300 TO CORRECT-N
168100             MOVE    XRECORD-NUMBER (1) TO COMPUTED-N
168200             PERFORM FAIL
168300             PERFORM PRINT-DETAIL
168400     ELSE
168500             PERFORM PASS
168600             PERFORM PRINT-DETAIL.
168700*
168800 REL-8X-INIT-6.
168900     MOVE   "VIII-33 4.7.2"  TO ANSI-REFERENCE.
169000     MOVE   "REL-8X-TEST-6"  TO PAR-NAME.
169100     MOVE    123 TO WRK-RL-FD1-RECKEY.
169200     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
169300     MOVE    SPACES TO FILE-RECORD-INFO (1).
169400     MOVE    SPACE  TO WRK-XN-00001.
169500     MOVE    1 TO REC-CT.
169600     GO TO   REL-8X-TEST-6-0.
169700 REL-8X-DELETE-6.
169800     PERFORM DE-LETE.
169900     PERFORM PRINT-DETAIL.
170000     GO TO   REL-8X-INIT-7.
170100 REL-8X-TEST-6-0.
170200     START   RL-FD1
170300             KEY IS GREATER THAN OR EQUAL TO RL-FD1-KEY
170400             NOT INVALID KEY
170500                 MOVE "A" TO WRK-XN-00001.
170600 REL-8X-TEST-6-1.
170700     IF      WRK-XN-00001 NOT = "A"
170800             MOVE   "NOT INVALID KEY DID NOT EXECUTE"
170900                  TO RE-MARK
171000             MOVE   "A"  TO CORRECT-X
171100             MOVE    WRK-XN-00001 TO COMPUTED-X
171200             PERFORM FAIL
171300             PERFORM PRINT-DETAIL
171400     ELSE
171500             PERFORM PASS
171600             PERFORM PRINT-DETAIL.
171700     ADD     1 TO REC-CT.
171800 REL-8X-TEST-6-2.
171900     MOVE   "REL-8X-TEST-6-2" TO PAR-NAME.
172000     READ    RL-FD1  INTO FILE-RECORD-INFO (1).
172100     IF      XRECORD-NUMBER (1) < 123
172200             MOVE   "RECORD NUMBER LESS THAN RELATIVE KEY"
172300                  TO RE-MARK
172400             PERFORM FAIL
172500             PERFORM PRINT-DETAIL
172600     ELSE
172700             PERFORM PASS
172800             PERFORM PRINT-DETAIL.
172900*
173000 REL-8X-INIT-7.
173100     MOVE   "VIII-33 4.7.2"  TO ANSI-REFERENCE.
173200     MOVE   "REL-8X-TEST-7"  TO PAR-NAME.
173300     MOVE    154 TO WRK-RL-FD1-RECKEY.
173400     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
173500     MOVE    SPACES TO FILE-RECORD-INFO (1).
173600     MOVE    SPACE  TO WRK-XN-00001.
173700     MOVE    1 TO REC-CT.
173800     GO TO   REL-8X-TEST-7-0.
173900 REL-8X-DELETE-7.
174000     PERFORM DE-LETE.
174100     PERFORM PRINT-DETAIL.
174200     GO TO   REL-8X-INIT-8.
174300 REL-8X-TEST-7-0.
174400     START   RL-FD1
174500             KEY GREATER OR EQUAL TO RL-FD1-KEY
174600             NOT INVALID KEY
174700                 MOVE "A" TO WRK-XN-00001.
174800 REL-8X-TEST-7-1.
174900     IF      WRK-XN-00001 NOT = "A"
175000             MOVE   "NOT INVALID KEY DID NOT EXECUTE"
175100                  TO RE-MARK
175200             MOVE   "A"  TO CORRECT-X
175300             MOVE    WRK-XN-00001 TO COMPUTED-X
175400             PERFORM FAIL
175500             PERFORM PRINT-DETAIL
175600     ELSE
175700             PERFORM PASS
175800             PERFORM PRINT-DETAIL.
175900     ADD     1 TO REC-CT.
176000 REL-8X-TEST-7-2.
176100     MOVE   "REL-8X-TEST-7-2" TO PAR-NAME.
176200     READ    RL-FD1  INTO FILE-RECORD-INFO (1).
176300     IF      XRECORD-NUMBER (1) < 154
176400             MOVE   "RECORD NUMBER LESS THAN RELATIVE KEY"
176500                  TO RE-MARK
176600             MOVE    154 TO CORRECT-N
176700             MOVE    XRECORD-NUMBER (1) TO COMPUTED-N
176800             PERFORM FAIL
176900             PERFORM PRINT-DETAIL
177000     ELSE
177100             PERFORM PASS
177200             PERFORM PRINT-DETAIL.
177300*
177400 REL-8X-INIT-8.
177500     MOVE   "VIII-33 4.7.2"  TO ANSI-REFERENCE.
177600     MOVE   "REL-8X-TEST-8"  TO PAR-NAME.
177700     MOVE    226 TO WRK-RL-FD1-RECKEY.
177800     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
177900     MOVE    SPACES TO FILE-RECORD-INFO (1).
178000     MOVE    SPACE  TO WRK-XN-00001.
178100     MOVE    1 TO REC-CT.
178200     GO TO   REL-8X-TEST-8-0.
178300 REL-8X-DELETE-8.
178400     PERFORM DE-LETE.
178500     PERFORM PRINT-DETAIL.
178600     GO TO   REL-8X-INIT-9.
178700 REL-8X-TEST-8-0.
178800     START   RL-FD1
178900             KEY IS >= RL-FD1-KEY
179000             NOT INVALID KEY
179100                 MOVE "A" TO WRK-XN-00001.
179200 REL-8X-TEST-8-1.
179300     IF      WRK-XN-00001 NOT = "A"
179400             MOVE   "NOT INVALID KEY DID NOT EXECUTE"
179500                  TO RE-MARK
179600             MOVE   "A"  TO CORRECT-X
179700             MOVE    WRK-XN-00001 TO COMPUTED-X
179800             PERFORM FAIL
179900             PERFORM PRINT-DETAIL
180000     ELSE
180100             PERFORM PASS
180200             PERFORM PRINT-DETAIL.
180300     ADD     1 TO REC-CT.
180400 REL-8X-TEST-8-2.
180500     MOVE   "REL-8X-TEST-8-2" TO PAR-NAME.
180600     READ    RL-FD1  INTO FILE-RECORD-INFO (1).
180700     IF      XRECORD-NUMBER (1) < 226
180800             MOVE   "RECORD NUMBER LESS THAN RELATIVE KEY"
180900                  TO RE-MARK
181000             MOVE    226 TO CORRECT-N
181100             MOVE    XRECORD-NUMBER (1) TO COMPUTED-N
181200             PERFORM FAIL
181300             PERFORM PRINT-DETAIL
181400     ELSE
181500             PERFORM PASS
181600             PERFORM PRINT-DETAIL.
181700*
181800 REL-8X-INIT-9.
181900     MOVE   "VIII-33 4.7.2"  TO ANSI-REFERENCE.
182000     MOVE   "REL-8X-TEST-9"  TO PAR-NAME.
182100     MOVE    300 TO WRK-RL-FD1-RECKEY.
182200     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
182300     MOVE    SPACES TO FILE-RECORD-INFO (1).
182400     MOVE    SPACE  TO WRK-XN-00001.
182500     MOVE    1 TO REC-CT.
182600     GO TO   REL-8X-TEST-9-0.
182700 REL-8X-DELETE-9.
182800     PERFORM DE-LETE.
182900     PERFORM PRINT-DETAIL.
183000     GO TO   REL-8X-INIT-10.
183100 REL-8X-TEST-9-0.
183200     START   RL-FD1
183300             KEY >= RL-FD1-KEY
183400             NOT INVALID KEY
183500                 MOVE "A" TO WRK-XN-00001.
183600 REL-8X-TEST-9-1.
183700     IF      WRK-XN-00001 NOT = "A"
183800             MOVE   "NOT INVALID KEY DID NOT EXECUTE"
183900                  TO RE-MARK
184000             MOVE   "A"  TO CORRECT-X
184100             MOVE    WRK-XN-00001 TO COMPUTED-X
184200             PERFORM FAIL
184300             PERFORM PRINT-DETAIL
184400     ELSE
184500             PERFORM PASS
184600             PERFORM PRINT-DETAIL.
184700     ADD     1 TO REC-CT.
184800 REL-8X-TEST-9-2.
184900     MOVE   "REL-8X-TEST-9-2" TO PAR-NAME.
185000     READ    RL-FD1  INTO FILE-RECORD-INFO (1).
185100     IF      XRECORD-NUMBER (1) < 300
185200             MOVE   "RECORD NUMBER LESS THAN RELATIVE KEY"
185300                  TO RE-MARK
185400             MOVE    300 TO CORRECT-N
185500             MOVE    XRECORD-NUMBER (1) TO COMPUTED-N
185600             PERFORM FAIL
185700             PERFORM PRINT-DETAIL
185800     ELSE
185900             PERFORM PASS
186000             PERFORM PRINT-DETAIL.
186100*
186200 REL-8X-INIT-10.
186300     MOVE   "VIII-33 4.7.2 (GR7)"  TO ANSI-REFERENCE.
186400     MOVE   "REL-8X-TEST-10"  TO PAR-NAME.
186500     MOVE    200 TO WRK-RL-FD1-RECKEY.
186600     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
186700     MOVE    SPACES TO FILE-RECORD-INFO (1).
186800     MOVE    SPACE  TO WRK-XN-00001.
186900     MOVE    1 TO REC-CT.
187000     GO TO   REL-8X-TEST-10-0.
187100 REL-8X-DELETE-10.
187200     PERFORM DE-LETE.
187300     PERFORM PRINT-DETAIL.
187400     GO TO   REL-8X-INIT-11.
187500 REL-8X-TEST-10-0.
187600     START   RL-FD1
187700             KEY >= RL-FD1-KEY
187800                 INVALID KEY
187900                 MOVE "A" TO WRK-XN-00001.
188000 REL-8X-TEST-10-1.
188100     IF      WRK-XN-00001 NOT = SPACE
188200             MOVE   "INVALID KEY SHOULD NOT EXECUTE"
188300                  TO RE-MARK
188400             MOVE    SPACE TO CORRECT-X
188500             MOVE    WRK-XN-00001 TO COMPUTED-X
188600             PERFORM FAIL
188700             PERFORM PRINT-DETAIL
188800     ELSE
188900             PERFORM PASS
189000             PERFORM PRINT-DETAIL.
189100     ADD     1 TO REC-CT.
189200 REL-8X-TEST-10-2.
189300     MOVE   "REL-8X-TEST-10-2" TO PAR-NAME.
189400     READ    RL-FD1  INTO FILE-RECORD-INFO (1).
189500     IF      XRECORD-NUMBER (1) < 200
189600             MOVE   "RECORD NUMBER LESS THAN RELATIVE KEY"
189700                  TO RE-MARK
189800             MOVE    200 TO CORRECT-N
189900             MOVE    XRECORD-NUMBER (1) TO COMPUTED-N
190000             PERFORM FAIL
190100             PERFORM PRINT-DETAIL
190200     ELSE
190300             PERFORM PASS
190400             PERFORM PRINT-DETAIL.
190500*
190600 REL-8X-INIT-11.
190700     MOVE   "VIII-33 4.7.2 (GR7)"  TO ANSI-REFERENCE.
190800     MOVE   "REL-8X-TEST-11"  TO PAR-NAME.
190900     MOVE    555 TO WRK-RL-FD1-RECKEY.
191000     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
191100     MOVE    SPACES TO FILE-RECORD-INFO (1).
191200     MOVE    SPACE  TO WRK-XN-00001.
191300     MOVE    1 TO REC-CT.
191400     GO TO   REL-8X-TEST-11-0.
191500 REL-8X-DELETE-11.
191600     PERFORM DE-LETE.
191700     PERFORM PRINT-DETAIL.
191800     GO TO   REL-8X-INIT-12.
191900 REL-8X-TEST-11-0.
192000     START   RL-FD1
192100             KEY >=  RL-FD1-KEY
192200                 INVALID KEY
192300                 MOVE "A" TO WRK-XN-00001.
192400 REL-8X-TEST-11-1.
192500     IF      WRK-XN-00001 NOT = "A"
192600             MOVE   "INVALID KEY SHOULD HAVE EXECUTED"
192700                  TO RE-MARK
192800             MOVE   "A" TO CORRECT-X
192900             MOVE    WRK-XN-00001 TO COMPUTED-X
193000             PERFORM FAIL
193100             PERFORM PRINT-DETAIL
193200     ELSE
193300             PERFORM PASS
193400             PERFORM PRINT-DETAIL.
193500*
193600 REL-8X-INIT-12.
193700     MOVE   "VIII-33 4.7.2 (GR7)"  TO ANSI-REFERENCE.
193800     MOVE   "REL-8X-TEST-12"  TO PAR-NAME.
193900     MOVE    027 TO WRK-RL-FD1-RECKEY.
194000     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
194100     MOVE    SPACES TO FILE-RECORD-INFO (1).
194200     MOVE    SPACE  TO WRK-XN-00001.
194300     MOVE    1 TO REC-CT.
194400     GO TO   REL-8X-TEST-12-0.
194500 REL-8X-DELETE-12.
194600     PERFORM DE-LETE.
194700     PERFORM PRINT-DETAIL.
194800     GO TO   REL-8X-INIT-13.
194900 REL-8X-TEST-12-0.
195000     START   RL-FD1
195100             KEY >= RL-FD1-KEY
195200             NOT INVALID KEY
195300                 MOVE "A" TO WRK-XN-00001.
195400 REL-8X-TEST-12-1.
195500     IF      WRK-XN-00001 NOT = "A"
195600             MOVE   "NOT INVALID KEY SHOULD HAVE EXECUTED"
195700                  TO RE-MARK
195800             MOVE   "A" TO CORRECT-X
195900             MOVE    WRK-XN-00001 TO COMPUTED-X
196000             PERFORM FAIL
196100             PERFORM PRINT-DETAIL
196200     ELSE
196300             PERFORM PASS
196400             PERFORM PRINT-DETAIL.
196500     ADD     1 TO REC-CT.
196600 REL-8X-TEST-12-2.
196700     MOVE   "REL-8X-TEST-12-2" TO PAR-NAME.
196800     READ    RL-FD1  INTO FILE-RECORD-INFO (1).
196900     IF      XRECORD-NUMBER (1) < 27
197000             MOVE   "RECORD NUMBER LESS THAN RELATIVE KEY"
197100                  TO RE-MARK
197200             MOVE    27 TO CORRECT-N
197300             MOVE    XRECORD-NUMBER (1) TO COMPUTED-N
197400             PERFORM FAIL
197500             PERFORM PRINT-DETAIL
197600     ELSE
197700             PERFORM PASS
197800             PERFORM PRINT-DETAIL.
197900*
198000 REL-8X-INIT-13.
198100     MOVE   "VIII-33 4.7.2 (GR7)"  TO ANSI-REFERENCE.
198200     MOVE   "REL-8X-TEST-13"  TO PAR-NAME.
198300     MOVE    555 TO WRK-RL-FD1-RECKEY.
198400     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
198500     MOVE    SPACES TO FILE-RECORD-INFO (1).
198600     MOVE    SPACE  TO WRK-XN-00001.
198700     MOVE    1 TO REC-CT.
198800     GO TO   REL-8X-TEST-13-0.
198900 REL-8X-DELETE-13.
199000     PERFORM DE-LETE.
199100     PERFORM PRINT-DETAIL.
199200     GO TO   REL-8X-INIT-14.
199300 REL-8X-TEST-13-0.
199400     START   RL-FD1
199500             KEY >= RL-FD1-KEY
199600             NOT INVALID KEY
199700                 MOVE "A" TO WRK-XN-00001.
199800 REL-8X-TEST-13-1.
199900     IF      WRK-XN-00001 NOT = SPACE
200000             MOVE   "NOT INVALID KEY SHOULD NOT HAVE EXECUTED"
200100                  TO RE-MARK
200200             MOVE    SPACE TO CORRECT-X
200300             MOVE    WRK-XN-00001 TO COMPUTED-X
200400             PERFORM FAIL
200500             PERFORM PRINT-DETAIL
200600     ELSE
200700             PERFORM PASS
200800             PERFORM PRINT-DETAIL.
200900*
201000 REL-8X-INIT-14.
201100     MOVE   "VIII-33 4.7.2 (GR7)"  TO ANSI-REFERENCE.
201200     MOVE   "REL-8X-TEST-14"  TO PAR-NAME.
201300     MOVE    101 TO WRK-RL-FD1-RECKEY.
201400     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
201500     MOVE    SPACES TO FILE-RECORD-INFO (1).
201600     MOVE    SPACE  TO WRK-XN-00001.
201700     MOVE    1 TO REC-CT.
201800     GO TO   REL-8X-TEST-14-0.
201900 REL-8X-DELETE-14.
202000     PERFORM DE-LETE.
202100     PERFORM PRINT-DETAIL.
202200     GO TO   REL-8X-INIT-15.
202300 REL-8X-TEST-14-0.
202400     START   RL-FD1
202500             KEY >= RL-FD1-KEY
202600                 INVALID KEY
202700                 MOVE "B" TO WRK-XN-00001
202800             NOT INVALID KEY
202900                 MOVE "A" TO WRK-XN-00001.
203000 REL-8X-TEST-14-1.
203100     IF      WRK-XN-00001 NOT = "A"
203200             MOVE   "NOT INVALID KEY SHOULD HAVE EXECUTED"
203300                  TO RE-MARK
203400             MOVE   "A" TO CORRECT-X
203500             MOVE    WRK-XN-00001 TO COMPUTED-X
203600             PERFORM FAIL
203700             PERFORM PRINT-DETAIL
203800     ELSE
203900             PERFORM PASS
204000             PERFORM PRINT-DETAIL.
204100     ADD     1 TO REC-CT.
204200 REL-8X-TEST-14-2.
204300     MOVE   "REL-8X-TEST-14-2" TO PAR-NAME.
204400     READ    RL-FD1  INTO FILE-RECORD-INFO (1).
204500     IF      XRECORD-NUMBER (1) < 101
204600             MOVE   "RECORD NUMBER LESS THAN RELATIVE KEY"
204700                  TO RE-MARK
204800             MOVE    101 TO CORRECT-N
204900             MOVE    XRECORD-NUMBER (1) TO COMPUTED-N
205000             PERFORM FAIL
205100             PERFORM PRINT-DETAIL
205200     ELSE
205300             PERFORM PASS
205400             PERFORM PRINT-DETAIL.
205500*
205600 REL-8X-INIT-15.
205700     MOVE   "VIII-33 4.7.2 (GR7)"  TO ANSI-REFERENCE.
205800     MOVE   "REL-8X-TEST-15"  TO PAR-NAME.
205900     MOVE    666 TO WRK-RL-FD1-RECKEY.
206000     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
206100     MOVE    SPACES TO FILE-RECORD-INFO (1).
206200     MOVE    SPACE  TO WRK-XN-00001.
206300     MOVE    1 TO REC-CT.
206400     GO TO   REL-8X-TEST-15-0.
206500 REL-8X-DELETE-15.
206600     PERFORM DE-LETE.
206700     PERFORM PRINT-DETAIL.
206800     GO TO   REL-8X-INIT-16.
206900 REL-8X-TEST-15-0.
207000     START   RL-FD1
207100             KEY >= RL-FD1-KEY
207200                 INVALID KEY
207300                 MOVE "A" TO WRK-XN-00001
207400             NOT INVALID KEY
207500                 MOVE "B" TO WRK-XN-00001.
207600 REL-8X-TEST-15-1.
207700     IF      WRK-XN-00001 NOT = "A"
207800             MOVE   "INVALID KEY SHOULD HAVE EXECUTED"
207900                  TO RE-MARK
208000             MOVE   "A" TO CORRECT-X
208100             MOVE    WRK-XN-00001 TO COMPUTED-X
208200             PERFORM FAIL
208300             PERFORM PRINT-DETAIL
208400     ELSE
208500             PERFORM PASS
208600             PERFORM PRINT-DETAIL.
208700*
208800 REL-8X-INIT-16.
208900     MOVE   "VIII-33 4.7.2 (GR7)"  TO ANSI-REFERENCE.
209000     MOVE   "REL-8X-TEST-16"  TO PAR-NAME.
209100     MOVE    200 TO WRK-RL-FD1-RECKEY.
209200     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
209300     MOVE    SPACES TO FILE-RECORD-INFO (1).
209400     MOVE    SPACE  TO WRK-XN-00001.
209500     MOVE    SPACE  TO WRK-XN-00002.
209600     MOVE    1 TO REC-CT.
209700     GO TO   REL-8X-TEST-16-0.
209800 REL-8X-DELETE-16.
209900     PERFORM DE-LETE.
210000     PERFORM PRINT-DETAIL.
210100     GO TO   REL-8X-INIT-17.
210200 REL-8X-TEST-16-0.
210300     START   RL-FD1
210400             KEY >= RL-FD1-KEY
210500                 INVALID KEY
210600                 MOVE "A" TO WRK-XN-00001
210700     END-START
210800     MOVE   "Z" TO WRK-XN-00002.
210900 REL-8X-TEST-16-1.
211000     IF      WRK-XN-00001 NOT = SPACE
211100             MOVE   "INVALID KEY SHOULD NOT HAVE EXECUTED"
211200                  TO RE-MARK
211300             MOVE    SPACE TO CORRECT-X
211400             MOVE    WRK-XN-00001 TO COMPUTED-X
211500             PERFORM FAIL
211600             PERFORM PRINT-DETAIL
211700     ELSE
211800             PERFORM PASS
211900             PERFORM PRINT-DETAIL.
212000     ADD     1 TO REC-CT.
212100 REL-8X-TEST-16-2.
212200     MOVE   "REL-8X-TEST-16-2" TO PAR-NAME.
212300     READ    RL-FD1  INTO FILE-RECORD-INFO (1).
212400     IF      XRECORD-NUMBER (1) < 200
212500             MOVE   "RECORD NUMBER LESS THAN RELATIVE KEY"
212600                  TO RE-MARK
212700             MOVE    200 TO CORRECT-N
212800             MOVE    XRECORD-NUMBER (1) TO COMPUTED-N
212900             PERFORM FAIL
213000             PERFORM PRINT-DETAIL
213100     ELSE
213200             PERFORM PASS
213300             PERFORM PRINT-DETAIL.
213400     ADD     1 TO REC-CT.
213500 REL-8X-TEST-16-3.
213600     MOVE   "REL-8X-TEST-16-3" TO PAR-NAME.
213700     IF      WRK-XN-00002 NOT = "Z"
213800             MOVE   "SCOPE TERMINATOR IGNORED" TO RE-MARK
213900             MOVE   "Z"  TO CORRECT-X
214000             MOVE    WRK-XN-00001 TO COMPUTED-X
214100             PERFORM FAIL
214200             PERFORM PRINT-DETAIL
214300     ELSE
214400             PERFORM PASS
214500             PERFORM PRINT-DETAIL.
214600*
214700 REL-8X-INIT-17.
214800     MOVE   "VIII-33 4.7.2 (GR7)"  TO ANSI-REFERENCE.
214900     MOVE   "REL-8X-TEST-17"  TO PAR-NAME.
215000     MOVE    555 TO WRK-RL-FD1-RECKEY.
215100     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
215200     MOVE    SPACES TO FILE-RECORD-INFO (1).
215300     MOVE    SPACE  TO WRK-XN-00001.
215400     MOVE    SPACE  TO WRK-XN-00002.
215500     MOVE    1 TO REC-CT.
215600     GO TO   REL-8X-TEST-17-0.
215700 REL-8X-DELETE-17.
215800     PERFORM DE-LETE.
215900     PERFORM PRINT-DETAIL.
216000     GO TO   REL-8X-INIT-18.
216100 REL-8X-TEST-17-0.
216200     START   RL-FD1
216300             KEY >= RL-FD1-KEY
216400                 INVALID KEY
216500                 MOVE "A" TO WRK-XN-00001
216600     END-START
216700     MOVE   "Z" TO WRK-XN-00002.
216800 REL-8X-TEST-17-1.
216900     IF      WRK-XN-00001 NOT = "A"
217000             MOVE   "INVALID KEY SHOULD HAVE EXECUTED"
217100                  TO RE-MARK
217200             MOVE   "A" TO CORRECT-X
217300             MOVE    WRK-XN-00001 TO COMPUTED-X
217400             PERFORM FAIL
217500             PERFORM PRINT-DETAIL
217600     ELSE
217700             PERFORM PASS
217800             PERFORM PRINT-DETAIL.
217900     ADD     1 TO REC-CT.
218000 REL-8X-TEST-17-2.
218100     MOVE   "REL-8X-TEST-17-2" TO PAR-NAME.
218200     IF      WRK-XN-00002 NOT = "Z"
218300             MOVE   "SCOPE TERMINATOR IGNORED" TO RE-MARK
218400             MOVE   "Z"  TO CORRECT-X
218500             MOVE    WRK-XN-00001 TO COMPUTED-X
218600             PERFORM FAIL
218700             PERFORM PRINT-DETAIL
218800     ELSE
218900             PERFORM PASS
219000             PERFORM PRINT-DETAIL.
219100*
219200 REL-8X-INIT-18.
219300     MOVE   "VIII-33 4.7.2 (GR7)"  TO ANSI-REFERENCE.
219400     MOVE   "REL-8X-TEST-18"  TO PAR-NAME.
219500     MOVE    027 TO WRK-RL-FD1-RECKEY.
219600     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
219700     MOVE    SPACES TO FILE-RECORD-INFO (1).
219800     MOVE    SPACE  TO WRK-XN-00001.
219900     MOVE    SPACE  TO WRK-XN-00002.
220000     MOVE    1 TO REC-CT.
220100     GO TO   REL-8X-TEST-18-0.
220200 REL-8X-DELETE-18.
220300     PERFORM DE-LETE.
220400     PERFORM PRINT-DETAIL.
220500     GO TO   REL-8X-INIT-19.
220600 REL-8X-TEST-18-0.
220700     START   RL-FD1
220800             KEY >= RL-FD1-KEY
220900             NOT INVALID KEY
221000                 MOVE "A" TO WRK-XN-00001
221100     END-START
221200     MOVE   "Z" TO WRK-XN-00002.
221300 REL-8X-TEST-18-1.
221400     IF      WRK-XN-00001 NOT = "A"
221500             MOVE   "NOT INVALID KEY SHOULD HAVE EXECUTED"
221600                  TO RE-MARK
221700             MOVE   "A" TO CORRECT-X
221800             MOVE    WRK-XN-00001 TO COMPUTED-X
221900             PERFORM FAIL
222000             PERFORM PRINT-DETAIL
222100     ELSE
222200             PERFORM PASS
222300             PERFORM PRINT-DETAIL.
222400     ADD     1 TO REC-CT.
222500 REL-8X-TEST-18-2.
222600     MOVE   "REL-8X-TEST-18-2" TO PAR-NAME.
222700     READ    RL-FD1  INTO FILE-RECORD-INFO (1).
222800     IF      XRECORD-NUMBER (1) < 27
222900             MOVE   "RECORD NUMBER LESS THAN RELATIVE KEY"
223000                  TO RE-MARK
223100             MOVE    27 TO CORRECT-N
223200             MOVE    XRECORD-NUMBER (1) TO COMPUTED-N
223300             PERFORM FAIL
223400             PERFORM PRINT-DETAIL
223500     ELSE
223600             PERFORM PASS
223700             PERFORM PRINT-DETAIL.
223800     ADD     1 TO REC-CT.
223900 REL-8X-TEST-18-3.
224000     MOVE   "REL-8X-TEST-18-3" TO PAR-NAME.
224100     IF      WRK-XN-00002 NOT = "Z"
224200             MOVE   "SCOPE TERMINATOR IGNORED" TO RE-MARK
224300             MOVE   "Z"  TO CORRECT-X
224400             MOVE    WRK-XN-00001 TO COMPUTED-X
224500             PERFORM FAIL
224600             PERFORM PRINT-DETAIL
224700     ELSE
224800             PERFORM PASS
224900             PERFORM PRINT-DETAIL.
225000*
225100 REL-8X-INIT-19.
225200     MOVE   "VIII-33 4.7.2 (GR7)"  TO ANSI-REFERENCE.
225300     MOVE   "REL-8X-TEST-19"  TO PAR-NAME.
225400     MOVE    555 TO WRK-RL-FD1-RECKEY.
225500     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
225600     MOVE    SPACES TO FILE-RECORD-INFO (1).
225700     MOVE    SPACE  TO WRK-XN-00001.
225800     MOVE    SPACE  TO WRK-XN-00002.
225900     MOVE    1 TO REC-CT.
226000     GO TO   REL-8X-TEST-19-0.
226100 REL-8X-DELETE-19.
226200     PERFORM DE-LETE.
226300     PERFORM PRINT-DETAIL.
226400     GO TO   REL-8X-INIT-20.
226500 REL-8X-TEST-19-0.
226600     START   RL-FD1
226700             KEY >= RL-FD1-KEY
226800             NOT INVALID KEY
226900                 MOVE "A" TO WRK-XN-00001
227000     END-START
227100     MOVE   "Z" TO WRK-XN-00002.
227200 REL-8X-TEST-19-1.
227300     IF      WRK-XN-00001 NOT = SPACE
227400             MOVE   "NOT INVALID KEY SHOULD NOT HAVE EXECUTED"
227500                  TO RE-MARK
227600             MOVE    SPACE TO CORRECT-X
227700             MOVE    WRK-XN-00001 TO COMPUTED-X
227800             PERFORM FAIL
227900             PERFORM PRINT-DETAIL
228000     ELSE
228100             PERFORM PASS
228200             PERFORM PRINT-DETAIL.
228300     ADD     1 TO REC-CT.
228400 REL-8X-TEST-19-2.
228500     MOVE   "REL-8X-TEST-19-2" TO PAR-NAME.
228600     IF      WRK-XN-00002 NOT = "Z"
228700             MOVE   "SCOPE TERMINATOR IGNORED" TO RE-MARK
228800             MOVE   "Z"  TO CORRECT-X
228900             MOVE    WRK-XN-00001 TO COMPUTED-X
229000             PERFORM FAIL
229100             PERFORM PRINT-DETAIL
229200     ELSE
229300             PERFORM PASS
229400             PERFORM PRINT-DETAIL.
229500*
229600 REL-8X-INIT-20.
229700     MOVE   "VIII-33 4.7.2 (GR7)"  TO ANSI-REFERENCE.
229800     MOVE   "REL-8X-TEST-20"  TO PAR-NAME.
229900     MOVE    101 TO WRK-RL-FD1-RECKEY.
230000     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
230100     MOVE    SPACES TO FILE-RECORD-INFO (1).
230200     MOVE    SPACE  TO WRK-XN-00001.
230300     MOVE    1 TO REC-CT.
230400     GO TO   REL-8X-TEST-20-0.
230500 REL-8X-DELETE-20.
230600     PERFORM DE-LETE.
230700     PERFORM PRINT-DETAIL.
230800     GO TO   REL-8X-INIT-21.
230900 REL-8X-TEST-20-0.
231000     START   RL-FD1
231100             KEY >= RL-FD1-KEY
231200                 INVALID KEY
231300                 MOVE "B" TO WRK-XN-00001
231400             NOT INVALID KEY
231500                 MOVE "A" TO WRK-XN-00001
231600     END-START
231700     MOVE   "Z" TO WRK-XN-00002.
231800 REL-8X-TEST-20-1.
231900     IF      WRK-XN-00001 NOT = "A"
232000             MOVE   "NOT INVALID KEY SHOULD HAVE EXECUTED"
232100                  TO RE-MARK
232200             MOVE   "A" TO CORRECT-X
232300             MOVE    WRK-XN-00001 TO COMPUTED-X
232400             PERFORM FAIL
232500             PERFORM PRINT-DETAIL
232600     ELSE
232700             PERFORM PASS
232800             PERFORM PRINT-DETAIL.
232900     ADD     1 TO REC-CT.
233000 REL-8X-TEST-20-2.
233100     MOVE   "REL-8X-TEST-20-2" TO PAR-NAME.
233200     READ    RL-FD1  INTO FILE-RECORD-INFO (1).
233300     IF      XRECORD-NUMBER (1) < 101
233400             MOVE   "RECORD NUMBER LESS THAN RELATIVE KEY"
233500                  TO RE-MARK
233600             MOVE    101 TO CORRECT-N
233700             MOVE    XRECORD-NUMBER (1) TO COMPUTED-N
233800             PERFORM FAIL
233900             PERFORM PRINT-DETAIL
234000     ELSE
234100             PERFORM PASS
234200             PERFORM PRINT-DETAIL.
234300     ADD     1 TO REC-CT.
234400 REL-8X-TEST-20-3.
234500     MOVE   "REL-8X-TEST-20-3" TO PAR-NAME.
234600     IF      WRK-XN-00002 NOT = "Z"
234700             MOVE   "SCOPE TERMINATOR IGNORED" TO RE-MARK
234800             MOVE   "Z"  TO CORRECT-X
234900             MOVE    WRK-XN-00001 TO COMPUTED-X
235000             PERFORM FAIL
235100             PERFORM PRINT-DETAIL
235200     ELSE
235300             PERFORM PASS
235400             PERFORM PRINT-DETAIL.
235500*
235600 REL-8X-INIT-21.
235700     MOVE   "VIII-33 4.7.2 (GR7)"  TO ANSI-REFERENCE.
235800     MOVE   "REL-8X-TEST-21"  TO PAR-NAME.
235900     MOVE    666 TO WRK-RL-FD1-RECKEY.
236000     MOVE    WRK-RL-FD1-RECKEY TO RL-FD1-KEY.
236100     MOVE    SPACES TO FILE-RECORD-INFO (1).
236200     MOVE    SPACE  TO WRK-XN-00001.
236300     MOVE    SPACE  TO WRK-XN-00002.
236400     MOVE    1 TO REC-CT.
236500     GO TO   REL-8X-TEST-21-0.
236600 REL-8X-DELETE-21.
236700     PERFORM DE-LETE.
236800     PERFORM PRINT-DETAIL.
236900     GO TO   REL-8X-END-21.
237000 REL-8X-TEST-21-0.
237100     START   RL-FD1
237200             KEY >= RL-FD1-KEY
237300                 INVALID KEY
237400                 MOVE "A" TO WRK-XN-00001
237500             NOT INVALID KEY
237600                 MOVE "B" TO WRK-XN-00001
237700     END-START
237800     MOVE   "Z" TO WRK-XN-00002.
237900 REL-8X-TEST-21-1.
238000     IF      WRK-XN-00001 NOT = "A"
238100             MOVE   "INVALID KEY SHOULD HAVE EXECUTED"
238200                  TO RE-MARK
238300             MOVE   "A" TO CORRECT-X
238400             MOVE    WRK-XN-00001 TO COMPUTED-X
238500             PERFORM FAIL
238600             PERFORM PRINT-DETAIL
238700     ELSE
238800             PERFORM PASS
238900             PERFORM PRINT-DETAIL.
239000     ADD     1 TO REC-CT.
239100 REL-8X-TEST-21-2.
239200     MOVE   "REL-8X-TEST-21-2" TO PAR-NAME.
239300     IF      WRK-XN-00002 NOT = "Z"
239400             MOVE   "SCOPE TERMINATOR IGNORED" TO RE-MARK
239500             MOVE   "Z"  TO CORRECT-X
239600             MOVE    WRK-XN-00001 TO COMPUTED-X
239700             PERFORM FAIL
239800             PERFORM PRINT-DETAIL
239900     ELSE
240000             PERFORM PASS
240100             PERFORM PRINT-DETAIL.
240200 REL-8X-END-21.
240300     CLOSE   RL-FD1.
240400     CLOSE   RL-FS2.
240500 REL-8X-EXIT.
240600     EXIT.
240700*
240800 CCVS-EXIT SECTION.
240900 CCVS-999999.
241000     GO TO CLOSE-FILES.
