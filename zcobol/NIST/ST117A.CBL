000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST117A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*
002200*
002300*    ST117
002400*
002500*
002600*    OBJECTIVE -
002700*        ROUTINE ST117 CHECKS THE FILE ( SQ-FS2 ) WHICH IS GIVEN
002800*    BY THE SORT IN ST116.  THE ALPHANUMERIC KEYS AND NUMERIC KEYS
002900*    ARE BOTH CHECKED BY ST117.
003000*
003100*
003200*    FEATURES TESTED -
003300*    *   FIXED LENGTH RECORDS
003400*    *   QUALIFIED ALPHANUMERIC AND NUMERIC SORT KEYS
003500*
003600*
003700*
003800*    ANSI X3.23-1974 REFERENCES -
003900*    *   SECTION 4.4  THE SORT STATEMENT  PAGE VII-14
004000*
004100*
004200*    FILES USED -
004300*    *   FILE SQ-FS2 CAN BE ON MAGNETIC TAPE OR MASS-STORAGE.
004400*
004500*        SQ-FS2 -
004600*    NUMBER OF RECORDS IS SET IN X-65
004700*    FIXED LENGTH ( 507 CHARACTERS PER RECORD )
004800*    BLOCKED 2
004900*    RESERVE 4 AREAS
005000*
005100*
005200*    X-CARDS USED  -
005300*    X-XXXD02     SQ-FS2
005400*    X-XXX063     NATIVE COLLATING SEQUENCE ASCENDING ORDER (NOTE
005500*        THAT THE QUOTE CHARACTER IS NOT TO APPEAR IN THE X-63
005600*        CARD AND THE DOLLAR SIGN $ IS TO APPEAR TWICE WHEREVER
005700*        THE $ BELONGS IN THE NATIVE COLLATING SEQUENCE).  IF
005800*        THE NATIVE COLLATING SEQUENCE IS ACTUALLY THE ASCII
005900*        COLLATING SEQUENCE SEE BELOW FOR A SAMPLE X-63 CARD.....
006000*
006100*    X-63  " $$()*+,-./0123456789;<=>ABCDEFGHIJKLMNOPQRSTUVWXYZ".
006200*
006300*    X-XXX065     4 DIGIT INTEGER FOR THE NUMBER OF RECORDS IN
006400*                      THE FILE SQ-FS2.
006500*
006600*
006700*    OPTIONS RECOMMENDED -
006800*    *   *OPT8  X  TO BE USED IF NECESSARY TO DUMP THE
006900*                 FILE SQ-FS2.
007000*
007100*
007200*    TEST DESCRIPTIONS -
007300*        THE INTEGER X-65 IS DIVIDED BY 51.  THIS IS THE NUMBER
007400*    OF DUPLICATE RECORD KEYS THAT ARE EXPECTED IN SQ-FS2.  THESE
007500*    KEYS SHOULD BE THE LOWEST CHARACTER IN THE NATIVE COLLATING
007600*    SEQUENCE.  ALL OF THE NUMERIC KEYS FOR THESE RECORDS SHOULD
007700*    BE IN ASCENDING ORDER.
007800*
007900*
008000*    ************************************************************
008100 ENVIRONMENT DIVISION.
008200 CONFIGURATION SECTION.
008300 SOURCE-COMPUTER.
008400     XXXXX082.
008500 OBJECT-COMPUTER.
008600     XXXXX083.
008700 INPUT-OUTPUT SECTION.
008800 FILE-CONTROL.
008900     SELECT PRINT-FILE ASSIGN TO
009000     XXXXX055.
009100     SELECT SQ-FS2 ASSIGN TO
009200     XXXXD002
009300     ORGANIZATION IS SEQUENTIAL
009400     ACCESS MODE IS SEQUENTIAL.
009500 DATA DIVISION.
009600 FILE SECTION.
009700 FD  PRINT-FILE.
009800 01  PRINT-REC PICTURE X(120).
009900 01  DUMMY-RECORD PICTURE X(120).
010000 FD  SQ-FS2
010100     LABEL RECORDS STANDARD
010200C    VALUE OF
010300C    XXXXX074
010400C    IS
010500C    XXXXX076
010600G    XXXXX069
010700     BLOCK CONTAINS 2 RECORDS
010800     RECORD CONTAINS 507 CHARACTERS
010900     DATA RECORD SQ-FS2R1-F-G-507.
011000 01  SQ-FS2R1-F-G-507.
011100     10 REC-PRE-2 PIC X(120).
011200     10  LENGTH-2 PIC 999.
011300     10  THOSE-LOVABLE-KEYS.
011400     20 KEY-4.
011500         30 ALPHAN-KEY-K4 PIC X.
011600         30 NUM-KEY-K4 PIC 999.
011700     20 KEY-5.
011800         30 ALPHAN-KEY-K5 PIC X.
011900         30 NUM-KEY-K5 PIC 999.
012000     20 KEY-6.
012100         30 ALPHAN-KEY-K6 PIC X.
012200         30 NUM-KEY-K6 PIC 999.
012300     10  STUFF-FOR-FUN OCCURS
012400             31 TIMES.
012500         30  FILLER  PIC X(12).
012600 WORKING-STORAGE SECTION.
012700 77  WRK-DU-9-0001 PIC 9 VALUE 0.
012800 77  WRK-DU-9-2 PIC 9 VALUE 0.
012900 77  WRK-DU-999-0001 PIC 999.
013000 77  WRK-DU-999-2 PIC 999 VALUE 000.
013100 77  WRK-DU-999-3 PIC 999 VALUE ZERO.
013200 77  NUMBER-OF-SETS PIC 999 VALUE ZERO.
013300X77  COUNT-OF-RECS PIC 9(6) VALUE ZERO.
013400 01  WRK-XN-2    PIC X(51) VALUE
013500     "                     * G BAIRD, USNAVY            ".
013600 01  WRK-XN-0051F-X-0002 REDEFINES WRK-XN-2.
013700     02 ANSWER PIC X OCCURS 51 TIMES.
013800 01  FILE-RECORD-INFORMATION-REC.
013900     03 FILE-RECORD-INFO-SKELETON.
014000        05 FILLER                 PICTURE X(48)       VALUE
014100             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
014200        05 FILLER                 PICTURE X(46)       VALUE
014300             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
014400        05 FILLER                 PICTURE X(26)       VALUE
014500             ",LFIL=000000,ORG=  ,LBLR= ".
014600        05 FILLER                 PICTURE X(37)       VALUE
014700             ",RECKEY=                             ".
014800        05 FILLER                 PICTURE X(38)       VALUE
014900             ",ALTKEY1=                             ".
015000        05 FILLER                 PICTURE X(38)       VALUE
015100             ",ALTKEY2=                             ".
015200        05 FILLER                 PICTURE X(7)        VALUE SPACE.
015300     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
015400        05 FILE-RECORD-INFO-P1-120.
015500           07 FILLER              PIC X(5).
015600           07 XFILE-NAME           PIC X(6).
015700           07 FILLER              PIC X(8).
015800           07 XRECORD-NAME         PIC X(6).
015900           07 FILLER              PIC X(1).
016000           07 REELUNIT-NUMBER     PIC 9(1).
016100           07 FILLER              PIC X(7).
016200           07 XRECORD-NUMBER       PIC 9(6).
016300           07 FILLER              PIC X(6).
016400           07 UPDATE-NUMBER       PIC 9(2).
016500           07 FILLER              PIC X(5).
016600           07 ODO-NUMBER          PIC 9(4).
016700           07 FILLER              PIC X(5).
016800           07 XPROGRAM-NAME        PIC X(5).
016900           07 FILLER              PIC X(7).
017000           07 XRECORD-LENGTH       PIC 9(6).
017100           07 FILLER              PIC X(7).
017200           07 CHARS-OR-RECORDS    PIC X(2).
017300           07 FILLER              PIC X(1).
017400           07 XBLOCK-SIZE          PIC 9(4).
017500           07 FILLER              PIC X(6).
017600           07 RECORDS-IN-FILE     PIC 9(6).
017700           07 FILLER              PIC X(5).
017800           07 XFILE-ORGANIZATION   PIC X(2).
017900           07 FILLER              PIC X(6).
018000           07 XLABEL-TYPE          PIC X(1).
018100        05 FILE-RECORD-INFO-P121-240.
018200           07 FILLER              PIC X(8).
018300           07 XRECORD-KEY          PIC X(29).
018400           07 FILLER              PIC X(9).
018500           07 ALTERNATE-KEY1      PIC X(29).
018600           07 FILLER              PIC X(9).
018700           07 ALTERNATE-KEY2      PIC X(29).
018800           07 FILLER              PIC X(7).
018900 01  TEST-RESULTS.
019000     02 FILLER                   PIC X      VALUE SPACE.
019100     02 FEATURE                  PIC X(20)  VALUE SPACE.
019200     02 FILLER                   PIC X      VALUE SPACE.
019300     02 P-OR-F                   PIC X(5)   VALUE SPACE.
019400     02 FILLER                   PIC X      VALUE SPACE.
019500     02  PAR-NAME.
019600       03 FILLER                 PIC X(19)  VALUE SPACE.
019700       03  PARDOT-X              PIC X      VALUE SPACE.
019800       03 DOTVALUE               PIC 99     VALUE ZERO.
019900     02 FILLER                   PIC X(8)   VALUE SPACE.
020000     02 RE-MARK                  PIC X(61).
020100 01  TEST-COMPUTED.
020200     02 FILLER                   PIC X(30)  VALUE SPACE.
020300     02 FILLER                   PIC X(17)  VALUE
020400            "       COMPUTED=".
020500     02 COMPUTED-X.
020600     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
020700     03 COMPUTED-N               REDEFINES COMPUTED-A
020800                                 PIC -9(9).9(9).
020900     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
021000     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
021100     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
021200     03       CM-18V0 REDEFINES COMPUTED-A.
021300         04 COMPUTED-18V0                    PIC -9(18).
021400         04 FILLER                           PIC X.
021500     03 FILLER PIC X(50) VALUE SPACE.
021600 01  TEST-CORRECT.
021700     02 FILLER PIC X(30) VALUE SPACE.
021800     02 FILLER PIC X(17) VALUE "       CORRECT =".
021900     02 CORRECT-X.
022000     03 CORRECT-A                  PIC X(20) VALUE SPACE.
022100     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
022200     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
022300     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
022400     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
022500     03      CR-18V0 REDEFINES CORRECT-A.
022600         04 CORRECT-18V0                     PIC -9(18).
022700         04 FILLER                           PIC X.
022800     03 FILLER PIC X(2) VALUE SPACE.
022900     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
023000 01  CCVS-C-1.
023100     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
023200-    "SS  PARAGRAPH-NAME
023300-    "       REMARKS".
023400     02 FILLER                     PIC X(20)    VALUE SPACE.
023500 01  CCVS-C-2.
023600     02 FILLER                     PIC X        VALUE SPACE.
023700     02 FILLER                     PIC X(6)     VALUE "TESTED".
023800     02 FILLER                     PIC X(15)    VALUE SPACE.
023900     02 FILLER                     PIC X(4)     VALUE "FAIL".
024000     02 FILLER                     PIC X(94)    VALUE SPACE.
024100 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
024200 01  REC-CT                        PIC 99       VALUE ZERO.
024300 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
024400 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
024500 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
024600 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
024700 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
024800 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
024900 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
025000 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
025100 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
025200 01  CCVS-H-1.
025300     02  FILLER                    PIC X(39)    VALUE SPACES.
025400     02  FILLER                    PIC X(42)    VALUE
025500     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
025600     02  FILLER                    PIC X(39)    VALUE SPACES.
025700 01  CCVS-H-2A.
025800   02  FILLER                        PIC X(40)  VALUE SPACE.
025900   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
026000   02  FILLER                        PIC XXXX   VALUE
026100     "4.2 ".
026200   02  FILLER                        PIC X(28)  VALUE
026300            " COPY - NOT FOR DISTRIBUTION".
026400   02  FILLER                        PIC X(41)  VALUE SPACE.
026500
026600 01  CCVS-H-2B.
026700   02  FILLER                        PIC X(15)  VALUE
026800            "TEST RESULT OF ".
026900   02  TEST-ID                       PIC X(9).
027000   02  FILLER                        PIC X(4)   VALUE
027100            " IN ".
027200   02  FILLER                        PIC X(12)  VALUE
027300     " HIGH       ".
027400   02  FILLER                        PIC X(22)  VALUE
027500            " LEVEL VALIDATION FOR ".
027600   02  FILLER                        PIC X(58)  VALUE
027700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
027800 01  CCVS-H-3.
027900     02  FILLER                      PIC X(34)  VALUE
028000            " FOR OFFICIAL USE ONLY    ".
028100     02  FILLER                      PIC X(58)  VALUE
028200     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
028300     02  FILLER                      PIC X(28)  VALUE
028400            "  COPYRIGHT   1985 ".
028500 01  CCVS-E-1.
028600     02 FILLER                       PIC X(52)  VALUE SPACE.
028700     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
028800     02 ID-AGAIN                     PIC X(9).
028900     02 FILLER                       PIC X(45)  VALUE SPACES.
029000 01  CCVS-E-2.
029100     02  FILLER                      PIC X(31)  VALUE SPACE.
029200     02  FILLER                      PIC X(21)  VALUE SPACE.
029300     02 CCVS-E-2-2.
029400         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
029500         03 FILLER                   PIC X      VALUE SPACE.
029600         03 ENDER-DESC               PIC X(44)  VALUE
029700            "ERRORS ENCOUNTERED".
029800 01  CCVS-E-3.
029900     02  FILLER                      PIC X(22)  VALUE
030000            " FOR OFFICIAL USE ONLY".
030100     02  FILLER                      PIC X(12)  VALUE SPACE.
030200     02  FILLER                      PIC X(58)  VALUE
030300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
030400     02  FILLER                      PIC X(13)  VALUE SPACE.
030500     02 FILLER                       PIC X(15)  VALUE
030600             " COPYRIGHT 1985".
030700 01  CCVS-E-4.
030800     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
030900     02 FILLER                       PIC X(4)   VALUE " OF ".
031000     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
031100     02 FILLER                       PIC X(40)  VALUE
031200      "  TESTS WERE EXECUTED SUCCESSFULLY".
031300 01  XXINFO.
031400     02 FILLER                       PIC X(19)  VALUE
031500            "*** INFORMATION ***".
031600     02 INFO-TEXT.
031700       04 FILLER                     PIC X(8)   VALUE SPACE.
031800       04 XXCOMPUTED                 PIC X(20).
031900       04 FILLER                     PIC X(5)   VALUE SPACE.
032000       04 XXCORRECT                  PIC X(20).
032100     02 INF-ANSI-REFERENCE           PIC X(48).
032200 01  HYPHEN-LINE.
032300     02 FILLER  PIC IS X VALUE IS SPACE.
032400     02 FILLER  PIC IS X(65)    VALUE IS "************************
032500-    "*****************************************".
032600     02 FILLER  PIC IS X(54)    VALUE IS "************************
032700-    "******************************".
032800 01  CCVS-PGM-ID                     PIC X(9)   VALUE
032900     "ST117A".
033000 PROCEDURE DIVISION.
033100 CCVS1 SECTION.
033200 OPEN-FILES.
033300     OPEN    OUTPUT PRINT-FILE.
033400     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
033500     MOVE    SPACE TO TEST-RESULTS.
033600     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
033700     MOVE    ZERO TO REC-SKL-SUB.
033800     PERFORM CCVS-INIT-FILE 9 TIMES.
033900 CCVS-INIT-FILE.
034000     ADD     1 TO REC-SKL-SUB.
034100     MOVE    FILE-RECORD-INFO-SKELETON
034200          TO FILE-RECORD-INFO (REC-SKL-SUB).
034300 CCVS-INIT-EXIT.
034400     GO TO CCVS1-EXIT.
034500 CLOSE-FILES.
034600     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
034700 TERMINATE-CCVS.
034800S    EXIT PROGRAM.
034900STERMINATE-CALL.
035000     STOP     RUN.
035100 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
035200 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
035300 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
035400 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
035500     MOVE "****TEST DELETED****" TO RE-MARK.
035600 PRINT-DETAIL.
035700     IF REC-CT NOT EQUAL TO ZERO
035800             MOVE "." TO PARDOT-X
035900             MOVE REC-CT TO DOTVALUE.
036000     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
036100     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
036200        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
036300          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
036400     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
036500     MOVE SPACE TO CORRECT-X.
036600     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
036700     MOVE     SPACE TO RE-MARK.
036800 HEAD-ROUTINE.
036900     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037000     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037100     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
037200     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
037300 COLUMN-NAMES-ROUTINE.
037400     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037500     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
037700 END-ROUTINE.
037800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
037900 END-RTN-EXIT.
038000     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038100 END-ROUTINE-1.
038200      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
038300      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
038400      ADD PASS-COUNTER TO ERROR-HOLD.
038500*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
038600      MOVE PASS-COUNTER TO CCVS-E-4-1.
038700      MOVE ERROR-HOLD TO CCVS-E-4-2.
038800      MOVE CCVS-E-4 TO CCVS-E-2-2.
038900      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
039000  END-ROUTINE-12.
039100      MOVE "TEST(S) FAILED" TO ENDER-DESC.
039200     IF       ERROR-COUNTER IS EQUAL TO ZERO
039300         MOVE "NO " TO ERROR-TOTAL
039400         ELSE
039500         MOVE ERROR-COUNTER TO ERROR-TOTAL.
039600     MOVE     CCVS-E-2 TO DUMMY-RECORD.
039700     PERFORM WRITE-LINE.
039800 END-ROUTINE-13.
039900     IF DELETE-COUNTER IS EQUAL TO ZERO
040000         MOVE "NO " TO ERROR-TOTAL  ELSE
040100         MOVE DELETE-COUNTER TO ERROR-TOTAL.
040200     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
040300     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
040400      IF   INSPECT-COUNTER EQUAL TO ZERO
040500          MOVE "NO " TO ERROR-TOTAL
040600      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
040700      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
040800      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
040900     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
041000 WRITE-LINE.
041100     ADD 1 TO RECORD-COUNT.
041200Y    IF RECORD-COUNT GREATER 42
041300Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
041400Y        MOVE SPACE TO DUMMY-RECORD
041500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
041600Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
041700Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
041800Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
041900Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
042000Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
042100Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
042200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
042300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
042400Y        MOVE ZERO TO RECORD-COUNT.
042500     PERFORM WRT-LN.
042600 WRT-LN.
042700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
042800     MOVE SPACE TO DUMMY-RECORD.
042900 BLANK-LINE-PRINT.
043000     PERFORM WRT-LN.
043100 FAIL-ROUTINE.
043200     IF     COMPUTED-X NOT EQUAL TO SPACE
043300            GO TO   FAIL-ROUTINE-WRITE.
043400     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
043500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
043600     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
043700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043800     MOVE   SPACES TO INF-ANSI-REFERENCE.
043900     GO TO  FAIL-ROUTINE-EX.
044000 FAIL-ROUTINE-WRITE.
044100     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
044200     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
044300     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
044400     MOVE   SPACES TO COR-ANSI-REFERENCE.
044500 FAIL-ROUTINE-EX. EXIT.
044600 BAIL-OUT.
044700     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
044800     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
044900 BAIL-OUT-WRITE.
045000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
045100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
045200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045300     MOVE   SPACES TO INF-ANSI-REFERENCE.
045400 BAIL-OUT-EX. EXIT.
045500 CCVS1-EXIT.
045600     EXIT.
045700 SECT-ST117-0001 SECTION.
045800 SRT-INIT.
045900     OPEN INPUT SQ-FS2.
046000     MOVE    "BIG-SORT" TO PAR-NAME.
046100     MOVE "NATIVE COLL.SEQUENCE " TO FEATURE.
046200     MOVE    0 TO WRK-DU-9-0001.
046300     MOVE    0 TO WRK-DU-9-2.
046400     MOVE    0 TO WRK-DU-999-3.
046500     DIVIDE
046600     XXXXX065
046700         BY 51 GIVING NUMBER-OF-SETS.
046800*
046900*    FOR EVERY SET OF 51 RECORDS CREATED AS THE ORIGINAL INPUT
047000*        FILE FOR THE SORT ( X-65 / 51 ), THEN THERE SHOULD BE AT
047100*        LEAST THAT NUMBER OF DUPLICATE ALPHANUMERIC KEYS AS THE
047200*        FIRST N RECORDS IN THE SORTED FILE SQ-FS2.  THAT MANY
047300*        RECORDS WILL BE READ AND THE KEYS SHOULD BE THE LOWEST
047400*        CHARACTER IN THE NATIVE COLLATING SEQUENCE. THE NUMERIC
047500*        KEYS SHOULD ALWAYS BE ASCENDING.
047600*
047700     MOVE 1 TO WRK-DU-999-0001.
047800 SRT-INIT-01.
047900     PERFORM RD-2 THRU R2-EXIT.
048000     ADD 1 TO WRK-DU-999-0001.
048100     IF  WRK-DU-999-0001 IS NOT GREATER THAN NUMBER-OF-SETS
048200         GO TO SRT-INIT-01.
048300     IF      WRK-DU-9-2 IS EQUAL TO 0
048400         PERFORM PASS
048500         GO TO SRT-WRITE
048600     ELSE
048700         PERFORM FAIL
048800         MOVE "ERROR AT RECORD" TO COMPUTED-A
048900         MOVE WRK-DU-999-2 TO CORRECT-18V0
049000         MOVE "FILE SQ-FS2 PASSED FROM ST116" TO RE-MARK
049100         GO TO SRT-WRITE.
049200 SRT-DELETE.
049300     PERFORM DE-LETE.
049400 SRT-WRITE.
049500     PERFORM PRINT-DETAIL.
049600     CLOSE   SQ-FS2.
049700     GO      TO ST117-END.
049800 RD-2.
049900     IF WRK-DU-9-0001 IS NOT EQUAL TO ZERO
050000         GO TO R2-EXIT.
050100     READ SQ-FS2 AT END GO TO PREMATURE-EOF.
050200     IF      ALPHAN-KEY-K6 IS NOT EQUAL TO ANSWER (1)
050300         MOVE 1 TO WRK-DU-9-2
050400         MOVE WRK-DU-999-0001 TO WRK-DU-999-2
050500         MOVE 1 TO WRK-DU-9-0001.
050600     IF      NUM-KEY-K6 IS NOT GREATER THAN WRK-DU-999-3
050700         MOVE 1 TO WRK-DU-9-2
050800         MOVE WRK-DU-999-0001 TO WRK-DU-999-2
050900         MOVE 1 TO WRK-DU-9-0001
051000     ELSE
051100         MOVE NUM-KEY-K6 TO WRK-DU-999-3
051200         GO TO R2-EXIT.
051300 PREMATURE-EOF.
051400     MOVE 1 TO WRK-DU-9-0001.
051500     PERFORM FAIL.
051600     MOVE    "AT RECORD" TO COMPUTED-A.
051700     MOVE    WRK-DU-999-0001 TO CORRECT-18V0.
051800     MOVE "PREMATURE EOF FOUND" TO RE-MARK.
051900 R2-EXIT.
052000     EXIT.
052100 ST117-END.
052200     EXIT.
052300XFILEDUMP SECTION.
052400XFILE-2-DUMP-INIT.
052500X    OPEN INPUT SQ-FS2.
052600X    MOVE ZERO TO COUNT-OF-RECS.
052700XFILE-2-DUMP.
052800X    READ SQ-FS2 RECORD
052900X        AT END GO TO FILE-2-DUMP-END.
053000X    ADD 1 TO COUNT-OF-RECS.
053100X    IF COUNT-OF-RECS GREATER THAN
053200X    XXXXX065
053300X        MOVE " TOO MANY RECORDS" TO DUMMY-RECORD
053400X        WRITE DUMMY-RECORD AFTER ADVANCING 1 LINES
053500X        GO TO FILE-2-DUMP-END.
053600X    PERFORM FILE-2-DUMP-WRITE.
053700X    GO TO FILE-2-DUMP.
053800XFILE-2-DUMP-WRITE.
053900X    MOVE SQ-FS2R1-F-G-507 TO DUMMY-RECORD.
054000X    WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
054100XFILE-2-DUMP-END.
054200X    MOVE    " NUMBER OF SORTED RECORDS ON SQ-FS2 SHOWN BELOW"
054300X        TO DUMMY-RECORD.
054400X    WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
054500X    MOVE    COUNT-OF-RECS TO DUMMY-RECORD.
054600X    WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
054700X    CLOSE   SQ-FS2.
054800 CCVS-EXIT SECTION.
054900 CCVS-999999.
055000     GO TO CLOSE-FILES.
