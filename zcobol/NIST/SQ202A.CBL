000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ202A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    " HIGH       ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "4.2 ".
001100*                                                              *
001200*  THE ROUTINE SQ202A (OLD SQ203) CREATES A MAGNETIC TAPE FILE AND
001300*    PASSES IT ON TO SQ203A TO BE OPENED AS INPUT UNDER A SELECT
001400*    OPTIONAL CLAUSE.
001500 ENVIRONMENT DIVISION.
001600 CONFIGURATION SECTION.
001700 SOURCE-COMPUTER.
001800     XXXXX082.
001900 OBJECT-COMPUTER.
002000     XXXXX083.
002100 INPUT-OUTPUT SECTION.
002200 FILE-CONTROL.
002300P    SELECT RAW-DATA   ASSIGN TO
002400P    XXXXX062
002500P           ORGANIZATION IS INDEXED
002600P           ACCESS MODE IS RANDOM
002700P           RECORD KEY IS RAW-DATA-KEY.
002800     SELECT PRINT-FILE ASSIGN TO
002900     XXXXX055.
003000     SELECT SQ-FS1 ASSIGN TO
003100     XXXXP001.
003200 DATA DIVISION.
003300 FILE SECTION.
003400P
003500PFD  RAW-DATA.
003600P
003700P01  RAW-DATA-SATZ.
003800P    05  RAW-DATA-KEY        PIC X(6).
003900P    05  C-DATE              PIC 9(6).
004000P    05  C-TIME              PIC 9(8).
004100P    05  C-NO-OF-TESTS       PIC 99.
004200P    05  C-OK                PIC 999.
004300P    05  C-ALL               PIC 999.
004400P    05  C-FAIL              PIC 999.
004500P    05  C-DELETED           PIC 999.
004600P    05  C-INSPECT           PIC 999.
004700P    05  C-NOTE              PIC X(13).
004800P    05  C-INDENT            PIC X.
004900P    05  C-ABORT             PIC X(8).
005000 FD  PRINT-FILE
005100C    LABEL RECORDS
005200C    XXXXX084
005300C    DATA RECORD IS PRINT-REC DUMMY-RECORD
005400               .
005500 01  PRINT-REC PICTURE X(120).
005600 01  DUMMY-RECORD PICTURE X(120).
005700 FD  SQ-FS1
005800C    LABEL RECORD STANDARD
005900     BLOCK CONTAINS 120 CHARACTERS.
006000 01  SQ-FS1R1-F-G-120 PIC X(120).
006100 WORKING-STORAGE SECTION.
006200 77  RECORD-OUT-COUNT   PIC 999.
006300 77  RECORDS-IN-ERROR   PIC 999.
006400 01  COUNT-OF-RECS PIC 9999.
006500 01  FILE-RECORD-INFORMATION-REC.
006600     03 FILE-RECORD-INFO-SKELETON.
006700        05 FILLER                 PICTURE X(48)       VALUE
006800             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
006900        05 FILLER                 PICTURE X(46)       VALUE
007000             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
007100        05 FILLER                 PICTURE X(26)       VALUE
007200             ",LFIL=000000,ORG=  ,LBLR= ".
007300        05 FILLER                 PICTURE X(37)       VALUE
007400             ",RECKEY=                             ".
007500        05 FILLER                 PICTURE X(38)       VALUE
007600             ",ALTKEY1=                             ".
007700        05 FILLER                 PICTURE X(38)       VALUE
007800             ",ALTKEY2=                             ".
007900        05 FILLER                 PICTURE X(7)        VALUE SPACE.
008000     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
008100        05 FILE-RECORD-INFO-P1-120.
008200           07 FILLER              PIC X(5).
008300           07 XFILE-NAME           PIC X(6).
008400           07 FILLER              PIC X(8).
008500           07 XRECORD-NAME         PIC X(6).
008600           07 FILLER              PIC X(1).
008700           07 REELUNIT-NUMBER     PIC 9(1).
008800           07 FILLER              PIC X(7).
008900           07 XRECORD-NUMBER       PIC 9(6).
009000           07 FILLER              PIC X(6).
009100           07 UPDATE-NUMBER       PIC 9(2).
009200           07 FILLER              PIC X(5).
009300           07 ODO-NUMBER          PIC 9(4).
009400           07 FILLER              PIC X(5).
009500           07 XPROGRAM-NAME        PIC X(5).
009600           07 FILLER              PIC X(7).
009700           07 XRECORD-LENGTH       PIC 9(6).
009800           07 FILLER              PIC X(7).
009900           07 CHARS-OR-RECORDS    PIC X(2).
010000           07 FILLER              PIC X(1).
010100           07 XBLOCK-SIZE          PIC 9(4).
010200           07 FILLER              PIC X(6).
010300           07 RECORDS-IN-FILE     PIC 9(6).
010400           07 FILLER              PIC X(5).
010500           07 XFILE-ORGANIZATION   PIC X(2).
010600           07 FILLER              PIC X(6).
010700           07 XLABEL-TYPE          PIC X(1).
010800        05 FILE-RECORD-INFO-P121-240.
010900           07 FILLER              PIC X(8).
011000           07 XRECORD-KEY          PIC X(29).
011100           07 FILLER              PIC X(9).
011200           07 ALTERNATE-KEY1      PIC X(29).
011300           07 FILLER              PIC X(9).
011400           07 ALTERNATE-KEY2      PIC X(29).
011500           07 FILLER              PIC X(7).
011600 01  TEST-RESULTS.
011700     02 FILLER                    PICTURE X VALUE SPACE.
011800     02 FEATURE                   PICTURE X(20) VALUE SPACE.
011900     02 FILLER                    PICTURE X VALUE SPACE.
012000     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
012100     02 FILLER                    PICTURE X  VALUE SPACE.
012200     02  PAR-NAME.
012300       03 FILLER PICTURE X(12) VALUE SPACE.
012400       03  PARDOT-X PICTURE X  VALUE SPACE.
012500       03 DOTVALUE PICTURE 99  VALUE ZERO.
012600       03 FILLER PIC X(5) VALUE SPACE.
012700     02 FILLER PIC X(10) VALUE SPACE.
012800     02 RE-MARK PIC X(61).
012900 01  TEST-COMPUTED.
013000     02 FILLER PIC X(30) VALUE SPACE.
013100     02 FILLER PIC X(17) VALUE "       COMPUTED=".
013200     02 COMPUTED-X.
013300     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
013400     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
013500     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
013600     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
013700     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
013800     03       CM-18V0 REDEFINES COMPUTED-A.
013900         04 COMPUTED-18V0                   PICTURE -9(18).
014000         04 FILLER                          PICTURE X.
014100     03 FILLER PIC X(50) VALUE SPACE.
014200 01  TEST-CORRECT.
014300     02 FILLER PIC X(30) VALUE SPACE.
014400     02 FILLER PIC X(17) VALUE "       CORRECT =".
014500     02 CORRECT-X.
014600     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
014700     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
014800     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
014900     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
015000     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
015100     03      CR-18V0 REDEFINES CORRECT-A.
015200         04 CORRECT-18V0                    PICTURE -9(18).
015300         04 FILLER                          PICTURE X.
015400     03 FILLER PIC X(50) VALUE SPACE.
015500 01  CCVS-C-1.
015600     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
015700-    "SS  PARAGRAPH-NAME
015800-    "        REMARKS".
015900     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
016000 01  CCVS-C-2.
016100     02 FILLER PICTURE IS X VALUE IS SPACE.
016200     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
016300     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
016400     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
016500     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
016600 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
016700 01  REC-CT PICTURE 99 VALUE ZERO.
016800 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
016900 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
017000 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
017100 01  PASS-COUNTER PIC 999 VALUE ZERO.
017200 01  TOTAL-ERROR PIC 999 VALUE ZERO.
017300 01  ERROR-HOLD PIC 999 VALUE ZERO.
017400 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
017500 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
017600 01  CCVS-H-1.
017700     02  FILLER   PICTURE X(27)  VALUE SPACE.
017800     02 FILLER PICTURE X(67) VALUE
017900     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
018000-    " SYSTEM".
018100     02  FILLER     PICTURE X(26)  VALUE SPACE.
018200 01  CCVS-H-2.
018300     02 FILLER PICTURE X(52) VALUE IS
018400     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
018500     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
018600     02 TEST-ID PICTURE IS X(9).
018700     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
018800 01  CCVS-H-3.
018900     02  FILLER PICTURE X(34) VALUE
019000     " FOR OFFICIAL USE ONLY    ".
019100     02  FILLER PICTURE X(58) VALUE
019200     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
019300     02  FILLER PICTURE X(28) VALUE
019400     "  COPYRIGHT   1985 ".
019500 01  CCVS-E-1.
019600     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
019700     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
019800     02 ID-AGAIN PICTURE IS X(9).
019900     02 FILLER PICTURE X(45) VALUE IS
020000     " NTIS DISTRIBUTION COBOL 85".
020100 01  CCVS-E-2.
020200     02  FILLER                   PICTURE X(31)  VALUE
020300     SPACE.
020400     02  FILLER                   PICTURE X(21)  VALUE SPACE.
020500     02 CCVS-E-2-2.
020600         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
020700         03 FILLER PICTURE IS X VALUE IS SPACE.
020800         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
020900 01  CCVS-E-3.
021000     02  FILLER PICTURE X(22) VALUE
021100     " FOR OFFICIAL USE ONLY".
021200     02  FILLER PICTURE X(12) VALUE SPACE.
021300     02  FILLER PICTURE X(58) VALUE
021400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
021500     02  FILLER PICTURE X(13) VALUE SPACE.
021600     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
021700 01  CCVS-E-4.
021800     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
021900     02 FILLER PIC XXXX VALUE " OF ".
022000     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
022100     02 FILLER PIC X(40) VALUE
022200      "  TESTS WERE EXECUTED SUCCESSFULLY".
022300 01  XXINFO.
022400     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
022500     02 INFO-TEXT.
022600     04 FILLER PIC X(20) VALUE SPACE.
022700     04 XXCOMPUTED PIC X(20).
022800     04 FILLER PIC X(5) VALUE SPACE.
022900     04 XXCORRECT PIC X(20).
023000 01  HYPHEN-LINE.
023100     02 FILLER PICTURE IS X VALUE IS SPACE.
023200     02 FILLER PICTURE IS X(65) VALUE IS "************************
023300-    "*****************************************".
023400     02 FILLER PICTURE IS X(54) VALUE IS "************************
023500-    "******************************".
023600 01  CCVS-PGM-ID PIC X(6) VALUE
023700     "SQ202A".
023800 PROCEDURE DIVISION.
023900 CCVS1 SECTION.
024000 OPEN-FILES.
024100P    OPEN I-O RAW-DATA.
024200P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
024300P    READ RAW-DATA INVALID KEY GO TO END-E-1.
024400P    MOVE "ABORTED " TO C-ABORT.
024500P    ADD 1 TO C-NO-OF-TESTS.
024600P    ACCEPT C-DATE  FROM DATE.
024700P    ACCEPT C-TIME  FROM TIME.
024800P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
024900PEND-E-1.
025000P    CLOSE RAW-DATA.
025100     OPEN     OUTPUT PRINT-FILE.
025200     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
025300     MOVE    SPACE TO TEST-RESULTS.
025400     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
025500     MOVE ZERO TO REC-SKL-SUB.
025600     PERFORM CCVS-INIT-FILE 9 TIMES.
025700 CCVS-INIT-FILE.
025800     ADD 1 TO REC-SKL-SUB.
025900     MOVE FILE-RECORD-INFO-SKELETON TO
026000                  FILE-RECORD-INFO (REC-SKL-SUB).
026100 CCVS-INIT-EXIT.
026200     GO TO CCVS1-EXIT.
026300 CLOSE-FILES.
026400     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
026500P    OPEN I-O RAW-DATA.
026600P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
026700P    READ RAW-DATA INVALID KEY GO TO END-E-2.
026800P    MOVE "OK.     " TO C-ABORT.
026900P    MOVE PASS-COUNTER TO C-OK.
027000P    MOVE ERROR-HOLD   TO C-ALL.
027100P    MOVE ERROR-COUNTER TO C-FAIL.
027200P    MOVE DELETE-CNT TO C-DELETED.
027300P    MOVE INSPECT-COUNTER TO C-INSPECT.
027400P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
027500PEND-E-2.
027600P    CLOSE RAW-DATA.
027700 TERMINATE-CCVS.
027800S    EXIT PROGRAM.
027900STERMINATE-CALL.
028000     STOP     RUN.
028100 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
028200 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
028300 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
028400 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
028500     MOVE "****TEST DELETED****" TO RE-MARK.
028600 PRINT-DETAIL.
028700     IF REC-CT NOT EQUAL TO ZERO
028800             MOVE "." TO PARDOT-X
028900             MOVE REC-CT TO DOTVALUE.
029000     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
029100     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
029200        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
029300          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
029400     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
029500     MOVE SPACE TO CORRECT-X.
029600     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
029700     MOVE     SPACE TO RE-MARK.
029800 HEAD-ROUTINE.
029900     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030000     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
030100     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030200 COLUMN-NAMES-ROUTINE.
030300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
030600 END-ROUTINE.
030700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
030800 END-RTN-EXIT.
030900     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031000 END-ROUTINE-1.
031100      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
031200      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
031300      ADD PASS-COUNTER TO ERROR-HOLD.
031400*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
031500      MOVE PASS-COUNTER TO CCVS-E-4-1.
031600      MOVE ERROR-HOLD TO CCVS-E-4-2.
031700      MOVE CCVS-E-4 TO CCVS-E-2-2.
031800      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
031900  END-ROUTINE-12.
032000      MOVE "TEST(S) FAILED" TO ENDER-DESC.
032100     IF       ERROR-COUNTER IS EQUAL TO ZERO
032200         MOVE "NO " TO ERROR-TOTAL
032300         ELSE
032400         MOVE ERROR-COUNTER TO ERROR-TOTAL.
032500     MOVE     CCVS-E-2 TO DUMMY-RECORD.
032600     PERFORM WRITE-LINE.
032700 END-ROUTINE-13.
032800     IF DELETE-CNT IS EQUAL TO ZERO
032900         MOVE "NO " TO ERROR-TOTAL  ELSE
033000         MOVE DELETE-CNT TO ERROR-TOTAL.
033100     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
033200     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033300      IF   INSPECT-COUNTER EQUAL TO ZERO
033400          MOVE "NO " TO ERROR-TOTAL
033500      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
033600      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
033700      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033800     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033900 WRITE-LINE.
034000     ADD 1 TO RECORD-COUNT.
034100Y    IF RECORD-COUNT GREATER 50
034200Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
034300Y        MOVE SPACE TO DUMMY-RECORD
034400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
034500Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
034600Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
034700Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
034800Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
034900Y        MOVE ZERO TO RECORD-COUNT.
035000     PERFORM WRT-LN.
035100 WRT-LN.
035200     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
035300     MOVE SPACE TO DUMMY-RECORD.
035400 BLANK-LINE-PRINT.
035500     PERFORM WRT-LN.
035600 FAIL-ROUTINE.
035700     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
035800     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
035900     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
036000     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036100     GO TO FAIL-ROUTINE-EX.
036200 FAIL-ROUTINE-WRITE.
036300     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
036400     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
036500 FAIL-ROUTINE-EX. EXIT.
036600 BAIL-OUT.
036700     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
036800     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
036900 BAIL-OUT-WRITE.
037000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
037100     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
037200 BAIL-OUT-EX. EXIT.
037300 CCVS1-EXIT.
037400     EXIT.
037500 SECTION-SQ202A-0001 SECTION.
037600 WRI-INIT-001.
037700     MOVE "SQ-FS1" TO XFILE-NAME (1).
037800     MOVE "R1-F-G" TO XRECORD-NAME (1).
037900     MOVE "SQ202A" TO XPROGRAM-NAME (1).
038000     MOVE 120      TO XRECORD-LENGTH (1).
038100     MOVE "RC"     TO CHARS-OR-RECORDS (1).
038200     MOVE 1        TO XBLOCK-SIZE (1).
038300     MOVE 750      TO RECORDS-IN-FILE (1).
038400     MOVE "SQ"     TO XFILE-ORGANIZATION (1).
038500     MOVE "S"      TO XLABEL-TYPE (1).
038600     MOVE 1 TO XRECORD-NUMBER (1).
038700     OPEN OUTPUT SQ-FS1.
038800 WRI-TEST-001.
038900     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-FS1R1-F-G-120.
039000     WRITE SQ-FS1R1-F-G-120.
039100     IF XRECORD-NUMBER (1) EQUAL TO 750
039200              GO TO WRI-WRITE-001.
039300     ADD 1 TO XRECORD-NUMBER (1).
039400     GO TO WRI-TEST-001.
039500 WRI-WRITE-001.
039600     MOVE "CREATE FILE SQ-FS1" TO FEATURE.
039700     MOVE "WRI-TEST-001" TO PAR-NAME.
039800     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
039900     MOVE XRECORD-NUMBER (1) TO CORRECT-18V0.
040000     PERFORM PRINT-DETAIL.
040100 WRI-CLOSE-001.
040200     CLOSE SQ-FS1.
040300 READ-INIT-001.
040400     MOVE 0 TO RECORD-OUT-COUNT, RECORDS-IN-ERROR.
040500     OPEN INPUT SQ-FS1.
040600 READ-TEST-001.
040700     READ SQ-FS1 AT END GO TO READ-TEST-001-01.
040800     MOVE SQ-FS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
040900     ADD 1 TO RECORD-OUT-COUNT
041000     IF RECORD-OUT-COUNT GREATER THAN 750
041100              MOVE "MORE THAN 750 RECORDS" TO RE-MARK
041200              GO TO READ-FAIL-001.
041300     IF RECORD-OUT-COUNT NOT EQUAL TO XRECORD-NUMBER (1)
041400              ADD 1 TO RECORDS-IN-ERROR
041500              GO TO READ-TEST-001.
041600     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS1"
041700              ADD 1 TO RECORDS-IN-ERROR
041800              GO TO READ-TEST-001.
041900     IF XLABEL-TYPE (1) NOT EQUAL TO "S"
042000              ADD 1 TO RECORDS-IN-ERROR.
042100     GO TO READ-TEST-001.
042200 READ-TEST-001-01.
042300     IF RECORDS-IN-ERROR EQUAL TO ZERO
042400              GO TO READ-PASS-001.
042500     MOVE "ERRORS IN READING SQ-FS1" TO RE-MARK.
042600 READ-FAIL-001.
042700     MOVE "RECORDS IN ERROR" TO COMPUTED-A.
042800     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
042900     PERFORM FAIL.
043000     GO TO READ-WRITE-001.
043100 READ-PASS-001.
043200     PERFORM PASS.
043300     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
043400     MOVE RECORD-OUT-COUNT TO CORRECT-18V0.
043500 READ-WRITE-001.
043600     MOVE "READ-TEST-001" TO PAR-NAME.
043700     MOVE "VERIFY FILE SQ-FS1" TO FEATURE.
043800     PERFORM PRINT-DETAIL.
043900 READ-CLOSE-001.
044000     CLOSE SQ-FS1.
044100 SQ202A-END-ROUTINE.
044200     MOVE "END OF SQ202A VALIDATION TESTS" TO PRINT-REC.
044300     WRITE PRINT-REC AFTER ADVANCING 1 LINE.
044400 TERMINATE-SQ202A.
044500     EXIT.
044600 CCVS-EXIT SECTION.
044700 CCVS-999999.
044800     GO TO CLOSE-FILES.
