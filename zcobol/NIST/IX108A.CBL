000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IX108A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*
001400*         NEW TESTS:
001500*
001600*         READ STATEMENT WITH THE PHRASES:
001700*         READ ...  NOT AT END   AND   END-READ
001800*         FOR FORMAT 1 AND 2 OF THE READ STATEMENT
001900*
002000*         DELETE STATEMENT WITH THE PHRASES:
002100*         DELETE ... NOT INVALID  AND  END-DELETE
002200*
002300*         REWRITE STATEMENT WITH THE PHRASES:
002400*         REWRITE  ...   NOT INVALID KEY   AND   END-REWRITE
002500*
002600*         WRITE STATEMENT WITH THE PHRASES:
002700*         WRITE  ...   NOT INVALID KEY   AND  END-WRITE
002800*
002900*
003000*
003100*
003200*       X-CARDS  WHICH MUST BE REPLACED FOR THIS PROGRAM ARE
003300*
003400*             X-24   INDEXED FILE IMPLEMENTOR-NAME IN ASSIGN TO
003500*                    CLAUSE FOR DATA FILE IX-FD1
003600*             X-44   INDEXED FILE IMPLEMENTOR-NAME IN ASSIGN TO
003700*                    CLAUSE FOR INDEX FILE IX-FD1
003800*             X-25   INDEXED FILE IMPLEMENTOR-NAME IN ASSIGN TO
003900*                    CLAUSE FOR DATA FILE IX-FD2
004000*             X-45   INDEXED FILE IMPLEMENTOR-NAME IN ASSIGN TO
004100*                    CLAUSE FOR INDEX FILE IX-FD2
004200*             X-55   IMPLEMENTOR-NAME FOR SYSTEM PRINTER
004300*             X-62   FOR RAW-DATA
004400*             X-82   IMPLEMENTOR-NAME FOR SOURCE-COMPUTER
004500*             X-84   LABEL RECORDS OF PRINT-FILE
004600*
004700*         NOTE:  X-CARDS 45, 62 AND 84   ARE OPTIONAL
004800*               AND NEED ONLY TO BE PRESENT IF THE COMPILER RE-
004900*               QUIRES THIS CODE BE AVAILABLE FOR PROPER PROGRAM
005000*               COMPILATION AND EXECUTION. IF THE VP-ROUTINE IS
005100*               USED THE  X-CARDS MAY BE AUTOMATICALLY SELECTED
005200*               FOR INCLUSION IN THE PROGRAM BY SPECIFYING THE
005300*               APPROPRIATE LETTER IN THE "*OPT" VP-ROUTINE
005400*               CONTROL CARD. THE LETTER  CORRESPONDS TO A
005500*               CHARACTER IN POSITION 7 OF THE SOURCE LINE AND
005600*               THEY ARE AS FOLLOWS
005700*
005800*                  J  SELECTS X-CARD 45
005900*
006000******************************************************
006100 ENVIRONMENT DIVISION.
006200 CONFIGURATION SECTION.
006300 SOURCE-COMPUTER.
006400     XXXXX082.
006500 OBJECT-COMPUTER.
006600     XXXXX083.
006700 INPUT-OUTPUT SECTION.
006800 FILE-CONTROL.
006900P    SELECT RAW-DATA   ASSIGN TO
007000P    XXXXX062
007100P           ORGANIZATION IS INDEXED
007200P           ACCESS MODE IS RANDOM
007300P           RECORD KEY IS RAW-DATA-KEY.
007400     SELECT PRINT-FILE ASSIGN TO
007500     XXXXX055.
007600     SELECT   IX-FS1 ASSIGN
007700     XXXXX024
007800J    XXXXX044
007900             ORGANIZATION IS INDEXED
008000        ACCESS SEQUENTIAL
008100        FILE STATUS IS IX-FS1-STATUS
008200        RECORD  IX-FS1-KEY.
008300     SELECT   IX-FS2 ASSIGN
008400     XXXXX025
008500J    XXXXX045
008600             ORGANIZATION IS INDEXED
008700        ACCESS RANDOM
008800        FILE STATUS IS IX-FS2-STATUS
008900        RECORD  IX-FS2-KEY.
009000 DATA DIVISION.
009100 FILE SECTION.
009200P
009300PFD  RAW-DATA.
009400P
009500P01  RAW-DATA-SATZ.
009600P    05  RAW-DATA-KEY        PIC X(6).
009700P    05  C-DATE              PIC 9(6).
009800P    05  C-TIME              PIC 9(8).
009900P    05  C-NO-OF-TESTS       PIC 99.
010000P    05  C-OK                PIC 999.
010100P    05  C-ALL               PIC 999.
010200P    05  C-FAIL              PIC 999.
010300P    05  C-DELETED           PIC 999.
010400P    05  C-INSPECT           PIC 999.
010500P    05  C-NOTE              PIC X(13).
010600P    05  C-INDENT            PIC X.
010700P    05  C-ABORT             PIC X(8).
010800 FD  PRINT-FILE.
010900 01  PRINT-REC PICTURE X(120).
011000 01  DUMMY-RECORD PICTURE X(120).
011100 FD  IX-FS1
011200C    LABEL RECORDS ARE STANDARD
011300C    DATA RECORDS IX-FS1R1-F-G-240
011400     BLOCK CONTAINS 480.
011500
011600 01  IX-FS1R1-F-G-240.
011700     05 IX-FS1-REC-120    PIC X(120).
011800     05 IX-FS1-REC-120-240.
011900     10  FILLER PICTURE X(8).
012000     10  IX-FS1-KEY PIC X(29).
012100     10  FILLER PIC X(83).
012200
012300 FD  IX-FS2
012400C    LABEL RECORDS ARE STANDARD
012500C    DATA RECORDS IX-FS2R1-F-G-240
012600     BLOCK CONTAINS 480.
012700
012800 01  IX-FS2R1-F-G-240.
012900     05 IX-FS2-REC-120    PIC X(120).
013000     05 IX-FS2-REC-120-240.
013100     10  FILLER PICTURE X(8).
013200     10  IX-FS2-KEY PIC X(29).
013300     10  FILLER PIC X(83).
013400 WORKING-STORAGE SECTION.
013500 01  SWITCHES-FOR-TEST.
013600     05  SWITCH-NOT-INVALID    PIC 9 VALUE ZERO.
013700     05  SWITCH-END-XXX        PIC 9 VALUE ZERO.
013800     05  SWITCH-END-X9X        PIC 9 VALUE ZERO.
013900     05  SWITCH-IF             PIC 9 VALUE ZERO.
014000 01  GRP-0101.
014100     02 FILLER PIC X(10) VALUE "ABCD921XYZ".
014200     02  WRK-DU-09V00-001 PIC 9(9) VALUE ZERO.
014300     02 FILLER PIC X(10) VALUE "Z2F()$+-AB".
014400 01  GRP-0001.
014500     05 WRK-CS-09V00-012  PIC S9(9) USAGE COMP  VALUE ZERO.
014600     05 WRK-CS-09V00-013  PIC S9(9) USAGE COMP  VALUE ZERO.
014700     05 WRK-CS-09V00-014  PIC S9(9) USAGE COMP  VALUE ZERO.
014800     05 WRK-CS-09V00-015  PIC S9(9) USAGE COMP  VALUE ZERO.
014900     05 WRK-CS-09V00-016  PIC S9(9) USAGE COMP  VALUE ZERO.
015000     05 WRK-CS-09V00-017  PIC S9(9) USAGE COMP  VALUE ZERO.
015100     05 WRK-CS-09V00-018  PIC S9(9) USAGE COMP  VALUE ZERO.
015200     05 IX-FS1-STATUS     PIC  XX  VALUE  SPACE.
015300     05 IX-FS2-STATUS     PIC  XX  VALUE  SPACE.
015400     05 WRK-XN-0002-001   PIC  X(2) VALUE  SPACE.
015500     05 WRK-XN-0002-002   PIC  X(2) VALUE  SPACE.
015600     05 WRK-XN-0002-003   PIC  X(2) VALUE  SPACE.
015700     05 WRK-XN-0002-004   PIC  X(2) VALUE  SPACE.
015800     05 WRK-XN-0002-005   PIC  X(2) VALUE  SPACE.
015900     05 WRK-XN-0002-006   PIC  X(2) VALUE  SPACE.
016000     05 WRK-XN-0002-007   PIC  X(2) VALUE  SPACE.
016100     05 WRK-XN-0002-008   PIC  X(2) VALUE  SPACE.
016200     05 WRK-XN-0002-009   PIC  X(2) VALUE  SPACE.
016300 01  DUMMY-WRK-REC.
016400     02 DUMMY-WRK1       PIC X(120).
016500     02 DUMMY-WRK2  REDEFINES  DUMMY-WRK1.
016600        03 FILLER   PIC X(5).
016700        03 DUMMY-WRK-INDENT-5  PIC X(115).
016800 01  FILE-RECORD-INFORMATION-REC.
016900     03 FILE-RECORD-INFO-SKELETON.
017000        05 FILLER                 PICTURE X(48)       VALUE
017100             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
017200        05 FILLER                 PICTURE X(46)       VALUE
017300             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
017400        05 FILLER                 PICTURE X(26)       VALUE
017500             ",LFIL=000000,ORG=  ,LBLR= ".
017600        05 FILLER                 PICTURE X(37)       VALUE
017700             ",RECKEY=                             ".
017800        05 FILLER                 PICTURE X(38)       VALUE
017900             ",ALTKEY1=                             ".
018000        05 FILLER                 PICTURE X(38)       VALUE
018100             ",ALTKEY2=                             ".
018200        05 FILLER                 PICTURE X(7)        VALUE SPACE.
018300     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
018400        05 FILE-RECORD-INFO-P1-120.
018500           07 FILLER              PIC X(5).
018600           07 XFILE-NAME           PIC X(6).
018700           07 FILLER              PIC X(8).
018800           07 XRECORD-NAME         PIC X(6).
018900           07 FILLER              PIC X(1).
019000           07 REELUNIT-NUMBER     PIC 9(1).
019100           07 FILLER              PIC X(7).
019200           07 XRECORD-NUMBER       PIC 9(6).
019300           07 FILLER              PIC X(6).
019400           07 UPDATE-NUMBER       PIC 9(2).
019500           07 FILLER              PIC X(5).
019600           07 ODO-NUMBER          PIC 9(4).
019700           07 FILLER              PIC X(5).
019800           07 XPROGRAM-NAME        PIC X(5).
019900           07 FILLER              PIC X(7).
020000           07 XRECORD-LENGTH       PIC 9(6).
020100           07 FILLER              PIC X(7).
020200           07 CHARS-OR-RECORDS    PIC X(2).
020300           07 FILLER              PIC X(1).
020400           07 XBLOCK-SIZE          PIC 9(4).
020500           07 FILLER              PIC X(6).
020600           07 RECORDS-IN-FILE     PIC 9(6).
020700           07 FILLER              PIC X(5).
020800           07 XFILE-ORGANIZATION   PIC X(2).
020900           07 FILLER              PIC X(6).
021000           07 XLABEL-TYPE          PIC X(1).
021100        05 FILE-RECORD-INFO-P121-240.
021200           07 FILLER              PIC X(8).
021300           07 XRECORD-KEY          PIC X(29).
021400           07 FILLER              PIC X(9).
021500           07 ALTERNATE-KEY1      PIC X(29).
021600           07 FILLER              PIC X(9).
021700           07 ALTERNATE-KEY2      PIC X(29).
021800           07 FILLER              PIC X(7).
021900 01  TEST-RESULTS.
022000     02 FILLER                   PIC X      VALUE SPACE.
022100     02 FEATURE                  PIC X(20)  VALUE SPACE.
022200     02 FILLER                   PIC X      VALUE SPACE.
022300     02 P-OR-F                   PIC X(5)   VALUE SPACE.
022400     02 FILLER                   PIC X      VALUE SPACE.
022500     02  PAR-NAME.
022600       03 FILLER                 PIC X(19)  VALUE SPACE.
022700       03  PARDOT-X              PIC X      VALUE SPACE.
022800       03 DOTVALUE               PIC 99     VALUE ZERO.
022900     02 FILLER                   PIC X(8)   VALUE SPACE.
023000     02 RE-MARK                  PIC X(61).
023100 01  TEST-COMPUTED.
023200     02 FILLER                   PIC X(30)  VALUE SPACE.
023300     02 FILLER                   PIC X(17)  VALUE
023400            "       COMPUTED=".
023500     02 COMPUTED-X.
023600     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
023700     03 COMPUTED-N               REDEFINES COMPUTED-A
023800                                 PIC -9(9).9(9).
023900     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
024000     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
024100     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
024200     03       CM-18V0 REDEFINES COMPUTED-A.
024300         04 COMPUTED-18V0                    PIC -9(18).
024400         04 FILLER                           PIC X.
024500     03 FILLER PIC X(50) VALUE SPACE.
024600 01  TEST-CORRECT.
024700     02 FILLER PIC X(30) VALUE SPACE.
024800     02 FILLER PIC X(17) VALUE "       CORRECT =".
024900     02 CORRECT-X.
025000     03 CORRECT-A                  PIC X(20) VALUE SPACE.
025100     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
025200     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
025300     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
025400     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
025500     03      CR-18V0 REDEFINES CORRECT-A.
025600         04 CORRECT-18V0                     PIC -9(18).
025700         04 FILLER                           PIC X.
025800     03 FILLER PIC X(2) VALUE SPACE.
025900     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
026000 01  CCVS-C-1.
026100     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
026200-    "SS  PARAGRAPH-NAME
026300-    "       REMARKS".
026400     02 FILLER                     PIC X(20)    VALUE SPACE.
026500 01  CCVS-C-2.
026600     02 FILLER                     PIC X        VALUE SPACE.
026700     02 FILLER                     PIC X(6)     VALUE "TESTED".
026800     02 FILLER                     PIC X(15)    VALUE SPACE.
026900     02 FILLER                     PIC X(4)     VALUE "FAIL".
027000     02 FILLER                     PIC X(94)    VALUE SPACE.
027100 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
027200 01  REC-CT                        PIC 99       VALUE ZERO.
027300 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
027400 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
027500 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
027600 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
027700 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
027800 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
027900 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
028000 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
028100 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
028200 01  CCVS-H-1.
028300     02  FILLER                    PIC X(39)    VALUE SPACES.
028400     02  FILLER                    PIC X(42)    VALUE
028500     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
028600     02  FILLER                    PIC X(39)    VALUE SPACES.
028700 01  CCVS-H-2A.
028800   02  FILLER                        PIC X(40)  VALUE SPACE.
028900   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
029000   02  FILLER                        PIC XXXX   VALUE
029100     "4.2 ".
029200   02  FILLER                        PIC X(28)  VALUE
029300            " COPY - NOT FOR DISTRIBUTION".
029400   02  FILLER                        PIC X(41)  VALUE SPACE.
029500
029600 01  CCVS-H-2B.
029700   02  FILLER                        PIC X(15)  VALUE
029800            "TEST RESULT OF ".
029900   02  TEST-ID                       PIC X(9).
030000   02  FILLER                        PIC X(4)   VALUE
030100            " IN ".
030200   02  FILLER                        PIC X(12)  VALUE
030300     " HIGH       ".
030400   02  FILLER                        PIC X(22)  VALUE
030500            " LEVEL VALIDATION FOR ".
030600   02  FILLER                        PIC X(58)  VALUE
030700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
030800 01  CCVS-H-3.
030900     02  FILLER                      PIC X(34)  VALUE
031000            " FOR OFFICIAL USE ONLY    ".
031100     02  FILLER                      PIC X(58)  VALUE
031200     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
031300     02  FILLER                      PIC X(28)  VALUE
031400            "  COPYRIGHT   1985 ".
031500 01  CCVS-E-1.
031600     02 FILLER                       PIC X(52)  VALUE SPACE.
031700     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
031800     02 ID-AGAIN                     PIC X(9).
031900     02 FILLER                       PIC X(45)  VALUE SPACES.
032000 01  CCVS-E-2.
032100     02  FILLER                      PIC X(31)  VALUE SPACE.
032200     02  FILLER                      PIC X(21)  VALUE SPACE.
032300     02 CCVS-E-2-2.
032400         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
032500         03 FILLER                   PIC X      VALUE SPACE.
032600         03 ENDER-DESC               PIC X(44)  VALUE
032700            "ERRORS ENCOUNTERED".
032800 01  CCVS-E-3.
032900     02  FILLER                      PIC X(22)  VALUE
033000            " FOR OFFICIAL USE ONLY".
033100     02  FILLER                      PIC X(12)  VALUE SPACE.
033200     02  FILLER                      PIC X(58)  VALUE
033300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
033400     02  FILLER                      PIC X(13)  VALUE SPACE.
033500     02 FILLER                       PIC X(15)  VALUE
033600             " COPYRIGHT 1985".
033700 01  CCVS-E-4.
033800     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
033900     02 FILLER                       PIC X(4)   VALUE " OF ".
034000     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
034100     02 FILLER                       PIC X(40)  VALUE
034200      "  TESTS WERE EXECUTED SUCCESSFULLY".
034300 01  XXINFO.
034400     02 FILLER                       PIC X(19)  VALUE
034500            "*** INFORMATION ***".
034600     02 INFO-TEXT.
034700       04 FILLER                     PIC X(8)   VALUE SPACE.
034800       04 XXCOMPUTED                 PIC X(20).
034900       04 FILLER                     PIC X(5)   VALUE SPACE.
035000       04 XXCORRECT                  PIC X(20).
035100     02 INF-ANSI-REFERENCE           PIC X(48).
035200 01  HYPHEN-LINE.
035300     02 FILLER  PIC IS X VALUE IS SPACE.
035400     02 FILLER  PIC IS X(65)    VALUE IS "************************
035500-    "*****************************************".
035600     02 FILLER  PIC IS X(54)    VALUE IS "************************
035700-    "******************************".
035800 01  CCVS-PGM-ID                     PIC X(9)   VALUE
035900     "IX108A".
036000 PROCEDURE DIVISION.
036100 DECLARATIVES.
036200 IX-FS2-01 SECTION.
036300     USE    AFTER STANDARD ERROR PROCEDURE ON IX-FS2.
036400 IX-FS2-01-01.
036500     ADD      1 TO  WRK-CS-09V00-013.
036600     GO TO    IX-FS2-01-03
036700              IX-FS2-01-05
036800              DEPENDING ON  WRK-CS-09V00-012.
036900     GO TO    IX-FS2-01-EXIT.
037000 IX-FS2-01-03.
037100*ENTRY FROM SEGMENT INX-TEST-001.
037200*    SHOULD NOT ENTER HERE UNLESS SPACE ALLOCATION TOO SMALL.
037300     ADD     1 TO  WRK-CS-09V00-014.
037400 IX-FS2-01-05.
037500     ADD      1 TO WRK-CS-09V00-017.
037600     IF       XRECORD-NUMBER (2) EQUAL TO 500
037700              MOVE   IX-FS2-STATUS TO WRK-XN-0002-002
037800              MOVE  "10" TO WRK-XN-0002-003.
037900 IX-FS2-01-EXIT.
038000     EXIT.
038100 END DECLARATIVES.
038200 CCVS1 SECTION.
038300 OPEN-FILES.
038400P    OPEN I-O RAW-DATA.
038500P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
038600P    READ RAW-DATA INVALID KEY GO TO END-E-1.
038700P    MOVE "ABORTED " TO C-ABORT.
038800P    ADD 1 TO C-NO-OF-TESTS.
038900P    ACCEPT C-DATE  FROM DATE.
039000P    ACCEPT C-TIME  FROM TIME.
039100P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
039200PEND-E-1.
039300P    CLOSE RAW-DATA.
039400     OPEN    OUTPUT PRINT-FILE.
039500     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
039600     MOVE    SPACE TO TEST-RESULTS.
039700     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
039800     MOVE    ZERO TO REC-SKL-SUB.
039900     PERFORM CCVS-INIT-FILE 9 TIMES.
040000 CCVS-INIT-FILE.
040100     ADD     1 TO REC-SKL-SUB.
040200     MOVE    FILE-RECORD-INFO-SKELETON
040300          TO FILE-RECORD-INFO (REC-SKL-SUB).
040400 CCVS-INIT-EXIT.
040500     GO TO CCVS1-EXIT.
040600 CLOSE-FILES.
040700P    OPEN I-O RAW-DATA.
040800P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
040900P    READ RAW-DATA INVALID KEY GO TO END-E-2.
041000P    MOVE "OK.     " TO C-ABORT.
041100P    MOVE PASS-COUNTER TO C-OK.
041200P    MOVE ERROR-HOLD   TO C-ALL.
041300P    MOVE ERROR-COUNTER TO C-FAIL.
041400P    MOVE DELETE-COUNTER TO C-DELETED.
041500P    MOVE INSPECT-COUNTER TO C-INSPECT.
041600P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
041700PEND-E-2.
041800P    CLOSE RAW-DATA.
041900     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
042000 TERMINATE-CCVS.
042100S    EXIT PROGRAM.
042200STERMINATE-CALL.
042300     STOP     RUN.
042400 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
042500 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
042600 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
042700 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
042800     MOVE "****TEST DELETED****" TO RE-MARK.
042900 PRINT-DETAIL.
043000     IF REC-CT NOT EQUAL TO ZERO
043100             MOVE "." TO PARDOT-X
043200             MOVE REC-CT TO DOTVALUE.
043300     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
043400     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
043500        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
043600          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
043700     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
043800     MOVE SPACE TO CORRECT-X.
043900     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
044000     MOVE     SPACE TO RE-MARK.
044100 HEAD-ROUTINE.
044200     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044300     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044400     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
044500     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
044600 COLUMN-NAMES-ROUTINE.
044700     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
044800     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
045000 END-ROUTINE.
045100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
045200 END-RTN-EXIT.
045300     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045400 END-ROUTINE-1.
045500      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
045600      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
045700      ADD PASS-COUNTER TO ERROR-HOLD.
045800*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
045900      MOVE PASS-COUNTER TO CCVS-E-4-1.
046000      MOVE ERROR-HOLD TO CCVS-E-4-2.
046100      MOVE CCVS-E-4 TO CCVS-E-2-2.
046200      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
046300  END-ROUTINE-12.
046400      MOVE "TEST(S) FAILED" TO ENDER-DESC.
046500     IF       ERROR-COUNTER IS EQUAL TO ZERO
046600         MOVE "NO " TO ERROR-TOTAL
046700         ELSE
046800         MOVE ERROR-COUNTER TO ERROR-TOTAL.
046900     MOVE     CCVS-E-2 TO DUMMY-RECORD.
047000     PERFORM WRITE-LINE.
047100 END-ROUTINE-13.
047200     IF DELETE-COUNTER IS EQUAL TO ZERO
047300         MOVE "NO " TO ERROR-TOTAL  ELSE
047400         MOVE DELETE-COUNTER TO ERROR-TOTAL.
047500     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
047600     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
047700      IF   INSPECT-COUNTER EQUAL TO ZERO
047800          MOVE "NO " TO ERROR-TOTAL
047900      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
048000      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
048100      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
048200     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
048300 WRITE-LINE.
048400     ADD 1 TO RECORD-COUNT.
048500Y    IF RECORD-COUNT GREATER 42
048600Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
048700Y        MOVE SPACE TO DUMMY-RECORD
048800Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
048900Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
049000Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
049100Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
049200Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
049300Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
049400Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
049500Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
049600Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
049700Y        MOVE ZERO TO RECORD-COUNT.
049800     PERFORM WRT-LN.
049900 WRT-LN.
050000     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
050100     MOVE SPACE TO DUMMY-RECORD.
050200 BLANK-LINE-PRINT.
050300     PERFORM WRT-LN.
050400 FAIL-ROUTINE.
050500     IF     COMPUTED-X NOT EQUAL TO SPACE
050600            GO TO   FAIL-ROUTINE-WRITE.
050700     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
050800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
050900     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
051000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
051100     MOVE   SPACES TO INF-ANSI-REFERENCE.
051200     GO TO  FAIL-ROUTINE-EX.
051300 FAIL-ROUTINE-WRITE.
051400     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
051500     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
051600     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
051700     MOVE   SPACES TO COR-ANSI-REFERENCE.
051800 FAIL-ROUTINE-EX. EXIT.
051900 BAIL-OUT.
052000     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
052100     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
052200 BAIL-OUT-WRITE.
052300     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
052400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
052500     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
052600     MOVE   SPACES TO INF-ANSI-REFERENCE.
052700 BAIL-OUT-EX. EXIT.
052800 CCVS1-EXIT.
052900     EXIT.
053000 SECT-IX-04-001 SECTION.
053100******************************************************************
053200*                                                                *
053300*   TEST  1   CREATE INDEXED FILE IX-FS2                         *
053400*                                                                *
053500******************************************************************
053600 WRITE-INIT-GF-01.
053700     MOVE     "WRITE NOT INVALID END-" TO  FEATURE.
053800     MOVE     "IX-FS2"        TO  XFILE-NAME (2).
053900     MOVE     "R1-F-G"        TO  XRECORD-NAME (2).
054000     MOVE     CCVS-PGM-ID     TO  XPROGRAM-NAME (2).
054100     MOVE     000240          TO  XRECORD-LENGTH (2).
054200     MOVE     "RC"            TO  CHARS-OR-RECORDS (2).
054300     MOVE     0001            TO  XBLOCK-SIZE       (2).
054400     MOVE     000500          TO  RECORDS-IN-FILE  (2).
054500     MOVE    "IX"                TO XFILE-ORGANIZATION (2).
054600     MOVE    "WRITE-TEST-GF-01" TO PAR-NAME.
054700     MOVE     "S"             TO  XLABEL-TYPE        (2).
054800     MOVE     000001          TO  XRECORD-NUMBER     (2).
054900     MOVE     1         TO  WRK-CS-09V00-012.
055000     MOVE     ZERO      TO  WRK-CS-09V00-013 WRK-CS-09V00-014
055100                            WRK-CS-09V00-015 WRK-CS-09V00-016
055200                            WRK-CS-09V00-017 WRK-CS-09V00-018.
055300     MOVE     SPACE     TO  IX-FS1-STATUS.
055400     MOVE     SPACE     TO  IX-FS2-STATUS.
055500     MOVE    ZERO TO WRK-DU-09V00-001.
055600     OPEN     OUTPUT    IX-FS1.
055700     OPEN     OUTPUT    IX-FS2.
055800     MOVE GRP-0101 TO IX-FS2-KEY.
055900     MOVE     IX-FS2-STATUS TO WRK-XN-0002-001.
056000 WRITE-TEST-GF-01.
056100     MOVE ZERO TO SWITCH-NOT-INVALID.
056200     MOVE ZERO TO SWITCH-END-XXX.
056300     MOVE ZERO TO SWITCH-END-X9X.
056400     MOVE    "99"  TO IX-FS2-STATUS.
056500     MOVE     XRECORD-NUMBER (2) TO WRK-DU-09V00-001.
056600     MOVE     GRP-0101 TO XRECORD-KEY (2).
056700     MOVE     "IX-FS2"        TO  XFILE-NAME (2).
056800     MOVE     FILE-RECORD-INFO (2) TO IX-FS2R1-F-G-240.
056900 WRITE-TEST-GF-01-1.
057000     WRITE   IX-FS2R1-F-G-240
057100       NOT INVALID
057200         MOVE 1 TO SWITCH-NOT-INVALID.
057300     IF SWITCH-NOT-INVALID = 1
057400         MOVE 0 TO SWITCH-NOT-INVALID
057500      ELSE
057600         MOVE "WRITE NOT INVALID" TO FEATURE
057700         PERFORM FAIL
057800         MOVE "FILE IX-FS2 CANNOT BE CREATED CORRECTLY; IX-41"
057900              TO RE-MARK
058000         GO TO CCVS-EXIT.
058100 WRITE-TEST-GF-01-2.
058200     MOVE ZERO TO SWITCH-NOT-INVALID.
058300     MOVE ZERO TO SWITCH-END-XXX.
058400     MOVE ZERO TO SWITCH-END-X9X.
058500     MOVE     "IX-FS1"        TO  XFILE-NAME (2).
058600     WRITE   IX-FS1R1-F-G-240 FROM FILE-RECORD-INFO (2)
058700          INVALID KEY GO TO WRITE-TEST-GF-01-2-1
058800          NOT INVALID
058900         MOVE 1 TO SWITCH-NOT-INVALID
059000      END-WRITE.
059100 WRITE-TEST-GF-01-2-1.
059200         MOVE 1 TO SWITCH-END-XXX.
059300     IF SWITCH-NOT-INVALID = 1
059400         MOVE 0 TO SWITCH-NOT-INVALID
059500      ELSE
059600         MOVE "WRITE NOT INVALID" TO FEATURE
059700         PERFORM FAIL
059800         MOVE "FILE IX-FS1 CANNOT BE CREATED CORRECTLY; IX-41"
059900              TO RE-MARK
060000         GO TO CCVS-EXIT.
060100     IF SWITCH-END-XXX     = 1
060200         MOVE 0 TO SWITCH-END-XXX
060300      ELSE
060400         MOVE "WRITE .. END-WRITE" TO FEATURE
060500         MOVE "FILE IX-FS1 CANNOT BE CREATED CORRECTLY; IX-41"
060600              TO RE-MARK
060700         PERFORM FAIL
060800         GO TO CCVS-EXIT.
060900     IF        IX-FS2-STATUS NOT EQUAL TO "00"
061000         ADD  1  TO WRK-CS-09V00-016.
061100     IF        IX-FS1-STATUS NOT EQUAL TO "00"
061200         ADD  1  TO WRK-CS-09V00-016.
061300     IF       XRECORD-NUMBER (2) EQUAL TO 100
061400              GO TO  WRITE-TEST-GF-01-3.
061500     ADD      01 TO  XRECORD-NUMBER (2).
061600     GO TO    WRITE-TEST-GF-01.
061700 WRITE-TEST-GF-01-3.
061800     IF       WRK-CS-09V00-014 NOT EQUAL TO ZERO
061900              MOVE "EXCEPTIONS/ERRORS" TO RE-MARK
062000              MOVE  ZERO TO CORRECT-18V0
062100              MOVE WRK-CS-09V00-014 TO COMPUTED-18V0
062200              MOVE "IX-41 4.9.2                       " TO RE-MARK
062300              PERFORM   FAIL
062400              ELSE
062500              PERFORM   PASS.
062600     PERFORM  PRINT-DETAIL.
062700 WRITE-TEST-GF-02.
062800     MOVE     "CREATE IX-FS2" TO  FEATURE
062900     MOVE    "WRITE-TEST-GF-02" TO PAR-NAME.
063000     IF       XRECORD-NUMBER (2) NOT EQUAL TO 100
063100              MOVE "INCORRECT COUNT" TO RE-MARK
063200              MOVE  500 TO CORRECT-18V0
063300             MOVE   XRECORD-NUMBER (2)  TO COMPUTED-18V0
063400              MOVE "IX-41 4.9.2                       " TO RE-MARK
063500              PERFORM  FAIL
063600              ELSE
063700              PERFORM PASS.
063800     PERFORM  PRINT-DETAIL.
063900
064000     CLOSE IX-FS1 IX-FS2.
064100
064200******************************************************************
064300*                                                                *
064400*   TESTS:      R E A D         NOT INVALID    END-READ          *
064500*                                                                *
064600******************************************************************
064700 READ-INIT-F1-01.
064800     OPEN INPUT IX-FS1.
064900     MOVE "READ-TEST-F1-01" TO PAR-NAME.
065000     MOVE "READ NOT AT END  " TO FEATURE.
065100     MOVE     ZERO  TO  SWITCH-NOT-INVALID.
065200     MOVE     ZERO  TO  SWITCH-END-XXX.
065300 READ-TEST-F1-01-0.
065400     READ  IX-FS1 AT END
065500              GO TO READ-FAIL-F1-01
065600          NOT AT END
065700           MOVE 1 TO SWITCH-NOT-INVALID.
065800 READ-TEST-F1-01.
065900     IF SWITCH-NOT-INVALID = 1
066000          GO TO READ-PASS-F1-01.
066100 READ-FAIL-F1-01.
066200     MOVE "IX-28 4.5.4 (11) C                        " TO RE-MARK.
066300     PERFORM FAIL.
066400     GO TO READ-WRITE-F1-01.
066500 READ-PASS-F1-01.
066600     PERFORM PASS.
066700 READ-WRITE-F1-01.
066800     PERFORM PRINT-DETAIL.
066900
067000******************************************************************
067100*   TEST  READ .. NOT AT END   ... END-READ.                     *
067200*                                                                *
067300*         IX-28, 4.5.4                                           *
067400******************************************************************
067500 READ-INIT-F1-02.
067600     MOVE "READ-TEST-F1-02-1" TO PAR-NAME.
067700     MOVE "READ . NOT INV. . END-" TO FEATURE.
067800     MOVE     ZERO  TO  SWITCH-NOT-INVALID.
067900     MOVE     ZERO  TO  SWITCH-END-XXX.
068000 READ-TEST-F1-02.
068100     READ  IX-FS1 AT END
068200              GO TO READ-FAIL-F1-02-1
068300          NOT END
068400           MOVE 1 TO SWITCH-NOT-INVALID
068500        END-READ.
068600     MOVE 1 TO SWITCH-END-XXX.
068700 READ-TEST-F1-02-1.
068800     IF SWITCH-NOT-INVALID = 1
068900          GO TO READ-PASS-F1-02-1.
069000 READ-FAIL-F1-02-1.
069100     MOVE "IX-28 4.5.4 (11) C                        " TO RE-MARK.
069200     PERFORM FAIL.
069300     GO TO READ-WRITE-F1-02-1.
069400 READ-PASS-F1-02-1.
069500     PERFORM PASS.
069600 READ-WRITE-F1-02-1.
069700     PERFORM PRINT-DETAIL.
069800
069900 READ-TEST-F1-02-2.
070000     MOVE "READ-TEST-F1-02-2" TO PAR-NAME.
070100     MOVE "END-READ.        " TO FEATURE.
070200     IF SWITCH-END-XXX     = 1
070300          GO TO READ-PASS-F1-02-2.
070400 READ-FAIL-F1-02-2.
070500     MOVE "IX-32 4.5.4 (19)                          " TO RE-MARK.
070600     PERFORM FAIL.
070700     GO TO READ-WRITE-F1-02-2.
070800 READ-PASS-F1-02-2.
070900     PERFORM PASS.
071000 READ-WRITE-F1-02-2.
071100     PERFORM PRINT-DETAIL.
071200
071300******************************************************************
071400*   TEST: IF READ .. NOT AT END   ... END-READ ...      .        *
071500*                                                                *
071600*         IX-28, 4.5.4                                           *
071700******************************************************************
071800 READ-INIT-F1-03.
071900     MOVE "READ-TEST-F1-03-1" TO PAR-NAME.
072000     MOVE "IF . READ . NOT INV. . END-" TO FEATURE.
072100     MOVE     ZERO  TO  SWITCH-NOT-INVALID.
072200     MOVE     ZERO  TO  SWITCH-END-XXX.
072300     MOVE    1      TO  SWITCH-IF.
072400 READ-TEST-F1-03.
072500     IF SWITCH-IF = 1
072600        READ  IX-FS1 AT END
072700              GO TO READ-FAIL-F1-03-1
072800          NOT END
072900             MOVE 1 TO SWITCH-NOT-INVALID
073000        END-READ
073100             MOVE 1 TO SWITCH-END-XXX.
073200     MOVE 9 TO SWITCH-END-X9X.
073300 READ-TEST-F1-03-1.
073400     IF SWITCH-NOT-INVALID = 1
073500          GO TO READ-PASS-F1-03-1.
073600 READ-FAIL-F1-03-1.
073700     MOVE "IX-28 4.5.4 (11) C                        " TO RE-MARK.
073800     PERFORM FAIL.
073900     GO TO READ-WRITE-F1-03-1.
074000 READ-PASS-F1-03-1.
074100     PERFORM PASS.
074200 READ-WRITE-F1-03-1.
074300     PERFORM PRINT-DETAIL.
074400
074500 READ-TEST-F1-03-2.
074600     MOVE "READ-TEST-F1-03-2" TO PAR-NAME.
074700     IF SWITCH-END-XXX     = 1
074800          GO TO READ-PASS-F1-03-2.
074900 READ-FAIL-F1-03-2.
075000     MOVE "IX-32 4.5.4 (19)                          " TO RE-MARK.
075100     PERFORM FAIL.
075200     GO TO READ-WRITE-F1-03-2.
075300 READ-PASS-F1-03-2.
075400     PERFORM PASS.
075500 READ-WRITE-F1-03-2.
075600     PERFORM PRINT-DETAIL.
075700
075800 READ-TEST-F1-03-3.
075900     MOVE "READ-TEST-F1-03-3" TO PAR-NAME.
076000     IF SWITCH-END-X9X     = 9
076100          GO TO READ-PASS-F1-03-3.
076200 READ-FAIL-F1-03-3.
076300     MOVE "IX-32 4.5.4 (19)                          " TO RE-MARK.
076400     PERFORM FAIL.
076500     GO TO READ-WRITE-F1-03-3.
076600 READ-PASS-F1-03-3.
076700     PERFORM PASS.
076800 READ-WRITE-F1-03-3.
076900     PERFORM PRINT-DETAIL.
077000
077100     CLOSE IX-FS1.
077200
077300******************************************************************
077400*   TEST  READ    NOT INVALID                                    *
077500*                                                                *
077600*         IX-28, 4.5.4                                           *
077700******************************************************************
077800 READ-INIT-F2-01.
077900     MOVE     2     TO  WRK-CS-09V00-012.
078000     MOVE     ZERO  TO  WRK-CS-09V00-013.
078100     MOVE     ZERO  TO  WRK-CS-09V00-014.
078200     MOVE     ZERO  TO  WRK-CS-09V00-015.
078300     MOVE     ZERO  TO  WRK-CS-09V00-016.
078400     MOVE     ZERO  TO  WRK-CS-09V00-017.
078500     MOVE     ZERO  TO  WRK-CS-09V00-018.
078600     MOVE    SPACE TO IX-FS2-STATUS.
078700     OPEN     I-O  IX-FS2.
078800     MOVE     SPACE     TO  WRK-XN-0002-002
078900     MOVE     SPACE     TO  WRK-XN-0002-003
079000     MOVE     SPACE     TO  WRK-XN-0002-004
079100     MOVE      IX-FS2-STATUS TO WRK-XN-0002-001
079200     MOVE      IX-FS2-STATUS TO WRK-XN-0002-001
079300     MOVE     SPACE TO IX-FS2-STATUS.
079400     MOVE "READ-TEST-F2-01" TO PAR-NAME.
079500     MOVE "READ NOT INVALID." TO FEATURE.
079600     MOVE     ZERO  TO  SWITCH-NOT-INVALID.
079700     MOVE     ZERO  TO  SWITCH-END-XXX.
079800 READ-TEST-F2-01-0.
079900     MOVE 1 TO WRK-DU-09V00-001.
080000     MOVE GRP-0101  TO IX-FS2-KEY.
080100     READ  IX-FS2 INVALID
080200              GO TO READ-FAIL-F2-01
080300          NOT INVALID
080400           MOVE 1 TO SWITCH-NOT-INVALID.
080500 READ-TEST-F2-01.
080600     IF SWITCH-NOT-INVALID = 1
080700          GO TO READ-PASS-F2-01.
080800 READ-FAIL-F2-01.
080900     MOVE "IX-28 4.5.4 (11) C                        " TO RE-MARK.
081000     PERFORM FAIL.
081100     GO TO READ-WRITE-F2-01.
081200 READ-PASS-F2-01.
081300     PERFORM PASS.
081400 READ-WRITE-F2-01.
081500     PERFORM PRINT-DETAIL.
081600
081700******************************************************************
081800*   TEST  READ .. NOT INVALID  ... END-READ.                     *
081900*                                                                *
082000*         IX-28, 4.5.4                                           *
082100******************************************************************
082200 READ-INIT-F2-02.
082300     MOVE "READ-TEST-F2-02-1" TO PAR-NAME.
082400     MOVE "READ . NOT INV. . END-" TO FEATURE.
082500     MOVE     ZERO  TO  SWITCH-NOT-INVALID.
082600     MOVE     ZERO  TO  SWITCH-END-XXX.
082700 READ-TEST-F2-02.
082800     MOVE 2 TO WRK-DU-09V00-001.
082900     MOVE GRP-0101  TO IX-FS2-KEY.
083000     READ  IX-FS2 INVALID KEY
083100              GO TO READ-FAIL-F2-02-1
083200          NOT INVALID KEY
083300           MOVE 1 TO SWITCH-NOT-INVALID
083400        END-READ.
083500     MOVE 1 TO SWITCH-END-XXX.
083600 READ-TEST-F2-02-1.
083700     IF SWITCH-NOT-INVALID = 1
083800          GO TO READ-PASS-F2-02-1.
083900 READ-FAIL-F2-02-1.
084000     MOVE "IX-28 4.5.4 (11) C                        " TO RE-MARK.
084100     PERFORM FAIL.
084200     GO TO READ-WRITE-F2-02-1.
084300 READ-PASS-F2-02-1.
084400     PERFORM PASS.
084500 READ-WRITE-F2-02-1.
084600     PERFORM PRINT-DETAIL.
084700
084800 READ-TEST-F2-02-2.
084900     MOVE "READ-TEST-F2-02-2" TO PAR-NAME.
085000     MOVE "END-READ.        " TO FEATURE.
085100     IF SWITCH-END-XXX     = 1
085200          GO TO READ-PASS-F2-02-2.
085300 READ-FAIL-F2-02-2.
085400     MOVE "IX-32 4.5.4 (19)                          " TO RE-MARK.
085500     PERFORM FAIL.
085600     GO TO READ-WRITE-F2-02-2.
085700 READ-PASS-F2-02-2.
085800     PERFORM PASS.
085900 READ-WRITE-F2-02-2.
086000     PERFORM PRINT-DETAIL.
086100
086200******************************************************************
086300*   TEST: IF READ .. NOT INVALID  ... END-READ ...      .        *
086400*                                                                *
086500*         IX-28, 4.5.4                                           *
086600******************************************************************
086700 READ-INIT-F2-03.
086800     MOVE "READ-TEST-F2-03-1" TO PAR-NAME.
086900     MOVE "IF . READ . NOT INV. . END-" TO FEATURE.
087000     MOVE     ZERO  TO  SWITCH-NOT-INVALID.
087100     MOVE     ZERO  TO  SWITCH-END-XXX.
087200     MOVE    1      TO  SWITCH-IF.
087300 READ-TEST-F2-03.
087400     MOVE 3 TO WRK-DU-09V00-001.
087500     MOVE GRP-0101  TO IX-FS2-KEY.
087600     IF SWITCH-IF = 1
087700        READ  IX-FS2 INVALID KEY
087800              GO TO READ-FAIL-F2-03-1
087900          NOT INVALID KEY
088000             MOVE 1 TO SWITCH-NOT-INVALID
088100        END-READ
088200             MOVE 1 TO SWITCH-END-XXX.
088300     MOVE 9 TO SWITCH-END-X9X.
088400 READ-TEST-F2-03-1.
088500     IF SWITCH-NOT-INVALID = 1
088600          GO TO READ-PASS-F2-03-1.
088700 READ-FAIL-F2-03-1.
088800     MOVE "IX-28 4.5.4 (11) C                        " TO RE-MARK.
088900     PERFORM FAIL.
089000     GO TO READ-WRITE-F2-03-1.
089100 READ-PASS-F2-03-1.
089200     PERFORM PASS.
089300 READ-WRITE-F2-03-1.
089400     PERFORM PRINT-DETAIL.
089500
089600 READ-TEST-F2-03-2.
089700     MOVE "READ-TEST-F2-03-2" TO PAR-NAME.
089800     IF SWITCH-END-XXX     = 1
089900          GO TO READ-PASS-F2-03-2.
090000 READ-FAIL-F2-03-2.
090100     MOVE "IX-32 4.5.4 (19)                          " TO RE-MARK.
090200     PERFORM FAIL.
090300     GO TO READ-WRITE-F2-03-2.
090400 READ-PASS-F2-03-2.
090500     PERFORM PASS.
090600 READ-WRITE-F2-03-2.
090700     PERFORM PRINT-DETAIL.
090800
090900 READ-TEST-F2-03-3.
091000     MOVE "READ-TEST-F2-03-3" TO PAR-NAME.
091100     IF SWITCH-END-X9X     = 9
091200          GO TO READ-PASS-F2-03-3.
091300 READ-FAIL-F2-03-3.
091400     MOVE "IX-32 4.5.4 (19)                          " TO RE-MARK.
091500     PERFORM FAIL.
091600     GO TO READ-WRITE-F2-03-3.
091700 READ-PASS-F2-03-3.
091800     PERFORM PASS.
091900 READ-WRITE-F2-03-3.
092000     PERFORM PRINT-DETAIL.
092100
092200     CLOSE IX-FS2.
092300
092400******************************************************************
092500*                                                                *
092600*   TESTS:   D E L E T E        NOT INVALID    END-DELETE        *
092700*         FOR A FILE WHICH IS IN RANDOM ACCESS MODE              *
092800*                                                                *
092900*                                                                *
093000*   TEST  DELETE  NOT INVALID                                    *
093100*                                                                *
093200*         IX-21, 4.3.2                                           *
093300******************************************************************
093400 DELETE-INIT-GF-01.
093500     MOVE     2     TO  WRK-CS-09V00-012.
093600     MOVE     ZERO  TO  WRK-CS-09V00-013.
093700     MOVE     ZERO  TO  WRK-CS-09V00-014.
093800     MOVE     ZERO  TO  WRK-CS-09V00-015.
093900     MOVE     ZERO  TO  WRK-CS-09V00-016.
094000     MOVE     ZERO  TO  WRK-CS-09V00-017.
094100     MOVE     ZERO  TO  WRK-CS-09V00-018.
094200     MOVE    SPACE TO IX-FS2-STATUS.
094300     OPEN     I-O  IX-FS2.
094400     MOVE     SPACE     TO  WRK-XN-0002-002
094500     MOVE     SPACE     TO  WRK-XN-0002-003
094600     MOVE     SPACE     TO  WRK-XN-0002-004
094700     MOVE      IX-FS2-STATUS TO WRK-XN-0002-001
094800     MOVE      IX-FS2-STATUS TO WRK-XN-0002-001
094900     MOVE     SPACE TO IX-FS2-STATUS.
095000     MOVE "DELETE-TEST-GF-01" TO PAR-NAME.
095100     MOVE "DELETE NOT INVALID." TO FEATURE.
095200     MOVE     ZERO  TO  SWITCH-NOT-INVALID.
095300     MOVE     ZERO  TO  SWITCH-END-XXX.
095400 DELETE-TEST-GF-01-0.
095500     MOVE 1 TO WRK-DU-09V00-001.
095600     MOVE GRP-0101  TO IX-FS2-KEY.
095700     READ  IX-FS2 INVALID KEY
095800              MOVE " READ FAILED " TO RE-MARK
095900              PERFORM FAIL
096000              GO TO DELETE-WRITE-GF-01.
096100     DELETE IX-FS2 RECORD
096200            INVALID KEY   MOVE "DELETE IS INVALID" TO RE-MARK
096300                          PERFORM FAIL
096400                          GO TO DELETE-WRITE-GF-01
096500          NOT INVALID KEY
096600           MOVE 1 TO SWITCH-NOT-INVALID.
096700 DELETE-TEST-GF-01.
096800     IF SWITCH-NOT-INVALID = 1
096900          GO TO DELETE-PASS-GF-01.
097000 DELETE-FAIL-GF-01.
097100     MOVE "IX-21, 4.3.2                              " TO RE-MARK.
097200     PERFORM FAIL.
097300     GO TO DELETE-WRITE-GF-01.
097400 DELETE-PASS-GF-01.
097500     PERFORM PASS.
097600 DELETE-WRITE-GF-01.
097700     PERFORM PRINT-DETAIL.
097800
097900******************************************************************
098000*   TEST  DELETE  NOT INVALID  ... END-DELETE.                   *
098100*                                                                *
098200*         IX-21, 4.3.2                                           *
098300******************************************************************
098400 DELETE-INIT-GF-02.
098500     MOVE "DELETE-TEST-GF-02-1"   TO PAR-NAME.
098600     MOVE "DELETE NOT INV. . END-" TO FEATURE.
098700     MOVE     ZERO  TO  SWITCH-NOT-INVALID.
098800     MOVE     ZERO  TO  SWITCH-END-XXX.
098900 DELETE-TEST-GF-02.
099000     MOVE 2 TO WRK-DU-09V00-001.
099100     MOVE GRP-0101  TO IX-FS2-KEY.
099200     READ  IX-FS2 INVALID KEY
099300              MOVE "READ FAILED " TO RE-MARK
099400              PERFORM FAIL
099500              GO TO DELETE-WRITE-GF-02-1.
099600     DELETE IX-FS2 RECORD
099700            INVALID       MOVE "DELETE IS INVALID" TO RE-MARK
099800                          PERFORM FAIL
099900                          GO TO DELETE-WRITE-GF-02-1
100000          NOT INVALID
100100           MOVE 1 TO SWITCH-NOT-INVALID
100200        END-DELETE.
100300     MOVE 1 TO SWITCH-END-XXX.
100400 DELETE-TEST-GF-02-1.
100500     IF SWITCH-NOT-INVALID = 1
100600          GO TO DELETE-PASS-GF-02-1.
100700 DELETE-FAIL-GF-02-1.
100800     MOVE "IX-21, 4.3.2                              " TO RE-MARK.
100900     PERFORM FAIL.
101000     GO TO DELETE-WRITE-GF-02-1.
101100 DELETE-PASS-GF-02-1.
101200     PERFORM PASS.
101300 DELETE-WRITE-GF-02-1.
101400     PERFORM PRINT-DETAIL.
101500
101600 DELETE-TEST-GF-02-2.
101700     MOVE "DELETE-TEST-GF-02-2"   TO PAR-NAME.
101800     MOVE "END-DELETE.      " TO FEATURE.
101900     IF SWITCH-END-XXX     = 1
102000          GO TO DELETE-PASS-GF-02-2.
102100 DELETE-FAIL-GF-02-2.
102200     MOVE "IX-32 4.5.4 (19)                          " TO RE-MARK.
102300     PERFORM FAIL.
102400     GO TO DELETE-WRITE-GF-02-2.
102500 DELETE-PASS-GF-02-2.
102600     PERFORM PASS.
102700 DELETE-WRITE-GF-02-2.
102800     PERFORM PRINT-DETAIL.
102900
103000******************************************************************
103100*   TEST: IF DELETE. NOT INVALID  ... END-DELETE ...    .        *
103200*                                                                *
103300*         IX-21, 4.3.2                                           *
103400******************************************************************
103500 DELETE-INIT-GF-03.
103600     MOVE "DELETE-TEST-GF-03-1"   TO PAR-NAME.
103700     MOVE "IF .DELETE. NOT INV. . END-" TO FEATURE.
103800     MOVE     ZERO  TO  SWITCH-NOT-INVALID.
103900     MOVE     ZERO  TO  SWITCH-END-XXX.
104000     MOVE    1      TO  SWITCH-IF.
104100 DELETE-TEST-GF-03.
104200     MOVE 3 TO WRK-DU-09V00-001.
104300     MOVE GRP-0101  TO IX-FS2-KEY.
104400     READ  IX-FS2 INVALID KEY
104500              MOVE "READ FAILED " TO RE-MARK
104600              PERFORM FAIL
104700              GO TO DELETE-WRITE-GF-03-1.
104800     IF SWITCH-IF = 1
104900        DELETE IX-FS2 RECORD
105000            INVALID KEY   MOVE "DELETE IS INVALID" TO RE-MARK
105100                          PERFORM FAIL
105200                          GO TO DELETE-WRITE-GF-03-1
105300          NOT INVALID KEY
105400             MOVE 1 TO SWITCH-NOT-INVALID
105500        END-DELETE
105600             MOVE 1 TO SWITCH-END-XXX.
105700     MOVE 9 TO SWITCH-END-X9X.
105800 DELETE-TEST-GF-03-1.
105900     IF SWITCH-NOT-INVALID = 1
106000          GO TO DELETE-PASS-GF-03-1.
106100 DELETE-FAIL-GF-03-1.
106200     MOVE "IX-21, 4.3.2                              " TO RE-MARK.
106300     PERFORM FAIL.
106400     GO TO DELETE-WRITE-GF-03-1.
106500 DELETE-PASS-GF-03-1.
106600     PERFORM PASS.
106700 DELETE-WRITE-GF-03-1.
106800     PERFORM PRINT-DETAIL.
106900
107000 DELETE-TEST-GF-03-2.
107100     MOVE "END-DELETE" TO FEATURE.
107200     MOVE "DELETE-TEST-GF-03-2"   TO PAR-NAME.
107300     IF SWITCH-END-XXX     = 1
107400          GO TO DELETE-PASS-GF-03-2.
107500 DELETE-FAIL-GF-03-2.
107600     MOVE "IX-32 4.5.4 (19)                          " TO RE-MARK.
107700     PERFORM FAIL.
107800     GO TO DELETE-WRITE-GF-03-2.
107900 DELETE-PASS-GF-03-2.
108000     PERFORM PASS.
108100 DELETE-WRITE-GF-03-2.
108200     PERFORM PRINT-DETAIL.
108300
108400 DELETE-TEST-GF-03-3.
108500     MOVE "DELETE-TEST-GF-03-3"   TO PAR-NAME.
108600     IF SWITCH-END-X9X     = 9
108700          GO TO DELETE-PASS-GF-03-3.
108800 DELETE-FAIL-GF-03-3.
108900     MOVE "IX-32 4.5.4 (19)                          " TO RE-MARK.
109000     PERFORM FAIL.
109100     GO TO DELETE-WRITE-GF-03-3.
109200 DELETE-PASS-GF-03-3.
109300     PERFORM PASS.
109400 DELETE-WRITE-GF-03-3.
109500     PERFORM PRINT-DETAIL.
109600
109700      CLOSE IX-FS2.
109800
109900******************************************************************
110000*                                                                *
110100*   TESTS:   R E W R I T E      NOT INVALID    END-REWRITE       *
110200*         FOR A FILE WHICH IS IN RANDOM ACCESS MODE              *
110300*                                                                *
110400*                                                                *
110500*   TEST  REWRITE NOT INVALID                                    *
110600*                                                                *
110700*         IX-33, 4.6.2                                           *
110800******************************************************************
110900 REWRITE-INIT-GF-01.
111000     MOVE     2     TO  WRK-CS-09V00-012.
111100     MOVE     ZERO  TO  WRK-CS-09V00-013.
111200     MOVE     ZERO  TO  WRK-CS-09V00-014.
111300     MOVE     ZERO  TO  WRK-CS-09V00-015.
111400     MOVE     ZERO  TO  WRK-CS-09V00-016.
111500     MOVE     ZERO  TO  WRK-CS-09V00-017.
111600     MOVE     ZERO  TO  WRK-CS-09V00-018.
111700     MOVE    SPACE TO IX-FS2-STATUS.
111800     OPEN     I-O  IX-FS2.
111900     MOVE     SPACE     TO  WRK-XN-0002-002
112000     MOVE     SPACE     TO  WRK-XN-0002-003
112100     MOVE     SPACE     TO  WRK-XN-0002-004
112200     MOVE      IX-FS2-STATUS TO WRK-XN-0002-001
112300     MOVE      IX-FS2-STATUS TO WRK-XN-0002-001
112400     MOVE     SPACE TO IX-FS2-STATUS.
112500     MOVE "REWRITE-TEST-GF-01" TO PAR-NAME.
112600     MOVE "REWRITE NOT INVALID." TO FEATURE.
112700     MOVE     ZERO  TO  SWITCH-NOT-INVALID.
112800     MOVE     ZERO  TO  SWITCH-END-XXX.
112900 REWRITE-TEST-GF-01-0.
113000     MOVE 5 TO WRK-DU-09V00-001.
113100     MOVE GRP-0101  TO IX-FS2-KEY.
113200     READ  IX-FS2 INVALID KEY
113300              MOVE " READ FAILED " TO RE-MARK
113400              PERFORM FAIL
113500              GO TO REWRITE-WRITE-GF-01.
113600     MOVE "RECORD REPLACED BY REWRITE STATEMENT" TO IX-FS2-REC-120
113700     REWRITE IX-FS2R1-F-G-240
113800            INVALID KEY   MOVE "REWRITE IS INVALID" TO RE-MARK
113900                          PERFORM FAIL
114000                          GO TO REWRITE-WRITE-GF-01
114100          NOT INVALID KEY
114200           MOVE 1 TO SWITCH-NOT-INVALID.
114300 REWRITE-TEST-GF-01.
114400     IF SWITCH-NOT-INVALID = 1
114500          GO TO REWRITE-PASS-GF-01.
114600 REWRITE-FAIL-GF-01.
114700     MOVE "IX-33, 4.6.2                              " TO RE-MARK.
114800     PERFORM FAIL.
114900     GO TO REWRITE-WRITE-GF-01.
115000 REWRITE-PASS-GF-01.
115100     PERFORM PASS.
115200 REWRITE-WRITE-GF-01.
115300     PERFORM PRINT-DETAIL.
115400
115500******************************************************************
115600*   TEST  REWRITE NOT INVALID  ... END-DELETE.                   *
115700*                                                                *
115800*         IX-33, 4.6.2                                           *
115900******************************************************************
116000 REWRITE-INIT-GF-02.
116100     MOVE "REWRITE-TEST-GF-02-1"  TO PAR-NAME.
116200     MOVE "REWRITE NOT INV. . END-" TO FEATURE.
116300     MOVE     ZERO  TO  SWITCH-NOT-INVALID.
116400     MOVE     ZERO  TO  SWITCH-END-XXX.
116500 REWRITE-TEST-GF-02.
116600     MOVE 6 TO WRK-DU-09V00-001.
116700     MOVE GRP-0101  TO IX-FS2-KEY.
116800     READ  IX-FS2 INVALID KEY
116900              MOVE "READ FAILED " TO RE-MARK
117000              PERFORM FAIL
117100              GO TO REWRITE-WRITE-GF-02-1.
117200     MOVE "RECORD REPLACED BY REWRITE STATEMENT" TO IX-FS2-REC-120
117300     REWRITE IX-FS2R1-F-G-240
117400            INVALID KEY   MOVE "REWRITE IS INVALID" TO RE-MARK
117500                          PERFORM FAIL
117600                          GO TO REWRITE-WRITE-GF-02-1
117700          NOT INVALID
117800           MOVE 1 TO SWITCH-NOT-INVALID
117900        END-REWRITE.
118000     MOVE 1 TO SWITCH-END-XXX.
118100 REWRITE-TEST-GF-02-1.
118200     IF SWITCH-NOT-INVALID = 1
118300          GO TO REWRITE-PASS-GF-02-1.
118400 REWRITE-FAIL-GF-02-1.
118500     MOVE "IX-33, 4.6.2                              " TO RE-MARK.
118600     PERFORM FAIL.
118700     GO TO REWRITE-WRITE-GF-02-1.
118800 REWRITE-PASS-GF-02-1.
118900     PERFORM PASS.
119000 REWRITE-WRITE-GF-02-1.
119100     PERFORM PRINT-DETAIL.
119200
119300 REWRITE-TEST-GF-02-2.
119400     MOVE "REWRITE-TEST-GF-02-2"  TO PAR-NAME.
119500     MOVE "END-REWRITE.     " TO FEATURE.
119600     IF SWITCH-END-XXX     = 1
119700          GO TO REWRITE-PASS-GF-02-2.
119800 REWRITE-FAIL-GF-02-2.
119900     MOVE "IX-32 4.5.4 (19)                          " TO RE-MARK.
120000     PERFORM FAIL.
120100     GO TO REWRITE-WRITE-GF-02-2.
120200 REWRITE-PASS-GF-02-2.
120300     PERFORM PASS.
120400 REWRITE-WRITE-GF-02-2.
120500     PERFORM PRINT-DETAIL.
120600
120700******************************************************************
120800*   TEST: IF REWRITE. NOT INVALID ... END-DELETE ...    .        *
120900*                                                                *
121000*         IX-33, 4.6.2                                           *
121100******************************************************************
121200 REWRITE-INIT-GF-03.
121300     MOVE "REWRITE-TEST-GF-03-1"  TO PAR-NAME.
121400     MOVE "IF .REWRITE. NOT INV. . END-" TO FEATURE.
121500     MOVE     ZERO  TO  SWITCH-NOT-INVALID.
121600     MOVE     ZERO  TO  SWITCH-END-XXX.
121700     MOVE    1      TO  SWITCH-IF.
121800 REWRITE-TEST-GF-03.
121900     MOVE 7 TO WRK-DU-09V00-001.
122000     MOVE GRP-0101  TO IX-FS2-KEY.
122100     READ  IX-FS2 INVALID KEY
122200              MOVE "READ FAILED " TO RE-MARK
122300              PERFORM FAIL
122400              GO TO REWRITE-WRITE-GF-03-1.
122500     IF SWITCH-IF = 1
122600     MOVE "RECORD REPLACED BY REWRITE STATEMENT" TO IX-FS2-REC-120
122700        REWRITE IX-FS2R1-F-G-240
122800            INVALID KEY   MOVE "REWRITE IS INVALID" TO RE-MARK
122900                          PERFORM FAIL
123000                          GO TO REWRITE-WRITE-GF-03-1
123100          NOT INVALID KEY
123200             MOVE 1 TO SWITCH-NOT-INVALID
123300        END-REWRITE
123400             MOVE 1 TO SWITCH-END-XXX.
123500     MOVE 9 TO SWITCH-END-X9X.
123600 REWRITE-TEST-GF-03-1.
123700     IF SWITCH-NOT-INVALID = 1
123800          GO TO REWRITE-PASS-GF-03-1.
123900 REWRITE-FAIL-GF-03-1.
124000     MOVE "IX-33, 4.6.2                              " TO RE-MARK.
124100     PERFORM FAIL.
124200     GO TO REWRITE-WRITE-GF-03-1.
124300 REWRITE-PASS-GF-03-1.
124400     PERFORM PASS.
124500 REWRITE-WRITE-GF-03-1.
124600     PERFORM PRINT-DETAIL.
124700
124800 REWRITE-TEST-GF-03-2.
124900     MOVE "END-REWRITE" TO FEATURE.
125000     MOVE "REWRITE-TEST-GF-03-2"  TO PAR-NAME.
125100     IF SWITCH-END-XXX     = 1
125200          GO TO REWRITE-PASS-GF-03-2.
125300 REWRITE-FAIL-GF-03-2.
125400     MOVE "IX-32 4.5.4 (19)                          " TO RE-MARK.
125500     PERFORM FAIL.
125600     GO TO REWRITE-WRITE-GF-03-2.
125700 REWRITE-PASS-GF-03-2.
125800     PERFORM PASS.
125900 REWRITE-WRITE-GF-03-2.
126000     PERFORM PRINT-DETAIL.
126100
126200 REWRITE-TEST-GF-03-3.
126300     MOVE "REWRITE-TEST-GF-03-3"  TO PAR-NAME.
126400     IF SWITCH-END-X9X     = 9
126500          GO TO REWRITE-PASS-GF-03-3.
126600 REWRITE-FAIL-GF-03-3.
126700     MOVE "IX-32 4.5.4 (19)                          " TO RE-MARK.
126800     PERFORM FAIL.
126900     GO TO REWRITE-WRITE-GF-03-3.
127000 REWRITE-PASS-GF-03-3.
127100     PERFORM PASS.
127200 REWRITE-WRITE-GF-03-3.
127300     PERFORM PRINT-DETAIL.
127400
127500     CLOSE IX-FS2.
127600
127700
127800******************************************************************
127900*                                                                *
128000*   TESTS:   R E W R I T E      NOT INVALID    END-REWRITE       *
128100*         FOR A FILE WHICH IS IN SEQUENTIAL ACCESS MODE          *
128200*                                                                *
128300*                                                                *
128400*   TEST  REWRITE NOT INVALID                                    *
128500*                                                                *
128600*         IX-33, 4.6.2                                           *
128700******************************************************************
128800 RWR-SEQ-INIT-GF-01.
128900     MOVE     2     TO  WRK-CS-09V00-012.
129000     MOVE     ZERO  TO  WRK-CS-09V00-013.
129100     MOVE     ZERO  TO  WRK-CS-09V00-014.
129200     MOVE     ZERO  TO  WRK-CS-09V00-015.
129300     MOVE     ZERO  TO  WRK-CS-09V00-016.
129400     MOVE     ZERO  TO  WRK-CS-09V00-017.
129500     MOVE     ZERO  TO  WRK-CS-09V00-018.
129600     MOVE    SPACE TO IX-FS1-STATUS.
129700     OPEN     I-O  IX-FS1.
129800     MOVE     SPACE     TO  WRK-XN-0002-002
129900     MOVE     SPACE     TO  WRK-XN-0002-003
130000     MOVE     SPACE     TO  WRK-XN-0002-004
130100     MOVE      IX-FS1-STATUS TO WRK-XN-0002-001
130200     MOVE      IX-FS1-STATUS TO WRK-XN-0002-001
130300     MOVE     SPACE TO IX-FS1-STATUS.
130400     MOVE "RWR-SEQ-TEST-GF-01"  TO PAR-NAME.
130500     MOVE "REWRITE NOT INVALID." TO FEATURE.
130600     MOVE     ZERO  TO  SWITCH-NOT-INVALID.
130700     MOVE     ZERO  TO  SWITCH-END-XXX.
130800 RWR-SEQ-TEST-GF-01-0.
130900******************************************************************
131000*                                                                *
131100*   READ AND REWRITE THE FIRST THREE RECORDS                     *
131200*                                                                *
131300******************************************************************
131400     READ  IX-FS1 AT END
131500              MOVE " READ FAILED " TO RE-MARK
131600              PERFORM FAIL
131700              GO TO RWR-SEQ-WRITE-GF-01.
131800     MOVE "RECORD REPLACED BY REWRITE STATEMENT" TO IX-FS1-REC-120
131900     REWRITE IX-FS1R1-F-G-240
132000            INVALID KEY   MOVE "REWRITE IS INVALID" TO RE-MARK
132100                          PERFORM FAIL
132200                          GO TO RWR-SEQ-WRITE-GF-01
132300          NOT INVALID KEY
132400           MOVE 1 TO SWITCH-NOT-INVALID.
132500 RWR-SEQ-TEST-GF-01.
132600     IF SWITCH-NOT-INVALID = 1
132700          GO TO RWR-SEQ-PASS-GF-01.
132800 RWR-SEQ-FAIL-GF-01.
132900     MOVE "IX-33, 4.6.2                              " TO RE-MARK.
133000     PERFORM FAIL.
133100     GO TO RWR-SEQ-WRITE-GF-01.
133200 RWR-SEQ-PASS-GF-01.
133300     PERFORM PASS.
133400 RWR-SEQ-WRITE-GF-01.
133500     PERFORM PRINT-DETAIL.
133600
133700******************************************************************
133800*   TEST  REWRITE NOT INVALID  ... END-DELETE.                   *
133900*                                                                *
134000*         IX-33, 4.6.2                                           *
134100******************************************************************
134200 RWR-SEQ-INIT-GF-02.
134300     MOVE "RWR-SEQ-TEST-GF-02-1"  TO PAR-NAME.
134400     MOVE "REWRITE NOT INV. . END-" TO FEATURE.
134500     MOVE     ZERO  TO  SWITCH-NOT-INVALID.
134600     MOVE     ZERO  TO  SWITCH-END-XXX.
134700 RWR-SEQ-TEST-GF-02.
134800     READ  IX-FS1 AT END
134900              MOVE "READ FAILED " TO RE-MARK
135000              PERFORM FAIL
135100              GO TO RWR-SEQ-WRITE-GF-02-1.
135200     MOVE "RECORD REPLACED BY REWRITE STATEMENT" TO IX-FS1-REC-120
135300     REWRITE IX-FS1R1-F-G-240
135400            INVALID       MOVE "REWRITE IS INVALID" TO RE-MARK
135500                          PERFORM FAIL
135600                          GO TO RWR-SEQ-WRITE-GF-02-1
135700          NOT INVALID
135800           MOVE 1 TO SWITCH-NOT-INVALID
135900        END-REWRITE.
136000     MOVE 1 TO SWITCH-END-XXX.
136100 RWR-SEQ-TEST-GF-02-1.
136200     IF SWITCH-NOT-INVALID = 1
136300          GO TO RWR-SEQ-PASS-GF-02-1.
136400 RWR-SEQ-FAIL-GF-02-1.
136500     MOVE "IX-33, 4.6.2                              " TO RE-MARK.
136600     PERFORM FAIL.
136700     GO TO RWR-SEQ-WRITE-GF-02-1.
136800 RWR-SEQ-PASS-GF-02-1.
136900     PERFORM PASS.
137000 RWR-SEQ-WRITE-GF-02-1.
137100     PERFORM PRINT-DETAIL.
137200
137300 RWR-SEQ-TEST-GF-02-2.
137400     MOVE "RWR-SEQ-TEST-GF-02-2"  TO PAR-NAME.
137500     MOVE "END-REWRITE.     " TO FEATURE.
137600     IF SWITCH-END-XXX     = 1
137700          GO TO RWR-SEQ-PASS-GF-02-2.
137800 RWR-SEQ-FAIL-GF-02-2.
137900     MOVE "IX-32 4.5.4 (19)                          " TO RE-MARK.
138000     PERFORM FAIL.
138100     GO TO RWR-SEQ-WRITE-GF-02-2.
138200 RWR-SEQ-PASS-GF-02-2.
138300     PERFORM PASS.
138400 RWR-SEQ-WRITE-GF-02-2.
138500     PERFORM PRINT-DETAIL.
138600
138700******************************************************************
138800*   TEST: IF REWRITE. NOT INVALID ... END-DELETE ...    .        *
138900*                                                                *
139000*         IX-33, 4.6.2                                           *
139100******************************************************************
139200 RWR-SEQ-INIT-GF-03.
139300     MOVE "RWR-SEQ-TEST-GF-03-1"  TO PAR-NAME.
139400     MOVE "IF .REWRITE. NOT INV. . END-" TO FEATURE.
139500     MOVE     ZERO  TO  SWITCH-NOT-INVALID.
139600     MOVE     ZERO  TO  SWITCH-END-XXX.
139700     MOVE    1      TO  SWITCH-IF.
139800 RWR-SEQ-TEST-GF-03.
139900     READ  IX-FS1 END
140000              MOVE "READ FAILED " TO RE-MARK
140100              PERFORM FAIL
140200              GO TO RWR-SEQ-WRITE-GF-03-1.
140300     IF SWITCH-IF = 1
140400     MOVE "RECORD REPLACED BY REWRITE STATEMENT" TO IX-FS1-REC-120
140500        REWRITE IX-FS1R1-F-G-240
140600            INVALID KEY   MOVE "REWRITE IS INVALID" TO RE-MARK
140700                          PERFORM FAIL
140800                          GO TO RWR-SEQ-WRITE-GF-03-1
140900          NOT INVALID KEY
141000             MOVE 1 TO SWITCH-NOT-INVALID
141100        END-REWRITE
141200             MOVE 1 TO SWITCH-END-XXX.
141300     MOVE 9 TO SWITCH-END-X9X.
141400 RWR-SEQ-TEST-GF-03-1.
141500     IF SWITCH-NOT-INVALID = 1
141600          GO TO RWR-SEQ-PASS-GF-03-1.
141700 RWR-SEQ-FAIL-GF-03-1.
141800     MOVE "IX-33, 4.6.2                              " TO RE-MARK.
141900     PERFORM FAIL.
142000     GO TO RWR-SEQ-WRITE-GF-03-1.
142100 RWR-SEQ-PASS-GF-03-1.
142200     PERFORM PASS.
142300 RWR-SEQ-WRITE-GF-03-1.
142400     PERFORM PRINT-DETAIL.
142500
142600 RWR-SEQ-TEST-GF-03-2.
142700     MOVE "END-REWRITE" TO FEATURE.
142800     MOVE "RWR-SEQ-TEST-GF-03-2"  TO PAR-NAME.
142900     IF SWITCH-END-XXX     = 1
143000          GO TO RWR-SEQ-PASS-GF-03-2.
143100 RWR-SEQ-FAIL-GF-03-2.
143200     MOVE "IX-32 4.5.4 (19)                          " TO RE-MARK.
143300     PERFORM FAIL.
143400     GO TO RWR-SEQ-WRITE-GF-03-2.
143500 RWR-SEQ-PASS-GF-03-2.
143600     PERFORM PASS.
143700 RWR-SEQ-WRITE-GF-03-2.
143800     PERFORM PRINT-DETAIL.
143900
144000 RWR-SEQ-TEST-GF-03-3.
144100     MOVE "RWR-SEQ-TEST-GF-03-3"  TO PAR-NAME.
144200     IF SWITCH-END-X9X     = 9
144300          GO TO RWR-SEQ-PASS-GF-03-3.
144400 RWR-SEQ-FAIL-GF-03-3.
144500     MOVE "IX-32 4.5.4 (19)                          " TO RE-MARK.
144600     PERFORM FAIL.
144700     GO TO RWR-SEQ-WRITE-GF-03-3.
144800 RWR-SEQ-PASS-GF-03-3.
144900     PERFORM PASS.
145000 RWR-SEQ-WRITE-GF-03-3.
145100     PERFORM PRINT-DETAIL.
145200
145300     CLOSE IX-FS1.
145400
145500
145600 CCVS-EXIT SECTION.
145700 CCVS-999999.
145800     GO TO CLOSE-FILES.
