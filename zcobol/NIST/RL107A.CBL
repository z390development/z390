000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RL107A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*GENERAL:    THIS PROGRAM PROCESSES TWO RELATIVE I-O FILES.  THE
002200*            THE FUNCTION OF THIS PROGRAM IS TO CREATE TWO
002300*            RELATIVES FILES RANDOMLY (ACCESS MODE RANDOM) AND
002400*            VERIFY THAT THEY WERE CREATED CORRECTLY.  THE FILES
002500*            ARE IDENTIFIED AS "RL-FR7" AND "RL-FR8".  THE FILES
002600*            ARE CREATED PARTIALLY (NOT ALL VALUES FOR RELATIVE
002700*            KEY ARE USED) IN THE OUTPUT MODE AND SUBSEQUENTLY
002800*            COMPLETED IN THE I-O MODE.  THE END RESULT IS THAT
002900*            THERE ARE NO NULL RECORDS IN ANY OF THE FILES.
003000*
003100*            X-CARD PARAMETERS WHICH MUST BE SUPPLIED FOR THIS
003200*            PROGRAM ARE:
003300*
003400*                 X-21   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
003500*                         RELATIVE  I-O DATA FILE-1
003600*                 X-22   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
003700*                         RELATIVE  I-O DATA FILE-2
003800*                 X-55   SYSTEM PRINTER
003900*                 X-69   ADDITIONAL VALUE OF CLAUSES
004000*                 X-74   VALUE OF IMPLEMENTOR-NAME
004100*                 X-75   OBJECT OF VALUE OF CLAUSE FOR FILE-1
004200*                 X-76   OBJECT OF VALUE OF CLAUSE FOR FILE-2
004300*                 X-82   SOURCE-COMPUTER
004400*                 X-83   OBJECT-COMPUTER.
004500*
004600****************************************************************
004700 ENVIRONMENT DIVISION.
004800 CONFIGURATION SECTION.
004900 SOURCE-COMPUTER.
005000     XXXXX082.
005100 OBJECT-COMPUTER.
005200     XXXXX083.
005300 INPUT-OUTPUT SECTION.
005400 FILE-CONTROL.
005500     SELECT PRINT-FILE ASSIGN TO
005600     XXXXX055.
005700     SELECT RL-FR7 ASSIGN TO
005800     XXXXX021
005900             ORGANIZATION IS RELATIVE
006000             ACCESS  MODE IS RANDOM
006100              RELATIVE KEY ACTUAL-KEY-1.
006200     SELECT RL-FR8 ASSIGN TO
006300     XXXXX022
006400             ORGANIZATION IS RELATIVE
006500             ACCESS  MODE IS RANDOM
006600              RELATIVE KEY IS ACTUAL-KEY-2.
006700 DATA DIVISION.
006800 FILE SECTION.
006900 FD  PRINT-FILE.
007000 01  PRINT-REC PICTURE X(120).
007100 01  DUMMY-RECORD PICTURE X(120).
007200 FD  RL-FR7
007300     LABEL RECORDS ARE STANDARD
007400C    VALUE OF
007500C    XXXXX074
007600C    IS
007700C    XXXXX075
007800G    XXXXX069
007900     DATA RECORD IS RAC-REC-1.
008000 01  RAC-REC-1.
008100     03  FILLER                  PICTURE IS X(24).
008200     03  RECORD-NO-1             PICTURE IS 9999.
008300     03  FILLER                  PICTURE IS XXXX.
008400     03  UPDATE-FIELD            PICTURE IS X(7).
008500     03  FILLER                  PICTURE IS X(81).
008600 FD  RL-FR8
008700     LABEL RECORDS ARE STANDARD
008800C    VALUE OF
008900C    XXXXX074
009000C    IS
009100C    XXXXX076
009200G    XXXXX069
009300     DATA RECORDS ARE RAC-REC-2 RAC-REC-3.
009400 01  RAC-REC-2.
009500     03  FILLER                  PICTURE IS X(24).
009600     03  RECORD-NO-2             PICTURE IS 9999.
009700     03  FILLER                  PICTURE IS X(92).
009800 01  RAC-REC-3.
009900     03  FILLER                  PICTURE IS X(24).
010000     03  RECORD-NO-3             PICTURE IS 9999.
010100     03  FILLER                  PICTURE IS X(92).
010200 WORKING-STORAGE SECTION.
010300 01  RECORD-SKELTON.
010400     03  FILLER PICTURE IS X(24) VALUE "  THIS IS RECORD NUMBER ".
010500     03  RECORD-NUMXXX           PICTURE IS  9999 VALUE IS ZERO.
010600     03  FILLER                  PICTURE IS X(92) VALUE SPACE.
010700 01  ACTUAL-KEY-1
010800         PICTURE   9(5).
010900 01  ACTUAL-KEY-2
011000         PICTURE   9(5).
011100 01  FILE-RECORD-INFORMATION-REC.
011200     03 FILE-RECORD-INFO-SKELETON.
011300        05 FILLER                 PICTURE X(48)       VALUE
011400             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
011500        05 FILLER                 PICTURE X(46)       VALUE
011600             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
011700        05 FILLER                 PICTURE X(26)       VALUE
011800             ",LFIL=000000,ORG=  ,LBLR= ".
011900        05 FILLER                 PICTURE X(37)       VALUE
012000             ",RECKEY=                             ".
012100        05 FILLER                 PICTURE X(38)       VALUE
012200             ",ALTKEY1=                             ".
012300        05 FILLER                 PICTURE X(38)       VALUE
012400             ",ALTKEY2=                             ".
012500        05 FILLER                 PICTURE X(7)        VALUE SPACE.
012600     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
012700        05 FILE-RECORD-INFO-P1-120.
012800           07 FILLER              PIC X(5).
012900           07 XFILE-NAME           PIC X(6).
013000           07 FILLER              PIC X(8).
013100           07 XRECORD-NAME         PIC X(6).
013200           07 FILLER              PIC X(1).
013300           07 REELUNIT-NUMBER     PIC 9(1).
013400           07 FILLER              PIC X(7).
013500           07 XRECORD-NUMBER       PIC 9(6).
013600           07 FILLER              PIC X(6).
013700           07 UPDATE-NUMBER       PIC 9(2).
013800           07 FILLER              PIC X(5).
013900           07 ODO-NUMBER          PIC 9(4).
014000           07 FILLER              PIC X(5).
014100           07 XPROGRAM-NAME        PIC X(5).
014200           07 FILLER              PIC X(7).
014300           07 XRECORD-LENGTH       PIC 9(6).
014400           07 FILLER              PIC X(7).
014500           07 CHARS-OR-RECORDS    PIC X(2).
014600           07 FILLER              PIC X(1).
014700           07 XBLOCK-SIZE          PIC 9(4).
014800           07 FILLER              PIC X(6).
014900           07 RECORDS-IN-FILE     PIC 9(6).
015000           07 FILLER              PIC X(5).
015100           07 XFILE-ORGANIZATION   PIC X(2).
015200           07 FILLER              PIC X(6).
015300           07 XLABEL-TYPE          PIC X(1).
015400        05 FILE-RECORD-INFO-P121-240.
015500           07 FILLER              PIC X(8).
015600           07 XRECORD-KEY          PIC X(29).
015700           07 FILLER              PIC X(9).
015800           07 ALTERNATE-KEY1      PIC X(29).
015900           07 FILLER              PIC X(9).
016000           07 ALTERNATE-KEY2      PIC X(29).
016100           07 FILLER              PIC X(7).
016200 01  TEST-RESULTS.
016300     02 FILLER                   PIC X      VALUE SPACE.
016400     02 FEATURE                  PIC X(20)  VALUE SPACE.
016500     02 FILLER                   PIC X      VALUE SPACE.
016600     02 P-OR-F                   PIC X(5)   VALUE SPACE.
016700     02 FILLER                   PIC X      VALUE SPACE.
016800     02  PAR-NAME.
016900       03 FILLER                 PIC X(19)  VALUE SPACE.
017000       03  PARDOT-X              PIC X      VALUE SPACE.
017100       03 DOTVALUE               PIC 99     VALUE ZERO.
017200     02 FILLER                   PIC X(8)   VALUE SPACE.
017300     02 RE-MARK                  PIC X(61).
017400 01  TEST-COMPUTED.
017500     02 FILLER                   PIC X(30)  VALUE SPACE.
017600     02 FILLER                   PIC X(17)  VALUE
017700            "       COMPUTED=".
017800     02 COMPUTED-X.
017900     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
018000     03 COMPUTED-N               REDEFINES COMPUTED-A
018100                                 PIC -9(9).9(9).
018200     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
018300     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
018400     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
018500     03       CM-18V0 REDEFINES COMPUTED-A.
018600         04 COMPUTED-18V0                    PIC -9(18).
018700         04 FILLER                           PIC X.
018800     03 FILLER PIC X(50) VALUE SPACE.
018900 01  TEST-CORRECT.
019000     02 FILLER PIC X(30) VALUE SPACE.
019100     02 FILLER PIC X(17) VALUE "       CORRECT =".
019200     02 CORRECT-X.
019300     03 CORRECT-A                  PIC X(20) VALUE SPACE.
019400     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
019500     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
019600     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
019700     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
019800     03      CR-18V0 REDEFINES CORRECT-A.
019900         04 CORRECT-18V0                     PIC -9(18).
020000         04 FILLER                           PIC X.
020100     03 FILLER PIC X(2) VALUE SPACE.
020200     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
020300 01  CCVS-C-1.
020400     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
020500-    "SS  PARAGRAPH-NAME
020600-    "       REMARKS".
020700     02 FILLER                     PIC X(20)    VALUE SPACE.
020800 01  CCVS-C-2.
020900     02 FILLER                     PIC X        VALUE SPACE.
021000     02 FILLER                     PIC X(6)     VALUE "TESTED".
021100     02 FILLER                     PIC X(15)    VALUE SPACE.
021200     02 FILLER                     PIC X(4)     VALUE "FAIL".
021300     02 FILLER                     PIC X(94)    VALUE SPACE.
021400 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
021500 01  REC-CT                        PIC 99       VALUE ZERO.
021600 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
021700 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
021800 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
021900 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
022000 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
022100 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
022200 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
022300 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
022400 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
022500 01  CCVS-H-1.
022600     02  FILLER                    PIC X(39)    VALUE SPACES.
022700     02  FILLER                    PIC X(42)    VALUE
022800     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
022900     02  FILLER                    PIC X(39)    VALUE SPACES.
023000 01  CCVS-H-2A.
023100   02  FILLER                        PIC X(40)  VALUE SPACE.
023200   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
023300   02  FILLER                        PIC XXXX   VALUE
023400     "4.2 ".
023500   02  FILLER                        PIC X(28)  VALUE
023600            " COPY - NOT FOR DISTRIBUTION".
023700   02  FILLER                        PIC X(41)  VALUE SPACE.
023800
023900 01  CCVS-H-2B.
024000   02  FILLER                        PIC X(15)  VALUE
024100            "TEST RESULT OF ".
024200   02  TEST-ID                       PIC X(9).
024300   02  FILLER                        PIC X(4)   VALUE
024400            " IN ".
024500   02  FILLER                        PIC X(12)  VALUE
024600     " HIGH       ".
024700   02  FILLER                        PIC X(22)  VALUE
024800            " LEVEL VALIDATION FOR ".
024900   02  FILLER                        PIC X(58)  VALUE
025000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025100 01  CCVS-H-3.
025200     02  FILLER                      PIC X(34)  VALUE
025300            " FOR OFFICIAL USE ONLY    ".
025400     02  FILLER                      PIC X(58)  VALUE
025500     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
025600     02  FILLER                      PIC X(28)  VALUE
025700            "  COPYRIGHT   1985 ".
025800 01  CCVS-E-1.
025900     02 FILLER                       PIC X(52)  VALUE SPACE.
026000     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
026100     02 ID-AGAIN                     PIC X(9).
026200     02 FILLER                       PIC X(45)  VALUE SPACES.
026300 01  CCVS-E-2.
026400     02  FILLER                      PIC X(31)  VALUE SPACE.
026500     02  FILLER                      PIC X(21)  VALUE SPACE.
026600     02 CCVS-E-2-2.
026700         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
026800         03 FILLER                   PIC X      VALUE SPACE.
026900         03 ENDER-DESC               PIC X(44)  VALUE
027000            "ERRORS ENCOUNTERED".
027100 01  CCVS-E-3.
027200     02  FILLER                      PIC X(22)  VALUE
027300            " FOR OFFICIAL USE ONLY".
027400     02  FILLER                      PIC X(12)  VALUE SPACE.
027500     02  FILLER                      PIC X(58)  VALUE
027600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
027700     02  FILLER                      PIC X(13)  VALUE SPACE.
027800     02 FILLER                       PIC X(15)  VALUE
027900             " COPYRIGHT 1985".
028000 01  CCVS-E-4.
028100     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
028200     02 FILLER                       PIC X(4)   VALUE " OF ".
028300     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
028400     02 FILLER                       PIC X(40)  VALUE
028500      "  TESTS WERE EXECUTED SUCCESSFULLY".
028600 01  XXINFO.
028700     02 FILLER                       PIC X(19)  VALUE
028800            "*** INFORMATION ***".
028900     02 INFO-TEXT.
029000       04 FILLER                     PIC X(8)   VALUE SPACE.
029100       04 XXCOMPUTED                 PIC X(20).
029200       04 FILLER                     PIC X(5)   VALUE SPACE.
029300       04 XXCORRECT                  PIC X(20).
029400     02 INF-ANSI-REFERENCE           PIC X(48).
029500 01  HYPHEN-LINE.
029600     02 FILLER  PIC IS X VALUE IS SPACE.
029700     02 FILLER  PIC IS X(65)    VALUE IS "************************
029800-    "*****************************************".
029900     02 FILLER  PIC IS X(54)    VALUE IS "************************
030000-    "******************************".
030100 01  CCVS-PGM-ID                     PIC X(9)   VALUE
030200     "RL107A".
030300 PROCEDURE DIVISION.
030400 CCVS1 SECTION.
030500 OPEN-FILES.
030600     OPEN    OUTPUT PRINT-FILE.
030700     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
030800     MOVE    SPACE TO TEST-RESULTS.
030900     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
031000     MOVE    ZERO TO REC-SKL-SUB.
031100     PERFORM CCVS-INIT-FILE 9 TIMES.
031200 CCVS-INIT-FILE.
031300     ADD     1 TO REC-SKL-SUB.
031400     MOVE    FILE-RECORD-INFO-SKELETON
031500          TO FILE-RECORD-INFO (REC-SKL-SUB).
031600 CCVS-INIT-EXIT.
031700     GO TO CCVS1-EXIT.
031800 CLOSE-FILES.
031900     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
032000 TERMINATE-CCVS.
032100S    EXIT PROGRAM.
032200STERMINATE-CALL.
032300     STOP     RUN.
032400 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
032500 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
032600 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
032700 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
032800     MOVE "****TEST DELETED****" TO RE-MARK.
032900 PRINT-DETAIL.
033000     IF REC-CT NOT EQUAL TO ZERO
033100             MOVE "." TO PARDOT-X
033200             MOVE REC-CT TO DOTVALUE.
033300     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
033400     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
033500        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
033600          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
033700     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
033800     MOVE SPACE TO CORRECT-X.
033900     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
034000     MOVE     SPACE TO RE-MARK.
034100 HEAD-ROUTINE.
034200     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034300     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034400     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
034500     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
034600 COLUMN-NAMES-ROUTINE.
034700     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034800     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
035000 END-ROUTINE.
035100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
035200 END-RTN-EXIT.
035300     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035400 END-ROUTINE-1.
035500      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
035600      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
035700      ADD PASS-COUNTER TO ERROR-HOLD.
035800*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
035900      MOVE PASS-COUNTER TO CCVS-E-4-1.
036000      MOVE ERROR-HOLD TO CCVS-E-4-2.
036100      MOVE CCVS-E-4 TO CCVS-E-2-2.
036200      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
036300  END-ROUTINE-12.
036400      MOVE "TEST(S) FAILED" TO ENDER-DESC.
036500     IF       ERROR-COUNTER IS EQUAL TO ZERO
036600         MOVE "NO " TO ERROR-TOTAL
036700         ELSE
036800         MOVE ERROR-COUNTER TO ERROR-TOTAL.
036900     MOVE     CCVS-E-2 TO DUMMY-RECORD.
037000     PERFORM WRITE-LINE.
037100 END-ROUTINE-13.
037200     IF DELETE-COUNTER IS EQUAL TO ZERO
037300         MOVE "NO " TO ERROR-TOTAL  ELSE
037400         MOVE DELETE-COUNTER TO ERROR-TOTAL.
037500     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
037600     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037700      IF   INSPECT-COUNTER EQUAL TO ZERO
037800          MOVE "NO " TO ERROR-TOTAL
037900      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
038000      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
038100      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038200     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038300 WRITE-LINE.
038400     ADD 1 TO RECORD-COUNT.
038500Y    IF RECORD-COUNT GREATER 50
038600Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
038700Y        MOVE SPACE TO DUMMY-RECORD
038800Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
038900Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
039000Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
039100Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
039200Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
039300Y        MOVE ZERO TO RECORD-COUNT.
039400     PERFORM WRT-LN.
039500 WRT-LN.
039600     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
039700     MOVE SPACE TO DUMMY-RECORD.
039800 BLANK-LINE-PRINT.
039900     PERFORM WRT-LN.
040000 FAIL-ROUTINE.
040100     IF     COMPUTED-X NOT EQUAL TO SPACE
040200            GO TO   FAIL-ROUTINE-WRITE.
040300     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
040400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
040500     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
040600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040700     MOVE   SPACES TO INF-ANSI-REFERENCE.
040800     GO TO  FAIL-ROUTINE-EX.
040900 FAIL-ROUTINE-WRITE.
041000     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
041100     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
041200     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
041300     MOVE   SPACES TO COR-ANSI-REFERENCE.
041400 FAIL-ROUTINE-EX. EXIT.
041500 BAIL-OUT.
041600     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
041700     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
041800 BAIL-OUT-WRITE.
041900     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
042000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
042100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042200     MOVE   SPACES TO INF-ANSI-REFERENCE.
042300 BAIL-OUT-EX. EXIT.
042400 CCVS1-EXIT.
042500     EXIT.
042600 SECT-RL107-001 SECTION.
042700 TEST-1.
042800     MOVE  "OPEN OUTPUT RL-FR7" TO FEATURE.
042900     MOVE  "REL-TEST-001" TO PAR-NAME.
043000     PERFORM PRINT-DETAIL.
043100     OPEN OUTPUT RL-FR7.
043200 TEST-2.
043300     MOVE "OPEN OUTPUT RL-FR8" TO FEATURE.
043400     MOVE  "REL-TEST-002" TO PAR-NAME.
043500     PERFORM PRINT-DETAIL.
043600     OPEN OUTPUT RL-FR8.
043700 TEST-3-INIT.
043800     MOVE "WRITE RL-FR7" TO FEATURE.
043900     MOVE  "REL-TEST-003" TO PAR-NAME.
044000     MOVE 0 TO ACTUAL-KEY-1.
044100     MOVE ZERO TO RECORD-NUMXXX.
044200 TEST-3.
044300     ADD 1 TO RECORD-NUMXXX.
044400     ADD 1 TO ACTUAL-KEY-1.
044500     IF RECORD-NUMXXX IS GREATER THAN 25 GO TO TEST-3-EXIT.
044600     MOVE RECORD-SKELTON TO RAC-REC-1.
044700     WRITE RAC-REC-1 INVALID KEY PERFORM ERROR-INVALID-KEY.
044800     GO TO TEST-3.
044900 TEST-3-EXIT.
045000     IF REC-CT IS EQUAL TO ZERO PERFORM PASS
045100        PERFORM PRINT-DETAIL.
045200 TEST-4-INIT.
045300     MOVE "REL-TEST-004" TO PAR-NAME.
045400     MOVE ZERO TO REC-CT.
045500     MOVE 51 TO RECORD-NUMXXX.
045600     MOVE 51 TO ACTUAL-KEY-1.
045700 TEST-4.
045800     SUBTRACT 1 FROM RECORD-NUMXXX.
045900     SUBTRACT 1 FROM ACTUAL-KEY-1.
046000     IF RECORD-NUMXXX IS LESS THAN 26 GO TO TEST-4-EXIT.
046100     MOVE RECORD-SKELTON TO RAC-REC-1.
046200     WRITE RAC-REC-1 INVALID KEY PERFORM ERROR-INVALID-KEY.
046300     GO TO TEST-4.
046400 TEST-4-EXIT.
046500     IF REC-CT IS EQUAL TO ZERO PERFORM PASS
046600        PERFORM PRINT-DETAIL.
046700 TEST-5-INIT.
046800     MOVE "REL-TEST-005" TO PAR-NAME.
046900     MOVE ZERO TO REC-CT.
047000     MOVE 48 TO ACTUAL-KEY-1.
047100     MOVE 48 TO RECORD-NUMXXX.
047200 TEST-5.
047300     ADD 3 TO RECORD-NUMXXX.
047400     ADD 3 TO ACTUAL-KEY-1.
047500     IF RECORD-NUMXXX IS GREATER THAN 125 GO TO TEST-5-EXIT.
047600     MOVE RECORD-SKELTON TO RAC-REC-1.
047700     WRITE RAC-REC-1 INVALID KEY PERFORM ERROR-INVALID-KEY.
047800     GO TO TEST-5.
047900 TEST-5-EXIT.
048000     IF REC-CT IS EQUAL TO ZERO PERFORM PASS
048100        PERFORM PRINT-DETAIL.
048200 TEST-6-INIT.
048300     MOVE "REL-TEST-006" TO PAR-NAME.
048400     MOVE ZERO TO REC-CT.
048500     MOVE 49 TO ACTUAL-KEY-1.
048600     MOVE 49 TO RECORD-NUMXXX.
048700 TEST-6.
048800     ADD 3 TO RECORD-NUMXXX.
048900     ADD 3 TO ACTUAL-KEY-1.
049000     IF RECORD-NUMXXX IS GREATER THAN 125 GO TO TEST-6-EXIT.
049100     MOVE RECORD-SKELTON TO RAC-REC-1.
049200     WRITE RAC-REC-1 INVALID KEY PERFORM ERROR-INVALID-KEY.
049300     GO TO TEST-6.
049400 TEST-6-EXIT.
049500     IF REC-CT IS EQUAL TO ZERO PERFORM PASS
049600        PERFORM PRINT-DETAIL.
049700 TEST-7-INIT.
049800     MOVE "REL-TEST-007" TO PAR-NAME.
049900     MOVE ZERO TO REC-CT.
050000     MOVE 128 TO ACTUAL-KEY-1.
050100     MOVE 128 TO RECORD-NUMXXX.
050200 TEST-7.
050300     SUBTRACT 3 FROM RECORD-NUMXXX.
050400     SUBTRACT 3 FROM ACTUAL-KEY-1.
050500     IF RECORD-NUMXXX IS LESS THAN 53 GO TO TEST-7-EXIT.
050600     MOVE RECORD-SKELTON TO RAC-REC-1.
050700     WRITE RAC-REC-1 INVALID KEY PERFORM ERROR-INVALID-KEY.
050800     GO TO TEST-7.
050900 TEST-7-EXIT.
051000     IF REC-CT IS EQUAL TO ZERO PERFORM PASS
051100        PERFORM PRINT-DETAIL.
051200 TEST-8-INIT.
051300     MOVE "WRITE RL-FR8" TO FEATURE.
051400     MOVE "REL-TEST-008" TO PAR-NAME.
051500     MOVE ZERO TO REC-CT.
051600     MOVE 0 TO ACTUAL-KEY-2.
051700     MOVE 0 TO RECORD-NUMXXX.
051800 TEST-8.
051900     ADD 1 TO RECORD-NUMXXX.
052000     ADD 1 TO ACTUAL-KEY-2.
052100     IF RECORD-NUMXXX IS GREATER THAN 25 GO TO TEST-8-EXIT.
052200     MOVE RECORD-SKELTON TO RAC-REC-2.
052300     WRITE RAC-REC-2 INVALID KEY PERFORM ERROR-INVALID-KEY.
052400     GO TO TEST-8.
052500 TEST-8-EXIT.
052600     IF REC-CT IS EQUAL TO ZERO PERFORM PASS
052700        PERFORM PRINT-DETAIL.
052800 TEST-9.
052900     MOVE "CLOSE RL-FR7" TO FEATURE.
053000     MOVE "REL-TEST-009" TO PAR-NAME.
053100     MOVE ZERO TO REC-CT.
053200     PERFORM PRINT-DETAIL.
053300     CLOSE RL-FR7.
053400 TEST-10.
053500     MOVE "CLOSE RL-FR8" TO FEATURE.
053600     MOVE "REL-TEST-010" TO PAR-NAME.
053700     PERFORM PRINT-DETAIL.
053800     CLOSE RL-FR8.
053900 TEST-11.
054000     MOVE "OPEN INPUT RL-FR8" TO FEATURE.
054100     MOVE "REL-TEST-011" TO PAR-NAME.
054200     PERFORM PRINT-DETAIL.
054300     OPEN INPUT RL-FR8.
054400 TEST-12.
054500     MOVE "OPEN I-O RL-FR7" TO FEATURE.
054600     MOVE "REL-TEST-012" TO PAR-NAME.
054700     PERFORM PRINT-DETAIL.
054800     OPEN I-O RL-FR7.
054900 TEST-13-INIT.
055000     MOVE "READ RL-FR7" TO FEATURE.
055100     MOVE "REL-TEST-013" TO PAR-NAME.
055200     MOVE 9 TO ACTUAL-KEY-1.
055300     MOVE 9 TO RECORD-NUMXXX.
055400 TEST-13.
055500     ADD 1 TO ACTUAL-KEY-1.
055600     ADD 1 TO RECORD-NUMXXX.
055700     IF RECORD-NUMXXX IS GREATER THAN 20 GO TO TEST-13-EXIT.
055800     READ RL-FR7 INVALID KEY PERFORM ERROR-INVALID-KEY
055900        GO TO TEST-13.
056000     IF RECORD-NUMXXX IS NOT EQUAL TO RECORD-NO-1
056100        PERFORM ERROR-WRONG-RECORD.
056200     GO TO TEST-13.
056300 TEST-13-EXIT.
056400     IF REC-CT IS EQUAL TO ZERO PERFORM PASS
056500        PERFORM PRINT-DETAIL.
056600 TEST-14-INIT.
056700     MOVE "READ RL-FR8" TO FEATURE.
056800     MOVE "REL-TEST-014" TO PAR-NAME.
056900     MOVE ZERO TO REC-CT.
057000     MOVE 0 TO ACTUAL-KEY-2.
057100     MOVE 0 TO RECORD-NUMXXX.
057200 TEST-14.
057300     ADD 3 TO ACTUAL-KEY-2.
057400     ADD 3 TO RECORD-NUMXXX.
057500     IF RECORD-NUMXXX IS GREATER THAN 25 GO TO TEST-14-EXIT.
057600     READ RL-FR8 INVALID KEY PERFORM ERROR-INVALID-KEY
057700        GO TO TEST-14.
057800     IF RECORD-NUMXXX IS NOT EQUAL TO RECORD-NO-2
057900        MOVE RECORD-NO-2 TO RECORD-NO-1
058000        PERFORM ERROR-WRONG-RECORD.
058100     GO TO TEST-14.
058200 TEST-14-EXIT.
058300     IF REC-CT IS EQUAL TO ZERO PERFORM PASS
058400        PERFORM PRINT-DETAIL.
058500 TEST-15-INIT.
058600     MOVE "READ RL-FR7" TO FEATURE.
058700     MOVE "REL-TEST-015" TO PAR-NAME.
058800     MOVE ZERO TO REC-CT.
058900     MOVE 14 TO ACTUAL-KEY-1.
059000     MOVE 14 TO RECORD-NUMXXX.
059100 TEST-15.
059200     ADD  14 TO ACTUAL-KEY-1.
059300     ADD  14 TO RECORD-NUMXXX.
059400     IF RECORD-NUMXXX IS GREATER THAN 125 GO TO TEST-15-EXIT.
059500     READ RL-FR7 INVALID KEY PERFORM ERROR-INVALID-KEY
059600        GO TO TEST-14.
059700     IF RECORD-NUMXXX IS NOT EQUAL TO RECORD-NO-1
059800        PERFORM ERROR-WRONG-RECORD.
059900     GO TO TEST-15.
060000 TEST-15-EXIT.
060100     IF REC-CT IS EQUAL TO ZERO PERFORM PASS
060200        PERFORM PRINT-DETAIL.
060300 TEST-16-INIT.
060400     MOVE "REL-TEST-016" TO PAR-NAME.
060500     MOVE ZERO TO REC-CT.
060600     MOVE 11 TO ACTUAL-KEY-1.
060700     MOVE 11 TO RECORD-NUMXXX.
060800 TEST-16.
060900     ADD 17 TO ACTUAL-KEY-1.
061000     ADD 17 TO RECORD-NUMXXX.
061100     IF RECORD-NUMXXX IS GREATER THAN 125 GO TO TEST-16-EXIT.
061200     READ RL-FR7 INVALID KEY PERFORM ERROR-INVALID-KEY
061300        GO TO TEST-16.
061400     IF RECORD-NUMXXX IS NOT EQUAL TO RECORD-NO-1
061500        PERFORM ERROR-WRONG-RECORD.
061600     GO TO TEST-16.
061700 TEST-16-EXIT.
061800     IF REC-CT IS EQUAL TO ZERO PERFORM PASS
061900        PERFORM PRINT-DETAIL.
062000 TEST-17-INIT.
062100     MOVE "WRITE RL-FR7" TO FEATURE.
062200     MOVE "REL-TEST-017" TO PAR-NAME.
062300     MOVE ZERO TO REC-CT.
062400     MOVE 125 TO ACTUAL-KEY-1.
062500     MOVE 125 TO RECORD-NUMXXX.
062600 TEST-17.
062700     ADD 5 TO ACTUAL-KEY-1.
062800     ADD 5 TO RECORD-NUMXXX.
062900     IF RECORD-NUMXXX IS GREATER THAN 200 GO TO TEST-17-EXIT.
063000     MOVE RECORD-SKELTON TO RAC-REC-1.
063100     WRITE RAC-REC-1 INVALID KEY PERFORM ERROR-INVALID-KEY.
063200     GO TO TEST-17.
063300 TEST-17-EXIT.
063400     IF REC-CT IS EQUAL TO ZERO PERFORM PASS
063500        PERFORM PRINT-DETAIL.
063600 TEST-18.
063700     MOVE "READ RL-FR7" TO FEATURE.
063800     MOVE "REL-TEST-018" TO PAR-NAME.
063900     MOVE ZERO TO REC-CT.
064000     MOVE 121 TO ACTUAL-KEY-1.
064100     MOVE 121 TO RECORD-NUMXXX.
064200     READ RL-FR7 INVALID KEY PERFORM ERROR-INVALID-KEY
064300        GO TO TEST-19.
064400     IF RECORD-NO-1 IS NOT EQUAL TO RECORD-NUMXXX
064500        PERFORM ERROR-WRONG-RECORD
064600        GO TO TEST-19.
064700     PERFORM PASS.
064800     PERFORM PRINT-DETAIL.
064900 TEST-19.
065000     MOVE "REL-TEST-019" TO PAR-NAME.
065100     MOVE ZERO TO REC-CT.
065200     MOVE 57 TO ACTUAL-KEY-1.
065300     MOVE 57 TO RECORD-NUMXXX.
065400     READ RL-FR7 INVALID KEY PERFORM ERROR-INVALID-KEY
065500        GO TO TEST-20.
065600     IF RECORD-NUMXXX IS NOT EQUAL TO RECORD-NO-1
065700        PERFORM ERROR-WRONG-RECORD
065800        GO TO TEST-20.
065900     PERFORM PASS.
066000     PERFORM PRINT-DETAIL.
066100 TEST-20.
066200     MOVE "READ RL-FR8" TO FEATURE.
066300     MOVE "REL-TEST-020" TO PAR-NAME.
066400     MOVE ZERO TO REC-CT.
066500     MOVE 12 TO RECORD-NUMXXX.
066600     MOVE 12 TO ACTUAL-KEY-2.
066700     READ RL-FR8 INVALID KEY PERFORM ERROR-INVALID-KEY
066800        GO TO TEST-21.
066900     IF RECORD-NUMXXX IS NOT EQUAL TO RECORD-NO-2
067000        MOVE RECORD-NO-2 TO RECORD-NO-1
067100        PERFORM ERROR-WRONG-RECORD
067200        GO TO TEST-21.
067300     PERFORM PASS
067400     PERFORM PRINT-DETAIL.
067500 TEST-21.
067600     MOVE "INVALID KEY RL-FR7" TO FEATURE.
067700     MOVE "REL-TEST-021" TO PAR-NAME.
067800     MOVE ZERO TO REC-CT.
067900     MOVE 237 TO ACTUAL-KEY-1.
068000     READ RL-FR7 INVALID KEY PERFORM PASS
068100        PERFORM PRINT-DETAIL
068200        GO TO TEST-22.
068300     PERFORM ERROR-INVALID-KEY-EXPECTED.
068400 TEST-22.
068500     MOVE "REL-TEST-022" TO PAR-NAME.
068600     MOVE 250 TO ACTUAL-KEY-1.
068700     READ RL-FR7 INVALID KEY PERFORM PASS
068800        PERFORM PRINT-DETAIL
068900        GO TO TEST-23.
069000     PERFORM ERROR-INVALID-KEY-EXPECTED.
069100 TEST-23.
069200     MOVE "INVALID KEY RL-FR8" TO FEATURE.
069300     MOVE "REL-TEST-023" TO PAR-NAME.
069400     MOVE 150 TO ACTUAL-KEY-2.
069500     READ RL-FR8 INVALID KEY PERFORM PASS
069600        PERFORM PRINT-DETAIL
069700        GO TO TEST-24.
069800     MOVE ACTUAL-KEY-2 TO ACTUAL-KEY-1.
069900     PERFORM ERROR-INVALID-KEY-EXPECTED.
070000 TEST-24.
070100     MOVE "INVALID KEY RL-FR7" TO FEATURE.
070200     MOVE "REL-TEST-024" TO PAR-NAME.
070300     MOVE 230 TO ACTUAL-KEY-1.
070400     READ RL-FR7 INVALID KEY PERFORM PASS
070500        PERFORM PRINT-DETAIL
070600        GO TO TEST-25-INIT.
070700     PERFORM ERROR-INVALID-KEY-EXPECTED.
070800 TEST-25-INIT.
070900     MOVE "REWRITE RL-FR7" TO FEATURE.
071000     MOVE "REL-TEST-025" TO PAR-NAME.
071100     MOVE  0 TO ACTUAL-KEY-1.
071200     MOVE  0 TO RECORD-NUMXXX.
071300     MOVE ZERO TO REC-CT.
071400 TEST-25.
071500     ADD 10 TO ACTUAL-KEY-1.
071600     ADD 10 TO RECORD-NUMXXX.
071700     IF RECORD-NUMXXX IS GREATER THAN 100 GO TO TEST-25-RESET.
071800     READ RL-FR7 INVALID KEY
071900        MOVE "INVALID KEY ON READ BEFORE REWRITE" TO RE-MARK
072000        PERFORM ERROR-WRONG-RECORD
072100        GO TO TEST-25.
072200     IF RECORD-NUMXXX IS NOT EQUAL TO RECORD-NO-1
072300        PERFORM ERROR-WRONG-RECORD
072400        GO TO TEST-25.
072500     MOVE "UPDATED" TO UPDATE-FIELD.
072600     REWRITE RAC-REC-1 INVALID KEY
072700        MOVE "INVALID KEY ON REWRITE" TO RE-MARK
072800        PERFORM ERROR-INVALID-KEY.
072900     GO TO TEST-25.
073000 TEST-25-RESET.
073100     MOVE 0  TO ACTUAL-KEY-1.
073200     MOVE 0  TO RECORD-NUMXXX.
073300 TEST-25-READ.
073400     ADD 10 TO ACTUAL-KEY-1.
073500     ADD 10 TO RECORD-NUMXXX.
073600     IF RECORD-NUMXXX IS GREATER THAN 100 GO TO TEST-25-EXIT.
073700     READ RL-FR7 INVALID KEY
073800        MOVE "INVALID KEY ON READ AFTER REWRITE" TO RE-MARK
073900        PERFORM ERROR-INVALID-KEY
074000        GO TO TEST-25-READ.
074100     IF RECORD-NUMXXX IS NOT EQUAL TO RECORD-NO-1
074200        PERFORM ERROR-WRONG-RECORD
074300        GO TO TEST-25-READ.
074400     IF UPDATE-FIELD IS EQUAL TO "UPDATED" GO TO TEST-25-READ.
074500     IF REC-CT IS EQUAL TO ZERO PERFORM FAIL.
074600     ADD 1 TO REC-CT.
074700     MOVE UPDATE-FIELD TO COMPUTED-A.
074800     MOVE "UPDATED" TO CORRECT-A.
074900     MOVE "RECORD NOT UPDATED PROPERLY" TO RE-MARK.
075000     PERFORM PRINT-DETAIL.
075100     GO TO TEST-25-READ.
075200 TEST-25-EXIT.
075300     IF REC-CT IS EQUAL TO ZERO PERFORM PASS
075400        PERFORM PRINT-DETAIL.
075500 TEST-26.
075600     MOVE "CLOSE RL-FR8" TO FEATURE.
075700     MOVE "REL-TEST-026" TO PAR-NAME.
075800     MOVE ZERO TO REC-CT.
075900     PERFORM PRINT-DETAIL.
076000     CLOSE RL-FR8.
076100 TEST-27.
076200     MOVE "CLOSE RL-FR7" TO FEATURE.
076300     MOVE "REL-TEST-027" TO PAR-NAME.
076400     PERFORM PRINT-DETAIL.
076500     CLOSE RL-FR7.
076600     GO TO SECT-RC-03-001-EXIT.
076700 ERROR-INVALID-KEY.
076800     IF REC-CT IS EQUAL TO ZERO PERFORM FAIL.
076900     ADD 1 TO REC-CT.
077000     MOVE RECORD-NUMXXX TO CORRECT-18V0.
077100     MOVE "INVALID KEY" TO COMPUTED-A.
077200     PERFORM PRINT-DETAIL.
077300 ERROR-INVALID-KEY-EXPECTED.
077400     PERFORM FAIL.
077500     ADD 1 TO REC-CT.
077600     MOVE ACTUAL-KEY-1 TO COMPUTED-18V0.
077700     MOVE "INVALID KEY" TO CORRECT-A.
077800     MOVE "INVALID KEY EXPECTED ON READ" TO RE-MARK.
077900     PERFORM PRINT-DETAIL.
078000 ERROR-WRONG-RECORD.
078100     IF REC-CT IS EQUAL TO ZERO PERFORM FAIL.
078200     ADD 1 TO REC-CT.
078300     MOVE RECORD-NO-1 TO COMPUTED-18V0.
078400     MOVE RECORD-NUMXXX TO CORRECT-18V0.
078500     MOVE "WRONG RECORD FOUND" TO RE-MARK.
078600     PERFORM PRINT-DETAIL.
078700 SECT-RC-03-001-EXIT.
078800     EXIT.
078900 CCVS-EXIT SECTION.
079000 CCVS-999999.
079100     GO TO CLOSE-FILES.
