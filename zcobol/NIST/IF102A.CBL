000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     IF102A.
000400
000500***********************************************************
000600*                                                         *
000700*   This program is intended to form part of the CCVS85   *
000800*   COBOL Test Suite. It contains tests for the           *
000900*   Intrinsic Function ANNUITY.                           *
001000*                                                         *
001100***********************************************************
001200 ENVIRONMENT DIVISION.
001300 CONFIGURATION SECTION.
001400 SOURCE-COMPUTER.
001500     XXXXX082.
001600 OBJECT-COMPUTER.
001700     XXXXX083.
001800 INPUT-OUTPUT SECTION.
001900 FILE-CONTROL.
002000     SELECT PRINT-FILE ASSIGN TO
002100     XXXXX055.
002200 DATA DIVISION.
002300 FILE SECTION.
002400 FD  PRINT-FILE.
002500 01  PRINT-REC PICTURE X(120).
002600 01  DUMMY-RECORD PICTURE X(120).
002700 WORKING-STORAGE SECTION.
002800***********************************************************
002900* Variables specific to the Intrinsic Function Test IF102A*
003000***********************************************************
003100 01  A                   PIC S9(10)          VALUE 4.
003200 01  B                   PIC S9(5)V9(5)      VALUE .25.
003300 01  C                   PIC S9(10)          VALUE 10.
003400 01  D                   PIC S9(10)          VALUE 100.
003500 01  ARG2                PIC S9(10)          VALUE 1.
003600 01  ARR                                     VALUE "40537".
003700     02  IND OCCURS 5 TIMES PIC 9.
003800 01  TEMP                PIC S9(5)V9(5).
003900 01  WS-NUM              PIC S9(5)V9(6).
004000 01  MIN-RANGE           PIC S9(5)V9(7).
004100 01  MAX-RANGE           PIC S9(5)V9(7).
004200*
004300**********************************************************
004400*
004500 01  TEST-RESULTS.
004600     02 FILLER                   PIC X      VALUE SPACE.
004700     02 FEATURE                  PIC X(20)  VALUE SPACE.
004800     02 FILLER                   PIC X      VALUE SPACE.
004900     02 P-OR-F                   PIC X(5)   VALUE SPACE.
005000     02 FILLER                   PIC X      VALUE SPACE.
005100     02  PAR-NAME.
005200       03 FILLER                 PIC X(19)  VALUE SPACE.
005300       03  PARDOT-X              PIC X      VALUE SPACE.
005400       03 DOTVALUE               PIC 99     VALUE ZERO.
005500     02 FILLER                   PIC X(8)   VALUE SPACE.
005600     02 RE-MARK                  PIC X(61).
005700 01  TEST-COMPUTED.
005800     02 FILLER                   PIC X(30)  VALUE SPACE.
005900     02 FILLER                   PIC X(17)  VALUE
006000            "       COMPUTED=".
006100     02 COMPUTED-X.
006200     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
006300     03 COMPUTED-N               REDEFINES COMPUTED-A
006400                                 PIC -9(9).9(9).
006500     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
006600     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
006700     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
006800     03       CM-18V0 REDEFINES COMPUTED-A.
006900         04 COMPUTED-18V0                    PIC -9(18).
007000         04 FILLER                           PIC X.
007100     03 FILLER PIC X(50) VALUE SPACE.
007200 01  TEST-CORRECT.
007300     02 FILLER PIC X(30) VALUE SPACE.
007400     02 FILLER PIC X(17) VALUE "       CORRECT =".
007500     02 CORRECT-X.
007600     03 CORRECT-A                  PIC X(20) VALUE SPACE.
007700     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
007800     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
007900     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
008000     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
008100     03      CR-18V0 REDEFINES CORRECT-A.
008200         04 CORRECT-18V0                     PIC -9(18).
008300         04 FILLER                           PIC X.
008400     03 FILLER PIC X(2) VALUE SPACE.
008500     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
008600 01  TEST-CORRECT-MIN.
008700     02 FILLER PIC X(30) VALUE SPACE.
008800     02 FILLER PIC X(17) VALUE "     MIN VALUE =".
008900     02 CORRECTMI-X.
009000     03 CORRECTMI-A                 PIC X(20) VALUE SPACE.
009100     03 CORRECT-MIN    REDEFINES CORRECTMI-A     PIC -9(9).9(9).
009200     03 CORRECTMI-0V18 REDEFINES CORRECTMI-A     PIC -.9(18).
009300     03 CORRECTMI-4V14 REDEFINES CORRECTMI-A     PIC -9(4).9(14).
009400     03 CORRECTMI-14V4 REDEFINES CORRECTMI-A     PIC -9(14).9(4).
009500     03      CR-18V0 REDEFINES CORRECTMI-A.
009600         04 CORRECTMI-18V0                     PIC -9(18).
009700         04 FILLER                           PIC X.
009800     03 FILLER PIC X(2) VALUE SPACE.
009900     03 FILLER                           PIC X(48) VALUE SPACE.
010000 01  TEST-CORRECT-MAX.
010100     02 FILLER PIC X(30) VALUE SPACE.
010200     02 FILLER PIC X(17) VALUE "     MAX VALUE =".
010300     02 CORRECTMA-X.
010400     03 CORRECTMA-A                  PIC X(20) VALUE SPACE.
010500     03 CORRECT-MAX    REDEFINES CORRECTMA-A     PIC -9(9).9(9).
010600     03 CORRECTMA-0V18 REDEFINES CORRECTMA-A     PIC -.9(18).
010700     03 CORRECTMA-4V14 REDEFINES CORRECTMA-A     PIC -9(4).9(14).
010800     03 CORRECTMA-14V4 REDEFINES CORRECTMA-A     PIC -9(14).9(4).
010900     03      CR-18V0 REDEFINES CORRECTMA-A.
011000         04 CORRECTMA-18V0                     PIC -9(18).
011100         04 FILLER                           PIC X.
011200     03 FILLER PIC X(2) VALUE SPACE.
011300     03 CORMA-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
011400 01  CCVS-C-1.
011500     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
011600-    "SS  PARAGRAPH-NAME
011700-    "       REMARKS".
011800     02 FILLER                     PIC X(20)    VALUE SPACE.
011900 01  CCVS-C-2.
012000     02 FILLER                     PIC X        VALUE SPACE.
012100     02 FILLER                     PIC X(6)     VALUE "TESTED".
012200     02 FILLER                     PIC X(15)    VALUE SPACE.
012300     02 FILLER                     PIC X(4)     VALUE "FAIL".
012400     02 FILLER                     PIC X(94)    VALUE SPACE.
012500 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
012600 01  REC-CT                        PIC 99       VALUE ZERO.
012700 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
012800 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
012900 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
013000 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
013100 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
013200 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
013300 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
013400 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
013500 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
013600 01  CCVS-H-1.
013700     02  FILLER                    PIC X(39)    VALUE SPACES.
013800     02  FILLER                    PIC X(42)    VALUE
013900     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
014000     02  FILLER                    PIC X(39)    VALUE SPACES.
014100 01  CCVS-H-2A.
014200   02  FILLER                        PIC X(40)  VALUE SPACE.
014300   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
014400   02  FILLER                        PIC XXXX   VALUE
014500     "4.2 ".
014600   02  FILLER                        PIC X(28)  VALUE
014700            " COPY - NOT FOR DISTRIBUTION".
014800   02  FILLER                        PIC X(41)  VALUE SPACE.
014900
015000 01  CCVS-H-2B.
015100   02  FILLER                        PIC X(15)  VALUE
015200            "TEST RESULT OF ".
015300   02  TEST-ID                       PIC X(9).
015400   02  FILLER                        PIC X(4)   VALUE
015500            " IN ".
015600   02  FILLER                        PIC X(12)  VALUE
015700     " HIGH       ".
015800   02  FILLER                        PIC X(22)  VALUE
015900            " LEVEL VALIDATION FOR ".
016000   02  FILLER                        PIC X(58)  VALUE
016100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
016200 01  CCVS-H-3.
016300     02  FILLER                      PIC X(34)  VALUE
016400            " FOR OFFICIAL USE ONLY    ".
016500     02  FILLER                      PIC X(58)  VALUE
016600     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
016700     02  FILLER                      PIC X(28)  VALUE
016800            "  COPYRIGHT   1985 ".
016900 01  CCVS-E-1.
017000     02 FILLER                       PIC X(52)  VALUE SPACE.
017100     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
017200     02 ID-AGAIN                     PIC X(9).
017300     02 FILLER                       PIC X(45)  VALUE SPACES.
017400 01  CCVS-E-2.
017500     02  FILLER                      PIC X(31)  VALUE SPACE.
017600     02  FILLER                      PIC X(21)  VALUE SPACE.
017700     02 CCVS-E-2-2.
017800         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
017900         03 FILLER                   PIC X      VALUE SPACE.
018000         03 ENDER-DESC               PIC X(44)  VALUE
018100            "ERRORS ENCOUNTERED".
018200 01  CCVS-E-3.
018300     02  FILLER                      PIC X(22)  VALUE
018400            " FOR OFFICIAL USE ONLY".
018500     02  FILLER                      PIC X(12)  VALUE SPACE.
018600     02  FILLER                      PIC X(58)  VALUE
018700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
018800     02  FILLER                      PIC X(13)  VALUE SPACE.
018900     02 FILLER                       PIC X(15)  VALUE
019000             " COPYRIGHT 1985".
019100 01  CCVS-E-4.
019200     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
019300     02 FILLER                       PIC X(4)   VALUE " OF ".
019400     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
019500     02 FILLER                       PIC X(40)  VALUE
019600      "  TESTS WERE EXECUTED SUCCESSFULLY".
019700 01  XXINFO.
019800     02 FILLER                       PIC X(19)  VALUE
019900            "*** INFORMATION ***".
020000     02 INFO-TEXT.
020100       04 FILLER                     PIC X(8)   VALUE SPACE.
020200       04 XXCOMPUTED                 PIC X(20).
020300       04 FILLER                     PIC X(5)   VALUE SPACE.
020400       04 XXCORRECT                  PIC X(20).
020500     02 INF-ANSI-REFERENCE           PIC X(48).
020600 01  HYPHEN-LINE.
020700     02 FILLER  PIC IS X VALUE IS SPACE.
020800     02 FILLER  PIC IS X(65)    VALUE IS "************************
020900-    "*****************************************".
021000     02 FILLER  PIC IS X(54)    VALUE IS "************************
021100-    "******************************".
021200 01  CCVS-PGM-ID                     PIC X(9)   VALUE
021300     "IF102A".
021400 PROCEDURE DIVISION.
021500 CCVS1 SECTION.
021600 OPEN-FILES.
021700     OPEN     OUTPUT PRINT-FILE.
021800     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
021900     MOVE    SPACE TO TEST-RESULTS.
022000     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
022100     GO TO CCVS1-EXIT.
022200 CLOSE-FILES.
022300     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
022400 TERMINATE-CCVS.
022500     STOP     RUN.
022600 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
022700 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
022800 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
022900 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
023000     MOVE "****TEST DELETED****" TO RE-MARK.
023100 PRINT-DETAIL.
023200     IF REC-CT NOT EQUAL TO ZERO
023300             MOVE "." TO PARDOT-X
023400             MOVE REC-CT TO DOTVALUE.
023500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
023600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
023700        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
023800          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
023900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
024000     MOVE SPACE TO CORRECT-X.
024100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
024200     MOVE     SPACE TO RE-MARK.
024300 HEAD-ROUTINE.
024400     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024500     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024600     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
024700     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
024800 COLUMN-NAMES-ROUTINE.
024900     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025000     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
025200 END-ROUTINE.
025300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
025400 END-RTN-EXIT.
025500     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025600 END-ROUTINE-1.
025700      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
025800      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
025900      ADD PASS-COUNTER TO ERROR-HOLD.
026000      MOVE PASS-COUNTER TO CCVS-E-4-1.
026100      MOVE ERROR-HOLD TO CCVS-E-4-2.
026200      MOVE CCVS-E-4 TO CCVS-E-2-2.
026300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
026400  END-ROUTINE-12.
026500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
026600     IF       ERROR-COUNTER IS EQUAL TO ZERO
026700         MOVE "NO " TO ERROR-TOTAL
026800         ELSE
026900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
027000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
027100     PERFORM WRITE-LINE.
027200 END-ROUTINE-13.
027300     IF DELETE-COUNTER IS EQUAL TO ZERO
027400         MOVE "NO " TO ERROR-TOTAL  ELSE
027500         MOVE DELETE-COUNTER TO ERROR-TOTAL.
027600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
027700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027800      IF   INSPECT-COUNTER EQUAL TO ZERO
027900          MOVE "NO " TO ERROR-TOTAL
028000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
028100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
028200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028400 WRITE-LINE.
028500     ADD 1 TO RECORD-COUNT.
028600Y    IF RECORD-COUNT GREATER 42
028700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
028800Y        MOVE SPACE TO DUMMY-RECORD
028900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
029000Y        MOVE CCVS-H-1  TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
029100Y        MOVE CCVS-H-2A TO DUMMY-RECORD  PERFORM WRT-LN 2 TIMES
029200Y        MOVE CCVS-H-2B TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
029300Y        MOVE CCVS-H-3  TO DUMMY-RECORD  PERFORM WRT-LN 3 TIMES
029400Y        MOVE CCVS-C-1  TO DUMMY-RECORD  PERFORM WRT-LN
029500Y        MOVE CCVS-C-2  TO DUMMY-RECORD  PERFORM WRT-LN
029600Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
029700Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
029800Y        MOVE ZERO TO RECORD-COUNT.
029900     PERFORM WRT-LN.
030000 WRT-LN.
030100     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
030200     MOVE SPACE TO DUMMY-RECORD.
030300 BLANK-LINE-PRINT.
030400     PERFORM WRT-LN.
030500 FAIL-ROUTINE.
030600     IF     COMPUTED-X NOT EQUAL TO SPACE
030700            GO TO FAIL-ROUTINE-WRITE.
030800     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
030900     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
031000     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
031100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031200     MOVE   SPACES TO INF-ANSI-REFERENCE.
031300     GO TO  FAIL-ROUTINE-EX.
031400 FAIL-ROUTINE-WRITE.
031500     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE.
031600     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE
031700                              CORMA-ANSI-REFERENCE.
031800     IF CORRECT-MIN NOT EQUAL TO SPACES THEN
031900           MOVE TEST-CORRECT-MIN TO PRINT-REC PERFORM WRITE-LINE
032000           MOVE TEST-CORRECT-MAX TO PRINT-REC PERFORM WRITE-LINE
032100     ELSE
032200           MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE.
032300     PERFORM WRITE-LINE.
032400     MOVE   SPACES TO COR-ANSI-REFERENCE.
032500 FAIL-ROUTINE-EX. EXIT.
032600 BAIL-OUT.
032700     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
032800     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
032900 BAIL-OUT-WRITE.
033000     MOVE CORRECT-A TO XXCORRECT.
033100     MOVE COMPUTED-A TO XXCOMPUTED.
033200     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
033300     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033400     MOVE   SPACES TO INF-ANSI-REFERENCE.
033500 BAIL-OUT-EX. EXIT.
033600 CCVS1-EXIT.
033700     EXIT.
033800********************************************************
033900*                                                      *
034000*    Intrinsic Function Tests         IF102A - ANNUITY *
034100*                                                      *
034200********************************************************
034300 SECT-IF102A SECTION.
034400 F-ANNUITY-INFO.
034500     MOVE     "See ref. A-34 2.6" TO ANSI-REFERENCE.
034600     MOVE     "ANNUITY Function" TO FEATURE.
034700*****************TEST (a) - SIMPLE TEST*****************
034800 F-ANNUITY-01.
034900     MOVE ZERO TO WS-NUM.
035000     MOVE  0.249995 TO MIN-RANGE.
035100     MOVE  0.250005 TO MAX-RANGE.
035200 F-ANNUITY-TEST-01.
035300     COMPUTE WS-NUM = FUNCTION ANNUITY(0, 4).
035400     IF (WS-NUM >= MIN-RANGE) AND
035500        (WS-NUM <= MAX-RANGE) THEN
035600                    PERFORM PASS
035700     ELSE
035800                    MOVE WS-NUM TO COMPUTED-N
035900                    MOVE MIN-RANGE TO CORRECT-MIN
036000                    MOVE MAX-RANGE TO CORRECT-MAX
036100                    PERFORM FAIL.
036200     GO TO F-ANNUITY-WRITE-01.
036300 F-ANNUITY-DELETE-01.
036400     PERFORM  DE-LETE.
036500     GO TO    F-ANNUITY-WRITE-01.
036600 F-ANNUITY-WRITE-01.
036700     MOVE "F-ANNUITY-01" TO PAR-NAME.
036800     PERFORM  PRINT-DETAIL.
036900*****************TEST (b) - SIMPLE TEST*****************
037000 F-ANNUITY-02.
037100     EVALUATE FUNCTION ANNUITY(2.9, 4)
037200     WHEN  2.91252 THRU  2.91264
037300                    PERFORM PASS
037400     WHEN OTHER
037500                    PERFORM FAIL.
037600     GO TO F-ANNUITY-WRITE-02.
037700 F-ANNUITY-DELETE-02.
037800     PERFORM  DE-LETE.
037900     GO TO    F-ANNUITY-WRITE-02.
038000 F-ANNUITY-WRITE-02.
038100     MOVE "F-ANNUITY-02" TO PAR-NAME.
038200     PERFORM  PRINT-DETAIL.
038300*****************TEST (c) - SIMPLE TEST*****************
038400 F-ANNUITY-03.
038500     MOVE  0.308663 TO MIN-RANGE.
038600     MOVE  0.308675 TO MAX-RANGE.
038700 F-ANNUITY-TEST-03.
038800     IF (FUNCTION ANNUITY(.09, A) >= MIN-RANGE) AND
038900        (FUNCTION ANNUITY(.09, A) <= MAX-RANGE) THEN
039000                    PERFORM PASS
039100     ELSE
039200                    PERFORM FAIL.
039300     GO TO F-ANNUITY-WRITE-03.
039400 F-ANNUITY-DELETE-03.
039500     PERFORM  DE-LETE.
039600     GO TO    F-ANNUITY-WRITE-03.
039700 F-ANNUITY-WRITE-03.
039800     MOVE "F-ANNUITY-03" TO PAR-NAME.
039900     PERFORM  PRINT-DETAIL.
040000*****************TEST (d) - SIMPLE TEST*****************
040100 F-ANNUITY-04.
040200     MOVE ZERO TO WS-NUM.
040300     MOVE  0.694430 TO MIN-RANGE.
040400     MOVE  0.694458 TO MAX-RANGE.
040500 F-ANNUITY-TEST-04.
040600     COMPUTE WS-NUM = FUNCTION ANNUITY(B, 2).
040700     IF (WS-NUM >= MIN-RANGE) AND
040800        (WS-NUM <= MAX-RANGE) THEN
040900                    PERFORM PASS
041000     ELSE
041100                    MOVE WS-NUM TO COMPUTED-N
041200                    MOVE MIN-RANGE TO CORRECT-MIN
041300                    MOVE MAX-RANGE TO CORRECT-MAX
041400                    PERFORM FAIL.
041500     GO TO F-ANNUITY-WRITE-04.
041600 F-ANNUITY-DELETE-04.
041700     PERFORM  DE-LETE.
041800     GO TO    F-ANNUITY-WRITE-04.
041900 F-ANNUITY-WRITE-04.
042000     MOVE "F-ANNUITY-04" TO PAR-NAME.
042100     PERFORM  PRINT-DETAIL.
042200*****************TEST (e) - SIMPLE TEST*****************
042300 F-ANNUITY-05.
042400     MOVE ZERO TO WS-NUM.
042500     MOVE  0.423434 TO MIN-RANGE.
042600     MOVE  0.423450 TO MAX-RANGE.
042700 F-ANNUITY-TEST-05.
042800     COMPUTE WS-NUM = FUNCTION ANNUITY(B, 4).
042900     IF (WS-NUM >= MIN-RANGE) AND
043000        (WS-NUM <= MAX-RANGE) THEN
043100                    PERFORM PASS
043200     ELSE
043300                    MOVE WS-NUM TO COMPUTED-N
043400                    MOVE MIN-RANGE TO CORRECT-MIN
043500                    MOVE MAX-RANGE TO CORRECT-MAX
043600                    PERFORM FAIL.
043700     GO TO F-ANNUITY-WRITE-05.
043800 F-ANNUITY-DELETE-05.
043900     PERFORM  DE-LETE.
044000     GO TO    F-ANNUITY-WRITE-05.
044100 F-ANNUITY-WRITE-05.
044200     MOVE "F-ANNUITY-05" TO PAR-NAME.
044300     PERFORM  PRINT-DETAIL.
044400*****************TEST (f) - SIMPLE TEST*****************
044500 F-ANNUITY-06.
044600     MOVE ZERO TO WS-NUM.
044700     MOVE  3.99992 TO MIN-RANGE.
044800     MOVE  4.00008 TO MAX-RANGE.
044900 F-ANNUITY-TEST-06.
045000     COMPUTE WS-NUM = FUNCTION ANNUITY(A, 9).
045100     IF (WS-NUM >= MIN-RANGE) AND
045200        (WS-NUM <= MAX-RANGE) THEN
045300                    PERFORM PASS
045400     ELSE
045500                    MOVE WS-NUM TO COMPUTED-N
045600                    MOVE MIN-RANGE TO CORRECT-MIN
045700                    MOVE MAX-RANGE TO CORRECT-MAX
045800                    PERFORM FAIL.
045900     GO TO F-ANNUITY-WRITE-06.
046000 F-ANNUITY-DELETE-06.
046100     PERFORM  DE-LETE.
046200     GO TO    F-ANNUITY-WRITE-06.
046300 F-ANNUITY-WRITE-06.
046400     MOVE "F-ANNUITY-06" TO PAR-NAME.
046500     PERFORM  PRINT-DETAIL.
046600*****************TEST (g) -SIMPLE TEST******************
046700 F-ANNUITY-07.
046800     MOVE ZERO TO WS-NUM.
046900     MOVE  5.00054 TO MIN-RANGE.
047000     MOVE  5.00074 TO MAX-RANGE.
047100 F-ANNUITY-TEST-07.
047200     COMPUTE WS-NUM = FUNCTION ANNUITY(5, 5).
047300     IF (WS-NUM >= MIN-RANGE) AND
047400        (WS-NUM <= MAX-RANGE) THEN
047500                    PERFORM PASS
047600     ELSE
047700                    MOVE WS-NUM TO COMPUTED-N
047800                    MOVE MIN-RANGE TO CORRECT-MIN
047900                    MOVE MAX-RANGE TO CORRECT-MAX
048000                    PERFORM FAIL.
048100     GO TO F-ANNUITY-WRITE-07.
048200 F-ANNUITY-DELETE-07.
048300     PERFORM  DE-LETE.
048400     GO TO    F-ANNUITY-WRITE-07.
048500 F-ANNUITY-WRITE-07.
048600     MOVE "F-ANNUITY-07" TO PAR-NAME.
048700     PERFORM  PRINT-DETAIL.
048800*****************TEST (h) - SIMPLE TEST*****************
048900 F-ANNUITY-08.
049000     MOVE ZERO TO WS-NUM.
049100     MOVE  4.03217   TO MIN-RANGE.
049200     MOVE  4.03233 TO MAX-RANGE.
049300 F-ANNUITY-TEST-08.
049400     COMPUTE WS-NUM = FUNCTION ANNUITY(IND(1), IND(A)).
049500     IF (WS-NUM >= MIN-RANGE) AND
049600        (WS-NUM <= MAX-RANGE) THEN
049700                    PERFORM PASS
049800     ELSE
049900                    MOVE WS-NUM TO COMPUTED-N
050000                    MOVE MIN-RANGE TO CORRECT-MIN
050100                    MOVE MAX-RANGE TO CORRECT-MAX
050200                    PERFORM FAIL.
050300     GO TO F-ANNUITY-WRITE-08.
050400 F-ANNUITY-DELETE-08.
050500     PERFORM  DE-LETE.
050600     GO TO    F-ANNUITY-WRITE-08.
050700 F-ANNUITY-WRITE-08.
050800     MOVE "F-ANNUITY-08" TO PAR-NAME.
050900     PERFORM  PRINT-DETAIL.
051000*****************TEST (a) - COMPLEX TEST****************
051100 F-ANNUITY-09.
051200     MOVE ZERO TO WS-NUM.
051300     MOVE  0.204824 TO MIN-RANGE.
051400     MOVE  0.204840 TO MAX-RANGE.
051500 F-ANNUITY-TEST-09.
051600     COMPUTE WS-NUM = FUNCTION ANNUITY(B / 2, 8).
051700     IF (WS-NUM >= MIN-RANGE) AND
051800        (WS-NUM <= MAX-RANGE) THEN
051900                    PERFORM PASS
052000     ELSE
052100                    MOVE WS-NUM TO COMPUTED-N
052200                    MOVE MIN-RANGE TO CORRECT-MIN
052300                    MOVE MAX-RANGE TO CORRECT-MAX
052400                    PERFORM FAIL.
052500     GO TO F-ANNUITY-WRITE-09.
052600 F-ANNUITY-DELETE-09.
052700     PERFORM  DE-LETE.
052800     GO TO    F-ANNUITY-WRITE-09.
052900 F-ANNUITY-WRITE-09.
053000     MOVE "F-ANNUITY-09" TO PAR-NAME.
053100     PERFORM  PRINT-DETAIL.
053200*****************TEST (b) - COMPLEX TEST****************
053300 F-ANNUITY-10.
053400     MOVE ZERO TO WS-NUM.
053500     MOVE 0.576553 TO MIN-RANGE.
053600     MOVE 0.576599 TO MAX-RANGE.
053700 F-ANNUITY-TEST-10.
053800     COMPUTE WS-NUM = FUNCTION ANNUITY(
053900                      FUNCTION ANNUITY(0, 3), 3).
054000     IF (WS-NUM >= MIN-RANGE) AND
054100        (WS-NUM <= MAX-RANGE) THEN
054200                    PERFORM PASS
054300     ELSE
054400                    MOVE WS-NUM TO COMPUTED-N
054500                    MOVE MIN-RANGE TO CORRECT-MIN
054600                    MOVE MAX-RANGE TO CORRECT-MAX
054700                    PERFORM FAIL.
054800     GO TO F-ANNUITY-WRITE-10.
054900 F-ANNUITY-DELETE-10.
055000     PERFORM  DE-LETE.
055100     GO TO    F-ANNUITY-WRITE-10.
055200 F-ANNUITY-WRITE-10.
055300     MOVE "F-ANNUITY-10" TO PAR-NAME.
055400     PERFORM  PRINT-DETAIL.
055500*****************TEST (c) - COMPLEX TEST****************
055600 F-ANNUITY-11.
055700     MOVE ZERO TO WS-NUM.
055800     MOVE 4.49978 TO MIN-RANGE.
055900     MOVE 5.50022 TO MAX-RANGE.
056000 F-ANNUITY-TEST-11.
056100     COMPUTE WS-NUM = FUNCTION ANNUITY(0, 2) + 5.
056200     IF (WS-NUM >= MIN-RANGE) AND
056300        (WS-NUM <= MAX-RANGE) THEN
056400                    PERFORM PASS
056500     ELSE
056600                    MOVE WS-NUM TO COMPUTED-N
056700                    MOVE MIN-RANGE TO CORRECT-MIN
056800                    MOVE MAX-RANGE TO CORRECT-MAX
056900                    PERFORM FAIL.
057000     GO TO F-ANNUITY-WRITE-11.
057100 F-ANNUITY-DELETE-11.
057200     PERFORM  DE-LETE.
057300     GO TO    F-ANNUITY-WRITE-11.
057400 F-ANNUITY-WRITE-11.
057500     MOVE "F-ANNUITY-11" TO PAR-NAME.
057600     PERFORM  PRINT-DETAIL.
057700*****************TEST (d) - COMPLEX TEST****************
057800 F-ANNUITY-12.
057900     MOVE ZERO TO WS-NUM.
058000     MOVE 0.999960 TO MIN-RANGE.
058100     MOVE 1.00004 TO MAX-RANGE.
058200 F-ANNUITY-TEST-12.
058300     COMPUTE WS-NUM = FUNCTION ANNUITY(0, 2) +
058400                      FUNCTION ANNUITY(0, 2).
058500     IF (WS-NUM >= MIN-RANGE) AND
058600        (WS-NUM <= MAX-RANGE) THEN
058700                    PERFORM PASS
058800     ELSE
058900                    MOVE WS-NUM TO COMPUTED-N
059000                    MOVE MIN-RANGE TO CORRECT-MIN
059100                    MOVE MAX-RANGE TO CORRECT-MAX
059200                    PERFORM FAIL.
059300     GO TO F-ANNUITY-WRITE-12.
059400 F-ANNUITY-DELETE-12.
059500     PERFORM  DE-LETE.
059600     GO TO    F-ANNUITY-WRITE-12.
059700 F-ANNUITY-WRITE-12.
059800     MOVE "F-ANNUITY-12" TO PAR-NAME.
059900     PERFORM  PRINT-DETAIL.
060000*****************SPECIAL PERFORM TEST**********************
060100 F-ANNUITY-13.
060200     PERFORM F-ANNUITY-TEST-13
060300       UNTIL FUNCTION ANNUITY(0, ARG2) < .25.
060400     PERFORM PASS.
060500     GO TO F-ANNUITY-WRITE-13.
060600 F-ANNUITY-TEST-13.
060700     COMPUTE ARG2 = ARG2 + 1.
060800 F-ANNUITY-DELETE-13.
060900     PERFORM  DE-LETE.
061000     GO TO    F-ANNUITY-WRITE-13.
061100 F-ANNUITY-WRITE-13.
061200     MOVE "F-ANNUITY-13" TO PAR-NAME.
061300     PERFORM  PRINT-DETAIL.
061400********************END OF TESTS***************
061500 CCVS-EXIT SECTION.
061600 CCVS-999999.
061700     GO TO CLOSE-FILES.
