000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST135A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*
002200*    ST205 BUILDS A FILE, SORTS IT, AND CHECKS IT IN AN OUTPUT
002300*    PROCEDURE. THE UNUSUAL FEATURE OF THIS PROGRAM IS THAT THE
002400*    FILES SHARE A NETWORK OF SAME AREA, SAME RECORD AREA, AND
002500*    SAME SORT AREA. IN ORDER TO THOROUGHLY EXERCISE THE "SAME"
002600*    OPTIONS, TWO DUMMY FILES, CALLED USELESS-FILE AND DEADWEIGHT-
002700*    FILE, ARE OPENED, CLOSED, READ, AND WRITTEN UPON. HOWEVER,
002800*    THE CONTENTS OF THESE TWO FILES ARE NEVER CHECKED.
002900*    SEE THE I-O-CONTROL PARAGRAPH FOR THE ACTUAL ORGANIZATION.
003000
003100 ENVIRONMENT DIVISION.
003200 CONFIGURATION SECTION.
003300 SOURCE-COMPUTER.
003400     XXXXX082.
003500 OBJECT-COMPUTER.
003600     XXXXX083.
003700 INPUT-OUTPUT SECTION.
003800 FILE-CONTROL.
003900     SELECT PRINT-FILE ASSIGN TO
004000     XXXXX055.
004100     SELECT SORTIN-2E ASSIGN TO
004200     XXXXX001.
004300     SELECT SORTOUT-2E ASSIGN TO
004400     XXXXX002.
004500     SELECT USELESS-FILE ASSIGN TO
004600     XXXXX003.
004700     SELECT DEADWEIGHT-FILE ASSIGN TO
004800     XXXXX004.
004900     SELECT SORTFILE-2E ASSIGN TO
005000     XXXXX027.
005100 I-O-CONTROL.
005200     SAME RECORD AREA FOR
005300              USELESS-FILE
005400              DEADWEIGHT-FILE
005500     SAME SORT
005600              SORTFILE-2E
005700              USELESS-FILE
005800     SAME
005900              SORTIN-2E
006000              SORTOUT-2E.
006100 DATA DIVISION.
006200 FILE SECTION.
006300 FD  PRINT-FILE.
006400 01  PRINT-REC PICTURE X(120).
006500 01  DUMMY-RECORD PICTURE X(120).
006600 FD  SORTIN-2E
006700     LABEL RECORDS STANDARD
006800C    VALUE OF
006900C    XXXXX074
007000C    IS
007100C    XXXXX075
007200G    XXXXX069
007300     DATA RECORD IS SORTIN-REC.
007400 01  SORTIN-REC.
007500     02 SORTIN-NON-KEY-1          PICTURE A(36) JUSTIFIED RIGHT.
007600     02 SORTIN-KEY                PICTURE 9(8) USAGE DISPLAY.
007700     02 SORTIN-NON-KEY-2          PICTURE A(36) JUSTIFIED RIGHT.
007800 FD  SORTOUT-2E
007900     LABEL RECORDS STANDARD
008000C    VALUE OF
008100C    XXXXX074
008200C    IS
008300C    XXXXX076
008400G    XXXXX069
008500     DATA RECORD IS SORTOUT-REC.
008600 01  SORTOUT-REC.
008700     02 SORTOUT-NON-KEY-1         PICTURE A(36) JUSTIFIED RIGHT.
008800     02 SORTOUT-KEY               PICTURE 9(8).
008900     02 SORTOUT-NON-KEY-2         PICTURE A(36) JUSTIFIED RIGHT.
009000 FD  USELESS-FILE
009100     LABEL RECORDS STANDARD
009200C    VALUE OF
009300C    XXXXX074
009400C    IS
009500C    XXXXX077
009600G    XXXXX069
009700     DATA RECORD IS USELESS-REC.
009800 01  USELESS-REC.
009900     02 FILLER                    PICTURE X(80).
010000 FD  DEADWEIGHT-FILE
010100     LABEL RECORDS STANDARD
010200C    VALUE OF
010300C    XXXXX074
010400C    IS
010500C    XXXXX078
010600G    XXXXX069
010700     DATA RECORD IS DEADWEIGHT-REC.
010800 01  DEADWEIGHT-REC               PICTURE X(80).
010900 SD  SORTFILE-2E
011000     DATA RECORD IS SORTFILE-REC.
011100 01  SORTFILE-REC.
011200     02 SORTFILE-NON-KEY-1        PICTURE A(36) JUSTIFIED RIGHT.
011300     02 SORTFILE-KEY              PICTURE 9(8).
011400     02 SORTFILE-NON-KEY-2        PICTURE A(36) JUSTIFIED RIGHT.
011500 WORKING-STORAGE SECTION.
011600 77  COMMENT-1 PICTURE X(27) VALUE "FIRST 20 OF 36-CHAR FIELD  ".
011700 77  COMMENT-2 PICTURE X(27) VALUE "LAST 16 OF 36-CHAR FIELD   ".
011800 77  UTIL-CTR           PICTURE S99999.
011900 01  LITERALS.
012000     02 SP-ACE          PICTURE X(14) VALUE "      (SPACES)".
012100     02 LITERAL-A       PICTURE X(16) VALUE "               A".
012200     02 LITERAL-B       PICTURE X(16) VALUE "               B".
012300 01  COMPUTED-BREAKDOWN.
012400     02 FIRST-20        PICTURE X(20).
012500     02 LAST-20         PICTURE X(20).
012600 01  TEST-RESULTS.
012700     02 FILLER                   PIC X      VALUE SPACE.
012800     02 FEATURE                  PIC X(20)  VALUE SPACE.
012900     02 FILLER                   PIC X      VALUE SPACE.
013000     02 P-OR-F                   PIC X(5)   VALUE SPACE.
013100     02 FILLER                   PIC X      VALUE SPACE.
013200     02  PAR-NAME.
013300       03 FILLER                 PIC X(19)  VALUE SPACE.
013400       03  PARDOT-X              PIC X      VALUE SPACE.
013500       03 DOTVALUE               PIC 99     VALUE ZERO.
013600     02 FILLER                   PIC X(8)   VALUE SPACE.
013700     02 RE-MARK                  PIC X(61).
013800 01  TEST-COMPUTED.
013900     02 FILLER                   PIC X(30)  VALUE SPACE.
014000     02 FILLER                   PIC X(17)  VALUE
014100            "       COMPUTED=".
014200     02 COMPUTED-X.
014300     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
014400     03 COMPUTED-N               REDEFINES COMPUTED-A
014500                                 PIC -9(9).9(9).
014600     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
014700     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
014800     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
014900     03       CM-18V0 REDEFINES COMPUTED-A.
015000         04 COMPUTED-18V0                    PIC -9(18).
015100         04 FILLER                           PIC X.
015200     03 FILLER PIC X(50) VALUE SPACE.
015300 01  TEST-CORRECT.
015400     02 FILLER PIC X(30) VALUE SPACE.
015500     02 FILLER PIC X(17) VALUE "       CORRECT =".
015600     02 CORRECT-X.
015700     03 CORRECT-A                  PIC X(20) VALUE SPACE.
015800     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
015900     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
016000     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
016100     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
016200     03      CR-18V0 REDEFINES CORRECT-A.
016300         04 CORRECT-18V0                     PIC -9(18).
016400         04 FILLER                           PIC X.
016500     03 FILLER PIC X(2) VALUE SPACE.
016600     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
016700 01  CCVS-C-1.
016800     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
016900-    "SS  PARAGRAPH-NAME
017000-    "       REMARKS".
017100     02 FILLER                     PIC X(20)    VALUE SPACE.
017200 01  CCVS-C-2.
017300     02 FILLER                     PIC X        VALUE SPACE.
017400     02 FILLER                     PIC X(6)     VALUE "TESTED".
017500     02 FILLER                     PIC X(15)    VALUE SPACE.
017600     02 FILLER                     PIC X(4)     VALUE "FAIL".
017700     02 FILLER                     PIC X(94)    VALUE SPACE.
017800 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
017900 01  REC-CT                        PIC 99       VALUE ZERO.
018000 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
018100 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
018200 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
018300 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
018400 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
018500 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
018600 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
018700 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
018800 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
018900 01  CCVS-H-1.
019000     02  FILLER                    PIC X(39)    VALUE SPACES.
019100     02  FILLER                    PIC X(42)    VALUE
019200     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
019300     02  FILLER                    PIC X(39)    VALUE SPACES.
019400 01  CCVS-H-2A.
019500   02  FILLER                        PIC X(40)  VALUE SPACE.
019600   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
019700   02  FILLER                        PIC XXXX   VALUE
019800     "4.2 ".
019900   02  FILLER                        PIC X(28)  VALUE
020000            " COPY - NOT FOR DISTRIBUTION".
020100   02  FILLER                        PIC X(41)  VALUE SPACE.
020200
020300 01  CCVS-H-2B.
020400   02  FILLER                        PIC X(15)  VALUE
020500            "TEST RESULT OF ".
020600   02  TEST-ID                       PIC X(9).
020700   02  FILLER                        PIC X(4)   VALUE
020800            " IN ".
020900   02  FILLER                        PIC X(12)  VALUE
021000     " HIGH       ".
021100   02  FILLER                        PIC X(22)  VALUE
021200            " LEVEL VALIDATION FOR ".
021300   02  FILLER                        PIC X(58)  VALUE
021400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
021500 01  CCVS-H-3.
021600     02  FILLER                      PIC X(34)  VALUE
021700            " FOR OFFICIAL USE ONLY    ".
021800     02  FILLER                      PIC X(58)  VALUE
021900     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022000     02  FILLER                      PIC X(28)  VALUE
022100            "  COPYRIGHT   1985 ".
022200 01  CCVS-E-1.
022300     02 FILLER                       PIC X(52)  VALUE SPACE.
022400     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
022500     02 ID-AGAIN                     PIC X(9).
022600     02 FILLER                       PIC X(45)  VALUE SPACES.
022700 01  CCVS-E-2.
022800     02  FILLER                      PIC X(31)  VALUE SPACE.
022900     02  FILLER                      PIC X(21)  VALUE SPACE.
023000     02 CCVS-E-2-2.
023100         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
023200         03 FILLER                   PIC X      VALUE SPACE.
023300         03 ENDER-DESC               PIC X(44)  VALUE
023400            "ERRORS ENCOUNTERED".
023500 01  CCVS-E-3.
023600     02  FILLER                      PIC X(22)  VALUE
023700            " FOR OFFICIAL USE ONLY".
023800     02  FILLER                      PIC X(12)  VALUE SPACE.
023900     02  FILLER                      PIC X(58)  VALUE
024000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024100     02  FILLER                      PIC X(13)  VALUE SPACE.
024200     02 FILLER                       PIC X(15)  VALUE
024300             " COPYRIGHT 1985".
024400 01  CCVS-E-4.
024500     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
024600     02 FILLER                       PIC X(4)   VALUE " OF ".
024700     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
024800     02 FILLER                       PIC X(40)  VALUE
024900      "  TESTS WERE EXECUTED SUCCESSFULLY".
025000 01  XXINFO.
025100     02 FILLER                       PIC X(19)  VALUE
025200            "*** INFORMATION ***".
025300     02 INFO-TEXT.
025400       04 FILLER                     PIC X(8)   VALUE SPACE.
025500       04 XXCOMPUTED                 PIC X(20).
025600       04 FILLER                     PIC X(5)   VALUE SPACE.
025700       04 XXCORRECT                  PIC X(20).
025800     02 INF-ANSI-REFERENCE           PIC X(48).
025900 01  HYPHEN-LINE.
026000     02 FILLER  PIC IS X VALUE IS SPACE.
026100     02 FILLER  PIC IS X(65)    VALUE IS "************************
026200-    "*****************************************".
026300     02 FILLER  PIC IS X(54)    VALUE IS "************************
026400-    "******************************".
026500 01  CCVS-PGM-ID                     PIC X(9)   VALUE
026600     "ST135A".
026700 PROCEDURE DIVISION.
026800 CCVS1 SECTION.
026900 OPEN-FILES.
027000     OPEN     OUTPUT PRINT-FILE.
027100     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
027200     MOVE    SPACE TO TEST-RESULTS.
027300     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
027400     GO TO CCVS1-EXIT.
027500 CLOSE-FILES.
027600     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
027700 TERMINATE-CCVS.
027800S    EXIT PROGRAM.
027900STERMINATE-CALL.
028000     STOP     RUN.
028100 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
028200 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
028300 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
028400 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
028500     MOVE "****TEST DELETED****" TO RE-MARK.
028600 PRINT-DETAIL.
028700     IF REC-CT NOT EQUAL TO ZERO
028800             MOVE "." TO PARDOT-X
028900             MOVE REC-CT TO DOTVALUE.
029000     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
029100     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
029200        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
029300          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
029400     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
029500     MOVE SPACE TO CORRECT-X.
029600     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
029700     MOVE     SPACE TO RE-MARK.
029800 HEAD-ROUTINE.
029900     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030000     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030100     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030200     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030300 COLUMN-NAMES-ROUTINE.
030400     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030500     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
030700 END-ROUTINE.
030800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
030900 END-RTN-EXIT.
031000     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031100 END-ROUTINE-1.
031200      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
031300      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
031400      ADD PASS-COUNTER TO ERROR-HOLD.
031500*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
031600      MOVE PASS-COUNTER TO CCVS-E-4-1.
031700      MOVE ERROR-HOLD TO CCVS-E-4-2.
031800      MOVE CCVS-E-4 TO CCVS-E-2-2.
031900      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
032000  END-ROUTINE-12.
032100      MOVE "TEST(S) FAILED" TO ENDER-DESC.
032200     IF       ERROR-COUNTER IS EQUAL TO ZERO
032300         MOVE "NO " TO ERROR-TOTAL
032400         ELSE
032500         MOVE ERROR-COUNTER TO ERROR-TOTAL.
032600     MOVE     CCVS-E-2 TO DUMMY-RECORD.
032700     PERFORM WRITE-LINE.
032800 END-ROUTINE-13.
032900     IF DELETE-COUNTER IS EQUAL TO ZERO
033000         MOVE "NO " TO ERROR-TOTAL  ELSE
033100         MOVE DELETE-COUNTER TO ERROR-TOTAL.
033200     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
033300     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033400      IF   INSPECT-COUNTER EQUAL TO ZERO
033500          MOVE "NO " TO ERROR-TOTAL
033600      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
033700      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
033800      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033900     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034000 WRITE-LINE.
034100     ADD 1 TO RECORD-COUNT.
034200Y    IF RECORD-COUNT GREATER 42
034300Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
034400Y        MOVE SPACE TO DUMMY-RECORD
034500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
034600Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
034700Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
034800Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
034900Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
035000Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
035100Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
035200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
035300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
035400Y        MOVE ZERO TO RECORD-COUNT.
035500     PERFORM WRT-LN.
035600 WRT-LN.
035700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
035800     MOVE SPACE TO DUMMY-RECORD.
035900 BLANK-LINE-PRINT.
036000     PERFORM WRT-LN.
036100 FAIL-ROUTINE.
036200     IF     COMPUTED-X NOT EQUAL TO SPACE
036300            GO TO   FAIL-ROUTINE-WRITE.
036400     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
036500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
036600     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
036700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036800     MOVE   SPACES TO INF-ANSI-REFERENCE.
036900     GO TO  FAIL-ROUTINE-EX.
037000 FAIL-ROUTINE-WRITE.
037100     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
037200     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
037300     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
037400     MOVE   SPACES TO COR-ANSI-REFERENCE.
037500 FAIL-ROUTINE-EX. EXIT.
037600 BAIL-OUT.
037700     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
037800     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
037900 BAIL-OUT-WRITE.
038000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
038100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
038200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038300     MOVE   SPACES TO INF-ANSI-REFERENCE.
038400 BAIL-OUT-EX. EXIT.
038500 CCVS1-EXIT.
038600     EXIT.
038700 BUILD-AND-SORT-AND-CHECK SECTION.
038800 BASAC.
038900     OPEN     OUTPUT SORTIN-2E.
039000     OPEN     OUTPUT USELESS-FILE.
039100     OPEN     OUTPUT DEADWEIGHT-FILE.
039200     MOVE     +10 TO UTIL-CTR.
039300 BUILD-LOOP.
039400     MOVE     UTIL-CTR TO SORTIN-KEY.
039500*        NOTE UTIL-CTR IS INTENTIONALLY MOVED TO AN UNSIGNED ITEM.
039600     MOVE     "A" TO SORTIN-NON-KEY-1.
039700     MOVE     "B" TO SORTIN-NON-KEY-2.
039800     WRITE    SORTIN-REC.
039900     MOVE     SPACE TO USELESS-REC.
040000     MOVE     SPACE TO DEADWEIGHT-REC.
040100     WRITE    USELESS-REC.
040200     WRITE    DEADWEIGHT-REC.
040300     SUBTRACT +1 FROM UTIL-CTR.
040400     IF       UTIL-CTR GREATER THAN -11 GO TO BUILD-LOOP.
040500     CLOSE    SORTIN-2E.
040600     CLOSE    USELESS-FILE.
040700     CLOSE    DEADWEIGHT-FILE.
040800 BUILD-TEST.
040900     IF       UTIL-CTR EQUAL TO -11
041000              PERFORM PASS GO TO BUILD-WRITE.
041100 BUILD-FAIL.
041200     PERFORM  FAIL.
041300     MOVE     UTIL-CTR TO COMPUTED-N.
041400     MOVE     -11 TO CORRECT-N.
041500 BUILD-WRITE.
041600     MOVE     "TAPE BEING BUILT" TO FEATURE.
041700     MOVE     "BUILD-TEST" TO PAR-NAME.
041800     PERFORM  PRINT-DETAIL.
041900 SORT-PARAGRAPH.
042000     SORT     SORTFILE-2E ON ASCENDING
042100              SORTFILE-KEY
042200              USING SORTIN-2E
042300              OUTPUT PROCEDURE OUTPROC.
042400 SORT-INIT.
042500     OPEN     INPUT SORTOUT-2E.
042600     OPEN     INPUT USELESS-FILE.
042700     OPEN     INPUT DEADWEIGHT-FILE.
042800     MOVE     +0 TO UTIL-CTR.
042900     MOVE     "SORT ---" TO FEATURE.
043000     PERFORM  PRINT-DETAIL.
043100     MOVE     "  SAME AREA" TO FEATURE.
043200 SORT-TEST-1.
043300     MOVE     "SORT-TEST-1" TO PAR-NAME.
043400     PERFORM  READ-SORTOUT.
043500     IF      SORTOUT-NON-KEY-1 NOT EQUAL TO "
043600-    "              A" GO TO SORT-FAIL-1.
043700     IF      SORTOUT-NON-KEY-2 NOT EQUAL TO "
043800-    "              B" GO TO SORT-FAIL-1.
043900     IF      SORTOUT-KEY EQUAL TO ZERO
044000              PERFORM PASS GO TO SORT-WRITE-1.
044100 SORT-FAIL-1.
044200     MOVE     ZERO TO CORRECT-N.
044300     PERFORM  BREAKDOWN-PARA.
044400 SORT-WRITE-1.
044500     PERFORM  PRINT-DETAIL.
044600 SORT-TEST-2.
044700     MOVE     "SORT-TEST-2" TO PAR-NAME.
044800     PERFORM  READ-SORTOUT.
044900     IF      SORTOUT-NON-KEY-1 NOT EQUAL TO "
045000-    "              A" GO TO SORT-FAIL-2.
045100     IF      SORTOUT-NON-KEY-2 NOT EQUAL TO "
045200-    "              B" GO TO SORT-FAIL-2.
045300     IF      SORTOUT-KEY EQUAL TO 1
045400              PERFORM PASS GO TO SORT-WRITE-2.
045500 SORT-FAIL-2.
045600     MOVE     1    TO CORRECT-N.
045700     PERFORM  BREAKDOWN-PARA.
045800 SORT-WRITE-2.
045900     PERFORM  PRINT-DETAIL.
046000 SORT-TEST-3.
046100     MOVE     "SORT-TEST-3" TO PAR-NAME.
046200     PERFORM  READ-SORTOUT.
046300     IF      SORTOUT-NON-KEY-1 NOT EQUAL TO "
046400-    "              A" GO TO SORT-FAIL-3.
046500     IF      SORTOUT-NON-KEY-2 NOT EQUAL TO "
046600-    "              B" GO TO SORT-FAIL-3.
046700     IF      SORTOUT-KEY EQUAL TO 1
046800              PERFORM PASS GO TO SORT-WRITE-3.
046900 SORT-FAIL-3.
047000     MOVE     1    TO CORRECT-N.
047100     PERFORM  BREAKDOWN-PARA.
047200 SORT-WRITE-3.
047300     PERFORM  PRINT-DETAIL.
047400 SORT-TEST-4.
047500     MOVE     "SORT-TEST-4" TO PAR-NAME.
047600     PERFORM  READ-SORTOUT 10 TIMES.
047700     IF      SORTOUT-NON-KEY-1 NOT EQUAL TO "
047800-    "              A" GO TO SORT-FAIL-4.
047900     IF      SORTOUT-NON-KEY-2 NOT EQUAL TO "
048000-    "              B" GO TO SORT-FAIL-4.
048100     IF      SORTOUT-KEY EQUAL TO 6
048200              PERFORM PASS GO TO SORT-WRITE-4.
048300 SORT-FAIL-4.
048400     MOVE     6    TO CORRECT-N.
048500     PERFORM  BREAKDOWN-PARA.
048600 SORT-WRITE-4.
048700     PERFORM  PRINT-DETAIL.
048800 SORT-TEST-5.
048900     MOVE     "SORT-TEST-5" TO PAR-NAME.
049000     PERFORM  READ-SORTOUT.
049100     IF      SORTOUT-NON-KEY-1 NOT EQUAL TO "
049200-    "              A" GO TO SORT-FAIL-5.
049300     IF      SORTOUT-NON-KEY-2 NOT EQUAL TO "
049400-    "              B" GO TO SORT-FAIL-5.
049500     IF      SORTOUT-KEY EQUAL TO 7
049600              PERFORM PASS GO TO SORT-WRITE-5.
049700 SORT-FAIL-5.
049800     MOVE     7    TO CORRECT-N.
049900     PERFORM  BREAKDOWN-PARA.
050000 SORT-WRITE-5.
050100     PERFORM  PRINT-DETAIL.
050200 SORT-TEST-6.
050300     MOVE     "SORT-TEST-6" TO PAR-NAME.
050400     PERFORM  READ-SORTOUT 6 TIMES
050500     IF      SORTOUT-NON-KEY-1 NOT EQUAL TO "
050600-    "              A" GO TO SORT-FAIL-6.
050700     IF      SORTOUT-NON-KEY-2 NOT EQUAL TO "
050800-    "              B" GO TO SORT-FAIL-6.
050900     IF      SORTOUT-KEY EQUAL TO 10
051000              PERFORM PASS GO TO SORT-WRITE-6.
051100 SORT-FAIL-6.
051200     MOVE     10   TO CORRECT-N.
051300     PERFORM  BREAKDOWN-PARA.
051400 SORT-WRITE-6.
051500     PERFORM  PRINT-DETAIL.
051600 SORT-TEST-7.
051700     MOVE     "SORT-TEST-7" TO PAR-NAME.
051800     PERFORM  READ-SORTOUT.
051900     IF      SORTOUT-NON-KEY-1 NOT EQUAL TO "
052000-    "              A" GO TO SORT-FAIL-7.
052100     IF      SORTOUT-NON-KEY-2 NOT EQUAL TO "
052200-    "              B" GO TO SORT-FAIL-7.
052300     IF      SORTOUT-KEY EQUAL TO 10
052400              PERFORM PASS GO TO SORT-WRITE-7.
052500 SORT-FAIL-7.
052600     MOVE     10   TO CORRECT-N.
052700     PERFORM  BREAKDOWN-PARA.
052800 SORT-WRITE-7.
052900     PERFORM  PRINT-DETAIL.
053000 SORT-TEST-8.
053100     MOVE     "SORT-TEST-8" TO PAR-NAME.
053200     READ     SORTOUT-2E AT END
053300              PERFORM PASS GO TO SORT-WRITE-8.
053400 SORT-FAIL-8.
053500     MOVE     SPACE TO LITERALS.
053600     MOVE     UTIL-CTR TO COMPUTED-N.
053700     MOVE     21 TO CORRECT-N.
053800     MOVE     "END OF FILE NOT FOUND" TO RE-MARK.
053900     PERFORM  PRINT-DETAIL.
054000     PERFORM  BREAKDOWN-PARA.
054100 SORT-WRITE-8.
054200     PERFORM  PRINT-DETAIL.
054300 CLOSE-SORT-FILES.
054400     CLOSE    USELESS-FILE.
054500     CLOSE    DEADWEIGHT-FILE.
054600     CLOSE    SORTOUT-2E.
054700     GO TO CCVS-EXIT.
054800 BREAKDOWN-PARA.
054900     MOVE     SORTOUT-KEY TO COMPUTED-N.
055000     PERFORM  FAIL.
055100     MOVE     "KEY AREA" TO RE-MARK.
055200     PERFORM  PRINT-DETAIL.
055300     MOVE     SORTOUT-NON-KEY-1 TO COMPUTED-BREAKDOWN.
055400     MOVE     FIRST-20 TO COMPUTED-A.
055500     MOVE     SP-ACE TO CORRECT-A.
055600     MOVE     COMMENT-1 TO RE-MARK.
055700     PERFORM  PRINT-DETAIL.
055800     MOVE     LAST-20 TO COMPUTED-A.
055900     MOVE     LITERAL-A TO CORRECT-A.
056000     MOVE     COMMENT-2 TO RE-MARK.
056100     PERFORM  PRINT-DETAIL.
056200     MOVE     SORTOUT-NON-KEY-2 TO COMPUTED-BREAKDOWN.
056300     MOVE     FIRST-20 TO COMPUTED-A.
056400     MOVE     SP-ACE TO CORRECT-A.
056500     MOVE     COMMENT-1 TO RE-MARK.
056600     PERFORM  PRINT-DETAIL.
056700     MOVE     LAST-20 TO COMPUTED-A.
056800     MOVE     SP-ACE TO CORRECT-A.
056900     MOVE     COMMENT-2 TO RE-MARK.
057000 READ-SORTOUT.
057100     READ     SORTOUT-2E AT END GO TO READ-ERROR.
057200     ADD      1 TO UTIL-CTR.
057300 READ-ERROR.
057400     PERFORM  FAIL.
057500     MOVE     "READ-ERROR" TO PAR-NAME.
057600     MOVE     UTIL-CTR TO COMPUTED-N.
057700     MOVE     21 TO CORRECT-N.
057800     MOVE     "EOF PREMATURELY FOUND" TO RE-MARK.
057900     PERFORM  PRINT-DETAIL.
058000     GO TO    CLOSE-SORT-FILES.
058100 OUTPROC SECTION.
058200 OUTPROC-OPEN.
058300     OPEN     OUTPUT SORTOUT-2E.
058400 OUTPROC-RETURN.
058500     RETURN   SORTFILE-2E AT END GO TO OUTPROC-CLOSE.
058600     MOVE     SORTFILE-REC TO SORTOUT-REC.
058700     WRITE    SORTOUT-REC.
058800     GO       TO OUTPROC-RETURN.
058900 OUTPROC-CLOSE.
059000     CLOSE    SORTOUT-2E.
059100 CCVS-EXIT SECTION.
059200 CCVS-999999.
059300     GO TO CLOSE-FILES.
