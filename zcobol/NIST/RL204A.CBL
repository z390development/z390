000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RL204A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*            THIS PROGRAM TESTS THE SYNTACTICAL CONSTRUCTS AND
001400*            SEMANTIC ACTIONS ASSOCIATED WITH THE FOLLOWING
001500*            ELEMENTS:
001600*
001700*            (1)  FILE STATUS
001800*            (2)  USE AFTER EXCEPTION PROCEDURE ON FILE-NAME
001900*            (3)  READ
002000*            (4)  WRITE
002100*            (5)  REWRITE
002200*            (6)  RELATIVE KEY
002300*            (7)  ACCESS MODE
002400*
002500*            THIS PROGRAM CREATES A RELATIVE I-O FILE SEQUENTIALLY
002600*            (ACCESS MODE DYNAMIC)    AND THEN UPDATES SELECTIVE
002700*            RECORDS OF THE FILE.  THE FILE STATUS CONTENTS ARE
002800*            CAPTURED AND TESTED FOR ACCURACY FOR EACH OPEN, CLOSE
002900*            READ AND REWRITE STATEMENT USED.  THE READ, WRITE AND
003000*            REWRITE STATEMENTS ARE USED WITHOUT THE APPROPRIATE
003100*            AT END ON INVALID KEY PHRASES.  THE OMISSION OF THESE
003200*            PHRASES ARE PERMITTED IF AN APPLICABLE USE PROCEDURE
003300*            HAS BEEN SPECIFIED.
003400*
003500*            X-CARD PARAMETERS WHICH MUST BE SUPPLIED FOR THIS
003600*            PROGRAM ARE:
003700*
003800*                 X-21   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
003900*                         RELATIVE  I-O DATA FILE
004000*                 X-55   SYSTEM PRINTER
004100*                 X-69   ADDITIONAL VALUE OF CLAUSES
004200*                 X-74   VALUE OF IMPLEMENTOR-NAME
004300*                 X-75   OBJECT OF VALUE OF CLAUSE
004400*                 X-82   SOURCE-COMPUTER
004500*                 X-83   OBJECT-COMPUTER.
004600*
004700***************************************************
004800 ENVIRONMENT DIVISION.
004900 CONFIGURATION SECTION.
005000 SOURCE-COMPUTER.
005100     XXXXX082.
005200 OBJECT-COMPUTER.
005300     XXXXX083.
005400 INPUT-OUTPUT SECTION.
005500 FILE-CONTROL.
005600     SELECT PRINT-FILE ASSIGN TO
005700     XXXXX055.
005800     SELECT   RL-FD2 ASSIGN
005900     XXXXX022
006000              ORGANIZATION RELATIVE
006100              ACCESS  DYNAMIC
006200              RELATIVE  RL-FD2-KEY
006300         FILE STATUS IS RL-FD2-STATUS.
006400 DATA DIVISION.
006500 FILE SECTION.
006600 FD  PRINT-FILE.
006700 01  PRINT-REC PICTURE X(120).
006800 01  DUMMY-RECORD PICTURE X(120).
006900 FD  RL-FD2
007000C    VALUE OF
007100C    XXXXX074
007200C    IS
007300C    XXXXX076
007400G    XXXXX069
007500     LABEL RECORDS ARE STANDARD
007600     BLOCK CONTAINS 1 RECORDS
007700     DATA RECORD RL-FD2R1-F-G-240.
007800 01  RL-FD2R1-F-G-240.
007900     05 RL-FD2-WRK-120 PIC X(120).
008000     05 RL-FD2-GRP-120.
008100        10 RL-FD2-WRK-XN-0001-O120F
008200                        PICTURE X OCCURS 120 TIMES.
008300 WORKING-STORAGE SECTION.
008400 01  GRP-0001.
008500     05 RL-FD2-KEY   PIC 9(8)  VALUE ZERO.
008600     05 WRK-CS-09V00-012  PIC S9(9) USAGE COMP  VALUE ZERO.
008700     05 WRK-CS-09V00-013  PIC S9(9) USAGE COMP  VALUE ZERO.
008800     05 WRK-CS-09V00-014  PIC S9(9) USAGE COMP  VALUE ZERO.
008900     05 WRK-CS-09V00-015  PIC S9(9) USAGE COMP  VALUE ZERO.
009000     05 WRK-CS-09V00-016  PIC S9(9) USAGE COMP  VALUE ZERO.
009100     05 WRK-CS-09V00-017  PIC S9(9) USAGE COMP  VALUE ZERO.
009200     05 WRK-CS-09V00-018  PIC S9(9) USAGE COMP  VALUE ZERO.
009300     05 RL-FD2-STATUS     PIC  XX  VALUE  SPACE.
009400     05 WRK-XN-0002-001   PIC  X(2) VALUE  SPACE.
009500     05 WRK-XN-0002-002   PIC  X(2) VALUE  SPACE.
009600     05 WRK-XN-0002-003   PIC  X(2) VALUE  SPACE.
009700     05 WRK-XN-0002-004   PIC  X(2) VALUE  SPACE.
009800     05 WRK-XN-0002-005   PIC  X(2) VALUE  SPACE.
009900     05 WRK-XN-0002-006   PIC  X(2) VALUE  SPACE.
010000     05 WRK-XN-0002-007   PIC  X(2) VALUE  SPACE.
010100     05 WRK-XN-0002-008   PIC  X(2) VALUE  SPACE.
010200     05 WRK-XN-0002-009   PIC  X(2) VALUE  SPACE.
010300 01  FILE-RECORD-INFORMATION-REC.
010400     03 FILE-RECORD-INFO-SKELETON.
010500        05 FILLER                 PICTURE X(48)       VALUE
010600             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
010700        05 FILLER                 PICTURE X(46)       VALUE
010800             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
010900        05 FILLER                 PICTURE X(26)       VALUE
011000             ",LFIL=000000,ORG=  ,LBLR= ".
011100        05 FILLER                 PICTURE X(37)       VALUE
011200             ",RECKEY=                             ".
011300        05 FILLER                 PICTURE X(38)       VALUE
011400             ",ALTKEY1=                             ".
011500        05 FILLER                 PICTURE X(38)       VALUE
011600             ",ALTKEY2=                             ".
011700        05 FILLER                 PICTURE X(7)        VALUE SPACE.
011800     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
011900        05 FILE-RECORD-INFO-P1-120.
012000           07 FILLER              PIC X(5).
012100           07 XFILE-NAME           PIC X(6).
012200           07 FILLER              PIC X(8).
012300           07 XRECORD-NAME         PIC X(6).
012400           07 FILLER              PIC X(1).
012500           07 REELUNIT-NUMBER     PIC 9(1).
012600           07 FILLER              PIC X(7).
012700           07 XRECORD-NUMBER       PIC 9(6).
012800           07 FILLER              PIC X(6).
012900           07 UPDATE-NUMBER       PIC 9(2).
013000           07 FILLER              PIC X(5).
013100           07 ODO-NUMBER          PIC 9(4).
013200           07 FILLER              PIC X(5).
013300           07 XPROGRAM-NAME        PIC X(5).
013400           07 FILLER              PIC X(7).
013500           07 XRECORD-LENGTH       PIC 9(6).
013600           07 FILLER              PIC X(7).
013700           07 CHARS-OR-RECORDS    PIC X(2).
013800           07 FILLER              PIC X(1).
013900           07 XBLOCK-SIZE          PIC 9(4).
014000           07 FILLER              PIC X(6).
014100           07 RECORDS-IN-FILE     PIC 9(6).
014200           07 FILLER              PIC X(5).
014300           07 XFILE-ORGANIZATION   PIC X(2).
014400           07 FILLER              PIC X(6).
014500           07 XLABEL-TYPE          PIC X(1).
014600        05 FILE-RECORD-INFO-P121-240.
014700           07 FILLER              PIC X(8).
014800           07 XRECORD-KEY          PIC X(29).
014900           07 FILLER              PIC X(9).
015000           07 ALTERNATE-KEY1      PIC X(29).
015100           07 FILLER              PIC X(9).
015200           07 ALTERNATE-KEY2      PIC X(29).
015300           07 FILLER              PIC X(7).
015400 01  TEST-RESULTS.
015500     02 FILLER                   PIC X      VALUE SPACE.
015600     02 FEATURE                  PIC X(20)  VALUE SPACE.
015700     02 FILLER                   PIC X      VALUE SPACE.
015800     02 P-OR-F                   PIC X(5)   VALUE SPACE.
015900     02 FILLER                   PIC X      VALUE SPACE.
016000     02  PAR-NAME.
016100       03 FILLER                 PIC X(19)  VALUE SPACE.
016200       03  PARDOT-X              PIC X      VALUE SPACE.
016300       03 DOTVALUE               PIC 99     VALUE ZERO.
016400     02 FILLER                   PIC X(8)   VALUE SPACE.
016500     02 RE-MARK                  PIC X(61).
016600 01  TEST-COMPUTED.
016700     02 FILLER                   PIC X(30)  VALUE SPACE.
016800     02 FILLER                   PIC X(17)  VALUE
016900            "       COMPUTED=".
017000     02 COMPUTED-X.
017100     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
017200     03 COMPUTED-N               REDEFINES COMPUTED-A
017300                                 PIC -9(9).9(9).
017400     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
017500     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
017600     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
017700     03       CM-18V0 REDEFINES COMPUTED-A.
017800         04 COMPUTED-18V0                    PIC -9(18).
017900         04 FILLER                           PIC X.
018000     03 FILLER PIC X(50) VALUE SPACE.
018100 01  TEST-CORRECT.
018200     02 FILLER PIC X(30) VALUE SPACE.
018300     02 FILLER PIC X(17) VALUE "       CORRECT =".
018400     02 CORRECT-X.
018500     03 CORRECT-A                  PIC X(20) VALUE SPACE.
018600     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
018700     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
018800     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
018900     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
019000     03      CR-18V0 REDEFINES CORRECT-A.
019100         04 CORRECT-18V0                     PIC -9(18).
019200         04 FILLER                           PIC X.
019300     03 FILLER PIC X(2) VALUE SPACE.
019400     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
019500 01  CCVS-C-1.
019600     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
019700-    "SS  PARAGRAPH-NAME
019800-    "       REMARKS".
019900     02 FILLER                     PIC X(20)    VALUE SPACE.
020000 01  CCVS-C-2.
020100     02 FILLER                     PIC X        VALUE SPACE.
020200     02 FILLER                     PIC X(6)     VALUE "TESTED".
020300     02 FILLER                     PIC X(15)    VALUE SPACE.
020400     02 FILLER                     PIC X(4)     VALUE "FAIL".
020500     02 FILLER                     PIC X(94)    VALUE SPACE.
020600 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
020700 01  REC-CT                        PIC 99       VALUE ZERO.
020800 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
020900 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
021000 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
021100 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
021200 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
021300 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
021400 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
021500 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
021600 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
021700 01  CCVS-H-1.
021800     02  FILLER                    PIC X(39)    VALUE SPACES.
021900     02  FILLER                    PIC X(42)    VALUE
022000     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
022100     02  FILLER                    PIC X(39)    VALUE SPACES.
022200 01  CCVS-H-2A.
022300   02  FILLER                        PIC X(40)  VALUE SPACE.
022400   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
022500   02  FILLER                        PIC XXXX   VALUE
022600     "4.2 ".
022700   02  FILLER                        PIC X(28)  VALUE
022800            " COPY - NOT FOR DISTRIBUTION".
022900   02  FILLER                        PIC X(41)  VALUE SPACE.
023000
023100 01  CCVS-H-2B.
023200   02  FILLER                        PIC X(15)  VALUE
023300            "TEST RESULT OF ".
023400   02  TEST-ID                       PIC X(9).
023500   02  FILLER                        PIC X(4)   VALUE
023600            " IN ".
023700   02  FILLER                        PIC X(12)  VALUE
023800     " HIGH       ".
023900   02  FILLER                        PIC X(22)  VALUE
024000            " LEVEL VALIDATION FOR ".
024100   02  FILLER                        PIC X(58)  VALUE
024200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024300 01  CCVS-H-3.
024400     02  FILLER                      PIC X(34)  VALUE
024500            " FOR OFFICIAL USE ONLY    ".
024600     02  FILLER                      PIC X(58)  VALUE
024700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
024800     02  FILLER                      PIC X(28)  VALUE
024900            "  COPYRIGHT   1985 ".
025000 01  CCVS-E-1.
025100     02 FILLER                       PIC X(52)  VALUE SPACE.
025200     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
025300     02 ID-AGAIN                     PIC X(9).
025400     02 FILLER                       PIC X(45)  VALUE SPACES.
025500 01  CCVS-E-2.
025600     02  FILLER                      PIC X(31)  VALUE SPACE.
025700     02  FILLER                      PIC X(21)  VALUE SPACE.
025800     02 CCVS-E-2-2.
025900         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
026000         03 FILLER                   PIC X      VALUE SPACE.
026100         03 ENDER-DESC               PIC X(44)  VALUE
026200            "ERRORS ENCOUNTERED".
026300 01  CCVS-E-3.
026400     02  FILLER                      PIC X(22)  VALUE
026500            " FOR OFFICIAL USE ONLY".
026600     02  FILLER                      PIC X(12)  VALUE SPACE.
026700     02  FILLER                      PIC X(58)  VALUE
026800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
026900     02  FILLER                      PIC X(13)  VALUE SPACE.
027000     02 FILLER                       PIC X(15)  VALUE
027100             " COPYRIGHT 1985".
027200 01  CCVS-E-4.
027300     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
027400     02 FILLER                       PIC X(4)   VALUE " OF ".
027500     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
027600     02 FILLER                       PIC X(40)  VALUE
027700      "  TESTS WERE EXECUTED SUCCESSFULLY".
027800 01  XXINFO.
027900     02 FILLER                       PIC X(19)  VALUE
028000            "*** INFORMATION ***".
028100     02 INFO-TEXT.
028200       04 FILLER                     PIC X(8)   VALUE SPACE.
028300       04 XXCOMPUTED                 PIC X(20).
028400       04 FILLER                     PIC X(5)   VALUE SPACE.
028500       04 XXCORRECT                  PIC X(20).
028600     02 INF-ANSI-REFERENCE           PIC X(48).
028700 01  HYPHEN-LINE.
028800     02 FILLER  PIC IS X VALUE IS SPACE.
028900     02 FILLER  PIC IS X(65)    VALUE IS "************************
029000-    "*****************************************".
029100     02 FILLER  PIC IS X(54)    VALUE IS "************************
029200-    "******************************".
029300 01  CCVS-PGM-ID                     PIC X(9)   VALUE
029400     "RL204A".
029500 PROCEDURE DIVISION.
029600 DECLARATIVES.
029700 RL-FD2-01 SECTION.
029800     USE      AFTER STANDARD EXCEPTION PROCEDURE ON RL-FD2.
029900 RL-FD2-01-01.
030000     ADD      1 TO  WRK-CS-09V00-013.
030100     GO TO    RL-FD2-01-03
030200              RL-FD2-01-05
030300              DEPENDING ON  WRK-CS-09V00-012.
030400     GO TO    RL-FD2-01-EXIT.
030500 RL-FD2-01-03.
030600*ENTRY FROM SEGMENT REL-TEST-009.
030700*    SHOULD NOT ENTER HERE UNLESS SPACE ALLOCATION TOO SMALL.
030800     ADD     1   TO WRK-CS-09V00-014.
030900 RL-FD2-01-05.
031000     ADD      1 TO WRK-CS-09V00-017.
031100     IF       XRECORD-NUMBER (2) EQUAL TO 500
031200              MOVE   RL-FD2-STATUS TO WRK-XN-0002-002
031300              MOVE  "10" TO WRK-XN-0002-003.
031400 RL-FD2-01-EXIT.
031500     EXIT.
031600 END DECLARATIVES.
031700 CCVS1 SECTION.
031800 OPEN-FILES.
031900     OPEN    OUTPUT PRINT-FILE.
032000     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
032100     MOVE    SPACE TO TEST-RESULTS.
032200     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
032300     MOVE    ZERO TO REC-SKL-SUB.
032400     PERFORM CCVS-INIT-FILE 9 TIMES.
032500 CCVS-INIT-FILE.
032600     ADD     1 TO REC-SKL-SUB.
032700     MOVE    FILE-RECORD-INFO-SKELETON
032800          TO FILE-RECORD-INFO (REC-SKL-SUB).
032900 CCVS-INIT-EXIT.
033000     GO TO CCVS1-EXIT.
033100 CLOSE-FILES.
033200     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
033300 TERMINATE-CCVS.
033400S    EXIT PROGRAM.
033500STERMINATE-CALL.
033600     STOP     RUN.
033700 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
033800 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
033900 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
034000 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
034100     MOVE "****TEST DELETED****" TO RE-MARK.
034200 PRINT-DETAIL.
034300     IF REC-CT NOT EQUAL TO ZERO
034400             MOVE "." TO PARDOT-X
034500             MOVE REC-CT TO DOTVALUE.
034600     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
034700     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
034800        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
034900          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
035000     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
035100     MOVE SPACE TO CORRECT-X.
035200     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
035300     MOVE     SPACE TO RE-MARK.
035400 HEAD-ROUTINE.
035500     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035600     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035700     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
035800     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
035900 COLUMN-NAMES-ROUTINE.
036000     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036100     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
036300 END-ROUTINE.
036400     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
036500 END-RTN-EXIT.
036600     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036700 END-ROUTINE-1.
036800      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
036900      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
037000      ADD PASS-COUNTER TO ERROR-HOLD.
037100*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
037200      MOVE PASS-COUNTER TO CCVS-E-4-1.
037300      MOVE ERROR-HOLD TO CCVS-E-4-2.
037400      MOVE CCVS-E-4 TO CCVS-E-2-2.
037500      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
037600  END-ROUTINE-12.
037700      MOVE "TEST(S) FAILED" TO ENDER-DESC.
037800     IF       ERROR-COUNTER IS EQUAL TO ZERO
037900         MOVE "NO " TO ERROR-TOTAL
038000         ELSE
038100         MOVE ERROR-COUNTER TO ERROR-TOTAL.
038200     MOVE     CCVS-E-2 TO DUMMY-RECORD.
038300     PERFORM WRITE-LINE.
038400 END-ROUTINE-13.
038500     IF DELETE-COUNTER IS EQUAL TO ZERO
038600         MOVE "NO " TO ERROR-TOTAL  ELSE
038700         MOVE DELETE-COUNTER TO ERROR-TOTAL.
038800     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
038900     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
039000      IF   INSPECT-COUNTER EQUAL TO ZERO
039100          MOVE "NO " TO ERROR-TOTAL
039200      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
039300      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
039400      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
039500     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
039600 WRITE-LINE.
039700     ADD 1 TO RECORD-COUNT.
039800Y    IF RECORD-COUNT GREATER 50
039900Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
040000Y        MOVE SPACE TO DUMMY-RECORD
040100Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
040200Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
040300Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
040400Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
040500Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
040600Y        MOVE ZERO TO RECORD-COUNT.
040700     PERFORM WRT-LN.
040800 WRT-LN.
040900     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
041000     MOVE SPACE TO DUMMY-RECORD.
041100 BLANK-LINE-PRINT.
041200     PERFORM WRT-LN.
041300 FAIL-ROUTINE.
041400     IF     COMPUTED-X NOT EQUAL TO SPACE
041500            GO TO   FAIL-ROUTINE-WRITE.
041600     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
041700     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
041800     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
041900     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042000     MOVE   SPACES TO INF-ANSI-REFERENCE.
042100     GO TO  FAIL-ROUTINE-EX.
042200 FAIL-ROUTINE-WRITE.
042300     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
042400     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
042500     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
042600     MOVE   SPACES TO COR-ANSI-REFERENCE.
042700 FAIL-ROUTINE-EX. EXIT.
042800 BAIL-OUT.
042900     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
043000     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
043100 BAIL-OUT-WRITE.
043200     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
043300     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
043400     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
043500     MOVE   SPACES TO INF-ANSI-REFERENCE.
043600 BAIL-OUT-EX. EXIT.
043700 CCVS1-EXIT.
043800     EXIT.
043900 SECT-RL204-001 SECTION.
044000 REL-INIT-009.
044100     MOVE    "REL-TEST-009" TO PAR-NAME.
044200     MOVE     "CREATE RL-FD2" TO  FEATURE
044300     MOVE     "RL-FD2"        TO  XFILE-NAME (2).
044400     MOVE     "R1-F-G"        TO  XRECORD-NAME (2).
044500     MOVE CCVS-PGM-ID             TO  XPROGRAM-NAME (2).
044600     MOVE     000240          TO  XRECORD-LENGTH (2).
044700     MOVE     "RC"            TO  CHARS-OR-RECORDS (2).
044800     MOVE     0001            TO  XBLOCK-SIZE       (2).
044900     MOVE     000500          TO  RECORDS-IN-FILE  (2).
045000     MOVE     "RL"            TO  XFILE-ORGANIZATION (2).
045100     MOVE     "S"             TO  XLABEL-TYPE        (2).
045200     MOVE     000001          TO  XRECORD-NUMBER     (2).
045300*INITIALIZE  RECORD WORK AREA NUMBER 2.
045400     MOVE     1         TO  WRK-CS-09V00-012.
045500     MOVE     ZERO      TO  WRK-CS-09V00-013 WRK-CS-09V00-014
045600                            WRK-CS-09V00-015 WRK-CS-09V00-016
045700                            WRK-CS-09V00-017 WRK-CS-09V00-018.
045800     MOVE     SPACE     TO  RL-FD2-STATUS.
045900     MOVE     90000002  TO  RL-FD2-KEY.
046000     MOVE     01 TO REC-CT.
046100     OPEN     OUTPUT    RL-FD2.
046200     MOVE     RL-FD2-STATUS TO WRK-XN-0002-001.
046300*CAPTURE STATUS KEY AFTER  OPEN STATEMENT IS EXECUTED.
046400 REL-TEST-009-R.
046500     MOVE XRECORD-NUMBER (2) TO RL-FD2-KEY.
046600     MOVE    "99"  TO RL-FD2-STATUS.
046700     MOVE     FILE-RECORD-INFO-P1-120 (2) TO RL-FD2-WRK-120.
046800     MOVE     FILE-RECORD-INFO-P1-120 (2) TO
046900               RL-FD2-GRP-120.
047000     WRITE    RL-FD2R1-F-G-240.
047100     IF        RL-FD2-STATUS NOT EQUAL TO "00"
047200              GO TO  REL-TEST-009-2.
047300     IF       XRECORD-NUMBER (2) EQUAL TO 500
047400             GO TO REL-TEST-009-2.
047500     ADD      01 TO  XRECORD-NUMBER (2).
047600     GO TO    REL-TEST-009-R.
047700 REL-TEST-009-2.
047800     IF       WRK-CS-09V00-014 NOT EQUAL TO ZERO
047900              MOVE "EXCEPTIONS/ERRORS" TO RE-MARK
048000              MOVE ZERO TO CORRECT-18V0
048100              MOVE WRK-CS-09V00-014 TO COMPUTED-18V0
048200              PERFORM   FAIL
048300              ELSE
048400              PERFORM   PASS.
048500     PERFORM  PRINT-DETAIL.
048600     ADD      01 TO REC-CT.
048700*    .01
048800     IF       XRECORD-NUMBER (2) NOT EQUAL TO 500
048900              MOVE "INCORRECT COUNT" TO RE-MARK
049000              MOVE  500 TO CORRECT-18V0
049100             MOVE    XRECORD-NUMBER (2)  TO COMPUTED-18V0
049200              PERFORM  FAIL
049300              ELSE
049400              PERFORM PASS.
049500     PERFORM  PRINT-DETAIL.
049600     ADD      01 TO REC-CT.
049700*    .02
049800     IF       WRK-XN-0002-001 NOT EQUAL TO  "00"
049900              MOVE "STATUS/OPEN" TO RE-MARK
050000              MOVE WRK-XN-0002-001 TO COMPUTED-A
050100              MOVE "00" TO CORRECT-A
050200              PERFORM  FAIL
050300              ELSE
050400              PERFORM  PASS.
050500     PERFORM  PRINT-DETAIL.
050600     ADD      01 TO REC-CT.
050700*    .03
050800     IF        RL-FD2-STATUS NOT EQUAL TO "00"
050900              MOVE "STATUS/WRITE" TO RE-MARK
051000              MOVE RL-FD2-STATUS TO COMPUTED-A
051100              MOVE "00" TO CORRECT-A
051200              PERFORM   FAIL
051300              ELSE
051400              PERFORM   PASS.
051500     PERFORM  PRINT-DETAIL.
051600     ADD      01 TO REC-CT.
051700*    .04
051800     MOVE     SPACE  TO  RL-FD2-STATUS.
051900     CLOSE    RL-FD2.
052000     IF        RL-FD2-STATUS NOT EQUAL TO "00"
052100              MOVE "CLOSE/STATUS" TO RE-MARK
052200              MOVE   RL-FD2-STATUS TO COMPUTED-A
052300              MOVE "00" TO CORRECT-A
052400              PERFORM FAIL
052500              ELSE
052600              PERFORM PASS.
052700     PERFORM  PRINT-DETAIL.
052800     ADD      01 TO REC-CT.
052900*    .05
053000 REL-INIT-010.
053100     MOVE    "REL-TEST-010" TO PAR-NAME.
053200     MOVE     2     TO  WRK-CS-09V00-012.
053300     MOVE     ZERO  TO  WRK-CS-09V00-013.
053400     MOVE     ZERO  TO  WRK-CS-09V00-014.
053500     MOVE     ZERO  TO  WRK-CS-09V00-015.
053600     MOVE     ZERO  TO  WRK-CS-09V00-016.
053700     MOVE     ZERO  TO  WRK-CS-09V00-017.
053800     MOVE     ZERO  TO  WRK-CS-09V00-018.
053900     MOVE     01 TO REC-CT.
054000     OPEN     I-O  RL-FD2.
054100     MOVE     SPACE     TO  WRK-XN-0002-002
054200     MOVE     SPACE     TO  WRK-XN-0002-003
054300     MOVE     SPACE     TO  WRK-XN-0002-004
054400     MOVE      RL-FD2-STATUS TO WRK-XN-0002-001
054500     MOVE     SPACE TO RL-FD2-STATUS.
054600*CAPTURE THE CONTENTS OF STATUS KEY AFTER OPEN IS EXECUTED.
054700     MOVE    "USE/FILE STATUS"  TO FEATURE.
054800 REL-TEST-010-R.
054900     ADD      1 TO WRK-CS-09V00-014.
055000     ADD      1 TO WRK-CS-09V00-015.
055100     READ     RL-FD2 NEXT RECORD.
055200     IF        RL-FD2-STATUS EQUAL TO "10"
055300              GO TO  REL-TEST-010-3.
055400     MOVE     RL-FD2-WRK-120 TO FILE-RECORD-INFO-P1-120 (2).
055500     IF       WRK-CS-09V00-015 EQUAL TO 5
055600              ADD 01 TO UPDATE-NUMBER (2)
055700              MOVE FILE-RECORD-INFO-P1-120 (2) TO RL-FD2-WRK-120
055800              REWRITE RL-FD2R1-F-G-240
055900           MOVE ZERO TO WRK-CS-09V00-015
056000              GO TO  REL-TEST-010-2.
056100     IF       WRK-CS-09V00-014 GREATER 500
056200              GO TO  REL-TEST-010-3.
056300     GO TO    REL-TEST-010-R.
056400 REL-TEST-010-2.
056500     IF        RL-FD2-STATUS NOT EQUAL TO "00"
056600              ADD 1 TO WRK-CS-09V00-016.
056700     MOVE    SPACE TO RL-FD2-STATUS.
056800     GO TO    REL-TEST-010-R.
056900 REL-TEST-010-3.
057000     IF       WRK-CS-09V00-013 NOT EQUAL TO 1
057100              MOVE  "EXCEPTIONS/ERRORS" TO RE-MARK
057200              MOVE WRK-CS-09V00-013 TO COMPUTED-18V0
057300              MOVE  1 TO CORRECT-18V0
057400              PERFORM FAIL
057500              ELSE
057600              PERFORM PASS.
057700     PERFORM  PRINT-DETAIL.
057800     ADD      01 TO REC-CT.
057900*    .01
058000     IF       WRK-CS-09V00-014 NOT EQUAL TO 501
058100              MOVE "INCORRECT COUNT" TO RE-MARK
058200              MOVE WRK-CS-09V00-014 TO COMPUTED-18V0
058300              MOVE 501 TO CORRECT-18V0
058400              PERFORM FAIL
058500              ELSE
058600             PERFORM PASS.
058700     PERFORM  PRINT-DETAIL.
058800     ADD      01 TO REC-CT.
058900*    .02
059000     IF       WRK-XN-0002-001 NOT EQUAL TO "00"
059100              MOVE "OPEN/STATUS"  TO  RE-MARK
059200              MOVE WRK-XN-0002-001 TO COMPUTED-A
059300              MOVE  "00" TO CORRECT-A
059400              PERFORM FAIL
059500              ELSE
059600              PERFORM PASS.
059700     PERFORM  PRINT-DETAIL.
059800     ADD      01 TO REC-CT.
059900*    .03
060000     IF        RL-FD2-STATUS NOT EQUAL  TO "10"
060100              MOVE "ATEND/STATUS" TO RE-MARK
060200              MOVE  RL-FD2-STATUS TO COMPUTED-A
060300              MOVE "10" TO CORRECT-A
060400              PERFORM FAIL
060500              ELSE
060600              PERFORM PASS.
060700     PERFORM  PRINT-DETAIL.
060800     ADD      01 TO REC-CT.
060900*    .04
061000     IF       WRK-XN-0002-002 NOT EQUAL TO "10"
061100              MOVE  "EXCEPTIN/STATUS" TO RE-MARK
061200              MOVE  WRK-XN-0002-002 TO COMPUTED-A
061300              MOVE  "10" TO CORRECT-A
061400              PERFORM FAIL
061500              ELSE
061600              PERFORM PASS.
061700     PERFORM  PRINT-DETAIL.
061800     ADD      01 TO REC-CT.
061900*    .05
062000     IF       WRK-XN-0002-003 NOT EQUAL TO "10"
062100              MOVE "NO/EXCEPTION" TO  RE-MARK
062200              MOVE WRK-XN-0002-003 TO COMPUTED-A
062300              MOVE "10" TO CORRECT-A
062400              PERFORM FAIL
062500              ELSE
062600              PERFORM PASS.
062700     PERFORM  PRINT-DETAIL
062800     ADD      01 TO REC-CT.
062900*    .06
063000     MOVE     SPACE TO RL-FD2-STATUS.
063100     CLOSE    RL-FD2
063200     IF        RL-FD2-STATUS NOT EQUAL TO "00"
063300              MOVE "CLOSE/STATUS" TO RE-MARK
063400              MOVE  RL-FD2-STATUS TO  COMPUTED-A
063500              MOVE "00" TO CORRECT-A
063600              PERFORM FAIL
063700              ELSE
063800              PERFORM PASS.
063900     PERFORM  PRINT-DETAIL.
064000     ADD      01 TO REC-CT.
064100*    .07
064200 CCVS-EXIT SECTION.
064300 CCVS-999999.
064400     GO TO CLOSE-FILES.
