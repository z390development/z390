000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ108A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    " HIGH       ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "4.2 ".
001100*                                                              *
001200****************************************************************
001300
001400*        THE ROUTINE SQ108A CREATES A FIXED LENGTH MASS STORAGE
001500*    FILE.  THE FILE IS CREATED USING WRITE STATEMENTS, VERIFIED
001600*    IN SEQ-TEST-20 AND THEN READ USING READ...INTO STATEMENTS.
001700*    THE READ...INTO TESTS CHECK FOR TRUNCATION AND BLANK FILL
001800*    OF THE IDENTIFIER AREA.
001900*
002000*    USED X-CARDS:
002100*         XXXXX014
002200*         XXXXX055
002300*     P   XXXXX062
002400*         XXXXX082
002500*         XXXXX083
002600*     C   XXXXX084
002700*
002800*
002900 ENVIRONMENT DIVISION.
003000 CONFIGURATION SECTION.
003100 SOURCE-COMPUTER.
003200     XXXXX082.
003300 OBJECT-COMPUTER.
003400     XXXXX083.
003500 INPUT-OUTPUT SECTION.
003600 FILE-CONTROL.
003700P    SELECT RAW-DATA   ASSIGN TO
003800P    XXXXX062
003900P           ORGANIZATION IS INDEXED
004000P           ACCESS MODE IS RANDOM
004100P           RECORD KEY IS RAW-DATA-KEY.
004200     SELECT PRINT-FILE ASSIGN TO
004300     XXXXX055.
004400     SELECT SQ-FS8 ASSIGN TO
004500     XXXXX014
004600     ORGANIZATION IS SEQUENTIAL
004700     ACCESS MODE IS SEQUENTIAL.
004800 DATA DIVISION.
004900 FILE SECTION.
005000P
005100PFD  RAW-DATA.
005200P
005300P01  RAW-DATA-SATZ.
005400P    05  RAW-DATA-KEY        PIC X(6).
005500P    05  C-DATE              PIC 9(6).
005600P    05  C-TIME              PIC 9(8).
005700P    05  C-NO-OF-TESTS       PIC 99.
005800P    05  C-OK                PIC 999.
005900P    05  C-ALL               PIC 999.
006000P    05  C-FAIL              PIC 999.
006100P    05  C-DELETED           PIC 999.
006200P    05  C-INSPECT           PIC 999.
006300P    05  C-NOTE              PIC X(13).
006400P    05  C-INDENT            PIC X.
006500P    05  C-ABORT             PIC X(8).
006600 FD  PRINT-FILE
006700C    LABEL RECORDS
006800C    XXXXX084
006900C    DATA RECORD IS PRINT-REC DUMMY-RECORD
007000               .
007100 01  PRINT-REC PICTURE X(120).
007200 01  DUMMY-RECORD PICTURE X(120).
007300 FD  SQ-FS8
007400C    LABEL RECORD STANDARD
007500     BLOCK CONTAINS 1 RECORDS.
007600 01  SQ-FS8R1-F-G-141.
007700     02  SQ-FS8R1-PART1   PICTURE X(120).
007800     02  SQ-FS8R1-PART2   PICTURE X(21).
007900 WORKING-STORAGE SECTION.
008000 01  END-OF-RECORD-AREA.
008100     02  ALPHA-AREA PIC X(17).
008200     02  NUMBER-AREA  PIC 9999.
008300 01  COUNT-OF-RECS PIC 9999.
008400 01  RECORDS-IN-ERROR  PIC S9(5) USAGE COMP VALUE 0.
008500 01  ERROR-FLAG PICTURE 9 VALUE 0.
008600 01  EOF-FLAG PICTURE 9 VALUE 0.
008700 01  READ-INTO-AREA1.
008800     02  AREA1-1  PIC X(87).
008900 01  FOLLOWS-AREA1 PIC X(10).
009000 01  READ-INTO-AREA2.
009100     02  AREA2-1 PIC X(120).
009200 01  FOLLOWS-AREA2 PIC X(10).
009300 01  READ-INTO-AREA3.
009400     02  AREA3-1   PIC  X(141).
009500     02  AREA3-2   PIC  X(7).
009600 01  READ-INTO-AREA4.
009700     02  AREA4-1   PICTURE X(120).
009800     02  AREA4-2   PICTURE X(21).
009900 01  FILE-RECORD-INFORMATION-REC.
010000     03 FILE-RECORD-INFO-SKELETON.
010100        05 FILLER                 PICTURE X(48)       VALUE
010200             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
010300        05 FILLER                 PICTURE X(46)       VALUE
010400             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
010500        05 FILLER                 PICTURE X(26)       VALUE
010600             ",LFIL=000000,ORG=  ,LBLR= ".
010700        05 FILLER                 PICTURE X(37)       VALUE
010800             ",RECKEY=                             ".
010900        05 FILLER                 PICTURE X(38)       VALUE
011000             ",ALTKEY1=                             ".
011100        05 FILLER                 PICTURE X(38)       VALUE
011200             ",ALTKEY2=                             ".
011300        05 FILLER                 PICTURE X(7)        VALUE SPACE.
011400     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
011500        05 FILE-RECORD-INFO-P1-120.
011600           07 FILLER              PIC X(5).
011700           07 XFILE-NAME           PIC X(6).
011800           07 FILLER              PIC X(8).
011900           07 XRECORD-NAME         PIC X(6).
012000           07 FILLER              PIC X(1).
012100           07 REELUNIT-NUMBER     PIC 9(1).
012200           07 FILLER              PIC X(7).
012300           07 XRECORD-NUMBER       PIC 9(6).
012400           07 FILLER              PIC X(6).
012500           07 UPDATE-NUMBER       PIC 9(2).
012600           07 FILLER              PIC X(5).
012700           07 ODO-NUMBER          PIC 9(4).
012800           07 FILLER              PIC X(5).
012900           07 XPROGRAM-NAME        PIC X(5).
013000           07 FILLER              PIC X(7).
013100           07 XRECORD-LENGTH       PIC 9(6).
013200           07 FILLER              PIC X(7).
013300           07 CHARS-OR-RECORDS    PIC X(2).
013400           07 FILLER              PIC X(1).
013500           07 XBLOCK-SIZE          PIC 9(4).
013600           07 FILLER              PIC X(6).
013700           07 RECORDS-IN-FILE     PIC 9(6).
013800           07 FILLER              PIC X(5).
013900           07 XFILE-ORGANIZATION   PIC X(2).
014000           07 FILLER              PIC X(6).
014100           07 XLABEL-TYPE          PIC X(1).
014200        05 FILE-RECORD-INFO-P121-240.
014300           07 FILLER              PIC X(8).
014400           07 XRECORD-KEY          PIC X(29).
014500           07 FILLER              PIC X(9).
014600           07 ALTERNATE-KEY1      PIC X(29).
014700           07 FILLER              PIC X(9).
014800           07 ALTERNATE-KEY2      PIC X(29).
014900           07 FILLER              PIC X(7).
015000 01  TEST-RESULTS.
015100     02 FILLER                    PICTURE X VALUE SPACE.
015200     02 FEATURE                   PICTURE X(20) VALUE SPACE.
015300     02 FILLER                    PICTURE X VALUE SPACE.
015400     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
015500     02 FILLER                    PICTURE X  VALUE SPACE.
015600     02  PAR-NAME.
015700       03 FILLER PICTURE X(12) VALUE SPACE.
015800       03  PARDOT-X PICTURE X  VALUE SPACE.
015900       03 DOTVALUE PICTURE 99  VALUE ZERO.
016000       03 FILLER PIC X(5) VALUE SPACE.
016100     02 FILLER PIC X(10) VALUE SPACE.
016200     02 RE-MARK PIC X(61).
016300 01  TEST-COMPUTED.
016400     02 FILLER PIC X(30) VALUE SPACE.
016500     02 FILLER PIC X(17) VALUE "       COMPUTED=".
016600     02 COMPUTED-X.
016700     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
016800     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
016900     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
017000     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
017100     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
017200     03       CM-18V0 REDEFINES COMPUTED-A.
017300         04 COMPUTED-18V0                   PICTURE -9(18).
017400         04 FILLER                          PICTURE X.
017500     03 FILLER PIC X(50) VALUE SPACE.
017600 01  TEST-CORRECT.
017700     02 FILLER PIC X(30) VALUE SPACE.
017800     02 FILLER PIC X(17) VALUE "       CORRECT =".
017900     02 CORRECT-X.
018000     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
018100     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
018200     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
018300     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
018400     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
018500     03      CR-18V0 REDEFINES CORRECT-A.
018600         04 CORRECT-18V0                    PICTURE -9(18).
018700         04 FILLER                          PICTURE X.
018800     03 FILLER PIC X(50) VALUE SPACE.
018900 01  CCVS-C-1.
019000     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
019100-    "SS  PARAGRAPH-NAME
019200-    "        REMARKS".
019300     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
019400 01  CCVS-C-2.
019500     02 FILLER PICTURE IS X VALUE IS SPACE.
019600     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
019700     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
019800     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
019900     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
020000 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
020100 01  REC-CT PICTURE 99 VALUE ZERO.
020200 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
020300 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
020400 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
020500 01  PASS-COUNTER PIC 999 VALUE ZERO.
020600 01  TOTAL-ERROR PIC 999 VALUE ZERO.
020700 01  ERROR-HOLD PIC 999 VALUE ZERO.
020800 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
020900 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
021000 01  CCVS-H-1.
021100     02  FILLER   PICTURE X(27)  VALUE SPACE.
021200     02 FILLER PICTURE X(67) VALUE
021300     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
021400-    " SYSTEM".
021500     02  FILLER     PICTURE X(26)  VALUE SPACE.
021600 01  CCVS-H-2.
021700     02 FILLER PICTURE X(52) VALUE IS
021800     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
021900     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
022000     02 TEST-ID PICTURE IS X(9).
022100     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
022200 01  CCVS-H-3.
022300     02  FILLER PICTURE X(34) VALUE
022400     " FOR OFFICIAL USE ONLY    ".
022500     02  FILLER PICTURE X(58) VALUE
022600     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022700     02  FILLER PICTURE X(28) VALUE
022800     "  COPYRIGHT   1985 ".
022900 01  CCVS-E-1.
023000     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
023100     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
023200     02 ID-AGAIN PICTURE IS X(9).
023300     02 FILLER PICTURE X(45) VALUE IS
023400     " NTIS DISTRIBUTION COBOL 85".
023500 01  CCVS-E-2.
023600     02  FILLER                   PICTURE X(31)  VALUE
023700     SPACE.
023800     02  FILLER                   PICTURE X(21)  VALUE SPACE.
023900     02 CCVS-E-2-2.
024000         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
024100         03 FILLER PICTURE IS X VALUE IS SPACE.
024200         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
024300 01  CCVS-E-3.
024400     02  FILLER PICTURE X(22) VALUE
024500     " FOR OFFICIAL USE ONLY".
024600     02  FILLER PICTURE X(12) VALUE SPACE.
024700     02  FILLER PICTURE X(58) VALUE
024800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024900     02  FILLER PICTURE X(13) VALUE SPACE.
025000     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
025100 01  CCVS-E-4.
025200     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
025300     02 FILLER PIC XXXX VALUE " OF ".
025400     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
025500     02 FILLER PIC X(40) VALUE
025600      "  TESTS WERE EXECUTED SUCCESSFULLY".
025700 01  XXINFO.
025800     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
025900     02 INFO-TEXT.
026000     04 FILLER PIC X(20) VALUE SPACE.
026100     04 XXCOMPUTED PIC X(20).
026200     04 FILLER PIC X(5) VALUE SPACE.
026300     04 XXCORRECT PIC X(20).
026400 01  HYPHEN-LINE.
026500     02 FILLER PICTURE IS X VALUE IS SPACE.
026600     02 FILLER PICTURE IS X(65) VALUE IS "************************
026700-    "*****************************************".
026800     02 FILLER PICTURE IS X(54) VALUE IS "************************
026900-    "******************************".
027000 01  CCVS-PGM-ID PIC X(6) VALUE
027100     "SQ108A".
027200 PROCEDURE DIVISION.
027300 CCVS1 SECTION.
027400 OPEN-FILES.
027500P    OPEN I-O RAW-DATA.
027600P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
027700P    READ RAW-DATA INVALID KEY GO TO END-E-1.
027800P    MOVE "ABORTED " TO C-ABORT.
027900P    ADD 1 TO C-NO-OF-TESTS.
028000P    ACCEPT C-DATE  FROM DATE.
028100P    ACCEPT C-TIME  FROM TIME.
028200P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
028300PEND-E-1.
028400P    CLOSE RAW-DATA.
028500     OPEN     OUTPUT PRINT-FILE.
028600     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
028700     MOVE    SPACE TO TEST-RESULTS.
028800     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
028900     MOVE ZERO TO REC-SKL-SUB.
029000     PERFORM CCVS-INIT-FILE 9 TIMES.
029100 CCVS-INIT-FILE.
029200     ADD 1 TO REC-SKL-SUB.
029300     MOVE FILE-RECORD-INFO-SKELETON TO
029400                  FILE-RECORD-INFO (REC-SKL-SUB).
029500 CCVS-INIT-EXIT.
029600     GO TO CCVS1-EXIT.
029700 CLOSE-FILES.
029800     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
029900P    OPEN I-O RAW-DATA.
030000P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
030100P    READ RAW-DATA INVALID KEY GO TO END-E-2.
030200P    MOVE "OK.     " TO C-ABORT.
030300P    MOVE PASS-COUNTER TO C-OK.
030400P    MOVE ERROR-HOLD   TO C-ALL.
030500P    MOVE ERROR-COUNTER TO C-FAIL.
030600P    MOVE DELETE-CNT TO C-DELETED.
030700P    MOVE INSPECT-COUNTER TO C-INSPECT.
030800P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
030900PEND-E-2.
031000P    CLOSE RAW-DATA.
031100 TERMINATE-CCVS.
031200S    EXIT PROGRAM.
031300STERMINATE-CALL.
031400     STOP     RUN.
031500 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
031600 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
031700 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
031800 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
031900     MOVE "****TEST DELETED****" TO RE-MARK.
032000 PRINT-DETAIL.
032100     IF REC-CT NOT EQUAL TO ZERO
032200             MOVE "." TO PARDOT-X
032300             MOVE REC-CT TO DOTVALUE.
032400     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
032500     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
032600        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
032700          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
032800     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
032900     MOVE SPACE TO CORRECT-X.
033000     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
033100     MOVE     SPACE TO RE-MARK.
033200 HEAD-ROUTINE.
033300     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033400     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
033500     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
033600 COLUMN-NAMES-ROUTINE.
033700     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033800     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
034000 END-ROUTINE.
034100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
034200 END-RTN-EXIT.
034300     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034400 END-ROUTINE-1.
034500      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
034600      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
034700      ADD PASS-COUNTER TO ERROR-HOLD.
034800*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
034900      MOVE PASS-COUNTER TO CCVS-E-4-1.
035000      MOVE ERROR-HOLD TO CCVS-E-4-2.
035100      MOVE CCVS-E-4 TO CCVS-E-2-2.
035200      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
035300  END-ROUTINE-12.
035400      MOVE "TEST(S) FAILED" TO ENDER-DESC.
035500     IF       ERROR-COUNTER IS EQUAL TO ZERO
035600         MOVE "NO " TO ERROR-TOTAL
035700         ELSE
035800         MOVE ERROR-COUNTER TO ERROR-TOTAL.
035900     MOVE     CCVS-E-2 TO DUMMY-RECORD.
036000     PERFORM WRITE-LINE.
036100 END-ROUTINE-13.
036200     IF DELETE-CNT IS EQUAL TO ZERO
036300         MOVE "NO " TO ERROR-TOTAL  ELSE
036400         MOVE DELETE-CNT TO ERROR-TOTAL.
036500     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
036600     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036700      IF   INSPECT-COUNTER EQUAL TO ZERO
036800          MOVE "NO " TO ERROR-TOTAL
036900      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
037000      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
037100      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037200     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037300 WRITE-LINE.
037400     ADD 1 TO RECORD-COUNT.
037500Y    IF RECORD-COUNT GREATER 50
037600Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
037700Y        MOVE SPACE TO DUMMY-RECORD
037800Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
037900Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
038000Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
038100Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
038200Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
038300Y        MOVE ZERO TO RECORD-COUNT.
038400     PERFORM WRT-LN.
038500 WRT-LN.
038600     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
038700     MOVE SPACE TO DUMMY-RECORD.
038800 BLANK-LINE-PRINT.
038900     PERFORM WRT-LN.
039000 FAIL-ROUTINE.
039100     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
039200     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
039300     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
039400     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
039500     GO TO FAIL-ROUTINE-EX.
039600 FAIL-ROUTINE-WRITE.
039700     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
039800     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
039900 FAIL-ROUTINE-EX. EXIT.
040000 BAIL-OUT.
040100     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
040200     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
040300 BAIL-OUT-WRITE.
040400     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
040500     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040600 BAIL-OUT-EX. EXIT.
040700 CCVS1-EXIT.
040800     EXIT.
040900 SECT-SQ-108-0001 SECTION.
041000 SEQ-INIT-019.
041100     MOVE "SQ-FS8" TO XFILE-NAME (1).
041200     MOVE "R1-F-G" TO XRECORD-NAME (1).
041300     MOVE CCVS-PGM-ID TO XPROGRAM-NAME (1).
041400     MOVE 141 TO XRECORD-LENGTH (1).
041500     MOVE "RC" TO CHARS-OR-RECORDS (1).
041600     MOVE 1 TO XBLOCK-SIZE (1).
041700     MOVE 710 TO RECORDS-IN-FILE (1).
041800     MOVE "SQ" TO XFILE-ORGANIZATION (1).
041900     MOVE "O" TO XLABEL-TYPE (1).
042000     MOVE  0  TO NUMBER-AREA.
042100     MOVE "READ...INTO FILE " TO ALPHA-AREA.
042200     OPEN OUTPUT SQ-FS8.
042300 SEQ-TEST-019.
042400     ADD 1 TO NUMBER-AREA.
042500     MOVE NUMBER-AREA TO XRECORD-NUMBER (1).
042600     MOVE FILE-RECORD-INFO-P1-120 (1) TO SQ-FS8R1-PART1.
042700     MOVE END-OF-RECORD-AREA TO SQ-FS8R1-PART2.
042800     WRITE SQ-FS8R1-F-G-141.
042900     IF NUMBER-AREA EQUAL TO 710
043000         GO TO SEQ-WRITE-019.
043100     GO TO SEQ-TEST-019.
043200 SEQ-WRITE-019.
043300     MOVE "CREATE FILE SQ-FS8" TO FEATURE.
043400     MOVE "SEQ-TEST-019" TO PAR-NAME.
043500     MOVE "FILE CREATED, RECS =" TO COMPUTED-A.
043600     MOVE NUMBER-AREA TO CORRECT-18V0.
043700     PERFORM PRINT-DETAIL.
043800     CLOSE SQ-FS8.
043900*        A MASS STORAGE SEQUENTIAL FILE WITH 141 CHARACTER
044000*    RECORDS HAS BEEN CREATED.  THE FILE CONTAINS 710 RECORDS.
044100 RERAD-INIT-020.
044200     MOVE ZERO TO COUNT-OF-RECS.
044300*        THIS TEST READS AND CHECKS THE FILE CREATED
044400*    IN RERAD-TEST-019.
044500     OPEN INPUT SQ-FS8.
044600 SEQ-TEST-020.
044700     READ SQ-FS8 RECORD
044800         AT END GO TO SEQ-TEST-020-1.
044900     ADD 1 TO COUNT-OF-RECS.
045000     IF COUNT-OF-RECS GREATER THAN 710
045100           MOVE "MORE THAN 710 RECORDS" TO RE-MARK
045200           GO TO SEQ-FAIL-020.
045300     MOVE SQ-FS8R1-PART1 TO FILE-RECORD-INFO-P1-120 (1).
045400     MOVE SQ-FS8R1-PART2 TO END-OF-RECORD-AREA.
045500     IF COUNT-OF-RECS NOT EQUAL TO NUMBER-AREA
045600           GO TO SEQ-TEST-020-2.
045700     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS8"
045800           GO TO SEQ-TEST-020-2.
045900     IF XLABEL-TYPE (1) NOT EQUAL TO "O"
046000           GO TO SEQ-TEST-020-2.
046100     IF COUNT-OF-RECS NOT EQUAL TO XRECORD-NUMBER (1)
046200           GO TO SEQ-TEST-020-2.
046300     IF ALPHA-AREA     EQUAL TO "READ...INTO FILE "
046400           GO TO SEQ-TEST-020.
046500 SEQ-TEST-020-2.
046600     ADD 1 TO RECORDS-IN-ERROR.
046700     GO TO SEQ-TEST-020.
046800 SEQ-TEST-020-1.
046900     IF RECORDS-IN-ERROR EQUAL TO ZERO
047000         GO TO SEQ-PASS-020.
047100     MOVE "ERRORS IN READING SQ-FS8" TO RE-MARK.
047200 SEQ-FAIL-020.
047300     MOVE "RECORDS IN ERROR =" TO COMPUTED-A.
047400     MOVE RECORDS-IN-ERROR TO CORRECT-18V0.
047500     PERFORM FAIL.
047600     GO TO SEQ-WRITE-020.
047700 SEQ-PASS-020.
047800     PERFORM PASS.
047900     MOVE "FILE VERIFIED RECS =" TO COMPUTED-A.
048000     MOVE COUNT-OF-RECS TO CORRECT-18V0.
048100 SEQ-WRITE-020.
048200     MOVE "SEQ-TEST-020"   TO PAR-NAME.
048300     MOVE "VERIFY FILE SQ-FS8" TO FEATURE.
048400     PERFORM PRINT-DETAIL.
048500 SEQ-CLOSE-020.
048600     CLOSE SQ-FS8.
048700 READ-INIT-GF-01.
048800     MOVE ZERO TO COUNT-OF-RECS.
048900     MOVE ZERO TO RECORDS-IN-ERROR.
049000     MOVE ZERO TO ERROR-FLAG.
049100     MOVE ZERO TO EOF-FLAG.
049200     MOVE "READ 141 INTO 87    " TO FEATURE.
049300     MOVE "READ...RECORD INTO...AT END  01 LEVEL" TO RE-MARK.
049400     MOVE "READ-TEST-GF-01" TO PAR-NAME.
049500*        THIS TEST READS RECORDS OF 141 CHARACTERS INTO A
049600*    WORKING-STORAGE AREA OF 87 CHARACTERS AND CHECKS THE AREA
049700*    FOLLOWING TO ENSURE TRUNCATION TOOK PLACE.  OTHER FIELDS
049800*    IN THE RECORD AREA ARE ALSO CHECKED.
049900     OPEN INPUT SQ-FS8.
050000 READ-TEST-GF-01.
050100     MOVE SPACE TO FOLLOWS-AREA1.
050200     READ SQ-FS8 RECORD INTO READ-INTO-AREA1
050300          AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
050400          MOVE 1 TO EOF-FLAG
050500          GO TO READ-FAIL-GF-01.
050600     ADD 1 TO COUNT-OF-RECS.
050700     IF COUNT-OF-RECS EQUAL TO 125
050800          GO TO READ-TEST-GF-01-1.
050900     IF FOLLOWS-AREA1 NOT EQUAL TO SPACE
051000        MOVE "WORKING-STORAGE CLOBBERED" TO RE-MARK
051100        MOVE FOLLOWS-AREA1 TO COMPUTED-A
051200        GO TO READ-FAIL-GF-01.
051300     MOVE SPACE TO CHARS-OR-RECORDS (1).
051400     MOVE AREA1-1 TO FILE-RECORD-INFO-P1-120 (1).
051500     IF CHARS-OR-RECORDS (1) EQUAL TO "RC"
051600         MOVE "NO TRUNC ON READ" TO COMPUTED-A
051700         GO TO READ-FAIL-GF-01.
051800     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS8"
051900         ADD 1 TO RECORDS-IN-ERROR
052000         GO TO READ-TEST-GF-01.
052100     IF XRECORD-NUMBER (1) NOT EQUAL TO COUNT-OF-RECS
052200         ADD 1 TO RECORDS-IN-ERROR.
052300     GO TO READ-TEST-GF-01.
052400 READ-TEST-GF-01-1.
052500     IF RECORDS-IN-ERROR EQUAL TO 0
052600         GO TO READ-PASS-GF-01.
052700 READ-FAIL-GF-01.
052800     MOVE "ERRORS IN RECORD(S)" TO COMPUTED-A.
052900     MOVE "VII-45; 4.4.3 (7), (8)                   " TO  RE-MARK.
053000     PERFORM FAIL.
053100     GO TO READ-WRITE-GF-01.
053200 READ-PASS-GF-01.
053300     PERFORM PASS.
053400 READ-WRITE-GF-01.
053500     PERFORM PRINT-DETAIL.
053600 READ-INIT-GF-02.
053700     IF EOF-FLAG EQUAL TO 1
053800           GO TO SEQ-EOF-21.
053900     MOVE 0 TO ERROR-FLAG.
054000*        THIS TEST READS RECORDS OF 141 CHARACTERS INTO AN 02
054100*    LEVEL IDENTIFIER WITH PIC X(120).
054200     MOVE "READ 141 INTO 120    " TO FEATURE.
054300     MOVE "READ-TEST-GF-02" TO PAR-NAME.
054400     MOVE "READ...INTO...AT END 02 LEVEL" TO RE-MARK.
054500 READ-TEST-GF-02.
054600     MOVE SPACE TO FOLLOWS-AREA2.
054700     READ SQ-FS8 INTO AREA2-1
054800         AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
054900         MOVE 1 TO EOF-FLAG
055000         GO TO READ-FAIL-GF-02.
055100     ADD 1 TO COUNT-OF-RECS.
055200     IF COUNT-OF-RECS EQUAL TO 250
055300         GO TO READ-TEST-GF-02-1.
055400     IF FOLLOWS-AREA2 NOT EQUAL TO SPACE
055500         MOVE "WORKING-STORAGE CLOBBERED" TO RE-MARK
055600         MOVE FOLLOWS-AREA2 TO COMPUTED-A
055700         GO TO READ-FAIL-GF-02.
055800     MOVE AREA2-1 TO FILE-RECORD-INFO-P1-120 (1).
055900     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS8"
056000         ADD 1 TO RECORDS-IN-ERROR
056100         MOVE 1 TO ERROR-FLAG
056200         GO TO READ-TEST-GF-02.
056300     IF XRECORD-NUMBER (1) NOT EQUAL TO COUNT-OF-RECS
056400         ADD 1 TO RECORDS-IN-ERROR
056500         MOVE 1 TO ERROR-FLAG.
056600     GO TO READ-TEST-GF-02.
056700 READ-TEST-GF-02-1.
056800     IF ERROR-FLAG EQUAL TO 0
056900         GO TO READ-PASS-GF-02.
057000 READ-FAIL-GF-02.
057100     MOVE "VII-45; 4.4.3 (7) & (8)                  " TO  RE-MARK.
057200     MOVE "ERRORS IN RECORD(S)" TO COMPUTED-A.
057300     PERFORM FAIL.
057400     GO TO READ-WRITE-GF-02.
057500 READ-PASS-GF-02.
057600     PERFORM PASS.
057700 READ-WRITE-GF-02.
057800     PERFORM PRINT-DETAIL.
057900 READ-INIT-GF-03.
058000     IF EOF-FLAG EQUAL TO 1
058100         GO TO SEQ-EOF-21.
058200     MOVE 0 TO ERROR-FLAG.
058300     MOVE "READ 141 INTO 148 " TO FEATURE.
058400     MOVE "READ-TEST-GF-03" TO PAR-NAME.
058500     MOVE "READ...RECORD INTO...END 01 LEVEL" TO RE-MARK.
058600*        THIS TEST READS RECORDS OF 141 CHARACTERS INTO A WORKING-
058700*    STORAGE RECORD OF 148 CHARACTERS.  THE LAST 7 CHARACTERS ARE
058800*    TESTED TO ENSURE THAT SPACE FILLING ON THE RIGHT OCCURRED.
058900 READ-TEST-GF-03.
059000     MOVE "ABCDEFG" TO AREA3-2.
059100     READ SQ-FS8 RECORD INTO READ-INTO-AREA3
059200           END MOVE "UNEXPECTED EOF" TO COMPUTED-A
059300           MOVE 1 TO EOF-FLAG
059400           GO TO READ-FAIL-GF-03.
059500     ADD 1 TO COUNT-OF-RECS.
059600     IF COUNT-OF-RECS EQUAL TO 350
059700           GO TO READ-TEST-GF-03-1.
059800     IF AREA3-2 NOT EQUAL TO SPACE
059900         MOVE "NO SPACE FILL" TO RE-MARK
060000         MOVE AREA3-2 TO COMPUTED-A
060100         GO TO READ-FAIL-GF-03.
060200     MOVE AREA3-1 TO FILE-RECORD-INFO-P1-120 (1).
060300     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS8"
060400         ADD 1 TO RECORDS-IN-ERROR
060500         MOVE 1 TO ERROR-FLAG
060600         GO TO READ-TEST-GF-03.
060700     IF XRECORD-NUMBER (1) NOT EQUAL TO COUNT-OF-RECS
060800         ADD 1 TO RECORDS-IN-ERROR
060900         MOVE 1 TO ERROR-FLAG
061000         GO TO READ-TEST-GF-03.
061100     IF XLABEL-TYPE (1) NOT EQUAL TO "O"
061200         ADD 1 TO RECORDS-IN-ERROR
061300         MOVE 1 TO ERROR-FLAG.
061400     GO TO READ-TEST-GF-03.
061500 READ-TEST-GF-03-1.
061600     IF ERROR-FLAG EQUAL TO 0
061700         GO TO READ-PASS-GF-03.
061800 READ-FAIL-GF-03.
061900     MOVE "VII-45; 4.4.3 (7) & (8)                  " TO  RE-MARK.
062000     MOVE "ERRORS IN RECORD(S)" TO COMPUTED-A.
062100     PERFORM FAIL.
062200     GO TO READ-WRITE-GF-03.
062300 READ-PASS-GF-03.
062400     PERFORM PASS.
062500 READ-WRITE-GF-03.
062600     PERFORM PRINT-DETAIL.
062700 READ-INIT-GF-04.
062800     IF EOF-FLAG EQUAL TO 1
062900          GO TO SEQ-EOF-21.
063000     MOVE 0 TO ERROR-FLAG.
063100     MOVE "READ 141 INTO 141" TO FEATURE.
063200     MOVE "READ-TEST-GF-04" TO PAR-NAME.
063300     MOVE "READ...INTO...END  01 LEVEL" TO RE-MARK.
063400*        THIS TEST READS RECORDS OF 141 CHARACTERS INTO A
063500*    WORKING-STORAGE RECORD OF 141 CHARACTERS.
063600 READ-TEST-GF-04.
063700     READ SQ-FS8 INTO READ-INTO-AREA4
063800          END MOVE "UNEXPECTED EOF" TO COMPUTED-A
063900          MOVE 1 TO EOF-FLAG
064000          GO TO READ-FAIL-GF-04.
064100     ADD 1 TO COUNT-OF-RECS.
064200     IF COUNT-OF-RECS EQUAL TO 400
064300         GO TO READ-TEST-GF-04-1.
064400     MOVE AREA4-2 TO END-OF-RECORD-AREA.
064500     IF ALPHA-AREA NOT EQUAL TO "READ...INTO FILE "
064600           GO TO READ-FAIL-GF-04-1.
064700     IF NUMBER-AREA NOT EQUAL TO COUNT-OF-RECS
064800           GO TO READ-FAIL-GF-04-1.
064900     MOVE AREA4-1 TO FILE-RECORD-INFO-P1-120 (1).
065000     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS8"
065100         GO TO READ-FAIL-GF-04-1.
065200     IF XRECORD-NUMBER (1) NOT EQUAL TO COUNT-OF-RECS
065300         GO TO READ-FAIL-GF-04-1.
065400     IF XLABEL-TYPE (1) NOT EQUAL TO "O"
065500         GO TO READ-FAIL-GF-04-1.
065600     GO TO READ-TEST-GF-04.
065700 READ-FAIL-GF-04-1.
065800     ADD 1 TO RECORDS-IN-ERROR.
065900     MOVE 1 TO ERROR-FLAG.
066000     GO TO READ-TEST-GF-04.
066100 READ-TEST-GF-04-1.
066200     IF ERROR-FLAG EQUAL TO 0
066300         GO TO READ-PASS-GF-04.
066400 READ-FAIL-GF-04.
066500     MOVE "ERRORS IN RECORD(S)" TO COMPUTED-A.
066600     MOVE "VII-45; 4.4.3 (7) & (8)                  " TO  RE-MARK.
066700     PERFORM FAIL.
066800     GO TO READ-WRITE-GF-04.
066900 READ-PASS-GF-04.
067000     PERFORM PASS.
067100 READ-WRITE-GF-04.
067200     PERFORM PRINT-DETAIL.
067300 READ-INIT-GF-05.
067400     IF EOF-FLAG EQUAL TO 1
067500         GO TO SEQ-EOF-21.
067600     MOVE 0 TO ERROR-FLAG.
067700     MOVE "READ 141 INTO 120" TO FEATURE.
067800     MOVE "READ-TEST-GF-05" TO PAR-NAME.
067900     MOVE "READ INTO SUBSCRIPTED DATA ITEM 05 LEVEL" TO RE-MARK.
068000*         THIS TEST READS A RECORD OF 141 CHARACTERS INTO A
068100*    SUBSCRIPTED DATA ITEM OF 120 CHARACTERS.
068200 READ-TEST-GF-05.
068300     READ SQ-FS8 RECORD INTO FILE-RECORD-INFO-P1-120 (1)
068400          AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
068500          MOVE 1 TO EOF-FLAG
068600          GO TO READ-FAIL-GF-05.
068700     ADD 1 TO COUNT-OF-RECS.
068800     IF COUNT-OF-RECS EQUAL TO 425
068900          GO TO READ-TEST-GF-05-1.
069000     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS8"
069100          GO TO READ-FAIL-GF-05-1.
069200     IF XRECORD-NUMBER (1) NOT EQUAL TO COUNT-OF-RECS
069300          GO TO READ-FAIL-GF-05-1.
069400     IF XLABEL-TYPE (1) NOT EQUAL TO "O"
069500          GO TO READ-FAIL-GF-05-1.
069600     GO TO READ-TEST-GF-05.
069700 READ-FAIL-GF-05-1.
069800     ADD 1 TO RECORDS-IN-ERROR.
069900     MOVE 1 TO ERROR-FLAG.
070000     GO TO READ-TEST-GF-05.
070100 READ-TEST-GF-05-1.
070200     IF ERROR-FLAG EQUAL TO 0
070300         GO TO READ-PASS-GF-05.
070400     MOVE "ERRORS IN RECORD(S)" TO COMPUTED-A.
070500 READ-FAIL-GF-05.
070600     MOVE "VII-45; 4.4.3 (7) & (8)                  " TO  RE-MARK.
070700     PERFORM FAIL.
070800     GO TO READ-WRITE-GF-05.
070900 READ-PASS-GF-05.
071000     PERFORM PASS.
071100 READ-WRITE-GF-05.
071200     PERFORM PRINT-DETAIL.
071300 READ-INIT-GF-06.
071400     IF EOF-FLAG EQUAL TO 1
071500         GO TO SEQ-EOF-21.
071600     MOVE 0 TO ERROR-FLAG.
071700     MOVE "READ 141 INTO 141" TO FEATURE.
071800     MOVE "READ-TEST-GF-06" TO PAR-NAME.
071900     MOVE "CHECK OF FD RECORD ON RD INTO 01 LEVEL" TO RE-MARK.
072000*        THIS TEST READS A RECORD INTO A WORKING-STORAGE AREA
072100*    AND CHECKS THE CONTENTS OF THE FD RECORD AREA TO ENSURE
072200*    THAT IT IS NOT AFFECTED BY THE INTO PHRASE.
072300 READ-TEST-GF-06.
072400     READ SQ-FS8 RECORD INTO READ-INTO-AREA4
072500          AT END MOVE "UNEXPECTED EOF" TO COMPUTED-A
072600          MOVE 1 TO EOF-FLAG
072700          GO TO READ-FAIL-GF-06.
072800     ADD 1 TO COUNT-OF-RECS.
072900     IF COUNT-OF-RECS EQUAL TO 710
073000         GO TO READ-TEST-GF-06-1.
073100     MOVE SQ-FS8R1-PART2 TO END-OF-RECORD-AREA.
073200     IF ALPHA-AREA NOT EQUAL TO "READ...INTO FILE "
073300         GO TO READ-FAIL-GF-06-1.
073400     IF NUMBER-AREA NOT EQUAL TO COUNT-OF-RECS
073500         GO TO READ-FAIL-GF-06-1.
073600     MOVE SQ-FS8R1-PART1 TO FILE-RECORD-INFO-P1-120 (1).
073700     IF XFILE-NAME (1) NOT EQUAL TO "SQ-FS8"
073800         GO TO READ-FAIL-GF-06-1.
073900     IF XRECORD-NUMBER (1) NOT EQUAL TO COUNT-OF-RECS
074000         GO TO READ-FAIL-GF-06-1.
074100     IF XLABEL-TYPE (1) NOT EQUAL TO "O"
074200         GO TO READ-FAIL-GF-06-1.
074300     GO TO READ-TEST-GF-06.
074400 READ-FAIL-GF-06-1.
074500     ADD 1 TO RECORDS-IN-ERROR.
074600     MOVE 1 TO ERROR-FLAG.
074700     GO TO READ-TEST-GF-06.
074800 READ-TEST-GF-06-1.
074900     IF ERROR-FLAG EQUAL TO 0
075000         GO TO READ-TEST-GF-06-2.
075100     MOVE "ERRORS IN RECORD(S)" TO COMPUTED-A.
075200     GO TO READ-FAIL-GF-06.
075300 READ-TEST-GF-06-2.
075400     IF READ-INTO-AREA4 EQUAL TO SQ-FS8R1-F-G-141
075500         GO TO READ-PASS-GF-06.
075600 READ-FAIL-GF-06.
075700     MOVE "VII-45; 4.4.3 (7) & (8)                  " TO  RE-MARK.
075800     PERFORM FAIL.
075900     GO TO READ-WRITE-GF-06.
076000 READ-PASS-GF-06.
076100     PERFORM PASS.
076200 READ-WRITE-GF-06.
076300     PERFORM PRINT-DETAIL.
076400 SEQ-INIT-21.
076500*        THIS TEST CHECKS IF ANY ERRORS WERE ENCOUNTERED ON THE
076600*    PRECEDING READS, AND READS THE FILE ONCE MORE EXPECTING
076700*    THE END CONDITION TO OCCUR.
076800     IF EOF-FLAG EQUAL TO 1
076900         GO TO SEQ-EOF-21.
077000 SEQ-TEST-21.
077100     READ SQ-FS8 RECORD INTO READ-INTO-AREA4
077200          AT END GO TO SEQ-TEST-21-1.
077300     MOVE "MORE THAN 710 RECORDS" TO RE-MARK.
077400     GO TO SEQ-FAIL-21.
077500 SEQ-TEST-21-1.
077600     IF RECORDS-IN-ERROR NOT EQUAL TO 0
077700          MOVE "RECORDS IN ERROR =" TO COMPUTED-A
077800          MOVE RECORDS-IN-ERROR TO CORRECT-18V0
077900          GO TO SEQ-FAIL-21.
078000 SEQ-PASS-21.
078100     PERFORM PASS.
078200     GO TO SEQ-WRITE-21.
078300 SEQ-EOF-21.
078400     MOVE "LESS THAN 710 RECORDS" TO RE-MARK.
078500     MOVE "RECORDS READ =" TO COMPUTED-A.
078600     MOVE COUNT-OF-RECS TO CORRECT-18V0.
078700 SEQ-FAIL-21.
078800     PERFORM FAIL.
078900 SEQ-WRITE-21.
079000     MOVE "SEQ-TEST-21" TO PAR-NAME.
079100     MOVE "READ SQ-FS8 INTO END" TO FEATURE.
079200     PERFORM PRINT-DETAIL.
079300 SEQ-CLOSE-021.
079400     CLOSE SQ-FS8.
079500 TERMINATE-ROUTINE.
079600     EXIT.
079700 CCVS-EXIT SECTION.
079800 CCVS-999999.
079900     GO TO CLOSE-FILES.
