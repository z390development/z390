000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     NC234A.
000400
000500****************************************************************
000600*                                                              *
000700*    VALIDATION FOR:-                                          *
000800*                                                              *
000900*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
001000*                                                              *
001100*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001200*                                                              *
001300****************************************************************
001400*                                                              *
001500*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001600*                                                              *
001700*        X-55  - SYSTEM PRINTER NAME.                          *
001800*        X-82  - SOURCE COMPUTER NAME.                         *
001900*        X-83  - OBJECT COMPUTER NAME.                         *
002000*                                                              *
002100****************************************************************
002200*
002300*    PROGRAM NC234A TESTS THE ACCESSING OF A "REDEFINED" THREE *
002400*    -DIMENSIONAL TABLE USING FORMAT 1 OF THE "SEARCH"         *
002500*    STATEMENT.  THE "VARYING" AND "AT END" PHRASES ARE USED.  *
002600*                                                              *
002700****************************************************************
002800 ENVIRONMENT DIVISION.
002900 CONFIGURATION SECTION.
003000 SOURCE-COMPUTER.
003100     XXXXX082.
003200 OBJECT-COMPUTER.
003300     XXXXX083.
003400 INPUT-OUTPUT SECTION.
003500 FILE-CONTROL.
003600     SELECT PRINT-FILE ASSIGN TO
003700     XXXXX055.
003800 DATA DIVISION.
003900 FILE SECTION.
004000 FD  PRINT-FILE.
004100 01  PRINT-REC PICTURE X(120).
004200 01  DUMMY-RECORD PICTURE X(120).
004300 WORKING-STORAGE SECTION.
004400 77  SUB-1              PICTURE S99  VALUE ZERO.
004500 77  SUB-2              PICTURE 99  VALUE ZERO.
004600 77  SUB-3              PICTURE 99  VALUE ZERO.
004700 77  CON-5              PICTURE 99  VALUE 05.
004800 77  CON-6              PICTURE 99  VALUE 06.
004900 77  CON-7              PICTURE 99  VALUE 07.
005000 77  CON-10             PICTURE 99  VALUE 10.
005100 77  GRP-HOLD-AREA      PICTURE X(5) VALUE SPACES.
005200 77  SEC-HOLD-AREA      PICTURE X(11) VALUE SPACES.
005300 77  ELEM-HOLD-AREA     PICTURE X(15) VALUE SPACES.
005400 01  GRP-NAME.
005500     02  FILLER              PICTURE XXX    VALUE "GRP".
005600     02  ADD-GRP             PICTURE 99     VALUE 01.
005700
005800 01  SEC-NAME.
005900     02  FILLER              PICTURE X(5)   VALUE "SEC (".
006000     02  SEC-GRP             PICTURE 99     VALUE 00.
006100     02  FILLER              PICTURE X      VALUE ",".
006200     02  ADD-SEC             PICTURE 99     VALUE 01.
006300     02  FILLER              PICTURE X      VALUE ")".
006400
006500 01  ELEM-NAME.
006600     02  FILLER              PICTURE X(6)   VALUE "ELEM (".
006700     02  ELEM-GRP            PICTURE 99     VALUE 00.
006800     02  FILLER              PICTURE X      VALUE ",".
006900     02  ELEM-SEC            PICTURE 99     VALUE 00.
007000     02  FILLER              PICTURE X      VALUE ",".
007100     02  ADD-ELEM            PICTURE 99     VALUE 01.
007200     02  FILLER              PICTURE X      VALUE ")".
007300
007400 01  3-DIMENSION-TBL.
007500     02  GRP-ENTRY OCCURS 10 TIMES INDEXED BY IDX-1.
007600         03  ENTRY-1         PICTURE X(5).
007700         03  GRP2-ENTRY OCCURS 10 TIMES INDEXED BY IDX-2.
007800             04  ENTRY-2     PICTURE X(11).
007900             04  3-ENTRY OCCURS 10 TIMES INDEXED BY IDX-3.
008000                 05  ENTRY-3 PICTURE X(15).
008100 01  3-DEM-TBL REDEFINES 3-DIMENSION-TBL.
008200     02  GRP-ENTRY-1 OCCURS 10 TIMES INDEXED BY IDX-1-1.
008300         03  ENTRY-1-1           PIC X(5).
008400         03  GRP2-ENTRY-1 OCCURS 10 TIMES INDEXED BY IDX-2-1.
008500             04  ENTRY-2-1       PIC X(11).
008600             04  GRP3-ENTRY-1 OCCURS 10 TIMES INDEXED BY IDX-3-1.
008700                 05  ENTRY-3-1   PIC X(15).
008800
008900 01  END-STMT.
009000     02  FILLER              PICTURE X(7)  VALUE "AT END ".
009100     02  END-IDX             PICTURE X(7)  VALUE SPACES.
009200     02  FILLER              PICTURE XXX   VALUE " = ".
009300     02  IDX-VALU            PICTURE 99    VALUE 00.
009400     02  FILLER              PICTURE XXX   VALUE SPACES.
009500 01  NOTE-1.
009600     02  FILLER                   PICTURE X(74)  VALUE
009700     "NOTE 1 - CORRECT AND COMPUTED DATA ARE EQUAL BUT THE AT END
009800-    "PATH WAS TAKEN".
009900     02  FILLER                   PICTURE X(46)  VALUE SPACES.
010000 01  NOTE-2.
010100     02  FILLER                   PICTURE X(112)  VALUE
010200     "NOTE 2 - CORRECT AND COMPUTED DATA ARE NOT EQUAL. THE COMPUT
010300-    "ED ENTRY WAS EXTRACTED FROM THE TABLE BY SUBSCRIPTS.".
010400     02  FILLER                   PICTURE X(8)   VALUE SPACES.
010500 01  TEST-RESULTS.
010600     02 FILLER                   PIC X      VALUE SPACE.
010700     02 FEATURE                  PIC X(20)  VALUE SPACE.
010800     02 FILLER                   PIC X      VALUE SPACE.
010900     02 P-OR-F                   PIC X(5)   VALUE SPACE.
011000     02 FILLER                   PIC X      VALUE SPACE.
011100     02  PAR-NAME.
011200       03 FILLER                 PIC X(19)  VALUE SPACE.
011300       03  PARDOT-X              PIC X      VALUE SPACE.
011400       03 DOTVALUE               PIC 99     VALUE ZERO.
011500     02 FILLER                   PIC X(8)   VALUE SPACE.
011600     02 RE-MARK                  PIC X(61).
011700 01  TEST-COMPUTED.
011800     02 FILLER                   PIC X(30)  VALUE SPACE.
011900     02 FILLER                   PIC X(17)  VALUE
012000            "       COMPUTED=".
012100     02 COMPUTED-X.
012200     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
012300     03 COMPUTED-N               REDEFINES COMPUTED-A
012400                                 PIC -9(9).9(9).
012500     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
012600     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
012700     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
012800     03       CM-18V0 REDEFINES COMPUTED-A.
012900         04 COMPUTED-18V0                    PIC -9(18).
013000         04 FILLER                           PIC X.
013100     03 FILLER PIC X(50) VALUE SPACE.
013200 01  TEST-CORRECT.
013300     02 FILLER PIC X(30) VALUE SPACE.
013400     02 FILLER PIC X(17) VALUE "       CORRECT =".
013500     02 CORRECT-X.
013600     03 CORRECT-A                  PIC X(20) VALUE SPACE.
013700     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
013800     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
013900     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
014000     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
014100     03      CR-18V0 REDEFINES CORRECT-A.
014200         04 CORRECT-18V0                     PIC -9(18).
014300         04 FILLER                           PIC X.
014400     03 FILLER PIC X(2) VALUE SPACE.
014500     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
014600 01  CCVS-C-1.
014700     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
014800-    "SS  PARAGRAPH-NAME
014900-    "       REMARKS".
015000     02 FILLER                     PIC X(20)    VALUE SPACE.
015100 01  CCVS-C-2.
015200     02 FILLER                     PIC X        VALUE SPACE.
015300     02 FILLER                     PIC X(6)     VALUE "TESTED".
015400     02 FILLER                     PIC X(15)    VALUE SPACE.
015500     02 FILLER                     PIC X(4)     VALUE "FAIL".
015600     02 FILLER                     PIC X(94)    VALUE SPACE.
015700 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
015800 01  REC-CT                        PIC 99       VALUE ZERO.
015900 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
016000 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
016100 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
016200 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
016300 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
016400 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
016500 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
016600 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
016700 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
016800 01  CCVS-H-1.
016900     02  FILLER                    PIC X(39)    VALUE SPACES.
017000     02  FILLER                    PIC X(42)    VALUE
017100     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
017200     02  FILLER                    PIC X(39)    VALUE SPACES.
017300 01  CCVS-H-2A.
017400   02  FILLER                        PIC X(40)  VALUE SPACE.
017500   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
017600   02  FILLER                        PIC XXXX   VALUE
017700     "4.2 ".
017800   02  FILLER                        PIC X(28)  VALUE
017900            " COPY - NOT FOR DISTRIBUTION".
018000   02  FILLER                        PIC X(41)  VALUE SPACE.
018100
018200 01  CCVS-H-2B.
018300   02  FILLER                        PIC X(15)  VALUE
018400            "TEST RESULT OF ".
018500   02  TEST-ID                       PIC X(9).
018600   02  FILLER                        PIC X(4)   VALUE
018700            " IN ".
018800   02  FILLER                        PIC X(12)  VALUE
018900     " HIGH       ".
019000   02  FILLER                        PIC X(22)  VALUE
019100            " LEVEL VALIDATION FOR ".
019200   02  FILLER                        PIC X(58)  VALUE
019300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
019400 01  CCVS-H-3.
019500     02  FILLER                      PIC X(34)  VALUE
019600            " FOR OFFICIAL USE ONLY    ".
019700     02  FILLER                      PIC X(58)  VALUE
019800     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
019900     02  FILLER                      PIC X(28)  VALUE
020000            "  COPYRIGHT   1985 ".
020100 01  CCVS-E-1.
020200     02 FILLER                       PIC X(52)  VALUE SPACE.
020300     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
020400     02 ID-AGAIN                     PIC X(9).
020500     02 FILLER                       PIC X(45)  VALUE SPACES.
020600 01  CCVS-E-2.
020700     02  FILLER                      PIC X(31)  VALUE SPACE.
020800     02  FILLER                      PIC X(21)  VALUE SPACE.
020900     02 CCVS-E-2-2.
021000         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
021100         03 FILLER                   PIC X      VALUE SPACE.
021200         03 ENDER-DESC               PIC X(44)  VALUE
021300            "ERRORS ENCOUNTERED".
021400 01  CCVS-E-3.
021500     02  FILLER                      PIC X(22)  VALUE
021600            " FOR OFFICIAL USE ONLY".
021700     02  FILLER                      PIC X(12)  VALUE SPACE.
021800     02  FILLER                      PIC X(58)  VALUE
021900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
022000     02  FILLER                      PIC X(13)  VALUE SPACE.
022100     02 FILLER                       PIC X(15)  VALUE
022200             " COPYRIGHT 1985".
022300 01  CCVS-E-4.
022400     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
022500     02 FILLER                       PIC X(4)   VALUE " OF ".
022600     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
022700     02 FILLER                       PIC X(40)  VALUE
022800      "  TESTS WERE EXECUTED SUCCESSFULLY".
022900 01  XXINFO.
023000     02 FILLER                       PIC X(19)  VALUE
023100            "*** INFORMATION ***".
023200     02 INFO-TEXT.
023300       04 FILLER                     PIC X(8)   VALUE SPACE.
023400       04 XXCOMPUTED                 PIC X(20).
023500       04 FILLER                     PIC X(5)   VALUE SPACE.
023600       04 XXCORRECT                  PIC X(20).
023700     02 INF-ANSI-REFERENCE           PIC X(48).
023800 01  HYPHEN-LINE.
023900     02 FILLER  PIC IS X VALUE IS SPACE.
024000     02 FILLER  PIC IS X(65)    VALUE IS "************************
024100-    "*****************************************".
024200     02 FILLER  PIC IS X(54)    VALUE IS "************************
024300-    "******************************".
024400 01  CCVS-PGM-ID                     PIC X(9)   VALUE
024500     "NC234A".
024600 PROCEDURE DIVISION.
024700 CCVS1 SECTION.
024800 OPEN-FILES.
024900     OPEN     OUTPUT PRINT-FILE.
025000     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
025100     MOVE    SPACE TO TEST-RESULTS.
025200     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
025300     GO TO CCVS1-EXIT.
025400 CLOSE-FILES.
025500     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
025600 TERMINATE-CCVS.
025700S    EXIT PROGRAM.
025800STERMINATE-CALL.
025900     STOP     RUN.
026000 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
026100 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
026200 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
026300 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
026400     MOVE "****TEST DELETED****" TO RE-MARK.
026500 PRINT-DETAIL.
026600     IF REC-CT NOT EQUAL TO ZERO
026700             MOVE "." TO PARDOT-X
026800             MOVE REC-CT TO DOTVALUE.
026900     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
027000     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
027100        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
027200          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
027300     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
027400     MOVE SPACE TO CORRECT-X.
027500     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
027600     MOVE     SPACE TO RE-MARK.
027700 HEAD-ROUTINE.
027800     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
027900     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028000     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
028100     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
028200 COLUMN-NAMES-ROUTINE.
028300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
028500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
028600 END-ROUTINE.
028700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
028800 END-RTN-EXIT.
028900     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029000 END-ROUTINE-1.
029100      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
029200      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
029300      ADD PASS-COUNTER TO ERROR-HOLD.
029400*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
029500      MOVE PASS-COUNTER TO CCVS-E-4-1.
029600      MOVE ERROR-HOLD TO CCVS-E-4-2.
029700      MOVE CCVS-E-4 TO CCVS-E-2-2.
029800      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
029900  END-ROUTINE-12.
030000      MOVE "TEST(S) FAILED" TO ENDER-DESC.
030100     IF       ERROR-COUNTER IS EQUAL TO ZERO
030200         MOVE "NO " TO ERROR-TOTAL
030300         ELSE
030400         MOVE ERROR-COUNTER TO ERROR-TOTAL.
030500     MOVE     CCVS-E-2 TO DUMMY-RECORD.
030600     PERFORM WRITE-LINE.
030700 END-ROUTINE-13.
030800     IF DELETE-COUNTER IS EQUAL TO ZERO
030900         MOVE "NO " TO ERROR-TOTAL  ELSE
031000         MOVE DELETE-COUNTER TO ERROR-TOTAL.
031100     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
031200     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031300      IF   INSPECT-COUNTER EQUAL TO ZERO
031400          MOVE "NO " TO ERROR-TOTAL
031500      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
031600      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
031700      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031800     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
031900 WRITE-LINE.
032000     ADD 1 TO RECORD-COUNT.
032100Y    IF RECORD-COUNT GREATER 50
032200Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
032300Y        MOVE SPACE TO DUMMY-RECORD
032400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
032500Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
032600Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
032700Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
032800Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
032900Y        MOVE ZERO TO RECORD-COUNT.
033000     PERFORM WRT-LN.
033100 WRT-LN.
033200     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
033300     MOVE SPACE TO DUMMY-RECORD.
033400 BLANK-LINE-PRINT.
033500     PERFORM WRT-LN.
033600 FAIL-ROUTINE.
033700     IF     COMPUTED-X NOT EQUAL TO SPACE
033800            GO TO    FAIL-ROUTINE-WRITE.
033900     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
034000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
034100     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
034200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034300     MOVE   SPACES TO INF-ANSI-REFERENCE.
034400     GO TO  FAIL-ROUTINE-EX.
034500 FAIL-ROUTINE-WRITE.
034600     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
034700     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
034800     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
034900     MOVE   SPACES TO COR-ANSI-REFERENCE.
035000 FAIL-ROUTINE-EX. EXIT.
035100 BAIL-OUT.
035200     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
035300     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
035400 BAIL-OUT-WRITE.
035500     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
035600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
035700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035800     MOVE   SPACES TO INF-ANSI-REFERENCE.
035900 BAIL-OUT-EX. EXIT.
036000 CCVS1-EXIT.
036100     EXIT.
036200 SECT-NC234A-001 SECTION.
036300 TH-07-001.
036400 INITIALISE-TABLE.
036500     PERFORM BUILD-TABLE VARYING SUB-1 FROM 1 BY 1
036600         UNTIL SUB-1 EQUAL TO 11
036700         AFTER SUB-2 FROM 1 BY 1 UNTIL SUB-2 EQUAL TO 11
036800         AFTER SUB-3 FROM 1 BY 1 UNTIL SUB-3 EQUAL TO 11
036900     GO TO CHECK-ENTRIES.
037000
037100 BUILD-TABLE.
037200     SET IDX-1 TO SUB-1.
037300     SET IDX-2 TO SUB-2.
037400     SET IDX-3 TO SUB-3.
037500     SET ADD-GRP, SEC-GRP, ELEM-GRP TO IDX-1.
037600     MOVE GRP-NAME TO ENTRY-1 (IDX-1).
037700     SET ADD-SEC, ELEM-SEC TO IDX-2.
037800     MOVE SEC-NAME TO ENTRY-2 (IDX-1, IDX-2).
037900     SET ADD-ELEM TO IDX-3.
038000     MOVE ELEM-NAME TO ENTRY-3 (IDX-1, IDX-2, IDX-3).
038100*
038200 CHECK-ENTRIES.
038300     MOVE "SEARCH VARYING LEV 1" TO FEATURE.
038400     MOVE "CHECK-ENTRIES" TO PAR-NAME.
038500     MOVE "GRP02" TO GRP-HOLD-AREA.
038600     MOVE 02 TO SUB-2.
038700     SET IDX-1 TO 1.
038800     SEARCH GRP-ENTRY VARYING IDX-1
038900         AT END
039000                GO TO CHECK-FAIL
039100         WHEN ENTRY-1 (IDX-1) = GRP-HOLD-AREA
039200                PERFORM PASS
039300                GO TO CHECK-WRITE.
039400 CHECK-DELETE.
039500     PERFORM DE-LETE.
039600     GO TO CHECK-WRITE.
039700 CHECK-FAIL.
039800     MOVE GRP-HOLD-AREA TO CORRECT-A.
039900     IF ENTRY-1 (SUB-2) EQUAL TO GRP-HOLD-AREA
040000         MOVE "IDX-1" TO END-IDX
040100         SET IDX-VALU TO IDX-1
040200         MOVE "SEE NOTE 1 FOR DIAGNOSTIC " TO RE-MARK
040300         MOVE END-STMT TO COMPUTED-A ELSE
040400     MOVE ENTRY-1 (SUB-2) TO COMPUTED-A
040500     MOVE "SEE NOTE 2 FOR DIAGNOSTIC " TO RE-MARK.
040600     PERFORM FAIL.
040700 CHECK-WRITE.
040800     PERFORM PRINT-DETAIL.
040900*
041000 TH1-INIT-F1-2.
041100     MOVE "TH1-TEST-F1-2" TO PAR-NAME.
041200     MOVE "VI-122 6.21" TO ANSI-REFERENCE.
041300     MOVE "SEARCH VARYING LEV 1" TO FEATURE.
041400     MOVE "GRP01" TO GRP-HOLD-AREA.
041500     MOVE 01 TO SUB-2.
041600     SET IDX-1-1 TO 1.
041700 TH1-TEST-F1-2.
041800     SEARCH GRP-ENTRY-1 VARYING IDX-1
041900         AT END GO TO TH1-FAIL-F1-2
042000         WHEN ENTRY-1-1 (IDX-1-1) = GRP-HOLD-AREA NEXT SENTENCE.
042100     PERFORM PASS
042200     GO TO TH1-WRITE-F1-2.
042300 TH1-DELETE-F1-2.
042400     PERFORM DE-LETE.
042500     GO TO TH1-WRITE-F1-2.
042600 TH1-FAIL-F1-2.
042700     PERFORM CHECK-FAIL.
042800 TH1-WRITE-F1-2.
042900     PERFORM PRINT-DETAIL.
043000*
043100 TH1-INIT-F1-3.
043200     MOVE "TH1-TEST-F1-3" TO PAR-NAME.
043300     MOVE "VI-122 6.21" TO ANSI-REFERENCE.
043400     MOVE "SEARCH VARYING LEV 1" TO FEATURE.
043500     MOVE "GRP10" TO GRP-HOLD-AREA.
043600     MOVE 10 TO SUB-2.
043700     SET IDX-1-1 TO 1.
043800 TH1-TEST-F1-3.
043900     SEARCH GRP-ENTRY-1 VARYING IDX-1-1
044000         AT END GO TO TH1-FAIL-F1-3
044100         WHEN ENTRY-1-1 (IDX-1-1) = GRP-HOLD-AREA NEXT SENTENCE.
044200     MOVE "SEARCH VARYING LEV 2" TO FEATURE.
044300     PERFORM PASS
044400     GO TO TH1-WRITE-F1-3.
044500 TH1-DELETE-F1-3.
044600     PERFORM DE-LETE.
044700     GO TO TH1-WRITE-F1-3.
044800 TH1-FAIL-F1-3.
044900     PERFORM CHECK-FAIL.
045000 TH1-WRITE-F1-3.
045100     PERFORM PRINT-DETAIL.
045200*
045300 TH1-INIT-F1-4.
045400     MOVE "TH1-TEST-F1-4" TO PAR-NAME.
045500     MOVE "VI-122 6.21" TO ANSI-REFERENCE.
045600     MOVE "SEARCH VARYING LEV 1" TO FEATURE.
045700     MOVE "GRP05" TO GRP-HOLD-AREA.
045800     MOVE 05 TO SUB-2.
045900     SET IDX-1-1 TO 05.
046000 TH1-TEST-F1-4.
046100     SEARCH GRP-ENTRY-1 VARYING IDX-1-1
046200         WHEN ENTRY-1-1 (IDX-1-1) = GRP-HOLD-AREA
046300             PERFORM PASS
046400             GO TO TH1-WRITE-F1-4.
046500     GO TO TH1-FAIL-F1-4.
046600 TH1-DELETE-F1-4.
046700     PERFORM DE-LETE.
046800     GO TO TH1-WRITE-F1-4.
046900 TH1-FAIL-F1-4.
047000     PERFORM CHECK-FAIL.
047100 TH1-WRITE-F1-4.
047200     PERFORM PRINT-DETAIL.
047300*
047400 TH2-INIT-F1-1.
047500     MOVE "SEARCH VARYING LEV 2" TO FEATURE.
047600     MOVE "VI-122 6.21" TO ANSI-REFERENCE.
047700     MOVE "TH2-TEST-F1-1" TO PAR-NAME.
047800     MOVE "SEC (01,01)" TO SEC-HOLD-AREA.
047900     MOVE  1 TO SUB-1  SUB-2.
048000     SET IDX-1-1 IDX-2-1 TO 1.
048100 TH2-TEST-F1-1.
048200     SEARCH GRP2-ENTRY-1 VARYING IDX-2-1 AT END
048300         GO TO TH2-FAIL-F1-1
048400         WHEN ENTRY-2-1 (IDX-1-1, IDX-2-1) = SEC-HOLD-AREA
048500             NEXT SENTENCE.
048600     PERFORM PASS
048700     GO TO TH2-WRITE-F1-1.
048800 TH2-DELETE-F1-1.
048900     PERFORM DE-LETE.
049000     GO TO TH2-WRITE-F1-1.
049100 TH2-FAIL-F1-1.
049200     PERFORM CHECK-FAIL2.
049300 TH2-WRITE-F1-1.
049400     PERFORM PRINT-DETAIL.
049500
049600*
049700 TH2-INIT-F1-2.
049800     MOVE "TH2-TEST-F1-2" TO PAR-NAME.
049900     MOVE "VI-122 6.21" TO ANSI-REFERENCE.
050000     MOVE "SEARCH VARYING LEV 2" TO FEATURE.
050100     MOVE "SEC (05,10)" TO SEC-HOLD-AREA.
050200     MOVE 05 TO SUB-1.
050300     MOVE 10 TO SUB-2.
050400     SET IDX-1-1 TO 5.
050500     SET IDX-2-1 TO 1.
050600 TH2-TEST-F1-2.
050700     SEARCH GRP2-ENTRY-1 VARYING IDX-2-1 AT END
050800         GO TO TH2-FAIL-F1-2
050900         WHEN ENTRY-2-1 (IDX-1-1, IDX-2-1) = SEC-HOLD-AREA
051000             NEXT SENTENCE.
051100     PERFORM PASS
051200     GO TO TH2-WRITE-F1-2.
051300 TH2-DELETE-F1-2.
051400     PERFORM DE-LETE.
051500     GO TO TH2-WRITE-F1-2.
051600 TH2-FAIL-F1-2.
051700     PERFORM CHECK-FAIL2.
051800 TH2-WRITE-F1-2.
051900     PERFORM PRINT-DETAIL.
052000*
052100 TH2-INIT-F1-3.
052200     MOVE "TH2-TEST-F1-3" TO PAR-NAME.
052300     MOVE "VI-122 6.21" TO ANSI-REFERENCE.
052400     MOVE "SEARCH VARYING LEV 2" TO FEATURE.
052500     MOVE "SEC (10,10)" TO SEC-HOLD-AREA.
052600     SET IDX-1-1 TO 10.
052700     SET IDX-2-1 TO 1.
052800     MOVE 10 TO SUB-1  SUB-2.
052900 TH2-TEST-F1-3.
053000     SEARCH GRP2-ENTRY-1 VARYING IDX-2-1 AT END
053100         GO TO TH2-FAIL-F1-3
053200         WHEN ENTRY-2-1 (IDX-1-1, IDX-2-1) = SEC-HOLD-AREA
053300             NEXT SENTENCE.
053400     PERFORM PASS
053500     GO TO TH2-WRITE-F1-3.
053600 TH2-DELETE-F1-3.
053700     PERFORM DE-LETE.
053800     GO TO TH2-WRITE-F1-3.
053900 TH2-FAIL-F1-3.
054000     PERFORM CHECK-FAIL2.
054100 TH2-WRITE-F1-3.
054200     PERFORM PRINT-DETAIL.
054300*
054400 TH2-INIT-F1-4.
054500     MOVE "TH2-TEST-F1-4" TO PAR-NAME.
054600     MOVE "VI-122 6.21" TO ANSI-REFERENCE.
054700     MOVE "SEARCH VARYING LEV 2" TO FEATURE.
054800     MOVE "SEC (08,02)" TO SEC-HOLD-AREA.
054900     MOVE 08 TO SUB-1.
055000     MOVE 02 TO SUB-2.
055100     SET IDX-1-1 TO 08.
055200     SET IDX-2-1 TO 01.
055300 TH2-TEST-F1-4.
055400     SEARCH GRP2-ENTRY-1 VARYING IDX-2-1
055500         WHEN ENTRY-2-1 (IDX-1-1, IDX-2-1) = SEC-HOLD-AREA
055600              PERFORM PASS
055700              GO TO TH2-WRITE-F1-4.
055800     GO TO TH2-FAIL-F1-4.
055900 TH2-DELETE-F1-4.
056000     PERFORM DE-LETE.
056100     GO TO TH2-WRITE-F1-4.
056200 TH2-FAIL-F1-4.
056300     PERFORM CHECK-FAIL2.
056400 TH2-WRITE-F1-4.
056500     PERFORM PRINT-DETAIL.
056600     GO TO TH3-INIT-F1-1.
056700
056800 CHECK-FAIL2.
056900     MOVE SEC-HOLD-AREA TO CORRECT-A.
057000     IF ENTRY-2-1 (SUB-1, SUB-2) EQUAL TO SEC-HOLD-AREA
057100         MOVE "IDX-2" TO END-IDX
057200         SET IDX-VALU TO IDX-2
057300         MOVE "SEE NOTE 1 FOR DIAGNOSTIC " TO RE-MARK
057400         MOVE END-STMT TO COMPUTED-A  ELSE
057500     MOVE ENTRY-2-1 (SUB-1, SUB-2) TO COMPUTED-A
057600     MOVE "SEE NOTE 2 FOR DIAGNOSTIC " TO RE-MARK.
057700     PERFORM FAIL.
057800*
057900 TH3-INIT-F1-1.
058000     MOVE "TH3-TEST-F1-1" TO PAR-NAME.
058100     MOVE "VI-122 6.21" TO ANSI-REFERENCE.
058200     MOVE "SEARCH VARYING LEV 3" TO FEATURE.
058300     MOVE 1 TO SUB-1  SUB-2  SUB-3.
058400     MOVE "ELEM (01,01,01)" TO ELEM-HOLD-AREA.
058500     SET IDX-1-1 IDX-2-1 IDX-3-1 TO 1.
058600 TH3-TEST-F1-1.
058700     SEARCH GRP3-ENTRY-1 VARYING IDX-3
058800         WHEN ENTRY-3-1 (IDX-1-1, IDX-2-1, IDX-3-1)
058900              = ELEM-HOLD-AREA
059000              PERFORM PASS
059100              GO TO TH3-WRITE-F1-1.
059200     GO TO TH3-FAIL-F1-1.
059300 TH3-DELETE-F1-1.
059400     PERFORM DE-LETE.
059500     GO TO TH3-WRITE-F1-1.
059600 TH3-FAIL-F1-1.
059700     PERFORM CHECK-FAIL3.
059800 TH3-WRITE-F1-1.
059900     PERFORM PRINT-DETAIL.
060000*
060100 TH3-INIT-F1-2.
060200     MOVE "TH3-TEST-F1-2" TO PAR-NAME.
060300     MOVE "VI-122 6.21" TO ANSI-REFERENCE.
060400     MOVE "SEARCH VARYING LEV 3" TO FEATURE.
060500     MOVE 05 TO SUB-1.
060600     MOVE 06 TO SUB-2.
060700     MOVE 07 TO SUB-3.
060800     SET IDX-1-1 TO 05.
060900     SET IDX-2-1 TO 06.
061000     SET IDX-3-1 TO 1.
061100     MOVE "ELEM (05,06,07)" TO ELEM-HOLD-AREA.
061200 TH3-TEST-F1-2.
061300     SEARCH GRP3-ENTRY-1 VARYING IDX-3-1 AT END
061400         GO TO TH3-FAIL-F1-2
061500         WHEN ENTRY-3-1 (IDX-1-1, IDX-2-1, IDX-3-1)
061600             = ELEM-HOLD-AREA
061700             NEXT SENTENCE.
061800     PERFORM PASS
061900     GO TO TH3-WRITE-F1-2.
062000 TH3-DELETE-F1-2.
062100     PERFORM DE-LETE.
062200     GO TO TH3-WRITE-F1-2.
062300 TH3-FAIL-F1-2.
062400     PERFORM CHECK-FAIL3.
062500 TH3-WRITE-F1-2.
062600     PERFORM PRINT-DETAIL.
062700*
062800 TH3-INIT-F1-3.
062900     MOVE "TH3-TEST-F1-3" TO PAR-NAME.
063000     MOVE "VI-122 6.21" TO ANSI-REFERENCE.
063100     MOVE "SEARCH VARYING LEV 3" TO FEATURE.
063200     MOVE 10 TO SUB-1 SUB-2 SUB-3.
063300     SET IDX-1-1 IDX-2-1 TO 10.
063400     SET IDX-3-1 TO 1.
063500     MOVE "ELEM (10,10,10)" TO ELEM-HOLD-AREA.
063600 TH3-TEST-F1-3.
063700     SEARCH GRP3-ENTRY-1 VARYING IDX-3-1 AT END
063800         GO TO TH3-FAIL-F1-3
063900         WHEN ENTRY-3-1 (IDX-1-1, IDX-2-1, IDX-3-1)
064000             = ELEM-HOLD-AREA
064100             NEXT SENTENCE.
064200     PERFORM PASS
064300     GO TO TH3-WRITE-F1-3.
064400 TH3-DELETE-F1-3.
064500     PERFORM DE-LETE.
064600     GO TO TH3-WRITE-F1-3.
064700 TH3-FAIL-F1-3.
064800     PERFORM CHECK-FAIL3.
064900 TH3-WRITE-F1-3.
065000     PERFORM PRINT-DETAIL.
065100*
065200 TH3-INIT-F1-4.
065300     MOVE "TH3-TEST-F1-4" TO PAR-NAME.
065400     MOVE "VI-122 6.21" TO ANSI-REFERENCE.
065500     MOVE "SEARCH VARYING LEV 3" TO FEATURE.
065600     MOVE "ELEM (07,06,05)" TO ELEM-HOLD-AREA.
065700     MOVE 07 TO SUB-1.
065800     MOVE 06 TO SUB-2.
065900     MOVE 05 TO SUB-3.
066000     SET IDX-1-1 TO 07.
066100     SET IDX-2-1 TO 06.
066200     SET IDX-3-1 TO 03.
066300 TH3-TEST-F1-4.
066400     SEARCH GRP3-ENTRY-1 VARYING IDX-3-1 AT END
066500         GO TO TH3-FAIL-F1-4
066600         WHEN ENTRY-3-1 (IDX-1-1, IDX-2-1, IDX-3-1)
066700         = ELEM-HOLD-AREA
066800         NEXT SENTENCE.
066900     PERFORM PASS
067000     GO TO TH3-WRITE-F1-4.
067100 TH3-DELETE-F1-4.
067200     PERFORM DE-LETE.
067300     GO TO TH3-WRITE-F1-4.
067400 TH3-FAIL-F1-4.
067500     PERFORM CHECK-FAIL3.
067600 TH3-WRITE-F1-4.
067700     PERFORM PRINT-DETAIL.
067800     GO TO MLT-INIT-F1-1.
067900*
068000 CHECK-FAIL3.
068100     MOVE ELEM-HOLD-AREA TO CORRECT-A.
068200     IF ENTRY-3-1 (SUB-1, SUB-2, SUB-3) EQUAL TO ELEM-HOLD-AREA
068300         MOVE "IDX-3-1" TO END-IDX
068400         SET IDX-VALU TO IDX-3-1
068500         MOVE "SEE NOTE 1 FOR DIAGNOSTIC " TO RE-MARK
068600         MOVE END-STMT TO COMPUTED-A ELSE
068700     MOVE ENTRY-3-1 (SUB-1, SUB-2, SUB-3) TO COMPUTED-A
068800     MOVE "SEE NOTE 2 FOR DIAGNOSTIC " TO RE-MARK.
068900     PERFORM FAIL.
069000*
069100 MLT-INIT-F1-1.
069200     MOVE "MLT-TEST-F1-1  " TO PAR-NAME.
069300     MOVE "VI-122 6.21" TO ANSI-REFERENCE.
069400     MOVE "MULTIPLE SEARCH STMT" TO FEATURE.
069500     MOVE "GRP08" TO GRP-HOLD-AREA.
069600     MOVE "SEC (08,07)" TO SEC-HOLD-AREA.
069700     SET IDX-1-1 IDX-2-1 TO 1.
069800 MLT-TEST-F1-1.
069900     SEARCH GRP-ENTRY-1 VARYING IDX-1-1
070000            AT END GO TO MLT-FAIL-F1-1-A
070100            WHEN ENTRY-1-1 (IDX-1-1) = "GRP08" NEXT SENTENCE.
070200     SEARCH GRP2-ENTRY-1 VARYING IDX-2-1
070300            AT END GO TO MLT-FAIL-F1-1-B
070400            WHEN ENTRY-2-1 (IDX-1-1, IDX-2-1) = SEC-HOLD-AREA
070500                 NEXT SENTENCE.
070600     PERFORM PASS
070700     GO TO MLT-WRITE-F1-1.
070800 MLT-DELETE-F1-1.
070900     PERFORM DE-LETE.
071000     GO TO MLT-WRITE-F1-1.
071100*
071200 MLT-FAIL-F1-1-A.
071300     MOVE GRP-HOLD-AREA TO CORRECT-A.
071400     IF ENTRY-1-1 (08) EQUAL TO GRP-HOLD-AREA
071500         MOVE "IDX-1-1" TO END-IDX
071600         MOVE "SEE NOTE 1 FOR DIAGNOSTIC " TO RE-MARK
071700         SET IDX-VALU TO IDX-1-1
071800         MOVE END-STMT TO COMPUTED-A ELSE
071900     MOVE ENTRY-1-1 (08) TO COMPUTED-A
072000     MOVE "SEE NOTE 2 FOR DIAGNOSTIC " TO RE-MARK.
072100     PERFORM FAIL
072200     GO TO MLT-WRITE-F1-1.
072300*
072400 MLT-FAIL-F1-1-B.
072500     MOVE SEC-HOLD-AREA TO CORRECT-A.
072600     IF ENTRY-2-1 (08, 07) EQUAL TO SEC-HOLD-AREA
072700         MOVE "IDX-2-1" TO END-IDX
072800         SET IDX-VALU TO IDX-2-1
072900         MOVE "SEE NOTE 1 FOR DIAGNOSTIC " TO RE-MARK
073000         MOVE END-STMT TO COMPUTED-A ELSE
073100     MOVE ENTRY-2-1 (08, 07) TO COMPUTED-A
073200     MOVE "SEE NOTE 2 FOR DIAGNOSTIC " TO RE-MARK.
073300     PERFORM FAIL.
073400 MLT-WRITE-F1-1.
073500     PERFORM PRINT-DETAIL.
073600*
073700 MLT-INIT-F1-2.
073800     MOVE "MLT-TEST-F1-2  " TO PAR-NAME.
073900     MOVE "VI-122 6.21" TO ANSI-REFERENCE.
074000     MOVE "MULTIPLE SEARCH STMT" TO FEATURE.
074100     MOVE "GRP04" TO GRP-HOLD-AREA.
074200     MOVE "SEC (04,04)" TO SEC-HOLD-AREA.
074300     MOVE "ELEM (04,04,04)" TO ELEM-HOLD-AREA.
074400     SET IDX-1-1 IDX-2-1 IDX-3-1 TO 1.
074500 MLT-TEST-F1-2.
074600     SEARCH GRP-ENTRY-1  VARYING IDX-1-1 AT END
074700         GO TO MLT-FAIL-F1-2-A WHEN ENTRY-1-1 (IDX-1-1) =
074800         GRP-HOLD-AREA  NEXT SENTENCE.
074900     SEARCH GRP2-ENTRY-1 VARYING IDX-2-1 AT END
075000         GO TO MLT-FAIL-F1-2-B WHEN ENTRY-2-1 (IDX-1-1, IDX-2-1) =
075100         SEC-HOLD-AREA  NEXT SENTENCE.
075200     SEARCH GRP3-ENTRY-1 VARYING IDX-3-1 AT END
075300         GO TO MLT-FAIL-F1-2-C WHEN ENTRY-3-1
075400             (IDX-1-1, IDX-2-1, IDX-3-1)
075500             = ELEM-HOLD-AREA NEXT SENTENCE.
075600     PERFORM PASS
075700     GO TO MLT-WRITE-F1-2.
075800 MLT-DELETE-F1-2.
075900     PERFORM DE-LETE
076000     GO TO MLT-WRITE-F1-2.
076100 MLT-FAIL-F1-2-A.
076200     MOVE GRP-HOLD-AREA TO CORRECT-A.
076300     IF ENTRY-1-1 (04) EQUAL TO GRP-HOLD-AREA
076400         MOVE "IDX-1-1" TO END-IDX
076500         MOVE "SEE NOTE 1 FOR DIAGNOSTIC " TO RE-MARK
076600         SET IDX-VALU TO IDX-1-1
076700         MOVE END-STMT TO COMPUTED-A ELSE
076800     MOVE ENTRY-1-1 (04) TO COMPUTED-A
076900     MOVE "SEE NOTE 2 FOR DIAGNOSTIC " TO RE-MARK.
077000     PERFORM FAIL.
077100     GO TO MLT-WRITE-F1-2.
077200
077300 MLT-FAIL-F1-2-B.
077400     MOVE  SEC-HOLD-AREA TO CORRECT-A.
077500     IF ENTRY-2-1 (04, 04) EQUAL TO SEC-HOLD-AREA
077600         MOVE "IDX-2-1" TO END-IDX
077700         MOVE "SEE NOTE 1 FOR DIAGNOSTIC " TO RE-MARK
077800         SET IDX-VALU TO IDX-2-1
077900         MOVE END-STMT TO COMPUTED-A ELSE
078000     MOVE ENTRY-2-1 (04, 04) TO COMPUTED-A
078100     MOVE "SEE NOTE 2 FOR DIAGNOSTIC " TO RE-MARK.
078200     PERFORM FAIL
078300     GO TO MLT-WRITE-F1-2.
078400
078500 MLT-FAIL-F1-2-C.
078600     MOVE ELEM-HOLD-AREA TO CORRECT-A.
078700     IF ENTRY-3-1 (04, 04, 04) EQUAL TO ELEM-HOLD-AREA
078800         MOVE "IDX-3-1" TO END-IDX
078900         MOVE "SEE NOTE 1 FOR DIAGNOSTIC " TO RE-MARK
079000         SET IDX-VALU TO IDX-3-1
079100         MOVE END-STMT TO COMPUTED-A ELSE
079200     MOVE ENTRY-3-1 (04, 04, 04) TO COMPUTED-A
079300     MOVE "SEE NOTE 2 FOR DIAGNOSTIC " TO RE-MARK.
079400     PERFORM FAIL.
079500 MLT-WRITE-F1-2.
079600     PERFORM PRINT-DETAIL.
079700*
079800 SPC-INIT-F1-1.
079900     MOVE "SPC-TEST-F1-1" TO PAR-NAME.
080000     MOVE "VI-122 6.21" TO ANSI-REFERENCE.
080100     MOVE "SEARCH WITH HI INDEX" TO FEATURE.
080200     SET IDX-1-1 TO 4.
080300 SPC-TEST-F1-1.
080400     SEARCH GRP-ENTRY-1 VARYING IDX-1-1
080500          AT END PERFORM PASS
080600                 GO TO SPC-WRITE-F1-1
080700          WHEN ENTRY-1-1 (IDX-1-1) = "GRP03"
080800                 GO TO SPC-FAIL-F1-1.
080900 SPC-DELETE-F1-1.
081000     PERFORM DE-LETE.
081100     GO TO SPC-WRITE-F1-1.
081200 SPC-FAIL-F1-1.
081300     MOVE SPACES TO CORRECT-A.
081400     MOVE ENTRY-1-1 (03) TO COMPUTED-A.
081500     MOVE SPACES TO RE-MARK.
081600     PERFORM FAIL.
081700 SPC-WRITE-F1-1.
081800     PERFORM PRINT-DETAIL.
081900*
082000 SP2-INIT-F1-1.
082100     MOVE "SP2-TEST-F1-1" TO PAR-NAME.
082200     MOVE "VI-122 6.21" TO ANSI-REFERENCE.
082300     MOVE "SEARCH WITH HI INDEX" TO FEATURE.
082400     SET IDX-1-1 TO 4.
082500     SET IDX-2-1 TO 5.
082600 SP2-TEST-F1-1.
082700     SEARCH GRP-ENTRY-1 VARYING IDX-1-1 AT END
082800         GO TO SP2-FAIL-F1-1-A
082900     WHEN ENTRY-1-1 (IDX-1-1) = "GRP04" NEXT SENTENCE.
083000     SET IDX-1-1 TO 4.
083100     SEARCH GRP2-ENTRY-1 VARYING IDX-2-1
083200         AT END PERFORM PASS
083300                GO TO SP2-WRITE-F1-1
083400     WHEN ENTRY-2-1 (IDX-1-1, IDX-2-1) = "SEC (04,04)"
083500         GO TO SP2-FAIL-F1-1-B.
083600 SP2-DELETE-F1-1.
083700     PERFORM DE-LETE.
083800     GO TO SP2-WRITE-F1-1.
083900 SP2-FAIL-F1-1-A.
084000     MOVE "GRP04" TO CORRECT-A.
084100     IF ENTRY-1-1 (04) EQUAL TO "GRP04"
084200         MOVE "IDX-2-1" TO END-IDX
084300         MOVE "SEE NOTE 1 FOR DIAGNOSTIC " TO RE-MARK
084400         SET IDX-VALU TO IDX-2-1
084500         MOVE END-STMT TO COMPUTED-A ELSE
084600     MOVE ENTRY-1-1 (04) TO COMPUTED-A
084700     MOVE "SEE NOTE 2 FOR DIAGNOSTIC " TO RE-MARK.
084800     PERFORM FAIL.
084900     GO TO SP2-WRITE-F1-1.
085000*
085100 SP2-FAIL-F1-1-B.
085200     MOVE ENTRY-2-1 (04, 04) TO COMPUTED-A.
085300     MOVE SPACES TO CORRECT-A.
085400     PERFORM FAIL.
085500 SP2-WRITE-F1-1.
085600     PERFORM PRINT-DETAIL.
085700*
085800 SP3-INIT-F1-1.
085900     MOVE "SP3-TEST-F1-1" TO PAR-NAME.
086000     MOVE "VI-122 6.21" TO ANSI-REFERENCE.
086100     MOVE "SEARCH WITH HI INDEX" TO FEATURE.
086200     SET IDX-1-1 TO 02.
086300 SP3-TEST-F1-1.
086400     SEARCH GRP-ENTRY-1 VARYING IDX-1-1
086500         AT END
086600                GO TO SP3-FAIL-F1-1-A
086700         WHEN ENTRY-1-1 (IDX-1-1) EQUAL TO "GRP02"
086800                NEXT SENTENCE.
086900     SET IDX-1-1 TO 02.
087000     SET IDX-2-1 TO 01.
087100     SEARCH GRP2-ENTRY-1 VARYING IDX-2-1
087200         AT END
087300                GO TO SP3-FAIL-F1-1-B
087400         WHEN ENTRY-2-1 (IDX-1-1, IDX-2-1) = "SEC (02,03)"
087500                NEXT SENTENCE.
087600     SET IDX-1-1 TO 02.
087700     SET IDX-2-1 TO 03.
087800     SET IDX-3-1 TO 05.
087900     SEARCH GRP3-ENTRY-1 VARYING IDX-3-1
088000         AT END PERFORM PASS
088100                GO TO SP3-WRITE-F1-1
088200         WHEN ENTRY-3-1 (IDX-1-1, IDX-2-1, IDX-3-1)
088300              = "ELEM (02,03,04)"
088400                GO TO SP3-FAIL-F1-1-C.
088500 SP3-DELETE-F1-1.
088600     PERFORM DE-LETE.
088700     GO TO SP3-WRITE-F1-1.
088800 SP3-FAIL-F1-1-A.
088900     MOVE "GRP02" TO CORRECT-A.
089000     IF ENTRY-1-1 (02) EQUAL TO "GRP02"
089100         MOVE "IDX-1-1" TO END-IDX
089200         MOVE "SEE NOTE 1 FOR DIAGNOSTIC " TO RE-MARK
089300         SET IDX-VALU TO IDX-1-1
089400         MOVE END-STMT TO COMPUTED-A ELSE
089500     MOVE ENTRY-1-1 (02) TO COMPUTED-A
089600     MOVE "SEE NOTE 2 FOR DIAGNOSTIC " TO RE-MARK.
089700     PERFORM FAIL.
089800     GO TO SP3-WRITE-F1-1.
089900*
090000 SP3-FAIL-F1-1-B.
090100     MOVE "SEC (02,03)" TO CORRECT-A.
090200     IF ENTRY-2-1 (02, 03) EQUAL TO "SEC (02,03)"
090300         MOVE "IDX-2-1"  TO END-IDX
090400         MOVE "SEE NOTE 1 FOR DIAGNOSTIC " TO RE-MARK
090500         SET IDX-VALU TO IDX-2-1
090600         MOVE END-STMT TO COMPUTED-A ELSE
090700     MOVE ENTRY-2-1 (02, 03) TO COMPUTED-A
090800     MOVE "SEE NOTE 2 FOR DIAGNOSTIC " TO RE-MARK.
090900     PERFORM FAIL.
091000     GO TO SP3-WRITE-F1-1.
091100*
091200 SP3-FAIL-F1-1-C.
091300     MOVE "INDEX SET HIGHER THAN ENTRY" TO RE-MARK
091400     MOVE SPACES TO CORRECT-A
091500     MOVE "ELEM (02,03,04)" TO COMPUTED-A
091600     PERFORM FAIL.
091700 SP3-WRITE-F1-1.
091800     PERFORM PRINT-DETAIL.
091900*
092000 CCVS-EXIT SECTION.
092100 CCVS-999999.
092200     GO TO CLOSE-FILES.
