000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST134A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*    ST134A DOES THE FOLLOWING ---
002200*          1. CREATES A FILE CONSISTING OF RECORDS WITH A KEY ITEM
002300*             AND TWO NON-KEY ITEMS. THIS CREATION OCCURS IN AN
002400*             INDEPENDENT SECTION OF THE PROGRAM.
002500*          2. SORTS THE FILE, EMPLOYING INPUT AND OUTPUT
002600*             PROCEDURES. THESE PROCEDURES ARE EQUIVALENT TO THE
002700*             PROCEDURES GENERATED BY USING AND GIVING CLAUSES.
002800*             THE SORTED FILE IS IN THE SAME SEQUENCE AS THE
002900*             ORIGINAL FILE.
003000*          3. SPOT-CHECKS THE RESULTS OF THE SORT IN ANOTHER
003100*             INDEPENDENT SECTION OF THE PROGRAM.
003200*    THE FILES SORTIN-2C AND SORTOUT-2C HAVE THE SAME RECORD AREA.
003300*    TEN RECORDS ARE SORTED. THE KEY ITEMS ARE SHOWN BELOW.
003400*
003500*        -100 -80  -60  -40  -20  ZERO +20  +40  +60  +80
003600
003700 ENVIRONMENT DIVISION.
003800 CONFIGURATION SECTION.
003900 SOURCE-COMPUTER.
004000     XXXXX082.
004100 OBJECT-COMPUTER.
004200     XXXXX083.
004300 INPUT-OUTPUT SECTION.
004400 FILE-CONTROL.
004500     SELECT PRINT-FILE ASSIGN TO
004600     XXXXX055.
004700     SELECT   SORTFILE-2D ASSIGN TO
004800     XXXXX027.
004900     SELECT   SORTIN-2D ASSIGN TO
005000     XXXXX001.
005100     SELECT   SORTOUT-2D ASSIGN TO
005200     XXXXX002.
005300 I-O-CONTROL.
005400     SAME RECORD AREA FOR
005500              SORTIN-2D
005600              SORTOUT-2D.
005700 DATA DIVISION.
005800 FILE SECTION.
005900 FD  PRINT-FILE.
006000 01  PRINT-REC PICTURE X(120).
006100 01  DUMMY-RECORD PICTURE X(120).
006200 SD  SORTFILE-2D
006300     DATA RECORD IS SORTFILE-REC.
006400 01  SORTFILE-REC.
006500     02 SORTFILE-NON-KEY-1        PICTURE X(60).
006600     02 SORTFILE-KEY              PICTURE S9(8) COMPUTATIONAL.
006700     02 SORTFILE-NON-KEY-2        PICTURE X(12).
006800 FD  SORTIN-2D
006900     LABEL RECORDS STANDARD
007000C    VALUE OF
007100C    XXXXX074
007200C    IS
007300C    XXXXX075
007400G    XXXXX069
007500     DATA RECORD IS SORTIN-REC.
007600 01  SORTIN-REC.
007700     02 SORTIN-NON-KEY-1          PICTURE X(60).
007800     02 SORTIN-KEY                PICTURE S9(8) COMPUTATIONAL.
007900     02 SORTIN-NON-KEY-2          PICTURE X(12).
008000 FD  SORTOUT-2D
008100     LABEL RECORDS STANDARD
008200C    VALUE OF
008300C    XXXXX074
008400C    IS
008500C    XXXXX076
008600G    XXXXX069
008700     DATA RECORD IS SORTOUT-REC.
008800 01  SORTOUT-REC.
008900     02 SORTOUT-NON-KEY-1         PICTURE X(60).
009000     02 SORTOUT-KEY               PICTURE S9(8) COMPUTATIONAL.
009100     02 SORTOUT-NON-KEY-2         PICTURE X(12).
009200 WORKING-STORAGE SECTION.
009300 77  UTIL-CTR           PICTURE S99999.
009400 01  LITERALS.
009500     02 SP-ACE          PICTURE X(14) VALUE "      (SPACES)".
009600     02 LITERAL-A       PICTURE X(60) VALUE "A
009700-    "                                       ".
009800     02 LITERAL-B       PICTURE X(12) VALUE "B           ".
009900 01  COMPUTED-BREAKDOWN.
010000     02 FIRST-20        PICTURE X(20).
010100     02 SECOND-20       PICTURE X(20).
010200     02 THIRD-20        PICTURE X(20).
010300 01  FILE-RECORD-INFORMATION-REC.
010400     03 FILE-RECORD-INFO-SKELETON.
010500        05 FILLER                 PICTURE X(48)       VALUE
010600             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
010700        05 FILLER                 PICTURE X(46)       VALUE
010800             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
010900        05 FILLER                 PICTURE X(26)       VALUE
011000             ",LFIL=000000,ORG=  ,LBLR= ".
011100        05 FILLER                 PICTURE X(37)       VALUE
011200             ",RECKEY=                             ".
011300        05 FILLER                 PICTURE X(38)       VALUE
011400             ",ALTKEY1=                             ".
011500        05 FILLER                 PICTURE X(38)       VALUE
011600             ",ALTKEY2=                             ".
011700        05 FILLER                 PICTURE X(7)        VALUE SPACE.
011800     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
011900        05 FILE-RECORD-INFO-P1-120.
012000           07 FILLER              PIC X(5).
012100           07 XFILE-NAME           PIC X(6).
012200           07 FILLER              PIC X(8).
012300           07 XRECORD-NAME         PIC X(6).
012400           07 FILLER              PIC X(1).
012500           07 REELUNIT-NUMBER     PIC 9(1).
012600           07 FILLER              PIC X(7).
012700           07 XRECORD-NUMBER       PIC 9(6).
012800           07 FILLER              PIC X(6).
012900           07 UPDATE-NUMBER       PIC 9(2).
013000           07 FILLER              PIC X(5).
013100           07 ODO-NUMBER          PIC 9(4).
013200           07 FILLER              PIC X(5).
013300           07 XPROGRAM-NAME        PIC X(5).
013400           07 FILLER              PIC X(7).
013500           07 XRECORD-LENGTH       PIC 9(6).
013600           07 FILLER              PIC X(7).
013700           07 CHARS-OR-RECORDS    PIC X(2).
013800           07 FILLER              PIC X(1).
013900           07 XBLOCK-SIZE          PIC 9(4).
014000           07 FILLER              PIC X(6).
014100           07 RECORDS-IN-FILE     PIC 9(6).
014200           07 FILLER              PIC X(5).
014300           07 XFILE-ORGANIZATION   PIC X(2).
014400           07 FILLER              PIC X(6).
014500           07 XLABEL-TYPE          PIC X(1).
014600        05 FILE-RECORD-INFO-P121-240.
014700           07 FILLER              PIC X(8).
014800           07 XRECORD-KEY          PIC X(29).
014900           07 FILLER              PIC X(9).
015000           07 ALTERNATE-KEY1      PIC X(29).
015100           07 FILLER              PIC X(9).
015200           07 ALTERNATE-KEY2      PIC X(29).
015300           07 FILLER              PIC X(7).
015400 01  TEST-RESULTS.
015500     02 FILLER                   PIC X      VALUE SPACE.
015600     02 FEATURE                  PIC X(20)  VALUE SPACE.
015700     02 FILLER                   PIC X      VALUE SPACE.
015800     02 P-OR-F                   PIC X(5)   VALUE SPACE.
015900     02 FILLER                   PIC X      VALUE SPACE.
016000     02  PAR-NAME.
016100       03 FILLER                 PIC X(19)  VALUE SPACE.
016200       03  PARDOT-X              PIC X      VALUE SPACE.
016300       03 DOTVALUE               PIC 99     VALUE ZERO.
016400     02 FILLER                   PIC X(8)   VALUE SPACE.
016500     02 RE-MARK                  PIC X(61).
016600 01  TEST-COMPUTED.
016700     02 FILLER                   PIC X(30)  VALUE SPACE.
016800     02 FILLER                   PIC X(17)  VALUE
016900            "       COMPUTED=".
017000     02 COMPUTED-X.
017100     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
017200     03 COMPUTED-N               REDEFINES COMPUTED-A
017300                                 PIC -9(9).9(9).
017400     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
017500     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
017600     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
017700     03       CM-18V0 REDEFINES COMPUTED-A.
017800         04 COMPUTED-18V0                    PIC -9(18).
017900         04 FILLER                           PIC X.
018000     03 FILLER PIC X(50) VALUE SPACE.
018100 01  TEST-CORRECT.
018200     02 FILLER PIC X(30) VALUE SPACE.
018300     02 FILLER PIC X(17) VALUE "       CORRECT =".
018400     02 CORRECT-X.
018500     03 CORRECT-A                  PIC X(20) VALUE SPACE.
018600     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
018700     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
018800     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
018900     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
019000     03      CR-18V0 REDEFINES CORRECT-A.
019100         04 CORRECT-18V0                     PIC -9(18).
019200         04 FILLER                           PIC X.
019300     03 FILLER PIC X(2) VALUE SPACE.
019400     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
019500 01  CCVS-C-1.
019600     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
019700-    "SS  PARAGRAPH-NAME
019800-    "       REMARKS".
019900     02 FILLER                     PIC X(20)    VALUE SPACE.
020000 01  CCVS-C-2.
020100     02 FILLER                     PIC X        VALUE SPACE.
020200     02 FILLER                     PIC X(6)     VALUE "TESTED".
020300     02 FILLER                     PIC X(15)    VALUE SPACE.
020400     02 FILLER                     PIC X(4)     VALUE "FAIL".
020500     02 FILLER                     PIC X(94)    VALUE SPACE.
020600 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
020700 01  REC-CT                        PIC 99       VALUE ZERO.
020800 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
020900 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
021000 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
021100 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
021200 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
021300 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
021400 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
021500 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
021600 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
021700 01  CCVS-H-1.
021800     02  FILLER                    PIC X(39)    VALUE SPACES.
021900     02  FILLER                    PIC X(42)    VALUE
022000     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
022100     02  FILLER                    PIC X(39)    VALUE SPACES.
022200 01  CCVS-H-2A.
022300   02  FILLER                        PIC X(40)  VALUE SPACE.
022400   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
022500   02  FILLER                        PIC XXXX   VALUE
022600     "4.2 ".
022700   02  FILLER                        PIC X(28)  VALUE
022800            " COPY - NOT FOR DISTRIBUTION".
022900   02  FILLER                        PIC X(41)  VALUE SPACE.
023000
023100 01  CCVS-H-2B.
023200   02  FILLER                        PIC X(15)  VALUE
023300            "TEST RESULT OF ".
023400   02  TEST-ID                       PIC X(9).
023500   02  FILLER                        PIC X(4)   VALUE
023600            " IN ".
023700   02  FILLER                        PIC X(12)  VALUE
023800     " HIGH       ".
023900   02  FILLER                        PIC X(22)  VALUE
024000            " LEVEL VALIDATION FOR ".
024100   02  FILLER                        PIC X(58)  VALUE
024200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024300 01  CCVS-H-3.
024400     02  FILLER                      PIC X(34)  VALUE
024500            " FOR OFFICIAL USE ONLY    ".
024600     02  FILLER                      PIC X(58)  VALUE
024700     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
024800     02  FILLER                      PIC X(28)  VALUE
024900            "  COPYRIGHT   1985 ".
025000 01  CCVS-E-1.
025100     02 FILLER                       PIC X(52)  VALUE SPACE.
025200     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
025300     02 ID-AGAIN                     PIC X(9).
025400     02 FILLER                       PIC X(45)  VALUE SPACES.
025500 01  CCVS-E-2.
025600     02  FILLER                      PIC X(31)  VALUE SPACE.
025700     02  FILLER                      PIC X(21)  VALUE SPACE.
025800     02 CCVS-E-2-2.
025900         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
026000         03 FILLER                   PIC X      VALUE SPACE.
026100         03 ENDER-DESC               PIC X(44)  VALUE
026200            "ERRORS ENCOUNTERED".
026300 01  CCVS-E-3.
026400     02  FILLER                      PIC X(22)  VALUE
026500            " FOR OFFICIAL USE ONLY".
026600     02  FILLER                      PIC X(12)  VALUE SPACE.
026700     02  FILLER                      PIC X(58)  VALUE
026800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
026900     02  FILLER                      PIC X(13)  VALUE SPACE.
027000     02 FILLER                       PIC X(15)  VALUE
027100             " COPYRIGHT 1985".
027200 01  CCVS-E-4.
027300     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
027400     02 FILLER                       PIC X(4)   VALUE " OF ".
027500     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
027600     02 FILLER                       PIC X(40)  VALUE
027700      "  TESTS WERE EXECUTED SUCCESSFULLY".
027800 01  XXINFO.
027900     02 FILLER                       PIC X(19)  VALUE
028000            "*** INFORMATION ***".
028100     02 INFO-TEXT.
028200       04 FILLER                     PIC X(8)   VALUE SPACE.
028300       04 XXCOMPUTED                 PIC X(20).
028400       04 FILLER                     PIC X(5)   VALUE SPACE.
028500       04 XXCORRECT                  PIC X(20).
028600     02 INF-ANSI-REFERENCE           PIC X(48).
028700 01  HYPHEN-LINE.
028800     02 FILLER  PIC IS X VALUE IS SPACE.
028900     02 FILLER  PIC IS X(65)    VALUE IS "************************
029000-    "*****************************************".
029100     02 FILLER  PIC IS X(54)    VALUE IS "************************
029200-    "******************************".
029300 01  CCVS-PGM-ID                     PIC X(9)   VALUE
029400     "ST134A".
029500 PROCEDURE DIVISION.
029600 CCVS1 SECTION.
029700 OPEN-FILES.
029800     OPEN    OUTPUT PRINT-FILE.
029900     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
030000     MOVE    SPACE TO TEST-RESULTS.
030100     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
030200     MOVE    ZERO TO REC-SKL-SUB.
030300     PERFORM CCVS-INIT-FILE 9 TIMES.
030400 CCVS-INIT-FILE.
030500     ADD     1 TO REC-SKL-SUB.
030600     MOVE    FILE-RECORD-INFO-SKELETON
030700          TO FILE-RECORD-INFO (REC-SKL-SUB).
030800 CCVS-INIT-EXIT.
030900     GO TO CCVS1-EXIT.
031000 CLOSE-FILES.
031100     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
031200 TERMINATE-CCVS.
031300S    EXIT PROGRAM.
031400STERMINATE-CALL.
031500     STOP     RUN.
031600 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
031700 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
031800 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
031900 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
032000     MOVE "****TEST DELETED****" TO RE-MARK.
032100 PRINT-DETAIL.
032200     IF REC-CT NOT EQUAL TO ZERO
032300             MOVE "." TO PARDOT-X
032400             MOVE REC-CT TO DOTVALUE.
032500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
032600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
032700        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
032800          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
032900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
033000     MOVE SPACE TO CORRECT-X.
033100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
033200     MOVE     SPACE TO RE-MARK.
033300 HEAD-ROUTINE.
033400     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033500     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033600     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
033700     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
033800 COLUMN-NAMES-ROUTINE.
033900     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034000     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
034200 END-ROUTINE.
034300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
034400 END-RTN-EXIT.
034500     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034600 END-ROUTINE-1.
034700      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
034800      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
034900      ADD PASS-COUNTER TO ERROR-HOLD.
035000*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
035100      MOVE PASS-COUNTER TO CCVS-E-4-1.
035200      MOVE ERROR-HOLD TO CCVS-E-4-2.
035300      MOVE CCVS-E-4 TO CCVS-E-2-2.
035400      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
035500  END-ROUTINE-12.
035600      MOVE "TEST(S) FAILED" TO ENDER-DESC.
035700     IF       ERROR-COUNTER IS EQUAL TO ZERO
035800         MOVE "NO " TO ERROR-TOTAL
035900         ELSE
036000         MOVE ERROR-COUNTER TO ERROR-TOTAL.
036100     MOVE     CCVS-E-2 TO DUMMY-RECORD.
036200     PERFORM WRITE-LINE.
036300 END-ROUTINE-13.
036400     IF DELETE-COUNTER IS EQUAL TO ZERO
036500         MOVE "NO " TO ERROR-TOTAL  ELSE
036600         MOVE DELETE-COUNTER TO ERROR-TOTAL.
036700     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
036800     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
036900      IF   INSPECT-COUNTER EQUAL TO ZERO
037000          MOVE "NO " TO ERROR-TOTAL
037100      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
037200      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
037300      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037400     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037500 WRITE-LINE.
037600     ADD 1 TO RECORD-COUNT.
037700Y    IF RECORD-COUNT GREATER 42
037800Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
037900Y        MOVE SPACE TO DUMMY-RECORD
038000Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
038100Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
038200Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
038300Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
038400Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
038500Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
038600Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
038700Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
038800Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
038900Y        MOVE ZERO TO RECORD-COUNT.
039000     PERFORM WRT-LN.
039100 WRT-LN.
039200     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
039300     MOVE SPACE TO DUMMY-RECORD.
039400 BLANK-LINE-PRINT.
039500     PERFORM WRT-LN.
039600 FAIL-ROUTINE.
039700     IF     COMPUTED-X NOT EQUAL TO SPACE
039800            GO TO   FAIL-ROUTINE-WRITE.
039900     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
040000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
040100     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
040200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040300     MOVE   SPACES TO INF-ANSI-REFERENCE.
040400     GO TO  FAIL-ROUTINE-EX.
040500 FAIL-ROUTINE-WRITE.
040600     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
040700     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
040800     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
040900     MOVE   SPACES TO COR-ANSI-REFERENCE.
041000 FAIL-ROUTINE-EX. EXIT.
041100 BAIL-OUT.
041200     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
041300     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
041400 BAIL-OUT-WRITE.
041500     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
041600     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
041700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041800     MOVE   SPACES TO INF-ANSI-REFERENCE.
041900 BAIL-OUT-EX. EXIT.
042000 CCVS1-EXIT.
042100     EXIT.
042200 MAIN-LINE SECTION.
042300 MAIN-LINE-INIT.
042400     PERFORM  CREATE-INPUT-FILE.
042500 SORT-PARAGRAPH.
042600     SORT     SORTFILE-2D ON ASCENDING
042700              SORTFILE-KEY
042800              INPUT PROCEDURE IS INPROC
042900              OUTPUT PROCEDURE IS OUTPROC.
043000 AFTER-SORT-PARA.
043100     PERFORM  SORT-TESTS.
043200     GO       TO CLOSE-AND-STOP.
043300 CREATE-INPUT-FILE SECTION.
043400 CREATE-INIT.
043500     OPEN     OUTPUT SORTIN-2D.
043600     MOVE     -100 TO UTIL-CTR.
043700 CREATE-LOOP.
043800     MOVE     UTIL-CTR TO SORTIN-KEY.
043900     MOVE     "A" TO SORTIN-NON-KEY-1.
044000     MOVE     "B" TO SORTIN-NON-KEY-2.
044100     WRITE    SORTIN-REC.
044200     ADD      20 TO UTIL-CTR.
044300     IF       UTIL-CTR LESS THAN +100 GO TO CREATE-LOOP.
044400     CLOSE    SORTIN-2D.
044500 INPROC SECTION.
044600 INPROC-INIT.
044700     OPEN     INPUT SORTIN-2D.
044800 INPROC-LOOP.
044900     READ     SORTIN-2D AT END GO TO INPROC-EXIT.
045000     MOVE     SORTIN-REC TO SORTFILE-REC.
045100     RELEASE   SORTFILE-REC.
045200     GO       TO INPROC-LOOP.
045300 INPROC-EXIT.
045400     CLOSE    SORTIN-2D.
045500 OUTPROC SECTION.
045600 OUTPROC-INIT.
045700     OPEN     OUTPUT SORTOUT-2D.
045800 OUTPROC-LOOP.
045900     RETURN   SORTFILE-2D AT END GO TO OUTPROC-EXIT.
046000     MOVE     SORTFILE-REC TO SORTOUT-REC.
046100     WRITE    SORTOUT-REC.
046200     GO       TO OUTPROC-LOOP.
046300 OUTPROC-EXIT.
046400     CLOSE    SORTOUT-2D.
046500 SORT-TESTS SECTION.
046600 SORT-INIT-A.
046700     MOVE     ZERO TO UTIL-CTR
046800     OPEN     INPUT SORTOUT-2D.
046900     MOVE     "SORT, SAME REC AREA" TO FEATURE.
047000     PERFORM PRINT-DETAIL-1.
047100 SORT-TEST-1.
047200     MOVE     "  COMP SORT KEY" TO FEATURE.
047300     MOVE     "SORT-TEST-1" TO PAR-NAME.
047400     PERFORM  READ-SORTOUT.
047500     IF       SORTOUT-KEY NOT EQUAL TO -100 GO TO SORT-FAIL-1.
047600     IF       SORTOUT-NON-KEY-1 NOT EQUAL TO LITERAL-A
047700              GO TO SORT-FAIL-1.
047800     IF       SORTOUT-NON-KEY-2 EQUAL TO LITERAL-B
047900              PERFORM PASS-1 GO TO SORT-WRITE-1.
048000 SORT-FAIL-1.
048100     MOVE     -100 TO CORRECT-N.
048200     PERFORM  BREAKDOWN-PARA.
048300 SORT-WRITE-1.
048400     PERFORM  PRINT-DETAIL-1.
048500 SORT-TEST-2.
048600     MOVE     "  COMP SORT KEY" TO FEATURE.
048700     MOVE     "SORT-TEST-2" TO PAR-NAME.
048800     PERFORM  READ-SORTOUT 5 TIMES.
048900     IF       SORTOUT-KEY NOT EQUAL TO ZERO GO TO SORT-FAIL-2.
049000     IF       SORTOUT-NON-KEY-1 NOT EQUAL TO LITERAL-A
049100              GO TO SORT-FAIL-2.
049200     IF       SORTOUT-NON-KEY-2 EQUAL TO LITERAL-B
049300              PERFORM PASS-1 GO TO SORT-WRITE-2.
049400 SORT-FAIL-2.
049500     MOVE     ZERO TO CORRECT-N.
049600     PERFORM  BREAKDOWN-PARA.
049700 SORT-WRITE-2.
049800     PERFORM  PRINT-DETAIL-1.
049900 SORT-TEST-3.
050000     MOVE     "  COMP SORT KEY" TO FEATURE.
050100     MOVE     "SORT-TEST-3" TO PAR-NAME.
050200     PERFORM  READ-SORTOUT 4 TIMES.
050300     IF       SORTOUT-KEY NOT EQUAL TO +80 GO TO SORT-FAIL-3.
050400     IF       SORTOUT-NON-KEY-1 NOT EQUAL TO LITERAL-A
050500              GO TO SORT-FAIL-3.
050600     IF       SORTOUT-NON-KEY-2 EQUAL TO LITERAL-B
050700              PERFORM PASS-1 GO TO SORT-WRITE-3.
050800 SORT-FAIL-3.
050900     MOVE     +80 TO CORRECT-N.
051000     PERFORM  BREAKDOWN-PARA.
051100 SORT-WRITE-3.
051200     PERFORM  PRINT-DETAIL-1.
051300 SORT-TEST-4.
051400     MOVE     "  COMP SORT KEY" TO FEATURE.
051500     MOVE     "SORT-TEST-4" TO PAR-NAME.
051600     READ     SORTOUT-2D AT END
051700              PERFORM PASS-1 GO TO SORT-WRITE-4.
051800 SORT-FAIL-4.
051900     MOVE     SPACE TO LITERALS.
052000     MOVE     "END OF FILE NOT FOUND" TO RE-MARK.
052100     PERFORM  PRINT-DETAIL-1.
052200     PERFORM  BREAKDOWN-PARA.
052300 SORT-WRITE-4.
052400     PERFORM  PRINT-DETAIL-1.
052500 SORT-EXIT.
052600     EXIT.
052700 CLOSE-AND-STOP SECTION.
052800 CLOSE-AND-STOP-PARA.
052900     CLOSE    SORTOUT-2D.
053000     GO TO CCVS-EXIT.
053100 INSPT-1. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
053200 PASS-1.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
053300 FAIL-1.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
053400 DE-LETE-1.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
053500     MOVE "****TEST DELETED****" TO RE-MARK.
053600 PRINT-DETAIL-1.
053700     IF REC-CT NOT EQUAL TO ZERO
053800             MOVE "." TO PARDOT-X
053900             MOVE REC-CT TO DOTVALUE.
054000     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE-1.
054100     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE-1
054200        PERFORM FAIL-ROUTINE-1 THRU FAIL-ROUTINE-EX-1
054300          ELSE PERFORM BAIL-OUT-1 THRU BAIL-OUT-EX-1.
054400     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
054500     MOVE SPACE TO CORRECT-X.
054600     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
054700     MOVE     SPACE TO RE-MARK.
054800 WRITE-LINE-1.
054900     ADD 1 TO RECORD-COUNT.
055000Y    IF RECORD-COUNT GREATER 50
055100Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
055200Y        MOVE SPACE TO DUMMY-RECORD
055300Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
055400Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN-1
055500Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN-1 2 TIMES
055600Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN-1
055700Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
055800Y        MOVE ZERO TO RECORD-COUNT.
055900     PERFORM WRT-LN-1.
056000 WRT-LN-1.
056100     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
056200     MOVE SPACE TO DUMMY-RECORD.
056300 BLANK-LINE-PRINT-1.
056400     PERFORM WRT-LN-1.
056500 FAIL-ROUTINE-1.
056600     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-1.
056700     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-1.
056800     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
056900     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-1 2 TIMES.
057000     GO TO FAIL-ROUTINE-EX-1.
057100 FAIL-RTN-WRITE-1.
057200     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE-1
057300     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE-1 2 TIMES.
057400 FAIL-ROUTINE-EX-1. EXIT.
057500 BAIL-OUT-1.
057600     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE-1.
057700     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX-1.
057800 BAIL-OUT-WRITE-1.
057900     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
058000     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-1 2 TIMES.
058100 BAIL-OUT-EX-1. EXIT.
058200 BREAKDOWN-PARA.
058300     MOVE     SORTOUT-KEY TO COMPUTED-N.
058400     PERFORM  FAIL-1.
058500     MOVE     "KEY AREA" TO RE-MARK.
058600     PERFORM  PRINT-DETAIL-1.
058700     MOVE     SPACE TO FEATURE.
058800     MOVE     SORTOUT-NON-KEY-1 TO COMPUTED-BREAKDOWN.
058900     MOVE     FIRST-20 TO COMPUTED-A.
059000     MOVE     LITERAL-A TO CORRECT-A.
059100     MOVE     "A 60-CHARACTER NON-KEY AREA" TO RE-MARK.
059200     PERFORM  PRINT-DETAIL-1.
059300     MOVE     SECOND-20 TO COMPUTED-A.
059400     MOVE     SP-ACE TO CORRECT-A.
059500     MOVE     "IS HERE SHOWN AS THREE" TO RE-MARK.
059600     PERFORM  PRINT-DETAIL-1.
059700     MOVE     THIRD-20 TO COMPUTED-A.
059800     MOVE     SP-ACE TO CORRECT-A.
059900     MOVE     "20-CHARACTER FIELDS." TO RE-MARK.
060000     PERFORM  PRINT-DETAIL-1.
060100     MOVE     SORTOUT-NON-KEY-2 TO COMPUTED-A.
060200     MOVE     LITERAL-B TO CORRECT-A.
060300     MOVE     "12-CHARACTER NON-KEY AREA" TO RE-MARK.
060400 READ-SORTOUT.
060500     READ     SORTOUT-2D AT END GO TO SORTOUT-ERROR.
060600     ADD      1 TO UTIL-CTR.
060700 SORTOUT-ERROR.
060800     MOVE     "SORTOUT-ERROR" TO PAR-NAME.
060900     PERFORM FAIL-1.
061000     MOVE     UTIL-CTR TO COMPUTED-N.
061100     MOVE     10 TO CORRECT-N.
061200     MOVE     "EOF PREMATURELY FOUND" TO RE-MARK.
061300     PERFORM  PRINT-DETAIL-1.
061400     GO TO    CLOSE-AND-STOP-PARA.
061500 CCVS-EXIT SECTION.
061600 CCVS-999999.
061700     GO TO CLOSE-FILES.
