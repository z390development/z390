000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ214A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    " HIGH       ".
000800*                                                              *
000900*    CREATION DATE     /     VALIDATION DATE                   *
001000*    "4.2 ".
001100*                                                              *
001200*
001300*
001400*    SQ214A TESTS OPERATIONS INVOLVING FORMAT 2 OCCURS CLAUSES,
001500*    I.E.  ...OCCURS INTEGER-1 TO INTEGER-2 TIMES DEPENDING ON
001600*          DATA-NAME-1 ....
001700*    X3.23-1976, PAGE III-4, 2.1.4(3) STATES, IN PART, THAT
001800*    INTEGER-2 REPRESENTS THE MAXIMUM NUMBER OF OCCURRENCES AND
001900*    THAT ONLY THE NUMBER OF OCCURRENCES, AND NOT THE ITEM LENGTH,
002000*    IS VARIABLE.  WHENEVER THE PARENT GROUP ITEM IS REFERENCED,
002100*    ONLY THE PORTION OF THE TABLE SPECIFIED BY THE CURRENT VALUE
002200*    OF DATA-NAME-1 WILL BE USED IN THE OPERATION.
002300*
002400*    THE FOLLOWING VERBS ARE EXERCIZED,
002500*        READ
002600*        WRITE
002700*
002800*
002900 ENVIRONMENT DIVISION.
003000 CONFIGURATION SECTION.
003100 SOURCE-COMPUTER.
003200     XXXXX082.
003300 OBJECT-COMPUTER.
003400     XXXXX083.
003500 INPUT-OUTPUT SECTION.
003600 FILE-CONTROL.
003700P    SELECT RAW-DATA   ASSIGN TO
003800P    XXXXX062
003900P           ORGANIZATION IS INDEXED
004000P           ACCESS MODE IS RANDOM
004100P           RECORD KEY IS RAW-DATA-KEY.
004200     SELECT PRINT-FILE ASSIGN TO
004300     XXXXX055.
004400     SELECT  SQ-FS1  ASSIGN TO
004500     XXXXX014.
004600 DATA DIVISION.
004700 FILE SECTION.
004800P
004900PFD  RAW-DATA.
005000P
005100P01  RAW-DATA-SATZ.
005200P    05  RAW-DATA-KEY        PIC X(6).
005300P    05  C-DATE              PIC 9(6).
005400P    05  C-TIME              PIC 9(8).
005500P    05  C-NO-OF-TESTS       PIC 99.
005600P    05  C-OK                PIC 999.
005700P    05  C-ALL               PIC 999.
005800P    05  C-FAIL              PIC 999.
005900P    05  C-DELETED           PIC 999.
006000P    05  C-INSPECT           PIC 999.
006100P    05  C-NOTE              PIC X(13).
006200P    05  C-INDENT            PIC X.
006300P    05  C-ABORT             PIC X(8).
006400 FD  PRINT-FILE
006500C    LABEL RECORDS
006600C    XXXXX084
006700C    DATA RECORD IS PRINT-REC DUMMY-RECORD
006800               .
006900 01  PRINT-REC PICTURE X(120).
007000 01  DUMMY-RECORD PICTURE X(120).
007100 FD  SQ-FS1
007200C    LABEL RECORD IS STANDARD
007300                .
007400 01  SQ-FS1R1-F-G-140.
007500     02 FS1R1-XN-120 PIC X(120).
007600     02  FS1R1-XN-20.
007700         03  FS1R1-XN-13  PIC X(13).
007800         03  FS1R1-XN-6   PIC X(6).
007900         03  FILLER       PIC X.
008000 WORKING-STORAGE SECTION.
008100 01  ODO-RECORD.
008200     02  FILLER PIC X(120).
008300     02  GRP-ODO.
008400         03  DOI-DU-01V00 PIC 9.
008500         03  ODO-XN-00009  PIC X(9).
008600         03  ODO-GRP-00009.
008700         04  ODO-XN-00001-O009D OCCURS 1 TO 9 TIMES DEPENDING ON
008800                 DOI-DU-01V00 ASCENDING KEY ODO-XN-00001-O009D
008900                 INDEXED BY ODO-IX PIC X.
009000 01  STATIC-VALUE.
009100     02  FILLER PIC 9 VALUE 9.
009200     02  FILLER PIC X(18) VALUE " ACTIVE: 123456789".
009300 01  WRK-GRP-00019.
009400     02  WRK-DU-01V00 PIC 9.
009500     02  WRK-XN-00009-1 PIC X(9).
009600     02  WRK-XN-00009-2 PIC X(9).
009700 01  WRK-GRP-00009.
009800     02  ODO-XN-00007  PIC X(7).
009900     02  ODO-XN-00002  PIC XX.
010000 01  WRK-GRP-00009A  REDEFINES  WRK-GRP-00009.
010100     02  ODO-XN-00005  PIC X(5).
010200     02  ODO-XN-00004  PIC X(4).
010300 01  WRK-DU-05V00 PIC 9(5).
010400 01  WRK-XN-00020 PIC X(20).
010500 01  WRK-XN-00010 PIC X(10).
010600 01  FILE-RECORD-INFORMATION-REC.
010700     03 FILE-RECORD-INFO-SKELETON.
010800        05 FILLER                 PICTURE X(48)       VALUE
010900             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
011000        05 FILLER                 PICTURE X(46)       VALUE
011100             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
011200        05 FILLER                 PICTURE X(26)       VALUE
011300             ",LFIL=000000,ORG=  ,LBLR= ".
011400        05 FILLER                 PICTURE X(37)       VALUE
011500             ",RECKEY=                             ".
011600        05 FILLER                 PICTURE X(38)       VALUE
011700             ",ALTKEY1=                             ".
011800        05 FILLER                 PICTURE X(38)       VALUE
011900             ",ALTKEY2=                             ".
012000        05 FILLER                 PICTURE X(7)        VALUE SPACE.
012100     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
012200        05 FILE-RECORD-INFO-P1-120.
012300           07 FILLER              PIC X(5).
012400           07 XFILE-NAME           PIC X(6).
012500           07 FILLER              PIC X(8).
012600           07 XRECORD-NAME         PIC X(6).
012700           07 FILLER              PIC X(1).
012800           07 REELUNIT-NUMBER     PIC 9(1).
012900           07 FILLER              PIC X(7).
013000           07 XRECORD-NUMBER       PIC 9(6).
013100           07 FILLER              PIC X(6).
013200           07 UPDATE-NUMBER       PIC 9(2).
013300           07 FILLER              PIC X(5).
013400           07 ODO-NUMBER          PIC 9(4).
013500           07 FILLER              PIC X(5).
013600           07 XPROGRAM-NAME        PIC X(5).
013700           07 FILLER              PIC X(7).
013800           07 XRECORD-LENGTH       PIC 9(6).
013900           07 FILLER              PIC X(7).
014000           07 CHARS-OR-RECORDS    PIC X(2).
014100           07 FILLER              PIC X(1).
014200           07 XBLOCK-SIZE          PIC 9(4).
014300           07 FILLER              PIC X(6).
014400           07 RECORDS-IN-FILE     PIC 9(6).
014500           07 FILLER              PIC X(5).
014600           07 XFILE-ORGANIZATION   PIC X(2).
014700           07 FILLER              PIC X(6).
014800           07 XLABEL-TYPE          PIC X(1).
014900        05 FILE-RECORD-INFO-P121-240.
015000           07 FILLER              PIC X(8).
015100           07 XRECORD-KEY          PIC X(29).
015200           07 FILLER              PIC X(9).
015300           07 ALTERNATE-KEY1      PIC X(29).
015400           07 FILLER              PIC X(9).
015500           07 ALTERNATE-KEY2      PIC X(29).
015600           07 FILLER              PIC X(7).
015700 01  TEST-RESULTS.
015800     02 FILLER                    PICTURE X VALUE SPACE.
015900     02 FEATURE                   PICTURE X(20) VALUE SPACE.
016000     02 FILLER                    PICTURE X VALUE SPACE.
016100     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
016200     02 FILLER                    PICTURE X  VALUE SPACE.
016300     02  PAR-NAME.
016400       03 FILLER PICTURE X(12) VALUE SPACE.
016500       03  PARDOT-X PICTURE X  VALUE SPACE.
016600       03 DOTVALUE PICTURE 99  VALUE ZERO.
016700       03 FILLER PIC X(5) VALUE SPACE.
016800     02 FILLER PIC X(10) VALUE SPACE.
016900     02 RE-MARK PIC X(61).
017000 01  TEST-COMPUTED.
017100     02 FILLER PIC X(30) VALUE SPACE.
017200     02 FILLER PIC X(17) VALUE "       COMPUTED=".
017300     02 COMPUTED-X.
017400     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
017500     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
017600     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
017700     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
017800     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
017900     03       CM-18V0 REDEFINES COMPUTED-A.
018000         04 COMPUTED-18V0                   PICTURE -9(18).
018100         04 FILLER                          PICTURE X.
018200     03 FILLER PIC X(50) VALUE SPACE.
018300 01  TEST-CORRECT.
018400     02 FILLER PIC X(30) VALUE SPACE.
018500     02 FILLER PIC X(17) VALUE "       CORRECT =".
018600     02 CORRECT-X.
018700     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
018800     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
018900     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
019000     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
019100     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
019200     03      CR-18V0 REDEFINES CORRECT-A.
019300         04 CORRECT-18V0                    PICTURE -9(18).
019400         04 FILLER                          PICTURE X.
019500     03 FILLER PIC X(50) VALUE SPACE.
019600 01  CCVS-C-1.
019700     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
019800-    "SS  PARAGRAPH-NAME
019900-    "        REMARKS".
020000     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
020100 01  CCVS-C-2.
020200     02 FILLER PICTURE IS X VALUE IS SPACE.
020300     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
020400     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
020500     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
020600     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
020700 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
020800 01  REC-CT PICTURE 99 VALUE ZERO.
020900 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
021000 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
021100 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
021200 01  PASS-COUNTER PIC 999 VALUE ZERO.
021300 01  TOTAL-ERROR PIC 999 VALUE ZERO.
021400 01  ERROR-HOLD PIC 999 VALUE ZERO.
021500 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
021600 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
021700 01  CCVS-H-1.
021800     02  FILLER   PICTURE X(27)  VALUE SPACE.
021900     02 FILLER PICTURE X(67) VALUE
022000     " FEDERAL SOFTWARE TESTING CENTER COBOL COMPILER VALIDATION
022100-    " SYSTEM".
022200     02  FILLER     PICTURE X(26)  VALUE SPACE.
022300 01  CCVS-H-2.
022400     02 FILLER PICTURE X(52) VALUE IS
022500     "CCVS85 FSTC COPY, NOT FOR DISTRIBUTION.".
022600     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
022700     02 TEST-ID PICTURE IS X(9).
022800     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
022900 01  CCVS-H-3.
023000     02  FILLER PICTURE X(34) VALUE
023100     " FOR OFFICIAL USE ONLY    ".
023200     02  FILLER PICTURE X(58) VALUE
023300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
023400     02  FILLER PICTURE X(28) VALUE
023500     "  COPYRIGHT   1985 ".
023600 01  CCVS-E-1.
023700     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
023800     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
023900     02 ID-AGAIN PICTURE IS X(9).
024000     02 FILLER PICTURE X(45) VALUE IS
024100     " NTIS DISTRIBUTION COBOL 85".
024200 01  CCVS-E-2.
024300     02  FILLER                   PICTURE X(31)  VALUE
024400     SPACE.
024500     02  FILLER                   PICTURE X(21)  VALUE SPACE.
024600     02 CCVS-E-2-2.
024700         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
024800         03 FILLER PICTURE IS X VALUE IS SPACE.
024900         03 ENDER-DESC PIC X(46) VALUE "ERRORS ENCOUNTERED".
025000 01  CCVS-E-3.
025100     02  FILLER PICTURE X(22) VALUE
025200     " FOR OFFICIAL USE ONLY".
025300     02  FILLER PICTURE X(12) VALUE SPACE.
025400     02  FILLER PICTURE X(58) VALUE
025500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025600     02  FILLER PICTURE X(13) VALUE SPACE.
025700     02 FILLER PIC X(15) VALUE " COPYRIGHT 1985".
025800 01  CCVS-E-4.
025900     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
026000     02 FILLER PIC XXXX VALUE " OF ".
026100     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
026200     02 FILLER PIC X(40) VALUE
026300      "  TESTS WERE EXECUTED SUCCESSFULLY".
026400 01  XXINFO.
026500     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
026600     02 INFO-TEXT.
026700     04 FILLER PIC X(20) VALUE SPACE.
026800     04 XXCOMPUTED PIC X(20).
026900     04 FILLER PIC X(5) VALUE SPACE.
027000     04 XXCORRECT PIC X(20).
027100 01  HYPHEN-LINE.
027200     02 FILLER PICTURE IS X VALUE IS SPACE.
027300     02 FILLER PICTURE IS X(65) VALUE IS "************************
027400-    "*****************************************".
027500     02 FILLER PICTURE IS X(54) VALUE IS "************************
027600-    "******************************".
027700 01  CCVS-PGM-ID PIC X(6) VALUE
027800     "SQ214A".
027900 PROCEDURE DIVISION.
028000 CCVS1 SECTION.
028100 OPEN-FILES.
028200P    OPEN I-O RAW-DATA.
028300P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
028400P    READ RAW-DATA INVALID KEY GO TO END-E-1.
028500P    MOVE "ABORTED " TO C-ABORT.
028600P    ADD 1 TO C-NO-OF-TESTS.
028700P    ACCEPT C-DATE  FROM DATE.
028800P    ACCEPT C-TIME  FROM TIME.
028900P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-1.
029000PEND-E-1.
029100P    CLOSE RAW-DATA.
029200     OPEN     OUTPUT PRINT-FILE.
029300     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
029400     MOVE    SPACE TO TEST-RESULTS.
029500     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
029600     MOVE ZERO TO REC-SKL-SUB.
029700     PERFORM CCVS-INIT-FILE 9 TIMES.
029800 CCVS-INIT-FILE.
029900     ADD 1 TO REC-SKL-SUB.
030000     MOVE FILE-RECORD-INFO-SKELETON TO
030100                  FILE-RECORD-INFO (REC-SKL-SUB).
030200 CCVS-INIT-EXIT.
030300     GO TO CCVS1-EXIT.
030400 CLOSE-FILES.
030500     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
030600P    OPEN I-O RAW-DATA.
030700P    MOVE CCVS-PGM-ID TO RAW-DATA-KEY.
030800P    READ RAW-DATA INVALID KEY GO TO END-E-2.
030900P    MOVE "OK.     " TO C-ABORT.
031000P    MOVE PASS-COUNTER TO C-OK.
031100P    MOVE ERROR-HOLD   TO C-ALL.
031200P    MOVE ERROR-COUNTER TO C-FAIL.
031300P    MOVE DELETE-CNT TO C-DELETED.
031400P    MOVE INSPECT-COUNTER TO C-INSPECT.
031500P    REWRITE RAW-DATA-SATZ INVALID KEY GO TO END-E-2.
031600PEND-E-2.
031700P    CLOSE RAW-DATA.
031800 TERMINATE-CCVS.
031900S    EXIT PROGRAM.
032000STERMINATE-CALL.
032100     STOP     RUN.
032200 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
032300 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
032400 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
032500 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
032600     MOVE "****TEST DELETED****" TO RE-MARK.
032700 PRINT-DETAIL.
032800     IF REC-CT NOT EQUAL TO ZERO
032900             MOVE "." TO PARDOT-X
033000             MOVE REC-CT TO DOTVALUE.
033100     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
033200     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
033300        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
033400          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
033500     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
033600     MOVE SPACE TO CORRECT-X.
033700     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
033800     MOVE     SPACE TO RE-MARK.
033900 HEAD-ROUTINE.
034000     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034100     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
034200     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
034300 COLUMN-NAMES-ROUTINE.
034400     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034500     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
034700 END-ROUTINE.
034800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
034900 END-RTN-EXIT.
035000     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035100 END-ROUTINE-1.
035200      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
035300      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
035400      ADD PASS-COUNTER TO ERROR-HOLD.
035500*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
035600      MOVE PASS-COUNTER TO CCVS-E-4-1.
035700      MOVE ERROR-HOLD TO CCVS-E-4-2.
035800      MOVE CCVS-E-4 TO CCVS-E-2-2.
035900      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
036000  END-ROUTINE-12.
036100      MOVE "TEST(S) FAILED" TO ENDER-DESC.
036200     IF       ERROR-COUNTER IS EQUAL TO ZERO
036300         MOVE "NO " TO ERROR-TOTAL
036400         ELSE
036500         MOVE ERROR-COUNTER TO ERROR-TOTAL.
036600     MOVE     CCVS-E-2 TO DUMMY-RECORD.
036700     PERFORM WRITE-LINE.
036800 END-ROUTINE-13.
036900     IF DELETE-CNT IS EQUAL TO ZERO
037000         MOVE "NO " TO ERROR-TOTAL  ELSE
037100         MOVE DELETE-CNT TO ERROR-TOTAL.
037200     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
037300     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037400      IF   INSPECT-COUNTER EQUAL TO ZERO
037500          MOVE "NO " TO ERROR-TOTAL
037600      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
037700      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
037800      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037900     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038000 WRITE-LINE.
038100     ADD 1 TO RECORD-COUNT.
038200Y    IF RECORD-COUNT GREATER 50
038300Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
038400Y        MOVE SPACE TO DUMMY-RECORD
038500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
038600Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
038700Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
038800Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
038900Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
039000Y        MOVE ZERO TO RECORD-COUNT.
039100     PERFORM WRT-LN.
039200 WRT-LN.
039300     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
039400     MOVE SPACE TO DUMMY-RECORD.
039500 BLANK-LINE-PRINT.
039600     PERFORM WRT-LN.
039700 FAIL-ROUTINE.
039800     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
039900     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
040000     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
040100     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040200     GO TO FAIL-ROUTINE-EX.
040300 FAIL-ROUTINE-WRITE.
040400     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
040500     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
040600 FAIL-ROUTINE-EX. EXIT.
040700 BAIL-OUT.
040800     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
040900     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
041000 BAIL-OUT-WRITE.
041100     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
041200     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041300 BAIL-OUT-EX. EXIT.
041400 CCVS1-EXIT.
041500     EXIT.
041600 BEGIN-SQ214A-TESTS SECTION.
041700 WRITE-INIT-GF-01.
041800     MOVE STATIC-VALUE TO WRK-GRP-00019.
041900     MOVE 9 TO DOI-DU-01V00.
042000     MOVE " ACTIVE: " TO ODO-XN-00009.
042100     MOVE "1" TO ODO-XN-00001-O009D (1).
042200     MOVE "2" TO ODO-XN-00001-O009D (2).
042300     MOVE "3" TO ODO-XN-00001-O009D (3).
042400     MOVE "4" TO ODO-XN-00001-O009D (4).
042500     MOVE "5" TO ODO-XN-00001-O009D (5).
042600     MOVE "6" TO ODO-XN-00001-O009D (6).
042700     MOVE "7" TO ODO-XN-00001-O009D (7).
042800     MOVE "8" TO ODO-XN-00001-O009D (8).
042900     MOVE "9" TO ODO-XN-00001-O009D (9).
043000 WRITE-SQ-FS1 SECTION.
043100 WRITE-SQ-FS1-PARA1.
043200     OPEN OUTPUT SQ-FS1.
043300     MOVE "SQ-FS1" TO XFILE-NAME (1).
043400     MOVE "FS1R1 " TO XRECORD-NAME (1).
043500     MOVE "SQ214"  TO XPROGRAM-NAME (1).
043600     MOVE 140 TO XRECORD-LENGTH (1).
043700     MOVE "1R" TO CHARS-OR-RECORDS (1).
043800     MOVE 4000 TO RECORDS-IN-FILE (1).
043900     MOVE "SQ" TO XFILE-ORGANIZATION (1).
044000     MOVE "S" TO XLABEL-TYPE (1).
044100     MOVE 1 TO XRECORD-NUMBER (1).
044200     MOVE 3 TO ODO-NUMBER (1).
044300     MOVE FILE-RECORD-INFO-P1-120 (1) TO ODO-RECORD.
044400     PERFORM WRITE-INIT-GF-01.
044500     MOVE 3 TO DOI-DU-01V00.
044600     WRITE SQ-FS1R1-F-G-140 FROM ODO-RECORD.
044700     MOVE 2 TO XRECORD-NUMBER (1).
044800     MOVE 7 TO ODO-NUMBER (1).
044900     MOVE FILE-RECORD-INFO-P1-120 (1) TO ODO-RECORD.
045000     PERFORM WRITE-INIT-GF-01.
045100     MOVE 7 TO DOI-DU-01V00.
045200     WRITE SQ-FS1R1-F-G-140 FROM ODO-RECORD.
045300     PERFORM WRITE-SQ-FS1-PARA2 VARYING ODO-IX FROM 3 BY 1
045400         UNTIL ODO-IX IS GREATER THAN 4000.
045500     GO TO WRITE-SQ-FS1-PARA3.
045600 WRITE-SQ-FS1-PARA2.
045700     SET XRECORD-NUMBER (1) TO ODO-IX.
045800     MOVE 9 TO ODO-NUMBER (1).
045900     MOVE FILE-RECORD-INFO-P1-120 (1) TO ODO-RECORD.
046000     PERFORM WRITE-INIT-GF-01.
046100     WRITE SQ-FS1R1-F-G-140 FROM ODO-RECORD.
046200 WRITE-SQ-FS1-PARA3.
046300     CLOSE SQ-FS1.
046400     OPEN INPUT SQ-FS1.
046500     MOVE "OCCURS DEPENDING ON" TO FEATURE.
046600 END-OF-WRITE-SQ-FS1 SECTION.
046700 WRITE-TEST-GF-01.
046800     MOVE SPACES TO SQ-FS1R1-F-G-140.
046900     READ SQ-FS1 AT END GO TO WRITE-DELETE-GF-01.
047000     IF FS1R1-XN-13     IS EQUAL TO "3 ACTIVE: 123" AND
047100        FS1R1-XN-6  IS NOT EQUAL TO "456789"
047200         PERFORM PASS
047300         ELSE
047400         PERFORM FAIL
047500       MOVE "VI-26 OCCURS & VII-44 READ / VII-52 WRITE" TO RE-MARK
047600         MOVE "3 ACTIVE: 123" TO CORRECT-A
047700         MOVE FS1R1-XN-20 TO COMPUTED-A.
047800     GO TO WRITE-WRITE-GF-01.
047900 WRITE-DELETE-GF-01.
048000     PERFORM DE-LETE.
048100 WRITE-WRITE-GF-01.
048200     MOVE "WRITE-TEST-GF-01" TO PAR-NAME.
048300     MOVE "WRITE FROM PARTIAL ODO" TO RE-MARK.
048400     PERFORM PRINT-DETAIL.
048500 READ-TEST-GF-01.
048600     MOVE SPACES TO SQ-FS1R1-F-G-140.
048700     MOVE 9 TO DOI-DU-01V00.
048800     MOVE SPACES TO ODO-RECORD.
048900     MOVE 9 TO DOI-DU-01V00.
049000     READ SQ-FS1 INTO ODO-RECORD AT END GO TO READ-DELETE-GF-01.
049100     MOVE 9 TO DOI-DU-01V00.
049200     MOVE ODO-GRP-00009 TO WRK-GRP-00009.
049300     IF ODO-XN-00007 IS EQUAL TO "1234567"  AND
049400        ODO-XN-00002 IS NOT EQUAL TO "89"
049500         PERFORM PASS
049600         ELSE
049700       MOVE "VI-26 OCCURS & VII-44 READ / VII-52 WRITE" TO RE-MARK
049800         PERFORM FAIL
049900         MOVE "1234567" TO CORRECT-A
050000         MOVE ODO-GRP-00009 TO COMPUTED-A.
050100     GO TO READ-WRITE-GF-01.
050200 READ-DELETE-GF-01.
050300     PERFORM DE-LETE.
050400 READ-WRITE-GF-01.
050500     MOVE "READ-TEST-GF-01" TO PAR-NAME.
050600     MOVE "READ PARTIAL ODO INTO FULL ODO" TO RE-MARK.
050700     PERFORM PRINT-DETAIL.
050800 WRITE-TEST-GF-02.
050900     MOVE SPACES TO SQ-FS1R1-F-G-140.
051000     READ SQ-FS1 AT END GO TO WRITE-DELETE-GF-02.
051100     IF FS1R1-XN-20     IS EQUAL TO "9 ACTIVE: 123456789"
051200         PERFORM PASS
051300         ELSE
051400       MOVE "VI-26 OCCURS & VII-44 READ / VII-52 WRITE" TO RE-MARK
051500         PERFORM FAIL
051600         MOVE "9 ACTIVE: 123456789" TO CORRECT-A
051700         MOVE FS1R1-XN-20     TO COMPUTED-A.
051800     GO TO WRITE-WRITE-GF-02.
051900 WRITE-DELETE-GF-02.
052000     PERFORM DE-LETE.
052100 WRITE-WRITE-GF-02.
052200     MOVE "WRITE-TEST-GF-02" TO PAR-NAME.
052300     MOVE "WRITE FROM FULL ODO" TO RE-MARK.
052400     PERFORM PRINT-DETAIL.
052500 READ-TEST-GF-02.
052600     MOVE 9 TO DOI-DU-01V00.
052700     MOVE SPACES TO SQ-FS1R1-F-G-140   ODO-RECORD.
052800     MOVE 9 TO DOI-DU-01V00.
052900     READ SQ-FS1 INTO ODO-RECORD AT END GO TO READ-DELETE-GF-02.
053000     IF GRP-ODO IS EQUAL TO "9 ACTIVE: 123456789"
053100         PERFORM PASS
053200         ELSE
053300       MOVE "VI-26 OCCURS & VII-44 READ / VII-52 WRITE" TO RE-MARK
053400         PERFORM FAIL
053500         MOVE "9 ACTIVE: 123456789" TO CORRECT-A
053600         MOVE GRP-ODO TO COMPUTED-A.
053700     GO TO READ-WRITE-GF-02.
053800 READ-DELETE-GF-02.
053900     PERFORM DE-LETE.
054000 READ-WRITE-GF-02.
054100     MOVE "READ-TEST-GF-02" TO PAR-NAME.
054200     MOVE "READ FULL ODO INTO FULL ODO" TO RE-MARK.
054300     PERFORM PRINT-DETAIL.
054400 READ-TEST-GF-03.
054500     MOVE 9 TO DOI-DU-01V00.
054600     MOVE SPACES TO SQ-FS1R1-F-G-140   ODO-RECORD.
054700     MOVE 5 TO DOI-DU-01V00.
054800     READ SQ-FS1 INTO ODO-RECORD AT END GO TO READ-DELETE-GF-03.
054900     MOVE 9 TO DOI-DU-01V00.
055000     MOVE ODO-GRP-00009 TO WRK-GRP-00009.
055100     IF ODO-XN-00005 IS EQUAL TO "12345"  AND
055200        ODO-XN-00004 IS EQUAL TO "6789"
055300         PERFORM PASS
055400         ELSE
055500       MOVE "VI-28 OCCURS & VII-44 READ / VII-52 WRITE" TO RE-MARK
055600         PERFORM FAIL
055700         MOVE "123456789" TO CORRECT-A
055800         MOVE ODO-GRP-00009 TO COMPUTED-A.
055900     GO TO READ-WRITE-GF-03.
056000 READ-DELETE-GF-03.
056100     PERFORM DE-LETE.
056200 READ-WRITE-GF-03.
056300     MOVE "READ-TEST-GF-03" TO PAR-NAME.
056400     MOVE "READ FULL ODO INTO PARTIAL ODO" TO RE-MARK.
056500     PERFORM PRINT-DETAIL.
056600 END-OF-SQ214A-TESTS.
056700     CLOSE SQ-FS1.
056800 CCVS-EXIT SECTION.
056900 CCVS-999999.
057000     GO TO CLOSE-FILES.
