000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RL210A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*    THE FUNCTION OF THIS PROGRAM IS TO CREATE A RELATIVE FILE *
001400*    SEQUENTIALLY WITH VARIABLE LENGTH RECORDS AND VERIFY THAT *
001500*    IT WAS CREATED CORRECTLY.                                 *
001600*    THE PROGRAM WILL CREATE A RELATIVE FILE OF 500 VARIABLE   *
001700*    LENGTH RECORDS.                                           *
001800*    THE RECORD SIZE WILL BE 120 TO 140 CHARACTERS.            *
001900*
002000*            X-CARD PARAMETERS WHICH MUST BE SUPPLIED FOR THIS
002100*            PROGRAM ARE:
002200*
002300*                 X-21   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR
002400*                         RELATIVE  I-O DATA FILE
002500*                 X-55   SYSTEM PRINTER
002600*                 X-69   ADDITIONAL VALUE OF CLAUSES
002700*                 X-74   VALUE OF IMPLEMENTOR-NAME
002800*                 X-75   OBJECT OF VALUE OF CLAUSE
002900*                 X-82   SOURCE-COMPUTER
003000*                 X-83   OBJECT-COMPUTER.
003100*
003200****************************************************************
003300 ENVIRONMENT DIVISION.
003400 CONFIGURATION SECTION.
003500 SOURCE-COMPUTER.
003600     XXXXX082.
003700 OBJECT-COMPUTER.
003800     XXXXX083.
003900 INPUT-OUTPUT SECTION.
004000 FILE-CONTROL.
004100     SELECT PRINT-FILE ASSIGN TO
004200     XXXXX055.
004300     SELECT   RL-VS1 ASSIGN TO
004400     XXXXP021
004500             ORGANIZATION IS RELATIVE.
004600*    ABSENCE OF THE ACCESS CLAUSE IS TREATED AS THOUGH
004700*     SEQUENTIAL HAD BEEN SPECIFIED.
004800 DATA DIVISION.
004900 FILE SECTION.
005000 FD  PRINT-FILE.
005100 01  PRINT-REC PICTURE X(120).
005200 01  DUMMY-RECORD PICTURE X(120).
005300 FD  RL-VS1
005400     LABEL RECORDS STANDARD
005500C    VALUE OF
005600C    XXXXX074
005700C    IS
005800C    XXXXX075
005900G    XXXXX069
006000     BLOCK CONTAINS 1 RECORDS
006100     RECORD IS VARYING.
006200 01  RL-VS1R2-F-G-140.
006300     02  FILLER PIC X(120).
006400     02  RL-VS1R2-F-G-121-124  PIC 9(4).
006500     02  RL-GROUP.
006600      03 RL-VS1R2-F-G-125-140  PIC X  OCCURS 1 TO 16
006700                               DEPENDING ON RL-VS1R2-F-G-121-124.
006800 01  RL-VS1R1-F-G-120.
006900     02 FILLER PIC X(120).
007000 WORKING-STORAGE SECTION.
007100 01  WRK-CS-09V00 PIC S9(9) USAGE COMP VALUE ZERO.
007200 01  FILE-RECORD-INFORMATION-REC.
007300     03 FILE-RECORD-INFO-SKELETON.
007400        05 FILLER                 PICTURE X(48)       VALUE
007500             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
007600        05 FILLER                 PICTURE X(46)       VALUE
007700             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
007800        05 FILLER                 PICTURE X(26)       VALUE
007900             ",LFIL=000000,ORG=  ,LBLR= ".
008000        05 FILLER                 PICTURE X(37)       VALUE
008100             ",RECKEY=                             ".
008200        05 FILLER                 PICTURE X(38)       VALUE
008300             ",ALTKEY1=                             ".
008400        05 FILLER                 PICTURE X(38)       VALUE
008500             ",ALTKEY2=                             ".
008600        05 FILLER                 PICTURE X(7)        VALUE SPACE.
008700     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
008800        05 FILE-RECORD-INFO-P1-120.
008900           07 FILLER              PIC X(5).
009000           07 XFILE-NAME           PIC X(6).
009100           07 FILLER              PIC X(8).
009200           07 XRECORD-NAME         PIC X(6).
009300           07 FILLER              PIC X(1).
009400           07 REELUNIT-NUMBER     PIC 9(1).
009500           07 FILLER              PIC X(7).
009600           07 XRECORD-NUMBER       PIC 9(6).
009700           07 FILLER              PIC X(6).
009800           07 UPDATE-NUMBER       PIC 9(2).
009900           07 FILLER              PIC X(5).
010000           07 ODO-NUMBER          PIC 9(4).
010100           07 FILLER              PIC X(5).
010200           07 XPROGRAM-NAME        PIC X(5).
010300           07 FILLER              PIC X(7).
010400           07 XRECORD-LENGTH       PIC 9(6).
010500           07 FILLER              PIC X(7).
010600           07 CHARS-OR-RECORDS    PIC X(2).
010700           07 FILLER              PIC X(1).
010800           07 XBLOCK-SIZE          PIC 9(4).
010900           07 FILLER              PIC X(6).
011000           07 RECORDS-IN-FILE     PIC 9(6).
011100           07 FILLER              PIC X(5).
011200           07 XFILE-ORGANIZATION   PIC X(2).
011300           07 FILLER              PIC X(6).
011400           07 XLABEL-TYPE          PIC X(1).
011500        05 FILE-RECORD-INFO-P121-240.
011600           07 FILLER              PIC X(8).
011700           07 XRECORD-KEY          PIC X(29).
011800           07 FILLER              PIC X(9).
011900           07 ALTERNATE-KEY1      PIC X(29).
012000           07 FILLER              PIC X(9).
012100           07 ALTERNATE-KEY2      PIC X(29).
012200           07 FILLER              PIC X(7).
012300 01  TEST-RESULTS.
012400     02 FILLER                   PIC X      VALUE SPACE.
012500     02 FEATURE                  PIC X(20)  VALUE SPACE.
012600     02 FILLER                   PIC X      VALUE SPACE.
012700     02 P-OR-F                   PIC X(5)   VALUE SPACE.
012800     02 FILLER                   PIC X      VALUE SPACE.
012900     02  PAR-NAME.
013000       03 FILLER                 PIC X(19)  VALUE SPACE.
013100       03  PARDOT-X              PIC X      VALUE SPACE.
013200       03 DOTVALUE               PIC 99     VALUE ZERO.
013300     02 FILLER                   PIC X(8)   VALUE SPACE.
013400     02 RE-MARK                  PIC X(61).
013500 01  TEST-COMPUTED.
013600     02 FILLER                   PIC X(30)  VALUE SPACE.
013700     02 FILLER                   PIC X(17)  VALUE
013800            "       COMPUTED=".
013900     02 COMPUTED-X.
014000     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
014100     03 COMPUTED-N               REDEFINES COMPUTED-A
014200                                 PIC -9(9).9(9).
014300     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
014400     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
014500     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
014600     03       CM-18V0 REDEFINES COMPUTED-A.
014700         04 COMPUTED-18V0                    PIC -9(18).
014800         04 FILLER                           PIC X.
014900     03 FILLER PIC X(50) VALUE SPACE.
015000 01  TEST-CORRECT.
015100     02 FILLER PIC X(30) VALUE SPACE.
015200     02 FILLER PIC X(17) VALUE "       CORRECT =".
015300     02 CORRECT-X.
015400     03 CORRECT-A                  PIC X(20) VALUE SPACE.
015500     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
015600     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
015700     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
015800     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
015900     03      CR-18V0 REDEFINES CORRECT-A.
016000         04 CORRECT-18V0                     PIC -9(18).
016100         04 FILLER                           PIC X.
016200     03 FILLER PIC X(2) VALUE SPACE.
016300     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
016400 01  CCVS-C-1.
016500     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
016600-    "SS  PARAGRAPH-NAME
016700-    "       REMARKS".
016800     02 FILLER                     PIC X(20)    VALUE SPACE.
016900 01  CCVS-C-2.
017000     02 FILLER                     PIC X        VALUE SPACE.
017100     02 FILLER                     PIC X(6)     VALUE "TESTED".
017200     02 FILLER                     PIC X(15)    VALUE SPACE.
017300     02 FILLER                     PIC X(4)     VALUE "FAIL".
017400     02 FILLER                     PIC X(94)    VALUE SPACE.
017500 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
017600 01  REC-CT                        PIC 99       VALUE ZERO.
017700 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
017800 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
017900 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
018000 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
018100 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
018200 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
018300 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
018400 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
018500 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
018600 01  CCVS-H-1.
018700     02  FILLER                    PIC X(39)    VALUE SPACES.
018800     02  FILLER                    PIC X(42)    VALUE
018900     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
019000     02  FILLER                    PIC X(39)    VALUE SPACES.
019100 01  CCVS-H-2A.
019200   02  FILLER                        PIC X(40)  VALUE SPACE.
019300   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
019400   02  FILLER                        PIC XXXX   VALUE
019500     "4.2 ".
019600   02  FILLER                        PIC X(28)  VALUE
019700            " COPY - NOT FOR DISTRIBUTION".
019800   02  FILLER                        PIC X(41)  VALUE SPACE.
019900
020000 01  CCVS-H-2B.
020100   02  FILLER                        PIC X(15)  VALUE
020200            "TEST RESULT OF ".
020300   02  TEST-ID                       PIC X(9).
020400   02  FILLER                        PIC X(4)   VALUE
020500            " IN ".
020600   02  FILLER                        PIC X(12)  VALUE
020700     " HIGH       ".
020800   02  FILLER                        PIC X(22)  VALUE
020900            " LEVEL VALIDATION FOR ".
021000   02  FILLER                        PIC X(58)  VALUE
021100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
021200 01  CCVS-H-3.
021300     02  FILLER                      PIC X(34)  VALUE
021400            " FOR OFFICIAL USE ONLY    ".
021500     02  FILLER                      PIC X(58)  VALUE
021600     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
021700     02  FILLER                      PIC X(28)  VALUE
021800            "  COPYRIGHT   1985 ".
021900 01  CCVS-E-1.
022000     02 FILLER                       PIC X(52)  VALUE SPACE.
022100     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
022200     02 ID-AGAIN                     PIC X(9).
022300     02 FILLER                       PIC X(45)  VALUE SPACES.
022400 01  CCVS-E-2.
022500     02  FILLER                      PIC X(31)  VALUE SPACE.
022600     02  FILLER                      PIC X(21)  VALUE SPACE.
022700     02 CCVS-E-2-2.
022800         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
022900         03 FILLER                   PIC X      VALUE SPACE.
023000         03 ENDER-DESC               PIC X(44)  VALUE
023100            "ERRORS ENCOUNTERED".
023200 01  CCVS-E-3.
023300     02  FILLER                      PIC X(22)  VALUE
023400            " FOR OFFICIAL USE ONLY".
023500     02  FILLER                      PIC X(12)  VALUE SPACE.
023600     02  FILLER                      PIC X(58)  VALUE
023700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
023800     02  FILLER                      PIC X(13)  VALUE SPACE.
023900     02 FILLER                       PIC X(15)  VALUE
024000             " COPYRIGHT 1985".
024100 01  CCVS-E-4.
024200     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
024300     02 FILLER                       PIC X(4)   VALUE " OF ".
024400     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
024500     02 FILLER                       PIC X(40)  VALUE
024600      "  TESTS WERE EXECUTED SUCCESSFULLY".
024700 01  XXINFO.
024800     02 FILLER                       PIC X(19)  VALUE
024900            "*** INFORMATION ***".
025000     02 INFO-TEXT.
025100       04 FILLER                     PIC X(8)   VALUE SPACE.
025200       04 XXCOMPUTED                 PIC X(20).
025300       04 FILLER                     PIC X(5)   VALUE SPACE.
025400       04 XXCORRECT                  PIC X(20).
025500     02 INF-ANSI-REFERENCE           PIC X(48).
025600 01  HYPHEN-LINE.
025700     02 FILLER  PIC IS X VALUE IS SPACE.
025800     02 FILLER  PIC IS X(65)    VALUE IS "************************
025900-    "*****************************************".
026000     02 FILLER  PIC IS X(54)    VALUE IS "************************
026100-    "******************************".
026200 01  CCVS-PGM-ID                     PIC X(9)   VALUE
026300     "RL210A".
026400 PROCEDURE DIVISION.
026500 CCVS1 SECTION.
026600 OPEN-FILES.
026700     OPEN    OUTPUT PRINT-FILE.
026800     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
026900     MOVE    SPACE TO TEST-RESULTS.
027000     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
027100     MOVE    ZERO TO REC-SKL-SUB.
027200     PERFORM CCVS-INIT-FILE 9 TIMES.
027300 CCVS-INIT-FILE.
027400     ADD     1 TO REC-SKL-SUB.
027500     MOVE    FILE-RECORD-INFO-SKELETON
027600          TO FILE-RECORD-INFO (REC-SKL-SUB).
027700 CCVS-INIT-EXIT.
027800     GO TO CCVS1-EXIT.
027900 CLOSE-FILES.
028000     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
028100 TERMINATE-CCVS.
028200S    EXIT PROGRAM.
028300STERMINATE-CALL.
028400     STOP     RUN.
028500 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
028600 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
028700 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
028800 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
028900     MOVE "****TEST DELETED****" TO RE-MARK.
029000 PRINT-DETAIL.
029100     IF REC-CT NOT EQUAL TO ZERO
029200             MOVE "." TO PARDOT-X
029300             MOVE REC-CT TO DOTVALUE.
029400     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
029500     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
029600        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
029700          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
029800     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
029900     MOVE SPACE TO CORRECT-X.
030000     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
030100     MOVE     SPACE TO RE-MARK.
030200 HEAD-ROUTINE.
030300     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030400     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030500     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030600     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
030700 COLUMN-NAMES-ROUTINE.
030800     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
030900     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
031100 END-ROUTINE.
031200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
031300 END-RTN-EXIT.
031400     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031500 END-ROUTINE-1.
031600      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
031700      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
031800      ADD PASS-COUNTER TO ERROR-HOLD.
031900*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
032000      MOVE PASS-COUNTER TO CCVS-E-4-1.
032100      MOVE ERROR-HOLD TO CCVS-E-4-2.
032200      MOVE CCVS-E-4 TO CCVS-E-2-2.
032300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
032400  END-ROUTINE-12.
032500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
032600     IF       ERROR-COUNTER IS EQUAL TO ZERO
032700         MOVE "NO " TO ERROR-TOTAL
032800         ELSE
032900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
033000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
033100     PERFORM WRITE-LINE.
033200 END-ROUTINE-13.
033300     IF DELETE-COUNTER IS EQUAL TO ZERO
033400         MOVE "NO " TO ERROR-TOTAL  ELSE
033500         MOVE DELETE-COUNTER TO ERROR-TOTAL.
033600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
033700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
033800      IF   INSPECT-COUNTER EQUAL TO ZERO
033900          MOVE "NO " TO ERROR-TOTAL
034000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
034100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
034200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034400 WRITE-LINE.
034500     ADD 1 TO RECORD-COUNT.
034600Y    IF RECORD-COUNT GREATER 50
034700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
034800Y        MOVE SPACE TO DUMMY-RECORD
034900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
035000Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
035100Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
035200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
035300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
035400Y        MOVE ZERO TO RECORD-COUNT.
035500     PERFORM WRT-LN.
035600 WRT-LN.
035700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
035800     MOVE SPACE TO DUMMY-RECORD.
035900 BLANK-LINE-PRINT.
036000     PERFORM WRT-LN.
036100 FAIL-ROUTINE.
036200     IF     COMPUTED-X NOT EQUAL TO SPACE
036300            GO TO   FAIL-ROUTINE-WRITE.
036400     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
036500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
036600     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
036700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
036800     MOVE   SPACES TO INF-ANSI-REFERENCE.
036900     GO TO  FAIL-ROUTINE-EX.
037000 FAIL-ROUTINE-WRITE.
037100     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
037200     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
037300     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
037400     MOVE   SPACES TO COR-ANSI-REFERENCE.
037500 FAIL-ROUTINE-EX. EXIT.
037600 BAIL-OUT.
037700     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
037800     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
037900 BAIL-OUT-WRITE.
038000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
038100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
038200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038300     MOVE   SPACES TO INF-ANSI-REFERENCE.
038400 BAIL-OUT-EX. EXIT.
038500 CCVS1-EXIT.
038600     EXIT.
038700 SECT-RL210A-001 SECTION.
038800 REL-INIT-001.
038900     MOVE     "FILE CREATE RL-VS1" TO FEATURE.
039000     OPEN     OUTPUT    RL-VS1.
039100     MOVE     "RL-VS1" TO XFILE-NAME (1).
039200     MOVE     "R1-F-G" TO XRECORD-NAME (1).
039300     MOVE CCVS-PGM-ID      TO XPROGRAM-NAME (1).
039400     MOVE     000120   TO XRECORD-LENGTH (1).
039500     MOVE     "RC"     TO CHARS-OR-RECORDS (1).
039600     MOVE     0001     TO XBLOCK-SIZE (1).
039700     MOVE     000500   TO RECORDS-IN-FILE (1).
039800     MOVE     "RL"     TO XFILE-ORGANIZATION (1).
039900     MOVE     "S"      TO XLABEL-TYPE (1).
040000     MOVE     000001   TO XRECORD-NUMBER (1).
040100 REL-TEST-001.
040200     MOVE    FILE-RECORD-INFO-P1-120 (1) TO RL-VS1R1-F-G-120.
040300     IF      XRECORD-NUMBER (1) < 201
040400             WRITE  RL-VS1R1-F-G-120
040500             INVALID KEY GO TO REL-FAIL-001
040600     ELSE
040700             MOVE    16 TO RL-VS1R2-F-G-121-124
040800             MOVE   "ABCDEFGHIJKLMNOP" TO RL-GROUP
040900             WRITE  RL-VS1R2-F-G-140
041000             INVALID KEY GO TO REL-FAIL-001.
041100     IF      XRECORD-NUMBER (1) EQUAL TO 500
041200             GO TO REL-WRITE-001.
041300     ADD     000001 TO XRECORD-NUMBER (1).
041400     GO      TO REL-TEST-001.
041500 REL-DELETE-001.
041600     PERFORM DE-LETE.
041700     GO TO REL-WRITE-001.
041800 REL-FAIL-001.
041900     PERFORM FAIL.
042000     MOVE   "BOUNDARY VIOLATION"  TO RE-MARK.
042100 REL-WRITE-001.
042200     MOVE   "REL-TEST-001" TO   PAR-NAME
042300     MOVE   "FILE CREATED, LFILE "  TO COMPUTED-A.
042400     MOVE    XRECORD-NUMBER (1) TO CORRECT-18V0.
042500     PERFORM PRINT-DETAIL.
042600     CLOSE   RL-VS1.
042700 REL-INIT-002.
042800     OPEN    INPUT     RL-VS1.
042900     MOVE    ZERO      TO WRK-CS-09V00.
043000 REL-TEST-002.
043100     MOVE    SPACES TO RL-VS1R2-F-G-140.
043200     READ    RL-VS1
043300             AT END GO TO REL-TEST-002-2.
043400     MOVE    RL-VS1R1-F-G-120 TO FILE-RECORD-INFO-P1-120 (1).
043500     ADD     1 TO WRK-CS-09V00.
043600     IF      WRK-CS-09V00 GREATER 500
043700             MOVE "MORE THAN 500 RECORDS" TO RE-MARK
043800             GO TO REL-TEST-002-2.
043900 REL-TEST-002-1-1.
044000     MOVE   "VIII-31 3.8.4 GR 10B" TO ANSI-REFERENCE.
044100     MOVE   "REL-TEST-002-1-1" TO PAR-NAME.
044200     IF      XLABEL-TYPE (1) NOT = "S"
044300             MOVE    XLABEL-TYPE (1) TO COMPUTED-X
044400             MOVE   "S"   TO CORRECT-X
044500             MOVE   "INVALID RECORD READ" TO RE-MARK
044600             PERFORM FAIL
044700             PERFORM PRINT-DETAIL.
044800 REL-TEST-002-1-2.
044900     MOVE   "VIII-31 3.8.4 GR 10C" TO ANSI-REFERENCE.
045000     MOVE   "REL-TEST-002-1-2" TO PAR-NAME.
045100     IF      XRECORD-NUMBER (1) > 200
045200             IF      RL-VS1R2-F-G-121-124 NOT = 16
045300                     MOVE    RL-VS1R2-F-G-121-124 TO COMPUTED-N
045400                     MOVE    16   TO CORRECT-N
045500                     MOVE   "WRONG LENGTH RECORD" TO RE-MARK
045600                     PERFORM FAIL
045700                     PERFORM PRINT-DETAIL.
045800 REL-TEST-002-1-3.
045900     MOVE   "VIII-31 3.8.4 GR 10B" TO ANSI-REFERENCE.
046000     MOVE   "REL-TEST-002-1-3" TO PAR-NAME.
046100     IF      XRECORD-NUMBER (1) > 200
046200             IF      RL-GROUP NOT = "ABCDEFGHIJKLMNOP"
046300                     MOVE   "ABCDEFGHIJKLMNOP" TO CORRECT-X
046400                     MOVE    RL-GROUP          TO COMPUTED-X
046500                     MOVE   "INVALID RECORD READ" TO RE-MARK
046600                     PERFORM FAIL
046700                     PERFORM PRINT-DETAIL.
046800     GO      TO REL-TEST-002.
046900 REL-DELETE-002.
047000     PERFORM DE-LETE.
047100     PERFORM PRINT-DETAIL.
047200 REL-TEST-002-2.
047300     MOVE   "REL-TEST-002-2" TO PAR-NAME.
047400     IF      XRECORD-NUMBER (1) NOT EQUAL TO 500
047500             PERFORM FAIL
047600     ELSE
047700             PERFORM PASS.
047800     GO      TO REL-WRITE-002.
047900 REL-WRITE-002.
048000     MOVE   "REL-TEST-002" TO PAR-NAME.
048100     MOVE   "FILE VERIFIED, LFILE" TO COMPUTED-A.
048200     MOVE    XRECORD-NUMBER (1) TO CORRECT-18V0.
048300     PERFORM PRINT-DETAIL.
048400     CLOSE   RL-VS1.
048500 CCVS-EXIT SECTION.
048600 CCVS-999999.
048700     GO TO CLOSE-FILES.
