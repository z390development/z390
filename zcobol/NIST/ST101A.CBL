000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST101A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100 ENVIRONMENT DIVISION.
002200 CONFIGURATION SECTION.
002300 SOURCE-COMPUTER.
002400     XXXXX082.
002500 OBJECT-COMPUTER.
002600     XXXXX083.
002700 INPUT-OUTPUT SECTION.
002800 FILE-CONTROL.
002900     SELECT PRINT-FILE ASSIGN TO
003000     XXXXX055.
003100     SELECT SORTFILE-1A ASSIGN TO
003200     XXXXX027.
003300     SELECT SORTOUT-1A ASSIGN TO
003400     XXXXP001.
003500 DATA DIVISION.
003600 FILE SECTION.
003700 FD  PRINT-FILE.
003800 01  PRINT-REC PICTURE X(120).
003900 01  DUMMY-RECORD PICTURE X(120).
004000 SD  SORTFILE-1A
004100     DATA RECORD IS S-RECORD.
004200 01  S-RECORD.
004300     02  KEYS-GROUP.
004400         03  KEY-1 PICTURE 9.
004500         03  KEY-2 PICTURE 99.
004600         03  KEY-3 PICTURE 999.
004700         03  KEY-4 PICTURE 9999.
004800         03  KEY-5 PICTURE 9(5).
004900     02  RDF-KEYS REDEFINES KEYS-GROUP PICTURE 9(15).
005000     02  FILLER PICTURE X(105).
005100 FD  SORTOUT-1A
005200     BLOCK CONTAINS 10 RECORDS
005300     LABEL RECORDS ARE STANDARD
005400C    VALUE OF
005500C    XXXXX074
005600C    IS
005700C    XXXXX075
005800G    XXXXX069
005900     DATA RECORD IS SORTED.
006000 01  SORTED PICTURE X(120).
006100 WORKING-STORAGE SECTION.
006200 77  C0 PICTURE 9 VALUE 0.
006300 77  C1 PICTURE 9 VALUE 1.
006400 77  C2 PICTURE 9 VALUE 2.
006500 77  C6 PICTURE 9 VALUE 6.
006600 77  C3 PICTURE 9 VALUE 3.
006700 77  COMMENT-SENTENCE  PIC X(116) VALUE " THE FILE BUILT IN ST101A
006800-    " IS USED BY ST102A. ST102A DOES NOT PRODUCE A REPORT- THE R
006900-    "ESULTS ARE CHECKED IN ST103A.".
007000 01  WKEYS-GROUP.
007100     02  WKEY-1 PICTURE 9.
007200     02  WKEY-2 PICTURE 99.
007300     02  WKEY-3 PICTURE 999.
007400     02  WKEY-4 PICTURE 9999.
007500     02  WKEY-5 PICTURE 9(5).
007600 01  WKEYS-RDF REDEFINES WKEYS-GROUP PICTURE 9(15).
007700 01  TEST-RESULTS.
007800     02 FILLER                   PIC X      VALUE SPACE.
007900     02 FEATURE                  PIC X(20)  VALUE SPACE.
008000     02 FILLER                   PIC X      VALUE SPACE.
008100     02 P-OR-F                   PIC X(5)   VALUE SPACE.
008200     02 FILLER                   PIC X      VALUE SPACE.
008300     02  PAR-NAME.
008400       03 FILLER                 PIC X(19)  VALUE SPACE.
008500       03  PARDOT-X              PIC X      VALUE SPACE.
008600       03 DOTVALUE               PIC 99     VALUE ZERO.
008700     02 FILLER                   PIC X(8)   VALUE SPACE.
008800     02 RE-MARK                  PIC X(61).
008900 01  TEST-COMPUTED.
009000     02 FILLER                   PIC X(30)  VALUE SPACE.
009100     02 FILLER                   PIC X(17)  VALUE
009200            "       COMPUTED=".
009300     02 COMPUTED-X.
009400     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
009500     03 COMPUTED-N               REDEFINES COMPUTED-A
009600                                 PIC -9(9).9(9).
009700     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
009800     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
009900     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
010000     03       CM-18V0 REDEFINES COMPUTED-A.
010100         04 COMPUTED-18V0                    PIC -9(18).
010200         04 FILLER                           PIC X.
010300     03 FILLER PIC X(50) VALUE SPACE.
010400 01  TEST-CORRECT.
010500     02 FILLER PIC X(30) VALUE SPACE.
010600     02 FILLER PIC X(17) VALUE "       CORRECT =".
010700     02 CORRECT-X.
010800     03 CORRECT-A                  PIC X(20) VALUE SPACE.
010900     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
011000     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
011100     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
011200     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
011300     03      CR-18V0 REDEFINES CORRECT-A.
011400         04 CORRECT-18V0                     PIC -9(18).
011500         04 FILLER                           PIC X.
011600     03 FILLER PIC X(2) VALUE SPACE.
011700     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
011800 01  CCVS-C-1.
011900     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
012000-    "SS  PARAGRAPH-NAME
012100-    "       REMARKS".
012200     02 FILLER                     PIC X(20)    VALUE SPACE.
012300 01  CCVS-C-2.
012400     02 FILLER                     PIC X        VALUE SPACE.
012500     02 FILLER                     PIC X(6)     VALUE "TESTED".
012600     02 FILLER                     PIC X(15)    VALUE SPACE.
012700     02 FILLER                     PIC X(4)     VALUE "FAIL".
012800     02 FILLER                     PIC X(94)    VALUE SPACE.
012900 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
013000 01  REC-CT                        PIC 99       VALUE ZERO.
013100 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
013200 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
013300 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
013400 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
013500 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
013600 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
013700 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
013800 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
013900 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
014000 01  CCVS-H-1.
014100     02  FILLER                    PIC X(39)    VALUE SPACES.
014200     02  FILLER                    PIC X(42)    VALUE
014300     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
014400     02  FILLER                    PIC X(39)    VALUE SPACES.
014500 01  CCVS-H-2A.
014600   02  FILLER                        PIC X(40)  VALUE SPACE.
014700   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
014800   02  FILLER                        PIC XXXX   VALUE
014900     "4.2 ".
015000   02  FILLER                        PIC X(28)  VALUE
015100            " COPY - NOT FOR DISTRIBUTION".
015200   02  FILLER                        PIC X(41)  VALUE SPACE.
015300
015400 01  CCVS-H-2B.
015500   02  FILLER                        PIC X(15)  VALUE
015600            "TEST RESULT OF ".
015700   02  TEST-ID                       PIC X(9).
015800   02  FILLER                        PIC X(4)   VALUE
015900            " IN ".
016000   02  FILLER                        PIC X(12)  VALUE
016100     " HIGH       ".
016200   02  FILLER                        PIC X(22)  VALUE
016300            " LEVEL VALIDATION FOR ".
016400   02  FILLER                        PIC X(58)  VALUE
016500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
016600 01  CCVS-H-3.
016700     02  FILLER                      PIC X(34)  VALUE
016800            " FOR OFFICIAL USE ONLY    ".
016900     02  FILLER                      PIC X(58)  VALUE
017000     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
017100     02  FILLER                      PIC X(28)  VALUE
017200            "  COPYRIGHT   1985 ".
017300 01  CCVS-E-1.
017400     02 FILLER                       PIC X(52)  VALUE SPACE.
017500     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
017600     02 ID-AGAIN                     PIC X(9).
017700     02 FILLER                       PIC X(45)  VALUE SPACES.
017800 01  CCVS-E-2.
017900     02  FILLER                      PIC X(31)  VALUE SPACE.
018000     02  FILLER                      PIC X(21)  VALUE SPACE.
018100     02 CCVS-E-2-2.
018200         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
018300         03 FILLER                   PIC X      VALUE SPACE.
018400         03 ENDER-DESC               PIC X(44)  VALUE
018500            "ERRORS ENCOUNTERED".
018600 01  CCVS-E-3.
018700     02  FILLER                      PIC X(22)  VALUE
018800            " FOR OFFICIAL USE ONLY".
018900     02  FILLER                      PIC X(12)  VALUE SPACE.
019000     02  FILLER                      PIC X(58)  VALUE
019100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
019200     02  FILLER                      PIC X(13)  VALUE SPACE.
019300     02 FILLER                       PIC X(15)  VALUE
019400             " COPYRIGHT 1985".
019500 01  CCVS-E-4.
019600     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
019700     02 FILLER                       PIC X(4)   VALUE " OF ".
019800     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
019900     02 FILLER                       PIC X(40)  VALUE
020000      "  TESTS WERE EXECUTED SUCCESSFULLY".
020100 01  XXINFO.
020200     02 FILLER                       PIC X(19)  VALUE
020300            "*** INFORMATION ***".
020400     02 INFO-TEXT.
020500       04 FILLER                     PIC X(8)   VALUE SPACE.
020600       04 XXCOMPUTED                 PIC X(20).
020700       04 FILLER                     PIC X(5)   VALUE SPACE.
020800       04 XXCORRECT                  PIC X(20).
020900     02 INF-ANSI-REFERENCE           PIC X(48).
021000 01  HYPHEN-LINE.
021100     02 FILLER  PIC IS X VALUE IS SPACE.
021200     02 FILLER  PIC IS X(65)    VALUE IS "************************
021300-    "*****************************************".
021400     02 FILLER  PIC IS X(54)    VALUE IS "************************
021500-    "******************************".
021600 01  CCVS-PGM-ID                     PIC X(9)   VALUE
021700     "ST101A".
021800 PROCEDURE DIVISION.
021900 SORT-INIT SECTION.
022000 I-1.
022100     SORT SORTFILE-1A
022200     ON ASCENDING KEY KEY-1
022300     ON DESCENDING KEY KEY-2
022400     ON ASCENDING KEY KEY-3
022500     DESCENDING KEY-4 KEY-5
022600     INPUT PROCEDURE IS INSORT
022700     OUTPUT PROCEDURE IS OUTP1 THRU OUTP3.
022800 I-2.
022900     STOP RUN.
023000 INSORT SECTION.
023100 IN-1.
023200*    NOTE.
023300*       KEYS 1 AND 3 THRU 5 WILL VARY IN VALUE BETWEEN 1 AND 2.
023400*       KEY 2 VARIES FROM 1 THRU 6. THUS 96 RECORDS ARE CREATED
023500*       IN REVERSE SEQUENCE OF SORTING ORDER. TWO RECORDS ARE
023600*       ADDED TO EACH END OF THE SORTED STRING FOR HI-LOW CONTROL.
023700*       THE SORT STATEMENT TESTS THE SERIES AND THRU OPTIONS WITH
023800*       INCLUSION AND OMISSION OF OPTIONAL WORDS. THE SORT
023900*       STATEMENT REPRESENTS BASIC SORTING PERMITTED BY LEVEL 1 OF
024000*       THE SORT MODULE.
024100 IN-2.
024200     MOVE 900009000000000 TO RDF-KEYS.
024300     RELEASE S-RECORD.
024400     MOVE 009000000900009 TO RDF-KEYS.
024500     RELEASE S-RECORD.
024600     MOVE 900008000000000 TO RDF-KEYS.
024700     RELEASE S-RECORD.
024800     MOVE 009000000900008 TO RDF-KEYS.
024900     RELEASE S-RECORD.
025000*    NOTE HI-LOW CONTROL RECORDS DONE.
025100     MOVE 300003000000000 TO WKEYS-RDF.
025200 IN-3.
025300     PERFORM IN-4 2 TIMES.
025400     GO TO IN-EXIT.
025500 IN-4.
025600     SUBTRACT C1 FROM WKEY-1.
025700     PERFORM IN-5 6 TIMES.
025800 IN-5.
025900     IF WKEY-2 IS EQUAL TO C6
026000         MOVE C0 TO WKEY-2.
026100     ADD C1 TO WKEY-2.
026200     PERFORM IN-6 2 TIMES.
026300 IN-6.
026400     IF WKEY-3 IS EQUAL TO C1
026500         MOVE C3 TO WKEY-3.
026600     SUBTRACT C1 FROM WKEY-3.
026700     PERFORM IN-7 2 TIMES.
026800 IN-7.
026900     IF WKEY-4 IS EQUAL TO C2
027000         MOVE C0 TO WKEY-4.
027100     ADD C1 TO WKEY-4.
027200     PERFORM IN-8 2 TIMES.
027300 IN-8.
027400     IF WKEY-5 IS EQUAL TO C2
027500         MOVE C0 TO WKEY-5.
027600     ADD C1 TO WKEY-5.
027700     MOVE WKEYS-RDF TO RDF-KEYS.
027800     RELEASE S-RECORD.
027900 IN-EXIT.
028000     EXIT.
028100 OUTP1 SECTION.
028200 SORTING-TEST.
028300     OPEN     OUTPUT SORTOUT-1A.
028400 OPEN-FILES.
028500     OPEN     OUTPUT PRINT-FILE.
028600     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
028700     MOVE    SPACE TO TEST-RESULTS.
028800     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
028900     GO TO CCVS1-EXIT.
029000 CLOSE-FILES.
029100     MOVE SPACES TO TEST-RESULTS.
029200     MOVE COMMENT-SENTENCE TO TEST-RESULTS.
029300     PERFORM PRINT-DETAIL.
029400     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
029500     MOVE SPACES TO TEST-RESULTS.
029600 TERMINATE-CCVS.
029700S    EXIT PROGRAM.
029800STERMINATE-CALL.
029900     STOP     RUN.
030000 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
030100 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
030200 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
030300 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
030400     MOVE "****TEST DELETED****" TO RE-MARK.
030500 PRINT-DETAIL.
030600     IF REC-CT NOT EQUAL TO ZERO
030700             MOVE "." TO PARDOT-X
030800             MOVE REC-CT TO DOTVALUE.
030900     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
031000     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
031100        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
031200          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
031300     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
031400     MOVE SPACE TO CORRECT-X.
031500     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
031600     MOVE     SPACE TO RE-MARK.
031700 HEAD-ROUTINE.
031800     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031900     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032000     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
032100     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
032200 COLUMN-NAMES-ROUTINE.
032300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
032400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
032600 END-ROUTINE.
032700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
032800 END-RTN-EXIT.
032900     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033000 END-ROUTINE-1.
033100      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
033200      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
033300      ADD PASS-COUNTER TO ERROR-HOLD.
033400*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
033500      MOVE PASS-COUNTER TO CCVS-E-4-1.
033600      MOVE ERROR-HOLD TO CCVS-E-4-2.
033700      MOVE CCVS-E-4 TO CCVS-E-2-2.
033800      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
033900  END-ROUTINE-12.
034000      MOVE "TEST(S) FAILED" TO ENDER-DESC.
034100     IF       ERROR-COUNTER IS EQUAL TO ZERO
034200         MOVE "NO " TO ERROR-TOTAL
034300         ELSE
034400         MOVE ERROR-COUNTER TO ERROR-TOTAL.
034500     MOVE     CCVS-E-2 TO DUMMY-RECORD.
034600     PERFORM WRITE-LINE.
034700 END-ROUTINE-13.
034800     IF DELETE-COUNTER IS EQUAL TO ZERO
034900         MOVE "NO " TO ERROR-TOTAL  ELSE
035000         MOVE DELETE-COUNTER TO ERROR-TOTAL.
035100     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
035200     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035300      IF   INSPECT-COUNTER EQUAL TO ZERO
035400          MOVE "NO " TO ERROR-TOTAL
035500      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
035600      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
035700      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035800     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
035900 WRITE-LINE.
036000     ADD 1 TO RECORD-COUNT.
036100Y    IF RECORD-COUNT GREATER 42
036200Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
036300Y        MOVE SPACE TO DUMMY-RECORD
036400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
036500Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
036600Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
036700Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
036800Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
036900Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
037000Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
037100Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
037200Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
037300Y        MOVE ZERO TO RECORD-COUNT.
037400     PERFORM WRT-LN.
037500 WRT-LN.
037600     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
037700     MOVE SPACE TO DUMMY-RECORD.
037800 BLANK-LINE-PRINT.
037900     PERFORM WRT-LN.
038000 FAIL-ROUTINE.
038100     IF     COMPUTED-X NOT EQUAL TO SPACE
038200            GO TO   FAIL-ROUTINE-WRITE.
038300     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
038400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
038500     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
038600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
038700     MOVE   SPACES TO INF-ANSI-REFERENCE.
038800     GO TO  FAIL-ROUTINE-EX.
038900 FAIL-ROUTINE-WRITE.
039000     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
039100     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
039200     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
039300     MOVE   SPACES TO COR-ANSI-REFERENCE.
039400 FAIL-ROUTINE-EX. EXIT.
039500 BAIL-OUT.
039600     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
039700     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
039800 BAIL-OUT-WRITE.
039900     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
040000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
040100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040200     MOVE   SPACES TO INF-ANSI-REFERENCE.
040300 BAIL-OUT-EX. EXIT.
040400 CCVS1-EXIT.
040500     EXIT.
040600 ST101-0001-01.
040700     MOVE     "ST101 GENERATES OUTPUT" TO RE-MARK.
040800     PERFORM  PRINT-DETAIL.
040900     MOVE     "WHICH AFFECTS PROGRAMS" TO RE-MARK.
041000     PERFORM  PRINT-DETAIL.
041100     MOVE     "ST102 AND ST103."       TO RE-MARK.
041200     PERFORM  PRINT-DETAIL.
041300     MOVE     "SORT --- FIVE KEYS" TO FEATURE.
041400 SORT-TEST-1.
041500     PERFORM  RET-1.
041600     IF       RDF-KEYS EQUAL TO 009000000900009
041700              PERFORM PASS GO TO SORT-WRITE-1.
041800     GO       TO SORT-FAIL-1.
041900 SORT-DELETE-1.
042000     PERFORM  DE-LETE.
042100     GO       TO SORT-WRITE-1.
042200 SORT-FAIL-1.
042300     MOVE     RDF-KEYS TO COMPUTED-18V0.
042400     MOVE     009000000900009 TO CORRECT-18V0.
042500     PERFORM  FAIL.
042600 SORT-WRITE-1.
042700     MOVE     "SORT-TEST-1 " TO PAR-NAME.
042800     PERFORM  PRINT-DETAIL.
042900 SORT-TEST-2.
043000     PERFORM  RET-1.
043100     IF       RDF-KEYS EQUAL TO 009000000900008
043200              PERFORM PASS GO TO SORT-WRITE-2.
043300     GO       TO SORT-FAIL-2.
043400 SORT-DELETE-2.
043500     PERFORM  DE-LETE.
043600     GO       TO SORT-WRITE-2.
043700 SORT-FAIL-2.
043800     MOVE     RDF-KEYS TO COMPUTED-18V0.
043900     MOVE     009000000900009 TO CORRECT-18V0.
044000     PERFORM  FAIL.
044100 SORT-WRITE-2.
044200     MOVE     "SORT-TEST-2 " TO PAR-NAME.
044300     PERFORM  PRINT-DETAIL.
044400 SORT-TEST-3.
044500     PERFORM  RET-1.
044600     IF       RDF-KEYS EQUAL TO 106001000200002
044700              PERFORM PASS GO TO SORT-WRITE-3.
044800     GO       TO SORT-FAIL-3.
044900 SORT-DELETE-3.
045000     PERFORM  DE-LETE.
045100     GO       TO SORT-WRITE-3.
045200 SORT-FAIL-3.
045300     MOVE     RDF-KEYS TO COMPUTED-18V0.
045400     MOVE     106001000200002  TO CORRECT-18V0.
045500     PERFORM  FAIL.
045600 SORT-WRITE-3.
045700     MOVE     "SORT-TEST-3 " TO PAR-NAME.
045800     PERFORM  PRINT-DETAIL.
045900 OUTP2 SECTION.
046000 SORT-TEST-4.
046100     PERFORM  RET-2 48 TIMES.
046200     IF       RDF-KEYS EQUAL TO 206001000200002
046300              PERFORM PASS GO TO SORT-WRITE-4.
046400     GO       TO SORT-FAIL-4.
046500 SORT-DELETE-4.
046600     PERFORM  DE-LETE.
046700     GO       TO SORT-WRITE-4.
046800 SORT-FAIL-4.
046900     MOVE     RDF-KEYS TO COMPUTED-18V0.
047000     MOVE    206001000200002 TO CORRECT-18V0.
047100     PERFORM  FAIL.
047200 SORT-WRITE-4.
047300     MOVE     "SORT-TEST-4 " TO PAR-NAME.
047400     PERFORM  PRINT-DETAIL.
047500 SORT-TEST-5.
047600     PERFORM  RET-2 40 TIMES.
047700     IF       RDF-KEYS EQUAL TO 201001000200002
047800              PERFORM PASS GO TO SORT-WRITE-5.
047900     GO       TO SORT-FAIL-5.
048000 SORT-DELETE-5.
048100     PERFORM  DE-LETE.
048200     GO       TO SORT-WRITE-5.
048300 SORT-FAIL-5.
048400     MOVE     RDF-KEYS TO COMPUTED-18V0.
048500     MOVE     201001000200002 TO CORRECT-18V0.
048600     PERFORM  FAIL.
048700 SORT-WRITE-5.
048800     MOVE     "SORT-TEST-5 " TO PAR-NAME.
048900     PERFORM  PRINT-DETAIL.
049000 SORT-TEST-6.
049100     PERFORM  RET-2 7 TIMES.
049200     IF       RDF-KEYS EQUAL TO 201002000100001
049300              PERFORM PASS GO TO SORT-WRITE-6.
049400     GO       TO SORT-FAIL-6.
049500 SORT-DELETE-6.
049600     PERFORM  DE-LETE.
049700     GO       TO SORT-WRITE-6.
049800 SORT-FAIL-6.
049900     MOVE     RDF-KEYS TO COMPUTED-18V0.
050000     MOVE     201002000100001 TO CORRECT-18V0.
050100     PERFORM  FAIL.
050200 SORT-WRITE-6.
050300     MOVE     "SORT-TEST-6 " TO PAR-NAME.
050400     PERFORM  PRINT-DETAIL.
050500 SORT-TEST-7.
050600     PERFORM  RET-2.
050700     IF       RDF-KEYS EQUAL TO 900008000000000
050800              PERFORM PASS GO TO SORT-WRITE-7.
050900     GO       TO SORT-FAIL-7.
051000 SORT-DELETE-7.
051100     PERFORM  DE-LETE.
051200     GO       TO SORT-WRITE-7.
051300 SORT-FAIL-7.
051400     MOVE     RDF-KEYS TO COMPUTED-18V0.
051500     MOVE     900008000000000 TO CORRECT-18V0.
051600     PERFORM  FAIL.
051700 SORT-WRITE-7.
051800     MOVE     "SORT-TEST-7 " TO PAR-NAME.
051900     PERFORM  PRINT-DETAIL.
052000 SORT-TEST-8.
052100     PERFORM  RET-2.
052200     IF       RDF-KEYS EQUAL TO 900009000000000
052300              PERFORM PASS GO TO SORT-WRITE-8.
052400     GO       TO SORT-FAIL-8.
052500 SORT-DELETE-8.
052600     PERFORM  DE-LETE.
052700     GO       TO SORT-WRITE-8.
052800 SORT-FAIL-8.
052900     MOVE     RDF-KEYS TO COMPUTED-18V0.
053000     MOVE     900009000000000 TO CORRECT-18V0.
053100     PERFORM  FAIL.
053200 SORT-WRITE-8.
053300     MOVE     "SORT-TEST-8 " TO PAR-NAME.
053400     PERFORM  PRINT-DETAIL.
053500 SORT-TEST-9.
053600     RETURN   SORTFILE-1A AT END
053700              PERFORM PASS GO TO SORT-WRITE-9.
053800     GO       TO SORT-FAIL-9.
053900 SORT-DELETE-9.
054000     PERFORM  DE-LETE.
054100     GO       TO SORT-WRITE-9.
054200 SORT-FAIL-9.
054300     MOVE     RDF-KEYS TO COMPUTED-18V0.
054400     MOVE     "END OF FILE NOT FOUND" TO RE-MARK.
054500     PERFORM  FAIL.
054600 SORT-WRITE-9.
054700     MOVE     "SORT-TEST-9 " TO PAR-NAME.
054800     PERFORM  PRINT-DETAIL.
054900 OUTP3 SECTION.
055000 ST101-0002-01.
055100     CLOSE    SORTOUT-1A.
055200     GO      TO OUTP3-EXIT.
055300 BAD-FILE.
055400     MOVE     "BAD-FILE" TO PAR-NAME.
055500     PERFORM  FAIL.
055600     MOVE     "END OF FILE PREMATURELY" TO RE-MARK.
055700     PERFORM  PRINT-DETAIL.
055800     MOVE     "REACHED, PREVIOUS TEST WAS" TO RE-MARK.
055900     PERFORM  PRINT-DETAIL.
056000     MOVE     "THE LAST SUCCESSFUL TEST." TO RE-MARK.
056100     PERFORM  PRINT-DETAIL.
056200     MOVE     SPACE TO FEATURE.
056300     GO TO    OUTP3-EXIT.
056400 RET-1.
056500     RETURN   SORTFILE-1A RECORD AT END GO TO BAD-FILE.
056600     MOVE     S-RECORD TO SORTED.
056700     WRITE    SORTED.
056800*    NOTE     THE RETURN VERB WITH ALL OPTIONAL WORDS.
056900 RET-2.
057000     RETURN   SORTFILE-1A           END GO TO BAD-FILE.
057100     MOVE     S-RECORD TO SORTED.
057200     WRITE    SORTED.
057300*    NOTE     THE RETURN VERB WITHOUT OPTIONAL WORDS.
057400 OUTP3-EXIT.
057500     PERFORM  CLOSE-FILES.
