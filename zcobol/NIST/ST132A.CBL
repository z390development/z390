000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     ST132A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*
002200*    THIS PROGRAM EXERCISES THE FOLLOWING
002300*        SAME SORT AREA CLAUSE
002400*        USING-OUTPUT PROCEDURE COMBINATION
002500*        MULTI REEL SORT
002600*        RELEASE FROM
002700*        RETURN INTO.
002800*    THERE ARE 3 SORTS. THE FIRST GENERATES THE INPUT DATA IN THE
002900*        INPUT PROCEDURE. THE SORT RESULTS ARE TESTED IN THE
003000*        OUTPUT PROCEDURE WHICH ALSO CREATES A 2-REEL FILE (VIA
003100*        CLOSE REEL) FOR INPUT TO THE SECOND SORT.
003200*    THE SECOND SORT (USING-OUTPUT PROCEDURE) IS TESTED IN THE
003300*        OUTPUT PROCEDURE.
003400*    THE THIRD SORT EXERCISES A SORT-FILE FOR THE SECOND TIME.
003500*        SUCCESSFUL EXECUTION IS THE SOLE TEST OF THIS SORT.
003600
003700 ENVIRONMENT DIVISION.
003800 CONFIGURATION SECTION.
003900 SOURCE-COMPUTER.
004000     XXXXX082.
004100 OBJECT-COMPUTER.
004200     XXXXX083.
004300 INPUT-OUTPUT SECTION.
004400 FILE-CONTROL.
004500     SELECT PRINT-FILE ASSIGN TO
004600     XXXXX055.
004700     SELECT SORT4  ASSIGN TO
004800     XXXXX027.
004900     SELECT SORT5  ASSIGN TO
005000     XXXXX028.
005100     SELECT FILE4 ASSIGN TO
005200     XXXXX006.
005300 I-O-CONTROL.
005400     SAME SORT AREA FOR SORT5 SORT4.
005500 DATA DIVISION.
005600 FILE SECTION.
005700 FD  PRINT-FILE.
005800 01  PRINT-REC PICTURE X(120).
005900 01  DUMMY-RECORD PICTURE X(120).
006000 FD  FILE4
006100     BLOCK CONTAINS 10 RECORDS
006200     LABEL RECORDS ARE STANDARD
006300C    VALUE OF
006400C    XXXXX074
006500C    IS
006600C    XXXXX075
006700G    XXXXX069
006800     DATA RECORD IS R4.
006900 01  R4 PICTURE X(120).
007000 SD  SORT4
007100     RECORD CONTAINS 120
007200     DATA RECORD IS S4.
007300 01  S4.
007400     02  S4-KEYS.
007500         03  S4-KEY1 PICTURE A(10).
007600         03  S4-KEY2 PICTURE 9(10).
007700     02  FILLER PICTURE X(100).
007800 SD  SORT5
007900     RECORD 120
008000     DATA RECORD S5.
008100 01  S5.
008200     02  S5-KEYS.
008300         03  S5-KEY1 PICTURE A(10).
008400         03  S5-KEY2 PICTURE 9(10).
008500     02  FILLER PICTURE X(100).
008600 WORKING-STORAGE SECTION.
008700 77  C0 PICTURE 9 COMPUTATIONAL VALUE ZERO.
008800 77  C1 PICTURE 9 COMPUTATIONAL VALUE 1.
008900 77  SUBSCRIPT-1 PICTURE 99 COMPUTATIONAL VALUE ZERO.
009000 77  SUBSCRIPT-2 PICTURE 99 COMPUTATIONAL.
009100 01  ALPHA-TABLE.
009200     02  ALPHA-TAB PICTURE A(25)
009300         VALUE "ABCDEFGHIJKLMNPQRSTUVWXYZ".
009400     02  ALPHA-TBL REDEFINES ALPHA-TAB PICTURE A OCCURS 25 TIMES.
009500 01  WKEYS.
009600     02  WKEY-1.
009700         03  FILLER PICTURE AAA VALUE "PQR".
009800         03  WKEY-1A PICTURE A.
009900         03  FILLER PICTURE A(5) VALUE "ABCDE".
010000         03  WKEY-1B PICTURE A.
010100     02  WKEY-2.
010200         03  FILLER PICTURE 9    VALUE 7.
010300         03  WKEY-2A PICTURE 9 VALUE ZERO.
010400         03  FILLER PICTURE 9(7) VALUE 1234567.
010500         03  WKEY-2B PICTURE 9 VALUE ZERO.
010600     02  FILLER PICTURE X(100).
010700 01  FILE-RECORD-INFORMATION-REC.
010800     03 FILE-RECORD-INFO-SKELETON.
010900        05 FILLER                 PICTURE X(48)       VALUE
011000             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
011100        05 FILLER                 PICTURE X(46)       VALUE
011200             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
011300        05 FILLER                 PICTURE X(26)       VALUE
011400             ",LFIL=000000,ORG=  ,LBLR= ".
011500        05 FILLER                 PICTURE X(37)       VALUE
011600             ",RECKEY=                             ".
011700        05 FILLER                 PICTURE X(38)       VALUE
011800             ",ALTKEY1=                             ".
011900        05 FILLER                 PICTURE X(38)       VALUE
012000             ",ALTKEY2=                             ".
012100        05 FILLER                 PICTURE X(7)        VALUE SPACE.
012200     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
012300        05 FILE-RECORD-INFO-P1-120.
012400           07 FILLER              PIC X(5).
012500           07 XFILE-NAME           PIC X(6).
012600           07 FILLER              PIC X(8).
012700           07 XRECORD-NAME         PIC X(6).
012800           07 FILLER              PIC X(1).
012900           07 REELUNIT-NUMBER     PIC 9(1).
013000           07 FILLER              PIC X(7).
013100           07 XRECORD-NUMBER       PIC 9(6).
013200           07 FILLER              PIC X(6).
013300           07 UPDATE-NUMBER       PIC 9(2).
013400           07 FILLER              PIC X(5).
013500           07 ODO-NUMBER          PIC 9(4).
013600           07 FILLER              PIC X(5).
013700           07 XPROGRAM-NAME        PIC X(5).
013800           07 FILLER              PIC X(7).
013900           07 XRECORD-LENGTH       PIC 9(6).
014000           07 FILLER              PIC X(7).
014100           07 CHARS-OR-RECORDS    PIC X(2).
014200           07 FILLER              PIC X(1).
014300           07 XBLOCK-SIZE          PIC 9(4).
014400           07 FILLER              PIC X(6).
014500           07 RECORDS-IN-FILE     PIC 9(6).
014600           07 FILLER              PIC X(5).
014700           07 XFILE-ORGANIZATION   PIC X(2).
014800           07 FILLER              PIC X(6).
014900           07 XLABEL-TYPE          PIC X(1).
015000        05 FILE-RECORD-INFO-P121-240.
015100           07 FILLER              PIC X(8).
015200           07 XRECORD-KEY          PIC X(29).
015300           07 FILLER              PIC X(9).
015400           07 ALTERNATE-KEY1      PIC X(29).
015500           07 FILLER              PIC X(9).
015600           07 ALTERNATE-KEY2      PIC X(29).
015700           07 FILLER              PIC X(7).
015800 01  TEST-RESULTS.
015900     02 FILLER                   PIC X      VALUE SPACE.
016000     02 FEATURE                  PIC X(20)  VALUE SPACE.
016100     02 FILLER                   PIC X      VALUE SPACE.
016200     02 P-OR-F                   PIC X(5)   VALUE SPACE.
016300     02 FILLER                   PIC X      VALUE SPACE.
016400     02  PAR-NAME.
016500       03 FILLER                 PIC X(19)  VALUE SPACE.
016600       03  PARDOT-X              PIC X      VALUE SPACE.
016700       03 DOTVALUE               PIC 99     VALUE ZERO.
016800     02 FILLER                   PIC X(8)   VALUE SPACE.
016900     02 RE-MARK                  PIC X(61).
017000 01  TEST-COMPUTED.
017100     02 FILLER                   PIC X(30)  VALUE SPACE.
017200     02 FILLER                   PIC X(17)  VALUE
017300            "       COMPUTED=".
017400     02 COMPUTED-X.
017500     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
017600     03 COMPUTED-N               REDEFINES COMPUTED-A
017700                                 PIC -9(9).9(9).
017800     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
017900     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
018000     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
018100     03       CM-18V0 REDEFINES COMPUTED-A.
018200         04 COMPUTED-18V0                    PIC -9(18).
018300         04 FILLER                           PIC X.
018400     03 FILLER PIC X(50) VALUE SPACE.
018500 01  TEST-CORRECT.
018600     02 FILLER PIC X(30) VALUE SPACE.
018700     02 FILLER PIC X(17) VALUE "       CORRECT =".
018800     02 CORRECT-X.
018900     03 CORRECT-A                  PIC X(20) VALUE SPACE.
019000     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
019100     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
019200     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
019300     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
019400     03      CR-18V0 REDEFINES CORRECT-A.
019500         04 CORRECT-18V0                     PIC -9(18).
019600         04 FILLER                           PIC X.
019700     03 FILLER PIC X(2) VALUE SPACE.
019800     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
019900 01  CCVS-C-1.
020000     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
020100-    "SS  PARAGRAPH-NAME
020200-    "       REMARKS".
020300     02 FILLER                     PIC X(20)    VALUE SPACE.
020400 01  CCVS-C-2.
020500     02 FILLER                     PIC X        VALUE SPACE.
020600     02 FILLER                     PIC X(6)     VALUE "TESTED".
020700     02 FILLER                     PIC X(15)    VALUE SPACE.
020800     02 FILLER                     PIC X(4)     VALUE "FAIL".
020900     02 FILLER                     PIC X(94)    VALUE SPACE.
021000 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
021100 01  REC-CT                        PIC 99       VALUE ZERO.
021200 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
021300 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
021400 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
021500 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
021600 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
021700 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
021800 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
021900 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
022000 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
022100 01  CCVS-H-1.
022200     02  FILLER                    PIC X(39)    VALUE SPACES.
022300     02  FILLER                    PIC X(42)    VALUE
022400     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
022500     02  FILLER                    PIC X(39)    VALUE SPACES.
022600 01  CCVS-H-2A.
022700   02  FILLER                        PIC X(40)  VALUE SPACE.
022800   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
022900   02  FILLER                        PIC XXXX   VALUE
023000     "4.2 ".
023100   02  FILLER                        PIC X(28)  VALUE
023200            " COPY - NOT FOR DISTRIBUTION".
023300   02  FILLER                        PIC X(41)  VALUE SPACE.
023400
023500 01  CCVS-H-2B.
023600   02  FILLER                        PIC X(15)  VALUE
023700            "TEST RESULT OF ".
023800   02  TEST-ID                       PIC X(9).
023900   02  FILLER                        PIC X(4)   VALUE
024000            " IN ".
024100   02  FILLER                        PIC X(12)  VALUE
024200     " HIGH       ".
024300   02  FILLER                        PIC X(22)  VALUE
024400            " LEVEL VALIDATION FOR ".
024500   02  FILLER                        PIC X(58)  VALUE
024600     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
024700 01  CCVS-H-3.
024800     02  FILLER                      PIC X(34)  VALUE
024900            " FOR OFFICIAL USE ONLY    ".
025000     02  FILLER                      PIC X(58)  VALUE
025100     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
025200     02  FILLER                      PIC X(28)  VALUE
025300            "  COPYRIGHT   1985 ".
025400 01  CCVS-E-1.
025500     02 FILLER                       PIC X(52)  VALUE SPACE.
025600     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
025700     02 ID-AGAIN                     PIC X(9).
025800     02 FILLER                       PIC X(45)  VALUE SPACES.
025900 01  CCVS-E-2.
026000     02  FILLER                      PIC X(31)  VALUE SPACE.
026100     02  FILLER                      PIC X(21)  VALUE SPACE.
026200     02 CCVS-E-2-2.
026300         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
026400         03 FILLER                   PIC X      VALUE SPACE.
026500         03 ENDER-DESC               PIC X(44)  VALUE
026600            "ERRORS ENCOUNTERED".
026700 01  CCVS-E-3.
026800     02  FILLER                      PIC X(22)  VALUE
026900            " FOR OFFICIAL USE ONLY".
027000     02  FILLER                      PIC X(12)  VALUE SPACE.
027100     02  FILLER                      PIC X(58)  VALUE
027200     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
027300     02  FILLER                      PIC X(13)  VALUE SPACE.
027400     02 FILLER                       PIC X(15)  VALUE
027500             " COPYRIGHT 1985".
027600 01  CCVS-E-4.
027700     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
027800     02 FILLER                       PIC X(4)   VALUE " OF ".
027900     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
028000     02 FILLER                       PIC X(40)  VALUE
028100      "  TESTS WERE EXECUTED SUCCESSFULLY".
028200 01  XXINFO.
028300     02 FILLER                       PIC X(19)  VALUE
028400            "*** INFORMATION ***".
028500     02 INFO-TEXT.
028600       04 FILLER                     PIC X(8)   VALUE SPACE.
028700       04 XXCOMPUTED                 PIC X(20).
028800       04 FILLER                     PIC X(5)   VALUE SPACE.
028900       04 XXCORRECT                  PIC X(20).
029000     02 INF-ANSI-REFERENCE           PIC X(48).
029100 01  HYPHEN-LINE.
029200     02 FILLER  PIC IS X VALUE IS SPACE.
029300     02 FILLER  PIC IS X(65)    VALUE IS "************************
029400-    "*****************************************".
029500     02 FILLER  PIC IS X(54)    VALUE IS "************************
029600-    "******************************".
029700 01  CCVS-PGM-ID                     PIC X(9)   VALUE
029800     "ST132A".
029900 PROCEDURE DIVISION.
030000 CCVS1 SECTION.
030100 OPEN-FILES.
030200     OPEN    OUTPUT PRINT-FILE.
030300     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
030400     MOVE    SPACE TO TEST-RESULTS.
030500     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
030600     MOVE    ZERO TO REC-SKL-SUB.
030700     PERFORM CCVS-INIT-FILE 9 TIMES.
030800 CCVS-INIT-FILE.
030900     ADD     1 TO REC-SKL-SUB.
031000     MOVE    FILE-RECORD-INFO-SKELETON
031100          TO FILE-RECORD-INFO (REC-SKL-SUB).
031200 CCVS-INIT-EXIT.
031300     GO TO CCVS1-EXIT.
031400 CLOSE-FILES.
031500     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
031600 TERMINATE-CCVS.
031700S    EXIT PROGRAM.
031800STERMINATE-CALL.
031900     STOP     RUN.
032000 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
032100 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
032200 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
032300 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
032400     MOVE "****TEST DELETED****" TO RE-MARK.
032500 PRINT-DETAIL.
032600     IF REC-CT NOT EQUAL TO ZERO
032700             MOVE "." TO PARDOT-X
032800             MOVE REC-CT TO DOTVALUE.
032900     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
033000     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
033100        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
033200          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
033300     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
033400     MOVE SPACE TO CORRECT-X.
033500     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
033600     MOVE     SPACE TO RE-MARK.
033700 HEAD-ROUTINE.
033800     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
033900     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034000     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
034100     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
034200 COLUMN-NAMES-ROUTINE.
034300     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034400     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
034600 END-ROUTINE.
034700     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
034800 END-RTN-EXIT.
034900     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035000 END-ROUTINE-1.
035100      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
035200      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
035300      ADD PASS-COUNTER TO ERROR-HOLD.
035400*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
035500      MOVE PASS-COUNTER TO CCVS-E-4-1.
035600      MOVE ERROR-HOLD TO CCVS-E-4-2.
035700      MOVE CCVS-E-4 TO CCVS-E-2-2.
035800      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
035900  END-ROUTINE-12.
036000      MOVE "TEST(S) FAILED" TO ENDER-DESC.
036100     IF       ERROR-COUNTER IS EQUAL TO ZERO
036200         MOVE "NO " TO ERROR-TOTAL
036300         ELSE
036400         MOVE ERROR-COUNTER TO ERROR-TOTAL.
036500     MOVE     CCVS-E-2 TO DUMMY-RECORD.
036600     PERFORM WRITE-LINE.
036700 END-ROUTINE-13.
036800     IF DELETE-COUNTER IS EQUAL TO ZERO
036900         MOVE "NO " TO ERROR-TOTAL  ELSE
037000         MOVE DELETE-COUNTER TO ERROR-TOTAL.
037100     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
037200     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037300      IF   INSPECT-COUNTER EQUAL TO ZERO
037400          MOVE "NO " TO ERROR-TOTAL
037500      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
037600      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
037700      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037800     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037900 WRITE-LINE.
038000     ADD 1 TO RECORD-COUNT.
038100Y    IF RECORD-COUNT GREATER 42
038200Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
038300Y        MOVE SPACE TO DUMMY-RECORD
038400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
038500Y        MOVE CCVS-H-1  TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
038600Y        MOVE CCVS-H-2A TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
038700Y        MOVE CCVS-H-2B TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
038800Y        MOVE CCVS-H-3  TO DUMMY-RECORD PERFORM WRT-LN 3 TIMES
038900Y        MOVE CCVS-C-1  TO DUMMY-RECORD PERFORM WRT-LN
039000Y        MOVE CCVS-C-2  TO DUMMY-RECORD PERFORM WRT-LN
039100Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
039200Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
039300Y        MOVE ZERO TO RECORD-COUNT.
039400     PERFORM WRT-LN.
039500 WRT-LN.
039600     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
039700     MOVE SPACE TO DUMMY-RECORD.
039800 BLANK-LINE-PRINT.
039900     PERFORM WRT-LN.
040000 FAIL-ROUTINE.
040100     IF     COMPUTED-X NOT EQUAL TO SPACE
040200            GO TO   FAIL-ROUTINE-WRITE.
040300     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
040400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
040500     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
040600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040700     MOVE   SPACES TO INF-ANSI-REFERENCE.
040800     GO TO  FAIL-ROUTINE-EX.
040900 FAIL-ROUTINE-WRITE.
041000     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
041100     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
041200     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
041300     MOVE   SPACES TO COR-ANSI-REFERENCE.
041400 FAIL-ROUTINE-EX. EXIT.
041500 BAIL-OUT.
041600     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
041700     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
041800 BAIL-OUT-WRITE.
041900     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
042000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
042100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
042200     MOVE   SPACES TO INF-ANSI-REFERENCE.
042300 BAIL-OUT-EX. EXIT.
042400 CCVS1-EXIT.
042500     EXIT.
042600 SRT-4 SECTION.
042700 FOURTH-SORT.
042800     SORT SORT4
042900         DESCENDING S4-KEY1 S4-KEY2
043000             INPUT PROCEDURE SRT-4-INPUT
043100             OUTPUT PROCEDURE SRT-4-OUTPUT.
043200     GO TO SRT-5.
043300 SRT-4-INPUT SECTION.
043400 P1-CREATE-S4.
043500     ADD C1 TO SUBSCRIPT-1.
043600     PERFORM P3-CREATE-S4 2 TIMES.
043700 P2-CREATE-S4.
043800     PERFORM P1-CREATE-S4.
043900     GO TO SRT-4-IN-EXIT.
044000 P3-CREATE-S4.
044100     MOVE ALPHA-TBL (SUBSCRIPT-1) TO WKEY-1A.
044200     MOVE C0 TO SUBSCRIPT-2.
044300     PERFORM P4-CREATE-S4 25 TIMES.
044400 P4-CREATE-S4.
044500     ADD C1 TO SUBSCRIPT-2.
044600     MOVE ALPHA-TBL (SUBSCRIPT-2) TO WKEY-1B.
044700     MOVE WKEYS TO S4.
044800     RELEASE S4.
044900     IF WKEY-2B IS EQUAL TO 9
045000         IF WKEY-2A IS EQUAL TO 9
045100             MOVE 0 TO WKEY-2A
045200         ELSE
045300             ADD C1 TO WKEY-2A
045400         END-IF
045500         MOVE C0 TO WKEY-2B
045600     ELSE ADD C1 TO WKEY-2B.
045700 SRT-4-IN-EXIT.
045800     EXIT.
045900 SRT-4-OUTPUT SECTION.
046000 OPEN-SRT4-OUT.
046100     OPEN     OUTPUT FILE4.
046200     MOVE     "SORT, OUTPUT PROC" TO FEATURE.
046300 SORT-TEST-16.
046400     PERFORM  RETURN-SORT4.
046500     IF       S4-KEYS EQUAL TO "PQRBABCDEZ7912345679"
046600              PERFORM PASS-1 GO TO SORT-WRITE-16.
046700     GO       TO SORT-FAIL-16.
046800 SORT-DELETE-16.
046900     PERFORM  DE-LETE-1.
047000     GO       TO SORT-WRITE-16.
047100 SORT-FAIL-16.
047200     MOVE     S4-KEYS TO COMPUTED-A.
047300     MOVE     "PQRBABCDEZ7912345679" TO CORRECT-A.
047400     PERFORM  FAIL-1.
047500 SORT-WRITE-16.
047600     MOVE     "SORT-TEST-16" TO PAR-NAME.
047700     PERFORM  PRINT-DETAIL-1.
047800 SORT-TEST-17.
047900     PERFORM  RETURN-SORT4 59 TIMES.
048000     IF       S4-KEYS EQUAL TO "PQRAABCDEV7212345670"
048100              PERFORM PASS-1 GO TO SORT-WRITE-17.
048200     GO       TO SORT-FAIL-17.
048300 SORT-DELETE-17.
048400     PERFORM  DE-LETE-1.
048500     GO       TO SORT-WRITE-17.
048600 SORT-FAIL-17.
048700     MOVE     S4-KEYS TO COMPUTED-A.
048800     MOVE     "PQRAABCDEV7212345670" TO CORRECT-A.
048900     PERFORM  FAIL-1.
049000 SORT-WRITE-17.
049100     MOVE     "SORT-TEST-17" TO PAR-NAME.
049200     PERFORM  PRINT-DETAIL-1.
049300 SORT-TEST-18.
049400H    CLOSE    FILE4 REEL.
049500
049600I    MOVE     "MINOR *CLOSE REEL* DELETED" TO RE-MARK.
049700*        NOTE CLOSE REEL DELETED FOR THIS RUN    XXXXX     XXXXX.
049800     PERFORM  RETURN-SORT4 40 TIMES.
049900     IF       S4-KEYS EQUAL TO "PQRAABCDEA7012345670"
050000              PERFORM PASS-1 GO TO SORT-WRITE-18.
050100     GO       TO SORT-FAIL-18.
050200 SORT-DELETE-18.
050300     PERFORM  DE-LETE-1.
050400     GO       TO SORT-WRITE-18.
050500 SORT-FAIL-18.
050600     MOVE     S4-KEYS TO COMPUTED-A.
050700     MOVE     "PQRAABCDEA7012345670" TO CORRECT-A.
050800     PERFORM  FAIL-1.
050900 SORT-WRITE-18.
051000     MOVE     "SORT-TEST-18" TO PAR-NAME.
051100     PERFORM  PRINT-DETAIL-1.
051200 CLOSE-1.
051300     CLOSE    FILE4.
051400     GO       TO EXIT-1.
051500 RETURN-SORT4.
051600     RETURN   SORT4 RECORD INTO R4 AT END GO TO TERMINAL-1.
051700*    NOTE     RETURN WITH ALL OPTIONAL WORDS.
051800     WRITE    R4.
051900 TERMINAL-1.
052000     PERFORM  FAIL-1.
052100     MOVE     "TERMINAL-1" TO PAR-NAME.
052200     MOVE     "END OF FILE PREMATURELY" TO RE-MARK.
052300     PERFORM  PRINT-DETAIL-1.
052400     MOVE     SPACE TO FEATURE.
052500     MOVE     "FOUND, PREVIOUS TEST WAS" TO RE-MARK.
052600     PERFORM  PRINT-DETAIL-1.
052700     MOVE     "LAST SUCCESSFUL TEST" TO RE-MARK.
052800     PERFORM  PRINT-DETAIL-1.
052900     GO       TO CLOSE-1.
053000 INSPT-1. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
053100 PASS-1.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
053200 FAIL-1.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
053300 DE-LETE-1.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
053400     MOVE "****TEST DELETED****" TO RE-MARK.
053500 PRINT-DETAIL-1.
053600     IF REC-CT NOT EQUAL TO ZERO
053700             MOVE "." TO PARDOT-X
053800             MOVE REC-CT TO DOTVALUE.
053900     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE-1.
054000     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE-1
054100        PERFORM FAIL-ROUTINE-1 THRU FAIL-ROUTINE-EX-1
054200          ELSE PERFORM BAIL-OUT-1 THRU BAIL-OUT-EX-1.
054300     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
054400     MOVE SPACE TO CORRECT-X.
054500     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
054600     MOVE     SPACE TO RE-MARK.
054700 WRITE-LINE-1.
054800     ADD 1 TO RECORD-COUNT.
054900Y    IF RECORD-COUNT GREATER 50
055000Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
055100Y        MOVE SPACE TO DUMMY-RECORD
055200Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
055300Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN-1
055400Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN-1 2 TIMES
055500Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN-1
055600Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
055700Y        MOVE ZERO TO RECORD-COUNT.
055800     PERFORM WRT-LN-1.
055900 WRT-LN-1.
056000     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
056100     MOVE SPACE TO DUMMY-RECORD.
056200 BLANK-LINE-PRINT-1.
056300     PERFORM WRT-LN-1.
056400 FAIL-ROUTINE-1.
056500     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-1.
056600     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-1.
056700     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
056800     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-1 2 TIMES.
056900     GO TO FAIL-ROUTINE-EX-1.
057000 FAIL-RTN-WRITE-1.
057100     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE-1
057200     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE-1 2 TIMES.
057300 FAIL-ROUTINE-EX-1. EXIT.
057400 BAIL-OUT-1.
057500     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE-1.
057600     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX-1.
057700 BAIL-OUT-WRITE-1.
057800     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
057900     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-1 2 TIMES.
058000 BAIL-OUT-EX-1. EXIT.
058100 EXIT-1.
058200     EXIT.
058300 SRT-5 SECTION.
058400 FIFTH-SORT.
058500     SORT SORT5
058600         ASCENDING S5-KEY1 S5-KEY2
058700             USING FILE4
058800             OUTPUT PROCEDURE SRT-5-OUTPUT.
058900     GO TO SRT-6.
059000 SRT-5-OUTPUT SECTION.
059100 OPEN-SRT5-OUT.
059200     OPEN     OUTPUT FILE4.
059300     MOVE     "SORT, OUTPUT PROC" TO FEATURE.
059400 SORT-TEST-19.
059500     PERFORM  RETURN-SORT5.
059600     IF       S5-KEYS EQUAL TO "PQRAABCDEA7012345670"
059700              PERFORM PASS-2 GO TO SORT-WRITE-19.
059800     GO       TO SORT-FAIL-19.
059900 SORT-DELETE-19.
060000     PERFORM  DE-LETE-2.
060100     GO       TO SORT-WRITE-19.
060200 SORT-FAIL-19.
060300     MOVE     S5-KEYS TO COMPUTED-A.
060400     MOVE     "PQRAABCDEA7012345670" TO CORRECT-A.
060500     PERFORM  FAIL-2.
060600 SORT-WRITE-19.
060700     MOVE     "SORT-TEST-19" TO PAR-NAME.
060800     PERFORM  PRINT-DETAIL-2.
060900 SORT-TEST-20.
061000     PERFORM  RETURN-SORT5 99 TIMES.
061100     IF       S5-KEYS EQUAL TO "PQRBABCDEZ7912345679"
061200              PERFORM PASS-2 GO TO SORT-WRITE-20.
061300     GO       TO SORT-FAIL-20.
061400 SORT-DELETE-20.
061500     PERFORM  DE-LETE-2.
061600     GO       TO SORT-WRITE-20.
061700 SORT-FAIL-20.
061800     MOVE     S5-KEYS TO COMPUTED-A.
061900     MOVE     "PQRBABCDEZ7912345679" TO CORRECT-A.
062000     PERFORM  FAIL-2.
062100 SORT-WRITE-20.
062200     MOVE     "SORT-TEST-20" TO PAR-NAME.
062300     PERFORM  PRINT-DETAIL-2.
062400 CLOSE-2.
062500     CLOSE    FILE4.
062600     GO       TO EXIT-2.
062700 RETURN-SORT5.
062800     RETURN   SORT5 INTO R4 END GO TO TERMINAL-2.
062900*    NOTE     RETURN WITHOUT OPTIONAL WORDS.
063000     WRITE    R4.
063100 TERMINAL-2.
063200     PERFORM  FAIL-2.
063300     MOVE     "TERMINAL-2" TO PAR-NAME.
063400     MOVE     "END OF FILE PREMATURELY" TO RE-MARK.
063500     PERFORM  PRINT-DETAIL-2.
063600     MOVE     SPACE TO FEATURE.
063700     MOVE     "FOUND, PREVIOUS TEST WAS" TO RE-MARK.
063800     PERFORM  PRINT-DETAIL-2.
063900     MOVE     "LAST SUCCESSFUL TEST." TO RE-MARK.
064000     PERFORM  PRINT-DETAIL-2.
064100     GO       TO CLOSE-2.
064200 INSPT-2. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
064300 PASS-2.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
064400 FAIL-2.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
064500 DE-LETE-2.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
064600     MOVE "****TEST DELETED****" TO RE-MARK.
064700 PRINT-DETAIL-2.
064800     IF REC-CT NOT EQUAL TO ZERO
064900             MOVE "." TO PARDOT-X
065000             MOVE REC-CT TO DOTVALUE.
065100     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE-2.
065200     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE-2
065300        PERFORM FAIL-ROUTINE-2 THRU FAIL-ROUTINE-EX-2
065400          ELSE PERFORM BAIL-OUT-2 THRU BAIL-OUT-EX-2.
065500     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
065600     MOVE SPACE TO CORRECT-X.
065700     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
065800     MOVE     SPACE TO RE-MARK.
065900 WRITE-LINE-2.
066000     ADD 1 TO RECORD-COUNT.
066100Y    IF RECORD-COUNT GREATER 50
066200Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
066300Y        MOVE SPACE TO DUMMY-RECORD
066400Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
066500Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN-2
066600Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN-2 2 TIMES
066700Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN-2
066800Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
066900Y        MOVE ZERO TO RECORD-COUNT.
067000     PERFORM WRT-LN-2.
067100 WRT-LN-2.
067200     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
067300     MOVE SPACE TO DUMMY-RECORD.
067400 BLANK-LINE-PRINT-2.
067500     PERFORM WRT-LN-2.
067600 FAIL-ROUTINE-2.
067700     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-2.
067800     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-2.
067900     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
068000     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-2 2 TIMES.
068100     GO TO FAIL-ROUTINE-EX-2.
068200 FAIL-RTN-WRITE-2.
068300     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE-2
068400     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE-2 2 TIMES.
068500 FAIL-ROUTINE-EX-2. EXIT.
068600 BAIL-OUT-2.
068700     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE-2.
068800     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX-2.
068900 BAIL-OUT-WRITE-2.
069000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
069100     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-2 2 TIMES.
069200 BAIL-OUT-EX-2. EXIT.
069300 EXIT-2.
069400     EXIT.
069500 SRT-6 SECTION.
069600 SIXTH-SORT.
069700     SORT SORT4
069800         ASCENDING S4-KEY2
069900             USING FILE4
070000             OUTPUT PROCEDURE SRT-6-OUTPUT.
070100 STOP-RUN.
070200     GO TO    CCVS-EXIT.
070300 SRT-6-OUTPUT SECTION.
070400 SORT-TEST-21.
070500     PERFORM  PASS-3.
070600     MOVE     "2 SORTS ON ONE FILE" TO FEATURE.
070700     MOVE     "SORT-TEST-21" TO PAR-NAME.
070800     PERFORM  PRINT-DETAIL-3.
070900*    NOTE     THIS TESTS THE ABILITY TO SORT A FILE A SECOND TIME.
071000     GO       TO EXIT-3.
071100 RETURN-FOR-THE-HELLUVIT.
071200     RETURN   SORT4 AT END GO TO PASS-3.
071300*        NOTE THE STANDARD REQUIRES THAT EVERY OUTPUT PROCEDURE
071400*             HAVE AT LEAST ONE RETURN STATEMENT --- THE ABOVE
071500*             STATEMENT IS COMPILED BUT NEVER EXECUTED.
071600 PASS-3.
071700     MOVE "PASS" TO P-OR-F.  ADD 1 TO PASS-COUNTER.
071800 FAIL-3.
071900     ADD      1 TO ERROR-COUNTER.
072000     MOVE "FAIL*" TO P-OR-F.
072100 DE-LETE-3.
072200     MOVE     SPACE TO P-OR-F.
072300     MOVE     "    ************    " TO COMPUTED-A.
072400     MOVE     "    ************    " TO CORRECT-A.
072500     MOVE "****TEST DELETED****" TO RE-MARK.
072600     ADD 1 TO DELETE-COUNTER.
072700 PRINT-DETAIL-3.
072800     IF REC-CT NOT EQUAL TO ZERO
072900             MOVE "." TO PARDOT-X
073000             MOVE REC-CT TO DOTVALUE.
073100     MOVE     TEST-RESULTS TO PRINT-REC.
073200     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
073300     MOVE     SPACE TO P-OR-F.
073400     MOVE     SPACE TO COMPUTED-A.
073500     MOVE SPACE TO CORRECT-A.
073600     IF     REC-CT EQUAL TO ZERO
073700              MOVE SPACE TO PAR-NAME.
073800     MOVE     SPACE TO RE-MARK.
073900 EXIT-3.
074000     EXIT.
074100 CCVS-EXIT SECTION.
074200 CCVS-999999.
074300     GO TO CLOSE-FILES.
