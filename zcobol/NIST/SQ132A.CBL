000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ132A.
000400***************************************************************
000500*                                                             *
000600*    VALIDATION FOR:-                                         *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 4.2.                                *
000900*                                                             *
001000*    CREATION DATE     /     VALIDATION DATE                  *
001100*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001200*                                                             *
001300***************************************************************
001400*                                                             *
001500*      X-CARDS USED BY THIS PROGRAM ARE :-                    *
001600*                                                             *
001700*            X-14   SEQUENTIAL MASS STORAGE FILE.             *
001800*            X-55   SYSTEM PRINTER                            *
001900*            X-82   SOURCE-COMPUTER                           *
002000*            X-83   OBJECT-COMPUTER                           *
002100*            X-84   LABEL RECORDS OPTION                      *
002200*                                                             *
002300***************************************************************
002400*                                                             *
002500*    THIS PROGRAM CHECKS FOR THE CORRECT RESPONSE TOCLOSING   *
002600*    AN UNOPENED FILE.  THE TEST FOR CORRECT I-O STATUS CODE  *
002700*    42 IS IN THE DECLARATIVES.  AN ABNORMAL TERMINATION IS   *
002800*    POSSIBLE AFTER THE TEST OF THE I-O STATUS CODE IS        *
002900*    ACCOMPLISHED BUT BEFORE CONTROL IS RETURNED TO THE MAIN  *
003000*    LINE CODE.                                               *
003100*                                                             *
003200***************************************************************
003300*
003400 ENVIRONMENT DIVISION.
003500 CONFIGURATION SECTION.
003600 SOURCE-COMPUTER.
003700     XXXXX082.
003800 OBJECT-COMPUTER.
003900     XXXXX083.
004000*
004100 INPUT-OUTPUT SECTION.
004200 FILE-CONTROL.
004300     SELECT PRINT-FILE ASSIGN TO
004400     XXXXX055.
004500*
004600     SELECT SQ-FS1 ASSIGN TO
004700     XXXXX014
004800            FILE STATUS SQ-FS1-STATUS.
004900*
005000*
005100 DATA DIVISION.
005200 FILE SECTION.
005300 FD  PRINT-FILE
005400C    LABEL RECORDS
005500C    XXXXX084
005600C    DATA RECORD IS PRINT-REC DUMMY-RECORD
005700               .
005800 01  PRINT-REC    PICTURE X(120).
005900 01  DUMMY-RECORD PICTURE X(120).
006000*
006100 FD  SQ-FS1
006200C    LABEL RECORD IS STANDARD
006300                .
006400 01  SQ-FS1R1-F-G-120 PIC X(120).
006500*
006600 WORKING-STORAGE SECTION.
006700*
006800**************************************************************
006900*                                                            *
007000*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE  *
007100*                                                            *
007200**************************************************************
007300*
007400 01  SQ-FS1-STATUS.
007500   03  SQ-FS1-KEY-1   PIC X.
007600   03  SQ-FS1-KEY-2   PIC X.
007700*
007800**************************************************************
007900*                                                            *
008000*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS             *
008100*                                                            *
008200**************************************************************
008300*
008400 01  REC-SKEL-SUB   PIC 99.
008500*
008600 01  FILE-RECORD-INFORMATION-REC.
008700     03 FILE-RECORD-INFO-SKELETON.
008800        05 FILLER                 PICTURE X(48)       VALUE
008900             "FILE=      ,RECORD=     /0,RECNO=000000,UPDT=00".
009000        05 FILLER                 PICTURE X(46)       VALUE
009100             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ =0000".
009200        05 FILLER                 PICTURE X(26)       VALUE
009300             ",LFIL=000000,ORG=  ,LBLR= ".
009400        05 FILLER                 PICTURE X(37)       VALUE
009500             ",RECKEY=                             ".
009600        05 FILLER                 PICTURE X(38)       VALUE
009700             ",ALTKEY1=                             ".
009800        05 FILLER                 PICTURE X(38)       VALUE
009900             ",ALTKEY2=                             ".
010000        05 FILLER                 PICTURE X(7)       VALUE SPACE.
010100     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
010200        05 FILE-RECORD-INFO-P1-120.
010300           07 FILLER              PIC X(5).
010400           07 XFILE-NAME          PIC X(6).
010500           07 FILLER              PIC X(8).
010600           07 XRECORD-NAME        PIC X(6).
010700           07 FILLER              PIC X(1).
010800           07 REELUNIT-NUMBER     PIC 9(1).
010900           07 FILLER              PIC X(7).
011000           07 XRECORD-NUMBER      PIC 9(6).
011100           07 FILLER              PIC X(6).
011200           07 UPDATE-NUMBER       PIC 9(2).
011300           07 FILLER              PIC X(5).
011400           07 ODO-NUMBER          PIC 9(4).
011500           07 FILLER              PIC X(5).
011600           07 XPROGRAM-NAME       PIC X(5).
011700           07 FILLER              PIC X(7).
011800           07 XRECORD-LENGTH      PIC 9(6).
011900           07 FILLER              PIC X(7).
012000           07 CHARS-OR-RECORDS    PIC X(2).
012100           07 FILLER              PIC X(1).
012200           07 XBLOCK-SIZE         PIC 9(4).
012300           07 FILLER              PIC X(6).
012400           07 RECORDS-IN-FILE     PIC 9(6).
012500           07 FILLER              PIC X(5).
012600           07 XFILE-ORGANIZATION  PIC X(2).
012700           07 FILLER              PIC X(6).
012800           07 XLABEL-TYPE         PIC X(1).
012900        05 FILE-RECORD-INFO-P121-240.
013000           07 FILLER              PIC X(8).
013100           07 XRECORD-KEY         PIC X(29).
013200           07 FILLER              PIC X(9).
013300           07 ALTERNATE-KEY1      PIC X(29).
013400           07 FILLER              PIC X(9).
013500           07 ALTERNATE-KEY2      PIC X(29).
013600           07 FILLER              PIC X(7).
013700*
013800 01  TEST-RESULTS.
013900     02 FILLER              PIC X      VALUE SPACE.
014000     02  PAR-NAME.
014100       03 FILLER              PIC X(14)  VALUE SPACE.
014200       03 PARDOT-X            PIC X      VALUE SPACE.
014300       03 DOTVALUE            PIC 99     VALUE ZERO.
014400     02 FILLER              PIC X      VALUE SPACE.
014500     02 FEATURE             PIC X(24)  VALUE SPACE.
014600     02 FILLER              PIC X      VALUE SPACE.
014700     02 P-OR-F              PIC X(5)   VALUE SPACE.
014800     02 FILLER              PIC X(9)   VALUE SPACE.
014900     02 RE-MARK             PIC X(61).
015000 01  TEST-COMPUTED.
015100   02 FILLER  PIC X(30)  VALUE SPACE.
015200   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
015300   02 COMPUTED-X.
015400     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
015500     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
015600     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
015700     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
015800     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
015900     03       CM-18V0 REDEFINES COMPUTED-A.
016000        04 COMPUTED-18V0                   PIC -9(18).
016100        04 FILLER                          PIC X.
016200     03 FILLER PIC X(50) VALUE SPACE.
016300 01  TEST-CORRECT.
016400     02 FILLER PIC X(30) VALUE SPACE.
016500     02 FILLER PIC X(17) VALUE "       CORRECT =".
016600     02 CORRECT-X.
016700     03 CORRECT-A                  PIC X(20) VALUE SPACE.
016800     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
016900     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
017000     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
017100     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
017200     03      CR-18V0 REDEFINES CORRECT-A.
017300         04 CORRECT-18V0                     PIC -9(18).
017400         04 FILLER                           PIC X.
017500     03 FILLER PIC X(2) VALUE SPACE.
017600     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
017700*
017800 01  CCVS-C-1.
017900     02 FILLER  PIC IS X        VALUE  SPACE.
018000     02 FILLER  PIC IS X(17)    VALUE "PARAGRAPH-NAME".
018100     02 FILLER  PIC IS X        VALUE  SPACE.
018200     02 FILLER  PIC IS X(24)    VALUE IS "FEATURE".
018300     02 FILLER  PIC IS X        VALUE  SPACE.
018400     02 FILLER  PIC IS X(5)     VALUE "PASS ".
018500     02 FILLER  PIC IS X(9)     VALUE  SPACE.
018600     02 FILLER  PIC IS X(62)    VALUE "REMARKS".
018700 01  CCVS-C-2.
018800     02 FILLER  PIC X(19)  VALUE  SPACE.
018900     02 FILLER  PIC X(6)   VALUE "TESTED".
019000     02 FILLER  PIC X(19)  VALUE  SPACE.
019100     02 FILLER  PIC X(4)   VALUE "FAIL".
019200     02 FILLER  PIC X(72)  VALUE  SPACE.
019300*
019400 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
019500 01  REC-CT            PIC 99       VALUE ZERO.
019600 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
019700 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
019800 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
019900 01  PASS-COUNTER      PIC 999      VALUE ZERO.
020000 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
020100 01  ERROR-HOLD        PIC 999      VALUE ZERO.
020200 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
020300 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
020400 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
020500 01  CCVS-H-1.
020600     02  FILLER          PIC X(39)    VALUE SPACES.
020700     02  FILLER          PIC X(42)    VALUE
020800     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
020900     02  FILLER          PIC X(39)    VALUE SPACES.
021000 01  CCVS-H-2A.
021100   02  FILLER            PIC X(40)  VALUE SPACE.
021200   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
021300   02  FILLER            PIC XXXX   VALUE
021400     "4.2 ".
021500   02  FILLER            PIC X(28)  VALUE
021600            " COPY - NOT FOR DISTRIBUTION".
021700   02  FILLER            PIC X(41)  VALUE SPACE.
021800*
021900 01  CCVS-H-2B.
022000   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF".
022100   02  TEST-ID           PIC X(9).
022200   02  FILLER            PIC X(4)   VALUE " IN ".
022300   02  FILLER            PIC X(12)  VALUE
022400     " HIGH       ".
022500   02  FILLER            PIC X(22)  VALUE
022600            " LEVEL VALIDATION FOR ".
022700   02  FILLER            PIC X(58)  VALUE
022800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
022900 01  CCVS-H-3.
023000     02  FILLER          PIC X(34)  VALUE
023100            " FOR OFFICIAL USE ONLY    ".
023200     02  FILLER          PIC X(58)  VALUE
023300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
023400     02  FILLER          PIC X(28)  VALUE
023500            "  COPYRIGHT   1985,1986 ".
023600 01  CCVS-E-1.
023700     02 FILLER           PIC X(52)  VALUE SPACE.
023800     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
023900     02 ID-AGAIN         PIC X(9).
024000     02 FILLER           PIC X(45)  VALUE SPACES.
024100 01  CCVS-E-2.
024200     02  FILLER          PIC X(31)  VALUE SPACE.
024300     02  FILLER          PIC X(21)  VALUE SPACE.
024400     02  CCVS-E-2-2.
024500         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
024600         03 FILLER         PIC X      VALUE SPACE.
024700         03 ENDER-DESC     PIC X(44)  VALUE
024800            "ERRORS ENCOUNTERED".
024900 01  CCVS-E-3.
025000     02  FILLER          PIC X(22)  VALUE
025100            " FOR OFFICIAL USE ONLY".
025200     02  FILLER          PIC X(12)  VALUE SPACE.
025300     02  FILLER          PIC X(58)  VALUE
025400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025500     02  FILLER          PIC X(8)   VALUE SPACE.
025600     02  FILLER          PIC X(20)  VALUE
025700             " COPYRIGHT 1985,1986".
025800 01  CCVS-E-4.
025900     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
026000     02 FILLER           PIC X(4)   VALUE " OF ".
026100     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
026200     02 FILLER           PIC X(40)  VALUE
026300      "  TESTS WERE EXECUTED SUCCESSFULLY".
026400 01  XXINFO.
026500     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
026600     02 INFO-TEXT.
026700       04 FILLER             PIC X(8)   VALUE SPACE.
026800       04 XXCOMPUTED         PIC X(20).
026900       04 FILLER             PIC X(5)   VALUE SPACE.
027000       04 XXCORRECT          PIC X(20).
027100     02 INF-ANSI-REFERENCE PIC X(48).
027200 01  HYPHEN-LINE.
027300     02 FILLER  PIC IS X VALUE IS SPACE.
027400     02 FILLER  PIC IS X(65)   VALUE IS  "************************
027500-    "*****************************************".
027600     02 FILLER  PIC IS X(54)   VALUE IS  "************************
027700-    "******************************".
027800 01  CCVS-PGM-ID  PIC X(9)   VALUE
027900     "SQ132A".
028000*
028100*
028200 PROCEDURE DIVISION.
028300 DECLARATIVES.
028400 SQ132A-DECLARATIVE-001-SECT SECTION.
028500     USE AFTER STANDARD ERROR PROCEDURE SQ-FS1.
028600 SQ-FS1-ERROR-PROCEDURE.
028700 DECL-CLOSE-01.
028800     IF SQ-FS1-STATUS = "42"
028900         PERFORM DECL-PASS
029000         GO TO DECL-ABNORMAL-TERM
029100     ELSE
029200         MOVE   "42"           TO CORRECT-A
029300         MOVE    SQ-FS1-STATUS TO COMPUTED-A
029400         MOVE   "STATUS FOR CLOSE OF UNOPENED FILE INCORRECT"
029500                   TO RE-MARK
029600         PERFORM DECL-FAIL
029700         GO TO DECL-ABNORMAL-TERM
029800     END-IF.
029900*
030000 DECL-PASS.
030100     MOVE   "PASS " TO P-OR-F.
030200     ADD     1 TO PASS-COUNTER.
030300     PERFORM DECL-PRINT-DETAIL.
030400*
030500 DECL-FAIL.
030600     MOVE   "FAIL*" TO P-OR-F.
030700     ADD     1 TO ERROR-COUNTER.
030800     PERFORM DECL-PRINT-DETAIL.
030900*
031000 DECL-PRINT-DETAIL.
031100     IF REC-CT NOT EQUAL TO ZERO
031200             MOVE "." TO PARDOT-X
031300             MOVE REC-CT TO DOTVALUE.
031400     MOVE    TEST-RESULTS TO PRINT-REC.
031500     PERFORM DECL-WRITE-LINE.
031600     IF P-OR-F EQUAL TO "FAIL*"
031700         PERFORM DECL-WRITE-LINE
031800         PERFORM DECL-FAIL-ROUTINE THRU DECL-FAIL-EX
031900     ELSE
032000         PERFORM DECL-BAIL THRU DECL-BAIL-EX.
032100     MOVE    SPACE TO P-OR-F.
032200     MOVE    SPACE TO COMPUTED-X.
032300     MOVE    SPACE TO CORRECT-X.
032400     IF REC-CT EQUAL TO ZERO
032500         MOVE    SPACE TO PAR-NAME.
032600     MOVE    SPACE TO RE-MARK.
032700*
032800 DECL-WRITE-LINE.
032900     ADD     1 TO RECORD-COUNT.
033000Y    IF RECORD-COUNT GREATER 50
033100Y        MOVE    DUMMY-RECORD TO DUMMY-HOLD
033200Y        MOVE    SPACE TO DUMMY-RECORD
033300Y        WRITE   DUMMY-RECORD AFTER ADVANCING PAGE
033400Y        MOVE    CCVS-C-1 TO DUMMY-RECORD PERFORM DECL-WRT-LN
033500Y        MOVE    CCVS-C-2 TO DUMMY-RECORD
033600Y        PERFORM DECL-WRT-LN 2 TIMES
033700Y        MOVE    HYPHEN-LINE TO DUMMY-RECORD
033800Y        PERFORM DECL-WRT-LN
033900Y        MOVE    DUMMY-HOLD TO DUMMY-RECORD
034000Y        MOVE    ZERO TO RECORD-COUNT.
034100     PERFORM DECL-WRT-LN.
034200*
034300 DECL-WRT-LN.
034400     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
034500     MOVE    SPACE TO DUMMY-RECORD.
034600*
034700 DECL-FAIL-ROUTINE.
034800     IF COMPUTED-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
034900     IF CORRECT-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
035000     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
035100     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
035200     MOVE    XXINFO TO DUMMY-RECORD.
035300     PERFORM DECL-WRITE-LINE 2 TIMES.
035400     MOVE    SPACES TO INF-ANSI-REFERENCE.
035500     GO TO   DECL-FAIL-EX.
035600 DECL-FAIL-WRITE.
035700     MOVE    TEST-COMPUTED TO PRINT-REC
035800     PERFORM DECL-WRITE-LINE
035900     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
036000     MOVE    TEST-CORRECT TO PRINT-REC
036100     PERFORM DECL-WRITE-LINE 2 TIMES.
036200     MOVE    SPACES TO COR-ANSI-REFERENCE.
036300 DECL-FAIL-EX.
036400     EXIT.
036500*
036600 DECL-BAIL.
036700     IF COMPUTED-A NOT EQUAL TO SPACE GO TO DECL-BAIL-WRITE.
036800     IF CORRECT-A EQUAL TO SPACE GO TO DECL-BAIL-EX.
036900 DECL-BAIL-WRITE.
037000     MOVE    CORRECT-A TO XXCORRECT.
037100     MOVE    COMPUTED-A TO XXCOMPUTED.
037200     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
037300     MOVE    XXINFO TO DUMMY-RECORD.
037400     PERFORM DECL-WRITE-LINE 2 TIMES.
037500     MOVE SPACES TO INF-ANSI-REFERENCE.
037600 DECL-BAIL-EX.
037700     EXIT.
037800*
037900 DECL-ABNORMAL-TERM.
038000     MOVE SPACE TO DUMMY-RECORD.
038100     PERFORM DECL-WRITE-LINE.
038200     MOVE "ABNORMAL TERMINATION AT THIS POINT IS ACCEPTABLE"
038300             TO DUMMY-RECORD.
038400     PERFORM DECL-WRITE-LINE 3 TIMES.
038500*
038600 END-DECLS.
038700     EXIT.
038800 END DECLARATIVES.
038900*
039000*
039100 CCVS1 SECTION.
039200 OPEN-FILES.
039300     OPEN    OUTPUT PRINT-FILE.
039400     MOVE    CCVS-PGM-ID TO TEST-ID.
039500     MOVE    CCVS-PGM-ID TO ID-AGAIN.
039600     MOVE    SPACE TO TEST-RESULTS.
039700     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
039800     MOVE    ZERO TO REC-SKEL-SUB.
039900     PERFORM CCVS-INIT-FILE 10 TIMES.
040000     GO TO CCVS1-EXIT.
040100*
040200 CCVS-INIT-FILE.
040300     ADD     1 TO REC-SKL-SUB.
040400     MOVE    FILE-RECORD-INFO-SKELETON TO
040500                  FILE-RECORD-INFO (REC-SKL-SUB).
040600*
040700 CLOSE-FILES.
040800     PERFORM END-ROUTINE THRU END-ROUTINE-13.
040900     CLOSE   PRINT-FILE.
041000 TERMINATE-CCVS.
041100     STOP    RUN.
041200*
041300 INSPT.
041400     MOVE   "INSPT" TO P-OR-F.
041500     ADD     1 TO INSPECT-COUNTER.
041600     PERFORM PRINT-DETAIL.
041700
041800 PASS.
041900     MOVE   "PASS " TO P-OR-F.
042000     ADD     1 TO PASS-COUNTER.
042100     PERFORM PRINT-DETAIL.
042200*
042300 FAIL.
042400     MOVE   "FAIL*" TO P-OR-F.
042500     ADD     1 TO ERROR-COUNTER.
042600     PERFORM PRINT-DETAIL.
042700*
042800 DE-LETE.
042900     MOVE   "****TEST DELETED****" TO RE-MARK.
043000     MOVE   "*****" TO P-OR-F.
043100     ADD     1 TO DELETE-COUNTER.
043200     PERFORM PRINT-DETAIL.
043300*
043400 PRINT-DETAIL.
043500     IF REC-CT NOT EQUAL TO ZERO
043600         MOVE   "." TO PARDOT-X
043700         MOVE    REC-CT TO DOTVALUE.
043800     MOVE    TEST-RESULTS TO PRINT-REC.
043900     PERFORM WRITE-LINE.
044000     IF P-OR-F EQUAL TO "FAIL*"
044100         PERFORM WRITE-LINE
044200         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
044300     ELSE
044400         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
044500     MOVE    SPACE TO P-OR-F.
044600     MOVE    SPACE TO COMPUTED-X.
044700     MOVE    SPACE TO CORRECT-X.
044800     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
044900     MOVE    SPACE TO RE-MARK.
045000*
045100 HEAD-ROUTINE.
045200     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045300     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045400     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
045500     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
045600 COLUMN-NAMES-ROUTINE.
045700     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
045800     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045900     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
046000 END-ROUTINE.
046100     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
046200     PERFORM WRITE-LINE 5 TIMES.
046300 END-RTN-EXIT.
046400     MOVE    CCVS-E-1 TO DUMMY-RECORD.
046500     PERFORM WRITE-LINE 2 TIMES.
046600*
046700 END-ROUTINE-1.
046800     ADD     ERROR-COUNTER   TO ERROR-HOLD
046900     ADD     INSPECT-COUNTER TO ERROR-HOLD.
047000     ADD     DELETE-COUNTER  TO ERROR-HOLD.
047100     ADD     PASS-COUNTER    TO ERROR-HOLD.
047200     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
047300     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
047400     MOVE    CCVS-E-4        TO CCVS-E-2-2.
047500     MOVE    CCVS-E-2        TO DUMMY-RECORD
047600     PERFORM WRITE-LINE.
047700     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
047800     IF ERROR-COUNTER IS EQUAL TO ZERO
047900         MOVE   "NO " TO ERROR-TOTAL
048000     ELSE
048100         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
048200     MOVE    CCVS-E-2 TO DUMMY-RECORD.
048300     PERFORM WRITE-LINE.
048400 END-ROUTINE-13.
048500     IF DELETE-COUNTER IS EQUAL TO ZERO
048600         MOVE   "NO " TO ERROR-TOTAL
048700     ELSE
048800         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
048900     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
049000     MOVE    CCVS-E-2 TO DUMMY-RECORD.
049100     PERFORM WRITE-LINE.
049200     IF INSPECT-COUNTER EQUAL TO ZERO
049300         MOVE   "NO " TO ERROR-TOTAL
049400     ELSE
049500         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
049600     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
049700     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
049800     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
049900*
050000 WRITE-LINE.
050100     ADD     1 TO RECORD-COUNT.
050200Y    IF RECORD-COUNT GREATER 50
050300Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
050400Y        MOVE  SPACE TO DUMMY-RECORD
050500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
050600Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
050700Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
050800Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
050900Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
051000Y        MOVE  ZERO TO RECORD-COUNT.
051100     PERFORM WRT-LN.
051200*
051300 WRT-LN.
051400     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
051500     MOVE    SPACE TO DUMMY-RECORD.
051600 BLANK-LINE-PRINT.
051700     PERFORM WRT-LN.
051800 FAIL-ROUTINE.
051900     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
052000     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
052100     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
052200     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
052300     MOVE    XXINFO TO DUMMY-RECORD.
052400     PERFORM WRITE-LINE 2 TIMES.
052500     MOVE    SPACES TO INF-ANSI-REFERENCE.
052600     GO TO   FAIL-ROUTINE-EX.
052700 FAIL-ROUTINE-WRITE.
052800     MOVE    TEST-COMPUTED  TO PRINT-REC
052900     PERFORM WRITE-LINE
053000     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
053100     MOVE    TEST-CORRECT   TO PRINT-REC
053200     PERFORM WRITE-LINE 2 TIMES.
053300     MOVE    SPACES         TO COR-ANSI-REFERENCE.
053400 FAIL-ROUTINE-EX.
053500     EXIT.
053600 BAIL-OUT.
053700     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
053800     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
053900 BAIL-OUT-WRITE.
054000     MOVE    CORRECT-A      TO XXCORRECT.
054100     MOVE    COMPUTED-A     TO XXCOMPUTED.
054200     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
054300     MOVE    XXINFO TO DUMMY-RECORD.
054400     PERFORM WRITE-LINE 2 TIMES.
054500     MOVE    SPACES TO INF-ANSI-REFERENCE.
054600 BAIL-OUT-EX.
054700     EXIT.
054800 CCVS1-EXIT.
054900     EXIT.
055000*
055100***************************************************************
055200*                                                             *
055300*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND*
055400*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.       *
055500*                                                             *
055600***************************************************************
055700*
055800 SECT-SQ132A-0001 SECTION.
055900*
056000*    THIS TEST CLOSES A FILE THAT HAS NEVER BEEN OPENED.
056100*    I-O STATUS CODE 42 SHOULD BE GENERATED.
056200*
056300 CLOSE-INIT-O1.
056400     MOVE   "CLOSED UNOPENED FILE" TO FEATURE.
056500     MOVE   "**" TO SQ-FS1-STATUS.
056600     MOVE   "CLOS-TEST-01" TO PAR-NAME.
056700     MOVE   1 TO REC-CT.
056800*
056900 CLOSE-TEST-01.
057000     IF REC-CT = 0
057100         OPEN INPUT SQ-FS1.
057200*    THIS IF STATEMENT SHOULD NEVER BE TRUE.  IT IS INCLUDED IN
057300*    AN ATTEMPT TO AVOID A COMPILER DETECTING THE CLOSE OF AN
057400*    UNOPENED FILE WITHOUT EXECUTING THE PROGRAM.  HOWEVER, IF
057500*    THE DETECTION IS MADE AT COMPILE TIME, THE TEST SHOULD BE
057600*    CONSIDERED PASSED.
057700*
057800     CLOSE SQ-FS1.
057900*
058000 CCVS-EXIT SECTION.
058100 CCVS-999999.
058200     GO TO   CLOSE-FILES.
