000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SQ151A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000800*    USING CCVS85 VERSION 3.0.                                 *
000900*                                                              *
001000*    CREATION DATE     /     VALIDATION DATE                   *
001100*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001200*                                                              *
001300****************************************************************
001400*                                                              *
001500*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001600*                                                              *
001700*            X-01   SEQUENTIAL TAPE                            *
001800*            X-55   SYSTEM PRINTER                             *
001900*            X-82   SOURCE-COMPUTER                            *
002000*            X-83   OBJECT-COMPUTER                            *
002100*            X-84   LABEL RECORDS OPTION.                      *
002200*                                                              *
002300****************************************************************
002400*                                                              *
002500*    THIS PROGRAM CHECKS FOR THE CORRECT RESPONSE TO WRITING   *
002600*    A CLOSED FILE.  THE TEST FOR CORRECT I-O STATUS CODE 48   *
002700*    IS IN THE DECLARATIVES.  AN ABNORMAL TERMINATION IS       *
002800*    POSSIBLE AFTER THE TEST OF THE I-O STATUS CODE IS         *
002900*    ACCOMPLISHED BUT BEFORE CONTROL IS RETURNED TO THE MAIN   *
003000*    LINE CODE.                                                *
003100*                                                              *
003200****************************************************************
003300*
003400 ENVIRONMENT DIVISION.
003500 CONFIGURATION SECTION.
003600 SOURCE-COMPUTER.
003700     XXXXX082.
003800 OBJECT-COMPUTER.
003900     XXXXX083.
004000*
004100 INPUT-OUTPUT SECTION.
004200 FILE-CONTROL.
004300     SELECT PRINT-FILE ASSIGN TO
004400     XXXXX055.
004500*
004600     SELECT SQ-FS1 ASSIGN TO
004700     XXXXX001
004800            FILE STATUS IS SQ-FS1-STATUS.
004900*
005000*
005100 DATA DIVISION.
005200 FILE SECTION.
005300 FD  PRINT-FILE
005400C    LABEL RECORDS
005500C    XXXXX084
005600C    DATA RECORD IS PRINT-REC DUMMY-RECORD
005700               .
005800 01  PRINT-REC    PICTURE X(120).
005900 01  DUMMY-RECORD PICTURE X(120).
006000*
006100 FD  SQ-FS1
006200C    LABEL RECORD IS STANDARD
006300                .
006400 01  SQ-FS1R1-F-G-120 PIC X(120).
006500*
006600 WORKING-STORAGE SECTION.
006700*
006800***************************************************************
006900*                                                             *
007000*    WORKING-STORAGE DATA ITEMS SPECIFIC TO THIS TEST SUITE   *
007100*                                                             *
007200***************************************************************
007300*
007400 01  SQ-FS1-STATUS.
007500   03  SQ-FS1-KEY-1   PIC X.
007600   03  SQ-FS1-KEY-2   PIC X.
007700*
007800***************************************************************
007900*                                                             *
008000*    WORKING-STORAGE DATA ITEMS USED BY THE CCVS              *
008100*                                                             *
008200***************************************************************
008300*
008400 01  REC-SKEL-SUB   PIC 99.
008500*
008600 01  FILE-RECORD-INFORMATION-REC.
008700     03 FILE-RECORD-INFO-SKELETON.
008800        05 FILLER                 PICTURE X(48)       VALUE
008900             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
009000        05 FILLER                 PICTURE X(46)       VALUE
009100             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
009200        05 FILLER                 PICTURE X(26)       VALUE
009300             ",LFIL=000000,ORG=  ,LBLR= ".
009400        05 FILLER                 PICTURE X(37)       VALUE
009500             ",RECKEY=                             ".
009600        05 FILLER                 PICTURE X(38)       VALUE
009700             ",ALTKEY1=                             ".
009800        05 FILLER                 PICTURE X(38)       VALUE
009900             ",ALTKEY2=                             ".
010000        05 FILLER                 PICTURE X(7)        VALUE SPACE.
010100     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
010200        05 FILE-RECORD-INFO-P1-120.
010300           07 FILLER              PIC X(5).
010400           07 XFILE-NAME          PIC X(6).
010500           07 FILLER              PIC X(8).
010600           07 XRECORD-NAME        PIC X(6).
010700           07 FILLER              PIC X(1).
010800           07 REELUNIT-NUMBER     PIC 9(1).
010900           07 FILLER              PIC X(7).
011000           07 XRECORD-NUMBER      PIC 9(6).
011100           07 FILLER              PIC X(6).
011200           07 UPDATE-NUMBER       PIC 9(2).
011300           07 FILLER              PIC X(5).
011400           07 ODO-NUMBER          PIC 9(4).
011500           07 FILLER              PIC X(5).
011600           07 XPROGRAM-NAME       PIC X(5).
011700           07 FILLER              PIC X(7).
011800           07 XRECORD-LENGTH      PIC 9(6).
011900           07 FILLER              PIC X(7).
012000           07 CHARS-OR-RECORDS    PIC X(2).
012100           07 FILLER              PIC X(1).
012200           07 XBLOCK-SIZE         PIC 9(4).
012300           07 FILLER              PIC X(6).
012400           07 RECORDS-IN-FILE     PIC 9(6).
012500           07 FILLER              PIC X(5).
012600           07 XFILE-ORGANIZATION  PIC X(2).
012700           07 FILLER              PIC X(6).
012800           07 XLABEL-TYPE         PIC X(1).
012900        05 FILE-RECORD-INFO-P121-240.
013000           07 FILLER              PIC X(8).
013100           07 XRECORD-KEY         PIC X(29).
013200           07 FILLER              PIC X(9).
013300           07 ALTERNATE-KEY1      PIC X(29).
013400           07 FILLER              PIC X(9).
013500           07 ALTERNATE-KEY2      PIC X(29).
013600           07 FILLER              PIC X(7).
013700*
013800 01  TEST-RESULTS.
013900     02 FILLER              PIC X      VALUE SPACE.
014000     02 FEATURE             PIC X(24)  VALUE SPACE.
014100     02 FILLER              PIC X      VALUE SPACE.
014200     02 P-OR-F              PIC X(5)   VALUE SPACE.
014300     02 FILLER              PIC X      VALUE SPACE.
014400     02  PAR-NAME.
014500       03 FILLER              PIC X(14)  VALUE SPACE.
014600       03 PARDOT-X            PIC X      VALUE SPACE.
014700       03 DOTVALUE            PIC 99     VALUE ZERO.
014800     02 FILLER              PIC X(9)   VALUE SPACE.
014900     02 RE-MARK             PIC X(61).
015000 01  TEST-COMPUTED.
015100   02 FILLER  PIC X(30)  VALUE SPACE.
015200   02 FILLER  PIC X(17)  VALUE "      COMPUTED =".
015300   02 COMPUTED-X.
015400     03 COMPUTED-A    PIC X(20)  VALUE SPACE.
015500     03 COMPUTED-N    REDEFINES COMPUTED-A PIC -9(9).9(9).
015600     03 COMPUTED-0V18 REDEFINES COMPUTED-A PIC -.9(18).
015700     03 COMPUTED-4V14 REDEFINES COMPUTED-A PIC -9(4).9(14).
015800     03 COMPUTED-14V4 REDEFINES COMPUTED-A PIC -9(14).9(4).
015900     03       CM-18V0 REDEFINES COMPUTED-A.
016000        04 COMPUTED-18V0                   PIC -9(18).
016100        04 FILLER                          PIC X.
016200     03 FILLER PIC X(50) VALUE SPACE.
016300 01  TEST-CORRECT.
016400     02 FILLER PIC X(30) VALUE SPACE.
016500     02 FILLER PIC X(17) VALUE "       CORRECT =".
016600     02 CORRECT-X.
016700     03 CORRECT-A                  PIC X(20) VALUE SPACE.
016800     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
016900     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
017000     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
017100     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
017200     03      CR-18V0 REDEFINES CORRECT-A.
017300         04 CORRECT-18V0                     PIC -9(18).
017400         04 FILLER                           PIC X.
017500     03 FILLER PIC X(2) VALUE SPACE.
017600     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
017700 01  CCVS-C-1.
017800     02 FILLER  PIC IS X(4)     VALUE SPACE.
017900     02 FILLER  PIC IS X(98)    VALUE IS "FEATURE               PA
018000-    "SS  PARAGRAPH-NAME
018100-    "       REMARKS".
018200     02 FILLER           PIC X(17)    VALUE SPACE.
018300 01  CCVS-C-2.
018400     02 FILLER           PIC XXXX     VALUE SPACE.
018500     02 FILLER           PIC X(6)     VALUE "TESTED".
018600     02 FILLER           PIC X(16)    VALUE SPACE.
018700     02 FILLER           PIC X(4)     VALUE "FAIL".
018800     02 FILLER           PIC X(90)    VALUE SPACE.
018900 01  REC-SKL-SUB       PIC 9(2)     VALUE ZERO.
019000 01  REC-CT            PIC 99       VALUE ZERO.
019100 01  DELETE-COUNTER    PIC 999      VALUE ZERO.
019200 01  ERROR-COUNTER     PIC 999      VALUE ZERO.
019300 01  INSPECT-COUNTER   PIC 999      VALUE ZERO.
019400 01  PASS-COUNTER      PIC 999      VALUE ZERO.
019500 01  TOTAL-ERROR       PIC 999      VALUE ZERO.
019600 01  ERROR-HOLD        PIC 999      VALUE ZERO.
019700 01  DUMMY-HOLD        PIC X(120)   VALUE SPACE.
019800 01  RECORD-COUNT      PIC 9(5)     VALUE ZERO.
019900 01  ANSI-REFERENCE    PIC X(48)    VALUE SPACES.
020000 01  CCVS-H-1.
020100     02  FILLER          PIC X(39)    VALUE SPACES.
020200     02  FILLER          PIC X(42)    VALUE
020300     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
020400     02  FILLER          PIC X(39)    VALUE SPACES.
020500 01  CCVS-H-2A.
020600   02  FILLER            PIC X(40)  VALUE SPACE.
020700   02  FILLER            PIC X(7)   VALUE "CCVS85 ".
020800   02  FILLER            PIC XXXX   VALUE
020900     "4.2 ".
021000   02  FILLER            PIC X(28)  VALUE
021100            " COPY - NOT FOR DISTRIBUTION".
021200   02  FILLER            PIC X(41)  VALUE SPACE.
021300*
021400 01  CCVS-H-2B.
021500   02  FILLER            PIC X(15)  VALUE "TEST RESULT OF ".
021600   02  TEST-ID           PIC X(9).
021700   02  FILLER            PIC X(4)   VALUE " IN ".
021800   02  FILLER            PIC X(12)  VALUE
021900     " HIGH       ".
022000   02  FILLER            PIC X(22)  VALUE
022100            " LEVEL VALIDATION FOR ".
022200   02  FILLER            PIC X(58)  VALUE
022300     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
022400 01  CCVS-H-3.
022500     02  FILLER          PIC X(34)  VALUE
022600            " FOR OFFICIAL USE ONLY    ".
022700     02  FILLER          PIC X(58)  VALUE
022800     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
022900     02  FILLER          PIC X(28)  VALUE
023000            "  COPYRIGHT   1985,1986 ".
023100 01  CCVS-E-1.
023200     02 FILLER           PIC X(52)  VALUE SPACE.
023300     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
023400     02 ID-AGAIN         PIC X(9).
023500     02 FILLER           PIC X(45)  VALUE SPACES.
023600 01  CCVS-E-2.
023700     02  FILLER          PIC X(31)  VALUE SPACE.
023800     02  FILLER          PIC X(21)  VALUE SPACE.
023900     02  CCVS-E-2-2.
024000         03 ERROR-TOTAL    PIC XXX    VALUE SPACE.
024100         03 FILLER         PIC X      VALUE SPACE.
024200         03 ENDER-DESC     PIC X(44)  VALUE
024300            "ERRORS ENCOUNTERED".
024400 01  CCVS-E-3.
024500     02  FILLER          PIC X(22)  VALUE
024600            " FOR OFFICIAL USE ONLY".
024700     02  FILLER          PIC X(12)  VALUE SPACE.
024800     02  FILLER          PIC X(58)  VALUE
024900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
025000     02  FILLER          PIC X(8)   VALUE SPACE.
025100     02  FILLER          PIC X(20)  VALUE
025200             " COPYRIGHT 1985,1986".
025300 01  CCVS-E-4.
025400     02 CCVS-E-4-1       PIC XXX    VALUE SPACE.
025500     02 FILLER           PIC X(4)   VALUE " OF ".
025600     02 CCVS-E-4-2       PIC XXX    VALUE SPACE.
025700     02 FILLER           PIC X(40)  VALUE
025800      "  TESTS WERE EXECUTED SUCCESSFULLY".
025900 01  XXINFO.
026000     02 FILLER           PIC X(19)  VALUE "*** INFORMATION ***".
026100     02 INFO-TEXT.
026200       04 FILLER             PIC X(8)   VALUE SPACE.
026300       04 XXCOMPUTED         PIC X(20).
026400       04 FILLER             PIC X(5)   VALUE SPACE.
026500       04 XXCORRECT          PIC X(20).
026600     02 INF-ANSI-REFERENCE PIC X(48).
026700 01  HYPHEN-LINE.
026800     02 FILLER  PIC IS X VALUE IS SPACE.
026900     02 FILLER  PIC IS X(65)    VALUE IS "************************
027000-    "*****************************************".
027100     02 FILLER  PIC IS X(54)    VALUE IS "************************
027200-    "******************************".
027300 01  CCVS-PGM-ID  PIC X(9)   VALUE
027400     "SQ151A".
027500*
027600 PROCEDURE DIVISION.
027700 DECLARATIVES.
027800 SQ-FS1-DECLARATIVE SECTION.
027900     USE AFTER EXCEPTION PROCEDURE ON SQ-FS1.
028000 OUTPUT-ERROR-PROCESS.
028100     IF  SQ-FS1-STATUS = "48"
028200             PERFORM DECL-PASS
028300             GO TO DECL-ABNORMAL-TERM
028400     ELSE
028500             MOVE "48" TO CORRECT-A
028600             MOVE SQ-FS1-STATUS TO COMPUTED-A
028700             MOVE "STATUS FOR WRITE TO CLOSED FILE INCORRECT"
028800                     TO RE-MARK
028900             MOVE "VII-5, 1.3.5(4)G" TO ANSI-REFERENCE
029000             PERFORM DECL-FAIL
029100             GO TO DECL-ABNORMAL-TERM
029200     END-IF.
029300*
029400 DECL-PASS.
029500     MOVE   "PASS " TO P-OR-F.
029600     ADD     1 TO PASS-COUNTER.
029700     PERFORM DECL-PRINT-DETAIL.
029800*
029900 DECL-FAIL.
030000     MOVE   "FAIL*" TO P-OR-F.
030100     ADD     1 TO ERROR-COUNTER.
030200     PERFORM DECL-PRINT-DETAIL.
030300*
030400 DECL-PRINT-DETAIL.
030500     IF REC-CT NOT EQUAL TO ZERO
030600             MOVE "." TO PARDOT-X
030700             MOVE REC-CT TO DOTVALUE.
030800     MOVE    TEST-RESULTS TO PRINT-REC.
030900     PERFORM DECL-WRITE-LINE.
031000     IF P-OR-F EQUAL TO "FAIL*"
031100         PERFORM DECL-WRITE-LINE
031200         PERFORM DECL-FAIL-ROUTINE THRU DECL-FAIL-EX
031300     ELSE
031400         PERFORM DECL-BAIL THRU DECL-BAIL-EX.
031500     MOVE    SPACE TO P-OR-F.
031600     MOVE    SPACE TO COMPUTED-X.
031700     MOVE    SPACE TO CORRECT-X.
031800     IF REC-CT EQUAL TO ZERO
031900         MOVE    SPACE TO PAR-NAME.
032000     MOVE    SPACE TO RE-MARK.
032100*
032200 DECL-WRITE-LINE.
032300     ADD     1 TO RECORD-COUNT.
032400Y    IF RECORD-COUNT GREATER 50
032500Y        MOVE    DUMMY-RECORD TO DUMMY-HOLD
032600Y        MOVE    SPACE TO DUMMY-RECORD
032700Y        WRITE   DUMMY-RECORD AFTER ADVANCING PAGE
032800Y        MOVE    CCVS-C-1 TO DUMMY-RECORD PERFORM DECL-WRT-LN
032900Y        MOVE    CCVS-C-2 TO DUMMY-RECORD
033000Y        PERFORM DECL-WRT-LN 2 TIMES
033100Y        MOVE    HYPHEN-LINE TO DUMMY-RECORD
033200Y        PERFORM DECL-WRT-LN
033300Y        MOVE    DUMMY-HOLD TO DUMMY-RECORD
033400Y        MOVE    ZERO TO RECORD-COUNT.
033500     PERFORM DECL-WRT-LN.
033600*
033700 DECL-WRT-LN.
033800     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
033900     MOVE    SPACE TO DUMMY-RECORD.
034000*
034100 DECL-FAIL-ROUTINE.
034200     IF COMPUTED-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
034300     IF CORRECT-X NOT EQUAL TO SPACE GO TO DECL-FAIL-WRITE.
034400     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
034500     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
034600     MOVE    XXINFO TO DUMMY-RECORD.
034700     PERFORM DECL-WRITE-LINE 2 TIMES.
034800     MOVE    SPACES TO INF-ANSI-REFERENCE.
034900     GO TO   DECL-FAIL-EX.
035000 DECL-FAIL-WRITE.
035100     MOVE    TEST-COMPUTED TO PRINT-REC
035200     PERFORM DECL-WRITE-LINE
035300     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
035400     MOVE    TEST-CORRECT TO PRINT-REC
035500     PERFORM DECL-WRITE-LINE 2 TIMES.
035600     MOVE    SPACES TO COR-ANSI-REFERENCE.
035700 DECL-FAIL-EX.
035800     EXIT.
035900*
036000 DECL-BAIL.
036100     IF COMPUTED-A NOT EQUAL TO SPACE GO TO DECL-BAIL-WRITE.
036200     IF CORRECT-A EQUAL TO SPACE GO TO DECL-BAIL-EX.
036300 DECL-BAIL-WRITE.
036400     MOVE    CORRECT-A TO XXCORRECT.
036500     MOVE    COMPUTED-A TO XXCOMPUTED.
036600     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
036700     MOVE    XXINFO TO DUMMY-RECORD.
036800     PERFORM DECL-WRITE-LINE 2 TIMES.
036900     MOVE    SPACE TO  INF-ANSI-REFERENCE.
037000 DECL-BAIL-EX.
037100     EXIT.
037200*
037300 DECL-ABNORMAL-TERM.
037400     MOVE SPACE TO DUMMY-RECORD.
037500     PERFORM DECL-WRITE-LINE.
037600     MOVE "ABNORMAL TERMINATION AT THIS POINT IS ACCEPTABLE"
037700             TO DUMMY-RECORD.
037800     PERFORM DECL-WRITE-LINE 3 TIMES.
037900*
038000 END-DECLS.
038100     EXIT.
038200 END DECLARATIVES.
038300*
038400*
038500 CCVS1 SECTION.
038600 OPEN-FILES.
038700     OPEN    OUTPUT PRINT-FILE.
038800     MOVE    CCVS-PGM-ID TO TEST-ID.
038900     MOVE    CCVS-PGM-ID TO ID-AGAIN.
039000     MOVE    SPACE TO TEST-RESULTS.
039100     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
039200     MOVE    ZERO TO REC-SKEL-SUB.
039300     PERFORM CCVS-INIT-FILE 10 TIMES.
039400     GO TO CCVS1-EXIT.
039500*
039600 CCVS-INIT-FILE.
039700     ADD     1 TO REC-SKL-SUB.
039800     MOVE    FILE-RECORD-INFO-SKELETON TO
039900                  FILE-RECORD-INFO (REC-SKL-SUB).
040000*
040100 CLOSE-FILES.
040200     PERFORM END-ROUTINE THRU END-ROUTINE-13.
040300     CLOSE   PRINT-FILE.
040400 TERMINATE-CCVS.
040500     STOP    RUN.
040600*
040700 INSPT.
040800     MOVE   "INSPT" TO P-OR-F.
040900     ADD     1 TO INSPECT-COUNTER.
041000     PERFORM PRINT-DETAIL.
041100
041200 PASS.
041300     MOVE   "PASS " TO P-OR-F.
041400     ADD     1 TO PASS-COUNTER.
041500     PERFORM PRINT-DETAIL.
041600*
041700 FAIL.
041800     MOVE   "FAIL*" TO P-OR-F.
041900     ADD     1 TO ERROR-COUNTER.
042000     PERFORM PRINT-DETAIL.
042100*
042200 DE-LETE.
042300     MOVE   "****TEST DELETED****" TO RE-MARK.
042400     MOVE   "*****" TO P-OR-F.
042500     ADD     1 TO DELETE-COUNTER.
042600     PERFORM PRINT-DETAIL.
042700*
042800 PRINT-DETAIL.
042900     IF REC-CT NOT EQUAL TO ZERO
043000         MOVE   "." TO PARDOT-X
043100         MOVE    REC-CT TO DOTVALUE.
043200     MOVE    TEST-RESULTS TO PRINT-REC.
043300     PERFORM WRITE-LINE.
043400     IF P-OR-F EQUAL TO "FAIL*"
043500         PERFORM WRITE-LINE
043600         PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
043700     ELSE
043800         PERFORM BAIL-OUT THRU BAIL-OUT-EX.
043900     MOVE    SPACE TO P-OR-F.
044000     MOVE    SPACE TO COMPUTED-X.
044100     MOVE    SPACE TO CORRECT-X.
044200     IF REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
044300     MOVE    SPACE TO RE-MARK.
044400*
044500 HEAD-ROUTINE.
044600     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044700     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044800     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
044900     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
045000 COLUMN-NAMES-ROUTINE.
045100     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
045200     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
045400 END-ROUTINE.
045500     MOVE    HYPHEN-LINE TO DUMMY-RECORD.
045600     PERFORM WRITE-LINE 5 TIMES.
045700 END-RTN-EXIT.
045800     MOVE    CCVS-E-1 TO DUMMY-RECORD.
045900     PERFORM WRITE-LINE 2 TIMES.
046000*
046100 END-ROUTINE-1.
046200     ADD     ERROR-COUNTER   TO ERROR-HOLD
046300     ADD     INSPECT-COUNTER TO ERROR-HOLD.
046400     ADD     DELETE-COUNTER  TO ERROR-HOLD.
046500     ADD     PASS-COUNTER    TO ERROR-HOLD.
046600     MOVE    PASS-COUNTER    TO CCVS-E-4-1.
046700     MOVE    ERROR-HOLD      TO CCVS-E-4-2.
046800     MOVE    CCVS-E-4        TO CCVS-E-2-2.
046900     MOVE    CCVS-E-2        TO DUMMY-RECORD
047000     PERFORM WRITE-LINE.
047100     MOVE   "TEST(S) FAILED" TO ENDER-DESC.
047200     IF ERROR-COUNTER IS EQUAL TO ZERO
047300         MOVE   "NO " TO ERROR-TOTAL
047400     ELSE
047500         MOVE    ERROR-COUNTER TO ERROR-TOTAL.
047600     MOVE    CCVS-E-2 TO DUMMY-RECORD.
047700     PERFORM WRITE-LINE.
047800 END-ROUTINE-13.
047900     IF DELETE-COUNTER IS EQUAL TO ZERO
048000         MOVE   "NO " TO ERROR-TOTAL
048100     ELSE
048200         MOVE    DELETE-COUNTER TO ERROR-TOTAL.
048300     MOVE   "TEST(S) DELETED     " TO ENDER-DESC.
048400     MOVE    CCVS-E-2 TO DUMMY-RECORD.
048500     PERFORM WRITE-LINE.
048600     IF INSPECT-COUNTER EQUAL TO ZERO
048700         MOVE   "NO " TO ERROR-TOTAL
048800     ELSE
048900         MOVE    INSPECT-COUNTER TO ERROR-TOTAL.
049000     MOVE   "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
049100     MOVE    CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
049200     MOVE    CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
049300*
049400 WRITE-LINE.
049500     ADD     1 TO RECORD-COUNT.
049600Y    IF RECORD-COUNT GREATER 50
049700Y        MOVE  DUMMY-RECORD TO DUMMY-HOLD
049800Y        MOVE  SPACE TO DUMMY-RECORD
049900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
050000Y        MOVE  CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
050100Y        MOVE  CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
050200Y        MOVE  HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
050300Y        MOVE  DUMMY-HOLD TO DUMMY-RECORD
050400Y        MOVE  ZERO TO RECORD-COUNT.
050500     PERFORM WRT-LN.
050600*
050700 WRT-LN.
050800     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
050900     MOVE    SPACE TO DUMMY-RECORD.
051000 BLANK-LINE-PRINT.
051100     PERFORM WRT-LN.
051200 FAIL-ROUTINE.
051300     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
051400     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
051500     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
051600     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
051700     MOVE    XXINFO TO DUMMY-RECORD.
051800     PERFORM WRITE-LINE 2 TIMES.
051900     MOVE    SPACES TO INF-ANSI-REFERENCE.
052000     GO TO   FAIL-ROUTINE-EX.
052100 FAIL-ROUTINE-WRITE.
052200     MOVE    TEST-COMPUTED  TO PRINT-REC
052300     PERFORM WRITE-LINE
052400     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
052500     MOVE    TEST-CORRECT   TO PRINT-REC
052600     PERFORM WRITE-LINE 2 TIMES.
052700     MOVE    SPACES         TO COR-ANSI-REFERENCE.
052800 FAIL-ROUTINE-EX.
052900     EXIT.
053000 BAIL-OUT.
053100     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
053200     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
053300 BAIL-OUT-WRITE.
053400     MOVE    CORRECT-A      TO XXCORRECT.
053500     MOVE    COMPUTED-A     TO XXCOMPUTED.
053600     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
053700     MOVE    XXINFO TO DUMMY-RECORD.
053800     PERFORM WRITE-LINE 2 TIMES.
053900     MOVE    SPACES TO INF-ANSI-REFERENCE.
054000 BAIL-OUT-EX.
054100     EXIT.
054200 CCVS1-EXIT.
054300     EXIT.
054400*
054500****************************************************************
054600*                                                              *
054700*    THIS POINT MARKS THE END OF THE CCVS MONITOR ROUTINES AND *
054800*    THE START OF THE TESTS OF SPECIFIC COBOL FEATURES.        *
054900*                                                              *
055000****************************************************************
055100*
055200 SECT-SQ151A-0001 SECTION.
055300 WRITE-INIT-GF-01.
055400*
055500*        THIS TEST CREATES FILE SQ-FS1 AND CLOSES IT WITH LOCK.
055600*        FIRST IT SETS UP A SKELETON RECORD IN WORKING STORAGE.
055700*
055800     MOVE "SQ-FS1"     TO XFILE-NAME (1).
055900     MOVE "R1-F-G"     TO XRECORD-NAME (1).
056000     MOVE  CCVS-PGM-ID TO XPROGRAM-NAME (1).
056100     MOVE 120          TO XRECORD-LENGTH (1).
056200     MOVE "RC"         TO CHARS-OR-RECORDS (1).
056300     MOVE 1            TO XBLOCK-SIZE (1).
056400     MOVE 1            TO RECORDS-IN-FILE (1).
056500     MOVE "SQ"         TO XFILE-ORGANIZATION (1).
056600     MOVE "S"          TO XLABEL-TYPE (1).
056700     MOVE 1            TO XRECORD-NUMBER (1).
056800*
056900 WRITE-OPEN-01.
057000     OPEN    OUTPUT SQ-FS1.
057100*
057200*        WRITE A SINGLE RECORD TO THE FILE
057300*
057400 WRITE-TEST-01-01.
057500     MOVE    FILE-RECORD-INFO-P1-120 (1) TO SQ-FS1R1-F-G-120.
057600     WRITE   SQ-FS1R1-F-G-120.
057700*
057800*        CLOSE THE FILE.
057900*
058000 CLOSE-INIT-01.
058100 CLOSE-TEST-01.
058200     CLOSE   SQ-FS1.
058300*
058400*        WE WILL NOW ATTEMPT TO WRITE A RECORD TO THE CLOSED
058500*        FILE.  I-O STATUS 48 SHOULD BE GENERATED.
058600*
058700 WRITE-INIT-01.
058800*
058900     MOVE "WRITE CLOSED FILE" TO FEATURE.
059000     MOVE   "**" TO SQ-FS1-STATUS.
059100     MOVE "WRITE-TEST-01" TO PAR-NAME.
059200     MOVE 1 TO REC-CT.
059300 WRITE-TEST-01.
059400     WRITE SQ-FS1R1-F-G-120.
059500*
059600 CCVS-EXIT SECTION.
059700 CCVS-999999.
059800     GO TO CLOSE-FILES.
