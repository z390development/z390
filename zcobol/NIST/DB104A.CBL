000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     DB104A.
000400 AUTHOR.
000500     FEDERAL COMPILER TESTING CENTER.
000600 INSTALLATION.
000700     GENERAL SERVICES ADMINISTRATION
000800     AUTOMATED DATA AND TELECOMMUNICATION SERVICE.
000900     SOFTWARE DEVELOPMENT OFFICE.
001000     5203 LEESBURG PIKE  SUITE 1100
001100     FALLS CHURCH VIRGINIA 22041.
001200
001300     PHONE   (703) 756-6153
001400
001500     " HIGH       ".
001600 DATE-WRITTEN.
001700     CCVS-74 VERSION 4.0 - 1980 JULY 1.
001800     CREATION DATE     /    VALIDATION DATE
001900     "4.2 ".
002000 SECURITY.
002100     NONE.
002200*
002300*    *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
002400*
002500*                       PROGRAM ABSTRACT
002600*
002700*    DB104A TESTS THE CAPABILITY OF THE DEBUG MODULE TO HANDLE
002800*    PROCEDURES TIED TO SORT INPUT, SORT OUTPUT, AND FILE
002900*    DECLARATIVE PROCEDURES.  THIS PROGRAM IS TO BE COMPILED AND
003000*    EXECUTED WITH BOTH COMPILE AND OBJECT TIME DEBUGGING
003100*    SWITCHES ENABLED.  THE PROGRAM FIRST BUILDS A SEQUENTIAL
003200*    FILE CONTAINING 99 EIGHTY CHARACTER RECORDS.  THIS FILE
003300*    IS THEN SORTED.
003400*
003500*    ALL DEBUGGING PROCEDURES SHOULD BE INCLUDED IN COMPILATION
003600*    AND GENERATE CODE.  BEFORE BEGINNING EXECUTION OF THE OBJECT
003700*    PROGRAM, THE JOB CONTROL LANGUAGE NECESSARY TO ACTIVATE
003800*    THE OBJECT TIME DEBUGGING SWITCH MUST BE SUBMITTED.
003900*
004000*    EXECUTION OF THE PROGRAM"S SORT SHOULD TRIGGER DEBUGGING
004100*    PROCEDURES AT THE BEGINNING OF THE SORT INPUT AND SORT
004200*    OUTPUT PROCEDURES.  DURING EXECUTION OF THE SORT INPUT
004300*    PROCEDURE, END-OF-FILE CONDITION ON THE INPUT FILE SHOULD
004400*    TRIGGER A DECLARATIVE PROCEDURE ASSOCIATED WITH THE FILE,
004500*    AND THIS IN TURN SHOULD CAUSE EXECUTION OF A DEBUGGING
004600*    PROCEDURE MONITORING THE FILE DECLARATIVE PROCEDURE.
004700*
004800*    THE PERFORMANCE OF THE SORT VERB IS NOT CHECKED IN DB104.
004900*
005000*
005100*
005200 ENVIRONMENT DIVISION.
005300 CONFIGURATION SECTION.
005400 SOURCE-COMPUTER.
005500     XXXXX082
005600         WITH DEBUGGING MODE.
005700 OBJECT-COMPUTER.
005800     XXXXX083.
005900 INPUT-OUTPUT SECTION.
006000 FILE-CONTROL.
006100     SELECT PRINT-FILE ASSIGN TO
006200     XXXXX055.
006300     SELECT GEN-FILE ASSIGN TO
006400     XXXXX014
006500     FILE STATUS IS GEN-STATUS.
006600*      XXXXX014  REPLACE WITH SEQUENTIAL ACCESS SCRATCH FILE NAME
006700     SELECT SORT-FILE ASSIGN TO
006800     XXXXX027.
006900*      XXXXX27  REPLACE WITH SORT FILE NAME
007000 DATA DIVISION.
007100 FILE SECTION.
007200 FD  PRINT-FILE
007300     LABEL RECORDS
007400     XXXXX084
007500     DATA RECORD IS PRINT-REC DUMMY-RECORD.
007600 01  PRINT-REC PICTURE X(120).
007700 01  DUMMY-RECORD PICTURE X(120).
007800 FD  GEN-FILE
007900C    VALUE OF
008000C    XXXXX074
008100*      XXXXX074  REPLACE WITH IMPLEMENTOR NAME (*OPT C ONLY)
008200C    IS
008300C    XXXXX075
008400*      XXXXX075  REPLACE WITH VALUE CLAUSE OBJECT (*OPT C ONLY)
008500G    XXXXX069
008600*      XXXXX069  REPLACE WITH ADDITIONAL INFO (*OPT G ONLY)
008700     LABEL RECORD IS STANDARD.
008800 01  GEN-REC PIC X(80).
008900 SD  SORT-FILE.
009000 01  SORT-REC.
009100     02  FILLER PIC X(34).
009200     02  SORT-REC-NO PIC 9(6).
009300     02  FILLER PIC X(40).
009400 WORKING-STORAGE SECTION.
009500 77  RESULT-FLAG PIC 99 COMP VALUE 0.
009600 77  DBLINE-HOLD PIC X(6).
009700 77  DBNAME-HOLD PIC X(30).
009800 77  DBCONT-HOLD PIC X(30).
009900 01  FILE-RECORD-INFORMATION-REC.
010000     03 FILE-RECORD-INFO-SKELETON.
010100        05 FILLER                 PICTURE X(48)       VALUE
010200             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
010300        05 FILLER                 PICTURE X(46)       VALUE
010400             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
010500        05 FILLER                 PICTURE X(26)       VALUE
010600             ",LFIL=000000,ORG=  ,LBLR= ".
010700        05 FILLER                 PICTURE X(37)       VALUE
010800             ",RECKEY=                             ".
010900        05 FILLER                 PICTURE X(38)       VALUE
011000             ",ALTKEY1=                             ".
011100        05 FILLER                 PICTURE X(38)       VALUE
011200             ",ALTKEY2=                             ".
011300        05 FILLER                 PICTURE X(7)        VALUE SPACE.
011400     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
011500        05 FILE-RECORD-INFO-P1-120.
011600           07 FILLER              PIC X(5).
011700           07 XFILE-NAME           PIC X(6).
011800           07 FILLER              PIC X(8).
011900           07 XRECORD-NAME         PIC X(6).
012000           07 FILLER              PIC X(1).
012100           07 REELUNIT-NUMBER     PIC 9(1).
012200           07 FILLER              PIC X(7).
012300           07 XRECORD-NUMBER       PIC 9(6).
012400           07 FILLER              PIC X(6).
012500           07 UPDATE-NUMBER       PIC 9(2).
012600           07 FILLER              PIC X(5).
012700           07 ODO-NUMBER          PIC 9(4).
012800           07 FILLER              PIC X(5).
012900           07 XPROGRAM-NAME        PIC X(5).
013000           07 FILLER              PIC X(7).
013100           07 XRECORD-LENGTH       PIC 9(6).
013200           07 FILLER              PIC X(7).
013300           07 CHARS-OR-RECORDS    PIC X(2).
013400           07 FILLER              PIC X(1).
013500           07 XBLOCK-SIZE          PIC 9(4).
013600           07 FILLER              PIC X(6).
013700           07 RECORDS-IN-FILE     PIC 9(6).
013800           07 FILLER              PIC X(5).
013900           07 XFILE-ORGANIZATION   PIC X(2).
014000           07 FILLER              PIC X(6).
014100           07 XLABEL-TYPE          PIC X(1).
014200        05 FILE-RECORD-INFO-P121-240.
014300           07 FILLER              PIC X(8).
014400           07 XRECORD-KEY          PIC X(29).
014500           07 FILLER              PIC X(9).
014600           07 ALTERNATE-KEY1      PIC X(29).
014700           07 FILLER              PIC X(9).
014800           07 ALTERNATE-KEY2      PIC X(29).
014900           07 FILLER              PIC X(7).
015000 01  GEN-STATUS.
015100     02  END-FLAG PIC X.
015200     02  FILLER PIC X.
015300 01  SIZE-13.
015400     02  FILLER PIC XX.
015500     02  SIZE-11.
015600         03  FILLER PIC X.
015700         03  SIZE-10.
015800             04  FILLER PIC XX.
015900             04  SIZE-8.
016000                 05  FILLER PIC X.
016100                 05  SIZE-7 PIC X(7).
016200 01  TEST-RESULTS.
016300     02 FILLER                    PICTURE X VALUE SPACE.
016400     02 FEATURE                   PICTURE X(20) VALUE SPACE.
016500     02 FILLER                    PICTURE X VALUE SPACE.
016600     02 P-OR-F                    PICTURE X(5) VALUE SPACE.
016700     02 FILLER                    PICTURE X  VALUE SPACE.
016800     02  PAR-NAME.
016900       03 FILLER PICTURE X(12) VALUE SPACE.
017000       03  PARDOT-X PICTURE X  VALUE SPACE.
017100       03 DOTVALUE PICTURE 99  VALUE ZERO.
017200       03 FILLER PIC X(5) VALUE SPACE.
017300     02 FILLER PIC X(10) VALUE SPACE.
017400     02 RE-MARK PIC X(61).
017500 01  TEST-COMPUTED.
017600     02 FILLER PIC X(30) VALUE SPACE.
017700     02 FILLER PIC X(17) VALUE "       COMPUTED=".
017800     02 COMPUTED-X.
017900     03 COMPUTED-A                PICTURE X(20) VALUE SPACE.
018000     03 COMPUTED-N REDEFINES COMPUTED-A PICTURE -9(9).9(9).
018100     03 COMPUTED-0V18 REDEFINES COMPUTED-A  PICTURE -.9(18).
018200     03 COMPUTED-4V14 REDEFINES COMPUTED-A  PICTURE -9(4).9(14).
018300     03 COMPUTED-14V4 REDEFINES COMPUTED-A  PICTURE -9(14).9(4).
018400     03       CM-18V0 REDEFINES COMPUTED-A.
018500         04 COMPUTED-18V0                   PICTURE -9(18).
018600         04 FILLER                          PICTURE X.
018700     03 FILLER PIC X(50) VALUE SPACE.
018800 01  TEST-CORRECT.
018900     02 FILLER PIC X(30) VALUE SPACE.
019000     02 FILLER PIC X(17) VALUE "       CORRECT =".
019100     02 CORRECT-X.
019200     03 CORRECT-A                 PICTURE X(20) VALUE SPACE.
019300     03 CORRECT-N REDEFINES CORRECT-A PICTURE -9(9).9(9).
019400     03 CORRECT-0V18 REDEFINES CORRECT-A    PICTURE -.9(18).
019500     03 CORRECT-4V14 REDEFINES CORRECT-A    PICTURE -9(4).9(14).
019600     03 CORRECT-14V4 REDEFINES CORRECT-A    PICTURE -9(14).9(4).
019700     03      CR-18V0 REDEFINES CORRECT-A.
019800         04 CORRECT-18V0                    PICTURE -9(18).
019900         04 FILLER                          PICTURE X.
020000     03 FILLER PIC X(50) VALUE SPACE.
020100 01  CCVS-C-1.
020200     02 FILLER PICTURE IS X(99) VALUE IS " FEATURE              PA
020300-    "SS  PARAGRAPH-NAME
020400-    "        REMARKS".
020500     02 FILLER PICTURE IS X(20) VALUE IS SPACE.
020600 01  CCVS-C-2.
020700     02 FILLER PICTURE IS X VALUE IS SPACE.
020800     02 FILLER PICTURE IS X(6) VALUE IS "TESTED".
020900     02 FILLER PICTURE IS X(15) VALUE IS SPACE.
021000     02 FILLER PICTURE IS X(4) VALUE IS "FAIL".
021100     02 FILLER PICTURE IS X(94) VALUE IS SPACE.
021200 01  REC-SKL-SUB PICTURE 9(2) VALUE ZERO.
021300 01  REC-CT PICTURE 99 VALUE ZERO.
021400 01  DELETE-CNT                   PICTURE 999  VALUE ZERO.
021500 01  ERROR-COUNTER PICTURE IS 999 VALUE IS ZERO.
021600 01  INSPECT-COUNTER PIC 999 VALUE ZERO.
021700 01  PASS-COUNTER PIC 999 VALUE ZERO.
021800 01  TOTAL-ERROR PIC 999 VALUE ZERO.
021900 01  ERROR-HOLD PIC 999 VALUE ZERO.
022000 01  DUMMY-HOLD PIC X(120) VALUE SPACE.
022100 01  RECORD-COUNT PIC 9(5) VALUE ZERO.
022200 01  CCVS-H-1.
022300     02  FILLER   PICTURE X(27)  VALUE SPACE.
022400     02 FILLER PICTURE X(67) VALUE
022500     " FEDERAL COMPILER TESTING CENTER COBOL COMPILER VALIDATION
022600-    " SYSTEM".
022700     02  FILLER     PICTURE X(26)  VALUE SPACE.
022800 01  CCVS-H-2.
022900     02 FILLER PICTURE X(52) VALUE IS
023000     "CCVS74 NCC  COPY, NOT FOR DISTRIBUTION.".
023100     02 FILLER PICTURE IS X(19) VALUE IS "TEST RESULTS SET-  ".
023200     02 TEST-ID PICTURE IS X(9).
023300     02 FILLER PICTURE IS X(40) VALUE IS SPACE.
023400 01  CCVS-H-3.
023500     02  FILLER PICTURE X(34) VALUE
023600     " FOR OFFICIAL USE ONLY    ".
023700     02  FILLER PICTURE X(58) VALUE
023800     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
023900     02  FILLER PICTURE X(28) VALUE
024000     "  COPYRIGHT   1974 ".
024100 01  CCVS-E-1.
024200     02 FILLER PICTURE IS X(52) VALUE IS SPACE.
024300     02 FILLER PICTURE IS X(14) VALUE IS "END OF TEST-  ".
024400     02 ID-AGAIN PICTURE IS X(9).
024500     02 FILLER PICTURE X(45) VALUE IS
024600     " NTIS DISTRIBUTION COBOL 74".
024700 01  CCVS-E-2.
024800     02  FILLER                   PICTURE X(31)  VALUE
024900     SPACE.
025000     02  FILLER                   PICTURE X(21)  VALUE SPACE.
025100     02 CCVS-E-2-2.
025200         03 ERROR-TOTAL PICTURE IS XXX VALUE IS SPACE.
025300         03 FILLER PICTURE IS X VALUE IS SPACE.
025400         03 ENDER-DESC PIC X(44) VALUE "ERRORS ENCOUNTERED".
025500 01  CCVS-E-3.
025600     02  FILLER PICTURE X(22) VALUE
025700     " FOR OFFICIAL USE ONLY".
025800     02  FILLER PICTURE X(12) VALUE SPACE.
025900     02  FILLER PICTURE X(58) VALUE
026000     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
026100     02  FILLER PICTURE X(13) VALUE SPACE.
026200     02 FILLER PIC X(15) VALUE " COPYRIGHT 1974".
026300 01  CCVS-E-4.
026400     02 CCVS-E-4-1 PIC XXX VALUE SPACE.
026500     02 FILLER PIC XXXX VALUE " OF ".
026600     02 CCVS-E-4-2 PIC XXX VALUE SPACE.
026700     02 FILLER PIC X(40) VALUE
026800      "  TESTS WERE EXECUTED SUCCESSFULLY".
026900 01  XXINFO.
027000     02 FILLER PIC X(30) VALUE "        *** INFORMATION  ***".
027100     02 INFO-TEXT.
027200     04 FILLER PIC X(20) VALUE SPACE.
027300     04 XXCOMPUTED PIC X(20).
027400     04 FILLER PIC X(5) VALUE SPACE.
027500     04 XXCORRECT PIC X(20).
027600 01  HYPHEN-LINE.
027700     02 FILLER PICTURE IS X VALUE IS SPACE.
027800     02 FILLER PICTURE IS X(65) VALUE IS "************************
027900-    "*****************************************".
028000     02 FILLER PICTURE IS X(54) VALUE IS "************************
028100-    "******************************".
028200 01  CCVS-PGM-ID PIC X(6) VALUE
028300     "DB104A".
028400 PROCEDURE DIVISION.
028500 DECLARATIVES.
028600 SORT-IN-PROC SECTION.
028700     USE FOR DEBUGGING ON SORT-IN.
028800 BEGIN-SORT-IN-PROC.
028900     MOVE 1 TO RESULT-FLAG.
029000 DB-COMMON.
029100     MOVE DEBUG-LINE TO DBLINE-HOLD.
029200     MOVE DEBUG-NAME TO DBNAME-HOLD.
029300     MOVE DEBUG-CONTENTS TO DBCONT-HOLD.
029400 SORT-OUT-PROC SECTION.
029500     USE FOR DEBUGGING ON SORT-OUT.
029600 BEGIN-SORT-OUT-PROC.
029700     MOVE 2 TO RESULT-FLAG.
029800     PERFORM DB-COMMON.
029900 USE-PROC SECTION.
030000     USE FOR DEBUGGING ON AT-END-PROC.
030100 BEGIN-USE-PROC.
030200     ADD 3 TO RESULT-FLAG.
030300     PERFORM DB-COMMON.
030400 AT-END-PROC SECTION.
030500     USE AFTER ERROR PROCEDURE ON GEN-FILE.
030600 BEGIN-AT-END-PROC.
030700     ADD 4 TO RESULT-FLAG.
030800 END DECLARATIVES.
030900 CCVS1 SECTION.
031000 OPEN-FILES.
031100     OPEN     OUTPUT PRINT-FILE.
031200     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
031300     MOVE    SPACE TO TEST-RESULTS.
031400     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
031500     GO TO CCVS1-EXIT.
031600 CLOSE-FILES.
031700     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
031800 TERMINATE-CCVS.
031900S    EXIT PROGRAM.
032000STERMINATE-CALL.
032100     STOP     RUN.
032200 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
032300 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
032400 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
032500 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
032600     MOVE "****TEST DELETED****" TO RE-MARK.
032700 PRINT-DETAIL.
032800     IF REC-CT NOT EQUAL TO ZERO
032900             MOVE "." TO PARDOT-X
033000             MOVE REC-CT TO DOTVALUE.
033100     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
033200     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
033300        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
033400          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
033500     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
033600     MOVE SPACE TO CORRECT-X.
033700     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
033800     MOVE     SPACE TO RE-MARK.
033900 HEAD-ROUTINE.
034000     MOVE CCVS-H-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034100     MOVE CCVS-H-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
034200     MOVE CCVS-H-3 TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
034300 COLUMN-NAMES-ROUTINE.
034400     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
034500     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
034600     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
034700 END-ROUTINE.
034800     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
034900 END-RTN-EXIT.
035000     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
035100 END-ROUTINE-1.
035200      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
035300      ERROR-HOLD. ADD DELETE-CNT TO ERROR-HOLD.
035400      ADD PASS-COUNTER TO ERROR-HOLD.
035500*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
035600      MOVE PASS-COUNTER TO CCVS-E-4-1.
035700      MOVE ERROR-HOLD TO CCVS-E-4-2.
035800      MOVE CCVS-E-4 TO CCVS-E-2-2.
035900      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
036000  END-ROUTINE-12.
036100      MOVE "TEST(S) FAILED" TO ENDER-DESC.
036200     IF       ERROR-COUNTER IS EQUAL TO ZERO
036300         MOVE "NO " TO ERROR-TOTAL
036400         ELSE
036500         MOVE ERROR-COUNTER TO ERROR-TOTAL.
036600     MOVE     CCVS-E-2 TO DUMMY-RECORD.
036700     PERFORM WRITE-LINE.
036800 END-ROUTINE-13.
036900     IF DELETE-CNT IS EQUAL TO ZERO
037000         MOVE "NO " TO ERROR-TOTAL  ELSE
037100         MOVE DELETE-CNT TO ERROR-TOTAL.
037200     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
037300     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037400      IF   INSPECT-COUNTER EQUAL TO ZERO
037500          MOVE "NO " TO ERROR-TOTAL
037600      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
037700      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
037800      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
037900     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
038000 WRITE-LINE.
038100     ADD 1 TO RECORD-COUNT.
038200Y    IF RECORD-COUNT GREATER 50
038300Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
038400Y        MOVE SPACE TO DUMMY-RECORD
038500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
038600Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
038700Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
038800Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
038900Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
039000Y        MOVE ZERO TO RECORD-COUNT.
039100     PERFORM WRT-LN.
039200 WRT-LN.
039300     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
039400     MOVE SPACE TO DUMMY-RECORD.
039500 BLANK-LINE-PRINT.
039600     PERFORM WRT-LN.
039700 FAIL-ROUTINE.
039800     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
039900     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
040000     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
040100     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
040200     GO TO FAIL-ROUTINE-EX.
040300 FAIL-ROUTINE-WRITE.
040400     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
040500     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
040600 FAIL-ROUTINE-EX. EXIT.
040700 BAIL-OUT.
040800     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
040900     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
041000 BAIL-OUT-WRITE.
041100     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
041200     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
041300 BAIL-OUT-EX. EXIT.
041400 CCVS1-EXIT.
041500     EXIT.
041600 BEGIN-FILE-GENERATION.
041700     MOVE FILE-RECORD-INFO-SKELETON TO FILE-RECORD-INFO (1).
041800     MOVE "GEN-FI" TO XFILE-NAME (1).
041900     MOVE "GEN-RE" TO XRECORD-NAME (1).
042000     MOVE "DB104A" TO XPROGRAM-NAME (1).
042100     MOVE 80 TO XRECORD-LENGTH (1).
042200     OPEN OUTPUT GEN-FILE.
042300     MOVE 99 TO XRECORD-NUMBER (1).
042400 GEN-LOOP.
042500     MOVE FILE-RECORD-INFO (1) TO GEN-REC.
042600     WRITE GEN-REC.
042700     IF XRECORD-NUMBER (1) IS GREATER THAN 5
042800         SUBTRACT 5 FROM XRECORD-NUMBER (1)
042900         GO TO GEN-LOOP.
043000 END-OF-GEN-LOOP.
043100     MOVE 98 TO XRECORD-NUMBER (1).
043200     PERFORM GEN-LOOP.
043300     MOVE 97 TO XRECORD-NUMBER (1).
043400     PERFORM GEN-LOOP.
043500     MOVE 96 TO XRECORD-NUMBER (1).
043600     PERFORM GEN-LOOP.
043700     MOVE 95 TO XRECORD-NUMBER (1).
043800     PERFORM GEN-LOOP.
043900     CLOSE GEN-FILE.
044000******************************************************************
044100*    THE DEBUG-LINE (INSPT) SUBTESTS FOR THE TESTS NAMED IN THE  *
044200*    OUTPUT REPORT AS "SORT-IN-2" AND "SORT-OUT-2" SHOULD POINT  *
044300*    TO THE "SORT" STATEMENT WHICH APPEARS IN THE PARAGRAPH      *
044400*    BELOW NAMED "BEGIN-TESTS".                                  *
044500******************************************************************
044600 BEGIN-TESTS.
044700     MOVE 0 TO RESULT-FLAG.
044800     SORT SORT-FILE ON ASCENDING KEY SORT-REC-NO
044900         INPUT PROCEDURE IS SORT-IN
045000         OUTPUT PROCEDURE IS SORT-OUT.
045100     GO TO AFTER-SORT.
045200 SORT-IN SECTION.
045300 SORT-IN-1.
045400     MOVE "SORT-IN-1" TO PAR-NAME.
045500     IF RESULT-FLAG IS NOT EQUAL TO 1
045600         MOVE "DEBUG PROCEDURE NOT EXECUTED" TO RE-MARK
045700         PERFORM FAIL-1
045800         PERFORM SORT-IN-WRITE
045900         GO TO SORT-IN-5
046000         ELSE  PERFORM PASS-1
046100         MOVE "DEBUG PROCEDURE EXECUTED" TO RE-MARK.
046200     PERFORM SORT-IN-WRITE.
046300     GO TO SORT-IN-2.
046400 SORT-IN-DELETE.
046500     MOVE "SORT-IN" TO PAR-NAME.
046600     PERFORM DE-LETE-1.
046700     PERFORM SORT-IN-WRITE.
046800     GO TO SORT-IN-5.
046900 SORT-IN-WRITE.
047000     MOVE "DEBUG SORT INPUT" TO FEATURE.
047100     PERFORM PRINT-DETAIL-1.
047200 SORT-IN-2.
047300     MOVE "SORT-IN-2" TO PAR-NAME.
047400     MOVE DBLINE-HOLD TO COMPUTED-A.
047500     MOVE "DEBUG-LINE, SEE NEXT LINE" TO RE-MARK.
047600     MOVE "<===  DEBUG-LINE" TO CORRECT-A.
047700     PERFORM   INSPT-1.
047800     PERFORM SORT-IN-WRITE.
047900 SORT-IN-3.
048000     MOVE DBNAME-HOLD TO SIZE-7.
048100     IF SIZE-7 IS EQUAL TO "SORT-IN"
048200         PERFORM PASS-1 ELSE
048300         MOVE "SORT-IN" TO CORRECT-A
048400         MOVE DBNAME-HOLD TO COMPUTED-A
048500         PERFORM FAIL-1.
048600     MOVE "DEBUG-NAME" TO RE-MARK.
048700     MOVE "SORT-IN-3" TO PAR-NAME.
048800     PERFORM SORT-IN-WRITE.
048900 SORT-IN-4.
049000     MOVE DBCONT-HOLD TO SIZE-10.
049100     IF SIZE-10 IS EQUAL TO "SORT INPUT"
049200         PERFORM PASS-1 ELSE
049300         MOVE "SORT INPUT" TO CORRECT-A
049400         MOVE DBCONT-HOLD TO COMPUTED-A
049500         PERFORM FAIL-1.
049600     MOVE "DEBUG-CONTENTS" TO RE-MARK.
049700     MOVE "SORT-IN-4" TO PAR-NAME.
049800     PERFORM SORT-IN-WRITE.
049900 SORT-IN-5.
050000     OPEN INPUT GEN-FILE.
050100     MOVE 0 TO RESULT-FLAG.
050200******************************************************************
050300*    THE DEBUG-LINE (INSPT) SUBTEST FOR THE TEST NAMED IN THE    *
050400*    OUTPUT REPORT AS "SORT-USE-TEST" SHOULD POINT TO THE        *
050500*    EXECUTABLE STATEMENT WHICH FOLLOWS THIS COMMENT SET AND     *
050600*    WHICH READS, "READ GEN-FILE".                               *
050700******************************************************************
050800 SORT-USE-TEST.
050900     READ GEN-FILE
051000*        AT END GO TO SORT-USE-DELETE.
051100*
051200*    IN CASE IMPLEMENTATION FAILS TO NOTIFY PROGRAM OF
051300*    END-OF-FILE VIA STATUS OR DECLARATIVE PROC, REMOVE ASTERISK
051400*    FROM THE FIRST OF THESE COMMENT LINES AND PERMIT THE AT END
051500*    CLAUSE TO BE COMPILED; THIS WILL RESULT IN TEST DELETION.
051600*
051700     IF RESULT-FLAG IS EQUAL TO 3
051800         CLOSE GEN-FILE GO TO SORT-USE-1.
051900     IF RESULT-FLAG IS EQUAL TO 4
052000         CLOSE GEN-FILE GO TO SORT-USE-3.
052100     IF RESULT-FLAG IS EQUAL TO 7
052200         CLOSE GEN-FILE
052300         PERFORM PASS-1
052400         MOVE "BOTH PROCEDURES EXECUTED" TO RE-MARK
052500         PERFORM SORT-USE-WRITE
052600         GO TO SORT-USE-2.
052700     IF END-FLAG IS EQUAL TO "1"
052800         CLOSE GEN-FILE GO TO SORT-USE-4.
052900     RELEASE SORT-REC FROM GEN-REC.
053000     GO TO SORT-USE-TEST.
053100 SORT-USE-DELETE.
053200     CLOSE GEN-FILE.
053300     PERFORM DE-LETE-1.
053400     GO TO SORT-USE-WRITE.
053500 SORT-USE-1.
053600     MOVE "ERROR PROCEDURE NOT COMPLETED" TO RE-MARK.
053700     PERFORM SORT-USE-WRITE.
053800 SORT-USE-2.
053900     MOVE "DEBUG-LINE, SEE NEXT LINE" TO RE-MARK.
054000     MOVE "<===  DEBUG-LINE" TO CORRECT-A.
054100     MOVE DBLINE-HOLD TO COMPUTED-A.
054200     PERFORM   INSPT-1.
054300     PERFORM SORT-USE-WRITE.
054400     MOVE DBNAME-HOLD TO SIZE-11.
054500     IF SIZE-11 IS EQUAL TO "AT-END-PROC"
054600         PERFORM PASS-1 ELSE
054700         MOVE DBNAME-HOLD TO COMPUTED-A
054800         MOVE "AT-END-PROC" TO CORRECT-A
054900         PERFORM FAIL-1.
055000     MOVE "DEBUG-NAME" TO RE-MARK.
055100     PERFORM SORT-USE-WRITE.
055200     MOVE DBCONT-HOLD TO SIZE-13.
055300     IF SIZE-13 IS EQUAL TO "USE PROCEDURE"
055400         PERFORM PASS-1 ELSE
055500         MOVE DBCONT-HOLD TO COMPUTED-A
055600         MOVE "USE PROCEDURE" TO CORRECT-A
055700         PERFORM FAIL-1.
055800     MOVE "DEBUG-CONTENTS" TO RE-MARK.
055900     GO TO SORT-USE-WRITE.
056000 SORT-USE-3.
056100     MOVE "DEBUG ON USE PROC NOT EXECUTED" TO RE-MARK.
056200     PERFORM FAIL-1.
056300     GO TO SORT-USE-WRITE.
056400 SORT-USE-4.
056500     MOVE "DEBUG AND USE PROCS BOTH FAIL" TO RE-MARK.
056600     PERFORM FAIL-1.
056700 SORT-USE-WRITE.
056800     MOVE "SORT-USE-TEST" TO PAR-NAME.
056900     MOVE "DEBUG USE PROC" TO FEATURE.
057000     PERFORM PRINT-DETAIL-1.
057100 SORT-USE-DONE.
057200     GO TO SORT-IN-EXIT.
057300 INSPT-1. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
057400 PASS-1.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
057500 FAIL-1.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
057600 DE-LETE-1.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
057700     MOVE "****TEST DELETED****" TO RE-MARK.
057800 PRINT-DETAIL-1.
057900     IF REC-CT NOT EQUAL TO ZERO
058000             MOVE "." TO PARDOT-X
058100             MOVE REC-CT TO DOTVALUE.
058200     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE-1.
058300     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE-1
058400        PERFORM FAIL-ROUTINE-1 THRU FAIL-ROUTINE-EX-1
058500          ELSE PERFORM BAIL-OUT-1 THRU BAIL-OUT-EX-1.
058600     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
058700     MOVE SPACE TO CORRECT-X.
058800     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
058900     MOVE     SPACE TO RE-MARK.
059000 WRITE-LINE-1.
059100     ADD 1 TO RECORD-COUNT.
059200Y    IF RECORD-COUNT GREATER 50
059300Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
059400Y        MOVE SPACE TO DUMMY-RECORD
059500Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
059600Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN-1
059700Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN-1 2 TIMES
059800Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN-1
059900Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
060000Y        MOVE ZERO TO RECORD-COUNT.
060100     PERFORM WRT-LN-1.
060200 WRT-LN-1.
060300     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
060400     MOVE SPACE TO DUMMY-RECORD.
060500 BLANK-LINE-PRINT-1.
060600     PERFORM WRT-LN-1.
060700 FAIL-ROUTINE-1.
060800     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-1.
060900     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-1.
061000     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
061100     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-1 2 TIMES.
061200     GO TO FAIL-ROUTINE-EX-1.
061300 FAIL-RTN-WRITE-1.
061400     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE-1
061500     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE-1 2 TIMES.
061600 FAIL-ROUTINE-EX-1. EXIT.
061700 BAIL-OUT-1.
061800     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE-1.
061900     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX-1.
062000 BAIL-OUT-WRITE-1.
062100     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
062200     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-1 2 TIMES.
062300 BAIL-OUT-EX-1. EXIT.
062400 SORT-IN-EXIT.
062500     MOVE 0 TO RESULT-FLAG.
062600 SORT-OUT SECTION.
062700 SORT-OUT-1.
062800     MOVE "SORT-OUT-1" TO PAR-NAME.
062900     IF RESULT-FLAG IS NOT EQUAL TO 2
063000         PERFORM FAIL-2
063100         MOVE "DEBUG PROCEDURE NOT EXECUTED" TO RE-MARK
063200         GO TO SORT-OUT-WRITE.
063300     PERFORM PASS-2.
063400     MOVE "DEBUG PROCEDURE EXECUTED" TO RE-MARK.
063500     PERFORM SORT-OUT-WRITE.
063600 SORT-OUT-2.
063700     MOVE "SORT-OUT-2" TO PAR-NAME.
063800     MOVE DBLINE-HOLD TO COMPUTED-A.
063900     MOVE "DEBUG-LINE, SEE NEXT LINE" TO RE-MARK.
064000     MOVE "<===  DEBUG-LINE" TO CORRECT-A.
064100     PERFORM   INSPT-2.
064200     PERFORM SORT-OUT-WRITE.
064300 SORT-OUT-3.
064400     MOVE "SORT-OUT-3" TO PAR-NAME.
064500     MOVE DBNAME-HOLD TO SIZE-8.
064600     IF SIZE-8 IS EQUAL TO "SORT-OUT"
064700         PERFORM PASS-2 ELSE
064800         MOVE "SORT-OUT" TO CORRECT-A
064900         MOVE DBNAME-HOLD TO COMPUTED-A
065000         PERFORM FAIL-2.
065100     MOVE "DEBUG-NAME" TO RE-MARK.
065200     PERFORM SORT-OUT-WRITE.
065300 SORT-OUT-4.
065400     MOVE "SORT-OUT-4" TO PAR-NAME.
065500     MOVE DBCONT-HOLD TO SIZE-11.
065600     IF SIZE-11 IS EQUAL TO "SORT OUTPUT"
065700         PERFORM PASS-2 ELSE
065800         MOVE "SORT OUTPUT" TO CORRECT-A
065900         MOVE DBCONT-HOLD TO COMPUTED-A
066000     PERFORM FAIL-2.
066100     MOVE "DEBUG-CONTENTS" TO RE-MARK.
066200     GO TO SORT-OUT-WRITE.
066300 SORT-OUT-DELETE.
066400     MOVE "SORT-OUT" TO PAR-NAME.
066500     PERFORM DE-LETE-2.
066600 SORT-OUT-WRITE.
066700     MOVE "DEBUG SORT OUTPUT" TO FEATURE.
066800     PERFORM PRINT-DETAIL-2.
066900 SORT-OUT-5.
067000     OPEN OUTPUT GEN-FILE.
067100 SORT-OUT-6.
067200     RETURN SORT-FILE INTO GEN-REC
067300         AT END GO TO SORT-OUT-EXIT.
067400     WRITE GEN-REC.
067500     GO TO SORT-OUT-6.
067600 INSPT-2. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
067700 PASS-2.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
067800 FAIL-2.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
067900 DE-LETE-2.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-CNT.
068000     MOVE "****TEST DELETED****" TO RE-MARK.
068100 PRINT-DETAIL-2.
068200     IF REC-CT NOT EQUAL TO ZERO
068300             MOVE "." TO PARDOT-X
068400             MOVE REC-CT TO DOTVALUE.
068500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE-2.
068600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE-2
068700        PERFORM FAIL-ROUTINE-2 THRU FAIL-ROUTINE-EX-2
068800          ELSE PERFORM BAIL-OUT-2 THRU BAIL-OUT-EX-2.
068900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
069000     MOVE SPACE TO CORRECT-X.
069100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
069200     MOVE     SPACE TO RE-MARK.
069300 WRITE-LINE-2.
069400     ADD 1 TO RECORD-COUNT.
069500Y    IF RECORD-COUNT GREATER 50
069600Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
069700Y        MOVE SPACE TO DUMMY-RECORD
069800Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
069900Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN-2
070000Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN-2 2 TIMES
070100Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN-2
070200Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
070300Y        MOVE ZERO TO RECORD-COUNT.
070400     PERFORM WRT-LN-2.
070500 WRT-LN-2.
070600     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
070700     MOVE SPACE TO DUMMY-RECORD.
070800 BLANK-LINE-PRINT-2.
070900     PERFORM WRT-LN-2.
071000 FAIL-ROUTINE-2.
071100     IF COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-2.
071200     IF CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-RTN-WRITE-2.
071300     MOVE "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
071400     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-2 2 TIMES.
071500     GO TO FAIL-ROUTINE-EX-2.
071600 FAIL-RTN-WRITE-2.
071700     MOVE TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE-2
071800     MOVE TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE-2 2 TIMES.
071900 FAIL-ROUTINE-EX-2. EXIT.
072000 BAIL-OUT-2.
072100     IF COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE-2.
072200     IF CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX-2.
072300 BAIL-OUT-WRITE-2.
072400     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
072500     MOVE XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE-2 2 TIMES.
072600 BAIL-OUT-EX-2. EXIT.
072700 SORT-OUT-EXIT.
072800     CLOSE GEN-FILE.
072900     MOVE 0 TO RESULT-FLAG.
073000 END-OF-SORT SECTION.
073100 AFTER-SORT.
073200     EXIT.
073300XDUMP-CODING SECTION.
073400XBEGIN-DUMP.
073500X    OPEN INPUT GEN-FILE.
073600X    PERFORM BLANK-LINE-PRINT.
073700X    MOVE " DUMP OF GEN-FILE FOLLOWS:" TO PRINT-REC.
073800X    PERFORM WRITE-LINE.
073900XDUMP-FILE-1.
074000X    READ GEN-FILE AT END GO TO DUMP-FILE-2.
074100X    MOVE GEN-REC TO PRINT-REC.
074200X    PERFORM WRITE-LINE.
074300X    GO TO DUMP-FILE-1.
074400XDUMP-FILE-2.
074500X    CLOSE GEN-FILE.
074600 CCVS-EXIT SECTION.
074700 CCVS-999999.
074800     GO TO CLOSE-FILES.
