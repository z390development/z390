000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     RL116A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*                                                              *
002200*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
002300*                                                              *
002400*            X-21   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR   *
002500*                    RELATIVE  I-O DATA FILE                   *
002600*            X-22   IMPLEMENTOR-NAME IN ASSIGN TO CLAUSE FOR   *
002700*                    RELATIVE  I-O DATA FILE                   *
002800*            X-55   SYSTEM PRINTER                             *
002900*            X-69   ADDITIONAL VALUE OF CLAUSES                *
003000*            X-74   VALUE OF IMPLEMENTOR-NAME                  *
003100*            X-75   OBJECT OF VALUE OF CLAUSE                  *
003200*            X-82   SOURCE-COMPUTER                            *
003300*            X-83   OBJECT-COMPUTER.                           *
003400*                                                              *
003500****************************************************************
003600*    RL116A                                                    *
003700****************************************************************
003800*            THIS PROGRAM TESTS THE SYNTACTICAL CONSTRUCTS AND
003900*            SEMANTIC ACTIONS ASSOCIATED WITH THE "STATUS"
004000*            CLAUSE FOR THE VALUES "00" AND "10".
004100*
004200*
004300*
004400***************************************************
004500 ENVIRONMENT DIVISION.
004600 CONFIGURATION SECTION.
004700 SOURCE-COMPUTER.
004800     XXXXX082.
004900 OBJECT-COMPUTER.
005000     XXXXX083.
005100 INPUT-OUTPUT SECTION.
005200 FILE-CONTROL.
005300     SELECT PRINT-FILE ASSIGN TO
005400     XXXXX055.
005500     SELECT   RL-FD2 ASSIGN
005600     XXXXX022
005700              ORGANIZATION RELATIVE
005800              ACCESS  RANDOM
005900              RELATIVE  RL-FD2-KEY
006000         FILE STATUS IS RL-FD2-STATUS.
006100     SELECT   RL-FD3 ASSIGN
006200     XXXXX022
006300              ORGANIZATION RELATIVE
006400              ACCESS  SEQUENTIAL
006500              RELATIVE  RL-FD3-KEY
006600         FILE STATUS IS RL-FD3-STATUS.
006700 DATA DIVISION.
006800 FILE SECTION.
006900 FD  PRINT-FILE.
007000 01  PRINT-REC PICTURE X(120).
007100 01  DUMMY-RECORD PICTURE X(120).
007200 FD  RL-FD2
007300C    VALUE OF
007400C    XXXXX074
007500C    IS
007600C    XXXXX076
007700G    XXXXX069
007800     LABEL RECORDS ARE STANDARD
007900     BLOCK CONTAINS 1 RECORDS
008000     DATA RECORD RL-FD2R1-F-G-240.
008100 01  RL-FD2R1-F-G-240.
008200     05 RL-FD2-WRK-120 PIC X(120).
008300     05 RL-FD2-GRP-120.
008400        10 RL-FD2-WRK-XN-0001-O120F
008500                        PICTURE X OCCURS 120 TIMES.
008600 FD  RL-FD3
008700C    VALUE OF
008800C    XXXXX074
008900C    IS
009000C    XXXXX076
009100G    XXXXX069
009200     LABEL RECORDS ARE STANDARD
009300     BLOCK CONTAINS 1 RECORDS
009400     DATA RECORD RL-FD3R1-F-G-240.
009500 01  RL-FD3R1-F-G-240.
009600     05 RL-FD3-WRK-120 PIC X(120).
009700     05 RL-FD3-GRP-130.
009800        10 RL-FD3-WRK-XN-0001-O120F
009900                        PICTURE X OCCURS 120 TIMES.
010000 WORKING-STORAGE SECTION.
010100 01  GRP-0001.
010200     05 RL-FD2-KEY   PIC 9(8)  VALUE ZERO.
010300     05 RL-FD3-KEY   PIC 9(8)  VALUE ZERO.
010400     05 WRK-CS-09V00-012  PIC S9(9) USAGE COMP  VALUE ZERO.
010500     05 WRK-CS-09V00-013  PIC S9(9) USAGE COMP  VALUE ZERO.
010600     05 WRK-CS-09V00-014  PIC S9(9) USAGE COMP  VALUE ZERO.
010700     05 WRK-CS-09V00-015  PIC S9(9) USAGE COMP  VALUE ZERO.
010800     05 WRK-CS-09V00-016  PIC S9(9) USAGE COMP  VALUE ZERO.
010900     05 WRK-CS-09V00-017  PIC S9(9) USAGE COMP  VALUE ZERO.
011000     05 WRK-CS-09V00-018  PIC S9(9) USAGE COMP  VALUE ZERO.
011100     05 RL-FD2-STATUS     PIC  XX  VALUE  SPACE.
011200     05 RL-FD3-STATUS     PIC  XX  VALUE  SPACE.
011300     05 WRK-XN-0002-001   PIC  X(2) VALUE  SPACE.
011400     05 WRK-XN-0002-002   PIC  X(2) VALUE  SPACE.
011500     05 WRK-XN-0002-003   PIC  X(2) VALUE  SPACE.
011600     05 WRK-XN-0002-004   PIC  X(2) VALUE  SPACE.
011700     05 WRK-XN-0002-005   PIC  X(2) VALUE  SPACE.
011800     05 WRK-XN-0002-006   PIC  X(2) VALUE  SPACE.
011900     05 WRK-XN-0002-007   PIC  X(2) VALUE  SPACE.
012000     05 WRK-XN-0002-008   PIC  X(2) VALUE  SPACE.
012100     05 WRK-XN-0002-009   PIC  X(2) VALUE  SPACE.
012200 01  FILE-RECORD-INFORMATION-REC.
012300     03 FILE-RECORD-INFO-SKELETON.
012400        05 FILLER                 PICTURE X(48)       VALUE
012500             "FILE=      ,RECORD=      /0,RECNO=000000,UPDT=00".
012600        05 FILLER                 PICTURE X(46)       VALUE
012700             ",ODO=0000,PGM=     ,LRECL=000000,BLKSIZ  =0000".
012800        05 FILLER                 PICTURE X(26)       VALUE
012900             ",LFIL=000000,ORG=  ,LBLR= ".
013000        05 FILLER                 PICTURE X(37)       VALUE
013100             ",RECKEY=                             ".
013200        05 FILLER                 PICTURE X(38)       VALUE
013300             ",ALTKEY1=                             ".
013400        05 FILLER                 PICTURE X(38)       VALUE
013500             ",ALTKEY2=                             ".
013600        05 FILLER                 PICTURE X(7)        VALUE SPACE.
013700     03 FILE-RECORD-INFO          OCCURS  10  TIMES.
013800        05 FILE-RECORD-INFO-P1-120.
013900           07 FILLER              PIC X(5).
014000           07 XFILE-NAME           PIC X(6).
014100           07 FILLER              PIC X(8).
014200           07 XRECORD-NAME         PIC X(6).
014300           07 FILLER              PIC X(1).
014400           07 REELUNIT-NUMBER     PIC 9(1).
014500           07 FILLER              PIC X(7).
014600           07 XRECORD-NUMBER       PIC 9(6).
014700           07 FILLER              PIC X(6).
014800           07 UPDATE-NUMBER       PIC 9(2).
014900           07 FILLER              PIC X(5).
015000           07 ODO-NUMBER          PIC 9(4).
015100           07 FILLER              PIC X(5).
015200           07 XPROGRAM-NAME        PIC X(5).
015300           07 FILLER              PIC X(7).
015400           07 XRECORD-LENGTH       PIC 9(6).
015500           07 FILLER              PIC X(7).
015600           07 CHARS-OR-RECORDS    PIC X(2).
015700           07 FILLER              PIC X(1).
015800           07 XBLOCK-SIZE          PIC 9(4).
015900           07 FILLER              PIC X(6).
016000           07 RECORDS-IN-FILE     PIC 9(6).
016100           07 FILLER              PIC X(5).
016200           07 XFILE-ORGANIZATION   PIC X(2).
016300           07 FILLER              PIC X(6).
016400           07 XLABEL-TYPE          PIC X(1).
016500        05 FILE-RECORD-INFO-P121-240.
016600           07 FILLER              PIC X(8).
016700           07 XRECORD-KEY          PIC X(29).
016800           07 FILLER              PIC X(9).
016900           07 ALTERNATE-KEY1      PIC X(29).
017000           07 FILLER              PIC X(9).
017100           07 ALTERNATE-KEY2      PIC X(29).
017200           07 FILLER              PIC X(7).
017300 01  TEST-RESULTS.
017400     02 FILLER                   PIC X      VALUE SPACE.
017500     02 FEATURE                  PIC X(20)  VALUE SPACE.
017600     02 FILLER                   PIC X      VALUE SPACE.
017700     02 P-OR-F                   PIC X(5)   VALUE SPACE.
017800     02 FILLER                   PIC X      VALUE SPACE.
017900     02  PAR-NAME.
018000       03 FILLER                 PIC X(19)  VALUE SPACE.
018100       03  PARDOT-X              PIC X      VALUE SPACE.
018200       03 DOTVALUE               PIC 99     VALUE ZERO.
018300     02 FILLER                   PIC X(8)   VALUE SPACE.
018400     02 RE-MARK                  PIC X(61).
018500 01  TEST-COMPUTED.
018600     02 FILLER                   PIC X(30)  VALUE SPACE.
018700     02 FILLER                   PIC X(17)  VALUE
018800            "       COMPUTED=".
018900     02 COMPUTED-X.
019000     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
019100     03 COMPUTED-N               REDEFINES COMPUTED-A
019200                                 PIC -9(9).9(9).
019300     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
019400     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
019500     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
019600     03       CM-18V0 REDEFINES COMPUTED-A.
019700         04 COMPUTED-18V0                    PIC -9(18).
019800         04 FILLER                           PIC X.
019900     03 FILLER PIC X(50) VALUE SPACE.
020000 01  TEST-CORRECT.
020100     02 FILLER PIC X(30) VALUE SPACE.
020200     02 FILLER PIC X(17) VALUE "       CORRECT =".
020300     02 CORRECT-X.
020400     03 CORRECT-A                  PIC X(20) VALUE SPACE.
020500     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
020600     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
020700     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
020800     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
020900     03      CR-18V0 REDEFINES CORRECT-A.
021000         04 CORRECT-18V0                     PIC -9(18).
021100         04 FILLER                           PIC X.
021200     03 FILLER PIC X(2) VALUE SPACE.
021300     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
021400 01  CCVS-C-1.
021500     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
021600-    "SS  PARAGRAPH-NAME
021700-    "       REMARKS".
021800     02 FILLER                     PIC X(20)    VALUE SPACE.
021900 01  CCVS-C-2.
022000     02 FILLER                     PIC X        VALUE SPACE.
022100     02 FILLER                     PIC X(6)     VALUE "TESTED".
022200     02 FILLER                     PIC X(15)    VALUE SPACE.
022300     02 FILLER                     PIC X(4)     VALUE "FAIL".
022400     02 FILLER                     PIC X(94)    VALUE SPACE.
022500 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
022600 01  REC-CT                        PIC 99       VALUE ZERO.
022700 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
022800 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
022900 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
023000 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
023100 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
023200 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
023300 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
023400 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
023500 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
023600 01  CCVS-H-1.
023700     02  FILLER                    PIC X(39)    VALUE SPACES.
023800     02  FILLER                    PIC X(42)    VALUE
023900     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
024000     02  FILLER                    PIC X(39)    VALUE SPACES.
024100 01  CCVS-H-2A.
024200   02  FILLER                        PIC X(40)  VALUE SPACE.
024300   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
024400   02  FILLER                        PIC XXXX   VALUE
024500     "4.2 ".
024600   02  FILLER                        PIC X(28)  VALUE
024700            " COPY - NOT FOR DISTRIBUTION".
024800   02  FILLER                        PIC X(41)  VALUE SPACE.
024900
025000 01  CCVS-H-2B.
025100   02  FILLER                        PIC X(15)  VALUE
025200            "TEST RESULT OF ".
025300   02  TEST-ID                       PIC X(9).
025400   02  FILLER                        PIC X(4)   VALUE
025500            " IN ".
025600   02  FILLER                        PIC X(12)  VALUE
025700     " HIGH       ".
025800   02  FILLER                        PIC X(22)  VALUE
025900            " LEVEL VALIDATION FOR ".
026000   02  FILLER                        PIC X(58)  VALUE
026100     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
026200 01  CCVS-H-3.
026300     02  FILLER                      PIC X(34)  VALUE
026400            " FOR OFFICIAL USE ONLY    ".
026500     02  FILLER                      PIC X(58)  VALUE
026600     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
026700     02  FILLER                      PIC X(28)  VALUE
026800            "  COPYRIGHT   1985 ".
026900 01  CCVS-E-1.
027000     02 FILLER                       PIC X(52)  VALUE SPACE.
027100     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
027200     02 ID-AGAIN                     PIC X(9).
027300     02 FILLER                       PIC X(45)  VALUE SPACES.
027400 01  CCVS-E-2.
027500     02  FILLER                      PIC X(31)  VALUE SPACE.
027600     02  FILLER                      PIC X(21)  VALUE SPACE.
027700     02 CCVS-E-2-2.
027800         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
027900         03 FILLER                   PIC X      VALUE SPACE.
028000         03 ENDER-DESC               PIC X(44)  VALUE
028100            "ERRORS ENCOUNTERED".
028200 01  CCVS-E-3.
028300     02  FILLER                      PIC X(22)  VALUE
028400            " FOR OFFICIAL USE ONLY".
028500     02  FILLER                      PIC X(12)  VALUE SPACE.
028600     02  FILLER                      PIC X(58)  VALUE
028700     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
028800     02  FILLER                      PIC X(13)  VALUE SPACE.
028900     02 FILLER                       PIC X(15)  VALUE
029000             " COPYRIGHT 1985".
029100 01  CCVS-E-4.
029200     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
029300     02 FILLER                       PIC X(4)   VALUE " OF ".
029400     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
029500     02 FILLER                       PIC X(40)  VALUE
029600      "  TESTS WERE EXECUTED SUCCESSFULLY".
029700 01  XXINFO.
029800     02 FILLER                       PIC X(19)  VALUE
029900            "*** INFORMATION ***".
030000     02 INFO-TEXT.
030100       04 FILLER                     PIC X(8)   VALUE SPACE.
030200       04 XXCOMPUTED                 PIC X(20).
030300       04 FILLER                     PIC X(5)   VALUE SPACE.
030400       04 XXCORRECT                  PIC X(20).
030500     02 INF-ANSI-REFERENCE           PIC X(48).
030600 01  HYPHEN-LINE.
030700     02 FILLER  PIC IS X VALUE IS SPACE.
030800     02 FILLER  PIC IS X(65)    VALUE IS "************************
030900-    "*****************************************".
031000     02 FILLER  PIC IS X(54)    VALUE IS "************************
031100-    "******************************".
031200 01  CCVS-PGM-ID                     PIC X(9)   VALUE
031300     "RL116A".
031400 PROCEDURE DIVISION.
031500 DECLARATIVES.
031600 RL-FD2-01 SECTION.
031700     USE     AFTER ERROR PROCEDURE I-O.
031800 RL-FD2-01-01.
031900     MOVE   "PASS " TO P-OR-F.
032000     ADD     1 TO PASS-COUNTER.
032100*
032200     IF      REC-CT NOT EQUAL TO ZERO
032300             MOVE "." TO PARDOT-X
032400             MOVE REC-CT TO DOTVALUE.
032500     MOVE    TEST-RESULTS TO PRINT-REC.
032600     PERFORM D1-WRITE-LINE THRU D1-WRITE-LINE-EXIT.
032700     IF      P-OR-F EQUAL TO "FAIL*"
032800             PERFORM D1-WRITE-LINE THRU D1-WRITE-LINE-EXIT
032900             PERFORM D1-FAIL-ROUTINE THRU D1-FAIL-ROUTINE-EX
033000      ELSE
033100             PERFORM D1-BAIL-OUT THRU D1-BAIL-OUT-EX.
033200     MOVE    SPACE TO P-OR-F.
033300     MOVE    SPACE TO COMPUTED-X.
033400     MOVE    SPACE TO CORRECT-X.
033500     IF      REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
033600     MOVE    SPACE TO RE-MARK.
033700     GO TO   RL-FD2-01-EXIT.
033800 D1-FAIL-ROUTINE.
033900     IF      COMPUTED-X NOT EQUAL TO SPACE
034000             GO TO   D1-FAIL-ROUTINE-WRITE.
034100     IF      CORRECT-X NOT EQUAL TO SPACE
034200             GO TO   D1-FAIL-ROUTINE-WRITE.
034300     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
034400     MOVE   "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
034500     MOVE    XXINFO TO DUMMY-RECORD.
034600     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
034700     MOVE    SPACE TO DUMMY-RECORD.
034800     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
034900     MOVE    SPACE TO DUMMY-RECORD.
035000     MOVE    SPACES TO INF-ANSI-REFERENCE.
035100     GO TO   D1-FAIL-ROUTINE-EX.
035200 D1-FAIL-ROUTINE-WRITE.
035300     MOVE    TEST-COMPUTED TO PRINT-REC.
035400     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
035500     MOVE    SPACE TO DUMMY-RECORD.
035600     MOVE    ANSI-REFERENCE TO COR-ANSI-REFERENCE.
035700     MOVE    TEST-CORRECT TO PRINT-REC.
035800     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
035900     MOVE    SPACE TO DUMMY-RECORD.
036000     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
036100     MOVE    SPACE TO DUMMY-RECORD.
036200     MOVE    SPACES TO COR-ANSI-REFERENCE.
036300 D1-FAIL-ROUTINE-EX.
036400     EXIT.
036500 D1-BAIL-OUT.
036600     IF      COMPUTED-A NOT EQUAL TO SPACE
036700             GO TO    D1-BAIL-OUT-WRITE.
036800     IF      CORRECT-A EQUAL TO SPACE
036900             GO TO    D1-BAIL-OUT-EX.
037000 D1-BAIL-OUT-WRITE.
037100     MOVE    CORRECT-A  TO XXCORRECT.
037200     MOVE    COMPUTED-A TO XXCOMPUTED.
037300     MOVE    ANSI-REFERENCE TO INF-ANSI-REFERENCE.
037400     MOVE    XXINFO TO DUMMY-RECORD.
037500     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
037600     MOVE    SPACE TO DUMMY-RECORD.
037700     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
037800     MOVE    SPACE TO DUMMY-RECORD.
037900     MOVE    SPACES TO INF-ANSI-REFERENCE.
038000 D1-BAIL-OUT-EX.
038100     EXIT.
038200 D1-WRITE-LINE.
038300     ADD     1 TO RECORD-COUNT.
038400Y    IF      RECORD-COUNT GREATER 50
038500Y            MOVE    DUMMY-RECORD TO DUMMY-HOLD
038600Y            MOVE    SPACE TO DUMMY-RECORD
038700Y            WRITE   DUMMY-RECORD AFTER ADVANCING PAGE
038800Y            MOVE    CCVS-C-1 TO DUMMY-RECORD
038900Y            WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES
039000Y            MOVE    SPACE TO DUMMY-RECORD
039100Y            MOVE    CCVS-C-2 TO DUMMY-RECORD
039200Y            WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES
039300Y            MOVE    SPACE TO DUMMY-RECORD
039400Y            WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES
039500Y            MOVE    SPACE TO DUMMY-RECORD
039600Y            MOVE    HYPHEN-LINE TO DUMMY-RECORD
039700Y            WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES
039800Y            MOVE    SPACE TO DUMMY-RECORD
039900Y            MOVE    DUMMY-HOLD TO DUMMY-RECORD
040000Y            MOVE    ZERO TO RECORD-COUNT.
040100     WRITE   DUMMY-RECORD AFTER ADVANCING 1 LINES.
040200     MOVE    SPACE TO DUMMY-RECORD.
040300 D1-WRITE-LINE-EXIT.
040400     EXIT.
040500 RL-FD2-01-EXIT.
040600     EXIT.
040700 END DECLARATIVES.
040800 CCVS1 SECTION.
040900 OPEN-FILES.
041000     OPEN    OUTPUT PRINT-FILE.
041100     MOVE  CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
041200     MOVE    SPACE TO TEST-RESULTS.
041300     PERFORM HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
041400     MOVE    ZERO TO REC-SKL-SUB.
041500     PERFORM CCVS-INIT-FILE 9 TIMES.
041600 CCVS-INIT-FILE.
041700     ADD     1 TO REC-SKL-SUB.
041800     MOVE    FILE-RECORD-INFO-SKELETON
041900          TO FILE-RECORD-INFO (REC-SKL-SUB).
042000 CCVS-INIT-EXIT.
042100     GO TO CCVS1-EXIT.
042200 CLOSE-FILES.
042300     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
042400 TERMINATE-CCVS.
042500S    EXIT PROGRAM.
042600STERMINATE-CALL.
042700     STOP     RUN.
042800 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
042900 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
043000 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
043100 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
043200     MOVE "****TEST DELETED****" TO RE-MARK.
043300 PRINT-DETAIL.
043400     IF REC-CT NOT EQUAL TO ZERO
043500             MOVE "." TO PARDOT-X
043600             MOVE REC-CT TO DOTVALUE.
043700     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
043800     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
043900        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
044000          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
044100     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
044200     MOVE SPACE TO CORRECT-X.
044300     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
044400     MOVE     SPACE TO RE-MARK.
044500 HEAD-ROUTINE.
044600     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044700     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
044800     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
044900     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
045000 COLUMN-NAMES-ROUTINE.
045100     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
045200     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
045400 END-ROUTINE.
045500     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
045600 END-RTN-EXIT.
045700     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
045800 END-ROUTINE-1.
045900      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
046000      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
046100      ADD PASS-COUNTER TO ERROR-HOLD.
046200*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
046300      MOVE PASS-COUNTER TO CCVS-E-4-1.
046400      MOVE ERROR-HOLD TO CCVS-E-4-2.
046500      MOVE CCVS-E-4 TO CCVS-E-2-2.
046600      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
046700  END-ROUTINE-12.
046800      MOVE "TEST(S) FAILED" TO ENDER-DESC.
046900     IF       ERROR-COUNTER IS EQUAL TO ZERO
047000         MOVE "NO " TO ERROR-TOTAL
047100         ELSE
047200         MOVE ERROR-COUNTER TO ERROR-TOTAL.
047300     MOVE     CCVS-E-2 TO DUMMY-RECORD.
047400     PERFORM WRITE-LINE.
047500 END-ROUTINE-13.
047600     IF DELETE-COUNTER IS EQUAL TO ZERO
047700         MOVE "NO " TO ERROR-TOTAL  ELSE
047800         MOVE DELETE-COUNTER TO ERROR-TOTAL.
047900     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
048000     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
048100      IF   INSPECT-COUNTER EQUAL TO ZERO
048200          MOVE "NO " TO ERROR-TOTAL
048300      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
048400      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
048500      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
048600     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
048700 WRITE-LINE.
048800     ADD 1 TO RECORD-COUNT.
048900Y    IF RECORD-COUNT GREATER 50
049000Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
049100Y        MOVE SPACE TO DUMMY-RECORD
049200Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
049300Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
049400Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
049500Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
049600Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
049700Y        MOVE ZERO TO RECORD-COUNT.
049800     PERFORM WRT-LN.
049900 WRT-LN.
050000     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
050100     MOVE SPACE TO DUMMY-RECORD.
050200 BLANK-LINE-PRINT.
050300     PERFORM WRT-LN.
050400 FAIL-ROUTINE.
050500     IF     COMPUTED-X NOT EQUAL TO SPACE
050600            GO TO   FAIL-ROUTINE-WRITE.
050700     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
050800     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
050900     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
051000     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
051100     MOVE   SPACES TO INF-ANSI-REFERENCE.
051200     GO TO  FAIL-ROUTINE-EX.
051300 FAIL-ROUTINE-WRITE.
051400     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
051500     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
051600     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
051700     MOVE   SPACES TO COR-ANSI-REFERENCE.
051800 FAIL-ROUTINE-EX. EXIT.
051900 BAIL-OUT.
052000     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
052100     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
052200 BAIL-OUT-WRITE.
052300     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
052400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
052500     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
052600     MOVE   SPACES TO INF-ANSI-REFERENCE.
052700 BAIL-OUT-EX. EXIT.
052800 CCVS1-EXIT.
052900     EXIT.
053000 SECT-RL116A-001 SECTION.
053100 REL-INIT-009.
053200     MOVE    "VIII-36 4.8.4 GR4" TO ANSI-REFERENCE.
053300     MOVE    "REL-TEST-009" TO PAR-NAME.
053400     MOVE     "CREATE RL-FD2" TO  FEATURE
053500     MOVE     "RL-FD2"        TO  XFILE-NAME (2).
053600     MOVE     "R1-F-G"        TO  XRECORD-NAME (2).
053700     MOVE CCVS-PGM-ID             TO  XPROGRAM-NAME (2).
053800     MOVE     000240          TO  XRECORD-LENGTH (2).
053900     MOVE     "RC"            TO  CHARS-OR-RECORDS (2).
054000     MOVE     0001            TO  XBLOCK-SIZE       (2).
054100     MOVE     000500          TO  RECORDS-IN-FILE  (2).
054200     MOVE     "RL"            TO  XFILE-ORGANIZATION (2).
054300     MOVE     "S"             TO  XLABEL-TYPE        (2).
054400     MOVE     000001          TO  XRECORD-NUMBER     (2).
054500*INITIALIZE  RECORD WORK AREA NUMBER 2.
054600     MOVE     1         TO  WRK-CS-09V00-012.
054700     MOVE     ZERO      TO  WRK-CS-09V00-013 WRK-CS-09V00-014
054800                            WRK-CS-09V00-015 WRK-CS-09V00-016
054900                            WRK-CS-09V00-017 WRK-CS-09V00-018.
055000     MOVE     SPACE     TO  RL-FD2-STATUS.
055100     MOVE     90000002  TO  RL-FD2-KEY.
055200     MOVE     01 TO REC-CT.
055300     OPEN     OUTPUT    RL-FD2.
055400     MOVE     RL-FD2-STATUS TO WRK-XN-0002-001.
055500*CAPTURE STATUS KEY AFTER  OPEN STATEMENT IS EXECUTED.
055600 REL-INIT-1.
055700     MOVE   "REL-TEST-1" TO PAR-NAME.
055800     MOVE   "VII-3 1.3.4 1A" TO ANSI-REFERENCE.
055900     MOVE    XRECORD-NUMBER (2) TO RL-FD2-KEY.
056000     MOVE   "99"  TO RL-FD2-STATUS.
056100     MOVE    FILE-RECORD-INFO-P1-120 (2) TO RL-FD2-WRK-120.
056200     MOVE    FILE-RECORD-INFO-P1-120 (2) TO RL-FD2-GRP-120.
056300     WRITE   RL-FD2R1-F-G-240
056400            INVALID KEY CONTINUE.
056500 REL-TEST-1.
056600     IF      RL-FD2-STATUS NOT EQUAL TO "00"
056700             MOVE "INVALID WRITE" TO RE-MARK
056800             MOVE RL-FD2-STATUS TO COMPUTED-X
056900             MOVE "00" TO CORRECT-X
057000             PERFORM FAIL
057100             PERFORM PRINT-DETAIL
057200     ELSE
057300             PERFORM PASS
057400             PERFORM PRINT-DETAIL.
057500*
057600 REL-INIT-2.
057700     MOVE   "REL-TEST-2" TO PAR-NAME.
057800     MOVE   "VII-3 1.3.4 2A" TO ANSI-REFERENCE.
057900     IF      RL-FD2-STATUS NOT = "00"
058000             MOVE  "TEST-2 NOT PERFORMED DUE TO FAILURE OF TEST-1"
058100                  TO RE-MARK
058200             PERFORM FAIL
058300             PERFORM PRINT-DETAIL
058400             GO TO   REL-TEST-2-EXIT.
058500     CLOSE   RL-FD2.
058600     OPEN    INPUT RL-FD3.
058700     MOVE 1 TO RL-FD3-KEY.
058800 REL-TEST-2-0.
058900     READ    RL-FD3
059000             AT END GO TO REL-TEST-2-1.
059100     GO TO   REL-TEST-2-0.
059200 REL-TEST-2-1.
059300     IF      RL-FD3-STATUS NOT = "10"
059400             MOVE    RL-FD3-STATUS TO COMPUTED-X
059500             MOVE   "10" TO CORRECT-X
059600             PERFORM FAIL
059700             PERFORM PRINT-DETAIL
059800     ELSE
059900             PERFORM PASS
060000             PERFORM PRINT-DETAIL.
060100     CLOSE   RL-FD3
060200     IF      RL-FD3-STATUS NOT EQUAL TO "00"
060300             MOVE "CLOSE/STATUS" TO RE-MARK
060400             MOVE  RL-FD3-STATUS TO  COMPUTED-A
060500             MOVE "00" TO CORRECT-A
060600             PERFORM FAIL
060700     ELSE
060800             PERFORM PASS.
060900     PERFORM PRINT-DETAIL.
061000 REL-TEST-2-EXIT.
061100*
061200 CCVS-EXIT SECTION.
061300 CCVS-999999.
061400     GO TO CLOSE-FILES.
