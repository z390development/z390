000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     SM104A.
000400****************************************************************
000500*                                                              *
000600*    VALIDATION FOR:-                                          *
000700*                                                              *
000800*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
000900*                                                              *
001000*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001100*                                                              *
001200****************************************************************
001300*                                                              *
001400*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001500*                                                              *
001600*        X-55  - SYSTEM PRINTER NAME.                          *
001700*        X-82  - SOURCE COMPUTER NAME.                         *
001800*        X-83  - OBJECT COMPUTER NAME.                         *
001900*                                                              *
002000****************************************************************
002100*                                                              *
002200*    PROGRAM SM104A READS AND CHECKS THE FILE PRODUCED BY      *
002300*    SM103A TO VERIFY THE PROPER EXECUTION OF THE "COPY"       *
002400*    STATEMENTS IN THAT PROGRAM.                               *
002500*                                                              *
002600****************************************************************
002700 ENVIRONMENT DIVISION.
002800 CONFIGURATION SECTION.
002900 SOURCE-COMPUTER.
003000     XXXXX082.
003100 OBJECT-COMPUTER.
003200     XXXXX083.
003300 INPUT-OUTPUT SECTION.
003400 FILE-CONTROL.
003500     SELECT PRINT-FILE ASSIGN TO
003600     XXXXX055.
003700     SELECT TEST-FILE ASSIGN TO
003800* THE FOLLOWING LINE WILL BE CHANGED BY TPF ONLY WHEN THE
003900* PROGRAM-ID IS PART OF THE REPLACEMENT BY THE X-CARD
004000* DURING EXTRACTION.
004100     XXXXD001.
004200 DATA DIVISION.
004300 FILE SECTION.
004400 FD  PRINT-FILE.
004500 01  PRINT-REC PICTURE X(120).
004600 01  DUMMY-RECORD PICTURE X(120).
004700 FD  TEST-FILE
004800     LABEL RECORD STANDARD
004900C    VALUE OF
005000C    XXXXX074
005100C    IS
005200C    XXXXX075
005300G    XXXXX069
005400     DATA RECORD TEST-REC.
005500 01  TEST-REC.
005600     02  TST-FLD-1 PICTURE 9(5).
005700     02  TST-FLD-2 PICTURE X(13).
005800     02  FILLER PICTURE X(102).
005900 WORKING-STORAGE SECTION.
006000 01  TEST-RESULTS.
006100     02 FILLER                   PIC X      VALUE SPACE.
006200     02 FEATURE                  PIC X(20)  VALUE SPACE.
006300     02 FILLER                   PIC X      VALUE SPACE.
006400     02 P-OR-F                   PIC X(5)   VALUE SPACE.
006500     02 FILLER                   PIC X      VALUE SPACE.
006600     02  PAR-NAME.
006700       03 FILLER                 PIC X(19)  VALUE SPACE.
006800       03  PARDOT-X              PIC X      VALUE SPACE.
006900       03 DOTVALUE               PIC 99     VALUE ZERO.
007000     02 FILLER                   PIC X(8)   VALUE SPACE.
007100     02 RE-MARK                  PIC X(61).
007200 01  TEST-COMPUTED.
007300     02 FILLER                   PIC X(30)  VALUE SPACE.
007400     02 FILLER                   PIC X(17)  VALUE
007500            "       COMPUTED=".
007600     02 COMPUTED-X.
007700     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
007800     03 COMPUTED-N               REDEFINES COMPUTED-A
007900                                 PIC -9(9).9(9).
008000     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
008100     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
008200     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
008300     03       CM-18V0 REDEFINES COMPUTED-A.
008400         04 COMPUTED-18V0                    PIC -9(18).
008500         04 FILLER                           PIC X.
008600     03 FILLER PIC X(50) VALUE SPACE.
008700 01  TEST-CORRECT.
008800     02 FILLER PIC X(30) VALUE SPACE.
008900     02 FILLER PIC X(17) VALUE "       CORRECT =".
009000     02 CORRECT-X.
009100     03 CORRECT-A                  PIC X(20) VALUE SPACE.
009200     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
009300     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
009400     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
009500     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
009600     03      CR-18V0 REDEFINES CORRECT-A.
009700         04 CORRECT-18V0                     PIC -9(18).
009800         04 FILLER                           PIC X.
009900     03 FILLER PIC X(2) VALUE SPACE.
010000     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
010100 01  CCVS-C-1.
010200     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
010300-    "SS  PARAGRAPH-NAME
010400-    "       REMARKS".
010500     02 FILLER                     PIC X(20)    VALUE SPACE.
010600 01  CCVS-C-2.
010700     02 FILLER                     PIC X        VALUE SPACE.
010800     02 FILLER                     PIC X(6)     VALUE "TESTED".
010900     02 FILLER                     PIC X(15)    VALUE SPACE.
011000     02 FILLER                     PIC X(4)     VALUE "FAIL".
011100     02 FILLER                     PIC X(94)    VALUE SPACE.
011200 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
011300 01  REC-CT                        PIC 99       VALUE ZERO.
011400 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
011500 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
011600 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
011700 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
011800 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
011900 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
012000 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
012100 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
012200 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
012300 01  CCVS-H-1.
012400     02  FILLER                    PIC X(39)    VALUE SPACES.
012500     02  FILLER                    PIC X(42)    VALUE
012600     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
012700     02  FILLER                    PIC X(39)    VALUE SPACES.
012800 01  CCVS-H-2A.
012900   02  FILLER                        PIC X(40)  VALUE SPACE.
013000   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
013100   02  FILLER                        PIC XXXX   VALUE
013200     "4.2 ".
013300   02  FILLER                        PIC X(28)  VALUE
013400            " COPY - NOT FOR DISTRIBUTION".
013500   02  FILLER                        PIC X(41)  VALUE SPACE.
013600
013700 01  CCVS-H-2B.
013800   02  FILLER                        PIC X(15)  VALUE
013900            "TEST RESULT OF ".
014000   02  TEST-ID                       PIC X(9).
014100   02  FILLER                        PIC X(4)   VALUE
014200            " IN ".
014300   02  FILLER                        PIC X(12)  VALUE
014400     " HIGH       ".
014500   02  FILLER                        PIC X(22)  VALUE
014600            " LEVEL VALIDATION FOR ".
014700   02  FILLER                        PIC X(58)  VALUE
014800     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
014900 01  CCVS-H-3.
015000     02  FILLER                      PIC X(34)  VALUE
015100            " FOR OFFICIAL USE ONLY    ".
015200     02  FILLER                      PIC X(58)  VALUE
015300     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
015400     02  FILLER                      PIC X(28)  VALUE
015500            "  COPYRIGHT   1985 ".
015600 01  CCVS-E-1.
015700     02 FILLER                       PIC X(52)  VALUE SPACE.
015800     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
015900     02 ID-AGAIN                     PIC X(9).
016000     02 FILLER                       PIC X(45)  VALUE SPACES.
016100 01  CCVS-E-2.
016200     02  FILLER                      PIC X(31)  VALUE SPACE.
016300     02  FILLER                      PIC X(21)  VALUE SPACE.
016400     02 CCVS-E-2-2.
016500         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
016600         03 FILLER                   PIC X      VALUE SPACE.
016700         03 ENDER-DESC               PIC X(44)  VALUE
016800            "ERRORS ENCOUNTERED".
016900 01  CCVS-E-3.
017000     02  FILLER                      PIC X(22)  VALUE
017100            " FOR OFFICIAL USE ONLY".
017200     02  FILLER                      PIC X(12)  VALUE SPACE.
017300     02  FILLER                      PIC X(58)  VALUE
017400     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
017500     02  FILLER                      PIC X(13)  VALUE SPACE.
017600     02 FILLER                       PIC X(15)  VALUE
017700             " COPYRIGHT 1985".
017800 01  CCVS-E-4.
017900     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
018000     02 FILLER                       PIC X(4)   VALUE " OF ".
018100     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
018200     02 FILLER                       PIC X(40)  VALUE
018300      "  TESTS WERE EXECUTED SUCCESSFULLY".
018400 01  XXINFO.
018500     02 FILLER                       PIC X(19)  VALUE
018600            "*** INFORMATION ***".
018700     02 INFO-TEXT.
018800       04 FILLER                     PIC X(8)   VALUE SPACE.
018900       04 XXCOMPUTED                 PIC X(20).
019000       04 FILLER                     PIC X(5)   VALUE SPACE.
019100       04 XXCORRECT                  PIC X(20).
019200     02 INF-ANSI-REFERENCE           PIC X(48).
019300 01  HYPHEN-LINE.
019400     02 FILLER  PIC IS X VALUE IS SPACE.
019500     02 FILLER  PIC IS X(65)    VALUE IS "************************
019600-    "*****************************************".
019700     02 FILLER  PIC IS X(54)    VALUE IS "************************
019800-    "******************************".
019900 01  CCVS-PGM-ID                     PIC X(9)   VALUE
020000     "SM104A".
020100 PROCEDURE DIVISION.
020200 CCVS1 SECTION.
020300 OPEN-FILES.
020400     OPEN     OUTPUT PRINT-FILE.
020500     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
020600     MOVE    SPACE TO TEST-RESULTS.
020700     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
020800     GO TO CCVS1-EXIT.
020900 CLOSE-FILES.
021000     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
021100 TERMINATE-CCVS.
021200S    EXIT PROGRAM.
021300STERMINATE-CALL.
021400     STOP     RUN.
021500 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
021600 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
021700 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
021800 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
021900     MOVE "****TEST DELETED****" TO RE-MARK.
022000 PRINT-DETAIL.
022100     IF REC-CT NOT EQUAL TO ZERO
022200             MOVE "." TO PARDOT-X
022300             MOVE REC-CT TO DOTVALUE.
022400     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
022500     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
022600        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
022700          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
022800     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
022900     MOVE SPACE TO CORRECT-X.
023000     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
023100     MOVE     SPACE TO RE-MARK.
023200 HEAD-ROUTINE.
023300     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023400     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
023500     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
023600     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
023700 COLUMN-NAMES-ROUTINE.
023800     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
023900     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024000     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
024100 END-ROUTINE.
024200     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
024300 END-RTN-EXIT.
024400     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024500 END-ROUTINE-1.
024600      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
024700      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
024800      ADD PASS-COUNTER TO ERROR-HOLD.
024900*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
025000      MOVE PASS-COUNTER TO CCVS-E-4-1.
025100      MOVE ERROR-HOLD TO CCVS-E-4-2.
025200      MOVE CCVS-E-4 TO CCVS-E-2-2.
025300      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
025400  END-ROUTINE-12.
025500      MOVE "TEST(S) FAILED" TO ENDER-DESC.
025600     IF       ERROR-COUNTER IS EQUAL TO ZERO
025700         MOVE "NO " TO ERROR-TOTAL
025800         ELSE
025900         MOVE ERROR-COUNTER TO ERROR-TOTAL.
026000     MOVE     CCVS-E-2 TO DUMMY-RECORD.
026100     PERFORM WRITE-LINE.
026200 END-ROUTINE-13.
026300     IF DELETE-COUNTER IS EQUAL TO ZERO
026400         MOVE "NO " TO ERROR-TOTAL  ELSE
026500         MOVE DELETE-COUNTER TO ERROR-TOTAL.
026600     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
026700     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
026800      IF   INSPECT-COUNTER EQUAL TO ZERO
026900          MOVE "NO " TO ERROR-TOTAL
027000      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
027100      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
027200      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027300     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027400 WRITE-LINE.
027500     ADD 1 TO RECORD-COUNT.
027600Y    IF RECORD-COUNT GREATER 50
027700Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
027800Y        MOVE SPACE TO DUMMY-RECORD
027900Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
028000Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
028100Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
028200Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
028300Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
028400Y        MOVE ZERO TO RECORD-COUNT.
028500     PERFORM WRT-LN.
028600 WRT-LN.
028700     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
028800     MOVE SPACE TO DUMMY-RECORD.
028900 BLANK-LINE-PRINT.
029000     PERFORM WRT-LN.
029100 FAIL-ROUTINE.
029200     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
029300     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
029400     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
029500     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
029600     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
029700     MOVE   SPACES TO INF-ANSI-REFERENCE.
029800     GO TO  FAIL-ROUTINE-EX.
029900 FAIL-ROUTINE-WRITE.
030000     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
030100     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
030200     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
030300     MOVE   SPACES TO COR-ANSI-REFERENCE.
030400 FAIL-ROUTINE-EX. EXIT.
030500 BAIL-OUT.
030600     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
030700     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
030800 BAIL-OUT-WRITE.
030900     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
031000     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
031100     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
031200     MOVE   SPACES TO INF-ANSI-REFERENCE.
031300 BAIL-OUT-EX. EXIT.
031400 CCVS1-EXIT.
031500     EXIT.
031600 INITIALIZATION SECTION.
031700 SM104A-INIT.
031800     OPEN     INPUT TEST-FILE.
031900     MOVE     "ALL TESTS IN SM104A CHECK" TO RE-MARK.
032000     PERFORM  PRINT-DETAIL.
032100     MOVE     "OUTPUT OF SM103A."         TO RE-MARK.
032200     PERFORM  PRINT-DETAIL.
032300     MOVE     "COPY ---" TO FEATURE.
032400     PERFORM  PRINT-DETAIL.
032500 COPY-INIT-A.
032600     MOVE     "COPY WITHIN NOTE" TO FEATURE.
032700 COPY-TEST-1.
032800
032900
033000
033100
033200
033300*
033400******************* COPY WITHIN NOTE USED ************************
033500*
033600*        NOTE                                         COPY K4NTA.
033700*
033800**************** NO TEXT EXPANSION SHOULD OCCUR ******************
033900*        NOTE                                          COPY K4NTA.
034000 COPY-PASS-1.
034100     PERFORM PASS.
034200*        NOTE K4NTA IS IN THE LIBRARY BUT IT SHOULD
034300*             NOT BE COPIED.
034400 COPY-WRITE-1.
034500     MOVE     "COPY-TEST-1" TO PAR-NAME.
034600     PERFORM  PRINT-DETAIL.
034700 COPY-TEST-2.
034800*        NOTE THE WORDS COPY WHICH ARE IN THIS NOTE SHOULD
034900*             NOT BE TREATED AS COPY VERBS, AND THE FOLLOWING
035000*             "STATEMENTS" SHOULD BE TREATED AS PART OF THIS NOTE.
035100*             PERFORM FAIL.
035200*             MOVE "SEE COPY-TEST-2" TO RE-MARK.
035300*             GO TO COPY-WRITE-2.
035400 COPY-PASS-2.
035500     PERFORM PASS.
035600 COPY-WRITE-2.
035700     MOVE     "COPY-TEST-2" TO PAR-NAME.
035800     PERFORM PRINT-DETAIL.
035900 ENVIRONMENT-TEST SECTION.
036000 COPY-TEST-3.
036100     PERFORM  READ-TEST-FILE.
036200     IF       TST-FLD-2 EQUAL TO "12.345.678,91"
036300              PERFORM PASS GO TO COPY-WRITE-3.
036400     GO       TO COPY-FAIL-3.
036500 COPY-DELETE-3.
036600     PERFORM  DE-LETE.
036700     GO       TO COPY-WRITE-3.
036800 COPY-FAIL-3.
036900     MOVE     TST-FLD-2 TO COMPUTED-N.
037000     MOVE     "12.345.678,91" TO CORRECT-A.
037100     PERFORM  FAIL.
037200 COPY-WRITE-3.
037300     MOVE     "  DEC POINT IS COMMA" TO FEATURE.
037400     MOVE     "COPY-TEST-3 " TO PAR-NAME.
037500     PERFORM  PRINT-DETAIL.
037600 COPY-INIT-B.
037700     MOVE     "  ENVIR DIV ENTRIES" TO FEATURE.
037800 COPY-TEST-4.
037900     IF       TST-FLD-1 EQUAL TO 97532
038000              PERFORM PASS GO TO COPY-WRITE-4.
038100     GO       TO COPY-FAIL-4.
038200 COPY-DELETE-4.
038300     PERFORM  DE-LETE.
038400     GO       TO COPY-WRITE-4.
038500 COPY-FAIL-4.
038600     MOVE     TST-FLD-1 TO COMPUTED-N.
038700     MOVE     97532 TO CORRECT-N.
038800     PERFORM  FAIL.
038900 COPY-WRITE-4.
039000     MOVE     "COPY-TEST-4 " TO PAR-NAME.
039100     PERFORM  PRINT-DETAIL.
039200 COPY-TEST-5.
039300     PERFORM  READ-TEST-FILE.
039400     IF       TST-FLD-1 EQUAL TO 23479
039500              PERFORM PASS GO TO COPY-WRITE-5.
039600     GO       TO COPY-FAIL-5.
039700 COPY-DELETE-5.
039800     PERFORM  DE-LETE.
039900     GO       TO COPY-WRITE-5.
040000 COPY-FAIL-5.
040100     MOVE     TST-FLD-1 TO COMPUTED-N.
040200     MOVE     23479 TO CORRECT-N.
040300     PERFORM  FAIL.
040400 COPY-WRITE-5.
040500     MOVE     "COPY-TEST-5 " TO PAR-NAME.
040600     PERFORM  PRINT-DETAIL.
040700 COPY-TEST-6.
040800     PERFORM  READ-TEST-FILE 3 TIMES.
040900     IF       TST-FLD-1 EQUAL TO 14003
041000              PERFORM PASS GO TO COPY-WRITE-6.
041100     GO       TO COPY-FAIL-6.
041200 COPY-DELETE-6.
041300     PERFORM  DE-LETE.
041400     GO       TO COPY-WRITE-6.
041500 COPY-FAIL-6.
041600     MOVE     TST-FLD-1 TO COMPUTED-N.
041700     MOVE     14003 TO CORRECT-N.
041800     PERFORM  FAIL.
041900 COPY-WRITE-6.
042000     MOVE     "COPY-TEST-6 " TO PAR-NAME.
042100     PERFORM  PRINT-DETAIL.
042200 COPY-TEST-7.
042300     PERFORM  READ-TEST-FILE 2 TIMES.
042400     IF       TST-FLD-1 EQUAL TO 03543
042500              PERFORM PASS GO TO COPY-WRITE-7.
042600     GO       TO COPY-FAIL-7.
042700 COPY-DELETE-7.
042800     PERFORM  DE-LETE.
042900     GO       TO COPY-WRITE-7.
043000 COPY-FAIL-7.
043100     MOVE     TST-FLD-1 TO COMPUTED-N.
043200     MOVE     03543 TO CORRECT-N.
043300     PERFORM  FAIL.
043400 COPY-WRITE-7.
043500     MOVE     "COPY-TEST-7 " TO PAR-NAME.
043600     PERFORM  PRINT-DETAIL.
043700     CLOSE    TEST-FILE.
043800     GO TO CCVS-EXIT.
043900 READ-TEST-FILE.
044000     READ     TEST-FILE          AT END GO TO BAD-FILE.
044100 BAD-FILE.
044200     MOVE     "BAD-FILE" TO PAR-NAME.
044300     PERFORM  FAIL.
044400     MOVE     "EOF PREMATURELY FOUND" TO RE-MARK.
044500     PERFORM  PRINT-DETAIL.
044600     CLOSE    TEST-FILE.
044700 CCVS-EXIT SECTION.
044800 CCVS-999999.
044900     GO TO CLOSE-FILES.
