000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.
000300     NC222A.
000400*                                                              *
000500****************************************************************
000600*                                                              *
000700*    VALIDATION FOR:-                                          *
000800*                                                              *
000900*    "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
001000*                                                              *
001100*    "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
001200*                                                              *
001300****************************************************************
001400*                                                              *
001500*      X-CARDS USED BY THIS PROGRAM ARE :-                     *
001600*                                                              *
001700*        X-55  - SYSTEM PRINTER NAME.                          *
001800*        X-82  - SOURCE COMPUTER NAME.                         *
001900*        X-83  - OBJECT COMPUTER NAME.                         *
002000*                                                              *
002100****************************************************************
002200*    PROGRAM NC222A TESTS THE USE OF INDEXED IDENTIFIERS WITH  *
002300*    FORMAT 2 OF THE "ADD", "SUBTRACT" AND "MOVE" STATEMENTS.  *
002400*    DE-EDITING BY USE OF THE "MOVE" STATEMENT IS ALSO TESTED. *
002500*                                                              *
002600****************************************************************
002700 ENVIRONMENT DIVISION.
002800 CONFIGURATION SECTION.
002900 SOURCE-COMPUTER.
003000     XXXXX082.
003100 OBJECT-COMPUTER.
003200     XXXXX083.
003300 INPUT-OUTPUT SECTION.
003400 FILE-CONTROL.
003500     SELECT PRINT-FILE ASSIGN TO
003600     XXXXX055.
003700 DATA DIVISION.
003800 FILE SECTION.
003900 FD  PRINT-FILE.
004000 01  PRINT-REC PICTURE X(120).
004100 01  DUMMY-RECORD PICTURE X(120).
004200 WORKING-STORAGE SECTION.
004300 01  TABLE1.
004400     02  RECORD1                 PICTURE 99.
004500     02  RECORD2                 PICTURE 99
004600                                 OCCURS 2 TIMES
004700                                 INDEXED BY INDEX1.
004800     02  RECORD3                 PICTURE 99.
004900 01  TABLE2.
005000     02  RECORD1                 PICTURE 99.
005100     02  RECORD2                 PICTURE 99
005200                                 OCCURS 2 TIMES
005300                                 INDEXED BY INDEX2.
005400     02  RECORD3                 PICTURE 99.
005500 01  TABLE3.
005600     02  RECORD1                 PICTURE XX   VALUE "AA".
005700     02  RECORD2                 PICTURE XX
005800                                 OCCURS 2 TIMES
005900                                 INDEXED BY INDEX3.
006000     02  RECORD3                 PICTURE XX   VALUE "DD".
006100 01  TABLE4.
006200     02  RECORD1                 PICTURE XX   VALUE "EE".
006300     02  RECORD2                 PICTURE XX
006400                                 OCCURS 2 TIMES
006500                                 INDEXED BY INDEX4.
006600     02  RECORD3                 PICTURE XX   VALUE "HH".
006700 01  MOVE-TEST-3-A               PIC $(4)9.99CR.
006800 01  MOVE-TEST-3-B               PIC S9(4)V99.
006900 01  MOVE-TEST-4-A               PIC --9B.99B99/99.
007000 01  MOVE-TEST-4-B               PIC S99V9(6).
007100 01  TEST-RESULTS.
007200     02 FILLER                   PIC X      VALUE SPACE.
007300     02 FEATURE                  PIC X(20)  VALUE SPACE.
007400     02 FILLER                   PIC X      VALUE SPACE.
007500     02 P-OR-F                   PIC X(5)   VALUE SPACE.
007600     02 FILLER                   PIC X      VALUE SPACE.
007700     02  PAR-NAME.
007800       03 FILLER                 PIC X(19)  VALUE SPACE.
007900       03  PARDOT-X              PIC X      VALUE SPACE.
008000       03 DOTVALUE               PIC 99     VALUE ZERO.
008100     02 FILLER                   PIC X(8)   VALUE SPACE.
008200     02 RE-MARK                  PIC X(61).
008300 01  TEST-COMPUTED.
008400     02 FILLER                   PIC X(30)  VALUE SPACE.
008500     02 FILLER                   PIC X(17)  VALUE
008600            "       COMPUTED=".
008700     02 COMPUTED-X.
008800     03 COMPUTED-A               PIC X(20)  VALUE SPACE.
008900     03 COMPUTED-N               REDEFINES COMPUTED-A
009000                                 PIC -9(9).9(9).
009100     03 COMPUTED-0V18 REDEFINES COMPUTED-A   PIC -.9(18).
009200     03 COMPUTED-4V14 REDEFINES COMPUTED-A   PIC -9(4).9(14).
009300     03 COMPUTED-14V4 REDEFINES COMPUTED-A   PIC -9(14).9(4).
009400     03       CM-18V0 REDEFINES COMPUTED-A.
009500         04 COMPUTED-18V0                    PIC -9(18).
009600         04 FILLER                           PIC X.
009700     03 FILLER PIC X(50) VALUE SPACE.
009800 01  TEST-CORRECT.
009900     02 FILLER PIC X(30) VALUE SPACE.
010000     02 FILLER PIC X(17) VALUE "       CORRECT =".
010100     02 CORRECT-X.
010200     03 CORRECT-A                  PIC X(20) VALUE SPACE.
010300     03 CORRECT-N    REDEFINES CORRECT-A     PIC -9(9).9(9).
010400     03 CORRECT-0V18 REDEFINES CORRECT-A     PIC -.9(18).
010500     03 CORRECT-4V14 REDEFINES CORRECT-A     PIC -9(4).9(14).
010600     03 CORRECT-14V4 REDEFINES CORRECT-A     PIC -9(14).9(4).
010700     03      CR-18V0 REDEFINES CORRECT-A.
010800         04 CORRECT-18V0                     PIC -9(18).
010900         04 FILLER                           PIC X.
011000     03 FILLER PIC X(2) VALUE SPACE.
011100     03 COR-ANSI-REFERENCE             PIC X(48) VALUE SPACE.
011200 01  CCVS-C-1.
011300     02 FILLER  PIC IS X(99)    VALUE IS " FEATURE              PA
011400-    "SS  PARAGRAPH-NAME
011500-    "       REMARKS".
011600     02 FILLER                     PIC X(20)    VALUE SPACE.
011700 01  CCVS-C-2.
011800     02 FILLER                     PIC X        VALUE SPACE.
011900     02 FILLER                     PIC X(6)     VALUE "TESTED".
012000     02 FILLER                     PIC X(15)    VALUE SPACE.
012100     02 FILLER                     PIC X(4)     VALUE "FAIL".
012200     02 FILLER                     PIC X(94)    VALUE SPACE.
012300 01  REC-SKL-SUB                   PIC 9(2)     VALUE ZERO.
012400 01  REC-CT                        PIC 99       VALUE ZERO.
012500 01  DELETE-COUNTER                PIC 999      VALUE ZERO.
012600 01  ERROR-COUNTER                 PIC 999      VALUE ZERO.
012700 01  INSPECT-COUNTER               PIC 999      VALUE ZERO.
012800 01  PASS-COUNTER                  PIC 999      VALUE ZERO.
012900 01  TOTAL-ERROR                   PIC 999      VALUE ZERO.
013000 01  ERROR-HOLD                    PIC 999      VALUE ZERO.
013100 01  DUMMY-HOLD                    PIC X(120)   VALUE SPACE.
013200 01  RECORD-COUNT                  PIC 9(5)     VALUE ZERO.
013300 01  ANSI-REFERENCE                PIC X(48)    VALUE SPACES.
013400 01  CCVS-H-1.
013500     02  FILLER                    PIC X(39)    VALUE SPACES.
013600     02  FILLER                    PIC X(42)    VALUE
013700     "OFFICIAL COBOL COMPILER VALIDATION SYSTEM".
013800     02  FILLER                    PIC X(39)    VALUE SPACES.
013900 01  CCVS-H-2A.
014000   02  FILLER                        PIC X(40)  VALUE SPACE.
014100   02  FILLER                        PIC X(7)   VALUE "CCVS85 ".
014200   02  FILLER                        PIC XXXX   VALUE
014300     "4.2 ".
014400   02  FILLER                        PIC X(28)  VALUE
014500            " COPY - NOT FOR DISTRIBUTION".
014600   02  FILLER                        PIC X(41)  VALUE SPACE.
014700
014800 01  CCVS-H-2B.
014900   02  FILLER                        PIC X(15)  VALUE
015000            "TEST RESULT OF ".
015100   02  TEST-ID                       PIC X(9).
015200   02  FILLER                        PIC X(4)   VALUE
015300            " IN ".
015400   02  FILLER                        PIC X(12)  VALUE
015500     " HIGH       ".
015600   02  FILLER                        PIC X(22)  VALUE
015700            " LEVEL VALIDATION FOR ".
015800   02  FILLER                        PIC X(58)  VALUE
015900     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
016000 01  CCVS-H-3.
016100     02  FILLER                      PIC X(34)  VALUE
016200            " FOR OFFICIAL USE ONLY    ".
016300     02  FILLER                      PIC X(58)  VALUE
016400     "COBOL 85 VERSION 4.2, Apr  1993 SSVG                      ".
016500     02  FILLER                      PIC X(28)  VALUE
016600            "  COPYRIGHT   1985 ".
016700 01  CCVS-E-1.
016800     02 FILLER                       PIC X(52)  VALUE SPACE.
016900     02 FILLER  PIC X(14) VALUE IS "END OF TEST-  ".
017000     02 ID-AGAIN                     PIC X(9).
017100     02 FILLER                       PIC X(45)  VALUE SPACES.
017200 01  CCVS-E-2.
017300     02  FILLER                      PIC X(31)  VALUE SPACE.
017400     02  FILLER                      PIC X(21)  VALUE SPACE.
017500     02 CCVS-E-2-2.
017600         03 ERROR-TOTAL              PIC XXX    VALUE SPACE.
017700         03 FILLER                   PIC X      VALUE SPACE.
017800         03 ENDER-DESC               PIC X(44)  VALUE
017900            "ERRORS ENCOUNTERED".
018000 01  CCVS-E-3.
018100     02  FILLER                      PIC X(22)  VALUE
018200            " FOR OFFICIAL USE ONLY".
018300     02  FILLER                      PIC X(12)  VALUE SPACE.
018400     02  FILLER                      PIC X(58)  VALUE
018500     "ON-SITE VALIDATION, NATIONAL INSTITUTE OF STD & TECH.     ".
018600     02  FILLER                      PIC X(13)  VALUE SPACE.
018700     02 FILLER                       PIC X(15)  VALUE
018800             " COPYRIGHT 1985".
018900 01  CCVS-E-4.
019000     02 CCVS-E-4-1                   PIC XXX    VALUE SPACE.
019100     02 FILLER                       PIC X(4)   VALUE " OF ".
019200     02 CCVS-E-4-2                   PIC XXX    VALUE SPACE.
019300     02 FILLER                       PIC X(40)  VALUE
019400      "  TESTS WERE EXECUTED SUCCESSFULLY".
019500 01  XXINFO.
019600     02 FILLER                       PIC X(19)  VALUE
019700            "*** INFORMATION ***".
019800     02 INFO-TEXT.
019900       04 FILLER                     PIC X(8)   VALUE SPACE.
020000       04 XXCOMPUTED                 PIC X(20).
020100       04 FILLER                     PIC X(5)   VALUE SPACE.
020200       04 XXCORRECT                  PIC X(20).
020300     02 INF-ANSI-REFERENCE           PIC X(48).
020400 01  HYPHEN-LINE.
020500     02 FILLER  PIC IS X VALUE IS SPACE.
020600     02 FILLER  PIC IS X(65)    VALUE IS "************************
020700-    "*****************************************".
020800     02 FILLER  PIC IS X(54)    VALUE IS "************************
020900-    "******************************".
021000 01  CCVS-PGM-ID                     PIC X(9)   VALUE
021100     "NC222A".
021200 PROCEDURE DIVISION.
021300 CCVS1 SECTION.
021400 OPEN-FILES.
021500     OPEN     OUTPUT PRINT-FILE.
021600     MOVE CCVS-PGM-ID TO TEST-ID. MOVE CCVS-PGM-ID TO ID-AGAIN.
021700     MOVE    SPACE TO TEST-RESULTS.
021800     PERFORM  HEAD-ROUTINE THRU COLUMN-NAMES-ROUTINE.
021900     GO TO CCVS1-EXIT.
022000 CLOSE-FILES.
022100     PERFORM END-ROUTINE THRU END-ROUTINE-13. CLOSE PRINT-FILE.
022200 TERMINATE-CCVS.
022300S    EXIT PROGRAM.
022400STERMINATE-CALL.
022500     STOP     RUN.
022600 INSPT. MOVE "INSPT" TO P-OR-F. ADD 1 TO INSPECT-COUNTER.
022700 PASS.  MOVE "PASS " TO P-OR-F.  ADD 1 TO PASS-COUNTER.
022800 FAIL.  MOVE "FAIL*" TO P-OR-F.  ADD 1 TO ERROR-COUNTER.
022900 DE-LETE.  MOVE "*****" TO P-OR-F.  ADD 1 TO DELETE-COUNTER.
023000     MOVE "****TEST DELETED****" TO RE-MARK.
023100 PRINT-DETAIL.
023200     IF REC-CT NOT EQUAL TO ZERO
023300             MOVE "." TO PARDOT-X
023400             MOVE REC-CT TO DOTVALUE.
023500     MOVE     TEST-RESULTS TO PRINT-REC. PERFORM WRITE-LINE.
023600     IF P-OR-F EQUAL TO "FAIL*"  PERFORM WRITE-LINE
023700        PERFORM FAIL-ROUTINE THRU FAIL-ROUTINE-EX
023800          ELSE PERFORM BAIL-OUT THRU BAIL-OUT-EX.
023900     MOVE SPACE TO P-OR-F. MOVE SPACE TO COMPUTED-X.
024000     MOVE SPACE TO CORRECT-X.
024100     IF     REC-CT EQUAL TO ZERO  MOVE SPACE TO PAR-NAME.
024200     MOVE     SPACE TO RE-MARK.
024300 HEAD-ROUTINE.
024400     MOVE CCVS-H-1  TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024500     MOVE CCVS-H-2A TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
024600     MOVE CCVS-H-2B TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
024700     MOVE CCVS-H-3  TO DUMMY-RECORD. PERFORM WRITE-LINE 3 TIMES.
024800 COLUMN-NAMES-ROUTINE.
024900     MOVE CCVS-C-1 TO DUMMY-RECORD. PERFORM WRITE-LINE.
025000     MOVE CCVS-C-2 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025100     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE.
025200 END-ROUTINE.
025300     MOVE HYPHEN-LINE TO DUMMY-RECORD. PERFORM WRITE-LINE 5 TIMES.
025400 END-RTN-EXIT.
025500     MOVE CCVS-E-1 TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
025600 END-ROUTINE-1.
025700      ADD ERROR-COUNTER TO ERROR-HOLD ADD INSPECT-COUNTER TO
025800      ERROR-HOLD. ADD DELETE-COUNTER TO ERROR-HOLD.
025900      ADD PASS-COUNTER TO ERROR-HOLD.
026000*     IF PASS-COUNTER EQUAL TO ERROR-HOLD GO TO END-ROUTINE-12.
026100      MOVE PASS-COUNTER TO CCVS-E-4-1.
026200      MOVE ERROR-HOLD TO CCVS-E-4-2.
026300      MOVE CCVS-E-4 TO CCVS-E-2-2.
026400      MOVE CCVS-E-2 TO DUMMY-RECORD PERFORM WRITE-LINE.
026500  END-ROUTINE-12.
026600      MOVE "TEST(S) FAILED" TO ENDER-DESC.
026700     IF       ERROR-COUNTER IS EQUAL TO ZERO
026800         MOVE "NO " TO ERROR-TOTAL
026900         ELSE
027000         MOVE ERROR-COUNTER TO ERROR-TOTAL.
027100     MOVE     CCVS-E-2 TO DUMMY-RECORD.
027200     PERFORM WRITE-LINE.
027300 END-ROUTINE-13.
027400     IF DELETE-COUNTER IS EQUAL TO ZERO
027500         MOVE "NO " TO ERROR-TOTAL  ELSE
027600         MOVE DELETE-COUNTER TO ERROR-TOTAL.
027700     MOVE "TEST(S) DELETED     " TO ENDER-DESC.
027800     MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
027900      IF   INSPECT-COUNTER EQUAL TO ZERO
028000          MOVE "NO " TO ERROR-TOTAL
028100      ELSE MOVE INSPECT-COUNTER TO ERROR-TOTAL.
028200      MOVE "TEST(S) REQUIRE INSPECTION" TO ENDER-DESC.
028300      MOVE CCVS-E-2 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028400     MOVE CCVS-E-3 TO DUMMY-RECORD. PERFORM WRITE-LINE.
028500 WRITE-LINE.
028600     ADD 1 TO RECORD-COUNT.
028700Y    IF RECORD-COUNT GREATER 50
028800Y        MOVE DUMMY-RECORD TO DUMMY-HOLD
028900Y        MOVE SPACE TO DUMMY-RECORD
029000Y        WRITE DUMMY-RECORD AFTER ADVANCING PAGE
029100Y        MOVE CCVS-C-1 TO DUMMY-RECORD PERFORM WRT-LN
029200Y        MOVE CCVS-C-2 TO DUMMY-RECORD PERFORM WRT-LN 2 TIMES
029300Y        MOVE HYPHEN-LINE TO DUMMY-RECORD PERFORM WRT-LN
029400Y        MOVE DUMMY-HOLD TO DUMMY-RECORD
029500Y        MOVE ZERO TO RECORD-COUNT.
029600     PERFORM WRT-LN.
029700 WRT-LN.
029800     WRITE    DUMMY-RECORD AFTER ADVANCING 1 LINES.
029900     MOVE SPACE TO DUMMY-RECORD.
030000 BLANK-LINE-PRINT.
030100     PERFORM WRT-LN.
030200 FAIL-ROUTINE.
030300     IF   COMPUTED-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
030400     IF     CORRECT-X NOT EQUAL TO SPACE GO TO FAIL-ROUTINE-WRITE.
030500     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
030600     MOVE  "NO FURTHER INFORMATION, SEE PROGRAM." TO INFO-TEXT.
030700     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
030800     MOVE   SPACES TO INF-ANSI-REFERENCE.
030900     GO TO  FAIL-ROUTINE-EX.
031000 FAIL-ROUTINE-WRITE.
031100     MOVE   TEST-COMPUTED TO PRINT-REC PERFORM WRITE-LINE
031200     MOVE   ANSI-REFERENCE TO COR-ANSI-REFERENCE.
031300     MOVE   TEST-CORRECT TO PRINT-REC PERFORM WRITE-LINE 2 TIMES.
031400     MOVE   SPACES TO COR-ANSI-REFERENCE.
031500 FAIL-ROUTINE-EX. EXIT.
031600 BAIL-OUT.
031700     IF     COMPUTED-A NOT EQUAL TO SPACE GO TO BAIL-OUT-WRITE.
031800     IF     CORRECT-A EQUAL TO SPACE GO TO BAIL-OUT-EX.
031900 BAIL-OUT-WRITE.
032000     MOVE CORRECT-A TO XXCORRECT. MOVE COMPUTED-A TO XXCOMPUTED.
032100     MOVE   ANSI-REFERENCE TO INF-ANSI-REFERENCE.
032200     MOVE   XXINFO TO DUMMY-RECORD. PERFORM WRITE-LINE 2 TIMES.
032300     MOVE   SPACES TO INF-ANSI-REFERENCE.
032400 BAIL-OUT-EX. EXIT.
032500 CCVS1-EXIT.
032600     EXIT.
032700 INITIALISE-TABLE1.
032800     MOVE 06 TO RECORD1 OF TABLE1.
032900     MOVE 01 TO RECORD2 OF TABLE1 (1).
033000     MOVE 02 TO RECORD2 OF TABLE1 (2).
033100     MOVE 07 TO RECORD3 OF TABLE1.
033200 INITIALISE-TABLE2.
033300     MOVE 08 TO RECORD1 OF TABLE2.
033400     MOVE 03 TO RECORD2 OF TABLE2 (1).
033500     MOVE 04 TO RECORD2 OF TABLE2 (2).
033600     MOVE 09 TO RECORD3 OF TABLE2.
033700*
033800 ADD-INIT-F2-1.
033900     MOVE   "ADD-TEST-F2-1" TO PAR-NAME.
034000     MOVE "IV-21 4.3.8.2" TO ANSI-REFERENCE.
034100     MOVE "ADD - QUALIFICATION" TO FEATURE.
034200     PERFORM INITIALISE-TABLE1.
034300     PERFORM INITIALISE-TABLE2.
034400     SET INDEX1 TO 1.
034500     SET INDEX2 TO 1.
034600 ADD-TEST-F2-1.
034700     ADD RECORD2 OF TABLE1 (INDEX1) TO RECORD2 OF TABLE2 (INDEX2).
034800     IF      RECORD2 OF TABLE2 (1) = 04
034900         AND RECORD2 OF TABLE2 (2) = 04
035000         AND RECORD1 OF TABLE2 = 08
035100         AND RECORD3 OF TABLE2 = 09
035200             PERFORM PASS
035300     ELSE
035400             GO TO   ADD-FAIL-F2-1.
035500     GO TO   ADD-WRITE-F2-1.
035600 ADD-DELETE-F2-1.
035700     PERFORM DE-LETE.
035800     GO TO   ADD-WRITE-F2-1.
035900 ADD-FAIL-F2-1.
036000     PERFORM FAIL.
036100     MOVE    TABLE2 TO COMPUTED-A.
036200     MOVE   "08040409" TO CORRECT-A.
036300 ADD-WRITE-F2-1.
036400     PERFORM PRINT-DETAIL.
036500
036600 SUBTRACT-INIT-F2-1.
036700     MOVE "SUBTRACT-TEST-F2-1" TO PAR-NAME.
036800     MOVE "IV-21 4.3.8.2" TO ANSI-REFERENCE.
036900     MOVE   "SUBTRACT - QUAL." TO FEATURE.
037000     PERFORM INITIALISE-TABLE1.
037100     PERFORM INITIALISE-TABLE2.
037200     SET     INDEX1 TO 1.
037300     SET     INDEX2 TO 1.
037400 SUBTRACT-TEST-F2-1-0.
037500     SUBTRACT RECORD2 OF TABLE1 (INDEX1)
037600         FROM RECORD2 OF TABLE2 (INDEX2).
037700 SUBTRACT-TEST-F2-1-1.
037800     IF      RECORD2 OF TABLE2 (1) = 02
037900         AND RECORD2 OF TABLE2 (2) = 04
038000         AND RECORD1 OF TABLE2 = 08
038100         AND RECORD3 OF TABLE2 = 09
038200             PERFORM PASS
038300     ELSE
038400             GO TO   SUBTRACT-FAIL-F2-1.
038500     GO TO   SUBTRACT-WRITE-F2-1.
038600 SUBTRACT-DELETE-F2-1.
038700     PERFORM DE-LETE.
038800     GO TO SUBTRACT-WRITE-F2-1.
038900 SUBTRACT-FAIL-F2-1.
039000     PERFORM FAIL.
039100     MOVE TABLE2 TO COMPUTED-A.
039200     MOVE "08020409" TO CORRECT-A.
039300 SUBTRACT-WRITE-F2-1.
039400     PERFORM PRINT-DETAIL.
039500*
039600 MOV-INIT-F2-1.
039700     MOVE "MOV-TEST-F2-1" TO PAR-NAME.
039800     MOVE "IV-21 4.3.8.2" TO ANSI-REFERENCE.
039900     MOVE "MOVE CORRESPONDING" TO FEATURE.
040000     PERFORM INITIALISE-TABLE1.
040100     PERFORM INITIALISE-TABLE2.
040200 MOV-TEST-F2-1.
040300     MOVE CORRESPONDING TABLE1 TO TABLE2.
040400     IF RECORD1 OF TABLE2 = 06 AND
040500        RECORD2 OF TABLE2 (1) = 03 AND
040600        RECORD2 OF TABLE2 (2) = 04 AND
040700        RECORD3 OF TABLE2 = 07
040800        PERFORM PASS
040900        ELSE GO TO MOV-FAIL-F2-1.
041000     GO TO MOV-WRITE-F2-1.
041100 MOV-DELETE-F2-1.
041200     PERFORM DE-LETE.
041300     GO TO MOV-WRITE-F2-1.
041400 MOV-FAIL-F2-1.
041500     PERFORM FAIL.
041600     MOVE TABLE2 TO COMPUTED-A.
041700     MOVE "06030407" TO CORRECT-A.
041800 MOV-WRITE-F2-1.
041900     PERFORM PRINT-DETAIL.
042000*
042100 INITIALISE-TABLE3.
042200     MOVE "BB" TO RECORD2 OF TABLE3 (1).
042300     MOVE "CC" TO RECORD2 OF TABLE3 (2).
042400 INITIALISE-TABLE4.
042500     MOVE "FF" TO RECORD2 OF TABLE4 (1).
042600     MOVE "GG" TO RECORD2 OF TABLE4 (2).
042700*
042800 MOV-INIT-F2-2.
042900     MOVE "MOV-TEST-F2-2" TO PAR-NAME.
043000     MOVE "IV-21 4.3.8.2" TO ANSI-REFERENCE.
043100     MOVE "MOVE CORRESPONDING" TO FEATURE.
043200 MOV-TEST-F2-2.
043300     MOVE CORRESPONDING TABLE3 TO TABLE4.
043400     IF RECORD1 OF TABLE4 = "AA" AND
043500        RECORD2 OF TABLE4 (1) = "FF" AND
043600        RECORD2 OF TABLE4 (2) = "GG" AND
043700        RECORD3 OF TABLE4 = "DD"
043800        PERFORM PASS
043900        ELSE GO TO MOV-FAIL-F2-2.
044000     GO TO MOV-WRITE-F2-2.
044100 MOV-DELETE-F2-2.
044200     PERFORM DE-LETE.
044300     GO TO MOV-WRITE-F2-2.
044400 MOV-FAIL-F2-2.
044500     PERFORM FAIL.
044600     MOVE TABLE4 TO COMPUTED-A.
044700     MOVE "AAFFGGDD" TO CORRECT-A.
044800 MOV-WRITE-F2-2.
044900     PERFORM PRINT-DETAIL.
045000*
045100 MOV-INIT-F2-3.
045200*    ===-->  DE-EDITING  <--===
045300     MOVE   "VI-104 6.18.4 GR4(b)" TO ANSI-REFERENCE.
045400     MOVE   -123.45 TO MOVE-TEST-3-A.
045500     MOVE    1 TO REC-CT.
045600 MOV-TEST-F2-3-0.
045700     MOVE    MOVE-TEST-3-A TO MOVE-TEST-3-B.
045800     GO TO   MOV-TEST-F2-3-1.
045900 MOV-DELETE-F2-3.
046000     PERFORM DE-LETE.
046100     PERFORM PRINT-DETAIL.
046200     GO TO MOV-INIT-F2-4.
046300 MOV-TEST-F2-3-1.
046400     MOVE   "MOV-TEST-F2-3-1" TO PAR-NAME.
046500     IF      MOVE-TEST-3-B = -123.45
046600             PERFORM PASS
046700             GO TO MOV-WRITE-F2-3-1
046800     ELSE
046900             GO TO MOV-FAIL-F2-3-1.
047000 MOV-DELETE-F2-3-1.
047100     PERFORM DE-LETE.
047200     GO TO MOV-WRITE-F2-3-1.
047300 MOV-FAIL-F2-3-1.
047400     MOVE   -123.45 TO CORRECT-N
047500     MOVE    MOVE-TEST-3-B TO COMPUTED-N
047600     MOVE   "DE-EDITING MOVE ERROR" TO RE-MARK
047700     PERFORM FAIL.
047800 MOV-WRITE-F2-3-1.
047900     PERFORM PRINT-DETAIL.
048000*
048100 MOV-INIT-F2-3-2.
048200     ADD     1 TO REC-CT.
048300     MOVE   "MOV-TEST-F2-3-2" TO PAR-NAME.
048400 MOV-TEST-F2-3-2.
048500     IF      MOVE-TEST-3-A = " $123.45CR"
048600             PERFORM PASS
048700             GO TO MOV-WRITE-F2-3-2
048800     ELSE
048900             GO TO MOV-FAIL-F2-3-2.
049000 MOV-DELETE-F2-3-2.
049100     PERFORM DE-LETE.
049200     GO TO MOV-WRITE-F2-3-2.
049300 MOV-FAIL-F2-3-2.
049400     MOVE   " $123.45" TO CORRECT-X
049500     MOVE    MOVE-TEST-3-A TO COMPUTED-X
049600     MOVE   "EDITED DATA MOVE ERROR" TO RE-MARK
049700     PERFORM FAIL.
049800 MOV-WRITE-F2-3-2.
049900     PERFORM PRINT-DETAIL.
050000*
050100 MOV-INIT-F2-4.
050200*    ===-->  DE-EDITING  <--===
050300     MOVE   "VI-104 6.18.4 GR4(b)" TO ANSI-REFERENCE.
050400     MOVE   -42.9876 TO MOVE-TEST-4-A.
050500     MOVE    1 TO REC-CT.
050600 MOV-TEST-F2-4-0.
050700     MOVE    MOVE-TEST-4-A TO MOVE-TEST-4-B.
050800     GO TO MOV-TEST-F2-4-1.
050900 MOV-DELETE-F2-4.
051000     PERFORM DE-LETE.
051100     PERFORM PRINT-DETAIL.
051200     GO TO CCVS-999999.
051300 MOV-TEST-F2-4-1.
051400     MOVE   "MOV-TEST-F2-4-1" TO PAR-NAME.
051500     IF      MOVE-TEST-4-B = -42.987600
051600             PERFORM PASS
051700             GO TO MOV-WRITE-F2-4-1
051800     ELSE
051900             GO TO MOV-FAIL-F2-4-1.
052000 MOV-DELETE-F2-4-1.
052100     PERFORM DE-LETE.
052200     GO TO MOV-WRITE-F2-4-1.
052300 MOV-FAIL-F2-4-1.
052400     MOVE   -42.987600 TO CORRECT-N
052500     MOVE    MOVE-TEST-4-B TO COMPUTED-N
052600     MOVE   "DE-EDITING MOVE ERROR" TO RE-MARK
052700     PERFORM FAIL.
052800 MOV-WRITE-F2-4-1.
052900     PERFORM PRINT-DETAIL.
053000*
053100 MOV-TEST-F2-4-2.
053200     ADD     1 TO REC-CT.
053300     MOVE   "MOV-TEST-F2-4-2" TO PAR-NAME.
053400     IF      MOVE-TEST-4-A = "-42 .98 76/00"
053500             PERFORM PASS
053600             GO TO MOV-WRITE-F2-4-2
053700     ELSE
053800             GO TO MOV-FAIL-F2-4-2.
053900 MOV-DELETE-F2-4-2.
054000     PERFORM DE-LETE.
054100     GO TO MOV-WRITE-F2-4-2.
054200 MOV-FAIL-F2-4-2.
054300     MOVE   "-42 .98 76/00" TO CORRECT-X
054400     MOVE    MOVE-TEST-4-A TO COMPUTED-X
054500     MOVE   "EDITED DATA MOVE ERROR" TO RE-MARK
054600     PERFORM FAIL.
054700 MOV-WRITE-F2-4-2.
054800     PERFORM PRINT-DETAIL.
054900*
055000 CCVS-EXIT SECTION.
055100 CCVS-999999.
055200     GO TO CLOSE-FILES.
