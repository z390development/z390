       IDENTIFICATION DIVISION.
       PROGRAM-ID.  COPYFILE.
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT IN-FILE
               ASSIGN TO 'zcobol\demo\COPYFILE.IN'
               ORGANIZATION IS LINE SEQUENTIAL.
           SELECT OUT-FILE
               ASSIGN TO 'zcobol\demo\COPYFILE.OUT'
               ORGANIZATION IS LINE SEQUENTIAL.
       DATA DIVISION.
       FILE SECTION.
       FD  IN-FILE
           DATA RECORD IS IN-RECORD.
       01  IN-RECORD PIC X(80).
       FD  OUT-FILE
           DATA RECORD IS OUT-RECORD.
       01  OUT-RECORD PIC X(80).
       WORKING-STORAGE SECTION.
       01  WS-LINE PIC X(80).
       01  END-OF-FILE-FLAG PIC X VALUE 'F'.
       77  COUNT COMP-3 PIC S9(4) VALUE 0.
       LINKAGE SECTION.
       PROCEDURE DIVISION.
       MAINLINE.
           DISPLAY 'COPYFILE STARTED'
           PERFORM INITIALIZATION-ROUTINE.
           PERFORM THE-LOOP
                   UNTIL END-OF-FILE-FLAG = 'Y'.
           PERFORM EOJ-ROUTINE.
           DISPLAY 'COPYFILE RECORDS COPIED = ' COUNT.
           IF COUNT NOT = 17 
              DISPLAY 'COPYFILE RECORD COUNT ERROR'
              MOVE 16 TO RETURN-CODE
              STOP RUN
           END-IF 
           DISPLAY 'COPYFILE ENDED OK'
           STOP RUN.
       INITIALIZATION-ROUTINE.
           OPEN INPUT IN-FILE.
           OPEN OUTPUT OUT-FILE.
           READ IN-FILE INTO OUT-RECORD
                AT END MOVE 'Y' TO END-OF-FILE-FLAG.
       THE-LOOP.
           WRITE OUT-RECORD.
           ADD 1 TO COUNT
           READ IN-FILE INTO OUT-RECORD
                AT END MOVE 'Y' TO END-OF-FILE-FLAG.
       EOJ-ROUTINE.
           CLOSE IN-FILE.
           CLOSE OUT-FILE.
