.* MVS 3.8J PUBLIC DOMAIN
         MACRO
&NAME    IHBGAM1 &CODE,&ADDR,&GROUP
         GBLA  &IHBBLC,&IHBBLIM,&IHBBLP,&IHBSMSW
         GBLC  &IHBINIT
         IHBGAM3
&IHBBLC  SETA  &IHBBLC+2
         AIF   (T'&CODE EQ 'O').NEXT
&NAME    DC    H'&CODE'
&IHBBLC  SETA  &IHBBLC+2
.NEXT  AIF     (&IHBBLC LE &IHBBLIM).ON
         IHBERMAC 182
.ON      AIF   (T'&ADDR EQ 'O').ERRAD   VALIDATE ADDRESS PARAMETER
         AIF   ('&ADDR'(1,1) EQ '+' OR '&ADDR'(1,1) EQ '-').ERRAD
         AIF   (T'&ADDR NE 'N').SYMAD
         AIF   (&ADDR GT 32767).ERRAD
         DC    H'&ADDR'
       MEXIT
.ERRAD   IHBERMAC 180,ADDRESS,0
.NOAD  DC      X'0000'
         MEXIT
.SYMAD   AIF   (T'&GROUP NE 'O').GROUP
         DC    AL2(&ADDR-&IHBINIT+&IHBBLP)
         MEXIT
.GROUP   DC    AL2(&ADDR-&GROUP+IHB&GROUP)
         MEND

